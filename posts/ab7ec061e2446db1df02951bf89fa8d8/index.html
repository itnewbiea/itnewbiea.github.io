<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>阅读笔记--MolGAN: An implicit generative model for small molecular graphs - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="阅读笔记--MolGAN: An implicit generative model for small molecular graphs" />
<meta property="og:description" content="阅读笔记-MolGAN: An implicit generative model for small molecular graphs 概要背景介绍分子图隐式生成模型与似然生成模型GAN 与 Improved WGANDeterministic policy gradients 模型模型架构生成器判别器与反馈网络 实验分子生成药物发现 总结 概要 寻找具有理想性质的新化合物是一项具有挑战性的任务，具有重要的应用，如新药设计。可合成分子的空间是巨大的，在这个空间中寻找是非常困难的，这主要是由于它的离散性质。最近在开发深层生成模型方面取得的进展催生了一系列解决这一问题的有希望的提议。SMILES是一种从分子图派生的基于字符串的表示法。例如苯可以表示为： c 1 c c c c c 1 c1ccccc1 c1ccccc1。所以可以把它看作一个像语句那样的序列，然后利用基于RNN的生成方法来生成。但它的缺点为RNN必须花费能力来学习语法规则和表示的顺序歧义。 此外，这是不适用于一般（非分子）图的方法。SMILES字符串是从基于图的分子表示中生成的，因此在原始图空间中工作可以减少额外的开销。基于似然性的分子图生成方法需要提供固定（或随机选择）的图表示或昂贵的图匹配程序来评估生成的分子的可能性，因为对所有可能的节点排序的评估对于小尺寸的图的计算成本已经是非常高的了。
在这篇文章中作者利用生成对抗网络来生成分子图。并利用强化学习辅助生成具有具体属性的分子。
背景介绍 分子图 G \mathcal G G将一个分子表示为一个无向图。对于一个具有N个节点一个分子图可以由如下两个矩阵表示:
A ∈ R N × N × Y A\in\mathbb R^{N\times N\times Y} A∈RN×N×Y：邻接矩阵。 Y Y Y代表着分子图中具有Y种共价键（如单键、双键以及三键）。 A i j ∈ R Y A_{ij}\in\mathbb R^{Y} Aij​∈RY代表着原子 i , j i,j i,j之间的共价键类型（用 o n e − h o t one-hot one−hot向量来表示）。 X = [ x 1 , ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/ab7ec061e2446db1df02951bf89fa8d8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-10-05T23:52:24+08:00" />
<meta property="article:modified_time" content="2020-10-05T23:52:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">阅读笔记--MolGAN: An implicit generative model for small molecular graphs</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>阅读笔记-MolGAN: An implicit generative model for small molecular graphs</h4> 
 <ul><li><a href="#_1" rel="nofollow">概要</a></li><li><a href="#_10" rel="nofollow">背景介绍</a></li><li><ul><li><a href="#_11" rel="nofollow">分子图</a></li><li><a href="#_17" rel="nofollow">隐式生成模型与似然生成模型</a></li><li><a href="#GAN__Improved_WGAN_19" rel="nofollow">GAN 与 Improved WGAN</a></li><li><a href="#Deterministic_policy_gradients_25" rel="nofollow">Deterministic policy gradients</a></li></ul> 
  </li><li><a href="#_28" rel="nofollow">模型</a></li><li><ul><li><a href="#_30" rel="nofollow">模型架构</a></li><li><a href="#_33" rel="nofollow">生成器</a></li><li><a href="#_48" rel="nofollow">判别器与反馈网络</a></li></ul> 
  </li><li><a href="#_58" rel="nofollow">实验</a></li><li><ul><li><a href="#_59" rel="nofollow">分子生成</a></li><li><a href="#_70" rel="nofollow">药物发现</a></li></ul> 
  </li><li><a href="#_83" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>概要</h2> 
<p>寻找具有理想性质的新化合物是一项具有挑战性的任务，具有重要的应用，如新药设计。可合成分子的空间是巨大的，在这个空间中寻找是非常困难的，这主要是由于它的离散性质。最近在开发深层生成模型方面取得的进展催生了一系列解决这一问题的有希望的提议。<a href="https://zh.wikipedia.org/zh-hans/%E7%AE%80%E5%8C%96%E5%88%86%E5%AD%90%E7%BA%BF%E6%80%A7%E8%BE%93%E5%85%A5%E8%A7%84%E8%8C%83" rel="nofollow">SMILES</a>是一种从分子图派生的基于字符串的表示法。例如苯可以表示为：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         c 
        
       
         1 
        
       
         c 
        
       
         c 
        
       
         c 
        
       
         c 
        
       
         c 
        
       
         1 
        
       
      
        c1ccccc1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span><span class="mord">1</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord">1</span></span></span></span></span>。所以可以把它看作一个像语句那样的序列，然后利用基于RNN的生成方法来生成。但它的缺点为RNN必须花费能力来学习语法规则和表示的顺序歧义。 此外，这是不适用于一般（非分子）图的方法。SMILES字符串是从基于图的分子表示中生成的，因此在原始图空间中工作可以减少额外的开销。基于似然性的分子图生成方法需要提供固定（或随机选择）的图表示或昂贵的图匹配程序来评估生成的分子的可能性，因为对所有可能的节点排序的评估对于小尺寸的图的计算成本已经是非常高的了。<br> 在这篇文章中作者利用生成对抗网络来生成分子图。并利用强化学习辅助生成具有具体属性的分子。</p> 
<h2><a id="_10"></a>背景介绍</h2> 
<h3><a id="_11"></a>分子图</h3> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         G 
        
       
      
        \mathcal G 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.78055em; vertical-align: -0.09722em;"></span><span class="mord mathcal" style="margin-right: 0.0593em;">G</span></span></span></span></span>将一个分子表示为一个无向图。对于一个具有N个节点一个分子图可以由如下两个矩阵表示:</p> 
<ul><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          A 
         
        
          ∈ 
         
         
         
           R 
          
          
          
            N 
           
          
            × 
           
          
            N 
           
          
            × 
           
          
            Y 
           
          
         
        
       
         A\in\mathbb R^{N\times N\times Y} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10903em;">N</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.10903em;">N</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.22222em;">Y</span></span></span></span></span></span></span></span></span></span></span></span></span>：邻接矩阵。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          Y 
         
        
       
         Y 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.22222em;">Y</span></span></span></span></span>代表着分子图中具有Y种共价键（如单键、双键以及三键）。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           A 
          
          
          
            i 
           
          
            j 
           
          
         
        
          ∈ 
         
         
         
           R 
          
         
           Y 
          
         
        
       
         A_{ij}\in\mathbb R^{Y} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.22222em;">Y</span></span></span></span></span></span></span></span></span></span></span></span></span>代表着原子<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          i 
         
        
          , 
         
        
          j 
         
        
       
         i,j 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span></span></span></span></span>之间的共价键类型（用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          o 
         
        
          n 
         
        
          e 
         
        
          − 
         
        
          h 
         
        
          o 
         
        
          t 
         
        
       
         one-hot 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span></span></span></span></span>向量来表示）。</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          X 
         
        
          = 
         
        
          [ 
         
         
         
           x 
          
         
           1 
          
         
        
          , 
         
        
          . 
         
        
          . 
         
        
          . 
         
        
          , 
         
         
         
           x 
          
         
           N 
          
         
         
         
           ] 
          
         
           T 
          
         
        
          ∈ 
         
         
         
           R 
          
          
          
            N 
           
          
            × 
           
          
            T 
           
          
         
        
       
         X=[x_{1},...,x_{N}]^{T}\in\mathbb R^{N\times T} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09133em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10903em;">N</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></span>是节点特征矩阵。每个原子对应于一个节点<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           v 
          
         
           i 
          
         
        
          ∈ 
         
        
          V 
         
        
       
         v_{i}\in \mathcal V 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6891em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.08222em;">V</span></span></span></span></span>;这个节点用一个<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          T 
         
        
       
         T 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span>维的one-hot向量<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           x 
          
         
           i 
          
         
        
       
         x_{i} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>来表示。</li></ul> 
<h3><a id="_17"></a>隐式生成模型与似然生成模型</h3> 
<p>当我们生成图结构数据时，我们希望模型具有置换不变性。否则，我们就要执行一个计算量非常大的图匹配过程来评价模型所生成的图的质量。似然生成模型的优化过程更加稳定并且简单，但显式地评估所有可能节点排列的可能性的计算量很大，也就是似然的方法很难满足置换不变性。但基于生成对抗网络的方法则完全解决了这个问题，因为很多图卷积方法是置换不变的，我们可以用这些图卷积来构建我们的判别器。</p> 
<h3><a id="GAN__Improved_WGAN_19"></a>GAN 与 Improved WGAN</h3> 
<p>详见：</p> 
<ul><li><a href="https://zhuanlan.zhihu.com/p/25071913" rel="nofollow">WGAN</a></li><li><a href="https://en.wikipedia.org/wiki/Generative_adversarial_network" rel="nofollow">GAN</a></li><li><a href="https://arxiv.org/abs/1704.00028" rel="nofollow">WGAN-GP</a></li></ul> 
<h3><a id="Deterministic_policy_gradients_25"></a>Deterministic policy gradients</h3> 
<p>在药物生成中，我们生成的分子，不仅要满足化学定义，而且要有一些有用的性质（比如说易于合成）。而这种目标对于训练过程来说其实是不可微的，所以需要引入强化学习来优化那些不可微的指标的生成过程。<br> 在本文中作者采用了<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         D 
        
       
         D 
        
       
         P 
        
       
         G 
        
       
      
        DDPG 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault">G</span></span></span></span></span>，大致意思是生成器生成将先验<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         z 
        
       
      
        z 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span></span></span></span></span>生成为一个图结构<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         G 
        
       
      
        \mathcal G 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.78055em; vertical-align: -0.09722em;"></span><span class="mord mathcal" style="margin-right: 0.0593em;">G</span></span></span></span></span>。作者构建了一个<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         e 
        
       
         w 
        
       
         a 
        
       
         r 
        
       
         d 
          
       
         f 
        
       
         u 
        
       
         n 
        
       
         c 
        
       
         t 
        
       
         i 
        
       
         o 
        
       
         n 
          
        
         
         
           R 
          
         
           ^ 
          
         
        
          ψ 
         
        
       
         ( 
        
       
         G 
        
       
         ) 
        
       
      
        Reward\;function\;\hat R_{\psi}(\mathcal G) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.23288em; vertical-align: -0.286108em;"></span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault">u</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span></span><span class="" style="top: -3.25233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">ψ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathcal" style="margin-right: 0.0593em;">G</span><span class="mclose">)</span></span></span></span></span>根据<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         G 
        
       
      
        \mathcal G 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.78055em; vertical-align: -0.09722em;"></span><span class="mord mathcal" style="margin-right: 0.0593em;">G</span></span></span></span></span>得到一个输出奖励，然后将其和真正的奖励（由外部系统提供，例如，分子的可合成性得分）做均方误差损失，并通过最小化这个损失来提供生成器训练所需的梯度。</p> 
<h2><a id="_28"></a>模型</h2> 
<p><img src="https://images2.imgbox.com/64/17/klwdUL4E_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_30"></a>模型架构</h3> 
<ul><li>生成器：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          N 
         
        
          = 
         
        
          9 
         
        
          ， 
         
        
          T 
         
        
          = 
         
        
          5 
         
        
          ， 
         
        
          Y 
         
        
          = 
         
        
          4 
         
        
       
         N=9，T=5，Y=4 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">9</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">5</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault" style="margin-right: 0.22222em;">Y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">4</span></span></span></span></span>，并且先根据正态分布采样一个32维的潜在表示<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          z 
         
        
          ∼ 
         
        
          N 
         
        
          ( 
         
        
          0 
         
        
          , 
         
        
          I 
         
        
          ) 
         
        
       
         z\sim\mathcal N(0,I) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathcal" style="margin-right: 0.14736em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.07847em;">I</span><span class="mclose">)</span></span></span></span></span>。生成器是三层<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           M 
          
         
           L 
          
         
           P 
          
         
        
          [ 
         
        
          128 
         
        
          , 
         
        
          256 
         
        
          , 
         
        
          512 
         
        
          ] 
         
        
       
         \mathbf {MLP}[128,256,512] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathbf">M</span><span class="mord mathbf">L</span><span class="mord mathbf">P</span></span><span class="mopen">[</span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mord">5</span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">5</span><span class="mord">1</span><span class="mord">2</span><span class="mclose">]</span></span></span></span></span>，并且将<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          t 
         
        
          a 
         
        
          n 
         
        
          h 
         
        
       
         tanh 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">h</span></span></span></span></span>作为每层的激活函数。最后一层被线性投影以匹配X和A维数，并利用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          s 
         
        
          o 
         
        
          f 
         
        
          t 
         
        
          m 
         
        
          a 
         
        
          x 
         
        
       
         softmax 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span></span></span></span></span>来进行正则化。</li><li>判别器与反馈网络架构：两者都使用两层的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          R 
         
        
          e 
         
        
          l 
         
        
          a 
         
        
          t 
         
        
          i 
         
        
          o 
         
        
          n 
         
        
          a 
         
        
          l 
           
        
          G 
         
        
          C 
         
        
          N 
         
        
       
         Relational\;GCN 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span></span></span></span></span>，但并不共享参数。将图网络的输出经过处理得到图表示向量，并将得到的图表示向量输入一个两层的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           M 
          
         
           L 
          
         
           P 
          
         
        
          [ 
         
        
          128 
         
        
          , 
         
        
          1 
         
        
          ] 
         
        
       
         \mathbf {MLP}[128,1] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathbf">M</span><span class="mord mathbf">L</span><span class="mord mathbf">P</span></span><span class="mopen">[</span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span>来得到最终的输出。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          M 
         
        
          L 
         
        
          P 
         
        
       
         \mathbf{MLP} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68611em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbf">M</span><span class="mord mathbf">L</span><span class="mord mathbf">P</span></span></span></span></span></span>中判别器采用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          t 
         
        
          a 
         
        
          n 
         
        
          h 
         
        
       
         tanh 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">h</span></span></span></span></span>作为激活函数，而反馈网络采用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          s 
         
        
          i 
         
        
          g 
         
        
          m 
         
        
          o 
         
        
          i 
         
        
          d 
         
        
       
         sigmoid 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span></span></span></span></span>作为激活函数。</li></ul> 
<h3><a id="_33"></a>生成器</h3> 
<p>参考：</p> 
<ul><li><a href="https://arxiv.org/abs/1611.01144" rel="nofollow">Categorical Reparameterization with Gumbel-Softmax</a></li><li><a href="https://blog.csdn.net/a358463121/article/details/80820878">带你认识神奇的Gumbel trick</a></li></ul> 
<p>作者发现预先选择最大尺寸的图，可以以更快的速度训练，并且也更容易优化。生成器的目标函数为：<br> <img src="https://images2.imgbox.com/da/1e/LLl0GjU1_o.png" alt="在这里插入图片描述"><br> 对于生成过程：采样<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         z 
        
       
      
        z 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span></span></span></span></span>送入生成器生成A与X，接下来为了得到分子图，采取离散稀疏化送入判别器与奖励网络。但这样将使得生成器失去用来更新参数的梯度。作者采用了三种方法来解决这个问题：</p> 
<ul><li>不采用离散稀疏化，直接将生成的概率矩阵送入判别器与奖励网络；</li><li>将X与A与Gumbel噪声相加然后送入判别器与奖励网络；<br> <img src="https://images2.imgbox.com/a1/03/8tPFXsIS_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b0/14/IBqGtoS1_o.png" alt="在这里插入图片描述"></li><li>利用<a href="https://arxiv.org/abs/1611.01144" rel="nofollow">link</a>中提到的方法来获取梯度。</li></ul> 
<h3><a id="_48"></a>判别器与反馈网络</h3> 
<ul><li>奖励网络是用来近似奖励函数，并利用强化学习来使得模型向不可微的方向进行优化。数据集中的图和生成的图都是奖励网络的输入，但与判别器不同的是，奖励网络要给每个分子打分（比如生成的分子溶于水的可能性有多大，真实的分数由RDKit提供）。并且当生成的分子在化学上无效时，整个奖励网络将输出0。</li><li>判别器利用WGAN来训练，即：<br> <img src="https://images2.imgbox.com/ea/d3/4fRstr3V_o.png" alt="在这里插入图片描述"></li></ul> 
<p>判别器<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          D 
         
        
          ϕ 
         
        
       
      
        D_{\phi} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ϕ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>与奖励网络<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
         
           R 
          
         
           ^ 
          
         
        
          ψ 
         
        
       
      
        \hat R_{\psi} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.23288em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span></span><span class="" style="top: -3.25233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">ψ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>豆浆图结构作为输入并输出一个标量，并且两者采用相同的架构，但不共享参数。先是由一系列的图卷积<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         e 
        
       
         l 
        
       
         a 
        
       
         t 
        
       
         i 
        
       
         o 
        
       
         n 
        
       
         a 
        
       
         l 
          
       
         G 
        
       
         C 
        
       
         N 
        
       
      
        Relational\;GCN 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span></span></span></span></span>：<br> <img src="https://images2.imgbox.com/8d/a7/sonfK7pq_o.png" alt="在这里插入图片描述"><br> 经过若干层的图卷积后，由下式得到图表示向量：<br> <img src="https://images2.imgbox.com/75/62/wmBPSPEn_o.png" alt="在这里插入图片描述"><br> 将得到的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          h 
         
        
          G 
         
        
       
      
        h_{\mathcal G} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.912494em; vertical-align: -0.218054em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.0593em;">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.218054em;"><span class=""></span></span></span></span></span></span></span></span></span></span>作为一个MLP的输入得到一个标量。前向传播的过程由此结束。</p> 
<h2><a id="_58"></a>实验</h2> 
<h3><a id="_59"></a>分子生成</h3> 
<p>分子图生成任务常用的三个指标：</p> 
<ul><li><strong>Validity</strong>：生成的分子中符合化学规定的分子的数量与总生成数量之比；</li><li><strong>Novelty</strong>：生成的有效的分子中并不属于原数据集（即新生成的）的分子的数量与总的有效分子数量之比；</li><li><strong>Uniqueness</strong>：生成的分子不在数据集中的分子数与有效的分子数之比。这个指标反映了以衡量抽样过程中样本的变化程度。</li></ul> 
<p>除此之外，作者还将<strong>solubility</strong>（可溶性）作为一个实验指标，来进行实验。实验过程中作者发现，尽管使用了WGAN，模型崩溃还是会出现。并且作者还注意到奖励网络需要几个阶段的预训练才能将梯度传播到产生器，否则产生器很容易发散。所以作者在起初的几个epochs里，作者只用对抗损失来训练生成器，在同时也训练奖励网络但并不将<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          L 
         
         
         
           R 
          
         
           L 
          
         
        
       
      
        \mathbf L_{RL} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83611em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbf">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.00773em;">R</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>用于训练生成器。作者发现当<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          L 
         
         
         
           R 
          
         
           L 
          
         
        
       
      
        L_{RL} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.00773em;">R</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>占的比重比较大时，生成分子的有效性这一指标会增加。</p> 
<h3><a id="_70"></a>药物发现</h3> 
<p>药物发现任务常用的评价指标：</p> 
<ul><li><strong>Druglikeness</strong>：一种化合物成为药物的可能性有多大；常用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           Q 
          
         
           E 
          
         
           D 
          
         
        
          ( 
         
        
          Q 
         
        
          u 
         
        
          a 
         
        
          n 
         
        
          t 
         
        
          i 
         
        
          t 
         
        
          a 
         
        
          t 
         
        
          i 
         
        
          v 
         
        
          e 
             
        
          E 
         
        
          s 
         
        
          t 
         
        
          i 
         
        
          m 
         
        
          a 
         
        
          t 
         
        
          e 
           
        
          o 
         
        
          f 
               
        
          D 
         
        
          r 
         
        
          u 
         
        
          g 
         
        
          l 
         
        
          i 
         
        
          k 
         
        
          e 
         
        
          n 
         
        
          e 
         
        
          s 
         
        
          ) 
         
        
       
         \mathbf {QED}(Quantitative\;\;Estimate\;of\;\;\;Druglikenes) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathbf">Q</span><span class="mord mathbf">E</span><span class="mord mathbf">D</span></span><span class="mopen">(</span><span class="mord mathdefault">Q</span><span class="mord mathdefault">u</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">E</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span></span>，用期望值加权几何平均值来量化化合物特性，捕捉几种药物属性的潜在数据分布。</li><li><strong>Solubility</strong>：表示分子亲水性的程度；对数辛醇-水分配系数(<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           l 
          
         
           o 
          
         
           g 
          
         
        
          P 
         
        
       
         \mathbf{log}\mathbf P 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathbf">l</span><span class="mord mathbf">o</span><span class="mord mathbf" style="margin-right: 0.01597em;">g</span></span><span class="mord mathbf">P</span></span></span></span></span>)：其定义为一个溶质在两种溶剂中浓度比值的对数。</li><li><strong><a href="https://zhuanlan.zhihu.com/p/87351584" rel="nofollow">Synthetizability</a></strong>：这种方法可以量化一个分子合成的难易程度；<strong>SA score（Synthetic Accessibility score）</strong>：是一种用概率方法估计综合易用性的方法。</li></ul> 
<p>作者在进行实验优化<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          L 
         
         
         
           R 
          
         
           L 
          
         
        
       
      
        L_{RL} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.00773em;">R</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>时，并不是分别优化以上目标，而是进行了联合优化，将这几个指标相乘作为最终要优化的指标。</p> 
<p>实验结果：<br> <img src="https://images2.imgbox.com/79/2a/uXsT3cXC_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_83"></a>总结</h2> 
<p>MolGAN的一个局限是对于模型崩溃的敏感性。RL与GAN的目标函数都不鼓励产生多样的非独特的输出，因此模型被拉向一个只涉及很少样本可变性的解决方案，如果训练没有及早的停止，最终将导致仅产生少量不同的分子。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c8312854ce105011f6abf7b3315067b9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">在 IDEA 中，通过 module（模块） 依赖来解决一个模块中使用另一个模块中的类</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ac76d509db269ff4db0e9980540e0204/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Echarts：10-7-5:雷达图&#43;多雷达图</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>