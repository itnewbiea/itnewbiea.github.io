<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C&#43;&#43;——引入python函数 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C&#43;&#43;——引入python函数" />
<meta property="og:description" content="1、添加环境 #include&lt;Python.h&gt; 2、添加库路径 3、函数剖析 //初始化python解释器
void Py_Initialize(void);
//检查是否初始化成功
int Py_IsIntialized(void);
//导入python模块
PyObject* PyImport_ImportModule(char *name);
//执行Python代码
int PyRun_SimpleString(const char *command);
//构建参数列表， 把C类型转化成Python支持类型
PyObject* Py_BuildValue(char* format, ...)
//储存python导入的方法字典
PyModule_GetDict
//获取方法
PyObject* PyDict_GetItemString(PyObject*, const char*);
4、实例运用 如下有一个temp.py（pyhon文件）
def hello(name): print(&#34;hello world, &#34;, name) return 0 #include &lt;Python.h&gt; void importPython() { PyObject *pName = NULL; PyObject *pModule = NULL; PyObject *pFunc = NULL; PyObject *pDict = NULL; PyObject *pArgs = NULL; Py_Initialize(); if(!Py_IsInitialized()) { cout &lt;&lt; &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e17c905e776669d1d82fb2014504cece/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-07T09:42:13+08:00" />
<meta property="article:modified_time" content="2021-04-07T09:42:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C&#43;&#43;——引入python函数</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3> 1、添加环境</h3> 
<pre><code class="language-cpp">#include&lt;Python.h&gt;</code></pre> 
<p><img alt="" height="665" src="https://images2.imgbox.com/e3/15/8iWCRTzC_o.png" width="917"></p> 
<h3>2、添加库路径</h3> 
<p><img alt="" height="663" src="https://images2.imgbox.com/d7/6f/z8zL4rUq_o.png" width="916"></p> 
<h3>3、函数剖析</h3> 
<p>//初始化python解释器<br> void Py_Initialize(void);</p> 
<p>//检查是否初始化成功<br> int Py_IsIntialized(void);</p> 
<p>//导入python模块<br> PyObject* PyImport_ImportModule(char *name);</p> 
<p>//执行Python代码<br> int PyRun_SimpleString(const char *command);</p> 
<p>//构建参数列表， 把C类型转化成Python支持类型<br> PyObject* Py_BuildValue(char* format, ...)</p> 
<p>//储存python导入的方法字典<br> PyModule_GetDict</p> 
<p>//获取方法<br> PyObject* PyDict_GetItemString(PyObject*, const char*);</p> 
<h3>4、实例运用</h3> 
<p> 如下有一个temp.py（pyhon文件）</p> 
<pre><code class="language-python">def hello(name):
    print("hello world, ", name)
    return 0
</code></pre> 
<pre><code class="language-cpp">#include &lt;Python.h&gt;
void importPython()
{
    PyObject *pName = NULL;
    PyObject *pModule = NULL;
    PyObject *pFunc = NULL;
    PyObject *pDict = NULL;
    PyObject *pArgs = NULL;
    Py_Initialize();
    if(!Py_IsInitialized())
    {
	cout &lt;&lt; "python initialized failed." &lt;&lt; endl;
    }
    // 载入名为PyPlugin的脚本

    //添加路径为当前文件夹
    PyRun_SimpleString("import sys");  
    PyRun_SimpleString("sys.path.append('./')");  
    //导入python文件
    pModule = PyImport_ImportModule("getfiles");

    if (!pModule)
    {
	printf("can't getfiles.py\n");
    }
    pDict = PyModule_GetDict(pModule);
    if(!pDict)
    {
	cout &lt;&lt; "can't pDict" &lt;&lt; endl;
	system("pause");
	return;
    }
    pFunc = PyDict_GetItemString(pDict, "hello");
    if(!pFunc || !PyCallable_Check(pFunc))
    {
	cout &lt;&lt; "can't findfunction run" &lt;&lt; endl;
	system("pause");
	return;
    }
    char name[100] = "coco567";
    //将参数保存在容器内
    PyObject *list = PyList_New(0);
    pArgs = PyTuple_New(1);
    //s对应string类型
    PyList_Append(list, Py_BuildValue("s", name));
    PyTuple_SetItem(pArgs, 0, list);
    #调用
    PyObject *pRet = PyEval_CallObject(pFunc, pArgs);
    int ret = 0;
    if(pRet &amp;&amp; PyArg_ParseTuple(pRet, "i", &amp;ret))
    {
	printf("Function iter_reader call successful ret = %d\n", ret);
    }
    //垃圾回收
    if(pArgs)
	Py_DECREF(pArgs);
    if(pFunc)
	Py_DECREF(pFunc);
    //关闭解释器
    Py_Finalize();

}</code></pre> 
<p> </p> 
<p> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a2afe9791be711ad66291c279523091c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">oracle varray长度,Oracle VARRAY</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bb1222fffe8d765642a3c2410502fa5f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">RIP路由协议详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>