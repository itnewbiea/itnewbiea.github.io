<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>OGR坐标变换 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="OGR坐标变换" />
<meta property="og:description" content="以下是自己的一点点心得，留作以后用。可能不正确，欢迎指正 利用GDAL/OGR进行投影变化（VC&#43;&#43;中），相关的函数都在ogr_srs_api.h中了。
Lilin大虾写得是关于phython中进行转换的，所以他利用的是这样的。
ct = osr.CoordinateTransformation(osrobj,osrobj3)
ct.TransformPoint(590000,4928000)
在vc中，利用OGRSpatialReference对象的Transform()或TransformEx()方法可以实现不同投影系统之间以及投影坐标和地理坐标之间的转换(两者的区别我还不知道)。
OGRSpatialReference * ShpSpf;//
OGRSpatialReference Raster_spf;
ShpSpf=polayer-&gt;GetSpatialRef(); //获取矢量图像的投影信息 Raster_spf=poDataset-&gt;GetProjectionRef();//获取栅格图像的投影信息 OGRCoordinateTransformation *poCT;
if (!(ShpSpf-&gt;IsProjected()))//判断是否经过投影
{
if(ShpSpf-&gt;IsGeographic())//判断是否有地理坐标信息
{
AfxMessageBox(&#34;没有投影信息，只有地理信息！&#34;);
return;
}
else
{
AfxMessageBox(&#34;没有地理坐标和投影信息！&#34;);
return;
}
}
int spf_flag=ShpSpf-&gt;IsSame(&amp;Raster_spf);//spf_flag标示两个投影是否一致，如果一样则为1，反之为0
1、不同投影系统之间转换：
poCT=OGRCreateCoordinateTransformation(ShpSpf,&amp;Raster_spf);
// poCT-&gt;TransformPoint();
if((poCT==NULL))
{
AfxMessageBox(&#34;不支持该类型的坐标转换!&#34;);
shape=3;//不再画这一层数据
return;
}
if(!poCT-&gt;TransformEx(ipoints,Arrayx,Arrayy))
{
AfxMessageBox(&#34;坐标转换失败!&#34;);
shape=3;//不再画这一层数据
return;
}
2、投影坐标到地理坐标的转换：
OGRSpatialReference *tempsp;
tempsp=Raster_spf.CloneGeogCS();//获取投影系统中的地理坐标信息
OGRCoordinateTransformation *poCT1;
//投影坐标向地理坐标转换。
poCT1=OGRCreateCoordinateTransformation(&amp;Raster_spf,tempsp);
//&amp;Raster_spf,tempsp顺序颠倒过来就是从地理坐标向投影坐标转换了
if(poCT1-&gt;TransformEx(1,&amp;Arrayx[1],&amp;Arrayy[1]))
{
}
转载于:https://www.cnblogs.com/gisbingxin/archive/2008/12/15/1355414.html" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/0333015364657dca35e6bcc82e6d578a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2008-12-15T16:22:00+08:00" />
<meta property="article:modified_time" content="2008-12-15T16:22:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">OGR坐标变换</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body">
    以下是自己的一点点心得，留作以后用。可能不正确，欢迎指正 
 <p style="line-height:15pt;"><span style="font-family:'宋体';">利用</span>GDAL/OGR<span style="font-family:'宋体';">进行投影变化（</span>VC++<span style="font-family:'宋体';">中），相关的函数都在</span><span style="font-size:7.5pt;color:#000000;font-family:Verdana;"><a href="http://www.gdal.org/ogr/ogr__srs__api_8h.html" rel="nofollow"><strong>ogr_srs_api.h</strong></a></span><span style="font-family:'宋体';">中了。</span></p> 
 <p style="line-height:15pt;">Lilin<span style="font-family:'宋体';">大虾写得是关于</span>phython<span style="font-family:'宋体';">中进行转换的，所以他利用的是这样的。</span></p> 
 <p style="line-height:15pt;">                               ct = osr.CoordinateTransformation(osrobj,osrobj3)</p> 
 <p style="line-height:15pt;text-align:left;" align="left">                            ct.TransformPoint(590000,4928000)</p> 
 <p style="text-indent:21pt;"><span style="font-family:'宋体';">在</span>vc<span style="font-family:'宋体';">中，利用</span>OGRSpatialReference<span style="font-family:'宋体';">对象的</span>Transform()<span style="font-family:'宋体';">或</span>TransformEx()<span style="font-family:'宋体';">方法可以实现不同投影系统之间以及投影坐标和地理坐标之间的转换</span>(<span style="font-family:'宋体';">两者的区别我还不知道</span>)<span style="font-family:'宋体';">。</span></p> 
 <p style="margin-left:63pt;">       OGRSpatialReference * ShpSpf;//</p> 
 <p style="margin-left:63pt;">       OGRSpatialReference Raster_spf;</p> 
 <p style="margin-left:63pt;">       ShpSpf=polayer-&gt;GetSpatialRef();       //<span style="font-family:'宋体';">获取矢量图像的投影信息</span> </p> 
 <p style="margin-left:63pt;">       Raster_spf=poDataset-&gt;GetProjectionRef();//<span style="font-family:'宋体';">获取栅格图像的投影信息</span> </p> 
 <p style="margin-left:63pt;text-indent:21pt;">OGRCoordinateTransformation *poCT;</p> 
 <p style="margin-left:63pt;text-indent:21pt;">                     if (!(ShpSpf-&gt;IsProjected()))//<span style="font-family:'宋体';">判断是否经过投影</span></p> 
 <p style="margin-left:63pt;text-indent:21pt;">                     {<!-- --></p> 
 <p style="margin-left:63pt;text-indent:21pt;">                            if(ShpSpf-&gt;IsGeographic())//<span style="font-family:'宋体';">判断是否有地理坐标信息</span></p> 
 <p style="margin-left:63pt;text-indent:21pt;">                            {<!-- --></p> 
 <p style="margin-left:63pt;text-indent:21pt;">                            AfxMessageBox("<span style="font-family:'宋体';">没有投影信息，只有地理信息！</span>");</p> 
 <p style="margin-left:63pt;text-indent:21pt;">                                   return;</p> 
 <p style="margin-left:63pt;text-indent:21pt;">                            }</p> 
 <p style="margin-left:63pt;text-indent:21pt;">                            else</p> 
 <p style="margin-left:63pt;text-indent:21pt;">                            {<!-- --></p> 
 <p style="margin-left:63pt;text-indent:21pt;">                                   AfxMessageBox("<span style="font-family:'宋体';">没有地理坐标和投影信息！</span>");</p> 
 <p style="margin-left:63pt;text-indent:21pt;">                                   return;</p> 
 <p style="margin-left:63pt;text-indent:21pt;">                            }</p> 
 <p style="margin-left:63pt;text-indent:21pt;">                     }</p> 
 <p style="margin-left:63pt;text-indent:21pt;">int spf_flag=ShpSpf-&gt;IsSame(&amp;Raster_spf);//spf_flag<span style="font-family:'宋体';">标示两个投影是否一致，如果一样则为</span>1<span style="font-family:'宋体';">，反之为</span>0</p> 
 <p style="margin-left:63pt;text-indent:21pt;"> </p> 
 <p>1<span style="font-family:'宋体';">、不同投影系统之间转换：</span></p> 
 <p>                            poCT=OGRCreateCoordinateTransformation(ShpSpf,&amp;Raster_spf);</p> 
 <p>                     //     poCT-&gt;TransformPoint();</p> 
 <p>                            if((poCT==NULL))</p> 
 <p>                            {<!-- --></p> 
 <p>                                   AfxMessageBox("<span style="font-family:'宋体';">不支持该类型的坐标转换</span>!");</p> 
 <p>                                   shape=3;//<span style="font-family:'宋体';">不再画这一层数据</span></p> 
 <p>                                   return;</p> 
 <p>                            }</p> 
 <p>                            if(!poCT-&gt;TransformEx(ipoints,Arrayx,Arrayy))</p> 
 <p>                            {<!-- --></p> 
 <p>                                   AfxMessageBox("<span style="font-family:'宋体';">坐标转换失败</span>!");</p> 
 <p>                                   shape=3;//<span style="font-family:'宋体';">不再画这一层数据</span></p> 
 <p>                                   return;</p> 
 <p>                            }</p> 
 <p> </p> 
 <p>2<span style="font-family:'宋体';">、投影坐标到地理坐标的转换：</span></p> 
 <p>                            OGRSpatialReference *tempsp;</p> 
 <p>                            tempsp=Raster_spf.CloneGeogCS();//<span style="font-family:'宋体';">获取投影系统中的地理坐标信息</span></p> 
 <p>                            OGRCoordinateTransformation *poCT1;</p> 
 <p style="margin-left:63pt;text-indent:21pt;">//<span style="font-family:'宋体';">投影坐标向地理坐标转换。</span></p> 
 <p>                            poCT1=OGRCreateCoordinateTransformation(&amp;Raster_spf,tempsp);</p> 
 <p style="margin-left:63pt;text-indent:21pt;">//&amp;Raster_spf,tempsp<span style="font-family:'宋体';">顺序颠倒过来就是从地理坐标向投影坐标转换了</span></p> 
 <p>                            if(poCT1-&gt;TransformEx(1,&amp;Arrayx[1],&amp;Arrayy[1]))</p> 
 <p>                            {<!-- --></p> 
 <p>                            }</p> 
</div> 
<p>转载于:https://www.cnblogs.com/gisbingxin/archive/2008/12/15/1355414.html</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/89304c21e3b15978ea5a8b75a24a1fe9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">从c&#43;&#43;到java 之四（类定义&#43;import）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/eac457d617721917cdeb580c79450425/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C#中的映射</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>