<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>php curl模拟 浏览器 伪装客户端 访问 真实可用 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="php curl模拟 浏览器 伪装客户端 访问 真实可用" />
<meta property="og:description" content="作者最近有个需求，爬取别人的网站的卡的 归属银行，发现这个接口挺好用，就想了个办法模拟访问获取
public function getUrlContent() { $origin = &#39;http://www.lianhanghao.com&#39;; //目标网址 $referer = $origin . &#34;/cardbin.html&#34;;//当前页面 $apiUrl = $origin . &#34;/admin/api/getBankdata&#34;;//请求的api地址 $data = [&#39;cardno&#39; =&gt; &#39;&#39;];//此处填写的是银行卡或者信用卡的卡号 //注意了，这里的hear信息比较关键， 请先用ajax测试访问成功，然后把请求信息复制过来替换 $header = [ &#39;Accept: application/json, text/javascript, */*; q=0.01&#39;, // &#39;Accept-Encoding: gzip, deflate, br&#39;, &#39;Accept-Language: zh-CN,zh;q=0.9&#39;, &#39;Connection: keep-alive&#39;, &#39;Content-Type: application/x-www-form-urlencoded; charset=UTF-8&#39;, // &#39;Cookie: PHPSESSID=340abf1a618653fef13589101044e994; ZDEDebuggerPresent=php,phtml,php3; CNZZDATA1583751=cnzz_eid%3D572091052-1569547668-%26ntime%3D1569553068&#39;, // &#39;Host: localhost_mlf.com&#39;, &#39;Origin: &#39; . $origin, &#39;Referer:&#39; . $referer, &#39;User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c0c899f34661399866dd93ce8cf65d58/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-09-27T14:33:14+08:00" />
<meta property="article:modified_time" content="2019-09-27T14:33:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">php curl模拟 浏览器 伪装客户端 访问 真实可用</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>作者最近有个需求，爬取别人的网站的卡的 归属银行，发现这个接口挺好用，就想了个办法模拟访问获取</p> 
<pre><code class="prism language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getUrlContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>

        <span class="token variable">$origin</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'http://www.lianhanghao.com'</span><span class="token punctuation">;</span> <span class="token comment">//目标网址</span>
        <span class="token variable">$referer</span> <span class="token operator">=</span> <span class="token variable">$origin</span> <span class="token punctuation">.</span> <span class="token double-quoted-string string">"/cardbin.html"</span><span class="token punctuation">;</span><span class="token comment">//当前页面</span>
        <span class="token variable">$apiUrl</span> <span class="token operator">=</span> <span class="token variable">$origin</span> <span class="token punctuation">.</span> <span class="token double-quoted-string string">"/admin/api/getBankdata"</span><span class="token punctuation">;</span><span class="token comment">//请求的api地址</span>
        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'cardno'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//此处填写的是银行卡或者信用卡的卡号</span>
		
		<span class="token comment">//注意了，这里的hear信息比较关键， 请先用ajax测试访问成功，然后把请求信息复制过来替换</span>
        <span class="token variable">$header</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'Accept: application/json, text/javascript, */*; q=0.01'</span><span class="token punctuation">,</span>
<span class="token comment">//            'Accept-Encoding: gzip, deflate, br',</span>
            <span class="token single-quoted-string string">'Accept-Language: zh-CN,zh;q=0.9'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'Connection: keep-alive'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'Content-Type: application/x-www-form-urlencoded; charset=UTF-8'</span><span class="token punctuation">,</span>
<span class="token comment">//            'Cookie: PHPSESSID=340abf1a618653fef13589101044e994; ZDEDebuggerPresent=php,phtml,php3; CNZZDATA1583751=cnzz_eid%3D572091052-1569547668-%26ntime%3D1569553068',</span>
<span class="token comment">//            'Host: localhost_mlf.com',</span>
            <span class="token single-quoted-string string">'Origin: '</span> <span class="token punctuation">.</span> <span class="token variable">$origin</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'Referer:'</span> <span class="token punctuation">.</span> <span class="token variable">$referer</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'X-Requested-With: XMLHttpRequest'</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// 初始化一个curl会话</span>
        <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$apiUrl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HTTPHEADER</span><span class="token punctuation">,</span> <span class="token variable">$header</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_CONNECTTIMEOUT</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_SSL_VERIFYPEER</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_POST</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置为POST方式</span>
        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_POSTFIELDS</span><span class="token punctuation">,</span> <span class="token function">http_build_query</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//数据传输</span>
        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_FOLLOWLOCATION</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//解决重定向问题</span>

        <span class="token comment">// 执行一个curl会话</span>
        <span class="token variable">$contents</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 返回一个保护当前会话最近一次错误的字符串</span>
        <span class="token variable">$error</span> <span class="token operator">=</span> <span class="token function">curl_error</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">echo</span> <span class="token single-quoted-string string">'Error: '</span> <span class="token punctuation">.</span> <span class="token variable">$error</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 关闭一个curl会话</span>
        <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$contents</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>注意http_build_query此参数是必须的，不然会出现 以下情况<br> 多了 这个 boundary=—————————-f924413ea122<br> <img src="https://images2.imgbox.com/f3/0e/AWQtgGvf_o.png" alt="在这里插入图片描述"><br> 包括了 boundary 分界符，会多出很多字节。<br> 官方的手册上是这样说的：<br> The full data to post in a HTTP “POST” operation. To post a file, prepend a filename with @ and use the full path. This can either be passed as a urlencoded string like ‘para1=val1¶2=val2&amp;…’ or as an array with the field name as key and field data as value. If value is an array, the Content-Type header will be set to multipart/form-data.<br> 使用数组提供 post 数据时，CURL 组件大概是为了兼容 @filename 这种上传文件的写法，默认把 content_type 设为了 multipart/form-data。虽然对于大多数服务器并没有影响，但是还是有少部分服务器不兼容。</p> 
<p><img src="https://images2.imgbox.com/e4/0b/7h8oMj1i_o.png" alt="在这里插入图片描述"></p> 
<p>作者是用 postman访问程序的，连接可以不用管，访问的是上述的方法<br> <img src="https://images2.imgbox.com/5e/bf/GY5rrVS2_o.png" alt="在这里插入图片描述"></p> 
<p>以下是关于curl的参数解析，作者认为下面的参数作为参考就好了，真正还是看浏览器的信息比较合适，直接搬过来成功率比较高。</p> 
<p>ip 地址是无法伪造的，原因 REMOTE_ADDR 此参数暂时无法被伪造，获取ip地址一般用此参数</p> 
<p>curl_setopt – 设置一个curl传输选项</p> 
<p>对于下面的这些option的可选参数，value应该被设置一个bool类型的值：</p> 
<pre><code class="prism language-php">选项	可选value值	备注
<span class="token constant">CURLOPT_AUTOREFERER</span>	 当根据Location<span class="token punctuation">:</span>重定向时，自动设置header中的Referer<span class="token punctuation">:</span>信息。	
<span class="token constant">CURLOPT_BINARYTRANSFER</span>	 在启用<span class="token constant">CURLOPT_RETURNTRANSFER</span>的时候，返回原生的（Raw）输出。	
<span class="token constant">CURLOPT_COOKIESESSION</span>	 启用时curl会仅仅传递一个session cookie，忽略其他的cookie，默认状况下cURL会将所有的cookie返回给服务端。session cookie是指那些用来判断服务器端的session是否有效而存在的cookie。	
<span class="token constant">CURLOPT_CRLF</span>	 启用时将Unix的换行符转换成回车换行符。	
<span class="token constant">CURLOPT_DNS_USE_GLOBAL_CACHE</span>	 启用时会启用一个全局的<span class="token constant">DNS</span>缓存，此项为线程安全的，并且默认启用。	
<span class="token constant">CURLOPT_FAILONERROR</span>	 显示<span class="token constant">HTTP</span>状态码，默认行为是忽略编号小于等于<span class="token number">400</span>的<span class="token constant">HTTP</span>信息。	
<span class="token constant">CURLOPT_FILETIME</span>	 启用时会尝试修改远程文档中的信息。结果信息会通过<span class="token function">curl_getinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>函数的<span class="token constant">CURLINFO_FILETIME</span>选项返回。 <span class="token function">curl_getinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>	
<span class="token constant">CURLOPT_FOLLOWLOCATION</span>	 启用时会将服务器服务器返回的<span class="token double-quoted-string string">"Location: "</span>放在header中递归的返回给服务器，使用<span class="token constant">CURLOPT_MAXREDIRS</span>可以限定递归返回的数量。	
<span class="token constant">CURLOPT_FORBID_REUSE</span>	 在完成交互以后强迫断开连接，不能重用。	
<span class="token constant">CURLOPT_FRESH_CONNECT</span>	 强制获取一个新的连接，替代缓存中的连接。	
<span class="token constant">CURLOPT_FTP_USE_EPRT</span>	 启用时当<span class="token constant">FTP</span>下载时，使用<span class="token constant">EPRT</span> <span class="token punctuation">(</span>或 <span class="token constant">LPRT</span><span class="token punctuation">)</span>命令。设置为<span class="token constant">FALSE</span>时禁用<span class="token constant">EPRT</span>和<span class="token constant">LPRT</span>，使用<span class="token constant">PORT</span>命令 only<span class="token punctuation">.</span>	
<span class="token constant">CURLOPT_FTP_USE_EPSV</span>	 启用时，在<span class="token constant">FTP</span>传输过程中回复到<span class="token constant">PASV</span>模式前首先尝试<span class="token constant">EPSV</span>命令。设置为<span class="token constant">FALSE</span>时禁用<span class="token constant">EPSV</span>命令。	
<span class="token constant">CURLOPT_FTPAPPEND</span>	 启用时追加写入文件而不是覆盖它。	
<span class="token constant">CURLOPT_FTPASCII</span>	<span class="token constant">CURLOPT_TRANSFERTEXT</span>的别名。	
<span class="token constant">CURLOPT_FTPLISTONLY</span>	 启用时只列出<span class="token constant">FTP</span>目录的名字。	
<span class="token constant">CURLOPT_HEADER</span>	 启用时会将头文件的信息作为数据流输出。	
<span class="token constant">CURLINFO_HEADER_OUT</span>	 启用时追踪句柄的请求字符串。	 从 <span class="token constant">PHP</span> <span class="token number">5.1</span><span class="token number">.3</span> 开始可用。<span class="token constant">CURLINFO_</span>前缀是故意的<span class="token punctuation">(</span>intentional<span class="token punctuation">)</span>。
<span class="token constant">CURLOPT_HTTPGET</span>	 启用时会设置<span class="token constant">HTTP</span>的method为<span class="token constant">GET</span>，因为<span class="token constant">GET</span>是默认是，所以只在被修改的情况下使用。	
<span class="token constant">CURLOPT_HTTPPROXYTUNNEL</span>	 启用时会通过<span class="token constant">HTTP</span>代理来传输。	
<span class="token constant">CURLOPT_MUTE</span>	 启用时将cURL函数中所有修改过的参数恢复默认值。	
<span class="token constant">CURLOPT_NETRC</span>	 在连接建立以后，访问<span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>netrc文件获取用户名和密码信息连接远程站点。	
<span class="token constant">CURLOPT_NOBODY</span>	 启用时将不对<span class="token constant">HTML</span>中的<span class="token constant">BODY</span>部分进行输出。	
<span class="token constant">CURLOPT_NOPROGRESS</span>	
启用时关闭curl传输的进度条，此项的默认设置为启用。
 
Note<span class="token punctuation">:</span>
<span class="token constant">PHP</span>自动地设置这个选项为<span class="token constant">TRUE</span>，这个选项仅仅应当在以调试为目的时被改变。
<span class="token constant">CURLOPT_NOSIGNAL</span>	 启用时忽略所有的curl传递给php进行的信号。在<span class="token constant">SAPI</span>多线程传输时此项被默认启用。	 cURL <span class="token number">7.10</span>时被加入。
<span class="token constant">CURLOPT_POST</span>	 启用时会发送一个常规的<span class="token constant">POST</span>请求，类型为：application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded，就像表单提交的一样。	
<span class="token constant">CURLOPT_PUT</span>	 启用时允许<span class="token constant">HTTP</span>发送文件，必须同时设置<span class="token constant">CURLOPT_INFILE</span>和<span class="token constant">CURLOPT_INFILESIZE</span>。	
<span class="token constant">CURLOPT_RETURNTRANSFER</span>	 将<span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span>获取的信息以文件流的形式返回，而不是直接输出。	
<span class="token constant">CURLOPT_SSL_VERIFYPEER</span>	 禁用后cURL将终止从服务端进行验证。使用<span class="token constant">CURLOPT_CAINFO</span>选项设置证书使用<span class="token constant">CURLOPT_CAPATH</span>选项设置证书目录 如果<span class="token function">CURLOPT_SSL_VERIFYPEER</span><span class="token punctuation">(</span>默认值为<span class="token number">2</span><span class="token punctuation">)</span>被启用，<span class="token constant">CURLOPT_SSL_VERIFYHOST</span>需要被设置成<span class="token constant">TRUE</span>否则设置为<span class="token constant">FALSE</span>。	 自cURL <span class="token number">7.10</span>开始默认为<span class="token constant">TRUE</span>。从cURL <span class="token number">7.10</span>开始默认绑定安装。
<span class="token constant">CURLOPT_TRANSFERTEXT</span>	 启用后对<span class="token constant">FTP</span>传输使用<span class="token constant">ASCII</span>模式。对于<span class="token constant">LDAP</span>，它检索纯文本信息而非<span class="token constant">HTML</span>。在Windows系统上，系统不会把<span class="token constant">STDOUT</span>设置成binary模式。	
<span class="token constant">CURLOPT_UNRESTRICTED_AUTH</span>	 在使用<span class="token constant">CURLOPT_FOLLOWLOCATION</span>产生的header中的多个locations中持续追加用户名和密码信息，即使域名已发生改变。	
<span class="token constant">CURLOPT_UPLOAD</span>	 启用后允许文件上传。	
<span class="token constant">CURLOPT_VERBOSE</span>	 启用时会汇报所有的信息，存放在<span class="token constant">STDERR</span>或指定的<span class="token constant">CURLOPT_STDERR</span>中。
</code></pre> 
<p>对于下面的这些option的可选参数，value应该被设置一个integer类型的值：</p> 
<pre><code class="prism language-php">选项	可选value值	备注
<span class="token constant">CURLOPT_BUFFERSIZE</span>	 每次获取的数据中读入缓存的大小，但是不保证这个值每次都会被填满。	 在cURL <span class="token number">7.10</span>中被加入。
<span class="token constant">CURLOPT_CLOSEPOLICY</span>	 不是<span class="token constant">CURLCLOSEPOLICY_LEAST_RECENTLY_USED</span>就是<span class="token constant">CURLCLOSEPOLICY_OLDEST</span>，还存在另外三个<span class="token constant">CURLCLOSEPOLICY_</span>，但是cURL暂时还不支持。	
<span class="token constant">CURLOPT_CONNECTTIMEOUT</span>	 在发起连接前等待的时间，如果设置为<span class="token number">0</span>，则无限等待。	
<span class="token constant">CURLOPT_CONNECTTIMEOUT_MS</span>	 尝试连接等待的时间，以毫秒为单位。如果设置为<span class="token number">0</span>，则无限等待。	 在cURL <span class="token number">7.16</span><span class="token number">.2</span>中被加入。从<span class="token constant">PHP</span> <span class="token number">5.2</span><span class="token number">.3</span>开始可用。
<span class="token constant">CURLOPT_DNS_CACHE_TIMEOUT</span>	 设置在内存中保存<span class="token constant">DNS</span>信息的时间，默认为<span class="token number">120</span>秒。	
<span class="token constant">CURLOPT_FTPSSLAUTH</span>	 <span class="token constant">FTP</span>验证方式：<span class="token constant">CURLFTPAUTH_SSL</span> <span class="token punctuation">(</span>首先尝试<span class="token constant">SSL</span><span class="token punctuation">)</span>，<span class="token constant">CURLFTPAUTH_TLS</span> <span class="token punctuation">(</span>首先尝试<span class="token constant">TLS</span><span class="token punctuation">)</span>或<span class="token constant">CURLFTPAUTH_DEFAULT</span> <span class="token punctuation">(</span>让cURL自动决定<span class="token punctuation">)</span>。	 在cURL <span class="token number">7.12</span><span class="token number">.2</span>中被加入。
<span class="token constant">CURLOPT_HTTP_VERSION</span>	<span class="token constant">CURL_HTTP_VERSION_NONE</span> <span class="token punctuation">(</span>默认值，让cURL自己判断使用哪个版本<span class="token punctuation">)</span>，<span class="token constant">CURL_HTTP_VERSION_1_0</span> <span class="token punctuation">(</span>强制使用 <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.0</span><span class="token punctuation">)</span>或<span class="token constant">CURL_HTTP_VERSION_1_1</span> <span class="token punctuation">(</span>强制使用 <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span><span class="token punctuation">)</span>。	
<span class="token constant">CURLOPT_HTTPAUTH</span>	
使用的<span class="token constant">HTTP</span>验证方法，可选的值有：<span class="token constant">CURLAUTH_BASIC</span>、<span class="token constant">CURLAUTH_DIGEST</span>、<span class="token constant">CURLAUTH_GSSNEGOTIATE</span>、<span class="token constant">CURLAUTH_NTLM</span>、<span class="token constant">CURLAUTH_ANY</span>和<span class="token constant">CURLAUTH_ANYSAFE</span>。
 
可以使用<span class="token operator">|</span>位域<span class="token punctuation">(</span>或<span class="token punctuation">)</span>操作符分隔多个值，cURL让服务器选择一个支持最好的值。
<span class="token constant">CURLAUTH_ANY</span>等价于<span class="token constant">CURLAUTH_BASIC</span> <span class="token operator">|</span> <span class="token constant">CURLAUTH_DIGEST</span> <span class="token operator">|</span> <span class="token constant">CURLAUTH_GSSNEGOTIATE</span> <span class="token operator">|</span> <span class="token constant">CURLAUTH_NTLM</span><span class="token punctuation">.</span>
 
<span class="token constant">CURLAUTH_ANYSAFE</span>等价于<span class="token constant">CURLAUTH_DIGEST</span> <span class="token operator">|</span> <span class="token constant">CURLAUTH_GSSNEGOTIATE</span> <span class="token operator">|</span> <span class="token constant">CURLAUTH_NTLM</span><span class="token punctuation">.</span>
 
<span class="token constant">CURLOPT_INFILESIZE</span>	 设定上传文件的大小限制，字节<span class="token punctuation">(</span>byte<span class="token punctuation">)</span>为单位。	
<span class="token constant">CURLOPT_LOW_SPEED_LIMIT</span>	 当传输速度小于<span class="token constant">CURLOPT_LOW_SPEED_LIMIT</span>时<span class="token punctuation">(</span>bytes<span class="token operator">/</span>sec<span class="token punctuation">)</span>，<span class="token constant">PHP</span>会根据<span class="token constant">CURLOPT_LOW_SPEED_TIME</span>来判断是否因太慢而取消传输。	
<span class="token constant">CURLOPT_LOW_SPEED_TIME</span>	 当传输速度小于<span class="token constant">CURLOPT_LOW_SPEED_LIMIT</span>时<span class="token punctuation">(</span>bytes<span class="token operator">/</span>sec<span class="token punctuation">)</span>，<span class="token constant">PHP</span>会根据<span class="token constant">CURLOPT_LOW_SPEED_TIME</span>来判断是否因太慢而取消传输。	
<span class="token constant">CURLOPT_MAXCONNECTS</span>	 允许的最大连接数量，超过是会通过<span class="token constant">CURLOPT_CLOSEPOLICY</span>决定应该停止哪些连接。	
<span class="token constant">CURLOPT_MAXREDIRS</span>	 指定最多的<span class="token constant">HTTP</span>重定向的数量，这个选项是和<span class="token constant">CURLOPT_FOLLOWLOCATION</span>一起使用的。	
<span class="token constant">CURLOPT_PORT</span>	 用来指定连接端口。（可选项）	
<span class="token constant">CURLOPT_PROTOCOLS</span>	
<span class="token constant">CURLPROTO_</span><span class="token operator">*</span>的位域指。如果被启用，位域值会限定libcurl在传输过程中有哪些可使用的协议。这将允许你在编译libcurl时支持众多协议，但是限制只是用它们中被允许使用的一个子集。默认libcurl将会使用全部它支持的协议。参见<span class="token constant">CURLOPT_REDIR_PROTOCOLS</span><span class="token punctuation">.</span>
 
可用的协议选项为：<span class="token constant">CURLPROTO_HTTP</span>、<span class="token constant">CURLPROTO_HTTPS</span>、<span class="token constant">CURLPROTO_FTP</span>、<span class="token constant">CURLPROTO_FTPS</span>、<span class="token constant">CURLPROTO_SCP</span>、<span class="token constant">CURLPROTO_SFTP</span>、<span class="token constant">CURLPROTO_TELNET</span>、<span class="token constant">CURLPROTO_LDAP</span>、<span class="token constant">CURLPROTO_LDAPS</span>、<span class="token constant">CURLPROTO_DICT</span>、<span class="token constant">CURLPROTO_FILE</span>、<span class="token constant">CURLPROTO_TFTP</span>、<span class="token constant">CURLPROTO_ALL</span>
 
在cURL <span class="token number">7.19</span><span class="token number">.4</span>中被加入。
<span class="token constant">CURLOPT_PROXYAUTH</span>	 <span class="token constant">HTTP</span>代理连接的验证方式。使用在<span class="token constant">CURLOPT_HTTPAUTH</span>中的位域标志来设置相应选项。对于代理验证只有<span class="token constant">CURLAUTH_BASIC</span>和<span class="token constant">CURLAUTH_NTLM</span>当前被支持。	 在cURL <span class="token number">7.10</span><span class="token number">.7</span>中被加入。
<span class="token constant">CURLOPT_PROXYPORT</span>	 代理服务器的端口。端口也可以在<span class="token constant">CURLOPT_PROXY</span>中进行设置。	
<span class="token constant">CURLOPT_PROXYTYPE</span>	 不是<span class="token constant">CURLPROXY_HTTP</span> <span class="token punctuation">(</span>默认值<span class="token punctuation">)</span> 就是<span class="token constant">CURLPROXY_SOCKS5</span>。	 在cURL <span class="token number">7.10</span>中被加入。
<span class="token constant">CURLOPT_REDIR_PROTOCOLS</span>	<span class="token constant">CURLPROTO_</span><span class="token operator">*</span>中的位域值。如果被启用，位域值将会限制传输线程在<span class="token constant">CURLOPT_FOLLOWLOCATION</span>开启时跟随某个重定向时可使用的协议。这将使你对重定向时限制传输线程使用被允许的协议子集默认libcurl将会允许除<span class="token constant">FILE</span>和<span class="token constant">SCP</span>之外的全部协议。这个和<span class="token number">7.19</span><span class="token number">.4</span>预发布版本种无条件地跟随所有支持的协议有一些不同。关于协议常量，请参照<span class="token constant">CURLOPT_PROTOCOLS</span>。	 在cURL <span class="token number">7.19</span><span class="token number">.4</span>中被加入。
<span class="token constant">CURLOPT_RESUME_FROM</span>	 在恢复传输时传递一个字节偏移量（用来断点续传）。	
<span class="token constant">CURLOPT_SSL_VERIFYHOST</span>	 <span class="token number">1</span> 检查服务器<span class="token constant">SSL</span>证书中是否存在一个公用名<span class="token punctuation">(</span>common name<span class="token punctuation">)</span>。译者注：公用名<span class="token punctuation">(</span>Common Name<span class="token punctuation">)</span>一般来讲就是填写你将要申请<span class="token constant">SSL</span>证书的域名 <span class="token punctuation">(</span>domain<span class="token punctuation">)</span>或子域名<span class="token punctuation">(</span>sub domain<span class="token punctuation">)</span>。<span class="token number">2</span> 检查公用名是否存在，并且是否与提供的主机名匹配。	
<span class="token constant">CURLOPT_SSLVERSION</span>	 使用的<span class="token constant">SSL</span>版本<span class="token punctuation">(</span><span class="token number">2</span> 或 <span class="token number">3</span><span class="token punctuation">)</span>。默认情况下<span class="token constant">PHP</span>会自己检测这个值，尽管有些情况下需要手动地进行设置。	
<span class="token constant">CURLOPT_TIMECONDITION</span>	 如果在<span class="token constant">CURLOPT_TIMEVALUE</span>指定的某个时间以后被编辑过，则使用<span class="token constant">CURL_TIMECOND_IFMODSINCE</span>返回页面，如果没有被修改过，并且<span class="token constant">CURLOPT_HEADER</span>为<span class="token boolean">true</span>，则返回一个<span class="token double-quoted-string string">"304 Not Modified"</span>的header， <span class="token constant">CURLOPT_HEADER</span>为<span class="token boolean">false</span>，则使用<span class="token constant">CURL_TIMECOND_IFUNMODSINCE</span>，默认值为<span class="token constant">CURL_TIMECOND_IFUNMODSINCE</span>。	
<span class="token constant">CURLOPT_TIMEOUT</span>	 设置cURL允许执行的最长秒数。	
<span class="token constant">CURLOPT_TIMEOUT_MS</span>	 设置cURL允许执行的最长毫秒数。	 在cURL <span class="token number">7.16</span><span class="token number">.2</span>中被加入。从<span class="token constant">PHP</span> <span class="token number">5.2</span><span class="token number">.3</span>起可使用。
<span class="token constant">CURLOPT_TIMEVALUE</span>	 设置一个<span class="token constant">CURLOPT_TIMECONDITION</span>使用的时间戳，在默认状态下使用的是<span class="token constant">CURL_TIMECOND_IFMODSINCE</span>。
</code></pre> 
<p>对于下面的这些option的可选参数，value应该被设置一个string类型的值：</p> 
<pre><code class="prism language-php">选项	可选value值	备注
<span class="token constant">CURLOPT_CAINFO</span>	 一个保存着<span class="token number">1</span>个或多个用来让服务端验证的证书的文件名。这个参数仅仅在和<span class="token constant">CURLOPT_SSL_VERIFYPEER</span>一起使用时才有意义。 <span class="token punctuation">.</span>	
<span class="token constant">CURLOPT_CAPATH</span>	 一个保存着多个<span class="token constant">CA</span>证书的目录。这个选项是和<span class="token constant">CURLOPT_SSL_VERIFYPEER</span>一起使用的。	
<span class="token constant">CURLOPT_COOKIE</span>	 设定<span class="token constant">HTTP</span>请求中<span class="token double-quoted-string string">"Cookie: "</span>部分的内容。多个cookie用分号分隔，分号后带一个空格<span class="token punctuation">(</span>例如， <span class="token double-quoted-string string">"fruit=apple; colour=red"</span><span class="token punctuation">)</span>。	
<span class="token constant">CURLOPT_COOKIEFILE</span>	 包含cookie数据的文件名，cookie文件的格式可以是Netscape格式，或者只是纯<span class="token constant">HTTP</span>头部信息存入文件。	
<span class="token constant">CURLOPT_COOKIEJAR</span>	 连接结束后保存cookie信息的文件。	
<span class="token constant">CURLOPT_CUSTOMREQUEST</span>	
使用一个自定义的请求信息来代替<span class="token double-quoted-string string">"GET"</span>或<span class="token double-quoted-string string">"HEAD"</span>作为<span class="token constant">HTTP</span>请求。这对于执行<span class="token double-quoted-string string">"DELETE"</span> 或者其他更隐蔽的<span class="token constant">HTTP</span>请求。有效值如<span class="token double-quoted-string string">"GET"</span>，<span class="token double-quoted-string string">"POST"</span>，<span class="token double-quoted-string string">"CONNECT"</span>等等。也就是说，不要在这里输入整个<span class="token constant">HTTP</span>请求。例如输入<span class="token double-quoted-string string">"GET /index.html HTTP/1.0\r\n\r\n"</span>是不正确的。
Note<span class="token punctuation">:</span>
在确定服务器支持这个自定义请求的方法前不要使用。
<span class="token constant">CURLOPT_EGDSOCKET</span>	 类似<span class="token constant">CURLOPT_RANDOM_FILE</span>，除了一个Entropy Gathering Daemon套接字。	
<span class="token constant">CURLOPT_ENCODING</span>	 <span class="token constant">HTTP</span>请求头中<span class="token double-quoted-string string">"Accept-Encoding: "</span>的值。支持的编码有<span class="token double-quoted-string string">"identity"</span>，<span class="token double-quoted-string string">"deflate"</span>和<span class="token double-quoted-string string">"gzip"</span>。如果为空字符串<span class="token double-quoted-string string">""</span>，请求头会发送所有支持的编码类型。	 在cURL <span class="token number">7.10</span>中被加入。
<span class="token constant">CURLOPT_FTPPORT</span>	 这个值将被用来获取供<span class="token constant">FTP</span><span class="token double-quoted-string string">"POST"</span>指令所需要的<span class="token constant">IP</span>地址。<span class="token double-quoted-string string">"POST"</span>指令告诉远程服务器连接到我们指定的<span class="token constant">IP</span>地址。这个字符串可以是纯文本的<span class="token constant">IP</span>地址、主机名、一个网络接口名（<span class="token constant">UNIX</span>下）或者只是一个<span class="token single-quoted-string string">'-'</span>来使用默认的<span class="token constant">IP</span>地址。	
<span class="token constant">CURLOPT_INTERFACE</span>	 网络发送接口名，可以是一个接口名、<span class="token constant">IP</span>地址或者是一个主机名。	
<span class="token constant">CURLOPT_KRB4LEVEL</span>	 <span class="token constant">KRB4</span> <span class="token punctuation">(</span>Kerberos <span class="token number">4</span><span class="token punctuation">)</span> 安全级别。下面的任何值都是有效的<span class="token punctuation">(</span>从低到高的顺序<span class="token punctuation">)</span>：<span class="token double-quoted-string string">"clear"</span>、<span class="token double-quoted-string string">"safe"</span>、<span class="token double-quoted-string string">"confidential"</span>、<span class="token double-quoted-string string">"private"</span><span class="token punctuation">.</span>。如果字符串和这些都不匹配，将使用<span class="token double-quoted-string string">"private"</span>。这个选项设置为<span class="token keyword">NULL</span>时将禁用<span class="token constant">KRB4</span> 安全认证。目前<span class="token constant">KRB4</span> 安全认证只能用于<span class="token constant">FTP</span>传输。	
<span class="token constant">CURLOPT_POSTFIELDS</span>	 全部数据使用<span class="token constant">HTTP</span>协议中的<span class="token double-quoted-string string">"POST"</span>操作来发送。要发送文件，在文件名前面加上@前缀并使用完整路径。这个参数可以通过urlencoded后的字符串类似<span class="token single-quoted-string string">'para1=val1¶2=val2&amp;...'</span>或使用一个以字段名为键值，字段数据为值的数组。如果value是一个数组，Content<span class="token operator">-</span>Type头将会被设置成multipart<span class="token operator">/</span>form<span class="token operator">-</span>data。	
<span class="token constant">CURLOPT_PROXY</span>	 <span class="token constant">HTTP</span>代理通道。	
<span class="token constant">CURLOPT_PROXYUSERPWD</span>	 一个用来连接到代理的<span class="token double-quoted-string string">"[username]:[password]"</span>格式的字符串。	
<span class="token constant">CURLOPT_RANDOM_FILE</span>	 一个被用来生成<span class="token constant">SSL</span>随机数种子的文件名。	
<span class="token constant">CURLOPT_RANGE</span>	 以<span class="token double-quoted-string string">"X-Y"</span>的形式，其中X和Y都是可选项获取数据的范围，以字节计。<span class="token constant">HTTP</span>传输线程也支持几个这样的重复项中间用逗号分隔如<span class="token double-quoted-string string">"X-Y,N-M"</span>。	
<span class="token constant">CURLOPT_REFERER</span>	 在<span class="token constant">HTTP</span>请求头中<span class="token double-quoted-string string">"Referer: "</span>的内容。	
<span class="token constant">CURLOPT_SSL_CIPHER_LIST</span>	 一个<span class="token constant">SSL</span>的加密算法列表。例如<span class="token constant">RC4</span><span class="token operator">-</span><span class="token constant">SHA</span>和TLSv1都是可用的加密列表。	
<span class="token constant">CURLOPT_SSLCERT</span>	 一个包含<span class="token constant">PEM</span>格式证书的文件名。	
<span class="token constant">CURLOPT_SSLCERTPASSWD</span>	 使用<span class="token constant">CURLOPT_SSLCERT</span>证书需要的密码。	
<span class="token constant">CURLOPT_SSLCERTTYPE</span>	 证书的类型。支持的格式有<span class="token double-quoted-string string">"PEM"</span> <span class="token punctuation">(</span>默认值<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"DER"</span>和<span class="token double-quoted-string string">"ENG"</span>。	 在cURL <span class="token number">7.9</span><span class="token number">.3</span>中被加入。
<span class="token constant">CURLOPT_SSLENGINE</span>	 用来在<span class="token constant">CURLOPT_SSLKEY</span>中指定的<span class="token constant">SSL</span>私钥的加密引擎变量。	
<span class="token constant">CURLOPT_SSLENGINE_DEFAULT</span>	 用来做非对称加密操作的变量。	
<span class="token constant">CURLOPT_SSLKEY</span>	 包含<span class="token constant">SSL</span>私钥的文件名。	
<span class="token constant">CURLOPT_SSLKEYPASSWD</span>	
在<span class="token constant">CURLOPT_SSLKEY</span>中指定了的<span class="token constant">SSL</span>私钥的密码。
Note<span class="token punctuation">:</span>
由于这个选项包含了敏感的密码信息，记得保证这个<span class="token constant">PHP</span>脚本的安全。
<span class="token constant">CURLOPT_SSLKEYTYPE</span>	<span class="token constant">CURLOPT_SSLKEY</span>中规定的私钥的加密类型，支持的密钥类型为<span class="token double-quoted-string string">"PEM"</span><span class="token punctuation">(</span>默认值<span class="token punctuation">)</span>、<span class="token double-quoted-string string">"DER"</span>和<span class="token double-quoted-string string">"ENG"</span>。	
<span class="token constant">CURLOPT_URL</span>	 需要获取的<span class="token constant">URL</span>地址，也可以在<span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>函数中设置。	
<span class="token constant">CURLOPT_USERAGENT</span>	 在<span class="token constant">HTTP</span>请求中包含一个<span class="token double-quoted-string string">"User-Agent: "</span>头的字符串。	
<span class="token constant">CURLOPT_USERPWD</span>	 传递一个连接中需要的用户名和密码，格式为：<span class="token double-quoted-string string">"[username]:[password]"</span>。
</code></pre> 
<p>对于下面的这些option的可选参数，value应该被设置一个数组：</p> 
<pre><code class="prism language-php">选项	可选value值	备注
<span class="token constant">CURLOPT_HTTP200ALIASES</span>	 <span class="token number">200</span>响应码数组，数组中的响应吗被认为是正确的响应，否则被认为是错误的。	 在cURL <span class="token number">7.10</span><span class="token number">.3</span>中被加入。
<span class="token constant">CURLOPT_HTTPHEADER</span>	 一个用来设置<span class="token constant">HTTP</span>头字段的数组。使用如下的形式的数组进行设置： <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Content-type: text/plain'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'Content-length: 100'</span><span class="token punctuation">)</span>	
<span class="token constant">CURLOPT_POSTQUOTE</span>	 在<span class="token constant">FTP</span>请求执行完成后，在服务器上执行的一组<span class="token constant">FTP</span>命令。	
<span class="token constant">CURLOPT_QUOTE</span>	 一组先于<span class="token constant">FTP</span>请求的在服务器上执行的<span class="token constant">FTP</span>命令。
</code></pre> 
<p>对于下面的这些option的可选参数，value应该被设置一个流资源：</p> 
<pre><code class="prism language-php">选项	可选value值
<span class="token constant">CURLOPT_FILE</span>	 设置输出文件的位置，值是一个资源类型，默认为<span class="token constant">STDOUT</span> <span class="token punctuation">(</span>浏览器<span class="token punctuation">)</span>。
<span class="token constant">CURLOPT_INFILE</span>	 在上传文件的时候需要读取的文件地址，值是一个资源类型。
<span class="token constant">CURLOPT_STDERR</span>	 设置一个错误输出地址，值是一个资源类型，取代默认的<span class="token constant">STDERR</span>。
<span class="token constant">CURLOPT_WRITEHEADER</span>	 设置header部分内容的写入的文件地址，值是一个资源类型。
</code></pre> 
<p>对于下面的这些option的可选参数，value应该被设置为一个回调函数名：</p> 
<pre><code class="prism language-php">选项	可选value值
<span class="token constant">CURLOPT_HEADERFUNCTION</span>	 设置一个回调函数，这个函数有两个参数，第一个是cURL的资源句柄，第二个是输出的header数据。header数据的输出必须依赖这个函数，返回已写入的数据大小。
<span class="token constant">CURLOPT_PASSWDFUNCTION</span>	 设置一个回调函数，有三个参数，第一个是cURL的资源句柄，第二个是一个密码提示符，第三个参数是密码长度允许的最大值。返回密码的值。
<span class="token constant">CURLOPT_PROGRESSFUNCTION</span>	 设置一个回调函数，有三个参数，第一个是cURL的资源句柄，第二个是一个文件描述符资源，第三个是长度。返回包含的数据。
<span class="token constant">CURLOPT_READFUNCTION</span>	 回调函数名。该函数应接受三个参数。第一个是 cURL resource；第二个是通过选项 <span class="token constant">CURLOPT_INFILE</span> 传给 cURL 的 stream resource；第三个参数是最大可以读取的数据的数量。回 调函数必须返回一个字符串，长度小于或等于请求的数据量（第三个参数）。一般从传入的 stream resource 读取。返回空字符串作为 <span class="token constant">EOF</span>（文件结束） 信号。
<span class="token constant">CURLOPT_WRITEFUNCTION</span>	 回调函数名。该函数应接受两个参数。第一个是 cURL resource；第二个是要写入的数据字符串。数 据必须在函数中被保存。函数必须返回准确的传入的要写入数据的字节数，否则传输会被一个错误所中 断。
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bd6e0156e9eb174464d6c6a2f1e09e10/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">项目经理的商务指南系列之二：认识责任（敏捷开发，专家与杂家）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d711b55165b29776dc8996509be4c9f8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">scss</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>