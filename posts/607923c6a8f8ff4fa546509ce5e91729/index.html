<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#WinForm连接查询数据库sql - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#WinForm连接查询数据库sql" />
<meta property="og:description" content="目录
一、建立WinForm文件
二、开始设计窗体的板面
1.添加控件
2.修改控件属性
三、连接数据库sql
1.先点击工具栏，然后选择连接到数据库
2.选择sql server
3.开始选择想要的数据库
4.双击Button控件，进出button的C#编辑的地方
四、用C#查询数据库数据
1.加一个命名空间
2.在button控件代码里写查询数据库语句
五、总结
一、建立WinForm文件 建立一个你想要的项目，选择Windows桌面的Windows窗体应用（.NET Framework）框架可以选择.NET Framework 4.7.2，版本较低可以选择.NET Framework 4.7.1
二、开始设计窗体的板面 1.添加控件 添加两个控件button和DataGridView
2.修改控件属性 Button属性：name:btnInquiry(驼峰命名法，前面是控件名的缩写，后面是控件要执行的内容),BackColor：可以选择一个你自己想要的控件颜色,text:查询，Anchor属性为Top, Left, Right
DataGridView属性：更改Anchor属性为Top, Left, Right让它跟随主窗体大小变大变小
三、连接数据库sql 1.先点击工具栏，然后选择连接到数据库 2.选择sql server 3.开始选择想要的数据库 4.双击Button控件，进出button的点击事件中编写C# 四、用C#查询数据库数据 1.加一个命名空间 要在命名空间上加入下面一串代码，免得不支持sql
using System.Data.SqlClient; 2.在button控件代码里写查询数据库语句 查询：
private void btnInquiry_Click(object sender, EventArgs e) { //连接数据库 //server：自己电脑服务器名 //user id:SQL server 验证后的用户名 //password:SQL server 验证后的密码 //database:所要用的数据库 string conStr = &#34;server=不想写作业;user id=sa;password=1256;database=student&#34;; SqlConnection con = new SqlConnection(conStr); //打开数据库 con." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/607923c6a8f8ff4fa546509ce5e91729/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-07T16:21:46+08:00" />
<meta property="article:modified_time" content="2023-12-07T16:21:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#WinForm连接查询数据库sql</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p id="main-toc"><strong>目录</strong></p> 
 <p id="%E4%B8%80%E3%80%81%E5%BB%BA%E7%AB%8BWinForm%E6%96%87%E4%BB%B6-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E5%BB%BA%E7%AB%8BWinForm%E6%96%87%E4%BB%B6" rel="nofollow">一、建立WinForm文件</a></p> 
 <p id="%E4%BA%8C%E3%80%81%E5%BC%80%E5%A7%8B%E8%AE%BE%E8%AE%A1%E7%AA%97%E4%BD%93%E7%9A%84%E6%9D%BF%E9%9D%A2-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E5%BC%80%E5%A7%8B%E8%AE%BE%E8%AE%A1%E7%AA%97%E4%BD%93%E7%9A%84%E6%9D%BF%E9%9D%A2" rel="nofollow">二、开始设计窗体的板面</a></p> 
 <p id="1.%E6%B7%BB%E5%8A%A0%E6%8E%A7%E4%BB%B6-toc" style="margin-left:40px;"><a href="#1.%E6%B7%BB%E5%8A%A0%E6%8E%A7%E4%BB%B6" rel="nofollow">1.添加控件</a></p> 
 <p id="2.%E4%BF%AE%E6%94%B9%E6%8E%A7%E4%BB%B6%E5%B1%9E%E6%80%A7-toc" style="margin-left:40px;"><a href="#2.%E4%BF%AE%E6%94%B9%E6%8E%A7%E4%BB%B6%E5%B1%9E%E6%80%A7" rel="nofollow">2.修改控件属性</a></p> 
 <p id="%E4%B8%89%E3%80%81%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93sql-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93sql" rel="nofollow">三、连接数据库sql</a></p> 
 <p id="1.%E5%85%88%E7%82%B9%E5%87%BB%E5%B7%A5%E5%85%B7%E6%A0%8F%EF%BC%8C%E7%84%B6%E5%90%8E%E9%80%89%E6%8B%A9%E8%BF%9E%E6%8E%A5%E5%88%B0%E6%95%B0%E6%8D%AE%E5%BA%93-toc" style="margin-left:80px;"><a href="#1.%E5%85%88%E7%82%B9%E5%87%BB%E5%B7%A5%E5%85%B7%E6%A0%8F%EF%BC%8C%E7%84%B6%E5%90%8E%E9%80%89%E6%8B%A9%E8%BF%9E%E6%8E%A5%E5%88%B0%E6%95%B0%E6%8D%AE%E5%BA%93" rel="nofollow">1.先点击工具栏，然后选择连接到数据库</a></p> 
 <p id="2.%E9%80%89%E6%8B%A9sql%20server-toc" style="margin-left:80px;"><a href="#2.%E9%80%89%E6%8B%A9sql%20server" rel="nofollow">2.选择sql server</a></p> 
 <p id="3.%E5%BC%80%E5%A7%8B%E9%80%89%E6%8B%A9%E6%83%B3%E8%A6%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93-toc" style="margin-left:80px;"><a href="#3.%E5%BC%80%E5%A7%8B%E9%80%89%E6%8B%A9%E6%83%B3%E8%A6%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93" rel="nofollow">3.开始选择想要的数据库</a></p> 
 <p id="4.%E5%8F%8C%E5%87%BBButton%E6%8E%A7%E4%BB%B6%EF%BC%8C%E8%BF%9B%E5%87%BAbutton%E7%9A%84C%23%E7%BC%96%E8%BE%91%E7%9A%84%E5%9C%B0%E6%96%B9-toc" style="margin-left:80px;"><a href="#4.%E5%8F%8C%E5%87%BBButton%E6%8E%A7%E4%BB%B6%EF%BC%8C%E8%BF%9B%E5%87%BAbutton%E7%9A%84C%23%E7%BC%96%E8%BE%91%E7%9A%84%E5%9C%B0%E6%96%B9" rel="nofollow">4.双击Button控件，进出button的C#编辑的地方</a></p> 
 <p id="%E5%9B%9B%E3%80%81%E7%94%A8C%23%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%B0%E6%8D%AE-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81%E7%94%A8C%23%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%B0%E6%8D%AE" rel="nofollow">四、用C#查询数据库数据</a></p> 
 <p id="1.%E5%8A%A0%E4%B8%80%E4%B8%AA%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-toc" style="margin-left:80px;"><a href="#1.%E5%8A%A0%E4%B8%80%E4%B8%AA%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4" rel="nofollow">1.加一个命名空间</a></p> 
 <p id="2.%E5%9C%A8button%E6%8E%A7%E4%BB%B6%E4%BB%A3%E7%A0%81%E9%87%8C%E5%86%99%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E5%8F%A5-toc" style="margin-left:80px;"><a href="#2.%E5%9C%A8button%E6%8E%A7%E4%BB%B6%E4%BB%A3%E7%A0%81%E9%87%8C%E5%86%99%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E5%8F%A5" rel="nofollow">2.在button控件代码里写查询数据库语句</a></p> 
 <p id="%E4%BA%94%E3%80%81%E6%80%BB%E7%BB%93-toc" style="margin-left:0px;"><a href="#%E4%BA%94%E3%80%81%E6%80%BB%E7%BB%93" rel="nofollow">五、总结</a></p> 
 <hr id="hr-toc"> 
 <p></p> 
</blockquote> 
<h2 id="%E4%B8%80%E3%80%81%E5%BB%BA%E7%AB%8BWinForm%E6%96%87%E4%BB%B6"><br> 一、建立WinForm文件</h2> 
<p>建立一个你想要的项目，选择Windows桌面的<span style="color:#be191c;">Windows窗体应用（.NET Framework）</span>框架可以选择<span style="color:#be191c;">.NET Framework 4.7.2</span>，版本较低可以选择<span style="color:#be191c;">.NET Framework 4.7.1</span></p> 
<h2 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" height="1200" src="https://images2.imgbox.com/03/62/p4ohPdZR_o.png" width="1200"></h2> 
<h2 id="%E4%BA%8C%E3%80%81%E5%BC%80%E5%A7%8B%E8%AE%BE%E8%AE%A1%E7%AA%97%E4%BD%93%E7%9A%84%E6%9D%BF%E9%9D%A2"><a id="_19"></a>二、开始设计窗体的板面</h2> 
<h3 id="1.%E6%B7%BB%E5%8A%A0%E6%8E%A7%E4%BB%B6"><a id="1_20"></a>1.添加控件</h3> 
<p>添加两个控件button和DataGridView</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/03/be/95JThFLZ_o.png"><code class="language-c"> </code></p> 
<h3 id="2.%E4%BF%AE%E6%94%B9%E6%8E%A7%E4%BB%B6%E5%B1%9E%E6%80%A7"><a id="2_34"></a>2.修改控件属性<code class="language-c"> </code></h3> 
<p><span style="color:#be191c;">Button</span>属性：name:btnInquiry(驼峰命名法，前面是控件名的缩写，后面是控件要执行的内容),BackColor：可以选择一个你自己想要的控件颜色,text:查询，Anchor属性为Top, Left, Right</p> 
<p><span style="color:#be191c;">DataGridView</span>属性：更改Anchor属性为Top, Left, Right让它跟随主窗体大小变大变小</p> 
<p><img alt="" height="187" src="https://images2.imgbox.com/4f/2a/TMrMMwfM_o.png" width="501"></p> 
<hr> 
<h2 id="%E4%B8%89%E3%80%81%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93sql"><a id="_45"></a>三、连接数据库sql</h2> 
<h4 id="1.%E5%85%88%E7%82%B9%E5%87%BB%E5%B7%A5%E5%85%B7%E6%A0%8F%EF%BC%8C%E7%84%B6%E5%90%8E%E9%80%89%E6%8B%A9%E8%BF%9E%E6%8E%A5%E5%88%B0%E6%95%B0%E6%8D%AE%E5%BA%93">1.先点击工具栏，然后选择连接到数据库</h4> 
<p><img alt="" height="281" src="https://images2.imgbox.com/92/2c/Wrymj3nE_o.png" width="906"></p> 
<h4 id="2.%E9%80%89%E6%8B%A9sql%20server">2.选择sql server</h4> 
<p><img alt="" height="401" src="https://images2.imgbox.com/6c/e3/uzgWWvwY_o.png" width="1200"></p> 
<h4 id="3.%E5%BC%80%E5%A7%8B%E9%80%89%E6%8B%A9%E6%83%B3%E8%A6%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93">3.开始选择想要的数据库</h4> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/19/bb/WCBHqP7d_o.png" width="1102"></p> 
<h5></h5> 
<h4 id="4.%E5%8F%8C%E5%87%BBButton%E6%8E%A7%E4%BB%B6%EF%BC%8C%E8%BF%9B%E5%87%BAbutton%E7%9A%84C%23%E7%BC%96%E8%BE%91%E7%9A%84%E5%9C%B0%E6%96%B9">4.双击<span style="color:#be191c;">Button</span><span style="color:#0d0016;">控件，进出button的点击事件中编写C#</span></h4> 
<p><img alt="" height="591" src="https://images2.imgbox.com/cb/af/E4b3TUmL_o.png" width="1200"></p> 
<h2 id="%E5%9B%9B%E3%80%81%E7%94%A8C%23%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%B0%E6%8D%AE">四、用C#查询数据库数据</h2> 
<h4 id="1.%E5%8A%A0%E4%B8%80%E4%B8%AA%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4">1.加一个命名空间</h4> 
<p>要在命名空间上加入下面一串代码，免得不支持sql</p> 
<pre><code>using System.Data.SqlClient;</code></pre> 
<h4 id="2.%E5%9C%A8button%E6%8E%A7%E4%BB%B6%E4%BB%A3%E7%A0%81%E9%87%8C%E5%86%99%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E5%8F%A5">2.在button控件代码里写查询数据库语句</h4> 
<p>查询：</p> 
<pre><code class="language-cs"> private void btnInquiry_Click(object sender, EventArgs e)
        {
            //连接数据库
            //server：自己电脑服务器名
            //user id:SQL server 验证后的用户名
            //password:SQL server 验证后的密码
            //database:所要用的数据库
            string conStr = "server=不想写作业;user id=sa;password=1256;database=student";
            SqlConnection con = new SqlConnection(conStr);
            //打开数据库
            con.Open();
            //查询sql语句
            string sql = "select *from Student";
            //创建SqlDataAdapter对象，并将查询语句和连接对象并联
            SqlDataAdapter da = new SqlDataAdapter(sql, con);
            //创建DataTable对象，用于存储数据结果
            DataTable ds = new DataTable();
            //填充数据集
            da.Fill(ds);
            //关闭数据库
            con.Close();
            //把储存的数据结果绑定到dataGridView表格中
            dataGridView1.DataSource = ds;
        }</code></pre> 
<p>然后就可以把所有数据都给查询出来了，这是个简单的查询</p> 
<p>添加数据：</p> 
<pre><code class="language-cs">            //1、创建链接
            SqlConnection conn = new 
            SqlConnection("server=.;database=studentmanage;uid=sa;pwd=123456;");
            //打开
            conn.Open();
            //创建命令
            SqlCommand cmd = new SqlCommand("select * from department  where deptname like 
           '%"+textBox2.Text+"%'",conn);
            //执行命令 
            //object obj = cmd.ExecuteScalar();
            //textBox1.Text = obj.ToString();
            SqlDataReader sdr=cmd.ExecuteReader();
            while (sdr.Read())
            {
                txtDataView.AppendText(sdr["id"] + "|");
                txtDataView.AppendText(sdr["deptname"] + "|");
                txtDataView.AppendText(sdr["parentid"] + "|");
                txtDataView.AppendText(sdr["testname"] + "|");
                txtDataView.AppendText("\r\n");
            }
            conn.Close();</code></pre> 
<p>txtDataView.AppendText(sdr["id"] + "|");可以根据自己的需要来添加字段，\r\n是换行，|是输入自己的内容的地方，还有就是ExecuteNonQuery()方法是实现增删查的</p> 
<p>以上两种方法在button里写，是比较简单的查询和添加，更为复杂的还有comboBox控件下拉查询</p> 
<figure class="image"> 
 <img alt="" height="892" src="https://images2.imgbox.com/36/27/Y2by9xKP_o.png" width="1200"> 
 <figcaption>
   用语句查询后的数据库 
 </figcaption> 
</figure> 
<p>comboBox控件下拉查询：（这里要在comboBox控件里面写）</p> 
<pre><code class="language-cs">
               //先连接数据库，和上面步骤一样
               string sql = "select * from student"; //查询数据所有信息
 2             DataTable dt = SqlHelper.DataTable(sql);
 3             cmbName.DataSource = dt; //下拉框数据源为dt
 4             cmbName.DisplayMember = "RoleName";//显示成员
 5             cmbName.ValueMember = "RoleID"; //值成员(类似与索引)</code></pre> 
<p>然后赋值list.Add(new DictionaryEntry("stuname", "学生姓名"));stuname是数据库的字段，学生姓名是给它的命名</p> 
<pre><code class="language-cs">            comboBox1.Items.Add(new { key = "key", value = "value" });
            ArrayList list = new ArrayList();
            list.Add(new DictionaryEntry("ID", "ID"));
            list.Add(new DictionaryEntry("stuname", "学生姓名"));
            list.Add(new DictionaryEntry("sex", "性别"));
            list.Add(new DictionaryEntry("age", "年龄"));
            comboBox1.DataSource = list;
            comboBox1.DisplayMember = "Value";//显示出来的。Text
            comboBox1.ValueMember = "Key";// value值。</code></pre> 
<p>如果还想要更好的在<span style="color:#0d0016;">DataGridView中显示可以让DataGridView连接数据库，在编辑列然后让每个字段给它们赋值</span></p> 
<p><img alt="" height="108" src="https://images2.imgbox.com/05/23/N6ZejrFW_o.png" width="1200"></p> 
<p>然后再<span style="color:#0d0016;">DataGridView连接自己所需要的数据库</span></p> 
<p><img alt="" height="922" src="https://images2.imgbox.com/8b/e4/D43B1rDZ_o.png" width="1065"></p> 
<p>在dataGridView中写语句给每个字段赋值</p> 
<pre><code class="language-cs">
        private void dataGridView1_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            int rowindex = dataGridView1.CurrentCell.RowIndex;
            int id = int.Parse(dataGridView1.Rows[rowindex].Cells["col_id"].Value.ToString());
            string deptname = dataGridView1.Rows[rowindex].Cells["col_dept_name"].Value.ToString();
            int pid = int.Parse(dataGridView1.Rows[rowindex].Cells["col_pid"].Value.ToString());
            txtId.Text = id.ToString();
            txtDeptName.Text = deptname;
            cboParent.SelectedValue = pid;
        }</code></pre> 
<h2 id="%E4%BA%94%E3%80%81%E6%80%BB%E7%BB%93">五、总结</h2> 
<p>总体来说C#WinForm连接查询数据库sql还相对比较简单的，想要达到美观的效果还需要进一步的学习，通过语句可以查询到自己想要的内容，查询语句和sql语句相关</p> 
<p>还有就是C#WinForm连接查询数据库sql运用的也比较广泛，比如：图书馆管理系统，学生管理系统，汽车管理系统，商店管理系统等，在一定程度上方便了大家，减轻了大家的工作压力。</p> 
<p>使用C#WinForm连接查询数据库sql有什么好处呢？好处有很多，他可以收集强大的数据库，然后再让我们更简便的，更清楚的知道数据，在复杂的数据也会变得简便起来</p> 
<p>C#winform是个巨大的工程，学习也是很漫长，也会很痛苦，但是只要你理解了，也会变得很简单，很有趣</p> 
<p></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/805080eb6387f5c093344171aa605a3c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">React Native 环境搭建----Andriod端</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8e33f23ca06a5f9d5dedae7536460b70/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【STM32单片机】简易电子琴设计</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>