<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>NetData 入门 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="NetData 入门" />
<meta property="og:description" content="NetData 入门 Y_Wolf（2020.05.06）
文章目录 NetData 入门一、项目环境二、NetData简介三、NetData安装方法一方法二 四、NetData的基本操作五、卸载NetData五、NetData的相关配置文件六、添加第三方扩展插件（NVIDIA-SMI）在这里插入图片描述七、多设备监控方法一方法二节点服务器 主服务器 八、报警器九、将监控数据存入后端十、 创建自定义监控界面 一、项目环境 系统：Ubuntu 18.04.3 LTS官方说明文档：https://learn.netdata.cloud/docs/agent 二、NetData简介 ​ NetData 是一个用于系统和应用的分布式实时性能和健康监控工具。它提供了对系统中实时发生的所有事情的全面检测。你可以在高度互动的 Web 仪表板中查看结果。使用 Netdata，你可以清楚地了解现在发生的事情，以及之前系统和应用中发生的事情。你无需成为专家即可在 Linux 系统中部署此工具。NetData 开箱即用，零配置、零依赖。只需安装它然后坐等，之后 NetData 将负责其余部分。
三、NetData安装 方法一 Netdata最简单的一种安装方式就是直接使用官方的脚本进行一键安装
bash &lt;(curl -Ss https://my-netdata.io/kickstart-static64.sh) # Ubuntu的包管理器不确定有没有 sudo apt-get install netdata 当出现如下信息后，就代表安装成功了 ```bash ------------------------------------------------------------------------------- OK. NetData is installed and it is running (listening to *:19999). ------------------------------------------------------------------------------- INFO: Command line options changed. -pidfile, -nd and -ch are deprecated. If you use custom startup scripts, please run netdata -h to see the corresponding options and update your scripts." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/d99e3c6f6a47d4f5d89cd91e460de77b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-31T15:00:18+08:00" />
<meta property="article:modified_time" content="2023-05-31T15:00:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">NetData 入门</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="NetData__0"></a>NetData 入门</h2> 
<blockquote> 
 <p>Y_Wolf（2020.05.06）</p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#NetData__0" rel="nofollow">NetData 入门</a></li><li><ul><li><a href="#_5" rel="nofollow">一、项目环境</a></li><li><a href="#NetData_12" rel="nofollow">二、NetData简介</a></li><li><a href="#NetData_18" rel="nofollow">三、NetData安装</a></li><li><ul><li><a href="#_20" rel="nofollow">方法一</a></li><li><a href="#_57" rel="nofollow">方法二</a></li></ul> 
   </li><li><a href="#NetData_75" rel="nofollow">四、NetData的基本操作</a></li><li><a href="#NetData_93" rel="nofollow">五、卸载NetData</a></li><li><a href="#NetData_142" rel="nofollow">五、NetData的相关配置文件</a></li><li><a href="#NVIDIASMI_172" rel="nofollow">六、添加第三方扩展插件（NVIDIA-SMI）</a></li><li><a href="#httpsimgblogcsdnimgcn20200614212016363pngxossprocessimagewatermarktype_ZmFuZ3poZW5naGVpdGkshadow_10text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2ODY3OTY3size_16color_FFFFFFt_70pic_center_201" rel="nofollow">在这里插入图片描述</a></li><li><a href="#_206" rel="nofollow">七、多设备监控</a></li><li><ul><li><a href="#_208" rel="nofollow">方法一</a></li><li><a href="#_232" rel="nofollow">方法二</a></li><li><ul><li><a href="#_238" rel="nofollow">节点服务器</a></li></ul> 
    </li><li><a href="#_264" rel="nofollow">主服务器</a></li></ul> 
   </li><li><a href="#_294" rel="nofollow">八、报警器</a></li><li><a href="#_312" rel="nofollow">九、将监控数据存入后端</a></li><li><a href="#__350" rel="nofollow">十、 创建自定义监控界面</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_5"></a>一、项目环境</h3> 
<ul><li>系统：Ubuntu 18.04.3 LTS</li><li>官方说明文档：https://learn.netdata.cloud/docs/agent</li></ul> 
<hr> 
<h3><a id="NetData_12"></a>二、NetData简介</h3> 
<p>​ <strong>NetData</strong> 是一个用于系统和应用的分布式实时性能和健康监控工具。它提供了对系统中实时发生的所有事情的全面检测。你可以在高度互动的 Web 仪表板中查看结果。使用 Netdata，你可以清楚地了解现在发生的事情，以及之前系统和应用中发生的事情。你无需成为专家即可在 Linux 系统中部署此工具。NetData 开箱即用，零配置、零依赖。只需安装它然后坐等，之后 NetData 将负责其余部分。</p> 
<hr> 
<h3><a id="NetData_18"></a>三、NetData安装</h3> 
<ul><li> <h4><a id="_20"></a>方法一</h4> <p><strong>Netdata</strong>最简单的一种安装方式就是直接使用官方的脚本进行一键安装</p> <pre><code class="prism language-bash"><span class="token function">bash</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token function">curl</span> -Ss https://my-netdata.io/kickstart-static64.sh<span class="token punctuation">)</span>
<span class="token comment"># Ubuntu的包管理器不确定有没有  sudo apt-get install netdata</span>
</code></pre> </li></ul> 
<pre><code>  
当出现如下信息后，就代表安装成功了
  
  ```bash
  -------------------------------------------------------------------------------
  OK. NetData is installed and it is running (listening to *:19999).
  -------------------------------------------------------------------------------
  INFO: Command line options changed. -pidfile, -nd and -ch are deprecated.
  If you use custom startup scripts, please run netdata -h to see the
  corresponding options and update your scripts.
  Hit http://localhost:19999/ from your browser.
  To stop netdata, just kill it, with:
  killall netdata
  To start it, just run it:
  /usr/sbin/netdata
  Enjoy!
  Uninstall script generated: ./netdata-uninstaller.sh
</code></pre> 
<p>这时我们只需要打开<code>http://localhost:19999/</code>就可以看到<strong>NetData</strong>的默认界面了</p> 
<p><img src="https://images2.imgbox.com/56/1d/aQpUl6ij_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>[注]： NetData有汉化版，但是是第三方的包，出于安全考虑还是用官方的。<br> https://github.com/firehol/netdata （原版）<br> https://github.com/Fhaohaizi/netdata （汉化版本）<br> https://github.com/jasoncheng7115/netdata-cpatch （繁体汉化补丁[自行转简体]：html、js）</p> 
</blockquote> 
<ul><li> <h4><a id="_57"></a>方法二</h4> <p>如果上述方法安装不成功的话，也可以使用下面的方法自行安装</p> <pre><code class="prism language-bash"><span class="token comment"># 安装所需依赖项目</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> zlib1g-dev uuid-dev libuv1-dev liblz4-dev libjudy-dev libssl-dev libmnl-dev gcc <span class="token function">make</span> <span class="token function">git</span> autoconf autoconf-archive autogen automake pkg-config <span class="token function">curl</span>

<span class="token comment"># 克隆NetData的git仓库</span>
<span class="token function">git</span> clone https://github.com/netdata/netdata.git --depth<span class="token operator">=</span><span class="token number">100</span>

<span class="token comment"># 进入netdata目录</span>
<span class="token builtin class-name">cd</span> netdata/

<span class="token comment"># 执行安装脚本，并启动NetData</span>
<span class="token function">sudo</span> ./netdata-installer.sh
</code></pre> </li></ul> 
<h3><a id="NetData_75"></a>四、NetData的基本操作</h3> 
<pre><code class="prism language-bash"><span class="token comment"># 启动NetData服务，并设置开机启动</span>
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> netdata
<span class="token function">sudo</span> systemctl start netdata

<span class="token comment"># 重启服务</span>
<span class="token function">sudo</span> systemctl restart netdata

<span class="token comment"># 停止NetData服务</span>
<span class="token function">sudo</span> systemctl stop netdata

<span class="token comment"># 更新NetData服务（重新拉去，重新运行）</span>
<span class="token builtin class-name">cd</span> netdata
<span class="token function">git</span> pull
<span class="token function">sudo</span> ./netdata-installer.sh
</code></pre> 
<h3><a id="NetData_93"></a>五、卸载NetData</h3> 
<p>我们独立的卸载程序能够删除由Shell安装程序创建的Netdata安装。它不需要运行任何其他Netdata存储库文件。它所需要的只是一个<code>.environment</code>文件，该文件是在安装过程中创建的（使用Shell默认安装程序）并放入<code>${NETDATA_USER_CONFIG_DIR}/.environment</code>（默认情况下<code>/etc/netdata/.environment</code>）。该文件包含一些传递给我们的安装程序的参数，这些参数在卸载过程中是必需的。主要需要两个参数：</p> 
<pre><code class="prism language-shell">NETDATA_PREFIX

NETDATA_ADDED_TO_GROUPS
</code></pre> 
<p>卸载工作流程如下所示：</p> 
<ol><li>查找您的<code>.environment</code>文件，这通常<code>/etc/netdata/.environment</code>是默认安装。</li><li>如果找不到该文件并想要卸载Netdata，则创建一个具有以下内容的新文件：</li></ol> 
<pre><code class="prism language-shell">NETDATA_PREFIX <span class="token operator">=</span> <span class="token string">"&lt;安装前缀&gt;"</span> <span class="token comment"># 将您用作参数的参数放置到shell已安装的--install标志中。否则应为空</span>

NETDATA_ADDED_TO_GROUPS <span class="token operator">=</span><span class="token string">"&lt;其他组&gt;"</span> <span class="token comment"># 运行Netdata进程的用户的其他组</span>
</code></pre> 
<ol><li> <p>运行<code>netdata-uninstaller.sh</code>如下：</p> <pre><code class="prism language-shell">$ <span class="token punctuation">{<!-- --></span>NETDATA_PREFIX<span class="token punctuation">}</span> /usr/libexec/netdata/netdata-uninstaller.sh --yes --env <span class="token operator">&lt;</span>environment_file<span class="token operator">&gt;</span>
</code></pre> </li></ol> 
<blockquote> 
 <p>[注]： 如果没有文件，现有安装可能仍需要下载文件。要在这种情况下执行卸载，请运行以下命令：</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token function">wget</span> https://raw.githubusercontent.com/netdata/netdata/master/packaging/installer/netdata-uninstaller.sh

<span class="token function">chmod</span> + x ./netdata-uninstaller.sh

./netdata-uninstaller.sh --yes --env  <span class="token operator">&lt;</span>environment_file<span class="token operator">&gt;</span>
</code></pre> 
<p>默认<code>environment_file</code>值为<code>/etc/netdata/.environment</code>。</p> 
<blockquote> 
 <p>[注]： 此卸载方法假定以前使用<code>netdata-installer.sh</code>或kickstart脚本进行安装。当前由软件包管理器安装Netdata时使用它可能会起作用或导致意外结果。如果是使用docker进行安装。</p> 
</blockquote> 
<p>执行删除命令的过程中，它会让你确认有些文件是否需要删除，一般情况下，一路确定就可以了。</p> 
<p>一切顺利的话，当你看到下面的画面就表示你已经安装成功了。</p> 
<p><img src="https://images2.imgbox.com/27/97/VmufEq9X_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h3><a id="NetData_142"></a>五、NetData的相关配置文件</h3> 
<p><strong>NetData</strong>的核心配置可以通过<code>cat /etc/netdata/netdata.conf</code>或者<code>http://127.0.0.1:19999/netdata.conf</code>查看。</p> 
<p><img src="https://images2.imgbox.com/85/e1/s9u9fequ_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>[注]： 上图矩形框部分内的为NetData的主要配置文件路径。</p> 
</blockquote> 
<p>​ 如果觉得默认的仪表盘展示的图表太多，可以<code>vim /etc/netdata/netdata.conf</code>或者<code>nano /etc/netdata/netdata.conf</code> ，修改<code>[plugins]</code>中的配置。原配置文件中大部分默认开启的，如果我们不需要某些图表的话，可以将注释去掉，改为no。然后重启服务，就可以禁用相应的图表。</p> 
<p><img src="https://images2.imgbox.com/47/75/ExEniEl6_o.png" alt="在这里插入图片描述"></p> 
<p>​ 禁用效果：</p> 
<p><img src="https://images2.imgbox.com/be/cd/mnSnxJAs_o.png" alt="在这里插入图片描述"></p> 
<p>​ 如果觉得<strong>NetData</strong>占用的内存过大，也可以修改核心配置中的数据刷新率，来降低内存占用。</p> 
<pre><code class="prism language-bash"><span class="token comment"># 降低cpu占用：</span>
	<span class="token comment"># 编辑：vim netdata.conf</span>
		<span class="token punctuation">[</span>global<span class="token punctuation">]</span>
		update every <span class="token operator">=</span> <span class="token number">2</span>
	<span class="token comment"># 或者只修改apps部分：</span>
		<span class="token punctuation">[</span>plugin:apps<span class="token punctuation">]</span>
		update every <span class="token operator">=</span> <span class="token number">2</span>
</code></pre> 
<hr> 
<h3><a id="NVIDIASMI_172"></a>六、添加第三方扩展插件（NVIDIA-SMI）</h3> 
<blockquote> 
 <p>[官方文档]： https://learn.netdata.cloud/docs/agent/collectors/python.d.plugin/nvidia_smi/</p> 
</blockquote> 
<p>在新版NetData中，它自带nvidia显卡监控：</p> 
<pre><code class="prism language-bash"><span class="token comment"># vim /usr/lib/netdata/conf.d/python.d.conf</span>
  nvidia_smi: <span class="token function">yes</span>
</code></pre> 
<blockquote> 
 <p>[注]：但前提是你必须先确保安装好了<code>nvidia-smi</code>,且NVIDIA GPU必须支持该工具。</p> 
 <p>其次确保<code>netdata</code>用户可以执行<code>/usr/bin/nvidia-smi</code>或在您的二进制文件所在的任何位置。</p> 
</blockquote> 
<p>生成配置文件：</p> 
<pre><code class="prism language-bash"><span class="token comment"># 使用官方提供的脚本，生成对用文件的配置文件</span>
<span class="token builtin class-name">cd</span> /etc/netdata   
<span class="token function">sudo</span> ./edit-config python.d/nvidia_smi.conf
</code></pre> 
<p><img src="https://images2.imgbox.com/da/e3/0i6CFnDP_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash"><span class="token comment"># 官方文档提供样例</span>
loop_mode    <span class="token builtin class-name">:</span> <span class="token function">yes</span>  <span class="token comment"># 默认为yes。 如果设置为yes，则使用-l选项在单独的线程中执行nvidia-smi。</span>
poll_seconds <span class="token builtin class-name">:</span> <span class="token number">1</span>      <span class="token comment"># 默认为1。设置循环查询nvidia-smi工具的频率（秒数）。</span>
</code></pre> 
<h3><a id="httpsimgblogcsdnimgcn20200614212016363pngxossprocessimagewatermarktype_ZmFuZ3poZW5naGVpdGkshadow_10text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2ODY3OTY3size_16color_FFFFFFt_70pic_center_201"></a><img src="https://images2.imgbox.com/c7/fc/XatCKP80_o.png" alt="在这里插入图片描述"></h3> 
<hr> 
<h3><a id="_206"></a>七、多设备监控</h3> 
<ul><li> <h4><a id="_208"></a>方法一</h4> 
  <blockquote> 
   <p>[官方文档]：https://learn.netdata.cloud/docs/agent/step-by-step/step-03</p> 
  </blockquote> <p>使用官方提供的平台<strong>NetData Cloud</strong></p> </li></ul> 
<p><img src="https://images2.imgbox.com/e1/50/gSdCkb5K_o.png" alt="在这里插入图片描述"></p> 
<p>点击页面右上角的节点选项，即可进入官方平台。</p> 
<p><img src="https://images2.imgbox.com/ac/6c/ChOgOdZd_o.png" alt="在这里插入图片描述"></p> 
<p>通过邮箱或github账号，将设备与账号进行绑定。当我们使用平台绑定多个设备之后，就可以将多个设备的数据汇总到平台中进行浏览。</p> 
<p><img src="https://images2.imgbox.com/28/2a/4zKkaBcx_o.png" alt="在这里插入图片描述"></p> 
<p>也可以使用左上角的下拉菜单进行自由切换。</p> 
<p><img src="https://images2.imgbox.com/b7/89/aib4hzZ1_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>[注]：虽然在官方文档中，作者一再强调，他们只会存储账号和绑定关系，但是仍然无法确定是否会发送服务器的状态给到其他人</p> 
</blockquote> 
<ul><li> <h4><a id="_232"></a>方法二</h4> 
  <blockquote> 
   <p>[官方文档]：https://learn.netdata.cloud/docs/agent/streaming</p> 
  </blockquote> <p>可以使用为需要监控的服务器建立主从关系，将其他服务器的数据同一汇总到一台服务器进行浏览</p> <h5><a id="_238"></a>节点服务器</h5> <p>修改netdata.conf中的如下配置：</p> <pre><code class="prism language-bash"><span class="token punctuation">[</span>global<span class="token punctuation">]</span>
    memory mode <span class="token operator">=</span> none <span class="token comment"># 在此主机上禁用数据库。这也会禁用运行状况监视（没有数据库就无法进行运行状况监视）</span>
    <span class="token function">hostname</span> <span class="token operator">=</span> chenshaolang-MS-7817 <span class="token comment"># 修改配置名称</span>
<span class="token punctuation">[</span>web<span class="token punctuation">]</span>
    mode <span class="token operator">=</span> none  <span class="token comment"># 禁用API（Netdata不会监听任何端口）。这也会禁用注册表（没有API的注册表将无法使用）。</span>
</code></pre> <p>同时在同一目录下新建stream.conf并写入如下配置：</p> <pre><code class="prism language-bash">  <span class="token punctuation">[</span>stream<span class="token punctuation">]</span>
  enabled <span class="token operator">=</span> <span class="token function">yes</span>
  destination <span class="token operator">=</span> <span class="token number">127.0</span>.0.1:19999 <span class="token comment"># 主服务器的ip地址</span>
  api key <span class="token operator">=</span> 733d1bb7-91b1-4bcf-9a45-66ec2340316e   
  <span class="token comment"># api key是一个uuid格式的字符串，可以使用uuidgen命令生成。主要是提供给主服务器使用</span>
</code></pre> <p><img src="https://images2.imgbox.com/c5/59/CGjLQQCg_o.png" alt="在这里插入图片描述"></p> <p>重启服务：</p> <pre><code class="prism language-bash">  systemctl restart netdata
</code></pre> <h4><a id="_264"></a>主服务器</h4> <p>在netdata.conf的同一目录下新建stream.conf并写入如下配置：</p> <pre><code class="prism language-bash"><span class="token punctuation">[</span>733d1bb7-91b1-4bcf-9a45-66ec2340316e<span class="token punctuation">]</span>  <span class="token comment"># 刚才节点服务器生成的api key</span>
    enabled <span class="token operator">=</span> <span class="token function">yes</span>
    default <span class="token function">history</span> <span class="token operator">=</span> <span class="token number">3600</span>
    default memory mode <span class="token operator">=</span> save
    health enabled by default <span class="token operator">=</span> auto 
    allow from <span class="token operator">=</span> *  <span class="token comment"># allow from可以设置数据流的允许来源以保证安全。如 allow from = 127.0.0.1 仅允许该ip连接</span>
</code></pre> 
  <blockquote> 
   <p>[注]：如果有多个节点服务器，则一起写在stream.conf里面</p> 
  </blockquote> <p>重启服务：</p> <pre><code class="prism language-bash">  systemctl restart netdata
</code></pre> <p>配置完后，我们就可以直接在主服务器上直接浏览所有节点服务器的情况了。</p> </li></ul> 
<p><img src="https://images2.imgbox.com/39/a7/jHLuR0u2_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>[注]：右上方箭头处，证明我没有登录官方的平台就是先多服务器数据连通。</p> 
</blockquote> 
<hr> 
<h3><a id="_294"></a>八、报警器</h3> 
<blockquote> 
 <p>[官方文档]：https://learn.netdata.cloud/docs/agent/step-by-step/step-05</p> 
</blockquote> 
<p>事实上在我们安装好<strong>NetData</strong>时，官方就已经为我们预设了很多的报警器。我们直接点击上方的<code>Alarms</code>就可以进入。</p> 
<p><img src="https://images2.imgbox.com/2e/20/3vXdnzQ5_o.png" alt="在这里插入图片描述"></p> 
<p>同时它会定时记录每个时间段服务器的状况，并声称快照。当发现警报时，可以通过查阅历史，点击直接进入放生警报时服务器的状态。</p> 
<p><img src="https://images2.imgbox.com/a0/a6/C1slTgs9_o.png" alt="在这里插入图片描述"></p> 
<p>如上图，在5月4日的时候，系统发生了一次警报。通过点击，直接进入发生状况时，系统的状态。</p> 
<p><img src="https://images2.imgbox.com/46/d5/2VVZpEq3_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>[注]： 但是这个功能需要登录他们的平台才能跳转，或者将数据存入数据库或者其他第三方监控软件。如Graphite，OpenTSDB，Prometheus，AWS Kinesis Data Streams，MongoDB</p> 
</blockquote> 
<h3><a id="_312"></a>九、将监控数据存入后端</h3> 
<blockquote> 
 <p>[官方文档]：https://learn.netdata.cloud/docs/agent/step-by-step/step-09</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token comment"># 首先先安装数据库</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> mongodb

<span class="token comment"># 然后安装相关的依赖</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libmongoc-1.0-0 libmongoc-dev

<span class="token comment"># 在数据库中新建一个名叫netdata的数据库</span>
use netdata

<span class="token comment"># 并在里面创建一张名叫netdata_metrics的表</span>
db.createCollection<span class="token punctuation">(</span><span class="token string">"netdata_metrics"</span><span class="token punctuation">)</span>
</code></pre> 
<p>然后在核心配置<code>netdata.conf</code>文件中，将数据发送到MongoDB后端的功能启用</p> 
<p><img src="https://images2.imgbox.com/dd/5c/bJfFUo8W_o.png" alt="在这里插入图片描述"></p> 
<p>接着Netdata配置目录中，运行<code>sudo ./edit-config mongodb.conf</code>并设置<a href="https://docs.mongodb.com/manual/reference/connection-string/" rel="nofollow">MongoDB URI</a>，数据库名称和集合名称</p> 
<p><img src="https://images2.imgbox.com/0f/c2/qt7wBevt_o.png" alt="在这里插入图片描述"></p> 
<p>然后重新启动NetData以启用MongoDB后端，当出现下面画面就表示配置成功，已经将数据存储进mongodb中。</p> 
<p><img src="https://images2.imgbox.com/e7/2d/sMMT5hIT_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/de/2b/0lf3467o_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>[注]：这个之前按照官方文档的配置是不成功的，但是后面升级了pymongo，重启了一下就突然能用了。</p> 
 <p><code>pip3 uninstall pymongo bson </code></p> 
 <p><code>sudo pip3 install pymongo --upgrade</code></p> 
</blockquote> 
<h3><a id="__350"></a>十、 创建自定义监控界面</h3> 
<blockquote> 
 <p>[官方文档]：https://learn.netdata.cloud/docs/agent/step-by-step/step-08#why-should-i-create-a-custom-dashboard</p> 
</blockquote> 
<p><code>NetData</code>除了可以在默认的界面上进行相关图表的删除的添加之外，还支持自定义页面。</p> 
<p>首先 我们在目录<code>/usr/share/netdata/web</code>下创建也页面<code>custom-dashboard.html</code>。</p> 
<pre><code class="prism language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>My custom dashboard<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html; charset=utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>IE=edge,chrome=1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>apple-mobile-web-app-capable<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>yes<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>apple-mobile-web-app-status-bar-style<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>black-translucent<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">var</span> netdataTheme <span class="token operator">=</span> <span class="token string">'slate'</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 添加dashboard.js，这样才能使用NetData的图表 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://localhost:19999/dashboard.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">.wrap</span> <span class="token punctuation">{<!-- --></span>
      <span class="token property">max-width</span><span class="token punctuation">:</span> 1280px<span class="token punctuation">;</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">h1</span> <span class="token punctuation">{<!-- --></span>
      <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
      <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">.charts</span> <span class="token punctuation">{<!-- --></span>
      <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
      <span class="token property">flex-flow</span><span class="token punctuation">:</span> row wrap<span class="token punctuation">;</span>
      <span class="token property">justify-content</span><span class="token punctuation">:</span> space-around<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">.charts &gt; div</span> <span class="token punctuation">{<!-- --></span>
      <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 6rem<span class="token punctuation">;</span>
      <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
   </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>My custom dashboard<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>charts<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!-- 添加相关图表格 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">data-netdata</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>system.cpu<span class="token punctuation">"</span></span>
           <span class="token attr-name">data-after</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>-300<span class="token punctuation">"</span></span>
           <span class="token attr-name">data-height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>250px<span class="token punctuation">"</span></span>
           <span class="token attr-name">data-width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>calc(50% - 2rem)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">data-netdata</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>apps.cpu<span class="token punctuation">"</span></span>
           <span class="token attr-name">data-after</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>-300<span class="token punctuation">"</span></span>
           <span class="token attr-name">data-height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>250px<span class="token punctuation">"</span></span>
           <span class="token attr-name">data-width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>calc(50% - 2rem)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">data-netdata</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>groups.cpu<span class="token punctuation">"</span></span>
           <span class="token attr-name">data-after</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>-300<span class="token punctuation">"</span></span>
           <span class="token attr-name">data-height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>250px<span class="token punctuation">"</span></span>
           <span class="token attr-name">data-width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>calc(50% - 2rem)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">data-netdata</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>users.cpu<span class="token punctuation">"</span></span>
           <span class="token attr-name">data-after</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>-300<span class="token punctuation">"</span></span>
           <span class="token attr-name">data-height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>250px<span class="token punctuation">"</span></span>
           <span class="token attr-name">data-width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>calc(50% - 2rem)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>然后修改这个页面文件的权限，<code>NetData</code>有权限去直接访问它</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">chown</span> netdata:netdata /usr/share/netdata/web/custom-dashboard.html
</code></pre> 
<p>配置完后，就可以直接使用<code>http://127.0.0.1:19999/custom-dashboard.html</code>进行登录查看。</p> 
<p><img src="https://images2.imgbox.com/4e/32/Ui3uLURx_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p>很长一段时间没有在csdn中写文章了，事实上后面自己学习过程中的大部分文档都是在语雀中完成的，基本都是自己写自己看。后续文章都会分享到自己的个人博客上，感兴趣的话可以关注一下。<a href="https://chenshaolang.gitee.io/personal-blog/" rel="nofollow">个人博客地址</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1366b771eb32a59d7da68516ae487323/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">chat gpt</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a41a523fedce4ae2d2b3845fe83b5551/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">manjaro踩坑记</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>