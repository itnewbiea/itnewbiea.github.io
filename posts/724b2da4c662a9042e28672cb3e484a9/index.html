<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>https证书-openssl - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="https证书-openssl" />
<meta property="og:description" content="网页的http-&gt;https 1.生成根证书密钥 # 生成rsa私钥，openssl格式,4096位强度，*.key是密钥文件名 openssl genrsa -out ca.key 4096 2.生成自签名根证书 # 生成的ca.crt文件是用来签署下面的server.csr文件。 openssl req -new -x509 -days 3650 -key ca.key -out ca.crt 3.使用根证书来签名其它证书 # 生成证书密钥 openssl genrsa -out server.key 4096 # 执行这条命令需要依次输入国家、地区、组织、email，common name可以写名字或者域名。如果为了https申请，必须和域名相吻合 新建san.conf，并加入以下内容 [req] default_bits = 4096 distinguished_name = req_distinguished_name req_extensions = v3_req [req_distinguished_name] countryName = country stateOrProvinceName = province localityName = city organizationName = company name commonName = domain name or ip [v3_req] subjectAltName = @alt_names [alt_names] IP." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/724b2da4c662a9042e28672cb3e484a9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-24T15:36:50+08:00" />
<meta property="article:modified_time" content="2022-06-24T15:36:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">https证书-openssl</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre><code class="prism language-shell">网页的http-<span class="token operator">&gt;</span>https
</code></pre> 
<h6><a id="1_4"></a>1.生成根证书密钥</h6> 
<pre><code class="prism language-shell"><span class="token comment"># 生成rsa私钥，openssl格式,4096位强度，*.key是密钥文件名</span>
openssl genrsa -out ca.key <span class="token number">4096</span>
</code></pre> 
<h6><a id="2_11"></a>2.生成自签名根证书</h6> 
<pre><code class="prism language-shell"><span class="token comment"># 生成的ca.crt文件是用来签署下面的server.csr文件。</span>
openssl req -new -x509 -days <span class="token number">3650</span> -key ca.key -out ca.crt
</code></pre> 
<h6><a id="3_18"></a>3.使用根证书来签名其它证书</h6> 
<pre><code class="prism language-shell"><span class="token comment"># 生成证书密钥</span>
openssl genrsa -out server.key <span class="token number">4096</span>
<span class="token comment"># 执行这条命令需要依次输入国家、地区、组织、email，common name可以写名字或者域名。如果为了https申请，必须和域名相吻合</span>
</code></pre> 
<h6><a id="sanconf_26"></a>新建<code>san.conf</code>，并加入以下内容</h6> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>req<span class="token punctuation">]</span>
default_bits <span class="token operator">=</span> <span class="token number">4096</span>
distinguished_name <span class="token operator">=</span> req_distinguished_name
req_extensions <span class="token operator">=</span> v3_req

<span class="token punctuation">[</span>req_distinguished_name<span class="token punctuation">]</span>
countryName <span class="token operator">=</span> country
stateOrProvinceName <span class="token operator">=</span> province
localityName <span class="token operator">=</span> city
organizationName <span class="token operator">=</span> company name
commonName <span class="token operator">=</span> domain name or <span class="token function">ip</span>

<span class="token punctuation">[</span>v3_req<span class="token punctuation">]</span>
subjectAltName <span class="token operator">=</span> @alt_names

<span class="token punctuation">[</span>alt_names<span class="token punctuation">]</span>
IP.1<span class="token operator">=</span><span class="token number">10.0</span>.0.172  （换成本机地址！！！）
</code></pre> 
<h6><a id="4CSR_48"></a>4.生成证书签名请求(CSR)</h6> 
<pre><code class="prism language-shell"><span class="token comment"># 生成csr 注意要使用sha256算法（推荐是sha256算法，默认算法浏览器会报弱加密算法错误）</span>
openssl req -new -key server.key -out server.csr -config san.conf -sha256
<span class="token comment"># 查看csr信息</span>
openssl req -text -in server.csr
</code></pre> 
<h6><a id="5csrservercrt_57"></a>5.使用根证书按照csr给证书签名，生成新证书server.crt</h6> 
<pre><code class="prism language-shell"><span class="token comment"># 这里serial参数需要全局唯一，否则在同一台设备上使用serial值相同的证书会冲突。</span>
openssl x509 -req -days <span class="token number">365</span> -in server.csr -CA ca.crt -CAkey ca.key -set_serial 01 -out server.crt -extfile san.conf -extensions v3_req
<span class="token comment"># 查看证书</span>
openssl x509 -text -in server.crt
</code></pre> 
<blockquote> 
 <p>把ca.crt 导入到客户端谷歌浏览器https 受信任的证书里面</p> 
</blockquote>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f85c76e9ae5df6bba3d49dcd8d54a649/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[Vue warn]: Duplicate keys detected: ‘/‘. This may cause an update error.</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/10e8e84bcf2ab3d09963ec44dc450f0f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vscode运行卡顿解决方案</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>