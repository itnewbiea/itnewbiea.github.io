<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MacOS系统下matplotlib中SimHei中文字体缺失报错的解决办法 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MacOS系统下matplotlib中SimHei中文字体缺失报错的解决办法" />
<meta property="og:description" content="文章目录 问题描述解决方法：Step 1. 在终端进入python3环境，查看matplotlib字体路径：Step 2. 下载SimHei.ttf字体：Step 3. 将下载好的SimHei.ttf字体移动到第一步查询到的字体目录./fonts/ttf/下：Step 4. 打开终端，进入python环境，清理matplotlib缓冲目录：Step 5. 修改原始文件：Step 6. 重启，测试 问题延伸：安装Seaborn 问题描述 使用matplotlib画图时，因为缺少字体，出现warning，图像上label上的中文显示时空白小方块。因为matplotlib默认没有中文，可以调用中文字体，但是会出现如下图所示的warning：
import matplotlib.pyplot as plt plt.rcParams[&#39;font.sans-serif&#39;] = [&#39;SimHei&#39;] plt.rcParams[&#39;axes.unicode_minus&#39;] = False 解决方法： Step 1. 在终端进入python3环境，查看matplotlib字体路径： import matplotlib print(matplotlib.matplotlib_fname()) 找到自己的matplotlib字体文件路径：
比如/Users/dan/miniforge3/envs/py38/lib/python3.8/site-packages/matplotlib/mpl-data/matplotlibrc
Step 2. 下载SimHei.ttf字体： 国内SimHei
Step 3. 将下载好的SimHei.ttf字体移动到第一步查询到的字体目录./fonts/ttf/下： mv ~/Downloads/SimHei.ttf ~/miniforge3/envs/py38/lib/python3.8/site-packages/matplotlib/mpl-data/fonts/ttf/SimHei.ttf 注意字体文件名称一定是：SimHei.ttf
Step 4. 打开终端，进入python环境，清理matplotlib缓冲目录： import matplotlib print(matplotlib.get_cachedir()) 获取缓冲目录地址：/Users/dan/.matplotlib
终端输入exit()退出python环境，再删除上面找到的缓冲文件：
rm -rf /Users/dan/.matplotlib Step 5. 修改原始文件： 打开第一步找到的字体路径：/Users/dan/miniforge3/envs/py38/lib/python3.8/site-packages/matplotlib/mpl-data/matplotlibrc进行修改：
通过vi定位几个关键点来修改：
vi /Users/dan/miniforge3/envs/py38/lib/python3.8/site-packages/matplotlib/mpl-data/matplotlibrc 通过:/内容 查找指定内容
如:/font.family， :/font.sans-serif，:/ axes." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/bd23ecd9041d1b3f634b1c3a4f208a2c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-30T18:08:42+08:00" />
<meta property="article:modified_time" content="2022-03-30T18:08:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MacOS系统下matplotlib中SimHei中文字体缺失报错的解决办法</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">问题描述</a></li><li><a href="#_14" rel="nofollow">解决方法：</a></li><li><ul><li><a href="#Step_1_python3matplotlib_16" rel="nofollow">Step 1. 在终端进入python3环境，查看matplotlib字体路径：</a></li><li><a href="#Step_2_SimHeittf_32" rel="nofollow">Step 2. 下载SimHei.ttf字体：</a></li><li><a href="#Step_3_SimHeittffontsttf_36" rel="nofollow">Step 3. 将下载好的SimHei.ttf字体移动到第一步查询到的字体目录./fonts/ttf/下：</a></li><li><a href="#Step_4_pythonmatplotlib_44" rel="nofollow">Step 4. 打开终端，进入python环境，清理matplotlib缓冲目录：</a></li><li><a href="#Step_5__61" rel="nofollow">Step 5. 修改原始文件：</a></li><li><a href="#Step_6__90" rel="nofollow">Step 6. 重启，测试</a></li></ul> 
   </li><li><a href="#Seaborn_112" rel="nofollow">问题延伸：安装Seaborn</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>问题描述</h3> 
<p>使用matplotlib画图时，因为缺少字体，出现warning，图像上label上的中文显示时空白小方块。因为matplotlib默认没有中文，可以调用中文字体，但是会出现如下图所示的warning：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span> 
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/25/29/9qsFODZy_o.png" alt="1"></p> 
<h3><a id="_14"></a>解决方法：</h3> 
<h4><a id="Step_1_python3matplotlib_16"></a>Step 1. 在终端进入python3环境，查看matplotlib字体路径：</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib    
<span class="token keyword">print</span><span class="token punctuation">(</span>matplotlib<span class="token punctuation">.</span>matplotlib_fname<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/06/1a/cac8v7Hb_o.png" alt="在这里插入图片描述"></p> 
<p>找到自己的matplotlib字体文件路径：</p> 
<p>比如/Users/dan/miniforge3/envs/py38/lib/python3.8/site-packages/matplotlib/mpl-data/matplotlibrc</p> 
<h4><a id="Step_2_SimHeittf_32"></a>Step 2. 下载SimHei.ttf字体：</h4> 
<p><a href="http://www.xiazaiziti.com/210356.html" rel="nofollow">国内SimHei</a></p> 
<h4><a id="Step_3_SimHeittffontsttf_36"></a>Step 3. 将下载好的SimHei.ttf字体移动到第一步查询到的字体目录./fonts/ttf/下：</h4> 
<pre><code class="prism language-bash"><span class="token function">mv</span> ~/Downloads/SimHei.ttf ~/miniforge3/envs/py38/lib/python3.8/site-packages/matplotlib/mpl-data/fonts/ttf/SimHei.ttf
</code></pre> 
<p>注意字体文件名称一定是：SimHei.ttf</p> 
<h4><a id="Step_4_pythonmatplotlib_44"></a>Step 4. 打开终端，进入python环境，清理matplotlib缓冲目录：</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib
<span class="token keyword">print</span><span class="token punctuation">(</span>matplotlib<span class="token punctuation">.</span>get_cachedir<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>获取缓冲目录地址：/Users/dan/.matplotlib</p> 
<p>终端输入exit()退出python环境，再删除上面找到的缓冲文件：</p> 
<pre><code>rm -rf /Users/dan/.matplotlib
</code></pre> 
<h4><a id="Step_5__61"></a>Step 5. 修改原始文件：</h4> 
<p>打开第一步找到的字体路径：/Users/dan/miniforge3/envs/py38/lib/python3.8/site-packages/matplotlib/mpl-data/matplotlibrc进行修改：</p> 
<p><img src="https://images2.imgbox.com/1d/b2/MvOPqbnf_o.png" alt="在这里插入图片描述"></p> 
<p>通过vi定位几个关键点来修改：</p> 
<pre><code class="prism language-bash"> <span class="token function">vi</span> /Users/dan/miniforge3/envs/py38/lib/python3.8/site-packages/matplotlib/mpl-data/matplotlibrc
</code></pre> 
<p>通过<code>:/内容</code> 查找指定内容<br> 如<code>:/font.family</code>， <code>:/font.sans-serif</code>，<code>:/ axes.unicode_minus</code>.</p> 
<pre><code class="prism language-bash"><span class="token comment">#去掉前面的#</span>
font.family:  sans-serif
<span class="token comment">#去掉前面的#，手动加SimHei</span>
font.sans-serif: SimHei, DejaVu Sans, Bitstream Vera Sans, Computer Modern Sans Serif, Lucida Grande, Verdana, Geneva, Lucid, Arial, Helvetica, Avant Garde, sans-serif
<span class="token comment">#去掉前面的#，把True改为False</span>
axes.unicode_minus: False  <span class="token comment"># use Unicode for the minus symbol rather than hyphen.  See</span>
                           <span class="token comment"># https://en.wikipedia.org/wiki/Plus_and_minus_signs#Character_codes</span>
</code></pre> 
<h4><a id="Step_6__90"></a>Step 6. 重启，测试</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
x <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'x轴数据'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'y轴数据'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/89/1e/uM8piLMu_o.png" alt="在这里插入图片描述"></p> 
<p>不需要<code>plt.rcParams['font.sans-serif'] = ['SimHei']</code>就可以自动显示中文，至此中文显示的问题已经解决。</p> 
<p>参考：<a href="https://blog.csdn.net/D_Ddd0701/article/details/113743015">link 1</a></p> 
<h3><a id="Seaborn_112"></a>问题延伸：安装Seaborn</h3> 
<p>为了进一步做数据的可视化分析，安装matplotlib后，按照以上步骤设置，可以显示中文。之后安装seaborn，但是在后续调用matplotlib或seaborn进行作图时，坐标、标题的中文又无法显示，变成白框了。</p> 
<p>返回如下以下报错：</p> 
<pre><code class="prism language-bash">/Users/dan/miniforge3/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py:240: RuntimeWarning: Glyph <span class="token number">26376</span> missing from current font.
  font.set_text<span class="token punctuation">(</span>s, <span class="token number">0.0</span>, <span class="token assign-left variable">flags</span><span class="token operator">=</span>flags<span class="token punctuation">)</span>
/Users/dan/miniforge3/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py:240: RuntimeWarning: Glyph <span class="token number">19978</span> missing from current font.
  font.set_text<span class="token punctuation">(</span>s, <span class="token number">0.0</span>, <span class="token assign-left variable">flags</span><span class="token operator">=</span>flags<span class="token punctuation">)</span>
/Users/dan/miniforge3/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py:240: RuntimeWarning: Glyph <span class="token number">28023</span> missing from current font.
  font.set_text<span class="token punctuation">(</span>s, <span class="token number">0.0</span>, <span class="token assign-left variable">flags</span><span class="token operator">=</span>flags<span class="token punctuation">)</span>
/Users/dan/miniforge3/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py:240: RuntimeWarning: Glyph <span class="token number">26085</span> missing from current font.
  font.set_text<span class="token punctuation">(</span>s, <span class="token number">0.0</span>, <span class="token assign-left variable">flags</span><span class="token operator">=</span>flags<span class="token punctuation">)</span>
/Users/dan/miniforge3/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py:240: RuntimeWarning: Glyph <span class="token number">26032</span> missing from current font.
  font.set_text<span class="token punctuation">(</span>s, <span class="token number">0.0</span>, <span class="token assign-left variable">flags</span><span class="token operator">=</span>flags<span class="token punctuation">)</span>
/Users/dan/miniforge3/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py:240: RuntimeWarning: Glyph <span class="token number">22686</span> missing from current font.
  font.set_text<span class="token punctuation">(</span>s, <span class="token number">0.0</span>, <span class="token assign-left variable">flags</span><span class="token operator">=</span>flags<span class="token punctuation">)</span>
</code></pre> 
<p>但是卸载seaborn后又可以正常显示中文。到底是怎么回事？</p> 
<p><strong>问题探究：</strong><br> 设置中文显示，涉及到matplotlib的图像默认属性修改。</p> 
<p>seaborn是基于matplotlib库，是整合matplotlib各种绘图函数和设置函数的高级接口，可以理解为seaborn是个中间翻译，用户将绘图命令发给seaborn，seaborn再翻译给matplotlib，matplotlib再按命令绘图。用户也可以直接将绘图语言发给matplotlib。只不过与seaborn沟通的语言更简单易用，与matplotlib沟通就有些繁琐。</p> 
<p>所以，在seaborn中修改样式，最终还是在修改matplotlib的样式参数。</p> 
<p><strong>解决方法：</strong></p> 
<p>虽然已经处理了matplotlib中SimHei中文字体缺失，但是为了在seaborn中显示中文，还需要利用<code>set()</code>的<code>rc</code>参数传递设置，修改<code>rcParams</code>中的字体为中文字体。主要修改两个参数：</p> 
<ul><li><code>font.sans-serif</code>: 设置图像中的非衬线字体，必须是操作系统或matplotlib内置的字体，下文用黑体（SimHei）做示例；</li><li><code>axes.unicode_minus</code>: 设置为False，解决中文字体下显示不出负号。</li></ul> 
<p>如下所示：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token operator">%</span>matplotlib inline

tips <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./seaborn-data-master/tips-zh.csv'</span><span class="token punctuation">)</span>
rc <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'font.sans-serif'</span><span class="token punctuation">:</span> <span class="token string">'SimHei'</span><span class="token punctuation">,</span>
      <span class="token string">'axes.unicode_minus'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">}</span>
sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>context<span class="token operator">=</span><span class="token string">'notebook'</span><span class="token punctuation">,</span> style<span class="token operator">=</span><span class="token string">'ticks'</span><span class="token punctuation">,</span> rc<span class="token operator">=</span>rc<span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>catplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">"日期"</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">"总账单"</span><span class="token punctuation">,</span> data<span class="token operator">=</span>tips<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/05/9d/WGI65Eo0_o.png" alt="在这里插入图片描述"></p> 
<p>欢迎各位关注我的个人公众号：<strong>HsuDan</strong>，我将分享更多自己的学习心得、避坑总结、面试经验、AI最新技术资讯。</p> 
<div align="center"> 
 <img src="https://images2.imgbox.com/49/ac/z3FVJu3U_o.png" width="50%"> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/719cf2905a14e4927568b0d25e23ca73/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue-element-admin npm install 安装tui-editor失败 （解决方案-但是无法使用富文本）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1e52d73959e24d9f9ac35cfb23efe27f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">实现基于LSTM的情感分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>