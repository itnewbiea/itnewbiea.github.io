<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>3维SLAM入门 LIO-SAM的安装与运行 ubuntu18.04&#43;ros melodic - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="3维SLAM入门 LIO-SAM的安装与运行 ubuntu18.04&#43;ros melodic" />
<meta property="og:description" content="3维SLAM入门 LIO-SAM的安装与运行 ubuntu18.04&#43;ros melodic 1 背景介绍1.1 Cartographer1.2 LOAM1.3 LeGO-LOAM1.3 LIO-SAM1.4 LVI-SAM 2 安装LIO-SAM2.1 安装依赖2.2 安装LIO-SAM2.3 下载给定数据集 3 运行LIO-SLAM3.1 运行LIO-SAM：3.2 播放数据包3.3 保存pcd建图结果 参考文章：1、 SLAM学习笔记（十九）开源3D激光SLAM总结大全——Cartographer3D,LOAM,Lego-LOAM,LIO-SAM,LVI-SAM,Livox-LOAM的原理解析及区别 1 背景介绍 在自动驾驶的感知方案中，激光雷达是一个公认的精度高、探测距离远的传感器，适用于对周围环境的精确感知。激光雷达在工作时，采用激光扫描周围环境，返回点云数据。得到了周围环境的点云数据之后，需要对它进行处理。那么激光SLAM便是进行这个操作。激光SLAM是根据点云匹配来进行定位和建图。
现阶段，比较有名的三维激光SLAM算法有LOAM系和谷歌的cartographer。LOAM系包含了LOAM、LeGO-LOAM、LIO-SAM等一系列算法。先简要的介绍一下各个算法（主要是参考文章1）。
1.1 Cartographer Cartographer是由谷歌于2016年开源的一个支持ROS的室内SLAM库，并在截至目前为止，仍然处于不断的更新维护之中。
特点：代码极为工程，多态、继承、层层封装的十分完善。提供了方便的接口，便于接入IMU、（单/多线）雷达、里程计、甚至为二维码辅助等视觉识别方式也预留了接口（Landmark）。
1.2 LOAM LOAM为清华自动化本科毕业的Zhang Ji博士在CMU读博期间，于2014年在RSS期刊发表的关于三维激光传感器的SLAM算法。
特点：Cartographer主要解决室内问题，LOAM室内外都可以，但是没有回环检测，在具有旋转场景会有建图不准确的情况。LOAM的代码量相比Cartographer要小很多，文件结构相对简单。
1.3 LeGO-LOAM LeGO-LOAM是TiXiao Shan发表在IROS2018的文章，文章叫：可变地形下的轻量级和地面优化的雷达里程计与建图。其是以LOAM为框架衍生出的新算法，主要在于两点提升：轻量级 和 地面优化
特点：LeGO-LOAM具有回环检测能力，缺点是依赖地面。
1.3 LIO-SAM LIO-SAM是TixiaoShan在2020年IROS发表的Lego-LOAM续作。 它是Lego-LOAM的扩展版本，添加了IMU预积分因子和GPS因子。LOAM和LeGO-LOAM是纯依靠激光雷达点云SLAM，而LIO-SAM结合了Lidar、IMU和GPS。
1.4 LVI-SAM LVI-SAM为Lego-LOAM和LIO-SAM作者Tixiao Shan的最新工作，发表在ICRA 2021上。其提出了一个基于图优化的多传感器融合框架，具有多个子系统： 视觉惯性子系统（VIS） 和 雷达惯性子系统 （LIS）； 单目&#43;雷达&#43;imu融合
具有鲁棒性：任一子系统失效，不会导致整个系统挂掉。
LVI所采用的回环检测，与大多数视觉SLAM所采取的回环检测方法相同，为词袋模型。与LeGO-LOAM，LIO-LOAM等工作相比，这种方式可以在地图数据库中找到回环，而无需知道当前运动的历史轨迹。
2 安装LIO-SAM 我的环境如下：
ubuntu18.04
ros-melodic
前往TixiaoShan的github主页找到LIO-SAM项目，项目的readme.md文件已经介绍了如何安装和运行，此处我对该过程翻译一下，并加上自己碰上的坑。
2.1 安装依赖 ROS相关的依赖有三个：
sudo apt-get install -y ros-melodic-navigation sudo apt-get install -y ros-melodic-robot-localization sudo apt-get install -y ros-melodic-robot-state-publisher 因为LIO-SAM里面需要用到因子图优化，其采用的是因子图优化库gtsam。此处安装gtsam:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/6097ad9bcc2e1e6a4a8c199b508da1d5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-13T21:45:02+08:00" />
<meta property="article:modified_time" content="2021-07-13T21:45:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">3维SLAM入门 LIO-SAM的安装与运行 ubuntu18.04&#43;ros melodic</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>3维SLAM入门 LIO-SAM的安装与运行 ubuntu18.04+ros melodic</h4> 
 <ul><li><ul><li><a href="#1__2" rel="nofollow">1 背景介绍</a></li><li><ul><li><a href="#11_Cartographer_6" rel="nofollow">1.1 Cartographer</a></li><li><a href="#12_LOAM_10" rel="nofollow">1.2 LOAM</a></li><li><a href="#13_LeGOLOAM_14" rel="nofollow">1.3 LeGO-LOAM</a></li><li><a href="#13_LIOSAM_18" rel="nofollow">1.3 LIO-SAM</a></li><li><a href="#14_LVISAM_20" rel="nofollow">1.4 LVI-SAM</a></li></ul> 
   </li><li><a href="#2_LIOSAM_27" rel="nofollow">2 安装LIO-SAM</a></li><li><ul><li><a href="#21__34" rel="nofollow">2.1 安装依赖</a></li><li><a href="#22_LIOSAM_55" rel="nofollow">2.2 安装LIO-SAM</a></li><li><a href="#23__74" rel="nofollow">2.3 下载给定数据集</a></li></ul> 
   </li><li><a href="#3_LIOSLAM_80" rel="nofollow">3 运行LIO-SLAM</a></li><li><ul><li><a href="#31_LIOSAM_81" rel="nofollow">3.1 运行LIO-SAM：</a></li><li><a href="#32__96" rel="nofollow">3.2 播放数据包</a></li><li><a href="#33_pcd_104" rel="nofollow">3.3 保存pcd建图结果</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<br> 参考文章：1、 
<a href="https://blog.csdn.net/zkk9527/article/details/116160508?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-0&amp;spm=1001.2101.3001.4242">SLAM学习笔记（十九）开源3D激光SLAM总结大全——Cartographer3D,LOAM,Lego-LOAM,LIO-SAM,LVI-SAM,Livox-LOAM的原理解析及区别</a> 
<p></p> 
<h3><a id="1__2"></a>1 背景介绍</h3> 
<p>在自动驾驶的感知方案中，激光雷达是一个公认的精度高、探测距离远的传感器，适用于对周围环境的精确感知。激光雷达在工作时，采用激光扫描周围环境，返回点云数据。得到了周围环境的点云数据之后，需要对它进行处理。那么激光SLAM便是进行这个操作。激光SLAM是根据点云匹配来进行定位和建图。</p> 
<p>现阶段，比较有名的三维激光SLAM算法有LOAM系和谷歌的cartographer。LOAM系包含了LOAM、LeGO-LOAM、LIO-SAM等一系列算法。先简要的介绍一下各个算法（主要是参考文章1）。</p> 
<h4><a id="11_Cartographer_6"></a>1.1 Cartographer</h4> 
<p>Cartographer是由谷歌于2016年开源的一个支持ROS的室内SLAM库，并在截至目前为止，仍然处于不断的更新维护之中。</p> 
<p>特点：代码极为工程，多态、继承、层层封装的十分完善。提供了方便的接口，便于接入IMU、（单/多线）雷达、里程计、甚至为二维码辅助等视觉识别方式也预留了接口（Landmark）。</p> 
<h4><a id="12_LOAM_10"></a>1.2 LOAM</h4> 
<p>LOAM为清华自动化本科毕业的Zhang Ji博士在CMU读博期间，于2014年在RSS期刊发表的关于三维激光传感器的SLAM算法。</p> 
<p>特点：Cartographer主要解决室内问题，LOAM室内外都可以，但是没有回环检测，在具有旋转场景会有建图不准确的情况。LOAM的代码量相比Cartographer要小很多，文件结构相对简单。</p> 
<h4><a id="13_LeGOLOAM_14"></a>1.3 LeGO-LOAM</h4> 
<p>LeGO-LOAM是TiXiao Shan发表在IROS2018的文章，文章叫：可变地形下的轻量级和地面优化的雷达里程计与建图。其是以LOAM为框架衍生出的新算法，主要在于两点提升：轻量级 和 地面优化</p> 
<p>特点：LeGO-LOAM具有回环检测能力，缺点是依赖地面。</p> 
<h4><a id="13_LIOSAM_18"></a>1.3 LIO-SAM</h4> 
<p>LIO-SAM是TixiaoShan在2020年IROS发表的Lego-LOAM续作。 它是Lego-LOAM的扩展版本，添加了IMU预积分因子和GPS因子。LOAM和LeGO-LOAM是纯依靠激光雷达点云SLAM，而LIO-SAM结合了Lidar、IMU和GPS。</p> 
<h4><a id="14_LVISAM_20"></a>1.4 LVI-SAM</h4> 
<p>LVI-SAM为Lego-LOAM和LIO-SAM作者Tixiao Shan的最新工作，发表在ICRA 2021上。其提出了一个基于图优化的多传感器融合框架，具有多个子系统： 视觉惯性子系统（VIS） 和 雷达惯性子系统 （LIS）； 单目+雷达+imu融合</p> 
<p>具有鲁棒性：任一子系统失效，不会导致整个系统挂掉。</p> 
<p>LVI所采用的回环检测，与大多数视觉SLAM所采取的回环检测方法相同，为词袋模型。与LeGO-LOAM，LIO-LOAM等工作相比，这种方式可以在地图数据库中找到回环，而无需知道当前运动的历史轨迹。</p> 
<h3><a id="2_LIOSAM_27"></a>2 安装LIO-SAM</h3> 
<p>我的环境如下：<br> ubuntu18.04<br> ros-melodic</p> 
<p>前往TixiaoShan的github主页找到LIO-SAM项目，项目的readme.md文件已经介绍了如何安装和运行，此处我对该过程翻译一下，并加上自己碰上的坑。</p> 
<h4><a id="21__34"></a>2.1 安装依赖</h4> 
<p>ROS相关的依赖有三个：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y ros-melodic-navigation
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y ros-melodic-robot-localization
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y ros-melodic-robot-state-publisher
</code></pre> 
<p>因为LIO-SAM里面需要用到因子图优化，其采用的是因子图优化库gtsam。此处安装gtsam:</p> 
<pre><code class="prism language-bash"><span class="token function">wget</span> -O ~/Downloads/gtsam.zip https://ghproxy.com/https://github.com/borglab/gtsam/archive/4.0.2.zip
<span class="token function">cd</span> ~/Downloads/ <span class="token operator">&amp;&amp;</span> unzip gtsam.zip -d ~/Downloads/
<span class="token function">cd</span> ~/Downloads/gtsam-4.0.2/
<span class="token function">mkdir</span> build <span class="token operator">&amp;&amp;</span> <span class="token function">cd</span> build
cmake -DGTSAM_BUILD_WITH_MARCH_NATIVE<span class="token operator">=</span>OFF <span class="token punctuation">..</span>
<span class="token function">sudo</span> <span class="token function">make</span> <span class="token function">install</span> -j8
</code></pre> 
<p>作者给出的代码中，直接wget github地址来下载gtsam会很慢，这里我在gtsam的github地址前面加了代理网址https://ghproxy.com/，能够显著加速下载。</p> 
<p>gtsam的版本为4.0.2，安装其他版本可能会导致LIO_SAM运行报错。</p> 
<h4><a id="22_LIOSAM_55"></a>2.2 安装LIO-SAM</h4> 
<pre><code class="prism language-bash"><span class="token function">cd</span> ~/catkin_ws/src
<span class="token function">git</span> clone https://ghproxy.com/https://github.com/TixiaoShan/LIO-SAM.git
<span class="token function">cd</span> <span class="token punctuation">..</span>
catkin_make
</code></pre> 
<p>这里的catkin_ws是你已经创建好的工作空间。同上，为了加速下载，这里的git clone我也加了国内代理网址https://ghproxy.com/。如果编译失败，很有可能是因为gtsam没有按照上述要求安装。</p> 
<p>此外，创建一个新的工作空间catkin_ws的步骤为：</p> 
<pre><code class="prism language-bash">makdir -p ~/catkin_ws/src
<span class="token function">cd</span> ~/catkin_ws
catkin_make
<span class="token keyword">echo</span> <span class="token string">"source ~/catkin_ws/devel/setup.bash"</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc
<span class="token function">source</span> ~/.bashrc
</code></pre> 
<h4><a id="23__74"></a>2.3 下载给定数据集</h4> 
<p>LIO-SAM的作者提供了几个数据集进行测试，这里下载其中的walk数据集。作者提供地址是<a href="https://drive.google.com/drive/folders/1gJHwfdHCRdjP7vuT556pv8atqrCJPbUq" rel="nofollow">google云端硬盘</a>，其下载速度感人，我这里只有十几kb/s，而这个数据集有3.7G。可以到我这里分享的百度网盘链接下载：<a href="https://pan.baidu.com/s/1cMc0EXhbiY2HWqkKlspzDg" rel="nofollow">https://pan.baidu.com/s/1cMc0EXhbiY2HWqkKlspzDg</a><br> 提取码：gz7i<br> 百度网盘的下载速度同样感人。</p> 
<p>下载好数据集后，保存到自己指定的地址。这里，我保存到~/catkin_ws/src/data。</p> 
<h3><a id="3_LIOSLAM_80"></a>3 运行LIO-SLAM</h3> 
<h4><a id="31_LIOSAM_81"></a>3.1 运行LIO-SAM：</h4> 
<pre><code class="prism language-bash">roslaunch lio-sam run.launch
</code></pre> 
<p>输入上述命令，LIO-SAM开始运行，rviz界面跳出。</p> 
<p>这里我碰到一个问题，输入上述命令后出现报错。<strong>错误显示找不到文件libmetis.so</strong>。网上搜索后大致了解到，这个libmetis.so应该是LIO-SAM需要动态链接的一个文件。在ubuntu系统文件夹下搜索到libmetis.so存放在usr/local/lib文件夹下。猜想可能系统默认的动态链接地址为usr/lib文件夹，导致运行LIO-SAM时在usr/lib文件夹中找不到libmetis.so。</p> 
<p>解决方法：采用如下命令将libmetis.so复制到usr/lib文件夹中：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">cp</span> usr/local/lib/libmetis.so usr/lib/libmetis.so
</code></pre> 
<p>再次启动run.launch，程序不再报错。</p> 
<h4><a id="32__96"></a>3.2 播放数据包</h4> 
<p>输入下面命令即可播放存放在~/catkin_ws/src/data/，名称为casual_walk.bag数据包：</p> 
<pre><code class="prism language-bash">rosbag play ~/catkin_ws/src/data/casual_walk.bag
</code></pre> 
<p>开始播放数据包后，rviz即可自动显示当前动态建图画面。<br> <img src="https://images2.imgbox.com/26/a9/nn8YGd98_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="33_pcd_104"></a>3.3 保存pcd建图结果</h4> 
<p>首先，需要修改params.yaml中的参数。params.yaml在~/catkin_ws/src/LIO-SAM/config文件夹下。修改该文件中SavePCD：true 和保存地址。</p> 
<p>然后，为了避免保存还没完成，ros就已经关闭了节点，需要设置_TIMEOUT_SIGINT的值。按如下命令打开文件：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> gedit /opt/ros/melodic/lib/python2.7/dist-packages/roslaunch/nodeprocess.py
</code></pre> 
<p>在文件中找到_TIMEOUT_SIGINT，并设置为100秒。</p> 
<p>这样，在命令窗口中按下Ctrl+C来结束run.launch的运行时，便会自动将pcd文件保存到指定地址。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a9a151708a033381bdcbc54c49fe84a5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Mybatis：实现多表查询</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/19912fc0453970494de32c0665f2fed9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">使用onclick跳出弹窗确认是否删除</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>