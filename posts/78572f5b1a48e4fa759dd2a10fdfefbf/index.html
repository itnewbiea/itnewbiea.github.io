<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>视频和图片的相互转换 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="视频和图片的相互转换" />
<meta property="og:description" content="原文地址：opencv提取视频每一帧 作者：岳麓迷魂 //
// test3.cpp
//
// 该程序实现视频和图片的相互转换.
// Image_to_video()函数将一组图片合成AVI视频文件.
// Video_to_image()函数将AVI视频文件读入，将每一帧存储为jpg文件.
//
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;math.h&gt;
#include &lt;cv.h&gt;
#include &lt;highgui.h&gt;
#define NUM_FRAME 300 //只处理前300帧，根据视频帧数可修改
void Video_to_image(char* filename)
{
printf(&#34;------------- video to image ... ----------------n&#34;);
//初始化一个视频文件捕捉器
CvCapture* capture = cvCaptureFromAVI(filename);
//获取视频信息
cvQueryFrame(capture);
int frameH = (int) cvGetCaptureProperty(capture, CV_CAP_PROP_FRAME_HEIGHT);
int frameW = (int) cvGetCaptureProperty(capture, CV_CAP_PROP_FRAME_WIDTH);
int fps = (int) cvGetCaptureProperty(capture, CV_CAP_PROP_FPS);
int numFrames = (int) cvGetCaptureProperty(capture, CV_CAP_PROP_FRAME_COUNT);
printf(&#34;tvideo height : %dntvideo width : %dntfps : %dntframe numbers : %dn&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/78572f5b1a48e4fa759dd2a10fdfefbf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-07-12T09:21:33+08:00" />
<meta property="article:modified_time" content="2012-07-12T09:21:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">视频和图片的相互转换</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="blogzz_abstract borderc" style="border-bottom-style:none; border-right-style:none; margin:20px 0px; border-left-style:none; border-top:#ccc 1px dotted; padding-top:15px"> 
 <div class="blogzz_ainfo" style="margin-bottom:12px"> 
  <span style="margin-right:25px"><strong><span style="margin-right:25px"><strong></strong></span><span style="margin-right:25px"><strong></strong></span><span style="margin-right:25px"><strong></strong></span><span style="margin-right:25px"><strong></strong></span>原文地址：</strong><a title="opencv提取视频每一帧" href="http://blog.sina.com.cn/s/blog_5f5931540100rt4n.html" rel="nofollow noopener noreferrer" target="_blank">opencv提取视频每一帧</a></span> 
  <strong>作者：</strong><a title="岳麓迷魂" href="http://blog.sina.com.cn/u/1599680852" rel="nofollow noopener noreferrer" target="_blank">岳麓迷魂</a> 
 </div> 
 <div class="blogzz_acon"> 
  <p><br> //<br> // test3.cpp<br> //<br> // 该程序实现视频和图片的相互转换.<br> // Image_to_video()函数将一组图片合成AVI视频文件.<br> // Video_to_image()函数将AVI视频文件读入，将每一帧存储为jpg文件.<br> //<br> <br> #include &lt;stdlib.h&gt;<br> #include &lt;stdio.h&gt;<br> #include &lt;math.h&gt;<br> #include &lt;cv.h&gt;<br> #include &lt;highgui.h&gt;</p> 
  <p>#define NUM_FRAME 300 //只处理前300帧，根据视频帧数可修改</p> 
  <p><br> void Video_to_image(char* filename)<br> {<!-- --><br> printf("------------- video to image ... ----------------n");</p> 
  <p>//初始化一个视频文件捕捉器<br> CvCapture* capture = cvCaptureFromAVI(filename);</p> 
  <p>//获取视频信息<br> cvQueryFrame(capture);<br> int frameH <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> = (int) cvGetCaptureProperty(capture, CV_CAP_PROP_FRAME_HEIGHT);<br> int frameW <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> = (int) cvGetCaptureProperty(capture, CV_CAP_PROP_FRAME_WIDTH);<br> int fps <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> = (int) cvGetCaptureProperty(capture, CV_CAP_PROP_FPS);<br> int numFrames = (int) cvGetCaptureProperty(capture, CV_CAP_PROP_FRAME_COUNT);<br> printf("tvideo height : %dntvideo width : %dntfps : %dntframe numbers : %dn", frameH, frameW, fps, numFrames);</p> 
  <p>//定义和初始化变量<br> int i = 0;<br> IplImage* img = 0;<br> char image_name[13];<br> <br> cvNamedWindow( "mainWin", CV_WINDOW_AUTOSIZE );</p> 
  <p>//读取和显示<br> while(1)<br> {<!-- --><br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr><br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> img = cvQueryFrame(capture); //获取一帧图片<br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> cvShowImage( "mainWin", img ); //将其显示<br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> char key = cvWaitKey(20);<br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr><br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> sprintf(image_name, "%s%d%s", "image", ++i, ".jpg");//保存的图片名<br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr><br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> cvSaveImage( image_name, img); <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> //保存一帧图片</p> 
  <p><br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> if(i == NUM_FRAME) break;<br> }</p> 
  <p>cvReleaseCapture(&amp;capture);<br> cvDestroyWindow("mainWin");<br> }</p> 
  <p> <wbr></wbr><wbr></wbr></p> 
  <p>void Image_to_video()<br> {<!-- --><br> int i = 0;<br> IplImage* img = 0;<br> char image_name[13];</p> 
  <p>printf("------------- image to video ... ----------------n");</p> 
  <p>//初始化视频编写器，参数根据实际视频文件修改<br> CvVideoWriter *writer = 0;<br> int isColor = 1;<br> int fps <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> = 30; // or 25<br> int frameW = 400; // 744 for firewire cameras<br> int frameH = 240; // 480 for firewire cameras<br> writer=cvCreateVideoWriter("out.avi",CV_FOURCC('X','V','I','D'),fps,cvSize(frameW,frameH),isColor);</p> 
  <p>printf("tvideo height : %dntvideo width : %dntfps : %dn", frameH, frameW, fps);</p> 
  <p>//创建窗口<br> cvNamedWindow( "mainWin", CV_WINDOW_AUTOSIZE );</p> 
  <p>while(i&lt;NUM_FRAME)<br> {<!-- --><br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> sprintf(image_name, "%s%d%s", "image", ++i, ".jpg");<br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> img = cvLoadImage(image_name);<br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> if(!img)<br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> {<!-- --><br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> printf("Could not load image file...n");<br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> exit(0);<br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> }<br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> cvShowImage("mainWin", img);<br>  <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> char key = cvWaitKey(20);</p> 
  <p> <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> cvWriteFrame(writer, img);<br> }</p> 
  <p>cvReleaseVideoWriter(&amp;writer);<br> cvDestroyWindow("mainWin");<br> }</p> 
  <p><br> int main(int argc, char *argv[])<br> {<!-- --></p> 
  <p>char filename[13] = "infile.avi";</p> 
  <p>Video_to_image(filename); //视频转图片</p> 
  <p>Image_to_video(); <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> <wbr></wbr><wbr></wbr> //图片转视频</p> return 0; 
  <br> } 
  <br> //------------------------------------------------------------------------------- 
 </div> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9675aa480e4dbf91a473f499adc15702/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">播放器适配经验总结——IOS</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/39ec3455909f0e20287e9904a9b9763b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SQL Server 2000本地系统账户和域用户账户的选择</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>