<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#实现访问OPC UA服务器 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#实现访问OPC UA服务器" />
<meta property="og:description" content="OPC UA服务器支持三种认证方式，分别是匿名认证、用户认证和证书认证。其中匿名认证安全等级最低，访问不做任何校验。用户认证访问时，OPC UA客户端需要提供用户名及密码认证，只有用户名和密码正确才允许访问。
而证书认证，首先需要将客户端公钥证书提供给OPC UA服务器。然后客户端使用其公钥和私钥证书认证，认证成功后才能访问。
C#访问OPC UA服务器步骤如下：
1. 下载安装OPC UA服务器
OPC UA服务器下载及说明：EasyOPC
2. 连接OPC UA服务器
首先通过NuGet引入最新版OpcUaHelper。
匿名认证：
OpcUaClient opcUaClient = new OpcUaHelper.OpcUaClient(); opcUaClient.ConnectServer(&#34;opc.tcp://127.0.0.1:4840&#34;).Wait(); 用户认证：
OpcUaClient opcUaClient = new OpcUaHelper.OpcUaClient(); //用户及密码验证 opcUaClient.UserIdentity = new UserIdentity(&#34;test&#34;, &#34;123456&#34;); opcUaClient.ConnectServer(&#34;opc.tcp://127.0.0.1:4840&#34;).Wait(); 证书认证
3. 读取OPC UA节点
//读节点值 Double Temp = opcUaClient.ReadNode&lt;Double&gt;(&#34;ns=2;s=factory_1/line1/Temp&#34;); 4. 写OPC UA节点
//写节点值 opcUaClient.WriteNode&lt;Double&gt;(&#34;ns=2;s=factory_1/line1/Temp&#34;, 10.20); 5. 订阅OPC UA节点
订阅节点值发生改变，就会执行订阅事件
//订阅节点，ns=2;s=factory_1/line1/Temp 节点值发生改变执行事件 opcUaClient.AddSubscription(&#34;temp_subscription&#34;, &#34;ns=2;s=factory_1/line1/Temp&#34;, (string key, MonitoredItem item, MonitoredItemNotificationEventArgs eventArgs) =&gt; { var itemNotification = (MonitoredItemNotification)eventArgs." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/1d05071bf943cec113806dc17c295cc3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-16T15:01:31+08:00" />
<meta property="article:modified_time" content="2023-12-16T15:01:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#实现访问OPC UA服务器</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>OPC UA服务器支持三种认证方式，分别是匿名认证、用户认证和证书认证。其中匿名认证安全等级最低，访问不做任何校验。用户认证访问时，OPC UA客户端需要提供用户名及密码认证，只有用户名和密码正确才允许访问。<br> 而证书认证，首先需要将客户端公钥证书提供给OPC UA服务器。然后客户端使用其公钥和私钥证书认证，认证成功后才能访问。<br> C#访问OPC UA服务器步骤如下：</p> 
<p><strong>1. 下载安装OPC UA服务器</strong><br> OPC UA服务器下载及说明：<a href="https://download.csdn.net/download/xuhang01/88576112?spm=1001.2014.3001.5503">EasyOPC</a></p> 
<p><strong>2. 连接OPC UA服务器</strong><br> 首先通过NuGet引入最新版OpcUaHelper。</p> 
<p>匿名认证：</p> 
<pre><code> OpcUaClient opcUaClient = new OpcUaHelper.OpcUaClient();

   opcUaClient.ConnectServer("opc.tcp://127.0.0.1:4840").Wait();
</code></pre> 
<p>用户认证：</p> 
<pre><code>  OpcUaClient opcUaClient = new OpcUaHelper.OpcUaClient();

  //用户及密码验证
  opcUaClient.UserIdentity = new UserIdentity("test", "123456");

 opcUaClient.ConnectServer("opc.tcp://127.0.0.1:4840").Wait();
</code></pre> 
<p>证书认证</p> 
<p><img src="https://images2.imgbox.com/cc/28/BfUr561a_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/21/35/ujhmv2U1_o.png" alt=""></p> 
<p><strong>3. 读取OPC UA节点</strong></p> 
<pre><code> //读节点值
 Double Temp = opcUaClient.ReadNode&lt;Double&gt;("ns=2;s=factory_1/line1/Temp");
</code></pre> 
<p><strong>4. 写OPC UA节点</strong></p> 
<pre><code>//写节点值
opcUaClient.WriteNode&lt;Double&gt;("ns=2;s=factory_1/line1/Temp", 10.20);
</code></pre> 
<p><strong>5. 订阅OPC UA节点</strong><br> 订阅节点值发生改变，就会执行订阅事件</p> 
<pre><code> //订阅节点，ns=2;s=factory_1/line1/Temp 节点值发生改变执行事件

 opcUaClient.AddSubscription("temp_subscription", "ns=2;s=factory_1/line1/Temp", 
          (string key, MonitoredItem item, MonitoredItemNotificationEventArgs eventArgs) =&gt;
          {
                var itemNotification = (MonitoredItemNotification)eventArgs.NotificationValue;

                            Console.WriteLine((double)itemNotification.Value.Value);

           });
</code></pre> 
<p><a href="http://www.tengeli.cn/225.html" rel="nofollow">下载源代码</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bfd1e3492997bc375397313096a21227/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">使用ps修改图片大小不影响清晰度的方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/87c3838a5d26259eb64b38ae003b80e6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C#基础知识点</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>