<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>海康工业网口相机组播功能 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="海康工业网口相机组播功能" />
<meta property="og:description" content="海康工业网口相机组播功能 1.组播功能MVS演示1.1网络拓扑图1.2MVS功能演示 2.组播功能SDK接口调用实现3.组播功能使用常见问题 什么是组播？ 网口相机的组播功能可以实现多个PC对同一个相机同时进行访问。 简单直白的说，就是电脑A、电脑B、电脑C，可以同时获取一个相机的图像数据，电脑A的软件可以进行图像处理，而电脑B、C的软件可以进行录像监控等等 有什么限制条件？ 1.需要有千兆网交换机进行数据分流，转包 2.同一个相机，只能被一台电脑进行控制（参数设置：曝光修改等），其余的电脑，只能进行图像数据接收 3.只有网口相机支持 1.组播功能MVS演示 本文简单演示下1台相机，通过交换机被两台不同PC链接的情况
1.1网络拓扑图 1.控制端-主机1：用于相机参数配置，图像接收处理
2.接受端-主机2、3,N:仅支持，用于相机图像接收
3.交换机：千兆网交换机，用于相机图像的分包，接收端主机越多，对交换机性能要求越高
1.2MVS功能演示 1.控制端-主机1，以“控制与接收模式”打开相机，开始取流
2.接收端-主机2，以“数据接收模式”打开相机，开始取流
3.在控制端主机设置相机参数，可以看见接收端图像同步变化
2.组播功能SDK接口调用实现 海康SDK提供了示例以供用户调用其接口实现组播功能，示例代码路径如：
C:\Program Files (x86)\MVS\Development\Samples\VC\VS\SimpleSamples\MultiCast
代码整体结构相对简单，在opendevice是，使用不同权限打开相机即可，相机打开部分代码如下：
// ch:选择设备并创建句柄 | en:select device and create handle nRet = MV_CC_CreateHandle(&amp;handle, stDeviceList.pDeviceInfo[nIndex]); if (MV_OK != nRet) { printf(&#34;Create Handle fail! nRet [0x%x]\n&#34;, nRet); break; } // ch:询问用户启动多播控制应用程序或多播监控应用程序 // en:Ask the user to launch: the multicast controlling application or the multicast monitoring application. printf(&#34;Start multicast sample in (c)ontrol or in (m)onitor mode?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/25f337fbb8b3cd955893c4ab3cb34994/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-12T17:33:01+08:00" />
<meta property="article:modified_time" content="2021-11-12T17:33:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">海康工业网口相机组播功能</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>海康工业网口相机组播功能</h4> 
 <ul><li><a href="#1MVS_8" rel="nofollow">1.组播功能MVS演示</a></li><li><ul><li><a href="#11_10" rel="nofollow">1.1网络拓扑图</a></li><li><a href="#12MVS_15" rel="nofollow">1.2MVS功能演示</a></li></ul> 
  </li><li><a href="#2SDK_22" rel="nofollow">2.组播功能SDK接口调用实现</a></li><li><a href="#3_66" rel="nofollow">3.组播功能使用常见问题</a></li></ul> 
</div> 
<br> 
<strong>什么是组播？</strong> 
<br> 网口相机的组播功能可以实现多个PC对同一个相机同时进行访问。 
<br> 简单直白的说，就是电脑A、电脑B、电脑C，可以同时获取一个相机的图像数据，电脑A的软件可以进行图像处理，而电脑B、C的软件可以进行录像监控等等 
<br> 
<strong>有什么限制条件？</strong> 
<br> 1.需要有千兆网交换机进行数据分流，转包 
<br> 2.同一个相机，只能被一台电脑进行控制（参数设置：曝光修改等），其余的电脑，只能进行图像数据接收 
<br> 3.只有网口相机支持 
<p></p> 
<h2><a id="1MVS_8"></a>1.组播功能MVS演示</h2> 
<p>本文简单演示下1台相机，通过交换机被两台不同PC链接的情况</p> 
<h3><a id="11_10"></a>1.1网络拓扑图</h3> 
<p><img src="https://images2.imgbox.com/38/21/KsFkzAtv_o.png" alt="在这里插入图片描述"><br> 1.控制端-主机1：用于相机参数配置，图像接收处理<br> 2.接受端-主机2、3,N:仅支持，用于相机图像接收<br> 3.交换机：千兆网交换机，用于相机图像的分包，接收端主机越多，对交换机性能要求越高</p> 
<h3><a id="12MVS_15"></a>1.2MVS功能演示</h3> 
<p>1.控制端-主机1，以“<strong>控制与接收模式</strong>”打开相机，开始取流<br> <img src="https://images2.imgbox.com/14/22/eBXkZ8bq_o.png" alt="在这里插入图片描述"><br> 2.接收端-主机2，以“数据接收模式”打开相机，开始取流<br> <img src="https://images2.imgbox.com/39/22/e2o5BA3d_o.png" alt="在这里插入图片描述"><br> 3.在<strong>控制端主机</strong>设置相机参数，可以看见接收端图像同步变化<br> <img src="https://images2.imgbox.com/62/56/MRXKzBCN_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="2SDK_22"></a>2.组播功能SDK接口调用实现</h2> 
<p>海康SDK提供了示例以供用户调用其接口实现组播功能，示例代码路径如：<br> <strong>C:\Program Files (x86)\MVS\Development\Samples\VC\VS\SimpleSamples\MultiCast</strong><img src="https://images2.imgbox.com/b2/39/2QbQKMG7_o.png" alt="在这里插入图片描述"><br> 代码整体结构相对简单，在opendevice是，使用不同权限打开相机即可，相机打开部分代码如下：</p> 
<pre><code class="prism language-c">
        <span class="token comment">// ch:选择设备并创建句柄 | en:select device and create handle</span>
        nRet <span class="token operator">=</span> <span class="token function">MV_CC_CreateHandle</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>handle<span class="token punctuation">,</span> stDeviceList<span class="token punctuation">.</span>pDeviceInfo<span class="token punctuation">[</span>nIndex<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Create Handle fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>    
        <span class="token comment">// ch:询问用户启动多播控制应用程序或多播监控应用程序</span>
        <span class="token comment">// en:Ask the user to launch: the multicast controlling application or the multicast monitoring application.</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Start multicast sample in (c)ontrol or in (m)onitor mode? (c/m)\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">char</span> key<span class="token punctuation">;</span>
        <span class="token keyword">do</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token string">'c'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token string">'m'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token string">'C'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token string">'M'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ch:查询用户使用的模式 | en:Query the user for the mode to use.</span>
        bool monitorMode <span class="token operator">=</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'m'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'M'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ch:打开设备 | Open device</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>monitorMode<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            nRet <span class="token operator">=</span> <span class="token function">MV_CC_OpenDevice</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> MV_ACCESS_Monitor<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//接收端</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{<!-- --></span>
            nRet <span class="token operator">=</span> <span class="token function">MV_CC_OpenDevice</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> MV_ACCESS_Control<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//控制与接收</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Open Device fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p>不同电脑上面运行不同的open接口的代码，即可完成组播功能使用<br> <strong>需注意，接收端，不能控制相机参数，即必须控制端先控制相机取流，否则接收端会失败</strong></p> 
<h2><a id="3_66"></a>3.组播功能使用常见问题</h2> 
<p>3.1组播IP地址无效，系统弹框会提示“<strong>请检查IP地址是否有效</strong>”</p> 
<ul><li>组播IP地址应为D类IP地址。<br> 在224.0.0.0～239.255.255.255范围内的地址称为D类IP组播地址。<br> 其中，224.0.0.0～224.0.0.255为预留的组播地址(永久组地址)，地址224.0.0.0保留不做分配，其他地址供路由协议使用。<br> 224.0.1.0～238.255.255.255为用户可用的组播地址(临时组地址)，全网范围内有效。239.0.0.0～239.255.255.255为本地管理组播地址，仅在特定的本地范围内有效。</li></ul> 
<p>3.2组播端口号如何设置</p> 
<ul><li>组播端口号有效值为0~65535，且应该是未被使用的端口号。</li></ul> 
<p>3.3组播IP和端口号修改后不同步</p> 
<ul><li>由于接收端自动配置组播IP和组播端口，在控制端修改组播IP和组播端口号，会出现不同步现象<br> 解决方法：控制端-主机在MVS组播配置中修改IP和端口号后，接收端-主机MVS需要断开相机连接，重新连接后右键-组播配置，查看IP和端口号是否与控制端-主机一致。<br> 端口号不一致需再次断开相机连接，再次连接，直至IP和端口号一致。</li></ul>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9eee0ee42d5f3dc0e55f6cdcc90fb7d1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Hough变换</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/326ba5bcaddcb20185db5c14c39a46be/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">图像边缘检测</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>