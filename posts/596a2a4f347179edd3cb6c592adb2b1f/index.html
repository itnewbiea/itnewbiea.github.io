<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue3中pinia的使用 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue3中pinia的使用" />
<meta property="og:description" content="2.pinia基本使用 1.首先先安装依赖
1
npm install pinia
2.在main.js中引入pinia并创建容器挂载到根实例上
1
2
3
4
//引入stores暴露出的pinia的实例
import pinia from &#39;./stores&#39;
createApp(App).use(pinia).mount(&#39;#app&#39;)
3.创建stores文件夹和index.js文件（这个文件以后基本不用管了）
1
2
3
import { createPinia } from &#34;pinia&#34;;
const pinia = createPinia()
export default pinia
4.在stores文件夹下创建counter.js文件。这个文件就是存有关counter相关的数据。（类似vuex的模块化）
defineStore 是需要传参数的，
第一个参数是id，就是一个唯一的值，简单点说就可以理解成是一个命名空间.第二个参数就是一个对象，里面有三个模块需要处理，第一个是 state，第二个是 getters，第三个是 actions。 1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
//定义关于counter的store
import {defineStore} from &#39;pinia&#39;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/596a2a4f347179edd3cb6c592adb2b1f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-19T09:51:18+08:00" />
<meta property="article:modified_time" content="2023-05-19T09:51:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue3中pinia的使用</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 id="heading-1">2.pinia基本使用</h3> 
<p>1.首先先安装依赖</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>npm install pinia</code></p> </td></tr></tbody></table> 
<p>2.在main.js中引入pinia并创建容器挂载到根实例上</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> </td><td> <p><code>//引入stores暴露出的pinia的实例</code></p> <p><code>import pinia from </code><code>'./stores'</code></p> <p></p> <p><code>createApp(App).use(pinia).mount(</code><code>'#app'</code><code>)</code></p> </td></tr></tbody></table> 
<p>3.创建<strong>stores</strong>文件夹和<strong>index.js</strong>文件（这个文件以后基本不用管了）</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> </td><td> <p><code>import { createPinia } from </code><code>"pinia"</code><code>;</code></p> <p><code>const pinia = createPinia()</code></p> <p><code>export </code><code>default</code> <code>pinia</code></p> </td></tr></tbody></table> 
<p>4.在<strong>stores</strong>文件夹下创建<strong>counter.js</strong>文件。这个文件就是存有关counter相关的数据。（类似vuex的模块化）</p> 
<p><strong>defineStore</strong> 是需要传参数的，</p> 
<ul><li>第一个参数是id，就是一个唯一的值，简单点说就可以理解成是一个命名空间.</li><li>第二个参数就是一个对象，里面有三个模块需要处理，第一个是 state，第二个是 getters，第三个是 actions。</li></ul> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> <p>14</p> <p>15</p> <p>16</p> <p>17</p> <p>18</p> <p>19</p> <p>20</p> <p>21</p> <p>22</p> <p>23</p> <p>24</p> </td><td> <p><code>//定义关于counter的store</code></p> <p><code>import {defineStore} from </code><code>'pinia'</code></p> <p></p> <p><code>/*defineStore 是需要传参数的，其中第一个参数是id，就是一个唯一的值，</code></p> <p><code>简单点说就可以理解成是一个命名空间.</code></p> <p><code>第二个参数就是一个对象，里面有三个模块需要处理，第一个是 state，</code></p> <p><code>第二个是 getters，第三个是 actions。</code></p> <p><code>*/</code></p> <p><code>const useCounter = defineStore(</code><code>"counter"</code><code>,{<!-- --></code></p> <p><code>    </code><code>state:() =&gt; ({<!-- --></code></p> <p><code>        </code><code>count:66,</code></p> <p><code>    </code><code>}),</code></p> <p><code>    </code> </p> <p><code>    </code><code>getters: {<!-- --></code></p> <p></p> <p><code>    </code><code>},</code></p> <p></p> <p><code>    </code><code>actions: {<!-- --></code></p> <p></p> <p><code>    </code><code>}</code></p> <p><code>})</code></p> <p></p> <p><code>//暴露这个useCounter模块</code></p> <p><code>export </code><code>default</code> <code>useCounter</code></p> </td></tr></tbody></table> 
<blockquote> 
 <p>注意：返回的函数统一使用useXXX作为命名方案，这是约定的规矩。例如上面的useCounter</p> 
</blockquote> 
<p>5.然后再组件中使用：</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> </td><td> <p><code>&lt;template&gt;</code></p> <p><code>    </code><code>&lt;!-- 在页面中直接使用就可以了 不用 .state--&gt;</code></p> <p><code>  </code><code>&lt;div&gt;展示pinia的counter的count值：{<!-- -->{counterStore.count}}&lt;/div&gt;</code></p> <p></p> <p><code>&lt;/template&gt;</code></p> <p></p> <p><code>&lt;script setup&gt;</code></p> <p><code>// 首先需要引入一下我们刚刚创建的store</code></p> <p><code>import useCounter from </code><code>'../stores/counter'</code></p> <p><code>// 因为是个方法，所以我们得调用一下</code></p> <p><code>const counterStore = useCounter()</code></p> <p></p> <p><code>&lt;/script&gt;</code></p> </td></tr></tbody></table> 
<blockquote> 
 <p>注意：在模板使用 ，不用和vuex一样还要.state,直接点state里面的K</p> 
</blockquote> 
<p>运行效果： <strong>可以用vue3的调试工具看pinia</strong></p> 
<p></p> 
<p><a name="_lab2_1_0"></a></p> 
<h4 id="heading-2">2.1注意Store获取到后不能解构，否则失去响应式</h4> 
<p>案例需求，点击按钮加一：</p> 
<p>一个不解构，一个不解构看看区别。</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> <p>14</p> <p>15</p> <p>16</p> <p>17</p> <p>18</p> </td><td> <p><code>&lt;template&gt;</code></p> <p><code>  </code><code>&lt;div&gt;展示pinia的counter的count值：{<!-- -->{counterStore.count}}&lt;/div&gt;</code></p> <p><code>  </code><code>&lt;div&gt;展示解构出来的pinia的counter的count值：{<!-- -->{count}}&lt;/div&gt;</code></p> <p><code>  </code><code>&lt;button @click=</code><code>"addCount"</code><code>&gt;count+1&lt;/button&gt;</code></p> <p><code>&lt;/template&gt;</code></p> <p></p> <p><code>&lt;script setup&gt;</code></p> <p><code>    </code><code>import useCounter from </code><code>'../stores/counter'</code></p> <p><code>    </code> </p> <p><code>    </code><code>const counterStore = useCounter()</code></p> <p><code>    </code> </p> <p><code>    </code><code>const {count} = counterStore</code></p> <p><code>    </code> </p> <p><code>    </code><code>function</code> <code>addCount(){<!-- --></code></p> <p><code>      </code><code>//这里可以直接操作count，这就是pinia好处，在vuex还要commit在mutaitions修改数据</code></p> <p><code>      </code><code>counterStore.count++</code></p> <p><code>    </code><code>}</code></p> <p><code>&lt;script/&gt;</code></p> </td></tr></tbody></table> 
<blockquote> 
 <p>在 vuex 里面是坚决不允许这样子直接操作 state 数据的，pinia是可以的，看看上面的addCount函数直接操作。</p> 
</blockquote> 
<p>运行结果：</p> 
<p></p> 
<p>解决方案：</p> 
<p><strong>pinia提供了一个函数storeToRefs</strong>解决。引用官方API storeToRef 作用就是把结构的数据使用ref做代理</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> </td><td> <p><code>import {storeToRefs} from </code><code>'pinia'</code></p> <p><code>const counterStore = useCounter()</code></p> <p><code>const {count} = storeToRefs(counterStore)</code></p> </td></tr></tbody></table> 
<p>现在数据都是响应式的了</p> 
<p></p> 
<p><a name="_label2"></a></p> 
<h3 id="heading-3">3.修改state的数据</h3> 
<p>重新新建一个user模块</p> 
<p><strong>stores/user.js</strong></p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> </td><td> <p><code>//定义一个关于user的store</code></p> <p><code>import {defineStore} from </code><code>'pinia'</code></p> <p></p> <p><code>const useUser = defineStore(</code><code>"user"</code><code>,{<!-- --></code></p> <p><code>    </code><code>state:()=&gt;({<!-- --></code></p> <p><code>        </code><code>name:</code><code>"紫陌"</code><code>,</code></p> <p><code>        </code><code>age:18</code></p> <p><code>    </code><code>})</code></p> <p><code>})</code></p> <p></p> <p><code>export </code><code>default</code> <code>useUser</code></p> </td></tr></tbody></table> 
<p>组件中修改数据：</p> 
<p>**第一种方法：**点击按钮修改数据，这种方法是最直接的修改数据</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> <p>14</p> <p>15</p> <p>16</p> <p>17</p> <p>18</p> <p>19</p> <p>20</p> <p>21</p> <p>22</p> <p>23</p> </td><td> <p><code>&lt;template&gt;</code></p> <p><code>    </code><code>&lt;div&gt;</code></p> <p><code>        </code><code>&lt;h2&gt;名字是：{<!-- -->{name}}&lt;/h2&gt;</code></p> <p><code>        </code><code>&lt;h2&gt;年龄是：{<!-- -->{age}}&lt;/h2&gt;</code></p> <p><code>        </code><code>&lt;button @click=</code><code>"updateStore"</code><code>&gt;修改Store数据&lt;/button&gt;</code></p> <p><code>    </code><code>&lt;/div&gt;</code></p> <p></p> <p></p> <p><code>&lt;/template&gt;</code></p> <p></p> <p><code>&lt;script setup&gt;</code></p> <p><code>import useUser from </code><code>'../stores/user'</code></p> <p><code>import {storeToRefs} from </code><code>'pinia'</code></p> <p></p> <p><code>const userStore = useUser()</code></p> <p></p> <p><code>const {name,age} = storeToRefs(userStore)</code></p> <p></p> <p><code>function</code> <code>updateStore(){<!-- --></code></p> <p><code>    </code><code>//一个个的修改状态</code></p> <p><code>    </code><code>userStore.name = </code><code>"zimo"</code></p> <p><code>    </code><code>userStore.age = 20</code></p> <p><code>}</code></p> </td></tr></tbody></table> 
<p>效果：点击也修改了</p> 
<p></p> 
<p><strong>第二种方法：$patch函数修改</strong></p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> </td><td> <p><code>function</code> <code>updateStore(){<!-- --></code></p> <p><code>    </code><code>//一个个的修改状态</code></p> <p><code>    </code><code>// userStore.name = "zimo"</code></p> <p><code>    </code><code>// userStore.age = 20</code></p> <p></p> <p><code>    </code><code>// 一次性修改多个状态</code></p> <p><code>    </code><code>userStore.$patch({<!-- --></code></p> <p><code>        </code><code>name:</code><code>"zimo"</code><code>,</code></p> <p><code>        </code><code>age:20</code></p> <p><code>    </code><code>})</code></p> <p><code>}</code></p> </td></tr></tbody></table> 
<p>这个方式也可以，效果一样。</p> 
<p>第三种方法：$state 方式（这个是替换的方式。）这个基本不用，这里就不多说。可以看查阅文档。</p> 
<p><strong>第四种方法：$reset()函数是重置state数据的</strong></p> 
<p>新增一个重置按钮：</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> </td><td> <p><code>function</code> <code>resetStore(){<!-- --></code></p> <p><code>    </code><code>userStore.$reset()</code></p> <p><code>}</code></p> </td></tr></tbody></table> 
<p><strong>运行结果：点击了修改数据按钮之后在点重置按钮就恢复原始的数据。</strong></p> 
<p></p> 
<p><a name="_label3"></a></p> 
<h3 id="heading-4">4.getters的使用</h3> 
<p>getters 类似于 vue 里面的计算属性，可以对已有的数据进行修饰。不管调用多少次，getters中的函数只会执行一次，且都会缓存。</p> 
<p><strong>1.最基本的使用</strong></p> 
<p>在counter模块演示了，counter模块：</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> <p>14</p> <p>15</p> <p>16</p> <p>17</p> <p>18</p> </td><td> <p><code>//定义关于counter的store</code></p> <p><code>import {defineStore} from </code><code>'pinia'</code></p> <p></p> <p><code>const useCounter = defineStore(</code><code>"counter"</code><code>,{<!-- --></code></p> <p><code>    </code><code>state:() =&gt; ({<!-- --></code></p> <p><code>        </code><code>count:66,</code></p> <p><code>    </code><code>}),</code></p> <p></p> <p><code>    </code><code>getters:{<!-- --></code></p> <p><code>        </code><code>//基本使用</code></p> <p><code>        </code><code>doubleCount(state) {<!-- --></code></p> <p><code>            </code><code>return</code> <code>state.count * 2</code></p> <p><code>        </code><code>},</code></p> <p><code>    </code><code>},</code></p> <p><code>})</code></p> <p></p> <p><code>//暴露这个useCounter模块</code></p> <p><code>export </code><code>default</code> <code>useCounter</code></p> </td></tr></tbody></table> 
<p>组件中：</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> </td><td> <p><code>&lt;</code><code>div</code><code>&gt;</code></p> <p><code>      </code><code>&lt;</code><code>h1</code><code>&gt;getters的使用&lt;/</code><code>h1</code><code>&gt;</code></p> <p><code>      </code><code>&lt;</code><code>h2</code><code>&gt;doubleCount:{<!-- -->{counterStore.doubleCount}}&lt;/</code><code>h2</code><code>&gt;</code></p> <p><code>  </code><code>&lt;/</code><code>div</code><code>&gt;</code></p> </td></tr></tbody></table> 
<p>运行效果：</p> 
<p></p> 
<p>这样就是最基本的使用了。</p> 
<p><strong>2.一个getter引入另外一个getter</strong></p> 
<p>couter模块：</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> </td><td> <p><code>getters:{<!-- --></code></p> <p><code>        </code><code>//基本使用</code></p> <p><code>        </code><code>doubleCount(state) {<!-- --></code></p> <p><code>            </code><code>return</code> <code>state.count * 2</code></p> <p><code>        </code><code>},</code></p> <p><code>        </code><code>//一个getter引入另外一个getter</code></p> <p><code>        </code><code>doubleCountAddTwo(){<!-- --></code></p> <p><code>            </code><code>console.log(</code><code>this</code><code>);</code></p> <p><code>            </code><code>//this.是store实例</code></p> <p><code>            </code><code>return</code> <code>this</code><code>.doubleCount + 2</code></p> <p><code>        </code><code>}</code></p> <p><code>    </code><code>},</code></p> </td></tr></tbody></table> 
<p>组件中使用：</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> </td><td> <p><code>&lt;</code><code>div</code><code>&gt;</code></p> <p><code>        </code><code>&lt;</code><code>h1</code><code>&gt;getters的使用&lt;/</code><code>h1</code><code>&gt;</code></p> <p><code>        </code><code>&lt;</code><code>h2</code><code>&gt;doubleCount:{<!-- -->{counterStore.doubleCount}}&lt;/</code><code>h2</code><code>&gt;</code></p> <p><code>        </code><code>&lt;</code><code>h2</code><code>&gt;doubleCountAddTwo:{<!-- -->{counterStore.doubleCountAddTwo}}&lt;/</code><code>h2</code><code>&gt;</code></p> <p><code>    </code><code>&lt;/</code><code>div</code><code>&gt;</code></p> </td></tr></tbody></table> 
<p>运行效果并且看看打印的this：</p> 
<p></p> 
<p></p> 
<p>3.<strong>getters中用别的store中的数据</strong></p> 
<blockquote> 
 <p><strong>在counter模块中拿user模块的store数据。</strong></p> 
</blockquote> 
<p>count模块：</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> <p>14</p> <p>15</p> <p>16</p> <p>17</p> <p>18</p> <p>19</p> <p>20</p> <p>21</p> <p>22</p> <p>23</p> <p>24</p> <p>25</p> <p>26</p> <p>27</p> <p>28</p> <p>29</p> <p>30</p> <p>31</p> <p>32</p> <p>33</p> </td><td> <p><code>//定义关于counter的store</code></p> <p><code>import {defineStore} from </code><code>'pinia'</code></p> <p><code>import useUser from </code><code>"./user"</code></p> <p><code>const useCounter = defineStore(</code><code>"counter"</code><code>,{<!-- --></code></p> <p><code>    </code><code>state:() =&gt; ({<!-- --></code></p> <p><code>        </code><code>count:66,</code></p> <p><code>    </code><code>}),</code></p> <p></p> <p><code>    </code><code>getters:{<!-- --></code></p> <p><code>        </code><code>//基本使用</code></p> <p><code>        </code><code>doubleCount(state) {<!-- --></code></p> <p><code>            </code><code>return</code> <code>state.count * 2</code></p> <p><code>        </code><code>},</code></p> <p><code>        </code><code>//一个getter引入另外一个getter</code></p> <p><code>        </code><code>doubleCountAddTwo(){<!-- --></code></p> <p><code>            </code><code>console.log(</code><code>this</code><code>);</code></p> <p><code>            </code><code>//this.是store实例</code></p> <p><code>            </code><code>return</code> <code>this</code><code>.doubleCount + 2</code></p> <p><code>        </code><code>},</code></p> <p><code>        </code><code>//getters中用别的store中的数据</code></p> <p><code>        </code><code>showMessage(state){<!-- --></code></p> <p><code>            </code><code>console.log(state);</code></p> <p><code>            </code><code>console.log(</code><code>this</code><code>)</code></p> <p><code>            </code><code>//获取user信息，拿到useUser模块</code></p> <p><code>            </code><code>const userStore = useUser()</code></p> <p><code>            </code><code>//拼接信息</code></p> <p><code>            </code><code>return</code> <code>`name：${userStore.name}--count:${state.count}`</code></p> <p><code>        </code><code>}</code></p> <p><code>    </code><code>},</code></p> <p><code>})</code></p> <p></p> <p><code>//暴露这个useCounter模块</code></p> <p><code>export </code><code>default</code> <code>useCounter</code></p> </td></tr></tbody></table> 
<p><strong>注意：要引入user模块</strong></p> 
<p>组件中：</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> </td><td> <p><code>&lt;</code><code>div</code><code>&gt;</code></p> <p><code>       </code><code>&lt;</code><code>h1</code><code>&gt;getters的使用&lt;/</code><code>h1</code><code>&gt;</code></p> <p><code>       </code><code>&lt;</code><code>h2</code><code>&gt;doubleCount:{<!-- -->{counterStore.doubleCount}}&lt;/</code><code>h2</code><code>&gt;</code></p> <p><code>       </code><code>&lt;</code><code>h2</code><code>&gt;doubleCountAddTwo:{<!-- -->{counterStore.doubleCountAddTwo}}&lt;/</code><code>h2</code><code>&gt;</code></p> <p><code>       </code><code>&lt;</code><code>h2</code><code>&gt;showMessage:{<!-- -->{counterStore.showMessage}}&lt;/</code><code>h2</code><code>&gt;</code></p> <p><code>   </code><code>&lt;/</code><code>div</code><code>&gt;</code></p> </td></tr></tbody></table> 
<p>运行结果：</p> 
<p></p> 
<p><strong>注意：我打印了this和store，他们都是当前这这个模块的实例</strong></p> 
<p></p> 
<p>这样就在counter模块拿到了user模块的数据了。</p> 
<p><a name="_label4"></a></p> 
<h3 id="heading-5">5. actions的使用</h3> 
<blockquote> 
 <p><strong>actions 是可以处理同步，也可以处理异步，同步的话相对来说简单一点.actions类似methods</strong></p> 
</blockquote> 
<p><strong>1.先看同步使用</strong>：</p> 
<p>counter模块使用：</p> 
<p>在actions定义了两个函数一个加一的函数，一个加20的函数。</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> <p>14</p> <p>15</p> <p>16</p> <p>17</p> <p>18</p> <p>19</p> <p>20</p> <p>21</p> </td><td> <p><code>//定义关于counter的store</code></p> <p><code>import {defineStore} from </code><code>'pinia'</code></p> <p><code>const useCounter = defineStore(</code><code>"counter"</code><code>,{<!-- --></code></p> <p><code>    </code><code>state:() =&gt; ({<!-- --></code></p> <p><code>        </code><code>count:66,</code></p> <p><code>    </code><code>}),</code></p> <p></p> <p><code>    </code><code>actions:{<!-- --></code></p> <p><code>        </code><code>increment(state){<!-- --></code></p> <p><code>            </code><code>//actions没有state，只能通过this拿store，这里打印</code></p> <p><code>            </code><code>console.log(state);</code></p> <p><code>            </code><code>this</code><code>.count++</code></p> <p><code>        </code><code>},</code></p> <p><code>        </code><code>incrementNum(num){<!-- --></code></p> <p><code>            </code><code>this</code><code>.count += num</code></p> <p><code>        </code><code>}</code></p> <p><code>    </code><code>}</code></p> <p><code>})</code></p> <p></p> <p><code>//暴露这个useCounter模块</code></p> <p><code>export </code><code>default</code> <code>useCounter</code></p> </td></tr></tbody></table> 
<p>组件中：</p> 
<p>actions函数在组件中使用</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> <p>14</p> <p>15</p> <p>16</p> <p>17</p> <p>18</p> </td><td> <p><code>    </code><code>&lt;div&gt;</code></p> <p><code>        </code><code>&lt;h1&gt;actions的使用&lt;/h1&gt;</code></p> <p><code>        </code><code>&lt;h2&gt;count的事值：{<!-- -->{counterStore.count}}&lt;/h2&gt;</code></p> <p><code>        </code><code>&lt;button @click=</code><code>"changeState"</code><code>&gt;count+1&lt;/button&gt;</code></p> <p><code>        </code><code>&lt;button @click=</code><code>"incrementNum"</code><code>&gt;count+20&lt;/button&gt;</code></p> <p><code>      </code><code>&lt;/div&gt;</code></p> <p></p> <p><code>&lt;script setup&gt;</code></p> <p><code>    </code><code>import useCounter from </code><code>'../stores/counter'</code></p> <p><code>    </code><code>const counterStore = useCounter()</code></p> <p><code>    </code> </p> <p><code>    </code><code>function</code> <code>changeState(){<!-- --></code></p> <p><code>      </code><code>counterStore.increment()</code></p> <p><code>    </code><code>}</code></p> <p><code>    </code><code>function</code> <code>incrementNum(){<!-- --></code></p> <p><code>      </code><code>counterStore.incrementNum(20)</code></p> <p><code>    </code><code>}</code></p> <p><code>&lt;/script&gt;</code></p> </td></tr></tbody></table> 
<p>运行结果并且看看state是什么</p> 
<p>初始值是66，点了一次加1和点了一次加20</p> 
<p></p> 
<blockquote> 
 <p>注意：<strong>state的结果是undefined</strong> 所以actions只能通过this访问store。getter的话state和this都能访问。</p> 
</blockquote> 
<p></p> 
<p><strong>2.异步操作使用</strong></p> 
<p><strong>在 actions 处理异步的时候呢，我们一般是与 async 和 await 连用。</strong></p> 
<p>counter模块： 这里大致演示，具体还看自己怎么使用。</p> 
<pre>    state:() =&gt; ({
        count:66,
        list:[]
    }),
	actions:{
        //大概演示这个异步流程
        async axiosData(){
            const res = await fetch("http://-----------------")
            if(code ==200){
                //收到数据保存到store
                this.list = res.data.list
                return "ok"
            }
        }

    }
</pre> 
<p>组件使用：</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> </td><td> <p><code>&lt;template&gt;</code></p> <p><code>      </code><code>&lt;!-- 遍历store的数据 --&gt;</code></p> <p><code>      </code><code>&lt;div v-</code><code>for</code><code>=</code><code>"item in counterStore.list"</code><code>&gt;&lt;/div&gt;</code></p> <p><code>&lt;/template&gt;</code></p> <p></p> <p><code>&lt;script setup&gt;</code></p> <p><code>import useCounter from </code><code>'../stores/counter'</code></p> <p><code>const counterStore = useCounter()</code></p> <p></p> <p><code>counterStore.axiosData().then(res =&gt;{<!-- --></code></p> <p><code>  </code><code>console.log(</code><code>"成功"</code><code>,res);</code></p> <p><code>})</code></p> <p><code>&lt;/script&gt;</code></p> </td></tr></tbody></table> 
<p>就这样可以啦！！！</p> 
<p>是不是比vuex简洁很多。。。</p> 
<p><a name="_label5"></a></p> 
<h3 id="heading-6">6.数据的持久化</h3> 
<p>pinia支持扩展插件</p> 
<p>我们想实现数据持久化</p> 
<blockquote> 
 <p><strong>npm i pinia-plugin-persist</strong></p> 
</blockquote> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> <p>14</p> </td><td> <p><code>export const useUserStore = defineStore({<!-- --></code></p> <p><code>  </code><code>state () {<!-- --></code></p> <p><code>    </code><code>return</code> <code>{<!-- --></code></p> <p><code>      </code><code>count: 0,</code></p> <p><code>      </code><code>num: 101,</code></p> <p><code>      </code><code>list: [1, 2, 3, 4 ]</code></p> <p><code>    </code><code>}</code></p> <p><code>  </code><code>},</code></p> <p><code>  </code><code>persist: {<!-- --></code></p> <p><code>    </code><code>enabled: </code><code>true</code><code>, </code><code>// 开启缓存  默认会存储在本地localstorage</code></p> <p><code>    </code><code>storage: sessionStorage, </code><code>// 缓存使用方式</code></p> <p><code>    </code><code>paths:[] </code><code>// 需要缓存键 </code></p> <p><code>  </code><code>}</code></p> <p><code>})</code></p> <p><a href="https://www.jb51.net/article/282396.htm" rel="nofollow" title="Vue3中的pinia使用方法总结(建议收藏版)_vue.js_脚本之家">Vue3中的pinia使用方法总结(建议收藏版)_vue.js_脚本之家</a></p> </td></tr></tbody></table> 
<p></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/da4c3049443318fa16bd173435bae6f4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">PCL可视化</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a6fe609fa2ce265770102e035eec8fec/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Vue - vxe-table 表格合并行应用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>