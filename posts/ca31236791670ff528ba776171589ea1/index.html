<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【个人学习】使用torch实现xml文件返回的图片 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【个人学习】使用torch实现xml文件返回的图片" />
<meta property="og:description" content="个人学习使用，若有错误，敬请指正
主要实现 构建数据集类，使用xml的文件信息去提取车牌特征，转换尺寸之后输入神经网络。
因为没有搜索到纯代码实现xml的图片内容，所以自己尝试使用torch框架并实现。
实现代码 导入包和定义文件路径 import os import matplotlib.pyplot as plt from PIL import Image import random import xml.etree.ElementTree as ET import torch import torch.optim as optim from torchvision import transforms, datasets,utils from torch.utils.data import DataLoader, Dataset from skimage import io, transform import glob import torchvision import numpy as np plt.rcParams[&#34;font.sans-serif&#34;]=[&#34;SimHei&#34;] #设置字体 plt.rcParams[&#34;axes.unicode_minus&#34;]=False #该语句解决图像中的缺失中文 # 定义训练集和测试集的路径 trainData_dir = &#39;Train/images&#39; testData_dir = &#39;Test/images&#39; # 引入Annotations文件来增强特征提取 trainAnno_dir = &#39;Train/annotations&#39; testAnno_dir = &#39;Train/annotations&#39; images= os." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/ca31236791670ff528ba776171589ea1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-09T21:30:05+08:00" />
<meta property="article:modified_time" content="2023-04-09T21:30:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【个人学习】使用torch实现xml文件返回的图片</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>个人学习使用，若有错误，敬请指正</p> 
</blockquote> 
<h2><a id="_2"></a>主要实现</h2> 
<p>构建数据集类，使用xml的文件信息去提取车牌特征，转换尺寸之后输入神经网络。</p> 
<blockquote> 
 <p>因为没有搜索到纯代码实现xml的图片内容，所以自己尝试使用torch框架并实现。</p> 
</blockquote> 
<h2><a id="_5"></a>实现代码</h2> 
<h3><a id="_6"></a>导入包和定义文件路径</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> os 
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt 
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
<span class="token keyword">import</span> random
<span class="token keyword">import</span> xml<span class="token punctuation">.</span>etree<span class="token punctuation">.</span>ElementTree <span class="token keyword">as</span> ET
<span class="token keyword">import</span> torch
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">as</span> optim 
<span class="token keyword">from</span> torchvision <span class="token keyword">import</span> transforms<span class="token punctuation">,</span> datasets<span class="token punctuation">,</span>utils
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataLoader<span class="token punctuation">,</span> Dataset
<span class="token keyword">from</span> skimage <span class="token keyword">import</span> io<span class="token punctuation">,</span> transform
<span class="token keyword">import</span> glob 
<span class="token keyword">import</span> torchvision 
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np 
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">"font.sans-serif"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"SimHei"</span><span class="token punctuation">]</span> <span class="token comment">#设置字体</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">"axes.unicode_minus"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span> <span class="token comment">#该语句解决图像中的缺失中文</span>

<span class="token comment"># 定义训练集和测试集的路径</span>
trainData_dir <span class="token operator">=</span> <span class="token string">'Train/images'</span>
testData_dir <span class="token operator">=</span> <span class="token string">'Test/images'</span>
<span class="token comment"># 引入Annotations文件来增强特征提取</span>
trainAnno_dir <span class="token operator">=</span> <span class="token string">'Train/annotations'</span>
testAnno_dir <span class="token operator">=</span> <span class="token string">'Train/annotations'</span>

images<span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>trainData_dir<span class="token punctuation">)</span>
<span class="token comment"># print(f'文件夹下总共有{len(images)}条数据')</span>

<span class="token comment"># 构建图片名称和索引的映射</span>
name_map <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>images<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># print(images[i][:-4])</span>
    name_map<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span>  images<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>name_map<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_43"></a>自定义数据集的类</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''https://pytorch.org/tutorials/beginner/data_loading_tutorial.html
'''</span>
<span class="token keyword">class</span> <span class="token class-name">XMLDataset</span><span class="token punctuation">(</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>trainData_dir<span class="token punctuation">,</span>trainAnno_dir<span class="token punctuation">,</span>name_map<span class="token punctuation">,</span>transform<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 图像总路径</span>
        self<span class="token punctuation">.</span>img_path <span class="token operator">=</span> trainData_dir
        <span class="token comment"># 注解总路径</span>
        self<span class="token punctuation">.</span>ann_path <span class="token operator">=</span> trainAnno_dir
        <span class="token comment"># 总名称路径</span>
        self<span class="token punctuation">.</span>name_map <span class="token operator">=</span> name_map
        self<span class="token punctuation">.</span>transform <span class="token operator">=</span> transform


        
    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''返回数据集的总长度'''</span>
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>name_map<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''以支持索引，使得数据集[i]可以用于获得第i个样本。'''</span>
        <span class="token comment"># 输入索引，转换为名称</span>
        idx <span class="token operator">=</span> self<span class="token punctuation">.</span>name_map<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>
        img_name <span class="token operator">=</span> idx<span class="token operator">+</span><span class="token string">'.png'</span>
        ann_name <span class="token operator">=</span> idx<span class="token operator">+</span><span class="token string">'.xml'</span>

        <span class="token comment"># 图片完整路径</span>
        img_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>img_path<span class="token punctuation">,</span>img_name<span class="token punctuation">)</span>
        <span class="token comment"># 注解完整路径</span>
        ann_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>ann_path<span class="token punctuation">,</span>ann_name<span class="token punctuation">)</span>

        <span class="token comment"># 对图片进行xml特征提取</span>
        img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>img_path<span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">)</span>


        <span class="token comment"># 加载图片，从xml文件中获得bbox的数组然后返回图片矩阵</span>
        tree <span class="token operator">=</span> ET<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>ann_path<span class="token punctuation">)</span>
        root <span class="token operator">=</span> tree<span class="token punctuation">.</span>getroot<span class="token punctuation">(</span><span class="token punctuation">)</span>
        objects <span class="token operator">=</span> root<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'object'</span><span class="token punctuation">)</span>
        <span class="token comment"># 从xml中查看属性名称</span>
        <span class="token keyword">for</span> obj <span class="token keyword">in</span> objects<span class="token punctuation">:</span>
            bounding_box <span class="token operator">=</span> obj<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'bndbox'</span><span class="token punctuation">)</span>
            <span class="token comment"># 方法2</span>
            xmin <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>bounding_box<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span> 
            ymin <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>bounding_box<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>
            xmax <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>bounding_box<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>
            ymax <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>bounding_box<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>  
            <span class="token comment"># label = obj.find('name').text </span>
            <span class="token comment"># label = obj.find('truncated').text</span>

        bbox <span class="token operator">=</span> <span class="token punctuation">(</span>xmin<span class="token punctuation">,</span> ymin<span class="token punctuation">,</span> xmax<span class="token punctuation">,</span> ymax<span class="token punctuation">)</span>
        <span class="token comment"># 转换尺寸</span>
        img <span class="token operator">=</span> img<span class="token punctuation">.</span>crop<span class="token punctuation">(</span>bbox<span class="token punctuation">)</span>
        
        img <span class="token operator">=</span> img<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        img <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>img<span class="token punctuation">,</span>dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span> <span class="token comment"># unsinged char 和float、</span>
        <span class="token triple-quoted-string string">'''
        swap color axis because
        # numpy image: H x W x C
        # torch image: C x H x W
        '''</span>
        img <span class="token operator">=</span> img<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 转换格式 </span>
        
        <span class="token keyword">return</span> img<span class="token punctuation">,</span>torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    
</code></pre> 
<h3><a id="_112"></a>使用数据集加载器和定义模型</h3> 
<pre><code class="prism language-python">dataloader  <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>license_dataset<span class="token punctuation">,</span>batch_size<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>num_workers<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># 测试在批量中的图片信息</span>
<span class="token comment"># for i_batch,sample_batched in enumerate(dataloader):</span>
<span class="token comment">#     # print(i_batch, sample_batched['image'].size(),</span>
<span class="token comment">#     #       sample_batched['label'].size())</span>
    
<span class="token comment">#     # observe 4th batch and stop.</span>
<span class="token comment">#     if i_batch == 3:</span>
<span class="token comment">#         plt.figure()</span>
        
<span class="token comment">#         show_crop_batch(sample_batched)</span>
<span class="token comment">#         plt.axis('off')</span>
<span class="token comment">#         plt.ioff()</span>
<span class="token comment">#         plt.show()</span>
<span class="token comment">#         break</span>



<span class="token triple-quoted-string string">''' 定义模型'''</span>
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn 
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F 


<span class="token keyword">class</span> <span class="token class-name">Net</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token triple-quoted-string string">'''
        in_channels是输入的四维张量[N, C, H, W]中的C了，即输入张量的channels数。这个形参是确定权重等可学习参数的shape所必需的。
        
        torch的张量输入是[Num,channels,Height,Weight]

        '''</span>

        self<span class="token punctuation">.</span>conv1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>pool <span class="token operator">=</span> nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>conv2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>


        <span class="token comment"># self.fc1 = nn.Linear(16 * 5 * 5, 120)</span>
        self<span class="token punctuation">.</span>fc1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">2704</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>fc2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>fc3 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>


        x <span class="token operator">=</span> self<span class="token punctuation">.</span>pool<span class="token punctuation">(</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>pool<span class="token punctuation">(</span>F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv2<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> torch<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># flatten all dimensions except batch</span>
        
        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc2<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>fc3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

        <span class="token keyword">return</span> x

</code></pre> 
<h3><a id="_173"></a>初始化模型并训练</h3> 
<pre><code class="prism language-python">net <span class="token operator">=</span> Net<span class="token punctuation">(</span><span class="token punctuation">)</span>
criterion <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>
optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>net<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span>momentum<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span>
<span class="token comment"># 训练网络</span>
N_EPOCHS<span class="token operator">=</span><span class="token number">5</span> 
<span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N_EPOCHS<span class="token punctuation">)</span><span class="token punctuation">:</span>
    running_loss <span class="token operator">=</span> <span class="token number">0.0</span> 
    <span class="token comment"># for i,data in enumerate([image,'licence'],0):</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span>data <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># print(type(data))# 我的返回是字典</span>


        <span class="token comment"># 获得输入，data的形状是[inputs,labels]</span>
        inputs<span class="token punctuation">,</span>labels <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        
        <span class="token comment"># print(f'inputs_shape',inputs.shape)</span>
        <span class="token comment"># print(f"inputs={inputs},labels={labels}")</span>
        <span class="token comment"># print('inputs_shape,length of inputs',inputs.shape,len(inputs))</span>
        <span class="token comment"># print(type(inputs),inputs.dtype) # 后者查看具体类型</span>
        <span class="token comment"># inputs = inputs.astype('float')</span>
        
        <span class="token comment"># 零梯度参数</span>
        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 前向传播+后向传播+优化</span>
        outputs <span class="token operator">=</span> net<span class="token punctuation">(</span>inputs<span class="token punctuation">)</span>
        <span class="token comment"># print(outputs)</span>

        loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span>labels<span class="token punctuation">)</span>
        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 打印静态信息</span>
        running_loss <span class="token operator">+=</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>    <span class="token comment"># print every 2000 mini-batches</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token format-spec">5d</span><span class="token punctuation">}</span></span><span class="token string">] loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>running_loss <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">:</span><span class="token format-spec">.3f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
            running_loss <span class="token operator">=</span> <span class="token number">0.0</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Finished Training'</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_215"></a>实现截图</h2> 
<p><img src="https://images2.imgbox.com/38/a7/2BMK5gjH_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_219"></a>参考博客</h2> 
<p>1.https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html<br> 2.https://pytorch.org/tutorials/beginner/data_loading_tutorial.html<br> 3.https://pytorch.org/tutorials/beginner/transfer_learning_tutorial.html<br> 4.https://www.kaggle.com/code/bitthal/understanding-input-data-and-loading-with-pytorch</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/76ba712a1eea2cf90c9a6145165c9eb6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">视频生成: 基于Stable Diffusion的微调方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/89258d4fe29ffdb994e54292f88c0071/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">单例模式详细总结（8种实现方式，看完就会）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>