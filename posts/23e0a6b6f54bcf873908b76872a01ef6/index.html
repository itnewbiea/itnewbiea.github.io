<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用Jinjia模板语法将数据传递给JavaScript变量 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用Jinjia模板语法将数据传递给JavaScript变量" />
<meta property="og:description" content="网上很容易查到jinjia循环加载后端传来的数据到页面上的方法，但是很难搜到怎么通过jinjia获取flask后端传过来的数据给java script的变量赋值，特此记录。
先来看一下我们传输的数据：
@test_bp.route(&#39;/test&#39;) def test(): role = &#34;admin&#34; permission = [&#34;r1&#34;,&#34;r2&#34;,&#34;r3&#34;] project = [ [&#34;project&#34;,&#34;project&#34;,&#34;project&#34;,&#34;non-project&#34;,&#34;non-project&#34;], [&#34;p1&#34;,&#34;p2&#34;,&#34;p3&#34;,&#34;tool&#34;,&#34;other&#34;] ] action= { &#34;p1&#34;:[&#34;a1&#34;,&#34;a2&#34;,&#34;a3&#34;], &#34;p2&#34;:[&#34;b1&#34;], &#34;p3&#34;:[&#34;c1&#34;,&#34;c2&#34;], &#34;tool&#34;:[&#34;design&#34;,&#34;development&#34;], &#34;other&#34;:[&#34;please specify&#34;] } return render_template(&#39;test.html&#39;, action=action,project=project,role=role,premission=permission) 【方法一】：最初找到的方法，非常复杂，根据传来的数据的结构通过Jinjia不断循环
&lt;script&gt; // 在js里先建好空数据 let role = &#34;&#34; let permission = [] let sourceAllProjects = [] let sourceAllActions = {} &lt;/script&gt; &lt;!--把jinjia2的变量赋值到js的变量--&gt; &lt;!-- 传一个字符串变量--&gt; &lt;script type=&#34;text/javascript&#34;&gt; role = &#39;{{role}}&#39; //记得这里有引号 &lt;/script&gt; &lt;!-- 传一个列表变量--&gt; {% for p in permission %} &lt;script type=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/23e0a6b6f54bcf873908b76872a01ef6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-02T10:18:26+08:00" />
<meta property="article:modified_time" content="2023-08-02T10:18:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用Jinjia模板语法将数据传递给JavaScript变量</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>网上很容易查到jinjia循环加载后端传来的数据到页面上的方法，但是很难搜到怎么通过jinjia获取flask后端传过来的数据给java script的变量赋值，特此记录。</p> 
<p></p> 
<p>先来看一下我们传输的数据：</p> 
<pre><code>@test_bp.route('/test')
def test():
    role = "admin"
    permission = ["r1","r2","r3"]
    project = [
            ["project","project","project","non-project","non-project"],
            ["p1","p2","p3","tool","other"]
        ]
    action= {
        "p1":["a1","a2","a3"],
        "p2":["b1"],
        "p3":["c1","c2"],
        "tool":["design","development"],
        "other":["please specify"]
            }


    return render_template('test.html', action=action,project=project,role=role,premission=permission)
</code></pre> 
<p></p> 
<p>【方法一】：最初找到的方法，非常复杂，根据传来的数据的结构通过Jinjia不断循环</p> 
<blockquote> 
 <pre>  &lt;script&gt;
        // 在js里先建好空数据
        let role = ""
        let permission = []
        let sourceAllProjects = []
        let sourceAllActions = {}
    &lt;/script&gt;


    &lt;!--把jinjia2的变量赋值到js的变量--&gt;
    &lt;!--    传一个字符串变量--&gt;
    &lt;script type="text/javascript"&gt;
        role = '{<!-- -->{role}}' //记得这里有引号
    &lt;/script&gt;

    &lt;!--    传一个列表变量--&gt;
    {% for p in permission %}
        &lt;script type="text/javascript"&gt;
            permission.push('{<!-- -->{p}}');
        &lt;/script&gt;
    {% endfor %}


    &lt;!--    传一个列表套列表--&gt;
   {% for p in project %}
        &lt;script type="text/javascript"&gt;
            temp = ["",]
        &lt;/script&gt;
        {% for pp in p %}
        &lt;script type="text/javascript"&gt;
            temp.push('{<!-- -->{pp}}');
        &lt;/script&gt;
    {% endfor %}
        &lt;script type="text/javascript"&gt;
            sourceAllProjects.push(temp);
        &lt;/script&gt;
    {% endfor %}


    &lt;!--    传一个字典套列表--&gt;
    {% for k,v_list in action.items() %}
        &lt;script type="text/javascript"&gt;
            temp = [""]
        &lt;/script&gt;
        {% for v in v_list %}
            &lt;script type="text/javascript"&gt;
                temp.push('{<!-- -->{v}}')
            &lt;/script&gt;
        {% endfor %}
        &lt;script type="text/javascript"&gt;
            sourceAllActions["{<!-- -->{ k }}"] = temp
        &lt;/script&gt;
    {% endfor %}



&lt;script&gt;
    $(document).ready(function() {
        console.log(role)
        console.log(permission)
        console.log(sourceAllProjects)
        console.log(sourceAllActions)
    })
&lt;/script&gt;</pre> 
</blockquote> 
<p>最后的结果：</p> 
<p><img alt="" height="293" src="https://images2.imgbox.com/e3/94/J07wNqrQ_o.png" width="885"></p> 
<p></p> 
<p></p> 
<p></p> 
<p> 【方法二】：我真的栓Q，其实这样就好了</p> 
<blockquote> 
 <pre>&lt;script&gt;
  var action = {<!-- -->{ action | tojson }};
  var project = {<!-- -->{ project | tojson }};
  var role = "{<!-- -->{ role }}"; //记得这里要用引号！
  var permission = {<!-- -->{ permission | tojson }};
</pre> 
 <pre>$(document).ready(function() {
    console.log(role)
    console.log(permission)
    console.log(project)
    console.log(action)
})</pre> 
 <pre>&lt;/script&gt;</pre> 
</blockquote> 
<p></p> 
<p> 欲哭无泪，第一种方法用了很久..写得我眼睛都瞎了</p> 
<p>csdn上没有搜到过详述这种方法的，特此记录</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/714376523bdc78092ffdc0ce32a3def0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue3中pinia用法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7adab7198fca55c032a9fa043ddbcde0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Hive的Sort By与Distribute By</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>