<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue/cli4 单元测试与覆盖率体系搭建 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue/cli4 单元测试与覆盖率体系搭建" />
<meta property="og:description" content="探索 vue-cli4 创建集成 mocha &#43; chai 的项目中，如何写单元测试和查看单元测试覆盖率。
1、建立一个集成单元测试的项目 首先创建一个新的项目 vue-cli4-unit-mocha-chai-nyc：
vue create vue-cli4-unit-mocha-chai-nyc # 选择手动配置 ? Please pick a preset: zcloud (router, vuex, less, babel, eslint, unit-jest) default (babel, eslint) ❯ Manually select features # 选择需要的功能 ? Please pick a preset: Manually select features ? Check the features needed for your project: ◉ Babel ◯ TypeScript ◯ Progressive Web App (PWA) Support ◉ Router ◉ Vuex ◉ CSS Pre-processors ◉ Linter / Formatter ◉ Unit Testing ❯◉ E2E Testing # 使用 history 模式 ?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/dec45d7875d0b4a2fcd0196f01f94af2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-29T11:00:04+08:00" />
<meta property="article:modified_time" content="2020-05-29T11:00:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue/cli4 单元测试与覆盖率体系搭建</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>探索 vue-cli4 创建集成 mocha + chai 的项目中，如何写单元测试和查看单元测试覆盖率。<br></p> 
<h3><a id="1_2"></a>1、建立一个集成单元测试的项目</h3> 
<p>首先创建一个新的项目 vue-cli4-unit-mocha-chai-nyc：</p> 
<pre><code class="prism language-shell">vue create vue-cli4-unit-mocha-chai-nyc

<span class="token comment"># 选择手动配置</span>
? Please pick a preset: 
  zcloud <span class="token punctuation">(</span>router, vuex, less, babel, eslint, unit-jest<span class="token punctuation">)</span> 
  default <span class="token punctuation">(</span>babel, eslint<span class="token punctuation">)</span> 
❯ Manually <span class="token keyword">select</span> features 

<span class="token comment"># 选择需要的功能</span>
? Please pick a preset: Manually <span class="token keyword">select</span> features
? Check the features needed <span class="token keyword">for</span> your project: 
 ◉ Babel
 ◯ TypeScript
 ◯ Progressive Web App <span class="token punctuation">(</span>PWA<span class="token punctuation">)</span> Support
 ◉ Router
 ◉ Vuex
 ◉ CSS Pre-processors
 ◉ Linter / Formatter
 ◉ Unit Testing
❯◉ E2E Testing

<span class="token comment"># 使用 history 模式</span>
? Please pick a preset: Manually <span class="token keyword">select</span> features
? Check the features needed <span class="token keyword">for</span> your project: Babel, Router, Vuex, CSS Pre-processors, Linter, Unit, E2E
? Use <span class="token function">history</span> mode <span class="token keyword">for</span> router? <span class="token punctuation">(</span>Requires proper server setup <span class="token keyword">for</span> index fallback <span class="token keyword">in</span> production<span class="token punctuation">)</span> <span class="token punctuation">(</span>Y/n<span class="token punctuation">)</span> Y

<span class="token comment"># scss</span>
? Please pick a preset: Manually <span class="token keyword">select</span> features
? Check the features needed <span class="token keyword">for</span> your project: Babel, Router, Vuex, CSS Pre-processors, Linter, Unit, E2E
? Use <span class="token function">history</span> mode <span class="token keyword">for</span> router? <span class="token punctuation">(</span>Requires proper server setup <span class="token keyword">for</span> index fallback <span class="token keyword">in</span> production<span class="token punctuation">)</span> Yes
? Pick a CSS pre-processor <span class="token punctuation">(</span>PostCSS, Autoprefixer and CSS Modules are supported by default<span class="token punctuation">)</span>: 
  Sass/SCSS <span class="token punctuation">(</span>with dart-sass<span class="token punctuation">)</span> 
❯ Sass/SCSS <span class="token punctuation">(</span>with node-sass<span class="token punctuation">)</span> 
  Less 
  Stylus   

<span class="token comment"># esLint</span>
? Please pick a preset: Manually <span class="token keyword">select</span> features
? Check the features needed <span class="token keyword">for</span> your project: Babel, Router, Vuex, CSS Pre-processors, Linter, Unit, E2E
? Use <span class="token function">history</span> mode <span class="token keyword">for</span> router? <span class="token punctuation">(</span>Requires proper server setup <span class="token keyword">for</span> index fallback <span class="token keyword">in</span> production<span class="token punctuation">)</span> Yes
? Pick a CSS pre-processor <span class="token punctuation">(</span>PostCSS, Autoprefixer and CSS Modules are supported by default<span class="token punctuation">)</span>: Sass/SCSS <span class="token punctuation">(</span>with node-sass<span class="token punctuation">)</span>
? Pick a linter / formatter config: 
  ESLint with error prevention only 
  ESLint + Airbnb config 
❯ ESLint + Standard config 
  ESLint + Prettier 

<span class="token comment"># 保存时进行检测</span>
? Please pick a preset: Manually <span class="token keyword">select</span> features
? Check the features needed <span class="token keyword">for</span> your project: Babel, Router, Vuex, CSS Pre-processors, Linter, Unit, E2E
? Use <span class="token function">history</span> mode <span class="token keyword">for</span> router? <span class="token punctuation">(</span>Requires proper server setup <span class="token keyword">for</span> index fallback <span class="token keyword">in</span> production<span class="token punctuation">)</span> Yes
? Pick a CSS pre-processor <span class="token punctuation">(</span>PostCSS, Autoprefixer and CSS Modules are supported by default<span class="token punctuation">)</span>: Sass/SCSS <span class="token punctuation">(</span>with node-sass<span class="token punctuation">)</span>
? Pick a linter / formatter config: Standard
? Pick additional lint features: <span class="token punctuation">(</span>Press <span class="token operator">&lt;</span>space<span class="token operator">&gt;</span> to select, <span class="token operator">&lt;</span>a<span class="token operator">&gt;</span> to toggle all, <span class="token operator">&lt;</span>i<span class="token operator">&gt;</span> to invert selection<span class="token punctuation">)</span>
❯◉ Lint on save
 ◯ Lint and fix on commit
 
 <span class="token comment"># 单元测试 mocha + chai</span>
 ? Please pick a preset: Manually <span class="token keyword">select</span> features
? Check the features needed <span class="token keyword">for</span> your project: Babel, Router, Vuex, CSS Pre-processors, Linter, Unit, E2E
? Use <span class="token function">history</span> mode <span class="token keyword">for</span> router? <span class="token punctuation">(</span>Requires proper server setup <span class="token keyword">for</span> index fallback <span class="token keyword">in</span> production<span class="token punctuation">)</span> Yes
? Pick a CSS pre-processor <span class="token punctuation">(</span>PostCSS, Autoprefixer and CSS Modules are supported by default<span class="token punctuation">)</span>: Sass/SCSS <span class="token punctuation">(</span>with node-sass<span class="token punctuation">)</span>
? Pick a linter / formatter config: Standard
? Pick additional lint features: <span class="token punctuation">(</span>Press <span class="token operator">&lt;</span>space<span class="token operator">&gt;</span> to select, <span class="token operator">&lt;</span>a<span class="token operator">&gt;</span> to toggle all, <span class="token operator">&lt;</span>i<span class="token operator">&gt;</span> to invert selection<span class="token punctuation">)</span>Lint on save
? Pick a unit testing solution: <span class="token punctuation">(</span>Use arrow keys<span class="token punctuation">)</span>
❯ Mocha + Chai 
  Jest 
  
  <span class="token comment"># 端到端测试</span>
  ? Please pick a preset: Manually <span class="token keyword">select</span> features
? Check the features needed <span class="token keyword">for</span> your project: Babel, Router, Vuex, CSS Pre-processors, Linter, Unit, E2E
? Use <span class="token function">history</span> mode <span class="token keyword">for</span> router? <span class="token punctuation">(</span>Requires proper server setup <span class="token keyword">for</span> index fallback <span class="token keyword">in</span> production<span class="token punctuation">)</span> Yes
? Pick a CSS pre-processor <span class="token punctuation">(</span>PostCSS, Autoprefixer and CSS Modules are supported by default<span class="token punctuation">)</span>: Sass/SCSS <span class="token punctuation">(</span>with node-sass<span class="token punctuation">)</span>
? Pick a linter / formatter config: Standard
? Pick additional lint features: <span class="token punctuation">(</span>Press <span class="token operator">&lt;</span>space<span class="token operator">&gt;</span> to select, <span class="token operator">&lt;</span>a<span class="token operator">&gt;</span> to toggle all, <span class="token operator">&lt;</span>i<span class="token operator">&gt;</span> to invert selection<span class="token punctuation">)</span>Lint on save
? Pick a unit testing solution: Mocha
? Pick a E2E testing solution: <span class="token punctuation">(</span>Use arrow keys<span class="token punctuation">)</span>
❯ Cypress <span class="token punctuation">(</span>Chrome only<span class="token punctuation">)</span> 
  Nightwatch <span class="token punctuation">(</span>WebDriver-based<span class="token punctuation">)</span> 

<span class="token comment"># 单独的配置文件</span>
? Please pick a preset: Manually <span class="token keyword">select</span> features
? Check the features needed <span class="token keyword">for</span> your project: Babel, Router, Vuex, CSS Pre-processors, Linter, Unit, E2E
? Use <span class="token function">history</span> mode <span class="token keyword">for</span> router? <span class="token punctuation">(</span>Requires proper server setup <span class="token keyword">for</span> index fallback <span class="token keyword">in</span> production<span class="token punctuation">)</span> Yes
? Pick a CSS pre-processor <span class="token punctuation">(</span>PostCSS, Autoprefixer and CSS Modules are supported by default<span class="token punctuation">)</span>: Sass/SCSS <span class="token punctuation">(</span>with node-sass<span class="token punctuation">)</span>
? Pick a linter / formatter config: Standard
? Pick additional lint features: <span class="token punctuation">(</span>Press <span class="token operator">&lt;</span>space<span class="token operator">&gt;</span> to select, <span class="token operator">&lt;</span>a<span class="token operator">&gt;</span> to toggle all, <span class="token operator">&lt;</span>i<span class="token operator">&gt;</span> to invert selection<span class="token punctuation">)</span>Lint on save
? Pick a unit testing solution: Mocha
? Pick a E2E testing solution: Cypress
? Where <span class="token keyword">do</span> you prefer placing config <span class="token keyword">for</span> Babel, ESLint, etc.? 
❯ In dedicated config files 
  In package.json 

<span class="token comment"># 不保存配置</span>
? Please pick a preset: Manually <span class="token keyword">select</span> features
? Check the features needed <span class="token keyword">for</span> your project: Babel, Router, Vuex, CSS Pre-processors, Linter, Unit, E2E
? Use <span class="token function">history</span> mode <span class="token keyword">for</span> router? <span class="token punctuation">(</span>Requires proper server setup <span class="token keyword">for</span> index fallback <span class="token keyword">in</span> production<span class="token punctuation">)</span> Yes
? Pick a CSS pre-processor <span class="token punctuation">(</span>PostCSS, Autoprefixer and CSS Modules are supported by default<span class="token punctuation">)</span>: Sass/SCSS <span class="token punctuation">(</span>with node-sass<span class="token punctuation">)</span>
? Pick a linter / formatter config: Standard
? Pick additional lint features: <span class="token punctuation">(</span>Press <span class="token operator">&lt;</span>space<span class="token operator">&gt;</span> to select, <span class="token operator">&lt;</span>a<span class="token operator">&gt;</span> to toggle all, <span class="token operator">&lt;</span>i<span class="token operator">&gt;</span> to invert selection<span class="token punctuation">)</span>Lint on save
? Pick a unit testing solution: Mocha
? Pick a E2E testing solution: Cypress
? Where <span class="token keyword">do</span> you prefer placing config <span class="token keyword">for</span> Babel, ESLint, etc.? In dedicated config files
? Save this as a preset <span class="token keyword">for</span> future projects? <span class="token punctuation">(</span>y/N<span class="token punctuation">)</span> n

<span class="token comment"># 开始创建项目</span>
Vue CLI v4.1.2
✨  Creating project <span class="token keyword">in</span> /Users/heyi/File/Front-End/demo/vue-unit.
🗃  Initializing <span class="token function">git</span> repository<span class="token punctuation">..</span>.
⚙  Installing CLI plugins. This might take a while<span class="token punctuation">..</span>.

···

📄  Generating README.md<span class="token punctuation">..</span>.

🎉  Successfully created project vue-cli4-unit-mocha-chai-nyc.
👉  Get started with the following commands:

 $ <span class="token function">cd</span> vue-cli4-unit-mocha-chai-nyc
 $ <span class="token function">npm</span> run serve
</code></pre> 
<p><img src="https://images2.imgbox.com/bc/bb/6IxXTl0R_o.png" alt="asd"><br> 创建项目完成后，可以发现 cli4 会自动生成一个默认的单元测试例子 tests/unit/ example.spec.js，其内容如下：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> expect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'chai'</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> shallowMount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
<span class="token keyword">import</span> HelloWorld <span class="token keyword">from</span> <span class="token string">'@/components/HelloWorld.vue'</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'HelloWorld.vue'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'renders props.msg when passed'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token string">'new message'</span>
    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">shallowMount</span><span class="token punctuation">(</span>HelloWorld<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
      propsData<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> msg <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">include</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> 
<p>接下来，进入项目并运行单元测试：</p> 
<pre><code class="prism language-shell"><span class="token function">cd</span> vue-cli4-unit-mocha-chai-nyc
<span class="token function">npm</span> run test:unit

<span class="token operator">&gt;</span> vue-cli4-unit-mocha-chai-nyc@0.1.0 test:unit /Users/heyi/File/Front-End/demo/_unit/vue-cli4-unit-mocha-chai-nyc
<span class="token operator">&gt;</span> vue-cli-service test:unit

 WEBPACK  Compiling<span class="token punctuation">..</span>.

  <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">=</span>                      <span class="token punctuation">]</span> 10% <span class="token punctuation">(</span>building<span class="token punctuation">)</span>Download the Vue Devtools extension <span class="token keyword">for</span> a better development experience:
https://github.com/vuejs/vue-devtools
You are running Vue <span class="token keyword">in</span> development mode.
Make sure to turn on production mode when deploying <span class="token keyword">for</span> production.
See <span class="token function">more</span> tips at https://vuejs.org/guide/deployment.html
  <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token punctuation">]</span> 98% <span class="token punctuation">(</span>after emitting<span class="token punctuation">)</span>

 DONE  Compiled successfully <span class="token keyword">in</span> 3019ms

  <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token punctuation">]</span> 100% <span class="token punctuation">(</span>completed<span class="token punctuation">)</span>

 WEBPACK  Compiled successfully <span class="token keyword">in</span> 3019ms

 MOCHA  Testing<span class="token punctuation">..</span>.



  HelloWorld.vue
    ✓ renders props.msg when passed


  1 passing <span class="token punctuation">(</span>26ms<span class="token punctuation">)</span>

 MOCHA  Tests completed successfully
</code></pre> 
<p><code>npm run test:unit</code> 命令会自动读取 tests/unit/ 目录下的 *.spec.js 文件，来跑我们的单元测试。</p> 
<p>可以发现，通过 vue-cli4 创建集成的单元测试项目，已经可以让我们做到零配置来写单元测试了。接下来就动手写一个单元测试试试。</p> 
<p></p> 
<h3><a id="2_184"></a>2、动手写第一个单元测试</h3> 
<p><br>首先我们在 src/components/ 目录下创建文件 AppEmpty.vue，其内容如下:<br></p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div&gt;{<!-- -->{text}}&lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  name: 'AppEmpty',
  props: {
    text: {
      type: String,
      default: 'no data'
    }
  },
  data () {
    return {}
  }
}
&lt;/script&gt;

&lt;style scoped lang="scss"&gt;
&lt;/style&gt;
</code></pre> 
<p><br>接着在 tests/unit/ 目录下创建 app-empty.spec.js 文件，并添加如下内容：<br></p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> expect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'chai'</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> shallowMount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
<span class="token keyword">import</span> AppEmpty <span class="token keyword">from</span> <span class="token string">'@/components/AppEmpty.vue'</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'AppEmpty.vue'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'no props.text when passed'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">shallowMount</span><span class="token punctuation">(</span>AppEmpty<span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">include</span><span class="token punctuation">(</span><span class="token string">'no data'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'renders props.text when passed'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token string">'暂无数据'</span>
    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">shallowMount</span><span class="token punctuation">(</span>HelloWorld<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
      propsData<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> text <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">include</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><br>最后，再次运行 test:unit 命令：<br></p> 
<pre><code class="prism language-shell"><span class="token function">npm</span> run test:unit

<span class="token operator">&gt;</span> vue-cli4-unit-mocha-chai-nyc@0.1.0 test:unit /Users/heyi/File/Front-End/demo/_unit/vue-cli4-unit-mocha-chai-nyc
<span class="token operator">&gt;</span> vue-cli-service test:unit

 WEBPACK  Compiling<span class="token punctuation">..</span>.

  <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token punctuation">]</span> 98% <span class="token punctuation">(</span>after emitting<span class="token punctuation">)</span>

 DONE  Compiled successfully <span class="token keyword">in</span> 1935ms

  <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token punctuation">]</span> 100% <span class="token punctuation">(</span>completed<span class="token punctuation">)</span>

 WEBPACK  Compiled successfully <span class="token keyword">in</span> 1935ms

 MOCHA  Testing<span class="token punctuation">..</span>.



  AppEmpty.vue
    ✓ no props.text when passed
    ✓ renders props.text when passed

  HelloWorld.vue
    ✓ renders props.msg when passed


  3 passing <span class="token punctuation">(</span>35ms<span class="token punctuation">)</span>

 MOCHA  Tests completed successfully
</code></pre> 
<p><br>可以看到，我们自己写的单元测试也跑了起来。<br></p> 
<p></p> 
<h3><a id="3_273"></a>3、单元测试文件书写位置调整</h3> 
<p><br>如果所有的 *.spec.js 文件都写在 tests/unit/ 目录下会显得很凌乱，那么如果我们在 /unit 目录下再新建文件夹，会被读取到吗？答案是肯定的。<br><br> <br>在 tests/unit/ 目录下新建一个 components 文件夹，把刚刚创建的 app-empty.spec.js 文件移进去。再次运行 test:unit 命令：<br></p> 
<pre><code class="prism language-powershell">npm run test:unit

&gt; vue<span class="token operator">-</span>cli4<span class="token operator">-</span>unit<span class="token operator">-</span>mocha<span class="token operator">-</span>chai<span class="token operator">-</span>nyc@0<span class="token punctuation">.</span>1<span class="token punctuation">.</span>0 test:unit <span class="token operator">/</span>Users<span class="token operator">/</span>heyi<span class="token operator">/</span>File<span class="token operator">/</span>Front<span class="token operator">-</span><span class="token keyword">End</span><span class="token operator">/</span>demo<span class="token operator">/</span>_unit<span class="token operator">/</span>vue<span class="token operator">-</span>cli4<span class="token operator">-</span>unit<span class="token operator">-</span>mocha<span class="token operator">-</span>chai<span class="token operator">-</span>nyc
&gt; vue<span class="token operator">-</span><span class="token function">cli</span><span class="token operator">-</span>service test:unit

 WEBPACK  Compiling<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

  <span class="token punctuation">[</span>=========================<span class="token punctuation">]</span> 98<span class="token operator">%</span> <span class="token punctuation">(</span>after emitting<span class="token punctuation">)</span>

 DONE  Compiled successfully in 2035ms

  <span class="token punctuation">[</span>=========================<span class="token punctuation">]</span> 100<span class="token operator">%</span> <span class="token punctuation">(</span>completed<span class="token punctuation">)</span>

 WEBPACK  Compiled successfully in 2035ms

 MOCHA  Testing<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>



  HelloWorld<span class="token punctuation">.</span>vue
    ✓ renders props<span class="token punctuation">.</span>msg when passed

  AppEmpty<span class="token punctuation">.</span>vue
    ✓ no props<span class="token punctuation">.</span>text when passed
    ✓ renders props<span class="token punctuation">.</span>text when passed


  3 passing <span class="token punctuation">(</span>57ms<span class="token punctuation">)</span>

 MOCHA  Tests completed successfully
</code></pre> 
<p><br>说明我们是可以自己建立文件夹进行整理我们的单元测试文件的。<br><br> <br>如果我们的项目是一个去中心化的架构，我们可能希望我们的单元测试文件位于我们的组件旁边，而不是都写在 tests/unit/ 目录下。<br><br> <br>如何实现呢？<br><br> <br>在 tests/unit 目录下新建 index.spec.js 文件，其内容如下：<br></p> 
<pre><code class="prism language-javascript"><span class="token comment">// require all src files that ends with .spec.js</span>
<span class="token keyword">const</span> srcContext <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'../../src/'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex">/\.spec.js$/</span><span class="token punctuation">)</span>
srcContext<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>srcContext<span class="token punctuation">)</span>
</code></pre> 
<p><br>就可以在 src/ 目录下任何位置写我们的单元测试文件了。<br><br> <br>为了验证所言非虚，简单的验证一下。复制 tests/unit/components/app-empty.spec.js 文件，在 src/components/ 目录下粘贴，然后稍稍修改一下测试套件的文本：<br></p> 
<pre><code class="prism language-javascript"><span class="token operator">-</span> <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'AppEmpty.vue'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span> <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'src/**/*.spec.js AppEmpty.vue'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
</code></pre> 
<p><br>再次运行 test:unit 命令：<br></p> 
<pre><code>npm run test:unit

&gt; vue-cli4-unit-mocha-chai-nyc@0.1.0 test:unit /Users/heyi/File/Front-End/demo/_unit/vue-cli4-unit-mocha-chai-nyc
&gt; vue-cli-service test:unit

 WEBPACK  Compiling...

  [=========================] 98% (after emitting)

 DONE  Compiled successfully in 1968ms

  [=========================] 100% (completed)

 WEBPACK  Compiled successfully in 1968ms

 MOCHA  Testing...



  HelloWorld.vue
    ✓ renders props.msg when passed

  src/**/*.spec.js AppEmpty.vue
    ✓ no props.text when passed
    ✓ renders props.text when passed

  AppEmpty.vue
    ✓ no props.text when passed
    ✓ renders props.text when passed


  5 passing (38ms)

 MOCHA  Tests completed successfully
</code></pre> 
<p><br>嗯，所言不虚。<br></p> 
<p></p> 
<h3><a id="4_mochawesome__372"></a>4、使用 mochawesome 输出结果</h3> 
<p><br>到目前为止，我们的测试报告都是在命令行展示，那么如果我们想要把结果输出并展示在页面上如何做到呢？<br><br> <br>首先在项目中安装 mochawesome：<br></p> 
<pre><code class="prism language-shell"><span class="token function">npm</span> <span class="token function">install</span> --save-dev mochawesome
</code></pre> 
<p><br>然后在 package.json 中修改 test:unit 命令如下：<br></p> 
<pre><code class="prism language-json"><span class="token string">"test:unit"</span><span class="token punctuation">:</span> <span class="token string">"vue-cli-service test:unit --reporter=mochawesome"</span><span class="token punctuation">,</span>
</code></pre> 
<p><br>然后再次执行：<br></p> 
<pre><code class="prism language-powershell">npm run test:unit                      

&gt; vue<span class="token operator">-</span>cli4<span class="token operator">-</span>unit<span class="token operator">-</span>mocha<span class="token operator">-</span>chai<span class="token operator">-</span>nyc@0<span class="token punctuation">.</span>1<span class="token punctuation">.</span>0 test:unit <span class="token operator">/</span>Users<span class="token operator">/</span>heyi<span class="token operator">/</span>File<span class="token operator">/</span>Front<span class="token operator">-</span><span class="token keyword">End</span><span class="token operator">/</span>demo<span class="token operator">/</span>_unit<span class="token operator">/</span>vue<span class="token operator">-</span>cli4<span class="token operator">-</span>unit<span class="token operator">-</span>mocha<span class="token operator">-</span>chai<span class="token operator">-</span>nyc
&gt; vue<span class="token operator">-</span><span class="token function">cli</span><span class="token operator">-</span>service test:unit <span class="token operator">--</span>reporter=mochawesome

 WEBPACK  Compiling<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

  <span class="token punctuation">[</span>===                      <span class="token punctuation">]</span> 10<span class="token operator">%</span> <span class="token punctuation">(</span>building<span class="token punctuation">)</span>Download the Vue Devtools extension <span class="token keyword">for</span> a better development experience:
https:<span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>vuejs<span class="token operator">/</span>vue<span class="token operator">-</span>devtools
You are running Vue in development mode<span class="token punctuation">.</span>
Make sure to turn on production mode when deploying <span class="token keyword">for</span> production<span class="token punctuation">.</span>
See more tips at https:<span class="token operator">/</span><span class="token operator">/</span>vuejs<span class="token punctuation">.</span>org<span class="token operator">/</span>guide<span class="token operator">/</span>deployment<span class="token punctuation">.</span>html
  <span class="token punctuation">[</span>=========================<span class="token punctuation">]</span> 98<span class="token operator">%</span> <span class="token punctuation">(</span>after emitting<span class="token punctuation">)</span>

 WARNING  Compiled with 1 warnings

 warning  in <span class="token punctuation">.</span><span class="token operator">/</span>src<span class="token operator">/</span>components<span class="token operator">/</span>app<span class="token operator">-</span>empty<span class="token punctuation">.</span>spec<span class="token punctuation">.</span>js

Module Error <span class="token punctuation">(</span><span class="token keyword">from</span> <span class="token punctuation">.</span><span class="token operator">/</span>node_modules<span class="token operator">/</span>eslint<span class="token operator">-</span>loader<span class="token operator">/</span>index<span class="token punctuation">.</span>js<span class="token punctuation">)</span>:

<span class="token operator">/</span>Users<span class="token operator">/</span>heyi<span class="token operator">/</span>File<span class="token operator">/</span>Front<span class="token operator">-</span><span class="token keyword">End</span><span class="token operator">/</span>demo<span class="token operator">/</span>_unit<span class="token operator">/</span>vue<span class="token operator">-</span>cli4<span class="token operator">-</span>unit<span class="token operator">-</span>mocha<span class="token operator">-</span>chai<span class="token operator">-</span>nyc<span class="token operator">/</span>src<span class="token operator">/</span>components<span class="token operator">/</span>app<span class="token operator">-</span>empty<span class="token punctuation">.</span>spec<span class="token punctuation">.</span>js
   5:1  error  <span class="token string">'describe'</span> is not defined  no<span class="token operator">-</span>undef
   6:3  error  <span class="token string">'it'</span> is not defined        no<span class="token operator">-</span>undef
  11:3  error  <span class="token string">'it'</span> is not defined        no<span class="token operator">-</span>undef

✖ 3 problems <span class="token punctuation">(</span>3 errors<span class="token punctuation">,</span> 0 warnings<span class="token punctuation">)</span>


 @ <span class="token punctuation">.</span><span class="token operator">/</span>src sync \<span class="token punctuation">.</span>spec<span class="token punctuation">.</span>js$
 @ <span class="token punctuation">.</span><span class="token operator">/</span>tests<span class="token operator">/</span>unit<span class="token operator">/</span>index<span class="token punctuation">.</span>spec<span class="token punctuation">.</span>js
 @ <span class="token punctuation">.</span><span class="token operator">/</span>node_modules<span class="token operator">/</span>mochapack<span class="token operator">/</span>lib<span class="token operator">/</span>entry<span class="token punctuation">.</span>js

  <span class="token punctuation">[</span>=========================<span class="token punctuation">]</span> 100<span class="token operator">%</span> <span class="token punctuation">(</span>completed<span class="token punctuation">)</span>

 WEBPACK  Compiled with 1 warning<span class="token punctuation">(</span>s<span class="token punctuation">)</span>

Warning in <span class="token punctuation">.</span><span class="token operator">/</span>src<span class="token operator">/</span>components<span class="token operator">/</span>app<span class="token operator">-</span>empty<span class="token punctuation">.</span>spec<span class="token punctuation">.</span>js

  Module Error <span class="token punctuation">(</span><span class="token keyword">from</span> <span class="token punctuation">.</span><span class="token operator">/</span>node_modules<span class="token operator">/</span>eslint<span class="token operator">-</span>loader<span class="token operator">/</span>index<span class="token punctuation">.</span>js<span class="token punctuation">)</span>:
  
  <span class="token operator">/</span>Users<span class="token operator">/</span>heyi<span class="token operator">/</span>File<span class="token operator">/</span>Front<span class="token operator">-</span><span class="token keyword">End</span><span class="token operator">/</span>demo<span class="token operator">/</span>_unit<span class="token operator">/</span>vue<span class="token operator">-</span>cli4<span class="token operator">-</span>unit<span class="token operator">-</span>mocha<span class="token operator">-</span>chai<span class="token operator">-</span>nyc<span class="token operator">/</span>src<span class="token operator">/</span>components<span class="token operator">/</span>app<span class="token operator">-</span>empty<span class="token punctuation">.</span>spec<span class="token punctuation">.</span>js
     5:1  error  <span class="token string">'describe'</span> is not defined  no<span class="token operator">-</span>undef
     6:3  error  <span class="token string">'it'</span> is not defined        no<span class="token operator">-</span>undef
    11:3  error  <span class="token string">'it'</span> is not defined        no<span class="token operator">-</span>undef
  
  ✖ 3 problems <span class="token punctuation">(</span>3 errors<span class="token punctuation">,</span> 0 warnings<span class="token punctuation">)</span>
  

 MOCHA  Testing<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>



  HelloWorld<span class="token punctuation">.</span>vue
    ✓ renders props<span class="token punctuation">.</span>msg when passed

  src/<span class="token operator">*</span>*<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>spec<span class="token punctuation">.</span>js AppEmpty<span class="token punctuation">.</span>vue
    ✓ no props<span class="token punctuation">.</span>text when passed
    ✓ renders props<span class="token punctuation">.</span>text when passed

  AppEmpty<span class="token punctuation">.</span>vue
    ✓ no props<span class="token punctuation">.</span>text when passed
    ✓ renders props<span class="token punctuation">.</span>text when passed


  5 passing <span class="token punctuation">(</span>35ms<span class="token punctuation">)</span>

<span class="token namespace">[mochawesome]</span> Report JSON saved to <span class="token operator">/</span>Users<span class="token operator">/</span>heyi<span class="token operator">/</span>File<span class="token operator">/</span>Front<span class="token operator">-</span><span class="token keyword">End</span><span class="token operator">/</span>demo<span class="token operator">/</span>_unit<span class="token operator">/</span>vue<span class="token operator">-</span>cli4<span class="token operator">-</span>unit<span class="token operator">-</span>mocha<span class="token operator">-</span>chai<span class="token operator">-</span>nyc<span class="token operator">/</span>mochawesome<span class="token operator">-</span>report<span class="token operator">/</span>mochawesome<span class="token punctuation">.</span>json

<span class="token namespace">[mochawesome]</span> Report HTML saved to <span class="token operator">/</span>Users<span class="token operator">/</span>heyi<span class="token operator">/</span>File<span class="token operator">/</span>Front<span class="token operator">-</span><span class="token keyword">End</span><span class="token operator">/</span>demo<span class="token operator">/</span>_unit<span class="token operator">/</span>vue<span class="token operator">-</span>cli4<span class="token operator">-</span>unit<span class="token operator">-</span>mocha<span class="token operator">-</span>chai<span class="token operator">-</span>nyc<span class="token operator">/</span>mochawesome<span class="token operator">-</span>report<span class="token operator">/</span>mochawesome<span class="token punctuation">.</span>html
</code></pre> 
<p><br>非常醒目的警告提示首先被发现：<br></p> 
<pre><code class="prism language-powershell"> WEBPACK  Compiled with 1 warning<span class="token punctuation">(</span>s<span class="token punctuation">)</span>

Warning in <span class="token punctuation">.</span><span class="token operator">/</span>src<span class="token operator">/</span>components<span class="token operator">/</span>app<span class="token operator">-</span>empty<span class="token punctuation">.</span>spec<span class="token punctuation">.</span>js

  Module Error <span class="token punctuation">(</span><span class="token keyword">from</span> <span class="token punctuation">.</span><span class="token operator">/</span>node_modules<span class="token operator">/</span>eslint<span class="token operator">-</span>loader<span class="token operator">/</span>index<span class="token punctuation">.</span>js<span class="token punctuation">)</span>:
  
  <span class="token operator">/</span>Users<span class="token operator">/</span>heyi<span class="token operator">/</span>File<span class="token operator">/</span>Front<span class="token operator">-</span><span class="token keyword">End</span><span class="token operator">/</span>demo<span class="token operator">/</span>_unit<span class="token operator">/</span>vue<span class="token operator">-</span>cli4<span class="token operator">-</span>unit<span class="token operator">-</span>mocha<span class="token operator">-</span>chai<span class="token operator">-</span>nyc<span class="token operator">/</span>src<span class="token operator">/</span>components<span class="token operator">/</span>app<span class="token operator">-</span>empty<span class="token punctuation">.</span>spec<span class="token punctuation">.</span>js
     5:1  error  <span class="token string">'describe'</span> is not defined  no<span class="token operator">-</span>undef
     6:3  error  <span class="token string">'it'</span> is not defined        no<span class="token operator">-</span>undef
    11:3  error  <span class="token string">'it'</span> is not defined        no<span class="token operator">-</span>undef
  
  ✖ 3 problems <span class="token punctuation">(</span>3 errors<span class="token punctuation">,</span> 0 warnings<span class="token punctuation">)</span>
</code></pre> 
<p><br>告诉我们在 ./src/components/app-empty.spec.js 文件中 describe、it 未定义，为什么上面我们执行的时候都没有这个警告，这次就有了呢？而且，为什么只有 src/ 目录下的单元测试文件报了，tests/unit/ 目录下的没有报呢？<br><br> <br>答案在项目的 .eslintrc.js 配置文件里：<br></p> 
<pre><code class="prism language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  root<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  env<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    node<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'plugin:vue/essential'</span><span class="token punctuation">,</span>
    <span class="token string">'@vue/standard'</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  parserOptions<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    parser<span class="token punctuation">:</span> <span class="token string">'babel-eslint'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  rules<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'no-console'</span><span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span> <span class="token operator">?</span> <span class="token string">'warn'</span> <span class="token punctuation">:</span> <span class="token string">'off'</span><span class="token punctuation">,</span>
    <span class="token string">'no-debugger'</span><span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span> <span class="token operator">?</span> <span class="token string">'warn'</span> <span class="token punctuation">:</span> <span class="token string">'off'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  overrides<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span>
      files<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">'**/__tests__/*.{j,t}s?(x)'</span><span class="token punctuation">,</span>
        <span class="token string">'**/src/**/*.spec.{j,t}s?(x)'</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      env<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        mocha<span class="token punctuation">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><br>在项目生成的 eslint 配置文件中，存在针对特定文件的配置，具体理解不细说，只需要简单的在其中加入 src/ 的配置即可：<br></p> 
<pre><code class="prism language-javascript">···

  overrides<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span>
      files<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">'**/__tests__/*.{j,t}s?(x)'</span><span class="token punctuation">,</span>
<span class="token operator">+</span>       <span class="token string">'**/tests/unit/**/*.spec.{j,t}s?(x)'</span><span class="token punctuation">,</span>
        <span class="token string">'**/src/**/*.spec.{j,t}s?(x)'</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      env<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        mocha<span class="token punctuation">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
  
···
</code></pre> 
<p><br>接下来我们再次运行 test:unit 命令，上面出现的告警将不复存在：<br></p> 
<pre><code>npm run test:unit

&gt; vue-cli4-unit-mocha-chai-nyc@0.1.0 test:unit /Users/heyi/File/Front-End/demo/_unit/vue-cli4-unit-mocha-chai-nyc
&gt; vue-cli-service test:unit --reporter=mochawesome

 WEBPACK  Compiling...

  [=========================] 98% (after emitting)

 DONE  Compiled successfully in 1212ms

  [=========================] 100% (completed)

 WEBPACK  Compiled successfully in 1212ms

 MOCHA  Testing...



  HelloWorld.vue
    ✓ renders props.msg when passed

  src/**/*.spec.js AppEmpty.vue
    ✓ no props.text when passed
    ✓ renders props.text when passed

  AppEmpty.vue
    ✓ no props.text when passed
    ✓ renders props.text when passed


  5 passing (36ms)

[mochawesome] Report JSON saved to /Users/heyi/File/Front-End/demo/_unit/vue-cli4-unit-mocha-chai-nyc/mochawesome-report/mochawesome.json

[mochawesome] Report HTML saved to /Users/heyi/File/Front-End/demo/_unit/vue-cli4-unit-mocha-chai-nyc/mochawesome-report/mochawesome.html

 MOCHA  Tests completed successfully
</code></pre> 
<p><br>处理了告警问题，回到最初的目的。<br><br> <br>命令执行完成后，会在项目根目录下增加一个名为 mochawesome-report 的文件夹，里面就放着输出的单元测试报告。<br><br> <br>我们在浏览器打开 mochawesome.html 可以看到如下页面：<br><br> <img src="https://images2.imgbox.com/d0/4a/CbKEQiOB_o.png" alt=""><br> <br>单元测试写了，测试报告也有了，接下来就差扫描项目单元测试覆盖率了。<br></p> 
<p></p> 
<h3><a id="5_nyc__583"></a>5、使用 nyc 扫描测试覆盖率</h3> 
<p><br>文档地址：<a href="https://istanbul.js.org/" rel="nofollow">https://istanbul.js.org/</a><br><br> <br>项目地址：<a href="https://github.com/istanbuljs/nyc">https://github.com/istanbuljs/nyc</a><br><br> <br>首先，在项目中安装所需依赖：<br></p> 
<pre><code class="prism language-shell"><span class="token function">npm</span> i --save-dev babel-plugin-istanbul istanbul-instrumenter-loader nyc
</code></pre> 
<p><br>接着在项目根目录下新建 nyc.config.js 文件，其内容如下：<br></p> 
<pre><code class="prism language-javascript"><span class="token comment">// 探索istanbul/nyc代码覆盖工具的原理 https://zhuanlan.zhihu.com/p/88524418</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token string">'check-coverage'</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">'per-file'</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">'lines'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string">'statements'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string">'functions'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string">'branches'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string">'include'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'src/**/*.js'</span><span class="token punctuation">,</span>
    <span class="token string">'src/**/*.vue'</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">'exclude'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'src/abandon-ui/**'</span><span class="token punctuation">,</span>
    <span class="token string">'src/*.js'</span><span class="token punctuation">,</span>
    <span class="token string">'**/*.spec.js'</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">'reporter'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'lcov'</span><span class="token punctuation">,</span>
    <span class="token string">'text'</span><span class="token punctuation">,</span>
    <span class="token string">'text-summary'</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">'extension'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'.js'</span><span class="token punctuation">,</span>
    <span class="token string">'.vue'</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">'cache'</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">'all'</span><span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><br>完成后，在项目根目录新建 vue.config.js, 其内容如下：<br></p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> testMode <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'test'</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  lintOnSave<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  productionSourceMap<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>

  chainWebpack<span class="token punctuation">:</span> config <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>testMode<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      config<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        devtool<span class="token punctuation">:</span> <span class="token string">'eval'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      config<span class="token punctuation">.</span>module
        <span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">'istanbul'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token regex">/\.(js|vue)$/</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>include
        <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/src'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'istanbul-instrumenter-loader'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token string">'istanbul-instrumenter-loader'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> esModules<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token string">'babel-loader'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><br>完成后，打开项目根目录下的 babel.config.js 文件，修改如下：<br></p> 
<pre><code class="prism language-javascript"><span class="token operator">+</span> <span class="token keyword">const</span> testMode <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'test'</span>
<span class="token operator">+</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">-</span>   presets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'@vue/cli-plugin-babel/preset'</span><span class="token punctuation">]</span>
<span class="token operator">+</span>   presets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'@vue/cli-plugin-babel/preset'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">+</span>   plugins<span class="token punctuation">:</span> testMode <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token string">'babel-plugin-istanbul'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
</code></pre> 
<p><br>最后，打开 package.json 文件，修改 test:unit 命令：<br></p> 
<pre><code class="prism language-json"><span class="token operator">-</span>    <span class="token string">"test:unit"</span><span class="token punctuation">:</span> <span class="token string">"vue-cli-service test:unit --reporter=mochawesome"</span><span class="token punctuation">,</span>
<span class="token operator">+</span>    <span class="token string">"test:unit"</span><span class="token punctuation">:</span> <span class="token string">"nyc vue-cli-service test:unit --reporter=mochawesome"</span><span class="token punctuation">,</span>
</code></pre> 
<p><br>再次执行新的 test:unit 命令：<br></p> 
<pre><code class="prism language-powershell">npm run test:unit

&gt; vue<span class="token operator">-</span>cli4<span class="token operator">-</span>unit<span class="token operator">-</span>mocha<span class="token operator">-</span>chai<span class="token operator">-</span>nyc@0<span class="token punctuation">.</span>1<span class="token punctuation">.</span>0 test:unit <span class="token operator">/</span>Users<span class="token operator">/</span>heyi<span class="token operator">/</span>File<span class="token operator">/</span>Front<span class="token operator">-</span><span class="token keyword">End</span><span class="token operator">/</span>demo<span class="token operator">/</span>_unit<span class="token operator">/</span>vue<span class="token operator">-</span>cli4<span class="token operator">-</span>unit<span class="token operator">-</span>mocha<span class="token operator">-</span>chai<span class="token operator">-</span>nyc
&gt; nyc vue<span class="token operator">-</span><span class="token function">cli</span><span class="token operator">-</span>service test:unit <span class="token operator">--</span>reporter=mochawesome

 WEBPACK  Compiling<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

  <span class="token punctuation">[</span>===                      <span class="token punctuation">]</span> 10<span class="token operator">%</span> <span class="token punctuation">(</span>building<span class="token punctuation">)</span>Download the Vue Devtools extension <span class="token keyword">for</span> a better development experience:
https:<span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>vuejs<span class="token operator">/</span>vue<span class="token operator">-</span>devtools
You are running Vue in development mode<span class="token punctuation">.</span>
Make sure to turn on production mode when deploying <span class="token keyword">for</span> production<span class="token punctuation">.</span>
See more tips at https:<span class="token operator">/</span><span class="token operator">/</span>vuejs<span class="token punctuation">.</span>org<span class="token operator">/</span>guide<span class="token operator">/</span>deployment<span class="token punctuation">.</span>html
  <span class="token punctuation">[</span>=========================<span class="token punctuation">]</span> 98<span class="token operator">%</span> <span class="token punctuation">(</span>after emitting<span class="token punctuation">)</span>

 DONE  Compiled successfully in 2210ms

  <span class="token punctuation">[</span>=========================<span class="token punctuation">]</span> 100<span class="token operator">%</span> <span class="token punctuation">(</span>completed<span class="token punctuation">)</span>

 WEBPACK  Compiled successfully in 2210ms

 MOCHA  Testing<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>



  HelloWorld<span class="token punctuation">.</span>vue
    ✓ renders props<span class="token punctuation">.</span>msg when passed <span class="token punctuation">(</span>41ms<span class="token punctuation">)</span>

  src/<span class="token operator">*</span>*<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>spec<span class="token punctuation">.</span>js AppEmpty<span class="token punctuation">.</span>vue
    ✓ no props<span class="token punctuation">.</span>text when passed
    ✓ renders props<span class="token punctuation">.</span>text when passed

  AppEmpty<span class="token punctuation">.</span>vue
    ✓ no props<span class="token punctuation">.</span>text when passed
    ✓ renders props<span class="token punctuation">.</span>text when passed


  5 passing <span class="token punctuation">(</span>72ms<span class="token punctuation">)</span>

<span class="token namespace">[mochawesome]</span> Report JSON saved to <span class="token operator">/</span>Users<span class="token operator">/</span>heyi<span class="token operator">/</span>File<span class="token operator">/</span>Front<span class="token operator">-</span><span class="token keyword">End</span><span class="token operator">/</span>demo<span class="token operator">/</span>_unit<span class="token operator">/</span>vue<span class="token operator">-</span>cli4<span class="token operator">-</span>unit<span class="token operator">-</span>mocha<span class="token operator">-</span>chai<span class="token operator">-</span>nyc<span class="token operator">/</span>mochawesome<span class="token operator">-</span>report<span class="token operator">/</span>mochawesome<span class="token punctuation">.</span>json

<span class="token namespace">[mochawesome]</span> Report HTML saved to <span class="token operator">/</span>Users<span class="token operator">/</span>heyi<span class="token operator">/</span>File<span class="token operator">/</span>Front<span class="token operator">-</span><span class="token keyword">End</span><span class="token operator">/</span>demo<span class="token operator">/</span>_unit<span class="token operator">/</span>vue<span class="token operator">-</span>cli4<span class="token operator">-</span>unit<span class="token operator">-</span>mocha<span class="token operator">-</span>chai<span class="token operator">-</span>nyc<span class="token operator">/</span>mochawesome<span class="token operator">-</span>report<span class="token operator">/</span>mochawesome<span class="token punctuation">.</span>html

 MOCHA  Tests completed successfully

<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>
File             <span class="token punctuation">|</span> <span class="token operator">%</span> Stmts <span class="token punctuation">|</span> <span class="token operator">%</span> Branch <span class="token punctuation">|</span> <span class="token operator">%</span> Funcs <span class="token punctuation">|</span> <span class="token operator">%</span> Lines <span class="token punctuation">|</span> Uncovered Line <span class="token comment">#s </span>
<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>
All files        <span class="token punctuation">|</span>   16<span class="token punctuation">.</span>67 <span class="token punctuation">|</span>      100 <span class="token punctuation">|</span>      50 <span class="token punctuation">|</span>   16<span class="token punctuation">.</span>67 <span class="token punctuation">|</span>                   
 components      <span class="token punctuation">|</span>     100 <span class="token punctuation">|</span>      100 <span class="token punctuation">|</span>     100 <span class="token punctuation">|</span>     100 <span class="token punctuation">|</span>                   
  AppEmpty<span class="token punctuation">.</span>vue   <span class="token punctuation">|</span>     100 <span class="token punctuation">|</span>      100 <span class="token punctuation">|</span>     100 <span class="token punctuation">|</span>     100 <span class="token punctuation">|</span>                   
  HelloWorld<span class="token punctuation">.</span>vue <span class="token punctuation">|</span>       0 <span class="token punctuation">|</span>        0 <span class="token punctuation">|</span>       0 <span class="token punctuation">|</span>       0 <span class="token punctuation">|</span>                   
 router          <span class="token punctuation">|</span>       0 <span class="token punctuation">|</span>      100 <span class="token punctuation">|</span>       0 <span class="token punctuation">|</span>       0 <span class="token punctuation">|</span>                   
  index<span class="token punctuation">.</span>js       <span class="token punctuation">|</span>       0 <span class="token punctuation">|</span>      100 <span class="token punctuation">|</span>       0 <span class="token punctuation">|</span>       0 <span class="token punctuation">|</span> 5<span class="token operator">-</span>23              
 store           <span class="token punctuation">|</span>       0 <span class="token punctuation">|</span>      100 <span class="token punctuation">|</span>     100 <span class="token punctuation">|</span>       0 <span class="token punctuation">|</span>                   
  index<span class="token punctuation">.</span>js       <span class="token punctuation">|</span>       0 <span class="token punctuation">|</span>      100 <span class="token punctuation">|</span>     100 <span class="token punctuation">|</span>       0 <span class="token punctuation">|</span> 4                 
<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span><span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>

=============================== Coverage summary ===============================
Statements   : 16<span class="token punctuation">.</span>67<span class="token operator">%</span> <span class="token punctuation">(</span> 1<span class="token operator">/</span>6 <span class="token punctuation">)</span>
Branches     : 100<span class="token operator">%</span> <span class="token punctuation">(</span> 0<span class="token operator">/</span>0 <span class="token punctuation">)</span>
Functions    : 50<span class="token operator">%</span> <span class="token punctuation">(</span> 1<span class="token operator">/</span>2 <span class="token punctuation">)</span>
Lines        : 16<span class="token punctuation">.</span>67<span class="token operator">%</span> <span class="token punctuation">(</span> 1<span class="token operator">/</span>6 <span class="token punctuation">)</span>
================================================================================
</code></pre> 
<p><br>执行成功后会发现根目录下除了新增加的 mochawesome-report/ 目录，还多了 coverage/ 和 .nyc_output/ 目录，我们的覆盖率结果就输出在 coverage/ 目录下。<br><br> <br>在浏览器打开 coverage/ 目录下的 index.html 文件会出现以下页面：<br><br> <img src="https://images2.imgbox.com/80/a7/BjVlbz6o_o.png" alt=""><br> <br>单击页面上的 components 可以看到改目录下的详细 .vue 文件覆盖率情况：<br><br> <img src="https://images2.imgbox.com/4a/b2/T5c0KH0x_o.png" alt=""><br> <br>再次单击 AppEmpty.vue 可以看到文件文件内的覆盖情况：<br><br> <img src="https://images2.imgbox.com/16/d8/75nYkidK_o.png" alt=""><br> <br>最后列出 package.json 文件，以做参考：<br></p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"vue-cli4-unit-mocha-chai-nyc"</span><span class="token punctuation">,</span>
  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"0.1.0"</span><span class="token punctuation">,</span>
  <span class="token string">"private"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"serve"</span><span class="token punctuation">:</span> <span class="token string">"vue-cli-service serve"</span><span class="token punctuation">,</span>
    <span class="token string">"build"</span><span class="token punctuation">:</span> <span class="token string">"vue-cli-service build"</span><span class="token punctuation">,</span>
    <span class="token string">"test:unit"</span><span class="token punctuation">:</span> <span class="token string">"nyc vue-cli-service test:unit --reporter=mochawesome"</span><span class="token punctuation">,</span>
    <span class="token string">"test:e2e"</span><span class="token punctuation">:</span> <span class="token string">"vue-cli-service test:e2e"</span><span class="token punctuation">,</span>
    <span class="token string">"lint"</span><span class="token punctuation">:</span> <span class="token string">"vue-cli-service lint"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"dependencies"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"core-js"</span><span class="token punctuation">:</span> <span class="token string">"^3.6.5"</span><span class="token punctuation">,</span>
    <span class="token string">"vue"</span><span class="token punctuation">:</span> <span class="token string">"^2.6.11"</span><span class="token punctuation">,</span>
    <span class="token string">"vue-router"</span><span class="token punctuation">:</span> <span class="token string">"^3.2.0"</span><span class="token punctuation">,</span>
    <span class="token string">"vuex"</span><span class="token punctuation">:</span> <span class="token string">"^3.4.0"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"devDependencies"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"@vue/cli-plugin-babel"</span><span class="token punctuation">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/cli-plugin-e2e-cypress"</span><span class="token punctuation">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/cli-plugin-eslint"</span><span class="token punctuation">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/cli-plugin-router"</span><span class="token punctuation">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/cli-plugin-unit-mocha"</span><span class="token punctuation">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/cli-plugin-vuex"</span><span class="token punctuation">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/cli-service"</span><span class="token punctuation">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/eslint-config-standard"</span><span class="token punctuation">:</span> <span class="token string">"^5.1.2"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/test-utils"</span><span class="token punctuation">:</span> <span class="token string">"^1.0.3"</span><span class="token punctuation">,</span>
    <span class="token string">"babel-eslint"</span><span class="token punctuation">:</span> <span class="token string">"^10.1.0"</span><span class="token punctuation">,</span>
    <span class="token string">"babel-plugin-istanbul"</span><span class="token punctuation">:</span> <span class="token string">"^6.0.0"</span><span class="token punctuation">,</span>
    <span class="token string">"chai"</span><span class="token punctuation">:</span> <span class="token string">"^4.1.2"</span><span class="token punctuation">,</span>
    <span class="token string">"eslint"</span><span class="token punctuation">:</span> <span class="token string">"^6.7.2"</span><span class="token punctuation">,</span>
    <span class="token string">"eslint-plugin-import"</span><span class="token punctuation">:</span> <span class="token string">"^2.20.2"</span><span class="token punctuation">,</span>
    <span class="token string">"eslint-plugin-node"</span><span class="token punctuation">:</span> <span class="token string">"^11.1.0"</span><span class="token punctuation">,</span>
    <span class="token string">"eslint-plugin-promise"</span><span class="token punctuation">:</span> <span class="token string">"^4.2.1"</span><span class="token punctuation">,</span>
    <span class="token string">"eslint-plugin-standard"</span><span class="token punctuation">:</span> <span class="token string">"^4.0.0"</span><span class="token punctuation">,</span>
    <span class="token string">"eslint-plugin-vue"</span><span class="token punctuation">:</span> <span class="token string">"^6.2.2"</span><span class="token punctuation">,</span>
    <span class="token string">"istanbul-instrumenter-loader"</span><span class="token punctuation">:</span> <span class="token string">"^3.0.1"</span><span class="token punctuation">,</span>
    <span class="token string">"mochawesome"</span><span class="token punctuation">:</span> <span class="token string">"^6.1.1"</span><span class="token punctuation">,</span>
    <span class="token string">"node-sass"</span><span class="token punctuation">:</span> <span class="token string">"^4.12.0"</span><span class="token punctuation">,</span>
    <span class="token string">"nyc"</span><span class="token punctuation">:</span> <span class="token string">"^15.0.1"</span><span class="token punctuation">,</span>
    <span class="token string">"sass-loader"</span><span class="token punctuation">:</span> <span class="token string">"^8.0.2"</span><span class="token punctuation">,</span>
    <span class="token string">"vue-template-compiler"</span><span class="token punctuation">:</span> <span class="token string">"^2.6.11"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p></p> 
<h3><a id="6_karma__803"></a>6、使用 karma 扫描测试覆盖率</h3> 
<p><br>扫描测试覆盖率的另一个方法是使用 karma。<br><br> <br>官网：<a href="http://karma-runner.github.io/latest/index.html" rel="nofollow">http://karma-runner.github.io/latest/index.html</a><br><br> <br>在前面的 1-5 节部分，所有的内容都是在第 1 节建立的项目 vue-cli4-unit-mocha-chai-nyc 中依次完成的。在本节内容开始之前，需要按照第 1 节的内容，重新创建一个项目：vue-cli4-unit-mocha-chai-karma 。<br><br> <br>首先，依旧是安装需要的依赖：<br></p> 
<pre><code class="prism language-shell"><span class="token function">npm</span> i --save-dev karma karma-mocha mocha karma-chai \
karma-webpack karma-chrome-launcher karma-sourcemap-loader karma-spec-reporter \
karma-coverage@1.1.2 babel-plugin-istanbul@5.1.4 cross-env
</code></pre> 
<p><br>在项目根目录创建 karma.conf.js 文件，其内容如下：<br></p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> webpackConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@vue/cli-service/webpack.config.js'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  config<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    frameworks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'mocha'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

    files<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token string">'tests/**/*.spec.js'</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    preprocessors<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string">'**/*.spec.js'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'webpack'</span><span class="token punctuation">,</span> <span class="token string">'sourcemap'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    webpack<span class="token punctuation">:</span> webpackConfig<span class="token punctuation">,</span>

    reporters<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'spec'</span><span class="token punctuation">,</span> <span class="token string">'coverage'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    coverageReporter<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      dir<span class="token punctuation">:</span> <span class="token string">'./coverage'</span><span class="token punctuation">,</span>
      reporters<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span> type<span class="token punctuation">:</span> <span class="token string">'lcov'</span><span class="token punctuation">,</span> subdir<span class="token punctuation">:</span> <span class="token string">'.'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span> type<span class="token punctuation">:</span> <span class="token string">'text-summary'</span> <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    autoWatch<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

    browsers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'ChromeHeadless'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><br>然后，修改 babel.config.js 文件：<br></p> 
<pre><code class="prism language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  presets<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'@vue/cli-plugin-babel/preset'</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">+</span> env<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>   test<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">+</span>     plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"istanbul"</span><span class="token punctuation">]</span>
<span class="token operator">+</span> 	<span class="token punctuation">}</span>
<span class="token operator">+</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><br>接着，修改 package.json 文件的 test:unit 命令为：<br></p> 
<pre><code class="prism language-json"><span class="token string">"test:unit"</span><span class="token punctuation">:</span> <span class="token string">"cross-env NODE_ENV=test karma start --single-run"</span><span class="token punctuation">,</span>
</code></pre> 
<p><br>关于这里使用 <code>BABEL_ENV=test</code> 还是 <code>NODE_ENV=test</code>，建议是 <code>NODE_ENV=test</code>。<br></p> 
<blockquote> 
 <p>Karma can’t handle split chunks.</p> 
 <ul><li>In <code>@vue/cli-service</code> v3, unless you explicitly set <code>NODE_ENV</code> to <code>production</code>, <code>splitChunks</code> won’t be turned on.</li><li>In <code>@vue/cli-service</code> v4, unless you explicitly set <code>NODE_ENV</code> to <code>test</code>, <code>splitChunks</code> will be turned on by default.</li></ul> 
</blockquote> 
<p>It is a good practice to always set <code>NODE_ENV</code> to <code>test</code> during unit testing because many of the packages in Node.js ecosystem follows this convention.</p> 
<blockquote> 
 <p>Actually, with <code>NODE_ENV=test</code>, you can skip <code>BABEL_ENV=test</code> because it will default to <code>NODE_ENV</code>.</p> 
</blockquote> 
<p><br>最后，我们执行 test:unit 命令：<br></p> 
<pre><code class="prism language-shell"><span class="token function">npm</span> run test:unit                                    

<span class="token operator">&gt;</span> vue-cli4-unit-mocha-chai-karma@0.1.0 test:unit /Users/heyi/File/Front-End/demo/_unit/vue-cli4-unit-mocha-chai-karma
<span class="token operator">&gt;</span> cross-env NODE_ENV<span class="token operator">=</span>test karma start --single-run



 DONE  Compiled successfully <span class="token keyword">in</span> 671ms

ℹ ｢wdm｣: Hash: f44d39181b90d9235a4b
Version: webpack 4.43.0
Time: 671ms
Built at: 2020-05-29 09:55:03
                                                                                                 Asset       Size                   Chunks             Chunk Names
<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/Users/heyi/File/Front-End/demo/_unit/vue-cli4-unit-mocha-chai-karma/dist/favicon.ico   4.19 KiB                           <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  
                                                                                                app.js   1.22 MiB                      app  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  app
                                                                                 img/logo.82b9c7a5.png   6.69 KiB                           <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  
                                                                                            index.html  889 bytes                           <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  
                                                                            tests/unit/example.spec.js    3.1 MiB  tests/unit/example.spec  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  tests/unit/example.spec
Entrypoint app <span class="token operator">=</span> app.js
Entrypoint tests/unit/example.spec <span class="token operator">=</span> tests/unit/example.spec.js
<span class="token punctuation">[</span>0<span class="token punctuation">]</span> multi ./src/main.js 28 bytes <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">}</span>
<span class="token punctuation">[</span>./node_modules/@babel/runtime/helpers/interopRequireDefault.js<span class="token punctuation">]</span> 147 bytes <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">}</span> <span class="token punctuation">{<!-- --></span>tests/unit/example.spec<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span>./node_modules/@vue/test-utils/dist/vue-test-utils.js<span class="token punctuation">]</span> 400 KiB <span class="token punctuation">{<!-- --></span>tests/unit/example.spec<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span>./node_modules/chai/index.js<span class="token punctuation">]</span> 40 bytes <span class="token punctuation">{<!-- --></span>tests/unit/example.spec<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span>./node_modules/chai/lib/chai.js<span class="token punctuation">]</span> 1.23 KiB <span class="token punctuation">{<!-- --></span>tests/unit/example.spec<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span>./node_modules/vue-loader/lib/runtime/componentNormalizer.js<span class="token punctuation">]</span> 2.71 KiB <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">}</span> <span class="token punctuation">{<!-- --></span>tests/unit/example.spec<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span>./node_modules/vue-template-compiler/index.js<span class="token punctuation">]</span> 865 bytes <span class="token punctuation">{<!-- --></span>tests/unit/example.spec<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span>./node_modules/vue/dist/vue.runtime.esm.js<span class="token punctuation">]</span> 222 KiB <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">}</span> <span class="token punctuation">{<!-- --></span>tests/unit/example.spec<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span>./src/App.vue<span class="token punctuation">]</span> 566 bytes <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span>./src/components/HelloWorld.vue<span class="token punctuation">]</span> 599 bytes <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">}</span> <span class="token punctuation">{<!-- --></span>tests/unit/example.spec<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span>./src/components/HelloWorld.vue?vue<span class="token operator">&amp;</span>type<span class="token operator">=</span>script<span class="token operator">&amp;</span>lang<span class="token operator">=</span>js<span class="token operator">&amp;</span><span class="token punctuation">]</span> 576 bytes <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">}</span> <span class="token punctuation">{<!-- --></span>tests/unit/example.spec<span class="token punctuation">}</span>
<span class="token punctuation">[</span>./src/components/HelloWorld.vue?vue<span class="token operator">&amp;</span>type<span class="token operator">=</span>template<span class="token operator">&amp;</span>id<span class="token operator">=</span>469af010<span class="token operator">&amp;</span>scoped<span class="token operator">=</span>true<span class="token operator">&amp;</span><span class="token punctuation">]</span> 427 bytes <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">}</span> <span class="token punctuation">{<!-- --></span>tests/unit/example.spec<span class="token punctuation">}</span>
<span class="token punctuation">[</span>./src/main.js<span class="token punctuation">]</span> 2.38 KiB <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span>./src/router/index.js<span class="token punctuation">]</span> 3.23 KiB <span class="token punctuation">{<!-- --></span>app<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span>./tests/unit/example.spec.js<span class="token punctuation">]</span> 3.27 KiB <span class="token punctuation">{<!-- --></span>tests/unit/example.spec<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
    + 160 hidden modules
Child html-webpack-plugin <span class="token keyword">for</span> <span class="token string">"index.html"</span><span class="token keyword">:</span>
         Asset     Size  Chunks  Chunk Names
    index.html  534 KiB       1  
    Entrypoint undefined <span class="token operator">=</span> index.html
    <span class="token punctuation">[</span>./node_modules/html-webpack-plugin/lib/loader.js<span class="token operator">!</span>./public/index.html<span class="token punctuation">]</span> 928 bytes <span class="token punctuation">{<!-- --></span>1<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
    <span class="token punctuation">[</span>./node_modules/lodash/lodash.js<span class="token punctuation">]</span> 528 KiB <span class="token punctuation">{<!-- --></span>1<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
    <span class="token punctuation">[</span>./node_modules/webpack/buildin/module.js<span class="token punctuation">]</span> <span class="token punctuation">(</span>webpack<span class="token punctuation">)</span>/buildin/module.js 497 bytes <span class="token punctuation">{<!-- --></span>1<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
ℹ ｢wdm｣: Compiled successfully.
29 05 2020 09:55:03.205:INFO <span class="token punctuation">[</span>karma-server<span class="token punctuation">]</span>: Karma v5.0.9 server started at http://0.0.0.0:9876/
29 05 2020 09:55:03.207:INFO <span class="token punctuation">[</span>launcher<span class="token punctuation">]</span>: Launching browsers ChromeHeadless with concurrency unlimited
29 05 2020 09:55:03.231:INFO <span class="token punctuation">[</span>launcher<span class="token punctuation">]</span>: Starting browser ChromeHeadless
29 05 2020 09:55:03.790:INFO <span class="token punctuation">[</span>Chrome Headless 83.0.4103.61 <span class="token punctuation">(</span>Mac OS 10.14.6<span class="token punctuation">)</span><span class="token punctuation">]</span>: Connected on socket WTpGcR9Fum14KL6rAAAA with <span class="token function">id</span> 16752070

  HelloWorld.vue
    ✓ renders props.msg when passed

Chrome Headless 83.0.4103.61 <span class="token punctuation">(</span>Mac OS 10.14.6<span class="token punctuation">)</span>: Executed 1 of 1 SUCCESS <span class="token punctuation">(</span>0.012 secs / 0.009 secs<span class="token punctuation">)</span>
TOTAL: 1 SUCCESS


<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> Coverage summary <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Statements   <span class="token keyword">:</span> 100% <span class="token punctuation">(</span> 6/6 <span class="token punctuation">)</span>
Branches     <span class="token keyword">:</span> 100% <span class="token punctuation">(</span> 0/0 <span class="token punctuation">)</span>
Functions    <span class="token keyword">:</span> 100% <span class="token punctuation">(</span> 3/3 <span class="token punctuation">)</span>
Lines        <span class="token keyword">:</span> 100% <span class="token punctuation">(</span> 6/6 <span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
</code></pre> 
<p><br>执行成功后会在项目根目录下生成 coverage/** 文件夹，放着输出的测试覆盖率，我们在浏览器打开 coverage/lcov-report/index.html 文件，其页面如下：<br><br> <img src="https://images2.imgbox.com/e1/2e/oFeBS0pb_o.png" alt=""><br> <br>与使用 nyc 输出的页面一样，也可以单击列表的 src/components/ 查看该目录下的详细文件：<br><br> <img src="https://images2.imgbox.com/b6/26/Yd2dBjtz_o.png" alt=""><br> <br><br> <br>查看 HelloWorld.vue 文件详情：<br><br> <img src="https://images2.imgbox.com/5c/33/b49OAVSu_o.png" alt=""><br> <br><br> <br>由于在写这篇记录的时候，发现存在依赖（karma-coverage、babel-plugin-istanbul）不能直接安装最新版本，下面列出完整的 package.json 文件，以做参考：<br></p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"vue-cli4-unit-mocha-chai-karma"</span><span class="token punctuation">,</span>
  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"0.1.0"</span><span class="token punctuation">,</span>
  <span class="token string">"private"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"serve"</span><span class="token punctuation">:</span> <span class="token string">"vue-cli-service serve"</span><span class="token punctuation">,</span>
    <span class="token string">"build"</span><span class="token punctuation">:</span> <span class="token string">"vue-cli-service build"</span><span class="token punctuation">,</span>
    <span class="token string">"test:unit"</span><span class="token punctuation">:</span> <span class="token string">"cross-env NODE_ENV=test karma start --single-run"</span><span class="token punctuation">,</span>
    <span class="token string">"test:e2e"</span><span class="token punctuation">:</span> <span class="token string">"vue-cli-service test:e2e"</span><span class="token punctuation">,</span>
    <span class="token string">"lint"</span><span class="token punctuation">:</span> <span class="token string">"vue-cli-service lint"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"dependencies"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"core-js"</span><span class="token punctuation">:</span> <span class="token string">"^3.6.5"</span><span class="token punctuation">,</span>
    <span class="token string">"vue"</span><span class="token punctuation">:</span> <span class="token string">"^2.6.11"</span><span class="token punctuation">,</span>
    <span class="token string">"vue-router"</span><span class="token punctuation">:</span> <span class="token string">"^3.2.0"</span><span class="token punctuation">,</span>
    <span class="token string">"vuex"</span><span class="token punctuation">:</span> <span class="token string">"^3.4.0"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"devDependencies"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"@vue/cli-plugin-babel"</span><span class="token punctuation">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/cli-plugin-e2e-cypress"</span><span class="token punctuation">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/cli-plugin-eslint"</span><span class="token punctuation">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/cli-plugin-router"</span><span class="token punctuation">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/cli-plugin-unit-mocha"</span><span class="token punctuation">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/cli-plugin-vuex"</span><span class="token punctuation">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/cli-service"</span><span class="token punctuation">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/eslint-config-standard"</span><span class="token punctuation">:</span> <span class="token string">"^5.1.2"</span><span class="token punctuation">,</span>
    <span class="token string">"@vue/test-utils"</span><span class="token punctuation">:</span> <span class="token string">"^1.0.3"</span><span class="token punctuation">,</span>
    <span class="token string">"babel-eslint"</span><span class="token punctuation">:</span> <span class="token string">"^10.1.0"</span><span class="token punctuation">,</span>
    <span class="token string">"babel-plugin-istanbul"</span><span class="token punctuation">:</span> <span class="token string">"^5.1.4"</span><span class="token punctuation">,</span>
    <span class="token string">"chai"</span><span class="token punctuation">:</span> <span class="token string">"^4.1.2"</span><span class="token punctuation">,</span>
    <span class="token string">"cross-env"</span><span class="token punctuation">:</span> <span class="token string">"^7.0.2"</span><span class="token punctuation">,</span>
    <span class="token string">"eslint"</span><span class="token punctuation">:</span> <span class="token string">"^6.7.2"</span><span class="token punctuation">,</span>
    <span class="token string">"eslint-plugin-import"</span><span class="token punctuation">:</span> <span class="token string">"^2.20.2"</span><span class="token punctuation">,</span>
    <span class="token string">"eslint-plugin-node"</span><span class="token punctuation">:</span> <span class="token string">"^11.1.0"</span><span class="token punctuation">,</span>
    <span class="token string">"eslint-plugin-promise"</span><span class="token punctuation">:</span> <span class="token string">"^4.2.1"</span><span class="token punctuation">,</span>
    <span class="token string">"eslint-plugin-standard"</span><span class="token punctuation">:</span> <span class="token string">"^4.0.0"</span><span class="token punctuation">,</span>
    <span class="token string">"eslint-plugin-vue"</span><span class="token punctuation">:</span> <span class="token string">"^6.2.2"</span><span class="token punctuation">,</span>
    <span class="token string">"karma"</span><span class="token punctuation">:</span> <span class="token string">"^5.0.9"</span><span class="token punctuation">,</span>
    <span class="token string">"karma-chai"</span><span class="token punctuation">:</span> <span class="token string">"^0.1.0"</span><span class="token punctuation">,</span>
    <span class="token string">"karma-chrome-launcher"</span><span class="token punctuation">:</span> <span class="token string">"^3.1.0"</span><span class="token punctuation">,</span>
    <span class="token string">"karma-coverage"</span><span class="token punctuation">:</span> <span class="token string">"^1.1.2"</span><span class="token punctuation">,</span>
    <span class="token string">"karma-mocha"</span><span class="token punctuation">:</span> <span class="token string">"^2.0.1"</span><span class="token punctuation">,</span>
    <span class="token string">"karma-sourcemap-loader"</span><span class="token punctuation">:</span> <span class="token string">"^0.3.7"</span><span class="token punctuation">,</span>
    <span class="token string">"karma-spec-reporter"</span><span class="token punctuation">:</span> <span class="token string">"0.0.32"</span><span class="token punctuation">,</span>
    <span class="token string">"karma-webpack"</span><span class="token punctuation">:</span> <span class="token string">"^4.0.2"</span><span class="token punctuation">,</span>
    <span class="token string">"mocha"</span><span class="token punctuation">:</span> <span class="token string">"^7.2.0"</span><span class="token punctuation">,</span>
    <span class="token string">"node-sass"</span><span class="token punctuation">:</span> <span class="token string">"^4.12.0"</span><span class="token punctuation">,</span>
    <span class="token string">"sass-loader"</span><span class="token punctuation">:</span> <span class="token string">"^8.0.2"</span><span class="token punctuation">,</span>
    <span class="token string">"vue-template-compiler"</span><span class="token punctuation">:</span> <span class="token string">"^2.6.11"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><br>使用 karma 其它常用依赖：<br></p> 
<pre><code>chai-spies karma-chai-spies \
sinon sinon-chai karma-sinon-chai
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9df8ec04c0b12fb4eda9352a789f562a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ROS-读取pcd点云数据进行滤波并在Rviz中显示</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/731f152e75ced66da3e511e67e8971c9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python读写kepware数据</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>