<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>禅道二次开发（一）：开发环境配置 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="禅道二次开发（一）：开发环境配置" />
<meta property="og:description" content="禅道是一个开源的项目管理软件，作为测试人员最常用的功能就是用例管理和bug管理。目前的禅道开源版可能无法满足业务需求，可以基于禅道进行二次开发。先来介绍下如何配置禅道开发环境。
目录 前言禅道环境部署禅道安装禅道升级 连接数据库配置linux和windows文件共享Vscode 配置PHP开发环境参考资料 前言 禅道项目管理软件主要使用PHP语言，是基于zentaoPHP框架进行开发的。要对禅道进行二次开发需要对PHP语言、zentaoPHP框架、前端ZUI框架、MySQL数据库、HTML、JavaScript等有一定的了解。后续我会陆续发布一些禅道二次开发的相关笔记，文章不会对这些基础进行过多介绍，关于禅道二次开发的相关资料可滑到文章末尾查看，都是禅道官方提供的资料，介绍的比较详细。
下面介绍我是如何配置禅道开发环境的。
禅道环境部署 在Windows中部署PHP环境可以使用XAMPP，它是一个Apache发行版，其中包含了MariaDB、PHP和Perl。下载地址：
https://www.apachefriends.org/index.htmlhttps://www.apachefriends.org/zh_cn/download.html 由于我们的禅道部署在Linux系统上，我选择在Linux上部署环境。Linux也可以使用XAMPP部署，我觉得太麻烦就没有使用它，而是直接在Linux上安装禅道，因为禅道安装包内置了apache、php、mysql这些应用程序，不需要再单独安装部署。直接在禅道目录中进行二次开发就可以了。
禅道安装 在linux中使用禅道一键安装包安装禅道，下载地址：https://www.zentao.net/download.html ，我下载的是禅道16.4版本。
1、将禅道一键安装包解压到/opt目录下
$ sudo tar -zxvf ZenTaoPMS.16.4.zbox_64.tar.gz -C /opt 解压完成后可以查看PHP的版本：
$ /opt/zbox/bin/php -v PHP 7.2.33 (cli) (built: Jul 14 2021 12:01:31) ( ZTS ) Copyright (c) 1997-2018 The PHP Group Zend Engine v3.2.0, Copyright (c) 1998-2018 Zend Technologies with the ionCube PHP Loader &#43; ionCube24 v10.4.4, Copyright (c) 2002-2020, by ionCube Ltd. with Zend OPcache v7." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/1d12047b17a10625fe3f8e4adb36752f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-09T15:22:22+08:00" />
<meta property="article:modified_time" content="2022-04-09T15:22:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">禅道二次开发（一）：开发环境配置</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>禅道是一个开源的项目管理软件，作为测试人员最常用的功能就是用例管理和bug管理。目前的禅道开源版可能无法满足业务需求，可以基于禅道进行二次开发。先来介绍下如何配置禅道开发环境。</p> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_5" rel="nofollow">前言</a></li><li><a href="#_11" rel="nofollow">禅道环境部署</a></li><li><ul><li><a href="#_20" rel="nofollow">禅道安装</a></li><li><a href="#_120" rel="nofollow">禅道升级</a></li></ul> 
  </li><li><a href="#_137" rel="nofollow">连接数据库</a></li><li><a href="#linuxwindows_171" rel="nofollow">配置linux和windows文件共享</a></li><li><a href="#Vscode_PHP_225" rel="nofollow">Vscode 配置PHP开发环境</a></li><li><a href="#_251" rel="nofollow">参考资料</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_5"></a>前言</h2> 
<p>禅道项目管理软件主要使用PHP语言，是基于zentaoPHP框架进行开发的。要对禅道进行二次开发需要对PHP语言、zentaoPHP框架、前端ZUI框架、MySQL数据库、HTML、JavaScript等有一定的了解。后续我会陆续发布一些禅道二次开发的相关笔记，文章不会对这些基础进行过多介绍，关于禅道二次开发的相关资料可滑到文章末尾查看，都是禅道官方提供的资料，介绍的比较详细。</p> 
<p>下面介绍我是如何配置禅道开发环境的。</p> 
<h2><a id="_11"></a>禅道环境部署</h2> 
<p>在Windows中部署PHP环境可以使用XAMPP，它是一个Apache发行版，其中包含了MariaDB、PHP和Perl。下载地址：</p> 
<ul><li>https://www.apachefriends.org/index.html</li><li>https://www.apachefriends.org/zh_cn/download.html</li></ul> 
<p>由于我们的禅道部署在Linux系统上，我选择在Linux上部署环境。Linux也可以使用XAMPP部署，我觉得太麻烦就没有使用它，而是直接在Linux上安装禅道，因为禅道安装包内置了apache、php、mysql这些应用程序，不需要再单独安装部署。直接在禅道目录中进行二次开发就可以了。</p> 
<h3><a id="_20"></a>禅道安装</h3> 
<p>在linux中使用禅道一键安装包安装禅道，下载地址：https://www.zentao.net/download.html ，我下载的是<a href="https://www.zentao.net/dynamic/zentaopms16.4-80496.html" rel="nofollow">禅道16.4版本</a>。</p> 
<p><strong>1、将禅道一键安装包解压到<code>/opt</code>目录下</strong></p> 
<pre><code class="prism language-bash">$ <span class="token function">sudo</span> <span class="token function">tar</span> -zxvf  ZenTaoPMS.16.4.zbox_64.tar.gz -C /opt
</code></pre> 
<p>解压完成后可以查看PHP的版本：</p> 
<pre><code class="prism language-bash">$  /opt/zbox/bin/php -v
PHP <span class="token number">7.2</span>.33 <span class="token punctuation">(</span>cli<span class="token punctuation">)</span> <span class="token punctuation">(</span>built: Jul <span class="token number">14</span> <span class="token number">2021</span> <span class="token number">12</span>:01:31<span class="token punctuation">)</span> <span class="token punctuation">(</span> ZTS <span class="token punctuation">)</span>
Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">1997</span>-2018 The PHP Group
Zend Engine v3.2.0, Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">1998</span>-2018 Zend Technologies
    with the ionCube PHP Loader + ionCube24 v10.4.4, Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2002</span>-2020, by ionCube Ltd.
    with Zend OPcache v7.2.33, Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">1999</span>-2018, by Zend Technologies
</code></pre> 
<p><strong>2、设置Apache和MySQL的端口号</strong></p> 
<p>可以使用 <code>/opt/zbox/zbox -h</code> 命令查看帮助信息：</p> 
<pre><code class="prism language-bash">$ /opt/zbox/zbox -h
Usage: zbox.php <span class="token punctuation">{<!-- --></span>start<span class="token operator">|</span>stop<span class="token operator">|</span>restart<span class="token operator">|</span>status<span class="token punctuation">}</span>

Options:
    -h --help Show help.
    -ap --aport Apache port, default <span class="token number">80</span>.
    -mp --mport Mysql port, default <span class="token number">3306</span>.

</code></pre> 
<p>设置端口：</p> 
<pre><code class="prism language-bash">$ /opt/zbox/zbox -ap <span class="token number">8080</span> -mp <span class="token number">3306</span>
</code></pre> 
<p>其中 <code>-ap</code> 参数设置Apache端口，<code>-mp</code> 参数设置Mysql端口。</p> 
<p><strong>3、关闭防火墙</strong></p> 
<p>查看防⽕火墙状态</p> 
<pre><code class="prism language-sh">$ systemctl status firewalld
$ systemctl status firewalld.service
</code></pre> 
<p>停⽌止firewall</p> 
<pre><code class="prism language-sh">$ systemctl stop firewalld.service
</code></pre> 
<p>禁止firewall开机启动</p> 
<pre><code class="prism language-sh">$ systemctl disable firewalld.service 
</code></pre> 
<p>关闭selinux：<code>vi /etc/selinux/config</code>，注释掉 <code>SELINUX=enforcing</code>，添加 <code>SELINUX=disabled</code></p> 
<p><strong>4、启动禅道</strong></p> 
<pre><code class="prism language-bash">$ /opt/zbox/zbox start
Start Apache success
Start Mysql success
</code></pre> 
<p>停止禅道命令：</p> 
<pre><code class="prism language-bash">$ /opt/zbox/zbox stop
</code></pre> 
<p>重启：</p> 
<pre><code class="prism language-bash">$ /opt/zbox/zbox restart
</code></pre> 
<p>可以设置一下开机自动启动，把 <code>/opt/zbox/zbox restart</code> 命令添加<code>/etc/rc.d/rc.local</code> 文件，并添加执行权限：</p> 
<pre><code class="prism language-bash">$ <span class="token function">chmod</span> +x /etc/rc.d/rc.local
</code></pre> 
<p>禅道启动成功后，浏览器访问：http://192.168.30.9:8080/ ，其中192.168.30.9为我的服务器地址，8080为apache端口。</p> 
<p><img src="https://images2.imgbox.com/33/24/O3DzaAtz_o.png" alt="" width="700"></p> 
<p>禅道默认管理员帐号是 admin，密码 123456。登录后需要修改登录密码：</p> 
<p><img src="https://images2.imgbox.com/74/d6/tLUNGODj_o.png" alt="" width="700"></p> 
<h3><a id="_120"></a>禅道升级</h3> 
<p>如果禅道使用linux一键安装包安装，可按照以下步骤升级：</p> 
<p>1、下载新版本的源码包 ZenTaoPMS.16.4.zip</p> 
<p>2、解压缩后得到zentaopms文件夹，将zentaopms/下面的所有文件复制到 <code>/opt/zbox/app/zentao/</code> 下面，覆盖同名文件：</p> 
<pre><code class="prism language-bash">$ <span class="token function">unzip</span> ZenTaoPMS.16.4.zip
$ <span class="token function">sudo</span> <span class="token function">cp</span> -rf zentaopms/* /opt/zbox/app/zentao/
</code></pre> 
<p>3、访问 <code>http:/192.168.30.9:8080/zentao/upgrade.php</code>，按照页面提示进行升级。</p> 
<h2><a id="_137"></a>连接数据库</h2> 
<p>下面介绍使用Mysql Workbench客户端工具来连接数禅道据库，其它数据库管理工具类似。</p> 
<p>1、先添加一个数据库管理用户，设置密码</p> 
<pre><code class="prism language-bash">$ ./opt/zbox/auth/adduser.sh
This tool is used to <span class="token function">add</span> user to access adminer
Account: root
Password: Adding password <span class="token keyword">for</span> user root
</code></pre> 
<p>2、打开Mysql Workbench客户端工具，新建连接</p> 
<p>先用SSH通道连接上服务器，再连接禅道数据库</p> 
<p><img src="https://images2.imgbox.com/87/6d/2gc0mw5s_o.png" alt="" width="700"></p> 
<p>3、连接数据库</p> 
<p><img src="https://images2.imgbox.com/26/6d/np2TNi08_o.png" alt="" width="700"></p> 
<p>这样就可以对禅道数据库进行操作了。</p> 
<p>命令行连接和导入数据库方法：</p> 
<ul><li> <p>登录数据库：<code>/opt/zbox/bin/mysql -u root -P 3306 -p</code></p> </li><li> <p>导入数据库：<code>/opt/zbox/bin/mysql -u root -P 3306 -p zentao &lt; zentao.sql</code></p> </li></ul> 
<h2><a id="linuxwindows_171"></a>配置linux和windows文件共享</h2> 
<p>为了方便开发，我选择在Windows上使用vscode编辑器进行开发。我的解决方案是使用samba来配置linux和windows的文件共享。安装方法可参考<a href="https://blog.csdn.net/u010698107/article/details/119850227">使用samba实现linux和windows文件共享</a>。</p> 
<p><code>vi /etc/samba/smb.conf</code> ：</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>global<span class="token punctuation">]</span>
        workgroup <span class="token operator">=</span> ZENTAO
        security <span class="token operator">=</span> user

        passdb backend <span class="token operator">=</span> tdbsam

        printing <span class="token operator">=</span> cups
<span class="token punctuation">[</span>zentao<span class="token punctuation">]</span>
        comment <span class="token operator">=</span> ZENTAO Projects
        path <span class="token operator">=</span> /opt/zbox
        public <span class="token operator">=</span> <span class="token function">yes</span>
        writable <span class="token operator">=</span> <span class="token function">yes</span>
        browseable <span class="token operator">=</span> <span class="token function">yes</span>
        guest ok <span class="token operator">=</span> <span class="token function">yes</span>
        <span class="token builtin class-name">read</span> only <span class="token operator">=</span> no

</code></pre> 
<p>设置用户名和密码：<code>smbpasswd -a root</code></p> 
<pre><code class="prism language-bash">$ smbpasswd -a root
New SMB password:
Retype new SMB password:
Added user root.

</code></pre> 
<p>启动 <em>smb.service</em> 和 <em>nmb.service</em>两个服务</p> 
<pre><code class="prism language-bash">systemctl start smb.service
systemctl start nmb.service
</code></pre> 
<p>设置开机启动</p> 
<pre><code class="prism language-bash">systemctl <span class="token builtin class-name">enable</span> smb.service
systemctl <span class="token builtin class-name">enable</span> nmb.service
</code></pre> 
<p>windows访问地址 <a href="%5C192.168.168.226%5Czentao" rel="nofollow">\\192.168.30.9\zentao</a></p> 
<p><img src="https://images2.imgbox.com/29/ce/mJw7pfTm_o.png" alt="" width="700"></p> 
<h2><a id="Vscode_PHP_225"></a>Vscode 配置PHP开发环境</h2> 
<p>如果要在Windows中编写PHP脚本，需要配置一下settings.json文件，配置PHP执行文件php.exe的路径。</p> 
<p>点击VSCode的 文件 -&gt; 首选项 -&gt; 设置，搜索php</p> 
<p><img src="https://images2.imgbox.com/ca/24/cfp8opsb_o.png" alt="" width="700"></p> 
<p>点击setting.json，添加配置：</p> 
<pre><code class="prism language-bash"><span class="token string">"php.validate.executablePath"</span><span class="token builtin class-name">:</span> <span class="token string">"D:/xampp/php/php.exe"</span>,
</code></pre> 
<p>安装插件PHP Debug用于PHP调试，如果是禅道二次开发可以不用配置它，修改代码后刷新禅道页面，会看到修改后的效果。</p> 
<p>另外推荐安装PHP Intelephense插件，可用于方法跳转。</p> 
<p>接下来可以在Vscode中打开共享的zentao文件夹：</p> 
<p><img src="https://images2.imgbox.com/98/f1/gohARWdC_o.png" alt="" width="700"></p> 
<p>为了方便开发建议对zentao目录进行版本管理。</p> 
<h2><a id="_251"></a>参考资料</h2> 
<ol><li>禅道官网：<a href="https://www.zentao.net/" rel="nofollow">https://www.zentao.net/</a></li><li>禅道下载：https://www.zentao.net/download</li><li>禅道安装教程：https://www.zentao.net/book/zentaopmshelp/90.html</li><li>禅道升级：https://www.zentao.net/book/zentaopmshelp/41.html</li><li>禅道二次开发讲解：https://www.zentao.net/publicclass/80237.html</li><li>二次开发机制：https://www.zentao.net/book/zentaopmshelp/225.html</li></ol> 
<center> 
 <b>--THE END--<b></b></b> 
</center> 
<blockquote> 
 <p>世间所有的相遇，都是久别重逢。——《一代宗师》</p> 
</blockquote>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c44e890d9d09585335f46fb1075bcb42/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Map补充：map遍历方法和computeIfAbsent()方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/536d68075bdbce3e008745acd38c83d4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">uniapp小程序父组件与子组件之间调用方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>