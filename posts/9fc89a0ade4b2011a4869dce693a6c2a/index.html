<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>QML学习十五：ListView的简单使用（内建Model） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="QML学习十五：ListView的简单使用（内建Model）" />
<meta property="og:description" content="若该文为原创文章，转载请注明原文出处
一、概念 1、MVC 作为一种经典的架构模式，通过把职责、性质相近的成分归结在一起，不相近的进行隔离，MVC将系统分解为模型、视图、控制器三部分，每一部分都相对独立，职责单一。MVC是对系统复杂性的一种合理的梳理与切分，它的思想实质就是“关注点分离”。
QT中的Model-View编程框架，对Controller部分做了改动，引入了Delegate的概念，合起来就是Model-View-Delegate。
在QT C&#43;&#43;中，对Model-View-Delegate已经做了基础的实现，不必去设计Model-View框架，只需学习Qt给的框架即可。
2、ListView ListView用来一个条目列表，条目对应的数据来自于Model， 而每个条目的外观则由Delegate决定。
要使用ListView，必须指定一个Model、一个Delegate。
Model可以是QML内建类型，如ListModel、XmlListModel，也可以是在C&#43;&#43;实现的QAbstractItemModel或QAbstractListModel的派生类。
二、ListView简单的使用 1、简单的显示例子 修改main.qml内容：
import QtQuick 2.12 import QtQuick.Window 2.12 import QtQuick.Controls 2.12 import QtQuick.Layouts 1.12 import MyObj 1.0 Window { id: window visible: true width: 600 height: 480 title: qsTr(&#34;Hello World&#34;) Rectangle { width: 360 height: 300 color: &#34;#EEEEEE&#34; Component { id: phoneDelegate Item { id: wrapper width: parent.width height: 30 MouseArea { anchors.fill: parent onClicked: wrapper.ListView.view.currentIndex = index } RowLayout { anchors." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/9fc89a0ade4b2011a4869dce693a6c2a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-17T20:44:43+08:00" />
<meta property="article:modified_time" content="2022-06-17T20:44:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">QML学习十五：ListView的简单使用（内建Model）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>若该文为原创文章，转载请注明原文出处</p> 
<p></p> 
<h2>一、概念</h2> 
<h3>1、MVC</h3> 
<p>作为一种经典的架构模式，通过把职责、性质相近的成分归结在一起，不相近的进行隔离，MVC将系统分解为模型、视图、控制器三部分，每一部分都相对独立，职责单一。MVC是对系统复杂性的一种合理的梳理与切分，它的思想实质就是“关注点分离”。</p> 
<p>QT中的Model-View编程框架，对Controller部分做了改动，引入了Delegate的概念，合起来就是Model-View-Delegate。</p> 
<p>在QT C++中，对Model-View-Delegate已经做了基础的实现，不必去设计Model-View框架，只需学习Qt给的框架即可。</p> 
<h3>2、ListView</h3> 
<p>ListView用来一个条目列表，条目对应的数据来自于Model， 而每个条目的外观则由Delegate决定。</p> 
<p>要使用ListView，必须指定一个Model、一个Delegate。</p> 
<p>Model可以是QML内建类型，如ListModel、XmlListModel，也可以是在C++实现的QAbstractItemModel或QAbstractListModel的派生类。</p> 
<h2>二、ListView简单的使用</h2> 
<h3>1、简单的显示例子</h3> 
<p>修改main.qml内容：</p> 
<pre><code>import QtQuick 2.12
import QtQuick.Window 2.12
import QtQuick.Controls 2.12
import QtQuick.Layouts 1.12

import MyObj 1.0


Window {
    id: window
    visible: true
    width: 600
    height: 480
    title: qsTr("Hello World")

    Rectangle {
        width: 360
        height: 300
        color: "#EEEEEE"

        Component {
            id: phoneDelegate

            Item {
                id: wrapper
                width: parent.width
                height: 30

                MouseArea {
                    anchors.fill: parent
                    onClicked: wrapper.ListView.view.currentIndex = index
                }

                RowLayout {
                    anchors.left: parent.left
                    anchors.verticalCenter: parent.verticalCenter
                    spacing: 8

                    Text {
                        id: coll
                        text: name
                        color: wrapper.ListView.isCurrentItem ? "red" : "black"
                        font.pixelSize: wrapper.ListView.isCurrentItem ? 22 : 18
                        Layout.preferredWidth: 120
                    }

                    Text {
                        text: cost
                        color: wrapper.ListView.isCurrentItem ? "red" : "black";
                        font.pixelSize: wrapper.ListView.isCurrentItem ? 22 : 18
                        Layout.preferredWidth: 80
                    }

                    Text {
                        text: manufacturer
                        color: wrapper.ListView.isCurrentItem ? "red" : "black";
                        font.pixelSize: wrapper.ListView.isCurrentItem ? 22 : 18
                        Layout.fillWidth: true
                    }
                }
            }
        }

        ListView {
            id: listView
            anchors.fill: parent
            delegate: phoneDelegate

            model: ListModel {
                id: phoneModel

                ListElement {
                    name: "iPhone 3gs"
                    cost: "1000"
                    manufacturer: "Apple"
                }

                ListElement {
                    name: "iphone 4"
                    cost: "1800"
                    manufacturer: "Apple"
                }

                ListElement {
                    name: "iphone 5"
                    cost: "2800"
                    manufacturer: "Apple"
                }

                ListElement {
                    name: "iphone 6"
                    cost: "3800"
                    manufacturer: "Apple"
                }

                ListElement {
                    name: "iphone 8"
                    cost: "4800"
                    manufacturer: "Apple"
                }
            }
            focus: true
            highlight: Rectangle {
                color: "lightblue"
            }
        }
    }

}



</code></pre> 
<p><strong>编译运行：</strong></p> 
<p> <img alt="" height="510" src="https://images2.imgbox.com/e9/1a/5Z2gtxWo_o.png" width="607"></p> 
<p></p> 
<h3>2、增加Head和Footer</h3> 
<pre><code>import QtQuick 2.12
import QtQuick.Window 2.12
import QtQuick.Controls 2.12
import QtQuick.Layouts 1.12

import MyObj 1.0


Window {
    id: window
    visible: true
    width: 600
    height: 480
    title: qsTr("Hello World")

    Rectangle {
        width: 360
        height: 300
        color: "#EEEEEE"

        Component {
            id: phoneModel

            ListModel {
                ListElement {
                    name: "iPhone 3"
                    cost: "1000"
                    manufacturer: "Apple"
                }
                ListElement {
                    name: "iPhone 4"
                    cost: "2000"
                    manufacturer: "Apple"
                }
                ListElement {
                    name: "iPhone 5"
                    cost: "3000"
                    manufacturer: "Apple"
                }
                ListElement {
                    name: "iPhone 6"
                    cost: "4000"
                    manufacturer: "Apple"
                }
            }
        }

        Component {
            id: headerView

            Item {
                width: parent.width

                RowLayout {
                    anchors.left: parent.left
                    anchors.verticalCenter: parent.verticalCenter
                    spacing: 8

                    Text {
                        text: "Name"
                        font.bold: true
                        font.pixelSize: 20
                        Layout.preferredWidth: 120
                    }

                    Text {
                        text: "Cost"
                        font.bold: true
                        font.pixelSize: 20
                        Layout.preferredWidth: 80
                    }

                    Text {
                        text: "Manufacturer"
                        font.bold: true
                        font.pixelSize: 20
                        Layout.fillWidth: true
                    }
                }
            }
        }

        Component {
            id: footerView

            Text {
                width: parent.width
                font.italic: true
                color: "blue"
                height: 30
                verticalAlignment: Text.AlignVCenter
            }
        }

        Component {
            id: phoneDelegate

            Item {
                id: wrapper

                width: parent.width
                height: 30

                MouseArea {
                    anchors.fill: parent
                    onClicked: wrapper.ListView.view.currentIndex = index
                }

                RowLayout {
                    anchors.left: parent.left
                    anchors.verticalCenter: parent.verticalCenter
                    spacing: 8

                    Text {
                        id: coll
                        text: name
                        color: wrapper.ListView.isCurrentItem ? "red" : "black"
                        font.pixelSize: wrapper.ListView.isCurrentItem ? 22 : 18
                        Layout.preferredWidth: 120
                    }

                    Text {
                        text: cost
                        color: wrapper.ListView.isCurrentItem ? "red" : "black";
                        font.pixelSize: wrapper.ListView.isCurrentItem ? 22 : 18
                        Layout.preferredWidth: 80
                    }

                    Text {
                        text: manufacturer
                        color: wrapper.ListView.isCurrentItem ? "red" : "black";
                        font.pixelSize: wrapper.ListView.isCurrentItem ? 22 : 18
                        Layout.fillWidth: true
                    }
                }
            }
        }

        ListView {
            id: listView
            anchors.fill: parent
            delegate: phoneDelegate

            model: phoneModel.createObject(listView)
            header: headerView
            footer: footerView
            focus: true
            highlight: Rectangle {
                color: "lightblue"
            }

            onCurrentIndexChanged: {
                if(listView.currentIndex &gt;= 0) {
                    var data = listView.model.get(listView.currentIndex);
                    listView.footerItem.text = data.name + "," + data.cost + "," + data.manufacturer;
                } else {
                    listView.footerItem.text = "-";
                }
            }
        }
    }
}



</code></pre> 
<p><strong>编译结果：</strong></p> 
<p><img alt="" height="185" src="https://images2.imgbox.com/1a/65/FCyonb3V_o.png" width="616"></p> 
<h3> 3、访问与修改Model</h3> 
<h4>(1) 访问数据</h4> 
<p>ListModel的count属性表示Model中有多少条数据。</p> 
<p>ListModel的get()方法接受一个int类型的参数，用来获取指定索引位置的数据返回一个QML对象。</p> 
<p>然后，我们就可以像访问属性那样访问数据的role。</p> 
<pre><code>eq:

var data = listView.model.get(listView.currentIndex);
console.log(data.name + "," + data.cost + "," + data.manufacturer);</code></pre> 
<h4>(2) 删除数据</h4> 
<p>ListModel的remove(int index, int count)方法，删除一条或多条数据。</p> 
<pre><code>eq:

MouseArea {
    anchors.fill: parent
    onClicked: {
        wrapper.ListView.view.currentIndex = index;
    }

    onDoubleClicked: {
        wrapper.ListView.view.model.remove(index);
    }
}

</code></pre> 
<h4>(3) 修改数据</h4> 
<p>修改数据使用的是ListModel的setProperty(int index, string property, variant value)方法。</p> 
<pre><code>比如：修改价格
listView.model.setProperty(5, "cost", 16999)</code></pre> 
<h4>(4) 添加数据</h4> 
<p>添加数据使用的是append()方法。</p> 
<pre><code class="language-Erlang">eq:
listView.model.append (
    {
        "name" : "mx3"
        "cost" : "1978"
        "manufacturer" : "Meizu"
    }
)</code></pre> 
<h2>三、完整代码</h2> 
<pre><code>import QtQuick 2.12
import QtQuick.Window 2.12
import QtQuick.Controls 2.12
import QtQuick.Layouts 1.12

import MyObj 1.0


Window {
    id: window
    visible: true
    width: 600
    height: 480
    title: qsTr("Hello World")

    Rectangle {
        width: 360
        height: 300
        color: "#EEEEEE"

        Component {
            id: phoneModel

            ListModel {
                ListElement {
                    name: "iPhone 3"
                    cost: "1000"
                    manufacturer: "Apple"
                }
                ListElement {
                    name: "iPhone 4"
                    cost: "2000"
                    manufacturer: "Apple"
                }
                ListElement {
                    name: "iPhone 5"
                    cost: "3000"
                    manufacturer: "Apple"
                }
                ListElement {
                    name: "iPhone 6"
                    cost: "4000"
                    manufacturer: "Apple"
                }
            }
        }

        Component {
            id: headerView

            Item {
                width: parent.width
                height: 30

                RowLayout {
                    anchors.left: parent.left
                    anchors.verticalCenter: parent.verticalCenter
                    spacing: 8

                    Text {
                        text: "Name"
                        font.bold: true
                        font.pixelSize: 20
                        Layout.preferredWidth: 120
                    }

                    Text {
                        text: "Cost"
                        font.bold: true
                        font.pixelSize: 20
                        Layout.preferredWidth: 80
                    }

                    Text {
                        text: "Manufacturer"
                        font.bold: true
                        font.pixelSize: 20
                        Layout.fillWidth: true
                    }
                }
            }
        }

        Component {
            id: footerView

            Item {
                id: footerRootItem

                width: parent.width
                height: 30
                property alias text: txt.text
                signal clean()
                signal add()

                Text {
                    anchors.left: parent.left
                    anchors.top: parent.top
                    anchors.bottom: parent.bottom
                    id: txt
                    font.italic: true
                    color: "blue"
                    verticalAlignment: Text.AlignVCenter
                }

                Button {
                    id: clearAll

                    anchors.right: parent.right
                    anchors.verticalCenter: parent.verticalCenter
                    text: "Clear"
                    onClicked: footerRootItem.clean();
                }

                Button {
                    id: addOne

                    anchors.right: clearAll.left
                    anchors.rightMargin: 4
                    anchors.verticalCenter: parent.verticalCenter
                    text: "Add"
                    onClicked: footerRootItem.add()
                }
            }
        }

        Component {
            id: phoneDelegate

            Item {
                id: wrapper

                width: parent.width
                height: 30

                MouseArea {
                    anchors.fill: parent
                    onClicked: wrapper.ListView.view.currentIndex = index
                }

                RowLayout {
                    anchors.left: parent.left
                    anchors.verticalCenter: parent.verticalCenter
                    spacing: 8

                    Text {
                        id: coll
                        text: name
                        color: wrapper.ListView.isCurrentItem ? "red" : "black"
                        font.pixelSize: wrapper.ListView.isCurrentItem ? 22 : 18
                        Layout.preferredWidth: 120
                    }

                    Text {
                        text: cost
                        color: wrapper.ListView.isCurrentItem ? "red" : "black";
                        font.pixelSize: wrapper.ListView.isCurrentItem ? 22 : 18
                        Layout.preferredWidth: 80
                    }

                    Text {
                        text: manufacturer
                        color: wrapper.ListView.isCurrentItem ? "red" : "black";
                        font.pixelSize: wrapper.ListView.isCurrentItem ? 22 : 18
                        Layout.fillWidth: true
                    }
                }
            }
        }

        ListView {
            id: listView
            anchors.fill: parent
            delegate: phoneDelegate

            model: phoneModel.createObject(listView)
            header: headerView
            footer: footerView
            focus: true
            highlight: Rectangle {
                color: "lightblue"
            }

            onCurrentIndexChanged: {
                if(listView.currentIndex &gt;= 0) {
                    var data = listView.model.get(listView.currentIndex);
                    listView.footerItem.text = data.name + "," + data.cost + "," + data.manufacturer;
                } else {
                    listView.footerItem.text = "-";
                }
            }

            function addOne() {
                model.append(
                            {
                                "name" : "MX3",
                                "cost": "1233",
                                "manufacturer": "Meizu"
                            });
            }

            Component.onCompleted: {
                listView.footerItem.clean.connect(listView.model.clear);
                listView.footerItem.add.connect(listView.addOne);
            }
        }
    }
}



</code></pre> 
<p><strong>编译结果：</strong></p> 
<p><img alt="" height="215" src="https://images2.imgbox.com/8d/ed/Ag2JRBIM_o.png" width="592"></p> 
<p> </p> 
<p></p> 
<p>如有侵权，请及时联系博主删除，VX：18750903063</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f368e5498aaf17b524f4e66f1484cac0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java必知习题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9b420285e020a466799e370371d33f8d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于开源WebRTC开发实时音视频靠谱吗？第3方SDK有哪些？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>