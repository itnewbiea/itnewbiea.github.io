<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android Json文件解析及带关键字文件解压 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android Json文件解析及带关键字文件解压" />
<meta property="og:description" content="Some problems encountered and their answers in work (Android Chapter) Android 如何解析一个.json文件 在Android中，我们通常使用JSON格式来与后端服务器通信，需要解析JSON数据来提取有用的信息。解析JSON数据通常分为两个阶段：首先将JSON数据解析为JSON对象或JSON数组，然后从中提取所需的信息。 以下是一个简单的示例，演示如何解析一个本地JSON文件： 假设我们有一个名为&#34;example.json&#34;的本地JSON文件，它包含以下内容: json { &#34;name&#34;: &#34;John Smith&#34;, &#34;age&#34;: 35, &#34;isMarried&#34;: true, &#34;hobbies&#34;: [ &#34;reading&#34;, &#34;fishing&#34;, &#34;hiking&#34; ] } 我们可以使用Android中的JSON API来解析这个文件。以下是一些示例代码，假设我们希望从JSON文件中提取姓名和年龄： import org.json.JSONObject import java.io.BufferedReader import java.io.InputStreamReader // 读取JSON文件并创建JSON对象 val inputStream = resources.assets.open(&#34;example.json&#34;) val bufferedReader = BufferedReader(InputStreamReader(inputStream)) val jsonString = bufferedReader.use { it.readText() } val jsonObject = JSONObject(jsonString) // 从JSON对象中提取所需信息 val name = jsonObject.getString(&#34;name&#34;) val age = jsonObject." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/9a810a18b034897c549df6801bfa3ef6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-26T13:15:12+08:00" />
<meta property="article:modified_time" content="2023-05-26T13:15:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android Json文件解析及带关键字文件解压</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="Some_problems_encountered_and_their_answers_in_work_Android_Chapter_0"></a>Some problems encountered and their answers in work (Android Chapter)</h4> 
<hr> 
<h4><a id="Android_json_4"></a>Android 如何解析一个.json文件</h4> 
<pre><code class="prism language-java">在<span class="token class-name">Android</span>中，我们通常使用JSON格式来与后端服务器通信，需要解析JSON数据来提取有用的信息。解析JSON数据通常分为两个阶段：首先将JSON数据解析为JSON对象或JSON数组，然后从中提取所需的信息。
 以下是一个简单的示例，演示如何解析一个本地JSON文件：
 假设我们有一个名为<span class="token string">"example.json"</span>的本地JSON文件，它包含以下内容<span class="token operator">:</span>
json
<span class="token punctuation">{<!-- --></span>
  <span class="token string">"name"</span><span class="token operator">:</span> <span class="token string">"John Smith"</span><span class="token punctuation">,</span>
  <span class="token string">"age"</span><span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
  <span class="token string">"isMarried"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"hobbies"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"reading"</span><span class="token punctuation">,</span>
    <span class="token string">"fishing"</span><span class="token punctuation">,</span>
    <span class="token string">"hiking"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
我们可以使用<span class="token class-name">Android</span>中的JSON API来解析这个文件。以下是一些示例代码，假设我们希望从JSON文件中提取姓名和年龄：
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>json<span class="token punctuation">.</span></span><span class="token class-name">JSONObject</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">BufferedReader</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStreamReader</span>
 <span class="token comment">// 读取JSON文件并创建JSON对象</span>
val inputStream <span class="token operator">=</span> resources<span class="token punctuation">.</span>assets<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token string">"example.json"</span><span class="token punctuation">)</span>
val bufferedReader <span class="token operator">=</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">)</span>
val jsonString <span class="token operator">=</span> bufferedReader<span class="token punctuation">.</span>use <span class="token punctuation">{<!-- --></span> it<span class="token punctuation">.</span><span class="token function">readText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
val jsonObject <span class="token operator">=</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span>jsonString<span class="token punctuation">)</span>
 <span class="token comment">// 从JSON对象中提取所需信息</span>
val name <span class="token operator">=</span> jsonObject<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>
val age <span class="token operator">=</span> jsonObject<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span>
在上述代码片段中，我们首先打开example<span class="token punctuation">.</span>json文件，并逐行读取它的内容。然后，我们使用JSON字符串创建一个JSON对象，然后从中提取出需要的数据。在本例中，我们使用了<span class="token function">getString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>和<span class="token function">getInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法来提取字符串和整数类型的值。这些方法的参数是JSON键（key），它们指定需要提取的值所在的位置。
 请注意，这个示例假设example<span class="token punctuation">.</span>json文件位于app<span class="token operator">/</span>src<span class="token operator">/</span>main<span class="token operator">/</span>assets<span class="token operator">/</span>目录下。如果文件位于其他目录下，需要相应地更改路径。
</code></pre> 
<h4><a id="storage7EE27093partNumberjsonjson_37"></a>在/storage/7EE2-7093/目录下有一个partNumber.json文件，此json文件的内容为:</h4> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
 <span class="token string">"partnum"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>
   <span class="token string">"value"</span><span class="token operator">:</span> <span class="token string">"703000555AA"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
   <span class="token string">"value"</span><span class="token operator">:</span> <span class="token string">"703000555AG"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
   <span class="token string">"value"</span><span class="token operator">:</span> <span class="token string">"703000555AT"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
   <span class="token string">"value"</span><span class="token operator">:</span> <span class="token string">"703000555AH"</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
在Android程序中我如何解析此json文件获取到每个value后面的值
</code></pre> 
<pre><code class="prism language-java"><span class="token number">1.</span> 读取partNumber<span class="token punctuation">.</span>json文件的内容并转换为字符串。
<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"/storage/7EE2-7093/partNumber.json"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> size <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">byte</span> buffer<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>
    is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token number">2.</span> 解析JSON字符串并获取value对应的值。
<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">JSONObject</span> jsonObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">JSONArray</span> partNumArray <span class="token operator">=</span> jsonObject<span class="token punctuation">.</span><span class="token function">getJSONArray</span><span class="token punctuation">(</span><span class="token string">"partnum"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> partNumArray<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">JSONObject</span> partNumObject <span class="token operator">=</span> partNumArray<span class="token punctuation">.</span><span class="token function">getJSONObject</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> value <span class="token operator">=</span> partNumObject<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"value"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 在这里对每个value进行操作</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JSONException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
在上面的代码中，先将partNumber<span class="token punctuation">.</span>json文件的内容读取为字符串，然后使用<span class="token class-name">JSONObject</span>将其转换为JSON对象。接着，获取JSON对象中的partnum数组，并遍历该数组中的每个元素。对于每个元素，使用getJSONObject方法获取包含value字段的JSON对象，并使用getString方法获取value对应的值。最后，可以对每个value进行操作或将其存储到一个数组或列表中。
 注意要在<span class="token class-name">AndroidManifest</span><span class="token punctuation">.</span>xml文件中添加读取外部存储权限：  `<span class="token operator">&lt;</span><span class="token keyword">uses</span><span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.permission.READ_EXTERNAL_STORAGE"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>`
</code></pre> 
<h4><a id="parNumjsonAndroid_Studio_88"></a>有一个parNum.json文件需要存放在Android Studio项目中并读取他，应该如何存放并读取</h4> 
<pre><code class="prism language-java">要在<span class="token class-name">Android</span> <span class="token class-name">Studio</span>项目中存储和读取parNum<span class="token punctuation">.</span>json文件，可以将该文件放置在项目的assets目录中。
 <span class="token number">1.</span> 创建assets目录：
如果项目中没有assets目录，可以手动创建一个。在项目根目录中右键单击，选择<span class="token class-name">New</span> <span class="token operator">-&gt;</span> <span class="token class-name">Folder</span> <span class="token operator">-&gt;</span> <span class="token class-name">Assets</span> <span class="token class-name">Folder</span>，然后命名为“assets”并点击<span class="token class-name">Finish</span>。
 <span class="token number">2.</span> 存储parNum<span class="token punctuation">.</span>json文件：
将parNum<span class="token punctuation">.</span>json文件复制到assets目录中。在资源管理器中找到该文件，右键单击并选择<span class="token class-name">Copy</span>，然后在<span class="token class-name">Android</span> <span class="token class-name">Studio</span>中的assets目录中右键单击并选择<span class="token class-name">Paste</span>即可。
 <span class="token number">3.</span> 读取parNum<span class="token punctuation">.</span>json文件：
要读取该文件，可以使用以下代码：
<span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>content<span class="token punctuation">.</span></span><span class="token class-name">Context</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>json<span class="token punctuation">.</span></span><span class="token class-name">JSONException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>json<span class="token punctuation">.</span></span><span class="token class-name">JSONObject</span><span class="token punctuation">;</span>
 <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Utils</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">JSONObject</span> <span class="token function">getJSON</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">String</span> filename<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> jsonString<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">InputStream</span> is <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> size <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>
            is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            jsonString <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">JSONObject</span> jsonObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span>jsonString<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> jsonObject<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JSONException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
这个 `<span class="token function">getJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span>` 方法将从传入的上下文中的assets目录中获取文件名对应的文件，并返回一个包含JSON数据的<span class="token class-name">JSONObject</span>对象。在您的活动中使用该方法，例如：
<span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span><span class="token class-name">Bundle</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">androidx<span class="token punctuation">.</span>appcompat<span class="token punctuation">.</span>app<span class="token punctuation">.</span></span><span class="token class-name">AppCompatActivity</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>json<span class="token punctuation">.</span></span><span class="token class-name">JSONObject</span><span class="token punctuation">;</span>
 <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">JSONObject</span> parNum<span class="token punctuation">;</span>
     <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span><span class="token punctuation">;</span>
         parNum <span class="token operator">=</span> <span class="token class-name">Utils</span><span class="token punctuation">.</span><span class="token function">getJSON</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">"parNum.json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>parNum <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 处理获取json文件失败的情况</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 处理获取json文件成功的情况</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
这样，您就可以将parNum<span class="token punctuation">.</span>json文件存储在<span class="token class-name">Android</span> <span class="token class-name">Studio</span>项目中并从中读取它了。
</code></pre> 
<h4><a id="Android_StudioReadJsonTestjsonFilepartNumjsonpartNumjson_147"></a>在Android Studio名叫ReadJsonTest项目中创建一个jsonFile的文件夹，文件夹内存放一个partNum.json的文件，在代码中如何读取partNum.json文件</h4> 
<pre><code class="prism language-java">您可以使用以下代码在<span class="token class-name">Android</span> <span class="token class-name">Studio</span>中读取名为partNum<span class="token punctuation">.</span>json的文件：
<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token function">getAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token string">"jsonFile/partNum.json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">int</span> size <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>
    is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">String</span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token comment">// 处理 json 字符串...</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
在这个示例中，我们使用 `<span class="token function">getAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span>` 方法打开位于 `jsonFile<span class="token operator">/</span>partNum<span class="token punctuation">.</span>json` 相对路径的文件，并通过 `<span class="token class-name">InputStream</span>` 对象读取该文件。然后，我们将读取的数据转换为字符串格式，并最终处理该字符串中的JSON数据。
 需要注意的是，这段代码假定您已经创建了名为 `jsonFile` 的文件夹，并在其中存放了 `partNum<span class="token punctuation">.</span>json` 文件。如果您没有这样做，请先创建该文件夹并将文件存放在其中，然后再使用以上代码读取文件。
</code></pre> 
<h4><a id="Android_assets_166"></a>Android 项目中外部文件必须放在assets文件夹里面吗，有其他替代的方法吗‘</h4> 
<pre><code class="prism language-java">在<span class="token class-name">Android</span>项目中，您可以将外部文件放在其他位置，例如res<span class="token operator">/</span>raw目录或磁盘上的任何位置，但是使用这些文件时需要使用不同的方法。以下是一些替代方法：
 <span class="token number">1.</span> <span class="token class-name">Res</span><span class="token operator">/</span>raw目录：将文件放在res<span class="token operator">/</span>raw目录下，并使用以下代码读取文件：
<span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token function">getResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">openRawResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>raw<span class="token punctuation">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">2.</span> 磁盘上的任何位置：将文件放在磁盘上的任何位置，并使用以下代码读取文件：
<span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"/path/to/file"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
需要注意的是，在使用这些方法时，您需要获取正确的文件路径，并在读取文件时处理可能会发生的异常。此外，如果您需要在应用程序升级后更改文件，则需要考虑将文件放在外部存储设备上，并在运行时请求适当的权限来访问该设备。
</code></pre> 
<h4><a id="_180"></a>解压文件(可解压包含某关键字文件)</h4> 
<pre><code class="prism language-java">fun <span class="token function">unzipFileByKeyword</span><span class="token punctuation">(</span>zipFile<span class="token operator">:</span> <span class="token class-name">File</span><span class="token operator">?</span><span class="token punctuation">,</span> destDir<span class="token operator">:</span> <span class="token class-name">File</span><span class="token operator">?</span><span class="token punctuation">,</span> keyword<span class="token operator">:</span> <span class="token class-name">String</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">File</span><span class="token punctuation">&gt;</span></span><span class="token operator">?</span> <span class="token punctuation">{<!-- --></span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>zipFile <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> destDir <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span>  
        val files<span class="token operator">:</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">File</span><span class="token punctuation">&gt;</span></span> <span class="token operator">=</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
        val zip <span class="token operator">=</span> <span class="token class-name">ZipFile</span><span class="token punctuation">(</span>zipFile<span class="token punctuation">)</span>  
        val entries<span class="token operator">:</span> <span class="token class-name">Enumeration</span><span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token operator">=</span> zip<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>  
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isSpace</span><span class="token punctuation">(</span>keyword<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
                <span class="token keyword">while</span> <span class="token punctuation">(</span>entries<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
                    val entry <span class="token operator">=</span> entries<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> as <span class="token class-name">ZipEntry</span>  
                    val entryName <span class="token operator">=</span> entry<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"\\"</span><span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span>  
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>entryName<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"../"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
                        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">"ZipUtils"</span><span class="token punctuation">,</span> <span class="token string">"entryName: $entryName is dangerous!"</span><span class="token punctuation">)</span>  
                        <span class="token keyword">continue</span>  
                    <span class="token punctuation">}</span>  
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">unzipChildFile</span><span class="token punctuation">(</span>destDir<span class="token punctuation">,</span> files<span class="token punctuation">,</span> zip<span class="token punctuation">,</span> entry<span class="token punctuation">,</span> entryName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> files  
                <span class="token punctuation">}</span>  
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>  
                <span class="token keyword">while</span> <span class="token punctuation">(</span>entries<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
                    val entry <span class="token operator">=</span> entries<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> as <span class="token class-name">ZipEntry</span>  
                    val entryName <span class="token operator">=</span> entry<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"\\"</span><span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span>  
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>entryName<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"../"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
                        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">"ZipUtils"</span><span class="token punctuation">,</span> <span class="token string">"entryName: $entryName is dangerous!"</span><span class="token punctuation">)</span>  
                        <span class="token keyword">continue</span>  
                    <span class="token punctuation">}</span>  
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>entryName<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>keyword<span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">unzipChildFile</span><span class="token punctuation">(</span>destDir<span class="token punctuation">,</span> files<span class="token punctuation">,</span> zip<span class="token punctuation">,</span> entry<span class="token punctuation">,</span> entryName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> files  
                    <span class="token punctuation">}</span>  
                <span class="token punctuation">}</span>  
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span><span class="token class-name">Exception</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>  
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>  
            zip<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
        <span class="token punctuation">}</span>  
        <span class="token keyword">return</span> files  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Throws</span><span class="token punctuation">(</span><span class="token class-name">IOException</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span>  
    <span class="token keyword">private</span> fun <span class="token function">unzipChildFile</span><span class="token punctuation">(</span>destDir<span class="token operator">:</span> <span class="token class-name">File</span><span class="token punctuation">,</span> files<span class="token operator">:</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">File</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> zip<span class="token operator">:</span> <span class="token class-name">ZipFile</span><span class="token punctuation">,</span> entry<span class="token operator">:</span> <span class="token class-name">ZipEntry</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Boolean</span> <span class="token punctuation">{<!-- --></span>  
        val file <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">(</span>destDir<span class="token punctuation">,</span> name<span class="token punctuation">)</span>  
        files<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">.</span>isDirectory<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
            <span class="token keyword">return</span> <span class="token function">createOrExistsDir</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>  
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>  
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">createOrExistsFile</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>  
            <span class="token keyword">var</span> inputStream<span class="token operator">:</span> <span class="token class-name">InputStream</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span>  
            <span class="token keyword">var</span> outputStream<span class="token operator">:</span> <span class="token class-name">OutputStream</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span>  
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>  
                inputStream <span class="token operator">=</span> <span class="token class-name">BufferedInputStream</span><span class="token punctuation">(</span>zip<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span><span class="token punctuation">)</span>  
                outputStream <span class="token operator">=</span> <span class="token class-name">BufferedOutputStream</span><span class="token punctuation">(</span><span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span>  
                val buffer <span class="token operator">=</span> <span class="token class-name">ByteArray</span><span class="token punctuation">(</span><span class="token number">8192</span><span class="token punctuation">)</span>  
                <span class="token keyword">var</span> len<span class="token operator">:</span> <span class="token class-name">Int</span>  
                <span class="token keyword">while</span> <span class="token punctuation">(</span>inputStream<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">.</span>also <span class="token punctuation">{<!-- --></span> len <span class="token operator">=</span> it <span class="token punctuation">}</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
                    outputStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span>  
                <span class="token punctuation">}</span>  
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>  
                inputStream<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
                outputStream<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span>  
        <span class="token keyword">return</span> <span class="token boolean">true</span>  
    <span class="token punctuation">}</span>
</code></pre> 
<p><strong>将以上代码进行优化后</strong></p> 
<pre><code class="prism language-java">fun <span class="token function">unzipFileByKeyword</span><span class="token punctuation">(</span>zipFile<span class="token operator">:</span> <span class="token class-name">File</span><span class="token operator">?</span><span class="token punctuation">,</span> destDir<span class="token operator">:</span> <span class="token class-name">File</span><span class="token operator">?</span><span class="token punctuation">,</span> keyword<span class="token operator">:</span> <span class="token class-name">String</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">File</span><span class="token punctuation">&gt;</span></span><span class="token operator">?</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>zipFile <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> destDir <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>destDir<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>destDir<span class="token punctuation">.</span>isDirectory<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span>
     val files<span class="token operator">:</span> <span class="token class-name">MutableList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">File</span><span class="token punctuation">&gt;</span></span> <span class="token operator">=</span> <span class="token function">mutableListOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    val zip <span class="token operator">=</span> <span class="token class-name">ZipFile</span><span class="token punctuation">(</span>zipFile<span class="token punctuation">)</span>
     <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        val entries <span class="token operator">=</span> zip<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asSequence</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>filter <span class="token punctuation">{<!-- --></span> <span class="token operator">!</span>it<span class="token punctuation">.</span>isDirectory <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>keyword <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> it<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>keyword<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        entries<span class="token punctuation">.</span>forEach <span class="token punctuation">{<!-- --></span> entry <span class="token operator">-&gt;</span>
            val entryName <span class="token operator">=</span> entry<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"\\"</span><span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span>
             <span class="token keyword">if</span> <span class="token punctuation">(</span>entryName<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"../"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">"ZipUtils"</span><span class="token punctuation">,</span> <span class="token string">"entryName: $entryName is dangerous!"</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span><span class="token annotation punctuation">@forEach</span>
            <span class="token punctuation">}</span>
             val file <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">(</span>destDir<span class="token punctuation">,</span> entryName<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">createOrExistsFile</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token annotation punctuation">@forEach</span>
             zip<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span>use <span class="token punctuation">{<!-- --></span> inputStream <span class="token operator">-&gt;</span>
                <span class="token class-name">BufferedOutputStream</span><span class="token punctuation">(</span><span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>use <span class="token punctuation">{<!-- --></span> outputStream <span class="token operator">-&gt;</span>
                    inputStream<span class="token punctuation">.</span><span class="token function">copyTo</span><span class="token punctuation">(</span>outputStream<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
             files<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> <span class="token class-name">Exception</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
        zip<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
     <span class="token keyword">return</span> files
<span class="token punctuation">}</span>
 fun <span class="token function">createOrExistsDir</span><span class="token punctuation">(</span>file<span class="token operator">:</span> <span class="token class-name">File</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Boolean</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        file<span class="token punctuation">.</span>isDirectory
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        file<span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 fun <span class="token function">createOrExistsFile</span><span class="token punctuation">(</span>file<span class="token operator">:</span> <span class="token class-name">File</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Boolean</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> file<span class="token punctuation">.</span>isFile
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">createOrExistsDir</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>parentFile<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token keyword">return</span> <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        file<span class="token punctuation">.</span><span class="token function">createNewFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> <span class="token class-name">IOException</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

zip<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asSequence</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>filter <span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span>
这段代码返回一个<span class="token class-name">Sequence</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZipEntry</span><span class="token punctuation">&gt;</span></span>对象，它包含<span class="token punctuation">.</span>zip文件中的所有条目（entries）。具体地说，它使用<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法获取所有的条目，并将它们作为<span class="token class-name">Sequence</span>对象返回。然后，使用<span class="token function">asSequence</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法将此<span class="token class-name">Sequence</span>转换为另一个<span class="token class-name">Sequence</span>对象，以便后续操作。接下来，使用<span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法对转换后的<span class="token class-name">Sequence</span>中的条目进行过滤。这个方法使用一个lambda表达式来指定过滤条件。在这个例子中，过滤条件是<span class="token class-name">ZipEntry</span>对象的名称（name）属性以某个特定字符串结尾。最后，返回的<span class="token class-name">Sequence</span>对象包含所有满足过滤条件的条目。
    
val entries <span class="token operator">=</span> zip<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asSequence</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>filter <span class="token punctuation">{<!-- --></span> 
                <span class="token operator">!</span>it<span class="token punctuation">.</span>isDirectory <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>keyword <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> it<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>keyword<span class="token punctuation">)</span><span class="token punctuation">)</span> 
            <span class="token punctuation">}</span> <span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span>
这段代码的返回值是一个经过筛选的<span class="token class-name">ZipEntry</span>对象的<span class="token class-name">Sequence</span>序列。其中每个<span class="token class-name">ZipEntry</span>对象都满足以下两个条件之一：
 <span class="token number">1.</span>它的名称（name）属性以指定的关键字（keyword）结尾（如果指定了关键字）。
<span class="token number">2.</span>它不是一个目录（isDirectory属性为<span class="token boolean">false</span>）。
 这个<span class="token class-name">Sequence</span>序列中的每个对象都表示<span class="token punctuation">.</span>zip文件中的一个文件或目录。

<span class="token number">1.</span>将返回类型更改为<span class="token class-name">MutableList</span>＜<span class="token class-name">File</span>＞，而不是可为<span class="token keyword">null</span>的<span class="token class-name">List</span>＜<span class="token class-name">File</span><span class="token operator">&gt;</span>。
<span class="token number">2.</span>添加了一个检查，以确保目标目录存在并且是一个目录。
<span class="token number">3.</span>使用<span class="token class-name">Kotlin</span>的asSequence（）函数将<span class="token class-name">Enumeration</span>转换为<span class="token class-name">Sequence</span>。
<span class="token number">4.</span>使用use功能自动处理关闭的流和文件。
<span class="token number">5.</span>删除了两次检查关键字的多余<span class="token keyword">if</span>语句。
<span class="token number">6.</span>将用于创建文件或目录的代码提取到单独的函数中。
<span class="token number">7.</span>将<span class="token class-name">ArrayList</span>更改为<span class="token class-name">MutableList</span>，以允许使用<span class="token class-name">Kotlin</span>的可变列表函数。
<span class="token number">8.</span>删除了不必要的变量声明（例如inputStream、outputStream、len）。
<span class="token number">9.</span>使用copyTo（）函数将字节从输入流复制到输出流。
<span class="token number">10.</span>将<span class="token class-name">ArrayList</span>更改为<span class="token class-name">MutableList</span>，以允许使用<span class="token class-name">Kotlin</span>的可变列表函数。
</code></pre> 
<h4><a id="keyword_320"></a>以上代码中keyword如何使用</h4> 
<pre><code class="prism language-java">这段代码中的<span class="token string">"keyword"</span>是一个可选的参数，用于过滤zip文件中的条目。如果传递了<span class="token string">"keyword"</span>参数，则只有那些名称中包含它的条目才会被提取。如果未传递<span class="token string">"keyword"</span>参数，则所有条目都会被提取。此处的关键字是一个字符串类型的变量，可以在函数调用时作为参数传递，例如：
val extractedFiles <span class="token operator">=</span> <span class="token function">unzipFileByKeyword</span><span class="token punctuation">(</span>zipFile<span class="token punctuation">,</span> destDir<span class="token punctuation">,</span> <span class="token string">"example"</span><span class="token punctuation">)</span>
这将用<span class="token string">"example"</span>作为关键字来提取zip文件中名称中包含<span class="token string">"example"</span>的条目，并将结果存储在<span class="token string">"extractedFiles"</span>列表中。如果您不想使用关键字，请将其设置为<span class="token keyword">null</span>，例如：
val extractedFiles <span class="token operator">=</span> <span class="token function">unzipFileByKeyword</span><span class="token punctuation">(</span>zipFile<span class="token punctuation">,</span> destDir<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
这将提取zip文件中的所有条目，而不考虑名称。
</code></pre> 
<h4><a id="_330"></a></h4>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5075a77f27b9ae65d668158a345b1bd5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【深度学习】OCR文本识别</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f29bdc3429439d3110aad44043dd8ebd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">计算机网络1：局域网、广域网、IP地址和MAC地址详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>