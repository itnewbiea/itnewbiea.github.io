<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ubuntu18.04深度学习环境配置 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ubuntu18.04深度学习环境配置" />
<meta property="og:description" content="目录 前言1. ubuntu18.04安装2. nvidia显卡驱动3. 安装anaconda34. 安装pytorch（含cuda、cudnn） 前言 为跑代码方便，实验室电脑一般都用ubuntu系统，但无奈买来的电脑都是预装windows，所以需要重装系统，然后再配置一系列的环境。走一遍流程总要有些坑，下次再重复安装总是隐约记得但又会再踩坑，为了之后提高效率，这次把整个流程记录下来，以后用着也方便。
1. ubuntu18.04安装 现在ubuntu已经出到了21版本，一般安装LTS（长期支持）版本就没啥问题，但为了兼容一些老环境、老配置，这里选18版本的稳妥一些。
镜像在官网下载：https://ubuntu.com/#download
我用的是18.04.6桌面版，可以在这里下载：
链接：https://pan.baidu.com/s/1p4kAtoaZSzxJa2VqtjuFmg
提取码：vwj5
下载之后，要制作启动盘，用u盘或光盘都可，这里用u盘制作
制作工具用 UltraISO软碟通，下载之后，准备好一个空u盘（制作启动盘需要格式化u盘），8g的就够，然后按照这个来就行
https://jingyan.baidu.com/article/154b46311befea28ca8f41ae.html
之后就是关机，插上u盘，开机进入bios，选择u盘启动那一项，按照引导安装就行。（因为是重装系统，直接覆盖原系统，所以分区、存储那些配置都按照默认的来就行，记得选择覆盖原系统就行）
2. nvidia显卡驱动 深度学习网络都离不开显卡，安装显卡驱动算是最重要的一步。
首先，有个准备工作，禁用BIOS中的secure boot（需要重启一下进BIOS）。
进入系统后，禁用默认使用的开源显卡驱动nouveau：
创建文件 sudo vim /etc/modprobe.d/blacklist-nouveau.conf写入
blacklist nouveau options nouveau modeset=0使禁用生效 sudo update-initramfs -u检验是否生效（没有输出就是生效了） lsmod | grep nouveau 想使用nvidia的独立显卡，就需要安装对应的显卡驱动，所以要知道自己显卡的信息，确定驱动版本。
终端输入：ubuntu-drivers devices
可以看到推荐安装的是 nvidia-driver-470，直接安装就可。
sudo apt update
sudo apt install nvidia-driver-470
安装后重启一下，终端输入：nvidia-smi
如图安装成功。
其实也可以去nvidia官网下载对应版本的驱动，除去官网的版本可能更新一点之外，其实都差不多，上边的方法更简单。
具体过程参考：
https://zhuanlan.zhihu.com/p/59618999
https://blog.csdn.net/new_delete_/article/details/81544438
！！踩坑！！：之前安装显卡驱动后，再重启会显示驱动的版本和系统不一致，这是由于linux内核自动更新导致的，所以为了方便起见，避免之后出现问题，在显卡驱动安装后，先设置禁止系统内核更新，之后再重启查看显卡驱动。
查看一下在使用的内核版本 uname -a
然后 sudo apt-mark hold linux-image-5.4.0-84-generic" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/54096716378d92d38b3e4cc85d795cbf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-10T15:37:23+08:00" />
<meta property="article:modified_time" content="2022-04-10T15:37:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ubuntu18.04深度学习环境配置</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">前言</a></li><li><a href="#1__ubuntu1804_4" rel="nofollow">1. ubuntu18.04安装</a></li><li><a href="#2__nvidia_21" rel="nofollow">2. nvidia显卡驱动</a></li><li><a href="#3__anaconda3_67" rel="nofollow">3. 安装anaconda3</a></li><li><a href="#4__pytorchcudacudnn_75" rel="nofollow">4. 安装pytorch（含cuda、cudnn）</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>前言</h3> 
<p>为跑代码方便，实验室电脑一般都用ubuntu系统，但无奈买来的电脑都是预装windows，所以需要重装系统，然后再配置一系列的环境。走一遍流程总要有些坑，下次再重复安装总是隐约记得但又会再踩坑，为了之后提高效率，这次把整个流程记录下来，以后用着也方便。</p> 
<h3><a id="1__ubuntu1804_4"></a>1. ubuntu18.04安装</h3> 
<p>现在ubuntu已经出到了21版本，一般安装LTS（长期支持）版本就没啥问题，但为了兼容一些老环境、老配置，这里选18版本的稳妥一些。</p> 
<p>镜像在官网下载：<a href="https://ubuntu.com/#download" rel="nofollow">https://ubuntu.com/#download</a></p> 
<p>我用的是18.04.6桌面版，可以在这里下载：<br> 链接：https://pan.baidu.com/s/1p4kAtoaZSzxJa2VqtjuFmg<br> 提取码：vwj5</p> 
<p>下载之后，要制作启动盘，用u盘或光盘都可，这里用u盘制作</p> 
<p>制作工具用 <strong>UltraISO软碟通</strong>，下载之后，准备好一个空u盘（制作启动盘需要格式化u盘），8g的就够，然后按照这个来就行<br> <a href="https://jingyan.baidu.com/article/154b46311befea28ca8f41ae.html" rel="nofollow">https://jingyan.baidu.com/article/154b46311befea28ca8f41ae.html</a></p> 
<p>之后就是关机，插上u盘，开机进入bios，选择u盘启动那一项，按照引导安装就行。（因为是重装系统，直接覆盖原系统，所以分区、存储那些配置都按照默认的来就行，记得选择覆盖原系统就行）</p> 
<h3><a id="2__nvidia_21"></a>2. nvidia显卡驱动</h3> 
<p>深度学习网络都离不开显卡，安装显卡驱动算是最重要的一步。</p> 
<p>首先，有个准备工作，禁用BIOS中的secure boot（需要重启一下进BIOS）。</p> 
<p>进入系统后，禁用默认使用的开源显卡驱动nouveau：</p> 
<ul><li>创建文件 <code>sudo vim /etc/modprobe.d/blacklist-nouveau.conf</code></li><li>写入<br> <code>blacklist nouveau </code><br> <code>options nouveau modeset=0</code></li><li>使禁用生效 <code>sudo update-initramfs -u</code></li><li>检验是否生效（没有输出就是生效了） <code>lsmod | grep nouveau</code></li></ul> 
<p>想使用nvidia的独立显卡，就需要安装对应的显卡驱动，所以要知道自己显卡的信息，确定驱动版本。</p> 
<p>终端输入：<code>ubuntu-drivers devices</code><br> <img src="https://images2.imgbox.com/26/4c/xNui61TI_o.png" alt="在这里插入图片描述"><br> 可以看到推荐安装的是 nvidia-driver-470，直接安装就可。</p> 
<p><code>sudo apt update</code><br> <code>sudo apt install nvidia-driver-470</code></p> 
<p>安装后重启一下，终端输入：<code>nvidia-smi</code><br> <img src="https://images2.imgbox.com/8c/c8/aJtu6SIn_o.png" alt="在这里插入图片描述"><br> 如图安装成功。</p> 
<p>其实也可以去nvidia官网下载对应版本的驱动，除去官网的版本可能更新一点之外，其实都差不多，上边的方法更简单。</p> 
<p>具体过程参考：<br> <a href="https://zhuanlan.zhihu.com/p/59618999" rel="nofollow">https://zhuanlan.zhihu.com/p/59618999</a><br> <a href="https://blog.csdn.net/new_delete_/article/details/81544438">https://blog.csdn.net/new_delete_/article/details/81544438</a></p> 
<blockquote> 
 <p>！！踩坑！！：之前安装显卡驱动后，再重启会显示驱动的版本和系统不一致，这是由于linux内核自动更新导致的，所以为了方便起见，避免之后出现问题，<strong>在显卡驱动安装后，先设置禁止系统内核更新，之后再重启查看显卡驱动</strong>。</p> 
</blockquote> 
<p>查看一下在使用的内核版本 <code>uname -a</code><br> <img src="https://images2.imgbox.com/8e/89/NFbmigHy_o.png" alt="在这里插入图片描述"><br> 然后 <code>sudo apt-mark hold linux-image-5.4.0-84-generic</code></p> 
<p><code>dpkg --get-selections |grep linux-image</code> ，显示hold就可以了<br> <img src="https://images2.imgbox.com/b8/33/wwlDRlLd_o.png" alt="在这里插入图片描述"><br> 然后再禁止一下软件更新（如果不用图形界面，软件的更新其实没啥用）<br> <img src="https://images2.imgbox.com/67/b2/9KqxMyJw_o.png" alt="在这里插入图片描述"><br> 参考：<a href="https://www.cnblogs.com/111testing/p/13668275.html" rel="nofollow">https://www.cnblogs.com/111testing/p/13668275.html</a></p> 
<h3><a id="3__anaconda3_67"></a>3. 安装anaconda3</h3> 
<p>接下来就是安装python以及cuda这些实验环境了，由于后续想在虚拟环境中配置对应工程的环境，用conda还是方便些。<br> 安装anaconda，基本的过程就这样：<a href="https://blog.csdn.net/qq_15192373/article/details/81091098">https://blog.csdn.net/qq_15192373/article/details/81091098</a></p> 
<blockquote> 
 <p>注意：anaconda的版本建议新一点，我用老版本安装后，后续安装pytorch时候，装cuda11.3版本死活找不到源，后来升级了一下conda版本就可以了，所以建议一开始就安装新一点的版本。</p> 
</blockquote> 
<p>我用的这个版本，没有问题。<br> <img src="https://images2.imgbox.com/5f/a5/14VwNdp2_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4__pytorchcudacudnn_75"></a>4. 安装pytorch（含cuda、cudnn）</h3> 
<p>新建一个conda环境，python版本按需安装，一般3.6就够用了。 <a href="https://blog.csdn.net/omg_orange/article/details/98181099">https://blog.csdn.net/omg_orange/article/details/98181099</a></p> 
<p>进入环境，开始安装pytorch<br> 在官网 <a href="https://pytorch.org/" rel="nofollow">https://pytorch.org/</a> 找到安装指令，前边安装显卡驱动时候显示cuda11.4，这是驱动支持的最高cuda版本，可以向下兼容，下载11.3就可以。<br> <img src="https://images2.imgbox.com/4e/16/wsdvubwF_o.png" alt="在这里插入图片描述"><br> 安装：<code>conda install pytorch torchvision torchaudio cudatoolkit=11.3 -c pytorch</code></p> 
<blockquote> 
 <p>这里一般会出现网络连接不上，找不到资源等问题，网上有很多换conda源的，感觉某些资源可以在清华源这种找到，但是一些较新的资源还是没有，所以建议安装较新版本的anaconda，之后直接按照这个指令安装就行，可能会很慢，可以科学上网提提速。</p> 
</blockquote> 
<p>安装完成后，<code>conda list</code> 可以查看到<br> <img src="https://images2.imgbox.com/12/71/dNviTpHo_o.png" alt="在这里插入图片描述"></p> 
<p>写个python程序测试一下</p> 
<pre><code class="prism language-python"><span class="token comment">#test_gpu.py</span>
<span class="token keyword">import</span> torch
flag <span class="token operator">=</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
ngpu<span class="token operator">=</span> <span class="token number">1</span>
<span class="token comment"># Decide which device we want to run on</span>
device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">"cuda:0"</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">and</span> ngpu <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">"cpu"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>get_device_name<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/06/56/0nwaVEE2_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/aaae58dbf0439a5e025be6358bfc9fab/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">BUUCTF--web</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a9ea661ae4141a3906a44c416d389fbd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">CSS属性复习</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>