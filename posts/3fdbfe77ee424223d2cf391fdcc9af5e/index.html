<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>单独安装ubuntu18_ubuntu18.04安装opencv&#43;opencv_contrib - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="单独安装ubuntu18_ubuntu18.04安装opencv&#43;opencv_contrib" />
<meta property="og:description" content="本来在win7&#43;VS2017下配置好了opencv3.3.0，但在后来使用过程中才发现，当时安装的是一个基础版的，opencv的许多应用，比如sift检测等，需要单独安装opencv_contrib库才能使用。后来，在win7&#43;VS2017一下折腾很久，最终由于很多辅助软件无法下载而放弃，转到ubuntu18.04系统下配置opencv，安装过程也是各种折腾，所以把配置中出现过的问题及解决办法记录一下。
需要特别说明的是，我的电脑是hp probook440 G2，主系统安装的是win7 SP1，ubuntu18.04作为第二系统，C&#43;&#43;使用的IDE是kdevelop。把电脑系统情况说一下，是因为最近在安装ubuntu和配置opencv时，发现win7和win10有很大差异，出现的问题也是五花八门，特别是新的电脑采用UEFI启动模式，让安装双系统、设置系统启动更加麻烦，以后再针对win10安装双系统总结一下。
1、下载源文件 在下载源文件前需要安装好C&#43;&#43;编译器，下载源文件时可以在终端利用git下载opencv及opencv_contrib源文件，我使用的下在链接为：
git clone https://github.com/opencv/opencv.git git clone https://github.com/opencv/opencv_contrib.git 编译源文件 遇到问题最多的，就是编译源文件。因此，在编译前建议先看完本小结涉及的内容再操作，避免出错。 首先在opencv文件夹里新建build目录，再进入build目录。
在build目录下输入以下命令，进行编译: cmake -DCMAKE_BUILD_TYPE=RELEASE -DCMAKE_INSTALL_PREFIX=/usr/local -DINSTALL_C_EXAMPLES=ON -DINSTALL_PYTHON_EXAMPLES=ON -DWITH_TBB=ON -DWITH_V4L=ON -DWITH_QT=ON -DWITH_OPENGEL=ON -DOPENCV_EXTRA_MODULES_PATH=~/opencv/opencv_contrib/modules -DOPENCV_ENABLE_NONFREE=ON -DPYTHON_EXECUTABLE=/usr/bin/python -DBUILD_EXAMPLES=ON .. 遇到的问题 （1）如果直接在opencv文件夹中用cmake命令编译，会报错，提示不允许在源文件中进行编译，同时会在源文件的一些配置文件中记录你在源文件夹下进行编译操作。这时候，需要删除这个记录信息，并新建build，并在该目录下编译。因为我不知道这个信息具体是记录在哪个文件中的，我就是直接删除所有源文件，重新下载一份。
（2）如果在cmake命令中输漏了最后的..标识符，就会提示当前目录下没有CMakeLists. txt文件，这是由于我们现在进入了build目录，所以最后一定加上..这个符号。
（3）在安装过程中，会下载一些第三方依赖，而这些依赖会出线下载超时的情况，因为它采用的是默认的下载地址。解决办法是在网上先下载好这些依赖，然后再到安装文件中去修改这些依赖的默认下载地址，然后再重新输入上述cmake命令。以下是我单独下载的依赖和修改默认安装源地址的方法:
cmake_files文件下载及安装：opencv3_cmake_files
这个依赖位于~/Downloads目录下，需要将他们拷贝到opencv默认安装目录才能生效。因此，将这部分文件拷贝到我下载的源文件的目录下：
~/opencv/opencv_contrib/modules/xfeatures2d/src/ ippicv下载及安装：ippicv
下载的文件存放在~/Downloads目录下，需要修改opencv默认安装源目录。
打开源文件：~/opencv/3rdparty/ippicv/ippicv.cmak，将其中
&#34;https://raw.githubusercontent.com/opencv/opencv_3rdparty/${IPPICV_COMMIT}ippicv/&#34; 替换为
&#34;file:~/Downloads/&#34; face_landmark_model.dat下载及安装：face_landmark_model
类似的，对opencv默认安装源进行修改。
在源文件中打开：~/opencv/opencv_contrib/modules/face/CMakeLinks.txt，将其中的
&#34;https://raw.githubusercontent.com/opencv/opencv_3rdparty/${__commit_hash}/&#34; 替换为
&#34;file:~/Downloads/&#34; 至此，我配置完了无法下载的第三方依赖项，然后在重新进入:~/opencv/build利用cmake进行编译，可以顺利通过。
特别说明 （1）DPYTHON_EXECUTABLE=/usr/bin/python这个是你python的安装目录，可以通过which python查询。
（2）DOPENCV_EXTRA_MODULES_PATH=~/opencv/opencv_contrib/modules这个是你下载的opencb_contrib中modules文件夹的地址。
（3）修改第三方依赖项的下载地址时，需要用你下载的第三方依赖存储地址去替换。
2、生成及安装库文件 用sudo make -j8生成库文件。
sudo make -j8 其中的数字8是可用的线程数，可以用npro查询得到。
用sudo make install完成库文件安装。
sudo make install 3、配置库文件 参考网上配置方法，在终端输入以下命令，配置库文件。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/3fdbfe77ee424223d2cf391fdcc9af5e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-04T21:13:07+08:00" />
<meta property="article:modified_time" content="2021-01-04T21:13:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">单独安装ubuntu18_ubuntu18.04安装opencv&#43;opencv_contrib</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div> 
 <p></p> 
 <div style="text-align:center;"> 
  <img src="https://images2.imgbox.com/46/c4/uVCIMCJg_o.png" alt="a0d1f222bd17292c54864e3ffec7ecdc.png"> 
 </div> 
 <p>本来在win7+VS2017下配置好了opencv3.3.0，但在后来使用过程中才发现，当时安装的是一个基础版的，opencv的许多应用，比如sift检测等，需要单独安装opencv_contrib库才能使用。后来，在win7+VS2017一下折腾很久，最终由于很多辅助软件无法下载而放弃，转到ubuntu18.04系统下配置opencv，安装过程也是各种折腾，所以把配置中出现过的问题及解决办法记录一下。</p> 
 <p>需要特别说明的是，我的电脑是hp probook440 G2，主系统安装的是win7 SP1，ubuntu18.04作为第二系统，C++使用的IDE是kdevelop。把电脑系统情况说一下，是因为最近在安装ubuntu和配置opencv时，发现win7和win10有很大差异，出现的问题也是五花八门，特别是新的电脑采用UEFI启动模式，让安装双系统、设置系统启动更加麻烦，以后再针对win10安装双系统总结一下。</p> 
 <h3>1、下载源文件</h3> 
 <p>在下载源文件前需要安装好C++编译器，下载源文件时可以在终端利用git下载opencv及opencv_contrib源文件，我使用的下在链接为：</p> 
 <div class="has"> 
  <pre class="has"><code>git clone https://github.com/opencv/opencv.git
git clone https://github.com/opencv/opencv_contrib.git</code></pre> 
 </div> 
 <h3>编译源文件</h3> 
 <h3>遇到问题最多的，就是编译源文件。因此，在编译前建议先看完本小结涉及的内容再操作，避免出错。</h3> 
 <p>首先在opencv文件夹里新建build目录，再进入build目录。</p> 
 <h3>在build目录下输入以下命令，进行编译:</h3> 
 <div class="has"> 
  <pre class="has"><code>cmake -DCMAKE_BUILD_TYPE=RELEASE 
-DCMAKE_INSTALL_PREFIX=/usr/local -DINSTALL_C_EXAMPLES=ON 
-DINSTALL_PYTHON_EXAMPLES=ON -DWITH_TBB=ON -DWITH_V4L=ON 
-DWITH_QT=ON -DWITH_OPENGEL=ON 
-DOPENCV_EXTRA_MODULES_PATH=~/opencv/opencv_contrib/modules 
-DOPENCV_ENABLE_NONFREE=ON -DPYTHON_EXECUTABLE=/usr/bin/python 
-DBUILD_EXAMPLES=ON ..</code></pre> 
 </div> 
 <p></p> 
 <div style="text-align:center;"> 
  <img src="https://images2.imgbox.com/19/b0/oyaxUzlG_o.png" alt="943c2e2a0b5988f05feea8c5cefa58d5.png"> 
 </div> 
 <h3>遇到的问题</h3> 
 <p>（1）如果直接在opencv文件夹中用cmake命令编译，会报错，提示不允许在源文件中进行编译，同时会在源文件的一些配置文件中记录你在源文件夹下进行编译操作。这时候，需要删除这个记录信息，并新建build，并在该目录下编译。因为我不知道这个信息具体是记录在哪个文件中的，我就是直接删除所有源文件，重新下载一份。</p> 
 <p>（2）如果在cmake命令中输漏了最后的..标识符，就会提示当前目录下没有CMakeLists. txt文件，这是由于我们现在进入了build目录，所以最后一定加上..这个符号。</p> 
 <p>（3）在安装过程中，会下载一些第三方依赖，而这些依赖会出线下载超时的情况，因为它采用的是默认的下载地址。解决办法是在网上先下载好这些依赖，然后再到安装文件中去修改这些依赖的默认下载地址，然后再重新输入上述cmake命令。以下是我单独下载的依赖和修改默认安装源地址的方法:</p> 
 <p><b><i>cmake_files文件下载及安装</i></b>：opencv3_cmake_files</p> 
 <p></p> 
 <div style="text-align:center;"> 
  <img src="https://images2.imgbox.com/ae/d4/uyz2si2z_o.png" alt="744e89c0968704b40fa55c30af8a7355.png"> 
 </div> 
 <p>这个依赖位于~/Downloads目录下，需要将他们拷贝到opencv默认安装目录才能生效。因此，将这部分文件拷贝到我下载的源文件的目录下：</p> 
 <div class="has"> 
  <pre class="has"><code>~/opencv/opencv_contrib/modules/xfeatures2d/src/</code></pre> 
 </div> 
 <p><b><i>ippicv下载及安装</i></b>：ippicv</p> 
 <p></p> 
 <div style="text-align:center;"> 
  <img src="https://images2.imgbox.com/eb/d9/Pz77ZeKe_o.png" alt="5e9b16144ab457f62f3e8b672c7bde2c.png"> 
 </div> 
 <p>下载的文件存放在~/Downloads目录下，需要修改opencv默认安装源目录。</p> 
 <p>打开源文件：~/opencv/3rdparty/ippicv/ippicv.cmak，将其中</p> 
 <div class="has"> 
  <pre class="has"><code>"https://raw.githubusercontent.com/opencv/opencv_3rdparty/${IPPICV_COMMIT}ippicv/"</code></pre> 
 </div> 
 <p>替换为</p> 
 <div class="has"> 
  <pre class="has"><code>"file:~/Downloads/"</code></pre> 
 </div> 
 <p></p> 
 <div style="text-align:center;"> 
  <img src="https://images2.imgbox.com/d8/ff/ZRK0u0Xp_o.png" alt="6700e6215929ec94d20798e7b4d6885a.png"> 
 </div> 
 <p><b><i>face_landmark_model.dat下载及安装</i></b>：face_landmark_model</p> 
 <p>类似的，对opencv默认安装源进行修改。</p> 
 <p>在源文件中打开：~/opencv/opencv_contrib/modules/face/CMakeLinks.txt，将其中的</p> 
 <div class="has"> 
  <pre class="has"><code>"https://raw.githubusercontent.com/opencv/opencv_3rdparty/${__commit_hash}/"</code></pre> 
 </div> 
 <p>替换为</p> 
 <div class="has"> 
  <pre class="has"><code>"file:~/Downloads/"</code></pre> 
 </div> 
 <p></p> 
 <div style="text-align:center;"> 
  <img src="https://images2.imgbox.com/13/9c/ZUtGbpf3_o.png" alt="2055bbd6554da5e138a15716c95b33ff.png"> 
 </div> 
 <p>至此，我配置完了无法下载的第三方依赖项，然后在重新进入:~/opencv/build利用cmake进行编译，可以顺利通过。</p> 
 <h3>特别说明</h3> 
 <p>（1）DPYTHON_EXECUTABLE=/usr/bin/python这个是你python的安装目录，可以通过which python查询。</p> 
 <p>（2）DOPENCV_EXTRA_MODULES_PATH=~/opencv/opencv_contrib/modules这个是你下载的opencb_contrib中modules文件夹的地址。</p> 
 <p>（3）修改第三方依赖项的下载地址时，需要用你下载的第三方依赖存储地址去替换。</p> 
 <h3>2、生成及安装库文件</h3> 
 <p>用sudo make -j8生成库文件。</p> 
 <div class="has"> 
  <pre class="has"><code>sudo make -j8</code></pre> 
 </div> 
 <p>其中的数字8是可用的线程数，可以用npro查询得到。</p> 
 <p>用sudo make install完成库文件安装。</p> 
 <div class="has"> 
  <pre class="has"><code>sudo make install</code></pre> 
 </div> 
 <h3>3、配置库文件</h3> 
 <p>参考网上配置方法，在终端输入以下命令，配置库文件。</p> 
 <div class="has"> 
  <pre class="has"><code>sudo sh -c 'echo "/usr/local/lib" &gt;&gt; /etc/ld.so.conf.d/opencv.conf'
sudo ldconfig</code></pre> 
 </div> 
 <h3>4、配置CMakeLists. txt文件</h3> 
 <p>由于上一步的配置对我的电脑无效，所以我用kdevelop新建好工程后，需要在CMakeLists. txt中进行如下配置:</p> 
 <div class="has"> 
  <pre class="has"><code>cmake_minimum_required(VERSION 2.8)
project( Hello_World )
find_package( OpenCV REQUIRED )
include_directories( ${OpenCV_INCLUDE_DIRS} )
add_executable( hello_world main.cpp )
target_link_libraries( DisplayImage ${OpenCV_LIBS} )</code></pre> 
 </div> 
 <p>遇到的问题：</p> 
 <p>1、我当时在配置CMakeLists.txt是把OpenCV写成吧Opencv，导致无法编译，需要注意变量名。</p> 
 <h3>结束</h3> 
 <p>至此，完成opencv全部安装配置。如果大家在自己的系统中还遇到新的问题及解决方法，欢迎留言，方便以后大家查阅。</p> 
 <p>在配置安装opencv过程中，参考以下资料解决了安装过程中出线的问题：</p> 
 <p>https://marvae.github.io/2018-09-06/opencv-install/ </p> 
 <p>https://blog.csdn.net/xiangxianghehe/article/details/78780269 </p> 
 <p>ZhouruiSong：OpenCV3.4.5 安装contrib模块 </p> 
 <p>ubuntu16.04 安装opencv IPPICV 和 face_landmark_model.dat下载不下来的问题解决</p> 
 <p>编译OpenCV以及openc_contrib提示缺少boostdesc_bgm.i文件出错的解决</p> 
 <p>pencv 解决ippicv下载问题，离线:ippicv_2019_lnx_intel64_general_20180723.tgz</p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3e81e601d8125c306b8f5e77806fc019/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">torch.pairwise_distance(): 计算特征图之间的像素级欧氏距离</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9549574106579ff1befa64cacb1741c3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java.lang.NoClassDefFoundError: org/springframework/context/ApplicationContext崩溃解决</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>