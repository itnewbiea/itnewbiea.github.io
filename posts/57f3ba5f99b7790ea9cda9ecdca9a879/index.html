<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习sk-learn鸢尾花分类模型训练 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习sk-learn鸢尾花分类模型训练" />
<meta property="og:description" content="sk-learn鸢尾花分类模型训练 在python的sklearn库中，有一些小型数据集，我们可以直接拿来进行模型训练学习。
Iris（鸢尾花）数据集是常用的分类实验数据集，由Fisher, 1936收集整理。Iris也称鸢尾花卉数据集，是一类多重变量分析的数据集。关于数据集共有150个样本，4个特征，3个目标值，我们可以这样引用：
from sklearn.datasets import load_iris # 1.获取鸢尾花数据集 iris = load_iris() print(&#34;鸢尾花数据集的返回值：\n&#34;, iris) # 返回值是一个继承自字典的Bench print(&#34;鸢尾花的特征值:\n&#34;, iris[&#34;data&#34;]) print(&#34;鸢尾花的目标值：\n&#34;, iris.target) print(&#34;鸢尾花特征的名字：\n&#34;, iris.feature_names) print(&#34;鸢尾花目标值的名字：\n&#34;, iris.target_names) print(&#34;鸢尾花的描述：\n&#34;, iris.DESCR) 部分结果：
鸢尾花的特征值:
[[5.1 3.5 1.4 0.2]
[4.9 3. 1.4 0.2]
[4.7 3.2 1.3 0.2]
[4.6 3.1 1.5 0.2]
[5. 3.6 1.4 0.2]
[5.4 3.9 1.7 0.4]
[4.6 3.4 1.4 0.3]
[5. 3.4 1.5 0.2]
[4.4 2.9 1.4 0.2]
[4.9 3.1 1.5 0.1]" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/57f3ba5f99b7790ea9cda9ecdca9a879/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-06-11T14:13:49+08:00" />
<meta property="article:modified_time" content="2020-06-11T14:13:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习sk-learn鸢尾花分类模型训练</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="sklearn_0"></a>sk-learn鸢尾花分类模型训练</h3> 
<p>在python的sklearn库中，有一些小型数据集，我们可以直接拿来进行模型训练学习。<br> Iris（鸢尾花）数据集是常用的分类实验数据集，由Fisher, 1936收集整理。Iris也称鸢尾花卉数据集，是一类多重变量分析的数据集。关于数据集共有150个样本，4个特征，3个目标值，我们可以这样引用：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris
<span class="token comment"># 1.获取鸢尾花数据集</span>
iris <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"鸢尾花数据集的返回值：\n"</span><span class="token punctuation">,</span> iris<span class="token punctuation">)</span>
<span class="token comment"># 返回值是一个继承自字典的Bench</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"鸢尾花的特征值:\n"</span><span class="token punctuation">,</span> iris<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"鸢尾花的目标值：\n"</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>target<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"鸢尾花特征的名字：\n"</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"鸢尾花目标值的名字：\n"</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>target_names<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"鸢尾花的描述：\n"</span><span class="token punctuation">,</span> iris<span class="token punctuation">.</span>DESCR<span class="token punctuation">)</span>
</code></pre> 
<p><strong>部分结果：</strong></p> 
<blockquote> 
 <p><strong>鸢尾花的特征值:</strong><br> [[5.1 3.5 1.4 0.2]<br> [4.9 3. 1.4 0.2]<br> [4.7 3.2 1.3 0.2]<br> [4.6 3.1 1.5 0.2]<br> [5. 3.6 1.4 0.2]<br> [5.4 3.9 1.7 0.4]<br> [4.6 3.4 1.4 0.3]<br> [5. 3.4 1.5 0.2]<br> [4.4 2.9 1.4 0.2]<br> [4.9 3.1 1.5 0.1]<br> [5.4 3.7 1.5 0.2]<br> [4.8 3.4 1.6 0.2]<br> [4.8 3. 1.4 0.1]<br> [4.3 3. 1.1 0.1]<br> [5.8 4. 1.2 0.2]<br> [5.7 4.4 1.5 0.4]<br> [5.4 3.9 1.3 0.4]<br> [5.1 3.5 1.4 0.3]<br> [5.7 3.8 1.7 0.3]<br> [5.1 3.8 1.5 0.3]<br> [5.4 3.4 1.7 0.2]<br> [5.1 3.7 1.5 0.4]<br> [4.6 3.6 1. 0.2]<br> [5.1 3.3 1.7 0.5]<br> [4.8 3.4 1.9 0.2]<br> [5. 3. 1.6 0.2]<br> [5. 3.4 1.6 0.4]<br> [5.2 3.5 1.5 0.2]<br> [5.2 3.4 1.4 0.2]<br> [4.7 3.2 1.6 0.2]<br> [4.8 3.1 1.6 0.2]<br> [5.4 3.4 1.5 0.4]<br> [5.2 4.1 1.5 0.1]<br> [5.5 4.2 1.4 0.2]<br> [4.9 3.1 1.5 0.2]<br> [5. 3.2 1.2 0.2]<br> [5.5 3.5 1.3 0.2]<br> [4.9 3.6 1.4 0.1]<br> [4.4 3. 1.3 0.2]<br> [5.1 3.4 1.5 0.2]<br> [5. 3.5 1.3 0.3]<br> [4.5 2.3 1.3 0.3]<br> [4.4 3.2 1.3 0.2]<br> [5. 3.5 1.6 0.6]<br> [5.1 3.8 1.9 0.4]<br> [4.8 3. 1.4 0.3]<br> [5.1 3.8 1.6 0.2]<br> [4.6 3.2 1.4 0.2]<br> [5.3 3.7 1.5 0.2]<br> [5. 3.3 1.4 0.2]<br> [7. 3.2 4.7 1.4]<br> [6.4 3.2 4.5 1.5]<br> [6.9 3.1 4.9 1.5]<br> [5.5 2.3 4. 1.3]<br> [6.5 2.8 4.6 1.5]<br> [5.7 2.8 4.5 1.3]<br> [6.3 3.3 4.7 1.6]<br> [4.9 2.4 3.3 1. ]<br> [6.6 2.9 4.6 1.3]<br> [5.2 2.7 3.9 1.4]<br> [5. 2. 3.5 1. ]<br> [5.9 3. 4.2 1.5]<br> [6. 2.2 4. 1. ]<br> [6.1 2.9 4.7 1.4]<br> [5.6 2.9 3.6 1.3]<br> [6.7 3.1 4.4 1.4]<br> [5.6 3. 4.5 1.5]<br> [5.8 2.7 4.1 1. ]<br> [6.2 2.2 4.5 1.5]<br> [5.6 2.5 3.9 1.1]<br> [5.9 3.2 4.8 1.8]<br> [6.1 2.8 4. 1.3]<br> [6.3 2.5 4.9 1.5]<br> [6.1 2.8 4.7 1.2]<br> [6.4 2.9 4.3 1.3]<br> [6.6 3. 4.4 1.4]<br> [6.8 2.8 4.8 1.4]<br> [6.7 3. 5. 1.7]<br> [6. 2.9 4.5 1.5]<br> [5.7 2.6 3.5 1. ]<br> [5.5 2.4 3.8 1.1]<br> [5.5 2.4 3.7 1. ]<br> [5.8 2.7 3.9 1.2]<br> [6. 2.7 5.1 1.6]<br> [5.4 3. 4.5 1.5]<br> [6. 3.4 4.5 1.6]<br> [6.7 3.1 4.7 1.5]<br> [6.3 2.3 4.4 1.3]<br> [5.6 3. 4.1 1.3]<br> [5.5 2.5 4. 1.3]<br> [5.5 2.6 4.4 1.2]<br> [6.1 3. 4.6 1.4]<br> [5.8 2.6 4. 1.2]<br> [5. 2.3 3.3 1. ]<br> [5.6 2.7 4.2 1.3]<br> [5.7 3. 4.2 1.2]<br> [5.7 2.9 4.2 1.3]<br> [6.2 2.9 4.3 1.3]<br> [5.1 2.5 3. 1.1]<br> [5.7 2.8 4.1 1.3]<br> [6.3 3.3 6. 2.5]<br> [5.8 2.7 5.1 1.9]<br> [7.1 3. 5.9 2.1]<br> [6.3 2.9 5.6 1.8]<br> [6.5 3. 5.8 2.2]<br> [7.6 3. 6.6 2.1]<br> [4.9 2.5 4.5 1.7]<br> [7.3 2.9 6.3 1.8]<br> [6.7 2.5 5.8 1.8]<br> [7.2 3.6 6.1 2.5]<br> [6.5 3.2 5.1 2. ]<br> [6.4 2.7 5.3 1.9]<br> [6.8 3. 5.5 2.1]<br> [5.7 2.5 5. 2. ]<br> [5.8 2.8 5.1 2.4]<br> [6.4 3.2 5.3 2.3]<br> [6.5 3. 5.5 1.8]<br> [7.7 3.8 6.7 2.2]<br> [7.7 2.6 6.9 2.3]<br> [6. 2.2 5. 1.5]<br> [6.9 3.2 5.7 2.3]<br> [5.6 2.8 4.9 2. ]<br> [7.7 2.8 6.7 2. ]<br> [6.3 2.7 4.9 1.8]<br> [6.7 3.3 5.7 2.1]<br> [7.2 3.2 6. 1.8]<br> [6.2 2.8 4.8 1.8]<br> [6.1 3. 4.9 1.8]<br> [6.4 2.8 5.6 2.1]<br> [7.2 3. 5.8 1.6]<br> [7.4 2.8 6.1 1.9]<br> [7.9 3.8 6.4 2. ]<br> [6.4 2.8 5.6 2.2]<br> [6.3 2.8 5.1 1.5]<br> [6.1 2.6 5.6 1.4]<br> [7.7 3. 6.1 2.3]<br> [6.3 3.4 5.6 2.4]<br> [6.4 3.1 5.5 1.8]<br> [6. 3. 4.8 1.8]<br> [6.9 3.1 5.4 2.1]<br> [6.7 3.1 5.6 2.4]<br> [6.9 3.1 5.1 2.3]<br> [5.8 2.7 5.1 1.9]<br> [6.8 3.2 5.9 2.3]<br> [6.7 3.3 5.7 2.5]<br> [6.7 3. 5.2 2.3]<br> [6.3 2.5 5. 1.9]<br> [6.5 3. 5.2 2. ]<br> [6.2 3.4 5.4 2.3]<br> [5.9 3. 5.1 1.8]]<br> <strong>鸢尾花的目标值：</strong><br> [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0<br> 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1<br> 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2<br> 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2<br> 2 2]<br> <strong>鸢尾花特征的名字：</strong><br> [‘sepal length (cm)’, ‘sepal width (cm)’, ‘petal length (cm)’, ‘petal width (cm)’]<br> <strong>鸢尾花目标值的名字：</strong><br> [‘setosa’ ‘versicolor’ ‘virginica’]</p> 
</blockquote> 
<p>在载入了iris数据后，使用KNN算法（k-近邻算法）进行分类训练。如果一个样本在特征空间中的k个最相似(即特征空间中最邻近)的样本中的大多数属于某一个类别，则该样本也属于这个类别。<br> 这里训练集和测试集比例为8：2。<br> 在进行训练前，需要对数据进行预处理，这里使用的是标准化。</p> 
<pre><code class="prism language-python"><span class="token comment"># 2.数据基本处理</span>
<span class="token comment"># x_train,x_test,y_train,y_test为训练集特征值、测试集特征值、训练集目标值、测试集目标值的类别</span>
x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>data<span class="token punctuation">,</span> iris<span class="token punctuation">.</span>target<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token comment">#x为特征值，y为目标值</span>
<span class="token comment"># 3、特征工程：标准化</span>
transfer <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">#标准化API用transfer承接</span>
x_train <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>   <span class="token comment">#训练值类别标准化</span>
x_test <span class="token operator">=</span> transfer<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>     <span class="token comment">#测试值类别标准化</span>
</code></pre> 
<p>在进行数据训练使用API： KNeighborsClassifier的fit()方法</p> 
<pre><code class="prism language-python"><span class="token comment"># 4、机器学习(模型训练)</span>
estimator <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span>n_neighbors<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span>  <span class="token comment">#将API用estimator变量承接</span>
estimator<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>   <span class="token comment">#使用fit方法进行模型训练</span>
</code></pre> 
<p>最后进行模型评估，通过对比真实值和预测值以及准确率进行评估：</p> 
<pre><code class="prism language-python"><span class="token comment"># 5、模型评估</span>
<span class="token comment"># 方法1：比对真实值和预测值</span>
y_predict <span class="token operator">=</span> estimator<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>   <span class="token comment">#输入预测值进行预测</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"预测结果为:\n"</span><span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"比对真实值和预测值：\n"</span><span class="token punctuation">,</span> y_predict <span class="token operator">==</span> y_test<span class="token punctuation">)</span>  <span class="token comment">#相同输出True</span>
<span class="token comment"># 方法2：直接计算准确率</span>
score <span class="token operator">=</span> estimator<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>   
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"准确率为：\n"</span><span class="token punctuation">,</span> score<span class="token punctuation">)</span>
</code></pre> 
<p>预测结果：<br> <img src="https://images2.imgbox.com/e3/17/CGgLXsH7_o.png" alt="在这里插入图片描述"><br> 如果想绘制出鸢尾花的分类图，可以使用seaborn：</p> 
<p>Seaborn 是基于 Matplotlib 核心库进行了更高级的 API 封装，可以让你轻松地画出更漂亮的图形。而 Seaborn 的漂亮主要体现在配色更加舒服、以及图形元素的样式更加细腻。<br> 安装： pip3 install seaborn<br> seaborn.lmplot() 是一个非常有用的方法，它会在绘制二维散点图时，自动完成回归拟合</p> 
<p>sns.lmplot() 里的 x, y 分别代表横纵坐标的列名,<br> data= 是关联到数据集,<br> hue=*代表按照 species即花的类别分类显示,<br> fit_reg=是否进行线性拟合。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> pylab <span class="token keyword">import</span> mpl   <span class="token comment">#设置字体</span>
mpl<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">"font.sans-serif"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"SimHei"</span><span class="token punctuation">]</span>
mpl<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">"axes.unicode_minus"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>  
iris <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 把数据转换成dataframe的格式</span>
iris_d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Sepal_Length'</span><span class="token punctuation">,</span> <span class="token string">'Sepal_Width'</span><span class="token punctuation">,</span> <span class="token string">'Petal_Length'</span><span class="token punctuation">,</span> <span class="token string">'Petal_Width'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
iris_d<span class="token punctuation">[</span><span class="token string">'Species'</span><span class="token punctuation">]</span> <span class="token operator">=</span> iris<span class="token punctuation">.</span>target  <span class="token comment">#加1列类别</span>

<span class="token comment">#绘制分类图像，形参有iris矩阵，两个坐标轴分别为任意两个特征</span>
<span class="token keyword">def</span> <span class="token function">plot_iris</span><span class="token punctuation">(</span>iris<span class="token punctuation">,</span> col1<span class="token punctuation">,</span> col2<span class="token punctuation">)</span><span class="token punctuation">:</span>   
    sns<span class="token punctuation">.</span>lmplot<span class="token punctuation">(</span>x <span class="token operator">=</span> col1<span class="token punctuation">,</span> y <span class="token operator">=</span> col2<span class="token punctuation">,</span> data <span class="token operator">=</span> iris<span class="token punctuation">,</span> hue <span class="token operator">=</span> <span class="token string">"Species"</span><span class="token punctuation">,</span> fit_reg <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span>col1<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span>col2<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'鸢尾花种类分布图'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
plot_iris<span class="token punctuation">(</span>iris_d<span class="token punctuation">,</span> <span class="token string">'Petal_Width'</span><span class="token punctuation">,</span> <span class="token string">'Sepal_Length'</span><span class="token punctuation">)</span>
</code></pre> 
<p>结果：<br> <img src="https://images2.imgbox.com/bf/e0/9MMBJr1s_o.png" alt="在这里插入图片描述"><br> <strong>k近邻算法总结</strong><br> <strong>优点：</strong><br> 简单有效<br> 重新训练的代价低<br> 适合类域交叉样本<br> KNN方法主要靠周围有限的邻近的样本,而不是靠判别类域的方法来确定所属类别的，因此对于类域的交叉或重叠较多的待分样本集来说，KNN方法较其他方法更为适合。<br> 适合大样本自动分类<br> 该算法比较适用于样本容量比较大的类域的自动分类，而那些样本容量较小的类域采用这种算法比较容易产生误分。<br> <strong>缺点：</strong><br> 惰性学习<br> KNN算法是懒散学习方法（lazy learning,基本上不学习），一些积极学习的算法要快很多<br> 类别评分不是规格化<br> 输出可解释性不强<br> 计算量较大<br> 附男生受欢迎程度<br> 三个特征值（每月飞行公里数，吃甜点量，打游戏时间），三个目标值（1：差，2：中3：优）</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sklearn
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neighbors <span class="token keyword">import</span> KNeighborsClassifier
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> pylab <span class="token keyword">import</span> mpl   <span class="token comment">#设置字体</span>
man <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"E:\\dating.txt"</span><span class="token punctuation">)</span>  <span class="token comment">#导入txt文本数据</span>
man_1<span class="token operator">=</span>man<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'milage'</span><span class="token punctuation">,</span><span class="token string">'Liters'</span><span class="token punctuation">,</span><span class="token string">'Consumtime'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
man_2<span class="token operator">=</span>man<span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span>
man<span class="token punctuation">.</span>data<span class="token operator">=</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>man_1<span class="token punctuation">)</span>
man<span class="token punctuation">.</span>target<span class="token operator">=</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>man_2<span class="token punctuation">)</span>
x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>man<span class="token punctuation">.</span>data<span class="token punctuation">,</span> man<span class="token punctuation">.</span>target<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>
<span class="token comment"># 3、特征工程：标准化</span>
transfer <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
x_train <span class="token operator">=</span> transfer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
x_test <span class="token operator">=</span> transfer<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
<span class="token comment"># 4、机器学习(模型训练)</span>
estimator <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span>n_neighbors<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span>
estimator<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
<span class="token comment"># 5、模型评估</span>
<span class="token comment"># 方法1：比对真实值和预测值</span>
y_predict <span class="token operator">=</span> estimator<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"预测结果为:\n"</span><span class="token punctuation">,</span> y_predict<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"比对真实值和预测值：\n"</span><span class="token punctuation">,</span> y_predict <span class="token operator">==</span> y_test<span class="token punctuation">)</span>
<span class="token comment"># 方法2：直接计算准确率</span>
score <span class="token operator">=</span> estimator<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"准确率为：\n"</span><span class="token punctuation">,</span> score<span class="token punctuation">)</span>
y_test
</code></pre> 
<p><strong>结果：</strong><br> <img src="https://images2.imgbox.com/61/e3/g1umrOrO_o.png" alt="在这里插入图片描述"><br> 可以看出训练的成果还是比较好的的</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0ffdc3f86111a6be22ba58e2331b1f72/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Qt5.9.4编译QFTP手册</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2386e6e6ca48479cb3b20cb819499a76/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">oracle 数据库如何建立索引 如何用索引?</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>