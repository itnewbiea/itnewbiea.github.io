<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python电能质量扰动信号分类(四)基于CNN-BiLSTM的一维信号分类模型 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python电能质量扰动信号分类(四)基于CNN-BiLSTM的一维信号分类模型" />
<meta property="og:description" content="往期精彩内容：
引言
1 数据集制作与加载
1.1 导入数据
1.2 制作数据集
2 CNN-BiLSTM分类模型和超参数选取
2.1定义CNN-BiLSTM分类模型
2.2 设置参数，训练模型
3 模型评估
3.1 准确率、精确率、召回率、F1 Score
3.2 十分类混淆矩阵：
代码、数据如下：
往期精彩内容： 电能质量扰动信号数据介绍与分类-Python实现-CSDN博客
Python电能质量扰动信号分类(一)基于LSTM模型的一维信号分类-CSDN博客
Python电能质量扰动信号分类(二)基于CNN模型的一维信号分类-CSDN博客
Python电能质量扰动信号分类(三)基于Transformer的一维信号分类模型-CSDN博客
引言 本文基于Python仿真的电能质量扰动信号，先经过数据预处理进行数据集的制作和加载，然后通过Pytorch实现CNN-BiLSTM模型对扰动信号的分类。
​
Python仿真电能质量扰动信号的详细介绍可以参考下文（文末附10分类数据集）：
电能质量扰动信号数据介绍与分类-Python实现_电磁信号分类python-CSDN博客
部分扰动信号类型波形图如下所示：
​
1 数据集制作与加载 1.1 导入数据 在参考IEEE Std1159-2019电能质量检测标准与相关文献的基础上构建了扰动信号的模型，生成包括正常信号在内的10中单一信号和多种复合扰动信号。参考之前的文章，进行扰动信号10分类的预处理：
第一步，按照公式模型生成单一信号
​
单一扰动信号可视化：
​
第二步，导入十分类数据
import pandas as pd import numpy as np # 样本时长0.2s 样本步长1024 每个信号生成500个样本 噪声0DB window_step = 1024 samples = 500 noise = 0 split_rate = [0.7, 0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/99ce72862fd8e0228ff077d4adc072c0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-03T22:48:33+08:00" />
<meta property="article:modified_time" content="2024-01-03T22:48:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python电能质量扰动信号分类(四)基于CNN-BiLSTM的一维信号分类模型</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><a href="#%E5%BE%80%E6%9C%9F%E7%B2%BE%E5%BD%A9%E5%86%85%E5%AE%B9%EF%BC%9A" rel="nofollow">往期精彩内容：</a></p> 
<p id="%E5%BC%95%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E5%BC%95%E8%A8%80" rel="nofollow">引言</a></p> 
<p id="1%C2%A0%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%B6%E4%BD%9C%E4%B8%8E%E5%8A%A0%E8%BD%BD-toc" style="margin-left:0px;"><a href="#1%C2%A0%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%B6%E4%BD%9C%E4%B8%8E%E5%8A%A0%E8%BD%BD" rel="nofollow">1 数据集制作与加载</a></p> 
<p id="1.1%20%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#1.1%20%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE" rel="nofollow">1.1 导入数据</a></p> 
<p id="1.2%20%E5%88%B6%E4%BD%9C%E6%95%B0%E6%8D%AE%E9%9B%86-toc" style="margin-left:40px;"><a href="#1.2%20%E5%88%B6%E4%BD%9C%E6%95%B0%E6%8D%AE%E9%9B%86" rel="nofollow">1.2 制作数据集</a></p> 
<p id="2%C2%A0CNN-BiLSTM%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B%E5%92%8C%E8%B6%85%E5%8F%82%E6%95%B0%E9%80%89%E5%8F%96-toc" style="margin-left:0px;"><a href="#2%C2%A0CNN-BiLSTM%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B%E5%92%8C%E8%B6%85%E5%8F%82%E6%95%B0%E9%80%89%E5%8F%96" rel="nofollow">2 CNN-BiLSTM分类模型和超参数选取</a></p> 
<p id="2.1%E5%AE%9A%E4%B9%89CNN-BiLSTM%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B-toc" style="margin-left:40px;"><a href="#2.1%E5%AE%9A%E4%B9%89CNN-BiLSTM%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B" rel="nofollow">2.1定义CNN-BiLSTM分类模型</a></p> 
<p id="2.2%20%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0%EF%BC%8C%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B-toc" style="margin-left:40px;"><a href="#2.2%20%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0%EF%BC%8C%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B" rel="nofollow">2.2 设置参数，训练模型</a></p> 
<p id="3%20%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0-toc" style="margin-left:0px;"><a href="#3%20%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0" rel="nofollow">3 模型评估</a></p> 
<p id="3.1%20%E5%87%86%E7%A1%AE%E7%8E%87%E3%80%81%E7%B2%BE%E7%A1%AE%E7%8E%87%E3%80%81%E5%8F%AC%E5%9B%9E%E7%8E%87%E3%80%81F1%20Score-toc" style="margin-left:40px;"><a href="#3.1%20%E5%87%86%E7%A1%AE%E7%8E%87%E3%80%81%E7%B2%BE%E7%A1%AE%E7%8E%87%E3%80%81%E5%8F%AC%E5%9B%9E%E7%8E%87%E3%80%81F1%20Score" rel="nofollow">3.1 准确率、精确率、召回率、F1 Score</a></p> 
<p id="3.2%C2%A0%E5%8D%81%E5%88%86%E7%B1%BB%E6%B7%B7%E6%B7%86%E7%9F%A9%E9%98%B5%EF%BC%9A-toc" style="margin-left:40px;"><a href="#3.2%C2%A0%E5%8D%81%E5%88%86%E7%B1%BB%E6%B7%B7%E6%B7%86%E7%9F%A9%E9%98%B5%EF%BC%9A" rel="nofollow">3.2 十分类混淆矩阵：</a></p> 
<p id="%E4%BB%A3%E7%A0%81%E3%80%81%E6%95%B0%E6%8D%AE%E5%A6%82%E4%B8%8B%EF%BC%9A-toc" style="margin-left:0px;"><a href="#%E4%BB%A3%E7%A0%81%E3%80%81%E6%95%B0%E6%8D%AE%E5%A6%82%E4%B8%8B%EF%BC%9A" rel="nofollow">代码、数据如下：</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p id="ud23eac2d" style="text-align:center;"><img alt="" src="https://images2.imgbox.com/3e/aa/nEryrSLW_o.png"></p> 
<h2 id="%E5%BE%80%E6%9C%9F%E7%B2%BE%E5%BD%A9%E5%86%85%E5%AE%B9%EF%BC%9A">往期精彩内容：</h2> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134620438?spm=1001.2014.3001.5502" title="电能质量扰动信号数据介绍与分类-Python实现-CSDN博客">电能质量扰动信号数据介绍与分类-Python实现-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135044886?spm=1001.2014.3001.5502" title="Python电能质量扰动信号分类(一)基于LSTM模型的一维信号分类-CSDN博客">Python电能质量扰动信号分类(一)基于LSTM模型的一维信号分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135159638?spm=1001.2014.3001.5502" title="Python电能质量扰动信号分类(二)基于CNN模型的一维信号分类-CSDN博客">Python电能质量扰动信号分类(二)基于CNN模型的一维信号分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135160310?spm=1001.2014.3001.5502" title="Python电能质量扰动信号分类(三)基于Transformer的一维信号分类模型-CSDN博客">Python电能质量扰动信号分类(三)基于Transformer的一维信号分类模型-CSDN博客</a></p> 
<p></p> 
<h2 id="%E5%BC%95%E8%A8%80"><strong>引言</strong></h2> 
<p>本文基于Python仿真的电能质量扰动信号，先经过数据预处理进行数据集的制作和加载，然后通过Pytorch实现CNN-BiLSTM模型对扰动信号的分类。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/e8/b3/XgtSLjh1_o.png">​</p> 
<p>Python仿真电能质量扰动信号的详细介绍可以参考下文（<strong>文末附</strong><strong>10分类</strong><strong>数据集</strong>）：</p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134620438?spm=1001.2014.3001.5502" title="电能质量扰动信号数据介绍与分类-Python实现_电磁信号分类python-CSDN博客">电能质量扰动信号数据介绍与分类-Python实现_电磁信号分类python-CSDN博客</a></p> 
<p>部分扰动信号类型波形图如下所示：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/8a/e0/Dw4Glmgg_o.png">​</p> 
<h2 id="1%C2%A0%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%B6%E4%BD%9C%E4%B8%8E%E5%8A%A0%E8%BD%BD"><strong><strong><strong>1 数据集制作与加载</strong></strong></strong></h2> 
<h3 id="1.1%20%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE">1.1 导入数据</h3> 
<p>在参考IEEE Std1159-2019电能质量检测标准与相关文献的基础上构建了扰动信号的模型，生成包括正常信号在内的10中单一信号和多种复合扰动信号。参考之前的文章，进行扰动信号10分类的预处理：</p> 
<p>第一步，按照公式模型生成单一信号</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/9f/b1/iNYig3hl_o.png">​</p> 
<p>单一扰动信号可视化：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b4/8a/PuvZEnFm_o.png">​</p> 
<p>第二步，导入十分类数据</p> 
<div> 
 <pre><code class="language-python">import pandas as pd
import numpy as np

# 样本时长0.2s  样本步长1024  每个信号生成500个样本  噪声0DB  
window_step = 1024
samples = 500
noise = 0
split_rate = [0.7, 0.2, 0.1]  # 训练集、验证集、测试集划分比例

# 读取已处理的 CSV 文件
dataframe_10c = pd.read_csv('PDQ_10c_Clasiffy_data.csv' )
dataframe_10c.shape</code></pre> 
</div> 
<h3 id="1.2%20%E5%88%B6%E4%BD%9C%E6%95%B0%E6%8D%AE%E9%9B%86">1.2 制作数据集</h3> 
<p>第一步，定义制作数据集函数</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/7e/c5/Sq4BswFn_o.png">​</p> 
<p>第二步，制作数据集与分类标签</p> 
<div> 
 <pre><code class="language-python">from joblib import dump, load
# 生成数据
train_dataframe, val_dataframe, test_dataframe = make_data(dataframe_10c, split_rate)
# 制作标签
train_xdata, train_ylabel = make_data_labels(train_dataframe)
val_xdata, val_ylabel = make_data_labels(val_dataframe)
test_xdata, test_ylabel = make_data_labels(test_dataframe)
# 保存数据
dump(train_xdata, 'TrainX_1024_0DB_10c')
dump(val_xdata, 'ValX_1024_0DB_10c')
dump(test_xdata, 'TestX_1024_0DB_10c')
dump(train_ylabel, 'TrainY_1024_0DB_10c')
dump(val_ylabel, 'ValY_1024_0DB_10c')
dump(test_ylabel, 'TestY_1024_0DB_10c')</code></pre> 
</div> 
<h2 id="2%C2%A0CNN-BiLSTM%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B%E5%92%8C%E8%B6%85%E5%8F%82%E6%95%B0%E9%80%89%E5%8F%96"><strong><strong><strong>2 CNN-BiLSTM分类模型和超参数选取</strong></strong></strong></h2> 
<h3 id="2.1%E5%AE%9A%E4%B9%89CNN-BiLSTM%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B">2.1定义CNN-BiLSTM分类模型</h3> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/5a/b8/xqEyQB2c_o.png">​</p> 
<p>注意：输入数据维度为[64, 1, 1024], 先送入CNN网络进行1d的卷积池化，然后再把卷积池化的空间特征送入BiLSTM进行信号时域特征的提取，最终送入全连接层和softmax进行分类。</p> 
<h3 id="2.2%20%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0%EF%BC%8C%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B">2.2 设置参数，训练模型</h3> 
<p><img alt="" src="https://images2.imgbox.com/99/ba/aV3lxspM_o.png">100个epoch，准确率将近98%，CNN-BiLSTM模型分类效果良好，分类准确率高，性能优越，适当调整模型参数，可以进一步提高分类准确率。</p> 
<p></p> 
<p>注意调整参数：</p> 
<ul><li> <p>可以适当增加 CNN层数和隐藏层维度数，微调学习率；</p> </li><li> <p>增加BiLSTM层数和维度数，增加更多的 epoch （注意防止过拟合）</p> </li><li> <p>可以改变一维信号堆叠的形状（设置合适的长度和维度）</p> </li></ul> 
<h2 id="3%20%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0"><strong><strong><strong>3 模型评估</strong></strong></strong></h2> 
<h3 id="3.1%20%E5%87%86%E7%A1%AE%E7%8E%87%E3%80%81%E7%B2%BE%E7%A1%AE%E7%8E%87%E3%80%81%E5%8F%AC%E5%9B%9E%E7%8E%87%E3%80%81F1%20Score">3.1 准确率、精确率、召回率、F1 Score</h3> 
<p><img alt="" src="https://images2.imgbox.com/ab/ca/Dtr68qR7_o.png"></p> 
<h3 id="3.2%C2%A0%E5%8D%81%E5%88%86%E7%B1%BB%E6%B7%B7%E6%B7%86%E7%9F%A9%E9%98%B5%EF%BC%9A">3.2 十分类混淆矩阵：</h3> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ed/69/FOs8KP6N_o.png"></p> 
<h2 id="%E4%BB%A3%E7%A0%81%E3%80%81%E6%95%B0%E6%8D%AE%E5%A6%82%E4%B8%8B%EF%BC%9A"><strong>代码、数据如下：</strong></h2> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/65/11/7mQvrUhW_o.png"></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d613f4130e24f3bfc9ec8853c2e5ec1a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">注意：C语言结构体里不能赋初始值！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c6beeab9b33321a5310bd59717c5686e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据结构 第八章节 排序</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>