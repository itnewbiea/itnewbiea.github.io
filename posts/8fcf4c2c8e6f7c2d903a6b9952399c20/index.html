<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>关于el-table&#43;el-input&#43;el-propover的封装 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="关于el-table&#43;el-input&#43;el-propover的封装" />
<meta property="og:description" content="一、先放图片便于理解 需求： 1、el-input触发focus事件，弹出el-table(当然也可以为其添加搜索功能、分页)
2、el-table中的复选功能转化成单选共能
3、选择或取消的数据在el-input中动态显示
4、勾选数据后，因为分页过多，原先选好的数据容易被埋没，在el-input里手动删除或添加触发input事件，el-table根据原有数据能检索到对应数据
5、若不通过勾选选择信息，手动添加，触发input事件，可一边输入一边检索是否存在所输入的数据
6、选择全部勾选无效
二、封装成组件之后的调用 view部分：
&lt;selectUserInfo ref=&#34;selectUser&#34; :inputUserData=&#34;form.quauser&#34; @fatherSelect=&#34;selectMethod&#34;&gt;&lt;/selectUserInfo&gt; model部分：
selectMethod(selection) { //selection参数接收从子组件中传过来的被勾选的用户信息 let common; //通过字符串或数组类型来判断是在table页面勾选后回显input数据还是手动输入input数据 if (selection instanceof Array) { // 无论勾选多少个，只取最新勾选的用户数据 let index = selection.length - 1 &#43; &#34;&#34; common = selection[index]; } else { //规范输入操作，因为组件输入input框触发@input事件后根据“-”分割姓名和编号，进行实时检索，返回数据为空，这时操作者能及时修改输入内容，或者在输入过程中查找到对应数据直接勾选即可 let reg = /.-[1-9][0-9]{7}$/ if (!reg.test(selection)) { //不符合格式规范，会导致el-input表单校验confirm校验不通过 this.form.userInfo= &#34;&#34;; return } } }, 三、实现过程 1】el-popover代码 &lt;el-popover placement=&#34;right&#34; width=&#34;400&#34; trigger=&#34;click&#34;&gt; &lt;el-table :data=&#34;gridData&#34; v-loading=&#34;loading&#34; ref=&#34;userlist&#34; @select=&#34;handleSelectionChange&#34; :row-key=&#34;row =&gt; row." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8fcf4c2c8e6f7c2d903a6b9952399c20/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-15T15:12:38+08:00" />
<meta property="article:modified_time" content="2023-11-15T15:12:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">关于el-table&#43;el-input&#43;el-propover的封装</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>一、先放图片便于理解</h4> 
<p><img alt="" height="654" src="https://images2.imgbox.com/74/47/868Ra0r1_o.png" width="1200"></p> 
<p>需求： </p> 
<blockquote> 
 <p>1、el-input触发focus事件，弹出el-table(当然也可以为其添加搜索功能、分页)</p> 
 <p>2、el-table中的复选功能转化成单选共能</p> 
 <p>3、选择或取消的数据在el-input中动态显示</p> 
 <p>4、勾选数据后，因为分页过多，原先选好的数据容易被埋没，在el-input里手动删除或添加触发input事件，el-table根据原有数据能检索到对应数据</p> 
 <p>5、若不通过勾选选择信息，手动添加，触发input事件，可一边输入一边检索是否存在所输入的数据</p> 
 <p>6、选择全部勾选无效</p> 
</blockquote> 
<h4>二、封装成组件之后的调用</h4> 
<p>view部分：</p> 
<pre><code class="language-html">&lt;selectUserInfo ref="selectUser" :inputUserData="form.quauser" @fatherSelect="selectMethod"&gt;&lt;/selectUserInfo&gt;</code></pre> 
<p> model部分：</p> 
<pre><code class="language-javascript">  selectMethod(selection) {
//selection参数接收从子组件中传过来的被勾选的用户信息
            let common;
//通过字符串或数组类型来判断是在table页面勾选后回显input数据还是手动输入input数据
            if (selection instanceof Array) {
// 无论勾选多少个，只取最新勾选的用户数据
                let index = selection.length - 1 + ""
                common = selection[index];
            } else {
//规范输入操作，因为组件输入input框触发@input事件后根据“-”分割姓名和编号，进行实时检索，返回数据为空，这时操作者能及时修改输入内容，或者在输入过程中查找到对应数据直接勾选即可
                let reg = /.-[1-9][0-9]{7}$/
                if (!reg.test(selection)) {
//不符合格式规范，会导致el-input表单校验confirm校验不通过
                    this.form.userInfo= "";
                    return
                }
            }      

        },</code></pre> 
<h4>三、实现过程</h4> 
<h6>1】el-popover代码</h6> 
<pre><code class="language-html">&lt;el-popover
  placement="right"
  width="400"
  trigger="click"&gt;
  &lt;el-table :data="gridData" v-loading="loading" ref="userlist"  @select="handleSelectionChange"
            :row-key="row =&gt; row.userId"&gt;
    &lt;el-table-column width="150" property="date" label="日期"&gt;&lt;/el-table-column&gt;
    &lt;el-table-column width="100" property="name" label="姓名"&gt;&lt;/el-table-column&gt;
    &lt;el-table-column width="300" property="address" label="地址"&gt;&lt;/el-table-column&gt;
  &lt;/el-table&gt;
   &lt;el-input slot="reference" v-model="inputUserDataCopy" style="width" 
     @input="handleInput"&gt;
            &lt;i slot="suffix" class="el-icon-search"&gt;&lt;/i&gt;
        &lt;/el-input&gt;
&lt;/el-popover&gt;</code></pre> 
<h6> 2】elementUI el-popover源码分析</h6> 
<h6><img alt="" height="482" src="https://images2.imgbox.com/44/24/alnNdOsj_o.png" width="876"> 3】复选框实现单选功能</h6> 
<blockquote> 
 <p>思路：勾选数据之前取消所有的勾选</p> 
</blockquote> 
<p><img alt="" height="53" src="https://images2.imgbox.com/ef/c2/oYDE4LbJ_o.png" width="649"></p> 
<blockquote> 
 <p>避坑：</p> 
 <p>1、在el-table标签中添加“:row-key='row=&gt;row.userId'”实现勾选翻页的情况下保留勾选；</p> 
 <p>2、使用@select事件而不是@selection-change事件。在实现单选功能过程中，运用selection-change会发生反复触发以及反复调用函数的情况，就是通过api,clearSlection()和toggleRowSelection()改变的勾选状态也会触发selection-change绑定的方法。</p> 
</blockquote> 
<p><img alt="" height="73" src="https://images2.imgbox.com/ff/5a/WXyrHn4L_o.png" width="735"> <img alt="" height="63" src="https://images2.imgbox.com/1a/51/XyrTAyBp_o.png" width="659"></p> 
<p>触发@select事件后调用handleSelectionChange方法，js代码实现：</p> 
<pre><code class="language-javascript">       handleSelectionChange(selection) { 
// 当勾选时,取消前全部勾选只选择最后一个 另selection-change是复选框发生该便时调用，由于取消以及toggleRowSelection也会触发会造成一直被调用的状态。select在选择时调用，更适合这里
               let index = selection.length - 1 + "";
                this.$refs.userlist.clearSelection();
                this.$refs.userlist.toggleRowSelection(selection[index]);
           
        },</code></pre> 
<h6>4】 勾选的数据按照“姓名-编号”格式显示到input输入框</h6> 
<p>1、触发@select事件后调用handleSelectionChange(selection)方法，selection参数获取到所勾选函数的用户信息。</p> 
<p>2、通过$emit子组件调用父组件方法以及传值的方法，将用户数据传到父组件</p> 
<pre><code class="language-javascript"> props: {
        inputUserData: {
            type: String,
            default: ""
        },
    },  
data(){
     return{
         inputUserDataCopy: ""
       }
},
methods:{
 handleSelectionChange(selection) { 
// 当勾选时,取消前一个勾选只选择最后一个 另selection-change是复选框发生该便时调用，由于取消以及toggleRowSelection也会触发会造成一直被调用的状态。select在选择时调用，更适合这里
            selection.forEach(row =&gt; {
                this.$refs.userlist.clearSelection();
                this.$refs.userlist.toggleRowSelection(row);
            });
            this.emit().then(() =&gt; {
                this.inputUserDataCopy = this.inputUserData;
            });
        },
//封装一个异步方法，因为要想input v-model绑定的属性发生改变，就不能在props接收的属性上直接操作
//在 this.inputUserDataCopy = this.inputUserData;赋值之前需要先把数据selection用户数据传到父组件
      
 emit() {
            return new Promise((resole, reject) =&gt; {
                this.$emit("fatherSelect", this.selection);
                resole(true)
            })
        },
}, 
</code></pre> 
<h6><img alt="" height="689" src="https://images2.imgbox.com/bc/54/3kWxX7VQ_o.png" width="1200">5】 根据input值在table页面检索出对应的值</h6> 
<pre><code class="language-javascript">  handleInput() {
// 实现一边输入用户信息一边检索列表是否存在相应信息
//判断条件根据实际情况改变，之所这样是因为我需要“-”符号来区分名字和编号，以检索相应数据
            if (this.inputUserDataCopy.split("-").length &gt; 1) {
                this.queryParams.userName = this.inputUserDataCopy.split("-")[1];
                this.queryParams.userName = this.inputUserDataCopy.split("-")[0];
//改变搜索条件，调用this.handleQuery()进行搜索（常规axios请求响应操作，不做解释）
                this.handleQuery();
//手动输入含“-”符号的信息会被传输到父组件，前面讲过的，会对这里传过去的数据进行正则test校验
                this.$emit("fatherSelect", this.inputUserDataCopy);
            }
        },</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7c62491e2c24213e834ad7bb6b9a0c63/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Windows使用adb命令安装apk文件报错adb: failed to run abb_exec. Error: closedadb: retrieving the default device</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/297607cdab4fc925928229fd02a96ed6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">STM32CubeIDE的MCU开发</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>