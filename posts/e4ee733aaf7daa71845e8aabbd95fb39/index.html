<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>EFCore使用MySQL - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="EFCore使用MySQL" />
<meta property="og:description" content="EFCore使用SQL Server应该是鼻祖了吧，哈哈！不过使用MySQL的就比较少见了，至少官网是没有引导的。因为不是MySQL微软的东西嘛，当然推崇SQL Server了；不过MySQL相对SQL Server更为轻量一些，我们就来简单整理下吧！Model层NuGet包如下：
1、Microsoft.EntityFrameworkCore.Design
2、Microsoft.EntityFrameworkCore.Tools
3、MySql.EntityFrameworkCore
4、Microsoft.EntityFrameworkCore
5、Microsoft.EntityFrameworkCore.Relational
对了，MySQL还可以安装连接Visual Studio和.NET的组件，需要注意的是，目前直连Visual Studio的版本仅支持到Visual Studio 2017，Visual Studio 2019暂时还没有相关的组件，不过并不影响使用。
编写SysContext
public class SysContext : DbContext { public SysContext(DbContextOptions&lt;SysContext&gt; options) : base(options) { } public DbSet&lt;Student&gt; Student { get; set; } } 编写一个实体类，做一下简单Code First验证：
public class Student { [Key] public string Id { get; set; } public string Name { get; set; } public string Number { get; set; } public string Address { get; set; } } 同样，Web层也NuGet相同的包！在Startup." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e4ee733aaf7daa71845e8aabbd95fb39/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-03T11:32:03+08:00" />
<meta property="article:modified_time" content="2021-03-03T11:32:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">EFCore使用MySQL</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p><strong>EFCore</strong>使用<strong>SQL Server</strong>应该是鼻祖了吧，哈哈！不过使用<strong>MySQL</strong>的就比较少见了，至少<a href="https://docs.microsoft.com/zh-cn/aspnet/core/data/ef-mvc/intro?view=aspnetcore-5.0" rel="nofollow"><strong>官网</strong></a>是没有引导的。因为不是<strong>MySQL</strong>微软的东西嘛，当然推崇<strong>SQL Server</strong>了；不过<strong>MySQL</strong>相对<strong>SQL Server</strong>更为轻量一些，我们就来简单整理下吧！<strong>Model</strong>层<strong>NuGet</strong>包如下：<br> 1、<strong>Microsoft.EntityFrameworkCore.Design</strong><br> 2、<strong>Microsoft.EntityFrameworkCore.Tools</strong><br> 3、<strong>MySql.EntityFrameworkCore</strong><br> 4、<strong>Microsoft.EntityFrameworkCore</strong><br> 5、<strong>Microsoft.EntityFrameworkCore.Relational</strong></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/c2/5e/PrOH42Dz_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>对了，<strong>MySQL</strong>还可以安装连接<strong>Visual Studio</strong>和.<strong>NET</strong>的组件，需要注意的是，目前直连<strong>Visual Studio</strong>的版本仅支持到<strong>Visual Studio 2017</strong>，<strong>Visual Studio 2019</strong>暂时还没有相关的组件，不过并不影响使用。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/e8/6d/YGkScyMs_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>编写<strong>SysContext</strong></p> 
</blockquote> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SysContext</span> <span class="token punctuation">:</span> <span class="token class-name">DbContext</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">public</span> <span class="token function">SysContext</span><span class="token punctuation">(</span>DbContextOptions<span class="token operator">&lt;</span>SysContext<span class="token operator">&gt;</span> options<span class="token punctuation">)</span>
            <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> DbSet<span class="token operator">&lt;</span>Student<span class="token operator">&gt;</span> Student <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>编写一个实体类，做一下简单<strong>Code First</strong>验证：</p> 
</blockquote> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token punctuation">[</span><span class="token class-name">Key</span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">string</span> Id <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">string</span> Name <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">string</span> Number <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">string</span> Address <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>同样，<strong>Web</strong>层也<strong>NuGet</strong>相同的包！在<strong>Startup.cs</strong>进行注入：</p> 
</blockquote> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token class-name">IServiceCollection</span> services<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddDbContext</span><span class="token punctuation">&lt;</span><span class="token class-name">SysContext</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>options<span class="token operator">=</span><span class="token operator">&gt;</span>
            <span class="token punctuation">{<!-- --></span>
                options<span class="token punctuation">.</span><span class="token function">UseMySQL</span><span class="token punctuation">(</span>Configuration<span class="token punctuation">.</span><span class="token function">GetConnectionString</span><span class="token punctuation">(</span><span class="token string">"DefaultConnection"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            services<span class="token punctuation">.</span><span class="token function">AddControllersWithViews</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>配置<strong>appsettings.json</strong>链接字符串：</p> 
</blockquote> 
<pre><code class="prism language-csharp"><span class="token string">"ConnectionStrings"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"DefaultConnection"</span><span class="token punctuation">:</span> <span class="token string">"server=localhost;database=test;uid=root;pwd=2239Yang;"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/10/ff/Or2xCiAF_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>做一下，数据迁移</p> 
</blockquote> 
<pre><code class="prism language-csharp">Add<span class="token operator">-</span><span class="token class-name">Migration</span> <span class="token class-name">A</span>
Update<span class="token operator">-</span>Database
</code></pre> 
<p><img src="https://images2.imgbox.com/dc/a5/7qFJE18G_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>这时候打开客户端<strong>MySQL</strong>，可以看到通过自定义实体，已成功创建相应的表！</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/da/94/kbNy2Twf_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>编写一个<strong>Controller</strong>简单测试下吧！</p> 
</blockquote> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HomeController</span> <span class="token punctuation">:</span> <span class="token class-name">Controller</span>
    <span class="token punctuation">{<!-- --></span>        
        <span class="token keyword">public</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span>IActionResult<span class="token operator">&gt;</span> <span class="token function">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>

            <span class="token keyword">var</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConfigurationBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetBasePath</span><span class="token punctuation">(</span>Environment<span class="token punctuation">.</span>CurrentDirectory<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">AddJsonFile</span><span class="token punctuation">(</span><span class="token string">"appsettings.json"</span><span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">AddInMemoryCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token keyword">var</span> connStr <span class="token operator">=</span> config<span class="token punctuation">[</span><span class="token string">"ConnectionStrings:DefaultConnection"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            DbContextOptions<span class="token operator">&lt;</span>SysContext<span class="token operator">&gt;</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-method"><span class="token function">DbContextOptionsBuilder</span><span class="token punctuation">&lt;</span><span class="token class-name">SysContext</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">UseMySQL</span><span class="token punctuation">(</span>connStr<span class="token punctuation">)</span><span class="token punctuation">.</span>Options<span class="token punctuation">;</span>

            <span class="token class-name">SysContext</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SysContext</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">var</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                Id<span class="token operator">=</span>Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                Name<span class="token operator">=</span><span class="token string">"Stu1"</span><span class="token punctuation">,</span>
                Number<span class="token operator">=</span><span class="token string">"Stu_No1"</span><span class="token punctuation">,</span>
                Address<span class="token operator">=</span><span class="token string">"BeiJing"</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            db<span class="token punctuation">.</span>Student<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">var</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                Id <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                Name <span class="token operator">=</span> <span class="token string">"Stu2"</span><span class="token punctuation">,</span>
                Number <span class="token operator">=</span> <span class="token string">"Stu_No2"</span><span class="token punctuation">,</span>
                Address <span class="token operator">=</span> <span class="token string">"BeiJing"</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            db<span class="token punctuation">.</span>Student<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">await</span> db<span class="token punctuation">.</span><span class="token function">SaveChangesAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token function">Json</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>Student<span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>执行成功！</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/29/43/EP81ccPJ_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/11/5b/EnkH11WP_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8efaf33cf6f2c44257fa462901086af3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java实现18位身份证号码的校验码计算校验</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/610f76084fc04abc09427520883ebcb6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">15.Idea搭建Flink项目Java和Scala混合项目</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>