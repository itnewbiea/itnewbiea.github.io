<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>plink软件初体验3--计算样本杂合度和SNP位点杂合度 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="plink软件初体验3--计算样本杂合度和SNP位点杂合度" />
<meta property="og:description" content="这里，模拟一个plink文件的数据，8个样本，8个SNP位点，通过手动Excel计算样本杂合度和位点杂合度，比较plink计算杂合度的方法。
1. 模拟数据 ped数据：
$ cat a.ped FAMILY1 ID1 0 0 0 -9 CC CC AA GG AG GG GG GC FAMILY1 ID2 0 0 0 -9 CC GC AG GG GG AA AG CC FAMILY1 ID3 0 0 0 -9 GG CC AG GG GG GA AG GC FAMILY1 ID4 0 0 0 -9 GG CC GG GG GG AA GG GG FAMILY1 ID5 0 0 0 -9 GG CC GG GG GG AA AG GC FAMILY1 ID6 0 0 0 -9 GG CC GG GG GG AA AA CC FAMILY1 ID7 0 0 0 -9 GG CC GG AG AA AA GG CC FAMILY1 ID9 0 0 0 -9 GG CC GG AG AA AA GG CC map数据：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/eaa247f73cc539fb2c5d9913d2e3abc0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-26T22:51:19+08:00" />
<meta property="article:modified_time" content="2020-11-26T22:51:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">plink软件初体验3--计算样本杂合度和SNP位点杂合度</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>这里，模拟一个plink文件的数据，8个样本，8个SNP位点，通过手动Excel计算样本杂合度和位点杂合度，比较plink计算杂合度的方法。</p> 
<h4><a id="1__2"></a>1. 模拟数据</h4> 
<p><strong>ped数据：</strong></p> 
<pre><code>$ cat a.ped
FAMILY1     ID1       0       0       0       -9      CC     CC     AA     GG     AG     GG     GG     GC
FAMILY1     ID2       0       0       0       -9      CC     GC     AG     GG     GG     AA     AG     CC
FAMILY1     ID3       0       0       0       -9      GG     CC     AG     GG     GG     GA     AG     GC
FAMILY1     ID4       0       0       0       -9      GG     CC     GG     GG     GG     AA     GG     GG
FAMILY1     ID5       0       0       0       -9      GG     CC     GG     GG     GG     AA     AG     GC
FAMILY1     ID6       0       0       0       -9      GG     CC     GG     GG     GG     AA     AA     CC
FAMILY1     ID7       0       0       0       -9      GG     CC     GG     AG     AA     AA     GG     CC
FAMILY1     ID9       0       0       0       -9      GG     CC     GG     AG     AA     AA     GG     CC

</code></pre> 
<p><strong>map数据：</strong></p> 
<pre><code>$ cat a.map
1       snp1    0       55910
1       snp2    0       85204
1       snp3    0       122948
1       snp4    0       203750
1       snp5    0       312707
1       snp6    0       356863
1       snp7    0       400518
1       snp8    0       487423
</code></pre> 
<h4><a id="2_het_31"></a>2. 计算样本的杂合度<code>--het</code></h4> 
<pre><code>$ plink --file a --het

</code></pre> 
<p><strong>结果查看：</strong></p> 
<pre><code>$ cat plink.het
      FID  IID       O(HOM)       E(HOM)        N(NM)            F
  FAMILY1  ID1            6         5.32            8       0.2536
  FAMILY1  ID2            5         5.32            8      -0.1195
  FAMILY1  ID3            4         5.32            8      -0.4927
  FAMILY1  ID4            8         5.32            8            1
  FAMILY1  ID5            6         5.32            8       0.2536
  FAMILY1  ID6            8         5.32            8            1
  FAMILY1  ID7            7         5.32            8       0.6268
  FAMILY1  ID9            7         5.32            8       0.6268

</code></pre> 
<p>这里：</p> 
<ul><li>FID，家系ID</li><li>IID，个体ID</li><li>O(HOM)：观察到的纯合个数</li><li>E(HOM)：期望的纯合个数</li><li>N(NM)：没有缺失的SNP个数</li><li>F：计算的值</li></ul> 
<p>其中F的计算方法：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          F 
         
        
          = 
         
         
          
          
            O 
           
          
            − 
           
          
            E 
           
          
          
          
            N 
           
          
            − 
           
          
            E 
           
          
         
        
       
         F = \frac{O-E}{N-E} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.12966em; vertical-align: -0.76933em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.36033em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">E</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.76933em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<ul><li>O: O(HOM)</li><li>E: E(HOM)</li><li>N: N(NM)</li></ul> 
<p>可以这样认为，F值越小（包括负值），杂合度越高，F值越高，纯合度越高！</p> 
<p><strong>Excel对比</strong><br> 将ped文件，copy到Excel中，手动计算纯合和杂合的个数，进行统计：<br> <img src="https://images2.imgbox.com/50/cb/fgxYXvPN_o.png" alt=""></p> 
<h4><a id="3_SNP_71"></a>3. 计算SNP位点杂合度</h4> 
<p>这里，使用参数<code>--hardy</code>，可以给出位点的纯合和杂合个数：</p> 
<pre><code>$ plink --file a --hardy

</code></pre> 
<p>结果：</p> 
<pre><code>$ cat plink.hwe
 CHR  SNP     TEST   A1   A2                 GENO   O(HET)   E(HET)            P
   1 snp1  ALL(NP)    C    G                2/0/6        0    0.375      0.01538
   1 snp2  ALL(NP)    G    C                0/1/7    0.125   0.1172            1
   1 snp3  ALL(NP)    A    G                1/2/5     0.25    0.375       0.3846
   1 snp4  ALL(NP)    A    G                0/2/6     0.25   0.2188            1
   1 snp5  ALL(NP)    A    G                2/1/5    0.125   0.4297      0.07692
   1 snp6  ALL(NP)    G    A                1/1/6    0.125   0.3047          0.2
   1 snp7  ALL(NP)    A    G                1/3/4    0.375   0.4297            1
   1 snp8  ALL(NP)    G    C                1/3/4    0.375   0.4297            1

</code></pre> 
<ul><li>GENO，<code>2/0/6</code>，第一个是次等位基因纯合个数，第二个是杂合个数，第三个是主等位基因纯合个数</li><li>O(HET)，是杂合所在的比值</li></ul> 
<p><strong>对比Excel结果：</strong></p> 
<p><img src="https://images2.imgbox.com/d8/1a/zj2x4vVd_o.png" alt=""></p> 
<h4><a id="4_SNP_99"></a>4. 计算SNP位点的基因频率</h4> 
<pre><code>$ plink --file a --freq

</code></pre> 
<p><strong>结果查看：</strong></p> 
<pre><code>$ cat plink.frq
 CHR  SNP   A1   A2          MAF  NCHROBS
   1 snp1    C    G         0.25       16
   1 snp2    G    C       0.0625       16
   1 snp3    A    G         0.25       16
   1 snp4    A    G        0.125       16
   1 snp5    A    G       0.3125       16
   1 snp6    G    A       0.1875       16
   1 snp7    A    G       0.3125       16
   1 snp8    G    C       0.3125       16

</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/986721d81636c559a472f8aa66e99e8f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">centos 切换用户_linux进入单用户模式的几种方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/85ee9c19b6322ddee690a3340a4590f2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">aes 加密_Jmeter处理AES加密接口</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>