<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于PyCharm实现串口GUI编程 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于PyCharm实现串口GUI编程" />
<meta property="og:description" content="工具效果如下如所示
下面简单介绍一下操作流程
1.打开PyCharm软件
2.创建一个工程
3.给该工程命名
4.在main.py里面黏贴如下的代码
# This is a sample Python script. # Press Shift&#43;F10 to execute it or replace it with your code. # Press Double Shift to search everywhere for classes, files, tool windows, actions, and settings. import serial import threading import time from tkinter import * from tkinter.ttk import * from tkinter import messagebox def open_serial(a,b,c,d,e): global ser print(&#34;串口号:&#34;,a) print(&#34;波特率:&#34;,int(b)) print(&#34;数据位:&#34;,c) print(&#34;停止位:&#34;,d) print(&#34;检验位:&#34;,e) bytesize = serial." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/a235921cbddd0a4d09cd3597be6a27c2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-15T09:04:41+08:00" />
<meta property="article:modified_time" content="2023-12-15T09:04:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于PyCharm实现串口GUI编程</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:.0001pt;text-align:justify;">工具效果如下如所示</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="205" src="https://images2.imgbox.com/b8/95/3Mh71iL4_o.png" width="554"></p> 
<p style="margin-left:.0001pt;text-align:justify;">下面简单介绍一下操作流程</p> 
<p style="margin-left:.0001pt;text-align:justify;">1.打开PyCharm软件</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="72" src="https://images2.imgbox.com/5f/06/G22EWHCq_o.png" width="82"></p> 
<p style="margin-left:.0001pt;text-align:justify;">2.创建一个工程</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="125" src="https://images2.imgbox.com/e9/cd/nJ7OSZDl_o.png" width="287"></p> 
<p style="margin-left:.0001pt;text-align:justify;">3.给该工程命名</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="428" src="https://images2.imgbox.com/e6/b2/IvUiPypO_o.png" width="554"></p> 
<p style="margin-left:.0001pt;text-align:justify;">4.在main.py里面黏贴如下的代码</p> 
<pre><code class="language-python"># This is a sample Python script.
# Press Shift+F10 to execute it or replace it with your code.
# Press Double Shift to search everywhere for classes, files, tool windows, actions, and settings.
import serial
import threading
import time

from tkinter import *
from tkinter.ttk import *
from tkinter import messagebox

def open_serial(a,b,c,d,e):
    global ser
    print("串口号:",a)
    print("波特率:",int(b))
    print("数据位:",c)
    print("停止位:",d)
    print("检验位:",e)

    bytesize = serial.EIGHTBITS
    if c == '7':
        bytesize = serial.SEVENBITS
        print("select SEVENBITS")
    if c == '6':
        bytesize = serial.SIXBITS
        print("select SIXBITS")
    if c == '5':
        bytesize = serial.FIVEBITS
        print("select FIVEBITS")

    stopbitsize = serial.STOPBITS_ONE
    if d == '2':
        stopbitsize = serial.STOPBITS_TWO
        print("select STOPBITS_TWO")

    paritysel = serial.PARITY_NONE
    if e == 'Odd':
        paritysel = serial.PARITY_ODD
        print("select Odd")
    if e == 'Even':
        paritysel = serial.PARITY_EVEN
        print("select EVEN")

    ser=serial.Serial(port=a,baudrate=int(b),bytesize=bytesize,stopbits=stopbitsize,parity=paritysel,timeout=0.5)
 #   ser = serial.Serial('COM4', 9600, timeout=1)

def print_hi(name):
    # Use a breakpoint in the code line below to debug your script.
    print(f'Hi, {name}')  # Press Ctrl+F8 to toggle the breakpoint.

def print_log(log):
    time_start = time.time()
    date = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime())
    print(f'{date}-{log}')

def recv_hander():
    while 1:
         if ser.is_open:
            data = ser.read(1024).decode('gbk')
            print_log(data)
            msgshow.insert(END, data)

def create_recv_thread():
    global th
    th = threading.Thread(target=recv_hander)
    th.setDaemon(True)
    th.start()

def msg_send():
    msg = msginp.get()
    print_log(f'send==&gt;{msg}')
    if ser.is_open:
        ser.write(msg.encode('gbk'))

def open_com():
    print_log("open com")
    com_val = comnum.get()
    baud_val = baud.get()  # 获取当前选定项目的值
    databit_val = databit.get()
    stopbit_var = stopbit.get()
    parity_var = parity.get()
    print(com_val)
    print(baud_val)

    open_serial(com_val, baud_val, databit_val, stopbit_var, parity_var)
    if ser.is_open:
        messagebox.showinfo("标题","串口打开成功")
        create_recv_thread()

def close_com():
    print_log("close com")
    if ser.is_open:
        ser.close()

# Press the green button in the gutter to run the script.
if __name__ == '__main__':
    print_hi('PyCharm')

    root = Tk()
    root.geometry('768x512')
    root.title('串口工具')

    comnumvar = StringVar()
    baudvar = StringVar()
    databitvar = StringVar()
    stopbitvar = StringVar()
    parityvar = StringVar()

    lb_com = Label(root, text='串口号')
    lb_com.place(relx=0.01, rely=0.05, relwidth=0.1, relheight=0.1)
    comnum = Combobox(root, textvariable=comnumvar, values=['COM1', 'COM2', 'COM3', 'COM4', ])
    comnum.place(relx=0.08, rely=0.075, relwidth=0.1)
    comnum.current(3)

    lb_baud = Label(root, text='波特率')
    lb_baud.place(relx=0.01, rely=0.12, relwidth=0.1, relheight=0.1) #add 0.045
    baud = Combobox(root, textvariable=baudvar, values=['115200', '38400', '9600', '4800', ])
    baud.place(relx=0.08, rely=0.145, relwidth=0.1) #add 0.025
    baud.current(2)

    lb_databit = Label(root, text='数据位')
    lb_databit.place(relx=0.01, rely=0.19, relwidth=0.1, relheight=0.1)  #add 0.045
    databit = Combobox(root, textvariable=databitvar, values=['8', '7', '6', '5', ])
    databit.place(relx=0.08, rely=0.215, relwidth=0.1)     #add 0.025
    databit.current(0)

    lb_stopbit = Label(root, text='停止位')
    lb_stopbit.place(relx=0.01, rely=0.26, relwidth=0.1, relheight=0.1)
    stopbit = Combobox(root, textvariable=stopbitvar, values=['1', '2', ])
    stopbit.place(relx=0.08, rely=0.285, relwidth=0.1)
    stopbit.current(0)

    lb_parity = Label(root, text='校验位')
    lb_parity.place(relx=0.01, rely=0.33, relwidth=0.1, relheight=0.1)
    parity = Combobox(root, textvariable=parityvar, values=['None','Odd','Even',])
    parity.place(relx=0.08, rely=0.355, relwidth=0.1)
    parity.current(0)

    btnopen = Button(root, text='打开串口', command=open_com)
    btnopen.place(relx=0.01, rely=0.45, relwidth=0.1, relheight=0.05)

    btnclose = Button(root, text='关闭串口', command=close_com)
    btnclose.place(relx=0.12, rely=0.45, relwidth=0.1, relheight=0.05)

    lb1 = Label(root, text='串口数据接收')
    lb1.place(relx=0.25, rely=0.05, relwidth=0.7, relheight=0.1)

    msgshow = Text(root)
    msgshow.place(relx=0.25, rely=0.15, relwidth=0.7, relheight=0.3)

    lb2 = Label(root, text='串口数据发送')
    lb2.place(relx=0.25, rely=0.45, relwidth=0.7, relheight=0.1)
    msginp = Entry(root)
    msginp.place(relx=0.25, rely=0.55, relwidth=0.7, relheight=0.1)

    btnsend = Button(root, text='发送', command=msg_send)
    btnsend.place(relx=0.35, rely=0.86, relwidth=0.3, relheight=0.1)

    root.mainloop()

# See PyCharm help at https://www.jetbrains.com/help/pycharm/</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">5.执行脚本</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="105" src="https://images2.imgbox.com/d8/ba/XWNIsWxu_o.png" width="340"></p> 
<p style="margin-left:.0001pt;text-align:justify;">6.如果有提示“No module named 'serial”，需要安装 pyserial，在终端命令行输入：pip install pyserial，如下图所示：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="75" src="https://images2.imgbox.com/84/e6/07kT9CSb_o.png" width="554"></p> 
<p style="margin-left:.0001pt;text-align:justify;">7.在windows下安装一对虚拟串口，可以下载vspd安装，最终结果如下所示：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="71" src="https://images2.imgbox.com/87/40/AsNhGgQL_o.png" width="358"></p> 
<p style="margin-left:.0001pt;text-align:justify;">8.使用第三方工具进行数据互发测试</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="205" src="https://images2.imgbox.com/03/e5/EmMKnGXk_o.png" width="554"></p> 
<p style="margin-left:.0001pt;text-align:justify;">9.将该工具打包成exe可执行文件</p> 
<p style="margin-left:.0001pt;text-align:justify;">在命令行终端输入：python -m pysimplegui-exemaker.pysimplegui-exemaker</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="417" src="https://images2.imgbox.com/cf/5d/48Y0naoh_o.png" width="554"></p> 
<p style="margin-left:.0001pt;text-align:justify;">最后点击“Make EXE”，生成如下所示的exe文件</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="413" src="https://images2.imgbox.com/ae/f6/1aNOfgvU_o.png" width="554"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e1cab2616ab3861395b9c82d029191cd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Wddm内存段翻译</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3797f30d1c536c545ff5a8c8266717b5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">React中简单实现路由守卫（主要演示其原理）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>