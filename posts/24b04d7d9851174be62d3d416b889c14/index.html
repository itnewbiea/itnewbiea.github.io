<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在Ubuntu系统下安装Gitlab，搭建实验室自己的代码托管平台 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="在Ubuntu系统下安装Gitlab，搭建实验室自己的代码托管平台" />
<meta property="og:description" content="在Ubuntu系统下安装Gitlab，搭建实验室自己的代码托管平台 一、安装Docker 1.使用管理员用户运行 curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun
这里配置了镜像源
其他安装方式和操作参考菜鸟教程菜鸟教程
2.创建gitlab文件夹
打开路径 cd /home/用户名
创建文件夹mkir gitlab
可以使用docker -v查看docker版本
二、拉取镜像 搜索Docker官方网址，进入注册页面注册好后，在搜索栏搜索Gitlab，找到星标最多的那个项目
复制拉取代码 docker pull gitlab/gitlab-runner默认应该为最新版本
出现一串长数字和字母即为成功
三、运行Gitlab镜像 $ docker run -d -p 443:443 -p 80:80 -p 222:22 --name gitlab --restart always -v /home/gitlab/config:/etc/gitlab -v /home/gitlab/logs:/var/log/gitlab -v /home/gitlab/data:/var/opt/gitlab gitlab/gitlab-ce # -d：后台运行 # -p：将容器内部端口向外映射 # --name：命名容器名称 # -v：将容器内数据文件夹或者日志、配置等文件夹挂载到宿主机指定目录 运行成功出现一片数字
注：可以在此处配置端口设置，例如不想80被占用，可以在第一个80位置改为8080 例如 -p 80:80
四、配置 按上面的方式，gitlab容器运行没问题，但在gitlab上创建项目的时候，生成项目的URL访问地址是按容器的hostname来生成的，也就是容器的id。作为gitlab服务器，我们需要一个固定的URL访问地址，于是需要配置gitlab.rb
# gitlab.rb文件内容默认全是注释 $ vim /home/gitlab/config/gitlab." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/24b04d7d9851174be62d3d416b889c14/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-01T20:31:35+08:00" />
<meta property="article:modified_time" content="2021-12-01T20:31:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在Ubuntu系统下安装Gitlab，搭建实验室自己的代码托管平台</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="UbuntuGitlab_0"></a>在Ubuntu系统下安装Gitlab，搭建实验室自己的代码托管平台</h2> 
<h3><a id="Docker_1"></a>一、安装Docker</h3> 
<p>1.使用管理员用户运行 <code>curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun</code><br> 这里配置了镜像源<br> 其他安装方式和操作参考菜鸟教程<a href="https://www.runoob.com/docker/ubuntu-docker-install.html" rel="nofollow">菜鸟教程</a><br> 2.创建gitlab文件夹<br> 打开路径 <code>cd /home/用户名</code><br> 创建文件夹<code>mkir gitlab</code></p> 
<p>可以使用docker -v查看docker版本</p> 
<h3><a id="_10"></a>二、拉取镜像</h3> 
<p>搜索Docker官方网址，进入注册页面注册好后，在搜索栏搜索Gitlab，找到星标最多的那个项目<br> <img src="https://images2.imgbox.com/21/47/DzxmHfg6_o.png" alt="Gitlab地址"><br> 复制拉取代码 <code>docker pull gitlab/gitlab-runner</code>默认应该为最新版本<br> <img src="https://images2.imgbox.com/e5/84/dMcsROBA_o.png" alt="在这里插入图片描述"><br> 出现一串长数字和字母即为成功</p> 
<h3><a id="Gitlab_16"></a>三、运行Gitlab镜像</h3> 
<pre><code class="prism language-bash">$ docker run -d  -p <span class="token number">443</span>:443 -p <span class="token number">80</span>:80 -p <span class="token number">222</span>:22 --name gitlab --restart always -v /home/gitlab/config:/etc/gitlab -v /home/gitlab/logs:/var/log/gitlab -v /home/gitlab/data:/var/opt/gitlab gitlab/gitlab-ce
<span class="token comment"># -d：后台运行</span>
<span class="token comment"># -p：将容器内部端口向外映射</span>
<span class="token comment"># --name：命名容器名称</span>
<span class="token comment"># -v：将容器内数据文件夹或者日志、配置等文件夹挂载到宿主机指定目录</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/03/75/In3Rz67Z_o.png" alt="在这里插入图片描述"><br> 运行成功出现一片数字</p> 
<p>注：可以在此处配置端口设置，例如不想80被占用，可以在第一个80位置改为8080 例如 -p 80:80</p> 
<h3><a id="_29"></a>四、配置</h3> 
<p>按上面的方式，gitlab容器运行没问题，但在gitlab上创建项目的时候，生成项目的URL访问地址是按容器的hostname来生成的，也就是容器的id。作为gitlab服务器，我们需要一个固定的URL访问地址，于是需要配置gitlab.rb</p> 
<pre><code class="prism language-bash"><span class="token comment"># gitlab.rb文件内容默认全是注释</span>
$ <span class="token function">vim</span> /home/gitlab/config/gitlab.rb
</code></pre> 
<pre><code class="prism language-bash"><span class="token comment"># 配置http协议所使用的访问地址,不加端口号默认为80</span>
external_url <span class="token string">'http://自己ip地址'</span>

<span class="token comment"># 配置ssh协议所使用的访问地址和端口</span>
gitlab_rails<span class="token punctuation">[</span><span class="token string">'gitlab_ssh_host'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'自己ip地址'</span>
gitlab_rails<span class="token punctuation">[</span><span class="token string">'gitlab_shell_ssh_port'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">222</span> <span class="token comment"># 此端口是run时22端口映射的222端口</span>
:wq <span class="token comment">#保存配置文件并退出</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token comment"># 重启gitlab容器</span>
$ docker restart gitlab
</code></pre> 
<p>此时项目的仓库地址就变了。如果ssh端口地址不是默认的22，就会加上ssh:// 协议头<br> 打开浏览器输入ip地址(因为我的gitlab端口为80，所以浏览器url不用输入端口号，如果端口号不是80，则打开为：ip:端口号)</p> 
<p>可以使用<code>docker ps</code><br> <img src="https://images2.imgbox.com/a8/f9/JZE2Hwsw_o.png" alt="在这里插入图片描述"><br> 查看运行中的docker实例 以及端口配置情况<br> 使用<code>docker logs -f f0ff8417ad5e</code>查看日志信息<br> 等待一段时间之后可以用ip地址+端口号访问</p> 
<h3><a id="_59"></a>五、初次登录设置</h3> 
<p>gitlab-ce-14初装以后，把密码放在了一个临时文件中了</p> 
<pre><code class="prism language-bash">/home/用户名/gitlab/initial_root_password
</code></pre> 
<p>这个文件将在首次执行reconfigure后24小时自动删除<br> 用ls查看不到这个文件的话</p> 
<pre><code class="prism language-bash"> docker <span class="token builtin class-name">exec</span> -it gitlab /bin/bash
</code></pre> 
<p>具体内容如下，复制后在网页用root登录，尽快修改密码</p> 
<pre><code class="prism language-bash">Notes:
Default admin account has been configured with following details:
Username: root
Password: You didn<span class="token string">'t opt-in to print initial root password to STDOUT.
Password stored to /etc/gitlab/initial_root_password. This file will be cleaned up in first reconfigure run after 24 hours.

NOTE: Because these credentials might be present in your log files in plain text, it is highly recommended to reset the password following https://docs.gitlab.com/ee/security/reset_user_password.html#reset-your-root-password.

gitlab Reconfigured!
[root@c7-192 src]# cat /etc/gitlab/initial_root_password
# WARNING: This value is valid only in the following conditions
#          1. If provided manually (either via <span class="token variable"><span class="token variable">`</span>GITLAB_ROOT_PASSWORD<span class="token variable">`</span></span> environment variable or via <span class="token variable"><span class="token variable">`</span>gitlab_rails<span class="token punctuation">[</span><span class="token string">'initial_root_password'</span><span class="token punctuation">]</span><span class="token variable">`</span></span> setting in <span class="token variable"><span class="token variable">`</span>gitlab.rb<span class="token variable">`</span></span>, it was provided before database was seeded for the first time (usually, the first reconfigure run).
#          2. Password hasn'</span>t been changed manually, either via UI or via <span class="token builtin class-name">command</span> line.
<span class="token comment">#</span>
<span class="token comment">#          If the password shown here doesn't work, you must reset the admin password following https://docs.gitlab.com/ee/security/reset_user_password.html#reset-your-root-password.</span>

Password: <span class="token assign-left variable">thAXLJhVoo6V9sRvRH5HrLrD5rg88C7gccEGZDT4Lq0</span><span class="token operator">=</span>

<span class="token comment"># NOTE: This file will be automatically deleted in the first reconfigure run after 24 hours.</span>

</code></pre> 
<h3><a id="_96"></a>六、总结</h3> 
<p><img src="https://images2.imgbox.com/08/c6/0GNLQV1l_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>https://www.cnblogs.com/chuanqi1995/p/11445450.html<br> https://www.jianshu.com/p/080a962c35b6<br> https://blog.csdn.net/timonium/article/details/119451755<br> https://www.cnblogs.com/xiaoyingzhanchi/p/14283044.html</p> 
</blockquote>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9ccc4a24b4b24eee139280d82b47cea4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【MBP】苹果电脑使用SFTP无法可视化连接服务器的解决过程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9d374bf4f2860a29d99796dec32bd885/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">sql 函数 if 和 ifnull</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>