<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>VSCode调试C/C&#43;&#43;项目 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="VSCode调试C/C&#43;&#43;项目" />
<meta property="og:description" content="最近写完了自己的操作系统，深感有一个方便的调试环境是有多么重要，能够提升不少开发效率。恰好最近在的技术交流群里群友在问如何搭建VSCode调试操作系统的环境，刚考完试，就先把这篇VSCode调试C/C&#43;&#43;的通用教程发出来，而后针对VSCode调试操作系统的特定环境的教程稍后再发出来 VSCode调试C/C&#43;&#43;项目 VS Code作为宇宙第一编辑器，在众多插件的加持下，具有了调试、单元测试等等功能，使其越来越像一个IDE。
然而很多人其实并不会使用VS Code的调试功能，只是把VS Code当做了一个带有语法补全的编辑器。这实际上极大地浪费了VS Code的功能，尤其是对于C/C&#43;&#43;开发者来说，使用命令行的GDB调试远不如使用VS Code内嵌的GDB图形化界面调试来的舒服。
本文就讲介绍如何使用VS Code调试C/C&#43;&#43;项目
1. 概述 通常我们在调试一个C/C&#43;&#43;工程的时候，大体上的流程可以分为两步：
启动调试器（GDB）前的准备工作启动调试器（GDB）进行调试 例如对于一个CMake组织的C/C&#43;&#43;项目，这两大步具体包含的流程如下（编写CMakeLists.txt是在编码阶段，编码是与调试独立的阶段）：
启动调试器（GDB）前的准备工作 创建build文件夹：mkdir -p build切换到build文件夹：cd build配置（Configure）项目：cmake .. &lt;option&gt;构建/编译（Build）项目：make 启动调试器（GDB）进行调试 启动调试器：gdb &lt;path-to-executable 对于不同的项目（npm项目、C#项目、java项目等等），可能在启动调试器前的准备工作不同，但是大体上都可以分为进行调试前需要进行的一系列任务，以及结合具体参数启动时调试器
因此，对于这两个阶段，VSCode中提供了tasks.json和launch.json两个文件来分别描述调试前的准备工作以及以指定的参数启动调试器
2. 调试前的准备工作：tasks.json VSCode使用tasks.json来描述启动调试前的准备工作。
A. tasks.json的结构 tasks.json的结构一般如下
{ &#34;version&#34;: &#34;2.0.0&#34;, &#34;tasks&#34;: [ ], &#34;inputs&#34;: [ ] } B. version标签 version标签指定了Tasks.json的版本，因为不同的版本支持的标签不一样，所以需要使用version标签指明版本。
目前version支持2.0.0版本，所以直接指定version为2.0.0即可。
C. tasks标签 tasks标签是一个列表，我们在其中定义不同的task，而关于具体的task如何定义则见下
我们以创建build文件夹这个任务为例
{ &#34;label&#34;: &#34;create dir&#34;, &#34;type&#34;: &#34;shell&#34;, &#34;command&#34;: &#34;mkdir&#34;, &#34;args&#34;: [ &#34;-p&#34;, &#34;build&#34; ], &#34;windows&#34;: { &#34;args&#34;: [ &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/133dd8d787a34046a58e4f0d3186f753/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-22T23:14:22+08:00" />
<meta property="article:modified_time" content="2022-12-22T23:14:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">VSCode调试C/C&#43;&#43;项目</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="VSCodeVSCodeCCVSCode_0"></a>最近写完了自己的操作系统，深感有一个方便的调试环境是有多么重要，能够提升不少开发效率。恰好最近在的技术交流群里群友在问如何搭建VSCode调试操作系统的环境，刚考完试，就先把这篇VSCode调试C/C++的通用教程发出来，而后针对VSCode调试操作系统的特定环境的教程稍后再发出来</h3> 
<hr> 
<p><img src="https://images2.imgbox.com/4d/9e/zl79wWCO_o.png" alt="使用VSCode来调试C/C++工程"></p> 
<h2><a id="VSCodeCC_9"></a>VSCode调试C/C++项目</h2> 
<p>VS Code作为宇宙第一编辑器，在众多插件的加持下，具有了调试、单元测试等等功能，使其越来越像一个IDE。</p> 
<p>然而很多人其实并不会使用VS Code的调试功能，只是把VS Code当做了一个带有语法补全的编辑器。这实际上极大地浪费了VS Code的功能，尤其是对于C/C++开发者来说，使用命令行的GDB调试远不如使用VS Code内嵌的GDB图形化界面调试来的舒服。</p> 
<p>本文就讲介绍如何使用VS Code调试C/C++项目</p> 
<h3><a id="1__21"></a>1. 概述</h3> 
<p>通常我们在调试一个C/C++工程的时候，大体上的流程可以分为两步：</p> 
<ul><li><strong>启动调试器（GDB）前的准备工作</strong></li><li><strong>启动调试器（GDB）进行调试</strong></li></ul> 
<p>例如对于一个<code>CMake</code>组织的C/C++项目，这两大步具体包含的流程如下（编写<code>CMakeLists.txt</code>是在编码阶段，编码是与调试独立的阶段）：</p> 
<ul><li><strong>启动调试器（GDB）前的准备工作</strong> 
  <ol><li>创建<code>build</code>文件夹：<code>mkdir -p build</code></li><li>切换到<code>build</code>文件夹：<code>cd build</code></li><li>配置（Configure）项目：<code>cmake .. &lt;option&gt;</code></li><li>构建/编译（Build）项目：<code>make</code></li></ol> </li><li><strong>启动调试器（GDB）进行调试</strong> 
  <ol><li>启动调试器：<code>gdb &lt;path-to-executable</code></li></ol> </li></ul> 
<p>对于不同的项目（<code>npm</code>项目、<code>C#</code>项目、<code>java</code>项目等等），可能在启动调试器前的准备工作不同，但是大体上都可以分为进行调试前需要进行的一系列任务，以及结合具体参数启动时调试器</p> 
<p>因此，对于这两个阶段，VSCode中提供了<code>tasks.json</code>和<code>launch.json</code>两个文件来分别描述<code>调试前的准备工作</code>以及<code>以指定的参数启动调试器</code></p> 
<h3><a id="2_tasksjson_48"></a>2. 调试前的准备工作：tasks.json</h3> 
<p>VSCode使用<code>tasks.json</code>来描述启动调试前的准备工作。</p> 
<h4><a id="A_tasksjson_54"></a>A. tasks.json的结构</h4> 
<p><code>tasks.json</code>的结构一般如下</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"2.0.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"tasks"</span><span class="token operator">:</span> <span class="token punctuation">[</span>

    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">"inputs"</span><span class="token operator">:</span> <span class="token punctuation">[</span>

    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d1/ad/Om1tdoKf_o.png" alt="tasks.json的一般结构"></p> 
<h4><a id="B__version_74"></a>B. version标签</h4> 
<p><code>version</code>标签指定了<code>Tasks.json</code>的版本，因为不同的版本支持的标签不一样，所以需要使用<code>version</code>标签指明版本。</p> 
<p>目前<code>version</code>支持<code>2.0.0</code>版本，所以直接指定<code>version</code>为<code>2.0.0</code>即可。</p> 
<h4><a id="C_tasks_84"></a>C. tasks标签</h4> 
<p><code>tasks</code>标签是一个列表，我们在其中定义不同的<code>task</code>，而关于具体的<code>task</code>如何定义则见下</p> 
<p>我们以创建<code>build</code>文件夹这个任务为例</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
		<span class="token string-property property">"label"</span><span class="token operator">:</span> <span class="token string">"create dir"</span><span class="token punctuation">,</span>
		<span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"shell"</span><span class="token punctuation">,</span>
		<span class="token string-property property">"command"</span><span class="token operator">:</span> <span class="token string">"mkdir"</span><span class="token punctuation">,</span>
		<span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		    <span class="token string">"-p"</span><span class="token punctuation">,</span>
		    <span class="token string">"build"</span>
		<span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token string-property property">"windows"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
		    <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		        <span class="token string">"-Force"</span><span class="token punctuation">,</span>
		        <span class="token string">"build"</span>
		    <span class="token punctuation">]</span><span class="token punctuation">,</span>
		    <span class="token string-property property">"options"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
		        <span class="token string-property property">"shell"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
		            <span class="token string-property property">"executable"</span><span class="token operator">:</span> <span class="token string">"powershell.exe"</span>
		        <span class="token punctuation">}</span>
		    <span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="1_label_115"></a>1) label标签</h5> 
<p><code>label</code>标签定义了一个任务的名字，稍后我们能用通过名字取定位一个任务，从而实现诸如将多个任务合并为一个组，而后执行一组任务这样的操作。</p> 
<p><code>label</code>标签的值是随我们自己喜欢，想写什么就写什么的。</p> 
<h5><a id="2_type_123"></a>2) type标签</h5> 
<p><code>type</code>标签指定了一个任务的类型。所有的任务大致上可以分为两类：</p> 
<ul><li>第一类就是在<code>Shell</code>中执行的命令，值为<code>shell</code></li><li>第二类就是一个进程，例如我们写的程序是操作<code>MySQL</code>数据库的程序，那么就需要在调试前启动<code>MySQL</code>数据库，则此时<code>MySQL</code>数据库就是进程形式的任务。进程形式的任务的值为<code>process</code></li></ul> 
<h5><a id="3__command_132"></a>3 ) command标签</h5> 
<p><code>command</code>标签指定了需要执行的命令或者程序。</p> 
<ul><li>如果是<code>Shell</code>中的命令的话，那么<code>command</code>的值为需要执行的命令。</li><li>如果是进程的话，那么<code>command</code>的值为需要执行的可执行程序的位置，可执行程序可以是有x权限的<code>.sh</code>，也可以是<code>.exe</code>等可执行程序。</li></ul> 
<h5><a id="4__args_141"></a>4 ) args标签</h5> 
<p><code>args</code>标签指定了执行的命令或者程序时传入的命令行参数。在具体执行的时候会把多个参数用空格连接起来而后执行。</p> 
<p>结合<code>command</code>标签，我们执行的命令就是下面这句话</p> 
<pre><code class="prism language-shell"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> build
</code></pre> 
<h5><a id="5__windows_153"></a>5 ) windows标签</h5> 
<p><code>windows</code>标签指定了只有在<code>windows</code>系统上的配置。我们在<code>windows</code>标签中指定了两个标签<code>options</code>标签和<code>args</code>标签。</p> 
<ul><li> <p>对于<code>args</code>标签就意味着在其他系统（<code>Linux</code>/<code>MacOS</code>）上，使用<code>-p build</code>作为命令行参数，而在<code>Windows</code>系统上，使用<code>-Force build</code>作为命令行参数。</p> <p>这是因为在<code>Linux</code>/<code>MacOS</code>系统上，创建一个文件夹使用下面的命令就行了</p> <pre><code class="prism language-shell"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> 文件夹名
</code></pre> <p>但是在<code>Windows</code>平台上，创建一个文件夹需要使用下面的命令</p> <pre><code class="prism language-powershell">mkdir <span class="token operator">-</span>Force 文件夹名
</code></pre> </li><li> <p>对于<code>options</code>标签就意味着只有在<code>Windows</code>平台上才会有这个标签。</p> </li></ul> 
<h5><a id="6__options_177"></a>6 ) options标签</h5> 
<p><code>options</code>标签指明了运行命令的<code>shell</code>的位置（<code>shell</code>标签）、运行命令的环境变量（<code>env</code>标签）以及运行命令的文件夹（<code>cwd</code>标签）。当然这里只用了<code>shell</code>这一个标签。</p> 
<p>使用<code>shell</code>标签的原因是因为在<code>Windows</code>上有两个命令行，一个是<code>cmd</code>一个是<code>powershell</code>。而<code>mkdir</code>这个命令是在<code>powershell</code>中的，因此我们需要特殊指明在<code>Windwos</code>上需要使用<code>powershell.exe</code>作为Shell的解释器</p> 
<h4><a id="D_input_187"></a>D. input标签</h4> 
<p><code>input</code>标签用于生成一个选项卡，接收用户的输入，一般是和<code>args</code>标签一起使用我们稍后再讲解这个标签的用法。</p> 
<h3><a id="3_launchjson_197"></a>3. 启动调试器：launch.json</h3> 
<h4><a id="A_launchjson_199"></a>A. launch.json的结构</h4> 
<p><code>launch.json</code>的结构一般如下</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 使用 IntelliSense 了解相关属性。 </span>
    <span class="token comment">// 悬停以查看现有属性的描述。</span>
    <span class="token comment">// 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387</span>
    <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"0.2.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"configurations"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"gdb"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"GDB"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"program"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}/${command:AskForProgramName}"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"stopOnEntry"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token string-property property">"arguments"</span><span class="token operator">:</span> <span class="token string">""</span>，
            <span class="token string-property property">"preLaunchTask"</span><span class="token operator">:</span> <span class="token string">""</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0b/1f/QfkfsX20_o.png" alt="launch.json的结构"></p> 
<h4><a id="B_version_231"></a>B. version标签</h4> 
<p><code>launch.json</code>中的<code>version</code>标签和<code>tasks.json</code>中的<code>version</code>标签作用是一样的，一般都用<code>0.2.0</code>。</p> 
<h4><a id="C_configuration_241"></a>C. configuration标签</h4> 
<p><code>configuration</code>标签中定义了开始启动调试器时候的具体的配置信息。具体来说，可以有多套配置信息。即<code>configuration</code>标签下可以有多个条目。</p> 
<h5><a id="1__name_249"></a>1 ) name标签</h5> 
<p><code>name</code>标签定义了一套配置信息的名称，这个名称稍后可以在左边的<code>运行与调试</code>页面中看到。</p> 
<p><img src="https://images2.imgbox.com/20/86/uq9fNhyy_o.png" alt="name定义调试的配置名称，可以在运行与调试界面选择需要运行的配置"></p> 
<h5><a id="2__type_259"></a>2 ) type标签</h5> 
<p><code>type</code>标签指定了调试时启动的调试器：</p> 
<ul><li> <p>对于<code>C/C++</code>项目来说，<code>type</code>的值指定为<code>cppdbg</code>或者是<code>cppvsdbg</code></p> 
  <ul><li>在<code>Windows</code>上开发一般用的编译器都是<code>Visual Studio</code>中自带的<code>msvc</code>编译器，适用的调试器也是<code>Visual Studio</code>自带的，此时就需要把值设为<code>cppvsdbg</code></li><li>``Linux<code>上用的一般都是</code>gcc<code>，</code>MacOS<code>上用的编译器一般都是</code>clang<code>，对应的调试器分别是</code>gdb<code>和</code>lldb<code>，此时需要把值设为</code>cppdbg</li></ul> </li><li> <p>对于<code>Python</code>项目来说，<code>type</code>的值指定为<code>python</code>，因为<code>python</code>解释器自带了<code>pdb</code>这个调试器</p> </li><li> <p>…</p> </li></ul> 
<p>剩下的具体查询手册：https://code.visualstudio.com/docs</p> 
<h5><a id="3__request_276"></a>3 ) request标签</h5> 
<p><code>request</code>标签指明了调试器调试程序的方式。具体来说有两种：</p> 
<ul><li><code>launch</code>：表示调试器直接启动程序进行调试，类似于使用命令<code>gdb helloworld</code>，将会直接运行命令<code>helloworld</code></li><li><code>attach</code>：有时候，我们需要调试的程序运行在远程服务器上，此时在服务器上已经运行了一个<code>gdb</code>，而且服务器上的<code>gdb</code>把调试服务暴露在某一个端口上，此时我们在本机上运行<code>gdb</code>的时候，通过链接远程服务器该端口，从而实现用本地的<code>gdb</code>调试远程服务器上的程序。<strong>此时，远程服务器上的<code>gdb</code>称为<code>gdb server</code></strong>。这种调试方式称为<code>attach</code>，即把调试器附加到一个<code>gdb server</code>上去。</li></ul> 
<p>一般在本机做调试的时候值都是<code>launch</code>。</p> 
<h5><a id="4__program_289"></a>4 ) program标签</h5> 
<p><code>program</code>标签指定了我们需要调试的程序。注意，如果<code>request</code>标签的值是<code>attach</code>的话，那么就不能使用<code>program</code>标签。</p> 
<h5><a id="5__workspaceFolder_297"></a>5 ) workspaceFolder宏</h5> 
<p><code>CMake</code>中有<code>EXECUTABLE_OUTPUT_PATH</code>宏，我们可以指定<code>EXECUTABLE_OUTPUT_PATH</code>宏的值从而指定可执行文件输出的路径，也可以通过<code>${}</code>来读取<code>EXECUTABLE_OUTPUT_PATH</code>宏的值来打印到屏幕上或者用于为其他宏赋值。</p> 
<p>类似的，<code>VSCode</code>中也有功能类似的宏，<code>workspaceFolder</code>这个宏就表示了当前打开的目录。我们也可以使用<code>${}</code>来获取这个宏的值。</p> 
<h5><a id="6__commandAskForProgramName_307"></a>6 ) command:AskForProgramName</h5> 
<p><code>command:AskForProgramName</code>这个宏的作用就是在程序运行的时候在上面弹出来一个选项卡，询问用户需要调试的程序的名字。</p> 
<p>例如我们直接对着<code>launch.json</code>这个程序按下<code>F5</code>，然后就会弹出来一个选项卡让我们输入需要调试的程序的名字</p> 
<p><img src="https://images2.imgbox.com/03/f8/Pe26rJkk_o.png" alt="VSCode弹出选项卡要求用户输入程序的名字"></p> 
<h5><a id="7__stopAtEntry_319"></a>7 ) stopAtEntry标签</h5> 
<p><code>stopAtEntry</code>标签表示在进入到主程序之后就会停下来，对于<code>C/C++</code>来说就是在进入<code>main</code>之后就停下来。</p> 
<p>但是一般我们都是打上断点，然后直接运行到断点处，所以这个<code>stopAtEntry</code>的值一般用的都是<code>false</code>。</p> 
<h5><a id="8__Arguments_329"></a>8 ) Arguments标签</h5> 
<p>这个标签我没用过，所以我也搞不清楚，如果要传参的给程序的话，用<code>args</code>标签</p> 
<h5><a id="9__preLaunchTask_337"></a>9 ) preLaunchTask标签</h5> 
<p><code>preLaunchTask</code>标签可以说是最重要的标签之一，它沟通了<code>launch.json</code>和<code>tasks.json</code>这两个文件。</p> 
<p>前面我们在<code>tasks.json</code>中定义了一系列任务，而<code>launch.json</code>中的这个标签说明了在启动调试器前需要执行的<code>tasks.json</code>中的那个任务。</p> 
<p>所以利用这个标签，我们就可以实现从调试前的准备工作再到启动调试器这一连串的任务。</p> 
<h3><a id="4_Toy_Example_echo__355"></a>4. 一个Toy Example: echo 宏</h3> 
<p>下面展示一个Toy Example来展示<code>tasks.json</code>和<code>launch.json</code>的workflow</p> 
<h4><a id="A_tasksjson_361"></a>A. tasks.json的内容</h4> 
<p>Toy Example中<code>tasks.json</code>的内容如下</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"2.0.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"tasks"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"label"</span><span class="token operator">:</span> <span class="token string">"example"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"command"</span><span class="token operator">:</span> <span class="token string">"echo"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"${file}\n"</span><span class="token punctuation">,</span>
                <span class="token string">"${fileBasename}\n"</span><span class="token punctuation">,</span>
                <span class="token string">"${fileBasenameNoExtension}\n"</span><span class="token punctuation">,</span>
                <span class="token string">"${fileDirname}\n"</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>具体来说我们就是想要执行一下下面的命令</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">${file}</span><span class="token entity" title="\n">\n</span>"</span> <span class="token string">"<span class="token variable">${fileBasename}</span><span class="token entity" title="\n">\n</span>"</span> <span class="token string">"<span class="token variable">${fileBasenameNoExtension}</span><span class="token entity" title="\n">\n</span>"</span> <span class="token string">"<span class="token variable">${fileDirname}</span><span class="token entity" title="\n">\n</span>"</span>
</code></pre> 
<p>主要是看一看这四个宏的值分别是什么</p> 
<h4><a id="B_launchjson_395"></a>B. launch.json的内容</h4> 
<p>Toy Example中<code>lauch.json</code>的内容如下</p> 
<pre><code class="prism language-shell"><span class="token punctuation">{<!-- --></span>
    // 使用 IntelliSense 了解相关属性。 
    // 悬停以查看现有属性的描述。
    // 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid<span class="token operator">=</span><span class="token number">830387</span>
    <span class="token string">"version"</span><span class="token builtin class-name">:</span> <span class="token string">"0.2.0"</span>,
    <span class="token string">"configurations"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string">"type"</span><span class="token builtin class-name">:</span> <span class="token string">"gdb"</span>,
            <span class="token string">"request"</span><span class="token builtin class-name">:</span> <span class="token string">"launch"</span>,
            <span class="token string">"name"</span><span class="token builtin class-name">:</span> <span class="token string">"Toy Example"</span>,
            <span class="token string">"program"</span><span class="token builtin class-name">:</span> <span class="token string">"<span class="token variable">${workspaceFolder}</span>/<span class="token variable">${file}</span>"</span>,
            <span class="token string">"stopOnEntry"</span><span class="token builtin class-name">:</span> true,
            <span class="token string">"preLaunchTask"</span><span class="token builtin class-name">:</span> <span class="token string">"example"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>具体来说就是在启动调试器之前运行一下上面定义的<code>example</code>这个task。</p> 
<h4><a id="C_hello_worldc_424"></a>C. hello_world.c</h4> 
<p>我们接下来写一个<code>hello_world.c</code>，里面的内容如下：</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> argc<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello World!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="D__443"></a>D. 开始调试</h4> 
<p>首先在<code>运行和调试</code>界面把调试的配置选定为<code>Toy Example</code>，然后编辑器打开<code>hello_world.c</code></p> 
<p><img src="https://images2.imgbox.com/c0/dd/JR4uarnb_o.png" alt="开始调试"></p> 
<p>接下来按<code>F5</code>开始调试</p> 
<p>此时我们在终端就能够看到执行的任务以及输出</p> 
<p><img src="https://images2.imgbox.com/ec/b7/cAMhRI7w_o.png" alt="执行的任务以及输出"></p> 
<p>很清楚就能看到，上面四个宏的值分别是</p> 
<pre><code class="prism language-json">$<span class="token punctuation">{<!-- --></span>file<span class="token punctuation">}</span>													<span class="token operator">:</span>		<span class="token operator">/</span>Users<span class="token operator">/</span>jack<span class="token operator">/</span>project<span class="token operator">/</span>test<span class="token operator">/</span>vscode_test<span class="token operator">/</span>hello_world<span class="token punctuation">.</span>c
$<span class="token punctuation">{<!-- --></span>fileBasename<span class="token punctuation">}</span>									<span class="token operator">:</span>		hello_world<span class="token punctuation">.</span>c
$<span class="token punctuation">{<!-- --></span>fileBasenameNoExtension<span class="token punctuation">}</span>			<span class="token operator">:</span>		hello_world
$<span class="token punctuation">{<!-- --></span>fileDirname<span class="token punctuation">}</span>									<span class="token operator">:</span>		<span class="token operator">/</span>Users<span class="token operator">/</span>jack<span class="token operator">/</span>project<span class="token operator">/</span>test<span class="token operator">/</span>vscode_test
</code></pre> 
<h3><a id="5_Toy_Example_478"></a>5. 一个Toy Example：编译文件</h3> 
<p>我们对上面的Toy Example进行修改，增加一个自动编译的功能</p> 
<h4><a id="A_tasksjson_484"></a>A. tasks.json的内容</h4> 
<p>我们给<code>tasks.json</code>新加一个task，即自动编译，此外我们修改一下输出宏的task</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"2.0.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"tasks"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"label"</span><span class="token operator">:</span> <span class="token string">"echo"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"command"</span><span class="token operator">:</span> <span class="token string">"echo"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"${file}\n"</span><span class="token punctuation">,</span>
                <span class="token string">"${pathSeparator}\n"</span><span class="token punctuation">,</span>
                <span class="token string">"${fileBasenameNoExtension}\n"</span><span class="token punctuation">,</span>
                <span class="token string">"${fileDirname}${pathSeparator}${fileBasenameNoExtension}.o\n"</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"label"</span><span class="token operator">:</span> <span class="token string">"build"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"command"</span><span class="token operator">:</span> <span class="token string">"gcc"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"${file}"</span><span class="token punctuation">,</span>
                <span class="token string">"-o"</span><span class="token punctuation">,</span>
                <span class="token string">"${fileDirname}${pathSeparator}${fileBasenameNoExtension}.o"</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="B_launchjson_517"></a>B. launch.json的内容</h4> 
<p>我们再给launch.json中新加一个配置信息</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 使用 IntelliSense 了解相关属性。 </span>
    <span class="token comment">// 悬停以查看现有属性的描述。</span>
    <span class="token comment">// 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387</span>
    <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"0.2.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"configurations"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"gdb"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"Echo Macros"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"program"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}/${file}"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"stopOnEntry"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token string-property property">"preLaunchTask"</span><span class="token operator">:</span> <span class="token string">"echo"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"gdb"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"Gcc Compile"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"program"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}${pathSeparator}${fileBasenameNoExtension}.o"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"stopAtEntry"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token string-property property">"preLaunchTask"</span><span class="token operator">:</span> <span class="token string">"build"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="C_Echo_Macros_550"></a>C. 运行Echo Macros</h4> 
<p>首先输出一下在<code>build</code>这个task中使用到的宏。</p> 
<p>具体来说在<code>运行和调试</code>界面选择配置为<code>Echo Macros</code></p> 
<p><img src="https://images2.imgbox.com/6c/4b/c7NebGgo_o.png" alt="选择配置为Echo Macros"></p> 
<p>然后按下<code>F5</code>开始运行</p> 
<p><img src="https://images2.imgbox.com/47/3d/bBHTPzQ6_o.png" alt="Echo Macros运行的结果"></p> 
<p>可以看到，上面四个宏的值是</p> 
<pre><code class="prism language-json">$<span class="token punctuation">{<!-- --></span>file<span class="token punctuation">}</span>																												<span class="token operator">:</span>		<span class="token operator">/</span>Users<span class="token operator">/</span>jack<span class="token operator">/</span>project<span class="token operator">/</span>test<span class="token operator">/</span>vscode_test<span class="token operator">/</span>hello_world<span class="token punctuation">.</span>c
$<span class="token punctuation">{<!-- --></span>pathSeparator<span class="token punctuation">}</span>																							<span class="token operator">:</span>		<span class="token operator">/</span>
$<span class="token punctuation">{<!-- --></span>fileBasenameNoExtension<span class="token punctuation">}</span>																		<span class="token operator">:</span>		hello_world
$<span class="token punctuation">{<!-- --></span>fileDirname<span class="token punctuation">}</span>$<span class="token punctuation">{<!-- --></span>pathSeparator<span class="token punctuation">}</span>$<span class="token punctuation">{<!-- --></span>fileBasenameNoExtension<span class="token punctuation">}</span><span class="token punctuation">.</span>o		<span class="token operator">:</span>		<span class="token operator">/</span>Users<span class="token operator">/</span>jack<span class="token operator">/</span>project<span class="token operator">/</span>test<span class="token operator">/</span>vscode_test<span class="token operator">/</span>hello_world<span class="token punctuation">.</span>o
</code></pre> 
<h4><a id="D_Gcc_Compile_579"></a>D. 运行Gcc Compile</h4> 
<p>接下来我们运行<code>Gcc Compile</code>，类似的，还是先在<code>运行和调试</code>界面选择<code>Gcc Compile</code>，然后按下<code>F5</code>开始运行</p> 
<p><img src="https://images2.imgbox.com/b1/69/hA7gUnV2_o.png" alt="选择配置为Gcc Compile"></p> 
<p>而后我们就会发现在文件夹下就出现了编译后的文件</p> 
<p><img src="https://images2.imgbox.com/88/7b/DzquboN7_o.png" alt="Gcc Compile运行的结果"></p> 
<h3><a id="6_Toy_Example_601"></a>6. 一个Toy Example：调试程序</h3> 
<p>我们上面做到了编译程序，而在编译之后我们需要干的就是去调试这个程序。</p> 
<p>首先需要明白的是，我们如果想要使用<code>gdb</code>、<code>lldb</code>等调试器去调试一个程序的时候，我们必须要在编译的时候指定<code>-g</code>参数，这样编译器（例如<code>gcc</code>、<code>clang</code>）在编译的时候就会把源代码、符号表等等信息写入到程序里面去。</p> 
<p>而后在调试的时候，我们使用命令<code>gdb xxxx</code>/<code>lldb xxxx</code>，<code>gdb</code>/<code>lldb</code>就回去读取源代码和符号表，从而开始调试。</p> 
<h4><a id="A_tasksjson_613"></a>A. tasks.json的内容</h4> 
<p>我们首先新增加一个名为<code>debug_build</code>的task，具体来说就是在编译的时候加上<code>-g</code>参数</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"2.0.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"tasks"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"label"</span><span class="token operator">:</span> <span class="token string">"debug_build"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"command"</span><span class="token operator">:</span> <span class="token string">"gcc"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"${file}"</span><span class="token punctuation">,</span>
                <span class="token string">"-g"</span><span class="token punctuation">,</span>
                <span class="token string">"-o"</span><span class="token punctuation">,</span>
                <span class="token string">"${fileDirname}${pathSeparator}${fileBasenameNoExtension}.o"</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="B_launchjson_637"></a>B. launch.json的内容</h4> 
<p>为了要进行debug，我们在launch.json中新加入一项，这一项可能会有些复杂</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 使用 IntelliSense 了解相关属性。 </span>
    <span class="token comment">// 悬停以查看现有属性的描述。</span>
    <span class="token comment">// 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387</span>
    <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"0.2.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"configurations"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"cppdbg"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"LLDB Debug"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"program"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}${pathSeparator}${fileBasenameNoExtension}.o"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"stopAtEntry"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token string-property property">"preLaunchTask"</span><span class="token operator">:</span> <span class="token string">"debug_build"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"cwd"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"MIMode"</span><span class="token operator">:</span> <span class="token string">"lldb"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>详细的解释如下：</p> 
<ul><li><code>"type":"cppdbg"</code>：新加入的这一项的类型是<code>cppdgb</code>，表示<code>C/C++ Debug</code>。因为我们新添加的运行配置的目的就是给<code>C/C++</code>程序Debug，所以我们让这一项的类型是<code>cppdgb</code>。如果我们是别的项目的话，例如是<code>node.js</code>的项目的话，那么我们让这个运行配置的<code>type</code>是<code>node</code>即可</li><li><code>"cwd:"${workspaceFolder}"</code>：因为在开始调试的时候我们需要在指定的文件夹下运行调试器，所以就需要使用<code>cwd</code>标签指定工作目录，一般制定成项目的根目录，也就是<code>workspaceFolder</code>就行了</li><li><code>"MIMode":"lldb"</code>：不同的系统上使用的调试器不同，<code>MacOS</code>、<code>Linux</code>、<code>Windows</code>使用的调试器分别是<code>lldb</code>、<code>gdb</code>、<code>msvc</code>/<code>gdb</code>（<code>msvc</code>是<code>Visual Studio</code>带的调试器，<code>gdb</code>是<code>MinGW</code>带的调试器），所以我们需要使用<code>MIMode</code>标签指定使用的调试器的类型。</li></ul> 
<p>此外，我们其实还可以使用<code>miDebuggerArgs</code>和<code>miDebuggerPath</code>来专门制定调用调试器时候传入的参数以及调试器的路径。</p> 
<p>因为我写这篇博客时候用的是<code>Mac</code>，所以用的调试器就是<code>LLDB</code></p> 
<h4><a id="C_LLDB_Debug_676"></a>C. 运行LLDB Debug</h4> 
<p>我们给前面的程序加上一个断点，然后选择运行配置为<code>LLDB Debug</code>，然后按下<code>F5</code>开始调试。</p> 
<p><img src="https://images2.imgbox.com/b1/8b/JBSQRsjM_o.png" alt="运行LLDB Debug"></p> 
<p>接下来我们就进入了调试页面：</p> 
<ul><li>下方：显示了所有的任务</li><li>左侧：显示了当前所有的变量以及变量的值、监视的变量以及表达式、函数的调用堆栈</li><li>中间：显式了正在调试的程序</li><li>上方：显式了调试的功能按钮</li></ul> 
<p><img src="https://images2.imgbox.com/92/8e/J9gRDOK8_o.png" alt="image-20221011184352703"></p> 
<h3><a id="7_Toy_Example_703"></a>7. 一个Toy Example：顺序执行</h3> 
<p>我们上面调试了一个程序。但是在现实中，我们往往在调试前是需要顺序执行多个命令的，而不是简单的编译。</p> 
<p>我们接下来给出的Toy Example在启动调试前就将顺序执行两步命令：</p> 
<ul><li>创建一个<code>bin</code>文件夹</li><li>将编译好的源文件输出到<code>bin</code>文件夹中</li></ul> 
<h4><a id="A_tasksjson_716"></a>A. tasks.json中的内容</h4> 
<p>我们在<code>tasks.json</code>中创建下面的两个任务</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"2.0.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"tasks"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"label"</span><span class="token operator">:</span> <span class="token string">"create_bin"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"shell"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"command"</span><span class="token operator">:</span> <span class="token string">"mkdir"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"-p"</span><span class="token punctuation">,</span>
                <span class="token string">"${workspaceFolder}${pathSeparator}/bin"</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"label"</span><span class="token operator">:</span> <span class="token string">"debug_build"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"shell"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"command"</span><span class="token operator">:</span> <span class="token string">"gcc"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"group"</span><span class="token operator">:</span> <span class="token string">"build"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"${file}"</span><span class="token punctuation">,</span>
                <span class="token string">"-g"</span><span class="token punctuation">,</span>
                <span class="token string">"-o"</span><span class="token punctuation">,</span>
                <span class="token string">"${fileDirname}${pathSeparator}bin${pathSeparator}${fileBasenameNoExtension}.o"</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"dependsOn"</span><span class="token operator">:</span> <span class="token string">"create_bin"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>create_bin</code>任务就是老三样，没啥好说的。</p> 
<p>关键就在于修改之后的<code>debug_build</code>任务，<code>debug_build</code>任务中新增加了一个<code>dependsOn</code>标签，这个标签说明了在运行<code>debug_build</code>任务之前需要运行的任务。</p> 
<p>在这里就表示在运行<code>debug_build</code>任务之前，需要运行<code>create_bin</code>任务。</p> 
<h4><a id="B_launchjson_760"></a>B. launch.json的内容</h4> 
<p><code>launch.json</code>中的内容保持不变，还是<code>LLDB Debug</code></p> 
<pre><code class="prism language-shell"><span class="token punctuation">{<!-- --></span>
    // 使用 IntelliSense 了解相关属性。 
    // 悬停以查看现有属性的描述。
    // 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid<span class="token operator">=</span><span class="token number">830387</span>
    <span class="token string">"version"</span><span class="token builtin class-name">:</span> <span class="token string">"0.2.0"</span>,
    <span class="token string">"configurations"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string">"type"</span><span class="token builtin class-name">:</span> <span class="token string">"cppdbg"</span>,
            <span class="token string">"request"</span><span class="token builtin class-name">:</span> <span class="token string">"launch"</span>,
            <span class="token string">"name"</span><span class="token builtin class-name">:</span> <span class="token string">"LLDB Debug"</span>,
            <span class="token string">"program"</span><span class="token builtin class-name">:</span> <span class="token string">"<span class="token variable">${workspaceFolder}</span><span class="token variable">${pathSeparator}</span>bin<span class="token variable">${pathSeparator}</span><span class="token variable">${fileBasenameNoExtension}</span>.o"</span>,
            <span class="token string">"stopAtEntry"</span><span class="token builtin class-name">:</span> false,
            <span class="token string">"preLaunchTask"</span><span class="token builtin class-name">:</span> <span class="token string">"debug_build"</span>,
            <span class="token string">"cwd"</span><span class="token builtin class-name">:</span> <span class="token string">"<span class="token variable">${workspaceFolder}</span>"</span>,
            <span class="token string">"MIMode"</span><span class="token builtin class-name">:</span> <span class="token string">"lldb"</span>,
        <span class="token punctuation">}</span>,
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="C_LLDB_Debug_787"></a>C. 运行LLDB Debug</h4> 
<p>运行<code>LLDB Debug</code>的结果如下，可以发现首先<code>bin</code>文件被创建了，接着可执行文件输出到了<code>bin</code>文件夹中，而后开始debug</p> 
<p><img src="https://images2.imgbox.com/a4/7d/qwLJHH4h_o.png" alt="image-20221011222558619"></p> 
<h3><a id="8_CMake_799"></a>8. 一个真实的例子：CMake工程</h3> 
<p>我们上面讲了四个Toy Example，介绍了VSCode的<code>tasks.json</code>和<code>launch.json</code>最基本的功能，接下来我们就把这些功能结合到一起，用VSCode调试一个真实的<code>CMake</code>工程。</p> 
<p>下面这个工程的目的就是编译就是一个名为<code>Wish</code>的自己写的<code>shell</code>脚本的项目，编译完成后将在本机得到一个可以运行的<code>shell</code></p> 
<h4><a id="A_CMake_808"></a>A. CMake工程结构及文件</h4> 
<p><code>CMake</code>工程的结构如下</p> 
<pre><code class="prism language-shell">tree ./
./
├── CMakeLists.txt
├── main.c
├── wish.c
└── wish.h

<span class="token number">0</span> directories, <span class="token number">4</span> files
</code></pre> 
<p>项目的源文件一共有四个，其中：</p> 
<ul><li><code>CMakeLists.txt</code>定义了项目结构</li><li><code>wish.c</code>和<code>wish.h</code>定义了<code>libwish</code>静态库</li><li><code>main.c</code>调用了<code>libwish</code>库</li></ul> 
<h5><a id="1__CMakeListstxt_831"></a>1 ) CMakeLists.txt</h5> 
<p><code>CMakeLists.txt</code>中的内容如下：</p> 
<pre><code class="prism language-cmake">project(WISH)

cmake_minimum_required(VERSION 3.9)

set(EXECUTABLE_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/bin)

set(LIBRARY_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/lib)

add_library(
    libwish STATIC
    wish.c
)

add_executable(
    wish
    main.c
)

target_link_libraries(wish libwish)
</code></pre> 
<h5><a id="2__wishh__wishc_859"></a>2 ) wish.h 和 wish.c</h5> 
<pre><code class="prism language-c"><span class="token comment">// wish.h</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_WISH_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdbool.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_WISH_H</span> <span class="token expression"><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WISH_EXIT_SUCCESS</span> <span class="token expression"><span class="token number">0</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WISH_EXIT_FAILURE</span> <span class="token expression"><span class="token operator">-</span><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WISH_BUF_SIZE</span> <span class="token expression"><span class="token number">1024</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WISH_MY_SEARCH</span> <span class="token expression"><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WISH_BUILTIN_NUM</span> <span class="token expression"><span class="token keyword">sizeof</span><span class="token punctuation">(</span>builtin_str<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WISH_MAX_WORD</span> <span class="token expression"><span class="token number">20</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WISH_MAX_FNAME</span> <span class="token expression"><span class="token number">1024</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WISH_MAX_PATH</span> <span class="token expression"><span class="token number">128</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WISH_DEBUG</span> <span class="token expression"><span class="token number">1</span></span></span>

<span class="token comment">// Base Functions</span>
<span class="token keyword">void</span> <span class="token function">wish_loop</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                   <span class="token comment">// main loop of wish</span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">wish_read_line</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                             <span class="token comment">// read user input line</span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token function">wish_split_line</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment">// split user input line into words</span>
<span class="token keyword">int</span> <span class="token function">wish_redirection</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment">// parse user input token to </span>
<span class="token keyword">int</span> <span class="token function">wish_execute</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> rarg_sht<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// execute user input command</span>
<span class="token keyword">int</span> <span class="token function">wish_launch</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> rarg_sht<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// launch other program</span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">wish_search</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>                           <span class="token comment">// search program in PATH</span>
<span class="token keyword">void</span> <span class="token function">wish_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                      <span class="token comment">// report error</span>
<span class="token keyword">void</span> <span class="token function">wish_line</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">wish_cd</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">wish_exit</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">wish_path</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">wish_help</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">wish_env</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">// wish.c</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"wish.h"</span></span>

<span class="token comment">// path</span>
<span class="token keyword">char</span> <span class="token operator">*</span>path<span class="token punctuation">[</span>WISH_MAX_PATH<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/bin"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Shell Builtin Funtions</span>
<span class="token keyword">char</span> <span class="token operator">*</span>builtin_str<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"cd"</span><span class="token punctuation">,</span>
    <span class="token string">"exit"</span><span class="token punctuation">,</span>
    <span class="token string">"path"</span><span class="token punctuation">,</span>
    <span class="token string">"help"</span><span class="token punctuation">,</span>
    <span class="token string">"wenv"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>builtin_func<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token operator">&amp;</span>wish_cd<span class="token punctuation">,</span>
    <span class="token operator">&amp;</span>wish_exit<span class="token punctuation">,</span>
    <span class="token operator">&amp;</span>wish_path<span class="token punctuation">,</span>
    <span class="token operator">&amp;</span>wish_help<span class="token punctuation">,</span>
    <span class="token operator">&amp;</span>wish_env
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">void</span> <span class="token function">wish_loop</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">char</span> <span class="token operator">*</span>line<span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>args<span class="token punctuation">;</span>
    bool status<span class="token punctuation">;</span>
    <span class="token keyword">do</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"wish&gt; "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        line <span class="token operator">=</span> <span class="token function">wish_read_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        args <span class="token operator">=</span> <span class="token function">wish_split_line</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token function">wish_redirection</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            args<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        status <span class="token operator">=</span> <span class="token function">wish_execute</span><span class="token punctuation">(</span>args<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">free</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> WISH_MAX_WORD<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">!=</span> args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token function">free</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">free</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>status<span class="token punctuation">)</span>
        <span class="token function">exit</span><span class="token punctuation">(</span>WISH_EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">wish_read_line</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> position <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> bufsize <span class="token operator">=</span> WISH_BUF_SIZE<span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span> buffer <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> bufsize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> buffer<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"wish: Memory allocation failed for read line.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span>WISH_EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">char</span> c<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>true<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// read a char</span>
        c <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token constant">EOF</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token char">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            buffer<span class="token punctuation">[</span>position<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> buffer<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span>
            buffer<span class="token punctuation">[</span>position<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
        <span class="token comment">// resize buffer</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>position <span class="token operator">&gt;=</span> bufsize<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            bufsize <span class="token operator">+=</span> WISH_BUF_SIZE<span class="token punctuation">;</span>
            <span class="token keyword">char</span> <span class="token operator">*</span> temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> bufsize<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> temp<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"wish: Memory allocation failed for read line.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// copy and reset pointer to new buffer</span>
            <span class="token keyword">int</span> num <span class="token operator">=</span> position<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>num <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                temp<span class="token punctuation">[</span>num<span class="token punctuation">]</span> <span class="token operator">=</span> buffer<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">;</span>
                num<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token function">free</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            buffer <span class="token operator">=</span> temp<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token function">wish_split_line</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>line<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>words <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">*</span> WISH_MAX_WORD<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> WISH_MAX_WORD<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        words<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">;</span>
    
    <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        temp<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> line<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>temp<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">' '</span> <span class="token operator">||</span> temp<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'\t'</span> <span class="token operator">||</span> temp<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'\0'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            temp<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
            words<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">strncpy</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> temp<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            words<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
            j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> k <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> 
            j <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">free</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> words<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">wish_redirection</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>args<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'&gt;'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> i<span class="token punctuation">;</span>
        i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">wish_execute</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> rarg_sht<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">// run builtin command</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> WISH_BUILTIN_NUM<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> builtin_str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">*</span>builtin_func<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">wish_launch</span><span class="token punctuation">(</span>args<span class="token punctuation">,</span> rarg_sht<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">wish_launch</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> rarg_sht<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// search path</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>executable_path <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> WISH_MAX_FNAME<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> WISH_MAX_FNAME<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        executable_path<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span> temp_path <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> WISH_MAX_FNAME<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>path<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// copy path[i] to temp and then concate</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strncpy</span><span class="token punctuation">(</span>temp_path<span class="token punctuation">,</span> path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token function">wish_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">wish_line</span><span class="token punctuation">(</span><span class="token constant">__LINE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> WISH_EXIT_FAILURE<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>temp_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp_path<span class="token punctuation">[</span>len<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'/'</span><span class="token punctuation">;</span>
        temp_path<span class="token punctuation">[</span>len <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcat</span><span class="token punctuation">(</span>temp_path<span class="token punctuation">,</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token function">wish_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">wish_line</span><span class="token punctuation">(</span><span class="token constant">__LINE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> WISH_EXIT_FAILURE<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// check privilege</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">access</span><span class="token punctuation">(</span>temp_path<span class="token punctuation">,</span> X_OK<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcpy</span><span class="token punctuation">(</span>executable_path<span class="token punctuation">,</span> temp_path<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token function">wish_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">wish_line</span><span class="token punctuation">(</span><span class="token constant">__LINE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> WISH_EXIT_FAILURE<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">free</span><span class="token punctuation">(</span>temp_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// print error if not found</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>executable_path<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'\0'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">free</span><span class="token punctuation">(</span>executable_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">wish_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">wish_line</span><span class="token punctuation">(</span><span class="token constant">__LINE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> EXIT_FAILURE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> status<span class="token punctuation">;</span>
    <span class="token class-name">pid_t</span> son_pid<span class="token punctuation">,</span> wait_pid<span class="token punctuation">;</span>
    son_pid <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>son_pid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// child process</span>
        <span class="token comment">// redirection</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">!=</span> rarg_sht <span class="token operator">&amp;&amp;</span> <span class="token constant">NULL</span> <span class="token operator">!=</span> args<span class="token punctuation">[</span>rarg_sht<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">// get real path</span>
            <span class="token keyword">char</span> rp<span class="token punctuation">[</span>WISH_MAX_FNAME<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">realpath</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span>rarg_sht<span class="token punctuation">]</span><span class="token punctuation">,</span> rp<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> <span class="token function">freopen</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span> <span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"wish: redirection file %s open fail!\n"</span><span class="token punctuation">,</span> rp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// run cmd</span>
        <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>func<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>WISH_MY_SEARCH <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
            func <span class="token operator">=</span> execvp<span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            func <span class="token operator">=</span> execv<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">func</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">// wish_error();</span>
            <span class="token comment">// wish_line(__LINE__);</span>
            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// if run the following code, then it is wrong</span>
        <span class="token function">exit</span><span class="token punctuation">(</span>WISH_EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>son_pid <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> 
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"wish: son process create fail by fork"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">do</span> <span class="token punctuation">{<!-- --></span> 
            wait_pid <span class="token operator">=</span> <span class="token function">waitpid</span><span class="token punctuation">(</span>son_pid<span class="token punctuation">,</span> <span class="token operator">&amp;</span>status<span class="token punctuation">,</span> WUNTRACED<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">WIFEXITED</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">WIFSIGNALED</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> true<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">wish_search</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>cmd<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">wish_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">char</span> <span class="token operator">*</span>err_msg <span class="token operator">=</span> <span class="token string">"An error has occurred\n"</span><span class="token punctuation">;</span>
    <span class="token function">write</span><span class="token punctuation">(</span>STDERR_FILENO<span class="token punctuation">,</span> err_msg<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>err_msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">wish_line</span><span class="token punctuation">(</span><span class="token keyword">int</span> lineno<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">WISH_DEBUG</span></span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"in line %d\n"</span><span class="token punctuation">,</span> lineno<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">wish_cd</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token function">wish_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">chdir</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token function">wish_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">wish_exit</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">wish_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">wish_path</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> args<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>    
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">wish_env</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">char</span> <span class="token operator">*</span> env <span class="token operator">=</span> <span class="token function">getenv</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s:\n"</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">wish_help</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"WISH written by Shihong Wang.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Usage: command  argument [enter]\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Builtin commands:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> WISH_BUILTIN_NUM<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\t%s"</span><span class="token punctuation">,</span> builtin_str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nRefer man page of other command.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="3__mainc_1184"></a>3 ) main.c</h5> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"wish.h"</span></span>

<span class="token keyword">extern</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>environ<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// command loop mode</span>
        <span class="token function">wish_loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// read-parse-execute mode</span>
        FILE <span class="token operator">*</span>file<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> <span class="token punctuation">(</span>file <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"wish: read-parse mode %s file not exists!\n"</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">exit</span><span class="token punctuation">(</span>WISH_EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// read a line, parse and execute</span>
        <span class="token keyword">int</span> status<span class="token punctuation">;</span>
        <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span> args<span class="token punctuation">;</span>
        <span class="token class-name">size_t</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token class-name">ssize_t</span> read<span class="token punctuation">;</span>
        <span class="token keyword">char</span> <span class="token operator">*</span>line <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> WISH_BUF_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>read <span class="token operator">=</span> <span class="token function">getline</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>line<span class="token punctuation">,</span> <span class="token operator">&amp;</span>len<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>line<span class="token punctuation">[</span><span class="token operator">++</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token char">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            line<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
            args <span class="token operator">=</span> <span class="token function">wish_split_line</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token function">wish_redirection</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                args<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            status <span class="token operator">=</span> <span class="token function">wish_execute</span><span class="token punctuation">(</span>args<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> WISH_MAX_WORD<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">!=</span> args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token function">free</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">free</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">free</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> WISH_EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="B_tasksjson_1237"></a>B. tasks.json的内容</h4> 
<p>我们在调试前，需要：</p> 
<ul><li>创建<code>build</code>文件夹</li><li>进入<code>build</code>文件夹使用<code>cmake</code>配置项目</li><li>使用<code>make</code>或者<code>cmake --build ./ --target all</code>进行编译</li></ul> 
<p>因此，我们需要再<code>tasks.json</code>中定义三个任务</p> 
<pre><code class="prism language-json">	<span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"2.0.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"tasks"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"label"</span><span class="token operator">:</span> <span class="token string">"create_build"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"shell"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"command"</span><span class="token operator">:</span> <span class="token string">"mkdir"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"-p"</span><span class="token punctuation">,</span>
                <span class="token string">"${workspaceFolder}/build"</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"detail"</span><span class="token operator">:</span> <span class="token string">"创建build文件夹"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"label"</span><span class="token operator">:</span> <span class="token string">"cmake_configure"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"shell"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"command"</span><span class="token operator">:</span> <span class="token string">"cmake"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"options"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string-property property">"cwd"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}/build"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"-DCMAKE_BUILD_TYPE=${input:CMAKE_BUILD_TYPE}"</span><span class="token punctuation">,</span>
                <span class="token string">"-DCMAKE_EXPORT_COMPILE_COMMANDS=ON"</span><span class="token punctuation">,</span> <span class="token comment">// 生成compile_commands.json 供c/c++扩展提示使用</span>
                <span class="token string">"../"</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"dependsOn"</span><span class="token operator">:</span> <span class="token string">"create_build"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"detail"</span><span class="token operator">:</span> <span class="token string">"CMake配置项目"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"label"</span><span class="token operator">:</span> <span class="token string">"make_build"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"shell"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"command"</span><span class="token operator">:</span> <span class="token string">"make"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"options"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string-property property">"cwd"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}/build"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"all"</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"dependsOn"</span><span class="token operator">:</span> <span class="token string">"cmake_configure"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"detail"</span><span class="token operator">:</span> <span class="token string">"Make构建项目"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token string-property property">"inputs"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"id"</span><span class="token operator">:</span> <span class="token string">"CMAKE_BUILD_TYPE"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"pickString"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">"选择项目的编译类型(CMake Build Type)"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"options"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"Debug"</span><span class="token punctuation">,</span>
                <span class="token string">"Release"</span><span class="token punctuation">,</span>
                <span class="token string">"RelWithDebInfo"</span><span class="token punctuation">,</span>
                <span class="token string">"MinSizeRel"</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"default"</span><span class="token operator">:</span> <span class="token string">"Debug"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>关于<code>input</code>标签，参考手册的这一节：https://code.visualstudio.com/docs/editor/variables-reference</p> 
<h4><a id="C_launchjson_1314"></a>C. launch.json的内容</h4> 
<p><code>launch.json</code>的内容如下</p> 
<pre><code class="prism language-shell"><span class="token punctuation">{<!-- --></span>
    // 使用 IntelliSense 了解相关属性。 
    // 悬停以查看现有属性的描述。
    // 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid<span class="token operator">=</span><span class="token number">830387</span>
    <span class="token string">"version"</span><span class="token builtin class-name">:</span> <span class="token string">"0.2.0"</span>,
    <span class="token string">"configurations"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string">"type"</span><span class="token builtin class-name">:</span> <span class="token string">"cppdbg"</span>,
            <span class="token string">"request"</span><span class="token builtin class-name">:</span> <span class="token string">"launch"</span>,
            <span class="token string">"name"</span><span class="token builtin class-name">:</span> <span class="token string">"LLDB Debug"</span>,
            <span class="token string">"program"</span><span class="token builtin class-name">:</span> <span class="token string">"<span class="token variable">${workspaceFolder}</span>/bin/wish"</span>,
            <span class="token string">"stopAtEntry"</span><span class="token builtin class-name">:</span> true,
            <span class="token string">"preLaunchTask"</span><span class="token builtin class-name">:</span> <span class="token string">"make_build"</span>,
            <span class="token string">"cwd"</span><span class="token builtin class-name">:</span> <span class="token string">"<span class="token variable">${workspaceFolder}</span>"</span>,
            <span class="token string">"MIMode"</span><span class="token builtin class-name">:</span> <span class="token string">"lldb"</span>,
        <span class="token punctuation">}</span>,
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="D__1343"></a>D. 开始调试</h4> 
<p>按下<code>F5</code>开始调试</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-9m1QUYpQ-1671721662119)(https://jack-1307599355.cos.ap-shanghai.myqcloud.com/%E5%B1%8F%E5%B9%95%E5%BD%95%E5%88%B62022-10-11-%E4%B8%8B%E5%8D%8811.28.15%20(1)].gif)</p> 
<h3><a id="9_CMaketasksjsonlaunchjson_1363"></a>9. CMake工程常用的tasks.json和launch.json</h3> 
<p>下面给出一个<code>CMake</code>工程常用的<code>tasks.json</code>和<code>launch.json</code></p> 
<pre><code class="prism language-json"><span class="token comment">// tasks.json</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// See https://go.microsoft.com/fwlink/?LinkId=733558</span>
    <span class="token comment">// for the documentation about the tasks.json format</span>
    <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"2.0.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"tasks"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span> 
            <span class="token comment">// 在根文件夹中执行创建文件夹build的命令</span>
            <span class="token comment">// 除windows系统外执行的命令为`mkdir -p build`</span>
            <span class="token comment">// windows系统是在powershell中执行命令`mkdir -Force build`</span>
            <span class="token string-property property">"label"</span><span class="token operator">:</span> <span class="token string">"build_dir"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"command"</span><span class="token operator">:</span> <span class="token string">"mkdir"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"shell"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"-p"</span><span class="token punctuation">,</span>
                <span class="token string">"build"</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"windows"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string-property property">"options"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token string-property property">"shell"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token string-property property">"executable"</span><span class="token operator">:</span> <span class="token string">"powershell.exe"</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token string">"-Force"</span><span class="token punctuation">,</span>
                    <span class="token string">"build"</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 在build文件夹中调用cmake进行项目配置</span>
            <span class="token comment">// 除windows系统外执行的命令为`cmake -DCMAKE_BUILD_TYPE=&lt;Debug|Release|RelWithDebInfo|MinSizeRel&gt; ../`</span>
            <span class="token comment">// windows系统是在visual stuido的环境中执行命令`cmake -DCMAKE_BUILD_TYPE=&lt;Debug|Release|RelWithDebInfo|MinSizeRel&gt;  ../ -G "CodeBlocks - NMake Makefiles"`</span>
            <span class="token string-property property">"label"</span><span class="token operator">:</span> <span class="token string">"cmake"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"shell"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"command"</span><span class="token operator">:</span> <span class="token string">"cmake"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"-DCMAKE_BUILD_TYPE=${input:CMAKE_BUILD_TYPE}"</span><span class="token punctuation">,</span>
                <span class="token string">"-DCMAKE_EXPORT_COMPILE_COMMANDS=ON"</span><span class="token punctuation">,</span> <span class="token comment">// 生成compile_commands.json 供c/c++扩展提示使用</span>
                <span class="token string">"../"</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"options"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string-property property">"cwd"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}/build"</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string-property property">"windows"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token string">"-DCMAKE_BUILD_TYPE=${input:CMAKE_BUILD_TYPE}"</span><span class="token punctuation">,</span>
                    <span class="token string">"-DCMAKE_EXPORT_COMPILE_COMMANDS=ON"</span><span class="token punctuation">,</span>
                    <span class="token string">"../"</span><span class="token punctuation">,</span>
                    <span class="token string">"-G"</span><span class="token punctuation">,</span>
                    <span class="token string">"\"CodeBlocks - NMake Makefiles\""</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string-property property">"options"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token string-property property">"shell"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">// 需要根据安装的vs版本调用vs工具命令提示符，根据自己的计算机上的路径进行修改</span>
                        <span class="token string-property property">"executable"</span><span class="token operator">:</span> <span class="token string">"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\VC\\Auxiliary\\Build\\vcvarsall.bat"</span><span class="token punctuation">,</span>
                        <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                            <span class="token string">"${input:PLATFORM}"</span><span class="token punctuation">,</span> <span class="token comment">//指定平台</span>
                            <span class="token string">"-vcvars_ver=${input:vcvars_ver}"</span><span class="token punctuation">,</span> <span class="token comment">//指定vc环境版本</span>
                            <span class="token string">"&amp;&amp;"</span>
                        <span class="token punctuation">]</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string-property property">"dependsOn"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"build_dir"</span> <span class="token comment">// 在task `build_dir` 后执行该task</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 在build文件夹中调用cmake编译构建debug程序</span>
            <span class="token comment">// 执行的命令为`cmake --build ./ --target all --`</span>
            <span class="token comment">//  windows系统如上需要在visual stuido的环境中执行命令</span>
            <span class="token string-property property">"label"</span><span class="token operator">:</span> <span class="token string">"build"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"group"</span><span class="token operator">:</span> <span class="token string">"build"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"shell"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"command"</span><span class="token operator">:</span> <span class="token string">"cmake"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"--build"</span><span class="token punctuation">,</span>
                <span class="token string">"./"</span><span class="token punctuation">,</span>
                <span class="token string">"--target"</span><span class="token punctuation">,</span>
                <span class="token string">"all"</span><span class="token punctuation">,</span>
                <span class="token string">"--"</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"options"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string-property property">"cwd"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}/build"</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string-property property">"problemMatcher"</span><span class="token operator">:</span> <span class="token string">"$gcc"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"windows"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string-property property">"options"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token string-property property">"shell"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token string-property property">"executable"</span><span class="token operator">:</span> <span class="token string">"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\VC\\Auxiliary\\Build\\vcvarsall.bat"</span><span class="token punctuation">,</span>
                        <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                            <span class="token string">"${input:PLATFORM}"</span><span class="token punctuation">,</span>
                            <span class="token string">"-vcvars_ver=${input:vcvars_ver}"</span><span class="token punctuation">,</span>
                            <span class="token string">"&amp;&amp;"</span>
                        <span class="token punctuation">]</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token string-property property">"problemMatcher"</span><span class="token operator">:</span> <span class="token string">"$msCompile"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string-property property">"dependsOn"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"cmake"</span> <span class="token comment">// 在task `cmake` 后执行该task</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"label"</span><span class="token operator">:</span> <span class="token string">"Open Terminal"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"shell"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"command"</span><span class="token operator">:</span> <span class="token string">"osascript -e 'tell application \"Terminal\"\ndo script \"echo hello\"\nend tell'"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"problemMatcher"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">"inputs"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"id"</span><span class="token operator">:</span> <span class="token string">"CMAKE_BUILD_TYPE"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"pickString"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">"指定 CMAKE_BUILD_TYPE 的值"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"options"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"Debug"</span><span class="token punctuation">,</span>
                <span class="token string">"Release"</span><span class="token punctuation">,</span>
                <span class="token string">"RelWithDebInfo"</span><span class="token punctuation">,</span>
                <span class="token string">"MinSizeRel"</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"default"</span><span class="token operator">:</span> <span class="token string">"Debug"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"id"</span><span class="token operator">:</span> <span class="token string">"PLATFORM"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"pickString"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">"指定 PLATFORM 的值"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"options"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"x86"</span><span class="token punctuation">,</span>
                <span class="token string">"amd64"</span><span class="token punctuation">,</span>
                <span class="token string">"arm"</span><span class="token punctuation">,</span>
                <span class="token string">"x86_arm"</span><span class="token punctuation">,</span>
                <span class="token string">"x86_amd64"</span><span class="token punctuation">,</span>
                <span class="token string">"amd64_x86"</span><span class="token punctuation">,</span>
                <span class="token string">"amd64_arm"</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"default"</span><span class="token operator">:</span> <span class="token string">"amd64"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"id"</span><span class="token operator">:</span> <span class="token string">"vcvars_ver"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"pickString"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">"指定 vcvars_ver 的值"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"options"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"14.2"</span><span class="token punctuation">,</span> <span class="token comment">// 2019</span>
                <span class="token string">"14.1"</span><span class="token punctuation">,</span> <span class="token comment">// 2017</span>
                <span class="token string">"14.0"</span><span class="token punctuation">,</span> <span class="token comment">// 2015</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"default"</span><span class="token operator">:</span> <span class="token string">"14.2"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>注意，如果是需要以<code>Attach Debug</code>方式启动的调试的话，运行中的进程在编译的时候必须要加上<code>-g</code>以将符号表写入到程序中，从而能够<code>debug</code>程序，若使用<code>CMake</code>工具的话，需要指定使用<code>Debug</code>方式来构建程序，而非<code>MinSizeRel</code>等其他构建方式</p> 
<pre><code class="prism language-json"><span class="token comment">// launch.json</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// Use IntelliSense to learn about possible attributes.</span>
    <span class="token comment">// Hover to view descriptions of existing attributes.</span>
    <span class="token comment">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span>
    <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"0.2.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"configurations"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//名称</span>
            <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"Launch Debug"</span><span class="token punctuation">,</span>
            <span class="token comment">//调试类型，除使用msvc进行调试外，均为该类型</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"cppdbg"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span>
            <span class="token comment">//指定C/C++程序位置</span>
            <span class="token string-property property">"program"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}/bin/${input:executable}"</span><span class="token punctuation">,</span>
            <span class="token comment">//指定运行参数</span>
            <span class="token string-property property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"test.bin"</span><span class="token punctuation">,</span>
                <span class="token string">"sorted.bin"</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string-property property">"stopAtEntry"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token comment">//指定工作目录</span>
            <span class="token string-property property">"cwd"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}"</span><span class="token punctuation">,</span>
            <span class="token comment">//在调试前会先调用build_debug这个task编译构建程序</span>
            <span class="token string-property property">"preLaunchTask"</span><span class="token operator">:</span> <span class="token string">"build"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"environment"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token comment">//macOS的特定配置</span>
            <span class="token string-property property">"osx"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//指定使用lldb进行调试</span>
                <span class="token string-property property">"MIMode"</span><span class="token operator">:</span> <span class="token string">"lldb"</span><span class="token punctuation">,</span>
                <span class="token comment">// 使用外部终端</span>
                <span class="token string-property property">"externalConsole"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">//linux的特定配置</span>
            <span class="token string-property property">"linux"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//指定使用gdb调试</span>
                <span class="token string-property property">"MIMode"</span><span class="token operator">:</span> <span class="token string">"gdb"</span><span class="token punctuation">,</span>
                <span class="token string-property property">"setupCommands"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">"Enable pretty-printing for gdb"</span><span class="token punctuation">,</span>
                        <span class="token string-property property">"text"</span><span class="token operator">:</span> <span class="token string">"-enable-pretty-printing"</span><span class="token punctuation">,</span>
                        <span class="token string-property property">"ignoreFailures"</span><span class="token operator">:</span> <span class="token boolean">true</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">//windows的特定配置</span>
            <span class="token string-property property">"windows"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//指定使用msvc进行调试</span>
                <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"cppdbg"</span><span class="token punctuation">,</span>
                <span class="token comment">//指定C/C++程序位置</span>
                <span class="token string-property property">"program"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}/build/${workspaceFolderBasename}.exe"</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//名称</span>
            <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"Attach Debug"</span><span class="token punctuation">,</span>
            <span class="token comment">//调试类型，除使用msvc进行调试外，均为该类型</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"cppdbg"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"request"</span><span class="token operator">:</span> <span class="token string">"attach"</span><span class="token punctuation">,</span>
            <span class="token comment">//指定C/C++程序位置</span>
            <span class="token string-property property">"program"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}/bin/${input:executable}"</span><span class="token punctuation">,</span>
            <span class="token comment">//指定要attach的线程</span>
            <span class="token string-property property">"processId"</span><span class="token operator">:</span><span class="token string">"${command:pickProcess}"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"osx"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//指定使用lldb进行调试</span>
                <span class="token string-property property">"MIMode"</span><span class="token operator">:</span> <span class="token string">"lldb"</span><span class="token punctuation">,</span>
                <span class="token comment">// 使用外部终端</span>
                <span class="token string-property property">"externalConsole"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">//linux的特定配置</span>
            <span class="token string-property property">"linux"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//指定使用gdb调试</span>
                <span class="token string-property property">"MIMode"</span><span class="token operator">:</span> <span class="token string">"gdb"</span><span class="token punctuation">,</span>
                <span class="token string-property property">"setupCommands"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">"Enable pretty-printing for gdb"</span><span class="token punctuation">,</span>
                        <span class="token string-property property">"text"</span><span class="token operator">:</span> <span class="token string">"-enable-pretty-printing"</span><span class="token punctuation">,</span>
                        <span class="token string-property property">"ignoreFailures"</span><span class="token operator">:</span> <span class="token boolean">true</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">//windows的特定配置</span>
            <span class="token string-property property">"windows"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//指定使用msvc进行调试</span>
                <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"cppdbg"</span><span class="token punctuation">,</span>
                <span class="token comment">//指定C/C++程序位置</span>
                <span class="token string-property property">"program"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}/build/${workspaceFolderBasename}.exe"</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">"inputs"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"id"</span><span class="token operator">:</span> <span class="token string">"executable"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"pickString"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">"可执行文件的名称"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"default"</span><span class="token operator">:</span> <span class="token string">"posrt"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"options"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"psort"</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/10b6c9f20ba9a30503157db11a711ec7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">商品数量按钮加减</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/689a5384016e014b30075d8514864ff4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">在conda虚拟环境中安装OpenCv并在pycharm中使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>