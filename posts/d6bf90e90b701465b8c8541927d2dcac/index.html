<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Pythonnet：Python与.NET的无缝集成 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Pythonnet：Python与.NET的无缝集成" />
<meta property="og:description" content="Pythonnet是一个包，提供了与 .NET 公共语言运行时 (CLR) 近乎无缝的集成，为 Python 程序员和 .NET 开发人员提供了强大的应用程序脚本工具。它支持 Windows、Linux 和 macOS 上的 .NET Framework 和 .NET Core。Pythonnet允许将 .NET 程序集和命名空间导入为 Python 模块和包，以及从 Python 代码调用 .NET 方法和属性，反之亦然。它还支持 .NET 对象的动态类型和关键字参数，并与流行的 Python 库（如 numpy、pandas、matplotlib 等）良好集成。
其中，Pythonnet在网络爬虫领域具有广泛的应用场景。网络爬行是使用自动化程序从网站提取数据的过程。Python 是一种流行的网络爬行语言，但某些网站可能需要与 .NET 组件交互或访问 .NET API 来检索数据。在这种情况下，Pythonnet可以弥合 Python 和 .NET 之间的差距，使网络爬虫能够从 Python 代码访问 .NET 功能。例如，通过使用 Pythonnet，网络爬虫可以加载提供 Web 服务客户端或 Web 浏览器控件的 .NET 程序集，并与网站进行通信或呈现其内容。这样，Pythonnet可以利用 .NET 的强大功能来增强网络爬虫的功能和性能。
2023年高考分数已经公布，下面用程序采集各地录取分数线，首先需安装Python、Pythonnet和openpyxl库用于操作Excel文件，示例如下：
import clr import openpyxl import requests # 加载Pythonnet的clr模块 clr.AddReference(&#34;System&#34;) from System.Net import WebRequest, WebProxy # 亿牛云代理 # 设置爬虫代理加强版IP proxy_host = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/d6bf90e90b701465b8c8541927d2dcac/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-26T13:58:01+08:00" />
<meta property="article:modified_time" content="2023-06-26T13:58:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Pythonnet：Python与.NET的无缝集成</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/93/32/NFI7uDC0_o.jpg" alt="亿牛云代理.jpeg"><br> Pythonnet是一个包，提供了与 .NET 公共语言运行时 (CLR) 近乎无缝的集成，为 Python 程序员和 .NET 开发人员提供了强大的应用程序脚本工具。它支持 Windows、Linux 和 macOS 上的 .NET Framework 和 .NET Core。Pythonnet允许将 .NET 程序集和命名空间导入为 Python 模块和包，以及从 Python 代码调用 .NET 方法和属性，反之亦然。它还支持 .NET 对象的动态类型和关键字参数，并与流行的 Python 库（如 numpy、pandas、matplotlib 等）良好集成。<br> 其中，Pythonnet在网络爬虫领域具有广泛的应用场景。网络爬行是使用自动化程序从网站提取数据的过程。Python 是一种流行的网络爬行语言，但某些网站可能需要与 .NET 组件交互或访问 .NET API 来检索数据。在这种情况下，Pythonnet可以弥合 Python 和 .NET 之间的差距，使网络爬虫能够从 Python 代码访问 .NET 功能。例如，通过使用 Pythonnet，网络爬虫可以加载提供 Web 服务客户端或 Web 浏览器控件的 .NET 程序集，并与网站进行通信或呈现其内容。这样，Pythonnet可以利用 .NET 的强大功能来增强网络爬虫的功能和性能。<br> 2023年高考分数已经公布，下面用程序采集各地录取分数线，首先需安装Python、Pythonnet和openpyxl库用于操作Excel文件，示例如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> clr
<span class="token keyword">import</span> openpyxl
<span class="token keyword">import</span> requests

<span class="token comment"># 加载Pythonnet的clr模块</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">"System"</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> System<span class="token punctuation">.</span>Net <span class="token keyword">import</span> WebRequest<span class="token punctuation">,</span> WebProxy

<span class="token comment"># 亿牛云代理 </span>
<span class="token comment"># 设置爬虫代理加强版IP</span>
proxy_host <span class="token operator">=</span> <span class="token string">"www.16yun.cn"</span>
proxy_port <span class="token operator">=</span> <span class="token number">31300</span>
proxy_username <span class="token operator">=</span> <span class="token string">"16YUN"</span>
proxy_password <span class="token operator">=</span> <span class="token string">"16IP"</span>

<span class="token comment"># 设置代理信息</span>
proxy <span class="token operator">=</span> WebProxy<span class="token punctuation">(</span>proxy_host<span class="token punctuation">,</span> proxy_port<span class="token punctuation">)</span>
proxy<span class="token punctuation">.</span>Credentials <span class="token operator">=</span> System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>NetworkCredential<span class="token punctuation">(</span>proxy_username<span class="token punctuation">,</span> proxy_password<span class="token punctuation">)</span>

<span class="token comment"># 创建Web请求</span>
url <span class="token operator">=</span> <span class="token string">"https://www.baidu.com/s"</span>
params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"wd"</span><span class="token punctuation">:</span> <span class="token string">"高考批次线"</span>
<span class="token punctuation">}</span>
headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"</span>
<span class="token punctuation">}</span>
request <span class="token operator">=</span> WebRequest<span class="token punctuation">.</span>Create<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
request<span class="token punctuation">.</span>Proxy <span class="token operator">=</span> proxy
request<span class="token punctuation">.</span>UserAgent <span class="token operator">=</span> headers<span class="token punctuation">[</span><span class="token string">"User-Agent"</span><span class="token punctuation">]</span>

<span class="token comment"># 发送请求并获取响应</span>
response <span class="token operator">=</span> request<span class="token punctuation">.</span>GetResponse<span class="token punctuation">(</span><span class="token punctuation">)</span>
html <span class="token operator">=</span> <span class="token boolean">None</span>
<span class="token keyword">if</span> response<span class="token punctuation">.</span>StatusCode <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> response<span class="token punctuation">.</span>GetResponseStream<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> stream<span class="token punctuation">:</span>
        <span class="token keyword">with</span> StreamReader<span class="token punctuation">(</span>stream<span class="token punctuation">)</span> <span class="token keyword">as</span> reader<span class="token punctuation">:</span>
            html <span class="token operator">=</span> reader<span class="token punctuation">.</span>ReadToEnd<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 解析HTML并提取数据</span>
<span class="token comment"># 这里使用适合目标网站的具体解析方法，具体实现根据实际情况进行</span>
<span class="token comment"># 这里假设提取到的数据存储在一个字典scores中，省份为键，录取分数为值</span>

<span class="token comment"># 创建Excel文件并写入数据</span>
wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>active
sheet<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"高考批次线"</span>
sheet<span class="token punctuation">[</span><span class="token string">"A1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"省份"</span>
sheet<span class="token punctuation">[</span><span class="token string">"B1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"录取分数"</span>
row <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">for</span> province<span class="token punctuation">,</span> score <span class="token keyword">in</span> scores<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sheet<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"A</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>row<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> province
    sheet<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"B</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>row<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> score
    row <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token comment"># 保存Excel文件</span>
wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"高考批次线统计.xlsx"</span><span class="token punctuation">)</span>

</code></pre> 
<p>程序将采集百度搜索结果中关键词"高考批次线"的相关内容，并将结果存储到Excel文件"高考批次线统.xlsx"中。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/242b57901633eb9e1e3a2dd07ec938c0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">文本聚类之Supporting Clustering with Contrastive Learning（SCCL）论文复现【代码纠错及完善】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1dfb619b11e4c77d56ce02027db093e1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">原生js分页</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>