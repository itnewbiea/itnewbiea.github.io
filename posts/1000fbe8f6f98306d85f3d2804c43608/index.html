<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>excel数据分析 - 10个清洗文本类函数 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="excel数据分析 - 10个清洗文本类函数" />
<meta property="og:description" content="目录
1. FIND 位置查找函数
2. SEARCH 字符查找函数
3. LEFT / RIGHT/ MID 字符截取函数
4. CONCATENATE 文本串联函数
5. LEN 计算字符长度函数
6. LENB 计算双字节字符长度函数
7. TRIM 空格清理函数
8. REPLACE 位置替换函数 9. SUBSTITUTE 字符替换函数
10. TEXT 文本转换函数
①按指定格式，将数值转换为文本
②其他文本清洗方法：利用记事本
③将文本转换为数值
11.用查找和替换的注意点
1. FIND 位置查找函数 =FIND（待查找的字符，选中单元格，开始位置num） 字符记得加引号 找出字符串的位置，可查找1个or多个字符。 如不填写开始位置，则从选中单元格的第一个字符开始查找 e.g. A1单元格内容为“基础k内容”，需查找A1单元格中字符‘k’的位置 =find(&#39;&#39;k&#39;&#39;,A1,1) = 3 2. SEARCH 字符查找函数 =search(待查找的字符串,待查找的单元格,起始位置num)查找一个字符串，在另一个字符串的位置，不区分大小写 e.g. A1单元格内容为“基础k内K容”，需查找A1单元格中第一个出现‘k’的位置 =search(&#34;k&#34;,A1,1) = 3 3. LEFT / RIGHT/ MID 字符截取函数 ① LEFT函数 =LEFT（选中单元格，截止位置num）从文本字符串的左边第一个字符开始，返回指定个数的字符如未注明截止位置num，则返回左边第1个字符； 如注明截止位置num＞文本长度，则返回整个文本；如所注明的字符串为0，则返回空值。 e." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/1000fbe8f6f98306d85f3d2804c43608/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-22T14:03:56+08:00" />
<meta property="article:modified_time" content="2022-08-22T14:03:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">excel数据分析 - 10个清洗文本类函数</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="1.%20FIND%20%E4%BD%8D%E7%BD%AE%E6%9F%A5%E6%89%BE%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#1.%20FIND%20%E4%BD%8D%E7%BD%AE%E6%9F%A5%E6%89%BE%E5%87%BD%E6%95%B0" rel="nofollow">1. FIND 位置查找函数</a></p> 
<p id="2.%20SEARCH%20%E5%AD%97%E7%AC%A6%E6%9F%A5%E6%89%BE%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#2.%20SEARCH%20%E5%AD%97%E7%AC%A6%E6%9F%A5%E6%89%BE%E5%87%BD%E6%95%B0" rel="nofollow">2. SEARCH 字符查找函数</a></p> 
<p id="3.%20LEFT%C2%A0%2F%20RIGHT%2F%20MID%20%E5%AD%97%E7%AC%A6%E6%88%AA%E5%8F%96%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#3.%20LEFT%C2%A0%2F%20RIGHT%2F%20MID%20%E5%AD%97%E7%AC%A6%E6%88%AA%E5%8F%96%E5%87%BD%E6%95%B0" rel="nofollow">3. LEFT / RIGHT/ MID 字符截取函数</a></p> 
<p id="4.%20CONCATENATE%20%E6%96%87%E6%9C%AC%E4%B8%B2%E8%81%94%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#4.%20CONCATENATE%20%E6%96%87%E6%9C%AC%E4%B8%B2%E8%81%94%E5%87%BD%E6%95%B0" rel="nofollow">4. CONCATENATE 文本串联函数</a></p> 
<p id="5.%20LEN%20%E8%AE%A1%E7%AE%97%E5%AD%97%E7%AC%A6%E9%95%BF%E5%BA%A6%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#5.%20LEN%20%E8%AE%A1%E7%AE%97%E5%AD%97%E7%AC%A6%E9%95%BF%E5%BA%A6%E5%87%BD%E6%95%B0" rel="nofollow">5. LEN 计算字符长度函数</a></p> 
<p id="6.%C2%A0LENB%20%E8%AE%A1%E7%AE%97%E5%8F%8C%E5%AD%97%E8%8A%82%E5%AD%97%E7%AC%A6%E9%95%BF%E5%BA%A6%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#6.%C2%A0LENB%20%E8%AE%A1%E7%AE%97%E5%8F%8C%E5%AD%97%E8%8A%82%E5%AD%97%E7%AC%A6%E9%95%BF%E5%BA%A6%E5%87%BD%E6%95%B0" rel="nofollow">6. LENB 计算双字节字符长度函数</a></p> 
<p id="7.%20TRIM%20%E7%A9%BA%E6%A0%BC%E6%B8%85%E7%90%86%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#7.%20TRIM%20%E7%A9%BA%E6%A0%BC%E6%B8%85%E7%90%86%E5%87%BD%E6%95%B0" rel="nofollow">7. TRIM 空格清理函数</a></p> 
<p id="8.%20REPLACE%C2%A0%20%E4%BD%8D%E7%BD%AE%E6%9B%BF%E6%8D%A2%E5%87%BD%E6%95%B0%20%C2%A0%20%C2%A0%C2%A0-toc" style="margin-left:40px;"><a href="#8.%20REPLACE%C2%A0%20%E4%BD%8D%E7%BD%AE%E6%9B%BF%E6%8D%A2%E5%87%BD%E6%95%B0%20%C2%A0%20%C2%A0%C2%A0" rel="nofollow">8. REPLACE  位置替换函数     </a></p> 
<p id="9.%20SUBSTITUTE%20%E5%AD%97%E7%AC%A6%E6%9B%BF%E6%8D%A2%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#9.%20SUBSTITUTE%20%E5%AD%97%E7%AC%A6%E6%9B%BF%E6%8D%A2%E5%87%BD%E6%95%B0" rel="nofollow">9. SUBSTITUTE 字符替换函数</a></p> 
<p id="10.%20TEXT%20%E6%96%87%E6%9C%AC%E8%BD%AC%E6%8D%A2%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#10.%20TEXT%20%E6%96%87%E6%9C%AC%E8%BD%AC%E6%8D%A2%E5%87%BD%E6%95%B0" rel="nofollow">10. TEXT 文本转换函数</a></p> 
<p id="%E2%91%A0%E6%8C%89%E6%8C%87%E5%AE%9A%E6%A0%BC%E5%BC%8F%EF%BC%8C%E5%B0%86%E6%95%B0%E5%80%BC%E8%BD%AC%E6%8D%A2%E4%B8%BA%E6%96%87%E6%9C%AC-toc" style="margin-left:80px;"><a href="#%E2%91%A0%E6%8C%89%E6%8C%87%E5%AE%9A%E6%A0%BC%E5%BC%8F%EF%BC%8C%E5%B0%86%E6%95%B0%E5%80%BC%E8%BD%AC%E6%8D%A2%E4%B8%BA%E6%96%87%E6%9C%AC" rel="nofollow">①按指定格式，将数值转换为文本</a></p> 
<p id="%E2%91%A1%E5%85%B6%E4%BB%96%E6%96%87%E6%9C%AC%E6%B8%85%E6%B4%97%E6%96%B9%E6%B3%95%EF%BC%9A%E5%88%A9%E7%94%A8%E8%AE%B0%E4%BA%8B%E6%9C%AC-toc" style="margin-left:80px;"><a href="#%E2%91%A1%E5%85%B6%E4%BB%96%E6%96%87%E6%9C%AC%E6%B8%85%E6%B4%97%E6%96%B9%E6%B3%95%EF%BC%9A%E5%88%A9%E7%94%A8%E8%AE%B0%E4%BA%8B%E6%9C%AC" rel="nofollow">②其他文本清洗方法：利用记事本</a></p> 
<p id="%C2%A0%E2%91%A2%E5%B0%86%E6%96%87%E6%9C%AC%E8%BD%AC%E6%8D%A2%E4%B8%BA%E6%95%B0%E5%80%BC-toc" style="margin-left:40px;">        <a href="#%C2%A0%E2%91%A2%E5%B0%86%E6%96%87%E6%9C%AC%E8%BD%AC%E6%8D%A2%E4%B8%BA%E6%95%B0%E5%80%BC" rel="nofollow"> ③将文本转换为数值</a></p> 
<p id="11.%E7%94%A8%E6%9F%A5%E6%89%BE%E5%92%8C%E6%9B%BF%E6%8D%A2%E7%9A%84%E6%B3%A8%E6%84%8F%E7%82%B9-toc" style="margin-left:0px;"><a href="#11.%E7%94%A8%E6%9F%A5%E6%89%BE%E5%92%8C%E6%9B%BF%E6%8D%A2%E7%9A%84%E6%B3%A8%E6%84%8F%E7%82%B9" rel="nofollow">11.用查找和替换的注意点</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h3 id="1.%20FIND%20%E4%BD%8D%E7%BD%AE%E6%9F%A5%E6%89%BE%E5%87%BD%E6%95%B0">1. FIND 位置查找函数</h3> 
<ul><li>=FIND（待查找的字符，选中单元格，开始位置num）  <span style="color:#be191c;">  字符记得加引号 </span></li><li>找出字符串的位置，可查找1个or多个字符。     </li><li>如不填写开始位置，则从选中单元格的第一个字符开始查找</li></ul> 
<p>     e.g.  A1单元格内容为“基础k内容”，需查找A1单元格中字符‘k’的位置 </p> 
<p>               =find(''k'',A1,1)    =  3              </p> 
<p></p> 
<h3 id="2.%20SEARCH%20%E5%AD%97%E7%AC%A6%E6%9F%A5%E6%89%BE%E5%87%BD%E6%95%B0">2. SEARCH 字符查找函数</h3> 
<ul><li>=search(待查找的字符串,待查找的单元格,起始位置num)</li><li>查找一个字符串，在另一个字符串的位置，不区分大小写</li></ul> 
<p> e.g.  A1单元格内容为“基础k内K容”，需查找A1单元格中第一个出现‘k’的位置 </p> 
<p>               =search("k",A1,1)    =  3              </p> 
<p>                                                                                                 </p> 
<h3 id="3.%20LEFT%C2%A0%2F%20RIGHT%2F%20MID%20%E5%AD%97%E7%AC%A6%E6%88%AA%E5%8F%96%E5%87%BD%E6%95%B0">3. LEFT / RIGHT/ MID 字符截取函数</h3> 
<h4 id="%E2%91%A0%20LEFT%E5%87%BD%E6%95%B0">① LEFT函数</h4> 
<ul><li>       =LEFT（选中单元格，截止位置num）</li><li>从文本字符串的左边第一个字符开始，返回指定个数的字符</li><li>如未注明截止位置num，则返回左边第1个字符； </li><li>如注明截止位置num＞文本长度，则返回整个文本；</li><li>如所注明的字符串为0，则返回空值。</li></ul> 
<p>    e.g. =left(A1,3)     截取A1单元格中第1至3的字符</p> 
<h4 id="%E2%91%A1RIGHT%E5%87%BD%E6%95%B0">②RIGHT函数</h4> 
<ul><li>同理，从右边第一个字符开始，返回指定长度的字符。</li></ul> 
<h4 id="%E2%91%A2MID%E5%87%BD%E6%95%B0">③MID函数</h4> 
<ul><li><strong>   </strong>=MID(选中单元格,起始位置_num,截止位置num)</li><li>从指定位置开始，提取用户指定的字符数</li></ul> 
<h4>引申用法 - 用mid函数随机选取字符</h4> 
<p>在需要随机选取字符的单元格内，输入以下公式：</p> 
<p>=MID（“需选取的字符池”，RANDBETWEEN(1，字符池长度_num),1）</p> 
<p>e.g.  =MID("男女",RANDBETWEEN(1,2),1)</p> 
<p></p> 
<h3 id="4.%20CONCATENATE%20%E6%96%87%E6%9C%AC%E4%B8%B2%E8%81%94%E5%87%BD%E6%95%B0">4. CONCATENATE 文本串联函数</h3> 
<ul><li>=CONCATENATE(拼接字符1,拼接字符2,拼接字符3，...）</li><li>将多个文本字符or单元格串联，显示在同一个单元格内     </li></ul> 
<p>e.g. A1单元格内容为“基础内容”，A2单元格内容为“打地基”，</p> 
<p>      =concatenate(A1,A2,"K")   = 基础内容打地基K</p> 
<p></p> 
<h3 id="5.%20LEN%20%E8%AE%A1%E7%AE%97%E5%AD%97%E7%AC%A6%E9%95%BF%E5%BA%A6%E5%87%BD%E6%95%B0">5. LEN 计算字符长度函数</h3> 
<ul><li>=LEN(单元格or文本）</li><li>返回单元格or字符的长度，即字符数</li></ul> 
<p>e.g. A1单元格字符内容为“基础内容”，  =LEN(A1) = 4</p> 
<p></p> 
<h3 id="6.%C2%A0LENB%20%E8%AE%A1%E7%AE%97%E5%8F%8C%E5%AD%97%E8%8A%82%E5%AD%97%E7%AC%A6%E9%95%BF%E5%BA%A6%E5%87%BD%E6%95%B0">6. LENB 计算双字节字符长度函数</h3> 
<ul><li><strong>  </strong>=LENB(单元格or文本)</li><li>同样是返回字符长度，但双字节字符会返回2，单字节返回1 </li><li> 汉字及中文标点是双字节；英文字母及英文标点是单字节</li></ul> 
<p>     e.g. A1单元格字符内容为“基础内容”， </p> 
<p>            =LENB(A1) = 8</p> 
<p></p> 
<h3 id="7.%20TRIM%20%E7%A9%BA%E6%A0%BC%E6%B8%85%E7%90%86%E5%87%BD%E6%95%B0">7. TRIM 空格清理函数</h3> 
<ul><li>=TRIM(单元格or文本）</li><li>把前后的空格去掉，但不去除字符之间的空格</li></ul> 
<p></p> 
<h3 id="8.%20REPLACE%C2%A0%20%E4%BD%8D%E7%BD%AE%E6%9B%BF%E6%8D%A2%E5%87%BD%E6%95%B0%20%C2%A0%20%C2%A0%C2%A0">8. REPLACE  位置替换函数     </h3> 
<ul><li>=REPLACE(选中单元格，开始位置num，需替换的字符数num，新字符）</li><li><span style="color:#be191c;">字符内容需加双引号</span>，将指定位置的部分字符，替换为新字符 </li></ul> 
<p>   e.g. A1单元格字符内容为“基础内容”， </p> 
<p>       =REPLACE(A1 , 2 , 2 , "111")  = 基111容</p> 
<p></p> 
<h3 id="9.%20SUBSTITUTE%20%E5%AD%97%E7%AC%A6%E6%9B%BF%E6%8D%A2%E5%87%BD%E6%95%B0">9. SUBSTITUTE 字符替换函数</h3> 
<ul><li> = substitute（ 选中单元格，需替换的文本，新文本，mun_替换第几个）</li><li>文本记得加双引号</li><li>对指定的字符串进行替换</li><li>若有重复字符串，指定为第n个重复字符串，若不填写则每个重复字符串都会被替换</li></ul> 
<p>        e.g.1 屏蔽手机号码后四位</p> 
<p><img alt="watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiK5aW95L2zVmVuZXNzYQ==,size_15,color_FFFFFF,t_70,g_se,x_16" src="https://images2.imgbox.com/96/c7/pDpy6SrK_o.png"></p> 
<p>     e.g.2 把A2中的8替换为9</p> 
<p>              = substitute (A2,"8","9",1)</p> 
<p>     e.g.3  C1单元格字符内容为“嗯知道了知道了知道了可以”，</p> 
<p>              = substitute (C1,"知道了","行",1)  =嗯行知道了知道了可以</p> 
<p>              = substitute (C1,"知道了","行")     =嗯行行行可以</p> 
<p></p> 
<h3 id="10.%20TEXT%20%E6%96%87%E6%9C%AC%E8%BD%AC%E6%8D%A2%E5%87%BD%E6%95%B0">10. TEXT 文本转换函数</h3> 
<h4 id="%E2%91%A0%E6%8C%89%E6%8C%87%E5%AE%9A%E6%A0%BC%E5%BC%8F%EF%BC%8C%E5%B0%86%E6%95%B0%E5%80%BC%E8%BD%AC%E6%8D%A2%E4%B8%BA%E6%96%87%E6%9C%AC">①按指定格式，将数值转换为文本</h4> 
<p><strong>= </strong>TEXT(数值or单元格 , 待转换的值格式)  待转换的值格式需加双引号<br>    e.g.  单元格B1内容为“401” ，单元格B2内容为“2022/3/10” </p> 
<ul><li>        =TEXT(B1 , “0.00”)  =   401.00</li><li><span style="color:#be191c;"><strong>        =TEXT(B2 , “YYYY年M月D日”)  =2022年3月14日</strong></span></li></ul> 
<p></p> 
<h4 id="%E2%91%A1%E5%85%B6%E4%BB%96%E6%96%87%E6%9C%AC%E6%B8%85%E6%B4%97%E6%96%B9%E6%B3%95%EF%BC%9A%E5%88%A9%E7%94%A8%E8%AE%B0%E4%BA%8B%E6%9C%AC">②其他文本清洗方法：利用记事本</h4> 
<p>当日期包含了过多数据，不便于筛选查看。可插入辅助列，利用文本清洗，转换为具体到月份的数据列。以下为例，现需将下列包含具体日期的A列，转换为文本为xx年xx月的格式，以便于后期使用数据透视表和数据筛选。</p> 
<p class="img-center"><img alt="" height="551" src="https://images2.imgbox.com/44/26/R4DcwlRc_o.png" width="295"></p> 
<ul><li>复制该列数据，粘贴为辅助列 首行改为【月份】 → 选中辅助列 - 设置单元格格式 -设为xx年x月的形式 → 复制该列所有数据</li><li>打开记事本 → 粘贴，如下</li></ul> 
<p class="img-center"><img alt="" height="325" src="https://images2.imgbox.com/27/3a/4AH3PI05_o.png" width="277"></p> 
<ul><li> 返回excel，选中该辅助列 → 设置单元格格式 → 将该列全部转为【文本】格式</li><li>用 Ctrl + A 全选中粘贴在记事本的内容 →复制记事本的文本 → 选中辅助列全列或首行 →粘贴</li><li>即可把该列全部转为文本格式。可利用辅助列快速筛选</li></ul> 
<p class="img-center"><img alt="" height="569" src="https://images2.imgbox.com/1f/cf/ykOt1RaJ_o.png" width="277"></p> 
<p></p> 
<h4 id="%C2%A0%E2%91%A2%E5%B0%86%E6%96%87%E6%9C%AC%E8%BD%AC%E6%8D%A2%E4%B8%BA%E6%95%B0%E5%80%BC"> ③ 将文本转换为数值</h4> 
<p>可以使用函数转换，但<span style="color:#be191c;">最简便的方法是分列</span>：</p> 
<ul><li>数据 - 分列 → 分隔符号<span style="color:#7b7f82;">（无需操作，默认项）</span>→ 列数据格式 - 常规<span style="color:#7b7f82;">（无需操作，默认项）</span><span style="color:#333333;">→ 完成</span></li></ul> 
<p></p> 
<h2 id="11.%E7%94%A8%E6%9F%A5%E6%89%BE%E5%92%8C%E6%9B%BF%E6%8D%A2%E7%9A%84%E6%B3%A8%E6%84%8F%E7%82%B9">11.用查找和替换的注意点</h2> 
<ul><li> <p>如只替换数值内容为0的单元格，为避免替换到所有包含0的单元格，</p> </li><li> <p>在查找替换时，要设置选项 ：</p> </li><li> <p class="img-center"><img alt="" height="246" src="https://images2.imgbox.com/f2/e9/i0Sw40xV_o.png" width="547"></p> </li><li>点开  选项 → 勾选   单元格匹配</li></ul> 
<p class="img-center"><img alt="" height="333" src="https://images2.imgbox.com/96/8b/cQzwgzqm_o.png" width="593"></p> 
<p></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0b28dd0fa29e9990f7ecdd52f355e0bf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Shell | 查看进程的方法的不完全总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c23d208f7becfaba845f88a0edf914ed/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">线程不安全的解决方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>