<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>若依微服务版怎样新增业务子模块并使用代码生成实现对表的增删改查 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="若依微服务版怎样新增业务子模块并使用代码生成实现对表的增删改查" />
<meta property="og:description" content="场景 若依微服务版手把手教你本地搭建环境并运行前后端项目：
https://blog.csdn.net/BADAO_LIUMANG_QIZHI/article/details/109363303
在前面已经将若依微服务版的项目在本地搭建起来之后，怎样开发具体的业务。
搭建好之后的项目结构里，ruoyi-modules是存放业务模块的位置。
ruoyi-fzys就是新增的业务。
注： 博客：
https://blog.csdn.net/badao_liumang_qizhi
关注公众号
霸道的程序猿
获取编程相关电子书、教程推送与免费下载。
实现 新增业务模块并配置 按照项目的结构设计，业务模块的位置是在ruoyi-modules下，所以在此模块上右键-new-Module
点击确定后
然后点击next
为了和之前的模块统一风格的命名方式，所以这里新建的module的坐标是ruoyi-fzyscontrol，然后点击next
包括module的名字的命名风格，统一以ruoyi-modules-业务模块名的格式。
新增完模块之后，此业务模块就是上面ruoyi-modules的子模块，可以打开ruoyi-modules的pom.xml
可以看到已经自动将新增的业务模块添加到此业务模块下了
然后打开ruoyi-modules-system的系统模块的pom.xml,将其dependencies下和build下的代码复制到上面新建业务模块的pom.xml文件中
当前是如下代码，具体根据自己版本的pom文件去复制
&lt;dependencies&gt; &lt;!-- SpringCloud Ailibaba Nacos --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- SpringCloud Ailibaba Nacos Config --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- SpringCloud Ailibaba Sentinel --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- SpringBoot Actuator --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- Swagger --&gt; &lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt; &lt;version&gt;${swagger.fox.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Mysql Connector --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e815519efc7a859ac514bac6653a9025/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-06T09:21:54+08:00" />
<meta property="article:modified_time" content="2020-11-06T09:21:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">若依微服务版怎样新增业务子模块并使用代码生成实现对表的增删改查</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>场景</h2> 
<p>若依微服务版手把手教你本地搭建环境并运行前后端项目：</p> 
<p><a href="https://blog.csdn.net/BADAO_LIUMANG_QIZHI/article/details/109363303">https://blog.csdn.net/BADAO_LIUMANG_QIZHI/article/details/109363303</a></p> 
<p>在前面已经将若依微服务版的项目在本地搭建起来之后，怎样开发具体的业务。</p> 
<p> </p> 
<p><img alt="" height="687" src="https://images2.imgbox.com/41/98/M8eH8muP_o.jpg" width="644"></p> 
<p>搭建好之后的项目结构里，ruoyi-modules是存放业务模块的位置。</p> 
<p>ruoyi-fzys就是新增的业务。</p> 
<p>注： </p> 
<p>博客：<br><a href="https://blog.csdn.net/badao_liumang_qizhi">https://blog.csdn.net/badao_liumang_qizhi</a><br> 关注公众号<br> 霸道的程序猿<br> 获取编程相关电子书、教程推送与免费下载。</p> 
<h2>实现</h2> 
<h3>新增业务模块并配置</h3> 
<p>按照项目的结构设计，业务模块的位置是在ruoyi-modules下，所以在此模块上右键-new-Module</p> 
<p> </p> 
<p><img alt="" height="723" src="https://images2.imgbox.com/04/09/LtISsfVv_o.jpg" width="1200"></p> 
<p>点击确定后</p> 
<p> </p> 
<p><img alt="" height="707" src="https://images2.imgbox.com/15/62/WhWOuF5Q_o.jpg" width="1200"></p> 
<p>然后点击next</p> 
<p> </p> 
<p><img alt="" height="742" src="https://images2.imgbox.com/58/65/WC4KA4UT_o.jpg" width="1200"></p> 
<p>为了和之前的模块统一风格的命名方式，所以这里新建的module的坐标是ruoyi-fzyscontrol，然后点击next</p> 
<p> </p> 
<p><img alt="" height="621" src="https://images2.imgbox.com/1a/f7/a9D8onoE_o.jpg" width="1200"></p> 
<p>包括module的名字的命名风格，统一以ruoyi-modules-业务模块名的格式。</p> 
<p>新增完模块之后，此业务模块就是上面ruoyi-modules的子模块，可以打开ruoyi-modules的pom.xml</p> 
<p> </p> 
<p><img alt="" height="849" src="https://images2.imgbox.com/69/de/w3Jd6m7v_o.jpg" width="1067"></p> 
<p>可以看到已经自动将新增的业务模块添加到此业务模块下了</p> 
<p>然后打开ruoyi-modules-system的系统模块的pom.xml,将其dependencies下和build下的代码复制到上面新建业务模块的pom.xml文件中</p> 
<p>当前是如下代码，具体根据自己版本的pom文件去复制</p> 
<pre><code>    &lt;dependencies&gt;
     
     &lt;!-- SpringCloud Ailibaba Nacos --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;
        &lt;/dependency&gt;
       
        &lt;!-- SpringCloud Ailibaba Nacos Config --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;
        &lt;/dependency&gt;
       
     &lt;!-- SpringCloud Ailibaba Sentinel --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;/artifactId&gt;
        &lt;/dependency&gt;
       
     &lt;!-- SpringBoot Actuator --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
        &lt;/dependency&gt;
  
        &lt;!-- Swagger --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.springfox&lt;/groupId&gt;
            &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;
            &lt;version&gt;${swagger.fox.version}&lt;/version&gt;
        &lt;/dependency&gt;
  
        &lt;!-- Mysql Connector --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
        &lt;/dependency&gt;
       
        &lt;!-- Ruoyi Common Security --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.ruoyi&lt;/groupId&gt;
            &lt;artifactId&gt;ruoyi-common-security&lt;/artifactId&gt;
        &lt;/dependency&gt;
       
        &lt;!-- Ruoyi Common Datascope --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.ruoyi&lt;/groupId&gt;
            &lt;artifactId&gt;ruoyi-common-datascope&lt;/artifactId&gt;
        &lt;/dependency&gt;
       
        &lt;!-- Ruoyi Common Log --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.ruoyi&lt;/groupId&gt;
            &lt;artifactId&gt;ruoyi-common-log&lt;/artifactId&gt;
        &lt;/dependency&gt;
       
        &lt;!-- Ruoyi Common Swagger --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.ruoyi&lt;/groupId&gt;
            &lt;artifactId&gt;ruoyi-common-swagger&lt;/artifactId&gt;
        &lt;/dependency&gt;
       
        &lt;!-- RuoYi Common Redis--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.ruoyi&lt;/groupId&gt;
            &lt;artifactId&gt;ruoyi-common-redis&lt;/artifactId&gt;
        &lt;/dependency&gt;

    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;repackage&lt;/goal&gt;
                        &lt;/goals&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;</code></pre> 
<p>然后在新建模块下新建包com.ruoyi.fzyscontrol</p> 
<p> </p> 
<p><img alt="" height="541" src="https://images2.imgbox.com/d3/dd/QA3SWawM_o.jpg" width="1200"></p> 
<p>然后将前面system模块的启动类复制到新建业务的包下并更改名字</p> 
<p> </p> 
<p><img alt="" height="479" src="https://images2.imgbox.com/ab/03/7O8dt2wN_o.jpg" width="1051"></p> 
<p>更改启动类里面的类名和要启动的类名以及启动成功的输出内容。</p> 
<p> </p> 
<p><img alt="" height="719" src="https://images2.imgbox.com/bf/74/SJNvkC2a_o.jpg" width="1200"></p> 
<p>然后将system的yml配置文件复制到新建模块一份，并修改该模块的端口号，这里是9205,以及应用名称</p> 
<p> </p> 
<p>示例代码如下</p> 
<pre><code># Tomcat
server:
  port: 9205

# Spring
spring:
  application:
    # 应用名称
    name: ruoyi-fzyscontrol
  profiles:
    # 环境配置
    active: dev
  cloud:
    nacos:
      discovery:
        # 服务注册地址
        server-addr: 10.61.37.60:8848
      config:
        # 配置中心地址
        server-addr: 10.61.37.60:8848
        # 配置文件格式
        file-extension: yml
        # 共享配置
        shared-dataids: application-${spring.profiles.active}.${spring.cloud.nacos.config.file-extension}</code></pre> 
<p>然后登录Nacos配置中心，找到配置列表，选择ruoyi-system-dev.yml，点击克隆，并更改Data Id 为ruoyi-fzyscontrol-dev.yml</p> 
<p>点击开始克隆</p> 
<p> </p> 
<p><img alt="" height="834" src="https://images2.imgbox.com/9c/d4/GqIS4iZE_o.jpg" width="1200"></p> 
<p>然后再选中新克隆的配置文件，点击编辑，将搜索的指定包名的路径改为com.ruoyi.fzyscontrol，这里的包名要与后面生成代码时相对应</p> 
<p>注意下面的配置mapper的扫描，找到所有mapper.xml映射文件的地方</p> 
<p>这里的路径是在配置的在resources下的mapper目录下的任意子目录下的任意.xml文件</p> 
<p> </p> 
<p><img alt="" height="709" src="https://images2.imgbox.com/14/36/QruHdKnW_o.jpg" width="1200"></p> 
<p>示例代码如下</p> 
<pre><code># Spring
spring:
  redis:
    host: *****
    port: *****
    password: ******
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
   url:jdbc:mysql://*******:3306/fzys?useUnicode=true&amp;characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=true&amp;serverTimezone=GMT%2B8
    username: root
    password: 1234

# Mybatis配置
mybatis:
    # 搜索指定包别名
    typeAliasesPackage: com.ruoyi.fzyscontrol
    # 配置mapper的扫描，找到所有的mapper.xml映射文件
    mapperLocations: classpath:mapper/**/*.xml

# swagger 配置
swagger:
  title: 系统模块接口文档
  license: Powered By ruoyi
  licenseUrl: https://ruoyi.vip
  authorization:
    name: RuoYi OAuth
    auth-regex: ^.*$
    authorization-scope-list:
      - scope: server
        description: 客户端授权范围
    token-url-list:
      - http://localhost:8080/auth/oauth/token</code></pre> 
<p>注意将redis和mysql的连接改为自己的。</p> 
<p>然后再找到ruoyi-gateway-dev.yml网管的配置文件，点击编辑</p> 
<p> </p> 
<p><img alt="" height="690" src="https://images2.imgbox.com/a0/84/1G6hTtzy_o.jpg" width="1200"></p> 
<p>仿照上面system的配置复制出来一份，并修改为新模块所对应的。</p> 
<p>system的配置</p> 
<pre><code>        # 系统模块
        - id: ruoyi-system
          uri: lb://ruoyi-system
          predicates:
            - Path=/system/**
          filters:
            - StripPrefix=1</code></pre> 
<p>新建业务的配置</p> 
<pre><code>          # fzys控制模块
        - id: ruoyi-fzyscontrol
          uri: lb://ruoyi-fzyscontrol
          predicates:
            - Path=/fzyscontrol/**
          filters:
            - StripPrefix=1</code></pre> 
<p> </p> 
<p><img alt="" height="729" src="https://images2.imgbox.com/a5/3b/0V5Wp0Jn_o.jpg" width="1200"></p> 
<p>更改完之后点击发布。</p> 
<h3>启动项目并生成代码</h3> 
<p>依次找到ruoyi-gateway、ruoyi-auth、ruoyi-system、ruoyi-gen下的启动类去启动，注意启动顺序。</p> 
<p>网管模块和认证模块要在系统模块和代码生成模块之前。</p> 
<p>然后再启动刚才新建的业务模块，此时一个启动五个模块。</p> 
<p> </p> 
<p><img alt="" height="560" src="https://images2.imgbox.com/44/b4/xxIctcNE_o.jpg" width="1200"></p> 
<p>此时可以去Nacos服务注册中心的服务列表查看，回看到此时会有五个服务。</p> 
<p> </p> 
<p><img alt="" height="656" src="https://images2.imgbox.com/bd/be/CNoaG01f_o.jpg" width="1200"></p> 
<p>此时就可以打开此项目连接的数据库进行设计业务表，这里设计一个表</p> 
<p> </p> 
<p><img alt="" height="312" src="https://images2.imgbox.com/43/70/4qDn8EIP_o.jpg" width="1077"></p> 
<p>然后打开前端项目ruoyi-ui</p> 
<p>在终端中输入</p> 
<pre><code>npm install</code></pre> 
<p>安装前端项目依赖</p> 
<p> </p> 
<p><img alt="" height="511" src="https://images2.imgbox.com/c9/e2/LDz6dEWZ_o.jpg" width="1053"></p> 
<p>安装项目依赖成功之后找到项目的vue.config.js</p> 
<p>修改前端项目的端口，默认是80，这里修改为90,</p> 
<p> </p> 
<p><img alt="" height="613" src="https://images2.imgbox.com/a5/de/feY84iOE_o.jpg" width="1200"></p> 
<p>然后修改代理的后端的请求地址，这里要与上面后台网关模块中yml配置文件中配置的网关模块相对应</p> 
<p>默认网关是8080，这里为了避免端口冲突改为8888</p> 
<p>所以这里前端的代理地址的端口也是8888</p> 
<p> </p> 
<p><img alt="" height="715" src="https://images2.imgbox.com/f0/b4/O21Fwna0_o.jpg" width="1200"></p> 
<p>启动前端项目</p> 
<pre><code>npm run dev</code></pre> 
<p>启动后打开浏览器访问</p> 
<p><a href="http://localhost:90/" rel="nofollow">http://localhost:90/</a></p> 
<p> </p> 
<p><img alt="" height="751" src="https://images2.imgbox.com/25/39/3FgeWzZW_o.jpg" width="1200"></p> 
<p>登录成功后找到系统工具-代码生成-导入，选择前面新建的数据库中的表，导入之后，选择并编辑</p> 
<p> </p> 
<p><img alt="" height="527" src="https://images2.imgbox.com/43/49/Y2ZEoql9_o.jpg" width="1200"></p> 
<p>这里修改生成代码时的生成信息，注意这里的包名要与上面配置mapper扫描包的路径一致，并且这里还加了具体业务的包。</p> 
<p>这个功能是信号灯控制功能，最终是属于运行调度管理菜单下的功能，所以这里配置的包路径追加了一层运行调度管理，</p> 
<p>生成的模块名也叫运行调度管理，但是生成的业务名是其下具体的信号灯控制。</p> 
<p>然后点击提交后点击生成，会将生成代码的压缩包下载到本地，解压之后的目录</p> 
<p> </p> 
<p><img alt="" height="452" src="https://images2.imgbox.com/ef/91/AyJ00ulL_o.jpg" width="984"></p> 
<p>来到项目中新建模块的包下将后端代码复制到相应的位置</p> 
<p> </p> 
<p><img alt="" height="565" src="https://images2.imgbox.com/b8/0c/EdFpj2nH_o.jpg" width="1200"></p> 
<p>注意这里的复制后的代码的路径要和你在Nacos中配置文件的配置一致。</p> 
<p>然后打开ruoyi-ui前端代码，将生成的vue目录下的前端代码复制到相应的api和views下</p> 
<p> </p> 
<p><img alt="" height="687" src="https://images2.imgbox.com/36/6c/IbFSkcyk_o.jpg" width="1200"></p> 
<p>注意这里的路径，要与vue中调用js方法的路径以及菜单按钮路径中调用vue页面的路径一致。</p> 
<p>然后连接到数据库，运行代码生成时的sql文件，将菜单项插入到菜单表中</p> 
<p> </p> 
<p><img alt="" height="505" src="https://images2.imgbox.com/99/f8/44r2geUf_o.jpg" width="1200"></p> 
<p>此时会在菜单表中生成具体的菜单</p> 
<p> </p> 
<p><img alt="" height="264" src="https://images2.imgbox.com/d9/09/2FBEv8V7_o.jpg" width="1200"></p> 
<h3>前后端联调</h3> 
<p>因为生成的代码可能会有路径或者url等不对应的问题，所以要实现前后端的联调还需要进行调整。</p> 
<p>打开前端代码的js文件的请求后台的url路径为</p> 
<p>/runcontrolmange/signallightcontrol/list</p> 
<p>然后打开后端controller中具体方法</p> 
<p> </p> 
<p><img alt="" height="692" src="https://images2.imgbox.com/72/5f/ksADaiQw_o.jpg" width="1200"></p> 
<p>如果这里的controller的路径不对应的话进行修改。</p> 
<p>此时路径还是不能匹配。因为之前在Nacos的配置中心配置网关时设置了请求时的前缀</p> 
<p> </p> 
<p><img alt="" height="798" src="https://images2.imgbox.com/f8/ab/S8u4hKw1_o.jpg" width="1075"></p> 
<p>所以在请求具体的服务时，前端必须在对应后台Controller的基础上，添加一个网关管理的服务的前缀。</p> 
<p> </p> 
<p><img alt="" height="365" src="https://images2.imgbox.com/c6/dc/ItubXFVv_o.jpg" width="1200"></p> 
<p>所以在前端项目中进行请求的js的url中要根据具体请求的服务添加请求前缀</p> 
<p> </p> 
<p>此时访问具体的菜单即可获取到服务</p> 
<p> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0dbc75a9c44064c93175f39324f8754d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">antimalware service executable占用内存过高_svchost占用内存过高是怎么回事</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/11d2574452c4e7be3d142f360f531c8e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Plugin “GsonFormat“ is incompatible (supported only in IntelliJ IDEA).报错</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>