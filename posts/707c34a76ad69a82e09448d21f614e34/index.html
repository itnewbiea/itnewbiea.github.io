<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>element ui @selection-change多选对数据的操作 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="element ui @selection-change多选对数据的操作" />
<meta property="og:description" content="&lt;template&gt; &lt;div&gt; &lt;el-row class=&#34;top-block padding-20px&#34; :gutter=&#34;40&#34;&gt; &lt;el-col :xs=&#34;24&#34; :sm=&#34;12&#34; :lg=&#34;6&#34;&gt; &lt;el-row type=&#34;flex&#34; class=&#34;row-bg&#34; justify=&#34;&#34;&gt; &lt;el-col :xs=&#34;6&#34; :sm=&#34;6&#34; :lg=&#34;6&#34; class=&#34;flex-align-center&#34;&gt; &lt;label for=&#34;&#34;&gt;激活码：&lt;/label&gt; &lt;/el-col&gt; &lt;el-col :xs=&#34;18&#34; :sm=&#34;18&#34; :lg=&#34;18&#34;&gt; &lt;el-input v-model=&#34;input&#34; placeholder=&#34;请输入内容&#34;&gt;&lt;/el-input&gt; &lt;/el-col&gt; &lt;/el-row&gt; &lt;/el-col&gt; &lt;el-col :xs=&#34;24&#34; :sm=&#34;12&#34; :lg=&#34;6&#34;&gt; &lt;el-row type=&#34;flex&#34; class=&#34;row-bg&#34; justify=&#34;&#34;&gt; &lt;el-col :xs=&#34;6&#34; :sm=&#34;6&#34; :lg=&#34;6&#34; class=&#34;flex-align-center&#34;&gt; &lt;label for=&#34;&#34;&gt;分配经销商：&lt;/label&gt; &lt;/el-col&gt; &lt;el-col :xs=&#34;18&#34; :sm=&#34;18&#34; :lg=&#34;18&#34;&gt; &lt;el-input v-model=&#34;admin&#34; placeholder=&#34;请输入内容&#34;&gt;&lt;/el-input&gt; &lt;/el-col&gt; &lt;/el-row&gt; &lt;/el-col&gt; &lt;el-col :xs=&#34;24&#34; :sm=&#34;12&#34; :lg=&#34;6&#34;&gt; &lt;el-row type=&#34;flex&#34; class=&#34;row-bg&#34; justify=&#34;&#34;&gt; &lt;el-col :xs=&#34;6&#34; :sm=&#34;6&#34; :lg=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/707c34a76ad69a82e09448d21f614e34/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-06T16:18:23+08:00" />
<meta property="article:modified_time" content="2021-09-06T16:18:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">element ui @selection-change多选对数据的操作</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre><code>&lt;template&gt;
  &lt;div&gt;
    &lt;el-row class="top-block padding-20px" :gutter="40"&gt;
      &lt;el-col :xs="24" :sm="12" :lg="6"&gt;
        &lt;el-row type="flex" class="row-bg" justify=""&gt;
          &lt;el-col :xs="6" :sm="6" :lg="6" class="flex-align-center"&gt;
            &lt;label for=""&gt;激活码：&lt;/label&gt;
          &lt;/el-col&gt;
          &lt;el-col :xs="18" :sm="18" :lg="18"&gt;
            &lt;el-input v-model="input" placeholder="请输入内容"&gt;&lt;/el-input&gt;
          &lt;/el-col&gt;
        &lt;/el-row&gt;
      &lt;/el-col&gt;
      &lt;el-col :xs="24" :sm="12" :lg="6"&gt;
        &lt;el-row type="flex" class="row-bg" justify=""&gt;
          &lt;el-col :xs="6" :sm="6" :lg="6" class="flex-align-center"&gt;
            &lt;label for=""&gt;分配经销商：&lt;/label&gt;
          &lt;/el-col&gt;
          &lt;el-col :xs="18" :sm="18" :lg="18"&gt;
            &lt;el-input v-model="admin" placeholder="请输入内容"&gt;&lt;/el-input&gt;
          &lt;/el-col&gt;
        &lt;/el-row&gt;
      &lt;/el-col&gt;
      &lt;el-col :xs="24" :sm="12" :lg="6"&gt;
        &lt;el-row type="flex" class="row-bg" justify=""&gt;
          &lt;el-col :xs="6" :sm="6" :lg="6" class="flex-align-center"&gt;
            &lt;label for=""&gt;状态：&lt;/label&gt;
          &lt;/el-col&gt;
          &lt;el-col :xs="18" :sm="18" :lg="18"&gt;
            &lt;el-select v-model="value" placeholder="请选择" style="width: 100%"&gt;
              &lt;el-option
                v-for="item in options"
                :key="item.value"
                :label="item.label"
                :value="item.value"
              &gt;
              &lt;/el-option&gt;
            &lt;/el-select&gt;
          &lt;/el-col&gt;
        &lt;/el-row&gt;
      &lt;/el-col&gt;
      &lt;el-col :xs="24" :sm="12" :lg="6"&gt;
        &lt;el-row type="flex" class="row-bg" justify="start"&gt;
          &lt;el-button type="primary" @click="getcodelist"&gt;查询&lt;/el-button&gt;
          &lt;el-button @click="reset"&gt;重置&lt;/el-button&gt;
        &lt;/el-row&gt;
      &lt;/el-col&gt;
    &lt;/el-row&gt;
    &lt;el-row class="padding-20px" :gutter="20"&gt;
      &lt;el-col :xs="24" :sm="12" :lg="12"&gt;
        &lt;el-button type="primary" @click="distriButecode('')"
          &gt;分配给经销商&lt;/el-button
        &gt;
        &lt;el-button type="primary" @click="cancelList('')"&gt;取消分配&lt;/el-button&gt;
      &lt;/el-col&gt;
    &lt;/el-row&gt;
    &lt;el-row&gt;
      &lt;el-table
        ref="multipleTable"
        :data="codeList"
        tooltip-effect="dark"
        style="width: 100%"
        @selection-change="handleSelectionChange"
        :header-cell-style="{ background: '#eef1f6', color: '#606266' }"
      &gt;
        &lt;el-table-column type="selection" width="55"&gt; &lt;/el-table-column&gt;
        &lt;el-table-column label="SN编号" prop="code"&gt;
          &lt;!-- &lt;template slot-scope="scope"&gt;{<!-- -->{ scope.row.date }}&lt;/template&gt; --&gt;
        &lt;/el-table-column&gt;
        &lt;el-table-column prop="type" label="设备型号"&gt; &lt;/el-table-column&gt;
        &lt;el-table-column
          prop="belongDealer"
          label="经销商"
          show-overflow-tooltip
        &gt;
        &lt;/el-table-column&gt;
        &lt;el-table-column prop="belongUser" label="用户" show-overflow-tooltip&gt;
        &lt;/el-table-column&gt;
        &lt;el-table-column prop="status" label="激活状态" show-overflow-tooltip&gt;
        &lt;/el-table-column&gt;
      &lt;/el-table&gt;
    &lt;/el-row&gt;
    &lt;el-row&gt;
      &lt;Pagination
        :total="total"
        v-on:size-change="sizeChange"
        v-on:current-change="currentChange"
        :currentPage="form.pageNo"
        :pageSize="form.pageSize"
      /&gt;
    &lt;/el-row&gt;
    &lt;ActivationCodeAssignmentDialog ref="activationCodeAssignmentDialog" /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import { cancelcode } from "@/http";
import { distributecode } from "@/http";
import { codelist } from "@/http";
import Pagination from "@/components/pagination";
import ActivationCodeAssignmentDialog from "@/components/dialog/ActivationCodeAssignment";
export default {
  components: {
    Pagination,
    ActivationCodeAssignmentDialog,
  },
  data() {
    return {
      codeList: [],
      touserid: "",
      activationId: "",
      input: "",
      admin: "",
      options: [
        {
          value: "",
          label: "全部",
        },
        {
          value: "0",
          label: "未激活",
        },
        {
          value: "1",
          label: "激活",
        },
        {
          value: "-1",
          label: "未分配",
        },
      ],
      value: "",
      multipleSelection: [],
      form: {
        pageNo: 1,
        pageSize: 10,
      },
      total: 0,
    };
  },
  mounted() {
    this.getcodelist();
  },
  methods: {
    reset() {
      this.form.pageNo = 1;
      this.getcodelist();
    },
    getcodelist() {
      codelist({
        ...this.form,
      }).then((res) =&gt; {
        console.log(res);
        this.codeList = res.data.data.list;
        this.total = res.data.data.count;
        this.pageNo = res.data.data.pageNo;
        if (res.data.code === "000000") {
        } else {
          this.$message.error("加载失败");
        }
      });
    },
    getcancelCode(touserid, activationId) {
      cancelcode({
        touserid, //用户id
        activationId, // 激活码id
      }).then((res) =&gt; {
        console.log(res);
      });
    },
    cancelList() {
      if (this.multipleSelection.length) {
        let touserid = this.multipleSelection.map((item) =&gt; item.id).join(",");
        let activationId = this.multipleSelection.map((item) =&gt; item.code).join(",");
        this.getcancelCode(touserid, activationId);
      }
    },
    toggleSelection(rows) {
      if (rows) {
        rows.forEach((row) =&gt; {
          this.$refs.multipleTable.toggleRowSelection(row);
        });
      } else {
        this.$refs.multipleTable.clearSelection();
      }
    },
    handleSelectionChange(val) {
      this.multipleSelection = val;
    },
    sizeChange(val) {
      this.form.pageSize = val;
      this.getcodelist();
      console.warn(val);
    },
    currentChange(val) {
      this.form.pageNo = val;
      this.getcodelist();
      console.warn(val);
    },
    // 分配
    getDistributecode(touserid, activationId) {
      distributecode({
        touserid, //用户id
        activationId, // 激活码id
      }).then((res) =&gt; {
        console.log(res);
      });
    },
    distriButecode() {
      if (this.multipleSelection.length) {
        let touserid = this.multipleSelection.map((item) =&gt; item.id).join(",");
        let activationId = this.multipleSelection.map((item) =&gt; item.code).join(",");
        this.getDistributecode(touserid, activationId);
        this.$refs.activationCodeAssignmentDialog.show({touserid,activationId,});
      }
    },
    deleteItem(item) {
      this.$alert("确定要删除吗", "提示", {
        confirmButtonText: "确定",
        showCancelButton: true,
        showClose: false,
        callback: (action) =&gt; {
          this.$message({
            type: "info",
            message: `action: ${action}`,
          });
        },
      });
    },
    disabledItem(item) {
      this.$alert("确定要停用吗", "提示", {
        confirmButtonText: "确定",
        showCancelButton: true,
        showClose: false,
        callback: (action) =&gt; {
          this.$message({
            type: "info",
            message: `action: ${action}`,
          });
        },
      });
    },
  },
};
&lt;/script&gt;

&lt;style&gt;&lt;/style&gt;
</code></pre> 
<p>handleSelectionChange(val) { this.multipleSelection = val; }//val 为选中数据的集合</p> 
<p><img alt="" height="420" src="https://images2.imgbox.com/9b/6d/DPYg14ML_o.png" width="1155"></p> 
<p> </p> 
<p>列表的数据选择之后会保存到multipleSelection里面,通过this.multipleSelection.prop字段 取得每一个选项的值，prop字段就是表格里面子项的prop值。</p> 
<p>this.multipleSelection.length为选择了多少项.</p> 
<p><img alt="" height="150" src="https://images2.imgbox.com/1b/c6/k3KkAeTM_o.png" width="699"></p> 
<p> 参考这篇map的用法<a href="https://www.jianshu.com/p/e87b195f6943" rel="nofollow">https://www.jianshu.com/p/e87b195f6943</a></p> 
<pre><code>let activationId = this.multipleSelection.map((item) =&gt; item.status)</code></pre> 
<p>map创建的数组放item中的staus字段</p> 
<pre><code>let activationId = this.multipleSelection.map((item) =&gt; item.status).join(",");</code></pre> 
<p>map创建的数组放item中的staus字段，多选时将字段用逗号隔开，放到一个字符串中</p> 
<p>效果：<img alt="" height="108" src="https://images2.imgbox.com/6d/77/LLVzW6O0_o.png" width="1200"></p> 
<p> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c7e665db6269a666a170ee7835e7b485/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">支持给手机充电（快充）的无线领夹麦克风解决方案</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c36ef88de9f2242aa0bc9f072846ddb1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">部署华为云示例上云项目，基于Springboot的论坛实例，的故事</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>