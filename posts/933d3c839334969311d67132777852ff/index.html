<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>微信小程序--》从零实现小程序项目案例 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="微信小程序--》从零实现小程序项目案例" />
<meta property="og:description" content="🏍️作者简介：大家好，我是亦世凡华、渴望知识储备自己的一名在校大学生
🛵个人主页：亦世凡华、
🛺系列专栏：微信小程序
🚲座右铭：人生亦可燃烧，亦可腐败，我愿燃烧，耗尽所有光芒。
👀引言
⚓经过web前端开发的学习，相信大家对于前端开发有了一定深入的了解，今天我开设了微信小程序专栏，主要想从移动端开发方向进一步发展，而对于我来说写移动端博文的第一站就是小程序开发，希望看到我文章的朋友能对你有所帮助。
目录
配置导航栏
配置tabBar
实现页面轮播图
实现页面九宫格
实现底部图片
实现九宫格的导航跳转
实现导航跳转时设置标题内容
实现商品列表数据的渲染
实现上拉加载以及loading效果
实现数据是否加载完毕的判断
实现下拉刷新功能
实现wxs处理手机号
最终的实现效果
今天借助黑马的本地生活案例，加强一下自己对小程序的学习，并将学习过程分享出来，希望能和以前学习的知识相互印证。现在开始：
配置导航栏 导航栏是小程序的门户，用户进来第一眼看到的便是导航栏，其起着对当前小程序主题的概括。而我们 新建的小程序 时，第一步变开始配置导航栏。如下：
配置tabBar 因为配置tabBar需要借助字体图标，我这里平常喜欢使用阿里云字体图标库，所以需要先去阿里云库中找到相关图标：其官方网站：网站链接 。
随便找两个，一个作为未点击(未激活)状态，另一个作为已点击(已激活)状态：
因为我是属于类似做一个小demo ，图标就随便选了，在正式项目必须严谨了，选好图标命名如下
准备好图片资源之后就要在 app.json 文件中配置tabBar了，配置代码如下：
{ &#34;pages&#34;:[ &#34;pages/home/home&#34;, &#34;pages/message/message&#34;, &#34;pages/contact/contact&#34; ], &#34;window&#34;:{ &#34;backgroundTextStyle&#34;:&#34;light&#34;, &#34;navigationBarBackgroundColor&#34;: &#34;#008c8c&#34;, &#34;navigationBarTitleText&#34;: &#34;本地生活&#34;, &#34;navigationBarTextStyle&#34;:&#34;white&#34; }, &#34;tabBar&#34;: { &#34;list&#34;: [{ &#34;pagePath&#34;: &#34;pages/home/home&#34;, &#34;text&#34;: &#34;首页&#34;, &#34;iconPath&#34;: &#34;/images/home.png&#34;, &#34;selectedIconPath&#34;: &#34;/images/home-active.png&#34; },{ &#34;pagePath&#34;: &#34;pages/message/message&#34;, &#34;text&#34;: &#34;消息&#34;, &#34;iconPath&#34;: &#34;/images/message.png&#34;, &#34;selectedIconPath&#34;: &#34;/images/message-active.png&#34; },{ &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/933d3c839334969311d67132777852ff/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-06T17:18:04+08:00" />
<meta property="article:modified_time" content="2023-02-06T17:18:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">微信小程序--》从零实现小程序项目案例</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p>🏍️作者简介：大家好，我是亦世凡华、渴望知识储备自己的一名在校大学生</p> 
 <p>🛵个人主页：<a href="https://blog.csdn.net/qq_53123067?spm=1000.2115.3001.5343" title="亦世凡华、">亦世凡华、</a></p> 
 <p>🛺系列专栏：<a href="https://blog.csdn.net/qq_53123067/category_11919531.html?spm=1001.2014.3001.5482" title="微信小程序">微信小程序</a></p> 
 <p>🚲座右铭：人生亦可燃烧，亦可腐败，我愿燃烧，耗尽所有光芒。</p> 
</blockquote> 
<p>👀引言</p> 
<blockquote> 
 <p>       ⚓经过web前端开发的学习，相信大家对于前端开发有了一定深入的了解，今天我开设了微信小程序专栏，主要想从移动端开发方向进一步发展，而对于我来说写移动端博文的第一站就是小程序开发，希望看到我文章的朋友能对你有所帮助。</p> 
</blockquote> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E9%85%8D%E7%BD%AE%E5%AF%BC%E8%88%AA%E6%A0%8F-toc" style="margin-left:80px;"><a href="#%E9%85%8D%E7%BD%AE%E5%AF%BC%E8%88%AA%E6%A0%8F" rel="nofollow">配置导航栏</a></p> 
<p id="%E9%85%8D%E7%BD%AEtabBar-toc" style="margin-left:80px;"><a href="#%E9%85%8D%E7%BD%AEtabBar" rel="nofollow">配置tabBar</a></p> 
<p id="%E5%AE%9E%E7%8E%B0%E9%A1%B5%E9%9D%A2%E8%BD%AE%E6%92%AD%E5%9B%BE-toc" style="margin-left:80px;"><a href="#%E5%AE%9E%E7%8E%B0%E9%A1%B5%E9%9D%A2%E8%BD%AE%E6%92%AD%E5%9B%BE" rel="nofollow">实现页面轮播图</a></p> 
<p id="%E5%AE%9E%E7%8E%B0%E9%A1%B5%E9%9D%A2%E4%B9%9D%E5%AE%AB%E6%A0%BC-toc" style="margin-left:80px;"><a href="#%E5%AE%9E%E7%8E%B0%E9%A1%B5%E9%9D%A2%E4%B9%9D%E5%AE%AB%E6%A0%BC" rel="nofollow">实现页面九宫格</a></p> 
<p id="%E5%AE%9E%E7%8E%B0%E5%BA%95%E9%83%A8%E5%9B%BE%E7%89%87-toc" style="margin-left:80px;"><a href="#%E5%AE%9E%E7%8E%B0%E5%BA%95%E9%83%A8%E5%9B%BE%E7%89%87" rel="nofollow">实现底部图片</a></p> 
<p id="%E5%AE%9E%E7%8E%B0%E4%B9%9D%E5%AE%AB%E6%A0%BC%E7%9A%84%E5%AF%BC%E8%88%AA%E8%B7%B3%E8%BD%AC-toc" style="margin-left:80px;"><a href="#%E5%AE%9E%E7%8E%B0%E4%B9%9D%E5%AE%AB%E6%A0%BC%E7%9A%84%E5%AF%BC%E8%88%AA%E8%B7%B3%E8%BD%AC" rel="nofollow">实现九宫格的导航跳转</a></p> 
<p id="%E5%AE%9E%E7%8E%B0%E5%AF%BC%E8%88%AA%E8%B7%B3%E8%BD%AC%E6%97%B6%E8%AE%BE%E7%BD%AE%E6%A0%87%E9%A2%98%E5%86%85%E5%AE%B9-toc" style="margin-left:80px;"><a href="#%E5%AE%9E%E7%8E%B0%E5%AF%BC%E8%88%AA%E8%B7%B3%E8%BD%AC%E6%97%B6%E8%AE%BE%E7%BD%AE%E6%A0%87%E9%A2%98%E5%86%85%E5%AE%B9" rel="nofollow">实现导航跳转时设置标题内容</a></p> 
<p id="%E5%AE%9E%E7%8E%B0%E5%95%86%E5%93%81%E5%88%97%E8%A1%A8%E6%95%B0%E6%8D%AE%E7%9A%84%E6%B8%B2%E6%9F%93-toc" style="margin-left:80px;"><a href="#%E5%AE%9E%E7%8E%B0%E5%95%86%E5%93%81%E5%88%97%E8%A1%A8%E6%95%B0%E6%8D%AE%E7%9A%84%E6%B8%B2%E6%9F%93" rel="nofollow">实现商品列表数据的渲染</a></p> 
<p id="%E5%AE%9E%E7%8E%B0%E4%B8%8A%E6%8B%89%E5%8A%A0%E8%BD%BD%E4%BB%A5%E5%8F%8Aloading%E6%95%88%E6%9E%9C-toc" style="margin-left:80px;"><a href="#%E5%AE%9E%E7%8E%B0%E4%B8%8A%E6%8B%89%E5%8A%A0%E8%BD%BD%E4%BB%A5%E5%8F%8Aloading%E6%95%88%E6%9E%9C" rel="nofollow">实现上拉加载以及loading效果</a></p> 
<p id="%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E6%98%AF%E5%90%A6%E5%8A%A0%E8%BD%BD%E5%AE%8C%E6%AF%95%E7%9A%84%E5%88%A4%E6%96%AD-toc" style="margin-left:80px;"><a href="#%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E6%98%AF%E5%90%A6%E5%8A%A0%E8%BD%BD%E5%AE%8C%E6%AF%95%E7%9A%84%E5%88%A4%E6%96%AD" rel="nofollow">实现数据是否加载完毕的判断</a></p> 
<p id="%E5%AE%9E%E7%8E%B0%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0%E5%8A%9F%E8%83%BD-toc" style="margin-left:80px;"><a href="#%E5%AE%9E%E7%8E%B0%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0%E5%8A%9F%E8%83%BD" rel="nofollow">实现下拉刷新功能</a></p> 
<p id="%E5%AE%9E%E7%8E%B0wxs%E5%A4%84%E7%90%86%E6%89%8B%E6%9C%BA%E5%8F%B7-toc" style="margin-left:80px;"><a href="#%E5%AE%9E%E7%8E%B0wxs%E5%A4%84%E7%90%86%E6%89%8B%E6%9C%BA%E5%8F%B7" rel="nofollow">实现wxs处理手机号</a></p> 
<p id="%E6%9C%80%E7%BB%88%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%95%88%E6%9E%9C-toc" style="margin-left:80px;"><a href="#%E6%9C%80%E7%BB%88%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%95%88%E6%9E%9C" rel="nofollow">最终的实现效果</a></p> 
<hr id="hr-toc"> 
<p>今天借助黑马的本地生活案例，加强一下自己对小程序的学习，并将学习过程分享出来，希望能和以前学习的知识相互印证。现在开始：</p> 
<h4 id="%E9%85%8D%E7%BD%AE%E5%AF%BC%E8%88%AA%E6%A0%8F">配置导航栏</h4> 
<p>导航栏是小程序的门户，用户进来第一眼看到的便是导航栏，其起着对当前小程序主题的概括。而我们 <a class="link-info" href="https://z5qyj5pyi.blog.csdn.net/article/details/125818261" rel="nofollow" title="新建的小程序">新建的小程序</a> 时，第一步变开始配置导航栏。如下：</p> 
<p><img alt="" height="339" src="https://images2.imgbox.com/c2/71/hb4VBmec_o.png" width="1200"></p> 
<h4 id="%E9%85%8D%E7%BD%AEtabBar">配置tabBar</h4> 
<p>因为配置tabBar需要借助字体图标，我这里平常喜欢使用阿里云字体图标库，所以需要先去阿里云库中找到相关图标：其官方网站：<a class="link-info" href="https://www.iconfont.cn/" rel="nofollow" title="网站链接">网站链接</a> 。</p> 
<p>随便找两个，一个作为未点击(未激活)状态，另一个作为已点击(已激活)状态：</p> 
<p><img alt="" height="531" src="https://images2.imgbox.com/29/32/ar8jDQKW_o.png" width="1200"></p> 
<p>因为我是属于类似做一个小demo ，图标就随便选了，在正式项目必须严谨了，选好图标命名如下</p> 
<p><img alt="" height="316" src="https://images2.imgbox.com/71/29/6ZsOiR6q_o.png" width="1170"></p> 
<p>准备好图片资源之后就要在 app.json 文件中配置tabBar了，配置代码如下：</p> 
<pre><code class="language-bash">{
  "pages":[
    "pages/home/home",
    "pages/message/message",
    "pages/contact/contact"
  ],
  "window":{
    "backgroundTextStyle":"light", 
    "navigationBarBackgroundColor": "#008c8c", 
    "navigationBarTitleText": "本地生活",
    "navigationBarTextStyle":"white"
  },
  "tabBar": {
    "list": [{
      "pagePath": "pages/home/home",
      "text": "首页",
      "iconPath": "/images/home.png",
      "selectedIconPath": "/images/home-active.png"
    },{
      "pagePath": "pages/message/message",
      "text": "消息",
      "iconPath": "/images/message.png",
      "selectedIconPath": "/images/message-active.png"
    },{
      "pagePath": "pages/contact/contact",
      "text": "联系我们",
      "iconPath": "/images/contact.png",
      "selectedIconPath": "/images/contact-active.png"
    }]
  },
  "style": "v2",
  "sitemapLocation": "sitemap.json"
}</code></pre> 
<p><img alt="" src="https://images2.imgbox.com/9d/08/f5QziFXL_o.gif"></p> 
<h4 id="%E5%AE%9E%E7%8E%B0%E9%A1%B5%E9%9D%A2%E8%BD%AE%E6%92%AD%E5%9B%BE">实现页面轮播图</h4> 
<p>实现轮播图必须有图片资源，而在项目中一般是不会使用本地资源的，都是通过调用接口的形式拿到数据，在本项目中也是，因为轮播图是在 home 组件中进行使用，所有我们需要在home组件去调用接口，具体实现过程如下：</p> 
<p>在页面的初始数据data中定义一个数组，用于存放数据：</p> 
<p><img alt="" height="143" src="https://images2.imgbox.com/1e/e9/vhfSee65_o.png" width="956"></p> 
<p>调用微信的request方法，发起get请求访问接口拿到数据：</p> 
<pre><code class="language-javascript">// 获取轮播图的方法
getSwiperList(){
  wx.request({
    url: 'https://www.escook.cn/slides',
    method:'GET',
    success: (res)=&gt;{
      // 类似于React中的setState，将状态数据更新
      this.setData({
        SwiperList: res.data
      })
    }
  })
},</code></pre> 
<p>在生命周期onLoad，页面刚加载的时候，调用获取轮播图的方法：</p> 
<p><img alt="" height="216" src="https://images2.imgbox.com/39/9e/HfkVaMca_o.png" width="1068"></p> 
<p>在data存放的数据可以在控制台的AppData中看到：</p> 
<p><img alt="" height="429" src="https://images2.imgbox.com/30/31/oBMbvsN8_o.png" width="1116"></p> 
<p>拿到数据之后，我们就可以在wxml中制作页面效果了：</p> 
<pre><code class="language-javascript">&lt;!-- 轮播图区域 --&gt;
&lt;swiper indicator-dots circular autoplay interval="2000"&gt;
  &lt;swiper-item wx:for="{<!-- -->{SwiperList}}" wx:key="id"&gt;
    &lt;image src="{<!-- -->{item.image}}"&gt;&lt;/image&gt;
  &lt;/swiper-item&gt;
&lt;/swiper&gt;</code></pre> 
<p>属性可以参考我之前的文章：<a class="link-info" href="http://xn--ykq9j0kgey8vwln9hem80dltcea31ot6qd3pyw0btr05a" rel="nofollow" title="https://z5qyj5pyi.blog.csdn.net/article/details/125829071">https://z5qyj5pyi.blog.csdn.net/article/details/125829071</a> ，如下：</p> 
<p><img alt="" height="437" src="https://images2.imgbox.com/50/20/iLnUOWr4_o.png" width="1200"></p> 
<p>给轮播图添加样式，给定宽高并充满两侧：</p> 
<pre><code class="language-css">swiper{
  height: 350rpx; /*rpx能实现高度的自动缩放*/
}
swiper image{
  width: 100%;
  height: 100%;
}</code></pre> 
<p>至此轮播图效果已经实现，效果如下：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/3c/ba/54xgfRKg_o.gif"></p> 
<p>黑马的这个项目接口，就两张图片感觉有点丑，我自己在网上整了五张好看的小姐姐图片，然后用node搭建了一个本地服务器，然后也写了一个图片的接口，本想轮播小姐姐图片的，如下</p> 
<p><img alt="" height="457" src="https://images2.imgbox.com/9d/8e/yvkY8EK3_o.png" width="1200"></p> 
<p>换掉小程序之前黑马老师的接口链接，发现报错了，寻找原因原来没有让这个域名合法，好嘛于是登录到小程序的后台添加合法域名，发现报错，寻找原因，原来本地的ip地址不行，如下：</p> 
<p><img alt="" height="423" src="https://images2.imgbox.com/c6/16/vLTJKumG_o.png" width="1077"></p> 
<p>好嘛，之前的买的服务器已经到期了。。。只能这样了，看不了小姐姐了，哈哈，一个小插曲。</p> 
<h4 id="%E5%AE%9E%E7%8E%B0%E9%A1%B5%E9%9D%A2%E4%B9%9D%E5%AE%AB%E6%A0%BC">实现页面九宫格</h4> 
<p>和实现轮播图一样，也是需要调用接口，然后渲染到页面上，如下：</p> 
<p><img alt="" height="117" src="https://images2.imgbox.com/12/d4/1LBZCny7_o.png" width="1031"></p> 
<p>获取九宫格的数据：</p> 
<pre><code class="language-javascript">// 获取九宫格数据的方法
getGridList(){
  wx.request({
    url: 'https://www.escook.cn/categories',
    method:'GET',
    success: (res)=&gt;{
      this.setData({
        gridList:res.data
      })
    }
  })
},</code></pre> 
<p>在页面刚渲染的时候，调用获取九宫格的方法：</p> 
<p><img alt="" height="280" src="https://images2.imgbox.com/ce/17/mKfuVPR7_o.png" width="1090"></p> 
<p>在wxml页面上对接口获取到的数据进行渲染：</p> 
<pre><code class="language-html">&lt;!-- 九宫格区域 --&gt;
&lt;view class="grid-list"&gt;
  &lt;view class="grid-item" wx:for="{<!-- -->{gridList}}" wx:key="id"&gt;
    &lt;image src="{<!-- -->{item.icon}}"&gt;&lt;/image&gt;
    &lt;text&gt;{<!-- -->{item.name}}&lt;/text&gt;
  &lt;/view&gt;
&lt;/view&gt;</code></pre> 
<p>给获取到的数据添加样式：</p> 
<pre><code class="language-css">.grid-list{
  display: flex;
  flex-wrap: wrap; /* 让弹性盒元素在必要的时候拆行 */
  border-left: 1px solid #efefef;
  border-top: 1px solid #efefef;
}
.grid-item{
  width: 33.33%;
  height: 200rpx;
  display: flex;
  flex-direction: column;/* 项目将垂直显示，正如一个列一样。 */
  align-items: center; /* 定义flex子项在flex容器的中心 */
  justify-content: center;/*用于设置或检索弹性盒子元素在主轴（横轴）方向上的对齐方式为居中*/
  border-right: 1px solid #efefef;
  border-bottom: 1px solid #efefef;
  box-sizing: border-box;
}
.grid-item image {
  width: 60rpx;
  height: 60rpx;
}
.grid-item text{
  font-size: 24rpx;
  margin-top: 10rpx;
}</code></pre> 
<p>得到的效果如下：</p> 
<p><img alt="" height="769" src="https://images2.imgbox.com/e2/30/u1PHQpai_o.png" width="1200"></p> 
<h4 id="%E5%AE%9E%E7%8E%B0%E5%BA%95%E9%83%A8%E5%9B%BE%E7%89%87">实现底部图片</h4> 
<p>可以看到在九宫格的下面还是有很大一片区域的，所有我们需要在下面放置两张图片，一个是商品推荐，另一个是交友论坛，如下：</p> 
<p>在wxml中设置图片区域：</p> 
<pre><code class="language-html">&lt;!-- 图片区域 --&gt;
&lt;view class="img-box"&gt;
  &lt;image src="/images/shangjia.jpg"&gt;&lt;/image&gt;
  &lt;image src="/images/jiaoyou.jpg"&gt;&lt;/image&gt;
&lt;/view&gt;</code></pre> 
<p>给图片添加样式：</p> 
<pre><code class="language-css">/* 图片 */
.img-box{
  display: flex;
  padding: 20rpx 10rpx;
  justify-content: space-around;
}
.img-box image{
  width: 45%;
  height: 250rpx;
}</code></pre> 
<p>最终的结果如下：</p> 
<p><img alt="" height="547" src="https://images2.imgbox.com/d8/41/96nx4VcI_o.png" width="1200"></p> 
<h4 id="%E5%AE%9E%E7%8E%B0%E4%B9%9D%E5%AE%AB%E6%A0%BC%E7%9A%84%E5%AF%BC%E8%88%AA%E8%B7%B3%E8%BD%AC">实现九宫格的导航跳转</h4> 
<p>在我们配置好九宫格的样式之后，我们就需要给每个九宫格添加导航路由跳转了，如下：</p> 
<p>首先我们需要新创建一个文件夹，里面用来存放九宫格跳转路由时用到数据的组件，如下：</p> 
<p><img alt="" height="555" src="https://images2.imgbox.com/2a/75/CgVaCBZN_o.png" width="1200"></p> 
<p>创建好shoplist组件后，将我们之前九宫格的view标签修改为navigator标签，添加url属性，并书写好要跳转组件的路径，并传递参数，进行导航跳转：</p> 
<pre><code class="language-html">&lt;!-- 九宫格区域 --&gt; 
&lt;view class="grid-list"&gt;
  &lt;navigator class="grid-item" wx:for="{<!-- -->{gridList}}" wx:key="id" url="/pages/shoplist/shoplist?id={<!-- -->{item.id}}&amp;title={<!-- -->{item.name}}"&gt;
    &lt;image src="{<!-- -->{item.icon}}"&gt;&lt;/image&gt;
    &lt;text&gt;{<!-- -->{item.name}}&lt;/text&gt;
  &lt;/navigator&gt;
&lt;/view&gt;</code></pre> 
<p>如果不了解导航跳转的原理的朋友，可以看一下我之前的文章：<a class="link-info" href="https://z5qyj5pyi.blog.csdn.net/article/details/126207865" rel="nofollow" title="数据请求和页面导航">数据请求和页面导航</a> 。结果如下</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b2/44/9wgMHJa3_o.gif"></p> 
<h4 id="%E5%AE%9E%E7%8E%B0%E5%AF%BC%E8%88%AA%E8%B7%B3%E8%BD%AC%E6%97%B6%E8%AE%BE%E7%BD%AE%E6%A0%87%E9%A2%98%E5%86%85%E5%AE%B9">实现导航跳转时设置标题内容</h4> 
<p>我们在跳转到shoplist组件时，将我们的id和titile作为query参数传递过去了，在微信的官方文档明确告诉我们在传参过去如何设置标题内容，如下：</p> 
<p><img alt="" height="600" src="https://images2.imgbox.com/a7/c3/xW1aq04z_o.png" width="1200"></p> 
<p>那么如何调用 setNavigationBarTitle 呢？官方文档明确告诉我们调用的时机，如下：</p> 
<p><img alt="" height="313" src="https://images2.imgbox.com/49/50/Mgg2cx8n_o.png" width="1200"></p> 
<p>ok，这样的话，我们就需要在shoplist组件的js文件进行相关配置了，通过onLoad函数，拿到传递过来的query参数，并将参数更新到data中。</p> 
<p><img alt="" height="508" src="https://images2.imgbox.com/30/aa/3s3JSCF3_o.png" width="1200"></p> 
<p>在onReady函数中调用相应API，并从data拿到query的参数值，并渲染到页面，如下：</p> 
<p><img alt="" height="274" src="https://images2.imgbox.com/7e/c7/q9eHfekF_o.png" width="1196"></p> 
<p>最后的效果如下：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/3a/16/lgIflDWU_o.gif"></p> 
<h4 id="%E5%AE%9E%E7%8E%B0%E5%95%86%E5%93%81%E5%88%97%E8%A1%A8%E6%95%B0%E6%8D%AE%E7%9A%84%E6%B8%B2%E6%9F%93">实现商品列表数据的渲染</h4> 
<p>实现了标题内容之后，接下来需要实现，在点击相关九宫格选项之后，将相应的标题下的内容进行渲染出来，如下：</p> 
<p>根据我们要调用的接口返回来的数据，第一步先在data中初始化数据，如下：</p> 
<p><img alt="" height="327" src="https://images2.imgbox.com/43/82/4ShBUgey_o.png" width="1178"></p> 
<p>初始完数据之后，就要调用接口拿数据了，将拿到的数据去更新data里面的状态数据，根据我们点击九宫格返回过来的query参数里面的id，来判断我们要拿到哪一个页面的数据，如下：</p> 
<pre><code class="language-javascript">// 获取商品信息数据
getShopList(){
  wx.request({
    url: `https://www.escook.cn/categories/${this.data.query.id}/shops`,
    method:'GET',
    data:{//指定要发送给服务器的参数
      _page:this.data.page,
      _limit:this.data.pageSize
    },
    success:(res)=&gt;{
      this.setData({
        shopList:[...this.data.shopList,...res.data], // 新旧数据的拼接
        total: res.header['X-Total-Count']-0 // 将字符串转换为数字型
      })
    }
  })
},</code></pre> 
<p>在生命周期 onLoad ，页面刚加载数据的时候，调用我们获取商品列表信息的函数：</p> 
<p><img alt="" height="331" src="https://images2.imgbox.com/0b/7f/WfFYAdRf_o.png" width="1158"></p> 
<p>接下来，将我们接口调用的数据渲染到页面上，如下：</p> 
<pre><code class="language-html">&lt;view class="shop-item" wx:for="{<!-- -->{shopList}}" wx:key="id"&gt;
  &lt;!-- 图片资源 --&gt;
  &lt;view class="thumb"&gt;
    &lt;image src="{<!-- -->{item.images[0]}}"&gt;&lt;/image&gt;
  &lt;/view&gt;
  &lt;!-- 文字信息 --&gt;
  &lt;view class="info"&gt;
    &lt;text class="shop-title"&gt;{<!-- -->{item.name}}&lt;/text&gt;
    &lt;text&gt;电话：{<!-- -->{item.phone}}&lt;/text&gt;
    &lt;text&gt;地址：{<!-- -->{item.address}}&lt;/text&gt;
    &lt;text&gt;营业时间：{<!-- -->{item.businessHours}}&lt;/text&gt;
  &lt;/view&gt;
&lt;/view&gt;</code></pre> 
<p>接下来需要对我们设置的内容样式进行美化，如下：</p> 
<pre><code class="language-css">.shop-item{
  display: flex;
  padding: 15rpx;
  border: 1px solid #efefef;
  margin: 15rpx;
  border-radius: 8rpx;
  box-shadow: 1rpx 1rpx 15rpx #ddd;
}
.thumb image{
  width: 250rpx;
  height: 250rpx;
  display: block;
  margin-right: 15rpx;
}
.info{
  display: flex;
  flex-direction: column;
  justify-content: space-around;
  font-size: 24rpx;
}
.shop-title{
  font-weight: bold;
}</code></pre> 
<p>ok，具体效果如下：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/7e/77/msI1mq31_o.gif"></p> 
<h4 id="%E5%AE%9E%E7%8E%B0%E4%B8%8A%E6%8B%89%E5%8A%A0%E8%BD%BD%E4%BB%A5%E5%8F%8Aloading%E6%95%88%E6%9E%9C">实现上拉加载以及loading效果</h4> 
<p>在实现了接口数据渲染到页面之后，接下来要实现上拉加载实现请求多页的数据，如下：</p> 
<p>首先，我们需要在shoplist.json文件中，去设置当我们下拉的距离为多少的时候加载第二页数据：</p> 
<p><img alt="" height="397" src="https://images2.imgbox.com/bb/8c/ICqCbT3a_o.png" width="1200"></p> 
<p>设置，完成之后，我们需要在页面上拉触底事件的处理函数中，对我们之前初始化的page进行+1 ，然后重新调用获取shoplist列表数据的函数，如下：</p> 
<p><img alt="" height="250" src="https://images2.imgbox.com/8a/cd/RaXGdeIm_o.png" width="1106"></p> 
<p>要知道上拉加载是有一个问题的，在网络不稳定的情况下，当你不停的在对应距离来回拉扯会不停的触发上下加载函数，具体的过程如下：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/c6/62/hJJUqYKo_o.gif"></p> 
<p>为了处理这个问题，需要设置一个节流阀来进行限制，如下：</p> 
<p><img alt="" height="169" src="https://images2.imgbox.com/2c/bf/ZILf7ErO_o.png" width="1163"></p> 
<p>在调用接口的函数中，进行数据加载前以及加载后页面的设置 ：</p> 
<pre><code class="language-javascript">// 获取商品信息数据
getShopList(){
  // 表明我们要请求数据了，将isloading修改为true
  this.setData({
    isloading:true
  })
  // 展示loading效果
  wx.showLoading({
    title: '数据加载中......',
  })
  wx.request({
    url: `https://www.escook.cn/categories/${this.data.query.id}/shops`,
    method:'GET',
    data:{//指定要发送给服务器的参数
      _page:this.data.page,
      _limit:this.data.pageSize
    },
    success:(res)=&gt;{
      this.setData({
        shopList:[...this.data.shopList,...res.data], // 新旧数据的拼接
        total: res.header['X-Total-Count']-0
      })
    },
    // 事件完成之后调用
    complete:()=&gt;{
      // 取消loading效果
      wx.hideLoading()
      this.setData({
        isloading:false
      })
    }
  })
},</code></pre> 
<p>在上拉加载函数的地方在进行一次判断，如果isloading为true，证明当前正在请求数据，直接return出去就可以了，此时的页码值不会加1，也不会请求数据，当当前的数据请求完成以后，才可以让页码值进行加1，再请求下一页数据。</p> 
<p><img alt="" height="282" src="https://images2.imgbox.com/b2/ca/RMSGIsBi_o.png" width="1113"></p> 
<h4 id="%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E6%98%AF%E5%90%A6%E5%8A%A0%E8%BD%BD%E5%AE%8C%E6%AF%95%E7%9A%84%E5%88%A4%E6%96%AD">实现数据是否加载完毕的判断</h4> 
<p>我们在之前调用的接口中，里面的内容总共只有80条数据，每页有十条数据也就是说总共只有8页，但是当我们频繁的去下拉加载时，页数依然会增加，内容还是属于80条数据里面，这就产生了一个效率问题，如下：所有我们需要对数据是否加载完毕进行一个判断</p> 
<p><img alt="" height="411" src="https://images2.imgbox.com/f0/f5/vGueI413_o.png" width="1200"></p> 
<blockquote> 
 <p>判断的公式，如果下面公式成立 ，则证明没有下一页数据了：</p> 
 <p>页码值 * 每页显示多少条数据 &gt;= 总数据条数</p> 
 <p>page * pageSize &gt;= total</p> 
</blockquote> 
<p>这里需要借用微信官方文档提供的API，如下：</p> 
<p><img alt="" height="569" src="https://images2.imgbox.com/11/9b/ymDXjF3a_o.png" width="1200"></p> 
<p><img alt="" height="392" src="https://images2.imgbox.com/e4/e5/jaPY49pg_o.png" width="1182"></p> 
<p>最后的结果如下：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/0b/26/aAZ11lKI_o.gif"></p> 
<h4 id="%E5%AE%9E%E7%8E%B0%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0%E5%8A%9F%E8%83%BD">实现下拉刷新功能</h4> 
<p>实现下拉刷新功能之前，需要在shoplist.json文件中进行相关配置，如下：</p> 
<p><img alt="" height="436" src="https://images2.imgbox.com/ce/b6/EU8m6sFn_o.png" width="1200"></p> 
<p>结果如下：</p> 
<p><img alt="" height="249" src="https://images2.imgbox.com/06/38/23SLJWy6_o.png" width="1200"></p> 
<p>接下来需要在下拉刷新函数中进行配置，将data中的数据初始化最初状态，并重新发起接口请求：</p> 
<pre><code class="language-javascript">/**
 * 页面相关事件处理函数--监听用户下拉动作
 */
onPullDownRefresh() {
  // 需要重置关键的数据
  this.setData({
    page:1,
    shopList:[],
    total:0
  })
  // 重新发起数据请求,并传入一个参数函数，在接口请求数据结束，调用该函数阻止下拉刷新
  this.getShopList(()=&gt;{
    wx.stopPullDownRefresh()
  })
},    </code></pre> 
<p>获取商品数据的函数传递一个形参用来接收函数</p> 
<p><img alt="" height="168" src="https://images2.imgbox.com/98/24/8a6LMk01_o.png" width="1036"></p> 
<p>在接口请求完成之后通过短路运算调用这个函数，如下：这样即使有别的函数调用获取商品列表的接口函数，没有传递参数的话也是不会调用这个函数的。</p> 
<p><img alt="" height="391" src="https://images2.imgbox.com/e5/75/5wrUdWob_o.png" width="1159"></p> 
<p>可以点击预览在自己的手机上查看相关功能点配置如何：</p> 
<p><img alt="" height="417" src="https://images2.imgbox.com/52/c4/8k5TVyfr_o.png" width="1200"></p> 
<h4 id="%E5%AE%9E%E7%8E%B0wxs%E5%A4%84%E7%90%86%E6%89%8B%E6%9C%BA%E5%8F%B7">实现wxs处理手机号</h4> 
<p>我们可以通过配置一个wxs脚本来对手机号进行设置，如下：</p> 
<p><img alt="" height="369" src="https://images2.imgbox.com/34/d1/TAllepkr_o.png" width="1200"></p> 
<p>设置脚本文件，如下：</p> 
<pre><code class="language-javascript">function splitPhone(str){
  if(str!==null){
    if(str.length !== 11) return str
  }else{
    return '未知'
  }
  var arr = str.split('')
  arr.splice(3,0,'-')
  arr.splice(8,0,'-')
  return arr.join('')
}
module.exports = {
  splitPhone:splitPhone
} </code></pre> 
<p>最终结果如下：</p> 
<p><img alt="" height="473" src="https://images2.imgbox.com/5f/f2/N0dLutYO_o.png" width="1200"></p> 
<h4 id="%E6%9C%80%E7%BB%88%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%95%88%E6%9E%9C">最终的实现效果</h4> 
<p>根据上文对项目功能的不断增加，最终这个案例demo所呈现的效果如下：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/c0/f1/yWbibh2C_o.gif"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/807db5137cedb7ee2ea5060866d9007c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Servlet项目创建</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0aba75d44f1840ccd44ffe8497b0432b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java中的while循环和do while循环</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>