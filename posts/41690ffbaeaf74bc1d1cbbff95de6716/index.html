<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MySQL之经典50道题 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MySQL之经典50道题" />
<meta property="og:description" content="MySQL之经典50道题 一、创建数据表并插入数据二、开始解题2.1 题目1：查询&#34;01&#34;课程比&#34;02&#34;课程成绩高的学生的信息、课程分数2.2 题目2：查询平均成绩大于等于60分且总分大于200分的同学且必须考3门的学生编号和学生姓名和平均成绩2.3 题目3：查询平均成绩小于60分的同学的学生编号、学生姓名、平均成绩（包括有成绩的和无成绩）2.4 题目4：查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩2.5 题目5：查询“李”姓老师的数量2.6 题目6：查询学过张三老师授课的同学信息2.7 题目7：找出没有学过张三老师课程的学生2.8 题目8：查询学过编号为01，并且学过编号为02课程的学生信息2.9 题目9：查询学过01课程，但是没有学过02课程的学生信息2.10 题目10：查询没有学完全部课程的同学的信息2.11 题目11：查询至少有一门课与学号为01的同学所学相同的同学的信息2.12 题目12：查询和01同学学习的课程完全相同的同学的信息2.13 题目13：查询没有修过张三老师讲授的任何一门课程的学生姓名2.14 题目14：查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩2.15 题目15：LeetCode-for-SQL的第二题：第二高的薪水2.16 题目16：求出第n高的成绩（找出语文科目第2高的成绩和学号）2.17 题目17：LeetCode-SQL-596-超过5名学生的课程2.18 题目18：LeetCode-SQL-181-超过经理收入的员工2.19 题目19：检索01课程分数小于60，按分数降序排列的学生信息2.20 题目20：按平均成绩从高到低（降序）显示所有学生的所有课程的成绩以及平均成绩2.21 题目21：查询各科成绩最高分、最低分和平均分：以如下形式显示：课程ID，课程name，最高分，最低分，平均分，及格率（及格：&gt;=60），中等率（中等为：70-80），优良率（优良为：80-90），优秀率（优秀为：&gt;=90）；---比较综合，多看！2.22 题目22：按照各科成绩进行排序，并且显示排名---比较综合，多看！2.23 题目23：查询学生的总成绩，并进行排名---比较综合，多看！2.24 题目24：LeetCode-SQL-182-查找重复的电子邮箱，从给定的表Person中找出重复的电子邮箱2.25 题目25：LeetCode-SQL-595-大的国家2.26 题目26：LeetCode-SQL-184-部门工资最高/N高的员工---多看2.27 题目27：查询不同老师所教不同课程平均分从高到低显示2.28 题目28：查询所有课程的成绩第2名到第3名的学生信息及该课程成绩2.29 题目29：统计各科成绩各分数段人数：课程编号，课程名称，[100-85]，[85-70]，[70-60]，[0-60]及所占百分比2.30 题目30：查询学生的平均成绩及名次---比较综合，多看，定义变量，实现rank函数2.31 题目31：查询各科成绩前三名的记录---比较综合，多看2.32 题目32：查询每门课被选修的学生数2.33 题目33：查询出只有两门课程的全部学生的学号和姓名2.34 题目34：查询男女生人数2.35 题目35：查询名字中含有风字的学生信息2.36 题目36：查询同名同性的学生名单，并统计同名人数2.37 题目37：查询每门课程的平均成绩，结果按平均成绩降序排列；平均成绩相同时，按课程编号c_id升序排列2.38 题目38：查询平均成绩大于等于85的所有学生的学号、姓名和平均成绩2.39 题目39：查询所有学生的课程及分数（均分、总分）情况2.40 题目40：查询选修&#34;张三&#34;老师所授课程的学生中，成绩最高的学生信息及其成绩2.41 题目41：查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩---比较综合，多看！一个表自连2.42 题目42：题目的要求就是找出每门课的前2名同学---多看，比较综合，解决前几名排序的问题2.43 题目43：统计每门课程的学生选修人数（超过5人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列2.44 题目44：检索至少选修两门课程的学生学号2.45 题目45：查询选修了全部课程的学生信息2.46 题目46：查询各学生的年龄：按照出生日期来算，当前月日 &lt; 出生年月的月日则，年龄减12.47 题目47：查询本周过生日的学生2.48 题目48：查询下周过生日的学生2.49 题目49：查询本月过生的同学2.50 题目50：查询下月过生的同学 一、创建数据表并插入数据 1、学生表
Student(s_id,s_name,s_birth,s_sex) ：学生编号、姓名、年月、性别 -- 1、学生表 -- Student(s_id,s_name,s_birth,s_sex) ：学生编号、姓名、年月、性别 CREATE TABLE IF NOT EXISTS `Student` ( `s_id` VARCHAR (20), `s_name` VARCHAR (20) NOT NULL DEFAULT &#39;&#39;, `s_birth` VARCHAR (20) NOT NULL DEFAULT &#39;&#39;, `s_sex` VARCHAR (10) NOT NULL DEFAULT &#39;&#39;, PRIMARY KEY (`s_id`) ) ENGINE = INNODB DEFAULT CHARSET = utf8; -- 插入数据 INSERT INTO Student VALUES (&#39;01&#39;, &#39;赵雷&#39;, &#39;1990-01-01&#39;, &#39;男&#39;); INSERT INTO Student VALUES (&#39;02&#39;, &#39;钱电&#39;, &#39;1990-12-21&#39;, &#39;男&#39;); INSERT INTO Student VALUES (&#39;03&#39;, &#39;孙风&#39;, &#39;1990-05-20&#39;, &#39;男&#39;); INSERT INTO Student VALUES (&#39;04&#39;, &#39;李云&#39;, &#39;1990-08-06&#39;, &#39;男&#39;); INSERT INTO Student VALUES (&#39;05&#39;, &#39;周梅&#39;, &#39;1991-12-01&#39;, &#39;女&#39;); INSERT INTO Student VALUES (&#39;06&#39;, &#39;吴兰&#39;, &#39;1992-03-01&#39;, &#39;女&#39;); INSERT INTO Student VALUES (&#39;07&#39;, &#39;郑竹&#39;, &#39;1989-07-01&#39;, &#39;女&#39;); INSERT INTO Student VALUES (&#39;08&#39;, &#39;王菊&#39;, &#39;1990-01-20&#39;, &#39;女&#39;); 2、课程表" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/41690ffbaeaf74bc1d1cbbff95de6716/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-09T13:42:00+08:00" />
<meta property="article:modified_time" content="2021-08-09T13:42:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MySQL之经典50道题</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>MySQL之经典50道题</h4> 
 <ul><li><a href="#_1" rel="nofollow">一、创建数据表并插入数据</a></li><li><a href="#_91" rel="nofollow">二、开始解题</a></li><li><ul><li><a href="#21_10102_92" rel="nofollow">2.1 题目1：查询"01"课程比"02"课程成绩高的学生的信息、课程分数</a></li><li><a href="#22_2602003_126" rel="nofollow">2.2 题目2：查询平均成绩大于等于60分且总分大于200分的同学且必须考3门的学生编号和学生姓名和平均成绩</a></li><li><a href="#23_360_146" rel="nofollow">2.3 题目3：查询平均成绩小于60分的同学的学生编号、学生姓名、平均成绩（包括有成绩的和无成绩）</a></li><li><a href="#24_4_245" rel="nofollow">2.4 题目4：查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩</a></li><li><a href="#25_5_259" rel="nofollow">2.5 题目5：查询“李”姓老师的数量</a></li><li><a href="#26_6_270" rel="nofollow">2.6 题目6：查询学过张三老师授课的同学信息</a></li><li><a href="#27_7_307" rel="nofollow">2.7 题目7：找出没有学过张三老师课程的学生</a></li><li><a href="#28_80102_354" rel="nofollow">2.8 题目8：查询学过编号为01，并且学过编号为02课程的学生信息</a></li><li><a href="#29_90102_387" rel="nofollow">2.9 题目9：查询学过01课程，但是没有学过02课程的学生信息</a></li><li><a href="#210_10_412" rel="nofollow">2.10 题目10：查询没有学完全部课程的同学的信息</a></li><li><a href="#211_1101_435" rel="nofollow">2.11 题目11：查询至少有一门课与学号为01的同学所学相同的同学的信息</a></li><li><a href="#212_1201_449" rel="nofollow">2.12 题目12：查询和01同学学习的课程完全相同的同学的信息</a></li><li><a href="#213_13_498" rel="nofollow">2.13 题目13：查询没有修过张三老师讲授的任何一门课程的学生姓名</a></li><li><a href="#214_14_554" rel="nofollow">2.14 题目14：查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩</a></li><li><a href="#215_15LeetCodeforSQL_577" rel="nofollow">2.15 题目15：LeetCode-for-SQL的第二题：第二高的薪水</a></li><li><a href="#216_16n2_635" rel="nofollow">2.16 题目16：求出第n高的成绩（找出语文科目第2高的成绩和学号）</a></li><li><a href="#217_17LeetCodeSQL5965_650" rel="nofollow">2.17 题目17：LeetCode-SQL-596-超过5名学生的课程</a></li><li><a href="#218_18LeetCodeSQL181_695" rel="nofollow">2.18 题目18：LeetCode-SQL-181-超过经理收入的员工</a></li><li><a href="#219_190160_732" rel="nofollow">2.19 题目19：检索01课程分数小于60，按分数降序排列的学生信息</a></li><li><a href="#220_20_749" rel="nofollow">2.20 题目20：按平均成绩从高到低（降序）显示所有学生的所有课程的成绩以及平均成绩</a></li><li><a href="#221_21IDname607080809090_824" rel="nofollow">2.21 题目21：查询各科成绩最高分、最低分和平均分：以如下形式显示：课程ID，课程name，最高分，最低分，平均分，及格率（及格：&gt;=60），中等率（中等为：70-80），优良率（优良为：80-90），优秀率（优秀为：&gt;=90）；---比较综合，多看！</a></li><li><a href="#222_22_845" rel="nofollow">2.22 题目22：按照各科成绩进行排序，并且显示排名---比较综合，多看！</a></li><li><a href="#223_23_876" rel="nofollow">2.23 题目23：查询学生的总成绩，并进行排名---比较综合，多看！</a></li><li><a href="#224_24LeetCodeSQL182Person_899" rel="nofollow">2.24 题目24：LeetCode-SQL-182-查找重复的电子邮箱，从给定的表Person中找出重复的电子邮箱</a></li><li><a href="#225_25LeetCodeSQL595_915" rel="nofollow">2.25 题目25：LeetCode-SQL-595-大的国家</a></li><li><a href="#226_26LeetCodeSQL184N_926" rel="nofollow">2.26 题目26：LeetCode-SQL-184-部门工资最高/N高的员工---多看</a></li><li><a href="#227_27_967" rel="nofollow">2.27 题目27：查询不同老师所教不同课程平均分从高到低显示</a></li><li><a href="#228_2823_993" rel="nofollow">2.28 题目28：查询所有课程的成绩第2名到第3名的学生信息及该课程成绩</a></li><li><a href="#229_291008585707060060_1057" rel="nofollow">2.29 题目29：统计各科成绩各分数段人数：课程编号，课程名称，[100-85]，[85-70]，[70-60]，[0-60]及所占百分比</a></li><li><a href="#230_30rank_1080" rel="nofollow">2.30 题目30：查询学生的平均成绩及名次---比较综合，多看，定义变量，实现rank函数</a></li><li><a href="#231_31_1110" rel="nofollow">2.31 题目31：查询各科成绩前三名的记录---比较综合，多看</a></li><li><a href="#232_32_1127" rel="nofollow">2.32 题目32：查询每门课被选修的学生数</a></li><li><a href="#233_33_1139" rel="nofollow">2.33 题目33：查询出只有两门课程的全部学生的学号和姓名</a></li><li><a href="#234_34_1151" rel="nofollow">2.34 题目34：查询男女生人数</a></li><li><a href="#235_35_1160" rel="nofollow">2.35 题目35：查询名字中含有风字的学生信息</a></li><li><a href="#236_36_1167" rel="nofollow">2.36 题目36：查询同名同性的学生名单，并统计同名人数</a></li><li><a href="#237_37c_id_1181" rel="nofollow">2.37 题目37：查询每门课程的平均成绩，结果按平均成绩降序排列；平均成绩相同时，按课程编号c_id升序排列</a></li><li><a href="#238_3885_1195" rel="nofollow">2.38 题目38：查询平均成绩大于等于85的所有学生的学号、姓名和平均成绩</a></li><li><a href="#239_39_1208" rel="nofollow">2.39 题目39：查询所有学生的课程及分数（均分、总分）情况</a></li><li><a href="#240_40_1226" rel="nofollow">2.40 题目40：查询选修"张三"老师所授课程的学生中，成绩最高的学生信息及其成绩</a></li><li><a href="#241_41_1245" rel="nofollow">2.41 题目41：查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩---比较综合，多看！一个表自连</a></li><li><a href="#242_422_1260" rel="nofollow">2.42 题目42：题目的要求就是找出每门课的前2名同学---多看，比较综合，解决前几名排序的问题</a></li><li><a href="#243_435_1278" rel="nofollow">2.43 题目43：统计每门课程的学生选修人数（超过5人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列</a></li><li><a href="#244_44_1293" rel="nofollow">2.44 题目44：检索至少选修两门课程的学生学号</a></li><li><a href="#245_45_1306" rel="nofollow">2.45 题目45：查询选修了全部课程的学生信息</a></li><li><a href="#246_46__1_1317" rel="nofollow">2.46 题目46：查询各学生的年龄：按照出生日期来算，当前月日 &lt; 出生年月的月日则，年龄减1</a></li><li><a href="#247_47_1328" rel="nofollow">2.47 题目47：查询本周过生日的学生</a></li><li><a href="#248_48_1337" rel="nofollow">2.48 题目48：查询下周过生日的学生</a></li><li><a href="#249_49_1349" rel="nofollow">2.49 题目49：查询本月过生的同学</a></li><li><a href="#250_50_1355" rel="nofollow">2.50 题目50：查询下月过生的同学</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>一、创建数据表并插入数据</h2> 
<ul><li>1、学生表<br> Student(s_id,s_name,s_birth,s_sex) ：学生编号、姓名、年月、性别</li></ul> 
<pre><code class="prism language-sql"><span class="token comment">-- 1、学生表</span>
<span class="token comment">-- Student(s_id,s_name,s_birth,s_sex) ：学生编号、姓名、年月、性别</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>
<span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>Student<span class="token punctuation">`</span> <span class="token punctuation">(</span>
	<span class="token punctuation">`</span>s_id<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>s_name<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>s_birth<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>s_sex<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span><span class="token punctuation">,</span>
	<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>s_id<span class="token punctuation">`</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">INNODB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span> <span class="token operator">=</span> utf8<span class="token punctuation">;</span>
<span class="token comment">-- 插入数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token string">'赵雷'</span><span class="token punctuation">,</span> <span class="token string">'1990-01-01'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'02'</span><span class="token punctuation">,</span> <span class="token string">'钱电'</span><span class="token punctuation">,</span> <span class="token string">'1990-12-21'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'03'</span><span class="token punctuation">,</span> <span class="token string">'孙风'</span><span class="token punctuation">,</span> <span class="token string">'1990-05-20'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'04'</span><span class="token punctuation">,</span> <span class="token string">'李云'</span><span class="token punctuation">,</span> <span class="token string">'1990-08-06'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'05'</span><span class="token punctuation">,</span> <span class="token string">'周梅'</span><span class="token punctuation">,</span> <span class="token string">'1991-12-01'</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'06'</span><span class="token punctuation">,</span> <span class="token string">'吴兰'</span><span class="token punctuation">,</span> <span class="token string">'1992-03-01'</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'07'</span><span class="token punctuation">,</span> <span class="token string">'郑竹'</span><span class="token punctuation">,</span> <span class="token string">'1989-07-01'</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'08'</span><span class="token punctuation">,</span> <span class="token string">'王菊'</span><span class="token punctuation">,</span> <span class="token string">'1990-01-20'</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>2、课程表<br> Course(c_id,c_name,t_id) ：课程编号、 课程名称、 教师编号</li></ul> 
<pre><code class="prism language-sql"><span class="token comment">-- 2、课程表</span>
<span class="token comment">-- Course(c_id,c_name,t_id) ：课程编号、 课程名称、 教师编号</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>
<span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>Course<span class="token punctuation">`</span> <span class="token punctuation">(</span>
	<span class="token punctuation">`</span>c_id<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>c_name<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>t_id<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>c_id<span class="token punctuation">`</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">INNODB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span> <span class="token operator">=</span> utf8<span class="token punctuation">;</span>
<span class="token comment">-- 插入数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Course <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token string">'语文'</span><span class="token punctuation">,</span> <span class="token string">'02'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Course <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'02'</span><span class="token punctuation">,</span> <span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token string">'01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Course <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'03'</span><span class="token punctuation">,</span> <span class="token string">'英语'</span><span class="token punctuation">,</span> <span class="token string">'03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>3、教师表<br> Teacher(t_id,t_name) ：教师编号、教师姓名</li></ul> 
<pre><code class="prism language-sql"><span class="token comment">-- 3、教师表</span>
<span class="token comment">-- Teacher(t_id,t_name) ：教师编号、教师姓名</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>
<span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>Teacher<span class="token punctuation">`</span> <span class="token punctuation">(</span>
	<span class="token punctuation">`</span>t_id<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>t_name<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span><span class="token punctuation">,</span>
	<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>t_id<span class="token punctuation">`</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">INNODB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span> <span class="token operator">=</span> utf8<span class="token punctuation">;</span>
<span class="token comment">-- 插入数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Teacher <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Teacher <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'02'</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Teacher <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'03'</span><span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>4、成绩表<br> Score(s_id,c_id,s_score) ：学生编号、课程编号、分数</li></ul> 
<pre><code class="prism language-sql"><span class="token comment">-- 4、成绩表</span>
<span class="token comment">-- Score(s_id,c_id,s_score) ：学生编号、课程编号、分数</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>
<span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>Score<span class="token punctuation">`</span> <span class="token punctuation">(</span>
	<span class="token punctuation">`</span>s_id<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>c_id<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>s_score<span class="token punctuation">`</span> <span class="token keyword">INT</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>s_id<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>c_id<span class="token punctuation">`</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">INNODB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span> <span class="token operator">=</span> utf8<span class="token punctuation">;</span>
<span class="token comment">-- 插入数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token string">'02'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token string">'03'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'02'</span><span class="token punctuation">,</span> <span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'02'</span><span class="token punctuation">,</span> <span class="token string">'02'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'02'</span><span class="token punctuation">,</span> <span class="token string">'03'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'03'</span><span class="token punctuation">,</span> <span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'03'</span><span class="token punctuation">,</span> <span class="token string">'02'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'03'</span><span class="token punctuation">,</span> <span class="token string">'03'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'04'</span><span class="token punctuation">,</span> <span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'04'</span><span class="token punctuation">,</span> <span class="token string">'02'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'04'</span><span class="token punctuation">,</span> <span class="token string">'03'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'05'</span><span class="token punctuation">,</span> <span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'05'</span><span class="token punctuation">,</span> <span class="token string">'02'</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'06'</span><span class="token punctuation">,</span> <span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'06'</span><span class="token punctuation">,</span> <span class="token string">'03'</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'07'</span><span class="token punctuation">,</span> <span class="token string">'02'</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Score <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'07'</span><span class="token punctuation">,</span> <span class="token string">'03'</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9b/1d/1ESkXTOc_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_91"></a>二、开始解题</h2> 
<h3><a id="21_10102_92"></a>2.1 题目1：查询"01"课程比"02"课程成绩高的学生的信息、课程分数</h3> 
<ul><li>需要输出Student表的全部信息和Score表中的s_score；</li></ul> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法一：使用join连接</span>
<span class="token keyword">SELECT</span>
	a<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> 
    b<span class="token punctuation">.</span>s_score<span class="token punctuation">,</span>
	c<span class="token punctuation">.</span>s_score
<span class="token keyword">FROM</span>
	Student a
<span class="token keyword">JOIN</span> Score b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>s_id <span class="token operator">=</span> b<span class="token punctuation">.</span>s_id
<span class="token operator">AND</span> b<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token string">'01'</span>
<span class="token keyword">JOIN</span> Score c <span class="token keyword">ON</span> a<span class="token punctuation">.</span>s_id <span class="token operator">=</span> c<span class="token punctuation">.</span>s_id
<span class="token operator">AND</span> c<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token string">'02'</span>
<span class="token keyword">WHERE</span>
	b<span class="token punctuation">.</span>s_score <span class="token operator">&gt;</span> c<span class="token punctuation">.</span>s_score<span class="token punctuation">;</span>

<span class="token comment">-- 方法二：采用where语句</span>
<span class="token keyword">SELECT</span>
	a<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> 
  b<span class="token punctuation">.</span>s_score<span class="token punctuation">,</span>
	c<span class="token punctuation">.</span>s_score
<span class="token keyword">FROM</span>
	Student a<span class="token punctuation">,</span>
	Score b<span class="token punctuation">,</span>
	Score c
<span class="token keyword">WHERE</span>
	a<span class="token punctuation">.</span>s_id <span class="token operator">=</span> b<span class="token punctuation">.</span>s_id
<span class="token operator">AND</span> a<span class="token punctuation">.</span>s_id <span class="token operator">=</span> c<span class="token punctuation">.</span>s_id
<span class="token operator">AND</span> b<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token string">'01'</span>
<span class="token operator">AND</span> c<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token string">'02'</span>
<span class="token operator">AND</span> b<span class="token punctuation">.</span>s_score <span class="token operator">&gt;</span> c<span class="token punctuation">.</span>s_score<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/05/08/TjbrO6P8_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="22_2602003_126"></a>2.2 题目2：查询平均成绩大于等于60分且总分大于200分的同学且必须考3门的学生编号和学生姓名和平均成绩</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	a<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	a<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
	<span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_score<span class="token punctuation">,</span>
	<span class="token comment">-- 求均值并保留2位小数</span>
	<span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> sum_score
  <span class="token comment">-- 求和并保留0位小数</span>
<span class="token keyword">FROM</span>
	Student a
<span class="token keyword">JOIN</span> Score b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>s_id <span class="token operator">=</span> b<span class="token punctuation">.</span>s_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	a<span class="token punctuation">.</span>s_id
<span class="token keyword">HAVING</span>
	avg_score <span class="token operator">&gt;=</span> <span class="token number">60</span>
<span class="token operator">AND</span> sum_score <span class="token operator">&gt;</span> <span class="token number">200</span>
<span class="token operator">AND</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ce/3f/xoz2obGK_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="23_360_146"></a>2.3 题目3：查询平均成绩小于60分的同学的学生编号、学生姓名、平均成绩（包括有成绩的和无成绩）</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	a<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	a<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
	<span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_score
<span class="token keyword">FROM</span>
	Student a
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Score b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>s_id <span class="token operator">=</span> b<span class="token punctuation">.</span>s_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	a<span class="token punctuation">.</span>s_id
<span class="token keyword">HAVING</span>
	avg_score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/99/ec/pont4ZXI_o.png" alt="在这里插入图片描述"></p> 
<ul><li>上表所示的结果中没有"王菊"，因为王菊没有成绩；</li><li>以下代码筛选出没有成绩的同学王菊；</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	a<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	a<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
	<span class="token number">0</span> <span class="token keyword">AS</span> avg_score <span class="token comment">-- 将avg_score的值置为0</span>
<span class="token keyword">FROM</span>
	Student a
<span class="token keyword">WHERE</span>
	a<span class="token punctuation">.</span>s_id <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>
		<span class="token comment">-- 学生的学号不在给给定表的学号中</span>
		<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span>
			s_id <span class="token comment">-- 查询出全部的学号</span>
		<span class="token keyword">FROM</span>
			Score
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2d/27/rFredjSG_o.png" alt="在这里插入图片描述"></p> 
<ul><li>可以将上述2个表进行合并，采用union函数，但表的数据列必须一致，上下合并数据表的函数有union和union all两个，区别在于union可以对数据进行去重，而union all则不去重；</li></ul> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法1：采用union函数进行合并</span>
<span class="token keyword">SELECT</span>
	a<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	a<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
	<span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_score
<span class="token keyword">FROM</span>
	Student a
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Score b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>s_id <span class="token operator">=</span> b<span class="token punctuation">.</span>s_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	a<span class="token punctuation">.</span>s_id
<span class="token keyword">HAVING</span>
	avg_score <span class="token operator">&lt;</span> <span class="token number">60</span>
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span>
	a<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	a<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
	<span class="token number">0</span> <span class="token keyword">AS</span> avg_score
<span class="token keyword">FROM</span>
	Student a
<span class="token keyword">WHERE</span>
	a<span class="token punctuation">.</span>s_id <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>
		<span class="token comment">-- 学生的学号不在给给定表的学号中</span>
		<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span>
			s_id <span class="token comment">-- 查询出全部的学号</span>
		<span class="token keyword">FROM</span>
			Score
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d6/bd/Z6B02RI5_o.png" alt="在这里插入图片描述"></p> 
<ul><li>不采用union函数，采用ifnull和null函数进行筛选计算；</li></ul> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法2：采用ifnull函数</span>
<span class="token keyword">SELECT</span>
	S<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	S<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
	<span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>IFNULL<span class="token punctuation">(</span>C<span class="token punctuation">.</span>s_score<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_score <span class="token comment">-- ifnull 函数：第一个参数存在则取它本身，不存在取第二个值0</span>
<span class="token keyword">FROM</span>
	Student S
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Score C <span class="token keyword">ON</span> S<span class="token punctuation">.</span>s_id <span class="token operator">=</span> C<span class="token punctuation">.</span>s_id <span class="token comment">-- 一定要采用左连接</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	s_id
<span class="token keyword">HAVING</span>
	avg_score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/39/ba/sZtk6saQ_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法3：采用null函数</span>
<span class="token keyword">SELECT</span>
	a<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	a<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
	<span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_score
<span class="token keyword">FROM</span>
	Student a
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Score b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>s_id <span class="token operator">=</span> b<span class="token punctuation">.</span>s_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	a<span class="token punctuation">.</span>s_id
<span class="token keyword">HAVING</span>
	avg_score <span class="token operator">&lt;</span> <span class="token number">60</span>
<span class="token operator">OR</span> avg_score <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span> <span class="token comment">-- 最后的NULL判断</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/50/29/GdayJjs1_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="24_4_245"></a>2.4 题目4：查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	a<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	a<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
	<span class="token function">COUNT</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>c_id<span class="token punctuation">)</span> <span class="token keyword">AS</span> count_course<span class="token punctuation">,</span>
	<span class="token function">SUM</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> <span class="token keyword">AS</span> sum_socre
<span class="token keyword">FROM</span>
	Student a
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Score b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>s_id <span class="token operator">=</span> b<span class="token punctuation">.</span>s_id <span class="token comment">-- 采用left join，所以对于没有成绩的学生也可以筛选出来。</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	a<span class="token punctuation">.</span>s_id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8a/81/npUeM9LM_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="25_5_259"></a>2.5 题目5：查询“李”姓老师的数量</h3> 
<ul><li>采用通配符%和like关键字来解决。</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	<span class="token function">COUNT</span><span class="token punctuation">(</span>t_name<span class="token punctuation">)</span> 
<span class="token keyword">FROM</span>
	Teacher 
<span class="token keyword">WHERE</span>
	t_name <span class="token operator">LIKE</span> <span class="token string">'李%'</span><span class="token punctuation">;</span> <span class="token comment">-- 以李字开头的名字</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f1/39/3EPB5DRD_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="26_6_270"></a>2.6 题目6：查询学过张三老师授课的同学信息</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法1：通过筛选出张三的id，并匹配相应的课程id，最后将学生的成绩与课程id进行匹配，最后筛选出符合条件的学生。</span>
<span class="token keyword">SELECT</span>
	a<span class="token punctuation">.</span><span class="token operator">*</span> 
<span class="token keyword">FROM</span>
	Student a
	<span class="token keyword">JOIN</span> Score b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>s_id <span class="token operator">=</span> b<span class="token punctuation">.</span>s_id 
	<span class="token operator">AND</span> b<span class="token punctuation">.</span>c_id <span class="token operator">=</span><span class="token punctuation">(</span>
	<span class="token keyword">SELECT</span>
		c_id 
	<span class="token keyword">FROM</span>
		Course 
	<span class="token keyword">WHERE</span>
		t_id <span class="token operator">=</span><span class="token punctuation">(</span>
		<span class="token keyword">SELECT</span>
			t_id 
		<span class="token keyword">FROM</span>
			Teacher 
		<span class="token keyword">WHERE</span>
		t_name <span class="token operator">=</span> <span class="token string">'张三'</span> 
	<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法2：通过left join进行匹配</span>
<span class="token keyword">SELECT</span>
	a<span class="token punctuation">.</span><span class="token operator">*</span> 
<span class="token keyword">FROM</span>
	Student a
	<span class="token keyword">JOIN</span> Score b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>s_id <span class="token operator">=</span> b<span class="token punctuation">.</span>s_id
	<span class="token keyword">JOIN</span> Course c <span class="token keyword">ON</span> b<span class="token punctuation">.</span>c_id <span class="token operator">=</span> c<span class="token punctuation">.</span>c_id
	<span class="token keyword">JOIN</span> Teacher d <span class="token keyword">ON</span> c<span class="token punctuation">.</span>t_id <span class="token operator">=</span> d<span class="token punctuation">.</span>t_id
	<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span>t_name<span class="token operator">=</span><span class="token string">'张三'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/06/56/VpeqLFDb_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="27_7_307"></a>2.7 题目7：找出没有学过张三老师课程的学生</h3> 
<ul><li>和上面👆的题目是互补的，考虑取反操作。</li></ul> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法1：通过筛选出张三的id，并匹配相应的课程id，然后将学生的成绩与张三老师课程id进行匹配，最后筛选不在次学生id范围内的学生信息。</span>
<span class="token keyword">SELECT</span>
	t3<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span>
	Student t3
<span class="token keyword">WHERE</span>
	t3<span class="token punctuation">.</span>s_id <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>
		<span class="token keyword">SELECT</span>
			t1<span class="token punctuation">.</span>s_id
		<span class="token keyword">FROM</span>
			Score t1
		<span class="token keyword">JOIN</span> Course t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>c_id
		<span class="token keyword">WHERE</span>
			t_id <span class="token operator">=</span> <span class="token punctuation">(</span>
				<span class="token keyword">SELECT</span>
					t_id
				<span class="token keyword">FROM</span>
					Teacher
				<span class="token keyword">WHERE</span>
					t_name <span class="token operator">=</span> <span class="token string">'张三'</span>
			<span class="token punctuation">)</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">-- 方法2：使用join</span>
<span class="token keyword">SELECT</span>
	a<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span>
	Student a
<span class="token keyword">WHERE</span>
	a<span class="token punctuation">.</span>s_id <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>
		<span class="token keyword">SELECT</span>
			s_id
		<span class="token keyword">FROM</span>
			Score a
		<span class="token keyword">JOIN</span> Course b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>c_id <span class="token operator">=</span> b<span class="token punctuation">.</span>c_id
		<span class="token keyword">JOIN</span> Teacher c <span class="token keyword">ON</span> b<span class="token punctuation">.</span>t_id <span class="token operator">=</span> c<span class="token punctuation">.</span>t_id
		<span class="token keyword">WHERE</span>
			c<span class="token punctuation">.</span>t_name <span class="token operator">=</span> <span class="token string">'张三'</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/84/e9/cUSGcrw5_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="28_80102_354"></a>2.8 题目8：查询学过编号为01，并且学过编号为02课程的学生信息</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法1：通过自连接实现</span>
<span class="token keyword">SELECT</span>
	a<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span>
	Student a
<span class="token keyword">WHERE</span>
	a<span class="token punctuation">.</span>s_id <span class="token operator">IN</span> <span class="token punctuation">(</span>
		<span class="token keyword">SELECT</span>
			b<span class="token punctuation">.</span>s_id
		<span class="token keyword">FROM</span>
			Score b
		<span class="token keyword">JOIN</span> Score c <span class="token keyword">ON</span> b<span class="token punctuation">.</span>s_id <span class="token operator">=</span> c<span class="token punctuation">.</span>s_id
		<span class="token keyword">WHERE</span>
			b<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token string">'01'</span>
		<span class="token operator">AND</span> c<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token string">'02'</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">--方法2：通过where实现</span>
<span class="token keyword">SELECT</span>
	s1<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span>
	Student s1<span class="token punctuation">,</span>
	Score s2<span class="token punctuation">,</span>
	Score s3
<span class="token keyword">WHERE</span>
	s1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> s2<span class="token punctuation">.</span>s_id
<span class="token operator">AND</span> s1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> s3<span class="token punctuation">.</span>s_id
<span class="token operator">AND</span> s2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token number">01</span>
<span class="token operator">AND</span> s3<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token number">02</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a9/44/Qr0skX5U_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="29_90102_387"></a>2.9 题目9：查询学过01课程，但是没有学过02课程的学生信息</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	s1<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span>
	Student s1
<span class="token keyword">WHERE</span>
	s1<span class="token punctuation">.</span>s_id <span class="token operator">IN</span> <span class="token punctuation">(</span>
		<span class="token keyword">SELECT</span>
			s_id
		<span class="token keyword">FROM</span>
			Score
		<span class="token keyword">WHERE</span>
			c_id <span class="token operator">=</span> <span class="token string">'01'</span>
	<span class="token punctuation">)</span> <span class="token comment">-- 修过01课程，要保留</span>
<span class="token operator">AND</span> s1<span class="token punctuation">.</span>s_id <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>
	<span class="token keyword">SELECT</span>
		s_id
	<span class="token keyword">FROM</span>
		Score
	<span class="token keyword">WHERE</span>
		c_id <span class="token operator">=</span> <span class="token string">'02'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">-- 哪些人修过02，需要排除</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b9/c5/x96xYtts_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="210_10_412"></a>2.10 题目10：查询没有学完全部课程的同学的信息</h3> 
<ul><li>解题思路：在Course表中先计算总的课程数，后对学生进行分组，筛选出每组中课程数量少于总的课程数的学生。</li></ul> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法1</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span><span class="token operator">*</span> 
<span class="token keyword">from</span> Student s  <span class="token comment">-- 学生表</span>
<span class="token keyword">left</span> <span class="token keyword">join</span> Score s1  <span class="token comment">-- 成绩表</span>
<span class="token keyword">on</span> s1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> s<span class="token punctuation">.</span>s_id
<span class="token keyword">group</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>s_id  <span class="token comment">-- 学号分组</span>
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span>c_id<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>  <span class="token comment">-- 分组后学生的课程数&lt;3</span>
  <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> Course  <span class="token comment">-- 全部课程数=3</span>
<span class="token punctuation">)</span>
<span class="token comment">-- 方法2</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span><span class="token operator">*</span> 
<span class="token keyword">from</span> Student s
<span class="token keyword">where</span> s_id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span>
  <span class="token keyword">select</span> s_id 
  <span class="token keyword">from</span> Score s1
  <span class="token keyword">group</span> <span class="token keyword">by</span> s_id 
  <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> Course<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="211_1101_435"></a>2.11 题目11：查询至少有一门课与学号为01的同学所学相同的同学的信息</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	b<span class="token punctuation">.</span><span class="token operator">*</span> 
<span class="token keyword">FROM</span>
	student b
	<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score c <span class="token keyword">ON</span> b<span class="token punctuation">.</span>s_id <span class="token operator">=</span> c<span class="token punctuation">.</span>s_id 
<span class="token keyword">WHERE</span>
	c<span class="token punctuation">.</span>c_id <span class="token operator">IN</span> <span class="token punctuation">(</span> <span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>c_id <span class="token keyword">FROM</span> score a <span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>s_id <span class="token operator">=</span> <span class="token string">'01'</span> <span class="token punctuation">)</span> 
	<span class="token operator">AND</span> b<span class="token punctuation">.</span>s_id <span class="token operator">!=</span> <span class="token string">'01'</span> <span class="token comment">--排除01学生自己</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	b<span class="token punctuation">.</span>s_id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/18/d6/R2hBhU1n_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="212_1201_449"></a>2.12 题目12：查询和01同学学习的课程完全相同的同学的信息</h3> 
<ul><li>方法1：因为总课程数3，而01号同学的课程数刚好是3，所以我们只要找出在Score表中课程也修满3门的同学即可。</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	b<span class="token punctuation">.</span><span class="token operator">*</span> 
<span class="token keyword">FROM</span>
	student b
	<span class="token keyword">JOIN</span> score c <span class="token keyword">ON</span> b<span class="token punctuation">.</span>s_id <span class="token operator">=</span> c<span class="token punctuation">.</span>s_id 
<span class="token keyword">WHERE</span>
	b<span class="token punctuation">.</span>s_id <span class="token operator">!=</span> <span class="token string">'01'</span> 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	b<span class="token punctuation">.</span>s_id 
<span class="token keyword">HAVING</span>
	<span class="token function">COUNT</span><span class="token punctuation">(</span> c<span class="token punctuation">.</span>c_id <span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span>
	<span class="token keyword">SELECT</span>
		<span class="token function">COUNT</span><span class="token punctuation">(</span> c_id <span class="token punctuation">)</span> 
	<span class="token keyword">FROM</span>
		score 
<span class="token keyword">WHERE</span>
	s_id <span class="token operator">=</span> <span class="token string">'01'</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/57/4d/9XUqXw8e_o.png" alt="在这里插入图片描述"></p> 
<ul><li>方法2：<mark>使用group_concat函数（分组合并，同时排序）</mark><br> 1）group_concat的使用方法为：</li></ul> 
<pre><code class="prism language-sql">group_concat<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">DISTINCT</span><span class="token punctuation">]</span> 字段 <span class="token punctuation">[</span><span class="token keyword">Order</span> <span class="token keyword">BY</span> <span class="token keyword">ASC</span><span class="token operator">/</span><span class="token keyword">DESC</span> 排序字段<span class="token punctuation">]</span> <span class="token punctuation">[</span>Separator <span class="token string">'分隔符'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	b<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	b<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
	b<span class="token punctuation">.</span>s_sex<span class="token punctuation">,</span>
	GROUP_CONCAT<span class="token punctuation">(</span> c<span class="token punctuation">.</span>c_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> c<span class="token punctuation">.</span>c_id <span class="token punctuation">)</span> <span class="token keyword">AS</span> concat_course 
<span class="token keyword">FROM</span>
	student b
	<span class="token keyword">JOIN</span> score c <span class="token keyword">ON</span> b<span class="token punctuation">.</span>s_id <span class="token operator">=</span> c<span class="token punctuation">.</span>s_id 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	b<span class="token punctuation">.</span>s_id 
<span class="token keyword">HAVING</span>
	GROUP_CONCAT<span class="token punctuation">(</span> c<span class="token punctuation">.</span>c_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> c<span class="token punctuation">.</span>c_id <span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span>
	<span class="token keyword">SELECT</span>
		GROUP_CONCAT<span class="token punctuation">(</span> c_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> c_id <span class="token punctuation">)</span> 
	<span class="token keyword">FROM</span>
		score 
	<span class="token keyword">WHERE</span>
		s_id <span class="token operator">=</span> <span class="token string">'01'</span> 
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0d/20/M6GqhZT0_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="213_13_498"></a>2.13 题目13：查询没有修过张三老师讲授的任何一门课程的学生姓名</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法1</span>
<span class="token keyword">SELECT</span>
	<span class="token operator">*</span>
<span class="token keyword">FROM</span>
	student
<span class="token keyword">WHERE</span>
	s_id <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>
		<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span>
			t1<span class="token punctuation">.</span>s_id
		<span class="token keyword">FROM</span>
			score t1
		<span class="token keyword">JOIN</span> course t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>c_id
		<span class="token keyword">WHERE</span>
			t2<span class="token punctuation">.</span>t_id <span class="token operator">=</span> <span class="token punctuation">(</span>
				<span class="token keyword">SELECT</span>
					t_id
				<span class="token keyword">FROM</span>
					teacher
				<span class="token keyword">WHERE</span>
					t_name <span class="token operator">=</span> <span class="token string">'张三'</span>
			<span class="token punctuation">)</span>
	<span class="token punctuation">)</span> 

<span class="token comment">-- 方法2</span>
<span class="token keyword">SELECT</span>
		<span class="token operator">*</span> <span class="token comment">-- 4、学号取反找到学生信息</span>
	<span class="token keyword">FROM</span>
		Student
	<span class="token keyword">WHERE</span>
		s_id <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>
			<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span>
				<span class="token punctuation">(</span>s_id<span class="token punctuation">)</span> <span class="token comment">-- 3、课程号找到对应的学号</span>
			<span class="token keyword">FROM</span>
				Score
			<span class="token keyword">WHERE</span>
				c_id <span class="token operator">=</span> <span class="token punctuation">(</span>
					<span class="token keyword">SELECT</span>
						c_id <span class="token comment">-- 2、教师编号找到对应的课程号</span>
					<span class="token keyword">FROM</span>
						Course
					<span class="token keyword">WHERE</span>
						t_id <span class="token operator">=</span> <span class="token punctuation">(</span>
							<span class="token keyword">SELECT</span>
								t_id <span class="token comment">-- 1、姓名找到教师编号</span>
							<span class="token keyword">FROM</span>
								Teacher
							<span class="token keyword">WHERE</span>
								t_name <span class="token operator">=</span> <span class="token string">'张三'</span>
						<span class="token punctuation">)</span>
				<span class="token punctuation">)</span>
		<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d6/18/fvSAOFL2_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="214_14_554"></a>2.14 题目14：查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	s<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
	t<span class="token punctuation">.</span>avg_score
<span class="token keyword">FROM</span>
	Student s
<span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
	<span class="token keyword">SELECT</span>
		s_id<span class="token punctuation">,</span>
		<span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>s_score<span class="token punctuation">)</span><span class="token punctuation">)</span> avg_score  <span class="token comment">--求均值再取整</span>
	<span class="token keyword">FROM</span>
		Score
	<span class="token keyword">WHERE</span>
		s_score <span class="token operator">&lt;</span> <span class="token number">60</span>
	<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
		s_id
	<span class="token keyword">HAVING</span>
		<span class="token function">COUNT</span><span class="token punctuation">(</span>s_score<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">2</span>
<span class="token punctuation">)</span> t <span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t<span class="token punctuation">.</span>s_id
</code></pre> 
<p><img src="https://images2.imgbox.com/f5/d5/AblBsu2e_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="215_15LeetCodeforSQL_577"></a>2.15 题目15：LeetCode-for-SQL的第二题：第二高的薪水</h3> 
<p>编写一个 SQL 查询，获取 Employee 表中第二高的薪水（Salary） 。<br> ±—±-------+<br> | Id | Salary |<br> ±—±-------+<br> | 1 | 100 |<br> | 2 | 200 |<br> | 3 | 300 |<br> ±—±-------+<br> 例如上述 Employee 表，SQL查询应该返回 200 作为第二高的薪水。如果不存在第二高的薪水，那么查询应返回 null。<br> ±--------------------+<br> | SecondHighestSalary |<br> ±--------------------+<br> | 200 |<br> ±--------------------+</p> 
<ul><li>方法1：嵌套</li></ul> 
<pre><code class="prism language-sql">
<span class="token comment">-- 第二高的薪水，除去最高薪水之后，在剩下的薪水中找最高的</span>
<span class="token keyword">select</span> 
    <span class="token function">max</span><span class="token punctuation">(</span>Salary<span class="token punctuation">)</span> <span class="token keyword">as</span> SecondHighestSalary  <span class="token comment">-- 2、排除原数据中最高薪水之后，剩下的最大值就是第二高</span>
<span class="token keyword">from</span> Employee 
<span class="token keyword">where</span>  Salary <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>Salary<span class="token punctuation">)</span> <span class="token keyword">from</span> Employee<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- 1、这个select是找到原始数据中的最高薪水</span>
</code></pre> 
<p>缺点：当求第二高薪水的时候，只需要嵌套一层；如果求的是第3高，那么需要将第一高、第二高的同时排除，需要排除两次</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 嵌套方法：找出第三高的薪水</span>
<span class="token keyword">select</span> 
 <span class="token function">max</span><span class="token punctuation">(</span>Salary<span class="token punctuation">)</span> <span class="token keyword">as</span> ThirdHighestSalary  <span class="token comment">-- 3、确定第3高</span>
<span class="token keyword">from</span> Employee 
<span class="token keyword">where</span> Salary <span class="token operator">&lt;</span> <span class="token punctuation">(</span> 
    <span class="token keyword">select</span> 
      <span class="token function">max</span><span class="token punctuation">(</span>Salary<span class="token punctuation">)</span> <span class="token keyword">as</span> SecondHighestSalary  <span class="token comment">-- 2、找到第二高</span>
    <span class="token keyword">from</span> Employee 
    <span class="token keyword">where</span>  Salary <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>Salary<span class="token punctuation">)</span> <span class="token keyword">from</span> Employee<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- 1、找到第一高</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>方法1：使用 limit 关键字来实现翻页处理<br> 1）使用limit m,n的形式：m 表示从第 m 行数据之后，不包含第 m 行，之后的 n 行数据<br> <img src="https://images2.imgbox.com/2f/f3/8Ui2q3Nq_o.png" alt="在这里插入图片描述"><br> 1）使用limit m offset n形式：表示查询结果跳过 n 条数据，读取前 m 条数据<br> <img src="https://images2.imgbox.com/3c/13/x74OOR45_o.png" alt="在这里插入图片描述"></li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>
 <span class="token keyword">distinct</span> Salary  <span class="token comment">-- 去重</span>
<span class="token keyword">from</span> Employee
<span class="token keyword">order</span> <span class="token keyword">by</span> Salary <span class="token keyword">desc</span>   <span class="token comment">-- 薪水降序</span>
<span class="token keyword">limit</span> <span class="token number">1</span> <span class="token keyword">offset</span> <span class="token number">1</span>   <span class="token comment">-- 从第1行数据之后显示一行：除去最高的薪水之后再显示一行，也就是第二高的薪水</span>
</code></pre> 
<p>如果原数据中只存在一个最高值，也就说不存在第二高薪水的时候，需要显示为null，我们对上面的结果使用ifnull函数来实现</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> ifnull<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">distinct</span> Salary   <span class="token comment">-- 如果不存在则赋值为null</span>
              <span class="token keyword">from</span> Employee
              <span class="token keyword">order</span> <span class="token keyword">by</span> Salary <span class="token keyword">desc</span>   
              <span class="token keyword">limit</span> <span class="token number">1</span> <span class="token keyword">offset</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span> <span class="token keyword">as</span> SecondHighestSalary
</code></pre> 
<ul><li>IFNULL() 函数用于判断第一个表达式是否为 NULL，如果为 NULL 则返回第二个参数的值，如果不为 NULL 则返回第一个参数的值。</li></ul> 
<h3><a id="216_16n2_635"></a>2.16 题目16：求出第n高的成绩（找出语文科目第2高的成绩和学号）</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span>
	s<span class="token punctuation">.</span>s_score <span class="token comment">--  分数去重</span>
<span class="token keyword">FROM</span>
	Score s
	<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Course c <span class="token keyword">ON</span> s<span class="token punctuation">.</span>c_id <span class="token operator">=</span> c<span class="token punctuation">.</span>c_id 
<span class="token keyword">WHERE</span>
	c<span class="token punctuation">.</span>c_name <span class="token operator">=</span> <span class="token string">'语文'</span> <span class="token comment">-- 指定科目</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
	s<span class="token punctuation">.</span>s_score <span class="token keyword">DESC</span> <span class="token comment">-- 降序</span>
	<span class="token keyword">LIMIT</span> <span class="token number">1</span> <span class="token keyword">OFFSET</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">-- limit和offset实现翻页功能</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0f/da/umt0hD8J_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="217_17LeetCodeSQL5965_650"></a>2.17 题目17：LeetCode-SQL-596-超过5名学生的课程</h3> 
<p>有一个 courses 表 ，有 student (学生) 和 class (课程)。请列出所有超过或等于5名学生的课。例如，表：</p> 
<p>±--------±-----------+<br> | student | class |<br> ±--------±-----------+<br> | A | Math |<br> | B | English |<br> | C | Math |<br> | D | Biology |<br> | E | Math |<br> | F | Computer |<br> | G | Math |<br> | H | Math |<br> | I | Math |<br> ±--------±-----------+<br> 最终的结果输出为：</p> 
<p>±--------+<br> | class |<br> ±--------+<br> | Math |<br> ±--------+<br> 在最下面有个提示：学生在每个课中不应被重复计算。即如果A同学重修了Math课程，则不应该被计算在内。</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法1</span>
<span class="token keyword">select</span>
 class
<span class="token keyword">from</span> courses
<span class="token keyword">group</span> <span class="token keyword">by</span> class
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> student<span class="token punctuation">)</span> <span class="token operator">&gt;=</span><span class="token number">5</span><span class="token punctuation">;</span>   <span class="token comment">-- distinct去重关键</span>

<span class="token comment">-- 方法2</span>
<span class="token keyword">select</span>
    class
<span class="token keyword">from</span><span class="token punctuation">(</span>
    <span class="token keyword">select</span>
        <span class="token keyword">distinct</span> <span class="token operator">*</span>
    <span class="token keyword">from</span> courses<span class="token punctuation">)</span> t  <span class="token comment">-- 临时表</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> class
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>class<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">5</span><span class="token punctuation">;</span>
</code></pre> 
<p>本题中最大的陷阱就是有重修课程的同学，但是给出的数据中没有展现出来，所以上面的方法中都会出现去重的操作</p> 
<h3><a id="218_18LeetCodeSQL181_695"></a>2.18 题目18：LeetCode-SQL-181-超过经理收入的员工</h3> 
<p>Employee 表包含所有员工，他们的经理也属于员工。每个员工都有一个 Id，此外还有一列对应员工的经理的 Id。</p> 
<p>±—±------±-------±----------+<br> | Id | Name | Salary | ManagerId |<br> ±—±------±-------±----------+<br> | 1 | Joe | 70000 | 3 |<br> | 2 | Henry | 80000 | 4 |<br> | 3 | Sam | 60000 | NULL |<br> | 4 | Max | 90000 | NULL |<br> ±—±------±-------±----------+<br> 给定 Employee 表，编写一个 SQL 查询，该查询可以获取收入超过他们经理的员工的姓名。在上面的表格中，Joe 是唯一一个收入超过他的经理的员工。</p> 
<p>±---------+<br> | Employee |<br> ±---------+<br> | Joe |<br> ±---------+<br> 题目利用如下的图形解释：Joe是员工，工资是70000，经理是编号3，也就是Sam，但是Sam工资只有60000<br> <img src="https://images2.imgbox.com/45/64/RR6T2EAO_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法1：自连接</span>
<span class="token keyword">select</span>
    e1<span class="token punctuation">.</span>Name <span class="token keyword">as</span> Employee
<span class="token keyword">from</span> Employee e1  <span class="token comment">-- 表的自连接</span>
<span class="token keyword">left</span> <span class="token keyword">join</span> Employee e2
<span class="token keyword">on</span> e1<span class="token punctuation">.</span>ManagerId <span class="token operator">=</span> e2<span class="token punctuation">.</span>Id  <span class="token comment">-- 连接条件</span>
<span class="token keyword">where</span> e1<span class="token punctuation">.</span>Salary <span class="token operator">&gt;</span> e2<span class="token punctuation">.</span>Salary

<span class="token comment">-- 方法2：where条件过滤</span>
<span class="token keyword">select</span> 
 a<span class="token punctuation">.</span>Name <span class="token keyword">as</span> Employee 
<span class="token keyword">from</span> Employee <span class="token keyword">as</span> a<span class="token punctuation">,</span>Employee <span class="token keyword">as</span> b   <span class="token operator">-</span>
<span class="token keyword">where</span> a<span class="token punctuation">.</span>ManagerId <span class="token operator">=</span> b<span class="token punctuation">.</span>Id  
<span class="token operator">and</span> a<span class="token punctuation">.</span>Salary <span class="token operator">&gt;</span> b<span class="token punctuation">.</span>Salary<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="219_190160_732"></a>2.19 题目19：检索01课程分数小于60，按分数降序排列的学生信息</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	t1<span class="token punctuation">.</span>s_id
	<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>s_name
	<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>s_birth
	<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>s_sex
	<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>s_score
<span class="token keyword">FROM</span>
	student t1
	<span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id 
<span class="token keyword">WHERE</span>
	t2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token number">01</span> 
	<span class="token operator">AND</span> t2<span class="token punctuation">.</span>s_score <span class="token operator">&lt;</span> <span class="token number">60</span>
	<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>s_score <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/be/b6/KOGZg40t_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="220_20_749"></a>2.20 题目20：按平均成绩从高到低（降序）显示所有学生的所有课程的成绩以及平均成绩</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法1</span>
<span class="token keyword">SELECT</span>
	t1<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	t1<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span>
	t1<span class="token punctuation">.</span>s_score<span class="token punctuation">,</span>
	t2<span class="token punctuation">.</span>avg_score
<span class="token keyword">FROM</span>
	score t1
<span class="token keyword">JOIN</span> <span class="token punctuation">(</span> <span class="token comment">-- 创建临时表，并进行连接</span>
	<span class="token keyword">SELECT</span>
		s_id<span class="token punctuation">,</span>
		<span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> avg_score
	<span class="token keyword">FROM</span>
		score
	<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
		s_id
<span class="token punctuation">)</span> t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
	<span class="token number">4</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span> <span class="token comment">-- 按照select中的第4列进行降序排列</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/46/94/K5ZsN1iw_o.png" alt="在这里插入图片描述"><br> <strong><mark>为何采用聚合函数MAX</mark>：</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法2：采用case when then end语句</span>
<span class="token keyword">SELECT</span>
	s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	<span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> s<span class="token punctuation">.</span>c_id <span class="token keyword">WHEN</span> <span class="token string">'01'</span> <span class="token keyword">THEN</span> s<span class="token punctuation">.</span>s_score <span class="token keyword">END</span><span class="token punctuation">)</span> 语文<span class="token punctuation">,</span>
	<span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> s<span class="token punctuation">.</span>c_id <span class="token keyword">WHEN</span> <span class="token string">'02'</span> <span class="token keyword">THEN</span> s<span class="token punctuation">.</span>s_score <span class="token keyword">END</span><span class="token punctuation">)</span> 数学<span class="token punctuation">,</span>
	<span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> s<span class="token punctuation">.</span>c_id <span class="token keyword">WHEN</span> <span class="token string">'03'</span> <span class="token keyword">THEN</span> s<span class="token punctuation">.</span>s_score <span class="token keyword">END</span><span class="token punctuation">)</span> 英语<span class="token punctuation">,</span>
	<span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> avg_score
<span class="token keyword">FROM</span>
	score s
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	s<span class="token punctuation">.</span>s_id
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
	<span class="token number">5</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8a/ae/yMwgfwHz_o.png" alt="在这里插入图片描述"></p> 
<ul><li><mark>注意的点：对于下面的例子而言</mark></li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
 s<span class="token punctuation">.</span>s_id
 <span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">case</span> s<span class="token punctuation">.</span>c_id <span class="token keyword">when</span> <span class="token string">'01'</span> <span class="token keyword">then</span> s<span class="token punctuation">.</span>s_score <span class="token keyword">end</span><span class="token punctuation">)</span> 语文
 <span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">case</span> s<span class="token punctuation">.</span>c_id <span class="token keyword">when</span> <span class="token string">'02'</span> <span class="token keyword">then</span> s<span class="token punctuation">.</span>s_score <span class="token keyword">end</span><span class="token punctuation">)</span> 数学
 <span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">case</span> s<span class="token punctuation">.</span>c_id <span class="token keyword">when</span> <span class="token string">'03'</span> <span class="token keyword">then</span> s<span class="token punctuation">.</span>s_score <span class="token keyword">end</span><span class="token punctuation">)</span> 英语
 <span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span>
 <span class="token punctuation">,</span>b<span class="token punctuation">.</span>s_name  <span class="token comment">-- 没有出现在group by子句中，导致报错</span>
<span class="token keyword">from</span> score s
<span class="token keyword">join</span> Student b
<span class="token keyword">on</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> b<span class="token punctuation">.</span>s_id
<span class="token keyword">group</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>s_id
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">5</span> <span class="token keyword">desc</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li><mark>严格模式的报错</mark>：<br> ERROR 1055 (42000): Expression #6 of SELECT list is not in GROUP BY clause and contains nonaggregated column ‘test.b.s_name’ which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by</li><li><mark>原因在于</mark>：<strong>MySQL语句模式为only_full_group_by，即对于在SELECT中的列，除了采用聚合函数的列以外，其他的列必须出现在GROUP BY中，否则认为SQL语句是不合法的。</strong></li><li><mark>上述的MySQL语句应修改为</mark>：</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
 s<span class="token punctuation">.</span>s_id
 <span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">case</span> s<span class="token punctuation">.</span>c_id <span class="token keyword">when</span> <span class="token string">'01'</span> <span class="token keyword">then</span> s<span class="token punctuation">.</span>s_score <span class="token keyword">end</span><span class="token punctuation">)</span> 语文 <span class="token comment">-- 由于有些数据是空值，所以必须采用聚合函数，才能将真实值取出</span>
 <span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">case</span> s<span class="token punctuation">.</span>c_id <span class="token keyword">when</span> <span class="token string">'02'</span> <span class="token keyword">then</span> s<span class="token punctuation">.</span>s_score <span class="token keyword">end</span><span class="token punctuation">)</span> 数学
 <span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">case</span> s<span class="token punctuation">.</span>c_id <span class="token keyword">when</span> <span class="token string">'03'</span> <span class="token keyword">then</span> s<span class="token punctuation">.</span>s_score <span class="token keyword">end</span><span class="token punctuation">)</span> 英语
 <span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span>
 <span class="token punctuation">,</span>b<span class="token punctuation">.</span>s_name  <span class="token comment">-- 没有出现在group by子句中，导致报错</span>
<span class="token keyword">from</span> score s
<span class="token keyword">join</span> Student b
<span class="token keyword">on</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> b<span class="token punctuation">.</span>s_id
<span class="token keyword">group</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> b<span class="token punctuation">.</span>s_name
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">5</span> <span class="token keyword">desc</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="221_21IDname607080809090_824"></a>2.21 题目21：查询各科成绩最高分、最低分和平均分：以如下形式显示：课程ID，课程name，最高分，最低分，平均分，及格率（及格：&gt;=60），中等率（中等为：70-80），优良率（优良为：80-90），优秀率（优秀为：&gt;=90）；—比较综合，多看！</h3> 
<ul><li>一道比较综合的题目</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	t1<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span>
	t2<span class="token punctuation">.</span>c_name
    <span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> max_score
	<span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> min_score
	<span class="token punctuation">,</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> avg_score
	<span class="token punctuation">,</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t1<span class="token punctuation">.</span>s_score<span class="token operator">&gt;=</span><span class="token number">60</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t1<span class="token punctuation">.</span>s_score <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'及格率'</span>
	<span class="token punctuation">,</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t1<span class="token punctuation">.</span>s_score<span class="token operator">&gt;=</span><span class="token number">70</span> <span class="token operator">AND</span> t1<span class="token punctuation">.</span>s_score<span class="token operator">&lt;=</span><span class="token number">80</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t1<span class="token punctuation">.</span>s_score <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'中等率'</span>
	<span class="token punctuation">,</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t1<span class="token punctuation">.</span>s_score<span class="token operator">&gt;=</span><span class="token number">80</span> <span class="token operator">AND</span> t1<span class="token punctuation">.</span>s_score<span class="token operator">&lt;=</span><span class="token number">90</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t1<span class="token punctuation">.</span>s_score <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'优良率'</span>
	<span class="token punctuation">,</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t1<span class="token punctuation">.</span>s_score<span class="token operator">&gt;=</span><span class="token number">90</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t1<span class="token punctuation">.</span>s_score <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'优秀率'</span>
<span class="token keyword">FROM</span>
	score t1
<span class="token keyword">JOIN</span> course t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>c_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	t1<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span>
	t2<span class="token punctuation">.</span>c_name<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d1/64/udxFDKoO_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="222_22_845"></a>2.22 题目22：按照各科成绩进行排序，并且显示排名—比较综合，多看！</h3> 
<ul><li>MySQL进行排序、排名方式</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> 
                t1<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span>
                t1<span class="token punctuation">.</span>s_score<span class="token punctuation">,</span>
                <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> t2<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> 
                 <span class="token keyword">from</span> Score t2 
                 <span class="token keyword">where</span> t2<span class="token punctuation">.</span>s_score<span class="token operator">&gt;=</span>t1<span class="token punctuation">.</span>s_score <span class="token operator">and</span> t2<span class="token punctuation">.</span>c_id<span class="token operator">=</span><span class="token string">'01'</span><span class="token punctuation">)</span> rank
              <span class="token keyword">from</span> Score t1 <span class="token keyword">where</span> t1<span class="token punctuation">.</span>c_id<span class="token operator">=</span><span class="token string">'01'</span>
              <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>s_score <span class="token keyword">desc</span><span class="token punctuation">)</span> t1

<span class="token keyword">union</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> 
                 t1<span class="token punctuation">.</span>c_id
                 <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>s_score
                 <span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> t2<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span>
                   <span class="token keyword">from</span> Score t2 
                   <span class="token keyword">where</span> t2<span class="token punctuation">.</span>s_score<span class="token operator">&gt;=</span>t1<span class="token punctuation">.</span>s_score <span class="token operator">and</span> t2<span class="token punctuation">.</span>c_id<span class="token operator">=</span><span class="token string">'02'</span><span class="token punctuation">)</span> rank
               <span class="token keyword">from</span> Score t1 <span class="token keyword">where</span> t1<span class="token punctuation">.</span>c_id<span class="token operator">=</span><span class="token string">'02'</span>
               <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>s_score <span class="token keyword">desc</span><span class="token punctuation">)</span> t2

<span class="token keyword">union</span>
  <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> 
                  t1<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span>
                  t1<span class="token punctuation">.</span>s_score<span class="token punctuation">,</span>
                  <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> t2<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> <span class="token keyword">from</span> Score t2 <span class="token keyword">where</span> t2<span class="token punctuation">.</span>s_score<span class="token operator">&gt;=</span>t1<span class="token punctuation">.</span>s_score <span class="token operator">and</span> t2<span class="token punctuation">.</span>c_id<span class="token operator">=</span><span class="token string">'03'</span><span class="token punctuation">)</span> rank
                <span class="token keyword">from</span> Score t1 <span class="token keyword">where</span> t1<span class="token punctuation">.</span>c_id<span class="token operator">=</span><span class="token string">'03'</span>
                <span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>s_score <span class="token keyword">desc</span><span class="token punctuation">)</span> t3
</code></pre> 
<p><img src="https://images2.imgbox.com/4f/be/eSfUF6km_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="223_23_876"></a>2.23 题目23：查询学生的总成绩，并进行排名—比较综合，多看！</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
 t1<span class="token punctuation">.</span>s_id <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>score
 <span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span>
    <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> s<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> score
         <span class="token keyword">from</span> Student s
         <span class="token keyword">join</span> Score sc
         <span class="token keyword">on</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc<span class="token punctuation">.</span>s_id
         <span class="token keyword">group</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>s_id
         <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">3</span> <span class="token keyword">desc</span><span class="token punctuation">)</span>t2   <span class="token comment">-- t2和t1相同</span>
    <span class="token keyword">where</span> t2<span class="token punctuation">.</span>score <span class="token operator">&gt;=</span> t1<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> rank
<span class="token keyword">from</span><span class="token punctuation">(</span>
  <span class="token keyword">select</span> s<span class="token punctuation">.</span>s_id <span class="token punctuation">,</span>s<span class="token punctuation">.</span>s_name <span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> score
  <span class="token keyword">from</span> Student s
  <span class="token keyword">join</span> Score sc
  <span class="token keyword">on</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc<span class="token punctuation">.</span>s_id
  <span class="token keyword">group</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>s_id
  <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">3</span> <span class="token keyword">desc</span><span class="token punctuation">)</span>t1   <span class="token comment">-- t1</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">3</span> <span class="token keyword">desc</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/80/c0/J9iM6iCL_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="224_24LeetCodeSQL182Person_899"></a>2.24 题目24：LeetCode-SQL-182-查找重复的电子邮箱，从给定的表Person中找出重复的电子邮箱</h3> 
<p><img src="https://images2.imgbox.com/e8/12/Hdh9V26f_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法1</span>
<span class="token keyword">select</span> 
    Email
<span class="token keyword">from</span> Person 
<span class="token keyword">group</span> <span class="token keyword">by</span> Email
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>Email<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">-- 过滤条件</span>

<span class="token comment">-- 方法2</span>
<span class="token keyword">select</span> 
    <span class="token keyword">distinct</span> <span class="token punctuation">(</span>p1<span class="token punctuation">.</span>Email<span class="token punctuation">)</span>  <span class="token comment">-- 去重统计邮箱</span>
<span class="token keyword">from</span> Person p1
<span class="token keyword">join</span> Person p2 <span class="token keyword">on</span> p1<span class="token punctuation">.</span>Email <span class="token operator">=</span> p2<span class="token punctuation">.</span>Email <span class="token operator">and</span> p1<span class="token punctuation">.</span>Id <span class="token operator">!=</span> p2<span class="token punctuation">.</span>Id<span class="token punctuation">;</span>  <span class="token comment">-- 指定连接条件</span>
</code></pre> 
<h3><a id="225_25LeetCodeSQL595_915"></a>2.25 题目25：LeetCode-SQL-595-大的国家</h3> 
<p><img src="https://images2.imgbox.com/51/2b/wfEtBEpg_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
    name
    <span class="token punctuation">,</span>population
    <span class="token punctuation">,</span>area
<span class="token keyword">from</span> World 
<span class="token keyword">where</span> area <span class="token operator">&gt;</span> <span class="token number">3000000</span>
<span class="token operator">or</span> population <span class="token operator">&gt;</span> <span class="token number">25000000</span><span class="token punctuation">;</span> 
</code></pre> 
<h3><a id="226_26LeetCodeSQL184N_926"></a>2.26 题目26：LeetCode-SQL-184-部门工资最高/N高的员工—多看</h3> 
<p><img src="https://images2.imgbox.com/3e/52/qGqyWukh_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 方法1</span>
<span class="token keyword">SELECT</span>
    Department<span class="token punctuation">.</span>name <span class="token keyword">AS</span> <span class="token string">'Department'</span><span class="token punctuation">,</span>
    Employee<span class="token punctuation">.</span>name <span class="token keyword">AS</span> <span class="token string">'Employee'</span><span class="token punctuation">,</span>
    Salary
<span class="token keyword">FROM</span> Employee 
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Department <span class="token keyword">ON</span> Employee<span class="token punctuation">.</span>DepartmentId <span class="token operator">=</span> Department<span class="token punctuation">.</span>Id
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span>Employee<span class="token punctuation">.</span>DepartmentId <span class="token punctuation">,</span> Salary<span class="token punctuation">)</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>  <span class="token comment">-- 两个字段同时使用</span>
  <span class="token keyword">SELECT</span> 
   DepartmentId<span class="token punctuation">,</span> <span class="token comment">-- 部门分组找出部门号和薪水的最大值</span>
   <span class="token function">MAX</span><span class="token punctuation">(</span>Salary<span class="token punctuation">)</span>  
  <span class="token keyword">FROM</span> Employee 
  <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> DepartmentId
<span class="token punctuation">)</span>

<span class="token comment">-- 方法2：</span>
<span class="token keyword">select</span> 
    d<span class="token punctuation">.</span>Name  Department
    <span class="token punctuation">,</span>e<span class="token punctuation">.</span>Name  Employee
    <span class="token punctuation">,</span>e<span class="token punctuation">.</span>Salary  Salary
<span class="token keyword">from</span> Employee e <span class="token punctuation">,</span> Department d 
<span class="token keyword">where</span> e<span class="token punctuation">.</span>DepartmentId <span class="token operator">=</span> d<span class="token punctuation">.</span>Id  <span class="token comment">--  在同一个部门中进行比计较</span>
<span class="token operator">and</span> e<span class="token punctuation">.</span>Salary <span class="token operator">&gt;=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>Salary<span class="token punctuation">)</span> <span class="token keyword">from</span> Employee <span class="token keyword">where</span> DepartmentId<span class="token operator">=</span>d<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- 找出每个部门的最高值；如果大于等于这个最高值，肯定是最高的</span>
</code></pre> 
<ul><li>寻找排名第一或者第三的员工</li><li><mark><strong>窗口排名函数只有在hive和MySQL 8.X才有</strong></mark></li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> S<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span> S<span class="token punctuation">.</span>EMPLOYEE<span class="token punctuation">,</span> S<span class="token punctuation">.</span>SALARY
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> 
        d<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
        e<span class="token punctuation">.</span>Name Employee<span class="token punctuation">,</span>
        e<span class="token punctuation">.</span>Salary<span class="token punctuation">,</span>
        dense_rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span><span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> e<span class="token punctuation">.</span>DepartmentId <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> e<span class="token punctuation">.</span>Salary <span class="token keyword">DESC</span><span class="token punctuation">)</span> number <span class="token comment">-- 根据部门分区，薪水排序</span>
      <span class="token keyword">FROM</span> Employee e
      <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Department d
      <span class="token keyword">ON</span> e<span class="token punctuation">.</span>DepartmentId <span class="token operator">=</span> d<span class="token punctuation">.</span>Id<span class="token punctuation">)</span> S
 <span class="token keyword">WHERE</span> S<span class="token punctuation">.</span>number <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">or</span> S<span class="token punctuation">.</span>number <span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>  <span class="token comment">-- 排名第一或者第三</span>
</code></pre> 
<h3><a id="227_27_967"></a>2.27 题目27：查询不同老师所教不同课程平均分从高到低显示</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	t2<span class="token punctuation">.</span>t_name<span class="token punctuation">,</span>
    t2<span class="token punctuation">.</span>c_name<span class="token punctuation">,</span>
	<span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_score
<span class="token keyword">FROM</span>
	score t1
<span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
	<span class="token keyword">SELECT</span>
		a<span class="token punctuation">.</span>t_name<span class="token punctuation">,</span>
		b<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span>
    b<span class="token punctuation">.</span>c_name
	<span class="token keyword">FROM</span>
		teacher <span class="token keyword">AS</span> a<span class="token punctuation">,</span>
		course <span class="token keyword">AS</span> b
	<span class="token keyword">WHERE</span>
		a<span class="token punctuation">.</span>t_id <span class="token operator">=</span> b<span class="token punctuation">.</span>t_id
<span class="token punctuation">)</span> t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>c_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>t_name<span class="token punctuation">,</span> t2<span class="token punctuation">.</span>c_name
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6e/ee/cyOZCQej_o.png" alt="在这里插入图片描述"></p> 
<ul><li>注意：<br> 1）上题中，最好将在select语句中除聚合函数外的列全部放到group by语句后；<br> 2）上题中，由于select语句比order by语句先执行，所以在order by后必须使用ORDER BY ROUND(AVG(t1.s_score), 2) DESC，而不能采用别名avg_score；</li></ul> 
<h3><a id="228_2823_993"></a>2.28 题目28：查询所有课程的成绩第2名到第3名的学生信息及该课程成绩</h3> 
<ul><li>该题目采用union函数进行合并，但合并的数据必须包含相同的列；</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	s<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
	t<span class="token punctuation">.</span>c_name<span class="token punctuation">,</span>
	t<span class="token punctuation">.</span>s_score
<span class="token keyword">FROM</span>
	Student s
<span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
	<span class="token comment">-- union连接</span>
	<span class="token punctuation">(</span>
		<span class="token keyword">SELECT</span>
			s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
			s<span class="token punctuation">.</span>s_score<span class="token punctuation">,</span>
			c<span class="token punctuation">.</span>c_name
		<span class="token keyword">FROM</span>
			Score s
		<span class="token keyword">JOIN</span> Course c <span class="token keyword">ON</span> s<span class="token punctuation">.</span>c_id <span class="token operator">=</span> c<span class="token punctuation">.</span>c_id
		<span class="token keyword">WHERE</span>
			c<span class="token punctuation">.</span>c_name <span class="token operator">=</span> <span class="token string">'语文'</span>
		<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
			s<span class="token punctuation">.</span>s_score <span class="token keyword">DESC</span>
		<span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span> <span class="token comment">-- 从第1行数据之后取2行，即取第2,3行数据</span>
	<span class="token punctuation">)</span>
	<span class="token keyword">UNION</span>
		<span class="token punctuation">(</span>
			<span class="token keyword">SELECT</span>
				s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
				s<span class="token punctuation">.</span>s_score<span class="token punctuation">,</span>
				c<span class="token punctuation">.</span>c_name
			<span class="token keyword">FROM</span>
				Score s
			<span class="token keyword">JOIN</span> Course c <span class="token keyword">ON</span> s<span class="token punctuation">.</span>c_id <span class="token operator">=</span> c<span class="token punctuation">.</span>c_id
			<span class="token keyword">WHERE</span>
				c<span class="token punctuation">.</span>c_name <span class="token operator">=</span> <span class="token string">'数学'</span>
			<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
				s<span class="token punctuation">.</span>s_score <span class="token keyword">DESC</span>
			<span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
	<span class="token keyword">UNION</span>
			<span class="token punctuation">(</span>
				<span class="token keyword">SELECT</span>
					s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
					s<span class="token punctuation">.</span>s_score<span class="token punctuation">,</span>
					c<span class="token punctuation">.</span>c_name
				<span class="token keyword">FROM</span>
					Score s
				<span class="token keyword">JOIN</span> Course c <span class="token keyword">ON</span> s<span class="token punctuation">.</span>c_id <span class="token operator">=</span> c<span class="token punctuation">.</span>c_id
				<span class="token keyword">WHERE</span>
					c<span class="token punctuation">.</span>c_name <span class="token operator">=</span> <span class="token string">'英语'</span>
				<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
					s<span class="token punctuation">.</span>s_score <span class="token keyword">DESC</span>
				<span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> t <span class="token comment">-- 临时表t</span>
<span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t<span class="token punctuation">.</span>s_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
  t<span class="token punctuation">.</span>c_name<span class="token punctuation">,</span>
  s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
  s<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
  t<span class="token punctuation">.</span>s_score
</code></pre> 
<p><img src="https://images2.imgbox.com/e5/97/Lm3GYa4a_o.png" alt="在这里插入图片描述"></p> 
<ul><li>注意：每一个子查询，即括号中的部分，不需要将查询结果组成的表重命名，否则会报错。</li></ul> 
<h3><a id="229_291008585707060060_1057"></a>2.29 题目29：统计各科成绩各分数段人数：课程编号，课程名称，[100-85]，[85-70]，[70-60]，[0-60]及所占百分比</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	s<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span>
	c<span class="token punctuation">.</span>c_name<span class="token punctuation">,</span>
	<span class="token function">sum</span><span class="token punctuation">(</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> s_score <span class="token operator">&gt;</span> <span class="token number">85</span> <span class="token operator">AND</span> s_score <span class="token operator">&lt;=</span> <span class="token number">100</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'85-100'</span><span class="token punctuation">,</span>
	<span class="token function">round</span><span class="token punctuation">(</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token punctuation">(</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> s_score <span class="token operator">&gt;</span> <span class="token number">85</span> <span class="token operator">AND</span> s_score <span class="token operator">&lt;=</span> <span class="token number">100</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span> <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span> <span class="token string">'[85,100]占比'</span><span class="token punctuation">,</span>
	<span class="token function">sum</span><span class="token punctuation">(</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> s_score <span class="token operator">&gt;</span> <span class="token number">70</span> <span class="token operator">AND</span> s_score <span class="token operator">&lt;=</span> <span class="token number">85</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'70-85'</span><span class="token punctuation">,</span>
	<span class="token function">round</span><span class="token punctuation">(</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token punctuation">(</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> s_score <span class="token operator">&gt;</span> <span class="token number">70</span> <span class="token operator">AND</span> s_score <span class="token operator">&lt;=</span> <span class="token number">85</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span> <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span> <span class="token string">'[70,85]占比'</span><span class="token punctuation">,</span>
	<span class="token function">sum</span><span class="token punctuation">(</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> s_score <span class="token operator">&gt;</span> <span class="token number">60</span> <span class="token operator">AND</span> s_score <span class="token operator">&lt;=</span> <span class="token number">70</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'60-70'</span><span class="token punctuation">,</span>
	<span class="token function">round</span><span class="token punctuation">(</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token punctuation">(</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> s_score <span class="token operator">&gt;</span> <span class="token number">60</span> <span class="token operator">AND</span> s_score <span class="token operator">&lt;=</span> <span class="token number">70</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span> <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span> <span class="token string">'[60,70]占比'</span><span class="token punctuation">,</span>
	<span class="token function">sum</span><span class="token punctuation">(</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> s_score <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">AND</span> s_score <span class="token operator">&lt;=</span> <span class="token number">60</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'0-60'</span><span class="token punctuation">,</span>
	<span class="token function">round</span><span class="token punctuation">(</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token punctuation">(</span> <span class="token function">sum</span><span class="token punctuation">(</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> s_score <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">AND</span> s_score <span class="token operator">&lt;=</span> <span class="token number">60</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span> <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span> <span class="token string">'[0,60]占比'</span> 
<span class="token keyword">FROM</span>
	Score s
	<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Course c <span class="token keyword">ON</span> s<span class="token punctuation">.</span>c_id <span class="token operator">=</span> c<span class="token punctuation">.</span>c_id 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	s<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span>
	c<span class="token punctuation">.</span>c_name<span class="token punctuation">;</span><span class="token comment">-- 分课程统计总数和占比</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/62/b6/WQRGcd8X_o.png" alt="在这里插入图片描述"></p> 
<ul><li>注意：本题目是将case when then end函数和聚合函数一起使用。</li></ul> 
<h3><a id="230_30rank_1080"></a>2.30 题目30：查询学生的平均成绩及名次—比较综合，多看，定义变量，实现rank函数</h3> 
<ul><li>自定义变量实现rank排序</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>
 a<span class="token punctuation">.</span>s_id  <span class="token comment">-- 学号</span>
 <span class="token punctuation">,</span><span class="token variable">@i</span>:<span class="token operator">=</span><span class="token variable">@i</span><span class="token operator">+</span><span class="token number">1</span> <span class="token keyword">as</span> <span class="token string">'不保留空缺排名'</span>   <span class="token comment">-- 直接i的自加，顺序一直变大，声明变量需加@</span>
 <span class="token punctuation">,</span><span class="token variable">@k</span>:<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> <span class="token variable">@avg_score</span><span class="token operator">=</span>a<span class="token punctuation">.</span>avg_s <span class="token keyword">then</span> <span class="token variable">@k</span> <span class="token keyword">else</span> <span class="token variable">@i</span><span class="token operator">+</span><span class="token number">1</span> <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">'保留空缺排名'</span> <span class="token comment">-- 只有在前后二次排序值不同时才会使顺序号加1</span>
 <span class="token punctuation">,</span><span class="token variable">@avg_score</span>:<span class="token operator">=</span>avg_s <span class="token keyword">as</span> <span class="token string">'平均分'</span>  <span class="token comment">-- 表a中的值</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> 
       s_id
       <span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> avg_s
      <span class="token keyword">from</span> Score 
      <span class="token keyword">group</span> <span class="token keyword">by</span> s_id
      <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">2</span> <span class="token keyword">desc</span><span class="token punctuation">)</span>a    <span class="token comment">-- 表a：平均成绩的排序和学号</span>
      <span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token variable">@avg_score</span>:<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">@i</span>:<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">@k</span>:<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>b   <span class="token comment">-- 表b：进行变量初始化，固定写法。</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ca/39/JEzl5uZt_o.png" alt="在这里插入图片描述"></p> 
<ul><li>另一种实现排序的方式</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
  t1<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span> 
	t1<span class="token punctuation">.</span>s_score<span class="token comment">-- 成绩</span>
 <span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> t2<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> <span class="token comment">-- 排名从1开始</span>
    <span class="token keyword">from</span> Score t2
    <span class="token keyword">where</span> t2<span class="token punctuation">.</span>s_score <span class="token operator">&gt;=</span> t1<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> 排名   <span class="token comment">-- 在t2分数大的情况下，统计t2的去重个数</span>
<span class="token keyword">from</span> Score t1
<span class="token keyword">group</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>s_score
<span class="token keyword">order</span> <span class="token keyword">by</span> t1<span class="token punctuation">.</span>s_score <span class="token keyword">desc</span><span class="token punctuation">;</span>   <span class="token comment">-- 分数降序排列</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e3/4e/zDbk7yfy_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="231_31_1110"></a>2.31 题目31：查询各科成绩前三名的记录—比较综合，多看</h3> 
<ul><li>采用union可以实现，即将各科分别筛选出来再进行union合并，但是当科目特别多时，会比价耗时，所以采用自连接的方式进行筛选。</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>
 a<span class="token punctuation">.</span>s_id
 <span class="token punctuation">,</span>a<span class="token punctuation">.</span>c_id
 <span class="token punctuation">,</span>a<span class="token punctuation">.</span>s_score   <span class="token comment">-- a表的成绩</span>
<span class="token keyword">from</span> Score a
<span class="token keyword">join</span> Score b
<span class="token keyword">on</span> a<span class="token punctuation">.</span>c_id <span class="token operator">=</span> b<span class="token punctuation">.</span>c_id
<span class="token operator">and</span> a<span class="token punctuation">.</span>s_score <span class="token operator">&lt;=</span> b<span class="token punctuation">.</span>s_score   <span class="token comment">-- 判断a的分数小于等于b的分数，要带上等号</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span>
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>s_id<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">3</span>   <span class="token comment">-- b中的个数至少有3个，应对分数相同的情形</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token keyword">desc</span><span class="token punctuation">;</span>   <span class="token comment">-- 课程（2）的升序，成绩（3）的降序</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b6/bd/GUnMAoLA_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="232_32_1127"></a>2.32 题目32：查询每门课被选修的学生数</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
 c<span class="token punctuation">.</span>c_id
 <span class="token punctuation">,</span>c<span class="token punctuation">.</span>c_name
 <span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>s_id<span class="token punctuation">)</span>
<span class="token keyword">from</span> Course c
<span class="token keyword">join</span> Score s
<span class="token keyword">on</span> c<span class="token punctuation">.</span>c_id <span class="token operator">=</span> s<span class="token punctuation">.</span>c_id
<span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4b/73/zoT1mAf1_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="233_33_1139"></a>2.33 题目33：查询出只有两门课程的全部学生的学号和姓名</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
t1<span class="token punctuation">.</span>s_id
<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>s_name
<span class="token keyword">FROM</span>
student t1
<span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id<span class="token operator">=</span>t2<span class="token punctuation">.</span>s_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span>
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/02/dd/dDBKfyu6_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="234_34_1151"></a>2.34 题目34：查询男女生人数</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
 s_sex
 <span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>s_sex<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token punctuation">`</span>人数<span class="token punctuation">`</span>
<span class="token keyword">from</span> Student
<span class="token keyword">group</span> <span class="token keyword">by</span> s_sex<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/10/f7/SiIHdSaM_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="235_35_1160"></a>2.35 题目35：查询名字中含有风字的学生信息</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- 模糊匹配：在两边都加上了%，考虑的是姓或者名字含有风</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> Student <span class="token keyword">where</span> s_name <span class="token operator">like</span> <span class="token string">"%风%"</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fa/7e/bsyfAWN4_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="236_36_1167"></a>2.36 题目36：查询同名同性的学生名单，并统计同名人数</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
 a<span class="token punctuation">.</span>s_name
 <span class="token punctuation">,</span>a<span class="token punctuation">.</span>s_sex
 <span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Student a  <span class="token comment">-- 同一个表的自连接</span>
<span class="token keyword">join</span> Student b
<span class="token keyword">on</span> a<span class="token punctuation">.</span>s_id <span class="token operator">!=</span> b<span class="token punctuation">.</span>s_id   <span class="token comment">-- 连接的时候不能是同一个人：学号保证，每个人的学号是唯一的，其他字段都可能重复</span>
<span class="token operator">and</span> a<span class="token punctuation">.</span>s_sex <span class="token operator">=</span> b<span class="token punctuation">.</span>s_sex  <span class="token comment">-- 性别相同</span>
<span class="token operator">and</span> a<span class="token punctuation">.</span>s_name <span class="token operator">=</span> b<span class="token punctuation">.</span>s_name <span class="token comment">-- 名字相同</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/25/46/heDcNW1N_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="237_37c_id_1181"></a>2.37 题目37：查询每门课程的平均成绩，结果按平均成绩降序排列；平均成绩相同时，按课程编号c_id升序排列</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
 c<span class="token punctuation">.</span>c_id
 <span class="token punctuation">,</span>c<span class="token punctuation">.</span>c_name
 <span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> avg_score
<span class="token keyword">from</span> Score sc
<span class="token keyword">join</span> Course c
<span class="token keyword">on</span> sc<span class="token punctuation">.</span>c_id <span class="token operator">=</span> c<span class="token punctuation">.</span>c_id
<span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">3</span> <span class="token keyword">desc</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>c_id<span class="token punctuation">;</span>  <span class="token comment">-- 指定字段和排序方法</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/74/8e/lxZpsPIK_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="238_3885_1195"></a>2.38 题目38：查询平均成绩大于等于85的所有学生的学号、姓名和平均成绩</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
 sc<span class="token punctuation">.</span>s_id
 <span class="token punctuation">,</span>s<span class="token punctuation">.</span>s_name
 <span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> avg_score
<span class="token keyword">from</span> Score sc
<span class="token keyword">join</span> Student s
<span class="token keyword">on</span> sc<span class="token punctuation">.</span>s_id <span class="token operator">=</span> s<span class="token punctuation">.</span>s_id
<span class="token keyword">group</span> <span class="token keyword">by</span> sc<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>s<span class="token punctuation">.</span>s_name
<span class="token keyword">having</span> avg_score <span class="token operator">&gt;=</span> <span class="token number">85</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fb/67/5sVRP34j_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="239_39_1208"></a>2.39 题目39：查询所有学生的课程及分数（均分、总分）情况</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 
  s<span class="token punctuation">.</span>s_id
 <span class="token punctuation">,</span>s<span class="token punctuation">.</span>s_name
 <span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> c<span class="token punctuation">.</span>c_name <span class="token keyword">when</span> <span class="token string">'语文'</span> <span class="token keyword">then</span> sc<span class="token punctuation">.</span>s_score <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">'语文'</span>  <span class="token comment">-- 语文分数</span>
 <span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> c<span class="token punctuation">.</span>c_name <span class="token keyword">when</span> <span class="token string">'数学'</span> <span class="token keyword">then</span> sc<span class="token punctuation">.</span>s_score <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">'数学'</span>
 <span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> c<span class="token punctuation">.</span>c_name <span class="token keyword">when</span> <span class="token string">'英语'</span> <span class="token keyword">then</span> sc<span class="token punctuation">.</span>s_score <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">'英语'</span>
 <span class="token punctuation">,</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">'平均分'</span>  <span class="token comment">-- 每个人的平均分 </span>
 <span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">'总分'</span>  <span class="token comment">-- 每个人的总分</span>
<span class="token keyword">from</span> Student s
<span class="token keyword">left</span> <span class="token keyword">join</span> Score sc
<span class="token keyword">on</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc<span class="token punctuation">.</span>s_id
<span class="token keyword">left</span> <span class="token keyword">join</span> Course c 
<span class="token keyword">on</span> sc<span class="token punctuation">.</span>c_id <span class="token operator">=</span> c<span class="token punctuation">.</span>c_id
<span class="token keyword">group</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> s<span class="token punctuation">.</span>s_name<span class="token punctuation">;</span>   <span class="token comment">-- 学号和姓名的分组</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/18/db/jsPmpCTq_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="240_40_1226"></a>2.40 题目40：查询选修"张三"老师所授课程的学生中，成绩最高的学生信息及其成绩</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	t1<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	t1<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
	t1<span class="token punctuation">.</span>s_sex<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>s_birth<span class="token punctuation">,</span>
	t3<span class="token punctuation">.</span>c_name<span class="token punctuation">,</span>
    t3<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span>
	<span class="token function">MAX</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span>
<span class="token keyword">FROM</span>
	student t1
<span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
<span class="token keyword">JOIN</span> course t3 <span class="token keyword">ON</span> t2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t3<span class="token punctuation">.</span>c_id
<span class="token keyword">JOIN</span> teacher t4 <span class="token keyword">ON</span> t3<span class="token punctuation">.</span>t_id <span class="token operator">=</span> t4<span class="token punctuation">.</span>t_id
<span class="token keyword">WHERE</span>
	t4<span class="token punctuation">.</span>t_name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e2/58/hvyRsUQS_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="241_41_1245"></a>2.41 题目41：查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩—比较综合，多看！一个表自连</h3> 
<ul><li>3个字段同时在一个表中，所以我们可以通过一个表Score的自连接来实现查出。</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>
  a<span class="token punctuation">.</span>s_id
 <span class="token punctuation">,</span>a<span class="token punctuation">.</span>c_id
 <span class="token punctuation">,</span>a<span class="token punctuation">.</span>s_score
<span class="token keyword">from</span> Score a
<span class="token keyword">join</span> Score b
<span class="token keyword">on</span> a<span class="token punctuation">.</span>c_id <span class="token operator">!=</span> b<span class="token punctuation">.</span>c_id
<span class="token operator">and</span> a<span class="token punctuation">.</span>s_score <span class="token operator">=</span> b<span class="token punctuation">.</span>s_score
<span class="token operator">and</span> a<span class="token punctuation">.</span>s_id <span class="token operator">!=</span> b<span class="token punctuation">.</span>s_id
<span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/58/34/A2ue9yN8_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="242_422_1260"></a>2.42 题目42：题目的要求就是找出每门课的前2名同学—多看，比较综合，解决前几名排序的问题</h3> 
<ul><li>解决前几名排序的问题，特别好的方法！</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	a<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span>
	a<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
	a<span class="token punctuation">.</span>s_score 
<span class="token keyword">FROM</span>
	Score a 
<span class="token keyword">WHERE</span>
	<span class="token punctuation">(</span> <span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token comment">-- count(1)类似count(*)：统计表b中分数大的数量</span>
		<span class="token keyword">FROM</span> Score b <span class="token keyword">WHERE</span> b<span class="token punctuation">.</span>c_id <span class="token operator">=</span> a<span class="token punctuation">.</span>c_id <span class="token comment">-- 课程相同</span>
	<span class="token operator">AND</span> b<span class="token punctuation">.</span>s_score <span class="token operator">&gt;=</span> a<span class="token punctuation">.</span>s_score <span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">2</span> <span class="token comment">-- 前2名</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
	a<span class="token punctuation">.</span>c_id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/bd/a6/fTNYKi64_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="243_435_1278"></a>2.43 题目43：统计每门课程的学生选修人数（超过5人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	c_id<span class="token punctuation">,</span>
	<span class="token function">COUNT</span><span class="token punctuation">(</span> s_id <span class="token punctuation">)</span> num 
<span class="token keyword">FROM</span>
	score 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	c_id 
<span class="token keyword">HAVING</span>
	<span class="token function">COUNT</span><span class="token punctuation">(</span> s_id <span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">5</span> 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
	<span class="token function">COUNT</span><span class="token punctuation">(</span> s_id <span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">,</span> c_id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/73/03/jKykP6ON_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="244_44_1293"></a>2.44 题目44：检索至少选修两门课程的学生学号</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	s_id<span class="token punctuation">,</span>
	<span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> num 
<span class="token keyword">FROM</span>
	Score 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	s_id 
<span class="token keyword">HAVING</span>
	<span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6d/8a/EAS8aV31_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="245_45_1306"></a>2.45 题目45：查询选修了全部课程的学生信息</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>   <span class="token comment">-- 3、s_id对应的学生信息</span>
<span class="token keyword">from</span> Student 
<span class="token keyword">where</span> s_id <span class="token operator">in</span><span class="token punctuation">(</span><span class="token keyword">select</span> s_id <span class="token comment">-- 2、最大课程数对应的s_id</span>
              <span class="token keyword">from</span> Score 
              <span class="token keyword">group</span> <span class="token keyword">by</span> s_id 
              <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> Course<span class="token punctuation">)</span>  <span class="token comment">-- 1、全部课程数</span>
             <span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/23/ed/GB0jqYuw_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="246_46__1_1317"></a>2.46 题目46：查询各学生的年龄：按照出生日期来算，当前月日 &lt; 出生年月的月日则，年龄减1</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>
 s_name
 <span class="token punctuation">,</span>s_birth
 <span class="token punctuation">,</span>date_format<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%Y'</span><span class="token punctuation">)</span> <span class="token operator">-</span> date_format<span class="token punctuation">(</span>s_birth<span class="token punctuation">,</span> <span class="token string">'%Y'</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> date_format<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%m%d'</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> date_format<span class="token punctuation">(</span>s_birth<span class="token punctuation">,</span> <span class="token string">'%m%d'</span><span class="token punctuation">)</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> age  <span class="token comment">-- 当前日期大，说明已经过生了，年龄正常；反之说明今年还没有到年龄-1</span>
<span class="token keyword">from</span> Student<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/55/0f/Tfvvsu0C_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="247_47_1328"></a>2.47 题目47：查询本周过生日的学生</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> Student <span class="token keyword">where</span> week<span class="token punctuation">(</span>date_format<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%Y%m%d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> week<span class="token punctuation">(</span>s_birth<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- 方式1</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student <span class="token keyword">where</span> yearweek<span class="token punctuation">(</span>s_birth<span class="token punctuation">)</span> <span class="token operator">=</span> yearweek<span class="token punctuation">(</span>date_format<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%Y%m%d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">-- 方式2</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/88/a8/uOPsCiWS_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="248_48_1337"></a>2.48 题目48：查询下周过生日的学生</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> Student <span class="token keyword">where</span> week<span class="token punctuation">(</span>date_format<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%Y%m%d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token operator">=</span> week<span class="token punctuation">(</span>s_birth<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> 
<p><img src="https://images2.imgbox.com/e9/b8/8y8c3tZg_o.png" alt="在这里插入图片描述"></p> 
<ul><li>边界问题<br> 如果现在刚好的是今年的最后一个周，那么下周就是明年的第一个周，我们如何解决这个问题呢？？改进后的脚本：</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> Student
<span class="token keyword">where</span> <span class="token function">mod</span><span class="token punctuation">(</span>week<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">=</span>  week<span class="token punctuation">(</span>s_birth<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>当现在刚好是第52周，那么mod函数的结果是0，则说明出生的月份刚好是明年的第一周</p> 
<h3><a id="249_49_1349"></a>2.49 题目49：查询本月过生的同学</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> Student <span class="token keyword">where</span> <span class="token keyword">month</span><span class="token punctuation">(</span>date_format<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%Y%m%d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">month</span><span class="token punctuation">(</span>s_birth<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/77/fa/pL0baNdI_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="250_50_1355"></a>2.50 题目50：查询下月过生的同学</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> Student
<span class="token keyword">where</span> <span class="token keyword">month</span><span class="token punctuation">(</span>date_format<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%Y%m%d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token operator">=</span> <span class="token keyword">month</span><span class="token punctuation">(</span>s_birth<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b7/74/efzEqBK8_o.png" alt="在这里插入图片描述"></p> 
<ul><li>边界问题<br> 假设现在是12月份，那么下个月就是明年的1月份，我们如何解决？？？将上面的代码进行改进：</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> Student
<span class="token keyword">where</span> <span class="token function">mod</span><span class="token punctuation">(</span><span class="token keyword">month</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span>  <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">=</span>  <span class="token keyword">month</span><span class="token punctuation">(</span>s_birth<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>如果现在是12月份，则mod函数的结果是0，说明生日刚好是1月份</li></ul>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/71f79a0b1b483f9c5a81c3318968f51c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">微信上传图文素材接口报41005错误解决方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b07c6504e67eddf244fdb0410da35859/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">电脑k歌,电脑K歌软件有哪些 5款热门K软件推荐</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>