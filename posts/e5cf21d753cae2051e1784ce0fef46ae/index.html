<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于神经网络的手写汉字提取与书写评分系统研究 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于神经网络的手写汉字提取与书写评分系统研究" />
<meta property="og:description" content="相关源码和文档获取请私聊QQ:3106089953
论文目录结构 目 录 摘 要 I Abstract II 目 录 IV 第1章 绪论 1 1.1. 研究背景与意义 1 1.2. 国内外研究现状 2 1.2.1. 文本定位技术研究现状 2 1.2.2. 手写汉字识别研究现状 3 1.2.3. 汉字书写质量评价方法研究现状 4 1.3. 本文所做工作 4 1.4. 论文结构安排 5 第2章 系统需求分析及概要设计 6 2.1. 可行性分析 6 2.2. 系统用例分析 7 2.2.1. 用例表设计 7 2.3. 功能需求分析 9 2.4. 性能需求分析 10 2.5. 系统总体设计 10 2.5.1. 系统总体架构设计 10 2.5.2. 系统功能模块设计 12 2.6. 相关技术介绍 13 2.6.1. Android系统 13 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e5cf21d753cae2051e1784ce0fef46ae/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-06T11:47:40+08:00" />
<meta property="article:modified_time" content="2024-01-06T11:47:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于神经网络的手写汉字提取与书写评分系统研究</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p><strong>相关源码和文档获取请私聊QQ:3106089953</strong></p> 
</blockquote> 
<h2><a id="_2"></a>论文目录结构</h2> 
<pre><code class="prism language-bash">目 录
摘 要 I
Abstract II
目 录 IV
第1章 绪论 <span class="token number">1</span>
<span class="token number">1.1</span>. 研究背景与意义 <span class="token number">1</span>
<span class="token number">1.2</span>. 国内外研究现状 <span class="token number">2</span>
<span class="token number">1.2</span>.1. 文本定位技术研究现状 <span class="token number">2</span>
<span class="token number">1.2</span>.2. 手写汉字识别研究现状 <span class="token number">3</span>
<span class="token number">1.2</span>.3. 汉字书写质量评价方法研究现状 <span class="token number">4</span>
<span class="token number">1.3</span>. 本文所做工作 <span class="token number">4</span>
<span class="token number">1.4</span>. 论文结构安排 <span class="token number">5</span>
第2章 系统需求分析及概要设计 <span class="token number">6</span>
<span class="token number">2.1</span>. 可行性分析 <span class="token number">6</span>
<span class="token number">2.2</span>. 系统用例分析 <span class="token number">7</span>
<span class="token number">2.2</span>.1. 用例表设计 <span class="token number">7</span>
<span class="token number">2.3</span>. 功能需求分析 <span class="token number">9</span>
<span class="token number">2.4</span>. 性能需求分析 <span class="token number">10</span>
<span class="token number">2.5</span>. 系统总体设计 <span class="token number">10</span>
<span class="token number">2.5</span>.1. 系统总体架构设计 <span class="token number">10</span>
<span class="token number">2.5</span>.2. 系统功能模块设计 <span class="token number">12</span>
<span class="token number">2.6</span>. 相关技术介绍 <span class="token number">13</span>
<span class="token number">2.6</span>.1. Android系统 <span class="token number">13</span>
<span class="token number">2.6</span>.2. OpenCV视觉库 <span class="token number">14</span>
<span class="token number">2.6</span>.3. TensorFlow开源库 <span class="token number">14</span>
<span class="token number">2.7</span>. 本章小结 <span class="token number">14</span>
第3章 系统详细设计及实现 <span class="token number">16</span>
<span class="token number">3.1</span>. 系统模块详细设计 <span class="token number">16</span>
<span class="token number">3.2</span>. 笔画提取模块 <span class="token number">16</span>
<span class="token number">3.2</span>.1. 单帧图像的疑似笔画像素点检测 <span class="token number">17</span>
<span class="token number">3.2</span>.2. 基于帧差法的笔画增长点检测 <span class="token number">19</span>
<span class="token number">3.2</span>.3. 笔画切换点检测与单笔画的提取 <span class="token number">20</span>
<span class="token number">3.3</span>. 基本笔画识别模块 <span class="token number">22</span>
<span class="token number">3.3</span>.1. 汉字的基本笔画 <span class="token number">22</span>
<span class="token number">3.3</span>.2. LeNet-5网络 <span class="token number">23</span>
<span class="token number">3.4</span>. 书写评分模块 <span class="token number">25</span>
<span class="token number">3.4</span>.1. 重心特征 <span class="token number">27</span>
<span class="token number">3.4</span>.2. 网格特征 <span class="token number">27</span>
<span class="token number">3.4</span>.3. 整字综合评分 <span class="token number">27</span>
<span class="token number">3.5</span>. 系统UI界面 <span class="token number">28</span>
<span class="token number">3.6</span>. 本章小结 <span class="token number">30</span>
第4章 系统性能测试 <span class="token number">31</span>
<span class="token number">4.1</span>. 测试的意义与方法 <span class="token number">31</span>
<span class="token number">4.2</span>. 运行性能测试 <span class="token number">32</span>
<span class="token number">4.2</span>.1. 测试设备 <span class="token number">32</span>
<span class="token number">4.2</span>.2. 测试环境 <span class="token number">32</span>
<span class="token number">4.3</span>. 本章小结 <span class="token number">33</span>
总结 <span class="token number">34</span>

论文工作总结 <span class="token number">34</span>
工作展望 <span class="token number">34</span>
参考文献 <span class="token number">35</span>
致谢 <span class="token number">37</span>
</code></pre> 
<h2><a id="_60"></a>相关目录的具体内容</h2> 
<pre><code class="prism language-bash"><span class="token number">2.3</span>.功能需求分析
系统的用例分析是从用户操作的角度对系统进行设计，对于系统的功能需求分析，是以开发者的角度进行设计，即对系统的用例图及用例描述进行详细定义与描述，给开发人员作为参考。所有功能均与系统用例一一对应。
<span class="token number">1</span><span class="token punctuation">)</span>录制书写过程
该功能通过用户点击按钮触发，软件获取系统摄像头使用权限，开启摄像头，进行视频录制，直至用户点击按钮结束录制。输出mp4多媒体格式文件并传递给下一模块。
<span class="token number">2</span><span class="token punctuation">)</span>报告书写正确性
该功能触发前，需要用户输入书写的汉字，以供系统使用相应的模板特征数据与输入数据进行对比分析。系统对录制好的书写过程视频进行计算，提取出单一笔画，通过笔画识别、特征比对等方式得到书写正确性结果。书写正确性包括笔画类型、笔画位置、笔画顺序等方面的正确性。报告结果在文本框中以文本方式显示。后台给出笔画状态编码列表，前端对其映射得到对应文本。
<span class="token number">3</span><span class="token punctuation">)</span>显示书写改正建议
该功能依赖于报告书写正确性功能的分析结果。改正建议类型与正确性类型相对应，因此同样使用映射得到对应的建议文本，在前端的文本框中显示。
<span class="token number">4</span><span class="token punctuation">)</span>显示书写评分
该功能与报告书写正确性、显示书写改正建议一同显示。后台对单一笔画、整字分别通过特征比对法计算评分，最后将其权值相加以百分制形式给出用户的综合书写评分。
<span class="token number">2.4</span>.性能需求分析
系统的功能需求仅仅可以确定系统的任务，但是为了让系统的能够更长久且无误的运行，还需要进行系统的性能需求分析。系统的性能需求是按照系统的功能需求以及系统本身的特性所设定的。将从系统的开发、系统的运行以及部署等多个方面，进行性能的提取。当系统的性能满足需求后，系统的生命周期才会满足预估，且也会使得系统的功能更加完备。
<span class="token number">1</span>.可靠性
系统需要具备一定的可靠性，即用户完成视频输入后，在设备运行内存充足的情况下，系统应该在5秒内完成计算，给出反馈结果。
<span class="token number">2</span>.容错性
用户在进行功能操作时，若输入了错误的数据，如用户在汉字书写过程中，出现连笔、错字的情况等，用户在输入信息时输入了错误的形式信息后，系统不会自动闪退或崩溃，而是将这些错误情况进行捕捉，并显示哪里出错，让用户进行及时更改。
<span class="token number">3</span>.可维护性
系统需要具备一定的可维护性，随着后续的算法优化与替换，书写评价功能的增加等，所有的模块均应该是可维护的，且可增加、替换或者删除的，系统在设计过程中需要达到高内聚低耦合的状态。
<span class="token number">2.5</span>.系统总体设计
<span class="token number">2.5</span>.1.系统总体架构设计
系统总体架构设计是指按照多种角度进行分层，本系统的总体架构如图2-2所示。系统可分为访问层、前端UI、业务层、数据层及基础设施层<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span>。
对于访问层，有Android移动端及安卓用户作为终端。系统的所有功能均是通过这一硬件进行数据计算与显示的。
前端UI对应系统的页面展示与用户交互，该系统部署在App端，使用Android操作系统，以PyQt5作为GUI开发框架，本文转载自http://www.biyezuopin.vip/onews.asp?id<span class="token operator">=</span><span class="token number">14866</span>需要完成对Activity的编写以及Video的读写。
系统的业务层是将系统的功能以业务逻辑的形式展示在系统的总体架构图中。对于用户，主要包含录取视频、选择汉字等业务逻辑功能。对于后台的业务逻辑主要包含视频录制模块、书写评价模块，其中视频录制模块包括录取视频，书写评价模块包括笔画提取、笔顺判别、文本定位与切割、书写评分等功能。
数据层主要包含了数据的存储过程、数据缓存、文件读写等数据操作。
基础设施层对应了系统的物理架构所需要的硬件设备，包括操作系统、摄像头、CPU等。
</code></pre> 
<h2><a id="_91"></a>部分代码展示</h2> 
<pre><code class="prism language-python"><span class="token keyword">import</span> cv2
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> pickle
<span class="token keyword">from</span> text_location <span class="token keyword">import</span> <span class="token operator">*</span>

char_feat_path <span class="token operator">=</span> <span class="token string">'./utils/character_feature_dict'</span>
stroke_feat_path <span class="token operator">=</span> <span class="token string">'./utils/stroke_feature_dict'</span>

<span class="token keyword">def</span> <span class="token function">gravity_core</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 计算汉字的重心特征向量</span>
    <span class="token triple-quoted-string string">'''
    计算汉字的重心特征向量
    ----------
    :param img [ndarray]: 笔画二值图像，笔画为白色
    :return [list]: 归一化的重心坐标
    :return [list]: 绝对重心坐标
    '''</span>
    h<span class="token punctuation">,</span> w <span class="token operator">=</span> img<span class="token punctuation">.</span>shape
    x_axis <span class="token operator">=</span> <span class="token number">0</span>
    y_axis <span class="token operator">=</span> <span class="token number">0</span>
    total <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>img<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">:</span>
        y_axis <span class="token operator">+=</span> row <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>img<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Gy <span class="token operator">=</span> y_axis <span class="token operator">/</span> total
    <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x_axis <span class="token operator">+=</span> col <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>img<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> col<span class="token punctuation">]</span><span class="token punctuation">)</span>
    Gx <span class="token operator">=</span> x_axis <span class="token operator">/</span> total
   <span class="token comment">#除是进行了归一化处理，消除了输入图像分辨率的差异对评分的影响</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>Gx<span class="token operator">/</span>w<span class="token punctuation">,</span> Gy<span class="token operator">/</span>h<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Gx<span class="token punctuation">,</span> Gy<span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">grid_vector</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> n_divide <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token comment"># 计算图像的网格特征向量</span>
    <span class="token triple-quoted-string string">'''
    计算汉字的网格特征向量
    ----------
    :param img [ndarray]: 笔画二值图像，笔画为白色
    :param n_divide [int]: 
    :return [list]: 
    '''</span>
    w<span class="token punctuation">,</span> h <span class="token operator">=</span> img<span class="token punctuation">.</span>shape
    spanX <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>w<span class="token operator">/</span>n_divide<span class="token punctuation">)</span>
    spanY <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>h<span class="token operator">/</span>n_divide<span class="token punctuation">)</span>
    grid_area <span class="token operator">=</span> spanX <span class="token operator">*</span> spanY
    left_border <span class="token operator">=</span> <span class="token number">0</span>
    up_border <span class="token operator">=</span> <span class="token number">0</span>

    grid_vector <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment">#求出每一个矩阵的特征值</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_divide<span class="token punctuation">)</span><span class="token punctuation">:</span>
        left_border <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_divide<span class="token punctuation">)</span><span class="token punctuation">:</span>
            white_num <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>img<span class="token punctuation">[</span>up_border<span class="token punctuation">:</span>up_border<span class="token operator">+</span>spanY<span class="token punctuation">,</span> left_border<span class="token punctuation">:</span>left_border<span class="token operator">+</span>spanX<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token comment">#在这个矩形之中 一共有多少个方格是有白色像素的，然后除以这个矩形的面积</span>
            grid_vector<span class="token punctuation">.</span>append<span class="token punctuation">(</span>white_num <span class="token operator">/</span> grid_area<span class="token punctuation">)</span>
            left_border <span class="token operator">+=</span> spanX
        up_border <span class="token operator">+=</span> spanY

    <span class="token keyword">return</span> grid_vector

<span class="token keyword">def</span> <span class="token function">cosine_similarity</span><span class="token punctuation">(</span>vec1<span class="token punctuation">,</span> vec2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    计算向量余弦相似度
    ----------
    :param vec1 [list]: 向量1，元素应为可计算数值
    :param vec2 [list]: 向量2，元素应为可计算数值
    :return [float]: 相似性数值，取值范围为[-1,1]
    '''</span>
    <span class="token comment">#求余弦相似度的公式</span>
    sim <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>vec1<span class="token punctuation">,</span> vec2<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>vec1<span class="token punctuation">)</span><span class="token operator">*</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>vec2<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> sim

<span class="token keyword">def</span> <span class="token function">stroke_score</span><span class="token punctuation">(</span>stroke_list<span class="token punctuation">,</span> char_id<span class="token punctuation">,</span> dict_path<span class="token punctuation">,</span> gravity_ratio<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    根据单笔画分别评分
    ----------
    :param img [ndarray]: 笔画二值图像列表，笔画为白色
    :param char_id [str]: 汉字编号
    :param dict_path [str]: 模板特征字典文件路径
    :param gravity_ratio [float]: 重心特征评分所占比例，为0到1之间的值
    :return [float]: 笔画评分
    '''</span>
    <span class="token keyword">if</span> gravity_ratio<span class="token operator">&gt;</span><span class="token number">1.0</span> <span class="token keyword">or</span> gravity_ratio<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"单笔画重心评分比例错误，应为0到1之间的值"</span><span class="token punctuation">)</span>
        gravity_ratio <span class="token operator">=</span> <span class="token number">0.2</span>
    grid_ratio <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">-</span> gravity_ratio
    pattern_feat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    score <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>dict_path<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        <span class="token builtin">dict</span> <span class="token operator">=</span> pickle<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        pattern_feat <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">[</span>char_id<span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pattern_feat<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pattern_feat<span class="token punctuation">)</span><span class="token operator">==</span><span class="token builtin">len</span><span class="token punctuation">(</span>stroke_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>pattern_feat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 对每个笔画分别计算特征向量，计算评分</span>
                    gravity<span class="token punctuation">,</span> _ <span class="token operator">=</span> gravity_core<span class="token punctuation">(</span>stroke_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token comment">#重心特征</span>
                    grid <span class="token operator">=</span> grid_vector<span class="token punctuation">(</span>stroke_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>              <span class="token comment">#网络特征</span>
                    gravity_similarity <span class="token operator">=</span> cosine_similarity<span class="token punctuation">(</span>gravity<span class="token punctuation">,</span> pattern_feat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    grid_similarity <span class="token operator">=</span> cosine_similarity<span class="token punctuation">(</span>grid<span class="token punctuation">,</span> pattern_feat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

                    <span class="token comment"># test</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"单笔画重心评分"</span><span class="token punctuation">,</span> gravity_similarity<span class="token punctuation">)</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"单笔画网格评分"</span><span class="token punctuation">,</span> grid_similarity<span class="token punctuation">)</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token comment"># 这是笔画的评分</span>
                    score<span class="token punctuation">.</span>append<span class="token punctuation">(</span>gravity_similarity <span class="token operator">*</span> gravity_ratio <span class="token operator">+</span> grid_similarity <span class="token operator">*</span> grid_ratio<span class="token punctuation">)</span>
                <span class="token keyword">return</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>score<span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"【ERROR】 笔画图片数量与模板不一致！"</span><span class="token punctuation">)</span>
                sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"模板数据丢失！"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
<span class="token comment">#上面是检测单个笔画的，这个是整个字的，用的方法是一模一样</span>
<span class="token keyword">def</span> <span class="token function">char_score</span><span class="token punctuation">(</span>char_img<span class="token punctuation">,</span> char_id<span class="token punctuation">,</span> dict_path<span class="token punctuation">,</span> gravity_ratio<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    对整字进行评分
    ----------
    :param img [ndarray]: 汉字二值图像，文字部分为白色
    :param char_id [str]: 汉字编号
    :param dict_path [str]: 模板特征字典文件路径
    :param gravity_ratio [float]: 重心特征评分所占比例，为0到1之间的值
    :return [float]: 整字评分
    '''</span>
    <span class="token keyword">if</span> gravity_ratio<span class="token operator">&gt;</span><span class="token number">1.0</span> <span class="token keyword">or</span> gravity_ratio<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"单笔画重心评分比例错误，应为0到1之间的值"</span><span class="token punctuation">)</span>
        gravity_ratio <span class="token operator">=</span> <span class="token number">0.2</span>
    grid_ratio <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">-</span> gravity_ratio
    
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>dict_path<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        <span class="token builtin">dict</span> <span class="token operator">=</span> pickle<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        pattern_feat <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">[</span>char_id<span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pattern_feat<span class="token punctuation">)</span><span class="token punctuation">:</span>
            gravity<span class="token punctuation">,</span> _ <span class="token operator">=</span> gravity_core<span class="token punctuation">(</span>char_img<span class="token punctuation">)</span>
            grid <span class="token operator">=</span> grid_vector<span class="token punctuation">(</span>char_img<span class="token punctuation">)</span>
            gravity_similarity <span class="token operator">=</span> cosine_similarity<span class="token punctuation">(</span>gravity<span class="token punctuation">,</span> pattern_feat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            grid_similarity <span class="token operator">=</span> cosine_similarity<span class="token punctuation">(</span>grid<span class="token punctuation">,</span> pattern_feat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            
            <span class="token comment"># test</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"整字重心评分"</span><span class="token punctuation">,</span> gravity_similarity<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"整字网格评分"</span><span class="token punctuation">,</span> grid_similarity<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token keyword">return</span> <span class="token punctuation">(</span>gravity_similarity <span class="token operator">*</span> gravity_ratio <span class="token operator">+</span> grid_similarity <span class="token operator">*</span> grid_ratio<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"模板数据丢失！"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>

<span class="token keyword">def</span> <span class="token function">aesthetic_score</span><span class="token punctuation">(</span>stroke_list<span class="token punctuation">,</span> char_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    计算汉字的书写质量综合评分
    ----------
    :param stroke_list [list]: 笔画二值图像列表，笔画为白色
    :return [float]: 书写评分
    '''</span>
    <span class="token comment"># 计算单笔画评分</span>
    strokes_score <span class="token operator">=</span> stroke_score<span class="token punctuation">(</span>stroke_list<span class="token punctuation">,</span> char_id<span class="token punctuation">,</span> stroke_feat_path<span class="token punctuation">)</span>
    <span class="token comment"># 计算整字评分</span>
    char_img <span class="token operator">=</span> img_merge<span class="token punctuation">(</span>stroke_list<span class="token punctuation">)</span>
    character_score <span class="token operator">=</span> char_score<span class="token punctuation">(</span>char_img<span class="token punctuation">,</span> char_id<span class="token punctuation">,</span> char_feat_path<span class="token punctuation">)</span>

    <span class="token comment"># 权值相加得到综合评分</span>
    stroke_ratio <span class="token operator">=</span> <span class="token number">0.5</span>
    char_ratio <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">-</span> stroke_ratio
    final_score <span class="token operator">=</span> strokes_score <span class="token operator">*</span> stroke_ratio <span class="token operator">+</span> character_score <span class="token operator">*</span> char_ratio

    <span class="token keyword">return</span> final_score

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    stroke_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">"./test_video/strokes/"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".jpg"</span><span class="token punctuation">)</span>
        img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>
        stroke_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
    stroke_list <span class="token operator">=</span> text_location<span class="token punctuation">(</span>stroke_list<span class="token punctuation">)</span>    <span class="token comment"># 文本定位与切割</span>

    score <span class="token operator">=</span> aesthetic_score<span class="token punctuation">(</span>stroke_list<span class="token punctuation">,</span> <span class="token string">'0750'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>

</code></pre> 
<h2><a id="_275"></a>项目运行图片展示</h2> 
<p><img src="https://images2.imgbox.com/95/90/5CajrkDh_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/0d/05/63gwUQ8a_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/ff/33/ZoRIcuIG_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/d7/fc/3yVZfBWl_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/62/29/MAMsRWVR_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/2a/b2/9oCIoAP3_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/9a/fc/sE9VWTf4_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/4a/f2/8fiV66xo_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/9d/c1/KFMrbNpZ_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/04/23/Buc2pKuA_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/c4/6d/mXZjVbAC_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/d1/1c/FugM5Q06_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/66/00/8c84aWKD_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/84e9b345d7e794c6d3dcd012224a2ba8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">3D 建模中的 GLTF、USDZ 和 GLB 3D 文件格式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/407a357471b4d941f47a2f360231b08f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">工业相机——输出图像格式 RAW、RGB、YUV</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>