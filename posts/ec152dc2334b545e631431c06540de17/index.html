<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>深度学习/语义分割入门笔记（一）——遥感影像数据集及标签制作&#43;arcgis批量矢量转栅格 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="深度学习/语义分割入门笔记（一）——遥感影像数据集及标签制作&#43;arcgis批量矢量转栅格" />
<meta property="og:description" content="目录
一、目的
二、深度学习？语义分割？
三、遥感数据集及标签的制作
数据集制作步骤：
批量矢量转栅格步骤：
四、参考视频/文章：
一、目的 对遥感影像进行语义分割。初学看了很多教程，网上这方面内容较多同时也十分杂乱，选择价值高的信息也成为了一个费时费力的难点，总结了一下最近几天看的各种内容，做个笔记。
二、深度学习？语义分割？ 深度学习的课程可谓是十分之多，很多都是关注公众号或者加微信来卖课，大家自己斟酌。这里推荐b站白嫖。基础背景不再多说，这里主要记录我遇到的问题。
目前深度学习的主要三个方向分别是图像分类、目标检测和语义分割：
其中图像分类主要针对图片，比如识别一张动物的照片是猫是狗；目标检测的任务是找出图像中所有感兴趣的目标(物体)，确定它们的类别和位置，进行定位和生成标记物体的边界框；语义分割主要针对像素点进行分类，把每一个像素点都标注上其对应的类别。 根据自己的研究目的来选择相应的方法手段，这里我的需求是针对像素点的语义分割。
三、遥感数据集及标签的制作 【最新笔记在​​​​​​​【实验笔记】谷歌地图配准哨兵二号影像制作遥感影像数据集-CSDN博客】
看了很多教程，目前深度学习数据集的制作主要分为手动和半自动两类。对于一般的不含地理信息的图片（RGB三通道图像或者灰色单通道图像）可以采用半自动的方法进行制作，主流软件有label me、anylabeling等。对于图像的格式介绍在这里关于数据集处理的若干格式-CSDN博客
在遥感图像中，不同于普通图片，通常是包含更多信息比如地理信息以及多个光谱波段的栅格数据，后缀一般为tif，多光谱的遥感影像对于地物识别具有重要意义，自然不能舍弃。我参考了b站一个up的arcgis pro &#43; anylabeling半自动制作遥感影像数据集，最后发现软件并不支持我的四通道16位的tif数据（也可能是我没弄明白），最终选择了手动划分的方法。
数据集制作步骤： 1、使用arcgis pro打开遥感影像。
2、生成随机点。点击【视图】-【地理处理】-【创建随机点】，按照需求填写输出信息。
3、建立缓冲区。【地理处理】-【缓冲区】，同上根据需求填入信息。
4、输出数据集。【地理处理】-【导出训练数据进行深度学习】。
5、数据集标签制作。在arcmap中打开tif，对其进行标注。这里以其中一个为例进行说明。
导入tif影像；新建shp面要素，导入选择与tif源文件相同的坐标系。 右击shp打开属性表，添加字段class_id； 开始编辑，将需要分类的要素进行框选，框选后在属性表中对class_id字段进行赋值。 需要说明的是，这里分为二分类和多分类。也就是可以手动将不同类型的部分都划分出来，分类赋不同的值，也可以使用二分类，将需要提取的内容赋值为1，其他部分全部赋值为0。这里我使用二分类。标注完成。 6、批量面转栅格。上述标注的标签为shp格式，还需要将shp面要素转为tif格式来使用。单个转的话，arcgis工具箱【转换工具】-【转为栅格】-【面转栅格】设置好与原tif相同的像元大小，以及上述标注的“class_id”字段即可。但由于数据集一般过大，这里建议使用批量的方法来处理。
批量矢量转栅格步骤： 使用工具：arcgis安装自带的python2.7&#43;集成开发环境pycharm2022.3软件下载：arcgis不必多说，pycharm的话，建议不要使用最新版，第一新版本某些功能不太稳定，第二2023.2不支持中文汉化包。官网下载地址：其他版本 - PyCharm (jetbrains.com)软件激活：PyCharm 2022.3 激活破解码_安装教程 (持续更新~) - 异常教程 (exception.site)环境配置：打开pycharm，选择【文件】-【新建项目】-【添加解释器】-【添加本地解释器】 ​
注意这里选择【系统解释器】，不要选第一个【虚拟环境】，会发生不幸！
​
代码编写：（这里我的字段用的是id） # coding=utf-8 import os import arcpy from arcpy import env # 设置工作空间为包含 shp 文件的目录 env.workspace = r&#34;D:\DayDayUP\Eco_data\DeepData\shp&#34; # 设置保存转化后的影像路径 save_path = r&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/ec152dc2334b545e631431c06540de17/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-27T14:09:34+08:00" />
<meta property="article:modified_time" content="2023-11-27T14:09:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">深度学习/语义分割入门笔记（一）——遥感影像数据集及标签制作&#43;arcgis批量矢量转栅格</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%E7%9B%AE%E7%9A%84-toc" style="margin-left:160px;"><a href="#%E4%B8%80%E3%80%81%E7%9B%AE%E7%9A%84" rel="nofollow">一、目的</a></p> 
<p id="%E4%BA%8C%E3%80%81%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%EF%BC%9F%E8%AF%AD%E4%B9%89%E5%88%86%E5%89%B2%EF%BC%9F-toc" style="margin-left:160px;"><a href="#%E4%BA%8C%E3%80%81%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%EF%BC%9F%E8%AF%AD%E4%B9%89%E5%88%86%E5%89%B2%EF%BC%9F" rel="nofollow">二、深度学习？语义分割？</a></p> 
<p id="%E4%B8%89%E3%80%81%E9%81%A5%E6%84%9F%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9A%84%E5%88%B6%E4%BD%9C-toc" style="margin-left:160px;"><a href="#%E4%B8%89%E3%80%81%E9%81%A5%E6%84%9F%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9A%84%E5%88%B6%E4%BD%9C" rel="nofollow">三、遥感数据集及标签的制作</a></p> 
<p id="%E6%AD%A5%E9%AA%A4%EF%BC%9A-toc" style="margin-left:200px;"><a href="#%E6%AD%A5%E9%AA%A4%EF%BC%9A" rel="nofollow">数据集制作步骤：</a></p> 
<p id="%E6%89%B9%E9%87%8F%E7%9F%A2%E9%87%8F%E8%BD%AC%E6%A0%85%E6%A0%BC%E6%AD%A5%E9%AA%A4%EF%BC%9A-toc" style="margin-left:200px;"><a href="#%E6%89%B9%E9%87%8F%E7%9F%A2%E9%87%8F%E8%BD%AC%E6%A0%85%E6%A0%BC%E6%AD%A5%E9%AA%A4%EF%BC%9A" rel="nofollow">批量矢量转栅格步骤：</a></p> 
<p id="%E5%9B%9B%E3%80%81%E5%8F%82%E8%80%83%E8%A7%86%E9%A2%91%2F%E6%96%87%E7%AB%A0%EF%BC%9A-toc" style="margin-left:160px;"><a href="#%E5%9B%9B%E3%80%81%E5%8F%82%E8%80%83%E8%A7%86%E9%A2%91%2F%E6%96%87%E7%AB%A0%EF%BC%9A" rel="nofollow">四、参考视频/文章：</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h6 id="%E4%B8%80%E3%80%81%E7%9B%AE%E7%9A%84">一、目的</h6> 
<p>对遥感影像进行语义分割。初学看了很多教程，网上这方面内容较多同时也十分杂乱，选择价值高的信息也成为了一个费时费力的难点，总结了一下最近几天看的各种内容，做个笔记。</p> 
<h6 id="%E4%BA%8C%E3%80%81%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%EF%BC%9F%E8%AF%AD%E4%B9%89%E5%88%86%E5%89%B2%EF%BC%9F">二、深度学习？语义分割？</h6> 
<p>深度学习的课程可谓是十分之多，很多都是关注公众号或者加微信来卖课，大家自己斟酌。这里推荐b站白嫖。基础背景不再多说，这里主要记录我遇到的问题。</p> 
<p>目前深度学习的主要三个方向分别是图像分类、目标检测和语义分割：</p> 
<ul><li><span style="color:#494949;">其中图像分类主要针对图片，比如识别一张动物的照片是猫是狗；</span></li><li><span style="color:#494949;">目标检测的任务是找出图像中所有感兴趣的目标(物体)，确定它们的类别和位置，进行定位和生成标记物体的边界框；</span></li><li><span style="color:#494949;">语义分割主要针对像素点进行分类，把每一个像素点都标注上其对应的类别。</span></li></ul> 
<p>根据自己的研究目的来选择相应的方法手段，这里我的需求是针对像素点的语义分割。</p> 
<h6 id="%E4%B8%89%E3%80%81%E9%81%A5%E6%84%9F%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9A%84%E5%88%B6%E4%BD%9C">三、遥感数据集及标签的制作</h6> 
<p>【最新笔记在​​​​​​​<a href="https://blog.csdn.net/qq_43631231/article/details/134637746?spm=1001.2014.3001.5501" title="【实验笔记】谷歌地图配准哨兵二号影像制作遥感影像数据集-CSDN博客">【实验笔记】谷歌地图配准哨兵二号影像制作遥感影像数据集-CSDN博客</a>】</p> 
<p>看了很多教程，目前深度学习数据集的制作主要分为手动和半自动两类。对于一般的不含地理信息的图片（RGB三通道图像或者灰色单通道图像）可以采用半自动的方法进行制作，主流软件有label me、anylabeling等。对于图像的格式介绍在这里<a href="https://blog.csdn.net/qq_43631231/article/details/134390828?spm=1001.2014.3001.5501" title="关于数据集处理的若干格式-CSDN博客">关于数据集处理的若干格式-CSDN博客</a></p> 
<p>在遥感图像中，不同于普通图片，通常是包含更多信息比如地理信息以及多个光谱波段的栅格数据，后缀一般为tif，多光谱的遥感影像对于地物识别具有重要意义，自然不能舍弃。我参考了b站一个up的arcgis pro + anylabeling半自动制作遥感影像数据集，最后发现软件并不支持我的四通道16位的tif数据（也可能是我没弄明白），最终选择了手动划分的方法。</p> 
<h6 id="%E6%AD%A5%E9%AA%A4%EF%BC%9A">数据集制作步骤：</h6> 
<p><strong>1、使用arcgis pro打开遥感影像。</strong></p> 
<p><img alt="" height="853" src="https://images2.imgbox.com/9f/61/zPVF1Lw8_o.png" width="1200"></p> 
<p><strong>2、生成随机点。</strong>点击【视图】-【地理处理】-【创建随机点】，按照需求填写输出信息。</p> 
<p><img alt="" height="695" src="https://images2.imgbox.com/f1/0f/9ZCWcN59_o.png" width="295"></p> 
<p><strong>3、建立缓冲区。</strong>【地理处理】-【缓冲区】，同上根据需求填入信息。</p> 
<p><img alt="" height="693" src="https://images2.imgbox.com/6f/ea/mqnHiQeM_o.png" width="293"></p> 
<p><strong>4、输出数据集。</strong>【地理处理】-【导出训练数据进行深度学习】。</p> 
<p><img alt="" height="860" src="https://images2.imgbox.com/f2/4c/xABUUAAD_o.png" width="1200"></p> 
<p><strong>5、数据集标签制作</strong>。在arcmap中打开tif，对其进行标注。这里以其中一个为例进行说明。</p> 
<ul><li><span style="color:#494949;">导入tif影像；</span></li><li><span style="color:#494949;">新建shp面要素，导入选择与tif源文件相同的坐标系。</span></li></ul> 
<p><span style="color:#494949;"><img alt="" height="853" src="https://images2.imgbox.com/d3/95/JV7ygaus_o.png" width="1200"></span></p> 
<p><span style="color:#494949;"><img alt="" height="827" src="https://images2.imgbox.com/0a/1f/Tlo9j802_o.png" width="1144"></span></p> 
<ul><li><span style="color:#494949;">右击shp打开属性表，添加字段class_id；</span></li></ul> 
<p><span style="color:#494949;"><img alt="" height="703" src="https://images2.imgbox.com/6e/f0/N1as5ZfI_o.png" width="573"> </span></p> 
<ul><li><span style="color:#494949;">开始编辑，将需要分类的要素进行框选，框选后在属性表中对class_id字段进行赋值。</span></li></ul> 
<p><span style="color:#494949;"><img alt="" height="838" src="https://images2.imgbox.com/6f/9e/FbSfOenS_o.png" width="1200"></span></p> 
<ul><li><span style="color:#494949;">需要说明的是，这里分为二分类和多分类。也就是可以手动将不同类型的部分都划分出来，分类赋不同的值，也可以使用二分类，将需要提取的内容赋值为1，其他部分全部赋值为0。这里我使用二分类。标注完成。</span></li></ul> 
<p><strong>6、批量面转栅格。</strong>上述标注的标签为shp格式，还需要将shp面要素转为tif格式来使用。单个转的话，arcgis工具箱【转换工具】-【转为栅格】-【面转栅格】设置好与原tif相同的像元大小，以及上述标注的“class_id”字段即可。但由于数据集一般过大，这里建议使用批量的方法来处理。</p> 
<h6 id="%E6%89%B9%E9%87%8F%E7%9F%A2%E9%87%8F%E8%BD%AC%E6%A0%85%E6%A0%BC%E6%AD%A5%E9%AA%A4%EF%BC%9A">批量矢量转栅格步骤：</h6> 
<ul><li><span style="color:#494949;">使用工具：arcgis安装自带的python2.7+集成开发环境pycharm2022.3</span></li><li><span style="color:#494949;">软件下载：arcgis不必多说，pycharm的话，建议不要使用最新版，第一新版本某些功能不太稳定，第二2023.2不支持中文汉化包。官网下载地址：<a href="https://www.jetbrains.com/zh-cn/pycharm/download/other.html" rel="nofollow" title="其他版本 - PyCharm (jetbrains.com)">其他版本 - PyCharm (jetbrains.com)</a></span></li><li><span style="color:#494949;">软件激活：<a href="https://www.exception.site/essay/how-to-free-use-pycharm-2020" rel="nofollow" title="PyCharm 2022.3 激活破解码_安装教程 (持续更新~) - 异常教程 (exception.site)">PyCharm 2022.3 激活破解码_安装教程 (持续更新~) - 异常教程 (exception.site)</a></span></li><li><span style="color:#494949;">环境配置：打开pycharm，选择【文件】-【新建项目】-【添加解释器】-【添加本地解释器】</span></li></ul> 
<p><img alt="" height="658" src="https://images2.imgbox.com/07/fe/JiNWPs3M_o.png" width="816">​</p> 
<p> 注意这里选择【系统解释器】，不要选第一个【虚拟环境】，会发生不幸！</p> 
<p><img alt="" height="860" src="https://images2.imgbox.com/a9/33/xY4oGo2q_o.png" width="1200">​</p> 
<ul><li>代码编写：（这里我的字段用的是id）</li></ul> 
<div> 
 <pre><code class="language-python"># coding=utf-8
import os
import arcpy
from arcpy import env

# 设置工作空间为包含 shp 文件的目录
env.workspace = r"D:\DayDayUP\Eco_data\DeepData\shp"

# 设置保存转化后的影像路径
save_path = r"D:\DayDayUP\Eco_data\DeepData\label"

# 判断保存路径是否存在，如果不存在则创建
if not os.path.exists(save_path):
    os.mkdir(save_path)

# 获取工作空间中的所有 shp 文件
shp_files = arcpy.ListFeatureClasses("*.shp")

# 设置像元大小
cell_size = 10.0

# 遍历每个 shp 文件
for shp_file in shp_files:
    # 构建输出的 tif 文件路径，使用原始 shp 文件名字加上 .tif 后缀
    output_tif = os.path.join(save_path, "{}.tif".format(os.path.splitext(shp_file)[0]))

    # 获取 shp 文件的空间参考信息
    spatial_ref = arcpy.Describe(shp_file).spatialReference

    # 进行 FeatureToRaster 转换
    arcpy.FeatureToRaster_conversion(shp_file, "Id", output_tif, cell_size)

    # 更新生成的栅格的空间参考
    arcpy.DefineProjection_management(output_tif, spatial_ref)

    print("已经完成 {} 的转换。".format(shp_file))
</code></pre> 
</div> 
<p><span style="color:#494949;">运行成功后可以在label文件夹里看到，所有的tif文件，用arcgsi打开发现，地理坐标被保存。至此完成遥感影像数据集的制作。</span></p> 
<h6 id="%E5%9B%9B%E3%80%81%E5%8F%82%E8%80%83%E8%A7%86%E9%A2%91%2F%E6%96%87%E7%AB%A0%EF%BC%9A"><strong>四、参考视频/文章：</strong></h6> 
<p><a href="https://www.bilibili.com/video/BV1sj41147yM/?spm_id_from=333.337.top_right_bar_window_custom_collection.content.click" rel="nofollow" title="深度学习语义分割遥感数据集制作流程_哔哩哔哩_bilibili">深度学习语义分割遥感数据集制作流程_哔哩哔哩_bilibili</a></p> 
<p><a href="https://www.bilibili.com/video/BV1Xp4y1M7Yk/?spm_id_from=333.788.top_right_bar_window_custom_collection.content.click" rel="nofollow" title="如何制作遥感深度学习标签&amp;样本（1）_哔哩哔哩_bilibili">如何制作遥感深度学习标签&amp;样本（1）_哔哩哔哩_bilibili</a></p> 
<p><a href="https://www.bilibili.com/video/BV1pp4y1871g/?spm_id_from=333.337.top_right_bar_window_custom_collection.content.click" rel="nofollow" title="飞桨领航团计算机视觉项目实战营_哔哩哔哩_bilibili">飞桨领航团计算机视觉项目实战营_哔哩哔哩_bilibili</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e85c34f8cf989c774a7ca9d17b21e188/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">arm-eabi-gcc 和 arm-none-eabi-gcc 都是基于 GCC 的交叉编译器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ec2a72b6577d1be190c1481ca901f22c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">STM32CubeMX：配置硬件CRC 对比软件CRC计算</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>