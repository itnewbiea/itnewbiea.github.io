<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>加速Python列表和字典，让你代码更加高效 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="加速Python列表和字典，让你代码更加高效" />
<meta property="og:description" content="今天，我们将讨论Python中的优化技术。在本文中，您将了解如何通过避免在列表和字典中进行重新计算来加快代码的速度。
我们先编写一个装饰器函数来计算函数的执行时间，方便测验不同代码的速度：
import functools import time def timeit(func): @functools.wraps(func) def newfunc(*args, **kwargs): startTime = time.time() func(*args, **kwargs) elapsedTime = time.time() - startTime print(&#39;function - {}, took {} ms to complete&#39;.format(func.__name__, int(elapsedTime * 1000))) return newfunc 避免在列表中重新评估 在循环内
代码：
@timeit def append_inside_loop(limit): nums = [] for num in limit: nums.append(num) append_inside_loop(list(range(1, 9999999))) 在上面的函数中.append每次通过循环重新计算的函数引用。执行后，上述函数所花费的总时间：
o/p - function - append_inside_loop, took 529 ms to complete 在循环外
代码：
@timeit def append_outside_loop(limit): nums = [] append = nums." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/61250cdd9346a30e84b0a59965dd545b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-06-30T10:55:44+08:00" />
<meta property="article:modified_time" content="2020-06-30T10:55:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">加速Python列表和字典，让你代码更加高效</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>今天，我们将讨论Python中的优化技术。在本文中，您将了解如何通过避免在列表和字典中进行重新计算来加快代码的速度。</p> 
<p>我们先编写一个装饰器函数来计算函数的执行时间，方便测验不同代码的速度：</p> 
<pre><code>import functools
import time

def timeit(func):
    @functools.wraps(func)
    def newfunc(*args, **kwargs):
        startTime = time.time()
        func(*args, **kwargs)
        elapsedTime = time.time() - startTime
        print('function - {}, took {} ms to complete'.format(func.__name__, int(elapsedTime * 1000)))
    return newfunc
</code></pre> 
<h5><a id="_17"></a>避免在列表中重新评估</h5> 
<p><strong>在循环内</strong></p> 
<p>代码：</p> 
<pre><code>@timeit
def append_inside_loop(limit):
    nums = []
    for num in limit:
        nums.append(num)

append_inside_loop(list(range(1, 9999999)))
</code></pre> 
<p>在上面的函数中.append每次通过循环重新计算的函数引用。执行后，上述函数所花费的总时间：</p> 
<pre><code>o/p - function - append_inside_loop, took 529 ms to complete
</code></pre> 
<p><strong>在循环外</strong></p> 
<p>代码：</p> 
<pre><code>@timeit
def append_outside_loop(limit):
    nums = []
    append = nums.append
    for num in limit:
        append(num)

append_outside_loop(list(range(1, 9999999)))
</code></pre> 
<p>在上面的函数中，我们对nums.append在循环外部估值，并在循环内部使用append为变量。总时间：</p> 
<pre><code>o/p - function - append_outside_loop, took 328 ms to complete
</code></pre> 
<p>如您所见，当我们在​for循环外部追加为一个本地变量，这将花费更少的时间，可以将代码加速201 ms。​</p> 
<h5><a id="_59"></a>避免在字典中重新求值</h5> 
<p><strong>在循环内部</strong></p> 
<p>代码：</p> 
<pre><code>@timeit
def inside_evaluation(limit):
    data = {}
    for num in limit:
        data[num] = data.get(num, 0) + 1

inside_evaluation(list(range(1, 9999999)))
</code></pre> 
<p>上述函数所花费的总时间：</p> 
<pre><code>o/p - function - inside_evaluation, took 1400 ms to complete
</code></pre> 
<p><strong>在循环外</strong></p> 
<p>代码：</p> 
<pre><code>@timeit
def outside_evaluation(limit):
    data = {}
    get = data.get
    for num in limit:
        data[num] = get(num, 0) + 1


outside_evaluation(list(range(1, 9999999)))
</code></pre> 
<p>上述函数所花费的总时间：</p> 
<pre><code>o/p - function - outside_evaluation, took 1189 ms to complete
</code></pre> 
<p>如你所见，我们这里的代码速度提高了211毫秒。</p> 
<p>英文原文：</p> 
<p>https://dev.to/sharmapacific/speedup-python-list-and-dictionary-12</p> 
<blockquote> 
 <p>本文仅供学习之用，版权归原作者所有，如有侵权请联系删除。</p> 
 <p>在学习Python的道路上肯定会遇见困难，别慌，我这里有一套学习资料，包含40+本电子书，800+个教学视频，涉及Python基础、爬虫、框架、数据分析、机器学习等，不怕你学不会！<br> https://shimo.im/docs/JWCghr8prjCVCxxK/ 《Python学习资料》</p> 
 <p>关注公众号【Python圈子】，优质文章每日送达。</p> 
</blockquote>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/83544a0d1e73f4f387545f2fabcfa28d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">GAMIT/GLOBK 10.71处理GNSS/GPS数据入门介绍及简单应用（视频教程）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6ad35674fa1ca7a9ee3032bb3027c5a4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">springboot图片上传大小问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>