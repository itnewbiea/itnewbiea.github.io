<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习之二分类模型评价指标 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习之二分类模型评价指标" />
<meta property="og:description" content="机器学习之二分类模型评价指标 一、二分类模型衡量指标1.1 混淆矩阵：Confusion matrix1.1.1 原理1.1.2 实现 1.2 精确度：Accuracy1.2.1 原理1.2.2 实现 1.3 准确率：Precision1.3.1 原理1.3.2 实现 1.4 召回率：Recall1.4.1 原理1.4.2 实现 1.5 F1-Score1.5.1 原理1.5.2 实现 1.6 PR曲线1.6.1 原理1.6.1 实现 1.7 ROC曲线1.7.1 原理1.7.2 实现 1.8 AUC值1.8.1 原理1.8.2 实现 1.9 KS值1.9.1 原理1.9.2 实现 一、二分类模型衡量指标 1.1 混淆矩阵：Confusion matrix 1.1.1 原理 P（Positive） ：代表1N（Negative） ：代表0T（True） ：代表预测正确F（False） ：代表预测错误 1.1.2 实现 from sklearn.metrics import confusion_matrix confusion_matrix(y_true,y_pred,labels=None,sample_weight = None) &#39;&#39;&#39; y_true：真实的label，一维数组，列名 y_pred：预测值的label，一维数组，行名 labels：默认不指定，此时y_true,y_pred去并集，做升序，做label sample_weight：样本权重 返回结果：返回混淆矩阵 &#39;&#39;&#39; import numpy as np from sklearn." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/3f2c5dddb658b4072302ad2db05d194c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-11T20:31:18+08:00" />
<meta property="article:modified_time" content="2022-05-11T20:31:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习之二分类模型评价指标</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>机器学习之二分类模型评价指标</h4> 
 <ul><li><a href="#_1" rel="nofollow">一、二分类模型衡量指标</a></li><li><ul><li><a href="#11_Confusion_matrix_2" rel="nofollow">1.1 混淆矩阵：Confusion matrix</a></li><li><ul><li><a href="#111__3" rel="nofollow">1.1.1 原理</a></li><li><a href="#112__9" rel="nofollow">1.1.2 实现</a></li></ul> 
   </li><li><a href="#12_Accuracy_33" rel="nofollow">1.2 精确度：Accuracy</a></li><li><ul><li><a href="#121__34" rel="nofollow">1.2.1 原理</a></li><li><a href="#122__40" rel="nofollow">1.2.2 实现</a></li></ul> 
   </li><li><a href="#13_Precision_65" rel="nofollow">1.3 准确率：Precision</a></li><li><ul><li><a href="#131__66" rel="nofollow">1.3.1 原理</a></li><li><a href="#132__71" rel="nofollow">1.3.2 实现</a></li></ul> 
   </li><li><a href="#14_Recall_105" rel="nofollow">1.4 召回率：Recall</a></li><li><ul><li><a href="#141__106" rel="nofollow">1.4.1 原理</a></li><li><a href="#142__112" rel="nofollow">1.4.2 实现</a></li></ul> 
   </li><li><a href="#15_F1Score_115" rel="nofollow">1.5 F1-Score</a></li><li><ul><li><a href="#151__116" rel="nofollow">1.5.1 原理</a></li><li><a href="#152__121" rel="nofollow">1.5.2 实现</a></li></ul> 
   </li><li><a href="#16_PR_124" rel="nofollow">1.6 PR曲线</a></li><li><ul><li><a href="#161__125" rel="nofollow">1.6.1 原理</a></li><li><a href="#161__133" rel="nofollow">1.6.1 实现</a></li></ul> 
   </li><li><a href="#17_ROC_147" rel="nofollow">1.7 ROC曲线</a></li><li><ul><li><a href="#171__148" rel="nofollow">1.7.1 原理</a></li><li><a href="#172__159" rel="nofollow">1.7.2 实现</a></li></ul> 
   </li><li><a href="#18_AUC_180" rel="nofollow">1.8 AUC值</a></li><li><ul><li><a href="#181__181" rel="nofollow">1.8.1 原理</a></li><li><a href="#182__190" rel="nofollow">1.8.2 实现</a></li></ul> 
   </li><li><a href="#19_KS_200" rel="nofollow">1.9 KS值</a></li><li><ul><li><a href="#191__201" rel="nofollow">1.9.1 原理</a></li><li><a href="#192__205" rel="nofollow">1.9.2 实现</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>一、二分类模型衡量指标</h2> 
<h3><a id="11_Confusion_matrix_2"></a>1.1 混淆矩阵：Confusion matrix</h3> 
<h4><a id="111__3"></a>1.1.1 原理</h4> 
<p><img src="https://images2.imgbox.com/79/93/1xnvVBor_o.png" alt="在这里插入图片描述"></p> 
<ul><li>P（Positive） ：代表1</li><li>N（Negative） ：代表0</li><li>T（True） ：代表预测正确</li><li>F（False） ：代表预测错误</li></ul> 
<h4><a id="112__9"></a>1.1.2 实现</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> confusion_matrix
confusion_matrix<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>y_pred<span class="token punctuation">,</span>labels<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>sample_weight <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
y_true：真实的label，一维数组，列名
y_pred：预测值的label，一维数组，行名
labels：默认不指定，此时y_true,y_pred去并集，做升序，做label
sample_weight：样本权重
返回结果：返回混淆矩阵
'''</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> confusion_matrix

y_true <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
y_pred <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

confusion_matrix <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span>
confusion_matrix
<span class="token comment">#结果</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>int64<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="12_Accuracy_33"></a>1.2 精确度：Accuracy</h3> 
<h4><a id="121__34"></a>1.2.1 原理</h4> 
<ul><li>预测正确的结果占总样本的比例。<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           P 
          
         
           r 
          
         
           e 
          
         
           c 
          
         
           i 
          
         
           s 
          
         
           i 
          
         
           o 
          
         
           n 
          
         
           = 
          
          
           
           
             T 
            
           
             P 
            
           
             + 
            
           
             T 
            
           
             N 
            
           
           
           
             T 
            
           
             P 
            
           
             + 
            
           
             F 
            
           
             P 
            
           
             + 
            
           
             T 
            
           
             N 
            
           
             + 
            
           
             F 
            
           
             N 
            
           
          
         
        
          Precision=\frac{TP+TN}{TP+FP+TN+FN} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.12966em; vertical-align: -0.76933em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.36033em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.76933em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></li><li><mark>缺点</mark>：在样本不平衡时，不能很好的衡量结果。如正样本占90%，负样本占10%，样本是严重不平衡的。对于这种情况，我们只需要将全部样本预测为正样本即可得到90%的高准确率，但模型对负样本没有任何识别度。正因为如此，也就衍生了其他两种指标：准确率和召回率。</li></ul> 
<h4><a id="122__40"></a>1.2.2 实现</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score
accuracy_score<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> normalize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> sample_weight<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
y_true：数据的真实label值
y_pred：数据的预测标签值
normalize：默认为True，返回正确预测的个数，若是为False，返回正确预测的比例
sample_weight：样本权重
返回结果：score为正确预测的个数或者比例，由normalize确定
'''</span>

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score
y_true <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
y_pred <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
score <span class="token operator">=</span> accuracy_score<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>
<span class="token comment">#结果：0.6#正确预测的比例</span>
score1 <span class="token operator">=</span> accuracy_score<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>y_pred<span class="token punctuation">,</span>normalize <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>score1<span class="token punctuation">)</span>
<span class="token comment">#结果：3#正确预测的个数</span>
</code></pre> 
<h3><a id="13_Precision_65"></a>1.3 准确率：Precision</h3> 
<h4><a id="131__66"></a>1.3.1 原理</h4> 
<ul><li>又叫查准率，含义是所有被预测为正的样本中实际为正的样本的比例。<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           P 
          
         
           r 
          
         
           e 
          
         
           c 
          
         
           i 
          
         
           s 
          
         
           i 
          
         
           o 
          
         
           n 
          
         
           = 
          
          
           
           
             T 
            
           
             P 
            
           
           
           
             T 
            
           
             P 
            
           
             + 
            
           
             F 
            
           
             P 
            
           
          
         
        
          Precision=\frac{TP}{TP+FP} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.12966em; vertical-align: -0.76933em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.36033em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.76933em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></li></ul> 
<h4><a id="132__71"></a>1.3.2 实现</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report
classification_report<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> 
target_names<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> sample_weight<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> digits<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> output_dict<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
y_true：真实的label，一维数组，列名
y_pred：预测值的label，一维数组，行名
labels：默认不指定，此时y_true,y_pred去并集，做升序，做label
sample_weight：样本权重
target_names：行标签，顺序和label的要一致
digits，整型，小数的位数
out_dict：输出格式，默认False，如果为True，输出字典。
'''</span>

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report

y_true <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
y_pred <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
target_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'class0'</span><span class="token punctuation">,</span><span class="token string">'class1'</span><span class="token punctuation">,</span><span class="token string">'class2'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span>y_pred<span class="token punctuation">,</span>target_names <span class="token operator">=</span> target_names<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#结果如下</span>
  precision    recall  f1<span class="token operator">-</span>score   support

      class0       <span class="token number">0.67</span>      <span class="token number">1.00</span>      <span class="token number">0.80</span>         <span class="token number">2</span>
      class1       <span class="token number">1.00</span>      <span class="token number">0.75</span>      <span class="token number">0.86</span>         <span class="token number">4</span>
      class2       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">1</span>

   micro avg       <span class="token number">0.86</span>      <span class="token number">0.86</span>      <span class="token number">0.86</span>         <span class="token number">7</span>
   macro avg       <span class="token number">0.89</span>      <span class="token number">0.92</span>      <span class="token number">0.89</span>         <span class="token number">7</span>
weighted avg       <span class="token number">0.90</span>      <span class="token number">0.86</span>      <span class="token number">0.86</span>         <span class="token number">7</span>
</code></pre> 
<h3><a id="14_Recall_105"></a>1.4 召回率：Recall</h3> 
<h4><a id="141__106"></a>1.4.1 原理</h4> 
<ul><li>又叫查全率，含义是实际为正的样本中被预测为正样本的比例。<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           R 
          
         
           e 
          
         
           c 
          
         
           a 
          
         
           l 
          
         
           l 
          
         
           = 
          
          
           
           
             T 
            
           
             P 
            
           
           
           
             T 
            
           
             P 
            
           
             + 
            
           
             F 
            
           
             N 
            
           
          
         
        
          Recall=\frac{TP}{TP+FN} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.12966em; vertical-align: -0.76933em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.36033em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.76933em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></li><li><strong>召回率的应用场景</strong>：比如拿网贷违约率为例，相对好用户，我们更关心坏用户，不能错放过任何一个坏用户。因为如果我们过多的将坏用户当成好用户，这样后续可能发生的违约金额会远超过好用户偿还的借贷利息金额，造成严重偿失。<mark>召回率越高，代表实际坏用户被预测出来的概率越高</mark>，它的含义类似：宁可错杀一千，绝不放过一个。</li></ul> 
<h4><a id="142__112"></a>1.4.2 实现</h4> 
<ul><li>实现同1.3.2 。</li></ul> 
<h3><a id="15_F1Score_115"></a>1.5 F1-Score</h3> 
<h4><a id="151__116"></a>1.5.1 原理</h4> 
<ul><li>找寻Precision和Recall之间的平衡，是一个综合的评价指标。<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           F 
          
         
           1 
          
         
           − 
          
         
           S 
          
         
           c 
          
         
           o 
          
         
           r 
          
         
           e 
          
         
           = 
          
          
          
            2 
           
           
            
            
              1 
             
             
             
               P 
              
             
               r 
              
             
               e 
              
             
               c 
              
             
               i 
              
             
               s 
              
             
               i 
              
             
               o 
              
             
               n 
              
             
            
            
            
              1 
             
             
             
               R 
              
             
               e 
              
             
               c 
              
             
               a 
              
             
               l 
              
             
               l 
              
             
            
           
          
         
           = 
          
          
           
           
             2 
            
           
             ∗ 
            
           
             P 
            
           
             r 
            
           
             e 
            
           
             c 
            
           
             i 
            
           
             s 
            
           
             i 
            
           
             o 
            
           
             n 
            
           
             ∗ 
            
           
             R 
            
           
             e 
            
           
             c 
            
           
             a 
            
           
             l 
            
           
             l 
            
           
           
           
             P 
            
           
             r 
            
           
             e 
            
           
             c 
            
           
             i 
            
           
             s 
            
           
             i 
            
           
             o 
            
           
             n 
            
           
             + 
            
           
             R 
            
           
             e 
            
           
             c 
            
           
             a 
            
           
             l 
            
           
             l 
            
           
          
         
        
          F1-Score=\frac{2}{\frac{1}{Precision}\frac{1}{Recall}}=\frac{2*Precision*Recall}{Precision+Recall} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.40155em; vertical-align: -1.08011em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.26489em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">n</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.00773em;">R</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.08011em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.14077em; vertical-align: -0.76933em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.76933em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></li></ul> 
<h4><a id="152__121"></a>1.5.2 实现</h4> 
<ul><li>实现同1.3.2 。</li></ul> 
<h3><a id="16_PR_124"></a>1.6 PR曲线</h3> 
<h4><a id="161__125"></a>1.6.1 原理</h4> 
<ul><li>当正负样本数差距不大时，ROC和PR曲线的趋势是差不多的，<mark>在正负样本分布不均匀的情况下，PRC比ROC能更有效地反应分类器的好坏</mark>。</li><li>横坐标是查全率Recall，纵坐标是查准率Precision。<br> <img src="https://images2.imgbox.com/3f/01/RUjf5RkR_o.png" alt="在这里插入图片描述"></li><li>当PR曲线越靠近右上方时，表明模型性能越好；</li><li>与ROC曲线类似，在对不同模型进行比较时，若一个模型的PR曲线被另一个模型的PR曲线完全包住则说明后者的性能优于前者．如上图中橘色线代表的模型要优于蓝色线代表的模型；</li><li>若模型的PR曲线发生了交叉，则无法直接判断哪个模型更好。在周志华老师的机器学习上中提到了可以用<mark>平衡点</mark>。它是查准率=查全率时的取值，如上图黑色线代表的模型的平衡点要大于橘色线模型代表的平衡点，表明前者优于后者，除此之外更为常用的是F1 score，也就是查准率和查全率的加权平均，F1 = (2<em>查准率</em>查全率)/(查准率+查全率)</li><li><mark>PR曲线绘制</mark>：设置一个从高到低的阈值，预测概率大于等于阈值的样本被预测为正类，小于阈值的样本被预测为负类。显然，设置n个阈值后，就可以得到n个混淆矩阵，从而得到n对Precision和Recall的值，便可绘制成PR曲线。</li></ul> 
<h4><a id="161__133"></a>1.6.1 实现</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> precision_recall_curve
precision<span class="token punctuation">,</span> recall<span class="token punctuation">,</span> t <span class="token operator">=</span>precision_recall_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_score<span class="token punctuation">)</span> <span class="token comment">#y_score是预测的概率值，y_test是真实值标签值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token comment">#t是阈值</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Recall'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Precision'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>recall<span class="token punctuation">,</span> precision<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Precision-Recall"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/dd/0d/h8ysm6yQ_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="17_ROC_147"></a>1.7 ROC曲线</h3> 
<h4><a id="171__148"></a>1.7.1 原理</h4> 
<ul><li>TPR(True Positive Rate)：真正例率，等于Recall。<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           T 
          
         
           P 
          
         
           R 
          
         
           = 
          
          
           
           
             T 
            
           
             P 
            
           
           
           
             T 
            
           
             P 
            
           
             + 
            
           
             F 
            
           
             N 
            
           
          
         
        
          TPR=\frac{TP}{TP+FN} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.12966em; vertical-align: -0.76933em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.36033em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.76933em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></li><li>FPR(False Positive Rate)：假正例率<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           F 
          
         
           P 
          
         
           R 
          
         
           = 
          
          
           
           
             F 
            
           
             P 
            
           
           
           
             F 
            
           
             P 
            
           
             + 
            
           
             T 
            
           
             N 
            
           
          
         
        
          FPR=\frac{FP}{FP+TN} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.12966em; vertical-align: -0.76933em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.36033em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.76933em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></li><li>ROC：Receiver Operating Characteristic Curve，中文名字叫“受试者工作特征曲线”，ROC曲线以FPR为横坐标，TPR为纵坐标，样本数量越多，ROC曲线越平滑。<br> <img src="https://images2.imgbox.com/d5/76/pkw8QR16_o.png" alt="在这里插入图片描述"></li></ul> 
<h4><a id="172__159"></a>1.7.2 实现</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> roc_curve<span class="token punctuation">,</span> auc
fpr<span class="token punctuation">,</span>tpr<span class="token punctuation">,</span>threshold <span class="token operator">=</span> roc_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_score<span class="token punctuation">)</span> <span class="token comment">#y_score是预测概率，y_test是真实值类别</span>
roc_auc <span class="token operator">=</span> auc<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span>tpr<span class="token punctuation">)</span> <span class="token comment">###计算auc的值</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
lw <span class="token operator">=</span> <span class="token number">2</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span>
         lw<span class="token operator">=</span>lw<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'ROC curve (area = %0.2f)'</span> <span class="token operator">%</span> roc_auc<span class="token punctuation">)</span> <span class="token comment">###假正率为横坐标，真正率为纵坐标做曲线</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> lw<span class="token operator">=</span>lw<span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">'--'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.05</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'False Positive Rate'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'True Positive Rate'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'ROC'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"best"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/bb/92/Lb62trN6_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="18_AUC_180"></a>1.8 AUC值</h3> 
<h4><a id="181__181"></a>1.8.1 原理</h4> 
<ul><li>AUC值是ROC曲线下方的面积，越接近于1，模型效果越好。</li><li>比较有意思的是，如果我们连接对角线，它的面积正好是0.5。对角线的实际含义是：随机判断正负样本，正负样本比率应该都是50%，表示随机效果。即最差的随机判断都有0.5，所以一般AUC的值是介于0.5到1之间的。</li><li>UC的一般判断标准：<br> 0.5 - 0.7：效果较低，但用于预测股票已经很不错了<br> 0.7 - 0.85：效果一般<br> 0.85 - 0.95：效果很好<br> 0.95 - 1：效果非常好，但一般不太可能</li></ul> 
<h4><a id="182__190"></a>1.8.2 实现</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> roc_curve<span class="token punctuation">,</span> auc
fpr<span class="token punctuation">,</span>tpr<span class="token punctuation">,</span>threshold <span class="token operator">=</span> roc_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_score<span class="token punctuation">)</span> <span class="token comment">#y_score是预测概率，y_test是真实值类别</span>
roc_auc <span class="token operator">=</span> auc<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span>tpr<span class="token punctuation">)</span> <span class="token comment">###计算auc的值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>roc_auc<span class="token punctuation">)</span>
<span class="token comment">#结果</span>
<span class="token number">0.8133333333333334</span>
</code></pre> 
<h3><a id="19_KS_200"></a>1.9 KS值</h3> 
<h4><a id="191__201"></a>1.9.1 原理</h4> 
<ul><li>KS值是风控领域常用语评估模型区分度的指标。<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           K 
          
         
           S 
          
         
           = 
          
         
           m 
          
         
           a 
          
         
           x 
          
         
           ( 
          
         
           T 
          
         
           P 
          
         
           R 
          
         
           − 
          
         
           F 
          
         
           P 
          
         
           R 
          
         
           ) 
          
         
        
          KS=max(TPR-FPR) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mclose">)</span></span></span></span></span></span></li><li>KS值用来评估模型的区分能力，KS值越大，模型的区分能力越强。</li></ul> 
<h4><a id="192__205"></a>1.9.2 实现</h4> 
<ul><li>实现1</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> roc_curve<span class="token punctuation">,</span> auc
fpr<span class="token punctuation">,</span>tpr<span class="token punctuation">,</span>threshold <span class="token operator">=</span> roc_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_score<span class="token punctuation">)</span> <span class="token comment">#y_score是预测概率，y_test是真实值类别</span>
ks<span class="token operator">=</span><span class="token builtin">max</span><span class="token punctuation">(</span>tpr<span class="token operator">-</span>fpr<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ks<span class="token punctuation">)</span>
</code></pre> 
<ul><li>实现2</li></ul> 
<pre><code class="prism language-python">y_true<span class="token punctuation">,</span>y_pred <span class="token operator">=</span> y_train<span class="token punctuation">,</span>pred_train <span class="token comment"># 先以train的结果为例</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"y"</span><span class="token punctuation">:</span>y_true<span class="token punctuation">,</span><span class="token string">"pred"</span><span class="token punctuation">:</span>y_pred<span class="token punctuation">}</span><span class="token punctuation">)</span>
good_cumlis <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
bad_cumlis <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

good_total <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'y'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
bad_total <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'y'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> cutlist<span class="token punctuation">:</span>
    tmpdf <span class="token operator">=</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'pred'</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    a <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>tmpdf<span class="token punctuation">[</span><span class="token string">'y'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
    b <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>tmpdf<span class="token punctuation">[</span><span class="token string">'y'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
    good_cumlis<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token operator">/</span>good_total<span class="token punctuation">)</span>
    bad_cumlis<span class="token punctuation">.</span>append<span class="token punctuation">(</span>b<span class="token operator">/</span>bad_total<span class="token punctuation">)</span>

df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"cutoff"</span><span class="token punctuation">:</span>cutlist<span class="token punctuation">,</span>
                   <span class="token string">"good_cum"</span><span class="token punctuation">:</span>good_cumlis<span class="token punctuation">,</span>
                   <span class="token string">"bad_cum"</span><span class="token punctuation">:</span>bad_cumlis<span class="token punctuation">,</span>
                   <span class="token string">"delta(good_cum,bad_cum)"</span><span class="token punctuation">:</span><span class="token punctuation">[</span>a<span class="token operator">-</span>b <span class="token keyword">for</span> a<span class="token punctuation">,</span>b <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>good_cumlis<span class="token punctuation">,</span>bad_cumlis<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
deltalis <span class="token operator">=</span> df2<span class="token punctuation">[</span><span class="token string">'delta(good_cum,bad_cum)'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>cutlist<span class="token punctuation">,</span>df2<span class="token punctuation">[</span><span class="token string">'good_cum'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'good_cum'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>cutlist<span class="token punctuation">,</span>df2<span class="token punctuation">[</span><span class="token string">'bad_cum'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'bad_cum'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>cutlist<span class="token punctuation">,</span>deltalis<span class="token punctuation">,</span>label <span class="token operator">=</span> <span class="token string">'delta'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc <span class="token operator">=</span> <span class="token string">'best'</span><span class="token punctuation">)</span>
x1<span class="token operator">=</span>cutlist<span class="token punctuation">[</span>deltalis<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>deltalis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
y1<span class="token operator">=</span><span class="token builtin">max</span><span class="token punctuation">(</span>deltalis<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"cutoff"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"delta(good_cum,bad_cum)"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Delta最大值坐标：\ncutoff=%.4f\ndelta(good_cum,bad_cum)=ks=%.4f"</span><span class="token operator">%</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#-----------------------OUTPUT-----------------------#</span>
Delta最大值坐标：
cutoff<span class="token operator">=</span><span class="token number">0.4174</span>
delta<span class="token punctuation">(</span>good_cum<span class="token punctuation">,</span>bad_cum<span class="token punctuation">)</span><span class="token operator">=</span>ks<span class="token operator">=</span><span class="token number">0.5083</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/21/2e/eiZdhXD7_o.png" alt="在这里插入图片描述"></p> 
<ul><li>KS计算参考：<br> <a href="https://zhuanlan.zhihu.com/p/365959002" rel="nofollow">1. https://zhuanlan.zhihu.com/p/365959002</a><br> <a href="https://blog.csdn.net/sinat_26917383/article/details/51725102">2. https://blog.csdn.net/sinat_26917383/article/details/51725102</a></li></ul>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0c73bb856a79eb338159f67300489c42/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">(zichao)SpringMVC笔记（仅作简单整理，未深入探究）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cbbae9be3662dac465541ded7829b4bf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ibatis.binding.BindingException:Invalid bound statement （not found）:</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>