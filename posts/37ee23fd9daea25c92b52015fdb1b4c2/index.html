<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【数值分析实验MATLAB】插值与拟合：拉格朗日插值、多项式插值、分段插值（三次样条插值）、最小二乘法及平方误差 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【数值分析实验MATLAB】插值与拟合：拉格朗日插值、多项式插值、分段插值（三次样条插值）、最小二乘法及平方误差" />
<meta property="og:description" content="Matlab代码：
format long x=[11 12 13]; y=[0.190809 0.207912 0.224951]; x1=11.5; n=length(x)-1; m=length(x1); y1=zeros(1,m); for k=1:m z=x1(k); y1(k)=0; for i=1:n&#43;1 l=1; for j=1:n&#43;1 if j~=i l=l*(z-x(j))/(x(i)-x(j)); end end y1(k)=y1(k)&#43;l*y(i); end end y1=vpa(y1,7); y1 输出：
y1 = 0.1993685 （1）Matlab代码：
n(1)=5; n(2)=10; n(3)=20; l=1; L=0; t=-5:0.5:5; h=1./(1&#43;t.*t); plot(t,h,&#39;*&#39;) hold on; syms x; for k=1:3 for j=1:n(k)&#43;1 m(j)=-5&#43;(j-1)*10/n(k); end for i=1:n(k)&#43;1 for j=1:n(k)&#43;1 if(i~=j) l=l*(x-m(j))/(m(i)-m(j)); end end L=L&#43;f(m(i))*l; l=1; end a=-5:0.5:5; %a=-5:0.1:5; y=subs(L,x,a); plot(a,y); hold on; L=0; end （2）三次样条插值（三弯矩法）" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/37ee23fd9daea25c92b52015fdb1b4c2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-01-21T00:19:06+08:00" />
<meta property="article:modified_time" content="2020-01-21T00:19:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【数值分析实验MATLAB】插值与拟合：拉格朗日插值、多项式插值、分段插值（三次样条插值）、最小二乘法及平方误差</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/bf/7b/vpGLb9X3_o.png" alt=""><br> Matlab代码：</p> 
<pre><code class="prism language-bash"><span class="token function">format</span> long
x<span class="token operator">=</span><span class="token punctuation">[</span>11 12 13<span class="token punctuation">]</span><span class="token punctuation">;</span>
y<span class="token operator">=</span><span class="token punctuation">[</span>0.190809 0.207912 0.224951<span class="token punctuation">]</span><span class="token punctuation">;</span>
x1<span class="token operator">=</span>11.5<span class="token punctuation">;</span>
n<span class="token operator">=</span>length<span class="token punctuation">(</span>x<span class="token punctuation">)</span>-1<span class="token punctuation">;</span>
m<span class="token operator">=</span>length<span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">;</span>
y1<span class="token operator">=</span>zeros<span class="token punctuation">(</span>1,m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> k<span class="token operator">=</span>1:m
    z<span class="token operator">=</span>x1<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    y1<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span>0<span class="token punctuation">;</span>
    <span class="token keyword">for</span> i<span class="token operator">=</span>1:n+1
        l<span class="token operator">=</span>1<span class="token punctuation">;</span>
        <span class="token keyword">for</span> j<span class="token operator">=</span>1:n+1
            <span class="token keyword">if</span> j~<span class="token operator">=</span>i
                l<span class="token operator">=</span>l*<span class="token punctuation">(</span>z-x<span class="token punctuation">(</span>j<span class="token punctuation">))</span>/<span class="token punctuation">(</span>x<span class="token punctuation">(</span>i<span class="token punctuation">)</span>-x<span class="token punctuation">(</span>j<span class="token punctuation">))</span><span class="token punctuation">;</span>
            end
        end
        y1<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span>y1<span class="token punctuation">(</span>k<span class="token punctuation">)</span>+l*y<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
end
y1<span class="token operator">=</span>vpa<span class="token punctuation">(</span>y1,7<span class="token punctuation">)</span><span class="token punctuation">;</span>
y1
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-bash">y1 <span class="token operator">=</span>
 
0.1993685
</code></pre> 
<p><img src="https://images2.imgbox.com/6b/b0/PyY2oxBt_o.png" alt=""><br> （1）Matlab代码：</p> 
<pre><code class="prism language-bash">n<span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token operator">=</span>5<span class="token punctuation">;</span>
n<span class="token punctuation">(</span>2<span class="token punctuation">)</span><span class="token operator">=</span>10<span class="token punctuation">;</span>
n<span class="token punctuation">(</span>3<span class="token punctuation">)</span><span class="token operator">=</span>20<span class="token punctuation">;</span>
l<span class="token operator">=</span>1<span class="token punctuation">;</span>
L<span class="token operator">=</span>0<span class="token punctuation">;</span>

t<span class="token operator">=</span>-5:0.5:5<span class="token punctuation">;</span>
h<span class="token operator">=</span>1./<span class="token punctuation">(</span>1+t.*t<span class="token punctuation">)</span><span class="token punctuation">;</span>
plot<span class="token punctuation">(</span>t,h,<span class="token string">'*'</span><span class="token punctuation">)</span>
hold on<span class="token punctuation">;</span>

syms x<span class="token punctuation">;</span>
<span class="token keyword">for</span> k<span class="token operator">=</span>1:3
   <span class="token keyword">for</span> j<span class="token operator">=</span>1:n<span class="token punctuation">(</span>k<span class="token punctuation">)</span>+1
       m<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">=</span>-5+<span class="token punctuation">(</span>j-1<span class="token punctuation">)</span>*10/n<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
   end
   <span class="token keyword">for</span> i<span class="token operator">=</span>1:n<span class="token punctuation">(</span>k<span class="token punctuation">)</span>+1
       <span class="token keyword">for</span> j<span class="token operator">=</span>1:n<span class="token punctuation">(</span>k<span class="token punctuation">)</span>+1
           if<span class="token punctuation">(</span>i~<span class="token operator">=</span>j<span class="token punctuation">)</span>
               l<span class="token operator">=</span>l*<span class="token punctuation">(</span>x-m<span class="token punctuation">(</span>j<span class="token punctuation">))</span>/<span class="token punctuation">(</span>m<span class="token punctuation">(</span>i<span class="token punctuation">)</span>-m<span class="token punctuation">(</span>j<span class="token punctuation">))</span><span class="token punctuation">;</span>
           end
       end
       L<span class="token operator">=</span>L+f<span class="token punctuation">(</span>m<span class="token punctuation">(</span>i<span class="token punctuation">))</span>*l<span class="token punctuation">;</span>
       l<span class="token operator">=</span>1<span class="token punctuation">;</span>
   end
   a<span class="token operator">=</span>-5:0.5:5<span class="token punctuation">;</span>
   %a<span class="token operator">=</span>-5:0.1:5<span class="token punctuation">;</span>
   y<span class="token operator">=</span>subs<span class="token punctuation">(</span>L,x,a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   plot<span class="token punctuation">(</span>a,y<span class="token punctuation">)</span><span class="token punctuation">;</span>
   hold on<span class="token punctuation">;</span>
   L<span class="token operator">=</span>0<span class="token punctuation">;</span>
end
</code></pre> 
<p>（2）三次样条插值（三弯矩法）</p> 
<pre><code class="prism language-bash">n<span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token operator">=</span>5<span class="token punctuation">;</span>
n<span class="token punctuation">(</span>2<span class="token punctuation">)</span><span class="token operator">=</span>10<span class="token punctuation">;</span>
n<span class="token punctuation">(</span>3<span class="token punctuation">)</span><span class="token operator">=</span>20<span class="token punctuation">;</span>

t<span class="token operator">=</span>-5:0.1:5<span class="token punctuation">;</span>
h<span class="token operator">=</span>1./<span class="token punctuation">(</span>1+t.*t<span class="token punctuation">)</span><span class="token punctuation">;</span>
plot<span class="token punctuation">(</span>t,h,<span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hold on<span class="token punctuation">;</span>

syms x
<span class="token keyword">for</span> k<span class="token operator">=</span>1:3
   <span class="token keyword">for</span> j<span class="token operator">=</span>1:n<span class="token punctuation">(</span>k<span class="token punctuation">)</span>+1
   m<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">=</span>-5+<span class="token punctuation">(</span>j-1<span class="token punctuation">)</span>*10/n<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
   end
   h<span class="token operator">=</span>10./n<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span> i<span class="token operator">=</span>1:n<span class="token punctuation">(</span>k<span class="token punctuation">)</span>+1
    <span class="token keyword">for</span> j<span class="token operator">=</span>1:n<span class="token punctuation">(</span>k<span class="token punctuation">)</span>+1
        if<span class="token punctuation">(</span>i<span class="token operator">==</span>j<span class="token punctuation">)</span>
            b1<span class="token punctuation">(</span>i,j<span class="token punctuation">)</span><span class="token operator">=</span>4<span class="token punctuation">;</span>
        end
        if<span class="token punctuation">(</span>abs<span class="token punctuation">(</span>i-j<span class="token punctuation">)</span><span class="token operator">==</span>1<span class="token punctuation">)</span>
             b1<span class="token punctuation">(</span>i,j<span class="token punctuation">)</span><span class="token operator">=</span>1<span class="token punctuation">;</span>
        end
       if<span class="token punctuation">(</span>i~<span class="token operator">=</span>j<span class="token operator">&amp;&amp;</span>abs<span class="token punctuation">(</span>i-j<span class="token punctuation">)</span>~<span class="token operator">=</span>1<span class="token punctuation">)</span>
           b1<span class="token punctuation">(</span>i,j<span class="token punctuation">)</span><span class="token operator">=</span>0<span class="token punctuation">;</span>
       end
    end
   end
   <span class="token keyword">for</span> i<span class="token operator">=</span>1:n<span class="token punctuation">(</span>k<span class="token punctuation">)</span>+1
       <span class="token keyword">for</span> j<span class="token operator">=</span>1:n<span class="token punctuation">(</span>k<span class="token punctuation">)</span>+1
           if<span class="token punctuation">(</span>i<span class="token operator">==</span>j<span class="token operator">&amp;&amp;</span>j<span class="token operator">==</span>1<span class="token punctuation">)</span>
               b2<span class="token punctuation">(</span>i,j<span class="token punctuation">)</span><span class="token operator">=</span>2<span class="token punctuation">;</span>
           end
           if<span class="token punctuation">(</span>i<span class="token operator">==</span>j<span class="token operator">&amp;&amp;</span>j<span class="token operator">==</span>n<span class="token punctuation">(</span>k<span class="token punctuation">)</span>+1<span class="token punctuation">)</span>
               b2<span class="token punctuation">(</span>i,j<span class="token punctuation">)</span><span class="token operator">=</span>2<span class="token punctuation">;</span>
           end       
       end
   end
   b<span class="token operator">=</span>b1-b2<span class="token punctuation">;</span>
   b<span class="token operator">=</span>pinv<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
   d<span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token operator">=</span>6.*<span class="token variable"><span class="token punctuation">((</span>f<span class="token punctuation">(</span>m<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">))</span></span>-f<span class="token punctuation">(</span>m<span class="token punctuation">(</span>1<span class="token punctuation">))</span><span class="token punctuation">)</span>./h-f1<span class="token punctuation">(</span>m<span class="token punctuation">(</span>1<span class="token punctuation">))</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span> i<span class="token operator">=</span>2:n<span class="token punctuation">(</span>k<span class="token punctuation">)</span>-1
           d<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span>6.*<span class="token punctuation">(</span>f<span class="token punctuation">(</span>m<span class="token punctuation">(</span>i+1<span class="token punctuation">))</span>-2.*f<span class="token punctuation">(</span>m<span class="token punctuation">(</span>i<span class="token punctuation">))</span>+f<span class="token punctuation">(</span>m<span class="token punctuation">(</span>i-1<span class="token punctuation">))</span><span class="token punctuation">)</span>./<span class="token punctuation">(</span>h.*h<span class="token punctuation">)</span><span class="token punctuation">;</span>
   end
   d<span class="token punctuation">(</span>n<span class="token punctuation">(</span>k<span class="token punctuation">)</span>+1<span class="token punctuation">)</span><span class="token operator">=</span>-6.*<span class="token variable"><span class="token punctuation">((</span>f<span class="token punctuation">(</span>m<span class="token punctuation">(</span>n<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">))</span></span>-f<span class="token punctuation">(</span>m<span class="token punctuation">(</span>n<span class="token punctuation">(</span>k<span class="token punctuation">))</span><span class="token punctuation">))</span>./h-f1<span class="token punctuation">(</span>n<span class="token punctuation">(</span>k<span class="token punctuation">)</span>+1<span class="token punctuation">))</span><span class="token punctuation">;</span>
   c<span class="token operator">=</span>b*d'<span class="token punctuation">;</span>
   syms x
   <span class="token keyword">for</span> i<span class="token operator">=</span>1:n<span class="token punctuation">(</span>k<span class="token punctuation">)</span>
      s<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span>f<span class="token punctuation">(</span>m<span class="token punctuation">(</span>i<span class="token punctuation">))</span>+<span class="token variable"><span class="token punctuation">((</span>f<span class="token punctuation">(</span>m<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">))</span></span>-f<span class="token punctuation">(</span>m<span class="token punctuation">(</span>i<span class="token punctuation">))</span><span class="token punctuation">)</span>./h-<span class="token punctuation">(</span>2*c<span class="token punctuation">(</span>i<span class="token punctuation">)</span>+c<span class="token punctuation">(</span>i+1<span class="token punctuation">))</span>.*h/6<span class="token punctuation">)</span>.*<span class="token punctuation">(</span>x-m<span class="token punctuation">(</span>i<span class="token punctuation">))</span>+0.5.*c<span class="token punctuation">(</span>i<span class="token punctuation">)</span>.*<span class="token punctuation">(</span>x-m<span class="token punctuation">(</span>i<span class="token punctuation">))</span>^2+<span class="token punctuation">(</span>c<span class="token punctuation">(</span>i+1<span class="token punctuation">)</span>-c<span class="token punctuation">(</span>i<span class="token punctuation">))</span>.*<span class="token punctuation">(</span>x-m<span class="token punctuation">(</span>i<span class="token punctuation">))</span>^3./<span class="token punctuation">(</span>6.*h<span class="token punctuation">)</span><span class="token punctuation">;</span>
       a<span class="token operator">=</span>m<span class="token punctuation">(</span>i<span class="token punctuation">)</span>:h:m<span class="token punctuation">(</span>i+1<span class="token punctuation">)</span><span class="token punctuation">;</span>
      y<span class="token operator">=</span>subs<span class="token punctuation">(</span>s<span class="token punctuation">(</span>i<span class="token punctuation">)</span>,x,a<span class="token punctuation">)</span><span class="token punctuation">;</span>
      plot<span class="token punctuation">(</span>a,y<span class="token punctuation">)</span><span class="token punctuation">;</span>
      hold on
   end
end
</code></pre> 
<p><img src="https://images2.imgbox.com/45/7c/KBH23U2F_o.png" alt=""><br> Matlab代码：</p> 
<pre><code class="prism language-bash"><span class="token function">format</span> short
%第一题
X<span class="token operator">=</span><span class="token punctuation">[</span>1 2 3 4 5<span class="token punctuation">]</span><span class="token punctuation">;</span>
Y<span class="token operator">=</span><span class="token punctuation">[</span>4 4.5 6 8 8.5<span class="token punctuation">]</span><span class="token punctuation">;</span>
m<span class="token operator">=</span>1<span class="token punctuation">;</span>
%最小二乘算法
<span class="token punctuation">[</span>~,n<span class="token punctuation">]</span><span class="token operator">=</span>size<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>
S<span class="token operator">=</span>zeros<span class="token punctuation">(</span>1,2*m+1<span class="token punctuation">)</span><span class="token punctuation">;</span>
T<span class="token operator">=</span>zeros<span class="token punctuation">(</span>m+1,1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> k<span class="token operator">=</span>1:2*m+1
    S<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span>sum<span class="token punctuation">(</span>X.^<span class="token punctuation">(</span>k-1<span class="token punctuation">))</span><span class="token punctuation">;</span>
end
<span class="token keyword">for</span> k<span class="token operator">=</span>1:m+1
    T<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span>sum<span class="token punctuation">(</span>X.^<span class="token punctuation">(</span>k-1<span class="token punctuation">)</span>.*Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
end
A<span class="token operator">=</span>zeros<span class="token punctuation">(</span>m+1,m+1<span class="token punctuation">)</span><span class="token punctuation">;</span>
a<span class="token operator">=</span>zeros<span class="token punctuation">(</span>m+1,1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span>1:m+1
    <span class="token keyword">for</span> j<span class="token operator">=</span>1:m+1
        A<span class="token punctuation">(</span>i,j<span class="token punctuation">)</span><span class="token operator">=</span>S<span class="token punctuation">(</span>i+j-1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
end
a<span class="token operator">=</span>A\T<span class="token punctuation">;</span>
a
%平方误差
g<span class="token operator">=</span>0<span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span>1:n
    y<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span>a<span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> j<span class="token operator">=</span>2:m+1
        y<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span>y<span class="token punctuation">(</span>i<span class="token punctuation">)</span>+a<span class="token punctuation">(</span>j<span class="token punctuation">)</span>*X<span class="token punctuation">(</span>i<span class="token punctuation">)</span>^<span class="token punctuation">(</span>j-1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
    g<span class="token operator">=</span>g+<span class="token punctuation">(</span>y<span class="token punctuation">(</span>i<span class="token punctuation">)</span>-Y<span class="token punctuation">(</span>i<span class="token punctuation">))</span>^2<span class="token punctuation">;</span>
end
fprintf<span class="token punctuation">(</span><span class="token string">'平方误差为%.4f\n'</span>,g<span class="token punctuation">)</span><span class="token punctuation">;</span>
plot<span class="token punctuation">(</span>X,Y,<span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hold on<span class="token punctuation">;</span>
plot<span class="token punctuation">(</span>X,y,<span class="token string">'r--'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
legend<span class="token punctuation">(</span><span class="token string">'原始数据'</span>,<span class="token string">'拟合曲线'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-bash">a <span class="token operator">=</span>

    2.4500
    1.2500

平方误差为0.6750
</code></pre> 
<p><img src="https://images2.imgbox.com/73/8d/7k3Q66YM_o.png" alt=""><br> （1）Matlab代码：</p> 
<pre><code class="prism language-bash">%第二题
X<span class="token operator">=</span><span class="token punctuation">[</span>2 3 4 7 8 10 11 14 16 18 19<span class="token punctuation">]</span><span class="token punctuation">;</span>
Y<span class="token operator">=</span><span class="token punctuation">[</span>106.42 108.2 109.5 110 109.93 110.49 110.59 110.6 110.76 111 111.2<span class="token punctuation">]</span><span class="token punctuation">;</span>
m<span class="token operator">=</span>2<span class="token punctuation">;</span>
%最小二乘算法
<span class="token punctuation">[</span>~,n<span class="token punctuation">]</span><span class="token operator">=</span>size<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>
S<span class="token operator">=</span>zeros<span class="token punctuation">(</span>1,2*m+1<span class="token punctuation">)</span><span class="token punctuation">;</span>
T<span class="token operator">=</span>zeros<span class="token punctuation">(</span>m+1,1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> k<span class="token operator">=</span>1:2*m+1
    S<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span>sum<span class="token punctuation">(</span>X.^<span class="token punctuation">(</span>k-1<span class="token punctuation">))</span><span class="token punctuation">;</span>
end
<span class="token keyword">for</span> k<span class="token operator">=</span>1:m+1
    T<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span>sum<span class="token punctuation">(</span>X.^<span class="token punctuation">(</span>k-1<span class="token punctuation">)</span>.*Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
end
A<span class="token operator">=</span>zeros<span class="token punctuation">(</span>m+1,m+1<span class="token punctuation">)</span><span class="token punctuation">;</span>
a<span class="token operator">=</span>zeros<span class="token punctuation">(</span>m+1,1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span>1:m+1
    <span class="token keyword">for</span> j<span class="token operator">=</span>1:m+1
        A<span class="token punctuation">(</span>i,j<span class="token punctuation">)</span><span class="token operator">=</span>S<span class="token punctuation">(</span>i+j-1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
end
a<span class="token operator">=</span>A\T<span class="token punctuation">;</span>
a
%平方误差
g<span class="token operator">=</span>0<span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span>1:n
    y<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span>a<span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> j<span class="token operator">=</span>2:m+1
        y<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span>y<span class="token punctuation">(</span>i<span class="token punctuation">)</span>+a<span class="token punctuation">(</span>j<span class="token punctuation">)</span>*X<span class="token punctuation">(</span>i<span class="token punctuation">)</span>^<span class="token punctuation">(</span>j-1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
    g<span class="token operator">=</span>g+<span class="token punctuation">(</span>y<span class="token punctuation">(</span>i<span class="token punctuation">)</span>-Y<span class="token punctuation">(</span>i<span class="token punctuation">))</span>^2<span class="token punctuation">;</span>
end
fprintf<span class="token punctuation">(</span><span class="token string">'平方误差为%.4f\n'</span>,g<span class="token punctuation">)</span><span class="token punctuation">;</span>
plot<span class="token punctuation">(</span>X,Y,<span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hold on<span class="token punctuation">;</span>
plot<span class="token punctuation">(</span>X,y,<span class="token string">'r--'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
legend<span class="token punctuation">(</span><span class="token string">'原始数据'</span>,<span class="token string">'拟合曲线'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-bash">a <span class="token operator">=</span>

  106.2927
    0.6264
   -0.0205

平方误差为2.7796
</code></pre> 
<p>（2）Matlab代码：</p> 
<pre><code class="prism language-bash"><span class="token keyword">function</span> ercf1<span class="token punctuation">(</span><span class="token punctuation">)</span>
X<span class="token operator">=</span><span class="token punctuation">[</span>2 3 4 7 8 10 11 14 16 18 19<span class="token punctuation">]</span><span class="token punctuation">;</span>
Y<span class="token operator">=</span><span class="token punctuation">[</span>106.42 108.2 109.5 110 109.93 110.49 110.59 110.6 110.76 111 111.2<span class="token punctuation">]</span><span class="token punctuation">;</span>
X<span class="token operator">=</span>1./X<span class="token punctuation">;</span>
Y<span class="token operator">=</span>log<span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
m<span class="token operator">=</span>1<span class="token punctuation">;</span>
%最小二乘算法
<span class="token punctuation">[</span>~,n<span class="token punctuation">]</span><span class="token operator">=</span>size<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>
S<span class="token operator">=</span>zeros<span class="token punctuation">(</span>1,2*m+1<span class="token punctuation">)</span><span class="token punctuation">;</span>
T<span class="token operator">=</span>zeros<span class="token punctuation">(</span>m+1,1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> k<span class="token operator">=</span>1:2*m+1
    S<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span>sum<span class="token punctuation">(</span>X.^<span class="token punctuation">(</span>k-1<span class="token punctuation">))</span><span class="token punctuation">;</span>
end
<span class="token keyword">for</span> k<span class="token operator">=</span>1:m+1
    T<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">=</span>sum<span class="token punctuation">(</span>X.^<span class="token punctuation">(</span>k-1<span class="token punctuation">)</span>.*Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
end
A<span class="token operator">=</span>zeros<span class="token punctuation">(</span>m+1,m+1<span class="token punctuation">)</span><span class="token punctuation">;</span>
a<span class="token operator">=</span>zeros<span class="token punctuation">(</span>m+1,1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span>1:m+1
    <span class="token keyword">for</span> j<span class="token operator">=</span>1:m+1
        A<span class="token punctuation">(</span>i,j<span class="token punctuation">)</span><span class="token operator">=</span>S<span class="token punctuation">(</span>i+j-1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
end
a<span class="token operator">=</span>A\T<span class="token punctuation">;</span>
a<span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token operator">=</span>exp<span class="token punctuation">(</span>a<span class="token punctuation">(</span>1<span class="token punctuation">))</span><span class="token punctuation">;</span>
X<span class="token operator">=</span>1./X<span class="token punctuation">;</span>
Y<span class="token operator">=</span>exp<span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
a
g<span class="token operator">=</span>0<span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span>1:n
    y<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span>a<span class="token punctuation">(</span>1<span class="token punctuation">)</span>*<span class="token punctuation">(</span>exp<span class="token punctuation">(</span>a<span class="token punctuation">(</span>2<span class="token punctuation">)</span>/X<span class="token punctuation">(</span>i<span class="token punctuation">))</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    g<span class="token operator">=</span>g+<span class="token punctuation">(</span>y<span class="token punctuation">(</span>i<span class="token punctuation">)</span>-Y<span class="token punctuation">(</span>i<span class="token punctuation">))</span>^2<span class="token punctuation">;</span>
end
fprintf<span class="token punctuation">(</span><span class="token string">'平方误差为%.4f\n'</span>,g<span class="token punctuation">)</span><span class="token punctuation">;</span>
plot<span class="token punctuation">(</span>X,Y,<span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hold on<span class="token punctuation">;</span>
plot<span class="token punctuation">(</span>X,y,<span class="token string">'r--'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
legend<span class="token punctuation">(</span><span class="token string">'原始数据'</span>,<span class="token string">'拟合曲线'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-bash">a <span class="token operator">=</span>

  111.4940
   -0.0903

平方误差为0.4719
</code></pre> 
<p>ps：运行后的图片未贴出来</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c37c2d26f94f4e64a818f05a602e4210/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MongoDB 日志切割三种方式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/24744219279391f356ed9e4141cb494b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ElasticSearch学习笔记（九）——Elasticsearch查询原理分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>