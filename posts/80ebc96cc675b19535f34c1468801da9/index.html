<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用香橙派zero2及其他单网口开发板搭建UU加速盒 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用香橙派zero2及其他单网口开发板搭建UU加速盒" />
<meta property="og:description" content="本方案的初衷： UU加速盒价格昂贵，恰巧官方发布了Openwrt插件，于是想通过教程让更多人利用自己手里的开发板作为盒子使用，一举两得。之前网上没有相关教程，zero2也没有Openwrt固件，于是就写了这篇文章。
P.S.本方案适用于单口树莓派以及其他单口香橙派。至于为什么没有多接口，主要是因为docker在配置多网口开发板时虚拟网卡写法与单口不同。详情查看docker官网。
本方法基于以下操作： 1、香橙派zero2安装docker。
2、香橙派zero2安装openwrt的docker方法。
3、UU加速器openwrt版插件。
环境： 1、香橙派zero2（单网口）（下文简称Oz）
2、官网版Debian系统（自带清华软件源）
3、加速设备：PlayStation5 光驱版
经验分享（此部分非教程，可以不看。）： 错误/未实现思路：
1、使用oz作为主路由，主机连接wifi加速。
未实现原因：Docker内openwrt仅作为旁路由，不识别无线网卡。
2、使用openwrt
未实现原因：无适配固件。
3、加无线网卡使docker识别。
未实现原因：最近出品的无线网卡驱动大多只支持Linux内核5.3一下，官网Debian为5.16 。
成功实现思路：使用Docker搭建Openwrt作为旁路由使用。
实现（教程部分！）： 1.系统配置部分并连接终端（SSH），贴官网链接：
Orange Pi Zero 2 - Wiki-Orange Pi
2.使用网线连接oz与主路由LAN接口。在SSH中输入命令
sudo apt update sudo apt install docker.io 即可安装docker。
安装docker后，先进行网卡混杂：
ip link set eth0 promisc on 然后创建macvlan：（请将[主路由IP]替换为路由器IP。格式一般为192.168.x.1
docker network create -d macvlan --subnet=[主路由IP]/24 --gateway=[主路由IP] -o parent=eth0 macnet 拉取openwrt的docker镜像并运行：（armv8版本，如果非派zero2请使用命令2）
sudo docker run --restart always --name openwrt -d --network macnet --privileged sulinggg/openwrt:armv8 /sbin/init sudo docker run --restart always --name openwrt -d --network macnet --privileged unifreq/openwrt-aarch64:latest 等待输出一串容器id后即为配置成功。接下来进入终端。输入以下命令可以进入openwrt的终端。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/80ebc96cc675b19535f34c1468801da9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-15T22:42:02+08:00" />
<meta property="article:modified_time" content="2022-08-15T22:42:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用香橙派zero2及其他单网口开发板搭建UU加速盒</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>本方案的初衷：</h2> 
<p>UU加速盒价格昂贵，恰巧官方发布了Openwrt插件，于是想通过教程让更多人利用自己手里的开发板作为盒子使用，一举两得。之前网上没有相关教程，zero2也没有Openwrt固件，于是就写了这篇文章。</p> 
<p>P.S.本方案适用于单口树莓派以及其他单口香橙派。至于为什么没有多接口，主要是因为docker在配置多网口开发板时虚拟网卡写法与单口不同。详情查看docker官网。</p> 
<h2>本方法基于以下操作：</h2> 
<p>1、香橙派zero2安装docker。</p> 
<p>2、香橙派zero2安装openwrt的docker方法。</p> 
<p>3、UU加速器openwrt版插件。</p> 
<h2>环境：</h2> 
<p>1、香橙派zero2（单网口）（下文简称Oz）</p> 
<p>2、官网版Debian系统（自带清华软件源）</p> 
<p>3、加速设备：PlayStation5 光驱版</p> 
<h2>经验分享<span style="color:#fe2c24;">（此部分非教程，可以不看。）</span><span style="color:#0d0016;">：</span></h2> 
<p><span style="color:#0d0016;">错误/未实现思路：</span></p> 
<p><span style="color:#0d0016;">1、使用oz作为主路由，主机连接wifi加速。</span><br><span style="color:#0d0016;">未实</span><span style="color:#0d0016;">现原因：Docker内openwrt仅作为旁路由，不识别无线网卡。</span></p> 
<p><span style="color:#0d0016;">2、使用openwrt</span></p> 
<p><span style="color:#0d0016;">未实</span><span style="color:#0d0016;">现原因：无适配固件。</span></p> 
<p><span style="color:#0d0016;">3、加无线网卡使docker识别。</span></p> 
<p><span style="color:#0d0016;">未实</span><span style="color:#0d0016;">现原因：最近出品的无线网卡驱动大多只支持Linux内核5.3一下，官网Debian为5.16 。</span></p> 
<p><span style="color:#0d0016;">成功实现思路：使用Docker搭建Openwrt作为旁路由使用。</span></p> 
<h2>实现<span style="color:#fe2c24;">（教程部分！）</span>：</h2> 
<p>1.系统配置部分并连接终端（SSH），贴官网链接：</p> 
<p><a href="http://www.orangepi.cn/orangepiwiki/index.php/Orange_Pi_Zero_2#.E4.B8.8B.E8.BD.BD.E5.BC.80.E5.8F.91.E6.9D.BF.E7.9A.84.E9.95.9C.E5.83.8F.E5.92.8C.E7.9B.B8.E5.85.B3.E7.9A.84.E8.B5.84.E6.96.99" rel="nofollow" title="Orange Pi Zero 2 - Wiki-Orange Pi">Orange Pi Zero 2 - Wiki-Orange Pi</a></p> 
<p>2.使用网线连接oz与主路由LAN接口。在SSH中输入命令</p> 
<pre><code class="language-bash">sudo apt update
sudo apt install docker.io</code></pre> 
<p>即可安装docker。</p> 
<p>安装docker后，先进行网卡混杂：</p> 
<pre><code class="language-bash">ip link set eth0 promisc on</code></pre> 
<p>然后创建macvlan：（请将[主路由IP]替换为路由器IP。格式一般为192.168.x.1</p> 
<pre><code class="language-bash">docker network create -d macvlan --subnet=[主路由IP]/24 --gateway=[主路由IP] -o parent=eth0 macnet</code></pre> 
<p>拉取openwrt的docker镜像并运行：（armv8版本，如果非派zero2请使用命令2）</p> 
<pre><code class="language-bash">sudo docker run --restart always --name openwrt -d --network macnet --privileged sulinggg/openwrt:armv8 /sbin/init</code></pre> 
<pre><code class="language-bash">sudo docker run --restart always --name openwrt -d --network macnet --privileged unifreq/openwrt-aarch64:latest
</code></pre> 
<p>等待输出一串容器id后即为配置成功。接下来进入终端。输入以下命令可以进入openwrt的终端。</p> 
<pre><code class="language-bash">sudo docker exec -it openwrt bash</code></pre> 
<p>会显示如下字样，这时候可以输入命令：</p> 
<pre><code>bash-5.1#</code></pre> 
<p>输入如下命令进入vi，新手建议先百度vi如何使用；</p> 
<p>输入后编辑openwrt配置文件。</p> 
<pre><code class="language-bash">vi /etc/config/network
</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ef/c3/GPplcdHh_o.png"></p> 
<p></p> 
<p>修改如下字段：（新用户没有gateway和dns修改，请自己打出来。）</p> 
<pre><code class="language-bash">option ipaddr '192.168.x(路由器的第三位).[随机数，只要不和局域网设备重复]'

option gateway '[路由器IP]'

option dns '[路由器IP]'</code></pre> 
<p>然后保存。</p> 
<p>之后重启服务：</p> 
<pre><code class="language-bash">/etc/init.d/network restart
</code></pre> 
<p>openwrt配置完成，可以在浏览器输入刚刚ipaddr中的IP访问openwrt页面。</p> 
<p>3.进行插件安装</p> 
<p>在刚刚的命令行中依次输入以下命令：</p> 
<pre><code class="language-bash">wget http://uu.gdl.netease.com/uuplugin-script/202012111056/install.sh -O install.sh
/bin/sh install.sh openwrt $(uname -m)
</code></pre> 
<p>即可完成插件安装。</p> 
<p>为了解决设备一闪而过  /  连接失败等问题，依次输入以下内容添加规则：</p> 
<pre><code class="language-bash">iptables -t nat -A POSTROUTING -d 192.168.0.0/16 -o br-lan -j ACCEPT
iptables -t nat -A POSTROUTING -d 172.16.0.0/12 -o br-lan -j ACCEPT
iptables -t nat -A POSTROUTING -d 127.0.0.0/8 -o br-lan -j ACCEPT
iptables -t nat -A POSTROUTING -d 10.0.0.0/8 -o br-lan -j ACCEPT
iptables -t nat -A POSTROUTING -o br-lan -j SNAT --to [刚刚的ipaddr，也就是旁路由ip]</code></pre> 
<p>4.配置加速</p> 
<p>在手机上开启 UU <br> 直接打开 UU 主机加速，点击安装路由器插件，会提示该路由器型号暂不支持加速。</p> 
<p>此时，我们手动修改手机上网方式</p> 
<p>点开wifi-手动（类似这样，品牌不同说法不同）</p> 
<p>IP地址：随便输192.168.x.[随机]</p> 
<p>子网掩码：255.255.0.0</p> 
<p>网关：[ipaddr]</p> 
<p>DNS:[ipaddr]</p> 
<p>配置后再打开UU，点击测试，就可以绑定openwrt了。</p> 
<p>然后进入PS5/switch/xbox的网络设置，手动输入和手机相同的配置，即可连接UU加速器。</p> 
<p>UU会识别到设备，点击加速即可。</p> 
<p>——END——</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/749167ef53b9bb1e2866a5f0d1e7529f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ElasticSearch 数据备份与恢复</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/91227fb59df927323391f734c80132af/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Reverse proxy in QTS5.x</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>