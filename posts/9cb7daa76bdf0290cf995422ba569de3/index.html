<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>centos7 安装LibreOffice（超级详细） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="centos7 安装LibreOffice（超级详细）" />
<meta property="og:description" content="简介： 有的时候我们会遇到将word转换为pdf的需求，当然，不仅仅是word转换为PDF，像图片转换为pdf等等这样的转换工作。
如果涉及到以上这些需求，那么使用LibreOffice不失为一个好的方式，从转换后的准确率、转换速度、转换格式的支持LibreOffice都是比较给力的。下面，让我们具体学习下如何安装和使用libreOffice
官网信息： https://zh-cn.libreoffice.org/download/libreoffice/
安装 建议选择稳定版本，这里我选择了 LibreOffice 7.4.5。
下载和解压需要的包 选择你对应操作系统的包，我这里是Linux的rpm包 https://downloadarchive.documentfoundation.org/libreoffice/old/7.4.5.1/rpm/x86_64/
一般在最下面：
将上述的包下载下来后上传到服务器上，解压并安装 tar -zxvf LibreOffice_7.4.5.1_Linux_x86-64_rpm_langpack_zh-CN.tar.gz tar -zxvf LibreOffice_7.4.5.1_Linux_x86-64_rpm.tar.gz cd /LibreOffice_7.4.5.1_Linux_x86-64_rpm/RPMS/ yum localinstall *.rpm cd /LibreOffice_7.4.5.1_Linux_x86-64_rpm_langpack_zh-CN/RPMS/ yum localinstall *.rpm 安装成功后，会在 /opt/目录下生成一个libreoffice7.4的目录 配置环境变量 vim /etc/profile。 在文档底部添加如下内容。 然后source /etc/profile 使得配置生效
# libreoffice export LibreOffice_PATH=/opt/libreoffice7.4/program export PATH=$LibreOffice_PATH:$PATH 正常服务器不缺少底层依赖的话，这个时候你已经成功了，可以尝试下输入 libreoffice7.4 --help。 出现以下内容说明已经可以了。可以直接试下转换。否则看下个标题。
报错 No such file or directory 很明显，缺少依赖了。安装一下。
yum install cairo -y yum install cups-libs -y yum install libSM -y 试着转换pdf 经过前面的步骤我们已经安装好了LibreOffice，现在试着转换个word为pdf吧。 上传个word到服务器上。然后输入以下命令：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/9cb7daa76bdf0290cf995422ba569de3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-08T14:50:58+08:00" />
<meta property="article:modified_time" content="2023-03-08T14:50:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">centos7 安装LibreOffice（超级详细）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="_0"></a>简介：</h4> 
<p>有的时候我们会遇到将word转换为pdf的需求，当然，不仅仅是word转换为PDF，像图片转换为pdf等等这样的转换工作。<br> 如果涉及到以上这些需求，那么使用LibreOffice不失为一个好的方式，从转换后的准确率、转换速度、转换格式的支持LibreOffice都是比较给力的。下面，让我们具体学习下如何安装和使用libreOffice</p> 
<h4><a id="_3"></a>官网信息：</h4> 
<p><a href="https://zh-cn.libreoffice.org/download/libreoffice/" rel="nofollow">https://zh-cn.libreoffice.org/download/libreoffice/</a><br> <img src="https://images2.imgbox.com/24/6b/op6OodJa_o.png" alt="image.png"></p> 
<h4><a id="_6"></a>安装</h4> 
<blockquote> 
 <p>建议选择稳定版本，这里我选择了 LibreOffice 7.4.5。</p> 
</blockquote> 
<h5><a id="_9"></a>下载和解压需要的包</h5> 
<ol><li>选择你对应操作系统的包，我这里是Linux的rpm包</li></ol> 
<p><a href="https://downloadarchive.documentfoundation.org/libreoffice/old/7.4.5.1/rpm/x86_64/" rel="nofollow">https://downloadarchive.documentfoundation.org/libreoffice/old/7.4.5.1/rpm/x86_64/</a><br> <img src="https://images2.imgbox.com/d1/f2/P4xOJXwn_o.png" alt="image.png"><br> <img src="https://images2.imgbox.com/f1/95/FepWJAJd_o.png" alt="image.png"></p> 
<p><img src="https://images2.imgbox.com/ed/20/lZjNx0Ba_o.png" alt="image.png"><br> 一般在最下面：<br> <img src="https://images2.imgbox.com/84/81/ttYrUC4c_o.png" alt="image.png"></p> 
<ol start="2"><li>将上述的包下载下来后上传到服务器上，解压并安装</li></ol> 
<pre><code class="prism language-nginx">tar -zxvf LibreOffice_7.4.5.1_Linux_x86-64_rpm_langpack_zh-CN.tar.gz
tar -zxvf LibreOffice_7.4.5.1_Linux_x86-64_rpm.tar.gz
	
cd /LibreOffice_7.4.5.1_Linux_x86-64_rpm/RPMS/
yum localinstall *.rpm
cd /LibreOffice_7.4.5.1_Linux_x86-64_rpm_langpack_zh-CN/RPMS/
yum localinstall *.rpm
</code></pre> 
<ol start="3"><li>安装成功后，会在 /opt/目录下生成一个libreoffice7.4的目录</li></ol> 
<h5><a id="_33"></a>配置环境变量</h5> 
<p>vim /etc/profile。 在文档底部添加如下内容。 然后source /etc/profile 使得配置生效</p> 
<pre><code class="prism language-nginx"># libreoffice
export LibreOffice_PATH=/opt/libreoffice7.4/program
export PATH=$LibreOffice_PATH:$PATH
</code></pre> 
<p>正常服务器不缺少底层依赖的话，这个时候你已经成功了，可以尝试下输入 libreoffice7.4 --help。 出现以下内容说明已经可以了。可以直接试下转换。否则看下个标题。<br> <img src="https://images2.imgbox.com/8e/ce/afcFFzcn_o.png" alt="image.png"></p> 
<h5><a id="_No_such_file_or_directory_42"></a>报错 No such file or directory</h5> 
<p><img src="https://images2.imgbox.com/a2/e5/wlP7RKW8_o.png" alt="image.png"><br> 很明显，缺少依赖了。安装一下。</p> 
<pre><code class="prism language-nginx">yum install cairo -y
yum install cups-libs -y
yum install libSM -y
</code></pre> 
<h5><a id="pdf_50"></a>试着转换pdf</h5> 
<p>经过前面的步骤我们已经安装好了LibreOffice，现在试着转换个word为pdf吧。 上传个word到服务器上。然后输入以下命令：</p> 
<pre><code class="prism language-nginx">libreoffice7.4 --headless --invisible --convert-to pdf /opt/xxx.docx --outdir /opt
</code></pre> 
<p>转换成功！</p> 
<h5><a id="PDF_56"></a>解决转换后的PDF中的中文乱码问题</h5> 
<p>一般在windows下安装我们的LibreOffice成功后，转换中文都是正常的，但在linux上基本上都会出现乱码的问题。 因为linux中缺少一些中文字体导致的。这个时候我们需要把windos中的字体文件夹上传到linux上，同步一下字体信息。</p> 
<ol><li>打开windows下C:\Windows\fonts目录</li><li>将fonts目录压缩为zip包，然后上传到服务器上。上传路径为 /usr/share/fonts</li><li>在linux上解压上传的压缩包，因为是zip包，需要unzip命令。 如果没有要安装</li></ol> 
<pre><code class="prism language-nginx">yum -y install unzip
</code></pre> 
<ol start="4"><li>输入fc-list 查看系统的字体，如果报错后，需要下载，下载完成后就可以看了</li></ol> 
<pre><code class="prism language-nginx">yum -y install cups-libs fontconfig
</code></pre> 
<ol start="5"><li>给给解压后产生的文件夹Fonts权限</li></ol> 
<pre><code class="prism language-nginx">chmod -R 755 /usr/share/fonts/Fonts
</code></pre> 
<ol start="6"><li>安装ttmkfdir，然后执行对应命令</li></ol> 
<pre><code class="prism language-nginx">yum -y install ttmkfdir
ttmkfdir -e /usr/share/X11/fonts/encodings/encodings.dir
</code></pre> 
<ol start="7"><li>用vi/vim打开/etc/fonts/fonts.conf，添加我们字体文件的位置</li></ol> 
<pre><code class="prism language-nginx">vim /etc/fonts/fonts.conf
&lt;dir&gt;/usr/share/fonts/Fonts&lt;/dir&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/5c/53/78kRIYHg_o.png" alt="image.png"></p> 
<ol start="8"><li>刷新内存中的字体缓存，输入：fc-cache</li><li>fc-list查看一下linux系统中的字体, 有我们刚刚添加进去的</li><li>再试下转换，发现中文转换成功</li></ol> 
<p><strong><em>注： 关于在springboot中如何集成LibreOffice和转换PDF，我会在下个章节中进行说明。 如果文章对您有所帮助，创作不易，麻烦给个关注呗。谢谢了。</em></strong></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b860c709dd251157b2c4e44bb5902cc4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python中判断字符串数字、标题、大小写等</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4e8220f6218e1600d836ab029afe5cdf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C&#43;&#43;学习笔记（超详细笔记记录ing）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>