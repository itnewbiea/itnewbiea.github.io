<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#操作OPCUA - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#操作OPCUA" />
<meta property="og:description" content="using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using Opc.Ua;
using OpcUaHelper;
namespace ISCS_AutoTest
{
/// &lt;summary&gt;
/// 读写FEP和RETDB中的数据
/// &lt;/summary&gt;
public class OperatorOPCUa
{
public ExpandedNodeId TypeDefinition { get; set; }
private OpcUaClient opcUaClient = new OpcUaClient();
/// &lt;summary&gt;
/// 连接OPC ua Server /// &lt;/summary&gt;
/// &lt;param name=&#34;serverUrl&#34;&gt;服务地址&lt;/param&gt;
public bool ConnectOpcUa(string serverUrl)
{
try
{
if(opcUaClient.Connected == true)
{
return true;
}
else
{" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/86f541e8367fb9c64d7072f467406c3c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-11T13:29:05+08:00" />
<meta property="article:modified_time" content="2022-01-11T13:29:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#操作OPCUA</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>using System;<br> using System.Collections.Generic;<br> using System.Linq;<br> using System.Text;<br> using System.Threading.Tasks;<br> using System.Windows.Forms;<br> using Opc.Ua;<br> using OpcUaHelper;</p> 
<p>namespace ISCS_AutoTest<br> {<!-- --><br>     /// &lt;summary&gt;<br>     /// 读写FEP和RETDB中的数据<br>     /// &lt;/summary&gt;<br>     public class OperatorOPCUa<br>     {<!-- --><br>         public ExpandedNodeId TypeDefinition { get; set; }<br>         private OpcUaClient opcUaClient = new OpcUaClient();</p> 
<p>        /// &lt;summary&gt;<br>         /// 连接OPC ua Server <br>         /// &lt;/summary&gt;<br>         /// &lt;param name="serverUrl"&gt;服务地址&lt;/param&gt;<br>         public bool ConnectOpcUa(string serverUrl)<br>         {<!-- --><br>             try<br>             {<!-- --><br>                 if(opcUaClient.Connected == true)<br>                 {<!-- --><br>                     return true;<br>                 }<br>                 else<br>                 {<!-- --><br>                     opcUaClient.ConnectServer(serverUrl);<br>                     return true;<br>                 }<br>                 <br>             }<br>             catch (Exception ex)<br>             {<!-- --><br>                 // 使用了opc ua的错误处理机制来处理错误，网络不通或是读取拒绝<br>                 Opc.Ua.Client.Controls.ClientUtils.HandleException(serverUrl, ex);<br>                 return false;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 关闭连接OPC ua Server <br>         /// &lt;/summary&gt;<br>         public void CloseOpcUa()<br>         {<!-- --><br>             opcUaClient.Disconnect();<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 读取标签值，如果标签不存在则返回false<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="dbNumber"&gt;OBJ或FEP在server中的数据库编号&lt;/param&gt;<br>         /// &lt;param name="itemLabel"&gt;标签名称&lt;/param&gt;<br>         /// &lt;param name="itemValue"&gt;返回值&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public bool ReadItemValue(string dbNumber,string itemLabel,ref string itemValue)<br>         {<!-- --><br>             try<br>             {<!-- --><br>                 string sendCmd = "ns=" + dbNumber + ";s=" + itemLabel;<br>                 Opc.Ua.DataValue value = opcUaClient.ReadNode(sendCmd);<br>                 itemValue  =  SetDataValueToString(value);<br>                 return true;<br>             }<br>             catch (Exception ex)<br>             {<!-- --><br>                 Common.WriteLog(dbNumber + itemLabel+ ex);<br>                 itemValue = "";<br>                 return false;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 获取点最小周期<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="sendCmd"&gt;点命令信息&lt;/param&gt;<br>         /// &lt;param name="miniTime"&gt;最小时间周期&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public bool GetPropertyMiniTime(string sendCmd,ref int miniTime)<br>         {<!-- --><br>             Common.WriteLog("sendCmd:   " + sendCmd);<br>             OpcNodeAttribute[] nodeAttributes = opcUaClient.ReadNoteAttributes(sendCmd);<br>             foreach (var item in nodeAttributes)<br>             {<!-- --><br>                 Common.WriteLog("item.Name:   " + item.Name+ "item.Value" + item.Value);<br>                 if (item.Name == "MinimumSamplingInterval")<br>                 {<!-- --><br>                     Common.WriteLog("item.Value:   " + item.Value);<br>                     string result = System.Text.RegularExpressions.Regex.Replace(item.Value.ToString(), @"[^0-9]+", "");<br>                     miniTime = int.Parse(result);<br>                     if (result != "")<br>                     {<!-- --><br>                         miniTime = int.Parse(result);<br>                         //当时钟周期未获取到则设置为200毫秒，如果获取到时钟周期则设置其周期+100毫秒<br>                         if (miniTime &lt; 100)<br>                         {<!-- --><br>                             miniTime = 100;<br>                         }<br>                     }<br>                     else<br>                     {<!-- --><br>                         miniTime = 200;<br>                     }<br>                     Common.WriteLog("miniTime" + miniTime);<br>                     return true;<br>                 }<br>             }<br>             return false;<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 获取节点的属性描述信息<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="sendCmd"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public bool GetPropertyDiscription(string sendCmd,ref string discription)<br>         {<!-- --><br>             Common.WriteLog("sendCmd:   " + sendCmd);<br>             OpcNodeAttribute[] nodeAttributes = opcUaClient.ReadNoteAttributes(sendCmd);<br>             int count = 0;<br>             foreach (var item in nodeAttributes)<br>             {<!-- --><br>                 if (item.Name == "Description")<br>                 {<!-- --><br>                     count++;<br>                     discription = item.Value.ToString();<br>                 }<br>             }<br>             return false;<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 读取标签值，如果标签不存在则返回false<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="sendCmd"&gt;读取命令&lt;/param&gt;<br>         /// &lt;param name="itemValue"&gt;返回值&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public bool ReadItemValue(string sendCmd, ref string itemValue)<br>         {<!-- --><br>             Common.WriteLog("sendCmd---------:"+ sendCmd);<br>             try<br>             {<!-- --><br>                 itemValue = SetDataValueToString(opcUaClient.ReadNode(sendCmd));<br>             }<br>             catch<br>             {<!-- --><br>                 return false;<br>             }<br>             return true;<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 读取标签值，如果标签不存在则返回false<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="sendCmd"&gt;读取命令数组&lt;/param&gt;<br>         /// &lt;param name="itemValue"&gt;返回值&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public bool ReadItemValue(string[] sendCmd, ref string itemValue)<br>         {<!-- --><br>             try<br>             {<!-- --><br>                 int valueCount = sendCmd.Count();<br>                 switch(valueCount)//最大为三位<br>                 {<!-- --><br>                     case 1://表示1个FEP点控制1个OBJ点值<br>                         itemValue = SetDataValueToString( opcUaClient.ReadNode(sendCmd[0]));<br>                         break;<br>                     case 2://表示2个FEP点控制1个OBJ点值<br>                         itemValue = (int.Parse(SetDataValueToString(opcUaClient.ReadNode(sendCmd[0])))<br>                             + int.Parse(SetDataValueToString(opcUaClient.ReadNode(sendCmd[1]))) * 2).ToString();<br>                         break;<br>                     case 3://表示3个FEP点控制1个OBJ点值<br>                         itemValue = (int.Parse(SetDataValueToString(opcUaClient.ReadNode(sendCmd[0]))) <br>                             + int.Parse(SetDataValueToString(opcUaClient.ReadNode(sendCmd[1]))) * 2 <br>                             + int.Parse(SetDataValueToString(opcUaClient.ReadNode(sendCmd[2]))) * 4).ToString();<br>                         break;<br>                     default:<br>                         break;<br>                 }<br>                 return true;<br>             }<br>             catch (Exception ex)<br>             {<!-- --><br>                 Common.WriteLog(sendCmd[0] + ex);<br>                 itemValue = "";<br>                 try<br>                 {<!-- --><br>                     int valueCount = sendCmd.Count();<br>                     switch (valueCount)//最大为三位<br>                     {<!-- --><br>                         case 1://表示1个FEP点控制1个OBJ点值<br>                             itemValue = SetDataValueToString(opcUaClient.ReadNode(sendCmd[0].Replace(".In_Channel0","")));<br>                             break;<br>                         case 2://表示2个FEP点控制1个OBJ点值<br>                             itemValue = (int.Parse(SetDataValueToString(opcUaClient.ReadNode(sendCmd[0].Replace(".In_Channel0", ""))))<br>                                 + int.Parse(SetDataValueToString(opcUaClient.ReadNode(sendCmd[1].Replace(".In_Channel1", "")))) * 2).ToString();<br>                             break;<br>                         case 3://表示3个FEP点控制1个OBJ点值<br>                             itemValue = (int.Parse(SetDataValueToString(opcUaClient.ReadNode(sendCmd[0].Replace(".In_Channel0", "")))) <br>                                 + int.Parse(SetDataValueToString(opcUaClient.ReadNode(sendCmd[1].Replace(".In_Channel1", "")))) * 2<br>                                 + int.Parse(SetDataValueToString(opcUaClient.ReadNode(sendCmd[2].Replace(".In_Channel2", "")))) * 4).ToString();<br>                             break;<br>                         default:<br>                             break;<br>                     }<br>                     return true;<br>                 }<br>                 catch<br>                 {<!-- --><br>                     Common.WriteLog(sendCmd[0] + ex);<br>                 }<br>                 return false;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 设置节点下的所有设备为使能状态<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="rootNodeCmd"&gt;节点名称编号命令&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public bool SetAllDeviceEnable(string rootNodeCmd)<br>         {<!-- --><br>             Common.WriteLog("rootNodeCmd"+ rootNodeCmd);<br>             string str = "";<br>             try<br>             {<!-- --><br>                 Opc.Ua.ReferenceDescription[] reference = opcUaClient.BrowseNodeReference(rootNodeCmd);<br>                 foreach (var refer in reference)<br>                 {<!-- --><br>                     CallMethod(refer.NodeId.ToString(), 5, "ns=9;i=232");<br>                     //CallMethod(refer.NodeId.ToString(), 5, "SendCmd");<br>                     str += refer.NodeId.ToString()+"\r\n";<br>                 }<br>                 Common.WriteLog(str);<br>                 return true;<br>             }<br>             catch (Exception ex)<br>             {<!-- --><br>                 Common.WriteLog(rootNodeCmd + ex);<br>                 return false;<br>             }<br>         }<br>         <br>         /// &lt;summary&gt;<br>         /// 设置节点下的所有设备为使能状态<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="rootNodeCmd"&gt;节点名称编号命令&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public Dictionary&lt;string, List&lt;string&gt;&gt; GetAllDeviceInfo(string rootNodeName,string rootID,string DBNumber)<br>         {<!-- --><br>             Dictionary&lt;string, List&lt;string&gt;&gt; itemInfo = new Dictionary&lt;string, List&lt;string&gt;&gt;();<br>             try<br>             {<!-- --><br>                 //获取所有设备名称<br>                 string discriptonCmd = "ns=" + rootID + ";s=" + rootNodeName;<br>                 Common.WriteLog("discriptonCmd  "+ discriptonCmd);<br>                 Opc.Ua.ReferenceDescription[] refeRoot = opcUaClient.BrowseNodeReference(discriptonCmd);<br>                 foreach (var deviceName in refeRoot)<br>                 {<!-- --><br>                     try <br>                     {<!-- --><br>                         //获取所有设备的描述<br>                         string propertyCmd = "ns=" + rootID + ";s=" + deviceName.DisplayName.ToString() + "." + deviceName.DisplayName.ToString();<br>                         Common.WriteLog("propertyCmd    " + propertyCmd);<br>                         Opc.Ua.ReferenceDescription[] refeProperty = opcUaClient.BrowseNodeReference(propertyCmd);<br>                         foreach (var property in refeProperty)<br>                         {<!-- --><br>                             try<br>                             {<!-- --><br>                                 string sttributeCmd = "ns=9002;s=" + property.DisplayName.ToString().Insert(property.DisplayName.ToString().Length - 4, ".");<br>                                 Common.WriteLog("sttributeCmd    " + sttributeCmd);<br>                                 OpcNodeAttribute[] nodeAttributes = opcUaClient.ReadNoteAttributes(sttributeCmd);<br>                                 foreach (var attr in nodeAttributes)<br>                                 {<!-- --><br>                                     if (attr.Name == "Description")<br>                                     {<!-- --><br>                                         Common.WriteLog("设备名     " + deviceName.DisplayName.ToString() + "属性标签     " + property.DisplayName.ToString() + "属性描述     " + attr.Value);<br>                                     }<br>                                 }<br>                             }<br>                             catch<br>                             {<!-- --><br>                                 continue;<br>                             }<br>                         }<br>                     }<br>                     catch<br>                     {<!-- --><br>                         continue;<br>                     }<br>                 }<br>                 return itemInfo;<br>             }<br>             catch (Exception ex)<br>             {<!-- --><br>                 Common.WriteLog(ex.Message);<br>                 return itemInfo;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 设置节点下的所有设备为使能状态<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="rootNodeCmd"&gt;节点名称编号命令&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public Dictionary&lt;string, string&gt; GetAllDeviceNameAndDesp(string rootNodeCmd)<br>         {<!-- --><br>             Dictionary&lt;string, string&gt; nameAndDesp = new Dictionary&lt;string, string&gt;();<br>             try<br>             {<!-- --><br>                 Opc.Ua.ReferenceDescription[] reference = opcUaClient.BrowseNodeReference(rootNodeCmd);<br>                 foreach (var refer in reference)<br>                 {<!-- --><br>                     nameAndDesp.Add(refer.NodeId.ToString(), refer.DisplayName.ToString());<br>                 }<br>                 return nameAndDesp;<br>             }<br>             catch (Exception ex)<br>             {<!-- --><br>                 Common.WriteLog(rootNodeCmd + ex);<br>                 return nameAndDesp;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 调用call函数<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="sendCmd"&gt;调用命令&lt;/param&gt;<br>         /// &lt;param name="nodeNumber"&gt;节点数据&lt;/param&gt;<br>         /// &lt;param name="nodeString"&gt;节点名称&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public bool CallMethod(string sendCmd, object nodeNumber,string nodeString)<br>         {<!-- --><br>             try<br>             {<!-- --><br>                 if(nodeNumber.GetType() == typeof(int))<br>                 {<!-- --><br>                     if ((int)nodeNumber == 5)<br>                     {<!-- --><br>                         opcUaClient.CallMethodByNodeId(sendCmd, nodeString, nodeNumber, "04")[0].ToString();<br>                     }<br>                     else if ((int)nodeNumber == 6)<br>                     {<!-- --><br>                         opcUaClient.CallMethodByNodeId(sendCmd, nodeString, nodeNumber, "0")[0].ToString();<br>                     }<br>                 }<br>                 else if(nodeNumber.GetType() == typeof(bool) || nodeNumber.GetType() == typeof(Boolean))<br>                 {<!-- --><br>                     opcUaClient.CallMethodByNodeId(sendCmd, nodeString, true, nodeNumber);<br>                 }<br>                 else if(nodeNumber.GetType() == typeof(string))<br>                 {<!-- --><br>                     if(nodeNumber.ToString() == "取消强制")<br>                     {<!-- --><br>                         Common.WriteLog("CallMethodByNodeId-----");<br>                         opcUaClient.CallMethodByNodeId(sendCmd, nodeString, false, nodeNumber);<br>                     }<br>                 }<br>                 else<br>                 {<!-- --><br>                     return false;<br>                 }<br>                 return true;<br>             }<br>             catch (Exception ex)<br>             {<!-- --><br>                 Common.WriteLog(sendCmd + ex);<br>                 return false;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 读取设备属性描述<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="dbNumber"&gt;数据库编号&lt;/param&gt;<br>         /// &lt;param name="itemLabel"&gt;标签名称&lt;/param&gt;<br>         /// &lt;param name="itemValue"&gt;返回属性描述&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public bool ReadDiaplayName(string dbNumber, string itemLabel, ref string itemValue)<br>         {<!-- --><br>             try<br>             {<!-- --><br>                 string sendCmd = "ns=" + dbNumber + ";s=" + itemLabel;<br>                 sendCmd = sendCmd.Replace(".PV", ".ValueDesp");<br>                 Opc.Ua.DataValue value = opcUaClient.ReadNode(sendCmd);<br>                 itemValue = SetDataValueToString(value);<br>                 return true;<br>             }<br>             catch (Exception ex)<br>             {<!-- --><br>                 Common.WriteLog(dbNumber + itemLabel + ex);<br>                 itemValue = "";<br>                 return false;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 读取设备属性描述<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="sendCmd"&gt;读取属性描述命令&lt;/param&gt;<br>         /// &lt;param name="itemValue"&gt;返回属性描述&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public bool ReadDiaplayName(string sendCmd, ref string itemValue)<br>         {<!-- --><br>             try<br>             {<!-- --><br>                 Opc.Ua.DataValue value = opcUaClient.ReadNode(sendCmd);<br>                 itemValue = SetDataValueToString(value);<br>                 return true;<br>             }<br>             catch (Exception ex)<br>             {<!-- --><br>                 Common.WriteLog(sendCmd + ex);<br>                 itemValue = "";<br>                 return false;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 写入标签值，如果标签不存在则返回false<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="dbNumber"&gt;OBJ或FEP在server中的数据库编号&lt;/param&gt;<br>         /// &lt;param name="itemLabel"&gt;标签名称&lt;/param&gt;<br>         /// &lt;param name="itemValue"&gt;写入值&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public bool WriteItemValue(string dbNumber, string itemLabel, object itemValue)<br>         {<!-- --><br>             try<br>             {<!-- --><br>                 string sendCmd = "ns=" + dbNumber + ";s=" + itemLabel;<br>                 bool IsSuccess = opcUaClient.WriteNode(sendCmd, itemValue);<br>                 return IsSuccess;<br>             }<br>             catch (Exception ex)<br>             {<!-- --><br>                 Common.WriteLog(dbNumber + itemLabel + ex);<br>                 return false;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 写入标签值，如果标签不存在则返回false<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="sendCmd"&gt;写入值命令&lt;/param&gt;<br>         /// &lt;param name="itemValue"&gt;写入值&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         public bool WriteItemValue(string[] sendCmd, object[] itemValue)<br>         {<!-- --><br>             try<br>             {<!-- --><br>                 bool IsSuccess = opcUaClient.WriteNodes(sendCmd, itemValue);<br>                 return IsSuccess;<br>             }<br>             catch (Exception ex)<br>             {<!-- --><br>                 Common.WriteLog(sendCmd[0] + ex);<br>                 return false;<br>             }<br>         }</p> 
<p>        /// &lt;summary&gt;<br>         /// 将未知类型的值转换为string<br>         /// &lt;/summary&gt;<br>         /// &lt;param name="value"&gt;&lt;/param&gt;<br>         /// &lt;returns&gt;&lt;/returns&gt;<br>         private string SetDataValueToString(Opc.Ua.DataValue value)<br>         {<!-- --><br>             string tempValue = "";<br>             // 一个数据的类型是不是数组由 value.WrappedValue.TypeInfo.ValueRank 来决定的<br>             // -1 说明是一个数值<br>             // 1  说明是一维数组，如果类型BuiltInType是Int32，那么实际是int[]<br>             // 2  说明是二维数组，如果类型BuiltInType是Int32，那么实际是int[,]<br>             if(value == null)<br>             {<!-- --><br>                 return "";<br>             }<br>             switch(value.WrappedValue.TypeInfo.BuiltInType)<br>             {<!-- --><br>                 case Opc.Ua.BuiltInType.Int32:<br>                     {<!-- --><br>                         if (value.WrappedValue.TypeInfo.ValueRank == -1)<br>                         {<!-- --><br>                             int temp = (int)value.WrappedValue.Value;<br>                             tempValue = temp.ToString();<br>                         }<br>                         else if (value.WrappedValue.TypeInfo.ValueRank == 1)<br>                         {<!-- --><br>                             int[] temp = (int[])value.WrappedValue.Value;<br>                             foreach (int singleValue in temp)<br>                             {<!-- --><br>                                 tempValue += singleValue.ToString() + ",";<br>                             }<br>                         }<br>                         else if (value.WrappedValue.TypeInfo.ValueRank == 2)<br>                         {<!-- --><br>                             int[,] temp = (int[,])value.WrappedValue.Value;<br>                             tempValue = temp[0, 0].ToString();<br>                             foreach (int singleValue in temp)<br>                             {<!-- --><br>                                 tempValue += singleValue.ToString() + ",";<br>                             }<br>                         }<br>                     }<br>                     break;<br>                 case Opc.Ua.BuiltInType.Int16:<br>                     {<!-- --><br>                         Int16 temp = (Int16)value.WrappedValue.Value;<br>                         tempValue = temp.ToString();<br>                     }<br>                     break;<br>                 case Opc.Ua.BuiltInType.UInt16:<br>                     {<!-- --><br>                         UInt16 temp = (UInt16)value.WrappedValue.Value;<br>                         tempValue = temp.ToString();<br>                     }<br>                     break;<br>                 case Opc.Ua.BuiltInType.Int64:<br>                     {<!-- --><br>                         Int64 temp = (Int64)value.WrappedValue.Value;<br>                         tempValue = temp.ToString();<br>                     }<br>                     break;<br>                 case Opc.Ua.BuiltInType.UInt64:<br>                     {<!-- --><br>                         UInt64 temp = (UInt64)value.WrappedValue.Value;<br>                         tempValue = temp.ToString();<br>                     }<br>                     break;<br>                 case Opc.Ua.BuiltInType.UInt32:<br>                     {<!-- --><br>                         UInt32 temp = (UInt32)value.WrappedValue.Value;<br>                         tempValue = temp.ToString();<br>                     }<br>                     break;<br>                 case Opc.Ua.BuiltInType.Float:<br>                     {<!-- --><br>                         float temp = (float)value.WrappedValue.Value; <br>                         tempValue = temp.ToString();<br>                     }<br>                     break;<br>                 case Opc.Ua.BuiltInType.String:<br>                     {<!-- --><br>                         string temp = (string)value.WrappedValue.Value; <br>                         tempValue = temp.ToString();<br>                     }<br>                     break;<br>                 case Opc.Ua.BuiltInType.DateTime:<br>                     {<!-- --><br>                         DateTime temp = (DateTime)value.WrappedValue.Value;<br>                         tempValue = temp.ToString();<br>                     }<br>                     break;<br>                 case Opc.Ua.BuiltInType.LocalizedText:<br>                     {<!-- --><br>                         LocalizedText temp = (LocalizedText)value.WrappedValue.Value;<br>                         tempValue = temp.ToString();<br>                     }<br>                     break;<br>                 case Opc.Ua.BuiltInType.Byte:<br>                     {<!-- --><br>                         Byte temp = (Byte)value.WrappedValue.Value;<br>                         tempValue = temp.ToString();<br>                     }<br>                     break;<br>                 case Opc.Ua.BuiltInType.Boolean:<br>                     {<!-- --><br>                         Boolean temp = (Boolean)value.WrappedValue.Value;<br>                         if(temp == true)<br>                         {<!-- --><br>                             tempValue = "1";<br>                         }<br>                         else<br>                         {<!-- --><br>                             tempValue = "0";<br>                         }<br>                     }<br>                     break;<br>                 default:  <br>                     break;<br>             }<br>             return tempValue;<br>         }<br>     }<br> }<br>  </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/078f3bed0956e0d95bed27594cab3557/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">json序列化</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6f4e7a714042755f7c28f803f1ca4376/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">解决报错cannot import name ‘_registerMatType‘ from ‘cv2.cv2‘</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>