<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于FFT &#43; CNN - Transformer 时域、频域特征融合的轴承故障识别模型 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于FFT &#43; CNN - Transformer 时域、频域特征融合的轴承故障识别模型" />
<meta property="og:description" content="目录
往期精彩内容：
前言
1 快速傅里叶变换FFT原理介绍
2 轴承故障数据的预处理
2.1 导入数据
2.2 制作数据集和对应标签
3 基于FFT&#43;CNN-Transformer的轴承故障识别模型
3.1 网络定义模型
3.2 设置参数，训练模型
3.3 模型评估
往期精彩内容： Python-凯斯西储大学（CWRU）轴承数据解读与分类处理_cwru数据集时域图-CSDN博客
Python轴承故障诊断 (一)短时傅里叶变换STFT
Python轴承故障诊断 (二)连续小波变换CWT
Python轴承故障诊断 (三)经验模态分解EMD_轴承诊断 pytorch-CSDN博客
Pytorch-LSTM轴承故障一维信号分类(一)_cwru数据集pytorch训练-CSDN博客
Pytorch-CNN轴承故障一维信号分类(二)-CSDN博客
Pytorch-Transformer轴承故障一维信号分类(三)-CSDN博客
Python轴承故障诊断 (四)基于EMD-CNN的故障分类-CSDN博客
Python轴承故障诊断 (五)基于EMD-LSTM的故障分类-CSDN博客
Python轴承故障诊断 (六)基于EMD-Transformer的故障分类-CSDN博客
Python轴承故障诊断 (七)基于EMD-CNN-LSTM的故障分类-CSDN博客
Python轴承故障诊断 (八)基于EMD-CNN-GRU并行模型的故障分类-CSDN博客
基于FFT &#43; CNN - BiGRU-Attention 时域、频域特征注意力融合的轴承故障识别模型-CSDN博客
前言 本文基于凯斯西储大学（CWRU）轴承数据，进行快速傅里叶变换（FFT）的介绍与数据预处理，最后通过Python实现基于FFT的CNN-Transformer模型对故障数据的分类。凯斯西储大学轴承数据的详细介绍可以参考下文： Python-凯斯西储大学（CWRU）轴承数据解读与分类处理_cwru数据集时域图-CSDN博客
模型整体结构
模型整体结构如下所示，一维故障信号经过FFT变换的频域特征以及信号本身的时域特征分别经过CNN卷积池化操作，提取全局特征，然后再经过Transformer提取时序特征，再进行特征增强融合，最后经过全连接层和softmax输出分类结果。
1 快速傅里叶变换FFT原理介绍 傅里叶变换是一种信号处理和频谱分析的工具，用于将一个信号从时间域转换到频率域。而快速傅里叶变换（FFT）是一种高效实现傅里叶变换的算法，特别适用于离散信号的处理。
第一步，导入部分数据
fromscipy.ioimportloadmat import numpy as np import matplotlib.pyplot as plt import matplotlib matplotlib.rc(&#34;font&#34;, family=&#39;Microsoft YaHei&#39;) # 读取MAT文件 data1 = loadmat(&#39;0_0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e7ca239fe9a0c6476b67e924180a8c40/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-01T20:24:28+08:00" />
<meta property="article:modified_time" content="2024-01-01T20:24:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于FFT &#43; CNN - Transformer 时域、频域特征融合的轴承故障识别模型</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%BE%80%E6%9C%9F%E7%B2%BE%E5%BD%A9%E5%86%85%E5%AE%B9%EF%BC%9A-toc" style="margin-left:0px;"><a href="#%E5%BE%80%E6%9C%9F%E7%B2%BE%E5%BD%A9%E5%86%85%E5%AE%B9%EF%BC%9A" rel="nofollow">往期精彩内容：</a></p> 
<p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">前言</a></p> 
<p id="1%20%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2FFT%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D-toc" style="margin-left:0px;"><a href="#1%20%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2FFT%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D" rel="nofollow">1 快速傅里叶变换FFT原理介绍</a></p> 
<p id="2%C2%A0%E8%BD%B4%E6%89%BF%E6%95%85%E9%9A%9C%E6%95%B0%E6%8D%AE%E7%9A%84%E9%A2%84%E5%A4%84%E7%90%86-toc" style="margin-left:0px;"><a href="#2%C2%A0%E8%BD%B4%E6%89%BF%E6%95%85%E9%9A%9C%E6%95%B0%E6%8D%AE%E7%9A%84%E9%A2%84%E5%A4%84%E7%90%86" rel="nofollow">2 轴承故障数据的预处理</a></p> 
<p id="2.1%20%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE-toc" style="margin-left:0px;"><a href="#2.1%20%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE" rel="nofollow">2.1 导入数据</a></p> 
<p id="2.2%20%E5%88%B6%E4%BD%9C%E6%95%B0%E6%8D%AE%E9%9B%86%E5%92%8C%E5%AF%B9%E5%BA%94%E6%A0%87%E7%AD%BE-toc" style="margin-left:40px;"><a href="#2.2%20%E5%88%B6%E4%BD%9C%E6%95%B0%E6%8D%AE%E9%9B%86%E5%92%8C%E5%AF%B9%E5%BA%94%E6%A0%87%E7%AD%BE" rel="nofollow">2.2 制作数据集和对应标签</a></p> 
<p id="3%20%E5%9F%BA%E4%BA%8EFFT%2BCNN-Transformer%E7%9A%84%E8%BD%B4%E6%89%BF%E6%95%85%E9%9A%9C%E8%AF%86%E5%88%AB%E6%A8%A1%E5%9E%8B-toc" style="margin-left:0px;"><a href="#3%20%E5%9F%BA%E4%BA%8EFFT%2BCNN-Transformer%E7%9A%84%E8%BD%B4%E6%89%BF%E6%95%85%E9%9A%9C%E8%AF%86%E5%88%AB%E6%A8%A1%E5%9E%8B" rel="nofollow">3 基于FFT+CNN-Transformer的轴承故障识别模型</a></p> 
<p id="3.1%20%E7%BD%91%E7%BB%9C%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9E%8B-toc" style="margin-left:40px;"><a href="#3.1%20%E7%BD%91%E7%BB%9C%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9E%8B" rel="nofollow">3.1 网络定义模型</a></p> 
<p id="3.2%20%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0%EF%BC%8C%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B-toc" style="margin-left:40px;"><a href="#3.2%20%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0%EF%BC%8C%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B" rel="nofollow">3.2 设置参数，训练模型</a></p> 
<p id="3.3%20%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0-toc" style="margin-left:40px;"><a href="#3.3%20%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0" rel="nofollow">3.3 模型评估</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h3 id="%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E7%BC%96%E8%BE%91" style="text-align:center;"><img alt="" src="https://images2.imgbox.com/c0/d8/FSEgcdvF_o.png"></h3> 
<h2 id="%E5%BE%80%E6%9C%9F%E7%B2%BE%E5%BD%A9%E5%86%85%E5%AE%B9%EF%BC%9A">往期精彩内容：</h2> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134495407?spm=1001.2014.3001.5502" title="Python-凯斯西储大学（CWRU）轴承数据解读与分类处理_cwru数据集时域图-CSDN博客">Python-凯斯西储大学（CWRU）轴承数据解读与分类处理_cwru数据集时域图-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134744920?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (一)短时傅里叶变换STFT">Python轴承故障诊断 (一)短时傅里叶变换STFT</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134758611?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (二)连续小波变换CWT">Python轴承故障诊断 (二)连续小波变换CWT</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134770900?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (三)经验模态分解EMD_轴承诊断 pytorch-CSDN博客">Python轴承故障诊断 (三)经验模态分解EMD_轴承诊断 pytorch-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134863657?spm=1001.2014.3001.5502" title="Pytorch-LSTM轴承故障一维信号分类(一)_cwru数据集pytorch训练-CSDN博客">Pytorch-LSTM轴承故障一维信号分类(一)_cwru数据集pytorch训练-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134885503?spm=1001.2014.3001.5502" title="Pytorch-CNN轴承故障一维信号分类(二)-CSDN博客">Pytorch-CNN轴承故障一维信号分类(二)-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134894317?spm=1001.2014.3001.5502" title="Pytorch-Transformer轴承故障一维信号分类(三)-CSDN博客">Pytorch-Transformer轴承故障一维信号分类(三)-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134808308?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (四)基于EMD-CNN的故障分类-CSDN博客">Python轴承故障诊断 (四)基于EMD-CNN的故障分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134838832?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (五)基于EMD-LSTM的故障分类-CSDN博客">Python轴承故障诊断 (五)基于EMD-LSTM的故障分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134913585?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (六)基于EMD-Transformer的故障分类-CSDN博客">Python轴承故障诊断 (六)基于EMD-Transformer的故障分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135023821?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (七)基于EMD-CNN-LSTM的故障分类-CSDN博客">Python轴承故障诊断 (七)基于EMD-CNN-LSTM的故障分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135025051?spm=1001.2014.3001.5502" title="Python轴承故障诊断 (八)基于EMD-CNN-GRU并行模型的故障分类-CSDN博客">Python轴承故障诊断 (八)基于EMD-CNN-GRU并行模型的故障分类-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/135251000?spm=1001.2014.3001.5502" title="基于FFT + CNN - BiGRU-Attention 时域、频域特征注意力融合的轴承故障识别模型-CSDN博客">基于FFT + CNN - BiGRU-Attention 时域、频域特征注意力融合的轴承故障识别模型-CSDN博客</a></p> 
<h3></h3> 
<h2 id="%E5%89%8D%E8%A8%80"><strong>前言</strong></h2> 
<p>本文基于凯斯西储大学（CWRU）轴承数据，进行快速傅里叶变换（FFT）的介绍与数据预处理，最后通过Python实现基于FFT的CNN-Transformer模型对故障数据的分类。凯斯西储大学轴承数据的详细介绍可以参考下文： </p> 
<p><a href="https://blog.csdn.net/qq_40949048/article/details/134495407?spm=1001.2014.3001.5502" title="Python-凯斯西储大学（CWRU）轴承数据解读与分类处理_cwru数据集时域图-CSDN博客">Python-凯斯西储大学（CWRU）轴承数据解读与分类处理_cwru数据集时域图-CSDN博客</a></p> 
<p></p> 
<p><strong><strong><strong>模型整体结构</strong></strong></strong></p> 
<p>模型整体结构如下所示，一维故障信号经过FFT变换的频域特征以及信号本身的时域特征分别经过CNN卷积池化操作，提取全局特征，然后再经过Transformer提取时序特征，再进行特征增强融合，最后经过全连接层和softmax输出分类结果。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b3/c2/v7vxCEA1_o.png"></p> 
<h2 id="1%20%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2FFT%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D"><strong><strong><strong>1 快速傅里叶变换FFT原理介绍</strong></strong></strong></h2> 
<p>傅里叶变换是一种信号处理和频谱分析的工具，用于将一个信号从时间域转换到频率域。而快速傅里叶变换（FFT）是一种高效实现傅里叶变换的算法，特别适用于离散信号的处理。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/72/1c/7U8tFp4u_o.png"></p> 
<p>第一步，导入部分数据</p> 
<pre><code class="language-python">fromscipy.ioimportloadmat
import numpy as np
import matplotlib.pyplot as plt
import matplotlib
matplotlib.rc("font", family='Microsoft YaHei')

# 读取MAT文件   
data1 = loadmat('0_0.mat')  # 正常信号
data2 = loadmat('21_1.mat') # 0.021英寸 内圈
data3 = loadmat('21_2.mat') # 0.021英寸 滚珠
data4 = loadmat('21_3.mat') # 0.021英寸 外圈
# 注意，读取出来的data是字典格式，可以通过函数type(data)查看。</code></pre> 
<p>第二步，故障信号可视化</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/2f/17/Oqx8qqDN_o.png"></p> 
<p>第三步，故障信号经过FFT可视化</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/36/43/0M7YN9QK_o.png"></p> 
<h2 id="2%C2%A0%E8%BD%B4%E6%89%BF%E6%95%85%E9%9A%9C%E6%95%B0%E6%8D%AE%E7%9A%84%E9%A2%84%E5%A4%84%E7%90%86"><strong><strong><strong>2 轴承故障数据的预处理</strong></strong></strong></h2> 
<h2 id="2.1%20%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE">2.1 导入数据</h2> 
<p>参考之前的文章，进行故障10分类的预处理，凯斯西储大学轴承数据10分类数据集：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/44/36/Kph4bPwG_o.png"></p> 
<p>train_set、val_set、test_set 均为按照7：2：1划分训练集、验证集、测试集，最后保存数据</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/0a/52/SIDKUiyg_o.png"></p> 
<p>上图是数据的读取形式以及预处理思路</p> 
<p></p> 
<h3 id="2.2%20%E5%88%B6%E4%BD%9C%E6%95%B0%E6%8D%AE%E9%9B%86%E5%92%8C%E5%AF%B9%E5%BA%94%E6%A0%87%E7%AD%BE">2.2 制作数据集和对应标签</h3> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/4b/bb/mXz1scqW_o.png"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ad/bb/ZTfrcHwb_o.png"></p> 
<p></p> 
<h2 id="3%20%E5%9F%BA%E4%BA%8EFFT%2BCNN-Transformer%E7%9A%84%E8%BD%B4%E6%89%BF%E6%95%85%E9%9A%9C%E8%AF%86%E5%88%AB%E6%A8%A1%E5%9E%8B"><strong><strong><strong>3 基于FFT+CNN-Transformer的轴承故障识别模型</strong></strong></strong></h2> 
<h3 id="3.1%20%E7%BD%91%E7%BB%9C%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9E%8B">3.1 网络定义模型</h3> 
<p><img alt="" src="https://images2.imgbox.com/d3/3b/lGlwGtYH_o.png"></p> 
<p>注意：输入故障信号数据形状为 [32, 1024]， batch_size=32,  ，1024代表序列长度。</p> 
<h3></h3> 
<h3 id="3.2%20%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0%EF%BC%8C%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B">3.2 设置参数，训练模型</h3> 
<p><img alt="" src="https://images2.imgbox.com/e7/4f/a759yGE1_o.png"></p> 
<p>50个epoch，准确率100%，用FFT+CNN-Transformer融合网络模型分类效果显著，模型能够充分提取轴承故障信号的空间和时序特征和频域特征，收敛速度快，性能优越，精度高。</p> 
<p></p> 
<h3 id="3.3%20%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0">3.3 模型评估</h3> 
<p>准确率、精确率、召回率、F1 Score</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/8f/c3/B6eQgrsP_o.png"></p> 
<p>故障十分类混淆矩阵：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/9e/0b/UQO4QWEv_o.png"></p> 
<p>代码、数据如下：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/dd/c2/VEoEkN6r_o.png"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6cd7d415635ebec80aa9f114cb645d5a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">机器学习一些概念</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1af04fbed20eac36e7066973820784f7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">2024年Mac专用投屏工具AirServer 7 .27 for Mac中文版</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>