<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Unity中不用自带重力实现跳跃的方法 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Unity中不用自带重力实现跳跃的方法" />
<meta property="og:description" content="代码分为三部分：
Update()中的输入判定代码LateUpdate()中的跳跃实现部分OnCollisionEnter()与OnCollisionExit()的落地&amp;离地检测部分 当玩家按下跳跃键时进入跳跃状态并判断当前的水平速度
//跳跃判定 if (Input.GetButtonDown(&#34;Jump&#34;) &amp;&amp;nextJump) //不能在落地前跳跃 if (currentBaseState.fullPathHash == walkingState|| currentBaseState.fullPathHash == runningState|| currentBaseState.fullPathHash == standingState)//不能在动画完成前跳跃 { nextJump = false;//落地前无法再次起跳 GameManager.isJumping = true;//进入跳跃状态 if (GameManager.isStanding) { jumpV_x = 0;//处于站立状态时水平初速度为0 GameManager.isStanding = false;//改变当前状态由站立到跳跃，下同 } if (GameManager.isWalking) { jumpV_x = Haxis * moveSpeed; GameManager.isWalking = false; } if (GameManager.isRunning) //加速跳跃 { jumpV_x = Haxis * moveSpeed; jumpVelocity = GameManager.jumpVelocity * GameManager.jumpMultiple;//加速跳跃时竖向分速度也提高 GameManager.isRunning = false; } } 当跳跃状态==true时每帧移动相应的竖向，水平距离
private void LateUpdate() { transform." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/43c602aac3bd093033605d7c3db66828/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-03-29T12:58:04+08:00" />
<meta property="article:modified_time" content="2017-03-29T12:58:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Unity中不用自带重力实现跳跃的方法</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>代码分为三部分：</p> 
<ol><li>Update()中的输入判定代码</li><li>LateUpdate()中的跳跃实现部分</li><li>OnCollisionEnter()与OnCollisionExit()的落地&amp;离地检测部分</li></ol> 
<p>当玩家按下跳跃键时进入跳跃状态并判断当前的水平速度</p> 
<pre class="prettyprint"><code class=" hljs cs">        <span class="hljs-comment">//跳跃判定</span>
        <span class="hljs-keyword">if</span> (Input.GetButtonDown(<span class="hljs-string">"Jump"</span>) &amp;&amp;nextJump)            <span class="hljs-comment">//不能在落地前跳跃</span>
            <span class="hljs-keyword">if</span> (currentBaseState.fullPathHash == walkingState|| 
                currentBaseState.fullPathHash == runningState||
                currentBaseState.fullPathHash == standingState)<span class="hljs-comment">//不能在动画完成前跳跃</span>
            {
                nextJump = <span class="hljs-keyword">false</span>;<span class="hljs-comment">//落地前无法再次起跳</span>
                GameManager.isJumping = <span class="hljs-keyword">true</span>;<span class="hljs-comment">//进入跳跃状态</span>
                <span class="hljs-keyword">if</span> (GameManager.isStanding)
                {
                    jumpV_x = <span class="hljs-number">0</span>;<span class="hljs-comment">//处于站立状态时水平初速度为0</span>
                    GameManager.isStanding = <span class="hljs-keyword">false</span>;<span class="hljs-comment">//改变当前状态由站立到跳跃，下同</span>
                }
                <span class="hljs-keyword">if</span> (GameManager.isWalking)
                {
                    jumpV_x = Haxis * moveSpeed;
                    GameManager.isWalking = <span class="hljs-keyword">false</span>;
                }
                <span class="hljs-keyword">if</span> (GameManager.isRunning)                <span class="hljs-comment">//加速跳跃</span>
                {
                    jumpV_x = Haxis * moveSpeed;
                    jumpVelocity = GameManager.jumpVelocity * GameManager.jumpMultiple;<span class="hljs-comment">//加速跳跃时竖向分速度也提高</span>
                    GameManager.isRunning = <span class="hljs-keyword">false</span>;
                }
            }</code></pre> 
<p>当跳跃状态==true时每帧移动相应的竖向，水平距离</p> 
<pre class="prettyprint"><code class=" hljs avrasm">    private void LateUpdate()
    {
        transform<span class="hljs-preprocessor">.Translate</span>(Vector3<span class="hljs-preprocessor">.right</span> * Time<span class="hljs-preprocessor">.deltaTime</span> * moveSpeed * Haxis)<span class="hljs-comment">; //角色移动实现</span>
        if (GameManager<span class="hljs-preprocessor">.isJumping</span>)                   //跳跃实现
        {

            jumpHight += jumpVelocity * Time<span class="hljs-preprocessor">.deltaTime</span> * jumpSpeed<span class="hljs-comment">;</span>
            jumpVelocity = jumpVelocity - <span class="hljs-number">9.8</span>f * Time<span class="hljs-preprocessor">.deltaTime</span> * jumpSpeed<span class="hljs-comment">;</span>
            currentPosition<span class="hljs-preprocessor">.y</span> = jumpHight<span class="hljs-comment">;</span>
            currentPosition<span class="hljs-preprocessor">.x</span> = privousPosition<span class="hljs-preprocessor">.x</span> + Time<span class="hljs-preprocessor">.deltaTime</span> * jumpV_x<span class="hljs-comment">; //空中水平移动实现</span>
            transform<span class="hljs-preprocessor">.position</span> = currentPosition<span class="hljs-comment">;</span>

        }</code></pre> 
<p>落地以后退出跳跃状态，允许进行下次跳跃，并将跳跃速度的全局变量回归初始值以便下次跳跃</p> 
<pre class="prettyprint"><code class=" hljs lasso">    <span class="hljs-literal">void</span> OnCollisionEnter(Collision collider)
    {
        <span class="hljs-comment">//落地检测</span>
        <span class="hljs-keyword">if</span> (collider<span class="hljs-built_in">.</span>gameObject<span class="hljs-built_in">.</span><span class="hljs-built_in">tag</span> <span class="hljs-subst">==</span> <span class="hljs-string">"Ground"</span>)
        {
            nextJump <span class="hljs-subst">=</span> <span class="hljs-literal">true</span>;
            GameManager<span class="hljs-built_in">.</span>isGround <span class="hljs-subst">=</span> <span class="hljs-literal">true</span>;
            GameManager<span class="hljs-built_in">.</span>isJumping <span class="hljs-subst">=</span> <span class="hljs-literal">false</span>;

            <span class="hljs-comment">//落地还原速度</span>
            moveSpeed <span class="hljs-subst">=</span> GameManager<span class="hljs-built_in">.</span>moveSpeed;           
            jumpVelocity <span class="hljs-subst">=</span> GameManager<span class="hljs-built_in">.</span>jumpVelocity;
            jumpHight <span class="hljs-subst">=</span> <span class="hljs-number">0</span>;
            jumpV_x <span class="hljs-subst">=</span> <span class="hljs-number">0</span>;

            Debug<span class="hljs-built_in">.</span><span class="hljs-keyword">Log</span>(<span class="hljs-string">"ground!"</span>);
        }
    }
    <span class="hljs-literal">void</span> OnCollisionExit(Collision collider)
    {
        <span class="hljs-comment">//离地检测</span>
        <span class="hljs-keyword">if</span> (collider<span class="hljs-built_in">.</span>gameObject<span class="hljs-built_in">.</span><span class="hljs-built_in">tag</span> <span class="hljs-subst">==</span> <span class="hljs-string">"Ground"</span>)
            GameManager<span class="hljs-built_in">.</span>isGround <span class="hljs-subst">=</span> <span class="hljs-literal">false</span>;
        Debug<span class="hljs-built_in">.</span><span class="hljs-keyword">Log</span>(<span class="hljs-string">"offground!"</span>);
    }</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/71f7b091c50eb0a534b600b4bfdf26e9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【解决】CentOS7 安装 jkd1.8 报错-bash: /usr/local/jdk1.8.0_121/bin/java: /lib/ld-linux.so.2: bad ELF interpr</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d98f086cd0eb375e59db9f7327158759/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">OpenCV入门十：静态图片人脸检测和摄像头人脸检测</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>