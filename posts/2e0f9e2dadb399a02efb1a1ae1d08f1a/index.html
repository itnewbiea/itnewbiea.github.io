<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Uniapp小程序通过camera组件实现视频拍摄 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Uniapp小程序通过camera组件实现视频拍摄" />
<meta property="og:description" content="uni中可以通过调用api的方式去拍摄或者是选择相册的视频，但是在这里我们不采取这种方式，因为调用api的方式，必须跳转，而我们需要在页面中实现，下面看下具体步骤吧...
&lt;camera v-if=&#34;!srcUrl &amp;&amp; showCamera&#34; device-position=&#34;back&#34; flash=&#34;auto&#34; binderror=&#34;onCameraError&#34; style=&#34;width: 100%; height: 400rpx;&#34;&gt;&lt;/camera&gt; &lt;video v-if=&#34;srcUrl&#34; id=&#34;myVideo&#34; :src=&#34;srcUrl&#34; controls&gt;&lt;/video&gt; &lt;view @click=&#34;startShoot&#34;&gt; 开始 &lt;/view&gt; &lt;view&gt; ------------------------------------------ ------------------------------------------ &lt;/view&gt; &lt;view @click=&#34;stopShoot&#34;&gt; 结束 &lt;/view&gt; data() { return { cameraContext: null, showCamera: false, srcUrl: null, timer: null, totalSeconds: 0 }; } 接下来看下，怎么样实现拍摄
onReady() { this.cameraContext = uni.createCameraContext() } methods: { // 开始拍摄 startShoot() { this.totalSeconds = 0 this.showCamera = true this.cameraContext.startRecord({ timeoutCallback: () =&gt; { console." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/2e0f9e2dadb399a02efb1a1ae1d08f1a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-15T16:13:03+08:00" />
<meta property="article:modified_time" content="2023-12-15T16:13:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Uniapp小程序通过camera组件实现视频拍摄</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p>uni中可以通过调用api的方式去拍摄或者是选择相册的视频，但是在这里我们不采取这种方式，因为调用api的方式，必须跳转，而我们需要在页面中实现，下面看下具体步骤吧...</p> 
</blockquote> 
<pre><code class="language-javascript">&lt;camera v-if="!srcUrl &amp;&amp; showCamera" device-position="back" flash="auto" binderror="onCameraError" style="width: 100%; height: 400rpx;"&gt;&lt;/camera&gt;
&lt;video v-if="srcUrl" id="myVideo" :src="srcUrl" controls&gt;&lt;/video&gt;
&lt;view @click="startShoot"&gt;
	开始
&lt;/view&gt;
&lt;view&gt;
	------------------------------------------
	------------------------------------------
&lt;/view&gt;
&lt;view @click="stopShoot"&gt;
	结束
&lt;/view&gt;


data() {
	return {
		cameraContext: null,
		showCamera: false,
		srcUrl: null,
		timer: null,
		totalSeconds: 0
	};
}
</code></pre> 
<p> 接下来看下，怎么样实现拍摄</p> 
<pre><code class="language-javascript">onReady() {
	this.cameraContext = uni.createCameraContext()
}

methods: {
	// 开始拍摄
	startShoot() {
		this.totalSeconds = 0
		this.showCamera = true
		this.cameraContext.startRecord({
		timeoutCallback: () =&gt; {
			console.log(this.totalSeconds,'超出限制时长');
		},
		timeout: 300,
		success: (res) =&gt; {
			this.timer = setInterval(() =&gt; {
				this.totalSeconds++
			}, 1000)
		    console.log(res, '开始拍摄');
		},
		fail: (err) =&gt; {
				this.showCamera = false
				uni.showToast({
				title: '录制视频失败',
				icon: 'none',
				mask: true
			    })
		    }
		})
	},

    // 结束拍摄
    stopShoot() {
		if(this.timer) clearInterval(this.timer)
		    this.cameraContext.stopRecord({
			compressed: true,
			success: (res) =&gt; {
				this.srcUrl = res.tempVideoPath
				// TODO 获取数据帧
				console.log(res, '结束拍摄');
			},
			fail: (err) =&gt; {
				uni.showToast({
				title: '录制视频失败',
				icon: 'none',
				mask: true
				})
				console.log(err, '录制视频失败');
			},
			complete: () =&gt; {
				this.showCamera = false
			}
		  })
	  },
}</code></pre> 
<p>到这里已经基本实现了所需的功能，但是还需要处理一下拍摄超时的情况</p> 
<pre><code class="language-javascript">watch: {
	totalSeconds: {
		handler(newVal){
			if(newVal &gt;= 270) {
				console.log(newVal, 'newVal');
				this.stopShoot()
			}
		}
	}
}</code></pre> 
<p>感觉对你有帮助的小伙伴可以留个star...</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/10e6555c133e9b4e3260c4328d1e4c48/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux入门攻坚——8、磁盘管理——btrfs文件系统及压缩解压缩和归档</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4917c3c65085e4bfb410a6dd157ccd0b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">springboot&#43;vue项目在国产机东方通部署详细教程！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>