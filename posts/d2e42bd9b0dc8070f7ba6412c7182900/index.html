<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>STM32开发环境（工具）之Keil MDK 介绍 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="STM32开发环境（工具）之Keil MDK 介绍" />
<meta property="og:description" content="STM32微处理器基于ARM核，所以很多基于ARM嵌入式开发环境都可用于STM32开发平台。开发工具都可用于STM32开发。选择合适的开发环境可以加快开发进度，节省开发成本。本章将先对STM32常用的开发工具Keil MDK和IAR EWARM进行简单介绍，然后结合STM32_SK仿真评估板和STM32F103C的开发板讲解STM32片上资源使用，最后给出一个基于STM32的数据采集器的应用实例。
5.1 Keil MDK介绍
Keil是德国知名软件公司Keil（现已并入ARM 公司）开发的微控制器软件开发平台，是目前ARM内核单片机开发的主流工具。Keil提供了包括C编译器、宏汇编、连接器、库管理和一个功能强大的仿真调试器在内的完整开发方案，通过一个集成开发环境（uVision）将这些功能组合在一起。uVision当前最高版本是uVision3,它的界面和常用的微软VC&#43;&#43;的界面相似，界面友好，易学易用，在调试程序，软件仿真方面也有很强大的功能。因此很多开发ARM应用的工程师，都对它十分喜欢。
5.1.1 开发过程及集成开发环境简介
1. Keil的软件开发周期
使用Keil来开发嵌入式软件，开发周期和其他的平台软件开发周期是差不多的，大致有以下几个步骤：
1. 创建一个工程，选择一块目标芯片，并且做一些必要的工程配置。
2. 编写C或者汇编源文件。
3. 编译应用程序。
4. 修改源程序中的错误。
5. 联机调试。
下面这种结构图完整描述了Keil开发软件的整个过程。
2. uVision3 集成开发环境
uVision3 IDE是一款集编辑，编译和项目管理于一身的基于窗口的软件开发环境。uVision3集成了C语言编译器，宏编译，链接/定位，以及HEX文件产生器。uVision3具有如下特性：
功能齐全的源代码编辑器，
用于配置开发工具的设备库，
用于创建工程和维护工程的项目管理器，
所有的工具配置都采用对话框进行，
集成了源码级的仿真调试器，包括高速CPU和外设模拟器，
用于往Flash ROM下载应用程序的Flash编程工具，
完备的开发工具帮助文档，设备数据表和用户使用向导。
uVision3具有良好的界面风格，下图是一个典型的调试时的窗口。
工程区：用于访问文件组和文件，调试是可以查看CPU寄存器。
输出窗口：显示编译结果，以便快速查找错误的地方，同时还是调试命令输入输出窗口，也可以用于显示查找结果。
内存窗口：显示指定地址内村里的内容。
查看和调用栈窗口：用于查看和修改变量的值，并且现实当前函数调用树。
代码窗口：用于查看和编辑源文件。
外设对话框：检查微控制的片上外设的状态。
3. ULINK USB-JTAG接口适配器
ULINK USB-JTAG是一个用于连接PC USB口和开发板JTAG口的小硬件适配器。通过ULINK你可以在真实的目标板上创建，下载和测试嵌入式应用。ULINK支持如下操作：
下载目标程序。
检查内存和寄存器。
单步运行程序。
插入多个断点。
实时运行程序
烧写FLASH存储器
5.1.2 工程管理
在项目开发中，并不是仅有一个源程序就行了，还要为这个项目选择CPU（Keil支持数百种CPU，而这些CPU的特性并不完全相同），确定编译、汇编、连接的参数，指定调试的方式，有一些项目还会有多个文件组成等，为管理和使用方便，Keil使用工程（Project）这一概念，将这些参数设置和所需的所有文件都加到一个工程中，只对工程而不是对单一的源程序进行编译（汇编）和连接等操作。下面我们就以一个简单的例子HelloWorld来讲解如何建立工程和配置工程。在这个例子里，我们将实现开发板上的LED1闪烁，本例使用STM32F103C开发板为目标板。
5.1.2.1 新建工程
点击菜单“Project”，选择“New uVision Project”，这是将会出现一个对话框，要求给将要建立的工程起一个名字。
选择你要保存的路径，输入工程文件的名字，这里我们就叫HelloWorld，uVision3工程文件的后缀为“.uv2”,然后点击“Save”。 这时会弹出一个对话框要求你选择目标设备的型号。
你可以根据你使用的处理器来选择，如果您所使用的处理器型号在列表中找不到，也可以找一款与您使用的相兼容的型号来代替。这里我们选择STM32F103C8，如图所示，右边一栏是对这个芯片的基本的说明，然后点击“OK”。
有些芯片会提供启动代码，我们这个时候点击“Yes”，到此一个工程就建立好了。
5.1.2.2 配置工程" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/d2e42bd9b0dc8070f7ba6412c7182900/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2010-10-30T00:22:00+08:00" />
<meta property="article:modified_time" content="2010-10-30T00:22:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">STM32开发环境（工具）之Keil MDK 介绍</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p> </p> 
<p>STM32微处理器基于ARM核，所以很多基于ARM嵌入式开发环境都可用于STM32开发平台。开发工具都可用于STM32开发。选择合适的开发环境可以加快开发进度，节省开发成本。本章将先对STM32常用的开发工具Keil MDK和IAR EWARM进行简单介绍，然后结合STM32_SK仿真评估板和STM32F103C的开发板讲解STM32片上资源使用，最后给出一个基于STM32的数据采集器的应用实例。<br><br><strong>5.1 Keil MDK介绍</strong><br>Keil是德国知名软件公司Keil（现已并入ARM 公司）开发的微控制器软件开发平台，是目前ARM内核单片机开发的主流工具。Keil提供了包括C编译器、宏汇编、连接器、库管理和一个功能强大的仿真调试器在内的完整开发方案，通过一个集成开发环境（uVision）将这些功能组合在一起。uVision当前最高版本是uVision3,它的界面和常用的微软VC++的界面相似，界面友好，易学易用，在调试程序，软件仿真方面也有很强大的功能。因此很多开发ARM应用的工程师，都对它十分喜欢。<br><br><strong>5.1.1 开发过程及集成开发环境简介</strong><br><strong>1. Keil的软件开发周期</strong><br>使用Keil来开发嵌入式软件，开发周期和其他的平台软件开发周期是差不多的，大致有以下几个步骤：<br>1. 创建一个工程，选择一块目标芯片，并且做一些必要的工程配置。<br>2. 编写C或者汇编源文件。<br>3. 编译应用程序。<br>4. 修改源程序中的错误。<br>5. 联机调试。<br>下面这种结构图完整描述了Keil开发软件的整个过程。</p> 
<div> 
 <img src="https://images2.imgbox.com/27/74/VWMYHWnu_o.jpg" alt="" width="365" height="423"> 
 <br>  
</div> 
<p><strong>2. uVision3 集成开发环境</strong><br>uVision3 IDE是一款集编辑，编译和项目管理于一身的基于窗口的软件开发环境。uVision3集成了C语言编译器，宏编译，链接/定位，以及HEX文件产生器。uVision3具有如下特性：<br>　　功能齐全的源代码编辑器，<br>　　用于配置开发工具的设备库，<br>　　用于创建工程和维护工程的项目管理器，<br>　　所有的工具配置都采用对话框进行，<br>　　集成了源码级的仿真调试器，包括高速CPU和外设模拟器，<br>　　用于往Flash ROM下载应用程序的Flash编程工具，<br>　　完备的开发工具帮助文档，设备数据表和用户使用向导。<br>uVision3具有良好的界面风格，下图是一个典型的调试时的窗口。</p> 
<div> 
 <img src="https://images2.imgbox.com/e3/b1/fxpwj8JC_o.jpg" alt="" width="528" height="371"> 
 <br>  
</div> 
<p>　　工程区：用于访问文件组和文件，调试是可以查看CPU寄存器。<br>　　输出窗口：显示编译结果，以便快速查找错误的地方，同时还是调试命令输入输出窗口，也可以用于显示查找结果。<br>　　内存窗口：显示指定地址内村里的内容。<br>　　查看和调用栈窗口：用于查看和修改变量的值，并且现实当前函数调用树。<br>　　代码窗口：用于查看和编辑源文件。<br>　　外设对话框：检查微控制的片上外设的状态。<br><br><strong>3. ULINK USB-JTAG接口适配器</strong><br>ULINK USB-JTAG是一个用于连接PC USB口和开发板JTAG口的小硬件适配器。通过ULINK你可以在真实的目标板上创建，下载和测试嵌入式应用。ULINK支持如下操作：<br>　　下载目标程序。<br>　　检查内存和寄存器。<br>　　单步运行程序。<br>　　插入多个断点。<br>　　实时运行程序<br>　　烧写FLASH存储器</p> 
<div> 
 <img src="https://images2.imgbox.com/86/38/sUnS9jTi_o.jpg" alt="" width="421" height="299"> 
 <br>  
</div> 
<p><strong>5.1.2 工程管理</strong><br>在项目开发中，并不是仅有一个源程序就行了，还要为这个项目选择CPU（Keil支持数百种CPU，而这些CPU的特性并不完全相同），确定编译、汇编、连接的参数，指定调试的方式，有一些项目还会有多个文件组成等，为管理和使用方便，Keil使用工程（Project）这一概念，将这些参数设置和所需的所有文件都加到一个工程中，只对工程而不是对单一的源程序进行编译（汇编）和连接等操作。下面我们就以一个简单的例子HelloWorld来讲解如何建立工程和配置工程。在这个例子里，我们将实现开发板上的LED1闪烁，本例使用STM32F103C开发板为目标板。<br><br><strong>5.1.2.1 新建工程</strong><br>点击菜单“Project”，选择“New uVision Project”，这是将会出现一个对话框，要求给将要建立的工程起一个名字。<br>选择你要保存的路径，输入工程文件的名字，这里我们就叫HelloWorld，uVision3工程文件的后缀为“.uv2”,然后点击“Save”。 这时会弹出一个对话框要求你选择目标设备的型号。</p> 
<div> 
 <img src="https://images2.imgbox.com/06/d6/r7QwXx2F_o.jpg" alt="" width="481" height="279"> 
 <br>  
</div> 
<p>你可以根据你使用的处理器来选择，如果您所使用的处理器型号在列表中找不到，也可以找一款与您使用的相兼容的型号来代替。这里我们选择STM32F103C8，如图所示，右边一栏是对这个芯片的基本的说明，然后点击“OK”。</p> 
<div> 
 <img src="https://images2.imgbox.com/eb/96/zZFvt4Ux_o.jpg" alt="" width="362" height="141"> 
 <br>  
</div> 
<p>有些芯片会提供启动代码，我们这个时候点击“Yes”，到此一个工程就建立好了。<br><br><strong>5.1.2.2 配置工程</strong><br>工程建立好了之后，还要对工程进行进一步的设置，以满足要求。<br>首先用鼠标右键(注意用右键)点击左边工程窗口的“Target 1”，会出现一个菜单，选择“Options for Target 'Target 1'”（也可以通过点击工程窗口的Target 1”，然后使用菜单“Project”-&gt;“Options for Target 'Target 1'”），即出现工程配置的对话框，如下图所示：</p> 
<div> 
 <img src="https://images2.imgbox.com/64/a2/nke57cB3_o.jpg" alt="" width="467" height="194"> 
 <br>  
</div> 
<p>这个对话框很复杂，而且根所选择的芯片有关，这里共有10个页面，绝大多数选择默认配置即可，下面将对一些需要注意的配置简单介绍一下。<br><strong>1. Output标签页的设置</strong></p> 
<div> 
 <img src="https://images2.imgbox.com/f8/58/N3VfuySE_o.jpg" alt="" width="484" height="368"> 
 <br>  
</div> 
<p>Select Folder for Objects：选择编译之后的目标文件存储在哪个目录里，默认位置为工程文件的目录里。<br>Name of Executable：生成的目标文件的名字，缺省是工程的名字。<br>Create Executable：生成OMF以及HEX文件。OMF文件名同工程文件名但没有带扩展名。<br>Debug Information：用于Debug版本，生成调试信息，否则的话无法进行单步调试。<br>Create Batch File：生成用于实现整个编译过程的批处理文件，使用这个文件可以脱离IDE对省程序进行编译。<br>Create Hex File：这个选项默认情况下未被选中，如果要写片做硬件实验就必须选中该项。这一点是初学者易疏忽的，在此特别提醒注意一定要要选中，否则编译之不生成Hex文件。<br>Big Endian：编码格式，与CPU相关，如果CPU采用的是Big Endian编码则勾选上。<br>Browse Information：产生用于在源文件快速定位的信息。<br>Create Library：生成lib库文件，默认不选。<br>在我们刚刚新建的HelloWorld工程中，更改了三个地方，在工程目录下新建了一个Output目录保存目标文件，以避免和源文件混在一起。另外选中了Create Hex File和Browse Information，如上图所示。<br><strong>2. C/C++标签页的设置</strong></p> 
<div> 
 <img src="https://images2.imgbox.com/3c/92/50xKCrpj_o.jpg" alt="" width="484" height="372"> 
 <br>  
</div> 
<p>Include Paths：指定头文件的查找路径，可以添加多个。<br>这里我们所有的选择保持默认选择就可以了。<br><strong>3. Debug标签页的设置</strong></p> 
<div> 
 <img src="https://images2.imgbox.com/6d/b4/NqCRUjMt_o.jpg" alt="" width="478" height="369"> 
 <br>  
</div> 
<p>左边是对应uVision3的模拟环境，右边是针对仿真器，这里选择右边的ULINK Cortex Debugger仿真器为例进行说明。<br>如果已经将ULINK仿真器连接到你的电脑，点击“Settings”你将进入ARM Target Driver Setup 界面。</p> 
<div> 
 <img src="https://images2.imgbox.com/6a/32/YOJvh7Pm_o.jpg" alt="" width="462" height="249"> 
 <br>  
</div> 
<p>ULINK - JTAG/SWD Adapter：<br>Serial No：列出了当前连接到主机的所有ULINK适配器的串号，你可以通过列表选择要使用的ULINK适配器。<br>ULINK Version，Device Family以及Firmware Version分别列出了当前选择的ULINK适配器的版本，设备家族和固件版本。<br>SWJ，Port：根据和开发板接口的类型选择端口，有JTAG和SW两种，勾选SWJ表示支持两种方式。<br>Max　Clock：指定和开发板的最高通信时钟。<br>JTAG Device Chain：显示当前通过适配器连接上的开发板。<br>Automatic Detection：自动监测，选择系统将自动检测连接上的开发板，建议使用。<br>Manual Configuration：手动配置，通过手动设置ID CODE，Device Name和IR len等属性来查找设备。<br>Debug：<br>Cache Options：<br>　　Cache Code：通知调试器已经下载的程序代码不会改变，选中的话uVision将不会从目标系统读取程序代码。<br>　　Cache Memory：决定调试程序期间程序停止运行的时候，是否更新存储器显示。<br>Download Options：<br>　　Verify Code Download：比较目标存储器和调试器上的应用程序的内容。<br>　　Download to Flash：将代码下载到所有的存储器区域，如果不选中，调试器不会把代码下载到Flash Download Setup中制定的存储器地址范围。<br>Misc Options：<br>　　Use Reset at Startup：选中的时候，调试器在开始调试的时候会发起一次CPU复位。　<br>Load Application at Startup：将Output标签中指定的可执行文件导入到调试器的起始地址。<br>Run to Main：开始调试时执行到Main函数入口暂停执行。<br>Initialization File：指定一个包含一组调试命令的文件，这组命令是调试器开始工作或者调试函数在调试期间要使用的。<br>Restore Debug Session Settings：使用上一次调试过程对Breakpoints，Watchpoints，Memory Display和Toolbox（如果这些项被选中的话）。<br>Driver DLL – Parameter：由Device Database设置的目标驱动DLL，不要修改。<br>Dialog DLL – Parameter：由Device Database设置的对话框DLL，不要修改。<br>这里我们修改了两个地方，选中了Use ULINK和Run to Main，对ULINK的设置进行了一些调整，具体的设置图5.11所示。<br><strong>4. Utilities标签页的设置</strong></p> 
<div> 
 <img src="https://images2.imgbox.com/3c/75/ax8H0r21_o.jpg" alt=""> 
 <br>  
</div> 
<p>Configure Flash Menu Command<br>　　Use Target Driver for Flash Programming：列表选择和调试接口一致的驱动。Init File的设置也和前面调试设置一致。点击Settings将进入Flash Download Setup界面。</p> 
<div> 
 <img src="https://images2.imgbox.com/f6/b5/qcUP0ka5_o.jpg" alt="" width="483" height="306"> 
 <br>  
</div> 
<p>Download Function：定义了Flash烧写的时候进行的操作。<br>　　Erase Full Chip：前面三项要选一，烧写程序之前擦除整个Flash存储器。<br>　　Erase Sectors：烧写程序之前擦除程序要使用的扇区。<br>　　Do not Erase：不进行擦除操作<br>　　Program：使用当前uVision工程的程序烧写ROM。<br>　　Verify：验证Flash ROM的内容和当前工程中的程序一致。<br>　　Reset and Run：在烧写和验证完成之后复位开发板并且运行程序。<br>RAM for Algorithm：指定用于烧写程序的RAM区域，通常是微控制器上的一段片上空间。<br>　　Start：起始地址。<br>　　Size：大小。<br>可以通过点击Add添加，点击Add你将看到如下的选择列表，可以根据你选用的芯片选择合适的，也可以自己手动添加。</p> 
<div> 
 <img src="https://images2.imgbox.com/34/47/I18skvkq_o.jpg" alt="" width="343" height="324"> 
 <br>  
</div> 
<p>　　Use External Tool for Flash Programming：使用第三方的工具进行Flash下载。<br>　　Command：要使用的Flash烧写工具的命令文件（通常是一个.exe文件）。<br>　　Arguments：传递给Flash烧写工具的参数。<br>　　Run Independent：当选中的时候，uVision不等待Flash烧写完成。不选中的时候uVision要等待Flash烧写完成并且在输出窗口显示烧写结果。<br>在HelloWorld里面修改了Flash Download Setup，具体的设置如上图所示。到此工程设置就结束了。<br><br><strong>5.1.2.3 打开工程</strong><br>通过菜单“Project”-&gt;“Open Project”来打开一个现有工程，这时将弹出一个打开文件对话框让我们选择要打开的工程文件。<br>选择你要打开的工程的路径，然后点击“Open”打开工程。我们还可以和打开其他文件一样，找到一个后缀为“uv2”的uVision3工程文件，直接双击，Windows会自动调用uVision3打开这个文件，前提是你电脑已经安装了uVision3并且和“uv2”文件建立了关联。</p> 
<p> </p> 
<p><strong>5.1.3 编写源程序</strong><br>选择菜单“File”-&gt;“New”或者点击工具栏的新建文件按钮，即可在项目窗口的右侧打开一个新的文本编辑窗口，在该窗口可以输入程序代码。<br>需要说明的是，源文件就是一般的文本文件，不一定使用Keil软件编写，可以使用任意文本编辑器编写，而且Keil的编辑器对汉字的支持不好，建议使用UltraEdit之类的编辑软件进行源程序的输入。<br>每一个程序至少有一个原型为int main(void)的主函数，这是程序的入口地址，程序将从这里开始运行。此外，我们还需要对开发板做一些时钟和中断方面的初始化工作，这些工作将在函数RCC_Configuration和NVIC_Configuration中完成。源文件的代码清单如下所示。</p> 
<div class="dp-highlighter"> 
 <div class="bar">
     
 </div> 
 <ol class="dp-cpp"><li class="alt"><span class="preprocessor">#include "stm32f10x_lib.h" </span>  </li><li>GPIO_InitTypeDef GPIO_InitStructure;   </li><li class="alt"><span class="keyword">void</span> Delay (vu32 nCount);   </li><li><span class="comment">/******************************************************************************* Function Name : main</span> </li><li class="alt"><span class="comment">* Description : 主程序 </span> </li><li><span class="comment">* Input : None </span> </li><li class="alt"><span class="comment">* Output : None </span> </li><li><span class="comment">* Return : None </span> </li><li class="alt"><span class="comment">******************************************************************************/</span>  </li><li><span class="datatypes">int</span> main (<span class="keyword">void</span>)   </li><li class="alt">{   </li><li>    RCC_APB2PeriphClockCmd(RCC_APB2Periph_ GPIOB, ENABLE);   </li><li class="alt">    GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;    </li><li>    GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;   </li><li class="alt">    GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;   </li><li>    GPIO_Init (GPIOB, &amp;GPIO_InitStructure);    </li><li class="alt">    <span class="keyword">while</span> (1)   </li><li>    {   </li><li class="alt">        GPIO_WriteBit (GPIOB, GPIO_Pin_9,   </li><li>            (BitAction)(1-GPIO_ReadOutputDataBit (GPIOB, GPIO_Pin_9)));   </li><li class="alt">        Delay (1000000);   </li><li>    }   </li><li class="alt">}   </li><li><span class="keyword">void</span> Delay (vu32 nCount)   </li><li class="alt">{   </li><li>    <span class="keyword">for</span> (; nCount != 0; nCount--);   </li><li class="alt">}  </li></ol> 
</div> 
<p><br>代码编辑完成之后，我们可以保存源文件，选择菜单“File”-&gt;“Save”或者点击工具栏的保存文件按钮，可以用来保存源文件。<br>这时会出现一个保存文件的文件对话框，选择你要保存的路径，输入文件名HelloWorld.c。注意一定要输入扩展名，如果是c程序文件扩展名为.c，如果是汇编文件扩展名为.s，习惯.asm的也可以存储为.asm。注解说明文件可以保存为.txt的扩展名。<br>源文件编辑完成之后我们还需要将源文件加入到工程中，工程建好之后，在工程窗口的文件页中，将会出现“Target 1”，前面有个“+”号，点击“+”号展开，可以看到下一层的“Source Group 1”，我们需要向这个里面加入源文件，点击“Source Group 1”使其反白显示，然后，点击鼠标右键，出现一个下拉菜单，如下图如示。</p> 
<div> 
 <img src="https://images2.imgbox.com/04/4d/yzoiRr5N_o.jpg" alt=""> 
 <br>  
</div> 
<p>选中其中的“Add file to Group ‘Source Group 1’”，出现一个对话框，要求寻找源文件，如下图所示。</p> 
<div> 
 <img src="https://images2.imgbox.com/75/33/YFEcUaMW_o.jpg" alt="" width="483" height="372"> 
 <br>  
</div> 
<p>注意，该对话框下面的“文件类型”默认为C source file(*.c)，我们可以通过调整这个来选择过滤我们想要格式的文件，从而帮助我们快速查找文件。如果是汇编文件，就选择“asm source file”；如果是目标文件，选择“Object file”；如果是库文件，选择“Library file”。最后点击“Add”，也可以双击要添加的文件进行加入。注意：点击“Add”之后，窗口不会消失，如果要添加多个文件，可以不断添加，添加完毕此时再点击“Close”关闭该窗口。初学者时常误认为操作没有成功而再次双击同一文件或者再次点击“Add”，这时会出现如下的对话框。</p> 
<div> 
 <img src="https://images2.imgbox.com/29/e0/YfewLfc1_o.jpg" alt="" width="249" height="172"> 
 <br>  
</div> 
<p>在这里我们把刚新建的HelloWorld.c添加进去，文件添加进去之后，我们点击“Source Group 1”前面的“+”号，就会发现我们刚刚添加的文件HelloWrold.c已在其中了，双击文件名，即在代码区打开该源程序文件。<br>除了添加文件，我们还可以添加新的Group，操作和添加文件类似，出现下拉菜单之后我们选择“New Group”，这时就会在工程窗口看到新加的Group。对Group和添加文件的操作我们还可以通过点击工具栏上的彩色品字按钮进入“Components，Environment and Books”窗口，如下图所示。</p> 
<div> 
 <img src="https://images2.imgbox.com/6d/21/XAu2Ac82_o.jpg" alt="" width="475" height="335"> 
 <br>  
</div> 
<p>双击列表中的项可以对该项进行重命名操作，点击空白处可以添加新的项，虚方框按钮也可以添加新的项，红叉表示删除选中的项，上下箭头用于调整当前选中项在列表中的位置，“Add Files”可以添加新的源文件，操作过程和前面添加文件的操作是一样的。<br><br><strong>5.1.4 编译程序</strong><br>程序代码写好之后就进入编译程序阶段，可以通过菜单，工具栏和浮动菜单多种方式来发起编译过程，也可以通过批处理文件进行，关于这个批处理文件在Output标签页的设置中提到过。</p> 
<div> 
 <img src="https://images2.imgbox.com/54/da/ApGwoIrt_o.jpg" alt="" width="477" height="246"> 
 <br>  
</div> 
<p>红线圈起来的区域就是对应的菜单编译命令和工具栏编译命令。各命令的含义如下：<br>　　Clean target：清除编译结果。<br>　　Build target：编译被修改的文件并且编译应用程序。<br>　　Rebuild all target files：重新编译所有的源文件并且编译应用程序。<br>　　Batch Build：通过前面输出的批处理文件进行编译。<br>　　Translate **.*：编译某个源文件，**.*代表要编译的源文件。<br>　　Stop build：只有编译进行过程中这一项才有效。<br>通过在工程窗口“Target 1”上点击右键，也可以弹出相应的编译菜单，各命令含义和上面一致。</p> 
<div> 
 <img src="https://images2.imgbox.com/ae/e8/bi0OictM_o.jpg" alt="" width="250" height="218"> 
 <br>  
</div> 
<p>现在就让我们来编译我们的“HelloWorld”，如下图所示，编译的结果会在输出窗口显示。</p> 
<div> 
 <img src="https://images2.imgbox.com/de/8c/XvOn1ZvG_o.jpg" alt="" width="482" height="147"> 
 <br> 
 <div>
   很遗憾，有不少错误，也许你早就发现我们的代码中使用了很多我们没有定义的而且也不属于标准C的一些函数，没错这就是ST固件库给我们提供的函数，我们要做的就是把固件库添加到我们的工程中，和其他的开发环境一下，我们可以直接添加固件库的源文件和工程一起编译，也可以通过添加已经编译好的静态连接库（*.lib）文件。这里我们以后者为例，这些库在我们安装好Keil开发环境的时候已经提供了，路径一般在你安装目录下的ARM/RV31/LIB/中，例如我这里的路径是D:/Keil/ARM/RV31/LIB/ST。这里我们将添加一个新的Group，取名为FWLIB。然后将库文件添加到这个Group中，具体的操作过程可以参照编写源程序章节。添加库之后我们再次编译。 
  <br> 
  <div> 
   <img src="https://images2.imgbox.com/4b/9a/myTtRvg2_o.jpg" alt="" width="481" height="133"> 
   <br>  
  </div> 问题解决了，当出现“0 Error(s), 0 Warning(s)”的时候也就意味着我们的程序已经通过了语法检查，有时候一些Warning也不影响程序执行，但是我们要慎重对待，仔细分析每一个Warning。如果是源程序中有语法错误或者警告，我们可以通过双击输出窗口的该行，快速定位到出错的位置。 
  <br>  
 </div> 
</div> 
<p><strong>5.1.5 调试程序</strong><br>编译通过只是说明我们的代码没有语法错误，至于源程序中存在的其他错误，必须通过调试才能发现并解决，事实上，除了极简单的程序以外，绝大部分的程序都要通过反复调试才能得到正确的结果，因此，调试是软件开发接下来我们需要运行我们的程序来验证是否达到了预期的目的。也就是程序调试，程序调试往往是程序开发过程中最难的阶段，尤其是对一些比较大型的程序。下面我们就来看看uVision3对调试的支持。</p> 
<p><strong>5.1.5.1 常用的调试命令</strong><br>在对工程成功进行汇编、连接之后，按Ctrl+F5或者使用菜单Debug-&gt;Start/Stop Debug Session即可进入调试状态。进入调试状态后，界面与编辑状态相比有明显的变化，Debug才单项中原来不能用的命令现在已经可以使用了，工具栏会多出一个用于运行和调试的工具栏，如下图所示，Debug菜单上的大部分命令可以在此找到对应的快捷按钮。</p> 
<div> 
 <img src="https://images2.imgbox.com/b2/ae/KcDVRglX_o.jpg" alt="" width="411" height="289"> 
 <br>  
</div> 
<p>常用的Debug菜单命令如下所示：<br>　　Start/Stop Debug Session：开始或者停止调试。<br>　　Run：一直执行下一个活动的断点。<br>　　Step：单步执行。<br>　　Step Over：过程单步执行，即将一个函数作为一个语句来执行。<br>　　Step out of current Function：跳出当前的函数。<br>　　Run to Cursor line：执行到光标所在的行。<br>　　Stop Running：停止运行。<br>　　Breakpoints：打开断点对话框。<br>　　Insert/Remove Breakpoint：在当前行插入/删除一个断点。<br>　　Enable/Disable Breakpoint：激活当前行的断点或者使断点无效。<br>　　Disable All Breakpoints：使程序中所有的断点都无效。<br>　　Kill all Breakpoints：删除程序中所有的断点。</p> 
<div> 
 <img src="https://images2.imgbox.com/44/e7/LZZFIViS_o.jpg" alt="" width="445" height="180"> 
 <br>  
</div> 
<p>学习程序调试，必须明确两个重要的概念，即单步执行与全速执行。全速执行是指一行程序执行完了以后紧接着执行下一行程序，中间不停止，这样程序执行的速度就很快，并可以看到该段程序执行的总体效果，即最终结果正确还是错误，但如果程序有错，则难以确认错误出现在哪些程序行。单步执行是每次执行一行程序，执行完该行程序执行完以后即停止，等待命令执行下一行程序，此时我们可以观察该行程序执行完以后得到的结果，是否与我们写程序行所想要得的结果相同，借此可以找到程序中问题所在。程序调试中，这两种运行方式都要用到，要灵活应用，可以大大提高调试效率。<br>在调试窗口中，我们可以看到一个黄色的调试箭头，指向了当前执行到的程序行。<br><br><strong>5.1.5.2 断点设置</strong><br>程序调试时，有些程序行往往很难确认什么时候能够执行到，这类问题就不适合单步调试，这是我们需要使用程序调试中另一种非常重要的方法——断点设置。断点设置的方法有多种，常用的是在某一程序行设置断点，设置好断点之后可以全速运行程序，一旦执行到该程序行即停止，可在此观察有关的变量值，以确定问题所在。设置断点的命令请参考上一节常用调试命令介绍。一旦某一行被设置了断点，我们可以在程序行的左端看到一个红色方框（如图5.24调试窗口图所示），如果该断点被禁用，方框将会变为白色。<br>除了在某程序行设置断点这一基本方法以外，uVision3还提供了多种设置断点的方法，按Debug-&gt;Breakpoints，即出现一个对话框，该对话框用于对断点进行详细的设置，如下图所示。</p> 
<div> 
 <img src="https://images2.imgbox.com/cc/91/TaDMbT4I_o.jpg" alt="" width="445" height="317"> 
 <br>  
</div> 
<p>图5.26中的Expression后的编辑框用于输入表达式，该表达式用于确定程序停止运行的条件，功能强大，涉及到uVision3内置的一套调试算法，这里不做详细说明，请查阅相关帮助文档。</p> 
<p><strong>5.1.5.3 调试窗口</strong><br>前面讲了调试的一些方法，里面多次提到检查程序的执行状态。调试窗口就是用于查看程序执行状态的。uVision3提供了多种调试窗口，如寄存器窗口，存储器窗口，反汇编窗口，外设窗口等，下面将会一一作介绍。</p> 
<div> 
 <img src="https://images2.imgbox.com/cb/39/88xYKDye_o.jpg" alt="" width="245" height="187"> 
 <br>  
</div> 
<p><strong>1. 寄存器窗口</strong><br>图5.26是工程窗口寄存器页的内容，寄存器页包含了当前所有的工作寄存器和系统寄存器，每当程序中执行到对某个寄存器的操作时，该寄存器会反色显示，用鼠标单击然后按F2（鼠标连续单击两次），即可修改该值。<br><strong>2. 存储器窗口</strong><br>存储器窗口可以显示系统中各种内存中的值，通过在Address后的编辑框中输入“字母:数字”即可显示相应内存值，其中字母C、D、I、X，分别代表代码存储空间、直接寻址的片内存储空间、间接寻址的片内存储空间、扩展的外部RAM单元值、键入C：0即可显示从0开始的ROM单元中的值，即查看程序的二进制代码。该窗口的显示值可以以各种形式显示，如十进制、十六进制、字符型等。改变显示方式的方法是点鼠标右键，在弹出的快捷菜单中选择。除了显示，还可以修改内存中的值，如下图所示。</p> 
<div> 
 <img src="https://images2.imgbox.com/f3/61/vAUFCZpL_o.jpg" alt="" width="191" height="129"> 
 <br>  
</div> 
<p><strong>3. 查看和调用栈窗口</strong><br>这个窗口可以帮助我们查看当前调用树的情况，我们还可以通过这个窗口查看和修改一些变量的值。鼠标停留在某个变量的时候点右键，在弹出的浮动菜单中选择Add ***to Watch window，Local 窗口显示当前一些局部变量的值，变量值的现实方式可以在十六进制和十进制之间切换，方式是在查看窗口点右键，在某个变量的Value栏用鼠标单击然后按F2（鼠标连续单击两次），即可修改该值。如下图所示。</p> 
<div> 
 <img src="https://images2.imgbox.com/ab/08/LnY3ceRR_o.jpg" alt="" width="350" height="129"> 
 <br>  
</div> 
<p><strong>4. 反汇编窗口</strong><br>点击View-&gt;Dissambly Window可以打开反汇编窗口，该窗口可以显示反汇编后的代码、源代码和相应反汇编代码的混合代码，可以在该窗口进行在线汇编、利用该窗口跟踪已找行的代码、在该窗口按汇编代码的方式单步执行。点击鼠标右键，出现快捷菜单，如图5.29所示，其中Mixed Mode是以混合方式显示，Assembly Mode是以返回编码方式显示。</p> 
<div> 
 <img src="https://images2.imgbox.com/1b/60/uZqcS38I_o.jpg" alt="" width="458" height="247"> 
 <br>  
</div> 
<p><strong>5. 外设窗口</strong><br>为了能够比较直观地了解单片机中各种外设的使用情况，uVison3提供了一个外围接口对话框。通过Peripherals菜单，下拉菜单中的内容和你选择的芯片有关，会列出你所选择的芯片上所有的外设。选择一项你可以进入查看或修改该外设的一些状态。例如在这里我们是通过GPIO中的PB9来控制LED闪烁，我们可以打开GPIOB的状态对换框，如图5.30所示。</p> 
<div> 
 <img src="https://images2.imgbox.com/d2/93/yrXNXDgn_o.jpg" alt="" width="356" height="342"> 
 <br>  
</div> 
<p>现在我们可以调试我们的HelloWorld了。程序运行时，你将看到开发板上的L1不停闪烁。</p> 
<p></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5d8d0a5fb75e44a0deb5328950b101c0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【转】ASP.NET前台代码绑定后台变量方法总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8364dceade91a4cb881d63714b8b130a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">揭秘华为标准岗位工资</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>