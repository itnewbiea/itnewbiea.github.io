<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>前端调用后端接口,并把数据做分页处理 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="前端调用后端接口,并把数据做分页处理" />
<meta property="og:description" content="前端最主要的工作就是联合后端,调用后端接口,把页面用后端数据渲染出来
后端接口一般做封装处理
如下图:封装了一个接口,默认值处如果有默认值就写,如果没有默认值就直接写参数名,request下方记得把参数写全
在methods方法下方进行调用封装的接口,方法名随便起,调用接口方法中的变量和在封装接口中request保持一直,最下方做成功返回数据,若是做数据分页处理,在成功返回下方进行做(下方详细说明)
methods中的方法处理好后,先在script下方声明that,格式就是 var that,记得导入你所封装的接口,import { StoreCommodityList } from &#39;../../../servies&#39;,然后在onLoad下方调用方法时先声明that = this,下方写入接口所给的数据,图中接口请求示例:{{host}}/f/api/guiji/getStoreCommodityList?guiJiCode=G340101002&amp;pageSize=10&amp;pageNo=1,最后调用接口的方法名
分页处理
先在html中写入uni-load-more(使用之前记得导入),loadMoreStatus为状态参数名
然后在return下方给loadMoreStatus一个默认状态
在所需要数据接口下方成功下做分页处理,因为没有总页数,所以就判断数据的长度和页大小就行比较
下拉刷新和触底加载 注意:
触底加载页数要&#43;1并且还要判断是否需要下拉刷新,状态是否为&#39;more&#39;,
下拉刷新数据需要先清空
&lt;template&gt; &lt;view&gt; &lt;u-sticky&gt; &lt;view style=&#34;background-color: #ffffff;&#34;&gt; &lt;uni-section :title=&#34;terminal.guiJiCode&#43;&#39;(&#39;&#43;terminal.jiGuiName&#43;&#39;)&#39;&#34; :subTitle=&#34;terminal.store.name&#34; type=&#34;line&#34;&gt; &lt;view style=&#34;margin-bottom: 5px;&#34;&gt; &lt;u-tag style=&#34;margin-left: 10px;&#34; v-if=&#34;terminal.online&#34; text=&#34;在线&#34; type=&#34;success&#34; /&gt; &lt;u-tag style=&#34;margin-left: 10px;&#34; v-if=&#34;!terminal.online&#34; text=&#34;离线&#34; type=&#34;error&#34; /&gt; &lt;u-tag style=&#34;margin-left: 10px;&#34; v-if=&#34;terminal.terminalOpened&#34; text=&#34;营业&#34; type=&#34;success&#34; /&gt; &lt;u-tag style=&#34;margin-left: 10px;&#34; v-if=&#34;!terminal.terminalOpened&#34; text=&#34;维护&#34; type=&#34;error&#34; /&gt; &lt;/view&gt; &lt;/uni-section&gt; &lt;uni-notice-bar showIcon scrollable v-if=&#34;text!=null&#34; single :text=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/9c7c060b8413613043483841f3098d0c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-09T08:58:59+08:00" />
<meta property="article:modified_time" content="2023-02-09T08:58:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">前端调用后端接口,并把数据做分页处理</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <p style="">前端最主要的工作就是联合后端,调用后端接口,把页面用后端数据渲染出来</p> 
 <p style="">后端接口一般做封装处理</p> 
 <p style="">如下图:封装了一个接口,默认值处如果有默认值就写,如果没有默认值就直接写参数名,request下方记得把参数写全</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:641px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:93.60374%;height:0;"> 
    <img src="https://images2.imgbox.com/10/b3/5fyaOHwf_o.png" style="margin-left:;display:block;width:641px;margin-top:-93.60374%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">在methods方法下方进行调用封装的接口,方法名随便起,调用接口方法中的变量和在封装接口中request保持一直,最下方做成功返回数据,若是做数据分页处理,在成功返回下方进行做(下方详细说明)</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:946px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:63.424946%;height:0;"> 
    <img src="https://images2.imgbox.com/4b/22/KHxCT8zj_o.png" style="margin-left:;display:block;width:946px;margin-top:-63.424946%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">methods中的方法处理好后,先在script下方声明that,格式就是<span class="kdocs-color" style="color:#C21C13;"> var that</span>,记得导入你所封装的接口,<span class="kdocs-color" style="color:#C21C13;">import { StoreCommodityList } from '../../../servies',</span><span class="kdocs-color" style="color:#080F17;">然后在onLoad下方调用方法时先声明</span><span class="kdocs-color" style="color:#C21C13;">that = this,</span><span class="kdocs-color" style="color:#080F17;">下方写入接口所给的数据,图中接口请求示例:</span><span class="kdocs-color" style="color:#C21C13;">{<!-- -->{host}}/f/api/guiji/getStoreCommodityList?guiJiCode=G340101002&amp;pageSize=10&amp;pageNo=1</span><span class="kdocs-color" style="color:#080F17;">,最后调用接口的方法名</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:978px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:42.842537%;height:0;"> 
    <img src="https://images2.imgbox.com/09/22/LPxqUCDk_o.png" style="margin-left:;display:block;width:978px;margin-top:-42.842537%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">分页处理</p> 
 <p style="">先在html中写入<span class="kdocs-color" style="color:#C21C13;">uni-load-more</span><span class="kdocs-color" style="color:#080F17;">(使用之前记得导入)</span>,loadMoreStatus为状态参数名</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1308px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:19.495413%;height:0;"> 
    <img src="https://images2.imgbox.com/e6/a5/YF7Nwc52_o.png" style="margin-left:;display:block;width:1308px;margin-top:-19.495413%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">然后在<span class="kdocs-color" style="color:#C21C13;">return</span>下方给loadMoreStatus一个默认状态</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1083px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:19.390583%;height:0;"> 
    <img src="https://images2.imgbox.com/33/79/otJVgc2J_o.png" style="margin-left:;display:block;width:1083px;margin-top:-19.390583%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">在所需要数据接口下方<span class="kdocs-color" style="color:#C21C13;">成功</span>下做分页处理,因为没有总页数,所以就判断<span class="kdocs-color" style="color:#C21C13;">数据的长度和页大小</span>就行比较</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1207px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:49.710022%;height:0;"> 
    <img src="https://images2.imgbox.com/94/44/hQYYaY3Y_o.png" style="margin-left:;display:block;width:1207px;margin-top:-49.710022%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="">下拉刷新和触底加载 </p> 
 <p style=""><span class="kdocs-color" style="color:#C21C13;"><span class="kdocs-bold" style="font-weight:bold;"> 注意:</span></span></p> 
 <p style="">触底加载<span class="kdocs-color" style="color:#C21C13;"><span class="kdocs-bold" style="font-weight:bold;">页数要+1</span></span>并且<span class="kdocs-color" style="color:#C21C13;"><span class="kdocs-bold" style="font-weight:bold;">还要判断是否需要下拉刷新</span></span>,状态是否为'more',</p> 
 <p style="">下拉刷新<span class="kdocs-color" style="color:#C21C13;"><span class="kdocs-bold" style="font-weight:bold;">数据需要先清空</span></span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1311px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:37.528603%;height:0;"> 
    <img src="https://images2.imgbox.com/91/4a/8NmEejDB_o.png" style="margin-left:;display:block;width:1311px;margin-top:-37.528603%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">&lt;template&gt;
    &lt;view&gt;
        &lt;u-sticky&gt;
            &lt;view style="background-color: #ffffff;"&gt;
                &lt;uni-section :title="terminal.guiJiCode+'('+terminal.jiGuiName+')'" :subTitle="terminal.store.name"
                    type="line"&gt;
                    &lt;view style="margin-bottom: 5px;"&gt;
                        &lt;u-tag style="margin-left: 10px;" v-if="terminal.online" text="在线" type="success" /&gt;
                        &lt;u-tag style="margin-left: 10px;" v-if="!terminal.online" text="离线" type="error" /&gt;
                        &lt;u-tag style="margin-left: 10px;" v-if="terminal.terminalOpened" text="营业" type="success" /&gt;
                        &lt;u-tag style="margin-left: 10px;" v-if="!terminal.terminalOpened" text="维护" type="error" /&gt;
                    &lt;/view&gt;
                &lt;/uni-section&gt;
                &lt;uni-notice-bar showIcon scrollable   v-if="text!=null" single :text="text" /&gt;
            &lt;/view&gt;
        &lt;/u-sticky&gt;
        &lt;u-empty v-if="(terminalGoodsList==null||terminalGoodsList.length==0)&amp;&amp;loadMoreStatus!='loading'" mode="list"
            text="没有添加任何商品"&gt;&lt;/u-empty&gt;
        &lt;view class="uni-product-list" style=" margin-bottom: 50px;"&gt;
            &lt;view class="uni-product" v-for="(product,index) in terminalGoodsList" :key="index"&gt;
                &lt;view class="image-view"&gt;
                    &lt;!-- &lt;image v-if="renderImage" class="uni-product-image"
                        :src="cosUrl+'/goods_images/'+product.goods.goodsImage"&gt;
                    &lt;/image&gt; --&gt;
                    &lt;image class="uni-product-image" :src="product.commodity.image" &gt;&lt;/image&gt;
                &lt;/view&gt;
                &lt;view class="uni-product-title"&gt;{<!-- -->{product.commodity.title}}&lt;/view&gt;

                &lt;view class="uni-product-price"&gt;
                    &lt;text class="uni-product-price-original"&gt;￥{<!-- -->{product.discountPrice}}&lt;/text&gt;
                    &lt;!-- &lt;text style="margin-left: 10px;"&gt;
                        &lt;u-tag type="primary" :text="'库存:'+product.stockNum" /&gt;
                    &lt;/text&gt; --&gt;
                    &lt;text class="uni-product-tip"&gt;{<!-- -->{product.commodity.standard}}&lt;/text&gt;
                &lt;/view&gt;
                &lt;!-- &lt;view class="uni-product-title title"&gt;保质期至：{<!-- -->{product.expireDate.replace("00:00:00", "")}}&lt;/view&gt; --&gt;

            &lt;/view&gt;
            &lt;!-- &lt;uni-load-more :status="loadMoreStatus"&gt;&lt;/uni-load-more&gt;--&gt;
            &lt;uni-load-more :status="loadMoreStatus"/&gt;
            &lt;view class="goods-carts"&gt;
                &lt;uni-goods-nav :options="options" :fill="true" :button-group="buttonGroup" @click="onClick"
                    @buttonClick="placeOrder" /&gt;
            &lt;/view&gt;
        &lt;/view&gt;
        &lt;view class="backTop"&gt;
            &lt;u-back-top :scrollTop="scrollTop" mode="circle" icon="arrow-upward" :iconStyle="iconStyle" top="600" /&gt;
        &lt;/view&gt;
    &lt;/view&gt;
&lt;/template&gt;

&lt;script&gt;
    //导入数据API的二次封装模块
    import { Guiji, NewsList, StoreCommodityList } from '../../../servies'
    var that
    export default {
        data() {
            return {
                loadMoreStatus: 'more',  //当前正在加载数据吗?必须等待上一次加载完成才能下一次的加载
                scrollTop:0,
                iconStyle: {
                    fontSize: '25px',
                },
                terminalGoodsList: [],
                terminal:{},
                NewsList:[],
                options: [],
                buttonGroup: [{
                    text: '开门选取商品',
                    backgroundColor: 'linear-gradient(90deg, #1E83FF, #0053B8)',
                    color: '#fff'
                }],
                pageNo: 1,
                pageSize: 10,
                guiJiCode:'G340101002',
                modId:'9fbfce19839b4829899765d5724127cb',
                text: '',
            };
        },
        async onLoad(){
            that = this;
            this.pageNo=1;
            this.pageSize=10;
            this.guiJiCode='G340101002';
            this.goodsList();  //商品列表
            
            this.guiJiCode='G340101002';
            this.guiJi();      //柜机信息
            
            
            this.pageNo=1;
            this.pageSize=10;
            this.modId='9fbfce19839b4829899765d5724127cb';
            this.newsList()     //消息公告
        },
        onReachBottom(){      //触底加载
            //防止错误加载 当状态不为'more'时不触发触底加载
            if(this.loadMoreStatus != 'more'){
                return;
            }
            console.log('滚动到页面底部了,加载下一页数据');
            this.pageNo += 1     //页数
            this.goodsList()
        },
        onPullDownRefresh() {   //下拉刷新
            
            // console.log('用户在页面顶部下拉了,希望刷新当前页面');
            // 清除当前已经加载到的数据和状态
            this.terminalGoodsList = []    //先清空数据
            this.pageNo = 1
            this.goodsList()
            // 隐藏页面顶部的"下拉刷新"提示动画符
            uni.stopPullDownRefresh()   //停止下拉刷新(所产生的动画提示符)
        },
        methods:{
            onPageScroll(e) {
                this.scrollTop = e.scrollTop;
            },
            async goodsList(){
                that.loadMoreStatus = 'loading'
                //商品列表
                let data = await StoreCommodityList(
                    this.pageNo,
                    this.pageSize,
                    this.guiJiCode
                );
                if(data.success){
                    if(data.data.length &lt; that.pageSize){
                        that.loadMoreStatus = 'noMore'
                    }else {
                        that.loadMoreStatus = 'more'
                    }
                    that.terminalGoodsList = [...that.terminalGoodsList,...data.data]
                }else {
                    that.loadMoreStatus = 'more'
                }
                
            },
            async guiJi(){            //柜机信息
                let data = await Guiji(
                    this.guiJiCode
                )
                if(data.success){
                    that.terminal = data.data
                };
            },
            async newsList(){            //消息公告
                let data = await NewsList(
                    this.pageNo,
                    this.pageSize,
                    this.modId
                )
                if(data.success){
                    that.NewsList = data.data
                    for(var item in that.NewsList){
                        console.log('item1',item);
                        let news = that.NewsList[item]
                        console.log('item2',news.summary);  
                        that.text += ' ' + news.summary
                        console.log("text3",that.text);
                    }
                };
            }
        },
    };
&lt;/script&gt;

&lt;style lang="scss"&gt;
    /* product */
    page {
        background: #F8F8F8;
    }

    view {
        font-size: 28upx;
    }

    .goods-carts {
        /* #ifndef APP-NVUE */
        display: flex;
        /* #endif */
        flex-direction: column;
        position: fixed;
        left: 0;
        right: 0;
        /* top:20; */
        /* #ifdef H5 */
        left: var(--window-left);
        right: var(--window-right);
        /* #endif */
        bottom: 0;
    }

    .uni-product-list {
        display: flex;
        width: 100%;
        flex-wrap: wrap;
        flex-direction: row;
    }

    .uni-product {
        /* border: 1px solid black; */
        padding: 20upx;
        display: flex;
        flex-direction: column;
        margin-bottom: 30upx;
    }

    .image-view {
        /* border: 1px solid red; */
        height: 330upx;
        width: 330upx;
        margin: 12upx 0;
    }

    .uni-product-image {
        height: 330upx; 
        width: 330upx;
    }

    .uni-product-title {
        width: 300upx;
        word-break: break-all;
        display: -webkit-box;
        overflow: hidden;
        line-height: 1.5;
        text-overflow: ellipsis;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
    }

    .uni-product-price {
        margin-top: 10upx;
        font-size: 28upx;
        line-height: 1.5;
        position: relative;
    }

    .uni-product-price-original {
        color: #e80080;
    }

    .uni-product-price-favour {
        color: #888888;
        text-decoration: line-through;
        margin-left: 10upx;
    }

    .uni-product-tip {
        position: absolute;
        right: 10upx;
        background-color: #1E83FF;
        color: #ffffff;
        padding: 0 10upx;
        border-radius: 5upx;
    }
    .backTop{
        opacity: .7;    
        &amp;:active{
            opacity: 1;
        }
    }

    .title {
        font-size: 24rpx;
    }
&lt;/style&gt;
</code></pre> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5d173bf7237d56a085e48d688d7ed5a9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">遗传算法(Genetic Algorithm)之deap学习笔记(一): 基础概念</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2817bbe1cbdb8bafed39121911a0c4bb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">本地Pycharm连接远程服务器详细配置过程（直接在本地使用服务器显卡）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>