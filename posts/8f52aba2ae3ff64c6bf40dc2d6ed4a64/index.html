<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>第五篇 设计模式的选择和应用 - 智慧选择与合理实践 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="第五篇 设计模式的选择和应用 - 智慧选择与合理实践" />
<meta property="og:description" content="第五篇：设计模式的选择和应用 - 智慧选择与合理实践
1. 如何识别和选择合适的设计模式 理解问题本质：首先，要深入理解面临的问题或需求。分析系统中的对象、它们之间的关系以及可能出现的变化点。了解哪些部分需要灵活性、扩展性或者解耦。
模式匹配：根据问题特征对照已知的设计模式，识别出可能适用的模式类型。例如，若遇到对象创建过程复杂且需要解耦，可以考虑使用工厂方法、抽象工厂或建造者模式；若需处理对象间复杂的交互逻辑，则可考虑责任链、中介者或观察者模式等。
权衡比较：对于多种可能适用的设计模式，进行对比分析，考虑每种模式带来的优缺点。如复用程度、代码可读性、维护成本、性能影响等因素。
实际场景结合：确保所选模式符合项目的具体应用场景，同时考虑到系统的未来发展变化。确保选择的设计模式能够适应业务需求的演变，而不是仅仅为了应用模式而模式化设计。
2. 设计模式的权衡和适用场景分析 在选择和应用设计模式时，必须认识到每个模式都有其适用范围和局限性：
一些模式可能会增加系统的复杂性，特别是在小型项目中过度使用。有些模式可能提高代码的可读性和复用性，但可能导致运行时性能下降（如工厂方法产生的类实例增多）。有的模式如单例和全局状态可能会导致难以测试和扩展。 因此，在决定采用某个设计模式时，应综合评估该模式在当前场景下的价值，包括是否解决了特定问题、是否会带来其他潜在问题以及未来可能的需求变化。
3 设计模式在实际项目中的应用案例分享 3.1. Spring框架中的依赖注入：Spring通过实现控制反转（IoC）和依赖注入（DI），实际上采用了工厂方法、策略和代理等模式，使得组件间的耦合度降低，更易于测试和维护。 Spring框架通过依赖注入（DI）实现控制反转（IoC），在实际应用中确实采用了工厂方法、策略和代理等模式的变体。下面分别以代码片段的形式说明：
1. 工厂方法模式的体现：BeanFactory与ApplicationContext
Spring中的BeanFactory接口是IoC容器的基本实现，它扮演了抽象工厂角色，负责管理和创建各种对象（即bean）。而ApplicationContext作为BeanFactory的高级实现，更加强大且功能丰富。
// Spring BeanFactory 实现了工厂方法模式 public interface BeanFactory { Object getBean(String name) throws BeansException; // ... 其他获取bean的方法 } // 通常我们使用 ApplicationContext 来获取 bean public class ClassPathXmlApplicationContext implements ApplicationContext { public Object getBean(String name) throws BeansException { // ... } } 2. 策略模式的体现：例如数据源配置切换
Spring允许通过Java配置或XML配置定义多个数据源，并根据运行时条件选择不同的数据源策略。
@Configuration public class DataSourceConfig { @Autowired private Environment env; @Bean @Primary public DataSource primaryDataSource() { return DataSourceBuilder." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8f52aba2ae3ff64c6bf40dc2d6ed4a64/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-04T17:06:43+08:00" />
<meta property="article:modified_time" content="2024-01-04T17:06:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">第五篇 设计模式的选择和应用 - 智慧选择与合理实践</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>第五篇：设计模式的选择和应用 - 智慧选择与合理实践</strong></p> 
<h2><a id="1__2"></a>1. <strong>如何识别和选择合适的设计模式</strong></h2> 
<ol><li> <p><strong>理解问题本质</strong>：首先，要深入理解面临的问题或需求。分析系统中的对象、它们之间的关系以及可能出现的变化点。了解哪些部分需要灵活性、扩展性或者解耦。</p> </li><li> <p><strong>模式匹配</strong>：根据问题特征对照已知的设计模式，识别出可能适用的模式类型。例如，若遇到对象创建过程复杂且需要解耦，可以考虑使用工厂方法、抽象工厂或建造者模式；若需处理对象间复杂的交互逻辑，则可考虑责任链、中介者或观察者模式等。</p> </li><li> <p><strong>权衡比较</strong>：对于多种可能适用的设计模式，进行对比分析，考虑每种模式带来的优缺点。如复用程度、代码可读性、维护成本、性能影响等因素。</p> </li><li> <p><strong>实际场景结合</strong>：确保所选模式符合项目的具体应用场景，同时考虑到系统的未来发展变化。确保选择的设计模式能够适应业务需求的演变，而不是仅仅为了应用模式而模式化设计。</p> </li></ol> 
<h2><a id="2__12"></a>2. <strong>设计模式的权衡和适用场景分析</strong></h2> 
<p>在选择和应用设计模式时，必须认识到每个模式都有其适用范围和局限性：</p> 
<ul><li>一些模式可能会增加系统的复杂性，特别是在小型项目中过度使用。</li><li>有些模式可能提高代码的可读性和复用性，但可能导致运行时性能下降（如工厂方法产生的类实例增多）。</li><li>有的模式如单例和全局状态可能会导致难以测试和扩展。</li></ul> 
<p>因此，在决定采用某个设计模式时，应综合评估该模式在当前场景下的价值，包括是否解决了特定问题、是否会带来其他潜在问题以及未来可能的需求变化。</p> 
<h2><a id="3__22"></a>3 <strong>设计模式在实际项目中的应用案例分享</strong></h2> 
<h3><a id="31__SpringSpringIoCDI_24"></a>3.1. <strong>Spring框架中的依赖注入</strong>：Spring通过实现控制反转（IoC）和依赖注入（DI），实际上采用了工厂方法、策略和代理等模式，使得组件间的耦合度降低，更易于测试和维护。</h3> 
<p>Spring框架通过依赖注入（DI）实现控制反转（IoC），在实际应用中确实采用了工厂方法、策略和代理等模式的变体。下面分别以代码片段的形式说明：</p> 
<p><strong>1. 工厂方法模式的体现：BeanFactory与ApplicationContext</strong></p> 
<p>Spring中的<code>BeanFactory</code>接口是IoC容器的基本实现，它扮演了抽象工厂角色，负责管理和创建各种对象（即bean）。而<code>ApplicationContext</code>作为<code>BeanFactory</code>的高级实现，更加强大且功能丰富。</p> 
<pre><code class="prism language-java"><span class="token comment">// Spring BeanFactory 实现了工厂方法模式</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BeanFactory</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Object</span> <span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>
    <span class="token comment">// ... 其他获取bean的方法</span>
<span class="token punctuation">}</span>

<span class="token comment">// 通常我们使用 ApplicationContext 来获取 bean</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassPathXmlApplicationContext</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationContext</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>2. 策略模式的体现：例如数据源配置切换</strong></p> 
<p>Spring允许通过Java配置或XML配置定义多个数据源，并根据运行时条件选择不同的数据源策略。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataSourceConfig</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">Environment</span> env<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@Primary</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">primaryDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token class-name">DataSourceBuilder</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"primary.datasource.url"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">username</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"primary.datasource.username"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"primary.datasource.password"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">secondaryDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token class-name">DataSourceBuilder</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"secondary.datasource.url"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">username</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"secondary.datasource.username"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"secondary.datasource.password"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 在其他类中注入时可以按需选择数据源策略</span>
    <span class="token annotation punctuation">@Service</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SomeService</span> <span class="token punctuation">{<!-- --></span>
    
        <span class="token annotation punctuation">@Autowired</span>
        <span class="token keyword">private</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span> <span class="token comment">// 这里注入的数据源可能是primaryDataSource也可能是secondaryDataSource</span>
        
        <span class="token comment">// 根据业务需求决定使用哪个数据源</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>3. 代理模式的体现：AOP和动态代理</strong></p> 
<p>Spring通过AOP（面向切面编程）机制实现了对目标对象的代理，如事务管理、日志记录等。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Aspect</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TransactionalAdvice</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">"execution(* com.example.service.*.*(..))"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 开启事务的逻辑</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@AfterReturning</span><span class="token punctuation">(</span>pointcut <span class="token operator">=</span> <span class="token string">"execution(* com.example.service.*.*(..))"</span><span class="token punctuation">,</span> returning <span class="token operator">=</span> <span class="token string">"result"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterReturning</span><span class="token punctuation">(</span><span class="token class-name">Object</span> result<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 提交事务的逻辑</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 其他通知...</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">// 这个UserService的实例在Spring IoC容器中实际上是被代理的对象</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 添加用户逻辑</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在这个例子中，Spring通过生成代理对象来拦截目标方法调用，从而实现了诸如事务管理这样的横切关注点。这就是代理模式在Spring AOP中的应用。Spring既可以使用JDK动态代理，也可以使用CGLIB库进行代理实现。</p> 
<h3><a id="32___123"></a>3.2. <strong>电商购物车模块</strong>：在构建购物车功能时，可以使用组合模式来表示商品项及其子项（如套装内包含多个单品），利用观察者模式实现实时总价计算，当添加或删除商品时通知观察者更新总价。</h3> 
<p>由于文本交互的限制，下面将简要说明如何使用组合模式和观察者模式来实现电商购物车模块，并给出部分伪代码以展示关键逻辑。</p> 
<p><strong>1. 组合模式（Composite Pattern）</strong></p> 
<p>首先，定义一个商品接口<code>Product</code>以及它的两种实现：单品<code>SingleProduct</code>和套装<code>BundleProduct</code>。套装内可以包含多个子商品项，即采用组合结构。</p> 
<pre><code class="prism language-java"><span class="token comment">// 商品抽象类或接口</span>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">protected</span> <span class="token keyword">double</span> price<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Product</span> product<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">Product</span> product<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ... 其他如获取价格、名称等方法</span>
<span class="token punctuation">}</span>

<span class="token comment">// 单品商品</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingleProduct</span> <span class="token keyword">extends</span> <span class="token class-name">Product</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">SingleProduct</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">double</span> price<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>price <span class="token operator">=</span> price<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Product</span> product<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">"单个商品不能添加子商品"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">Product</span> product<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">"单个商品没有子商品可移除"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// 套装商品，内部维护一个产品列表</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BundleProduct</span> <span class="token keyword">extends</span> <span class="token class-name">Product</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> productList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Product</span> product<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        productList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">Product</span> product<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        productList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">double</span> totalPrice <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Product</span> item <span class="token operator">:</span> productList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            totalPrice <span class="token operator">+=</span> item<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> totalPrice<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>2. 观察者模式（Observer Pattern）</strong></p> 
<p>定义一个<code>Cart</code>购物车类，它持有商品集合并实现了观察者模式。当商品数量变化时，购物车总价自动更新。</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token comment">// 购物车接口，同时作为观察目标（Observable）</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Cart</span> <span class="token keyword">extends</span> <span class="token class-name">ObserverTarget</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">void</span> <span class="token function">addItem</span><span class="token punctuation">(</span><span class="token class-name">Product</span> product<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token class-name">Product</span> product<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> <span class="token function">getTotalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 注册和删除观察者的方法由ObserverTarget提供</span>
<span class="token punctuation">}</span>

<span class="token comment">// 购物车实现</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ShoppingCart</span> <span class="token keyword">implements</span> <span class="token class-name">Cart</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> cartItems <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Observer</span><span class="token punctuation">&gt;</span></span> observers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addItem</span><span class="token punctuation">(</span><span class="token class-name">Product</span> product<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        cartItems<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">notifyObservers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 添加商品后通知所有观察者</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token class-name">Product</span> product<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        cartItems<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">notifyObservers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 移除商品后通知所有观察者</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getTotalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">double</span> totalPrice <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Product</span> item <span class="token operator">:</span> cartItems<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            totalPrice <span class="token operator">+=</span> item<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> totalPrice<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 实现ObserverTarget接口中的注册与通知方法</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addObserver</span><span class="token punctuation">(</span><span class="token class-name">Observer</span> observer<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        observers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeObserver</span><span class="token punctuation">(</span><span class="token class-name">Observer</span> observer<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        observers<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">notifyObservers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Observer</span> observer <span class="token operator">:</span> observers<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            observer<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 更新观察者（例如总价显示组件）</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 观察者接口</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Observer</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Cart</span> cart<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 总价显示组件作为观察者</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TotalPriceDisplay</span> <span class="token keyword">implements</span> <span class="token class-name">Observer</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Cart</span> cart<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">double</span> totalPrice <span class="token operator">=</span> cart<span class="token punctuation">.</span><span class="token function">getTotalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 更新UI或其他操作，显示最新的总价</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在这个例子中，当我们向购物车中添加或删除商品时，购物车会触发<code>notifyObservers()</code>方法通知所有的观察者（如总价显示组件），观察者通过调用<code>update()</code>方法来获取最新的购物车总价并进行相应更新。这样就实现了在添加或删除商品时实时计算并更新购物车总价的功能。</p> 
<h3><a id="33_GUIGUI_263"></a>3.3. <strong>GUI事件处理</strong>：GUI编程中广泛使用了事件监听机制，这背后隐藏着观察者模式的应用，当用户触发按钮点击等事件时，相应的处理器会接收到通知并执行相应操作。</h3> 
<h2><a id="4__265"></a>4. <strong>避免设计模式的滥用和过度设计</strong></h2> 
<p>设计模式虽好，但如果滥用或过度设计，反而会导致代码过于复杂，增加理解和维护难度。以下是一些避免滥用和过度设计的建议：</p> 
<ul><li>只有在真正需要解决特定设计问题时才引入设计模式，不要为模式而模式。</li><li>在设计初期保持简洁，随着需求迭代逐渐优化结构，适时引入设计模式以应对复用、扩展和解耦的需求。</li><li>对于简单的场景，优先选择简单直观的设计方案，无需刻意追求高级设计模式。</li><li>在团队协作中建立良好的设计规范，明确何时、何地以及如何恰当地使用设计模式。</li></ul> 
<p>总结来说，选择和应用设计模式的关键在于深入理解其原理，把握好适用的时机，并结合实际情况灵活运用，最终目的是为了提升软件的可读性、可维护性和可扩展性，而非盲目追求理论上的完美设计。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0e869f6ee49eeb679e43b20f6bba636d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">微服务全做错了！谷歌提出新方法，成本直接降为1/9！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/63a752ef312e87ff83ddc2c14b6347a4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">小红书12月内容趋势分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>