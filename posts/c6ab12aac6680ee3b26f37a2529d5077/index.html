<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【WEB逆向】关于tiktok参数msToken，X-Bogus，_signature生成 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【WEB逆向】关于tiktok参数msToken，X-Bogus，_signature生成" />
<meta property="og:description" content="目录
tiktok逆向
算法介绍
算法生成研究
代码跟踪
代码编写
开发者测试
tiktok的基本接口​编辑
评论截图
tiktok逆向 本文只是技术探讨，如果对tiktok造成影响请告知，本人及时删除。在线联系VV:HH19991111LV
从视频主页开始查找标题，如图下:
会发现加密参数的msToken，X-Bogus，_signature这个三个
以下开始算法研究
算法介绍 根据js代码抽取和去除花指令需要大量时间，以及绕过检测，
本编文件根本写不完。所以这里简单讲解一下算法生成过程，
tiktok的此次算法生成是使用JSVMP虚拟机模式，
膨胀了大量代码，校验是否为浏览器环境，其中检测了document,window,location,navigator.cavas,symbol,tostring.html，body,script,prototype等等，
算法生成研究 msToken，X-Bogus，_signature是jsVmp生成。
参数必选备注msTokentrue非对称算法生成，和_signature参数相辅相成X-Bogusfalse发现了cookie参与了运算，但是发空值，服务器并未进行检验，后期算法更新估计就会更新这一块，_signaturetrue检验是否浏览器环境，如果非浏览器生成的算法则发包报错，其中关键点，_signature生成的时候，浏览器环境user-agent参与运算。 代码跟踪 代码太多贴入js文件。
window.byted_acrawler.init({ aid: 1988, dfp: !1, boe: !1, intercept: !0, enablePathList: [&#34;/*&#34;], region: &#34;va-tiktok&#34;, mode: 513, isSDK: false }); //加上下面js //https://sf16-secsdk.ttwstatic.com/obj/rc-web-sdk-gcs/webmssdk/1.0.0.195/webmssdk.js 代码编写 var p = new XMLHttpRequest; p.open(&#34;GET&#34;, &#39;https://www.tiktok.com/api/comment/publish/?aid=1988&amp;app_language=zh-Hant-TW&amp;app_name=tiktok_web&amp;aweme_id=7034791620910451970&amp;battery_info=0.97&amp;browser_language=zh-CN&amp;browser_name=Mozilla&amp;browser_online=true&amp;browser_platform=Win32&amp;browser_version=5.0%20%28Windows%20NT%2010.0%3B%20Win64%3B%20x64%29%20AppleWebKit%2F537.36%20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F94.0.4606.81%20Safari%2F537.36&amp;channel=tiktok_web&amp;cookie_enabled=true&amp;device_id=7062797146567869953&amp;device_platform=web_pc&amp;focus_state=true&amp;from_page=video&amp;history_len=6&amp;is_fullscreen=false&amp;is_page_visible=true&amp;os=windows&amp;priority_region=US&amp;referer=https%3A%2F%2Fwww.tiktok.com%2F&amp;region=JP&amp;root_referer=https%3A%2F%2Fwww.tiktok.com%2F&amp;screen_height=823&amp;screen_width=1463&amp;text=123&amp;text_extra=%5B%5D&amp;tz_name=Asia%2FShanghai&amp;verifyFp=verify_kzfyihmc_9MFy9BZO_vzrg_4eUB_BTQG_EeTWUe5uPwoi&amp;webcast_language=zh-Hant-TW&#39;, !0); p.timeout = 60000; p.setRequestHeader(&#34;Accept&#34;, &#34;application/json, text/plain, */*&#34;); p.setRequestHeader(&#34;Content-Type&#34;, &#34;application/x-www-form-urlencoded; charset=UTF-8&#34;); p.setRequestHeader(&#34;x-tt-passport-csrf-token&#34;, &#34;89fedbd4e9c37c1d3d7af4c84664cb7f&#34;); var result = p.send(); 开发者测试 https://www." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c6ab12aac6680ee3b26f37a2529d5077/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-23T16:37:23+08:00" />
<meta property="article:modified_time" content="2023-05-23T16:37:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【WEB逆向】关于tiktok参数msToken，X-Bogus，_signature生成</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4 id="tiktok%E9%80%86%E5%90%91"></h4> 
<ul><li> <p id="main-toc"><strong>目录</strong></p> <p id="tiktok%E9%80%86%E5%90%91-toc" style="margin-left:80px;"></p> <p id="tiktok%E9%80%86%E5%90%91-toc" style="margin-left:40px;"><a href="#tiktok%E9%80%86%E5%90%91" rel="nofollow">tiktok逆向</a></p> <p id="%E7%AE%97%E6%B3%95%E4%BB%8B%E7%BB%8D-toc" style="margin-left:40px;"><a href="#%E7%AE%97%E6%B3%95%E4%BB%8B%E7%BB%8D" rel="nofollow">算法介绍</a></p> <p id="%E7%AE%97%E6%B3%95%E7%94%9F%E6%88%90%E7%A0%94%E7%A9%B6-toc" style="margin-left:40px;"><a href="#%E7%AE%97%E6%B3%95%E7%94%9F%E6%88%90%E7%A0%94%E7%A9%B6" rel="nofollow">算法生成研究</a></p> <p id="%E4%BB%A3%E7%A0%81%E8%B7%9F%E8%B8%AA-toc" style="margin-left:40px;"><a href="#%E4%BB%A3%E7%A0%81%E8%B7%9F%E8%B8%AA" rel="nofollow">代码跟踪</a></p> <p id="%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99-toc" style="margin-left:40px;"><a href="#%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99" rel="nofollow">代码编写</a></p> <p id="%E5%BC%80%E5%8F%91%E8%80%85%E6%B5%8B%E8%AF%95-toc" style="margin-left:40px;"><a href="#%E5%BC%80%E5%8F%91%E8%80%85%E6%B5%8B%E8%AF%95" rel="nofollow">开发者测试</a></p> <p id="%C2%A0tiktok%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%8E%A5%E5%8F%A3%E2%80%8B%E7%BC%96%E8%BE%91-toc" style="margin-left:40px;"><a href="#%C2%A0tiktok%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%8E%A5%E5%8F%A3%E2%80%8B%E7%BC%96%E8%BE%91" rel="nofollow">tiktok的基本接口​编辑</a></p> <p id="%C2%A0%E8%AF%84%E8%AE%BA%E6%88%AA%E5%9B%BE-toc" style="margin-left:40px;"><a href="#%C2%A0%E8%AF%84%E8%AE%BA%E6%88%AA%E5%9B%BE" rel="nofollow">评论截图</a></p> 
  <hr id="hr-toc"><p></p> <p></p> <p></p> </li></ul> 
<h3>tiktok逆向</h3> 
<p><em>本文只是技术探讨，如果对tiktok造成影响请告知，本人及时删除。在线联系VV:HH19991111LV</em></p> 
<p>从视频主页开始查找标题，如图下:</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/6c/67/b091kdp4_o.png" width="1200"></p> 
<p></p> 
<p>会发现加密参数的msToken，X-Bogus，_signature这个三个<br> 以下开始算法研究</p> 
<p></p> 
<h3 id="%E7%AE%97%E6%B3%95%E4%BB%8B%E7%BB%8D">算法介绍</h3> 
<p><strong>根据js代码抽取和去除花指令需要大量时间，以及绕过检测，<br> 本编文件根本写不完。所以这里简单讲解一下算法生成过程，<br> tiktok的此次算法生成是使用JSVMP虚拟机模式，<br> 膨胀了大量代码，校验是否为浏览器环境，其中检测了document,window,location,navigator.cavas,symbol,tostring.html，body,script,prototype等等，</strong></p> 
<hr> 
<h3 id="%E7%AE%97%E6%B3%95%E7%94%9F%E6%88%90%E7%A0%94%E7%A9%B6">算法生成研究</h3> 
<p>msToken，X-Bogus，_signature是jsVmp生成。</p> 
<table><thead><tr><th>参数</th><th>必选</th><th>备注</th></tr></thead><tbody><tr><td>msToken</td><td>true</td><td>非对称算法生成，和_signature参数相辅相成</td></tr><tr><td>X-Bogus</td><td>false</td><td>发现了cookie参与了运算，但是发空值，服务器并未进行检验，后期算法更新估计就会更新这一块，</td></tr><tr><td>_signature</td><td>true</td><td>检验是否浏览器环境，如果非浏览器生成的算法则发包报错，其中关键点，_signature生成的时候，浏览器环境user-agent参与运算。</td></tr></tbody></table> 
<p></p> 
<h3 id="%E4%BB%A3%E7%A0%81%E8%B7%9F%E8%B8%AA">代码跟踪</h3> 
<p><strong>代码太多贴入js文件。</strong></p> 
<pre><code>    window.byted_acrawler.init({
        aid: 1988,
        dfp: !1,
        boe: !1,
        intercept: !0,
        enablePathList: ["/*"],
        region: "va-tiktok",
        mode: 513,
        isSDK: false
    });
//加上下面js
//https://sf16-secsdk.ttwstatic.com/obj/rc-web-sdk-gcs/webmssdk/1.0.0.195/webmssdk.js
</code></pre> 
<hr> 
<h3 id="%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99">代码编写</h3> 
<pre><code>    var p = new XMLHttpRequest;
    p.open("GET", 'https://www.tiktok.com/api/comment/publish/?aid=1988&amp;app_language=zh-Hant-TW&amp;app_name=tiktok_web&amp;aweme_id=7034791620910451970&amp;battery_info=0.97&amp;browser_language=zh-CN&amp;browser_name=Mozilla&amp;browser_online=true&amp;browser_platform=Win32&amp;browser_version=5.0%20%28Windows%20NT%2010.0%3B%20Win64%3B%20x64%29%20AppleWebKit%2F537.36%20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F94.0.4606.81%20Safari%2F537.36&amp;channel=tiktok_web&amp;cookie_enabled=true&amp;device_id=7062797146567869953&amp;device_platform=web_pc&amp;focus_state=true&amp;from_page=video&amp;history_len=6&amp;is_fullscreen=false&amp;is_page_visible=true&amp;os=windows&amp;priority_region=US&amp;referer=https%3A%2F%2Fwww.tiktok.com%2F&amp;region=JP&amp;root_referer=https%3A%2F%2Fwww.tiktok.com%2F&amp;screen_height=823&amp;screen_width=1463&amp;text=123&amp;text_extra=%5B%5D&amp;tz_name=Asia%2FShanghai&amp;verifyFp=verify_kzfyihmc_9MFy9BZO_vzrg_4eUB_BTQG_EeTWUe5uPwoi&amp;webcast_language=zh-Hant-TW', !0);
    p.timeout = 60000;
    p.setRequestHeader("Accept", "application/json, text/plain, */*");
    p.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8");
    p.setRequestHeader("x-tt-passport-csrf-token", "89fedbd4e9c37c1d3d7af4c84664cb7f");
    var result = p.send();
</code></pre> 
<hr> 
<h3 id="%E5%BC%80%E5%8F%91%E8%80%85%E6%B5%8B%E8%AF%95">开发者测试</h3> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/bf/2b/KiGDX2gi_o.png"></p> 
<pre><code class="language-python">
https://www.tiktok.com/api/comment/list/?aid=1988&amp;app_language=ja-JP&amp;app_name=tiktok_web&amp;aweme_id=7228801069831179527&amp;browser_language=zh-CN&amp;browser_name=Mozilla&amp;browser_online=true&amp;browser_platform=Win32&amp;browser_version=5.0%20%28Windows%20NT%2010.0%3B%20Win64%3B%20x64%29%20AppleWebKit%2F537.36%20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F113.0.0.0%20Safari%2F537.36&amp;channel=tiktok_web&amp;cookie_enabled=true&amp;count=20&amp;current_region=JP&amp;cursor=0&amp;device_id=7231761221069440513&amp;device_platform=web_pc&amp;focus_state=true&amp;fromWeb=1&amp;from_page=video&amp;history_len=9&amp;is_fullscreen=false&amp;is_page_visible=true&amp;os=windows&amp;priority_region=&amp;referer=&amp;region=JP&amp;screen_height=1412&amp;screen_width=2510&amp;tz_name=Asia%2FShanghai&amp;webcast_language=zh-Hans&amp;msToken=g9DUJp7Zp2PoJZdfKNwFrli2niA1VrMhIR7v-uZy5SRLwgVqOMws0EawtMDrwFqaCsVWjqncIB0Oo41U8x4PuH3JOqwDBJdNj3jC9_qgGzfVxwjlGheCWF0IQyJQep_MgTzcQmjmGz8WnG0MRQ==&amp;X-Bogus=DFSzswVOmCxANxKftt7nPYXAIQRM&amp;_signature=_02B4Z6wo00001rlxQvQAAIDD2nuCn8zE5o65cUZAAMo897</code></pre> 
<p></p> 
<p>在使用v8环境和nodejs环境中分别测试，效果还可以<br> 理由fastapi搭建了tiktok的基本接口</p> 
<h3 id="%C2%A0tiktok%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%8E%A5%E5%8F%A3%E2%80%8B%E7%BC%96%E8%BE%91">tiktok的基本接口<img alt="" src="https://images2.imgbox.com/a7/db/WZ0No8j6_o.png"></h3> 
<h3 id="%C2%A0%E8%AF%84%E8%AE%BA%E6%88%AA%E5%9B%BE">评论截图</h3> 
<p>以下是评论的一部分截图</p> 
<p><img alt="" height="1121" src="https://images2.imgbox.com/ae/02/Uh3GXr6v_o.png" width="1200"></p> 
<p>涉及研究技术问题,代码就不公布，觉得文章比较好就给我点个关注</p> 
<p>来源：H~</p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/77fc3364d0b12158444c1671368ee1f8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SpringBoot开发实用篇2---与数据层技术有关的替换和整合</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/69fce3f4b8e6ed5f30e33b710980cd07/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">将本地jar包上传到私服</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>