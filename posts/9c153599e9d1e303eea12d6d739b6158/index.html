<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java实现office文件的在线预览 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java实现office文件的在线预览" />
<meta property="og:description" content="java实现office文件的在线预览 要实现office文件的在线预览，需要将office文件转换为pdf文件，然后打开
首先需要安装openOfice去官网先将openOffice 下载下来Apache OpenOffice - Official Download在java中导入依赖，导入依赖可能会导致报错，是因为本地maven仓库没有此依赖 所以需要去下载jar包，将jar放入本地maven资源仓库，在这里我提供了所需的jar包，有需要的可以去下载链接：https://pan.baidu.com/s/1gRlN6KHlL3nMz5fB7l-EIQ 提取码：zxcv下载号好之解压到Maven仓库的&#34;com\artofsolving\&#34;这个路径下( 如果没有这个路径就创建 ) 完成上面这步操作之后就可以配置Maven依赖了
&lt;dependency&gt; &lt;groupId&gt;com.artofsolving&lt;/groupId&gt; &lt;artifactId&gt;jodconverter&lt;/artifactId&gt; &lt;version&gt;2.2.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.openoffice&lt;/groupId&gt; &lt;artifactId&gt;jurt&lt;/artifactId&gt; &lt;version&gt;3.0.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.openoffice&lt;/groupId&gt; &lt;artifactId&gt;ridl&lt;/artifactId&gt; &lt;version&gt;3.0.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.openoffice&lt;/groupId&gt; &lt;artifactId&gt;juh&lt;/artifactId&gt; &lt;version&gt;3.0.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.openoffice&lt;/groupId&gt; &lt;artifactId&gt;unoil&lt;/artifactId&gt; &lt;version&gt;3.0.1&lt;/version&gt; &lt;/dependency&gt; 我将openoffice 的转换写成了一个工具类放在下面，有需要可以直接使用
/** * Created with IntelliJ IDEA. * * @Auther: 李子叔叔 * @Date: 2021/01/20/18:39 * @Description: */ public class OppenOffice { // 将word格式的文件转换为pdf格式 //startFile为源文件地址 //overFile为转换之后的文件地址 public static boolean WordToPDF(String startFile, String overFile) throws IOException { // 源文件目录 File inputFile = new File(startFile); System." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/9c153599e9d1e303eea12d6d739b6158/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-21T12:07:43+08:00" />
<meta property="article:modified_time" content="2022-09-21T12:07:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java实现office文件的在线预览</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>java实现office文件的在线预览</h2> 
<p>要实现office文件的在线预览，需要将office文件转换为pdf文件，然后打开</p> 
<ol><li>首先需要安装openOfice</li><li>去官网先将openOffice 下载下来<a href="http://www.openoffice.org/download/" rel="nofollow" title="Apache OpenOffice - Official Download">Apache OpenOffice - Official Download</a></li><li>在java中导入依赖，导入依赖可能会导致报错，是因为本地maven仓库没有此依赖</li><li> 所以需要去下载jar包，将jar放入本地maven资源仓库，在这里我提供了所需的jar包，有需要的可以去下载</li><li>链接：<a href="https://pan.baidu.com/s/1gRlN6KHlL3nMz5fB7l-EIQ" rel="nofollow" title="https://pan.baidu.com/s/1gRlN6KHlL3nMz5fB7l-EIQ ">https://pan.baidu.com/s/1gRlN6KHlL3nMz5fB7l-EIQ </a>       提取码：zxcv</li><li>下载号好之解压到Maven仓库的"com\artofsolving\"这个路径下( 如果没有这个路径就创建 )</li></ol> 
<p>完成上面这步操作之后就可以配置Maven依赖了</p> 
<pre><code>        &lt;dependency&gt;
			&lt;groupId&gt;com.artofsolving&lt;/groupId&gt;
			&lt;artifactId&gt;jodconverter&lt;/artifactId&gt;
			&lt;version&gt;2.2.2&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.openoffice&lt;/groupId&gt;
			&lt;artifactId&gt;jurt&lt;/artifactId&gt;
			&lt;version&gt;3.0.1&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.openoffice&lt;/groupId&gt;
			&lt;artifactId&gt;ridl&lt;/artifactId&gt;
			&lt;version&gt;3.0.1&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.openoffice&lt;/groupId&gt;
			&lt;artifactId&gt;juh&lt;/artifactId&gt;
			&lt;version&gt;3.0.1&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.openoffice&lt;/groupId&gt;
			&lt;artifactId&gt;unoil&lt;/artifactId&gt;
			&lt;version&gt;3.0.1&lt;/version&gt;
		&lt;/dependency&gt;</code></pre> 
<p>我将openoffice 的转换写成了一个工具类放在下面，有需要可以直接使用</p> 
<pre><code>/**
 * Created with IntelliJ IDEA.
 *
 * @Auther: 李子叔叔
 * @Date: 2021/01/20/18:39
 * @Description:
 */
public class OppenOffice {
    // 将word格式的文件转换为pdf格式
    //startFile为源文件地址
    //overFile为转换之后的文件地址
    public static boolean WordToPDF(String startFile, String overFile) throws IOException {
        // 源文件目录
        File inputFile = new File(startFile);
        System.out.println(startFile);

        //
        File outFile = new File(overFile);
        if (!inputFile.exists()) {
            System.out.println("源文件不存在！");
            return false;
        }
        // 输出文件目录
        File outputFile = new File(overFile);
        if (!outputFile.getParentFile().exists()) {
            outputFile.getParentFile().exists();
        }


        // 调用openoffice服务线程
        /** 我把openOffice下载到了 C:/Program Files (x86)/下  ,下面的写法自己修改编辑就可以**/
        String command = "C:\\Program Files (x86)\\OpenOffice 4\\program\\soffice.exe -headless -accept=\"socket,host=127.0.0.1,port=8100;urp;\"";
        Process p = Runtime.getRuntime().exec(command);

        // 连接openoffice服务
        OpenOfficeConnection connection = new SocketOpenOfficeConnection("127.0.0.1", 8100);

        connection.connect();

        // 转换
        DocumentConverter converter = new OpenOfficeDocumentConverter(connection);
        converter.convert(inputFile, outputFile);

        // 关闭连接
        connection.disconnect();

//         关闭进程
        p.destroy();
        return  true;
    }
}</code></pre> 
<p>写完工具类之后在控制层拿到两个地址就可以直接调用工具类进行转换，在控制器用流的方式打开也行，也可以将转换完成之后的地址返回到前台</p> 
<p>使用流打开</p> 
<pre><code>//overoFile为转换之后的路径
File file = new File(overFile);
        //判断文件是否存在
        if (file.exists()){
            byte[] data = null;
            try {
                FileInputStream input = new FileInputStream(file);
                data = new byte[input.available()];
                input.read(data);
                response.getOutputStream().write(data);
                input.close();
            } catch (Exception e) {
                System.out.println(e);
            }

        }else{
            return;
        }

//js
 function openFile(fileId) {
       window.open("/openOffice?fileId="+fileId);
    }</code></pre> 
<p>在前端直接打开</p> 
<pre><code> function openFile(fileId) {
        $.ajax({
            url:"/openOffice?fileId="+fileId,//控制器路径
            type:"get",
            async: false,
            success:function (data) {
                $.modal.open("预览文件",data);
            }
        })
    }</code></pre> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/59c8decc1e7c19236f6440c441784c86/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">word 2016编辑区鼠标光标消失/变白解决方案</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9e7fba06c9d5e2bd5c3fc6692b4a24d6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">高速USB转8串口产品设计-RS485串口</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>