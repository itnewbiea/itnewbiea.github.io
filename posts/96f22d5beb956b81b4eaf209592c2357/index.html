<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mmrotate框架基本使用 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mmrotate框架基本使用" />
<meta property="og:description" content="1、如何将类交给mmrotate框架容器管理 容器：框架中现有基本容器包括DATASETS, BACKBONES, LOSSES, DETECTORS。初始化容器：Registry(‘backbone’)中’backbone’为容器初始化配置文件。#/mmdet/models/builder.py 部分代码 from mmcv.utils import Registry,build_from_cfg BACKBONES = Registry(&#39;backbone&#39;) NECKS = Registry(&#39;neck&#39;) ROI_EXTRACTORS = Registry(&#39;roi_extractor&#39;) SHARED_HEADS = Registry(&#39;shared_head&#39;) HEADS = Registry(&#39;head&#39;) LOSSES = Registry(&#39;loss&#39;) DETECTORS = Registry(&#39;detector&#39;) 容器管理类的形式：#DATASETS容器 Registry(name=dataset, items={ &#39;CustomDataset&#39;: &lt;class&#39;mmdet.datasets.custom.CustomDataset&#39;&gt;, &#39;CocoDataset&#39;: &lt;class&#39;mmdet.datasets.coco.CocoDataset&#39;&gt;, &#39;CityscapesDataset&#39;: &lt;class&#39;mmdet.datasets.cityscapes.CityscapesDataset&#39;&gt;, &#39;ConcatDataset&#39;: &lt;class&#39;mmdet.datasets.dataset_wrappers.ConcatDataset&#39;&gt;, &#39;RepeatDataset&#39;: &lt;class&#39;mmdet.datasets.dataset_wrappers.RepeatDataset&#39;&gt;, &#39;XMLDataset&#39;: &lt;class&#39;mmdet.datasets.xml_style.XMLDataset&#39;&gt;, &#39;VOCDataset&#39;: &lt;class&#39;mmdet.datasets.voc.VOCDataset&#39;&gt;, &#39;WIDERFaceDataset&#39;: &lt;class&#39;mmdet.datasets.wider_face.WIDERFaceDataset&#39;&gt;}) 通过注解@ROTATED_DATASETS.register_module()可将数据集类注册到ROTATED_DATASETS容器。同理@ROTATED_BACKBONES.register_module()可将主干网类注册到ROTATED_BACKBONES容器。 2、如何实例化mmrotate框架容器管理的类 通过build_dataset(cfg),build_backbone(cfg),build_neck(cfg),build_loss(cfg)实例化相应容器中的类对象。#L1LossConfig loss = dict(&#39;type&#39;: &#39;L1Loss&#39;, &#39;loss_weight&#39;: 1.0) import mmdet.models.builder.build_loss import L1LossConfig l1Loss = build_loss(L1LossConfig.loss) 以上几个build_xxx(cfg)仅仅只是构建一个模型中的组件。 3、如何组装实例化mmrotate类对象（组件） 通过build_detectors(cfg)就可以将各个组件组装起来。cfg如下：# model settings model = dict( type=&#39;MaskRCNN&#39;, backbone=dict( type=&#39;ResNet&#39;, xxx ), neck=dict( type=&#39;FPN&#39;, xxx ), rpn_head=dict( type=&#39;RPNHead&#39;, xxx loss_cls=dict( type=&#39;CrossEntropyLoss&#39;, xxx), loss_bbox=dict(type=&#39;L1Loss&#39;, xxx), roi_head=dict( xxx mask_head=dict( type=&#39;FCNMaskHead&#39;, xxx loss_mask=dict( type=&#39;CrossEntropyLoss&#39;, xxx)))) 4、各个组件之间是怎么进行耦合的。 5、怎么知道单个组件需要传入哪些参数，才能自适应构建我们想要的组件。 6、mmrotate组织结构/功能。 通过 LOSSES = Registry(‘loss’)注册管理loss注册表中的所有loss，并通过build_loss(cfg)定制化生成我们所需的对象。这和Spring是一致的，通过ApplicationContext（application." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/96f22d5beb956b81b4eaf209592c2357/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-28T11:23:30+08:00" />
<meta property="article:modified_time" content="2023-07-28T11:23:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mmrotate框架基本使用</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1mmrotate_0"></a>1、如何将类交给mmrotate框架容器管理</h3> 
<ul><li>容器：框架中现有基本容器包括DATASETS, BACKBONES, LOSSES, DETECTORS。</li><li>初始化容器：Registry(‘backbone’)中’backbone’为容器初始化配置文件。<pre><code class="prism language-python"><span class="token comment">#/mmdet/models/builder.py  部分代码</span>
<span class="token keyword">from</span> mmcv<span class="token punctuation">.</span>utils <span class="token keyword">import</span> Registry<span class="token punctuation">,</span>build_from_cfg
BACKBONES <span class="token operator">=</span> Registry<span class="token punctuation">(</span><span class="token string">'backbone'</span><span class="token punctuation">)</span>
NECKS <span class="token operator">=</span> Registry<span class="token punctuation">(</span><span class="token string">'neck'</span><span class="token punctuation">)</span>
ROI_EXTRACTORS <span class="token operator">=</span> Registry<span class="token punctuation">(</span><span class="token string">'roi_extractor'</span><span class="token punctuation">)</span>
SHARED_HEADS <span class="token operator">=</span> Registry<span class="token punctuation">(</span><span class="token string">'shared_head'</span><span class="token punctuation">)</span>
HEADS <span class="token operator">=</span> Registry<span class="token punctuation">(</span><span class="token string">'head'</span><span class="token punctuation">)</span>
LOSSES <span class="token operator">=</span> Registry<span class="token punctuation">(</span><span class="token string">'loss'</span><span class="token punctuation">)</span>
DETECTORS <span class="token operator">=</span> Registry<span class="token punctuation">(</span><span class="token string">'detector'</span><span class="token punctuation">)</span>
</code></pre> </li><li>容器管理类的形式：<pre><code class="prism language-python"><span class="token comment">#DATASETS容器</span>
Registry<span class="token punctuation">(</span>name<span class="token operator">=</span>dataset<span class="token punctuation">,</span> items<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
<span class="token string">'CustomDataset'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span><span class="token keyword">class</span><span class="token string">'mmdet.datasets.custom.CustomDataset'</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> 
<span class="token string">'CocoDataset'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span><span class="token keyword">class</span><span class="token string">'mmdet.datasets.coco.CocoDataset'</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> 
<span class="token string">'CityscapesDataset'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span><span class="token keyword">class</span><span class="token string">'mmdet.datasets.cityscapes.CityscapesDataset'</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> 
<span class="token string">'ConcatDataset'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span><span class="token keyword">class</span><span class="token string">'mmdet.datasets.dataset_wrappers.ConcatDataset'</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> 
<span class="token string">'RepeatDataset'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span><span class="token keyword">class</span><span class="token string">'mmdet.datasets.dataset_wrappers.RepeatDataset'</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> 
<span class="token string">'XMLDataset'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span><span class="token keyword">class</span><span class="token string">'mmdet.datasets.xml_style.XMLDataset'</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> 
<span class="token string">'VOCDataset'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span><span class="token keyword">class</span><span class="token string">'mmdet.datasets.voc.VOCDataset'</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> 
<span class="token string">'WIDERFaceDataset'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span><span class="token keyword">class</span><span class="token string">'mmdet.datasets.wider_face.WIDERFaceDataset'</span><span class="token operator">&gt;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> </li><li>通过注解@ROTATED_DATASETS.register_module()可将数据集类注册到ROTATED_DATASETS容器。同理@ROTATED_BACKBONES.register_module()可将主干网类注册到ROTATED_BACKBONES容器。</li></ul> 
<h3><a id="2mmrotate_28"></a>2、如何实例化mmrotate框架容器管理的类</h3> 
<ul><li>通过build_dataset(cfg),build_backbone(cfg),build_neck(cfg),build_loss(cfg)实例化相应容器中的类对象。<pre><code class="prism language-python"><span class="token comment">#L1LossConfig</span>
 loss <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token string">'L1Loss'</span><span class="token punctuation">,</span> <span class="token string">'loss_weight'</span><span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">)</span>
</code></pre> <pre><code class="prism language-python"><span class="token keyword">import</span> mmdet<span class="token punctuation">.</span>models<span class="token punctuation">.</span>builder<span class="token punctuation">.</span>build_loss
<span class="token keyword">import</span> L1LossConfig
l1Loss <span class="token operator">=</span> build_loss<span class="token punctuation">(</span>L1LossConfig<span class="token punctuation">.</span>loss<span class="token punctuation">)</span>
</code></pre> </li><li>以上几个build_xxx(cfg)仅仅只是构建一个模型中的组件。</li></ul> 
<h3><a id="3mmrotate_40"></a>3、如何组装实例化mmrotate类对象（组件）</h3> 
<ul><li>通过build_detectors(cfg)就可以将各个组件组装起来。cfg如下：<pre><code class="prism language-python"><span class="token comment"># model settings</span>
model <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>
    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'MaskRCNN'</span><span class="token punctuation">,</span>
    backbone<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>
        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'ResNet'</span><span class="token punctuation">,</span>
        xxx
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
    neck<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>
        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'FPN'</span><span class="token punctuation">,</span>
        xxx
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
    rpn_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>
        <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'RPNHead'</span><span class="token punctuation">,</span>
           xxx
        loss_cls<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>
            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> xxx<span class="token punctuation">)</span><span class="token punctuation">,</span>
        loss_bbox<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'L1Loss'</span><span class="token punctuation">,</span> xxx<span class="token punctuation">)</span><span class="token punctuation">,</span>
    roi_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>
        xxx
        mask_head<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>
            <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'FCNMaskHead'</span><span class="token punctuation">,</span>
            xxx
            loss_mask<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>
                <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'CrossEntropyLoss'</span><span class="token punctuation">,</span> xxx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> </li></ul> 
<p><img src="https://images2.imgbox.com/ad/a4/gxPV60We_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_69"></a>4、各个组件之间是怎么进行耦合的。</h3> 
<h3><a id="5_71"></a>5、怎么知道单个组件需要传入哪些参数，才能自适应构建我们想要的组件。</h3> 
<h3><a id="6mmrotate_73"></a>6、mmrotate组织结构/功能。</h3> 
<ul><li>通过 LOSSES = Registry(‘loss’)注册管理loss注册表中的所有loss，并通过build_loss(cfg)定制化生成我们所需的对象。这和Spring是一致的，通过ApplicationContext（application.xml）加载application.xml中所有的Bean，不过不同的是Bean中指定了更为详细的信息，包括Property等。而loss注册表中仅仅只有对象名和对应的类，其他所需要的配置需要通过build_loss(cfg)指定。mmrotate分两步加载生成实例Bean，Spring只需要一步。但mmrotate更加灵活，它将通用部分进一步抽象。</li></ul>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a0156b33feaf1ea172e3ecfbaf70a4d6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">DRUPAL 8.x远程代码执行漏洞(CVE-2018-7600)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/16aff2aa132a9c63247337abd69458b0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JS如何获取最近一个月或指定天数的日期,并以数组的形式存储</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>