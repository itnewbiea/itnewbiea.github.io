<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>快速了解B&#43;树的插入、删除操作 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="快速了解B&#43;树的插入、删除操作" />
<meta property="og:description" content="B&#43;树非常的复杂，这里不进行详细的讲解，只对基本的插入删除操作进行说明。
在B&#43;树中，所有记录节点都是按键值的大小顺序存放在同一层的叶节点中，各叶节点用指针连接。因此在进行插入删除操作时，要进行调整，维持其平衡性。
我们先来看一个B&#43;树，其高度为2，每页可存放4条记录，扇出（fan out）为5，可以理解成5阶多叉树。
可以看出，所有记录都在叶节点中，并且是顺序存放的，如果我们从最左边的叶节点开始顺序遍历，可以得到所有键值的顺序排序：5、10、15、20、25、30、50、55、60、65、75、80、85、90。
1、插入 B&#43;树的插入必须保证插入后叶节点中的记录依然排序，同时需要考虑插入B&#43;树的三种情况，每种情况都可能会导致不同的插入算法，如表5-1所示。
我们用实例来分析B&#43;树的插入，我们插入28这个键值，发现当前Leaf Page和Index Page都没有满，我们直接插入就可以了。
这次我们再插入一条70这个键值，这时原先的Leaf Page已经满了，但是Index Page还没有满，符合表5-1的第二种情况，这时插入Leaf Page后的情况为50、55、60、65、70。我们根据中间的值60拆分叶节点。
因为图片显示的关系，这次我没有能在各叶节点加上双向链表指针。最后我们来插入记录95，这时符合表5-1讨论的第三种情况，即Leaf Page和Index Page都满了，这时需要做两次拆分。
可以看到，不管怎么变化，B&#43;树总是会保持平衡。但是为了保持平衡，对于新插入的键值可能需要做大量的拆分页（split）操作，而B&#43;树主要用于磁盘，因此页的拆分意味着磁盘的操作，应该在可能的情况下尽量减少页的拆分。因此，B&#43;树提供了旋转（rotation）的功能。
旋转发生在Leaf Page已经满了、但是其左右兄弟节点没有满的情况下
可以看到，采用旋转操作使B&#43;树减少了一次页的拆分操作，而这时B&#43;树的高度依然还是2。
2、删除 a）初始状态
b）删除22
c）删除15
删除后当前结点只有一个key,不满足条件，而兄弟结点有三个key，可以从兄弟结点借一个关键字为9的记录,同时更新将父结点中的关键字由10也变为9，删除结束。
d）删除7
当前结点关键字个数小于2，（左）兄弟结点中的也没有富余的关键字（当前结点还有个右兄弟，不过选择任意一个进行分析就可以了，这里我们选择了左边的），所以当前结点和兄弟结点合并，并删除父结点中的key，当前结点指向父结点。
此时当前结点的关键字个数小于2，兄弟结点的关键字也没有富余，所以父结点中的关键字下移，和两个孩子结点合并，结果如下图所示。
参考资料：
[1].B&#43;树介绍 https://www.cnblogs.com/wade-luffy/p/6292784.html#_label0_1
[2].B树和B&#43;树的插入、删除图文详解 https://www.cnblogs.com/nullzx/p/8729425.html" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/4c8280fc9957fcd8cde35cdb6f6920ef/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-09-17T19:34:19+08:00" />
<meta property="article:modified_time" content="2018-09-17T19:34:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">快速了解B&#43;树的插入、删除操作</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>B+树非常的复杂，这里不进行详细的讲解，只对基本的插入删除操作进行说明。</p> 
<p>在B+树中，所有记录节点都是按键值的大小顺序存放在同一层的<code>叶节点</code>中，各叶节点用<code>指针</code>连接。因此在进行插入删除操作时，要进行调整，维持其平衡性。</p> 
<p>我们先来看一个B+树，其高度为2，每页可存放4条记录，扇出（fan out）为5，可以理解成5阶多叉树。<br> <img src="https://images2.imgbox.com/69/89/dmmLZq3W_o.png" alt="在这里插入图片描述"></p> 
<p>可以看出，所有记录都在叶节点中，并且是顺序存放的，如果我们从最左边的叶节点开始顺序遍历，可以得到所有键值的顺序排序：5、10、15、20、25、30、50、55、60、65、75、80、85、90。</p> 
<h4><a id="1_8"></a>1、插入</h4> 
<p>B+树的插入必须保证插入后叶节点中的记录依然排序，同时需要考虑插入B+树的三种情况，每种情况都可能会导致不同的插入算法，如表5-1所示。<br> <img src="https://images2.imgbox.com/55/93/kuOS8aHs_o.png" alt="在这里插入图片描述"></p> 
<p>我们用实例来分析B+树的插入，我们插入28这个键值，发现当前Leaf Page和Index Page都没有满，我们直接插入就可以了。<br> <img src="https://images2.imgbox.com/13/06/6dpz8XR6_o.png" alt="在这里插入图片描述"><br> 这次我们再插入一条70这个键值，这时原先的Leaf Page已经满了，但是Index Page还没有满，符合表5-1的第二种情况，这时插入Leaf Page后的情况为50、55、60、65、70。我们根据中间的值60拆分叶节点。<br> <img src="https://images2.imgbox.com/81/7d/OuLrIko4_o.png" alt="在这里插入图片描述"><br> 因为图片显示的关系，这次我没有能在各叶节点加上双向链表指针。最后我们来插入记录95，这时符合表5-1讨论的第三种情况，即Leaf Page和Index Page都满了，这时需要做两次拆分。<br> <img src="https://images2.imgbox.com/42/57/hO5eP7fV_o.png" alt="在这里插入图片描述"><br> 可以看到，不管怎么变化，B+树总是会保持平衡。但是为了保持平衡，对于新插入的键值可能需要做大量的拆分页（split）操作，而B+树主要用于磁盘，因此页的拆分意味着磁盘的操作，应该在可能的情况下尽量减少页的拆分。因此，B+树提供了旋转（rotation）的功能。</p> 
<p>旋转发生在Leaf Page已经满了、但是其左右兄弟节点没有满的情况下</p> 
<p><img src="https://images2.imgbox.com/49/93/aPh4Kek1_o.png" alt="在这里插入图片描述"><br> 可以看到，采用旋转操作使B+树减少了一次页的拆分操作，而这时B+树的高度依然还是2。</p> 
<h4><a id="2_24"></a>2、删除</h4> 
<p><img src="https://images2.imgbox.com/f9/b6/GB5AhRdA_o.png" alt="在这里插入图片描述"><br> a）初始状态<br> <img src="https://images2.imgbox.com/b3/a5/5X1Kv78o_o.png" alt="在这里插入图片描述"></p> 
<p>b）删除22<br> <img src="https://images2.imgbox.com/c9/bb/us647NQ2_o.png" alt="在这里插入图片描述"><br> c）删除15<br> <img src="https://images2.imgbox.com/3a/e6/hdgKXlwb_o.png" alt="在这里插入图片描述"><br> 删除后当前结点只有一个key,不满足条件，而兄弟结点有三个key，可以从兄弟结点借一个关键字为9的记录,同时更新将父结点中的关键字由10也变为9，删除结束。<br> <img src="https://images2.imgbox.com/e4/0c/IMRVXmGS_o.png" alt="在这里插入图片描述"><br> d）删除7<br> <img src="https://images2.imgbox.com/9a/4f/DPQWGX4d_o.png" alt="在这里插入图片描述"><br> 当前结点关键字个数小于2，（左）兄弟结点中的也没有富余的关键字（当前结点还有个右兄弟，不过选择任意一个进行分析就可以了，这里我们选择了左边的），所以当前结点和兄弟结点合并，并删除父结点中的key，当前结点指向父结点。<br> <img src="https://images2.imgbox.com/2b/4b/r77WbCUk_o.png" alt="在这里插入图片描述"><br> 此时当前结点的关键字个数小于2，兄弟结点的关键字也没有富余，所以父结点中的关键字下移，和两个孩子结点合并，结果如下图所示。<br> <img src="https://images2.imgbox.com/e8/f1/xRe0iRJI_o.png" alt="在这里插入图片描述"><br> 参考资料：<br> [1].B+树介绍 <a href="https://www.cnblogs.com/wade-luffy/p/6292784.html#_label0_1" rel="nofollow">https://www.cnblogs.com/wade-luffy/p/6292784.html#_label0_1</a><br> [2].B树和B+树的插入、删除图文详解 <a href="https://www.cnblogs.com/nullzx/p/8729425.html" rel="nofollow">https://www.cnblogs.com/nullzx/p/8729425.html</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ae67c5d873f9e726ce3937bd2a6f6cb6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ImportError: No module named pkg_resources解决方案  CentOS6.5上安装Python2.7和PIP</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/38e8589fc95641bbb6bc28079da5e0a7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">adb 指令uninstall卸载android app 处理方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>