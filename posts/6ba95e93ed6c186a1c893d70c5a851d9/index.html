<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue 前端导出xlsx文件 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue 前端导出xlsx文件" />
<meta property="og:description" content="安装组件：
npm install xlsx --save
npm install --save xlsx file-saver html 代码:
&lt;el-table :data=&#34;tableData&#34; id=&#34;outExcel&#34;&gt;&lt;/el-table&gt;
js 代码:
import * as XLSX from &#39;xlsx&#39;;
import FileSaver from &#39;file-saver&#39;
/**导出数据*/
handleOut() {
/** 从表生成工作簿对象 out-table是表格的id */
const wb = XLSX.utils.table_to_book(document.querySelector(&#34;#outExcel&#34;));
/** 获取二进制字符串作为输出 */
const wbout = XLSX.write(wb, {
bookType: &#34;xlsx&#34;,
bookSST: true,
type: &#34;array&#34;
});
try {
FileSaver.saveAs(
new Blob([wbout], {type: &#34;application/octet-stream&#34;}),
//设置导出文件名称
&#34;文件名称.xlsx&#34;
);
} catch (e) {
if (typeof console !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/6ba95e93ed6c186a1c893d70c5a851d9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-17T16:05:05+08:00" />
<meta property="article:modified_time" content="2023-02-17T16:05:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue 前端导出xlsx文件</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="color:#fe2c24;">安装组件：</span></p> 
<p>npm install xlsx --save<br> npm install --save xlsx file-saver </p> 
<p></p> 
<p><span style="color:#ff9900;">html 代码:</span></p> 
<p>&lt;el-table :data="tableData" id="outExcel"&gt;&lt;/el-table&gt;</p> 
<p></p> 
<p><span style="color:#ffd900;">js 代码:</span></p> 
<p>import * as XLSX from 'xlsx';<br> import FileSaver from 'file-saver'<br>  <br>  <br>     /**导出数据*/<br>     handleOut() {<!-- --><br>  <br> /** 从表生成工作簿对象 out-table是表格的id */<br>           const wb = XLSX.utils.table_to_book(document.querySelector("#outExcel"));<br>           /** 获取二进制字符串作为输出 */<br>           const wbout = XLSX.write(wb, {<!-- --><br>             bookType: "xlsx",<br>             bookSST: true,<br>             type: "array"<br>           });<br>           try {<!-- --><br>             FileSaver.saveAs(<br>               new Blob([wbout], {type: "application/octet-stream"}),<br>               //设置导出文件名称<br>               "文件名称.xlsx"<br>             );<br>           } catch (e) {<!-- --><br>             if (typeof console !== "undefined") console.log(e, wbout);<br>           }<br>           return wbout;<br>  <br> }</p> 
<p></p> 
<p><span style="color:#a2e043;">如果想复用的话可以用下面的封装方法</span></p> 
<p><span style="color:#a2e043;">1、outToExcel.js代码，复制即可使用：</span></p> 
<p>import FileSaver from 'file-saver';<br> import * as XLSX from 'xlsx'<br> export default {<!-- --><br>     // 导出Excel表格<br>     exportExcel(name, tableName) {<!-- --><br>         //name表示生成excel的文件名     tableName表示表格的id<br>         var sel = XLSX.utils.table_to_book(document.querySelector(tableName))<br>         var selIn = XLSX.write(sel, { bookType: 'xlsx', bookSST: true, type: 'array' })<br>         try {<!-- --><br>             FileSaver.saveAs(new Blob([selIn], { type: 'application/octet-stream' }), name)<br>         } catch (e) {<!-- --><br>             if (typeof console !== 'undefined') console.log(e, selIn)<br>         }<br>         return selIn<br>     }<br> };</p> 
<p><span style="color:#38d8f0;">2、main.js里面引入刚刚写好的那个js文件</span></p> 
<p>//全局导出excel<br> import outToexcel（文件名） from 刚刚写好的那个js文件的路径<br> Vue.prototype.outToExcels（取名随意） = outToexcel（文件名）;</p> 
<p><span style="color:#4da8ee;">3、html 代码:</span></p> 
<p>&lt;el-table :data="tableData" id="outExcel"&gt;&lt;/el-table&gt;</p> 
<p><span style="color:#956fe7;">4、methods方法调用:</span></p> 
<p>exportExcel(){<!-- --><br> outToExcels.exportExcel("文件名.xlsx","#outExcel")<br> }</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ec8a1f3034baf501f2c91d8cc9ba9ff7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">关于幸运数字的解答</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/443a09f45638c76bf33c0a1a7339c58a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">hive学习笔记</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>