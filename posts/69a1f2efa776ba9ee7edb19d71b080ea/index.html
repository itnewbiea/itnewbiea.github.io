<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>毕业设计-基于机器视觉的眼底视网膜血管语义分割-U-net - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="毕业设计-基于机器视觉的眼底视网膜血管语义分割-U-net" />
<meta property="og:description" content="目录
前言
课题背景和意义
实现技术思路
一、图像预处理(Image preprocessing)
二、U-net网络模型(U-net network model)
三、实验结果与分析(Experimental results and analysis)
四、总结(Conclusion)
实现效果图样例
最后
前言 📅大四是整个大学期间最忙碌的时光,一边要忙着备考或实习为毕业后面临的就业升学做准备,一边要为毕业设计耗费大量精力。近几年各个学校要求的毕设项目越来越难,有不少课题是研究生级别难度的,对本科同学来说是充满挑战。为帮助大家顺利通过和节省时间与精力投入到更重要的就业和考试中去,学长分享优质的选题经验和毕设项目与技术思路。
🚀对毕设有任何疑问都可以问学长哦!
选题指导: https://blog.csdn.net/qq_37340229/article/details/128243277
大家好,这里是海浪学长毕设专题,本次分享的课题是
🎯毕业设计-基于机器视觉的眼底视网膜血管语义分割-U-net
课题背景和意义 眼底血管与人体健康息息相关，同时也作为医生诊断各 类眼科疾病以及心脑血管疾病的重要依据。眼底视网膜血管 结构特征变化与高血压、动脉硬化等心脑血管疾病有着密切 的联系，医生借助计算机图像处理技术，可以自动获取到眼 底图像中的血管形态。眼底图像血管提取的传统方法有匹配 滤波方法、阈值分割方法、形态学处理方法等。这些方法不 需要训练模型，但是血管分割的精度不够高。基于机器学习 的方法利用人工标记的血管图像来训练模型，以实现血管的 提取，Staal利用KNN(K-Nearest Neighbor)分类器来区分血 管的半径、亮度和边缘强度等特征信息。潘林等[2]为了克服光 照不均、对比度低以及病灶干扰等问题，提出了Gabor小波和 SVM(Support Vector Machines)分类器相结合的方法,利用多 种尺度的Gabor滤波特征和绿色通道灰度信息组成特征向量进 行降维，然后用SVM分类来区分血管。 近年来，卷积神经网络在图像处理领域取得了突破性。
实现技术思路 一、图像预处理(Image preprocessing) 为了下游分割任务更顺利地进行，我们先对图像进行 预处理。文献[3]单通道能够更加清晰地体现眼背景差异。 因此，在实验中将3通道图像按比例转换为灰度图像。原始 图像中血管与背景的对比度较弱，血管边界模糊，眼底图像 对比度较低，不易于人眼分辨。
使用OpenCv库中cv2.createCLAHE(clipLimit, titleGridSize)来实现这一功能。clipLimit是限制对比度阈值， 默认为40，直方图中像素值出现次数大于该阈值，多余的次 数会被重新分配；titleGridSize表示图像进行像素均衡化的网 格大小。经过上述操作后，可弱化眼底图像中的背景，提升 图像中血管区域的灰度，可以更清楚地显示血管结构。效果图如图所示。
二、U-net网络模型(U-net network model) 网络结构
U-net网络结构呈U字形，由卷积和池化单元构成。左 半边为编码器即如传统的分类网络是下采样阶段，右半边为 解码器是上采样阶段，中间的箭头为跳跃连接，将浅层的特 征与深层的特征进行拼接。因为浅层提取到图像的一些简单特征，比如边界、颜色等。
深层经过的卷积操作多抓取到图 像的一些高级抽象特征。跳跃连接将编码器中获得特征信息 引入到对应的解码器中，为上采样提供了更多低层次的空间 与信息。这些低级的信息通常为轮廓和位置等，为后期图像 分割提供多尺度多层次的信息，由此可以得到更精细的分割 效果。U-net的网络结构如图所示。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/69a1f2efa776ba9ee7edb19d71b080ea/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-03T16:00:00+08:00" />
<meta property="article:modified_time" content="2023-04-03T16:00:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">毕业设计-基于机器视觉的眼底视网膜血管语义分割-U-net</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">前言</a></p> 
<p id="%E8%AF%BE%E9%A2%98%E8%83%8C%E6%99%AF%E5%92%8C%E6%84%8F%E4%B9%89-toc" style="margin-left:0px;"><a href="#%E8%AF%BE%E9%A2%98%E8%83%8C%E6%99%AF%E5%92%8C%E6%84%8F%E4%B9%89" rel="nofollow">课题背景和意义</a></p> 
<p id="%E5%AE%9E%E7%8E%B0%E6%8A%80%E6%9C%AF%E6%80%9D%E8%B7%AF-toc" style="margin-left:0px;"><a href="#%E5%AE%9E%E7%8E%B0%E6%8A%80%E6%9C%AF%E6%80%9D%E8%B7%AF" rel="nofollow">实现技术思路</a></p> 
<p id="%E4%B8%80%E3%80%81%E5%9B%BE%E5%83%8F%E9%A2%84%E5%A4%84%E7%90%86(Image%20preprocessing)-toc" style="margin-left:40px;"><a href="#%E4%B8%80%E3%80%81%E5%9B%BE%E5%83%8F%E9%A2%84%E5%A4%84%E7%90%86%28Image%20preprocessing%29" rel="nofollow">一、图像预处理(Image preprocessing)</a></p> 
<p id="%E4%BA%8C%E3%80%81U-net%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B(U-net%20network%20model)-toc" style="margin-left:40px;"><a href="#%E4%BA%8C%E3%80%81U-net%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B%28U-net%20network%20model%29" rel="nofollow">二、U-net网络模型(U-net network model)</a></p> 
<p id="%E4%B8%89%E3%80%81%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C%E4%B8%8E%E5%88%86%E6%9E%90(Experimental%20results%20and%20%C2%A0analysis)-toc" style="margin-left:40px;"><a href="#%E4%B8%89%E3%80%81%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C%E4%B8%8E%E5%88%86%E6%9E%90%28Experimental%20results%20and%20%C2%A0analysis%29" rel="nofollow">三、实验结果与分析(Experimental results and  analysis)</a></p> 
<p id="%E5%9B%9B%E3%80%81%E6%80%BB%E7%BB%93(Conclusion)-toc" style="margin-left:40px;"><a href="#%E5%9B%9B%E3%80%81%E6%80%BB%E7%BB%93%28Conclusion%29" rel="nofollow">四、总结(Conclusion)</a></p> 
<p id="%E5%AE%9E%E7%8E%B0%E6%95%88%E6%9E%9C%E5%9B%BE%E6%A0%B7%E4%BE%8B-toc" style="margin-left:0px;"><a href="#%E5%AE%9E%E7%8E%B0%E6%95%88%E6%9E%9C%E5%9B%BE%E6%A0%B7%E4%BE%8B" rel="nofollow">实现效果图样例</a></p> 
<p id="%E6%9C%80%E5%90%8E-toc" style="margin-left:0px;"><a href="#%E6%9C%80%E5%90%8E" rel="nofollow">最后</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E5%89%8D%E8%A8%80">前言</h2> 
<p><br>     📅大四是整个大学期间最忙碌的时光,一边要忙着备考或实习为毕业后面临的就业升学做准备,一边要为毕业设计耗费大量精力。近几年各个学校要求的毕设项目越来越难,有不少课题是研究生级别难度的,对本科同学来说是充满挑战。为帮助大家顺利通过和节省时间与精力投入到更重要的就业和考试中去,学长分享优质的选题经验和毕设项目与技术思路。</p> 
<p><strong>🚀<u>对毕设有任何疑问都可以问学长哦!</u></strong></p> 
<p><strong><u>选题指导:</u></strong><a href="https://blog.csdn.net/qq_37340229/article/details/128243277" title=" https://blog.csdn.net/qq_37340229/article/details/128243277"> https://blog.csdn.net/qq_37340229/article/details/128243277</a></p> 
<p><strong>大家好,这里是海浪学长毕设专题,本次分享的课题是</strong></p> 
<p>🎯<strong>毕业设计-基于机器视觉的眼底视网膜血管语义分割-U-net</strong></p> 
<h2 id="%E8%AF%BE%E9%A2%98%E8%83%8C%E6%99%AF%E5%92%8C%E6%84%8F%E4%B9%89"><strong>课题背景和意义</strong></h2> 
<p>眼底血管与人体健康息息相关，同时也作为医生诊断各 类眼科疾病以及心脑血管疾病的重要依据。眼底视网膜血管 结构特征变化与高血压、动脉硬化等心脑血管疾病有着密切 的联系，医生借助计算机图像处理技术，可以自动获取到眼 底图像中的血管形态。眼底图像血管提取的传统方法有匹配 滤波方法、阈值分割方法、形态学处理方法等。这些方法不 需要训练模型，但是血管分割的精度不够高。基于机器学习 的方法利用人工标记的血管图像来训练模型，以实现血管的 提取，Staal利用KNN(K-Nearest Neighbor)分类器来区分血 管的半径、亮度和边缘强度等特征信息。潘林等[2]为了克服光 照不均、对比度低以及病灶干扰等问题，提出了Gabor小波和 SVM(Support Vector Machines)分类器相结合的方法,利用多 种尺度的Gabor滤波特征和绿色通道灰度信息组成特征向量进 行降维，然后用SVM分类来区分血管。 近年来，卷积神经网络在图像处理领域取得了突破性。</p> 
<h2 id="%E5%AE%9E%E7%8E%B0%E6%8A%80%E6%9C%AF%E6%80%9D%E8%B7%AF"><strong>实现技术思路</strong></h2> 
<h3 id="%E4%B8%80%E3%80%81%E5%9B%BE%E5%83%8F%E9%A2%84%E5%A4%84%E7%90%86(Image%20preprocessing)">一、图像预处理(Image preprocessing)</h3> 
<p>为了下游分割任务更顺利地进行，我们先对图像进行 预处理。文献[3]单通道能够更加清晰地体现眼背景差异。 因此，在实验中将3通道图像按比例转换为灰度图像。原始 图像中血管与背景的对比度较弱，血管边界模糊，眼底图像 对比度较低，不易于人眼分辨。</p> 
<p>使用OpenCv库中cv2.createCLAHE(clipLimit, titleGridSize)来实现这一功能。clipLimit是限制对比度阈值， 默认为40，直方图中像素值出现次数大于该阈值，多余的次 数会被重新分配；titleGridSize表示图像进行像素均衡化的网 格大小。经过上述操作后，可弱化眼底图像中的背景，提升 图像中血管区域的灰度，可以更清楚地显示血管结构。效果图如图所示。</p> 
<p class="img-center"><img alt="" height="152" src="https://images2.imgbox.com/1d/5b/Wie9cS57_o.png" width="313"></p> 
<h3 id="%E4%BA%8C%E3%80%81U-net%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B(U-net%20network%20model)">二、U-net网络模型(U-net network model)</h3> 
<p><strong>网络结构</strong></p> 
<p>U-net网络结构呈U字形，由卷积和池化单元构成。左 半边为编码器即如传统的分类网络是下采样阶段，右半边为 解码器是上采样阶段，中间的箭头为跳跃连接，将浅层的特 征与深层的特征进行拼接。因为浅层提取到图像的一些简单特征，比如边界、颜色等。</p> 
<p>深层经过的卷积操作多抓取到图 像的一些高级抽象特征。跳跃连接将编码器中获得特征信息 引入到对应的解码器中，为上采样提供了更多低层次的空间 与信息。这些低级的信息通常为轮廓和位置等，为后期图像 分割提供多尺度多层次的信息，由此可以得到更精细的分割 效果。U-net的网络结构如图所示。</p> 
<p class="img-center"><img alt="" height="197" src="https://images2.imgbox.com/11/c5/3rHntCKH_o.png" width="318"></p> 
<p> U-net为Encoder-Decoder结构。在编码器部分，采用五 个卷积模块进行特征提取。每个模块中的卷积层后都紧随批 归一化层，其作用是调整网络中的数据分布，防止出现数据 的“协变量漂移问题”，防止过度拟合。每个模块中的卷积 层中卷积核的个数分别为32、64、128、256、512。</p> 
<p>池化层用 于对特征进行降维，在保持通道不变的情况下，将尺寸缩小 为输入特征的一半。经过编码器后，得到输入图像的高级特 征向量，将特征向量传入到解码器中。编码器部分采用ReLU 函数。</p> 
<p><strong>U-net改进</strong></p> 
<p>U-net中使用的激活函数为ReLU函数，ReLU函数定义 为y=max(0,x)，对于所有正值，ReLU是线性的,对于所有负 值，经过ReLU计算后是0。由于没有复杂的数学运算，收敛 更快，模型可以花费更少的时间训练。<span style="color:#000000;">Leaky ReLU函数图像如图所示。</span></p> 
<p class="img-center"><img alt="" height="157" src="https://images2.imgbox.com/88/a1/MZqH0Ajw_o.png" width="341"></p> 
<p><strong>模型优化器选择</strong></p> 
<p>算法模型需要选择合适的优化器进行参数的学习来使损 失函数不断减小。现有的U-net分割模型使用的是随机梯度下 降法(Stochastic Gradient Descent, SGD),梯度通过每一次 的迭代下降来更新网络中的参数。但是SGD的缺点是难以选 择合适的学习率，并且容易收敛到局部最优点。 为了解决上述问题，使用Adam优化器替代SGD 来进行模型参数权重的更新。<span style="color:#000000;">如式所示：</span></p> 
<p class="img-center"><img alt="" height="119" src="https://images2.imgbox.com/59/ac/VjsVcywx_o.png" width="149"></p> 
<p><strong>评价指标</strong></p> 
<p>语义分割通常使用平均交并比这个指标来评估语义分割 算法的性能。交并比(Intersection over Union, IoU)表示的 含义是模型对某一类别预测结果和真实值的交集与并集的比 值。IoU的计算公式如下：</p> 
<p class="img-center"><img alt="" height="25" src="https://images2.imgbox.com/f7/3f/RAQ76Iyt_o.png" width="153"></p> 
<p> <span style="color:#000000;">式中，</span><span style="color:#000000;"><em>TP</em></span><span style="color:#000000;">表示正确识别为正类的像素个数；</span><span style="color:#000000;"><em>FP</em>表示错误识别为正类的像素个数；FN表示错误识别为负类的像素个数。然 后重复计算其他类别的IoU，再计算它们的平均数，计算公式 如下：</span></p> 
<p class="img-center"><img alt="" height="64" src="https://images2.imgbox.com/fd/7e/AxyeMqCr_o.png" width="222"></p> 
<p> 式中，k表示类别，k+1表示加上了背景类，i表示真实值，j表 示预测值， 表示将i预测为j，为假负(FN)； 将j预测为i，为 假正(FP)； 将i预测为i，为真正(TP)。因此可以等价于式。</p> 
<p class="img-center"><img alt="" height="45" src="https://images2.imgbox.com/f9/71/hoIFaPud_o.png" width="185"></p> 
<h3 id="%E4%B8%89%E3%80%81%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C%E4%B8%8E%E5%88%86%E6%9E%90(Experimental%20results%20and%20%C2%A0analysis)">三、实验结果与分析(Experimental results and  analysis)</h3> 
<p><strong>实验环境</strong></p> 
<p>眼底血管分割程序运行环境为Ubuntu 18.04,使用 Pytorch作为深度学习框架，VsCode作为程序编辑器；硬 件平台为AMD Ryzen 16核CPU,主频3.6 GHz,显卡是4 张 GeForce RTX 2080Ti，每张卡显存为12 GB。</p> 
<p><strong>数据集制作</strong></p> 
<p>眼底图像数据分别选取开源数据集CHASE和DRIVE数据 集进行实验，从两个数据集中分别选取100 对左右眼共计400  幅图像。然后统一将大图分割为256×256的小块，一是为了 增加数据量，二是通过裁减而不是采样的方式可以保留原图 的细节特征。最终获得1,600 幅图像。再按照8:2将上述图像 划分为训练集和测试集。</p> 
<p><strong>实验结果分析</strong></p> 
<p>设置batch_size=4,初始学习率取0.001。同时为了防止过 拟合，本文采用L2正则化，将权重衰减稀疏设置为0.0001。 然后训练本文算法模型，训练过程中的损失函数变化情况如 图4所示。由图4显示的训练过程迭代次数损失曲线发现，训 练迭代3万次后，损失值基本围绕0.15进行上下波动，随着迭 代次数的增加，波动减小，损失值趋于稳定。</p> 
<p class="img-center"><img alt="" height="203" src="https://images2.imgbox.com/b2/12/rEZhYhHn_o.png" width="253"></p> 
<p> 为了验证本文提出的算法在眼底血管分割上是否具有优 势，实验选取了与FCN及U-net算法进行对比。表1中给出了 本文算法与其他算法的分割效果对比。</p> 
<p class="img-center"><img alt="" height="94" src="https://images2.imgbox.com/b7/af/5zgepG2G_o.png" width="343"></p> 
<p>采用改进的U-net算法模型表现相对较 好，在原始U-net网络进行低级语义信息和高级语义信息融合 阶段，使用Leaky ReLU函数有效避免了神经元趋于“坏死” 的问题，改善了算法模型的稀疏性，从而在训练集和测试集 上MIoU值均有一定的提升，获取了更好的语义分割结果。另 外，从实验结果看，U-net算法分割的MIoU值远高于FCN算 法，可见U型网络[8]结构更适用于医疗图像的分割任务。</p> 
<p>因为训练前将图像分割成许多块，所以在模型预测 完成后需要将预测结果进行合并，获取完整的推理图像， 然后与label进行比较。拼接后的分割结果如图所示，图(a)、图(b)、图(c)、图(d)依次是原图、预处理图、标 记图和预测图。</p> 
<p class="img-center"><img alt="" height="320" src="https://images2.imgbox.com/3b/2c/bKrl8cVT_o.png" width="303"></p> 
<h3 id="%E5%9B%9B%E3%80%81%E6%80%BB%E7%BB%93(Conclusion)">四、总结(Conclusion)</h3> 
<p>基于U-net图像分割算法，对于眼底图像中的血管 进行提取。首先，从两种开源的数据集中选取数据制作数据 集，其目的是丰富数据集的多样性，提高模型的泛化能力。 然后，针对U-net特征提取层中ReLU函数在模型训练时可能 存在的“神经元坏死”的情况，使用Leaky ReLU替代ReLU 函数，保留了特征中的负值信息，可以让模型学习到更多的 细节信息。</p> 
<h2 id="%E5%AE%9E%E7%8E%B0%E6%95%88%E6%9E%9C%E5%9B%BE%E6%A0%B7%E4%BE%8B">实现效果图样例</h2> 
<p>眼底视网膜血管语义分割：</p> 
<p class="img-center"><img alt="" height="264" src="https://images2.imgbox.com/23/75/qJcZwvVE_o.png" width="532"></p> 
<p><strong>我是海浪学长,创作不易,欢迎点赞、关注、收藏、留言。</strong></p> 
<p><strong>毕设帮助，疑难解答，欢迎打扰！</strong></p> 
<h2 id="%E6%9C%80%E5%90%8E">最后</h2>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b22ab45b0c994c309c5eda81bc1148b5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[yolox优化] 提升ap</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ceefe8ca0e65d966f98f8edf778b0b2e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">如何快速实现供应商管理信息化（SRM供应商管理怎么做）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>