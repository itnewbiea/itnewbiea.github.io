<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在maya中如何修正相机的枢轴点的变化导致相机动画导入引擎后不正确的问题 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="在maya中如何修正相机的枢轴点的变化导致相机动画导入引擎后不正确的问题" />
<meta property="og:description" content="前言 最近工作中经常遇到外包回来的相机的枢轴点变化,甚至所有值归零后枢轴点也不在世界中心的情况,这种相机动画导入引擎就会出现和maya中相机对不上的情况,这里记录一下解决方法.
过程 基本思路就是计算出原有相机中心点的世界坐标位置,然后用一个新相机继承原有相机的动画,最后烘焙关键帧即可.
打开maya的节点编辑器,将原相机和新相机显示在图表上
首先我们忽略相机的旋转,我这里用一个球体代替,在节点编辑器中Transform节点给我们提供了Rotate Pivot但是,这个枢轴点是局部空间的(即:相机中心到枢轴点的向量),好在Transform节点也为我们提供了用于将局部空间变换为世界空间的矩阵,这里我们用节点PointMatrixMult(这个节点可能需要开启插件matrixNodes.mll才能找到),把这个局部坐标和世界变换矩阵相乘,即可得到枢轴点的世界空间坐标. 这样我们就找到了相机枢轴点的世界空间坐标,.因为我们之前说过相机的局部空间坐标是相机中心位置到相机枢轴点之间的向量,此时用相机枢轴点的坐标减去这个向量就可以得到,这里我们使用节点PlusMinusAverage并将Operation调整为Subtract来计算点和向量之间的减法.
可以看到此时小球已经和相机的中心点重合了,但需要注意此时我们的相机是不带旋转值的,如果我们此时对相机进行旋转,可以看到,相机的中心点在旋转后产生了位移. 这时,我们可以利用一个向量来帮助我们计算相机旋转后的中心点的位置,即相机在不旋转时,枢轴点指向相机中心点的向量,然后我们旋转这个向量,再使用相机枢轴点的坐标加上旋转后的向量即可得到相机旋转后中心点的位置.继续使用PlusMinusAverage来计算枢轴点指向相机中心点的向量,使用ComposeMatrix节点创建旋转矩阵,再次使用PointMatrixMult来计算旋转后的向量 需要注意的这次的PointMatrixMult需要勾选Vector Muitiply(不过目前的情况不勾选也没影响),这样我们就得到了旋转后枢轴点指向相机中心点的向量,最后用枢轴点的坐标加上这个向量即可同时还需要将老相机的旋转值传递给新相机." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/bac8ec9623fc0ee52df42e2a5ccfc802/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-16T18:45:05+08:00" />
<meta property="article:modified_time" content="2023-01-16T18:45:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在maya中如何修正相机的枢轴点的变化导致相机动画导入引擎后不正确的问题</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_1"></a>前言</h3> 
<p>最近工作中经常遇到外包回来的相机的枢轴点变化,甚至所有值归零后枢轴点也不在世界中心的情况,这种相机动画导入引擎就会出现和maya中相机对不上的情况,这里记录一下解决方法.</p> 
<h3><a id="_3"></a>过程</h3> 
<p>基本思路就是计算出原有相机中心点的世界坐标位置,然后用一个新相机继承原有相机的动画,最后烘焙关键帧即可.</p> 
<ul><li>打开maya的节点编辑器,将原相机和新相机显示在图表上<br> <img src="https://images2.imgbox.com/79/ce/1YFdakmW_o.png" alt="在这里插入图片描述"></li><li>首先我们忽略相机的旋转,我这里用一个球体代替,在节点编辑器中Transform节点给我们提供了Rotate Pivot但是,这个枢轴点是局部空间的(即:相机中心到枢轴点的向量),好在Transform节点也为我们提供了用于将局部空间变换为世界空间的矩阵,这里我们用节点PointMatrixMult(这个节点可能需要开启插件matrixNodes.mll才能找到),把这个局部坐标和世界变换矩阵相乘,即可得到枢轴点的世界空间坐标.</li></ul> 
<p><img src="https://images2.imgbox.com/83/d8/TG8LbEGI_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6c/4c/iZuTFLOm_o.png" alt="在这里插入图片描述"></p> 
<ul><li>这样我们就找到了相机枢轴点的世界空间坐标,.因为我们之前说过相机的局部空间坐标是相机中心位置到相机枢轴点之间的向量,此时用相机枢轴点的坐标减去这个向量就可以得到,这里我们使用节点PlusMinusAverage并将Operation调整为Subtract来计算点和向量之间的减法.<br> <img src="https://images2.imgbox.com/4e/14/3RhgYouz_o.png" alt="在这里插入图片描述"></li></ul> 
<p><img src="https://images2.imgbox.com/3e/27/wzhnorLN_o.png" alt="在这里插入图片描述"></p> 
<ul><li>可以看到此时小球已经和相机的中心点重合了,但需要注意此时我们的相机是不带旋转值的,如果我们此时对相机进行旋转,可以看到,相机的中心点在旋转后产生了位移.</li></ul> 
<p><img src="https://images2.imgbox.com/26/87/aFTBzZg2_o.png" alt="在这里插入图片描述"></p> 
<ul><li>这时,我们可以利用一个向量来帮助我们计算相机旋转后的中心点的位置,即相机在不旋转时,枢轴点指向相机中心点的向量,然后我们旋转这个向量,再使用相机枢轴点的坐标加上旋转后的向量即可得到相机旋转后中心点的位置.继续使用PlusMinusAverage来计算枢轴点指向相机中心点的向量,使用ComposeMatrix节点创建旋转矩阵,再次使用PointMatrixMult来计算旋转后的向量</li></ul> 
<p><img src="https://images2.imgbox.com/23/36/pnRhwxFE_o.png" alt="在这里插入图片描述"></p> 
<ul><li>需要注意的这次的PointMatrixMult需要勾选Vector Muitiply(不过目前的情况不勾选也没影响),这样我们就得到了旋转后枢轴点指向相机中心点的向量,最后用枢轴点的坐标加上这个向量即可同时还需要将老相机的旋转值传递给新相机.<br> <img src="https://images2.imgbox.com/17/33/Frv9PDHI_o.png" alt="在这里插入图片描述"></li></ul> 
<p><img src="https://images2.imgbox.com/9c/92/ZkLa3gpR_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b145bfa48b1a33cf00f082792df78d20/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Centernet算法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bf97a50bcd16c13b986310fd6aec82c3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">k8s之挂载本地磁盘到POD中</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>