<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQL多列合并成一列 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SQL多列合并成一列" />
<meta property="og:description" content="一、拼接多列数据的基本概念 在SQL中，拼接多个列数据成为一列数据是很常见的问题。要将多列合并成一列，在SQL语言中需要使用concat函数。concat函数可以将多个字符串拼接成为一个字符串输出。concat函数的格式为concat(string1,string2,...)。
其中，string1，string2，…为需要拼接的字符串。concat函数将按照所填写的参数顺序，将各个参数字符串按照顺序拼接成为一个大字符串。例如，若输入concat(‘Hello’,‘World’)，那么输出为HelloWorld。
SELECT CONCAT(‘Hello’, ‘World’); 二、使用concat函数拼接多列数据 在SQL语言中，如果需要将多列数据合并为一列数据，只需要将多个列名称作为参数填入concat函数中即可。以下是一个简单的示例：
SELECT CONCAT(First_Name,‘ ’,Last_Name) AS Name FROM Employees; 以上代码将First_Name和Last_Name两列数据用空格隔开并拼接成为一列标记为Name的新数据列。此时，新的数据列Name的每一行数据均为拼接后的数据。如果想要添加分隔符，可以在需要添加分隔符的参数中加入分隔符：
SELECT CONCAT(First_Name,‘-’,Last_Name) AS Name FROM Employees; 三、使用concat_ws函数拼接多列数据 SQL还提供了一个特殊的函数——concat_ws。与普通的concat函数不同的是，concat_ws函数可以使用指定的分隔符拼接多个参数，并在输出值中使用该分隔符分割。以下是一个简单的示例：
SELECT CONCAT_WS(&#39; &#39;,First_Name,Last_Name) AS Name FROM Employees; 以上代码将使用空格作为分隔符，将First_Name和Last_Name两列数据拼接成为一个新的数据列Name。新的数据列中各行的名称均由空格隔开。
四、使用CASE函数拼接多列数据 除了concat函数和concat_ws函数以外，SQL还提供了一种更为灵活的拼接多个数据列的方式——使用CASE函数。
CASE函数可以帮助我们为每一行数据自定义生成一个新的数据列。如果需要将多列数据中的一个或多个列拼接起来，可以使用CASE函数将数据列进行分组，然后使用concat函数或concat_ws函数将分组后的数据列拼接成一个新的数据列。以下是使用CASE函数拼接多列数据的示例：
SELECT CASE WHEN Gender = &#39;M&#39; THEN CONCAT_WS(&#39; &#39;, First_Name, Middle_Initial, Last_Name) ELSE CONCAT_WS(&#39; &#39;, Last_Name, First_Name, Middle_Initial) END AS FullName FROM Employees; 以上代码用于在Employees表中生成一个FullName数据列。如果Gender列的值为M，那么FullName数据列将包含First_Name、Middle_Initial和Last_​​Name三个数据列用空格拼接而成的字符串；如果Gender列的值不是M，那么FullName数据列将包含Last_Name、First_Name和Middle_Initial三个数据列用空格拼接而成的字符串。
五、使用COALESCE函数拼接多列数据 在使用上述的拼接函数时，如果有某个列的值为NULL，那么会导致整个拼接字符串的输出结果也为NULL。如果想要避免这种情况，可以使用COALESCE函数。
COALESCE函数可以将参数列表中的第一个非NULL值返回。以下是一个简单的示例：
SELECT COALESCE(NULL, ‘Hello’, ‘World’); 以上代码将输出Hello。
在使用COALESCE函数拼接多列数据时，如果某些列的值为空，则可以通过使用COALESCE函数，将空值替换为默认值。以下是一个使用COALESCE函数拼接多列数据的示例：
SELECT CONCAT_WS(&#39; &#39;, COALESCE(First_Name,&#39;&#39;), COALESCE(Middle_Initial,&#39;&#39;), COALESCE(Last_Name,&#39;&#39;)) AS FullName FROM Employees; 以上代码将使用空值替换任何为NULL的列值，并将FirstName、Middle_Initial和Last_​​Name三列数据用空格隔开，并拼接成一个称为FullName的新数据列。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/ab5543fbb97eb798de1e33394c5eac6d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-29T15:20:33+08:00" />
<meta property="article:modified_time" content="2023-06-29T15:20:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQL多列合并成一列</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <div class="content-body"> 
</div> 
<h3 id="title-1">一、拼接多列数据的基本概念</h3> 
<p>在SQL中，拼接多个列数据成为一列数据是很常见的问题。要将多列合并成一列，在SQL语言中需要使用concat函数。concat函数可以将多个字符串拼接成为一个字符串输出。concat函数的格式为concat(string1,string2,...)。</p> 
<p>其中，string1，string2，…为需要拼接的字符串。concat函数将按照所填写的参数顺序，将各个参数字符串按照顺序拼接成为一个大字符串。例如，若输入concat(‘Hello’,‘World’)，那么输出为HelloWorld。</p> 
<pre><code>SELECT CONCAT(‘Hello’, ‘World’);
</code></pre> 
<h3 id="title-2">二、使用concat函数拼接多列数据</h3> 
<p>在SQL语言中，如果需要将多列数据合并为一列数据，只需要将多个列名称作为参数填入concat函数中即可。以下是一个简单的示例：</p> 
<pre><code>SELECT CONCAT(First_Name,‘ ’,Last_Name) AS Name FROM Employees;
</code></pre> 
<p>以上代码将First_Name和Last_Name两列数据用空格隔开并拼接成为一列标记为Name的新数据列。此时，新的数据列Name的每一行数据均为拼接后的数据。如果想要添加分隔符，可以在需要添加分隔符的参数中加入分隔符：</p> 
<pre><code>SELECT CONCAT(First_Name,‘-’,Last_Name) AS Name FROM Employees;
</code></pre> 
<h3 id="title-3">三、使用concat_ws函数拼接多列数据</h3> 
<p>SQL还提供了一个特殊的函数——concat_ws。与普通的concat函数不同的是，concat_ws函数可以使用指定的分隔符拼接多个参数，并在输出值中使用该分隔符分割。以下是一个简单的示例：</p> 
<pre><code>SELECT CONCAT_WS(' ',First_Name,Last_Name) AS Name FROM Employees;
</code></pre> 
<p>以上代码将使用空格作为分隔符，将First_Name和Last_Name两列数据拼接成为一个新的数据列Name。新的数据列中各行的名称均由空格隔开。</p> 
<h3 id="title-4">四、使用CASE函数拼接多列数据</h3> 
<p>除了concat函数和concat_ws函数以外，SQL还提供了一种更为灵活的拼接多个数据列的方式——使用CASE函数。</p> 
<p>CASE函数可以帮助我们为每一行数据自定义生成一个新的数据列。如果需要将多列数据中的一个或多个列拼接起来，可以使用CASE函数将数据列进行分组，然后使用concat函数或concat_ws函数将分组后的数据列拼接成一个新的数据列。以下是使用CASE函数拼接多列数据的示例：</p> 
<pre><code>SELECT
    CASE
        WHEN Gender = 'M' THEN CONCAT_WS(' ', First_Name, Middle_Initial, Last_Name)
        ELSE CONCAT_WS(' ', Last_Name, First_Name, Middle_Initial)
    END AS FullName
FROM
    Employees;
</code></pre> 
<p>以上代码用于在Employees表中生成一个FullName数据列。如果Gender列的值为M，那么FullName数据列将包含First_Name、Middle_Initial和Last_​​Name三个数据列用空格拼接而成的字符串；如果Gender列的值不是M，那么FullName数据列将包含Last_Name、First_Name和Middle_Initial三个数据列用空格拼接而成的字符串。</p> 
<h3 id="title-5">五、使用COALESCE函数拼接多列数据</h3> 
<p>在使用上述的拼接函数时，如果有某个列的值为NULL，那么会导致整个拼接字符串的输出结果也为NULL。如果想要避免这种情况，可以使用COALESCE函数。</p> 
<p>COALESCE函数可以将参数列表中的第一个非NULL值返回。以下是一个简单的示例：</p> 
<pre><code>SELECT COALESCE(NULL, ‘Hello’, ‘World’);
</code></pre> 
<p>以上代码将输出Hello。</p> 
<p>在使用COALESCE函数拼接多列数据时，如果某些列的值为空，则可以通过使用COALESCE函数，将空值替换为默认值。以下是一个使用COALESCE函数拼接多列数据的示例：</p> 
<pre><code>SELECT CONCAT_WS(' ', COALESCE(First_Name,''), COALESCE(Middle_Initial,''), COALESCE(Last_Name,'')) AS FullName FROM Employees;
</code></pre> 
<p>以上代码将使用空值替换任何为NULL的列值，并将FirstName、Middle_Initial和Last_​​Name三列数据用空格隔开，并拼接成一个称为FullName的新数据列。</p> 
<h3 id="title-6">六、总结</h3> 
<p>在SQL中，拼接多个数据列成为一列是很常见的需求，在SQL中有很多函数可以实现这个需求，例如concat、concat_ws、case和coalesce等函数。在使用这些函数时，需要注意空值的处理，以及要拼接的字符串的格式和分隔符。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/663b92e67090e41662262b993c9e1804/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">img标签上title与alt属性的区别是什么？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/293b636e6447d8a6e5c8a3015be2a9f1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">PolicyGradient算法玩CartPole和MountainCar代码Pytorch版本</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>