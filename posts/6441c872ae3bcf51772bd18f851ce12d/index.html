<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【ThreeJs】如何给模型打上文字标签？ - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【ThreeJs】如何给模型打上文字标签？" />
<meta property="og:description" content="一、概述 ThreeJs渲染中创建的网格模型，有时候我们需要给模型添加标签文字，方便识别不同的物体。
这时候我们可以使用CSS3DRenderer、CSS2DRenderer这两个库，里面提供了三种打标签的方式，随着相机角度的变化，三种标签的显示效果各不相同。
三种标签分别是： CSS 2DObject、CSS 3DObject 标签、CSS 3DSprite 标签
二、效果预览 1、角度不同 下面是从不同角度看同一组模型时的显示效果：
2、距离不同 这是前后两组模型的显示效果：
3、区别简述 可以看到，CSS 2DObject、CSS 3DSprite都可以让标签永远正对当前相机视角。不同的是，CSS 2DObject标签的尺寸不会受远近影响；CSS 3DSprite标签的尺寸受远近影响，远小近大；
CSS 3DObject 标签朝向固定，不会随视角变化而改变，就仿佛是创建的模型对象，但实际这三种标签都是使用html&#43;css来实现的，并且CSS 3DObject标签的大小也会受远近影响，远小近大。
三、代码实现 tag2D.js【创建CSS2DObject】 import { CSS2DRenderer, CSS2DObject } from &#39;three/examples/jsm/renderers/CSS2DRenderer.js&#39;; // 创建一个HTML标签 function tag(name) { // 创建div元素(作为标签) var div = document.createElement(&#39;div&#39;); div.innerHTML = name; div.classList.add(&#39;tag&#39;); //div元素包装为CSS2模型对象CSS2DObject var label = new CSS2DObject(div); div.style.pointerEvents = &#39;none&#39;;//避免HTML标签遮挡三维场景的鼠标事件 // 设置HTML元素标签在three.js世界坐标中位置 // label.position.set(x, y, z); return label;//返回CSS2模型标签 } // 创建一个CSS2渲染器CSS2DRenderer function labelRenderer(container) { var labelRenderer = new CSS2DRenderer(); labelRenderer." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/6441c872ae3bcf51772bd18f851ce12d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-11T23:30:02+08:00" />
<meta property="article:modified_time" content="2023-03-11T23:30:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【ThreeJs】如何给模型打上文字标签？</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>一、概述</h2> 
<p>ThreeJs渲染中创建的网格模型，有时候我们需要给模型添加标签文字，方便识别不同的物体。<br> 这时候我们可以使用<code>CSS3DRenderer</code>、<code>CSS2DRenderer</code>这两个库，里面提供了三种打标签的方式，随着相机角度的变化，三种标签的显示效果各不相同。<br> <strong>三种标签分别是： CSS 2DObject、CSS 3DObject 标签、CSS 3DSprite 标签</strong></p> 
<h2><a id="_4"></a>二、效果预览</h2> 
<h3><a id="1_5"></a>1、角度不同</h3> 
<p>下面是从不同角度看同一组模型时的显示效果：<br> <img src="https://images2.imgbox.com/12/bc/aCgEW3a4_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_8"></a>2、距离不同</h3> 
<p>这是前后两组模型的显示效果：<br> <img src="https://images2.imgbox.com/39/ca/soEKAZYO_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3_11"></a>3、区别简述</h3> 
<p>可以看到，<code>CSS 2DObject</code>、<code>CSS 3DSprite</code>都可以让标签永远正对当前相机视角。不同的是，<code>CSS 2DObject</code>标签的尺寸不会受远近影响；<code>CSS 3DSprite</code>标签的尺寸受远近影响，远小近大；<br> <code>CSS 3DObject</code> 标签朝向固定，不会随视角变化而改变，就仿佛是创建的模型对象，<strong>但实际这三种标签都是使用<code>html+css</code>来实现的</strong>，并且<code>CSS 3DObject</code>标签的大小也会受远近影响，远小近大。</p> 
<h2><a id="_15"></a>三、代码实现</h2> 
<h3><a id="tag2DjsCSS2DObject_16"></a>tag2D.js【创建CSS2DObject】</h3> 
<pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> CSS2DRenderer<span class="token punctuation">,</span> CSS2DObject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'three/examples/jsm/renderers/CSS2DRenderer.js'</span><span class="token punctuation">;</span>
<span class="token comment">// 创建一个HTML标签</span>
<span class="token keyword">function</span> <span class="token function">tag</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建div元素(作为标签)</span>
  <span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> name<span class="token punctuation">;</span>
  div<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'tag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//div元素包装为CSS2模型对象CSS2DObject</span>
  <span class="token keyword">var</span> label <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CSS2DObject</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
  div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>pointerEvents <span class="token operator">=</span> <span class="token string">'none'</span><span class="token punctuation">;</span><span class="token comment">//避免HTML标签遮挡三维场景的鼠标事件</span>
  <span class="token comment">// 设置HTML元素标签在three.js世界坐标中位置</span>
  <span class="token comment">// label.position.set(x, y, z);</span>
  <span class="token keyword">return</span> label<span class="token punctuation">;</span><span class="token comment">//返回CSS2模型标签      </span>
<span class="token punctuation">}</span>

<span class="token comment">// 创建一个CSS2渲染器CSS2DRenderer</span>
<span class="token keyword">function</span> <span class="token function">labelRenderer</span><span class="token punctuation">(</span><span class="token parameter">container</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">var</span> labelRenderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CSS2DRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  labelRenderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">,</span> container<span class="token punctuation">.</span>offsetHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
  labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">'absolute'</span><span class="token punctuation">;</span>
  <span class="token comment">// 相对标签原位置位置偏移大小</span>
  labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'0px'</span><span class="token punctuation">;</span>
  labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token string">'0px'</span><span class="token punctuation">;</span>
  <span class="token comment">// //设置.pointerEvents=none，以免模型标签HTML元素遮挡鼠标选择场景模型</span>
  labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>pointerEvents <span class="token operator">=</span> <span class="token string">'none'</span><span class="token punctuation">;</span>
  container<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> labelRenderer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token punctuation">{<!-- --></span> tag<span class="token punctuation">,</span> labelRenderer <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="tag3DjsCSS3DObject_CSS3DSprite_49"></a>tag3D.js【创建CSS3DObject ,CSS3DSprite】</h3> 
<pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> CSS3DRenderer<span class="token punctuation">,</span> CSS3DObject <span class="token punctuation">,</span>CSS3DSprite<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'three/examples/jsm/renderers/CSS3DRenderer.js'</span><span class="token punctuation">;</span>
<span class="token comment">// 创建一个HTML标签</span>
<span class="token keyword">function</span> <span class="token function">tag3D</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建div元素(作为标签)</span>
  <span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> name<span class="token punctuation">;</span>
  div<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'tag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//div元素包装为CSS3模型对象CSS3DObject</span>
  <span class="token keyword">var</span> label <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CSS3DObject</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
  div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>pointerEvents <span class="token operator">=</span> <span class="token string">'none'</span><span class="token punctuation">;</span><span class="token comment">//避免HTML标签遮挡三维场景的鼠标事件</span>
  <span class="token comment">// 设置HTML元素标签在three.js世界坐标中位置</span>
  <span class="token comment">// label.position.set(x, y, z);</span>
  <span class="token comment">//缩放CSS3DObject模型对象</span>
  label<span class="token punctuation">.</span>scale<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//根据相机渲染范围控制HTML 3D标签尺寸</span>
  label<span class="token punctuation">.</span><span class="token function">rotateY</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//控制HTML标签CSS3对象姿态角度</span>
  <span class="token comment">// label.rotateX(-Math.PI/2);</span>
  <span class="token keyword">return</span> label<span class="token punctuation">;</span><span class="token comment">//返回CSS3模型标签    </span>
<span class="token punctuation">}</span>

<span class="token comment">// 创建一个HTML标签</span>
<span class="token keyword">function</span> <span class="token function">tag3DSprite</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建div元素(作为标签)</span>
  <span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> name<span class="token punctuation">;</span>
  div<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'tag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//div元素包装为CSS3模型对象CSS3DSprite</span>
  <span class="token keyword">var</span> label <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CSS3DSprite</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
  div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>pointerEvents <span class="token operator">=</span> <span class="token string">'none'</span><span class="token punctuation">;</span><span class="token comment">//避免HTML标签遮挡三维场景的鼠标事件</span>
  <span class="token comment">// 设置HTML元素标签在three.js世界坐标中位置</span>
  <span class="token comment">// label.position.set(x, y, z);</span>
  <span class="token comment">//缩放CSS3DSprite模型对象</span>
  label<span class="token punctuation">.</span>scale<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//根据相机渲染范围控制HTML 3D标签尺寸</span>
  label<span class="token punctuation">.</span><span class="token function">rotateY</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//控制HTML标签CSS3对象姿态角度</span>
  <span class="token comment">// label.rotateX(-Math.PI/2);</span>
  <span class="token keyword">return</span> label<span class="token punctuation">;</span><span class="token comment">//返回CSS3模型标签    </span>
<span class="token punctuation">}</span>

<span class="token comment">// 创建一个CSS2渲染器CSS2DRenderer</span>
<span class="token keyword">function</span> <span class="token function">labelRenderer</span><span class="token punctuation">(</span><span class="token parameter">container</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">var</span> labelRenderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CSS3DRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  labelRenderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">,</span> container<span class="token punctuation">.</span>offsetHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
  labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">'absolute'</span><span class="token punctuation">;</span>
  <span class="token comment">// 相对标签原位置位置偏移大小</span>
  labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'0px'</span><span class="token punctuation">;</span>
  labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token string">'0px'</span><span class="token punctuation">;</span>
  <span class="token comment">// //设置.pointerEvents=none，以免模型标签HTML元素遮挡鼠标选择场景模型</span>
  labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>pointerEvents <span class="token operator">=</span> <span class="token string">'none'</span><span class="token punctuation">;</span>
  container<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> labelRenderer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token punctuation">{<!-- --></span> tag3D<span class="token punctuation">,</span> tag3DSprite<span class="token punctuation">,</span> labelRenderer <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="Boxts_104"></a>Box.ts【创建模型+标签】</h3> 
<pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">THREE</span> <span class="token keyword">from</span> <span class="token string">"three"</span>
<span class="token keyword">import</span> initRenderer <span class="token keyword">from</span> <span class="token string">"./core/renderer"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> model <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./core/model"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> initScene <span class="token keyword">from</span> <span class="token string">"./core/scene"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> labelRenderer <span class="token keyword">as</span> labelRenderer2D<span class="token punctuation">,</span> tag <span class="token keyword">as</span> tag2D <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./core/tag2D"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> labelRenderer <span class="token keyword">as</span> labelRenderer3D<span class="token punctuation">,</span> tag3D<span class="token punctuation">,</span> tag3DSprite <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./core/tag3D"</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Box</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> scene<span class="token punctuation">;</span>
    <span class="token keyword">private</span> camera<span class="token punctuation">;</span>
    <span class="token keyword">private</span> renderer<span class="token punctuation">;</span>
    <span class="token keyword">private</span> container<span class="token punctuation">;</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">container</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>container <span class="token operator">=</span> container<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 初始化渲染器和相机</span>
        <span class="token keyword">let</span> <span class="token punctuation">{<!-- --></span> renderer<span class="token punctuation">,</span> camera<span class="token punctuation">,</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">initRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">scene</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">,</span> <span class="token literal-property property">container</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">,</span> <span class="token literal-property property">labelRenderer2D</span><span class="token operator">:</span> <span class="token function">labelRenderer2D</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">labelRenderer3D</span><span class="token operator">:</span> <span class="token function">labelRenderer3D</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>renderer <span class="token operator">=</span> renderer<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>camera <span class="token operator">=</span> camera<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">setClearColor</span><span class="token punctuation">(</span><span class="token string">"black"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 初始化场景</span>
        <span class="token function">initScene</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">scene</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">,</span> <span class="token literal-property property">container</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">,</span> <span class="token literal-property property">renderer</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">,</span> <span class="token literal-property property">camera</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>camera <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//初始化模型</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initObjects</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 开始渲染</span>
        <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//绘制</span>
    <span class="token function">initObjects</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> box <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshLambertMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x0000ff</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token comment">// --------------------模型1</span>
        <span class="token keyword">const</span> mesh1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>box<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mesh1<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
        mesh1<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
        box<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh1<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 添加CSS 2DObject标签</span>
        <span class="token keyword">var</span> label2D <span class="token operator">=</span> <span class="token function">tag2D</span><span class="token punctuation">(</span><span class="token string">"CSS 2DObject 标签"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置标签名称</span>
        <span class="token keyword">var</span> pos1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mesh1<span class="token punctuation">.</span><span class="token function">getWorldPosition</span><span class="token punctuation">(</span>pos1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取obj世界坐标、</span>
        pos1<span class="token punctuation">.</span>y <span class="token operator">+=</span> <span class="token number">30</span><span class="token punctuation">;</span>
        label2D<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>pos1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//标签标注在obj世界坐标</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>label2D<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//标签插入场景 </span>

        <span class="token comment">// --------------------模型2</span>
        <span class="token keyword">const</span> mesh2 <span class="token operator">=</span> mesh1<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mesh2<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 添加CSS 3DObject标签</span>
        <span class="token keyword">var</span> label3D <span class="token operator">=</span> <span class="token function">tag3D</span><span class="token punctuation">(</span><span class="token string">"CSS 3DObject 标签"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置标签名称</span>
        <span class="token keyword">var</span> pos2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mesh2<span class="token punctuation">.</span><span class="token function">getWorldPosition</span><span class="token punctuation">(</span>pos2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取obj世界坐标、</span>
        pos2<span class="token punctuation">.</span>y <span class="token operator">+=</span> <span class="token number">30</span><span class="token punctuation">;</span>
        label3D<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>pos2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//标签标注在obj世界坐标</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>label3D<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//标签插入场景 </span>

        <span class="token comment">// --------------------模型3</span>
        <span class="token keyword">const</span> mesh3 <span class="token operator">=</span> mesh1<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mesh3<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh3<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 添加CSS 3DSprite标签</span>
        <span class="token keyword">var</span> label3DSprite <span class="token operator">=</span> <span class="token function">tag3DSprite</span><span class="token punctuation">(</span><span class="token string">"CSS 3DSprite 标签"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置标签名称</span>
        <span class="token keyword">var</span> pos3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mesh3<span class="token punctuation">.</span><span class="token function">getWorldPosition</span><span class="token punctuation">(</span>pos3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取obj世界坐标、</span>
        pos3<span class="token punctuation">.</span>y <span class="token operator">+=</span> <span class="token number">30</span><span class="token punctuation">;</span>
        label3DSprite<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>pos3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//标签标注在obj世界坐标</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>label3DSprite<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//标签插入场景 </span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Box<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="renderts_191"></a>render.ts【设置渲染器】</h3> 
<pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">THREE</span> <span class="token keyword">from</span> <span class="token string">"three"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> createCamera <span class="token keyword">from</span> <span class="token string">"./camera"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">initRenderer</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> <span class="token punctuation">{<!-- --></span> scene<span class="token punctuation">,</span> labelRenderer2D<span class="token punctuation">,</span> labelRenderer3D <span class="token punctuation">}</span> <span class="token operator">=</span> context<span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token punctuation">{<!-- --></span> camera<span class="token punctuation">,</span> renderer <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createCamera</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 渲染</span>
    <span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
        labelRenderer2D<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//渲染HTML标签对象 CSS2DObject 标签</span>
        labelRenderer3D<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//渲染HTML标签对象 CSS3DObject 标签</span>

        <span class="token comment">//监听鼠标、键盘事件</span>
        <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> camera<span class="token punctuation">,</span> renderer<span class="token punctuation">,</span> render <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> initRenderer<span class="token punctuation">;</span>
</code></pre> 
<h2><a id="_214"></a>四、源码</h2> 
<p>前往<a href="https://gitee.com/6feel/vue-vite-ts-test/tree/master/src/views/threeJS/label" rel="nofollow">标签demo源码</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/60b60f7385c1c9bf40b0baf237905b95/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">在cmd中转到某一目录下及一些命令行操作</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1f587a8593021b62a3e048b2902c8abf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">最新stm32毕设100例(四)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>