<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C. Two strings-二分的威力，思路题 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C. Two strings-二分的威力，思路题" />
<meta property="og:description" content="Educational Codeforces Round 17 C. Two strings 题意，给两个长度小于十万的字符串A、B，B删除连续的字符串后成为A的子串（不需要连续），求这最长子串，可能为空也可能为A本身。 思路：枚举B的子串其实只要枚举删除的位置就好了，因为B删除的部分是连续的字符串而且只能删一次。可以把字符串B看成三部分。
| 左边部分 || 删除部分 || 右边部分 | 左边部分、右边部分可能为空。 其实就是前后缀，先求出B各个前缀需要A前缀的长度，再求出B各个后缀需要A后缀的长度，
比如说字符串A是 abacaba，字符串B是 abcdcba ，B的前缀依次是a、ab、abc、abcd….,后缀依次是a、ba、cba、dcba、cdcba….，前缀a需要字符串A的前缀长度为1(a)，前缀ab需要字符串A的前缀长度为2(ab),前缀abc需要字符串A的前缀长度为4(abac)….
后缀同理，那么，只需要满足从b前、后缀数组里面选出两个位置相加要求长度小于等于字符串A长度，这两个位置就能确定删除部分了。用len来表示B删除连续字符串后剩下的长度。
先贴一下我test 36 TLE的代码，原因是轮询太慢，2000ms，
#include &lt;iostream&gt; #include &lt;cstdio&gt; #include &lt;cstring&gt; using namespace std; typedef long long int ll; const int maxn = 100007; char a[maxn],b[maxn]; int lena,lenb; int needApreLen[maxn],needAsufLen[maxn]; int main() { // freopen(&#34;in.txt&#34;,&#34;r&#34;,stdin); scanf(&#34;%s&#34;,a); scanf(&#34;%s&#34;,b); lena = strlen(a); lenb = strlen(b); for(int i=0;i&lt;maxn;&#43;&#43;i)needApreLen[i] = lena &#43; 5; for(int i=0;i&lt;maxn;&#43;&#43;i)needAsufLen[i] = lena &#43; 5; int pos = 0; for(int i = 0; i &lt; lenb;&#43;&#43;i) { while(pos&lt;lena &amp;&amp; a[pos] !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/7f83b11dcf87d9069c5e67fa6fd302ff/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-01-31T21:10:05+08:00" />
<meta property="article:modified_time" content="2017-01-31T21:10:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C. Two strings-二分的威力，思路题</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>Educational Codeforces Round 17 C. Two strings <br> 题意，给两个长度小于十万的字符串A、B，B删除连续的字符串后成为A的子串（不需要连续），求这最长子串，可能为空也可能为A本身。 <br> 思路：枚举B的子串其实只要枚举删除的位置就好了，因为B删除的部分是连续的字符串而且只能删一次。可以把字符串B看成三部分。</p> 
<pre><code>                    | 左边部分 || 删除部分 || 右边部分 |
</code></pre> 
<p>左边部分、右边部分可能为空。 <br> 其实就是前后缀，先求出B各个前缀需要A前缀的长度，再求出B各个后缀需要A后缀的长度，</p> 
<p>比如说字符串A是 abacaba，字符串B是 abcdcba ，B的前缀依次是a、ab、abc、abcd….,后缀依次是a、ba、cba、dcba、cdcba….，前缀a需要字符串A的前缀长度为1(a)，前缀ab需要字符串A的前缀长度为2(ab),前缀abc需要字符串A的前缀长度为4(abac)….</p> 
<p>后缀同理，那么，只需要满足从b前、后缀数组里面选出两个位置相加要求长度小于等于字符串A长度，这两个位置就能确定删除部分了。用len来表示B删除连续字符串后剩下的长度。</p> 
<p>先贴一下我test 36 TLE的代码，原因是轮询太慢，2000ms，</p> 
<pre class="prettyprint"><code class=" hljs perl"><span class="hljs-comment">#include &lt;iostream&gt;</span>
<span class="hljs-comment">#include &lt;cstdio&gt;</span>
<span class="hljs-comment">#include &lt;cstring&gt;</span>
using namespace std;
typedef long long <span class="hljs-keyword">int</span> ll;
const <span class="hljs-keyword">int</span> maxn = <span class="hljs-number">100007</span>;
char a[maxn],b[maxn];
<span class="hljs-keyword">int</span> lena,lenb;
<span class="hljs-keyword">int</span> needApreLen[maxn],needAsufLen[maxn];
<span class="hljs-keyword">int</span> main()
{
<span class="hljs-regexp">//</span>  freopen(<span class="hljs-string">"in.txt"</span>,<span class="hljs-string">"r"</span>,stdin);
    scanf(<span class="hljs-string">"<span class="hljs-variable">%s</span>"</span>,a);
    scanf(<span class="hljs-string">"<span class="hljs-variable">%s</span>"</span>,b);
    lena = strlen(a);
    lenb = strlen(b);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;maxn;++i)needApreLen[i] = lena + <span class="hljs-number">5</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;maxn;++i)needAsufLen[i] = lena + <span class="hljs-number">5</span>;

    <span class="hljs-keyword">int</span> <span class="hljs-keyword">pos</span> = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; lenb;++i)
    {
        <span class="hljs-keyword">while</span>(<span class="hljs-keyword">pos</span>&lt;lena &amp;&amp; a[<span class="hljs-keyword">pos</span>] != b[i])++<span class="hljs-keyword">pos</span>;
        ++<span class="hljs-keyword">pos</span>;              <span class="hljs-regexp">//index</span> starts from <span class="hljs-number">0</span>,plus before update
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">pos</span>&lt;=lena)needApreLen[i] = min(<span class="hljs-keyword">pos</span>,needAsufLen[i]);
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">pos</span>&gt;lena)<span class="hljs-keyword">break</span>;  
    }

    <span class="hljs-keyword">pos</span> = lena - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = lenb-<span class="hljs-number">1</span>;i &gt;= <span class="hljs-number">0</span>;--i)
    {
        <span class="hljs-keyword">while</span>(<span class="hljs-keyword">pos</span>&gt;=<span class="hljs-number">0</span> &amp;&amp; a[<span class="hljs-keyword">pos</span>] != b[i])--<span class="hljs-keyword">pos</span>;       
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">pos</span>&gt;=<span class="hljs-number">0</span>)needAsufLen[i] = min(lena - <span class="hljs-keyword">pos</span>,needAsufLen[i]);
        --<span class="hljs-keyword">pos</span>;              <span class="hljs-regexp">//index</span> starts from lena-<span class="hljs-number">1</span>,decrease after update
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">pos</span>&lt;<span class="hljs-number">0</span>)<span class="hljs-keyword">break</span>; 
    }

    //<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;i &lt; lenb;++i)<span class="hljs-keyword">printf</span>(<span class="hljs-string">"<span class="hljs-variable">%d</span> "</span>,needApreLen[i]);<span class="hljs-keyword">printf</span>(<span class="hljs-string">"\n"</span>);
    <span class="hljs-regexp">//for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;i &lt; lenb;++i)<span class="hljs-keyword">printf</span>(<span class="hljs-string">"<span class="hljs-variable">%d</span> "</span>,needAsufLen[i]);<span class="hljs-keyword">printf</span>(<span class="hljs-string">"\n"</span>);

    <span class="hljs-keyword">int</span> longestL = -<span class="hljs-number">1</span>,longestR = -<span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;i &lt; lenb;++i)<span class="hljs-keyword">if</span>( needApreLen[i] &lt;= lena )longestL = i;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = lenb - <span class="hljs-number">1</span>;i &gt;= <span class="hljs-number">0</span>;--i)<span class="hljs-keyword">if</span>( needAsufLen[i] &lt;= lena )longestR = i; 

    <span class="hljs-keyword">if</span>(longestL == -<span class="hljs-number">1</span> &amp;&amp; longestR == -<span class="hljs-number">1</span>)<span class="hljs-keyword">printf</span>(<span class="hljs-string">"-"</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(longestL == -<span class="hljs-number">1</span>){<!-- --><span class="hljs-regexp">//only</span> suffix
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=longestR;i&lt;lenb;++i)<span class="hljs-keyword">printf</span>(<span class="hljs-string">"<span class="hljs-variable">%c</span>"</span>,b[i]);
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(longestR ==-<span class="hljs-number">1</span>){<!-- --><span class="hljs-regexp">//only</span> prefix
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;=longestL;++i)<span class="hljs-keyword">printf</span>(<span class="hljs-string">"<span class="hljs-variable">%c</span>"</span>,b[i]);
    }
    <span class="hljs-keyword">else</span>{
        <span class="hljs-keyword">int</span> len,left,right,op=<span class="hljs-number">0</span>,os=<span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span>(longestL+<span class="hljs-number">1</span> &gt; lenb-longestR){     <span class="hljs-regexp">//only</span> prefix
            len = longestL+<span class="hljs-number">1</span>;
            left = longestL;
            op = <span class="hljs-number">1</span>;
        }<span class="hljs-keyword">else</span>{      <span class="hljs-regexp">//only</span> suffix
            len = lenb-longestR;
            right = longestR;
            os = <span class="hljs-number">1</span>;
        }
    //  <span class="hljs-keyword">printf</span>(<span class="hljs-string">"lenb = <span class="hljs-variable">%d</span>\n"</span>,lenb);
    <span class="hljs-regexp">//</span>  <span class="hljs-keyword">printf</span>(<span class="hljs-string">"longestL = <span class="hljs-variable">%d</span> longestR = <span class="hljs-variable">%d</span>\n"</span>,longestL,longestR);
    <span class="hljs-regexp">//</span>  <span class="hljs-keyword">printf</span>(<span class="hljs-string">"len = <span class="hljs-variable">%d</span>\n"</span>,len);
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = longestL,j = longestR;i&gt;=<span class="hljs-number">0</span>;--i)//i : max len of valid prefix,j : max len of valid suffix
        {
            j = longestR;
            <span class="hljs-keyword">while</span>(j&lt;lenb  &amp;&amp;needApreLen[i] + needAsufLen[j] &gt; lena)++j;     
            <span class="hljs-keyword">if</span>(j&lt;lenb  &amp;&amp; i&lt;j &amp;&amp; lenb-(j-i-<span class="hljs-number">1</span>)&gt;len){             
                left = i;
                right = j;
                len = lenb-(j-i-<span class="hljs-number">1</span>);
                os = op = <span class="hljs-number">0</span>;
            }
        }
        <span class="hljs-keyword">if</span>(os==<span class="hljs-number">0</span> &amp;&amp; op==<span class="hljs-number">0</span>){ 
        <span class="hljs-regexp">//</span>  <span class="hljs-keyword">printf</span>(<span class="hljs-string">"here1\n"</span>);      
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;=left;++i)<span class="hljs-keyword">printf</span>(<span class="hljs-string">"<span class="hljs-variable">%c</span>"</span>,b[i]);
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=right;i&lt;lenb;++i)<span class="hljs-keyword">printf</span>(<span class="hljs-string">"<span class="hljs-variable">%c</span>"</span>,b[i]);
        }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(op){
        <span class="hljs-regexp">//</span>  <span class="hljs-keyword">printf</span>(<span class="hljs-string">"here2\n"</span>);
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;=left;++i)<span class="hljs-keyword">printf</span>(<span class="hljs-string">"<span class="hljs-variable">%c</span>"</span>,b[i]);
        }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(os){
        <span class="hljs-regexp">//</span>  <span class="hljs-keyword">printf</span>(<span class="hljs-string">"here3\n"</span>);
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=right;i&lt;lenb;++i)<span class="hljs-keyword">printf</span>(<span class="hljs-string">"<span class="hljs-variable">%c</span>"</span>,b[i]);
        }


    }
    <span class="hljs-keyword">printf</span>(<span class="hljs-string">"\n"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre> 
<p>后来用二分查找重新优化了31ms过。。。二分真的很快，但是upper_bound用起来需要注意是否越界，而且需要先排序，而且处理字符串，从1开始存的话方便很多，不要怕错，用多了就会习惯了。重写几次代码也是很考毅力啊，可是做题不A等于没做，一定要写出来，况且根本就没有努力到需要讲求天赋的水平，优秀的人只是愿意比你多试几次而已，一点点的积累很重要，一天一点，一年会改变很多。没天赋的人需要努力，有天赋的就更需要了，不然浪费。</p> 
<pre class="prettyprint"><code class=" hljs perl"><span class="hljs-comment">#include &lt;iostream&gt;</span>
<span class="hljs-comment">#include &lt;cstdio&gt;</span>
<span class="hljs-comment">#include &lt;cstring&gt;</span>
<span class="hljs-comment">#include &lt;algorithm&gt;</span>
using namespace std;
typedef long long <span class="hljs-keyword">int</span> ll;
const <span class="hljs-keyword">int</span> maxn = <span class="hljs-number">100050</span>;
char a[maxn],b[maxn];
<span class="hljs-keyword">int</span> lena,lenb;
<span class="hljs-keyword">int</span> needAP[maxn],needAS[maxn];
<span class="hljs-keyword">int</span> main()
{
    <span class="hljs-regexp">//freopen</span>(<span class="hljs-string">"in.txt"</span>,<span class="hljs-string">"r"</span>,stdin);
    scanf(<span class="hljs-string">"<span class="hljs-variable">%s</span>"</span>,a+<span class="hljs-number">1</span>);
    scanf(<span class="hljs-string">"<span class="hljs-variable">%s</span>"</span>,b+<span class="hljs-number">1</span>);
    lena = strlen(a+<span class="hljs-number">1</span>);
    lenb = strlen(b+<span class="hljs-number">1</span>);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=lenb;++i)needAP[i] = needAS[i] = lena + <span class="hljs-number">1</span>;

    <span class="hljs-keyword">int</span> <span class="hljs-keyword">pos</span> = <span class="hljs-number">1</span>,longestL = lenb,longestR = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= lenb;++i){
        <span class="hljs-keyword">while</span>(<span class="hljs-keyword">pos</span>&lt;=lena &amp;&amp; a[<span class="hljs-keyword">pos</span>] != b[i])++<span class="hljs-keyword">pos</span>;
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">pos</span>&lt;=lena)needAP[i] = <span class="hljs-keyword">pos</span>;
        <span class="hljs-keyword">else</span> {longestL = i-<span class="hljs-number">1</span>;<span class="hljs-keyword">break</span>;}
        ++<span class="hljs-keyword">pos</span>;
    }

    <span class="hljs-keyword">pos</span> = lena;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = lenb;i &gt;= <span class="hljs-number">1</span>;--i){
        <span class="hljs-keyword">while</span>(<span class="hljs-keyword">pos</span>&gt;=<span class="hljs-number">1</span> &amp;&amp; a[<span class="hljs-keyword">pos</span>] != b[i])--<span class="hljs-keyword">pos</span>;       
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">pos</span>&gt;=<span class="hljs-number">1</span>)needAS[i] = lena - <span class="hljs-keyword">pos</span> + <span class="hljs-number">1</span>;
        <span class="hljs-keyword">else</span> {longestR = i+<span class="hljs-number">1</span>;<span class="hljs-keyword">break</span>;}
        --<span class="hljs-keyword">pos</span>;      
    }

    <span class="hljs-keyword">if</span>(longestL &lt; <span class="hljs-number">1</span> &amp;&amp; longestR &gt; lenb)<span class="hljs-keyword">printf</span>(<span class="hljs-string">"-"</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(longestL == lenb || longestR == <span class="hljs-number">1</span>)<span class="hljs-keyword">printf</span>(<span class="hljs-string">"<span class="hljs-variable">%s</span>"</span>,b+<span class="hljs-number">1</span>);
    <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">int</span> len,left,right;
        <span class="hljs-keyword">if</span>(longestL &gt; lenb - longestR + <span class="hljs-number">1</span>){<!-- --><span class="hljs-regexp">//only</span> prefix
            len = longestL;
            left = longestL;
            right = lenb + <span class="hljs-number">1</span>;
        }<span class="hljs-keyword">else</span>{                              <span class="hljs-regexp">//only</span> suffix
            len = lenb - longestR + <span class="hljs-number">1</span>;
            left = <span class="hljs-number">0</span>;
            right = longestR;
        }

        <span class="hljs-keyword">int</span> pfind = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=longestR;i&lt;=lenb;++i)
        {
            pfind = upper_bound(needAP,needAP+longestL+<span class="hljs-number">2</span>,lena - needAS[i]) - needAP - <span class="hljs-number">1</span>;
            <span class="hljs-keyword">if</span>(pfind &lt;= longestL &amp;&amp; pfind + lenb-i+<span class="hljs-number">1</span> &gt; len){
                left = pfind;
                right = i;
                len = pfind + lenb-i+<span class="hljs-number">1</span>;
            }
        }

        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>;i &lt;= left;++i)<span class="hljs-keyword">printf</span>(<span class="hljs-string">"<span class="hljs-variable">%c</span>"</span>,b[i]);
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = right; i&lt;= lenb;++i)<span class="hljs-keyword">printf</span>(<span class="hljs-string">"<span class="hljs-variable">%c</span>"</span>,b[i]);
    }   
    <span class="hljs-keyword">printf</span>(<span class="hljs-string">"\n"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b2d49a4f39ff41ec9509445d5986baf7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">算法训练 2的次幂表示  （java版）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/beeb8a8c107011e7aa0c07d42e585185/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">LINQ 查询表达式（C# 编程指南）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>