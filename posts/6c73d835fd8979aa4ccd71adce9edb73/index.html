<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vcf 文件如何修改染色体修改样本名称提取样本 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vcf 文件如何修改染色体修改样本名称提取样本" />
<meta property="og:description" content="大家好，我是邓飞。
对于vcf文件和plink文件是经常用的文件，对于基因型数据的处理，一般分为：
数据质控数据提取染色体修改名称样本修改名称 今天介绍一下vcf文件的三个处理方法：
1，染色体修改2，样本名称修改3，样本提取 用到的软件是bcftools，用到的系统是Linux。
1. 数据描述 数据使用GWAS-Cookbook中的GWASdat1中的数据，将数据变为vcf格式。
相关基因型数据，可以在这里下载：快来领取 | 飞哥的GWAS分析教程更新啦
将plink的二进制文件，变为vcf的代码：
plink --bfile ../../gwas_cookbook/GWAS-dat1/1_QC_GWAS/HapMap_3_r3_1 --recode vcf-iid --out test1 vcf预览：
2. vcf文件修改染色体名称 整理染色体修改对应关系：
awk &#39;{print $1}&#39; HapMap_3_r3_1.bim |sort |uniq &gt;chr.txt awk &#39;{print $1,&#34;chr&#34;$1}&#39; chr.txt &gt;chr_rename.txt 整理好的对应关系：
$ cat chr_rename.txt 1 chr1 10 chr10 11 chr11 12 chr12 13 chr13 14 chr14 15 chr15 16 chr16 17 chr17 18 chr18 19 chr19 2 chr2 20 chr20 21 chr21 22 chr22 23 chr23 25 chr25 3 chr3 4 chr4 5 chr5 6 chr6 7 chr7 8 chr8 9 chr9 代码：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/6c73d835fd8979aa4ccd71adce9edb73/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-10T22:25:16+08:00" />
<meta property="article:modified_time" content="2023-10-10T22:25:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vcf 文件如何修改染色体修改样本名称提取样本</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>大家好，我是邓飞。</p> 
<p>对于vcf文件和plink文件是经常用的文件，对于基因型数据的处理，一般分为：</p> 
<ul><li>数据质控</li><li>数据提取</li><li>染色体修改名称</li><li>样本修改名称</li></ul> 
<p>今天介绍一下vcf文件的三个处理方法：</p> 
<ul><li>1，染色体修改</li><li>2，样本名称修改</li><li>3，样本提取</li></ul> 
<p>用到的软件是<code>bcftools</code>，用到的系统是<code>Linux</code>。</p> 
<h4><a id="1__16"></a>1. 数据描述</h4> 
<p>数据使用GWAS-Cookbook中的GWASdat1中的数据，将数据变为vcf格式。</p> 
<blockquote> 
 <p>相关基因型数据，可以在这里下载：<a href="https://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247492692&amp;idx=1&amp;sn=1fbb8373de650c72b33234661490e726&amp;chksm=e90c0b46de7b82505914f468926e356eb1d146bf7131a6176507c8e6cbd463a52398392a2a0c&amp;scene=21#wechat_redirect" rel="nofollow">快来领取 | 飞哥的GWAS分析教程更新啦</a></p> 
</blockquote> 
<p>将plink的二进制文件，变为vcf的代码：</p> 
<pre><code>plink --bfile ../../gwas_cookbook/GWAS-dat1/1_QC_GWAS/HapMap_3_r3_1 --recode vcf-iid --out test1

</code></pre> 
<p><img src="https://images2.imgbox.com/b3/bf/SOK5dEqu_o.png" alt=""><br> vcf预览：</p> 
<p><img src="https://images2.imgbox.com/35/a0/l7EZoxju_o.png" alt=""></p> 
<h4><a id="2_vcf_33"></a>2. vcf文件修改染色体名称</h4> 
<p><img src="https://images2.imgbox.com/bb/f4/8p5wU8KA_o.png" alt=""><br> 整理染色体修改对应关系：</p> 
<pre><code>awk '{print $1}' HapMap_3_r3_1.bim |sort |uniq &gt;chr.txt
awk '{print $1,"chr"$1}' chr.txt &gt;chr_rename.txt
</code></pre> 
<p>整理好的对应关系：</p> 
<pre><code>$ cat chr_rename.txt 
1 chr1
10 chr10
11 chr11
12 chr12
13 chr13
14 chr14
15 chr15
16 chr16
17 chr17
18 chr18
19 chr19
2 chr2
20 chr20
21 chr21
22 chr22
23 chr23
25 chr25
3 chr3
4 chr4
5 chr5
6 chr6
7 chr7
8 chr8
9 chr9

</code></pre> 
<p>代码：</p> 
<pre><code> bcftools annotate --rename-chrs chr_rename.txt -Oz -o test2.vcf.gz test1.vcf 
gzip -d test2.vcf.gz 
less -S test2.vcf 
</code></pre> 
<p>修改后的结果：</p> 
<p><img src="https://images2.imgbox.com/ef/a8/nr25oyWs_o.png" alt=""><br> 可以看到，已经修改过了。</p> 
<h4><a id="3__85"></a>3. 修改样本的名称</h4> 
<p>样本对应关系txt文件整理：</p> 
<pre><code>awk '{print $2}' HapMap_3_r3_1.fam |head &gt;sname.txt
awk '{print $1,"new_"$1}' sname.txt &gt;sname_change.txt
</code></pre> 
<p>对应关系文件内容：</p> 
<pre><code>$ head sname_change.txt 
NA06989 new_NA06989
NA11891 new_NA11891
NA11843 new_NA11843
NA12341 new_NA12341
NA12739 new_NA12739
NA10850 new_NA10850
NA06984 new_NA06984
NA12877 new_NA12877
NA12275 new_NA12275
NA06986 new_NA06986
</code></pre> 
<p>代码：</p> 
<pre><code>bcftools reheader -s sname_change.txt test1.vcf -o test3.vcf.gz
</code></pre> 
<p>修改后的vcf：</p> 
<p><img src="https://images2.imgbox.com/b6/8c/MbDR9Nf7_o.png" alt=""></p> 
<h4><a id="4_vcf_119"></a>4. 提取vcf样本</h4> 
<p>代码：</p> 
<pre><code>bcftools view -S sname.txt test1.vcf -Ov &gt; test4.vcf
</code></pre> 
<p>提取后的文件：</p> 
<p><img src="https://images2.imgbox.com/e9/6e/6G0KFhVn_o.png" alt=""></p> 
<p>搞定！</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/42bfa95044f780e4b800ee65632652f7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C&#43;&#43;中对象指针【详细讲解】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c895cad230dfeb4d49b37f3a7794c42f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">多积分通道行人检测&#43;KCF跟踪（企业级项目）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>