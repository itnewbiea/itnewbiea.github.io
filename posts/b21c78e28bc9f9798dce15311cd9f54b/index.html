<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SpringBoot运维中的高级配置 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SpringBoot运维中的高级配置" />
<meta property="og:description" content="🙈作者简介：练习时长两年半的Java up主
🙉个人主页：程序员老茶
🙊 ps:点赞👍是免费的，却可以让写博客的作者开心好久好久😎
📚系列专栏：Java全栈，计算机系列（火速更新中）
💭 格言：种一棵树最好的时间是十年前，其次是现在
🏡动动小手，点个关注不迷路，感谢宝子们一键三连
目录 课程名：Java内容/作用：知识点/设计/实验/作业/练习学习：SpringBoot运维中的高级配置SpringBoot运维中的高级配置1. 临时属性设置1.1 属性加载优先级1.2 开发环境中使用临时属性 2. 配置文件分类3. 自定义配置文件 课程名：Java 内容/作用：知识点/设计/实验/作业/练习 学习：SpringBoot运维中的高级配置 SpringBoot运维中的高级配置 ​ 关于配置在之前讲过一部分，之前的配置总体上来说就是让各位小伙伴掌握配置的格式。比如配置文件如何写啊，写好的数据如何读取啊，都是基础的语法级知识。在后面的学习中就要集中在配置的应用这个方面了，下面就开始配置高级相关内容的第一部分学习，为什么说第一部分，因为在实际开发实用中还有对应的配置高级知识要进行学习。
1. 临时属性设置 ​ 目前我们的程序包打好了，可以发布了。但是程序包打好以后，里面的配置都已经是固定的了，比如配置了服务器的端口是8080。如果我要启动项目，发现当前我的服务器上已经有应用启动起来并且占用了8080端口，这个时候就尴尬了。难道要重新把打包好的程序修改一下吗？比如我要把打包好的程序启动端口改成80。
​ SpringBoot提供了灵活的配置方式，如果你发现你的项目中有个别属性需要重新配置，可以使用临时属性的方式快速修改某些配置。方法也特别简单，在启动的时候添加上对应参数就可以了。
java –jar springboot.jar –-server.port=80 ​ 上面的命令是启动SpringBoot程序包的命令，在命令输入完毕后，空一格，然后输入两个-号。下面按照属性名=属性值的形式添加对应参数就可以了。记得，这里的格式不是yaml中的书写格式，当属性存在多级名称时，中间使用点分隔，和properties文件中的属性格式完全相同。
​ 如果你发现要修改的属性不止一个，可以按照上述格式继续写，属性与属性之间使用空格分隔。
java –jar springboot.jar –-server.port=80 --logging.level.root=debug 1.1 属性加载优先级 ​ 现在我们的程序配置受两个地方控制了，第一配置文件，第二临时属性。并且我们发现临时属性的加载优先级要高于配置文件的。那是否还有其他的配置方式呢？其实是有的，而且还不少，打开官方文档中对应的内容，就可以查看配置读取的优先顺序。
地址：https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-external-config
​ 我们可以看到，居然有14种配置的位置，而我们现在使用的是这里面的2个。第3条Config data说的就是使用配置文件，第11条Command line arguments说的就是使用命令行临时参数。而这14种配置的顺序就是SpringBoot加载配置的顺序，言外之意，命令行临时属性比配置文件的加载优先级高，所以这个列表上面的优先级低，下面的优先级高。其实这个东西不用背的，你就记得一点，你最终要什么效果，你自己是知道的，不管这个顺序是怎么个高低排序，开发时一定要配置成你要的顺序为准。这个顺序只是在你想不明白问题的时候帮助你分析罢了。
​ 比如你现在加载了一个user.name属性。结果你发现出来的结果和你想的不一样，那肯定是别的优先级比你高的属性覆盖你的配置属性了，那你就可以看着这个顺序挨个排查。哪个位置有可能覆盖了你的属性。
​ 看到小伙伴学习之前内容的时候问这个问题了，就是这个原因造成的。在yaml中配置了user.name属性值，然后读取出来的时候居然不是自己的配置值，因为在系统属性中有一个属性叫做user.name，两个相互冲突了。而系统属性的加载优先顺序在上面这个列表中是5号，高于3号，所以SpringBoot最终会加载系统配置属性user.name。
总结
使用jar命令启动SpringBoot工程时可以使用临时属性替换配置文件中的属性临时属性添加方式：java –jar 工程名.jar –-属性名=值多个临时属性之间使用空格分隔临时属性必须是当前boot工程支持的属性，否则设置无效 1.2 开发环境中使用临时属性 ​ 临时使用目前是有了，但是上线的时候通过命令行输入的临时属性必须是正确的啊，那这些属性配置值我们必须在开发环境中测试好才行。下面说一下开发环境中如何使用临时属性，其实就是Idea界面下如何操作了。
​ 打开SpringBoot引导类的运行界面，在里面找到配置项。其中Program arguments对应的位置就是添加临时属性的，可以加几个试试效果。
​ 做到这里其实可以产生一个思考了，如果对java编程熟悉的小伙伴应该知道，我们运行main方法的时候，如果想使用main方法的参数，也就是下面的args参数，就是在上面这个位置添加的参数。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/b21c78e28bc9f9798dce15311cd9f54b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-14T15:43:12+08:00" />
<meta property="article:modified_time" content="2023-12-14T15:43:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SpringBoot运维中的高级配置</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>🙈作者简介：练习时长两年半的Java up主<br> 🙉个人主页：程序员老茶<br> 🙊 ps:点赞👍是免费的，却可以让写博客的作者开心好久好久😎<br> 📚系列专栏：Java全栈，计算机系列（火速更新中）<br> 💭 格言：种一棵树最好的时间是十年前，其次是现在<br> 🏡动动小手，点个关注不迷路，感谢宝子们一键三连</p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#Java_11" rel="nofollow">课程名：Java</a></li><li><ul><li><a href="#_12" rel="nofollow">内容/作用：知识点/设计/实验/作业/练习</a></li><li><a href="#SpringBoot_13" rel="nofollow">学习：SpringBoot运维中的高级配置</a></li><li><a href="#SpringBoot_14" rel="nofollow">SpringBoot运维中的高级配置</a></li><li><ul><li><a href="#1__20" rel="nofollow">1. 临时属性设置</a></li><li><ul><li><a href="#11__45" rel="nofollow">1.1 属性加载优先级</a></li><li><a href="#12__68" rel="nofollow">1.2 开发环境中使用临时属性</a></li></ul> 
    </li><li><a href="#2__119" rel="nofollow">2. 配置文件分类</a></li><li><a href="#3__158" rel="nofollow">3. 自定义配置文件</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="Java_11"></a>课程名：Java</h2> 
<h3><a id="_12"></a>内容/作用：知识点/设计/实验/作业/练习</h3> 
<h3><a id="SpringBoot_13"></a>学习：SpringBoot运维中的高级配置</h3> 
<h3><a id="SpringBoot_14"></a>SpringBoot运维中的高级配置</h3> 
<p>​ 关于配置在之前讲过一部分，之前的配置总体上来说就是让各位小伙伴掌握配置的格式。比如配置文件如何写啊，写好的数据如何读取啊，都是基础的语法级知识。在后面的学习中就要集中在配置的应用这个方面了，下面就开始配置高级相关内容的第一部分学习，为什么说第一部分，因为在实际开发实用中还有对应的配置高级知识要进行学习。</p> 
<h4><a id="1__20"></a>1. 临时属性设置</h4> 
<p>​ 目前我们的程序包打好了，可以发布了。但是程序包打好以后，里面的配置都已经是固定的了，比如配置了服务器的端口是8080。如果我要启动项目，发现当前我的服务器上已经有应用启动起来并且占用了8080端口，这个时候就尴尬了。难道要重新把打包好的程序修改一下吗？比如我要把打包好的程序启动端口改成80。<br> <img src="https://images2.imgbox.com/03/d5/RgnezA4N_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/e8/35/VLXWbkrc_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/48/f1/PzNXgYra_o.png" alt="在这里插入图片描述"></p> 
<p>​ SpringBoot提供了灵活的配置方式，如果你发现你的项目中有个别属性需要重新配置，可以使用临时属性的方式快速修改某些配置。方法也特别简单，在启动的时候添加上对应参数就可以了。</p> 
<pre><code class="prism language-JAVA">java –jar springboot.jar –-server.port=80
</code></pre> 
<p>​ 上面的命令是启动SpringBoot程序包的命令，在命令输入完毕后，空一格，然后输入两个-号。下面按照属性名=属性值的形式添加对应参数就可以了。记得，这里的格式不是yaml中的书写格式，当属性存在多级名称时，中间使用点分隔，和properties文件中的属性格式完全相同。</p> 
<p>​ 如果你发现要修改的属性不止一个，可以按照上述格式继续写，属性与属性之间使用空格分隔。</p> 
<pre><code class="prism language-JAVA">java –jar springboot.jar –-server.port=80 --logging.level.root=debug
</code></pre> 
<h5><a id="11__45"></a>1.1 属性加载优先级</h5> 
<p>​ 现在我们的程序配置受两个地方控制了，第一配置文件，第二临时属性。并且我们发现临时属性的加载优先级要高于配置文件的。那是否还有其他的配置方式呢？其实是有的，而且还不少，打开官方文档中对应的内容，就可以查看配置读取的优先顺序。<br> 地址：<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html" rel="nofollow">https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-external-config</a></p> 
<p><img src="https://images2.imgbox.com/1d/72/C41XYfm2_o.png" alt="在这里插入图片描述"></p> 
<p>​ 我们可以看到，居然有14种配置的位置，而我们现在使用的是这里面的2个。第3条Config data说的就是使用配置文件，第11条Command line arguments说的就是使用命令行临时参数。而这14种配置的顺序就是SpringBoot加载配置的顺序，言外之意，命令行临时属性比配置文件的加载优先级高，所以这个列表上面的优先级低，下面的优先级高。其实这个东西不用背的，你就记得一点，你最终要什么效果，你自己是知道的，不管这个顺序是怎么个高低排序，开发时一定要配置成你要的顺序为准。这个顺序只是在你想不明白问题的时候帮助你分析罢了。</p> 
<p>​ 比如你现在加载了一个user.name属性。结果你发现出来的结果和你想的不一样，那肯定是别的优先级比你高的属性覆盖你的配置属性了，那你就可以看着这个顺序挨个排查。哪个位置有可能覆盖了你的属性。</p> 
<p>​ 看到小伙伴学习之前内容的时候问这个问题了，就是这个原因造成的。在yaml中配置了user.name属性值，然后读取出来的时候居然不是自己的配置值，因为在系统属性中有一个属性叫做user.name，两个相互冲突了。而系统属性的加载优先顺序在上面这个列表中是5号，高于3号，所以SpringBoot最终会加载系统配置属性user.name。</p> 
<p><strong>总结</strong></p> 
<ol><li>使用jar命令启动SpringBoot工程时可以使用临时属性替换配置文件中的属性</li><li>临时属性添加方式：java –jar 工程名.jar –-属性名=值</li><li>多个临时属性之间使用空格分隔</li><li>临时属性必须是当前boot工程支持的属性，否则设置无效</li></ol> 
<h5><a id="12__68"></a>1.2 开发环境中使用临时属性</h5> 
<p>​ 临时使用目前是有了，但是上线的时候通过命令行输入的临时属性必须是正确的啊，那这些属性配置值我们必须在开发环境中测试好才行。下面说一下开发环境中如何使用临时属性，其实就是Idea界面下如何操作了。</p> 
<p>​ 打开SpringBoot引导类的运行界面，在里面找到配置项。其中Program arguments对应的位置就是添加临时属性的，可以加几个试试效果。</p> 
<p><img src="https://images2.imgbox.com/95/79/m3Fqy9mu_o.png" alt=""></p> 
<p>​ 做到这里其实可以产生一个思考了，如果对java编程熟悉的小伙伴应该知道，我们运行main方法的时候，如果想使用main方法的参数，也就是下面的args参数，就是在上面这个位置添加的参数。</p> 
<pre><code class="prism language-JAVA">public static void main(String[] args) {
}
</code></pre> 
<p>​ 原来是这样，通过这个args就可以获取到参数。再来看我们的引导类是如何书写的</p> 
<pre><code class="prism language-JAVA">public static void main(String[] args) {
    SpringApplication.run(SSMPApplication.class,args);
}
</code></pre> 
<p>​ 这个args参数居然传递给了run方法，看来在Idea中配置的临时参数就是通过这个位置传递到我们的程序中的。言外之意，这里如果不用这个args是不是就断开了外部传递临时属性的入口呢？是这样的，我们可以使用下面的调用方式，这样外部临时属性就无法进入到SpringBoot程序中了。</p> 
<pre><code class="prism language-JAVA">public static void main(String[] args) {
    SpringApplication.run(SSMPApplication.class);
}
</code></pre> 
<p>​ 或者还可以使用如下格式来玩这个操作，就是将配置不写在配置文件中，直接写成一个字符串数组，传递给程序入口。当然，这种做法并没有什么实际开发意义。</p> 
<pre><code class="prism language-JAVA">public static void main(String[] args) {
    String[] arg = new String[1];
    arg[0] = "--server.port=8082";
    SpringApplication.run(SSMPApplication.class, arg);
}
</code></pre> 
<p><strong>总结</strong></p> 
<ol><li>启动SpringBoot程序时，可以选择是否使用命令行属性为SpringBoot程序传递启动属性</li></ol> 
<p><strong>思考</strong></p> 
<p>​ 现在使用临时属性可以在启动项目前临时更改配置了，但是新的问题又出来了。临时属性好用是好用，就是写的多了会很麻烦。比如我现在有个需求，上线的时候使用临时属性配置20个值，这下可麻烦了，能不能搞得简单点，集中管理一下呢？比如说搞个文件，加载指定文件？还真可以。怎么做呢？咱们下一节再说。</p> 
<h4><a id="2__119"></a>2. 配置文件分类</h4> 
<p>​ SpringBoot提供了配置文件和临时属性的方式来对程序进行配置。前面一直说的是临时属性，这一节要说说配置文件了。其实这个配置文件我们一直在使用，只不过我们用的是SpringBoot提供的4级配置文件中的其中一个级别。4个级别分别是：</p> 
<ul><li>类路径下配置文件（一直使用的是这个，也就是resources目录中的application.yml文件）</li><li>类路径下config目录下配置文件</li><li>程序包所在目录中配置文件</li><li>程序包所在目录中config目录下配置文件</li></ul> 
<p>​ 好复杂，一个一个说。其实上述4种文件是提供给你了4种配置文件书写的位置，功能都是一样的，都是做配置的。那大家关心的就是差别了，没错，就是因为位置不同，产生了差异。总体上来说，4种配置文件如果都存在的话，有一个优先级的问题，说白了就是加入4个文件我都有，里面都有一样的配置，谁生效的问题。上面4个文件的加载优先顺序为</p> 
<ol><li>file ：config/application.yml <strong>【最高】</strong></li><li>file ：application.yml</li><li>classpath：config/application.yml</li><li>classpath：application.yml <strong>【最低】</strong></li></ol> 
<p>​ 那为什么设计这种多种呢？说一个最典型的应用吧。</p> 
<ul><li>场景A：你作为一个开发者，你做程序的时候为了方便自己写代码，配置的数据库肯定是连接你自己本机的，咱们使用4这个级别，也就是之前一直用的application.yml。</li><li>场景B：现在项目开发到了一个阶段，要联调测试了，连接的数据库是测试服务器的数据库，肯定要换一组配置吧。你可以选择把你之前的文件中的内容都改了，目前还不麻烦。</li><li>场景C：测试完了，一切OK。你继续写你的代码，你发现你原来写的配置文件被改成测试服务器的内容了，你要再改回来。现在明白了不？场景B中把你的内容都改掉了，你现在要重新改回来，以后呢？改来改去吗？</li></ul> 
<p>​ 解决方案很简单，用上面的3这个级别的配置文件就可以快速解决这个问题，再写一个配置就行了。两个配置文件共存，因为config目录中的配置加载优先级比你的高，所以配置项如果和级别4里面的内容相同就覆盖了，这样是不是很简单？</p> 
<p>​ 级别1和2什么时候使用呢？程序打包以后就要用这个级别了，管你程序里面配置写的是什么？我的级别高，可以轻松覆盖你，就不用考虑这些配置冲突的问题了。</p> 
<p><strong>总结</strong></p> 
<ol><li> <p>配置文件分为4种</p> 
  <ul><li>项目类路径配置文件：服务于开发人员本机开发与测试</li><li>项目类路径config目录中配置文件：服务于项目经理整体调控</li><li>工程路径配置文件：服务于运维人员配置涉密线上环境</li><li>工程路径config目录中配置文件：服务于运维经理整体调控</li></ul> </li><li> <p>多层级配置文件间的属性采用叠加并覆盖的形式作用于程序</p> </li></ol> 
<h4><a id="3__158"></a>3. 自定义配置文件</h4> 
<p>​ 之前咱们做配置使用的配置文件都是application.yml，其实这个文件也是可以改名字的，这样方便维护。比如我2023年12月1日搞活动，走了一组配置，2023年12月10日活动取消，恢复原始配置，这个时候只需要重新更换一下配置文件就可以了。但是你总不能在原始配置文件上修改吧，不然搞完活动以后，活动的配置就留不下来了，不利于维护。</p> 
<p>​ 自定义配置文件方式有如下两种：</p> 
<p><strong>方式一：使用临时属性设置配置文件名，注意仅仅是名称，不要带扩展名</strong></p> 
<p><img src="https://images2.imgbox.com/78/c4/9bzdZxWx_o.png" alt=""><br> <strong>方式二：使用临时属性设置配置文件路径，这个是全路径名</strong></p> 
<p><img src="https://images2.imgbox.com/27/39/YeIMEfuY_o.png" alt=""><br> ​ 也可以设置加载多个配置文件</p> 
<p><img src="https://images2.imgbox.com/39/5c/BEB8gjmP_o.png" alt=""><br> ​ 使用的属性一个是spring.config.name，另一个是spring.config.location，这个一定要区别清楚。</p> 
<p><font color="#f0f"><b>温馨提示</b></font></p> 
<p>​ 我们现在研究的都是SpringBoot单体项目，就是单服务器版本。其实企业开发现在更多的是使用基于SpringCloud技术的多服务器项目。这种配置方式和我们现在学习的完全不一样，所有的服务器将不再设置自己的配置文件，而是通过配置中心获取配置，动态加载配置信息。为什么这样做？集中管理。</p> 
<p><strong>总结</strong></p> 
<ol><li>配置文件可以修改名称，通过启动参数设定</li><li>配置文件可以修改路径，通过启动参数设定</li><li>微服务开发中配置文件通过配置中心进行设置</li></ol> 
<table><thead><tr><th>往期专栏</th></tr></thead><tbody><tr><td>Java全栈开发</td></tr><tr><td>数据结构与算法</td></tr><tr><td>计算机组成原理</td></tr><tr><td>操作系统</td></tr><tr><td>数据库系统</td></tr><tr><td>物联网控制原理与技术</td></tr></tbody></table>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ad017efa6ac850396b7ab498e9879d65/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">计算机网络基础</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1321dc38f42245a644724b2121c1b3bc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Node】Express模块set、engine、all、use等常用接口解析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>