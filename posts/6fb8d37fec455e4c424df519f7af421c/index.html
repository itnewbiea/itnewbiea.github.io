<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SSH免密失败并报错：no mutual signature algorithm - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SSH免密失败并报错：no mutual signature algorithm" />
<meta property="og:description" content="🎹 个人简介：大家好，我是 金鱼哥，CSDN运维领域新星创作者，华为云·云享专家，阿里云社区·专家博主
📚个人资质：CCNA、HCNP、CSNA（网络分析师），软考初级、中级网络工程师、RHCSA、RHCE、RHCA、RHCI、ITIL😜
💬格言：努力不一定成功，但要想成功就必须努力🔥
🎈支持我：可点赞👍、可收藏⭐️、可留言📝
运维要时刻关注漏洞情况并根据现在的版本而进行知识的更新，本例子就是2022年9月8日当天工作所遇到的问题，经过排查和测试后，最终成功解决并了解到更进一步的设置。
文章目录 📜免密登录设置失效📜排查过程📜处理方法📑临时方法📑最佳方式 💡总结 📜免密登录设置失效 一个老运维，要做免密登录，如果没特殊需求，当然一上来就是直接一条命令 ssh-keygen 噼里啪啦，然后拷贝秘钥 ssh-copy-id 就直接了事，更何况要管控一台新下发的机器（云平台，你懂的），当然是直接运行 ssh-copy-id 就直接完事。
谁知道一 ssh 测试，就提示要输入密码，啊这，没道理啊，咋会翻车呢？
📜排查过程 输入密码能登录到系统，之后查看messages和secure日志，正常得很。
之后查看sshd配置，发现与之前有些不同的配置地方，好像HostKey那里，多了ed25519这样的东西（算法类型）如：
[root@centos7-3 ~]# vim /etc/ssh/sshd_config #Port 22 #AddressFamily any #ListenAddress 0.0.0.0 #ListenAddress :: # The default requires explicit activation of protocol 1 #Protocol 2 # HostKey for protocol version 1 #HostKey /etc/ssh/ssh_host_key # HostKeys for protocol version 2 HostKey /etc/ssh/ssh_host_rsa_key #HostKey /etc/ssh/ssh_host_dsa_key HostKey /etc/ssh/ssh_host_ecdsa_key HostKey /etc/ssh/ssh_host_ed25519_key # Lifetime and size of ephemeral version 1 server key #KeyRegenerationInterval 1h #ServerKeyBits 1024 ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/6fb8d37fec455e4c424df519f7af421c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-13T17:31:12+08:00" />
<meta property="article:modified_time" content="2022-09-13T17:31:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SSH免密失败并报错：no mutual signature algorithm</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>🎹 个人简介：大家好，我是 <strong>金鱼哥，CSDN运维领域新星创作者，华为云·云享专家，阿里云社区·专家博主</strong><br> 📚个人资质：<strong>CCNA、HCNP、CSNA（网络分析师），软考初级、中级网络工程师、RHCSA、RHCE、RHCA、RHCI、ITIL</strong>😜<br> 💬格言：努力不一定成功，但要想成功就必须努力🔥</p> 
 <p>🎈支持我：可点赞👍、可收藏⭐️、可留言📝</p> 
</blockquote> 
<hr> 
<blockquote> 
 <p>运维要时刻关注漏洞情况并根据现在的版本而进行知识的更新，本例子就是<strong>2022年9月8日</strong>当天工作所遇到的问题，经过排查和测试后，最终成功解决并了解到更进一步的设置。</p> 
</blockquote> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_13" rel="nofollow">📜免密登录设置失效</a></li><li><a href="#_21" rel="nofollow">📜排查过程</a></li><li><a href="#_213" rel="nofollow">📜处理方法</a></li><li><ul><li><a href="#_219" rel="nofollow">📑临时方法</a></li><li><a href="#_236" rel="nofollow">📑最佳方式</a></li></ul> 
   </li><li><a href="#_285" rel="nofollow">💡总结</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_13"></a>📜免密登录设置失效</h3> 
<p>一个老运维，要做免密登录，如果没特殊需求，当然一上来就是直接一条命令 <code>ssh-keygen</code> 噼里啪啦，然后拷贝秘钥 <code>ssh-copy-id</code> 就直接了事，更何况要管控一台新下发的机器（云平台，你懂的），当然是直接运行 <code>ssh-copy-id</code> 就直接完事。</p> 
<p>谁知道一 ssh 测试，就提示要输入密码，啊这，没道理啊，咋会翻车呢？</p> 
<hr> 
<h3><a id="_21"></a>📜排查过程</h3> 
<p>输入密码能登录到系统，之后查看messages和secure日志，正常得很。</p> 
<p><img src="https://images2.imgbox.com/9b/20/mzc1SK56_o.png" alt="在这里插入图片描述"></p> 
<p>之后查看sshd配置，发现与之前有些不同的配置地方，好像HostKey那里，多了ed25519这样的东西（算法类型）如：</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@centos7-3 ~<span class="token punctuation">]</span><span class="token comment"># vim /etc/ssh/sshd_config</span>
<span class="token comment">#Port 22</span>
<span class="token comment">#AddressFamily any</span>
<span class="token comment">#ListenAddress 0.0.0.0</span>
<span class="token comment">#ListenAddress ::</span>

<span class="token comment"># The default requires explicit activation of protocol 1</span>
<span class="token comment">#Protocol 2</span>

<span class="token comment"># HostKey for protocol version 1</span>
<span class="token comment">#HostKey /etc/ssh/ssh_host_key</span>
<span class="token comment"># HostKeys for protocol version 2</span>
HostKey /etc/ssh/ssh_host_rsa_key
<span class="token comment">#HostKey /etc/ssh/ssh_host_dsa_key</span>
HostKey /etc/ssh/ssh_host_ecdsa_key
HostKey /etc/ssh/ssh_host_ed25519_key

<span class="token comment"># Lifetime and size of ephemeral version 1 server key</span>
<span class="token comment">#KeyRegenerationInterval 1h</span>
<span class="token comment">#ServerKeyBits 1024</span>

<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre> 
<p>之后肯定要使用 -vvv 来演示更详细的信息进行进一步排查：</p> 
<pre><code class="prism language-shell"><span class="token comment"># ssh  -vvv root@172.16.103.129</span>
OpenSSH_8.9p1, OpenSSL <span class="token number">1.1</span>.1n  <span class="token number">15</span> Mar <span class="token number">2022</span>
debug1: Reading configuration data /etc/ssh/ssh_config
debug2: resolve_canonicalize: <span class="token function">hostname</span> <span class="token number">172.16</span>.103.129 is address
debug3: expanded UserKnownHostsFile <span class="token string">'~/.ssh/known_hosts'</span> -<span class="token operator">&gt;</span> <span class="token string">'/root/.ssh/known_hosts'</span>
debug3: expanded UserKnownHostsFile <span class="token string">'~/.ssh/known_hosts2'</span> -<span class="token operator">&gt;</span> <span class="token string">'/root/.ssh/known_hosts2'</span>
debug1: Authenticator provider <span class="token variable">$SSH_SK_PROVIDER</span> did not resolve<span class="token punctuation">;</span> disabling
debug3: ssh_connect_direct: entering
debug1: Connecting to <span class="token number">172.16</span>.103.129 <span class="token punctuation">[</span><span class="token number">172.16</span>.103.129<span class="token punctuation">]</span> port <span class="token number">22</span>.
debug3: set_sock_tos: <span class="token builtin class-name">set</span> socket <span class="token number">3</span> IP_TOS 0x48
debug1: Connection established.
debug1: identity <span class="token function">file</span> /root/.ssh/id_rsa <span class="token builtin class-name">type</span> <span class="token number">0</span>
debug1: identity <span class="token function">file</span> /root/.ssh/id_rsa-cert <span class="token builtin class-name">type</span> -1
debug1: identity <span class="token function">file</span> /root/.ssh/id_ecdsa <span class="token builtin class-name">type</span> -1
debug1: identity <span class="token function">file</span> /root/.ssh/id_ecdsa-cert <span class="token builtin class-name">type</span> -1
debug1: identity <span class="token function">file</span> /root/.ssh/id_ecdsa_sk <span class="token builtin class-name">type</span> -1
debug1: identity <span class="token function">file</span> /root/.ssh/id_ecdsa_sk-cert <span class="token builtin class-name">type</span> -1
debug1: identity <span class="token function">file</span> /root/.ssh/id_ed25519 <span class="token builtin class-name">type</span> -1
debug1: identity <span class="token function">file</span> /root/.ssh/id_ed25519-cert <span class="token builtin class-name">type</span> -1
debug1: identity <span class="token function">file</span> /root/.ssh/id_ed25519_sk <span class="token builtin class-name">type</span> -1
debug1: identity <span class="token function">file</span> /root/.ssh/id_ed25519_sk-cert <span class="token builtin class-name">type</span> -1
debug1: identity <span class="token function">file</span> /root/.ssh/id_xmss <span class="token builtin class-name">type</span> -1
debug1: identity <span class="token function">file</span> /root/.ssh/id_xmss-cert <span class="token builtin class-name">type</span> -1
debug1: identity <span class="token function">file</span> /root/.ssh/id_dsa <span class="token builtin class-name">type</span> -1
debug1: identity <span class="token function">file</span> /root/.ssh/id_dsa-cert <span class="token builtin class-name">type</span> -1
debug1: Local version string SSH-2.0-OpenSSH_8.9
debug1: Remote protocol version <span class="token number">2.0</span>, remote software version OpenSSH_6.6.1
debug1: compat_banner: match: OpenSSH_6.6.1 pat OpenSSH_6.6.1* compat 0x04000002
debug2: fd <span class="token number">3</span> setting O_NONBLOCK
debug1: Authenticating to <span class="token number">172.16</span>.103.129:22 as <span class="token string">'root'</span>
debug3: record_hostkey: found key <span class="token builtin class-name">type</span> ED25519 <span class="token keyword">in</span> <span class="token function">file</span> /root/.ssh/known_hosts:10
debug3: load_hostkeys_file: loaded <span class="token number">1</span> keys from <span class="token number">172.16</span>.103.129
debug1: load_hostkeys: fopen /root/.ssh/known_hosts2: No such <span class="token function">file</span> or directory
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts: No such <span class="token function">file</span> or directory
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts2: No such <span class="token function">file</span> or directory
debug3: order_hostkeyalgs: have matching best-preference key <span class="token builtin class-name">type</span> ssh-ed25519-cert-v01@openssh.com, using HostkeyAlgorithms verbatim
debug3: send packet: <span class="token builtin class-name">type</span> <span class="token number">20</span>
debug1: SSH2_MSG_KEXINIT sent
debug3: receive packet: <span class="token builtin class-name">type</span> <span class="token number">20</span>
debug1: SSH2_MSG_KEXINIT received
debug2: <span class="token builtin class-name">local</span> client KEXINIT proposal
debug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,sntrup761x25519-sha512@openssh.com,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256,ext-info-c
debug2: <span class="token function">host</span> key algorithms: ssh-ed25519-cert-v01@openssh.com,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,sk-ssh-ed25519-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-ed25519,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,sk-ssh-ed25519@openssh.com,sk-ecdsa-sha2-nistp256@openssh.com,rsa-sha2-512,rsa-sha2-256
debug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com
debug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com
debug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1
debug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1
debug2: compression ctos: none,zlib@openssh.com,zlib
debug2: compression stoc: none,zlib@openssh.com,zlib
debug2: languages ctos: 
debug2: languages stoc: 
debug2: first_kex_follows <span class="token number">0</span> 
debug2: reserved <span class="token number">0</span> 
debug2: peer server KEXINIT proposal
debug2: KEX algorithms: curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1
debug2: <span class="token function">host</span> key algorithms: ssh-rsa,ecdsa-sha2-nistp256,ssh-ed25519
debug2: ciphers ctos: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se
debug2: ciphers stoc: aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour,rijndael-cbc@lysator.liu.se
debug2: MACs ctos: hmac-md5-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-md5,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96
debug2: MACs stoc: hmac-md5-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-md5,hmac-sha1,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-ripemd160,hmac-ripemd160@openssh.com,hmac-sha1-96,hmac-md5-96
debug2: compression ctos: none,zlib@openssh.com
debug2: compression stoc: none,zlib@openssh.com
debug2: languages ctos: 
debug2: languages stoc: 
debug2: first_kex_follows <span class="token number">0</span> 
debug2: reserved <span class="token number">0</span> 
debug1: kex: algorithm: curve25519-sha256@libssh.org
debug1: kex: <span class="token function">host</span> key algorithm: ssh-ed25519
debug1: kex: server-<span class="token operator">&gt;</span>client cipher: chacha20-poly1305@openssh.com MAC: <span class="token operator">&lt;</span>implicit<span class="token operator">&gt;</span> compression: none
debug1: kex: client-<span class="token operator">&gt;</span>server cipher: chacha20-poly1305@openssh.com MAC: <span class="token operator">&lt;</span>implicit<span class="token operator">&gt;</span> compression: none
debug3: send packet: <span class="token builtin class-name">type</span> <span class="token number">30</span>
debug1: expecting SSH2_MSG_KEX_ECDH_REPLY
debug3: receive packet: <span class="token builtin class-name">type</span> <span class="token number">31</span>
debug1: SSH2_MSG_KEX_ECDH_REPLY received
debug1: Server <span class="token function">host</span> key: ssh-ed25519 SHA256:umdF0tnveVEhk5QWECp4Frj8GqPgD1uyjxcmvud8dcg
debug3: record_hostkey: found key <span class="token builtin class-name">type</span> ED25519 <span class="token keyword">in</span> <span class="token function">file</span> /root/.ssh/known_hosts:10
debug3: load_hostkeys_file: loaded <span class="token number">1</span> keys from <span class="token number">172.16</span>.103.129
debug1: load_hostkeys: fopen /root/.ssh/known_hosts2: No such <span class="token function">file</span> or directory
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts: No such <span class="token function">file</span> or directory
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts2: No such <span class="token function">file</span> or directory
debug1: Host <span class="token string">'172.16.103.129'</span> is known and matches the ED25519 <span class="token function">host</span> key.
debug1: Found key <span class="token keyword">in</span> /root/.ssh/known_hosts:10
debug3: send packet: <span class="token builtin class-name">type</span> <span class="token number">21</span>
debug2: ssh_set_newkeys: mode <span class="token number">1</span>
debug1: rekey out after <span class="token number">134217728</span> blocks
debug1: SSH2_MSG_NEWKEYS sent
debug1: expecting SSH2_MSG_NEWKEYS
debug3: receive packet: <span class="token builtin class-name">type</span> <span class="token number">21</span>
debug1: SSH2_MSG_NEWKEYS received
debug2: ssh_set_newkeys: mode <span class="token number">0</span>
debug1: rekey <span class="token keyword">in</span> after <span class="token number">134217728</span> blocks
debug1: Will attempt key: /root/.ssh/id_rsa RSA SHA256:tFjK6AdypgKDhFpeoC9mZmGOui9TLuPIDxPzBBmJt98
debug1: Will attempt key: /root/.ssh/id_ecdsa 
debug1: Will attempt key: /root/.ssh/id_ecdsa_sk 
debug1: Will attempt key: /root/.ssh/id_ed25519 
debug1: Will attempt key: /root/.ssh/id_ed25519_sk 
debug1: Will attempt key: /root/.ssh/id_xmss 
debug1: Will attempt key: /root/.ssh/id_dsa 
debug2: pubkey_prepare: <span class="token keyword">done</span>
debug3: send packet: <span class="token builtin class-name">type</span> <span class="token number">5</span>
debug3: receive packet: <span class="token builtin class-name">type</span> <span class="token number">6</span>
debug2: service_accept: ssh-userauth
debug1: SSH2_MSG_SERVICE_ACCEPT received
debug3: send packet: <span class="token builtin class-name">type</span> <span class="token number">50</span>
debug3: receive packet: <span class="token builtin class-name">type</span> <span class="token number">51</span>
debug1: Authentications that can continue: publickey,gssapi-keyex,gssapi-with-mic,password
debug3: start over, passed a different list publickey,gssapi-keyex,gssapi-with-mic,password
debug3: preferred publickey,keyboard-interactive,password
debug3: authmethod_lookup publickey
debug3: remaining preferred: keyboard-interactive,password
debug3: authmethod_is_enabled publickey
debug1: Next authentication method: publickey
debug1: Offering public key: /root/.ssh/id_rsa RSA SHA256:tFjK6AdypgKDhFpeoC9mZmGOui9TLuPIDxPzBBmJt98
debug1: send_pubkey_test: no mutual signature algorithm
debug1: Trying private key: /root/.ssh/id_ecdsa
debug3: no such identity: /root/.ssh/id_ecdsa: No such <span class="token function">file</span> or directory
debug1: Trying private key: /root/.ssh/id_ecdsa_sk
debug3: no such identity: /root/.ssh/id_ecdsa_sk: No such <span class="token function">file</span> or directory
debug1: Trying private key: /root/.ssh/id_ed25519
debug3: no such identity: /root/.ssh/id_ed25519: No such <span class="token function">file</span> or directory
debug1: Trying private key: /root/.ssh/id_ed25519_sk
debug3: no such identity: /root/.ssh/id_ed25519_sk: No such <span class="token function">file</span> or directory
debug1: Trying private key: /root/.ssh/id_xmss
debug3: no such identity: /root/.ssh/id_xmss: No such <span class="token function">file</span> or directory
debug1: Trying private key: /root/.ssh/id_dsa
debug3: no such identity: /root/.ssh/id_dsa: No such <span class="token function">file</span> or directory
debug2: we did not send a packet, disable method
debug3: authmethod_lookup password
debug3: remaining preferred: ,password
debug3: authmethod_is_enabled password
debug1: Next authentication method: password
root@172.16.103.129's password: 
</code></pre> 
<p>一看最后中断的过程里，有关键提示：<code>debug1: send_pubkey_test: no mutual signature algorithm</code> ，提示后就开始进行相关尝试，只是都失败了，并 <code>we did not send a packet, disable method</code>。</p> 
<p>那就有了排错的初步查找资料了。</p> 
<p>经过查找，其中一篇文章的说明：<a href="https://confluence.atlassian.com/bitbucketserverkb/ssh-rsa-key-rejected-with-message-no-mutual-signature-algorithm-1026057701.html" rel="nofollow">SSH-RSA key rejected with message "no mutual signature algorithm</a></p> 
<p><img src="https://images2.imgbox.com/cc/a7/ojPeNAHQ_o.png" alt="在这里插入图片描述"></p> 
<p>文中有一句：任何运行<a href="https://www.openssh.com/txt/release-8.8" rel="nofollow">OpenSSH 8.8</a> 或更新版本的系统默认使用 SHA-1 哈希算法禁用 RSA 签名。</p> 
<p>因此，以往我们这些老司机直接的噼里啪啦一条命令，此时已经不再适用了，算法导致旧的RSA签名无效。</p> 
<p><img src="https://images2.imgbox.com/3d/60/RxSDFOli_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c8/36/7W7xMFFm_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h3><a id="_213"></a>📜处理方法</h3> 
<p>不难看出，解决方法就是生成密钥对时，使用ed25519的算法，这是最佳的处理办法，需要也有临时的处置方法，那就是在ssh时添加对应的选项：<code>-o PubkeyAcceptedKeyTypes=+ssh-rsa</code> ，有些文章还建议添加配置到配置文件，但并不建议这样做，因为既然有漏洞相关，那就用现在的方法。</p> 
<hr> 
<h4><a id="_219"></a>📑临时方法</h4> 
<p>在ssh时添加对应的选项：<code>-o PubkeyAcceptedKeyTypes=+ssh-rsa</code></p> 
<p><img src="https://images2.imgbox.com/08/f2/6sBhgVvQ_o.png" alt="在这里插入图片描述"></p> 
<p>不建议的处置方法，添加配置：</p> 
<pre><code class="prism language-shell"><span class="token comment"># vim /etc/ssh/ssh_config</span>
<span class="token comment"># 添加以下内容</span>
PubkeyAcceptedKeyTypes +ssh-rsa
</code></pre> 
<hr> 
<h4><a id="_236"></a>📑最佳方式</h4> 
<p>使用ed25519的算法生成密钥，之后再直接复制密钥去对应的机器。</p> 
<pre><code class="prism language-shell"><span class="token comment"># ssh-keygen -t ed25519</span>
Generating public/private ed25519 key pair.
Enter <span class="token function">file</span> <span class="token keyword">in</span> <span class="token function">which</span> to save the key <span class="token punctuation">(</span>/root/.ssh/id_ed25519<span class="token punctuation">)</span>: 
Enter passphrase <span class="token punctuation">(</span>empty <span class="token keyword">for</span> no passphrase<span class="token punctuation">)</span>: 
Enter same passphrase again: 
Your identification has been saved <span class="token keyword">in</span> /root/.ssh/id_ed25519.
Your public key has been saved <span class="token keyword">in</span> /root/.ssh/id_ed25519.pub.
The key fingerprint is:
SHA256:m4fsH0mCqg3ovPLwVNQxJHlpmQjMb037iT+Unv0jCQM root@glusternode5
The key<span class="token string">'s randomart image is:
+--[ED25519 256]--+
| o...+++         |
|  o ooBo         |
|   ..=..         |
|   .o E.         |
|   .. .+So.      |
| . . ...B* .     |
|o o .  +==+.     |
|++ +   .=.+..    |
|.== .   .o.o..   |
+----[SHA256]-----+

# ssh-copy-id root@172.16.103.129
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/root/.ssh/id_ed25519.pub"
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
root@172.16.103.129'</span>s password: 

Number of key<span class="token punctuation">(</span>s<span class="token punctuation">)</span> added: <span class="token number">1</span>

Now try logging into the machine, with:   <span class="token string">"ssh 'root@172.16.103.129'"</span>
and check to <span class="token function">make</span> sure that only the key<span class="token punctuation">(</span>s<span class="token punctuation">)</span> you wanted were added.

</code></pre> 
<p><img src="https://images2.imgbox.com/89/7f/fRhxc4bg_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/7a/05/iOCe2rMu_o.png" alt="在这里插入图片描述"></p> 
<p>最后，当然是直接ssh过去就OK了。</p> 
<hr> 
<h3><a id="_285"></a>💡总结</h3> 
<p>故障到此已处理完毕，在查阅资料过程中，发现有一些场景是设置 git 中的ssh拉取而出现类似的故障现象，但归因都一致，都是sshd服务的相关设置和运用。</p> 
<p>遇到报错要学会查看日志，利用相关命令参数做debug，抽取关键信息进行搜索和检索。</p> 
<p>扎实的基础有利于排除故障并学习更多的知识和技能，共同努力，好好加油🤪。</p> 
<p><img src="https://images2.imgbox.com/0a/b4/QpxmfuHr_o.png" alt=""></p> 
<p>以上就是【金鱼哥】对 <strong>此次SSH免密操作所遇故障</strong> 的简述和讲解。希望能对看到此文章的小伙伴有所帮助。</p> 
<blockquote> 
 <p>💾<strong>日常故障</strong>专栏系列：<a href="https://blog.csdn.net/qq_41765918/category_11630822.html">金鱼哥的TroubleShooting</a></p> 
</blockquote> 
<p>如果这篇【文章】有帮助到你，希望可以给【金鱼哥】点个赞👍，创作不易，相比官方的陈述，我更喜欢用【通俗易懂】的文笔去讲解每一个知识点。</p> 
<p>如果有对【运维技术】感兴趣，也欢迎关注❤️❤️❤️ 【金鱼哥】❤️❤️❤️，我将会给你带来巨大的【收获与惊喜】💕💕！</p> 
<p><img src="https://images2.imgbox.com/60/b1/zZdIbbdf_o.png" alt=""></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/060177c319c9ba504c18d7aec63cebb7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Unity project 发布成Standalone EXE版本后，它的Debug infomation在什么位置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/801e9e84642c7c129723f77c5f08b485/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">forEach、map和filter的区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>