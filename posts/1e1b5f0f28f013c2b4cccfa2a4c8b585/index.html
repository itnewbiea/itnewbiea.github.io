<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【C&#43;&#43;】基于EasyX库的2048小游戏 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【C&#43;&#43;】基于EasyX库的2048小游戏" />
<meta property="og:description" content="文章目录 0 前言1 先看一下最终的效果图2 2048核心2 EasyX库2.1 配色2.2 文字2.3 填充 3 总结 0 前言 最近比较迷2048小游戏，于是想自己写代码实现出来，恰好也在网上找到一个现成的2048的VS工程，但是界面做得很难看，且运行逻辑存在一定问题，于是花了一天时间把原2048工程完善了一下，记录一下实践要点。
1 先看一下最终的效果图 2 2048核心 既然要做2048游戏，首先是要实现2048这个游戏规则。由于C语言中没有Python语言中便捷操作矩阵的方法，因此只能老实定义二维数组、然后用循环去实现。因此代码相对复杂。
#include &lt;iostream&gt; #include &lt;conio.h&gt; #include &lt;stdlib.h&gt; using namespace std; //#include&#34;2048base.h&#34; /*矩阵转置*/ void transform(int *p, int len) { for (int i = 0; i &lt; len; i&#43;&#43;) for (int j = 0; j &lt; len; j&#43;&#43;) if (i&gt;j) //转置时只需要更新对角部分即可 { int tmp = *(p &#43; i*len &#43; j); *(p &#43; i*len &#43; j) = *(p &#43; j*len &#43; i); *(p &#43; j*len &#43; i) = tmp; } } /*删除某一行数据中的零元素——把零元素根据rev往一个方向去堆叠*/ void delZeros(int *p, int len, bool rev) { int k = rev ?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/1e1b5f0f28f013c2b4cccfa2a4c8b585/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-12T19:27:43+08:00" />
<meta property="article:modified_time" content="2023-01-12T19:27:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【C&#43;&#43;】基于EasyX库的2048小游戏</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#0__2" rel="nofollow">0 前言</a></li><li><a href="#1__5" rel="nofollow">1 先看一下最终的效果图</a></li><li><a href="#2_2048_9" rel="nofollow">2 2048核心</a></li><li><a href="#2_EasyX_205" rel="nofollow">2 EasyX库</a></li><li><ul><li><a href="#21__208" rel="nofollow">2.1 配色</a></li><li><a href="#22__213" rel="nofollow">2.2 文字</a></li><li><a href="#23__219" rel="nofollow">2.3 填充</a></li></ul> 
  </li><li><a href="#3__222" rel="nofollow">3 总结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="0__2"></a>0 前言</h2> 
<p>  最近比较迷2048小游戏，于是想自己写代码实现出来，恰好也在网上找到一个现成的2048的VS工程，但是界面做得很难看，且运行逻辑存在一定问题，于是花了一天时间把原2048工程完善了一下，记录一下实践要点。</p> 
<h2><a id="1__5"></a>1 先看一下最终的效果图</h2> 
<p><img src="https://images2.imgbox.com/81/10/wck8JepE_o.png" alt="在这里插入图片描述" width="500"></p> 
<h2><a id="2_2048_9"></a>2 2048核心</h2> 
<p>  既然要做2048游戏，首先是要实现2048这个游戏规则。由于C语言中没有Python语言中便捷操作矩阵的方法，因此只能老实定义二维数组、然后用循环去实现。因此代码相对复杂。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;conio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//#include"2048base.h"</span>

<span class="token comment">/*矩阵转置*/</span>
<span class="token keyword">void</span> <span class="token function">transform</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">&gt;</span>j<span class="token punctuation">)</span> <span class="token comment">//转置时只需要更新对角部分即可</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">int</span> tmp <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> i<span class="token operator">*</span>len <span class="token operator">+</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> i<span class="token operator">*</span>len <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> j<span class="token operator">*</span>len <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> j<span class="token operator">*</span>len <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/*删除某一行数据中的零元素——把零元素根据rev往一个方向去堆叠*/</span>
<span class="token keyword">void</span> <span class="token function">delZeros</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">,</span> <span class="token keyword">bool</span> rev<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> k <span class="token operator">=</span> rev <span class="token operator">?</span> <span class="token punctuation">(</span>len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> step <span class="token operator">=</span> rev <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> rev <span class="token operator">?</span> <span class="token punctuation">(</span>len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> len <span class="token operator">&amp;&amp;</span> j <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
            k <span class="token operator">+=</span> step<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        j <span class="token operator">+=</span> step<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> k<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> len <span class="token operator">&amp;&amp;</span> j <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        j <span class="token operator">+=</span> step<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/*合并一行数据的相同元素,返回得分*/</span>
<span class="token keyword">int</span> <span class="token function">combine</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">,</span> <span class="token keyword">bool</span> rev<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> score <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>				 <span class="token comment">// 得分</span>
    <span class="token keyword">int</span> k <span class="token operator">=</span> rev <span class="token operator">?</span> <span class="token punctuation">(</span>len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 主要的顺序变量</span>
    <span class="token keyword">int</span> step <span class="token operator">=</span> rev <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>	 <span class="token comment">// 步长，和是否反向有关</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> rev <span class="token operator">?</span> <span class="token punctuation">(</span>len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len <span class="token operator">&amp;&amp;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> step<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> i <span class="token operator">+</span> step<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token punctuation">(</span>rev <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            k <span class="token operator">+=</span> step<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
            i <span class="token operator">+=</span> step<span class="token punctuation">;</span> <span class="token comment">// i跳过重复数字的位置</span>
            k <span class="token operator">+=</span> step<span class="token punctuation">;</span>
            score <span class="token operator">+=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> k<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> len <span class="token operator">&amp;&amp;</span> j <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">+=</span> step<span class="token punctuation">)</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// k没遍历完，补零</span>
    <span class="token keyword">return</span> score<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*输出二维数组*/</span>
<span class="token keyword">void</span> <span class="token function">out</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> i <span class="token operator">*</span> len <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token char">' '</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*判断移动前后数组是否发生改变*/</span>
<span class="token keyword">bool</span> <span class="token function">ifchange</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>q<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">bool</span> flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> i<span class="token operator">*</span>len <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">*</span><span class="token punctuation">(</span>q <span class="token operator">+</span> i<span class="token operator">*</span>len <span class="token operator">+</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> flag<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*对数组进行堆叠。p为需要堆叠的一行/列数据，len为边长，rev判断是否反向[从左至右], transform判断是否需要转置[上/下]。
 *默认的矩阵顺序：行从上到下；列从左至右。计算时，遍历每一行，堆叠每一列
 *返回数组堆叠前后是否发生变化
 */</span>
<span class="token keyword">bool</span> <span class="token function">pileRows</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">,</span> <span class="token keyword">bool</span> rev<span class="token punctuation">,</span> <span class="token keyword">bool</span> trans<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>score<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> <span class="token operator">*</span>q <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>len<span class="token operator">*</span>len<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>len<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token operator">*</span><span class="token punctuation">(</span>q <span class="token operator">+</span> i<span class="token operator">*</span>len <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> i<span class="token operator">*</span>len <span class="token operator">+</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//先复制一遍，方便判断数组是否发生改变</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>trans<span class="token punctuation">)</span> <span class="token function">transform</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 转置</span>
    <span class="token comment">// out(p, len);</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">// 遍历每一行</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> <span class="token operator">*</span>q <span class="token operator">=</span> p <span class="token operator">+</span> i <span class="token operator">*</span> len<span class="token punctuation">;</span>     <span class="token comment">// 构造一行数据对应的指针</span>
        <span class="token comment">// for(int i=0;i&lt;len;i++) cout &lt;&lt; *(q+i) &lt;&lt; " ";cout &lt;&lt; endl;</span>
        <span class="token function">delZeros</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span> len<span class="token punctuation">,</span> rev<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 先把这一行中的零元素往一个方向堆叠</span>
        <span class="token comment">// for(int i=0;i&lt;len;i++) cout &lt;&lt; *(q+i) &lt;&lt; " ";cout &lt;&lt; endl;</span>
        <span class="token operator">*</span>score <span class="token operator">+=</span> <span class="token function">combine</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span> len<span class="token punctuation">,</span> rev<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//合并相同元素，并获得得分</span>
        <span class="token comment">// for(int i=0;i&lt;len;i++) cout &lt;&lt; *(q+i) &lt;&lt; " ";cout &lt;&lt; endl;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// out(p, len);</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>trans<span class="token punctuation">)</span> <span class="token function">transform</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 操作完了，再转置回来</span>
    <span class="token keyword">return</span> <span class="token function">ifchange</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 返回数组是否发生变化的标志</span>
<span class="token punctuation">}</span>

<span class="token comment">/*添加随机数*/</span>
<span class="token keyword">void</span> <span class="token function">AddNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span>
    <span class="token keyword">do</span>
    <span class="token punctuation">{<!-- --></span>
        x <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">;</span>
        y <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> x <span class="token operator">*</span> len <span class="token operator">+</span> y<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 找到数字为零的位置</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">9</span> <span class="token operator">&gt;=</span> <span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment">// 4出现的概率为4/9</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> x <span class="token operator">*</span> len <span class="token operator">+</span> y<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> x <span class="token operator">*</span> len <span class="token operator">+</span> y<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*运行2048*/</span>
<span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>score<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">char</span> key <span class="token operator">=</span> <span class="token function">getch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">72</span><span class="token operator">:</span> <span class="token comment">//"up"</span>
    <span class="token keyword">case</span> <span class="token char">'w'</span><span class="token operator">:</span>
    <span class="token keyword">case</span> <span class="token char">'W'</span><span class="token operator">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">pileRows</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> len<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> score<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">AddNum</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//只有数组发生改变才增加一个随机数</span>
        <span class="token comment">//out(p, len);</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">80</span><span class="token operator">:</span> <span class="token comment">//"down"</span>
    <span class="token keyword">case</span> <span class="token char">'s'</span><span class="token operator">:</span>
    <span class="token keyword">case</span> <span class="token char">'S'</span><span class="token operator">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">pileRows</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> len<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> score<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">AddNum</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//out(p, len);</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">75</span><span class="token operator">:</span> <span class="token comment">//"left"</span>
    <span class="token keyword">case</span> <span class="token char">'a'</span><span class="token operator">:</span>
    <span class="token keyword">case</span> <span class="token char">'A'</span><span class="token operator">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">pileRows</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> len<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> score<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">AddNum</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//out(p, len);</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">77</span><span class="token operator">:</span> <span class="token comment">//"right"</span>
    <span class="token keyword">case</span> <span class="token char">'d'</span><span class="token operator">:</span>
    <span class="token keyword">case</span> <span class="token char">'D'</span><span class="token operator">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">pileRows</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> len<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> score<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">AddNum</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// out(p, len);</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/*主程序，测试用*/</span>
<span class="token comment">//int main()</span>
<span class="token comment">//{<!-- --></span>
<span class="token comment">//    int b[4][4] = { 4, 0, 0, 0,</span>
<span class="token comment">//        2, 0, 0, 0,</span>
<span class="token comment">//        8, 0, 0, 0,</span>
<span class="token comment">//        2, 0, 0, 0 };</span>
<span class="token comment">//    int *score = new int;</span>
<span class="token comment">//    *score = 0;</span>
<span class="token comment">//    int *x = (int *)b;</span>
<span class="token comment">//    while (1)</span>
<span class="token comment">//    {<!-- --></span>
<span class="token comment">//        run(x, 4, score);</span>
<span class="token comment">//        out(x, 4);</span>
<span class="token comment">//    }</span>
<span class="token comment">//</span>
<span class="token comment">//    // int a[] = {2,2,1,2};</span>
<span class="token comment">//    // cout &lt;&lt; combine(a,4,true);</span>
<span class="token comment">//    // for(int i=0; i&lt;4; i++) cout &lt;&lt; a[i] &lt;&lt; " ";</span>
<span class="token comment">//    return 0;</span>
<span class="token comment">//}</span>
</code></pre> 
<p>  以上代码可以概括为几个要点：①先堆叠零，往哪个方向移动就往另一边堆叠零；②合并相同的数，并计算得分；③以上两个操作都是按行操作，即左右移动时。如果是上下移动，需要先对数组进行转置，再进行以上操作，操作完了再转置回来。④最后是判断数组是否发生变化，再选择是否需要增加随机数。<br>   需要注意的就是写代码的时候逻辑要清晰，而且建议<strong>以指针作为参数传入，只修改指针指向的内容，不修改指针本身，这样可以尽量减少函数返回值</strong>。</p> 
<h2><a id="2_EasyX_205"></a>2 EasyX库</h2> 
<p>  实现完了核心部分，接下来就是制作界面了。这里使用的是C++的一个第三方库——EasyX，这是一个可以用来绘制界面的库，而且使用起来相对方便。具体安装方法和使用方法可以参考<a href="https://docs.easyx.cn/zh-cn/intro" rel="nofollow"><strong>官方文档</strong></a>，内容非常详细。</p> 
<h3><a id="21__208"></a>2.1 配色</h3> 
<p>  由于本人实在没有艺术细胞，关于这个游戏的配色，是完全参考自一个2048的在线游戏，链接在<a href="http://www.2048123.com/" rel="nofollow">这里</a>。如下图所示。<br> <img src="https://images2.imgbox.com/a1/69/aoxy52B7_o.png" alt="在这里插入图片描述" width="500"></p> 
<h3><a id="22__213"></a>2.2 文字</h3> 
<p>  在显示文字方面，这里采用的是<code>outtextxy</code>函数，可以在指定位置输出设定的文本，不过它默认是有背景色作为填充的，可以在调用该函数先设置一下：<br> <img src="https://images2.imgbox.com/f7/d6/fL3Av69Y_o.png" alt="在这里插入图片描述" width="600"></p> 
<p>  另外，这个第三方库和MFC不一样，可以指定某段文本的属性，它是设置完属性后，如字体的颜色，大小等，之后所有写入的文本都会按照这个属性来，所以在调用该函数前，记得先设置好属性。</p> 
<h3><a id="23__219"></a>2.3 填充</h3> 
<p>  2048如果只是数字的移动看起来不太方便，最好是要有不同颜色的方块。好在EasyX库也支持填充函数<code>fillrectangle</code>。和上面一样，每次使用前都需要设置好属性。</p> 
<h2><a id="3__222"></a>3 总结</h2> 
<p>  本博客主要记录了一下自己使用C++实践2048小游戏时的一些心得体会，同时提供了核心代码。颜色渲染部分建议还是去认真看一下官方文档，写得挺明白的。总的来说，这个项目不是很难。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/341810527f973acf83e2d247a5500682/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于pytorch写一个多对多预测代码，数据集名称为data.csv，前四列为特征，后面50列为标签，前800行为训练集其余为测试集，将其中一组预测值与真实值输出到excel工作表中...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/042d6f7a0ac990696119e0012d1fe4d6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android SDK的安装配置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>