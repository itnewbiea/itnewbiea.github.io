<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>面向开放词汇的目标检测ECCV2022 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="面向开放词汇的目标检测ECCV2022" />
<meta property="og:description" content="目录 1.贡献2.方法2.1.Open Vocabulary Object Detector2.2.通过Detector Training实现对齐2.3.通过Regional Prompt Learning对齐2.4.PromptDet：通过自训练对齐 3.实验 1.贡献 这项工作的目标是建立一个可扩展的pipeline，使用零手动注释将目标检测器扩展到新的类别。为了实现这一点，做出了以下四个贡献：
为了实现泛化，我们提出了一个两阶段的开放词汇表对象检测器，其中类不可知的对象proposal区域通过预先训练的视觉-语言模型中的文本编码器进行分类；为了将视觉潜在空间（RPN box proposal）与预先训练的文本编码器的视觉潜在空间配对，我们提出了区域提示学习（regional prompt）的思想，以使文本嵌入空间与regional visual object特征对齐；为了扩大学习过程，以检测更广泛的对象，我们通过一个新的自训练框架来利用可用的在线资源，该框架允许在大量未经处理的网络图像上训练我们提出的检测器。最后，为了评估我们提出的检测器PromptDet，我们对具有挑战性的LVIS和MS-COCO数据集进行了广泛的实验。 PromptDet的性能优于现有方法，并且只需较少的额外训练图像和零手动注释。
图1：提出的PromptDet是一个框架，用于扩展目标检测器中的词汇表，并且无需人工注释。该图描述了模型在LVIS验证集上生成的检测示例，蓝色和绿色框分别表示基本类别和新类别的目标对象。尽管没有为新类别提供GroundTruth，PromptDet仍然能够以高精度可靠地定位和识别这些目标。 相关工作：Zero-shot learning
Zero-shot learning旨在将已经学到的知识从看得见的目标类别迁移到新的类别。在目标检测领域，早期的工作利用视觉属性：比如类别的层次结构，类别的相似度，目标对象的局部part，从而将看得见的类别泛化到看不见的类别；其他研究方向学习将视觉样本和语义描述符映射到联合嵌入空间，并计算嵌入空间中图像和文本之间的相似性。
个人对zero-shot learning的理解
我认为分类任务的尽头其实是：类别的名称只是一个描述，我们要学会区分新类别和过去见过的类别，同时要能区分新类别中的各个不同的类别。zero-shot learning应当属于分类任务的最终目的。
设想第一个发现秃鹰（Bald eagle）的研究者，他可以简单地给这个物种命名Bald eagle，这群秃鹰的特征是相似的：翼展6-7英尺，深褐色或白色的尾巴，白色的头，明亮的黄色眼睛。尽管研究者事先并不知道什么是“秃鹰”，但是他能确定这是与以前发现的物种不同的动物。
一般来说，目前zero-shot learning 方法会遵循三种学习范式之一：
从属性中学习。一个类别可以伴随一个结构化的描述，例如，“白色的头“和“黄色的嘴“描述一个秃鹰。这允许算法将输入分解为描述类的元素，即使它没有看到该类的任何显式示例；从文字描述中学习。一个类别可以附带一个文本的自然语言描述，就像一本词典或者一个百科全书的单词入口。这允许模型在仅给定类别描述的情况下解释输入并将其映射到类别。独立学习。类别被嵌入到一个连续的空间中，zero-shot 分类器可以区分embedding的位置以确定输出。由于不需要每个类别显式的属性或文本描述，这种方法更符合 zero-shot learning 的目标，但是可能表现得比较差。 2.方法 在本文中，我们的目标是扩展标准的 2 stage 目标检测器的词汇表，以最少的手动操作定位和识别新类别对象。本节的组织方式如下，我们首先介绍构建开放词汇表检测器的基本模块，该检测器可以检测封闭集合之外的任意类别的对象；在第2.2节中，我们通过继承CLIP的文本编码器作为分类器生成器，描述了将视觉主干与冻结语言模型配对的基本思想；在第2.3节中，为了鼓励以目标对象为中心的视觉表示和文本表示之间的一致性，我们引入了区域提示学习（RPL，regional prompt learning）；在第2.4节中，我们介绍了一种迭代学习方案，它可以有效地利用未经处理的web图像，寻找新类别的高质量候选图像。因此，我们提出的开放词汇检测器，称为PromptDet，可以用可扩展的方式对这些候选图像进行自训练。
2.1.Open Vocabulary Object Detector 假设我们有一个目标检测数据集 D t r a i n D_{train} Dtrain​，包含一组基本类别的注释 C t r a i n = C b a s e C_{train}=C_{base} Ctrain​=Cbase​，比如 D t r a i n = { ( I 1 , y 1 ) , ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/4cb9d73599aee89e8a78cb3e6485e5be/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-20T20:08:03+08:00" />
<meta property="article:modified_time" content="2022-09-20T20:08:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">面向开放词汇的目标检测ECCV2022</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/f0/6d/4p90Z6zx_o.png" alt="fig1"><br> </p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#1_3" rel="nofollow">1.贡献</a></li><li><a href="#2_31" rel="nofollow">2.方法</a></li><li><ul><li><a href="#21Open_Vocabulary_Object_Detector_33" rel="nofollow">2.1.Open Vocabulary Object Detector</a></li><li><a href="#22Detector_Training_46" rel="nofollow">2.2.通过Detector Training实现对齐</a></li><li><a href="#23Regional_Prompt_Learning_58" rel="nofollow">2.3.通过Regional Prompt Learning对齐</a></li><li><a href="#24PromptDet_66" rel="nofollow">2.4.PromptDet：通过自训练对齐</a></li></ul> 
  </li><li><a href="#3_85" rel="nofollow">3.实验</a></li></ul> 
</div> 
<p></p> 
<h2><a id="1_3"></a>1.贡献</h2> 
<p>这项工作的目标是建立一个可扩展的pipeline，使用零手动注释将目标检测器扩展到新的类别。为了实现这一点，做出了以下四个贡献：</p> 
<ul><li>为了实现泛化，我们提出了一个两阶段的开放词汇表对象检测器，其中类不可知的对象proposal区域通过预先训练的视觉-语言模型中的文本编码器进行分类；</li><li>为了将视觉潜在空间（RPN box proposal）与预先训练的文本编码器的视觉潜在空间配对，我们提出了区域提示学习（regional prompt）的思想，以使文本嵌入空间与regional visual object特征对齐；</li><li>为了扩大学习过程，以检测更广泛的对象，我们通过一个新的自训练框架来利用可用的在线资源，该框架允许在大量未经处理的网络图像上训练我们提出的检测器。</li><li>最后，为了评估我们提出的检测器PromptDet，我们对具有挑战性的LVIS和MS-COCO数据集进行了广泛的实验。</li></ul> 
<p>PromptDet的性能优于现有方法，并且只需较少的额外训练图像和零手动注释。</p> 
<p><img src="https://images2.imgbox.com/80/e6/3cefqTkd_o.png" alt="fig2"></p> 
<ul><li>图1：提出的PromptDet是一个框架，用于扩展目标检测器中的词汇表，并且无需人工注释。该图描述了模型在LVIS验证集上生成的检测示例，蓝色和绿色框分别表示基本类别和新类别的目标对象。尽管没有为新类别提供GroundTruth，PromptDet仍然能够以高精度可靠地定位和识别这些目标。</li></ul> 
<hr> 
<p><strong>相关工作：Zero-shot learning</strong><br> Zero-shot learning旨在将已经学到的知识从看得见的目标类别迁移到新的类别。在目标检测领域，早期的工作利用视觉属性：比如类别的层次结构，类别的相似度，目标对象的局部part，从而将看得见的类别泛化到看不见的类别；其他研究方向学习将视觉样本和语义描述符映射到联合嵌入空间，并计算嵌入空间中图像和文本之间的相似性。</p> 
<p><strong>个人对zero-shot learning的理解</strong><br> 我认为分类任务的尽头其实是：类别的名称只是一个描述，我们要学会区分新类别和过去见过的类别，同时要能区分新类别中的各个不同的类别。zero-shot learning应当属于分类任务的最终目的。</p> 
<p>设想第一个发现秃鹰（Bald eagle）的研究者，他可以简单地给这个物种命名Bald eagle，这群秃鹰的特征是相似的：翼展6-7英尺，深褐色或白色的尾巴，白色的头，明亮的黄色眼睛。尽管研究者事先并不知道什么是“秃鹰”，但是他能确定这是与以前发现的物种不同的动物。</p> 
<p>一般来说，目前zero-shot learning 方法会遵循三种学习范式之一：</p> 
<ul><li>从属性中学习。一个类别可以伴随一个结构化的描述，例如，“白色的头“和“黄色的嘴“描述一个秃鹰。这允许算法将输入分解为描述类的元素，即使它没有看到该类的任何显式示例；</li><li>从文字描述中学习。一个类别可以附带一个文本的自然语言描述，就像一本词典或者一个百科全书的单词入口。这允许模型在仅给定类别描述的情况下解释输入并将其映射到类别。</li><li>独立学习。类别被嵌入到一个连续的空间中，zero-shot 分类器可以区分embedding的位置以确定输出。由于不需要每个类别显式的属性或文本描述，这种方法更符合 zero-shot learning 的目标，但是可能表现得比较差。</li></ul> 
<hr> 
<h2><a id="2_31"></a>2.方法</h2> 
<p>在本文中，我们的目标是扩展标准的 2 stage 目标检测器的词汇表，以最少的手动操作定位和识别新类别对象。本节的组织方式如下，我们首先介绍构建开放词汇表检测器的基本模块，该检测器可以检测封闭集合之外的任意类别的对象；在第2.2节中，我们通过继承CLIP的文本编码器作为分类器生成器，描述了将视觉主干与冻结语言模型配对的基本思想；在第2.3节中，为了鼓励以目标对象为中心的视觉表示和文本表示之间的一致性，我们引入了区域提示学习（RPL，regional prompt learning）；在第2.4节中，我们介绍了一种迭代学习方案，它可以有效地利用未经处理的web图像，寻找新类别的高质量候选图像。因此，我们提出的开放词汇检测器，称为PromptDet，可以用可扩展的方式对这些候选图像进行自训练。</p> 
<h3><a id="21Open_Vocabulary_Object_Detector_33"></a>2.1.Open Vocabulary Object Detector</h3> 
<p>假设我们有一个目标检测数据集<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          D 
         
         
         
           t 
          
         
           r 
          
         
           a 
          
         
           i 
          
         
           n 
          
         
        
       
      
        D_{train} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal mtight">ain</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，包含一组基本类别的注释<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          C 
         
         
         
           t 
          
         
           r 
          
         
           a 
          
         
           i 
          
         
           n 
          
         
        
       
         = 
        
        
        
          C 
         
         
         
           b 
          
         
           a 
          
         
           s 
          
         
           e 
          
         
        
       
      
        C_{train}=C_{base} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal mtight">ain</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，比如<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          D 
         
         
         
           t 
          
         
           r 
          
         
           a 
          
         
           i 
          
         
           n 
          
         
        
       
         = 
        
        
        
          { 
         
        
          ( 
         
         
         
           I 
          
         
           1 
          
         
        
          , 
         
         
         
           y 
          
         
           1 
          
         
        
          ) 
         
        
          , 
         
        
          . 
         
        
          . 
         
        
          . 
         
        
          , 
         
        
          ( 
         
         
         
           I 
          
         
           n 
          
         
        
          , 
         
         
         
           y 
          
         
           n 
          
         
        
          ) 
         
        
          } 
         
        
       
      
        D_{train}=\left\{(I_{1},y_{1}),...,(I_{n},y_{n})\right\} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal mtight">ain</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{<!-- --></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;">}</span></span></span></span></span></span>，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          I 
         
        
          i 
         
        
       
         ∈ 
        
        
        
          R 
         
         
         
           H 
          
         
           × 
          
         
           W 
          
         
           × 
          
         
           3 
          
         
        
       
      
        I_{i}\in R^{H\times W\times 3} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0813em;">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">W</span><span class="mbin mtight">×</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></span>指第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
      
        i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span>张图像，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          y 
         
        
          i 
         
        
       
         = 
        
        
         
         
           { 
          
         
           ( 
          
          
          
            b 
           
          
            i 
           
          
         
           , 
          
          
          
            c 
           
          
            i 
           
          
         
           ) 
          
         
           } 
          
         
        
          m 
         
        
       
      
        y_{i}=\left\{(b_{i},c_{i})\right\}^{m} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0543em; vertical-align: -0.25em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{<!-- --></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;">}</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8043em;"><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span></span>表示坐标<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          b 
         
        
          i 
         
        
          k 
         
        
       
         ∈ 
        
        
        
          R 
         
        
          4 
         
        
       
      
        b_{i}^{k}\in R^{4} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.1078em; vertical-align: -0.2587em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8491em;"><span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2587em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span></span>和类别<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          c 
         
        
          i 
         
        
          k 
         
        
       
         ∈ 
        
        
        
          R 
         
         
         
           C 
          
          
          
            b 
           
          
            a 
           
          
            s 
           
          
            e 
           
          
         
        
       
      
        c_{i}^{k}\in R^{C_{base}} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.1078em; vertical-align: -0.2587em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8491em;"><span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2587em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3488em; margin-left: -0.0715em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1512em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>（该图像中一共<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         m 
        
       
      
        m 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span>个对象）。我们要训练能够在测试集<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          D 
         
         
         
           t 
          
         
           e 
          
         
           s 
          
         
           t 
          
         
        
       
      
        D_{test} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">es</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>上成功运行的目标检测器，测试集上的对象类别超出了<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          C 
         
         
         
           b 
          
         
           a 
          
         
           s 
          
         
           e 
          
         
        
       
      
        C_{base} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，测试集的对象类别为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          C 
         
         
         
           t 
          
         
           e 
          
         
           s 
          
         
           t 
          
         
        
       
         = 
        
        
        
          C 
         
         
         
           b 
          
         
           a 
          
         
           s 
          
         
           e 
          
         
        
       
         ∪ 
        
        
        
          C 
         
         
         
           n 
          
         
           o 
          
         
           v 
          
         
           e 
          
         
           l 
          
         
        
       
      
        C_{test}=C_{base}\cup C_{novel} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">es</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.0715em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">v</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right: 0.0197em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，因此被称为开放词汇检测器。特别是，我们在LIVS数据集上进行了实验，并将常见类作为基本类别，将罕见类作为新类别。</p> 
<p>一般来说，流行的 2 stage 目标检测器，例如MaskRCNN，由视觉主干编码器、区域建议网络（RPN）和分类模块组成：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           { 
          
          
           
           
             y 
            
           
             ^ 
            
           
          
            1 
           
          
         
           , 
          
         
           . 
          
         
           . 
          
         
           . 
          
         
           , 
          
          
           
           
             y 
            
           
             ^ 
            
           
          
            n 
           
          
         
           } 
          
         
        
          = 
         
         
         
           Φ 
          
          
          
            C 
           
          
            L 
           
          
            S 
           
          
         
        
          ∘ 
         
         
         
           Φ 
          
          
          
            R 
           
          
            P 
           
          
            N 
           
          
         
        
          ∘ 
         
         
         
           Φ 
          
          
          
            E 
           
          
            N 
           
          
            C 
           
          
         
        
          ( 
         
        
          I 
         
        
          ) 
         
        
       
         \left\{\widehat{y}_{1},...,\widehat{y}_{n}\right\}=\Phi_{CLS}\circ\Phi_{RPN}\circ\Phi_{ENC}(I) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{<!-- --></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6706em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span><span class="svg-align" style="width: calc(100% - 0.1111em); margin-left: 0.1111em; top: -3.4306em;"><span class="pstrut" style="height: 3em;"></span><span class="" style="height: 0.24em;"> 
              <svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"> 
               <path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"></path> 
              </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6706em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span><span class="svg-align" style="width: calc(100% - 0.1111em); margin-left: 0.1111em; top: -3.4306em;"><span class="pstrut" style="height: 3em;"></span><span class="" style="height: 0.24em;"> 
              <svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"> 
               <path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"></path> 
              </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">}</span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.109em;">RPN</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">ENC</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="mclose">)</span></span></span></span></span></span>因此，构建开放词汇表检测器需要解决以下两个后续问题：</p> 
<ul><li>有效生成类别无关的 regional proposal；</li><li>在视觉类别的闭集之外，准确对proposal的区域进行分类；</li></ul> 
<p><strong>类别无关的RPN</strong> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          Φ 
         
         
         
           R 
          
         
           P 
          
         
           N 
          
         
        
       
      
        \Phi_{RPN} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.109em;">RPN</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>：指的是proposal出可能有对象的所有区域的能力，不管其类别是什么。在这里，我们将anchor分类，bounding box回归，mask预测用类别无关的方式参数化，比如对所有类别都共享参数。</p> 
<p><strong>开放词汇表分类</strong> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          Φ 
         
         
         
           C 
          
         
           L 
          
         
           S 
          
         
        
       
      
        \Phi_{CLS} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>：目的是对视觉对象进行分类，使其超出固定大小的词汇表。我们假设，视觉和自然语言之间存在一个共同的潜在空间，因此可以通过寻找视觉对象在语言潜在空间中的最接近嵌入来对其进行分类，例如，将一个区域划分为“杏仁almond”或“狗dog”，可以计算出“杏仁almond“的分类概率：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           c 
          
          
          
            a 
           
          
            l 
           
          
            m 
           
          
            o 
           
          
            n 
           
          
            d 
           
          
         
        
          = 
         
         
         
           ϕ 
          
          
          
            t 
           
          
            e 
           
          
            x 
           
          
            t 
           
          
         
        
          ( 
         
        
          g 
         
        
          ( 
         
        
          " 
         
        
          t 
         
        
          h 
         
        
          i 
         
        
          s 
         
        
          − 
         
        
          i 
         
        
          s 
         
        
          − 
         
        
          a 
         
        
          − 
         
        
          p 
         
        
          h 
         
        
          o 
         
        
          t 
         
        
          o 
         
        
          − 
         
        
          o 
         
        
          f 
         
        
          − 
         
        
          [ 
         
        
          a 
         
        
          l 
         
        
          m 
         
        
          o 
         
        
          n 
         
        
          d 
         
        
          ] 
         
        
          " 
         
        
          ) 
         
        
          ) 
         
        
       
         c_{almond}=\phi_{text}(g("this-is-a-photo-of-[almond]")) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mopen">(</span><span class="mord">"</span><span class="mord mathnormal">t</span><span class="mord mathnormal">hi</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7429em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mclose">]</span><span class="mord">"</span><span class="mclose">))</span></span></span></span></span></span><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           c 
          
          
          
            d 
           
          
            o 
           
          
            g 
           
          
         
        
          = 
         
         
         
           ϕ 
          
          
          
            t 
           
          
            e 
           
          
            x 
           
          
            t 
           
          
         
        
          ( 
         
        
          g 
         
        
          ( 
         
        
          " 
         
        
          t 
         
        
          h 
         
        
          i 
         
        
          s 
         
        
          − 
         
        
          i 
         
        
          s 
         
        
          − 
         
        
          a 
         
        
          − 
         
        
          p 
         
        
          h 
         
        
          o 
         
        
          t 
         
        
          o 
         
        
          − 
         
        
          o 
         
        
          f 
         
        
          − 
         
        
          [ 
         
        
          d 
         
        
          o 
         
        
          g 
         
        
          ] 
         
        
          " 
         
        
          ) 
         
        
          ) 
         
        
       
         c_{dog}=\phi_{text}(g("this-is-a-photo-of-[dog]")) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mopen">(</span><span class="mord">"</span><span class="mord mathnormal">t</span><span class="mord mathnormal">hi</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7429em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">d</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mclose">]</span><span class="mord">"</span><span class="mclose">))</span></span></span></span></span></span><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           p 
          
          
          
            a 
           
          
            l 
           
          
            m 
           
          
            o 
           
          
            n 
           
          
            d 
           
          
         
        
          = 
         
         
          
          
            e 
           
          
            x 
           
          
            p 
           
          
            ( 
           
          
            &lt; 
           
          
            v 
           
          
            , 
           
           
           
             c 
            
            
            
              a 
             
            
              l 
             
            
              m 
             
            
              o 
             
            
              n 
             
            
              d 
             
            
           
          
            &gt; 
           
          
            / 
           
          
            t 
           
          
            ) 
           
          
          
          
            e 
           
          
            x 
           
          
            p 
           
          
            ( 
           
          
            &lt; 
           
          
            v 
           
          
            , 
           
           
           
             c 
            
            
            
              a 
             
            
              l 
             
            
              m 
             
            
              o 
             
            
              n 
             
            
              d 
             
            
           
          
            &gt; 
           
          
            / 
           
          
            t 
           
          
            ) 
           
          
            + 
           
          
            e 
           
          
            x 
           
          
            p 
           
          
            ( 
           
          
            &lt; 
           
          
            v 
           
          
            , 
           
           
           
             c 
            
            
            
              d 
             
            
              o 
             
            
              g 
             
            
           
          
            &gt; 
           
          
            / 
           
          
            t 
           
          
            ) 
           
          
         
        
       
         p_{almond}=\frac{exp(&lt;v,c_{almond}&gt;/t)}{exp(&lt;v,c_{almond}&gt;/t)+exp(&lt;v,c_{dog}&gt;/t)} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.3991em; vertical-align: -0.9721em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">/</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">/</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">/</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.9721em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         v 
        
       
         ∈ 
        
        
        
          R 
         
        
          D 
         
        
       
      
        v\in R^{D} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">v</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">D</span></span></span></span></span></span></span></span></span></span></span></span></span>表示region proposal的ROI pooled features，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         g 
        
       
         ( 
        
       
         ⋅ 
        
       
         ) 
        
       
      
        g(\cdot) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span>表示tokenisation程序，没有可学习参数，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          ϕ 
         
         
         
           t 
          
         
           e 
          
         
           x 
          
         
           t 
          
         
        
       
         ( 
        
       
         ⋅ 
        
       
         ) 
        
       
      
        \phi_{text}(\cdot) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span>表示将自然语言映射到embedding的网络，输入文本通常需要带有手动提示的模板，比如<code>"this is a photo of [category]"</code>，prompt范式将分类任务转换为与训练前使用的格式相同的格式。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>是温度参数，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         &lt; 
        
       
         a 
        
       
         , 
        
       
         b 
        
       
         &gt; 
        
       
      
        &lt;a,b&gt; 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span>表示计算向量相似度。通过优化分类损失来训练视觉主干，将相应类别的region视觉嵌入和文本嵌入配对。</p> 
<p><strong>讨论</strong>：定义开放词汇检测器很简单，但由于缺乏针对大规模数据集的详尽注释，训练此类模型将面临巨大挑战。 直到最近，大规模的视觉语言模型，如 CLIP 和 ALIGN，已经被训练来对齐视觉和语言之间的潜在空间。这些视觉语言模型受益于文本描述中的丰富信息，例如动作、物体、人与物体的交互和物体与物体之间的关系，在各种图像分类任务中表现出显著的“zero-shot”泛化，这为扩大物体检测器的词汇量提供了机会。</p> 
<h3><a id="22Detector_Training_46"></a>2.2.通过Detector Training实现对齐</h3> 
<p>在本节中，我们旨在用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          D 
         
         
         
           t 
          
         
           r 
          
         
           a 
          
         
           i 
          
         
           n 
          
         
        
       
      
        D_{train} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal mtight">ain</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>（仅包括base categories）训练一个开放词汇目标检测器（基于Mask-RCNN），仅使用基本类别优化视觉主干和类别无关的RPN，与继承自CLIP的预训练文本编码器的分类器对齐。见图2左侧。<br> <img src="https://images2.imgbox.com/03/b1/FiEAFfFm_o.png" alt="fig3"></p> 
<ul><li>图2：Left是提出的开放词汇检测器，将开放类别嵌入作为开放词汇表分类器的输出，训练视觉主干和CLIP的分类器对齐。Right是离线区域提示学习的程序。为所有基本类别提取crop，并使用其视觉嵌入优化可学习的prompt（2.3节有详细描述）</li></ul> 
<p>然而，正如实验所表明的那样，将视觉潜在空间与文本空间自然对齐只会产生非常有限的开放词汇检测性能。我们推测泛化能力差主要来自三个方面：</p> 
<ul><li>仅用类名（<code>"This is a photo of [category]"</code>）计算类别嵌入是次优的，因为它们可能不够精确，无法描述视觉概念，从而导致词汇歧义。例如，“杏仁almond”既指带硬壳的可食用椭圆形坚果，也指它生长的树；</li><li>用于训练CLIP的web图像是以场景为中心的，对象仅占图像的一小部分，而RPN的proposal要求将对象紧密地框起来，导致视觉表现上存在明显的领域差距；</li><li>用于检测器训练的基本类别与用于训练CLIP的基本类别相比差异显著较小，因此，可能不足以保证对新类别的泛化。</li></ul> 
<p>在下面的章节中，我们提出了一些简单的步骤来缓解上述问题。</p> 
<h3><a id="23Regional_Prompt_Learning_58"></a>2.3.通过Regional Prompt Learning对齐</h3> 
<p>与用于训练CLIP的以场景为中心的图像相比，RPN的输出特征是局部的和以对象为中心的。因此，如果将区域视觉表示与冻结的CLIP文本编码器对齐，将鼓励每个proposal捕获更多的上下文。为此，我们提出了一个简单的区域提示学习（RPL）概念，控制文本潜在空间以更好地适应以对象为中心的图像。</p> 
<p>具体来说，在计算类别分类器或嵌入时，我们在文本输入之前添加一系列可学习向量，称为“连续提示向量”（continuous prompt vectors）。这些提示向量与任何实际单词都不对应，并且将在后续层中处理，它们就像是一系列“虚拟标记virtual tokens”一样。此外，我们还将更详细的描述包含在提示模板中，以减轻词汇歧义，例如：<code>{category: "almond", description: "oval-shaped edible seed of the almond tree"}</code>。请注意，描述通常可以很容易地从维基百科或数据集中的元数据中获取。因此，每个单独类别的嵌入可以生成为：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           c 
          
          
          
            a 
           
          
            l 
           
          
            m 
           
          
            o 
           
          
            n 
           
          
            d 
           
          
         
        
          = 
         
         
         
           ϕ 
          
          
          
            t 
           
          
            e 
           
          
            x 
           
          
            t 
           
          
         
        
          ( 
         
        
          [ 
         
         
         
           p 
          
         
           1 
          
         
        
          , 
         
        
          . 
         
        
          . 
         
        
          . 
         
        
          , 
         
         
         
           p 
          
         
           j 
          
         
        
          , 
         
        
          g 
         
        
          ( 
         
        
          c 
         
        
          a 
         
        
          t 
         
        
          e 
         
        
          g 
         
        
          o 
         
        
          r 
         
        
          y 
         
        
          ) 
         
        
          , 
         
         
         
           p 
          
          
          
            j 
           
          
            + 
           
          
            1 
           
          
         
        
          , 
         
        
          . 
         
        
          . 
         
        
          . 
         
        
          , 
         
         
         
           p 
          
          
          
            j 
           
          
            + 
           
          
            h 
           
          
         
        
          , 
         
        
          g 
         
        
          ( 
         
        
          d 
         
        
          e 
         
        
          s 
         
        
          c 
         
        
          r 
         
        
          i 
         
        
          p 
         
        
          t 
         
        
          i 
         
        
          o 
         
        
          n 
         
        
          ) 
         
        
          ] 
         
        
          ) 
         
        
       
         c_{almond}=\phi_{text}([p_{1},...,p_{j},g(category),p_{j+1},...,p_{j+h},g(description)]) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0361em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">([</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mord mathnormal" style="margin-right: 0.0359em;">ory</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right: 0.0278em;">escr</span><span class="mord mathnormal">i</span><span class="mord mathnormal">pt</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mclose">)])</span></span></span></span></span></span>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          p 
         
        
          i 
         
        
       
      
        p_{i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示可学习的提示向量，其维度和word embedding的维度相同。由于可学习提示向量是类别无关的，并且为所有类别共享，因此在训练后，它们有望转移到新类别。</p> 
<p><strong>优化提示向量</strong><br> 为了节省计算，我们考虑离线学习提示向量，具体来说，我们从LVIS获取基本类别的对象crop，相应地调整它们的大小，并通过冻结的CLIP视觉编码器生成图像嵌入。为了优化提示向量，我们将视觉编码器和文本编码器都冻结，只更新可学习的提示向量，并使用标准交叉熵损失对这些图像crop进行分类。RPL的过程如图2（Right）所示。</p> 
<h3><a id="24PromptDet_66"></a>2.4.PromptDet：通过自训练对齐</h3> 
<p>到目前为止，通过将视觉主干与提示文本编码器对齐，我们已经获得了一个开放词汇表目标检测器。然而，RPL仅利用了有限的视觉多样性，即仅使用基本类别。在本节中，我们放宽了这种限制，并利用大规模、未经处理、嘈杂的web图像来进一步改进对齐。具体来说，如图3所示，我们描述了一个学习框架，该框架迭代RPL和候选图像，然后生成伪GT框，并对开放词汇检测器进行自训练。</p> 
<p><strong>寻找候选图像</strong><br> 我们将LAION-400M数据集作为初始图像-语料库，使用CLIP的视觉编码器预先计算视觉嵌入。为了获取每个类别的候选图像，我们计算视觉嵌入和类别嵌入之间的相似性分数，这是通过学习的区域提示计算的。我们保留了具有最高相似性的图像。因此，使用基本类别和新类别构建了一组额外的图像，并且没有可用的GT框，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          D 
         
         
         
           e 
          
         
           x 
          
         
           t 
          
         
        
       
         = 
        
        
         
         
           { 
          
         
           ( 
          
          
          
            I 
           
           
           
             e 
            
           
             x 
            
           
             t 
            
           
          
          
          
            ) 
           
          
            i 
           
          
         
           } 
          
         
         
         
           i 
          
         
           = 
          
         
           1 
          
         
         
         
           ∣ 
          
          
          
            D 
           
           
           
             e 
            
           
             x 
            
           
             t 
            
           
          
         
           ∣ 
          
         
        
       
      
        D_{ext}=\left\{(I_{ext})_{i}\right\}_{i=1}^{|D_{ext}|} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.3276em; vertical-align: -0.2997em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{<!-- --></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">}</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0279em;"><span class="" style="top: -2.4003em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2963em;"><span class="" style="top: -2.357em; margin-left: -0.0278em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2997em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。</p> 
<p><strong>迭代式提示学习</strong><br> 我们交替使用"区域提示学习"（图3 stage1）和"用学习到的提示寻找候选图像"（图3 stage2）。实验表明，这种迭代过程有利于高精度挖掘以对象为中心的图像。它能够生成更精确的伪GT框，因此，在自训练后，大大提高了对新类别的检测性能。</p> 
<p><img src="https://images2.imgbox.com/c8/3f/ROZamlIf_o.png" alt="fig4"></p> 
<ul><li>图3：自训练框架。</li><li>stage 1：使用基本类别来学习区域提示，如图2（Right）所示。</li><li>stage 2：通过学习的提示来获取来自Web的候选图像。</li><li>stage 3：我们使用基本类别的LVIS图像和新类别的源图像对检测器进行自训练。请注意，可以反复执行提示学习和候选图像的获取，以更好地检索相关图像。</li></ul> 
<p><strong>Bounding box生成</strong><br> 对于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          D 
         
         
         
           e 
          
         
           x 
          
         
           t 
          
         
        
       
      
        D_{ext} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>中的每一张图像，我们使用开放词汇表进行推理。由于这些候选图像通常是以对象为中心的，因此不受类别限制的RPN的输出对象proposal通常可以保证适当的精度和召回率。我们保留具有最大对象性分数的top-K proposal，然后保留具有最大分类分数的框作为每个图像的伪Ground Truth。请注意，尽管图像可能包含多个感兴趣的对象，但我们只选择一个框作为伪GT。总的来说，这种程序将成功地挖掘出大量以前未标记的伪GT实例，这些实例随后用于在Mask RCNN中重新训练视觉中枢和RPN（包括回归头）。</p> 
<h2><a id="3_85"></a>3.实验</h2> 
<p><img src="https://images2.imgbox.com/97/5a/hBDQrW1k_o.png" alt="fig5"></p> 
<ul><li>图4：候选图像上生成的伪GT。</li></ul> 
<p><img src="https://images2.imgbox.com/15/89/oxJ1ql7c_o.png" alt="fig6"></p> 
<ul><li>表1：手动设计提示和学习提示的比较。这里，我们在PRL中只使用两个可学习的提示向量，即[1+1]表示使用一个向量作为前缀，一个向量用作后缀。</li></ul>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/af5ff4006945a3f4b3c7165b7e7b9a77/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux下安装Mysql5.6，配置my.cnf并开启远程登录功能</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d2be9256ebf89d3af2ccd5916520a480/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">初学者学python用什么软件,python编程入门软件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>