<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Oracle里时间的应用 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Oracle里时间的应用" />
<meta property="og:description" content="1、转换函数 与date操作关系最大的就是两个转换函数：to_date(),to_char() to_date() 作用将字符类型按一定格式转化为日期类型： 具体用法:to_date(&#39;2004-11-27&#39;,&#39;yyyy-mm-dd&#39;),前者为字符串，后者为转换日期格式，注意，前后两者要以一对应。 如;to_date(&#39;2004-11-27 13:34:43&#39;, &#39;yyyy-mm-dd hh24:mi:ss&#39;) 将得到具体的时间 多种日期格式： YYYY：四位表示的年份 YYY，YY，Y：年份的最后三位、两位或一位，缺省为当前世纪 MM：01~12的月份编号 MONTH：九个字符表示的月份，右边用空格填补 MON：三位字符的月份缩写 WW：一年中的星期 D：星期中的第几天 DD：月份中的第几天 DDD：年所中的第几天 DAY：九个字符表示的天的全称，右边用空格补齐 HH，HH12：一天中的第几个小时，12进制表示法 HH24：一天中的第几个小时，取值为00~23 MI：一小时中的分钟 SS：一分钟中的秒 SSSS：从午夜开始过去的秒数 to_char():将日期转按一定格式换成字符类型 SQL&gt; select to_char(sysdate,&#39;yyyy-mm-dd hh24:mi:ss&#39;) time from dual; TIME ------------------- 2004-10-08 15:22:58 即把当前时间按yyyy-mm-dd hh24:mi:ss格式转换成字符类型 在oracle中处理日期大全 TO_DATE格式 Day: dd number 12 dy abbreviated fri day spelled out friday ddspth spelled out, ordinal twelfth Month: mm number 03 mon abbreviated mar month spelled out march Year: yy two digits 98 yyyy four digits 1998 24小时格式下时间范围为： 0:00:00 - 23:59:59." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/b4d8d77c617ed1b79e2a40095c541b65/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2006-08-23T14:03:00+08:00" />
<meta property="article:modified_time" content="2006-08-23T14:03:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Oracle里时间的应用</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    1、转换函数 
<br>与date操作关系最大的就是两个转换函数：to_date(),to_char() 
<br>to_date() 作用将字符类型按一定格式转化为日期类型： 
<br>具体用法:to_date('2004-11-27','yyyy-mm-dd'),前者为字符串，后者为转换日期格式，注意，前后两者要以一对应。 
<br>如;to_date('2004-11-27 13:34:43', 'yyyy-mm-dd hh24:mi:ss') 将得到具体的时间 
<br> 
<br>多种日期格式： 
<br> 
<br>YYYY：四位表示的年份 
<br>YYY，YY，Y：年份的最后三位、两位或一位，缺省为当前世纪 
<br>MM：01~12的月份编号 
<br>MONTH：九个字符表示的月份，右边用空格填补 
<br>MON：三位字符的月份缩写 
<br>WW：一年中的星期 
<br>D：星期中的第几天 
<br>DD：月份中的第几天 
<br>DDD：年所中的第几天 
<br>DAY：九个字符表示的天的全称，右边用空格补齐 
<br>HH，HH12：一天中的第几个小时，12进制表示法 
<br>HH24：一天中的第几个小时，取值为00~23 
<br>MI：一小时中的分钟 
<br>SS：一分钟中的秒 
<br>SSSS：从午夜开始过去的秒数 
<br> 
<br>to_char():将日期转按一定格式换成字符类型 
<br>SQL&gt; select to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') time from dual; 
<br> 
<br>TIME 
<br>------------------- 
<br>2004-10-08 15:22:58 
<br> 
<br>即把当前时间按yyyy-mm-dd hh24:mi:ss格式转换成字符类型 
<br> 
<br>在oracle中处理日期大全 
<br> 
<br>  TO_DATE格式   
<br>Day:   
<br>dd number 12   
<br>dy abbreviated fri   
<br>day spelled out friday   
<br>ddspth spelled out, ordinal twelfth   
<br>Month:   
<br>mm number 03   
<br>mon abbreviated mar   
<br>month spelled out march   
<br>Year:   
<br>yy two digits 98   
<br>yyyy four digits 1998   
<br> 
<br>24小时格式下时间范围为： 0:00:00 - 23:59:59....   
<br>12小时格式下时间范围为： 1:00:00 - 12:59:59 ....   
<br> 
<br> 
<span class="bold"><span class="smalltxt"><strong><font face="Comic Sans MS">[ZT]日期和時間函數匯總</font></strong></span></span> 
<br>1.   
<br>日期和字符转换函数用法（to_date,to_char）   
<br> 
<br>2.   
<br>select to_char( to_date(222,'J'),'Jsp') from dual   
<br> 
<br>显示Two Hundred Twenty-Two   
<br> 
<br>3.   
<br>求某天是星期几   
<br>select to_char(to_date('2002-08-26','yyyy-mm-dd'),'day') from dual;   
<br>星期一   
<br>select to_char(to_date('2002-08-26','yyyy-mm-dd'),'day','NLS_DATE_LANGUAGE = American') from dual;   
<br>monday   
<br>设置日期语言   
<br>ALTER SESSION SET NLS_DATE_LANGUAGE='AMERICAN';   
<br>也可以这样   
<br>TO_DATE ('2002-08-26', 'YYYY-mm-dd', 'NLS_DATE_LANGUAGE = American')   
<br> 
<br>4.   
<br>两个日期间的天数   
<br>select floor(sysdate - to_date('20020405','yyyymmdd')) from dual;   
<br> 
<br>5. 时间为null的用法   
<br>select id, active_date from table1   
<br>UNION   
<br>select 1, TO_DATE(null) from dual;   
<br> 
<br>注意要用TO_DATE(null)   
<br> 
<br>6.   
<br>a_date between to_date('20011201','yyyymmdd') and to_date('20011231','yyyymmdd')   
<br>那么12月31号中午12点之后和12月1号的12点之前是不包含在这个范围之内的。   
<br>所以，当时间需要精确的时候，觉得to_char还是必要的   
<br>7. 日期格式冲突问题   
<br>输入的格式要看你安装的ORACLE字符集的类型, 比如: US7ASCII, date格式的类型就是: '01-Jan-01'   
<br>alter system set NLS_DATE_LANGUAGE = American   
<br>alter session set NLS_DATE_LANGUAGE = American   
<br>或者在to_date中写   
<br>select to_char(to_date('2002-08-26','yyyy-mm-dd'),'day','NLS_DATE_LANGUAGE = American') from dual;   
<br>注意我这只是举了NLS_DATE_LANGUAGE，当然还有很多，   
<br>可查看   
<br>select * from nls_session_parameters   
<br>select * from V$NLS_PARAMETERS   
<br> 
<br>8.   
<br>select count(*)   
<br>from ( select rownum-1 rnum   
<br>from all_objects   
<br>where rownum &lt;= to_date('2002-02-28','yyyy-mm-dd') - to_date('2002-   
<br>02-01','yyyy-mm-dd')+1   
<br>)   
<br>where to_char( to_date('2002-02-01','yyyy-mm-dd')+rnum-1, 'D' )   
<br>not   
<br>in ( '1', '7' )   
<br> 
<br>查找2002-02-28至2002-02-01间除星期一和七的天数   
<br>在前后分别调用DBMS_UTILITY.GET_TIME, 让后将结果相减(得到的是1/100秒, 而不是毫秒).   
<br> 
<br>9.   
<br>select months_between(to_date('01-31-1999','MM-DD-YYYY'),   
<br>to_date('12-31-1998','MM-DD-YYYY')) "MONTHS" FROM DUAL;   
<br>1   
<br> 
<br>select months_between(to_date('02-01-1999','MM-DD-YYYY'),   
<br>to_date('12-31-1998','MM-DD-YYYY')) "MONTHS" FROM DUAL;   
<br> 
<br>1.03225806451613   
<br>10. Next_day的用法   
<br>Next_day(date, day)   
<br> 
<br>Monday-Sunday, for format code DAY   
<br>Mon-Sun, for format code DY   
<br>1-7, for format code D   
<br> 
<br>11   
<br>select to_char(sysdate,'hh:mi:ss') TIME from all_objects   
<br>注意：第一条记录的TIME 与最后一行是一样的   
<br>可以建立一个函数来处理这个问题   
<br>create or replace function sys_date return date is   
<br>begin   
<br>return sysdate;   
<br>end;   
<br> 
<br>select to_char(sys_date,'hh:mi:ss') from all_objects;   
<br>12.   
<br>获得小时数   
<br> 
<br>SELECT EXTRACT(HOUR FROM TIMESTAMP '2001-02-16 2:38:40') from offer   
<br>SQL&gt; select sysdate ,to_char(sysdate,'hh') from dual;   
<br> 
<br>SYSDATE TO_CHAR(SYSDATE,'HH')   
<br>-------------------- ---------------------   
<br>2003-10-13 19:35:21 07   
<br> 
<br>SQL&gt; select sysdate ,to_char(sysdate,'hh24') from dual;   
<br> 
<br>SYSDATE TO_CHAR(SYSDATE,'HH24')   
<br>-------------------- -----------------------   
<br>2003-10-13 19:35:21 19   
<br> 
<br>获取年月日与此类似   
<br>13.   
<br>年月日的处理   
<br>select older_date,   
<br>newer_date,   
<br>years,   
<br>months,   
<br>abs(   
<br>trunc(   
<br>newer_date-   
<br>add_months( older_date,years*12+months )   
<br>)   
<br>) days   
<br>from ( select   
<br>trunc(months_between( newer_date, older_date )/12) YEARS,   
<br>mod(trunc(months_between( newer_date, older_date )),   
<br>12 ) MONTHS,   
<br>newer_date,   
<br>older_date   
<br>from ( select hiredate older_date,   
<br>add_months(hiredate,rownum)+rownum newer_date   
<br>from emp )   
<br>)   
<br> 
<br>14.   
<br>处理月份天数不定的办法   
<br>select to_char(add_months(last_day(sysdate) +1, -2), 'yyyymmdd'),last_day(sysdate) from dual   
<br> 
<br>16.   
<br>找出今年的天数   
<br>select add_months(trunc(sysdate,'year'), 12) - trunc(sysdate,'year') from dual   
<br> 
<br>闰年的处理方法   
<br>to_char( last_day( to_date('02' || :year,'mmyyyy') ), 'dd' )   
<br>如果是28就不是闰年   
<br> 
<br>17.   
<br>yyyy与rrrr的区别   
<br>'YYYY99 TO_C   
<br>------- ----   
<br>yyyy 99 0099   
<br>rrrr 99 1999   
<br>yyyy 01 0001   
<br>rrrr 01 2001   
<br> 
<br>18.不同时区的处理   
<br>select to_char( NEW_TIME( sysdate, 'GMT','EST'), 'dd/mm/yyyy hh:mi:ss') ,sysdate   
<br>from dual;   
<br> 
<br>19.   
<br>5秒钟一个间隔   
<br>Select TO_DATE(FLOOR(TO_CHAR(sysdate,'SSSSS')/300) * 300,'SSSSS') ,TO_CHAR(sysdate,'SSSSS')   
<br>from dual   
<br> 
<br>2002-11-1 9:55:00 35786   
<br>SSSSS表示5位秒数   
<br> 
<br>20.   
<br>一年的第几天   
<br>select TO_CHAR(SYSDATE,'DDD'),sysdate from dual   
<br>310 2002-11-6 10:03:51   
<br> 
<br>21.计算小时,分,秒,毫秒   
<br>select   
<br>Days,   
<br>A,   
<br>TRUNC(A*24) Hours,   
<br>TRUNC(A*24*60 - 60*TRUNC(A*24)) Minutes,   
<br>TRUNC(A*24*60*60 - 60*TRUNC(A*24*60)) Seconds,   
<br>TRUNC(A*24*60*60*100 - 100*TRUNC(A*24*60*60)) mSeconds   
<br>from   
<br>(   
<br>select   
<br>trunc(sysdate) Days,   
<br>sysdate - trunc(sysdate) A   
<br>from dual   
<br>)   
<br> 
<br> 
<br> 
<br>select * from tabname   
<br>order by decode(mode,'FIFO',1,-1)*to_char(rq,'yyyymmddhh24miss');   
<br> 
<br>//   
<br>floor((date2-date1) /365) 作为年   
<br>floor((date2-date1, 365) /30) 作为月   
<br>mod(mod(date2-date1, 365), 30)作为日.   
<br>23.next_day函数   
<br>next_day(sysdate,6)是从当前开始下一个星期五。后面的数字是从星期日开始算起。   
<br>1 2 3 4 5 6 7   
<br>日 一 二 三 四 五 六 
<br> 
<br> 
<span class="bold"><span class="smalltxt"><strong><font face="Comic Sans MS">oracle中有很多关于日期的函数<br><br></font></strong></span></span>在oracle中有很多关于日期的函数，如： 
<br>1、add_months()用于从一个日期值增加或减少一些月份 
<br>date_value:=add_months(date_value,number_of_months) 
<br>例： 
<br>SQL&gt; select add_months(sysdate,12) "Next Year" from dual; 
<br> 
<br>Next Year 
<br>---------- 
<br>13-11月-04 
<br> 
<br>SQL&gt; select add_months(sysdate,112) "Last Year" from dual; 
<br> 
<br>Last Year 
<br>---------- 
<br>13-3月 -13 
<br> 
<br>SQL&gt; 
<br> 
<br>2、current_date()返回当前会放时区中的当前日期 
<br>date_value:=current_date 
<br>SQL&gt; column sessiontimezone for a15 
<br>SQL&gt; select sessiontimezone,current_date from dual; 
<br> 
<br>SESSIONTIMEZONE CURRENT_DA 
<br>--------------- ---------- 
<br>+08:00 13-11月-03 
<br> 
<br>SQL&gt; alter session set time_zone='-11:00' 
<br>  2 / 
<br> 
<br>会话已更改。 
<br> 
<br>SQL&gt; select sessiontimezone,current_timestamp from dual; 
<br> 
<br>SESSIONTIMEZONE CURRENT_TIMESTAMP 
<br>--------------- ------------------------------------ 
<br>-11:00 12-11月-03 04.59.13.668000 下午 -11: 
<br>                00 
<br> 
<br>SQL&gt; 
<br> 
<br>3、current_timestamp()以timestamp with time zone数据类型返回当前会放时区中的当前日期 
<br>timestamp_with_time_zone_value:=current_timestamp([timestamp_precision]) 
<br>SQL&gt; column sessiontimezone for a15 
<br>SQL&gt; column current_timestamp format a36 
<br>SQL&gt; select sessiontimezone,current_timestamp from dual; 
<br> 
<br>SESSIONTIMEZONE CURRENT_TIMESTAMP 
<br>--------------- ------------------------------------ 
<br>+08:00 13-11月-03 11.56.28.160000 上午 +08: 
<br>                00 
<br> 
<br>SQL&gt; alter session set time_zone='-11:00' 
<br>  2 / 
<br> 
<br>会话已更改。 
<br> 
<br>SQL&gt; select sessiontimezone,current_timestamp from dual; 
<br> 
<br>SESSIONTIMEZONE CURRENT_TIMESTAMP 
<br>--------------- ------------------------------------ 
<br>-11:00 12-11月-03 04.58.00.243000 下午 -11: 
<br>                00 
<br> 
<br>SQL&gt; 
<br> 
<br>4、dbtimezone()返回时区 
<br>varchar_value:=dbtimezone 
<br>SQL&gt; select dbtimezone from dual; 
<br> 
<br>DBTIME 
<br>------ 
<br>-07:00 
<br> 
<br>SQL&gt; 
<br> 
<br>5、extract()找出日期或间隔值的字段值 
<br>date_value:=extract(date_field from [datetime_value|interval_value]) 
<br>SQL&gt; select extract(month from sysdate) "This Month" from dual; 
<br> 
<br>This Month 
<br>---------- 
<br>        11 
<br> 
<br>SQL&gt; select extract(year from add_months(sysdate,36)) "3 Years Out" from dual; 
<br> 
<br>3 Years Out 
<br>----------- 
<br>       2006 
<br> 
<br>SQL&gt; 
<br> 
<br>6、last_day()返回包含了日期参数的月份的最后一天的日期 
<br>date_value:=last_day(date_value) 
<br>SQL&gt; select last_day(date'2000-02-01') "Leap Yr?" from dual; 
<br> 
<br>Leap Yr? 
<br>---------- 
<br>29-2月 -00 
<br> 
<br>SQL&gt; select last_day(sysdate) "Last day of this month" from dual; 
<br> 
<br>Last day o 
<br>---------- 
<br>30-11月-03 
<br> 
<br>SQL&gt; 
<br> 
<br>7、localtimestamp()返回会话中的日期和时间 
<br>timestamp_value:=localtimestamp 
<br>SQL&gt; column localtimestamp format a28 
<br>SQL&gt; select localtimestamp from dual; 
<br> 
<br>LOCALTIMESTAMP 
<br>---------------------------- 
<br>13-11月-03 12.09.15.433000 
<br>下午 
<br> 
<br>SQL&gt; select localtimestamp,current_timestamp from dual; 
<br> 
<br>LOCALTIMESTAMP CURRENT_TIMESTAMP 
<br>---------------------------- ------------------------------------ 
<br>13-11月-03 12.09.31.006000 13-11月-03 12.09.31.006000 下午 +08: 
<br>下午 00 
<br> 
<br>SQL&gt; alter session set time_zone='-11:00'; 
<br> 
<br>会话已更改。 
<br> 
<br>SQL&gt; select localtimestamp,to_char(sysdate,'DD-MM-YYYY HH:MI:SS AM') "SYSDATE" from dual; 
<br> 
<br>LOCALTIMESTAMP SYSDATE 
<br>---------------------------- ------------------------ 
<br>12-11月-03 05.11.31.259000 13-11-2003 12:11:31 下午 
<br>下午 
<br> 
<br>SQL&gt; 
<br> 
<br>8、months_between()判断两个日期之间的月份数量 
<br>number_value:=months_between(date_value,date_value) 
<br>SQL&gt; select months_between(sysdate,date'1971-05-18') from dual; 
<br> 
<br>MONTHS_BETWEEN(SYSDATE,DATE'1971-05-18') 
<br>---------------------------------------- 
<br>                              389.855143 
<br> 
<br>SQL&gt; select months_between(sysdate,date'2001-01-01') from dual; 
<br> 
<br>MONTHS_BETWEEN(SYSDATE,DATE'2001-01-01') 
<br>---------------------------------------- 
<br>                              34.4035409 
<br> 
<br>SQL&gt; 
<br> 
<br>9、next_day()给定一个日期值，返回由第二个参数指出的日子第一次出现在的日期值（应返回相应日子的名称字符串） 
<br> 
<br> 
<table style="TABLE-LAYOUT: fixed; WORD-WRAP: break-word" height="100%" cellspacing="0" cellpadding="0" width="100%" border="0"><tbody><tr><td> <p><span class="bold"><span class="smalltxt"><strong><font face="Comic Sans MS">與周相關日期函數<br><br></font></strong></span></span>1.查询某周的第一天<br>select trunc(decode(ww, 53, to_date(yy || '3112', 'yyyyddmm'), to_date(yy || '-' || to_char(ww * 7), 'yyyy-ddd')), 'd') last_day<br>from (select substr('2004-32', 1, 4) yy, to_number(substr('2004-32', 6)) ww<br>         from dual)<br><br>select trunc(to_date(substr('2003-01',1,5)||to_char((to_number(substr('2003-01',6)))*7),'yyyy-ddd'),'d')-6 first_day from dual<br><br>select min(v_date) from<br>  (select (to_date('200201','yyyymm') + rownum) v_date<br>  from all_tables<br>  where rownum &lt; 370)<br>where to_char(v_date,'yyyy-iw') = '2002-49'<br><br>2.查询某周的最后一天<br>select trunc(decode(ww, 53, to_date(yy || '3112', 'yyyyddmm'), to_date(yy || '-' || to_char(ww * 7), 'yyyy-ddd')), 'd') - 6 first_day<br>  from (select substr('2004-33', 1, 4) yy, to_number(substr('2004-33', 6)) ww<br>          from dual)<br>          <br>select trunc(to_date(substr('2003-01',1,5)||to_char((to_number(substr('2003-01',6)))*7),'yyyy-ddd'),'d') last_day from dual<br><br>select max(v_date) from<br>  (select (to_date('200408','yyyymm') + rownum) v_date<br>  from all_tables<br>  where rownum &lt; 370)<br>where to_char(v_date,'yyyy-iw') = '2004-33'<br><br>3.查询某周的日期<br>select min_date, to_char(min_date,'day') day from<br>(select to_date(substr('2004-33',1,4)||'001'+rownum-1,'yyyyddd') min_date <br>        from all_tables<br>  where rownum &lt;= decode(mod(to_number(substr('2004-33',1,4)),4),0,366,365)  <br>  union<br><br>  select to_date(substr('2004-33',1,4)-1||<br>         decode(mod(to_number(substr('2004-33',1,4))-1,4),0,359,358)+rownum,'yyyyddd') min_date <br>        from all_tables          <br>          where rownum &lt;= 7<br>  union<br><br>  select to_date(substr('2004-33',1,4)+1||'001'+rownum-1,'yyyyddd') min_date <br>        from all_tables          <br>          where rownum &lt;= 7                       <br>)<br>where to_char(min_date,'yyyy-iw') ='2004-33'</p> <p> </p> </td></tr></tbody></table>  
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d2a9f6c8c286919873f2ab29aaad28aa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java中调用c(c&#43;&#43;)写的dll文件的实现及步骤</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/870960971198fdf369e639b5aea61398/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">经验功享：对CPU资源占用100％的解决方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>