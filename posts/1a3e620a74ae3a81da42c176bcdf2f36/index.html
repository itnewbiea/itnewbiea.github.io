<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Go语言基础简单了解 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Go语言基础简单了解" />
<meta property="og:description" content="文章目录 前言关于Go学习流程 基础语法注释变量常量数据类型运算符fmt库 流程控制if、switch、selectfor、break、continue遍历String 函数值传递和引用传递deferinit匿名、回调、闭包函数 数组和切片Map结构体自定义数据类型接口协程和channel线程锁异常处理泛型文件读取文件写入反射TCP网络编程Httpwebsocket爬虫正则表达式goquerycolly豆瓣250爬B站评论 前言 简单的入门一下Go、会对基础语法、网络编程、Gin开发进行简单的了解，关键是Gin开发。
关于Go Go语言（也称为Golang）是Google开发的一种开源编程语言。它被设计用于构建高效、可靠和可扩展的软件系统。下面是Go语言的一些主要用途：
服务器端开发：Go语言提供了强大的标准库和并发模型，使其成为构建高性能网络服务器的理想选择。许多大型互联网公司正在使用Go语言来开发后端服务，以处理高负载和并发请求。网络编程：Go语言提供了丰富的网络编程库，可用于开发各种网络应用程序，包括Web服务、API服务器、网络代理等。分布式系统：Go语言的并发模型和原生支持的并发原语（goroutine和channel）使其非常适合构建分布式系统，例如数据处理管道、消息队列等。命令行工具：Go语言的编译速度快，生成的可执行文件体积小，使其成为开发命令行工具的良好选择。许多开发者使用Go语言来构建工具、脚本和自动化任务。嵌入式系统：Go语言可以用于编写嵌入式系统的控制逻辑和驱动程序。它提供了对底层硬件的访问和控制能力，并具有较小的内存消耗。 需要注意的是，Go语言具有简洁而直观的语法，易于学习和使用。它的性能非常好，可以充分利用多核处理器和并发编程来提高应用程序的性能和吞吐量。
学习流程 基础语法-&gt;Web开发-&gt;常见中间件-&gt;云平台
基础语法 注释 增强语言的可读性
单行注释
多行注释
package main import &#34;fmt&#34; // 单行注释 /* 多行注释 多行注释 */ func main() { fmt.Println(&#34;hello world&#34;) } 变量 var 定义变量，var 变量名 变量类型。简短变量声明，使用:=运算符可以在函数内部声明并初始化变量。匿名变量，使用 _ 占位符可以声明一个匿名变量，忽略不需要的值，任何赋值給这个标识符的值都将被抛弃，并且不会导致变量的冲突定义多个变量，可以使用()包裹，表示定义多个变量注意点：变量名的首个字符不能为数字，全局变量可被局部变量再定义(就近原则 )，定义的变量一定要使用。 变量声明后的默认值：
整数型浮点数变量默认值是0和0.0字符串变量默认值是空字符串布尔型变量默认是false切片，函数，指针变量默认是nil Printf输出时声明的格式
%v：默认格式化输出，会根据变量的类型自动选择合适的格式。%s：输出字符串。%d、%b、%o、%x：输出整数，分别表示十进制、二进制、八进制和十六进制。%t：输出布尔值，结果为 true 或 false。%f、%e、%g：输出浮点数，分别表示十进制表示法、科学计数法和通用格式。%p：输出指针地址。%c：输出字符。%q：输出带引号的字符串。%%：输出一个百分号。 fmt.Printf(&#34;内存地址:%p,变量类型:%T&#34;,name,&amp;name) //打印内存地址，变量类型等 例子：
package main import &#34;fmt&#34; var name = &#34;Lau&#34; //全局变量(隐式定义) func fun() (int, int) { return 100, 200 } func main() { var name string = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/1a3e620a74ae3a81da42c176bcdf2f36/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-02T22:30:14+08:00" />
<meta property="article:modified_time" content="2024-01-02T22:30:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Go语言基础简单了解</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_3" rel="nofollow">前言</a></li><li><a href="#Go_5" rel="nofollow">关于Go</a></li><li><ul><li><a href="#_17" rel="nofollow">学习流程</a></li></ul> 
  </li><li><a href="#_23" rel="nofollow">基础语法</a></li><li><ul><li><a href="#_25" rel="nofollow">注释</a></li><li><a href="#_49" rel="nofollow">变量</a></li><li><a href="#_107" rel="nofollow">常量</a></li><li><a href="#_139" rel="nofollow">数据类型</a></li><li><a href="#_213" rel="nofollow">运算符</a></li><li><a href="#fmt_253" rel="nofollow">fmt库</a></li></ul> 
  </li><li><a href="#_315" rel="nofollow">流程控制</a></li><li><ul><li><a href="#ifswitchselect_317" rel="nofollow">if、switch、select</a></li><li><a href="#forbreakcontinue_397" rel="nofollow">for、break、continue</a></li><li><a href="#String_433" rel="nofollow">遍历String</a></li></ul> 
  </li><li><a href="#_458" rel="nofollow">函数</a></li><li><ul><li><a href="#_522" rel="nofollow">值传递和引用传递</a></li><li><a href="#defer_527" rel="nofollow">defer</a></li><li><a href="#init_565" rel="nofollow">init</a></li><li><a href="#_575" rel="nofollow">匿名、回调、闭包函数</a></li></ul> 
  </li><li><a href="#_628" rel="nofollow">数组和切片</a></li><li><a href="#Map_655" rel="nofollow">Map</a></li><li><a href="#_684" rel="nofollow">结构体</a></li><li><a href="#_737" rel="nofollow">自定义数据类型</a></li><li><a href="#_786" rel="nofollow">接口</a></li><li><a href="#channel_841" rel="nofollow">协程和channel</a></li><li><a href="#_971" rel="nofollow">线程锁</a></li><li><a href="#_1025" rel="nofollow">异常处理</a></li><li><a href="#_1089" rel="nofollow">泛型</a></li><li><a href="#_1134" rel="nofollow">文件读取</a></li><li><a href="#_1174" rel="nofollow">文件写入</a></li><li><a href="#_1237" rel="nofollow">反射</a></li><li><a href="#TCP_1401" rel="nofollow">TCP网络编程</a></li><li><a href="#Http_1475" rel="nofollow">Http</a></li><li><a href="#websocket_1582" rel="nofollow">websocket</a></li><li><a href="#_1669" rel="nofollow">爬虫</a></li><li><ul><li><a href="#_1671" rel="nofollow">正则表达式</a></li><li><a href="#goquery_1803" rel="nofollow">goquery</a></li><li><a href="#colly_1857" rel="nofollow">colly</a></li><li><a href="#250_1906" rel="nofollow">豆瓣250</a></li><li><a href="#B_2032" rel="nofollow">爬B站评论</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_3"></a>前言</h2> 
<p>简单的入门一下Go、会对基础语法、网络编程、Gin开发进行简单的了解，关键是<code>Gin</code>开发。</p> 
<h2><a id="Go_5"></a>关于Go</h2> 
<p>Go语言（也称为Golang）是Google开发的一种开源编程语言。它被设计用于构建高效、可靠和可扩展的软件系统。下面是Go语言的一些主要用途：</p> 
<ol><li>服务器端开发：Go语言提供了强大的标准库和并发模型，使其成为构建高性能网络服务器的理想选择。许多大型互联网公司正在使用Go语言来开发后端服务，以处理高负载和并发请求。</li><li>网络编程：Go语言提供了丰富的网络编程库，可用于开发各种网络应用程序，包括Web服务、API服务器、网络代理等。</li><li>分布式系统：Go语言的并发模型和原生支持的并发原语（goroutine和channel）使其非常适合构建分布式系统，例如数据处理管道、消息队列等。</li><li>命令行工具：Go语言的编译速度快，生成的可执行文件体积小，使其成为开发命令行工具的良好选择。许多开发者使用Go语言来构建工具、脚本和自动化任务。</li><li>嵌入式系统：Go语言可以用于编写嵌入式系统的控制逻辑和驱动程序。它提供了对底层硬件的访问和控制能力，并具有较小的内存消耗。</li></ol> 
<p>需要注意的是，Go语言具有简洁而直观的语法，易于学习和使用。它的性能非常好，可以充分利用多核处理器和并发编程来提高应用程序的性能和吞吐量。</p> 
<h3><a id="_17"></a>学习流程</h3> 
<p>基础语法-&gt;Web开发-&gt;常见中间件-&gt;云平台</p> 
<h2><a id="_23"></a>基础语法</h2> 
<h3><a id="_25"></a>注释</h3> 
<p>增强语言的可读性</p> 
<ol><li> <p>单行注释</p> </li><li> <p>多行注释</p> <pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token comment">// 单行注释</span>
<span class="token comment">/*
多行注释
多行注释
*/</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> </li></ol> 
<h3><a id="_49"></a>变量</h3> 
<ol><li><code>var</code> 定义变量，<code>var 变量名 变量类型。</code></li><li>简短变量声明，使用<code>:=</code>运算符可以在函数内部声明并初始化变量。</li><li>匿名变量，使用 <code>_</code> 占位符可以声明一个匿名变量，忽略不需要的值，任何赋值給这个标识符的值都将被抛弃，并且不会导致变量的冲突</li><li>定义多个变量，可以使用<code>()</code>包裹，表示定义多个变量</li><li>注意点：变量名的首个字符不能为数字，全局变量可被局部变量再定义(<code>就近原则</code> )，定义的变量一定要使用。</li></ol> 
<p>变量声明后的默认值：</p> 
<ul><li>整数型浮点数变量默认值是0和0.0</li><li>字符串变量默认值是空字符串</li><li>布尔型变量默认是false</li><li>切片，函数，指针变量默认是nil</li></ul> 
<p><code>Printf</code>输出时声明的格式</p> 
<ul><li><code>%v</code>：默认格式化输出，会根据变量的类型自动选择合适的格式。</li><li><code>%s</code>：输出字符串。</li><li><code>%d</code>、<code>%b</code>、<code>%o</code>、<code>%x</code>：输出整数，分别表示十进制、二进制、八进制和十六进制。</li><li><code>%t</code>：输出布尔值，结果为 true 或 false。</li><li><code>%f</code>、<code>%e</code>、<code>%g</code>：输出浮点数，分别表示十进制表示法、科学计数法和通用格式。</li><li><code>%p</code>：输出指针地址。</li><li><code>%c</code>：输出字符。</li><li><code>%q</code>：输出带引号的字符串。</li><li><code>%%</code>：输出一个百分号。</li></ul> 
<pre><code class="prism language-go">fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"内存地址:%p,变量类型:%T"</span><span class="token punctuation">,</span>name<span class="token punctuation">,</span><span class="token operator">&amp;</span>name<span class="token punctuation">)</span> <span class="token comment">//打印内存地址，变量类型等</span>

</code></pre> 
<p>例子：</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"Lau"</span> <span class="token comment">//全局变量(隐式定义)</span>

<span class="token keyword">func</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">var</span> name <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">"aiwin"</span> <span class="token comment">//显示定义</span>
	<span class="token keyword">var</span> a<span class="token punctuation">,</span> b <span class="token builtin">int</span> <span class="token comment">//同时定义a,b两个变量</span>
	age <span class="token operator">:=</span> <span class="token number">18</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"姓名:%s,内存地址为:%p,类型为:%T,年龄:%d,年龄十六进制数为:%x\n"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> <span class="token operator">&amp;</span>name<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> age<span class="token punctuation">)</span> <span class="token comment">//就近原则</span>
	a<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"_可代替被舍弃的值,并且可被重复定义:"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
	a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"类似于Python,可直接进行值交换:"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="_107"></a>常量</h3> 
<ol><li>使用<code>const</code>来定义常量，不可改变</li><li><code>iota</code> 开始是0，默认会不断的自增进行计数，相当于是一个常量的<code>计数器</code>，直至新的一组常量计数器出现才会恢复，可理解过<code>const</code>语句块的<code>索引</code></li></ol> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">const</span> <span class="token punctuation">(</span>
		a <span class="token operator">=</span> <span class="token boolean">iota</span>
		b
		c		
		d <span class="token operator">=</span> <span class="token string">"aiwin"</span>
		e		<span class="token comment">//未被定义所以用上一个的值,但是iota还是会一直计数</span>
		f <span class="token operator">=</span> <span class="token number">100</span>
		g 		<span class="token comment">//未被定义所以用上一个的值</span>
		h <span class="token operator">=</span> <span class="token boolean">iota</span>
		j
	<span class="token punctuation">)</span>
	<span class="token keyword">const</span> <span class="token punctuation">(</span>
		k <span class="token operator">=</span> <span class="token boolean">iota</span>	<span class="token comment">//新的const出现,新iota被重新从0开始计数</span>
		l
	<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> e<span class="token punctuation">,</span> f<span class="token punctuation">,</span> g<span class="token punctuation">,</span> h<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">,</span> l<span class="token punctuation">)</span> <span class="token comment">//0 1 2 aiwin aiwin 100 100 7 8 0 1</span>


<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_139"></a>数据类型</h3> 
<ol><li> <p>布尔型<code>bool</code>，默认值是<code>false</code></p> </li><li> <p>数字类型，分为<code>int</code>和<code>float</code>，并且支持复数，位运算采用补码</p> 
  <table><thead><tr><th align="center">序号</th><th align="center">类型和描述</th></tr></thead><tbody><tr><td align="center">1</td><td align="center"><strong>uint8</strong>无符号8位整型(0~255)</td></tr><tr><td align="center">2</td><td align="center"><strong>uint16</strong>无符号16位整型(0~65535)</td></tr><tr><td align="center">3</td><td align="center"><strong>uint32</strong>无符号32位整型(0~4294967295)</td></tr><tr><td align="center">4</td><td align="center"><strong>uint64</strong>无符号64位整型(0~18446744073709551615)</td></tr><tr><td align="center">5</td><td align="center"><strong>int8</strong>有符号8位整型(-128~127)i</td></tr><tr><td align="center">6</td><td align="center"><strong>int16</strong>符号16位整型(-32768~32767)</td></tr><tr><td align="center">7</td><td align="center"><strong>int32</strong>有符号32位整型(-2147483648~2147483647)</td></tr><tr><td align="center">8</td><td align="center"><strong>int64</strong>有符号64位整型(-9223372036854775808~9223372036854775807)</td></tr></tbody></table></li><li> <p><code>float</code>浮点型，默认是64位，保留6位小数，保留小数会丢失精度，采取四舍五入的原则</p> 
  <table><thead><tr><th align="left">序号</th><th align="left">类型和描述</th></tr></thead><tbody><tr><td align="left">1</td><td align="left"><strong>float32</strong> IEEE-754 32位浮点型数</td></tr><tr><td align="left">2</td><td align="left"><strong>float64</strong> IEEE-754 64位浮点型数</td></tr><tr><td align="left">3</td><td align="left"><strong>complex64</strong> 32 位实数和虚数</td></tr><tr><td align="left">4</td><td align="left"><strong>complex128</strong> 64 位实数和虚数</td></tr></tbody></table></li><li> <p><code>类型别名</code>，<code>Go</code>语言会有一些类型的别名</p> 
  <table><thead><tr><th align="center">序号</th><th align="center">类型和描述</th></tr></thead><tbody><tr><td align="center">1</td><td align="center"><strong>byte</strong>类似<strong>uint8</strong></td></tr><tr><td align="center">2</td><td align="center"><strong>int</strong>和<strong>uint</strong>一样大小</td></tr><tr><td align="center">3</td><td align="center"><strong>rune</strong>类似<strong>int32</strong></td></tr><tr><td align="center">7</td><td align="center"><strong>uintptr</strong>无符号整型，用于存放指针</td></tr></tbody></table></li><li> <p><code>字符类型</code>，<strong>’</strong> 和**"** 和双引号包裹的字符是有差别的，<strong>’</strong> 默认是<strong>int32</strong> 类型，会自动转换成<strong>Unicode</strong> 编码的值，字符可以直接使用**+** 连接</p> </li><li> <p><code>类型转换</code> ，<strong>Go语言不存在隐式类型转换，所有的类型转换都必须是显式的声明</strong></p> </li></ol> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">var</span> age <span class="token builtin">byte</span> <span class="token operator">=</span> <span class="token number">18</span> <span class="token comment">//相当于uint8</span>
	<span class="token comment">//超过范围,报错 age = 9223372036854775808</span>
	<span class="token keyword">var</span> num1 <span class="token builtin">float32</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">123.0000901</span>
	<span class="token keyword">var</span> num2 <span class="token builtin">float64</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">123.0000901</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"num1="</span><span class="token punctuation">,</span> num1<span class="token punctuation">,</span> <span class="token string">"num2="</span><span class="token punctuation">,</span> num2<span class="token punctuation">)</span> <span class="token comment">//精度缺失</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"转换后导致的精度丢失:num="</span><span class="token punctuation">,</span> <span class="token function">float32</span><span class="token punctuation">(</span>num2<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> num3 <span class="token builtin">float64</span> <span class="token operator">=</span> <span class="token number">3.19</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"num3=%.1f\n"</span><span class="token punctuation">,</span> num3<span class="token punctuation">)</span> <span class="token comment">//四舍五入,输出3.2</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"age的类型为%T,数值为%d"</span><span class="token punctuation">,</span> age<span class="token punctuation">,</span> age<span class="token punctuation">)</span>

	str <span class="token operator">:=</span> <span class="token string">"Hello"</span>
	str1 <span class="token operator">:=</span> <span class="token char">'中'</span> <span class="token comment">//使用Unicode编码表,会自动认为是int32类型</span>
	str2 <span class="token operator">:=</span> <span class="token string">"World"</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%T,%s\n"</span><span class="token punctuation">,</span> str<span class="token punctuation">,</span> str<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%T,%d\n"</span><span class="token punctuation">,</span> str1<span class="token punctuation">,</span> str1<span class="token punctuation">)</span> <span class="token comment">//默认是int32类型,转换成数字</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>str <span class="token operator">+</span> <span class="token string">","</span> <span class="token operator">+</span> str2<span class="token punctuation">)</span>

	<span class="token keyword">var</span> b <span class="token builtin">uint16</span> <span class="token operator">=</span> <span class="token number">256</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"b="</span><span class="token punctuation">,</span> <span class="token function">uint8</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//变成了0</span>
	<span class="token comment">/*
		flag := 2
		fmt.Println(bool(flag)) 整型不能转换成bool类型*/</span>

<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="_213"></a>运算符</h3> 
<table><thead><tr><th align="center">运算符</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center">&amp;&amp;</td><td align="center">逻辑 AND 运算符。 如果两边的操作数都是 True，则条件 True，否则为 False。</td></tr><tr><td align="center">||</td><td align="center">逻辑 OR 运算符。 如果两边的操作数有一个 True，则条件 True，否则为 False。</td></tr><tr><td align="center">!</td><td align="center">逻辑 NOT 运算符。 如果条件为 True，则逻辑 NOT 条件 False，否则为 True。</td></tr></tbody></table> 
<table><thead><tr><th align="center">运算符</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center"></td><td align="center"></td></tr><tr><td align="center">&amp;</td><td align="center">按位与运算符"&amp;"是双目运算符。都是1结果为1，否则为0</td></tr><tr><td align="center">|</td><td align="center">按位或运算符"|"是双目运算符。 都是0结果为0，否则为1</td></tr><tr><td align="center">^</td><td align="center">按位异或运算符"^"是双目运算符。 其功能是参与运算的两数各对应的二进位相异或，当两对应的二进位相异时，结果为1。</td></tr><tr><td align="center">&lt;&lt;</td><td align="center">左移运算符"&lt;&lt;“是双目运算符。左移n位就是乘以2的n次方。 其功能把”&lt;&lt;“左边的运算数的各二进位全部左移若干位，由”&lt;&lt;"右边的数指定移动的位数，高位丢弃，低位补0。</td></tr><tr><td align="center">&gt;&gt;</td><td align="center">右移运算符"&gt;&gt;“是双目运算符。右移n位就是除以2的n次方。 其功能是把”&gt;&gt;“左边的运算数的各二进位全部右移若干位，”&gt;&gt;"右边的数指定移动的位数。</td></tr><tr><td align="center">&amp;^</td><td align="center">位清空，a&amp;^b，对于b上的每个数值，如果为0，则取a对应位上的数，如果为1，则取0</td></tr></tbody></table> 
<table><thead><tr><th align="center">运算符</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center">&amp;</td><td align="center">返回变量存储地址</td></tr><tr><td align="center">*</td><td align="center">指针变量。</td></tr></tbody></table> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">var</span> a <span class="token builtin">uint</span> <span class="token operator">=</span> <span class="token number">13</span>     <span class="token comment">//0011 1100</span>
	<span class="token keyword">var</span> b <span class="token builtin">uint</span> <span class="token operator">=</span> <span class="token number">60</span>     <span class="token comment">//0000 1101</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a <span class="token operator">&amp;</span> b<span class="token punctuation">)</span>  <span class="token comment">//0000 1100</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a <span class="token operator">|</span> b<span class="token punctuation">)</span>  <span class="token comment">//0011 1101</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a <span class="token operator">^</span> b<span class="token punctuation">)</span>  <span class="token comment">//0011 0001</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a <span class="token operator">&amp;^</span> b<span class="token punctuation">)</span> <span class="token comment">// 0000 0001</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>b <span class="token operator">&gt;&gt;</span> a<span class="token punctuation">)</span> <span class="token comment">//60右移60位,结果为0</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="fmt_253"></a>fmt库</h3> 
<p>常用的一些函数</p> 
<ol><li><code>Print</code> / <code>Println</code> / <code>Printf</code>：格式化并输出到标准输出。</li><li><code>Println</code>：类似于 <code>Print</code>，但在输出后添加换行符。</li><li><code>Printf</code>：使用格式化字符串进行输出（类似于 C 语言中的 <code>printf</code> 函数）。</li><li><code>Sprint</code> / <code>Sprintln</code> / <code>Sprintf</code>：将格式化的结果以字符串形式返回，而不是输出到标准输出。</li><li><code>Fprint</code> / <code>Fprintln</code> / <code>Fprintf</code>：将格式化的结果输出到指定的文件（<code>io.Writer</code>）。</li><li><code>Errorf</code>：生成一个格式化的错误字符串。</li><li><code>Scan</code> / <code>Scanln</code> / <code>Scanf</code>：从标准输入读取并格式化输入。</li><li><code>Sscan</code> / <code>Sscanln</code> / <code>Sscanf</code>：从给定的字符串中读取并格式化输入。</li><li><code>Fscan</code> / <code>Fscanln</code> / <code>Fscanf</code>：从指定的文件（<code>io.Reader</code>）中读取并格式化输入。</li></ol> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"os"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	name <span class="token operator">:=</span> <span class="token string">"Alice"</span>
	age <span class="token operator">:=</span> <span class="token number">30</span>
	height <span class="token operator">:=</span> <span class="token number">1.68</span>

	<span class="token comment">// 格式化并输出到标准输出</span>
	fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"Hello, "</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"!"</span><span class="token punctuation">)</span>

	<span class="token comment">// 使用格式化字符串进行输出</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%s is %d years old.\n"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>

	<span class="token comment">// 输出到指定文件</span>
	file<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token string">"user.gob"</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> file<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintln</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> name<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> age<span class="token punctuation">)</span>
	
	<span class="token comment">//标准化读取文件输入</span>
	file<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">"user.gob"</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> file<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> ReadName <span class="token builtin">string</span>
	<span class="token keyword">var</span> ReadAge <span class="token builtin">int</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fscanln</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ReadName<span class="token punctuation">)</span> <span class="token comment">//以行为单位来读取</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fscanln</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ReadAge<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"读取到的数据为,Name: %s,Age: %d\n"</span><span class="token punctuation">,</span> ReadName<span class="token punctuation">,</span> ReadAge<span class="token punctuation">)</span>

	<span class="token comment">// 将格式化的结果以字符串形式返回</span>
	info <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Name: %s, Age: %d, Height: %.2f"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> height<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span>

	<span class="token comment">// 从标准输入读取并格式化输入</span>
	<span class="token keyword">var</span> input <span class="token builtin">string</span>
	fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"Enter your name: "</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Scanln</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>input<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Hello, %s!\n"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_315"></a>流程控制</h2> 
<h3><a id="ifswitchselect_317"></a>if、switch、select</h3> 
<table><thead><tr><th align="center">语句</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center"><strong>if语句</strong></td><td align="center"><strong>if 语句</strong> 由一个布尔表达式后紧跟一个或多个语句组成。</td></tr><tr><td align="center"><strong>if else</strong></td><td align="center"><strong>if 语句</strong> 后可以使用可选的 <strong>else 语句</strong>, else 语句中的表达式在布尔表达式为 false 时执行。</td></tr><tr><td align="center"><strong>else if</strong></td><td align="center">你可以在 <strong>if</strong> 或 <strong>else if</strong> 语句中嵌入一个或多个 <strong>if</strong> 或 <strong>else if</strong> 语句。</td></tr><tr><td align="center"><strong>switch</strong></td><td align="center"><strong>switch</strong> 语句用于基于不同条件执行不同动作。</td></tr><tr><td align="center"><strong>fallthrough</strong></td><td align="center">当使用<strong>swich</strong>语句时，可以使用<strong>fallthrough</strong> 进行case穿透，下面的条件一定会执行</td></tr><tr><td align="center"><strong>select</strong></td><td align="center"><strong>select</strong> 语句类似于 <strong>switch</strong> 语句，但是select会随机执行一个可运行的case。如果没有case可运行，它将阻塞，直到有case可运行。</td></tr></tbody></table> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"time"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">//if语句</span>
	<span class="token keyword">var</span> password <span class="token builtin">string</span>
	<span class="token keyword">var</span> username <span class="token builtin">string</span>
	fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"请输入账号:"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>username<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"请输入密码:"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>password<span class="token punctuation">)</span>
	<span class="token keyword">if</span> username <span class="token operator">==</span> <span class="token string">"admin"</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> password <span class="token operator">==</span> <span class="token string">"Qyx@Sxf715"</span> <span class="token punctuation">{<!-- --></span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"登录成功"</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"密码错误"</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"用户名错误"</span><span class="token punctuation">)</span> <span class="token comment">//注意这里的else一定要接在if的}后面,不能进行换行</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//switch</span>
	<span class="token keyword">var</span> score <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">88</span>
	<span class="token keyword">switch</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> score <span class="token operator">&gt;=</span> <span class="token number">90</span><span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"成绩为A级"</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> score <span class="token operator">&gt;=</span> <span class="token number">80</span> <span class="token operator">&amp;&amp;</span> score <span class="token operator">&lt;</span> <span class="token number">90</span><span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"成绩为B级"</span><span class="token punctuation">)</span>
		<span class="token comment">//fallthrough 一定会把下面的一个case也穿透掉</span>
	<span class="token keyword">case</span> score <span class="token operator">&gt;=</span> <span class="token number">70</span> <span class="token operator">&amp;&amp;</span> score <span class="token operator">&lt;</span> <span class="token number">80</span><span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"成绩为C级"</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> score <span class="token operator">&gt;=</span> <span class="token number">60</span> <span class="token operator">&amp;&amp;</span> score <span class="token operator">&lt;</span> <span class="token number">70</span><span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"成绩为D级"</span><span class="token punctuation">)</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"成绩为不及格"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//select语句的使用</span>
	ch1 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token comment">//创建了两个通道 ch1 和 ch2</span>
	ch2 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span>
	<span class="token comment">//两个匿名的 goroutine 分别向这两个通道发送值</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
		ch1 <span class="token operator">&lt;-</span> <span class="token string">"Hello"</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
		ch2 <span class="token operator">&lt;-</span> <span class="token string">"World"</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">/*select 会同时监听多个通道的操作，当任何一个 case 中的操作就绪时，该 case 就会被执行。
	如果同时有多个 case 就绪，select 随机选择一个可执行的 case 来执行。
	如果没有任何 case 就绪，并且存在 default 分支，那么执行 default 分支。*/</span>
	<span class="token keyword">select</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> msg1 <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch1<span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Received from ch1:"</span><span class="token punctuation">,</span> msg1<span class="token punctuation">)</span>
	<span class="token keyword">case</span> msg2 <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch2<span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Received from ch2:"</span><span class="token punctuation">,</span> msg2<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token operator">&lt;-</span>time<span class="token punctuation">.</span><span class="token function">After</span><span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span><span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Timed out"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="forbreakcontinue_397"></a>for、break、continue</h3> 
<p><strong>Go</strong>语言的<strong>for</strong>循环也需要三个参数，<code>起始位，最终位，间距</code> ，但是三个参数都可以省略掉。</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">//9*9乘法表</span>
	<span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">9</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> j<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{<!-- --></span>
			fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%dx%d=%d \t"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> i<span class="token operator">*</span>j<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">9</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token number">5</span> <span class="token punctuation">{<!-- --></span>
			<span class="token comment">//结束掉整个循环</span>
			<span class="token keyword">break</span>
		<span class="token punctuation">}</span>
		fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">9</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token number">5</span> <span class="token punctuation">{<!-- --></span>
			<span class="token comment">//结束当次循环</span>
			<span class="token keyword">continue</span>
		<span class="token punctuation">}</span>
		fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="String_433"></a>遍历String</h3> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">var</span> str <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">"Hello,Aiwin"</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"字符串的长度为%d\n"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"第二个字符是%c\n"</span><span class="token punctuation">,</span> str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token comment">//遍历字符串</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">len</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//for range</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> i<span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> str <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%d%c\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> v<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_458"></a>函数</h2> 
<ol><li>函数是一个基本代码块，用于执行一个任务</li><li>Go语言最少有一个<strong>main</strong>函数</li><li>函数声明告诉编译器函数的名称，返回类型，参数</li><li>函数本身也是一个变量，也可以进行赋值</li></ol> 
<pre><code>function 函数名(参数，参数类型)(返回类型){}
</code></pre> 
<ul><li>形式参数：定义函数时，用于接收外部传入数据的参数</li><li>实际参数：调用函数时，传给形参的实际数据是实际参数</li><li>可变参数：参数类型确定，但是数量不确定，可以用**…<strong>，可变参数前面可以继续定义参数，后面不能再定义参数，一个函数列表只能有</strong>一个**可变参数</li></ul> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"1+2的结果为"</span><span class="token punctuation">,</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	x<span class="token punctuation">,</span> y <span class="token operator">:=</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token string">"你好"</span><span class="token punctuation">,</span> <span class="token string">"Go语言"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
	<span class="token function">printMessage</span><span class="token punctuation">(</span><span class="token string">"一个参数的函数"</span><span class="token punctuation">)</span>
	<span class="token function">printStatic</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"求和函数:"</span><span class="token punctuation">,</span> <span class="token function">getSum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token comment">// 有多个返回值函数</span>
<span class="token keyword">func</span> <span class="token function">swap</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> y<span class="token punctuation">,</span> x
<span class="token punctuation">}</span>

<span class="token comment">// 有两个参数的函数</span>
<span class="token keyword">func</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{<!-- --></span>
	result <span class="token operator">:=</span> a <span class="token operator">+</span> b
	<span class="token keyword">return</span> result
<span class="token punctuation">}</span>

<span class="token comment">// 一个参数函数</span>
<span class="token keyword">func</span> <span class="token function">printMessage</span><span class="token punctuation">(</span>msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 无参数函数</span>
<span class="token keyword">func</span> <span class="token function">printStatic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"无参数函数"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">getSum</span><span class="token punctuation">(</span>number <span class="token operator">...</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{<!-- --></span>
	sum <span class="token operator">:=</span> <span class="token number">0</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">len</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{<!-- --></span>
		sum <span class="token operator">+=</span> number<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> sum
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="_522"></a>值传递和引用传递</h3> 
<ul><li>值类型数据：操作的是数据本身，如<strong>int</strong>，<strong>string</strong> ，<strong>bool</strong>，<strong>array</strong>，改变值不会改变数据本身，地址是不一样的</li><li>引用类型数据，操作的是数据的地址，如<strong>slice</strong>，<strong>map</strong> ，<strong>chanel</strong>，改变的时候会一起改变，函数地址是一样的。</li></ul> 
<h3><a id="defer_527"></a>defer</h3> 
<p>可以在函数中添加多个defer语句，当函数执行到最后时，这些defer语句会<strong>逆序执行</strong>，可以用于在函数返回前关闭相应的资源等操作</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">//值传递</span>
	arr <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span>
	<span class="token function">updateArr</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
	<span class="token comment">//引用传递</span>
	sli <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>
	<span class="token function">updateSlice</span><span class="token punctuation">(</span>sli<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>sli<span class="token punctuation">)</span>
	<span class="token comment">//defer函数</span>
	a <span class="token operator">:=</span> <span class="token number">10</span>
	<span class="token keyword">defer</span> <span class="token function">MyPrint</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">//输出10,已经传递进去了,一切准备就绪</span>
	a<span class="token operator">++</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">updateArr</span><span class="token punctuation">(</span>arr <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">updateSlice</span><span class="token punctuation">(</span>sli <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	sli<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>sli<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">MyPrint</span><span class="token punctuation">(</span>number <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="init_565"></a>init</h3> 
<ol><li> <p>**init()**函数不能被其它函数调用，而是在main函数执行之前自动被调用</p> </li><li> <p><strong>init</strong> 函数不能作为参数传入，不能有传入参数和返回值</p> </li><li> <p>当一个<strong>main</strong>有多个<strong>init</strong>函数，谁在前谁就先执行</p> </li></ol> 
<h3><a id="_575"></a>匿名、回调、闭包函数</h3> 
<ol><li>也叫闭包函数(closures),<strong>允许临时创建一个没有指定名称的函数</strong></li><li>回调函数就是一个函数作为<strong>另一个函数的参数</strong>。</li><li>闭包结构，一个外层函数中有内层函数，该内层函数中可以操作外层函数的局部变量，并且外层函数的返回值是内层函数，这种结构是闭包结构。</li><li>正常的局部变量会随着函数的调用而创建，随着函数的结束而销毁，但是在闭包结构中的外层函数的局部变量并不会随着外层函数的结果而销毁，因为内层函数还在堆栈中使用</li></ol> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	r1 <span class="token operator">:=</span> <span class="token function">operator</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> add<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span>

	<span class="token comment">//匿名函数</span>
	r2 <span class="token operator">:=</span> <span class="token function">operator</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token number">0</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> a <span class="token operator">/</span> b
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span>

	<span class="token comment">//闭包结构</span>
	f1 <span class="token operator">:=</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	f2 <span class="token operator">:=</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//输出3,f1没有被销毁</span>
<span class="token punctuation">}</span>

<span class="token comment">// 回调函数,fun是告诫函数,operator是回调函数</span>
<span class="token keyword">func</span> <span class="token function">operator</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">,</span> fun <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token function">fun</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> a <span class="token operator">+</span> b
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{<!-- --></span>
	i <span class="token operator">:=</span> <span class="token number">0</span>
	fun <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{<!-- --></span>
		i<span class="token operator">++</span>
		<span class="token keyword">return</span> i
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> fun
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_628"></a>数组和切片</h2> 
<p>数组的数量在创建的时候就定义的，不可再进行改变。</p> 
<p>数组的定义语法：</p> 
<pre><code>var 数组名 [数量]数据类型=[数量]数据类型{数据}
</code></pre> 
<p>切片相对于数组来说更加灵活，切片的长度是可变的，相当于可切的数组</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">main</span>

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

func <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">var</span> nameArr <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>string <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>string<span class="token punctuation">{<!-- --></span><span class="token string">"Hello"</span><span class="token punctuation">,</span> <span class="token string">"Wor"</span><span class="token punctuation">,</span> <span class="token string">"ld"</span><span class="token punctuation">}</span>
	<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span>nameArr<span class="token punctuation">)</span>
	<span class="token keyword">var</span> nameList <span class="token punctuation">[</span><span class="token punctuation">]</span>string
	nameList <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>nameList<span class="token punctuation">,</span> <span class="token string">"Hello"</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span>nameList<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="Map_655"></a>Map</h2> 
<p>Map就是Python中的字典(键值对)，Map创建的时候一定需要初始化</p> 
<pre><code>var 变量名 map[键类型]值类型{}
</code></pre> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">var</span> userMap <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token operator">=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{<!-- --></span>
		<span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">"Aiwin"</span><span class="token punctuation">,</span>
		<span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">"Lau"</span><span class="token punctuation">,</span>
		<span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>userMap<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	value<span class="token punctuation">,</span> ok <span class="token operator">:=</span> userMap<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment">//3存在,ok是true</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> ok<span class="token punctuation">)</span>
	userMap<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"LauAiwin"</span>
	<span class="token function">delete</span><span class="token punctuation">(</span>userMap<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>userMap<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_684"></a>结构体</h2> 
<p>结构体定义，可以类比为对象</p> 
<pre><code>type 结构体名称 struct{
	名称 类型
}
</code></pre> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"encoding/json"</span>
	<span class="token string">"fmt"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Parent <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Name <span class="token builtin">string</span>
	Age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Children <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Parent
	Name <span class="token builtin">string</span>
	Age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>children <span class="token operator">*</span>Children<span class="token punctuation">)</span> <span class="token function">setChildernName</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span> age <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//引用传递</span>
	children<span class="token punctuation">.</span>Name <span class="token operator">=</span> name
	children<span class="token punctuation">.</span>Age <span class="token operator">=</span> age
<span class="token punctuation">}</span>

<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Username <span class="token builtin">string</span> <span class="token string">`json:"username"`</span>      <span class="token comment">//转换结果为username</span>
	Password <span class="token builtin">string</span> <span class="token string">`json:"-"`</span>             <span class="token comment">//不显示</span>
	Age      <span class="token builtin">int</span>    <span class="token string">`json:"age,omitempty"`</span> <span class="token comment">//抛弃空值</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	parent <span class="token operator">:=</span> Parent<span class="token punctuation">{<!-- --></span>Name<span class="token punctuation">:</span> <span class="token string">"Lau"</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">40</span><span class="token punctuation">}</span>
	childern <span class="token operator">:=</span> Children<span class="token punctuation">{<!-- --></span>parent<span class="token punctuation">,</span> <span class="token string">"Aiwin"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%s的父亲是:%s,年龄是:%d\n"</span><span class="token punctuation">,</span> childern<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> childern<span class="token punctuation">.</span>Parent<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> childern<span class="token punctuation">.</span>Parent<span class="token punctuation">.</span>Age<span class="token punctuation">)</span>
	childern<span class="token punctuation">.</span><span class="token function">setChildernName</span><span class="token punctuation">(</span><span class="token string">"LauAiwin"</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>childern<span class="token punctuation">)</span>
	user <span class="token operator">:=</span> User<span class="token punctuation">{<!-- --></span><span class="token string">"Aiwin"</span><span class="token punctuation">,</span> <span class="token string">"123456"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span>
	byteData<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Marshal</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>byteData<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_737"></a>自定义数据类型</h2> 
<p>自定义类型的本意就是为了代码更简化、易于理解、方便维护。</p> 
<p>类型别名(就是将类型赋值给一个type)</p> 
<ol><li>不能绑定方法</li><li>打印类型还是原始类型</li><li>类型别名不用转换</li></ol> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">type</span> Code <span class="token builtin">int</span>

<span class="token keyword">const</span> <span class="token punctuation">(</span>
	SuccessCode Code <span class="token operator">=</span> <span class="token number">1</span>
	ErrorCode   Code <span class="token operator">=</span> <span class="token number">2</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>code Code<span class="token punctuation">)</span> <span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>message <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">switch</span> code <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> SuccessCode<span class="token punctuation">:</span>
		<span class="token keyword">return</span> <span class="token string">"请求成功"</span>
	<span class="token keyword">case</span> ErrorCode<span class="token punctuation">:</span>
		<span class="token keyword">return</span> <span class="token string">"请求失败"</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token string">""</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>code Code<span class="token punctuation">)</span> <span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>result Code<span class="token punctuation">,</span> message <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> code<span class="token punctuation">,</span> code<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">Request</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>code Code<span class="token punctuation">,</span> message <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> name <span class="token operator">==</span> <span class="token string">"admin"</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> SuccessCode<span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> ErrorCode<span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_786"></a>接口</h2> 
<p>接口是一组仅包含方法名、参数、返回值的为具体实现的方法的集合，同样接口也不能绑定<strong>方法</strong></p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	name <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Name <span class="token keyword">interface</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>student Student<span class="token punctuation">)</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> student<span class="token punctuation">.</span>name
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Teacher <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	name <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>teacher Teacher<span class="token punctuation">)</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> teacher<span class="token punctuation">.</span>name
<span class="token punctuation">}</span>

<span class="token comment">// 接口,可以统一传入其它的类型</span>
<span class="token keyword">func</span> <span class="token function">getName</span><span class="token punctuation">(</span>name Name<span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//name.(Teacher)</span>
	<span class="token keyword">switch</span> types <span class="token operator">:=</span> name<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//类型断言</span>
	<span class="token keyword">case</span> Teacher<span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>types<span class="token punctuation">)</span>
	<span class="token keyword">case</span> Student<span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>types<span class="token punctuation">)</span>

	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> name<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">MyPrint</span><span class="token punctuation">(</span>val <span class="token keyword">interface</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//空接口</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	student <span class="token operator">:=</span> Student<span class="token punctuation">{<!-- --></span><span class="token string">"Aiwin"</span><span class="token punctuation">}</span>
	teacher <span class="token operator">:=</span> Teacher<span class="token punctuation">{<!-- --></span><span class="token string">"Xd"</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span>teacher<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token function">MyPrint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="channel_841"></a>协程和channel</h2> 
<p><strong>协程</strong>可以理解为轻量级线程，一个线程可以拥有多个协程，与线程相比，协程不受操作系统调度，协程调度器按照调度策略把协程调度到线程中执行，协程调度器由应用程序的runtime包提供，用户使用<strong>go关键字</strong>即可创建协程，这也就是GO在语言层面直接支持协程的特色</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"sync"</span>
	<span class="token string">"time"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">shopping</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span> group <span class="token operator">*</span>sync<span class="token punctuation">.</span>WaitGroup<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%s 开始攻击\n"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%s 停止攻击\n"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
	group<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">var</span> group sync<span class="token punctuation">.</span>WaitGroup
	StartTime <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	group<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token function">shopping</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>group<span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token function">shopping</span><span class="token punctuation">(</span><span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>group<span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token function">shopping</span><span class="token punctuation">(</span><span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>group<span class="token punctuation">)</span>
	group<span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Since</span><span class="token punctuation">(</span>StartTime<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>那么协程里面产生的数据，怎么传递给主线程，<strong>Go</strong> 官方使用<strong>channel</strong> 来传递</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"sync"</span>
	<span class="token string">"time"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> moneyChanel <span class="token keyword">chan</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> nameChanel <span class="token keyword">chan</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> DoneChanel <span class="token keyword">chan</span> <span class="token keyword">struct</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token keyword">struct</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">shopping</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span> money <span class="token builtin">int</span><span class="token punctuation">,</span> group <span class="token operator">*</span>sync<span class="token punctuation">.</span>WaitGroup<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%s 开始攻击\n"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%s 停止攻击\n"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
	moneyChanel <span class="token operator">&lt;-</span> money
	nameChanel <span class="token operator">&lt;-</span> name
	group<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">var</span> group sync<span class="token punctuation">.</span>WaitGroup
	StartTime <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	group<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token function">shopping</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>group<span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token function">shopping</span><span class="token punctuation">(</span><span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>group<span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token function">shopping</span><span class="token punctuation">(</span><span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>group<span class="token punctuation">)</span>
	<span class="token keyword">var</span> moneyList <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>
	<span class="token keyword">var</span> nameList <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//解决moneyChanel一直死循环的问题</span>
		<span class="token keyword">defer</span> <span class="token function">close</span><span class="token punctuation">(</span>moneyChanel<span class="token punctuation">)</span>
		<span class="token keyword">defer</span> <span class="token function">close</span><span class="token punctuation">(</span>nameChanel<span class="token punctuation">)</span>
		<span class="token keyword">defer</span> <span class="token function">close</span><span class="token punctuation">(</span>DoneChanel<span class="token punctuation">)</span>
		group<span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">//go func(){<!-- --></span>
	<span class="token comment">//	for money := range moneyChanel {<!-- --></span>
	<span class="token comment">//		moneyList = append(moneyList, money) //解决moneyChannel被一直输数据问题</span>
	<span class="token comment">//	}</span>
	<span class="token comment">//}()</span>
	<span class="token comment">//for name := range nameChanel {<!-- --></span>
	<span class="token comment">//	nameList = append(nameList, name)</span>
	<span class="token comment">//}</span>
	event <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">select</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">case</span> names <span class="token operator">:=</span> <span class="token operator">&lt;-</span>nameChanel<span class="token punctuation">:</span>
				nameList <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>nameList<span class="token punctuation">,</span> names<span class="token punctuation">)</span>
			<span class="token keyword">case</span> money <span class="token operator">:=</span> <span class="token operator">&lt;-</span>moneyChanel<span class="token punctuation">:</span>
				moneyList <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>moneyList<span class="token punctuation">,</span> money<span class="token punctuation">)</span>
			<span class="token keyword">case</span> <span class="token operator">&lt;-</span>DoneChanel<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>解决当协程全部完事<span class="token punctuation">,</span>退出循环的问题
				<span class="token keyword">return</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">event</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>moneyList<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>nameList<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Since</span><span class="token punctuation">(</span>StartTime<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>超时</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"time"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> doneChanel <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token keyword">struct</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">timeOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"开始"</span><span class="token punctuation">)</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"结束"</span><span class="token punctuation">)</span>
	<span class="token function">close</span><span class="token punctuation">(</span>doneChanel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">go</span> <span class="token function">timeOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">select</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> <span class="token operator">&lt;-</span>doneChanel<span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"执行完成"</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token operator">&lt;-</span>time<span class="token punctuation">.</span><span class="token function">After</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span><span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"超时"</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_971"></a>线程锁</h2> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">main</span>

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"sync"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> sum <span class="token keyword">int</span>
<span class="token keyword">var</span> wait <span class="token class-name"><span class="token namespace">sync<span class="token punctuation">.</span></span>WaitGroup</span>

<span class="token keyword">var</span> lock <span class="token class-name"><span class="token namespace">sync<span class="token punctuation">.</span></span>Mutex</span>

func <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name"><span class="token namespace">lock<span class="token punctuation">.</span></span>Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//线程锁,不然会线程紊乱</span>
	<span class="token keyword">for</span> i <span class="token operator">:</span><span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{<!-- --></span>
		sum<span class="token operator">++</span>
	<span class="token punctuation">}</span>
	<span class="token class-name"><span class="token namespace">lock<span class="token punctuation">.</span></span>Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">wait<span class="token punctuation">.</span></span>Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>
func <span class="token function">sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name"><span class="token namespace">lock<span class="token punctuation">.</span></span>Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
	<span class="token keyword">for</span> i <span class="token operator">:</span><span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{<!-- --></span>
		sum<span class="token operator">--</span>
	<span class="token punctuation">}</span>
	<span class="token class-name"><span class="token namespace">lock<span class="token punctuation">.</span></span>Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">wait<span class="token punctuation">.</span></span>Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
func <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name"><span class="token namespace">wait<span class="token punctuation">.</span></span>Add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
	go <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	go <span class="token function">sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">wait<span class="token punctuation">.</span></span>Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span>
	<span class="token keyword">var</span> maps <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">sync<span class="token punctuation">.</span></span>Map</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token comment">//Map的协程紊乱,要使用这种创建方式</span>
	go <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">{<!-- --></span>
			<span class="token class-name"><span class="token namespace">maps<span class="token punctuation">.</span></span>Store</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"Aiwin"</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	go <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">{<!-- --></span>
			<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">maps<span class="token punctuation">.</span></span>Load</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	select <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_1025"></a>异常处理</h2> 
<p>Go语言没有捕获异常的机制，每次都要接<strong>error</strong> ，这是Go语言的一个诟病，异常处理可分为三种，分别是中断、恢复、从上一级返回处理。</p> 
<p>例子：</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">main</span>

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"errors"</span>
	<span class="token string">"fmt"</span>
<span class="token punctuation">)</span>

<span class="token comment">// 中断仅适用于init开始时</span>
<span class="token comment">//</span>
<span class="token comment">//	func init() {<!-- --></span>
<span class="token comment">//		_, err := os.ReadFile("aaa")</span>
<span class="token comment">//		if err != nil {<!-- --></span>
<span class="token comment">//			panic("中断报错了")</span>
<span class="token comment">//		}</span>
<span class="token comment">//	}</span>
func <span class="token function">div</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token keyword">int</span><span class="token punctuation">,</span> err error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{<!-- --></span>
		err <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">errors<span class="token punctuation">.</span></span>New</span><span class="token punctuation">(</span><span class="token string">"除数不能为0"</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	res <span class="token operator">=</span> a <span class="token operator">/</span> b
	<span class="token keyword">return</span> res<span class="token punctuation">,</span> nil
<span class="token punctuation">}</span>

func <span class="token function">zhixing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token keyword">int</span><span class="token punctuation">,</span> err error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	res<span class="token punctuation">,</span> err <span class="token operator">=</span> <span class="token function">div</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> nil <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	res <span class="token operator">+=</span> <span class="token number">2</span>
	<span class="token keyword">return</span> res<span class="token punctuation">,</span> nil

<span class="token punctuation">}</span>

func <span class="token function">recovery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	defer <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> lists <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">int</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">int</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>
	<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span>lists<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>
func <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">/*错误向上处理
	res, err := zhixing()
	if err != nil {
		fmt.Println(err)
		return
	}
	fmt.Println(res)*/</span>
	<span class="token function">recovery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"恢复正常逻辑"</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_1089"></a>泛型</h2> 
<p>Go语言的泛型是指在定义函数、数据结构或接口时，可以不指定具体数据类型，而是以一种通用的方式编写代码，以便在不同的数据类型上有效地进行操作。泛型使得代码更具有通用性和可复用性，因为它可以适用于多种不同类型的数据而无需重复编写相似的代码。</p> 
<p>比如说结构的泛型：</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"encoding/json"</span>
	<span class="token string">"fmt"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Response<span class="token punctuation">[</span>A any<span class="token punctuation">]</span> <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Code <span class="token builtin">int</span>    <span class="token string">`json:"code"`</span>
	Msg  <span class="token builtin">string</span> <span class="token string">`json:"msg"`</span>
	Data A      <span class="token string">`json:"data"`</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Name <span class="token builtin">string</span> <span class="token string">`json:"name"`</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> User1 <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Name <span class="token builtin">string</span> <span class="token string">`json:"name"`</span>
	Age  <span class="token builtin">int</span>    <span class="token string">`json:"age"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">//UserInfo := Response[User]{<!-- --></span>
	<span class="token comment">//	Code: 1,</span>
	<span class="token comment">//	Msg:  "反序列化",</span>
	<span class="token comment">//	Data: User{<!-- --></span>
	<span class="token comment">//		Name: "Aiwin",</span>
	<span class="token comment">//	},</span>
	<span class="token comment">//}</span>
	<span class="token comment">//marshal, _ := json.Marshal(UserInfo)</span>
	<span class="token comment">//fmt.Println(string(marshal))</span>
	<span class="token keyword">var</span> UnMarRes Response<span class="token punctuation">[</span>User<span class="token punctuation">]</span>
	json<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">`{"code":1,"msg":"反序列化","data":{"name":"Aiwin"}}`</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>UnMarRes<span class="token punctuation">)</span> <span class="token comment">//通过泛型可以识别是属于哪一个User</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>UnMarRes<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>

<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_1134"></a>文件读取</h2> 
<ol><li> <p><code>os.ReadFile()</code>一次性读取整个文件的内容。</p> </li><li> <p><code>os.Open()</code>分片读取。</p> </li><li> <p><code>bufio</code>依赖来读取，指定分割符，换行符等</p> <pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"bufio"</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"os"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	file<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">"text.txt"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"文件读取错误"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//buf := bufio.NewReader(file)</span>
	<span class="token comment">//for {<!-- --></span>
	<span class="token comment">//	line, _, err := buf.ReadLine()</span>
	<span class="token comment">//	if err == io.EOF {<!-- --></span>
	<span class="token comment">//		break</span>
	<span class="token comment">//	}</span>
	<span class="token comment">//	fmt.Println(string(line))</span>
	<span class="token comment">//}</span>
	<span class="token comment">//指定分割符</span>
	scanner <span class="token operator">:=</span> bufio<span class="token punctuation">.</span><span class="token function">NewScanner</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
	scanner<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>bufio<span class="token punctuation">.</span>ScanLines<span class="token punctuation">)</span>
	<span class="token keyword">for</span> scanner<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>scanner<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> </li></ol> 
<h2><a id="_1174"></a>文件写入</h2> 
<ol><li> <p><code>os.openFile()</code>中flag的类型：</p> <pre><code class="prism language-go"><span class="token keyword">const</span> <span class="token punctuation">(</span>
	O_RDONLY <span class="token builtin">int</span> <span class="token operator">=</span> syscall<span class="token punctuation">.</span>O_RDONLY <span class="token comment">// open the file read-only.</span>
	O_WRONLY <span class="token builtin">int</span> <span class="token operator">=</span> syscall<span class="token punctuation">.</span>O_WRONLY <span class="token comment">// open the file write-only.</span>
	O_RDWR   <span class="token builtin">int</span> <span class="token operator">=</span> syscall<span class="token punctuation">.</span>O_RDWR   <span class="token comment">// open the file read-write.</span>
	O_APPEND <span class="token builtin">int</span> <span class="token operator">=</span> syscall<span class="token punctuation">.</span>O_APPEND <span class="token comment">// append data to the file when writing.</span>
	O_CREATE <span class="token builtin">int</span> <span class="token operator">=</span> syscall<span class="token punctuation">.</span>O_CREAT  <span class="token comment">// create a new file if none exists.</span>
	O_EXCL   <span class="token builtin">int</span> <span class="token operator">=</span> syscall<span class="token punctuation">.</span>O_EXCL   <span class="token comment">// used with O_CREATE, file must not exist.</span>
	O_SYNC   <span class="token builtin">int</span> <span class="token operator">=</span> syscall<span class="token punctuation">.</span>O_SYNC   <span class="token comment">// open for synchronous I/O.</span>
	O_TRUNC  <span class="token builtin">int</span> <span class="token operator">=</span> syscall<span class="token punctuation">.</span>O_TRUNC  <span class="token comment">// truncate regular writable file when opened.</span>
<span class="token punctuation">)</span>
</code></pre> <p>例子:</p> <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">main</span>

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"io"</span>
	<span class="token string">"os"</span>
<span class="token punctuation">)</span>
func <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">//文件写入</span>
	file<span class="token punctuation">,</span> err <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">os<span class="token punctuation">.</span></span>OpenFile</span><span class="token punctuation">(</span><span class="token string">"text.txt"</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span><span class="token constant">O_CREATE</span><span class="token operator">|</span>os<span class="token punctuation">.</span><span class="token constant">O_RDWR</span><span class="token punctuation">,</span> <span class="token number">0777</span><span class="token punctuation">)</span> <span class="token comment">//模式和权限,权限仅针对linux系统</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> nil <span class="token punctuation">{<!-- --></span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"文件写入失败"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	defer <span class="token class-name"><span class="token namespace">file<span class="token punctuation">.</span></span>Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">file<span class="token punctuation">.</span></span>Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">byte</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

	<span class="token comment">//文件写入</span>
	err1 <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">os<span class="token punctuation">.</span></span>WriteFile</span><span class="token punctuation">(</span><span class="token string">"text.txt"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">byte</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0777</span><span class="token punctuation">)</span> <span class="token comment">//全部写入,会全覆盖</span>
	<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span>err1<span class="token punctuation">)</span>

	<span class="token comment">//文件复制</span>
	rFile<span class="token punctuation">,</span> err2 <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">os<span class="token punctuation">.</span></span>Open</span><span class="token punctuation">(</span><span class="token string">"text.txt"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err2 <span class="token operator">!=</span> nil <span class="token punctuation">{<!-- --></span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"文件不可取"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	wFile<span class="token punctuation">,</span> err3 <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">os<span class="token punctuation">.</span></span>OpenFile</span><span class="token punctuation">(</span><span class="token string">"copy.txt"</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span><span class="token constant">O_CREATE</span><span class="token operator">|</span>os<span class="token punctuation">.</span><span class="token constant">O_WRONLY</span><span class="token punctuation">,</span> <span class="token number">0777</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err3 <span class="token operator">!=</span> nil <span class="token punctuation">{<!-- --></span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"文件错误"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	defer <span class="token class-name"><span class="token namespace">wFile<span class="token punctuation">.</span></span>Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span></span>Copy</span><span class="token punctuation">(</span>wFile<span class="token punctuation">,</span> rFile<span class="token punctuation">)</span> <span class="token comment">//文件复制</span>

	dir<span class="token punctuation">,</span> err <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">os<span class="token punctuation">.</span></span>ReadDir</span><span class="token punctuation">(</span><span class="token string">"基础语法"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> nil <span class="token punctuation">{<!-- --></span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> _<span class="token punctuation">,</span> entry <span class="token operator">:</span><span class="token operator">=</span> range dir <span class="token punctuation">{<!-- --></span>
		info<span class="token punctuation">,</span> _ <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">entry<span class="token punctuation">.</span></span>Info</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">entry<span class="token punctuation">.</span></span>IsDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">entry<span class="token punctuation">.</span></span>Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">info<span class="token punctuation">.</span></span>Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <h2><a id="_1237"></a>反射</h2> 
  <ol><li><code>reflect.typeof</code> 获取类型</li><li><code>reflect.Valueof</code> 获取值</li><li><code>setInt、setString</code> 重新设置值</li></ol> </li></ol> 
<p>demo</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">main</span>

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"reflect"</span>
<span class="token punctuation">)</span>

func <span class="token function">getType</span><span class="token punctuation">(</span>obj any<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	v <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">reflect<span class="token punctuation">.</span></span>TypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
	<span class="token keyword">switch</span> <span class="token class-name"><span class="token namespace">v<span class="token punctuation">.</span></span>Kind</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> <span class="token class-name"><span class="token namespace">reflect<span class="token punctuation">.</span></span>Int</span><span class="token operator">:</span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"获取到Int类型"</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token class-name"><span class="token namespace">reflect<span class="token punctuation">.</span></span>String</span><span class="token operator">:</span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"获取到String类型"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//注意要更改值，需要使用指针的形式更改</span>
func <span class="token function">setValue</span><span class="token punctuation">(</span>obj any<span class="token punctuation">,</span> value any<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	v1 <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">reflect<span class="token punctuation">.</span></span>ValueOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
	v2 <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">reflect<span class="token punctuation">.</span></span>ValueOf</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
	<span class="token keyword">if</span> <span class="token class-name"><span class="token namespace">v1<span class="token punctuation">.</span></span>Elem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Kind</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token class-name"><span class="token namespace">v2<span class="token punctuation">.</span></span>Kind</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//获取一个值的指针所指向的元素值</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">switch</span> <span class="token class-name"><span class="token namespace">v1<span class="token punctuation">.</span></span>Elem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Kind</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> <span class="token class-name"><span class="token namespace">reflect<span class="token punctuation">.</span></span>Int</span><span class="token operator">:</span>
		<span class="token class-name"><span class="token namespace">v1<span class="token punctuation">.</span></span>Elem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetInt</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">v2<span class="token punctuation">.</span></span>Int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token class-name"><span class="token namespace">reflect<span class="token punctuation">.</span></span>String</span><span class="token operator">:</span>
		<span class="token class-name"><span class="token namespace">v1<span class="token punctuation">.</span></span>Elem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetString</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

func <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"张三"</span>
	<span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">24</span>
	<span class="token function">getType</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
	<span class="token function">getType</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span>
	<span class="token function">setValue</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>name<span class="token punctuation">,</span> <span class="token string">"李四"</span><span class="token punctuation">)</span>
	<span class="token function">setValue</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>age<span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">main</span>

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"reflect"</span>
<span class="token punctuation">)</span>

type <span class="token class-name">User</span> struct <span class="token punctuation">{<!-- --></span>
	<span class="token class-name">UserName</span> string `json<span class="token operator">:</span><span class="token string">"userName"</span>`
	<span class="token class-name">Password</span> string `json<span class="token operator">:</span><span class="token string">"password"</span>`
<span class="token punctuation">}</span>

func <span class="token function">demo</span><span class="token punctuation">(</span>obj any<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	t <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">reflect<span class="token punctuation">.</span></span>TypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
	v <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">reflect<span class="token punctuation">.</span></span>ValueOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:</span><span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name"><span class="token namespace">t<span class="token punctuation">.</span></span>NumField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{<!-- --></span>
		value <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">v<span class="token punctuation">.</span></span>Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> i <span class="token operator">:</span><span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name"><span class="token namespace">t<span class="token punctuation">.</span></span>NumMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{<!-- --></span>
		m <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">t<span class="token punctuation">.</span></span>Method</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token class-name"><span class="token namespace">m<span class="token punctuation">.</span></span>Name</span> <span class="token operator">!=</span> <span class="token string">"Call"</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//方法名必须为大写</span>
			<span class="token keyword">continue</span>
		<span class="token punctuation">}</span>
		method <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">v<span class="token punctuation">.</span></span>Method</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
		<span class="token class-name"><span class="token namespace">method<span class="token punctuation">.</span></span>Call</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token class-name"><span class="token namespace">reflect<span class="token punctuation">.</span></span>Value</span><span class="token punctuation">{<!-- --></span>
			<span class="token class-name"><span class="token namespace">reflect<span class="token punctuation">.</span></span>ValueOf</span><span class="token punctuation">(</span><span class="token string">"Aiwin"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

func <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span> <span class="token class-name">Call</span><span class="token punctuation">(</span>name string<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"我的名字是"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

func <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	user <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name">User</span><span class="token punctuation">{<!-- --></span><span class="token class-name">UserName</span><span class="token operator">:</span> <span class="token string">"Aiwin"</span><span class="token punctuation">,</span> <span class="token class-name">Password</span><span class="token operator">:</span> <span class="token string">"123456"</span><span class="token punctuation">}</span>
	<span class="token function">demo</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>反射转ord小案例：</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"errors"</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"reflect"</span>
	<span class="token string">"strings"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Users <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Name <span class="token builtin">string</span> <span class="token string">`orm:"name"`</span>
	Id   <span class="token builtin">int</span>    <span class="token string">`orm:"id"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">Find</span><span class="token punctuation">(</span>obj any<span class="token punctuation">,</span> query <span class="token operator">...</span>any<span class="token punctuation">)</span> <span class="token punctuation">(</span>sql <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	t <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">TypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
	<span class="token keyword">if</span> t<span class="token punctuation">.</span><span class="token function">Kind</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> reflect<span class="token punctuation">.</span>Struct <span class="token punctuation">{<!-- --></span>
		err <span class="token operator">=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"非结构体"</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//获取到where</span>
	<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 有第二个参数，校验第二个参数中的？个数，是不是和后面的个数一样</span>
		q <span class="token operator">:=</span> query<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">//取第一个参数</span>
		<span class="token keyword">if</span> strings<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"?"</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span> <span class="token operator">!=</span> <span class="token function">len</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			err <span class="token operator">=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"参数个数不对"</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">var</span> where <span class="token builtin">string</span>
		<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> a <span class="token operator">:=</span> <span class="token keyword">range</span> query<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
			at <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">TypeOf</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
			<span class="token keyword">switch</span> at<span class="token punctuation">.</span><span class="token function">Kind</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">case</span> reflect<span class="token punctuation">.</span>Int<span class="token punctuation">:</span>
				q <span class="token operator">=</span> strings<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"?"</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">//将?替换成数值</span>
			<span class="token keyword">case</span> reflect<span class="token punctuation">.</span>String<span class="token punctuation">:</span>
				q <span class="token operator">=</span> strings<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"?"</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"'%s'"</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		where <span class="token operator">+=</span> <span class="token string">"where "</span> <span class="token operator">+</span> q<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span>
		<span class="token comment">//获取到字段</span>
		<span class="token keyword">var</span> columns <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
		<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> t<span class="token punctuation">.</span><span class="token function">NumField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{<!-- --></span>
			field <span class="token operator">:=</span> t<span class="token punctuation">.</span><span class="token function">Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
			f <span class="token operator">:=</span> field<span class="token punctuation">.</span>Tag<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"orm"</span><span class="token punctuation">)</span>
			columns <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>columns<span class="token punctuation">,</span> f<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//获取表名称</span>
		table <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		sql <span class="token operator">=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"select %s from %s %s"</span><span class="token punctuation">,</span> strings<span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span>columns<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> where<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	sql<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">Find</span><span class="token punctuation">(</span>Users<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"name= ? and id = ?"</span><span class="token punctuation">,</span> <span class="token string">"Aiwin"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token comment">//select name,id from Users where name='Aiwin' and id=1</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	sql<span class="token punctuation">,</span> err <span class="token operator">=</span> <span class="token function">Find</span><span class="token punctuation">(</span>Users<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"id = ?"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token comment">//select name,id from Users where id=1</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="TCP_1401"></a>TCP网络编程</h2> 
<p>主要通过<code>net</code>依赖包来完成，比如以下方法：</p> 
<ul><li><code>net.Dial(network, address string) (Conn, error)</code>：通过指定的网络协议和地址连接到远程主机，返回一个Conn接口类型的实例和可能的错误。</li><li><code>net.Listen(network, address string) (Listener, error)</code>：在指定的网络协议和地址上监听连接，返回一个Listener接口类型的实例和可能的错误。</li><li><code>net.DialTimeout(network, address string, timeout time.Duration) (Conn, error)</code>：在指定的超时时间内，通过指定的网络协议和地址连接到远程主机，返回一个Conn接口类型的实例和可能的错误。</li><li><code>net.ListenPacket(network, address string) (PacketConn, error)</code>：在指定的网络协议和地址上监听数据包的到达，返回一个PacketConn接口类型的实例和可能的错误。</li><li><code>net.ResolveTCPAddr(network, address string) (*TCPAddr, error)</code>：将字符串形式的TCP地址解析为TCPAddr类型的实例，包括IP地址和端口号等信息。</li><li><code>net.ResolveUDPAddr(network, address string) (*UDPAddr, error)</code>：将字符串形式的UDP地址解析为UDPAddr类型的实例，包括IP地址和端口号等信息。</li><li><code>net.LookupHost(host string) ([]string, error)</code>：通过主机名查询对应的IP地址列表，并返回一个字符串切片和可能的错误。</li><li><code>net.LookupPort(network, service string) (port int, err error)</code>：通过网络协议和服务名查询对应的端口号，并返回端口号和可能的错误。</li></ul> 
<p>demo：</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"io"</span>
	<span class="token string">"net"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	tcp<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">ResolveTCPAddr</span><span class="token punctuation">(</span><span class="token string">"tcp"</span><span class="token punctuation">,</span> <span class="token string">"127.0.0.1:81"</span><span class="token punctuation">)</span> <span class="token comment">//将一个字符串形式的 TCP 地址解析为一个 TCPAddr 类型的实例</span>
	listen<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">ListenTCP</span><span class="token punctuation">(</span><span class="token string">"tcp"</span><span class="token punctuation">,</span> tcp<span class="token punctuation">)</span>              <span class="token comment">//进行监听</span>
	<span class="token keyword">for</span> <span class="token punctuation">{<!-- --></span>
		<span class="token comment">//接收连接</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"开始监听...."</span><span class="token punctuation">)</span>
		con<span class="token punctuation">,</span> err <span class="token operator">:=</span> listen<span class="token punctuation">.</span><span class="token function">Accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span>
		<span class="token punctuation">}</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>con<span class="token punctuation">.</span><span class="token function">RemoteAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"进来了"</span><span class="token punctuation">)</span>
		<span class="token keyword">for</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">var</span> buf <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span> <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span>
			n<span class="token punctuation">,</span> err <span class="token operator">:=</span> con<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span>
			<span class="token comment">//客户端退出</span>
			<span class="token keyword">if</span> err <span class="token operator">==</span> io<span class="token punctuation">.</span>EOF <span class="token punctuation">{<!-- --></span>
				fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>con<span class="token punctuation">.</span><span class="token function">RemoteAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"退出了"</span><span class="token punctuation">)</span>
				<span class="token keyword">break</span>
			<span class="token punctuation">}</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"net"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	conn<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">Dial</span><span class="token punctuation">(</span><span class="token string">"tcp"</span><span class="token punctuation">,</span> <span class="token string">"127.0.0.1:81"</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> s <span class="token builtin">string</span>
	<span class="token keyword">for</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Scanln</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span>
		<span class="token keyword">if</span> s <span class="token operator">==</span> <span class="token string">"quit"</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span>
		<span class="token punctuation">}</span>
		conn<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="Http_1475"></a>Http</h2> 
<ul><li><code>http.HandleFunc(pattern string, handler func(ResponseWriter, *Request))</code>：注册一个处理函数，用于指定URL模式的请求处理。</li><li><code>http.Handle(pattern string, handler http.Handler)</code>：注册一个处理器对象，该对象实现了http.Handler接口，用于指定URL模式的请求处理。</li><li><code>http.ListenAndServe(addr string, handler http.Handler)</code>：启动一个HTTP服务器，监听指定地址，并使用指定的处理器对象处理接收到的请求。</li><li><code>http.Get(url string) (resp *http.Response, err error)</code>：向指定URL发起GET请求，并返回响应结果。</li><li><code>http.Post(url string, bodyType string, body io.Reader) (resp *http.Response, err error)</code>：向指定URL发起POST请求，携带指定类型的请求体，并返回响应结果。</li><li><code>http.NewRequest(method, url string, body io.Reader) (*Request, error)</code>：创建一个自定义的HTTP请求对象，可以指定请求方法、URL和请求体。</li><li><code>http.DefaultServeMux</code>：默认的ServeMux多路复用器，可以通过它来注册处理函数，用于处理HTTP请求。</li><li><code>http.HandlerFunc</code>：将一个函数转换为http.Handler接口的实现，用于处理HTTP请求。</li><li><code>http.Error(w ResponseWriter, error string, code int)</code>：向客户端发送指定状态码的错误响应。</li><li><code>http.Redirect(w ResponseWriter, r *Request, url string, code int)</code>：向客户端发送重定向指令，使其跳转到指定的URL。</li></ul> 
<p>demo</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">main</span>

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"crypto/md5"</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"net/http"</span>
<span class="token punctuation">)</span>

func <span class="token class-name">HashUsingMD5</span><span class="token punctuation">(</span>input string<span class="token punctuation">)</span> string <span class="token punctuation">{<!-- --></span>
	hasher <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">md5<span class="token punctuation">.</span></span>New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">hasher<span class="token punctuation">.</span></span>Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">byte</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Sprintf</span><span class="token punctuation">(</span><span class="token string">"%x"</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">hasher<span class="token punctuation">.</span></span>Sum</span><span class="token punctuation">(</span>nil<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
func <span class="token class-name">LoginHandler</span><span class="token punctuation">(</span>res <span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>ResponseWriter</span><span class="token punctuation">,</span> req <span class="token operator">*</span><span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>Request</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token class-name"><span class="token namespace">req<span class="token punctuation">.</span></span>Method</span> <span class="token operator">==</span> <span class="token string">"POST"</span> <span class="token punctuation">{<!-- --></span>
		username <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">req<span class="token punctuation">.</span></span>FormValue</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>
		password <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">req<span class="token punctuation">.</span></span>FormValue</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> username <span class="token operator">==</span> <span class="token string">"admin"</span> <span class="token operator">&amp;&amp;</span> password <span class="token operator">==</span> <span class="token string">"123456"</span> <span class="token punctuation">{<!-- --></span>
			<span class="token class-name">Cookie</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name">HashUsingMD5</span><span class="token punctuation">(</span>username <span class="token operator">+</span> password<span class="token punctuation">)</span>
			cookie <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>Cookie</span><span class="token punctuation">{<!-- --></span>
				<span class="token class-name">Name</span><span class="token operator">:</span>  <span class="token string">"Value"</span><span class="token punctuation">,</span>
				<span class="token class-name">Value</span><span class="token operator">:</span> <span class="token class-name">Cookie</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span>
			<span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>SetCookie</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token operator">&amp;</span>cookie<span class="token punctuation">)</span>
			<span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>Redirect</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> req<span class="token punctuation">,</span> <span class="token string">"/success"</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>StatusFound</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
			<span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>Redirect</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> req<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>StatusFound</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token namespace">res<span class="token punctuation">.</span></span>WriteHeader</span><span class="token punctuation">(</span><span class="token number">405</span><span class="token punctuation">)</span>
		<span class="token class-name"><span class="token namespace">res<span class="token punctuation">.</span></span>Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">byte</span><span class="token punctuation">(</span><span class="token string">"Method Not Allow"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

func <span class="token class-name">SuccessHandler</span><span class="token punctuation">(</span>res <span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>ResponseWriter</span><span class="token punctuation">,</span> req <span class="token operator">*</span><span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>Request</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	cookie<span class="token punctuation">,</span> err <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">req<span class="token punctuation">.</span></span>Cookie</span><span class="token punctuation">(</span><span class="token string">"Value"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> nil <span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>Redirect</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> req<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>StatusFound</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	cookie_value <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name">HashUsingMD5</span><span class="token punctuation">(</span><span class="token string">"admin123456"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> <span class="token class-name"><span class="token namespace">cookie<span class="token punctuation">.</span></span>Value</span> <span class="token operator">!=</span> cookie_value <span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>Redirect</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> req<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>StatusFound</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token namespace">res<span class="token punctuation">.</span></span>Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">byte</span><span class="token punctuation">(</span><span class="token string">"登录成功"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

func <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">//创建一个文件服务器来处理静态文件</span>
	fs <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>FileServer</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>Dir</span><span class="token punctuation">(</span><span class="token string">"C:\\Users\\25018\\GolandProjects\\Project\\网络编程\\http"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>Handle</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>StripPrefix</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> fs<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> <span class="token class-name">LoginHandler</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/success"</span><span class="token punctuation">,</span> <span class="token class-name">SuccessHandler</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"HTTP server running at http://127.0.0.1:7000"</span><span class="token punctuation">)</span>
	err <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>ListenAndServe</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1:7000"</span><span class="token punctuation">,</span> nil<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> nil <span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"net/http"</span>
	<span class="token string">"net/url"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	client <span class="token operator">:=</span> <span class="token operator">&amp;</span>http<span class="token punctuation">.</span>Client<span class="token punctuation">{<!-- --></span>
		CheckRedirect<span class="token punctuation">:</span> <span class="token keyword">func</span><span class="token punctuation">(</span>req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">,</span> via <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> http<span class="token punctuation">.</span>ErrUseLastResponse
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	res<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">PostForm</span><span class="token punctuation">(</span><span class="token string">"http://127.0.0.1:7000/login"</span><span class="token punctuation">,</span> url<span class="token punctuation">.</span>Values<span class="token punctuation">{<!-- --></span><span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">"123456"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"请求失败"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> res<span class="token punctuation">.</span>StatusCode <span class="token operator">==</span> http<span class="token punctuation">.</span>StatusFound <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>Header<span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"重定向成功"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="websocket_1582"></a>websocket</h2> 
<pre><code>go get github.com/gorilla/websocket
</code></pre> 
<p>websocket是<a href="https://so.csdn.net/so/search?q=socket&amp;spm=1001.2101.3001.7020">socket</a>连接和http协议的结合体，可以实现网页和服务端的长连接</p> 
<p>demo</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/gorilla/websocket"</span>
	<span class="token string">"net/http"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> UP <span class="token operator">=</span> websocket<span class="token punctuation">.</span>Upgrader<span class="token punctuation">{<!-- --></span>
	ReadBufferSize<span class="token punctuation">:</span>  <span class="token number">1024</span><span class="token punctuation">,</span>
	WriteBufferSize<span class="token punctuation">:</span> <span class="token number">1024</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">handler</span><span class="token punctuation">(</span>res http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	conn<span class="token punctuation">,</span> err <span class="token operator">:=</span> UP<span class="token punctuation">.</span><span class="token function">Upgrade</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> req<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">{<!-- --></span>
		<span class="token comment">//消息类型,消息,错误</span>
		types<span class="token punctuation">,</span> message<span class="token punctuation">,</span> err <span class="token operator">:=</span> conn<span class="token punctuation">.</span><span class="token function">ReadMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span>
		<span class="token punctuation">}</span>
		conn<span class="token punctuation">.</span><span class="token function">WriteMessage</span><span class="token punctuation">(</span>websocket<span class="token punctuation">.</span>TextMessage<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"你说的是:%s吗？"</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>types<span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">defer</span> conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"服务关闭"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1:7000"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"bufio"</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/gorilla/websocket"</span>
	<span class="token string">"os"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">send</span><span class="token punctuation">(</span>conn <span class="token operator">*</span>websocket<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	reader <span class="token operator">:=</span> bufio<span class="token punctuation">.</span><span class="token function">NewReader</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stdin<span class="token punctuation">)</span>
	l<span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> reader<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	conn<span class="token punctuation">.</span><span class="token function">WriteMessage</span><span class="token punctuation">(</span>websocket<span class="token punctuation">.</span>TextMessage<span class="token punctuation">,</span> l<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	dl <span class="token operator">:=</span> websocket<span class="token punctuation">.</span>Dialer<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	conn<span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> dl<span class="token punctuation">.</span><span class="token function">Dial</span><span class="token punctuation">(</span><span class="token string">"ws://127.0.0.1:7000"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">go</span> <span class="token function">send</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span>
		t<span class="token punctuation">,</span> p<span class="token punctuation">,</span> err <span class="token operator">:=</span> conn<span class="token punctuation">.</span><span class="token function">ReadMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span>
		<span class="token punctuation">}</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//1代表TextMessage</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_1669"></a>爬虫</h2> 
<h3><a id="_1671"></a>正则表达式</h3> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">main</span>

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	_ <span class="token string">"github.com/go-sql-driver/mysql"</span>
	<span class="token string">"io"</span>
	<span class="token string">"net/http"</span>
	<span class="token string">"os"</span>
	<span class="token string">"regexp"</span>
	<span class="token string">"strconv"</span>
	<span class="token string">"strings"</span>
	<span class="token string">"time"</span>
	<span class="token string">"xorm.io/xorm"</span>
<span class="token punctuation">)</span>

type <span class="token class-name">Page</span> struct <span class="token punctuation">{<!-- --></span>
	<span class="token class-name">Id</span>          int64 `xorm<span class="token operator">:</span><span class="token string">"pk autoincr"</span>` <span class="token comment">//Id自增</span>
	<span class="token class-name">Title</span>       string
	<span class="token class-name">Content</span>     string    `xorm<span class="token operator">:</span><span class="token string">"text"</span>`
	<span class="token class-name">CreateTime</span>  <span class="token class-name"><span class="token namespace">time<span class="token punctuation">.</span></span>Time</span> `xorm<span class="token operator">:</span><span class="token string">"created"</span>`
	<span class="token class-name">UpdatedTime</span> <span class="token class-name"><span class="token namespace">time<span class="token punctuation">.</span></span>Time</span> `xorm<span class="token operator">:</span><span class="token string">"updated"</span>`
<span class="token punctuation">}</span>

<span class="token keyword">var</span> engine <span class="token operator">*</span><span class="token class-name"><span class="token namespace">xorm<span class="token punctuation">.</span></span>Engine</span>

func <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	dbType <span class="token operator">:</span><span class="token operator">=</span> <span class="token string">"mysql"</span>
	dbHost <span class="token operator">:</span><span class="token operator">=</span> <span class="token string">"localhost"</span>
	dbPort <span class="token operator">:</span><span class="token operator">=</span> <span class="token string">"3306"</span>
	dbUser <span class="token operator">:</span><span class="token operator">=</span> <span class="token string">"root"</span>
	dbPassword <span class="token operator">:</span><span class="token operator">=</span> <span class="token string">"root"</span>
	dbName <span class="token operator">:</span><span class="token operator">=</span> <span class="token string">"test_xorm"</span>

	<span class="token comment">// 创建引擎</span>
	<span class="token keyword">var</span> err error
	engine<span class="token punctuation">,</span> err <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">xorm<span class="token punctuation">.</span></span>NewEngine</span><span class="token punctuation">(</span>dbType<span class="token punctuation">,</span> dbUser<span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span>dbPassword<span class="token operator">+</span><span class="token string">"@tcp("</span><span class="token operator">+</span>dbHost<span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span>dbPort<span class="token operator">+</span><span class="token string">")/"</span><span class="token operator">+</span>dbName<span class="token punctuation">)</span> <span class="token comment">//连接mysql数据库</span>
	<span class="token comment">//engine, err = xorm.NewEngine("mysql", "root:root@/test_xorm?charset=utf-8") //连接mysql数据库</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> nil <span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"初始化不成功"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		err2 <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">engine<span class="token punctuation">.</span></span>Ping</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err2 <span class="token operator">!=</span> nil <span class="token punctuation">{<!-- --></span>
			<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"连接不成功"</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
			<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"连接成功!"</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
func <span class="token function">fetch</span><span class="token punctuation">(</span>url string<span class="token punctuation">)</span> string <span class="token punctuation">{<!-- --></span>
	client <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>Client</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	req<span class="token punctuation">,</span> _ <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>NewRequest</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> nil<span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">req<span class="token punctuation">.</span></span>Header<span class="token punctuation">.</span>Set</span><span class="token punctuation">(</span><span class="token string">"User-Agent"</span><span class="token punctuation">,</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36"</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">req<span class="token punctuation">.</span></span>Header<span class="token punctuation">.</span>Add</span><span class="token punctuation">(</span><span class="token string">"Cookie"</span><span class="token punctuation">,</span> <span class="token string">"_gid=GA1.2.1321863478.1703508772; _ga_YXBYDX14GJ=GS1.1.1703508771.1.1.1703510246.58.0.0; _ga=GA1.2.1396264026.1703508772"</span><span class="token punctuation">)</span>
	resp<span class="token punctuation">,</span> err <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">client<span class="token punctuation">.</span></span>Do</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> nil <span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"Http error"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token string">""</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token class-name"><span class="token namespace">resp<span class="token punctuation">.</span></span>StatusCode</span> <span class="token operator">!=</span> <span class="token number">200</span> <span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"Http Status Code"</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">resp<span class="token punctuation">.</span></span>StatusCode</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token string">""</span>
	<span class="token punctuation">}</span>
	defer <span class="token class-name"><span class="token namespace">resp<span class="token punctuation">.</span></span>Body<span class="token punctuation">.</span>Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	body<span class="token punctuation">,</span> err <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span></span>ReadAll</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">resp<span class="token punctuation">.</span></span>Body</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> nil <span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"Read error"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token string">""</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token function">string</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span>

<span class="token punctuation">}</span>

func <span class="token function">parse</span><span class="token punctuation">(</span>html string<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	html <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">strings<span class="token punctuation">.</span></span>Replace</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
	re_sidebar <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">regexp<span class="token punctuation">.</span></span>MustCompile</span><span class="token punctuation">(</span>`<span class="token operator">&lt;</span>aside id<span class="token operator">=</span><span class="token string">"sidebar"</span> role<span class="token operator">=</span><span class="token string">"navigation"</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">.</span>*<span class="token operator">?</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>aside<span class="token operator">&gt;</span>`<span class="token punctuation">)</span>
	sidebar <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">re_sidebar<span class="token punctuation">.</span></span>FindString</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
	re_link <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">regexp<span class="token punctuation">.</span></span>MustCompile</span><span class="token punctuation">(</span>`href<span class="token operator">=</span><span class="token string">"(.*?)"</span>`<span class="token punctuation">)</span>
	links <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">re_link<span class="token punctuation">.</span></span>FindAllString</span><span class="token punctuation">(</span>sidebar<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
	url <span class="token operator">:</span><span class="token operator">=</span> <span class="token string">"https://gorm.io/zh_CN/docs/"</span>
	<span class="token keyword">for</span> _<span class="token punctuation">,</span> value <span class="token operator">:</span><span class="token operator">=</span> range links <span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
		href <span class="token operator">:</span><span class="token operator">=</span> value<span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">:</span> <span class="token function">len</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
		url <span class="token operator">:</span><span class="token operator">=</span> url <span class="token operator">+</span> href
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"url\n"</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span>
		body <span class="token operator">:</span><span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
		go <span class="token function">parse2</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
func <span class="token function">parse2</span><span class="token punctuation">(</span>body string<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	body <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">strings<span class="token punctuation">.</span></span>Replace</span><span class="token punctuation">(</span>body<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
	re_title <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">regexp<span class="token punctuation">.</span></span>MustCompile</span><span class="token punctuation">(</span>`<span class="token operator">&lt;</span>h1 <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"article-title"</span> itemprop<span class="token operator">=</span><span class="token string">"name"</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">.</span>*<span class="token operator">?</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>`<span class="token punctuation">)</span>
	title <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">re_title<span class="token punctuation">.</span></span>FindString</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span>
	title <span class="token operator">=</span> title<span class="token punctuation">[</span><span class="token number">42</span> <span class="token operator">:</span> <span class="token function">len</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span>
	<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">,</span> title<span class="token punctuation">)</span>
	<span class="token comment">//save(title, body)</span>
	<span class="token function">saveToDB</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> body<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
func <span class="token function">save</span><span class="token punctuation">(</span>title string<span class="token punctuation">,</span> content string<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	err <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">os<span class="token punctuation">.</span></span>WriteFile</span><span class="token punctuation">(</span><span class="token string">"网络编程/Go爬虫/pages/"</span><span class="token operator">+</span>title<span class="token operator">+</span><span class="token string">".html"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">byte</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0644</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> nil <span class="token punctuation">{<!-- --></span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"保存出现错误"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

func <span class="token function">saveToDB</span><span class="token punctuation">(</span>title string<span class="token punctuation">,</span> content string<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	err <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">engine<span class="token punctuation">.</span></span>Sync</span><span class="token punctuation">(</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token class-name">Page</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> nil <span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"Failed to sync database: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	page <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name">Page</span><span class="token punctuation">{<!-- --></span>
		<span class="token class-name">Title</span><span class="token operator">:</span>   title<span class="token punctuation">,</span>
		<span class="token class-name">Content</span><span class="token operator">:</span> content<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	affected<span class="token punctuation">,</span> err <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">engine<span class="token punctuation">.</span></span>Insert</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>page<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> nil <span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"插入出现错误"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"save:"</span> <span class="token operator">+</span> <span class="token class-name"><span class="token namespace">strconv<span class="token punctuation">.</span></span>FormatInt</span><span class="token punctuation">(</span>affected<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

func <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	url <span class="token operator">:</span><span class="token operator">=</span> <span class="token string">"https://gorm.io/zh_CN/docs/"</span>
	html <span class="token operator">:</span><span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
	<span class="token function">parse</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="goquery_1803"></a>goquery</h3> 
<p>通过<code>goquery</code>可以快速的对<code>HTML</code>或<code>XML</code>进行解析，提供简单的API提取一个<code>HTML</code>或<code>XML</code>页面中的节点。</p> 
<p>常用元素：</p> 
<ol><li><strong>Find</strong>: 通过CSS选择器查找元素，例如 <code>doc.Find("div.content")</code> 将返回所有class为content的div元素。</li><li><strong>Each</strong>: 遍历匹配的元素集合，并对每个元素执行指定的函数。</li><li><strong>Text</strong>: 获取元素的文本内容。</li><li><strong>Attr</strong>: 获取元素的属性值。</li><li><strong>Html</strong>: 获取匹配元素的HTML内容。</li><li><strong>Parent, Children, Next, Prev</strong>: 获取父元素、子元素、相邻的后一个元素、相邻的前一个元素等。</li><li><strong>Filter, Not, HasClass, Is</strong>: 根据特定条件对元素集合进行过滤和判断。</li><li><strong>AddClass, RemoveClass, ToggleClass</strong>: 添加、移除、切换元素的类名。</li><li><strong>Serialize</strong>: 将匹配的表单元素序列化为URL编码的字符串。</li><li><strong>Each</strong>: 遍历匹配的元素集合，并对每个元素执行指定的函数。</li></ol> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/PuerkitoBio/goquery"</span>
	<span class="token string">"net/http"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	url <span class="token operator">:=</span> <span class="token string">"https://gorm.io/zh_CN/docs/"</span>
	<span class="token comment">//goquery.NewDocument(url)已过时弃用</span>
	res<span class="token punctuation">,</span> err <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"http请求出现错误"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">defer</span> res<span class="token punctuation">.</span>Body<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	doc<span class="token punctuation">,</span> err <span class="token operator">:=</span> goquery<span class="token punctuation">.</span><span class="token function">NewDocumentFromReader</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"goquery解析失败"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	doc<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token string">".sidebar-link"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Each</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>i <span class="token builtin">int</span><span class="token punctuation">,</span> s <span class="token operator">*</span>goquery<span class="token punctuation">.</span>Selection<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		href<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> s<span class="token punctuation">.</span><span class="token function">Attr</span><span class="token punctuation">(</span><span class="token string">"href"</span><span class="token punctuation">)</span>
		base_url <span class="token operator">:=</span> <span class="token string">"https://gorm.io/zh_CN/docs/"</span>
		detail_url <span class="token operator">:=</span> base_url <span class="token operator">+</span> href
		resp<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>detail_url<span class="token punctuation">)</span>
		detail_doc<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> goquery<span class="token punctuation">.</span><span class="token function">NewDocumentFromReader</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
		title <span class="token operator">:=</span> detail_doc<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token string">".article-title"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		content<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> detail_doc<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token string">".article"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Html</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"title:\n"</span><span class="token punctuation">,</span> title<span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"content\n"</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="colly_1857"></a>colly</h3> 
<p>Colly 是一个用于爬取 Web 数据的 Golang 框架，具有以下特点：</p> 
<ol><li><strong>简单易用</strong>：Colly 提供了一个简洁、直观的 API，易于使用和理解。</li><li><strong>高度灵活</strong>：Colly 允许你自定义请求头、回调函数、处理方法等，以满足各种爬取需求。</li><li><strong>并发支持</strong>：Colly 提供了并发请求的支持，可以同时处理多个请求，提高爬取效率。</li><li><strong>支持动态网页</strong>：Colly 集成了 PhantomJS，可以处理 JavaScript 渲染的动态网页。</li><li><strong>内置的选择器引擎</strong>：Colly 使用自己的选择器引擎，类似于 CSS 选择器，可以轻松地从 HTML 中提取所需的数据。</li><li><strong>自动处理重试和错误</strong>：Colly 可以自动处理请求的重试和错误，提供了一种简化错误处理的方法。</li><li><strong>支持代理</strong>：Colly 允许你使用代理服务器进行请求，以帮助隐藏真实 IP 地址和绕过访问限制。</li><li><strong>自定义数据存储</strong>：Colly 提供了灵活的机制，允许你自定义数据的存储方式，比如输出到文件、存储到数据库等。</li><li><strong>事件驱动</strong>：Colly 采用事件驱动的方式，通过注册回调函数处理请求和提取数据。</li><li><strong>广泛的社区支持</strong>：Colly 作为一个流行的爬虫框架，有着活跃的社区，你可以轻松找到相关的文档、教程和示例代码。</li></ol> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">main</span>

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/gocolly/colly"</span>
<span class="token punctuation">)</span>

func <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	c <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">colly<span class="token punctuation">.</span></span>NewCollector</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span></span>OnHTML</span><span class="token punctuation">(</span><span class="token string">".sidebar-link"</span><span class="token punctuation">,</span> <span class="token function">func</span><span class="token punctuation">(</span>element <span class="token operator">*</span><span class="token class-name"><span class="token namespace">colly<span class="token punctuation">.</span></span>HTMLElement</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		href <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">element<span class="token punctuation">.</span></span>Attr</span><span class="token punctuation">(</span><span class="token string">"href"</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> href <span class="token operator">!=</span> <span class="token string">"index.html"</span> <span class="token punctuation">{<!-- --></span>
			<span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span></span>Visit</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">element<span class="token punctuation">.</span></span>Request<span class="token punctuation">.</span>AbsoluteURL</span><span class="token punctuation">(</span>href<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span></span>OnHTML</span><span class="token punctuation">(</span><span class="token string">".article-title"</span><span class="token punctuation">,</span> <span class="token function">func</span><span class="token punctuation">(</span>element <span class="token operator">*</span><span class="token class-name"><span class="token namespace">colly<span class="token punctuation">.</span></span>HTMLElement</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		title <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">element<span class="token punctuation">.</span></span>Text</span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"title:"</span><span class="token punctuation">,</span> title<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span></span>OnHTML</span><span class="token punctuation">(</span><span class="token string">".article"</span><span class="token punctuation">,</span> <span class="token function">func</span><span class="token punctuation">(</span>element <span class="token operator">*</span><span class="token class-name"><span class="token namespace">colly<span class="token punctuation">.</span></span>HTMLElement</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		content<span class="token punctuation">,</span> _ <span class="token operator">:</span><span class="token operator">=</span> <span class="token class-name"><span class="token namespace">element<span class="token punctuation">.</span></span>DOM<span class="token punctuation">.</span>Html</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token string">"content:"</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span>

	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span></span>OnRequest</span><span class="token punctuation">(</span><span class="token function">func</span><span class="token punctuation">(</span>request <span class="token operator">*</span><span class="token class-name"><span class="token namespace">colly<span class="token punctuation">.</span></span>Request</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token namespace">fmt<span class="token punctuation">.</span></span>Println</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">request<span class="token punctuation">.</span></span>URL<span class="token punctuation">.</span>String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	url <span class="token operator">:</span><span class="token operator">=</span> <span class="token string">"https://gorm.io/zh_CN/docs/"</span>
	<span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span></span>Visit</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="250_1906"></a>豆瓣250</h3> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/PuerkitoBio/goquery"</span>
	<span class="token boolean">_</span> <span class="token string">"github.com/go-sql-driver/mysql"</span>
	<span class="token string">"net/http"</span>
	<span class="token string">"regexp"</span>
	<span class="token string">"strconv"</span>
	<span class="token string">"xorm.io/xorm"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> MovieData <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Id       <span class="token builtin">int64</span> <span class="token string">`xorm:"pk autoincr"`</span>
	Title    <span class="token builtin">string</span>
	Year     <span class="token builtin">string</span>
	Score    <span class="token builtin">string</span>
	Director <span class="token builtin">string</span>
	Actor    <span class="token builtin">string</span> <span class="token string">`xorm:"text"`</span>
	Quote    <span class="token builtin">string</span> <span class="token string">`xorm:"text"`</span>
	Picture  <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> engine <span class="token operator">*</span>xorm<span class="token punctuation">.</span>Engine

<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	dbType <span class="token operator">:=</span> <span class="token string">"mysql"</span>
	dbHost <span class="token operator">:=</span> <span class="token string">"localhost"</span>
	dbPort <span class="token operator">:=</span> <span class="token string">"3306"</span>
	dbUser <span class="token operator">:=</span> <span class="token string">"root"</span>
	dbPassword <span class="token operator">:=</span> <span class="token string">"root"</span>
	dbName <span class="token operator">:=</span> <span class="token string">"test_xorm"</span>
	<span class="token keyword">var</span> err <span class="token builtin">error</span>
	engine<span class="token punctuation">,</span> err <span class="token operator">=</span> xorm<span class="token punctuation">.</span><span class="token function">NewEngine</span><span class="token punctuation">(</span>dbType<span class="token punctuation">,</span> dbUser<span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span>dbPassword<span class="token operator">+</span><span class="token string">"@tcp("</span><span class="token operator">+</span>dbHost<span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span>dbPort<span class="token operator">+</span><span class="token string">")/"</span><span class="token operator">+</span>dbName<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"初始化失败"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		err2 <span class="token operator">:=</span> engine<span class="token punctuation">.</span><span class="token function">Ping</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err2 <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
			<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"连接不成功"</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"连接成功!"</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"正常爬取第 %d 页信息\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
		<span class="token function">Spider</span><span class="token punctuation">(</span>strconv<span class="token punctuation">.</span><span class="token function">Itoa</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">Spider</span><span class="token punctuation">(</span>page <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

	url <span class="token operator">:=</span> <span class="token string">"https://movie.douban.com/top250"</span> <span class="token operator">+</span> <span class="token string">"?start="</span> <span class="token operator">+</span> page
	client <span class="token operator">:=</span> http<span class="token punctuation">.</span>Client<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	req<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">NewRequest</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
	req<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"Accept"</span><span class="token punctuation">,</span> <span class="token string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"</span><span class="token punctuation">)</span>
	req<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"User-Agent"</span><span class="token punctuation">,</span> <span class="token string">"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Mobile Safari/537.36"</span><span class="token punctuation">)</span>
	req<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"Accept-Encoding"</span><span class="token punctuation">,</span> <span class="token string">"zh-CN,zh;q=0.9"</span><span class="token punctuation">)</span>
	req<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"Cache-Control"</span><span class="token punctuation">,</span> <span class="token string">"max-age=0"</span><span class="token punctuation">)</span>
	resp<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
	doc<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> goquery<span class="token punctuation">.</span><span class="token function">NewDocumentFromReader</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
	<span class="token comment">//#content &gt; div &gt; div.article &gt; ol &gt; li:nth-child(1)</span>
	<span class="token comment">//#content &gt; div &gt; div.article &gt; ol &gt; li:nth-child(2)</span>
	doc<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token string">"#content &gt; div &gt; div.article &gt; ol &gt; li"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Each</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>i <span class="token builtin">int</span><span class="token punctuation">,</span> selection <span class="token operator">*</span>goquery<span class="token punctuation">.</span>Selection<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		title <span class="token operator">:=</span> selection<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token string">"div &gt; div.info &gt; div.hd &gt; a &gt; span:nth-child(1)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		img <span class="token operator">:=</span> selection<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token string">"div &gt; div.pic &gt; a &gt; img"</span><span class="token punctuation">)</span>
		imgUrl<span class="token punctuation">,</span> ok <span class="token operator">:=</span> img<span class="token punctuation">.</span><span class="token function">Attr</span><span class="token punctuation">(</span><span class="token string">"src"</span><span class="token punctuation">)</span>
		quote <span class="token operator">:=</span> selection<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token string">"div &gt; div.info &gt; div.bd &gt; p.quote &gt; span"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		score <span class="token operator">:=</span> selection<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token string">"div &gt; div.info &gt; div.bd &gt; div &gt; span.rating_num"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		info <span class="token operator">:=</span> selection<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token string">"div &gt; div.info &gt; div.bd &gt; p:nth-child(1)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> ok <span class="token punctuation">{<!-- --></span>
			year<span class="token punctuation">,</span> director<span class="token punctuation">,</span> actor <span class="token operator">:=</span> <span class="token function">InfoHandler</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span>
			<span class="token function">saveToDb</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> imgUrl<span class="token punctuation">,</span> year<span class="token punctuation">,</span> score<span class="token punctuation">,</span> quote<span class="token punctuation">,</span> director<span class="token punctuation">,</span> actor<span class="token punctuation">)</span>

		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">saveToDb</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> imgUrl<span class="token punctuation">,</span> year<span class="token punctuation">,</span> score<span class="token punctuation">,</span> quote<span class="token punctuation">,</span> director<span class="token punctuation">,</span> actor <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	err <span class="token operator">:=</span> engine<span class="token punctuation">.</span><span class="token function">Sync</span><span class="token punctuation">(</span><span class="token function">new</span><span class="token punctuation">(</span>MovieData<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"保存数据出现错误"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	moviedata <span class="token operator">:=</span> MovieData<span class="token punctuation">{<!-- --></span>
		Title<span class="token punctuation">:</span>    title<span class="token punctuation">,</span>
		Year<span class="token punctuation">:</span>     year<span class="token punctuation">,</span>
		Score<span class="token punctuation">:</span>    score<span class="token punctuation">,</span>
		Director<span class="token punctuation">:</span> director<span class="token punctuation">,</span>
		Actor<span class="token punctuation">:</span>    actor<span class="token punctuation">,</span>
		Quote<span class="token punctuation">:</span>    quote<span class="token punctuation">,</span>
		Picture<span class="token punctuation">:</span>  imgUrl<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	affected<span class="token punctuation">,</span> err <span class="token operator">:=</span> engine<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>moviedata<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"插入出现错误!"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"保存:"</span><span class="token punctuation">,</span> strconv<span class="token punctuation">.</span><span class="token function">FormatInt</span><span class="token punctuation">(</span>affected<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">InfoHandler</span><span class="token punctuation">(</span>info <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>year<span class="token punctuation">,</span> director<span class="token punctuation">,</span> actor <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	year_re<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> regexp<span class="token punctuation">.</span><span class="token function">Compile</span><span class="token punctuation">(</span><span class="token string">`(\d+)`</span><span class="token punctuation">)</span>
	year <span class="token operator">=</span> <span class="token function">string</span><span class="token punctuation">(</span>year_re<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	director_re<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> regexp<span class="token punctuation">.</span><span class="token function">Compile</span><span class="token punctuation">(</span><span class="token string">`导演:(.*?)\s*(主演:|$)`</span><span class="token punctuation">)</span>
	director_result <span class="token operator">:=</span> director_re<span class="token punctuation">.</span><span class="token function">FindStringSubmatch</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span>
	<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>director_result<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token punctuation">{<!-- --></span>
		director <span class="token operator">=</span> director_result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
	actor_re<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> regexp<span class="token punctuation">.</span><span class="token function">Compile</span><span class="token punctuation">(</span><span class="token string">`主演:(.*)`</span><span class="token punctuation">)</span>
	actor_result <span class="token operator">:=</span> actor_re<span class="token punctuation">.</span><span class="token function">FindStringSubmatch</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span>
	<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>actor_result<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token punctuation">{<!-- --></span>
		actor <span class="token operator">=</span> actor_result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> year<span class="token punctuation">,</span> director<span class="token punctuation">,</span> actor

<span class="token punctuation">}</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/9a/a9/1dhzZtIl_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="B_2032"></a>爬B站评论</h3> 
<p>Go语言爬虫还是挺累人，它在解析<code>json</code>数据要使用结构体的形式，这里可以使用<code> json2struct.mervine.net</code>网站来转换成结构体，并提取出评论部分。</p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/goccy/go-json"</span>
	<span class="token string">"io"</span>
	<span class="token string">"log"</span>
	<span class="token string">"net/http"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> KingRankResp <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Code <span class="token builtin">int64</span> <span class="token string">`json:"code"`</span>
	Data <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
		Replies <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
			Content <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
				Device  <span class="token builtin">string</span>        <span class="token string">`json:"device"`</span>
				JumpURL <span class="token keyword">struct</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>      <span class="token string">`json:"jump_url"`</span>
				MaxLine <span class="token builtin">int64</span>         <span class="token string">`json:"max_line"`</span>
				Members <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span> <span class="token string">`json:"members"`</span>
				Message <span class="token builtin">string</span>        <span class="token string">`json:"message"`</span>
				Plat    <span class="token builtin">int64</span>         <span class="token string">`json:"plat"`</span>
			<span class="token punctuation">}</span> <span class="token string">`json:"content"`</span>
			Count  <span class="token builtin">int64</span> <span class="token string">`json:"count"`</span>
			Folder <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
				HasFolded <span class="token builtin">bool</span>   <span class="token string">`json:"has_folded"`</span>
				IsFolded  <span class="token builtin">bool</span>   <span class="token string">`json:"is_folded"`</span>
				Rule      <span class="token builtin">string</span> <span class="token string">`json:"rule"`</span>
			<span class="token punctuation">}</span> <span class="token string">`json:"folder"`</span>
			Like    <span class="token builtin">int64</span> <span class="token string">`json:"like"`</span>
			Replies <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
				Action  <span class="token builtin">int64</span> <span class="token string">`json:"action"`</span>
				Assist  <span class="token builtin">int64</span> <span class="token string">`json:"assist"`</span>
				Attr    <span class="token builtin">int64</span> <span class="token string">`json:"attr"`</span>
				Content <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
					Device  <span class="token builtin">string</span>   <span class="token string">`json:"device"`</span>
					JumpURL <span class="token keyword">struct</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span> <span class="token string">`json:"jump_url"`</span>
					MaxLine <span class="token builtin">int64</span>    <span class="token string">`json:"max_line"`</span>
					Message <span class="token builtin">string</span>   <span class="token string">`json:"message"`</span>
					Plat    <span class="token builtin">int64</span>    <span class="token string">`json:"plat"`</span>
				<span class="token punctuation">}</span> <span class="token string">`json:"content"`</span>
				Rcount  <span class="token builtin">int64</span>       <span class="token string">`json:"rcount"`</span>
				Replies <span class="token keyword">interface</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span> <span class="token string">`json:"replies"`</span>
			<span class="token punctuation">}</span> <span class="token string">`json:"replies"`</span>
			Type <span class="token builtin">int64</span> <span class="token string">`json:"type"`</span>
		<span class="token punctuation">}</span> <span class="token string">`json:"replies"`</span>
	<span class="token punctuation">}</span> <span class="token string">`json:"data"`</span>
	Message <span class="token builtin">string</span> <span class="token string">`json:"message"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	client <span class="token operator">:=</span> <span class="token operator">&amp;</span>http<span class="token punctuation">.</span>Client<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	req<span class="token punctuation">,</span> err <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">NewRequest</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span> <span class="token string">"https://api.bilibili.com/x/v2/reply/wbi/main?oid=338159898&amp;type=1&amp;mode=3&amp;pagination_str={\"offset\":\"\"}&amp;plat=1&amp;seek_rpid=&amp;web_location=1315875&amp;w_rid=1b7a0abc9704055facaafb28b36d864e&amp;wts=1704203337"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	req<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"authority"</span><span class="token punctuation">,</span> <span class="token string">"api.bilibili.com"</span><span class="token punctuation">)</span>
	req<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"sec-ch-ua-mobile"</span><span class="token punctuation">,</span> <span class="token string">"?0"</span><span class="token punctuation">)</span>
	req<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"user-agent"</span><span class="token punctuation">,</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.93 Safari/537.36"</span><span class="token punctuation">)</span>
	req<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"accept"</span><span class="token punctuation">,</span> <span class="token string">"*/*"</span><span class="token punctuation">)</span>
	req<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"accept-language"</span><span class="token punctuation">,</span> <span class="token string">"zh-CN,zh;q=0.9"</span><span class="token punctuation">)</span>
	resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">defer</span> resp<span class="token punctuation">.</span>Body<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	bodyText<span class="token punctuation">,</span> err <span class="token operator">:=</span> io<span class="token punctuation">.</span><span class="token function">ReadAll</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">var</span> resultList KingRankResp
	<span class="token boolean">_</span> <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span>bodyText<span class="token punctuation">,</span> <span class="token operator">&amp;</span>resultList<span class="token punctuation">)</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> result <span class="token operator">:=</span> <span class="token keyword">range</span> resultList<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>Replies <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"一级评论："</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>Content<span class="token punctuation">.</span>Message<span class="token punctuation">)</span>
		<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> reply <span class="token operator">:=</span> <span class="token keyword">range</span> result<span class="token punctuation">.</span>Replies <span class="token punctuation">{<!-- --></span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"二级评论："</span><span class="token punctuation">,</span> reply<span class="token punctuation">.</span>Content<span class="token punctuation">.</span>Message<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f93210cb0d13d97f9cdfaf2d1d542315/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VC6.0 下载的dsw打不开解决</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/08ba335278db349e110e8a1a79d1f2a7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">听GPT 讲Rust源代码--library/core/benches</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>