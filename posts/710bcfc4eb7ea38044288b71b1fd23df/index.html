<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>rebar3使用介绍（三）命令 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="rebar3使用介绍（三）命令" />
<meta property="og:description" content="rebar3使用介绍（三） ascompilecleanctcoverdepsdodialyzeredocescriptizeeunitget-depshelpnewpathpkgsreleaserelupreportshelltartreelockunlockupdateupgradeversionxref 本篇主要介绍rebar3的命令 as 它使配置文件名称和任务列表在该配置文件下运行.
举个例子，你可以配置dev模式和relese模式下不同的配置，然后rebar3 as dev release 就可以按照dev模式发布，同样可以用release发布
rebar.config
{profiles, [ {dev, [ {plugins, [ {rebar3_gpb_plugin, &#34;2.3.2&#34;} ]}, {provider_hooks, [ {pre, [ {compile, {protobuf, compile}}, {clean, {protobuf, clean}} ]} ]} ]}, {test, [ {erl_opts, [nowarn_export_all]}, {ct_opts, [{create_priv_dir, auto_per_tc}, {config, &#34;test/ct.config&#34;}]}, {plugins, [ rebar3_proper ]}, {deps, [ {proper, {git, &#34;git://github.com/proper-testing/proper&#34;, {tag, &#34;v1.3&#34;}}} ]}, {extra_src_dirs, [&#34;test/support&#34;]} ]} ]}. 根据profiles字段的值,可以自定义自己的发布模板
compile rebar3的编译命令会自己确保依赖到位，不像rebar需要自己get-deps,除了deps部分其他和rebar一致，编译erl，app.src
clean rebar3 clean 默认只会清理主app下的文件，clean也支持as，rebar3 as test clean 将只会清除test模式下的文件" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/710bcfc4eb7ea38044288b71b1fd23df/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-11-12T16:57:02+08:00" />
<meta property="article:modified_time" content="2018-11-12T16:57:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">rebar3使用介绍（三）命令</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>rebar3使用介绍（三）</h4> 
 <ul><li><a href="#as_3" rel="nofollow">as</a></li><li><a href="#compile_37" rel="nofollow">compile</a></li><li><a href="#clean_40" rel="nofollow">clean</a></li><li><a href="#ct_49" rel="nofollow">ct</a></li><li><a href="#cover_54" rel="nofollow">cover</a></li><li><a href="#deps_72" rel="nofollow">deps</a></li><li><a href="#do_75" rel="nofollow">do</a></li><li><a href="#dialyzer_78" rel="nofollow">dialyzer</a></li><li><a href="#edoc_104" rel="nofollow">edoc</a></li><li><a href="#escriptize_107" rel="nofollow">escriptize</a></li><li><a href="#eunit_125" rel="nofollow">eunit</a></li><li><a href="#getdeps_136" rel="nofollow">get-deps</a></li><li><a href="#help_139" rel="nofollow">help</a></li><li><a href="#new_142" rel="nofollow">new</a></li><li><a href="#path_147" rel="nofollow">path</a></li><li><a href="#pkgs_163" rel="nofollow">pkgs</a></li><li><a href="#release_166" rel="nofollow">release</a></li><li><a href="#relup_169" rel="nofollow">relup</a></li><li><a href="#report_172" rel="nofollow">report</a></li><li><a href="#shell_175" rel="nofollow">shell</a></li><li><a href="#tar_189" rel="nofollow">tar</a></li><li><a href="#tree_192" rel="nofollow">tree</a></li><li><a href="#lock_195" rel="nofollow">lock</a></li><li><a href="#unlock_198" rel="nofollow">unlock</a></li><li><a href="#update_205" rel="nofollow">update</a></li><li><a href="#upgrade_208" rel="nofollow">upgrade</a></li><li><a href="#version_213" rel="nofollow">version</a></li><li><a href="#xref_220" rel="nofollow">xref</a></li></ul> 
</div> 
<br> 本篇主要介绍rebar3的命令 
<p></p> 
<h2><a id="as_3"></a>as</h2> 
<p>它使配置文件名称和任务列表在该配置文件下运行.<br> 举个例子，你可以配置dev模式和relese模式下不同的配置，然后rebar3 as dev release 就可以按照dev模式发布，同样可以用release发布</p> 
<p>rebar.config</p> 
<pre><code class="prism language-erlang">{profiles, [
    {dev, [
        {plugins, [
            {rebar3_gpb_plugin, "2.3.2"}
        ]},
        {provider_hooks, [
            {pre, [
                {compile, {protobuf, compile}},
                {clean, {protobuf, clean}}
            ]}
        ]}
    ]},
    {test, [
        {erl_opts, [nowarn_export_all]},
        {ct_opts, [{create_priv_dir, auto_per_tc},
                   {config, "test/ct.config"}]},
        {plugins, [
            rebar3_proper
        ]},
        {deps, [
            {proper, {git, "git://github.com/proper-testing/proper", {tag, "v1.3"}}}
        ]},
        {extra_src_dirs, ["test/support"]}
    ]}
]}.
</code></pre> 
<p>根据profiles字段的值,可以自定义自己的发布模板</p> 
<h2><a id="compile_37"></a>compile</h2> 
<p>rebar3的编译命令会自己确保依赖到位，不像rebar需要自己get-deps,除了deps部分其他和rebar一致，编译erl，app.src</p> 
<h2><a id="clean_40"></a>clean</h2> 
<p>rebar3 clean 默认只会清理主app下的文件，clean也支持as，rebar3 as test clean 将只会清除test模式下的文件<br> 如果想要清除deps的文件，加上 --all即可</p> 
<table><thead><tr><th>Option</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>–all/-a</td><td>none</td><td>清除所有app，包括依赖项的构建文件</td></tr><tr><td>–profile/-p</td><td>string</td><td>等价于rebar3 as clean</td></tr></tbody></table> 
<h2><a id="ct_49"></a>ct</h2> 
<p>ct命令将会执行test/目录下的测试用例<br> ct命令和erlang的是基本一致的，支持的扩展参数可以看<a href="http://erlang.org/doc/man/ct_run.html" rel="nofollow">这</a><br> 注意rebar 加参数用的是 – erlang用的-</p> 
<h2><a id="cover_54"></a>cover</h2> 
<p>cover 一般配合ct或者eunit来用，<code>rebar3 do ct, cover</code>, <code>rebar3 do eunit, cover</code> 或者 <code>rebar3 do eunit, ct, cover</code></p> 
<p>cover 是否开启配置在rebar.config中的cover_enabled字段，默认是false</p> 
<pre><code class="prism language-erlang">%% Whether to enable coverage reporting where commands support cover. Default
%% is `false'
{cover_enabled, false}.
</code></pre> 
<p>cover 命令支持以下扩展参数：</p> 
<table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody><tr><td>–reset/-r</td><td>重置所有数据</td></tr><tr><td>–verbose / -v</td><td>在终端中打印覆盖率分析。</td></tr></tbody></table> 
<p>通过添加<code>{cover_excl_mods,[Modules]}</code>到配置文件，可以从代码覆盖中将特定模块列入黑名单。通过添加<code>{cover_excl_apps, [AppNames]}</code>到配置文件，可以将特定应用程序列入黑名单。</p> 
<h2><a id="deps_72"></a>deps</h2> 
<p>列出依赖项，无论它们是源依赖项还是程序包依赖项，以及它们是否已锁定。锁定但未与锁定文件匹配的那些后跟星号（*）</p> 
<h2><a id="do_75"></a>do</h2> 
<p>do 允许你串行执行多个命令，以逗号分隔。例：rebar3 do a, b, c</p> 
<h2><a id="dialyzer_78"></a>dialyzer</h2> 
<p>构建并保持最新的合适PLT，并使用它来对当前项目进行成功的类型分析。</p> 
<table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody><tr><td>–update-PLT / -u</td><td>启用更新PLT。默认值：true</td></tr><tr><td>–succ-typings/-s</td><td>启用成功键入分析。默认值：true</td></tr></tbody></table> 
<p>有关抑制告警的说明，请参阅Dialyzer文档中的<a href="http://erlang.org/doc/man/dialyzer.html" rel="nofollow">Requesting or Suppressing Warnings in Source Files</a>部分。</p> 
<p>PLT文件被命名_&lt;otp_release&gt;_plt; 基础PLT是PLT，包含项目PLT通常需要的核心应用程序。每个OTP版本创建一个基本PLT并存储在其中base_plt_location。然后使用基础PLT来构建项目PLT。</p> 
<p>可以将以下（可选）配置添加到rebar.config中的选项dialyzer中：</p> 
<table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody><tr><td>warnings</td><td>透析器警告列表</td></tr><tr><td>get_warnings</td><td>更改PLT文件时显示警告（布尔值）</td></tr><tr><td>plt_apps</td><td>用于确定哪些包含在PLT文件的应用程序的策略，top_level_deps以仅包括直接依赖或all_deps包括所有嵌套的依赖（直接依赖的应用程序中列出applications和included_applications他们的.app文件。）</td></tr><tr><td>plt_extra_apps</td><td>要包含在PLT文件中的应用程序base_plt_apps列表（将在列表中的应用程序）</td></tr><tr><td>plt_location</td><td>PLT文件的位置，local存储在配置文件的基本目录（默认）或自定义目录中。</td></tr><tr><td>plt_prefix</td><td>PLT文件的前缀，默认为“rebar3”</td></tr><tr><td>base_plt_apps</td><td>要包含在基本PLT文件中的应用程序列表</td></tr><tr><td>base_plt_location</td><td>基本PLT文件的位置，global存储在$ HOME / .cache / rebar3（默认）或自定义目录中</td></tr><tr><td>base_plt_prefix</td><td>基本PLT文件的前缀，默认为“rebar3”</td></tr></tbody></table> 
<h2><a id="edoc_104"></a>edoc</h2> 
<p>生成doc文档，具体看<a href="http://erlang.org/doc/apps/edoc/chapter.html" rel="nofollow">这</a></p> 
<h2><a id="escriptize_107"></a>escriptize</h2> 
<p>生成包含项目及其依赖项的BEAM文件的escript可执行文件。</p> 
<table><thead><tr><th>Config Option</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>escript_main_app</td><td>atom</td><td>要转到escript的应用程序的名称。如果只有一个，则默认为顶级应用。使用伞状项目（具有多个顶级应用程序）时，必须指定此值。</td></tr><tr><td>escript_name</td><td>string</td><td>生成的escript的名称，以及boot（Module:main(_)）的默认模块名称。默认值为escript_main_app</td></tr><tr><td>escript_incl_apps</td><td>list of atoms</td><td>除主应用程序及其依赖项（来自应用程序文件）之外，要包含在escript存档中的应用程序列表。默认为[]</td></tr><tr><td>escript_emu_args</td><td>string</td><td>Escript模拟器参数（%%!在escript声明之后）。该字符串必须%%!以换行符开头并以换行符结束。一个示例字符串"%%! +sbtu +A0\n"。默认值为 “%%! -escript main MainApp\n”</td></tr><tr><td>escript_shebang</td><td>string</td><td>要运行的escript文件的位置。默认为"#!/usr/bin/env escript\n"。行结束标记必须包含在字符串中。</td></tr><tr><td>escript_comment</td><td>string</td><td>任意comment放入生成的escript中。必须在末尾包含换行标记。默认为%%\n。</td></tr></tbody></table> 
<p>要覆盖escript的默认模块名称（预期与之相同escript_name），请添加-escript main Module到escript_emu_args</p> 
<p>示例escript配置来自relx：</p> 
<pre><code class="prism language-erlang">{escript_emu_args, "%%! +sbtu +A0 -noinput\n"}.
{escript_incl_apps, [getopt, erlware_commons, bbmustache, providers, relx]}.
</code></pre> 
<h2><a id="eunit_125"></a>eunit</h2> 
<p>运行项目应用程序的eunit测试。支持参数如下：</p> 
<table><thead><tr><th>Option</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>–cover/-c</td><td>Boolean</td><td>生成cover数据</td></tr><tr><td>–verbose/-v</td><td>Boolean</td><td>详细输出</td></tr><tr><td>–app</td><td>Comma separated list of strings</td><td>运行测试的应用程序列表。相当于EUnit的[{application, App}]。</td></tr><tr><td>–suite</td><td>Comma separated list of strings</td><td>要运行的测试套件列表。相当于EUnit的[{module, Suite}]。</td></tr><tr><td>–file / -f</td><td>Comma separated list of strings</td><td>要运行的文件列表（例如test/my_tests.beam），相当于Eunit的[{file, File}]。</td></tr></tbody></table> 
<h2><a id="getdeps_136"></a>get-deps</h2> 
<p>rebar3 已结不需要这个命令，compile会调用get-deps</p> 
<h2><a id="help_139"></a>help</h2> 
<p>查看某个命令的帮助， rebar3 help clean</p> 
<h2><a id="new_142"></a>new</h2> 
<p>基础用法章节中讲过，这里就不再讲了<br> rebar3 new <br> 使用 --force/-f 可以强制覆盖已有文件，不过还是推荐删除重新生成</p> 
<h2><a id="path_147"></a>path</h2> 
<p>打印在当前配置文件中构建目录的路径。支持选项如下：</p> 
<table><thead><tr><th>Option</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>-app</td><td>Comma separated list of strings</td><td>逗号分隔的应用程序列表，用于返回路径。</td></tr><tr><td>–base</td><td>none</td><td>返回指定项目当前配置文件的路径</td></tr><tr><td>–bin</td><td>none</td><td>返回指定项目当前配置文件的路径</td></tr><tr><td>–ebin</td><td>none</td><td>返回指定项目当前配置文件的路径</td></tr><tr><td>–lib</td><td>none</td><td>返回指定项目当前配置文件的路径</td></tr><tr><td>–priv</td><td>none</td><td>返回指定项目当前配置文件的路径</td></tr><tr><td>–separator/-s</td><td>string</td><td>在多个返回路径的情况下，用于连接它们的分隔符。</td></tr><tr><td>–src</td><td>none</td><td>返回指定项目当前配置文件的路径</td></tr><tr><td>–rel</td><td>none</td><td>返回指定项目当前配置文件的路径</td></tr></tbody></table> 
<h2><a id="pkgs_163"></a>pkgs</h2> 
<p>列出可用的包。</p> 
<h2><a id="release_166"></a>release</h2> 
<p>构建项目发布。使用rebar3 help release来查看支持参数列表</p> 
<h2><a id="relup_169"></a>relup</h2> 
<p>从2个版本创建一个relup， 使用 rebar3 help relup 查看支持参数列表</p> 
<h2><a id="report_172"></a>report</h2> 
<p>生成上下文数据以包含在错误报告中,如果你要给rebar3上报自己的异常，使用reprot可以快速采集环境信息</p> 
<h2><a id="shell_175"></a>shell</h2> 
<p>使用项目应用程序和路径中的deps运行shell。</p> 
<p>使用此命令引导的shell具有运行的代理，允许动态运行rebar3命令，例如r3:compile()或r3:upgrade()，并自动重新加载新模块。通过调用可以访问特定的命名空间r3:do(Namespace, Command)。shell不支持传参</p> 
<table><thead><tr><th>Option</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>–config</td><td>string</td><td>支持加载配置文件（如果有）。默认是sys_config</td></tr><tr><td>–name/–sname</td><td>atom</td><td>使用erl -name/-sname 来启动节点</td></tr><tr><td>–setcookie</td><td>string</td><td>指定cookie，同erl -setcookie</td></tr><tr><td>–script</td><td>string</td><td>在应用程序启动之前要执行的escript的路径</td></tr><tr><td>–apps</td><td>string</td><td>以逗号分隔的要引导的应用程序名称列表。</td></tr></tbody></table> 
<p>如果relx做了配置，则默认为relx版本中的应用程序。</p> 
<h2><a id="tar_189"></a>tar</h2> 
<p>构建由项目构建的发布的压缩tar存档, rebar3 help tar 查看详细内容</p> 
<h2><a id="tree_192"></a>tree</h2> 
<p>打印项目构件树</p> 
<h2><a id="lock_195"></a>lock</h2> 
<p>获取要添加到rebar.lock文件中的未构建的依赖项。它们会被下载，但它们的构建脚本都不应该运行。虽然这不一定适用于pre / post hooks和dep plugins。</p> 
<h2><a id="unlock_198"></a>unlock</h2> 
<p>解锁依赖项。如果没有提到依赖项，则该命令将解锁所有依赖项。如果列出任何特定的顶级依赖项（以逗号分隔）作为参数，那么这些依赖项将被解锁。</p> 
<p>然后生成新的锁定文件，或者在没有锁定的情况下删除现有的锁定文件。</p> 
<p>当从rebar.config中取出一个或多个依赖项时，应使用此命令，但保留在锁定文件中。也就是你要删除依赖项的时候，用来清理rebar.lock文件</p> 
<h2><a id="update_205"></a>update</h2> 
<p>更新包索引。</p> 
<h2><a id="upgrade_208"></a>upgrade</h2> 
<p>升级依赖项并相应地更新锁定文件。<br> rebar3 upgrade []<br> 如果没指定，则所有的都会被更新</p> 
<h2><a id="version_213"></a>version</h2> 
<p>打印rebar3 和erlang的版本</p> 
<pre><code class="prism language-shell">$ <span class="token punctuation">..</span>/rebar3 version
rebar 3.7.0-rc2+build.4175.ref83d01b5 on Erlang/OTP 19 Erts 8.0
</code></pre> 
<h2><a id="xref_220"></a>xref</h2> 
<p>执行xref分析</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c4c108997ffdf872c7a4e027befdba7d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">rebar3使用介绍（二）配置项</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dfaa537fc533a988f56de54a0a63e0fd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">rebar3使用介绍（四）依赖</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>