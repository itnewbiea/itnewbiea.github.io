<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>tabs导航添加及右侧的关闭和打印printJs - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="tabs导航添加及右侧的关闭和打印printJs" />
<meta property="og:description" content="tab.js
store状态
import { defineStore } from &#39;pinia&#39;
import { RouteLocationNormalizedLoaded } from &#39;vue-router&#39;
export const tabsStore = defineStore(&#39;tabsStore&#39;, {
state: () =&gt; ({
visitedViews: [] as any[],
cachedViews: [] as any[]
}),
actions: {
addView(view: RouteLocationNormalizedLoaded) {
if (this.visitedViews.some(value =&gt; value.path === view.path)) {
return
}
this.visitedViews.push(
Object.assign({}, view, {
title: view.meta?.title || &#39;unknown&#39;
})
)
},
addCachedView(view: RouteLocationNormalizedLoaded) {
if (this.cachedViews.includes(view.name)) {
return
}
if (view.meta.cache) {" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/19e5fd99aefd78097f07f783c799bfba/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-20T13:39:57+08:00" />
<meta property="article:modified_time" content="2023-04-20T13:39:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">tabs导航添加及右侧的关闭和打印printJs</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>tab.js</p> 
<p>store状态</p> 
<p>import { defineStore } from 'pinia'</p> 
<p>import { RouteLocationNormalizedLoaded } from 'vue-router'</p> 
<p></p> 
<p>export const tabsStore = defineStore('tabsStore', {<!-- --></p> 
<p>    state: () =&gt; ({<!-- --></p> 
<p>        visitedViews: [] as any[],</p> 
<p>        cachedViews: [] as any[]</p> 
<p>    }),</p> 
<p>    actions: {<!-- --></p> 
<p>        addView(view: RouteLocationNormalizedLoaded) {<!-- --></p> 
<p>            if (this.visitedViews.some(value =&gt; value.path === view.path)) {<!-- --></p> 
<p>                return</p> 
<p>            }</p> 
<p>            this.visitedViews.push(</p> 
<p>                Object.assign({}, view, {<!-- --></p> 
<p>                    title: view.meta?.title || 'unknown'</p> 
<p>                })</p> 
<p>            )</p> 
<p>        },</p> 
<p>        addCachedView(view: RouteLocationNormalizedLoaded) {<!-- --></p> 
<p>            if (this.cachedViews.includes(view.name)) {<!-- --></p> 
<p>                return</p> 
<p>            }</p> 
<p></p> 
<p>            if (view.meta.cache) {<!-- --></p> 
<p>                this.cachedViews.push(view.name)</p> 
<p>            }</p> 
<p>        },</p> 
<p>        delView(view: RouteLocationNormalizedLoaded) {<!-- --></p> 
<p>            for (const [i, v] of this.visitedViews.entries()) {<!-- --></p> 
<p>                if (v.path === view.path) {<!-- --></p> 
<p>                    this.visitedViews.splice(i, 1)</p> 
<p>                    break</p> 
<p>                }</p> 
<p>            }</p> 
<p></p> 
<p>            this.delCachedView(view).then()</p> 
<p>        },</p> 
<p>        delCachedView(view: RouteLocationNormalizedLoaded) {<!-- --></p> 
<p>            return new Promise(resolve =&gt; {<!-- --></p> 
<p>                const index = this.cachedViews.indexOf(view.name)</p> 
<p>                if (index &gt; -1) {<!-- --></p> 
<p>                    this.cachedViews.splice(index, 1)</p> 
<p>                }</p> 
<p>                resolve([...this.cachedViews])</p> 
<p>            })</p> 
<p>        },</p> 
<p>        delOthersViews(view: RouteLocationNormalizedLoaded) {<!-- --></p> 
<p>            this.visitedViews = this.visitedViews.filter(v =&gt; {<!-- --></p> 
<p>                return v.meta.affix || v.path === view.path</p> 
<p>            })</p> 
<p></p> 
<p>            const index = this.cachedViews.indexOf(view.name)</p> 
<p>            if (index &gt; -1) {<!-- --></p> 
<p>                this.cachedViews = this.cachedViews.slice(index, index + 1)</p> 
<p>            } else {<!-- --></p> 
<p>                this.cachedViews = []</p> 
<p>            }</p> 
<p>        },</p> 
<p>        delAllViews() {<!-- --></p> 
<p>            this.visitedViews = this.visitedViews.filter(tab =&gt; tab.meta.affix)</p> 
<p>            this.cachedViews = []</p> 
<p>        }</p> 
<p>    }</p> 
<p>})</p> 
<p>tab.vue  使用</p> 
<p>&lt;template&gt;</p> 
<p>    &lt;div class="tabs-container"&gt;</p> 
<p>        &lt;div class="tabs-item"&gt;</p> 
<p>            &lt;el-tabs v-model="activeTabName" :class="tabsStyleClass" @tab-click="tabClick" @tab-remove="tabRemove"&gt;</p> 
<p>                &lt;el-tab-pane</p> 
<p>                    v-for="tab in store.tabsStore.visitedViews"</p> 
<p>                    :key="tab"</p> 
<p>                    :label="tab.title"</p> 
<p>                    :name="tab.path"</p> 
<p>                    :closable="!isAffix(tab)"</p> 
<p>                &gt;&lt;/el-tab-pane&gt;</p> 
<p>            &lt;/el-tabs&gt;</p> 
<p>        &lt;/div&gt;</p> 
<p>        &lt;el-dropdown class="tabs-action" trigger="click" placement="bottom-end" @command="onClose"&gt;</p> 
<p>            &lt;template #dropdown&gt;</p> 
<p>                &lt;el-dropdown-menu&gt;</p> 
<p>                    &lt;el-dropdown-item :icon="Close" command="close"&gt;{<!-- -->{ $t('app.close') }}&lt;/el-dropdown-item&gt;</p> 
<p>                    &lt;el-dropdown-item :icon="CircleClose" command="closeOthers"&gt;{<!-- -->{ $t('app.closeOthers') }}&lt;/el-dropdown-item&gt;</p> 
<p>                    &lt;el-dropdown-item :icon="CircleCloseFilled" command="closeAll"&gt;{<!-- -->{ $t('app.closeAll') }}&lt;/el-dropdown-item&gt;</p> 
<p>                &lt;/el-dropdown-menu&gt;</p> 
<p>            &lt;/template&gt;</p> 
<p>            &lt;el-icon&gt;&lt;arrow-down /&gt;&lt;/el-icon&gt;</p> 
<p>        &lt;/el-dropdown&gt;</p> 
<p>    &lt;/div&gt;</p> 
<p>&lt;/template&gt;</p> 
<p></p> 
<p>&lt;script setup lang="ts"&gt;</p> 
<p>import { watch, onMounted, ref, computed } from 'vue'</p> 
<p>import { useRoute, useRouter } from 'vue-router'</p> 
<p>import store from '@/store'</p> 
<p>import { closeAllTabs, closeOthersTabs, closeTab } from '@/utils/tabs'</p> 
<p>import { ArrowDown, Close, CircleClose, CircleCloseFilled } from '@element-plus/icons-vue'</p> 
<p></p> 
<p>const route = useRoute()</p> 
<p>const router = useRouter()</p> 
<p></p> 
<p>const activeTabName = ref(route.path)</p> 
<p>const tabsStyleClass = computed(() =&gt; 'tabs-item-' + store.appStore.theme.tabsStyle)</p> 
<p></p> 
<p>// 是否固定</p> 
<p>const isAffix = (tab: any) =&gt; {<!-- --></p> 
<p>    return tab.meta &amp;&amp; tab.meta.affix</p> 
<p>}</p> 
<p></p> 
<p>watch(route, () =&gt; {<!-- --></p> 
<p>    // 当前路由，添加到tabs里</p> 
<p>    if (route.name) {<!-- --></p> 
<p>        addTab()</p> 
<p>    }</p> 
<p>})</p> 
<p></p> 
<p>onMounted(() =&gt; {<!-- --></p> 
<p>    // 初始化</p> 
<p>    initTabs()</p> 
<p>    addTab()</p> 
<p>})</p> 
<p></p> 
<p>// 初始化固定tab</p> 
<p>const initTabs = () =&gt; {<!-- --></p> 
<p>    const affixTabs = getAffixTabs(store.routerStore.routes)</p> 
<p>    for (const tab of affixTabs) {<!-- --></p> 
<p>        // 需要有tab名称</p> 
<p>        if (tab.name) {<!-- --></p> 
<p>            store.tabsStore.addView(tab)</p> 
<p>        }</p> 
<p>    }</p> 
<p>}</p> 
<p></p> 
<p>// 获取需要固定的tabs</p> 
<p>const getAffixTabs = (routes: any) =&gt; {<!-- --></p> 
<p>    let tabs: any[] = []</p> 
<p>    routes.forEach((route: any) =&gt; {<!-- --></p> 
<p>        if (route.meta &amp;&amp; route.meta.affix) {<!-- --></p> 
<p>            tabs.push({<!-- --></p> 
<p>                fullPath: route.path,</p> 
<p>                path: route.path,</p> 
<p>                name: route.name,</p> 
<p>                meta: { ...route.meta }</p> 
<p>            })</p> 
<p>        }</p> 
<p>        if (route.children) {<!-- --></p> 
<p>            const tempTabs = getAffixTabs(route.children)</p> 
<p>            if (tempTabs.length &gt;= 1) {<!-- --></p> 
<p>                tabs = [...tabs, ...tempTabs]</p> 
<p>            }</p> 
<p>        }</p> 
<p>    })</p> 
<p>    return tabs</p> 
<p>}</p> 
<p></p> 
<p>// 添加tab</p> 
<p>const addTab = () =&gt; {<!-- --></p> 
<p>    store.tabsStore.addView(route)</p> 
<p>    store.tabsStore.addCachedView(route)</p> 
<p>    activeTabName.value = route.path</p> 
<p>}</p> 
<p></p> 
<p>// tab被选中</p> 
<p>const tabClick = (tab: any) =&gt; {<!-- --></p> 
<p>    tab.props.name &amp;&amp; router.push(tab.props.name)</p> 
<p>}</p> 
<p></p> 
<p>// 点击关闭tab</p> 
<p>const tabRemove = (path: string) =&gt; {<!-- --></p> 
<p>    const tab = store.tabsStore.visitedViews.filter((tab: any) =&gt; tab.path === path)</p> 
<p>    closeTab(router, tab[0])</p> 
<p>}</p> 
<p></p> 
<p>// dropdown 关闭事件</p> 
<p>const onClose = (type: string) =&gt; {<!-- --></p> 
<p>    switch (type) {<!-- --></p> 
<p>        case 'close':</p> 
<p>            closeTab(router, route)</p> 
<p>            break</p> 
<p>        case 'closeOthers':</p> 
<p>            closeOthersTabs(router, route)</p> 
<p>            break</p> 
<p>        case 'closeAll':</p> 
<p>            closeAllTabs(router, route)</p> 
<p>            break</p> 
<p>    }</p> 
<p>}</p> 
<p>&lt;/script&gt;</p> 
<p></p> 
<p>&lt;style lang="scss" scoped&gt;</p> 
<p>.tabs-container {<!-- --></p> 
<p>    display: flex;</p> 
<p>    position: relative;</p> 
<p>    z-index: 6;</p> 
<p>    height: 40px;</p> 
<p>    .tabs-item {<!-- --></p> 
<p>        transition: left 0.3s;</p> 
<p>        flex-grow: 1;</p> 
<p>        overflow: hidden;</p> 
<p>        ::v-deep(.el-tabs__nav-prev) {<!-- --></p> 
<p>            padding: 0 10px;</p> 
<p>            border-right: var(--el-border-color-extra-light) 1px solid;</p> 
<p>        }</p> 
<p>        ::v-deep(.el-tabs__nav-next) {<!-- --></p> 
<p>            padding: 0 10px;</p> 
<p>            border-left: var(--el-border-color-extra-light) 1px solid;</p> 
<p>        }</p> 
<p>        ::v-deep(.is-scrollable) {<!-- --></p> 
<p>            padding: 0 32px;</p> 
<p>        }</p> 
<p>        ::v-deep(.el-tabs__active-bar) {<!-- --></p> 
<p>            height: 0;</p> 
<p>        }</p> 
<p>        ::v-deep(.el-tabs__item) {<!-- --></p> 
<p>            .is-icon-close {<!-- --></p> 
<p>                transition: none !important;</p> 
<p>                &amp;:hover {<!-- --></p> 
<p>                    color: var(--el-color-primary-light-9);</p> 
<p>                    background-color: var(--el-color-primary);</p> 
<p>                    border-radius: 50%;</p> 
<p>                }</p> 
<p>            }</p> 
<p>        }</p> 
<p>    }</p> 
<p>}</p> 
<p>.tabs-item-style-1 {<!-- --></p> 
<p>    ::v-deep(.el-tabs__item) {<!-- --></p> 
<p>        padding: 0 15px !important;</p> 
<p>        border-right: var(--el-border-color-extra-light) 1px solid;</p> 
<p>        user-select: none;</p> 
<p>        color: #8c8c8c;</p> 
<p>        &amp;:hover {<!-- --></p> 
<p>            color: #444;</p> 
<p>            background: rgba(0, 0, 0, 0.02);</p> 
<p>        }</p> 
<p>        &amp;.is-active {<!-- --></p> 
<p>            color: var(--el-color-primary);</p> 
<p>            background-color: var(--el-color-primary-light-9);</p> 
<p>            border-bottom: var(--el-border-color-light) 2px solid;</p> 
<p>            &amp;::before {<!-- --></p> 
<p>                background-color: var(--el-color-primary);</p> 
<p>            }</p> 
<p>        }</p> 
<p>        &amp;::before {<!-- --></p> 
<p>            content: '';</p> 
<p>            width: 9px;</p> 
<p>            height: 9px;</p> 
<p>            margin-right: 8px;</p> 
<p>            display: inline-block;</p> 
<p>            background-color: #ddd;</p> 
<p>            border-radius: 50%;</p> 
<p>        }</p> 
<p>    }</p> 
<p>}</p> 
<p>.tabs-item-style-2 {<!-- --></p> 
<p>    ::v-deep(.el-tabs__item) {<!-- --></p> 
<p>        padding: 0 15px !important;</p> 
<p>        border-right: none;</p> 
<p>        user-select: none;</p> 
<p>        color: #8c8c8c;</p> 
<p>        display: inline-block;</p> 
<p></p> 
<p>        &amp;:hover {<!-- --></p> 
<p>            color: #444;</p> 
<p>            background: rgba(0, 0, 0, 0.02);</p> 
<p>            border-bottom: var(--el-color-primary) 2px solid;</p> 
<p>        }</p> 
<p></p> 
<p>        &amp;.is-active {<!-- --></p> 
<p>            color: var(--el-color-primary) !important;</p> 
<p>            background-color: var(--el-color-primary-light-9) !important;</p> 
<p>            border-bottom: var(--el-color-primary) 2px solid;</p> 
<p>            &amp;::before {<!-- --></p> 
<p>                background-color: var(--el-color-primary);</p> 
<p>            }</p> 
<p>        }</p> 
<p>    }</p> 
<p>}</p> 
<p>.tabs-action {<!-- --></p> 
<p>    height: 40px;</p> 
<p>    line-height: 40px;</p> 
<p>    box-sizing: border-box;</p> 
<p>    padding: 0 12px;</p> 
<p>    align-items: center;</p> 
<p>    cursor: pointer;</p> 
<p>    color: #666;</p> 
<p>    border-left: var(--el-border-color-extra-light) 1px solid;</p> 
<p>    border-bottom: var(--el-border-color-light) 2px solid;</p> 
<p>}</p> 
<p>&lt;/style&gt;</p> 
<p><img alt="" height="166" src="https://images2.imgbox.com/86/4b/u4Phugxp_o.png" width="1184"></p> 
<p>&lt;template&gt;</p> 
<p>    &lt;div id="printJs-vue"&gt;</p> 
<p>        &lt;el-card shadow="hover" header="页面打印"&gt;</p> 
<p>            &lt;el-alert title="页面打印演示，使用的是 `print-js`，项目地址：https://github.com/crabbly/Print.js" type="success" :closable="false"&gt;&lt;/el-alert&gt;</p> 
<p>            &lt;p style="margin-top: 10px"&gt;&lt;el-button size="default" type="primary" @click="handlePrintJs"&gt; 点击打印 &lt;/el-button&gt;&lt;/p&gt;</p> 
<p>        &lt;/el-card&gt;</p> 
<p>    &lt;/div&gt;</p> 
<p>&lt;/template&gt;</p> 
<p></p> 
<p>&lt;script lang="ts" setup&gt;</p> 
<p>import printJs from 'print-js'</p> 
<p></p> 
<p>const handlePrintJs = () =&gt; {<!-- --></p> 
<p>    printJs({<!-- --></p> 
<p>        printable: 'printJs-vue',</p> 
<p>        type: 'html',</p> 
<p>        css: ['//unpkg.com/element-plus/dist/index.css'],</p> 
<p>        scanStyles: false</p> 
<p>    })</p> 
<p>}</p> 
<p>&lt;/script&gt;</p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7e3afc9bd902990fa18b6bca014200b1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">1002：求三个数最大值 C语言七种写法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8f5053711e637bd53b8fbd4b5c7bcf2c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">工作记录 根据菜单列表生成路由数据</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>