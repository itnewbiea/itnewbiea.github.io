<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Spark Streaming - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Spark Streaming" />
<meta property="og:description" content="目录
一、流计算概述
（一）静态数据和流数据
（二）批量计算和实时计算
（三）流计算概念
（四）流计算框架
（五）流计算处理流程
二、Spark Streaming
（一）Spark Streaming设计
（二）Spark Streaming与Storm的对比
（三）从“Hadoop&#43;Storm”架构转向Spark架构
三、DStream操作概述
（一）Spark Streaming工作机制
（二）Spark Streaming程序的基本步骤
（三）创建StreamingContext对象
一、流计算概述 （一）静态数据和流数据 很多企业为了支持决策分析而构建的数据仓库系统，其中存放的大量历史数据就是静态数据。技术人员可以利用数据挖掘和OLAP（On-Line Analytical Processing）分析工具从静态数据中找到对企业有价值的信息。
近年来，在Web应用、网络监控、传感监测等领域，兴起了一种新的数据密集型应用——流数据，即数据以大量、快速、时变的流形式持续到达。实例：PM2.5检测、电子商务网站用户点击流。
流数据具有如下特征：
（1）数据快速持续到达，潜在大小也许是无穷无尽的。
（2）数据来源众多，格式复杂。
（3）数据量大，但是不十分关注存储，一旦经过处理，要么被丢弃，要么被归档存储。
（4）注重数据的整体价值，不过分关注个别数据。
（5）数据顺序颠倒，或者不完整，系统无法控制将要处理的新到达的数据元素的顺序。
（二）批量计算和实时计算 对静态数据和流数据的处理，对应着两种截然不同的计算模式：批量计算和实时计算。
批量计算：充裕时间处理静态数据，如Hadoop。流数据不适合采用批量计算，因为流数据不适合用传统的关系模型建模。
实时计算：流数据必须采用实时计算，响应时间为秒级。数据量少时，不是问题，但是，在大数据时代，数据格式复杂、来源众多、数据量巨大，对实时计算提出了很大的挑战。因此，针对流数据的实时计算——流计算，应运而生。
（三）流计算概念 流计算：实时获取来自不同数据源的海量数据，经过实时分析处理，获得有价值的信息。
流计算秉承一个基本理念，即数据的价值随着时间的流逝而降低，如用户点击流。因此，当事件出现时就应该立即进行处理，而不是缓存起来进行批量处理。为了及时处理流数据，就需要一个低延迟、可扩展、高可靠的处理引擎。
对于一个流计算系统来说，它应达到如下需求：
（1）高性能：处理大数据的基本要求，如每秒处理几十万条数据
（2）海量式：支持TB级甚至是PB级的数据规模
（3）实时性：保证较低的延迟时间，达到秒级别，甚至是毫秒级别
（4）分布式：支持大数据的基本架构，必须能够平滑扩展
（5）易用性：能够快速进行开发和部署
（6）可靠性：能可靠地处理流数据
（四）流计算框架 当前业界诞生了许多专门的流数据实时计算系统来满足各自需求。目前有三类常见的流计算框架和平台：商业级的流计算平台、开源流计算框架、公司为支持自身业务开发的流计算框架。
第一类是商业级的流计算平台：
——IBM InfoSphere Streams
——IBM StreamBase
第二类是开源流计算框架，也是较为常见的，代表如下：
——Twitter Storm：免费、开源的分布式实时计算系统，可简单、高效、可靠地处理大量的流数据。
——Yahoo! S4（Simple Scalable Streaming System）：开源流计算平台，是通用的、分布式的、可扩展的、分区容错的、可插拔的流式系统。
第三类是公司为支持自身业务开发的流计算框架：
——Facebook Puma
——Dstream（百度）
——银河流数据处理平台（淘宝）
（五）流计算处理流程 1、概述" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/218179e07b39d764a7a806f94e458afd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-30T11:47:21+08:00" />
<meta property="article:modified_time" content="2023-12-30T11:47:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Spark Streaming</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%E6%B5%81%E8%AE%A1%E7%AE%97%E6%A6%82%E8%BF%B0-toc" style="margin-left:40px;"><a href="#%E4%B8%80%E3%80%81%E6%B5%81%E8%AE%A1%E7%AE%97%E6%A6%82%E8%BF%B0" rel="nofollow">一、流计算概述</a></p> 
<p id="%EF%BC%88%E4%B8%80%EF%BC%89%E9%9D%99%E6%80%81%E6%95%B0%E6%8D%AE%E5%92%8C%E6%B5%81%E6%95%B0%E6%8D%AE-toc" style="margin-left:80px;"><a href="#%EF%BC%88%E4%B8%80%EF%BC%89%E9%9D%99%E6%80%81%E6%95%B0%E6%8D%AE%E5%92%8C%E6%B5%81%E6%95%B0%E6%8D%AE" rel="nofollow">（一）静态数据和流数据</a></p> 
<p id="%EF%BC%88%E4%BA%8C%EF%BC%89%E6%89%B9%E9%87%8F%E8%AE%A1%E7%AE%97%E5%92%8C%E5%AE%9E%E6%97%B6%E8%AE%A1%E7%AE%97-toc" style="margin-left:80px;"><a href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E6%89%B9%E9%87%8F%E8%AE%A1%E7%AE%97%E5%92%8C%E5%AE%9E%E6%97%B6%E8%AE%A1%E7%AE%97" rel="nofollow">（二）批量计算和实时计算</a></p> 
<p id="%EF%BC%88%E4%B8%89%EF%BC%89%E6%B5%81%E8%AE%A1%E7%AE%97%E6%A6%82%E5%BF%B5-toc" style="margin-left:80px;"><a href="#%EF%BC%88%E4%B8%89%EF%BC%89%E6%B5%81%E8%AE%A1%E7%AE%97%E6%A6%82%E5%BF%B5" rel="nofollow">（三）流计算概念</a></p> 
<p id="%EF%BC%88%E5%9B%9B%EF%BC%89%E6%B5%81%E8%AE%A1%E7%AE%97%E6%A1%86%E6%9E%B6-toc" style="margin-left:80px;"><a href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E6%B5%81%E8%AE%A1%E7%AE%97%E6%A1%86%E6%9E%B6" rel="nofollow">（四）流计算框架</a></p> 
<p id="%EF%BC%88%E4%BA%94%EF%BC%89%E6%B5%81%E8%AE%A1%E7%AE%97%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B-toc" style="margin-left:80px;"><a href="#%EF%BC%88%E4%BA%94%EF%BC%89%E6%B5%81%E8%AE%A1%E7%AE%97%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B" rel="nofollow">（五）流计算处理流程</a></p> 
<p id="%E4%BA%8C%E3%80%81Spark%20Streaming-toc" style="margin-left:40px;"><a href="#%E4%BA%8C%E3%80%81Spark%20Streaming" rel="nofollow">二、Spark Streaming</a></p> 
<p id="%EF%BC%88%E4%B8%80%EF%BC%89Spark%20Streaming%E8%AE%BE%E8%AE%A1-toc" style="margin-left:80px;"><a href="#%EF%BC%88%E4%B8%80%EF%BC%89Spark%20Streaming%E8%AE%BE%E8%AE%A1" rel="nofollow">（一）Spark Streaming设计</a></p> 
<p id="%EF%BC%88%E4%BA%8C%EF%BC%89Spark%20Streaming%E4%B8%8EStorm%E7%9A%84%E5%AF%B9%E6%AF%94-toc" style="margin-left:80px;"><a href="#%EF%BC%88%E4%BA%8C%EF%BC%89Spark%20Streaming%E4%B8%8EStorm%E7%9A%84%E5%AF%B9%E6%AF%94" rel="nofollow">（二）Spark Streaming与Storm的对比</a></p> 
<p id="%EF%BC%88%E4%B8%89%EF%BC%89%E4%BB%8E%E2%80%9CHadoop%2BStorm%E2%80%9D%E6%9E%B6%E6%9E%84%E8%BD%AC%E5%90%91Spark%E6%9E%B6%E6%9E%84-toc" style="margin-left:80px;"><a href="#%EF%BC%88%E4%B8%89%EF%BC%89%E4%BB%8E%E2%80%9CHadoop%2BStorm%E2%80%9D%E6%9E%B6%E6%9E%84%E8%BD%AC%E5%90%91Spark%E6%9E%B6%E6%9E%84" rel="nofollow">（三）从“Hadoop+Storm”架构转向Spark架构</a></p> 
<p id="%E4%B8%89%E3%80%81DStream%E6%93%8D%E4%BD%9C%E6%A6%82%E8%BF%B0-toc" style="margin-left:40px;"><a href="#%E4%B8%89%E3%80%81DStream%E6%93%8D%E4%BD%9C%E6%A6%82%E8%BF%B0" rel="nofollow">三、DStream操作概述</a></p> 
<p id="%EF%BC%88%E4%B8%80%EF%BC%89Spark%20Streaming%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6-toc" style="margin-left:80px;"><a href="#%EF%BC%88%E4%B8%80%EF%BC%89Spark%20Streaming%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6" rel="nofollow">（一）Spark Streaming工作机制</a></p> 
<p id="%EF%BC%88%E4%BA%8C%EF%BC%89Spark%20Streaming%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%AD%A5%E9%AA%A4-toc" style="margin-left:80px;"><a href="#%EF%BC%88%E4%BA%8C%EF%BC%89Spark%20Streaming%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%AD%A5%E9%AA%A4" rel="nofollow">（二）Spark Streaming程序的基本步骤</a></p> 
<p id="%EF%BC%88%E4%B8%89%EF%BC%89%E5%88%9B%E5%BB%BAStreamingContext%E5%AF%B9%E8%B1%A1-toc" style="margin-left:80px;"><a href="#%EF%BC%88%E4%B8%89%EF%BC%89%E5%88%9B%E5%BB%BAStreamingContext%E5%AF%B9%E8%B1%A1" rel="nofollow">（三）创建StreamingContext对象</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h3>一、流计算概述</h3> 
<h4 id="%EF%BC%88%E4%B8%80%EF%BC%89%E9%9D%99%E6%80%81%E6%95%B0%E6%8D%AE%E5%92%8C%E6%B5%81%E6%95%B0%E6%8D%AE">（一）静态数据和流数据</h4> 
<p style="text-align:justify;">        很多企业为了支持决策分析而构建的数据仓库系统，其中存放的大量历史数据就是静态数据。技术人员可以利用数据挖掘和OLAP（On-Line Analytical Processing）分析工具从静态数据中找到对企业有价值的信息。</p> 
<p class="img-center"><img alt="" height="433" src="https://images2.imgbox.com/18/3e/GWZeDjCN_o.png" width="800"></p> 
<p style="text-align:justify;">        近年来，在Web应用、网络监控、传感监测等领域，兴起了一种新的数据密集型应用——流数据，即数据以大量、快速、时变的流形式持续到达。实例：PM2.5检测、电子商务网站用户点击流。<br>         <strong>流数据具有如下特征：</strong><br> （1）数据快速持续到达，潜在大小也许是无穷无尽的。<br> （2）数据来源众多，格式复杂。<br> （3）数据量大，但是不十分关注存储，一旦经过处理，要么被丢弃，要么被归档存储。<br> （4）注重数据的整体价值，不过分关注个别数据。<br> （5）数据顺序颠倒，或者不完整，系统无法控制将要处理的新到达的数据元素的顺序。</p> 
<h4 id="%EF%BC%88%E4%BA%8C%EF%BC%89%E6%89%B9%E9%87%8F%E8%AE%A1%E7%AE%97%E5%92%8C%E5%AE%9E%E6%97%B6%E8%AE%A1%E7%AE%97" style="text-align:justify;">（二）批量计算和实时计算</h4> 
<p style="text-align:justify;">对静态数据和流数据的处理，对应着两种截然不同的计算模式：批量计算和实时计算。<br><strong>       批量计算</strong>：充裕时间处理静态数据，如Hadoop。流数据不适合采用批量计算，因为流数据不适合用传统的关系模型建模。<br><strong>       实时计算</strong>：流数据必须采用实时计算，响应时间为秒级。数据量少时，不是问题，但是，在大数据时代，数据格式复杂、来源众多、数据量巨大，对实时计算提出了很大的挑战。因此，针对流数据的实时计算——流计算，应运而生。</p> 
<p class="img-center"><img alt="" height="327" src="https://images2.imgbox.com/d1/04/ZJ9y2gnO_o.png" width="400"></p> 
<h4 id="%EF%BC%88%E4%B8%89%EF%BC%89%E6%B5%81%E8%AE%A1%E7%AE%97%E6%A6%82%E5%BF%B5" style="text-align:justify;">（三）流计算概念</h4> 
<p style="text-align:justify;">        <strong>流计算</strong>：实时获取来自不同数据源的海量数据，经过实时分析处理，获得有价值的信息。</p> 
<p class="img-center"><img alt="" height="246" src="https://images2.imgbox.com/68/17/khZ5Ynnc_o.png" width="500"></p> 
<p style="text-align:justify;">        流计算秉承一个基本理念，即数据的价值随着时间的流逝而降低，如用户点击流。因此，当事件出现时就应该立即进行处理，而不是缓存起来进行批量处理。为了及时处理流数据，就需要一个低延迟、可扩展、高可靠的处理引擎。</p> 
<p style="text-align:justify;">        对于一个流计算系统来说，它应达到如下<strong>需求</strong>：<br> （1）高性能：处理大数据的基本要求，如每秒处理几十万条数据<br> （2）海量式：支持TB级甚至是PB级的数据规模<br> （3）实时性：保证较低的延迟时间，达到秒级别，甚至是毫秒级别<br> （4）分布式：支持大数据的基本架构，必须能够平滑扩展<br> （5）易用性：能够快速进行开发和部署<br> （6）可靠性：能可靠地处理流数据</p> 
<h4 id="%EF%BC%88%E5%9B%9B%EF%BC%89%E6%B5%81%E8%AE%A1%E7%AE%97%E6%A1%86%E6%9E%B6" style="text-align:justify;">（四）流计算框架</h4> 
<p style="text-align:justify;">        当前业界诞生了许多专门的流数据实时计算系统来满足各自需求。目前有三类常见的流计算框架和平台：商业级的流计算平台、开源流计算框架、公司为支持自身业务开发的流计算框架。</p> 
<p style="text-align:justify;">第一类是<strong>商业级的流计算平台</strong>：<br> ——IBM InfoSphere Streams<br> ——IBM StreamBase<br> 第二类是<strong>开源流计算框架</strong>，也是较为常见的，代表如下：<br> ——Twitter Storm：免费、开源的分布式实时计算系统，可简单、高效、可靠地处理大量的流数据。<br> ——Yahoo! S4（Simple Scalable Streaming System）：开源流计算平台，是通用的、分布式的、可扩展的、分区容错的、可插拔的流式系统。<br> 第三类是<strong>公司为支持自身业务开发的流计算框架</strong>：<br> ——Facebook Puma<br> ——Dstream（百度）<br> ——银河流数据处理平台（淘宝）</p> 
<h4 id="%EF%BC%88%E4%BA%94%EF%BC%89%E6%B5%81%E8%AE%A1%E7%AE%97%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B" style="text-align:justify;">（五）流计算处理流程</h4> 
<p style="text-align:justify;"><strong>1、概述</strong></p> 
<p style="text-align:justify;">        传统的数据处理流程，需要先采集数据并存储在关系数据库等数据管理系统中，之后由用户通过查询操作和数据管理系统进行交互。</p> 
<p class="img-center"><img alt="" height="120" src="https://images2.imgbox.com/a1/10/XbAx2PdQ_o.png" width="400"></p> 
<p>        传统的数据处理流程隐含了<strong>两个前提</strong>：<br> （1）<strong>存储的数据是旧的</strong>。存储的静态数据是过去某一时刻的快照，这些数据在查询时可能已不具备时效性了。<br> （2）<strong>需要用户主动发出查询来获取结果</strong>。</p> 
<p>流计算的处理流程一般包含三个阶段：数据实时采集、数据实时计算、实时查询服务。</p> 
<p class="img-center"><img alt="" height="251" src="https://images2.imgbox.com/55/0f/Y59ZkQZv_o.png" width="600"></p> 
<p><strong>2、数据实时采集</strong></p> 
<p style="text-align:justify;">        数据实时采集阶段通常采集多个数据源的海量数据，需要保证实时性、低延迟与稳定可靠。以日志数据为例，由于分布式集群的广泛应用，数据分散存储在不同的机器上，因此需要实时汇总来自不同机器上的日志数据。<br>         目前有许多互联网公司发布的开源分布式日志采集系统均可满足每秒数百MB的数据采集和传输需求，如： Facebook的Scribe、LinkedIn的Kafka、淘宝的Time Tunnel，以及基于Hadoop的Chukwa和Flume。</p> 
<p><strong>3、数据实时计算</strong></p> 
<p>        数据实时计算阶段对采集的数据进行实时的分析和计算，并反馈实时结果。经流处理系统处理后的数据，可视情况进行存储，以便之后再进行分析计算。在时效性要求较高的场景中，处理之后的数据也可以直接丢弃。</p> 
<p class="img-center"><img alt="" height="164" src="https://images2.imgbox.com/ee/63/uvWXmD2s_o.png" width="400"></p> 
<p><strong>4、数据实时计算</strong></p> 
<p style="text-align:justify;">        实时查询服务：经由流计算框架得出的结果可供用户进行实时查询、展示或储存。传统的数据处理流程，用户需要主动发出查询才能获得想要的结果。而在流处理流程中，实时查询服务可以不断更新结果，并将用户所需的结果实时推送给用户。<br>         虽然通过对传统的数据处理系统进行<strong>定时</strong>查询，也可以实现不断地更新结果和结果推送，但通过这样的方式获取的结果，仍然是根据过去某一时刻的数据得到的结果，与实时结果有着本质的区别。</p> 
<p style="text-align:justify;">        可见，流处理系统与传统的数据处理系统有如下不同：<br> （1）流处理系统处理的是实时的数据，而传统的数据处理系统处理的是预先存储好的静态数据。<br> （2）用户通过流处理系统获取的是实时结果，而通过传统的数据处理系统，获取的是过去某一时刻的结果 流处理系统无需用户主动发出查询，实时查询服务可以主动将实时结果推送给用户。</p> 
<h3 id="%E4%BA%8C%E3%80%81Spark%20Streaming">二、Spark Streaming</h3> 
<h4 id="%EF%BC%88%E4%B8%80%EF%BC%89Spark%20Streaming%E8%AE%BE%E8%AE%A1">（一）Spark Streaming设计</h4> 
<p style="text-align:justify;">        Spark Streaming可整合多种输入数据源，如Kafka、Flume、HDFS，甚至是普通的TCP套接字。经处理后的数据可存储至文件系统、数据库，或显示在仪表盘里。</p> 
<p class="img-center"><img alt="" height="259" src="https://images2.imgbox.com/aa/ea/Hn6OISZn_o.png" width="600"></p> 
<p style="text-align:justify;">        Spark Streaming的基本原理是将实时输入数据流以时间片（秒级）为单位进行拆分，然后经Spark引擎以类似批处理的方式处理每个时间片数据。</p> 
<p class="img-center"><img alt="" height="171" src="https://images2.imgbox.com/ef/18/jHIuQdnl_o.png" width="800"></p> 
<p style="text-align:justify;">        Spark Streaming最主要的抽象是DStream（Discretized Stream，离散化数据流），表示连续不断的数据流。在内部实现上，Spark Streaming的输入数据按照时间片（如1秒）分成一段一段，每一段数据转换为Spark中的RDD，这些分段就是Dstream，并且对DStream的操作都最终转变为对相应的RDD的操作。</p> 
<p class="img-center"><img alt="" height="268" src="https://images2.imgbox.com/5e/0f/gM2nPm39_o.png" width="600"></p> 
<h4 id="%EF%BC%88%E4%BA%8C%EF%BC%89Spark%20Streaming%E4%B8%8EStorm%E7%9A%84%E5%AF%B9%E6%AF%94" style="text-align:justify;">（二）Spark Streaming与Storm的对比</h4> 
<p style="text-align:justify;">        Spark Streaming和Storm最大的区别在于，Spark Streaming无法实现毫秒级的流计算，而Storm可以实现毫秒级响应。<br>         Spark Streaming构建在Spark上，一方面是因为Spark的低延迟执行引擎（100ms+）可以用于实时计算，另一方面，相比于Storm，RDD数据集更容易做高效的容错处理。<br>         Spark Streaming采用的小批量处理的方式使得它可以同时兼容批量和实时数据处理的逻辑和算法，因此，方便了一些需要历史数据和实时数据联合分析的特定应用场合。</p> 
<h4 id="%EF%BC%88%E4%B8%89%EF%BC%89%E4%BB%8E%E2%80%9CHadoop%2BStorm%E2%80%9D%E6%9E%B6%E6%9E%84%E8%BD%AC%E5%90%91Spark%E6%9E%B6%E6%9E%84" style="text-align:justify;">（三）从“Hadoop+Storm”架构转向Spark架构</h4> 
<p style="text-align:justify;">        为了能同时进行批处理与流处理，企业应用中通常会采用"Hadoop+Storm”的架构（也称为Lambda架构）。图一给出了采用Hadoop+Storm部署方式的一个案例，在这种部署架构中， Hadoop 和 Storm框架部署在资源管理框架YARN（或Mesos）之上，接受统一的资源管理和调度，并共享底层的数据存储（如HDFS、HBase、Cassandra等）。Hadoop负责对批量历史数据的实时查询和离线分析，而Storm则负责对流数据的实时处理。<br>         但是，上述这种架构部署较为烦琐。由于Spark同时支持批处理与流处理，因此，对于一些类型的企业应用而言，从“Hadoop+Storm”架构转向Spark架构图二就成为一种很自然的选择。</p> 
<p class="img-center"><img alt="" height="499" src="https://images2.imgbox.com/da/21/w8eULH6F_o.png" width="800"></p> 
<p class="img-center"><img alt="" height="415" src="https://images2.imgbox.com/1c/80/r59Fqnqs_o.png" width="400"></p> 
<p>采用Spark架构具有如下优点：<br> （1）实现一键式安装和配置、线程级别的任务监控和告警；<br> （2）降低硬件集群构建、软件维护、任务监控和应用开发的难度；<br> （3）便于做成统一的硬件、计算平台资源池。</p> 
<p style="text-align:justify;">需要说明的是，正如前面介绍的那样，Spark Streaming无法实现毫秒级的流计算，因此，对于需要毫秒级实时响应的企业应用而言，仍然需要采用流计算框架（如Storm）。</p> 
<h3 id="%E4%B8%89%E3%80%81DStream%E6%93%8D%E4%BD%9C%E6%A6%82%E8%BF%B0" style="text-align:justify;">三、DStream操作概述</h3> 
<h4 id="%EF%BC%88%E4%B8%80%EF%BC%89Spark%20Streaming%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6" style="text-align:justify;">（一）Spark Streaming工作机制</h4> 
<p style="text-align:justify;">        在Spark Streaming中，会有一个组件Receiver，作为一个长期运行的task跑在一个Executor上。每个Receiver都会负责一个input DStream（比如从文件中读取数据的文件流，比如套接字流，或者从Kafka中读取的一个输入流等等）。Spark Streaming通过input DStream与外部数据源进行连接，读取相关数据。</p> 
<div class="img-center"> 
 <figure class="image"> 
  <img alt="" height="304" src="https://images2.imgbox.com/40/41/oj0rQqlq_o.png" width="600"> 
  <figcaption>
    Spark Streaming工作机制 
  </figcaption> 
 </figure> 
</div> 
<h4 id="%EF%BC%88%E4%BA%8C%EF%BC%89Spark%20Streaming%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%AD%A5%E9%AA%A4" style="text-align:justify;">（二）Spark Streaming程序的基本步骤</h4> 
<p style="text-align:justify;">编写Spark Streaming程序的基本步骤是：<br> 1、通过创建输入DStream来定义输入源<br> 2、通过对DStream应用转换操作和输出操作来定义流计算<br> 3、用streamingContext.start()来开始接收数据和处理流程<br> 4、通过streamingContext.awaitTermination()方法来等待处理结束（手动结束或因为错误而结束）<br> 5、可以通过streamingContext.stop()来手动结束流计算进程</p> 
<h4 id="%EF%BC%88%E4%B8%89%EF%BC%89%E5%88%9B%E5%BB%BAStreamingContext%E5%AF%B9%E8%B1%A1" style="text-align:justify;">（三）创建StreamingContext对象</h4> 
<p style="text-align:justify;">        如果要运行一个Spark Streaming程序，就需要首先生成一个StreamingContext对象，它是Spark Streaming程序的主入口。<br>         可以从一个SparkConf对象创建一个StreamingContext对象。 在pyspark中的创建方法：进入pyspark以后，就已经获得了一个默认的SparkConext对象，也就是sc。因此，可以采用如下方式来创建StreamingContext对象：</p> 
<pre><code class="language-bash">&gt;&gt;&gt; from pyspark.streaming import StreamingContext
&gt;&gt;&gt; ssc = StreamingContext(sc, 1)
</code></pre> 
<p style="text-align:justify;">        如果是编写一个独立的Spark Streaming程序，而不是在pyspark中运行，则需要通过如下方式创建StreamingContext对象：</p> 
<pre><code class="language-python">from pyspark import SparkContext, SparkConf
from pyspark.streaming import StreamingContext
conf = SparkConf()
conf.setAppName('TestDStream')
conf.setMaster('local[2]')
sc = SparkContext(conf = conf)
ssc = StreamingContext(sc, 1)
</code></pre> 
<p></p> 
<p><em><strong>以下内容会在下一篇博客中讲解到：（Spark编程实验四：Spark Streaming编程）</strong></em></p> 
<p><a class="has-card" href="https://blog.csdn.net/Morse_Chen/article/details/135302003" title="Spark编程实验四：Spark Streaming编程-CSDN博客"><span class="link-card-box"><span class="link-title">Spark编程实验四：Spark Streaming编程-CSDN博客</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/61/07/8IfWl6tg_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/Morse_Chen/article/details/135302003</span></span></a><strong>四、基本输入源</strong><br> （一）文件流<br> （二）套接字流<br> （三）RDD队列流</p> 
<p><strong>五、高级数据源</strong> ——&gt; 此部分内容可以参考上一篇博客：</p> 
<p><a class="has-card" href="https://blog.csdn.net/Morse_Chen/article/details/135273370" title="【数据采集与预处理】数据接入工具Kafka-CSDN博客"><span class="link-card-box"><span class="link-title">【数据采集与预处理】数据接入工具Kafka-CSDN博客</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/bb/93/5h8GWWCp_o.png" alt="icon-default.png?t=N7T8">https://blog.csdn.net/Morse_Chen/article/details/135273370</span></span></a>（一）Kafka简介<br> （二）Kafka准备工作<br> （三）Spark准备工作<br> （四）编写Spark Streaming程序使用Kafka数据源</p> 
<p><strong>六、转换操作</strong><br> （一）DStream无状态转换操作<br> （二）DStream有状态转换操作</p> 
<p><strong>七、输出操作</strong><br> （一）把DStream输出到文本文件中<br> （二）把DStream写入到MySQL数据库中</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/791347e71f63293fbddb1d367f7cdfc5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">腾讯欧拉平台产品经理：如何做一款好的数据平台？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/017a8d0f9d415197d7265304dce2b1f6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">滤波器opencv</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>