<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【VulnHub系列】BrokenGallery - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【VulnHub系列】BrokenGallery" />
<meta property="og:description" content="因为是从PDF转换过来偶尔可能会出现内容缺少，可以看原版PDF：有道云笔记 实验信息 Broken：192.168.10.111
Kali：192.168.10.106
实验过程 sudo arp-scan --interface eth0 192.168.10.1/24 然后对靶机进行端口探测 nmap -sT -p- --min-rate 1000 192.168.10.111 -oA ./Broken_result 再对端口进行详细扫描和漏洞扫描
cat Broken_result.nmap | grep &#34;open&#34; | awk -F &#39;/&#39; &#39;{print $1}&#39; | paste -sd &#39;,&#39; sudo nmap -sT -sC -sV -p 22,80 192.168.10.111 -oA ./detail 详细扫描发现80端口有几个文件
后台挂着gobuster来跑目录
sudo gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 20 -u http://192.168.10.111/ -x txt,rar,zip,tar,sql,php 打开80端口，发现文件都wget保存到本地,查看网页源码以及文件来收集信息
xdg-open img_forest.jpg 查看REAMD.md的文件类型，是txt类型
用cat发现都是十六进制的字节码
-r选项用于将十六进制格式转换回二进制格式 -p表示输出纯粹的十六进制编码，而不包括其他信息 -s选项用于跳过文件的前N个字节 通过strings来读二进制文件，通过head来读取前几行内容来确定文件类型
-r选项用于将十六进制格式转换回二进制格式 -p表示输出纯粹的十六进制编码，而不包括其他信息 -s选项用于跳过文件的前N个字节 xxd -r -ps README." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/77e41f5372eb6c52834741f42c91bac9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-25T10:55:21+08:00" />
<meta property="article:modified_time" content="2023-06-25T10:55:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【VulnHub系列】BrokenGallery</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="margin-left:5pt;">因为是从PDF转换过来偶尔可能会出现内容缺少，可以看原版PDF：<a href="https://note.youdao.com/s/Qz3O9bz8" rel="nofollow" title="有道云笔记">有道云笔记</a></h2> 
<p></p> 
<h2 style="margin-left:5pt;"><span style="color:#24292e;">实验信息</span></h2> 
<p><span style="color:#24292e;">Broken：192.168.10.111</span></p> 
<p><span style="color:#24292e;">Kali：192.168.10.106</span></p> 
<h2 style="margin-left:5pt;"><span style="color:#24292e;">实验过程</span></h2> 
<pre><code class="hljs">sudo arp-scan --interface eth0 192.168.10.1/24</code></pre> 
<p><img alt="" height="382" src="https://images2.imgbox.com/7b/e6/hcbJOL6n_o.png" width="1061"></p> 
<p><span style="color:#24292e;">然后对靶机进行端口探测</span> </p> 
<p></p> 
<pre><code class="hljs">nmap -sT -p- --min-rate 1000 192.168.10.111 -oA ./Broken_result</code></pre> 
<p> </p> 
<p><img alt="" height="352" src="https://images2.imgbox.com/88/2c/rTWH7SjZ_o.png" width="1064"></p> 
<p style="margin-left:0;"><span style="color:#24292e;">再对端口进行详细扫描和漏洞扫描</span></p> 
<p style="margin-left:0;"></p> 
<pre><code class="hljs">cat Broken_result.nmap | grep "open" | awk -F '/' '{print $1}' | paste -sd ',' 
sudo nmap -sT -sC -sV -p 22,80 192.168.10.111 -oA ./detail</code></pre> 
<p style="margin-left:0;"><span style="color:#24292e;">详细扫描发现80端口有几个文件</span></p> 
<p style="margin-left:0;"><img alt="" height="732" src="https://images2.imgbox.com/bb/70/pjUES8dy_o.png" width="1060"></p> 
<p> <span style="color:#24292e;">后台挂着</span><span style="color:#24292e;">gobuster</span><span style="color:#24292e;">来跑目录</span></p> 
<pre><code class="hljs">sudo gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 20 -u http://192.168.10.111/ -x txt,rar,zip,tar,sql,php</code></pre> 
<p><span style="color:#24292e;">打开</span><span style="color:#24292e;">80</span><span style="color:#24292e;">端口，发现文件都wget保存到本地,查看网页源码以及文件来收集信息</span></p> 
<pre><code class="hljs">xdg-open img_forest.jpg</code></pre> 
<p style="margin-left:0;"><span style="color:#24292e;">查看REAMD.md的文件类型，是</span><span style="color:#24292e;">txt</span><span style="color:#24292e;">类型</span></p> 
<p style="margin-left:0;"><img alt="" height="111" src="https://images2.imgbox.com/99/33/BFsZOJqi_o.png" width="527"></p> 
<p style="margin-left:0;"><span style="color:#24292e;">用cat发现都是十六进制的字节码</span></p> 
<p style="margin-left:0;"><img alt="" height="890" src="https://images2.imgbox.com/91/49/uc7KD4hU_o.png" width="1060"></p> 
<pre><code class="hljs">-r选项用于将十六进制格式转换回二进制格式
-p表示输出纯粹的十六进制编码，而不包括其他信息
-s选项用于跳过文件的前N个字节
</code></pre> 
<p> <img alt="" height="97" src="https://images2.imgbox.com/d2/6d/QSQ7yRj3_o.png" width="956"></p> 
<p> <span style="color:#24292e;">通过strings来读二进制文件，通过head来读取前几行内容来确定文件类型</span></p> 
<pre><code class="hljs">-r选项用于将十六进制格式转换回二进制格式
-p表示输出纯粹的十六进制编码，而不包括其他信息
-s选项用于跳过文件的前N个字节
xxd -r -ps README.md &gt; README.bin
</code></pre> 
<pre><code class="hljs">strings README.bin | head -n 10</code></pre> 
<p style="margin-left:0;"><span style="color:#24292e;">可以看到JFIF头，说明这个文件是图片文件，更改为Jpg后缀并打开</span></p> 
<p style="margin-left:0;"><img alt="" height="604" src="https://images2.imgbox.com/de/db/uFgrljt0_o.png" width="1060"></p> 
<p> <span style="color:#24292e;">是一段文字信息</span></p> 
<p style="margin-left:0;"><span style="color:#24292e;">再用exiftool来看看其他图片，没有发现有隐藏的信息</span></p> 
<p style="margin-left:0;"><img alt="" height="1148" src="https://images2.imgbox.com/5c/4c/TlFV9IgE_o.png" width="1060"></p> 
<p><span style="color:#24292e;">同时目录爆破也并没有什么有用信息</span></p> 
<p><span style="color:#24292e;">所以只能把注意力放到22端口上</span> </p> 
<p style="margin-left:0;"><span style="color:#24292e;">我们根据从图片获取的信息制作一个简易的字典文件尝试爆破SSH</span></p> 
<p style="margin-left:0;"><img alt="" height="403" src="https://images2.imgbox.com/a3/9a/l8ezgmYo_o.png" width="796"></p> 
<p> <span style="color:#24292e;">通过</span><span style="color:#24292e;">crackmapexec</span><span style="color:#24292e;">进行SSH爆破</span></p> 
<pre><code class="hljs">#--continue-on-success:表示成功获得凭据后继续爆破
#跟john相比，john更偏向快速，creackmapexec支持的协议和功能比较多

sudo crackmapexec ssh 192.168.10.111 -u creds -p creds --continue-on-success
</code></pre> 
<p style="margin-left:0;"><img alt="" height="714" src="https://images2.imgbox.com/27/c6/vKueVjlg_o.png" width="1053"></p> 
<p><span style="color:#24292e;">获得账号密码</span></p> 
<p><span style="color:#24292e;">broken:broken</span></p> 
<p><img alt="" height="187" src="https://images2.imgbox.com/6c/11/AldXNTJN_o.png" width="1067"> </p> 
<p><span style="color:#24292e;">登陆broken，发现其可以通过</span><span style="color:#24292e;">timedatectl</span><span style="color:#24292e;">来提权</span> </p> 
<p style="margin-left:0;"><img alt="" height="480" src="https://images2.imgbox.com/3b/5b/iXPq0lZv_o.png" width="1060"></p> 
<p> <span style="color:#24292e;">通过gtfobins：</span><a href="https://gtfobins.github.io/" rel="nofollow" title="https://gtfobins.github.io/ ">https://gtfobins.github.io/ </a><span style="color:#24292e;">来查看对应的提权方法</span></p> 
<p> <img alt="" height="506" src="https://images2.imgbox.com/dd/c8/TRsF7Lgx_o.png" width="750"></p> 
<p> </p> 
<p><span style="color:#24292e;">成功获得</span><span style="color:#24292e;">root权限</span></p> 
<p><img alt="" height="598" src="https://images2.imgbox.com/af/68/iQD9Uuyq_o.png" width="741"></p> 
<p> </p> 
<p> </p> 
<p style="margin-left:0;"></p> 
<div id="trans_main"></div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/20de647d45a6e100dc25d877cfd3555c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">springboot&#43;mysql核酸检测信息管理系统-计算机毕业设计源码19832</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9cd2b80146f53b0bc63d499cef261d06/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【MySql】MySql视图</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>