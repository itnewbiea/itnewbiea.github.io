<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>手把手教你EEG脑电数据预处理-操作篇 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="手把手教你EEG脑电数据预处理-操作篇" />
<meta property="og:description" content="目录 导入数据对数据进行初步认识电极定位移除无用电极重参考重采样滤波分段和基线校正插值坏导ICA剔除ICA成分剔除坏段目视检查法保存数据 本分享为脑机学习者Rose整理发表于公众号：脑机接口社区 QQ交流群：941473018
感谢简书ID:亚内士多德 授权分享
EEG脑电数据预处理-操作篇
关于EEG数据预处理的原理，前面已经介绍过了，大家可以查看《手把手教你EEG脑电数据预处理-原理篇》。下面是亚内士多德分享的操作篇。
导入数据 选择要导入的数据格式
接下来会弹出一个对话框，是否要对数据进行选择性导入，一般都是全部导入，直接点OK即可。
接下来又会再弹出一个对话框，是否要对数据进行命名。基本上在EEGLAB的每一步操作之后都会弹出这样的对话框，询问你是否需要对新产生的数据进行命名，根据自己需要选择即可。
对数据进行初步认识 channel per frame：64 指导入的数据有64个通道
frames per epoch：一段数据的总长度，是439880采样点
epochs：指当前数据的段数，原始数据还没有进行分段，因此显示只有一段
events：检测到当前数据一共有202个events
sampling rate（HZ）：数据的采样率为1000HZ
epoch start和epoch end: 这个的分段是从0秒开始，到439.879秒结束。还没有进行分段所以看这个数值没有意义
reference: 指数据的参考点，重参考后会显示重参考的电极点，或者average，目前还没有进行重参考所以是unknown
channel locations：是否有对通道进行定位，目前显示没有，定位后会显示为yes
ICA weights：是否对数据进行了ICA独立主成分分析，分析后会显示yes
dataset size：数据的大小
电极定位 默认文件是standard-10-5-cap385.elp，点击确定即可
点击OK之后可以进入下一步查看数据
如果检查到某个电极点的坐标信息为空白（如上图所示），可能是该通道的名称在加载的模板文件中找不到，那么
如果确定该通道是根据国际排布系统来确定的，那可以修改label名称后再点击下方的look up locs来更新通道位置信息，比如上图的VEO改为VEOG，然后更新位置信息之后就可以看到了
如果不是国际排布系统，可以向厂家要电极的坐标位置信息
如果知道该电极点的精确坐标，可以手动输入
双侧乳突的电极点位置可能会根据脑电系统的不同而不同，比如TP9 TP10,A1 A2, M1 M2这三对都是指双侧乳突
移除无用电极 此处我们要移除掉两个眼电数据
重参考 此处要将数据转换为双侧乳突平均参考，即TP9，TP10
重采样 不一定每个数据都需要进行重采样，可根据需要进行。
滤波 此处选择默认的滤波器进行0.1-30Hz的滤波
依次在第一框中填入0.1和第二个框中填入30进行计算，两个一起填代表进行带通滤波，建议分开进行
分段和基线校正 点击OK后会弹出下一个要求基线校正的对话框，默认是event前的数据作为基线来进行校正，点击OK即可。
插值坏导 对数据进行检查，如果发现某个通道的数据坏了，可以用插值的方式来进行校正，此处要校正的通道为FC3，选择插值的通道为它周围的四个电极点，F3,FC1,C3,FC5
第一种方法是代码操作
EEG.data(a,:,:) = mean(EEG.data([b c d],:,:)) ; 其中a代表坏掉的电极点数值，b c d 代表要进行插值平均的电极点数值" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/eab03bbd6c85013432c1f0a68908aa39/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-19T17:57:17+08:00" />
<meta property="article:modified_time" content="2020-05-19T17:57:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">手把手教你EEG脑电数据预处理-操作篇</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><a href="#_11" rel="nofollow">导入数据</a></li><li><a href="#_21" rel="nofollow">对数据进行初步认识</a></li><li><a href="#_35" rel="nofollow">电极定位</a></li><li><a href="#_52" rel="nofollow">移除无用电极</a></li><li><a href="#_57" rel="nofollow">重参考</a></li><li><a href="#_62" rel="nofollow">重采样</a></li><li><a href="#_67" rel="nofollow">滤波</a></li><li><a href="#_76" rel="nofollow">分段和基线校正</a></li><li><a href="#_84" rel="nofollow">插值坏导</a></li><li><a href="#ICA_112" rel="nofollow">ICA</a></li><li><a href="#ICA_156" rel="nofollow">剔除ICA成分</a></li><li><a href="#_178" rel="nofollow">剔除坏段</a></li><li><a href="#_184" rel="nofollow">目视检查法</a></li><li><a href="#_192" rel="nofollow">保存数据</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p>本分享为脑机学习者Rose整理发表于公众号：脑机接口社区 QQ交流群：941473018<br> <img src="https://images2.imgbox.com/e3/43/YC8nwOfb_o.jpg" alt=""><br> 感谢简书ID:亚内士多德 授权分享</p> 
<p>EEG脑电数据预处理-操作篇</p> 
<p>关于EEG数据预处理的原理，前面已经介绍过了，大家可以查看《手把手教你EEG脑电数据预处理-原理篇》。下面是亚内士多德分享的操作篇。</p> 
<h3><a id="_11"></a>导入数据</h3> 
<p>选择要导入的数据格式<br> <img src="https://images2.imgbox.com/d3/76/SdZg6H47_o.png" alt="在这里插入图片描述"><br> 接下来会弹出一个对话框，是否要对数据进行选择性导入，一般都是全部导入，直接点OK即可。<br> <img src="https://images2.imgbox.com/3c/da/qxZVoYyL_o.png" alt="在这里插入图片描述"></p> 
<p>接下来又会再弹出一个对话框，是否要对数据进行命名。基本上在EEGLAB的每一步操作之后都会弹出这样的对话框，询问你是否需要对新产生的数据进行命名，根据自己需要选择即可。<br> <img src="https://images2.imgbox.com/a3/61/0cOWivXh_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_21"></a>对数据进行初步认识</h3> 
<p><img src="https://images2.imgbox.com/97/a9/xP6IbyBg_o.png" alt="在这里插入图片描述"></p> 
<p>channel per frame：64 指导入的数据有64个通道<br> frames per epoch：一段数据的总长度，是439880采样点<br> epochs：指当前数据的段数，原始数据还没有进行分段，因此显示只有一段<br> events：检测到当前数据一共有202个events<br> sampling rate（HZ）：数据的采样率为1000HZ<br> epoch start和epoch end: 这个的分段是从0秒开始，到439.879秒结束。还没有进行分段所以看这个数值没有意义<br> reference: 指数据的参考点，重参考后会显示重参考的电极点，或者average，目前还没有进行重参考所以是unknown<br> channel locations：是否有对通道进行定位，目前显示没有，定位后会显示为yes<br> ICA weights：是否对数据进行了ICA独立主成分分析，分析后会显示yes<br> dataset size：数据的大小</p> 
<h3><a id="_35"></a>电极定位</h3> 
<p>默认文件是standard-10-5-cap385.elp，点击确定即可<br> <img src="https://images2.imgbox.com/7e/b5/UZo7EcE6_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e5/98/4rfW1Pa4_o.png" alt="在这里插入图片描述"></p> 
<p>点击OK之后可以进入下一步查看数据</p> 
<p><img src="https://images2.imgbox.com/21/48/8dsN3IHs_o.png" alt="channel locations info"></p> 
<p>如果检查到某个电极点的坐标信息为空白（如上图所示），可能是该通道的名称在加载的模板文件中找不到，那么<br> 如果确定该通道是根据国际排布系统来确定的，那可以修改label名称后再点击下方的look up locs来更新通道位置信息，比如上图的VEO改为VEOG，然后更新位置信息之后就可以看到了<br> 如果不是国际排布系统，可以向厂家要电极的坐标位置信息<br> 如果知道该电极点的精确坐标，可以手动输入<br> 双侧乳突的电极点位置可能会根据脑电系统的不同而不同，比如TP9 TP10,A1 A2, M1 M2这三对都是指双侧乳突</p> 
<p><img src="https://images2.imgbox.com/af/3f/Iz3uoIah_o.png" alt="更新后的电极点坐标"></p> 
<h3><a id="_52"></a>移除无用电极</h3> 
<p>此处我们要移除掉两个眼电数据<br> <img src="https://images2.imgbox.com/1d/46/9yXL8cJz_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f2/57/hT9nLKa5_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/03/f1/asvbUSOS_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_57"></a>重参考</h3> 
<p>此处要将数据转换为双侧乳突平均参考，即TP9，TP10</p> 
<p><img src="https://images2.imgbox.com/68/93/6mTTOJtL_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/9b/4e/XOvvXzZq_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_62"></a>重采样</h3> 
<p>不一定每个数据都需要进行重采样，可根据需要进行。<br> <img src="https://images2.imgbox.com/af/73/Zey2Iegm_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/35/51/BrCybCFO_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_67"></a>滤波</h3> 
<p>此处选择默认的滤波器进行0.1-30Hz的滤波</p> 
<p><img src="https://images2.imgbox.com/fe/09/q9JR9hdF_o.png" alt="filter"></p> 
<p>依次在第一框中填入0.1和第二个框中填入30进行计算，两个一起填代表进行带通滤波，建议分开进行</p> 
<p><img src="https://images2.imgbox.com/a5/eb/S8sn3jGa_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_76"></a>分段和基线校正</h3> 
<p><img src="https://images2.imgbox.com/86/f9/jhbyj48V_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6d/95/hELgGrPl_o.png" alt="在这里插入图片描述"></p> 
<p>点击OK后会弹出下一个要求基线校正的对话框，默认是event前的数据作为基线来进行校正，点击OK即可。</p> 
<p><img src="https://images2.imgbox.com/0e/8e/O2Gb1w3V_o.png" alt="baseline correction"></p> 
<h3><a id="_84"></a>插值坏导</h3> 
<p>对数据进行检查，如果发现某个通道的数据坏了，可以用插值的方式来进行校正，此处要校正的通道为FC3，选择插值的通道为它周围的四个电极点，F3,FC1,C3,FC5</p> 
<p>第一种方法是代码操作</p> 
<pre><code class="prism language-matlab">EEG.data(a,:,:) = mean(EEG.data([b c d],:,:)) ;
</code></pre> 
<p>其中a代表坏掉的电极点数值，b c d 代表要进行插值平均的电极点数值<br> 如果不确定通道数值是多少，可以通过Plot - channel locations - by name 来进行查看。</p> 
<p>画出通道图之后，可以通过单击通道名字来查看通道数值。<br> <img src="https://images2.imgbox.com/49/a5/D677G1Yu_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/fa/1c/2n5Gab8D_o.png" alt="在这里插入图片描述"></p> 
<p>所以这句代码为</p> 
<pre><code class="prism language-python">EEG<span class="token punctuation">.</span>data<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> mean<span class="token punctuation">(</span>EEG<span class="token punctuation">.</span>data<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">8</span> <span class="token number">18</span> <span class="token number">26</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre> 
<p>这句代码的意思是指，第17个通道的数值，用第8，18，26，16这四个通道数值的平均值来代替。</p> 
<p>第二种方法是面板操作，用eeglab的默认算法进行<br> <img src="https://images2.imgbox.com/1d/85/Va56Hk9O_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a8/e0/X4bC1AXA_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="ICA_112"></a>ICA</h3> 
<p>使用ICA算法剔除伪迹，此步操作耗时较长</p> 
<p><img src="https://images2.imgbox.com/8b/ec/bJPW5H4w_o.png" alt="run ICA"></p> 
<p>因为我们有一个坏通道的数据是用其他通道的数据生成的，相当于我们损失了一个有效通道数据，而ICA默认是在所有通道都是有效数据的情况下进行的，所以此处我们需要进行一些修改，在’extended’, 1后面加上’pca’, 59，中间用逗号和空格隔开，逗号要用英文输入法下的</p> 
<p><img src="https://images2.imgbox.com/c9/eb/a563RNia_o.png" alt="run ICA"></p> 
<p>点击确定之后会出现一个对话框，显示正在进行ICA计算，计算结束后该对话框会消失</p> 
<p><img src="https://images2.imgbox.com/25/97/NjMlBF01_o.png" alt="run ICA"></p> 
<p>在跑完ICA之后建议保存当前数据，在进行伪迹剔除操作。这样做可以保证在剔除不当的时候随时回到未剔除的状态下重新进行选择。<br> 此时会保存为eeglab的.set的格式文件</p> 
<p><img src="https://images2.imgbox.com/4a/60/aeStJ3tD_o.png" alt="在这里插入图片描述"></p> 
<p>在跑完ICA之后就可以用ICA进行伪迹剔除了<br> <img src="https://images2.imgbox.com/b2/1c/YxyLrP5p_o.png" alt="在这里插入图片描述"></p> 
<p>选择要画出的成分数，此处我们选择默认状态</p> 
<p><img src="https://images2.imgbox.com/64/ed/Bg7c3rjV_o.png" alt="plot ICA"></p> 
<p>eeglab提示我们一张画布只能画下35个图，剩下的会在第二张画布中画出，点击OK即可</p> 
<p><img src="https://images2.imgbox.com/b1/87/U72Fvqmk_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/82/56/7cNNXBWe_o.png" alt="在这里插入图片描述"><br> 此时我们可以对所有的ICA成分进行查看和标记，点击成分数字，会出现该成分的详细情况。如果觉得该成分代表伪迹成分，想要剔除的话，可以先将它标记起来。标记的方式是单机下方绿色的ACCEPT,单击之后会变成红色的REJECT</p> 
<p><img src="https://images2.imgbox.com/7f/59/tq3ixlXE_o.png" alt="在这里插入图片描述"></p> 
<p>这一步需要对每一个成分进行查看和判断，然后将想要剔除的成分先标记起来。ICA可以进行眼电伪迹，肌电伪迹，坏导伪迹以及心电伪迹等的辨识与剔除，但是此处我们只进行眼电伪迹的剔除，我们将第一个成分和第13个成分标记起来，标记了的成分数会变成红色。然后点OK。此时还没有进行剔除操作。</p> 
<p><img src="https://images2.imgbox.com/31/f0/ej9tgDsQ_o.png" alt="mark ICA"></p> 
<p>除了上面那种方式之外，还可以使用逐个成分画出的方式来查看和标记</p> 
<p><img src="https://images2.imgbox.com/84/c5/Y3Scq0vF_o.png" alt="plot ICA"></p> 
<p><img src="https://images2.imgbox.com/dc/73/wg87aWUm_o.png" alt="plot ICA"></p> 
<h3><a id="ICA_156"></a>剔除ICA成分</h3> 
<p><img src="https://images2.imgbox.com/71/ab/XdlmJruy_o.png" alt="remove ICA"></p> 
<p>eeglab默认两个框都是一样的信息，此时记得把第二个框的信息给清除掉</p> 
<p><img src="https://images2.imgbox.com/40/ce/jNqcAr2K_o.png" alt="remove ICA"></p> 
<p>在接下来的对话框里，我们可以对剔除了ICA成分和未剔除的数据进行比较</p> 
<p><img src="https://images2.imgbox.com/d5/61/ckutq84R_o.png" alt="check data"></p> 
<p>红色代表未剔除的数据，蓝色代表剔除后的数据，所有通道的ERP图如下<br> <img src="https://images2.imgbox.com/3d/e1/4etafnwz_o.png" alt="在这里插入图片描述"></p> 
<p>从红色框中的部分可以看到，我们还是很有效地剔除了眼动伪迹的,所有通道单个trial的图如下<br> <img src="https://images2.imgbox.com/92/f3/Dttoomi1_o.png" alt="在这里插入图片描述"></p> 
<p>检查确认无误后点击accept进行剔除操作</p> 
<h3><a id="_178"></a>剔除坏段</h3> 
<ol><li>绝对阈值法<br> 此处我们选择剔除掉超出±100μV的trial。</li></ol> 
<p><img src="https://images2.imgbox.com/78/03/VpFe7miU_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/31/86/EnyEG0mK_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_184"></a>目视检查法</h3> 
<p><img src="https://images2.imgbox.com/20/49/YGQ9d1Sr_o.png" alt="在这里插入图片描述"></p> 
<p>逐个trial进行查看，如果发现有伪迹过大的trial想要剔除的话，单击该trial，它会变成黄色。选择完所有trials后，点击下方的reject即可。此处选中的两个trials仅仅作为演示用。</p> 
<p><img src="https://images2.imgbox.com/25/06/7rvEth1d_o.png" alt="reject trials"></p> 
<h3><a id="_192"></a>保存数据</h3> 
<p>至此EEG数据的预处理就基本完成了，我们可以再次将这个数据保存起来，以供下一步操作。</p> 
<p>参考<br> <a href="https://mp.weixin.qq.com/s/SD8NDlql_TasexZBNIDBxw" rel="nofollow">手把手教你EEG脑电数据预处理-操作篇</a><br> 本文章由脑机学习者Rose笔记分享,QQ交流群：941473018<br> 更多分享，请关注公众号<br> <img src="https://images2.imgbox.com/62/7f/JoIik4At_o.jpg" alt=""></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4ee66695496aafd48d7215fad6ddf79d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">超实用的shell脚本--一键获取进程所有信息</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c5810456c6f8ac2b824ec4b210f6523a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">LeetCode JAVA 11. 盛最多水的容器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>