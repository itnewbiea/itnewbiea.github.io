<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>centos7 mysql源码安装_CentOS7下源码安装MySQL 8.x - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="centos7 mysql源码安装_CentOS7下源码安装MySQL 8.x" />
<meta property="og:description" content="会选择使用源码安装MySQL，想必对MySQL及其他的安装方式已经有了一定的了解，这里就不对周边信息进行过多赘述了，直接开始吧。
编译MySQL比较消耗内存，如果机器内存较小，可能会在编译期间出现内存不足的异常。若没有设置swap分区的可以设置swap分区来解决，否则只能扩容内存了：
[root@txy-server ~]# dd if=/dev/zero of=/swapfile bs=1k count=2048000
[root@txy-server ~]# mkswap /swapfile
[root@txy-server ~]# swapon /swapfile
1、安装编译时所需的依赖包
1.1、使用yum命令安装编译所依赖的包及工具：
[root@txy-server ~]# yum install -y cmake3 git gcc-c&#43;&#43; ncurses-devel perl-Data-Dumper boost boost-doc boost-devel bzip2 openssl-devel libtirpc-devel.x86_64
由于编译MySQL时对gcc的版本要求是5.3以上，所以我们需要先升级一下gcc的版本，因为yum安装目前最新版本只到4.8.5。
升级gcc版本的方式主要有两种，一种是下载源码包进行编译安装，一种是使用yum安装devtoolset包，目前devtoolset包里的gcc版本为5.3.1。
而源码安装的方式比较灵活可以选择任意版本，但非常耗时。这里两种方式都会介绍，可以自行视情况选择。
1.1.1、使用yum安装devtoolset包，命令如下：
[root@txy-server ~]# yum install -y centos-release-scl scl-utils-build
[root@txy-server ~]# yum install -y devtoolset-4-gcc.x86_64 devtoolset-4-gcc-c&#43;&#43;.x86_64 devtoolset-4-gcc-gdb-plugin.x86_64
1.1.2、创建软件链接，覆盖/usr/bin下的gcc相关命令，因为编译MySQL时默认会去/usr/bin目录下找gcc相关的命令：
[root@txy-server ~]# ln -sf /opt/rh/devtoolset-4/root/usr/bin/* /usr/bin/
1.1.3、最后验证一下gcc、cc、c&#43;&#43;等命令的版本是否为5.3.1：
[root@txy-server ~]# gcc -v
...
gcc version 5." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/1f0368b2014b8bad389138a11c6edd3e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-19T00:38:11+08:00" />
<meta property="article:modified_time" content="2021-01-19T00:38:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">centos7 mysql源码安装_CentOS7下源码安装MySQL 8.x</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>会选择使用源码安装MySQL，想必对MySQL及其他的安装方式已经有了一定的了解，这里就不对周边信息进行过多赘述了，直接开始吧。</p> 
 <p>编译MySQL比较消耗内存，如果机器内存较小，可能会在编译期间出现内存不足的异常。若没有设置swap分区的可以设置swap分区来解决，否则只能扩容内存了：</p> 
 <p>[root@txy-server ~]# dd if=/dev/zero of=/swapfile bs=1k count=2048000</p> 
 <p>[root@txy-server ~]# mkswap /swapfile</p> 
 <p>[root@txy-server ~]# swapon /swapfile</p> 
 <p>1、安装编译时所需的依赖包</p> 
 <p>1.1、使用yum命令安装编译所依赖的包及工具：</p> 
 <p>[root@txy-server ~]# yum install -y cmake3 git gcc-c++ ncurses-devel perl-Data-Dumper boost boost-doc boost-devel bzip2 openssl-devel libtirpc-devel.x86_64</p> 
 <p>由于编译MySQL时对gcc的版本要求是5.3以上，所以我们需要先升级一下gcc的版本，因为yum安装目前最新版本只到4.8.5。</p> 
 <p>升级gcc版本的方式主要有两种，一种是下载源码包进行编译安装，一种是使用yum安装devtoolset包，目前devtoolset包里的gcc版本为5.3.1。</p> 
 <p>而源码安装的方式比较灵活可以选择任意版本，但非常耗时。这里两种方式都会介绍，可以自行视情况选择。</p> 
 <p>1.1.1、使用yum安装devtoolset包，命令如下：</p> 
 <p>[root@txy-server ~]# yum install -y centos-release-scl scl-utils-build</p> 
 <p>[root@txy-server ~]# yum install -y devtoolset-4-gcc.x86_64 devtoolset-4-gcc-c++.x86_64 devtoolset-4-gcc-gdb-plugin.x86_64</p> 
 <p>1.1.2、创建软件链接，覆盖/usr/bin下的gcc相关命令，因为编译MySQL时默认会去/usr/bin目录下找gcc相关的命令：</p> 
 <p>[root@txy-server ~]# ln -sf /opt/rh/devtoolset-4/root/usr/bin/* /usr/bin/</p> 
 <p>1.1.3、最后验证一下gcc、cc、c++等命令的版本是否为5.3.1：</p> 
 <p>[root@txy-server ~]# gcc -v</p> 
 <p>...</p> 
 <p>gcc version 5.3.1 20160406 (Red Hat 5.3.1-6) (GCC)</p> 
 <p>[root@txy-server ~]# cc -v</p> 
 <p>...</p> 
 <p>gcc version 5.3.1 20160406 (Red Hat 5.3.1-6) (GCC)</p> 
 <p>[root@txy-server ~]# c++ -v</p> 
 <p>...</p> 
 <p>gcc version 5.3.1 20160406 (Red Hat 5.3.1-6) (GCC)</p> 
 <p>Tips：建议使用这种方式进行安装，比较简单不容易踩坑</p> 
 <p>1.2.1、以下是源码安装的方式，首先下载GCC源码安装包并解压缩：</p> 
 <p>[root@txy-server ~]# cd /usr/local/src</p> 
 <p>[root@txy-server /usr/local/src]# wget http://ftp.gnu.org/gnu/gcc/gcc-9.1.0/gcc-9.1.0.tar.gz</p> 
 <p>[root@txy-server /usr/local/src]# tar -xzvf gcc-9.1.0.tar.gz</p> 
 <p>1.2.2、进入解压后的目录，运行download_prerequisites脚本，该脚本会自动下载编译时所需要的依赖文件和库：</p> 
 <p>[root@txy-server /usr/local/src]# cd gcc-9.1.0</p> 
 <p>[root@txy-server /usr/local/src/gcc-9.1.0]# ./contrib/download_prerequisites</p> 
 <p>1.2.3、建立输出目录，将所有的中间文件都放到该目录下：</p> 
 <p>[root@txy-server /usr/local/src/gcc-9.1.0]# mkdir gcc-build-9.1.0</p> 
 <p>1.2.4、进入新建的目录，并完成编译配置：</p> 
 <p>[root@txy-server /usr/local/src/gcc-9.1.0]# cd gcc-build-9.1.0</p> 
 <p>[root@txy-server /usr/local/src/gcc-9.1.0/gcc-build-9.1.0]# ../configure -enable-checking=release -enable-languages=c,c++ -disable-multilib</p> 
 <p>参数说明：</p> 
 <p>–enable-languages：让gcc支持哪些语言</p> 
 <p>–disable-multilib：不生成编译为其他平台可执行代码的交叉编译器</p> 
 <p>–disable-checking：生成的编译器在编译过程中不做额外检查，也可以使用–enable-checking=xxx来增加一些检查</p> 
 <p>1.2.5、接着就可以进行编译安装了：</p> 
 <p>[root@txy-server /usr/local/src/gcc-9.1.0/gcc-build-9.1.0]# make &amp;&amp; make install</p> 
 <p>Tips：这一步耗时会比较久，大概1-2个小时</p> 
 <p>1.2.6、创建软件链接，覆盖/usr/bin下的gcc相关命令，因为编译MySQL时默认会去/usr/bin目录下找gcc相关的命令：</p> 
 <p>[root@txy-server ~]# ln -sf /usr/local/bin/* /usr/bin/</p> 
 <p>1.2.7、最后验证一下gcc版本是否为9.1.0，如下代表安装成功：</p> 
 <p>[root@txy-server ~]# gcc -v</p> 
 <p>Using built-in specs.</p> 
 <p>COLLECT_GCC=gcc</p> 
 <p>COLLECT_LTO_WRAPPER=/usr/local/libexec/gcc/x86_64-pc-linux-gnu/9.1.0/lto-wrapper</p> 
 <p>Target: x86_64-pc-linux-gnu</p> 
 <p>Configured with: ../configure -enable-checking=release -enable-languages=c,c++ -disable-multilib</p> 
 <p>Thread model: posix</p> 
 <p>gcc version 9.1.0 (GCC)</p> 
 <p>[root@txy-server ~]#</p> 
 <p>2、下载MySQL源码包解压并编译安装</p> 
 <p>2.1、进入MySQL官网下载地址：</p> 
 <p>2.2、复制源码包的下载链接：</p> 
 <p align="center"><img src="https://images2.imgbox.com/9b/b5/7nX1Op4h_o.png" alt="f0aadca3cd7f7b86f7faf1d1202aebe6.png"></p> 
 <p>2.3、到Linux上下载并解压源码包：</p> 
 <p>[root@txy-server ~]# cd /usr/local/src</p> 
 <p>[root@txy-server /usr/local/src]# wget https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-boost-8.0.18.tar.gz</p> 
 <p>[root@txy-server /usr/local/src]# tar -zxvf mysql-boost-8.0.18.tar.gz</p> 
 <p>2.4、进入解压后的目录，参照如下命令步骤完成编译安装：</p> 
 <p># 创建数据文件存放目录</p> 
 <p>[root@txy-server /usr/local/src]# mkdir -p /data/mysql</p> 
 <p>[root@txy-server /usr/local/src]# cd mysql-8.0.18/</p> 
 <p># 新建目录，存放编译产生的中间文件。因为不允许在源码目录下进行编译</p> 
 <p>[root@txy-server /usr/local/src/mysql-8.0.18]# mkdir builder</p> 
 <p>[root@txy-server /usr/local/src/mysql-8.0.18]# cd builder/</p> 
 <p>[root@txy-server /usr/local/src/mysql-8.0.18/builder]# cmake3 ../ -DCMAKE_INSTALL_PREFIX=/usr/local/mysql -DMYSQL_DATADIR=/data/mysql -DSYSCONFDIR=/etc -DMYSQL_USER=mysql -DWITH_MYISAM_STORAGE_ENGINE=1 -DWITH_INNOBASE_STORAGE_ENGINE=1 -DMYSQL_UNIX_ADDR=/tmp/mysql.sock -DMYSQL_TCP_PORT=3306 -DEXTRA_CHARSETS=all -DDEFAULT_CHARSET=utf8mb4 -DDEFAULT_COLLATION=utf8mb4_general_ci -DWITH_DEBUG=0 -DMYSQL_MAINTAINER_MODE=0 -DWITH_SYSTEMD=1 -DDOWNLOAD_BOOST=1 -DWITH_BOOST=../boost</p> 
 <p>[root@txy-server /usr/local/src/mysql-8.0.18/builder]# make &amp;&amp; make install</p> 
 <p>Tips：编译安装会比较耗时，大概1-2个小时</p> 
 <p>cmake3命令所使用的参数说明：</p> 
 <p>-DCMAKE_INSTALL_PREFIX=/usr/local/mysql：MySQL安装的根目录</p> 
 <p>-DMYSQL_DATADIR=/data/mysql：数据文件所存放的目录</p> 
 <p>-DSYSCONFDIR=/etc ：MySQL配置文件所在目录</p> 
 <p>-DMYSQL_USER=mysql：MySQL服务的用户名</p> 
 <p>-DWITH_MYISAM_STORAGE_ENGINE=1：安装MyISAM引擎</p> 
 <p>-DWITH_INNOBASE_STORAGE_ENGINE=1：安装InnoDB引擎</p> 
 <p>-DWITH_ARCHIVE_STORAGE_ENGINE=1：安装Archive引擎</p> 
 <p>-DWITH_MEMORY_STORAGE_ENGINE=1：安装Memory引擎</p> 
 <p>-DWITH_FEDERATED_STORAGE_ENGINE=1：安装Federated引擎</p> 
 <p>-DWITH_PARTITION_STORAGE_ENGINE=1：安装Partition引擎</p> 
 <p>-DWITH_READLINE=1：MySQL的readline library</p> 
 <p>-DMYSQL_UNIX_ADDR=/tmp/mysql.sock：sock文件的路径</p> 
 <p>-DMYSQL_TCP_PORT=3306 ：MySQL的监听端口</p> 
 <p>-DENABLED_LOCAL_INFILE=1：启用加载本地数据</p> 
 <p>-DENABLE_DOWNLOADS=1：编译时允许自主下载相关文件</p> 
 <p>-DEXTRA_CHARSETS=all ：使MySQL支持所有的扩展字符</p> 
 <p>-DDEFAULT_CHARSET=utf8mb4：设置默认字符集为utf8mb4</p> 
 <p>-DDEFAULT_COLLATION=utf8mb4_general_ci：设置默认字符校对</p> 
 <p>-DWITH_DEBUG=0：禁用调试模式</p> 
 <p>-DMYSQL_MAINTAINER_MODE=0：是否启用mysql维护器特定的开发环境</p> 
 <p>-DDOWNLOAD_BOOST=1：允许在线更新boost库</p> 
 <p>-DWITH_BOOST=../boost：指定boost安装路径</p> 
 <p>关于cmake3所支持的参数可以到官网文档进行查询：</p> 
 <p>2.5、编译安装完成后，创建mysql用户及更改相应目录的属主：</p> 
 <p>[root@txy-server ~]# groupadd mysql</p> 
 <p>[root@txy-server ~]# useradd -M -g mysql -s /sbin/nologin mysql</p> 
 <p>[root@txy-server ~]# chown -R mysql:mysql /usr/local/mysql/</p> 
 <p>[root@txy-server ~]# chown -R mysql:mysql /data/mysql/</p> 
 <p>2.6、编辑配置文件：</p> 
 <p>[root@txy-server ~]# vim /etc/my.cnf</p> 
 <p>[mysqld]</p> 
 <p>basedir=/usr/local/mysql</p> 
 <p>datadir=/data/mysql</p> 
 <p>socket=/tmp/mysql.sock</p> 
 <p>[mysqld_safe]</p> 
 <p>log-error=/var/log/mysqld/mysqld.log</p> 
 <p>pid-file=/var/run/mysqld/mysql.pid</p> 
 <p>2.7、创建日志文件存放的目录和pid文件存放的目录，并赋权给mysql用户：</p> 
 <p>[root@txy-server ~]# mkdir -p /var/log/mysqld /var/run/mysqld</p> 
 <p>[root@txy-server ~]# chown -R mysql:mysql /var/log/mysqld</p> 
 <p>[root@txy-server ~]# chown -R mysql:mysql /var/run/mysqld</p> 
 <p>2.8、配置环境变量，方便使用MySQL的命令：</p> 
 <p>[root@txy-server ~]# vim /etc/profile</p> 
 <p>export MYSQL_HOME=/usr/local/mysql</p> 
 <p>export PATH=$PATH:$MYSQL_HOME/bin</p> 
 <p>[root@txy-server ~]# source /etc/profile</p> 
 <p>[root@txy-server ~]# mysql --version # 验证配置是否成功</p> 
 <p>mysql Ver 8.0.18 for Linux on x86_64 (Source distribution)</p> 
 <p>[root@txy-server ~]#</p> 
 <p>2.9、执行如下命令初始化数据库：</p> 
 <p>[root@txy-server ~]# mysqld --initialize --user=mysql --basedir=/usr/local/mysql/ --datadir=/data/mysql</p> 
 <p>初始化成功后会生成root账户的默认密码，如下图所示：</p> 
 <p align="center"><img src="https://images2.imgbox.com/57/ef/vQIOPbs9_o.png" alt="908bad5a887be35d96afaae66242a6d4.png"></p> 
 <p>将该密码复制并保存，因为后面需要使用该密码登录到MySQL中修改密码</p> 
 <p>2.10、将MySQL生成的启动文件复制到/usr/lib/systemd/system/目录下：</p> 
 <p>[root@txy-server ~]# cp /usr/local/src/mysql-8.0.18/builder/scripts/mysqld.service /usr/lib/systemd/system/</p> 
 <p>[root@txy-server ~]# chown 775 /usr/lib/systemd/system/mysqld.service</p> 
 <p>2.11、使用systemctl命令启动MySQL服务：</p> 
 <p>[root@txy-server ~]# systemctl start mysqld</p> 
 <p>2.12、查看3306端口是否已正常监听：</p> 
 <p>[root@txy-server ~]# netstat -lntp |grep 3306</p> 
 <p>tcp6 0 0 :::33060 :::* LISTEN 27363/mysqld</p> 
 <p>tcp6 0 0 :::3306 :::* LISTEN 27363/mysqld</p> 
 <p>[root@txy-server ~]#</p> 
 <p>2.13、使用默认密码登录MySQL，并重置密码及开放远程登录：</p> 
 <p>[root@txy-server ~]# mysql -uroot -pmXyfy/g8\)aus</p> 
 <p>mysql&gt; ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'your_password'; # 重置密码</p> 
 <p>mysql&gt; use mysql;</p> 
 <p>mysql&gt; update user set host ='%' where user='root'; # 开放远程登录</p> 
 <p>mysql&gt; FLUSH PRIVILEGES; # 刷新修改</p> 
 <p>2.14、使用可视化工具进行远程连接，测试下是否能正常对MySQL进行访问：</p> 
 <p align="center"><img src="https://images2.imgbox.com/65/ef/v2W9VGTk_o.png" alt="0fb2484a65b04882d594d0f60669e603.png"></p> 
 <p>end</p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/37060e0be2420f19625ddcd271cce244/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mysql根据字段长度查询_SQL语句如何查询某一字符串字段长度等于某个值的所有记录...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d5779662371e473eff9ed5bb6e2e4489/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">设置mysql远程连接权限_mysql远程连接权限设置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>