<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[手机Linux] 四，Linux修改yum源为阿里源，寻找systemctl的替代品 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[手机Linux] 四，Linux修改yum源为阿里源，寻找systemctl的替代品" />
<meta property="og:description" content="背景：
我们直接用yum install 下载安装包，因为用的是国外的源，下载速度难免会受限，我们可以改为用阿里源，当然你不改也是没问题的。还有因为在手机安装的linux是安装在一个容器里的，当我们使用systemctl命令时，无法启用服务，提示：Running in chroot, ignoring request. 百度了很多，找到有可以替代的方法。
原料：
还是那部萌萌的小米6手机
一，禁用Yum插件 用vim编辑 /etc/yum.conf 文件，找到 plugins=1 这一行改为0即可
vim /etc/yum.conf 二，替换yum源为阿里源 先用cat /etc/redhat-release 命令查看自己的系统版本
cat /etc/redhat-release 用vim编辑文件：/etc/yum.repos.d/CentOS-Base.repo
编辑前先备份，用cp命令复制一份
cp /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bk_20220508 将下面的 7.9.2009 换成你自己当前系统的版本号
适用于aarch64构架的阿里云镜像源配置文件
用 vim /etc/yum.repos.d/CentOS-Base.repo 编辑文件
可以用命令ggdG 快速清空当前文件，在命令模式下,首先执行 gg 这里是跳至文件首行 再执行: dG 也就是直接按 ggdG 这样就清空了整个文件，然后用下面的内容粘贴替换，:wq保存退出。
# CentOS-Base.repo # # The mirror system uses the connecting IP address of the client and the # update status of each mirror to pick mirrors that are updated to and # geographically close to the client." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8f96cfa4e6e6935d63b7a9c19bacd810/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-15T23:16:23+08:00" />
<meta property="article:modified_time" content="2022-05-15T23:16:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[手机Linux] 四，Linux修改yum源为阿里源，寻找systemctl的替代品</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>背景：</strong></p> 
<p>我们直接用yum install 下载安装包，因为用的是国外的源，下载速度难免会受限，我们可以改为用阿里源，当然你不改也是没问题的。还有因为在手机安装的linux是安装在一个容器里的，当我们使用<strong>systemctl</strong>命令时，无法启用服务，提示：Running in chroot, ignoring request. 百度了很多，找到有可以替代的方法。</p> 
<p><strong>原料：</strong></p> 
<p>还是那部萌萌的小米6手机</p> 
<h2>一，禁用<a href="https://so.csdn.net/so/search?q=Yum&amp;spm=1001.2101.3001.7020" title="Yum">Yum</a>插件</h2> 
<p>用vim编辑<strong> /etc/yum.conf</strong> 文件，找到 <span style="color:#fe2c24;">plugins=1</span> 这一行改为0即可</p> 
<pre><code class="language-bash">vim /etc/yum.conf </code></pre> 
<p><img alt="" height="359" src="https://images2.imgbox.com/45/78/Rghfr9s4_o.png" width="671"></p> 
<h2> 二，替换yum源为阿里源</h2> 
<p>先用cat /etc/redhat-release 命令查看自己的系统版本</p> 
<pre><code class="language-bash">cat /etc/redhat-release</code></pre> 
<p><img alt="" height="83" src="https://images2.imgbox.com/52/69/WnTE2bV6_o.png" width="498"></p> 
<p> 用vim编辑文件：<strong>/etc/yum.repos.d/CentOS-Base.repo</strong></p> 
<p>编辑前先备份，用cp命令复制一份</p> 
<pre><code class="language-bash">cp /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bk_20220508</code></pre> 
<p>将下面的 7.9.2009 换成你自己当前系统的<strong>版本号</strong><br> 适用于aarch64构架的阿里云镜像源配置文件</p> 
<p>用 vim <strong>/etc/yum.repos.d/CentOS-Base.repo </strong>编辑文件</p> 
<p>可以用命令<strong>ggdG</strong> 快速清空当前文件，在命令模式下,首先执行 gg 这里是跳至文件首行 再执行: dG 也就是直接按 ggdG 这样就清空了整个文件，然后用下面的内容粘贴替换，:wq保存退出。</p> 
<pre><code class="language-bash"># CentOS-Base.repo
#
# The mirror system uses the connecting IP address of the client and the
# update status of each mirror to pick mirrors that are updated to and
# geographically close to the client.  You should use this for CentOS updates
# unless you are manually picking other mirrors.
#
# If the mirrorlist= does not work for you, as a fall back you can try the 
# remarked out baseurl= line instead.
#
#

[base]
name=CentOS-7.9.2009 - Base - mirrors.aliyun.com
failovermethod=priority
baseurl=http://mirrors.aliyun.com/centos-altarch/7.9.2009/os/aarch64/
        http://mirrors.aliyuncs.com/centos-altarch/7.9.2009/os/aarch64/
        http://mirrors.cloud.aliyuncs.com/centos-altarch/7.9.2009/os/aarch64/
gpgcheck=1
gpgkey=http://mirrors.aliyun.com/centos-altarch/RPM-GPG-KEY-CentOS-7
 
#released updates 
[updates]
name=CentOS-7.9.2009 - Updates - mirrors.aliyun.com
failovermethod=priority
baseurl=http://mirrors.aliyun.com/centos-altarch/7.9.2009/updates/aarch64/
        http://mirrors.aliyuncs.com/centos-altarch/7.9.2009/updates/aarch64/
        http://mirrors.cloud.aliyuncs.com/centos-altarch/7.9.2009/updates/aarch64/
gpgcheck=1
gpgkey=http://mirrors.aliyun.com/centos-altarch/RPM-GPG-KEY-CentOS-7
 
#additional packages that may be useful
[extras]
name=CentOS-7.9.2009 - Extras - mirrors.aliyun.com
failovermethod=priority
baseurl=http://mirrors.aliyun.com/centos-altarch/7.9.2009/extras/aarch64/
        http://mirrors.aliyuncs.com/centos-altarch/7.9.2009/extras/aarch64/
        http://mirrors.cloud.aliyuncs.com/centos-altarch/7.9.2009/extras/aarch64/
gpgcheck=1
gpgkey=http://mirrors.aliyun.com/centos-altarch/RPM-GPG-KEY-CentOS-7
 
#additional packages that extend functionality of existing packages
[centosplus]
name=CentOS-7.9.2009 - Plus - mirrors.aliyun.com
failovermethod=priority
baseurl=http://mirrors.aliyun.com/centos-altarch/7.9.2009/centosplus/aarch64/
        http://mirrors.aliyuncs.com/centos-altarch/7.9.2009/centosplus/aarch64/
        http://mirrors.cloud.aliyuncs.com/centos-altarch/7.9.2009/centosplus/aarch64/
gpgcheck=1
enabled=0
gpgkey=http://mirrors.aliyun.com/centos-altarch/RPM-GPG-KEY-CentOS-7
 
#contrib - packages by Centos Users
[contrib]
name=CentOS-7.9.2009 - Contrib - mirrors.aliyun.com
failovermethod=priority
baseurl=http://mirrors.aliyun.com/centos-altarch/7.9.2009/contrib/aarch64/
        http://mirrors.aliyuncs.com/centos-altarch/7.9.2009/contrib/aarch64/
        http://mirrors.cloud.aliyuncs.com/centos-altarch/7.9.2009/contrib/aarch64/
gpgcheck=1
enabled=0
gpgkey=http://mirrors.aliyun.com/centos-altarch/RPM-GPG-KEY-CentOS-7
</code></pre> 
<p>更新下载新的rpm秘钥: 下面的7.9.2009替换成自己的版本号<br> 下载地址: <strong>https://mirrors.aliyun.com/centos-altarch/7.9.2009/os/aarch64/</strong><br> 下载 需要的两个文件：<br> RPM-GPG-KEY-CentOS-7 <br> RPM-GPG-KEY-CentOS-Testing-7</p> 
<p><img alt="" height="562" src="https://images2.imgbox.com/d8/36/lJR13TDz_o.png" width="1200"><br> 然后在这个<span style="color:#fe2c24;"><strong>/etc/pki/rpm-gpg/</strong></span>目录下把原来的替换掉，替换之前也要有做备份的习惯</p> 
<p><img alt="" height="518" src="https://images2.imgbox.com/e8/db/FDnQl8FR_o.png" width="1200"><br> 然后执行更新命令</p> 
<p>yum makecache 下载需要点时间，主要看你网络</p> 
<pre><code>yum makecache
rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7-aarch64
rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7</code></pre> 
<p><img alt="" height="718" src="https://images2.imgbox.com/a9/5a/5xsGxAC3_o.png" width="1200"></p> 
<h2> 三，添加环境变量</h2> 
<p>这里默认/usr/local/bin并不在系统变量中，我们需要在/etc/bashrc中添加它</p> 
<pre><code class="language-bash">echo export PATH=$PATH:/usr/local/bin &gt;&gt; /etc/bashrc</code></pre> 
<h2>四，寻找systemctl的替代品</h2> 
<p>执行<strong>systemctl </strong>start cpolar命令时，无法启动服务，提示以下信息。</p> 
<p><img alt="" height="93" src="https://images2.imgbox.com/42/30/7sBQ7QIa_o.png" width="482"></p> 
<p> 可以用以下方法解决：</p> 
<pre><code># 下载包并解压
wget https://github.com/smaknsk/servicectl/archive/1.0.tar.gz

# 解压指定到路径 
tar -xf 1.0.tar.gz -C /usr/local/lib/

# 软链接
ln -s /usr/local/lib/servicectl-1.0/servicectl /usr/local/bin/servicectl
ln -s /usr/local/lib/servicectl-1.0/serviced /usr/local/bin/serviced
</code></pre> 
<p><img alt="" height="378" src="https://images2.imgbox.com/97/ba/rsjRSP8p_o.png" width="675"></p> 
<p><strong>使用方法：</strong><br><strong>servicectl:</strong><br> sudo servicectl [action] [service]<br> ‎此命令仅执行文件 /usr/lib/systemd/system/${service}.service中的${action}， 如果通过的操作启用或禁用，则 servicectl将在 ${service}.service上创建或删除symlink以供使用服务。‎</p> 
<p>参数:<br> action  - 可以是 {start, stop, restart, reload, enable, disable}<br> service - 在/usr/lib/systemd/system/文件夹中的文件</p> 
<p>例如：</p> 
<pre><code class="language-bash"># inside chroot
sudo servicectl start mariadb</code></pre> 
<p><br><strong>serviced:</strong><br> sudo serviced [action]<br> ‎此命令执行 ${action} 为所有启用服务。‎</p> 
<p>参数:<br> action -默认是start，也可以是： {start, stop, restart, reload, disable}</p> 
<p>例如：</p> 
<pre><code class="language-bash"># outside chroot: 
# init startup and run all enabled daemons
sudo chroot /path/to/chroot serviced
</code></pre> 
<p></p> 
<p>上篇：<a href="https://blog.csdn.net/tyler880/article/details/124645739?spm=1001.2014.3001.5502" title="[手机Linux] 三,安卓手机Linux内网穿透(cpolar)，实现远程连接_虾稿的博客-CSDN博客">[手机Linux] 三,安卓手机Linux内网穿透(cpolar)，实现远程连接_虾稿的博客-CSDN博客</a></p> 
<p>下篇：<a href="https://blog.csdn.net/tyler880/article/details/124677084" title="[手机Linux] 五，打造属于自己的私有网盘(Cloudreve)，跟百度网盘说拜拜_虾稿的博客-CSDN博客">[手机Linux] 五，打造属于自己的私有网盘(Cloudreve)，跟百度网盘说拜拜_虾稿的博客-CSDN博客</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ed2a790a04774954e68776baf9b0aeb2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">关于Vue报错“Component name “School“ should always be multi-word”的解决方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d634f66ee5c9920b8b7cf0561b0a2993/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">嵌入式常用的开源库</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>