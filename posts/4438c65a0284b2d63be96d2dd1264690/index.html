<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CAS集群部署基于Redis缓存配置详细方案 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CAS集群部署基于Redis缓存配置详细方案" />
<meta property="og:description" content="CAS （ Central Authentication Service ） 是 Yale 大学发起的一个企业级的、开源的项目，旨在为 Web 应用系统提供一种可靠的单点登录解决方法（属于 Web SSO ）。CAS集群部署首先需要考虑的是ticket票据统一存储的问题，以便于达到每个节点访问的一致性，官方虽然提供了基于memcached方式，但未提供基于Redis方式，项目中需要使用redis，因此仿照memcached方式，新建cas-server-integration-redis工程，来完成工作需求，下面本站素文宅www.yoodb.com就分享一下CAS集群部署基于Redis缓存配置，仅供大家参考学习。
主要特性，具体如下：
1）开源的、多协议的 SSO 解决方案； Protocols ： Custom Protocol 、 CAS 、 OAuth 、 OpenID 、 RESTful API 、 SAML1.1 、 SAML2.0 等。
2）支持多种认证机制： Active Directory 、 JAAS 、 JDBC 、 LDAP 、 X.509 Certificates 等；
3）安全策略：使用票据（ Ticket ）来实现支持的认证协议；
4）支持授权：可以决定哪些服务可以请求和验证服务票据（ Service Ticket ）；
5） 提 供高可用性：通过把认证过的状态数据存储在 TicketRegistry 组件中，这些组件有很多支持分布式环境的实现， 如： BerkleyDB 、 Default 、 EhcacheTicketRegistry 、 JDBCTicketRegistry 、 JBOSS TreeCache 、 JpaTicketRegistry 、 MemcacheTicketRegistry 等；" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/4438c65a0284b2d63be96d2dd1264690/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-12-01T12:41:32+08:00" />
<meta property="article:modified_time" content="2016-12-01T12:41:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CAS集群部署基于Redis缓存配置详细方案</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>        CAS （ Central Authentication Service ） 是 Yale 大学发起的一个企业级的、开源的项目，旨在为 Web 应用系统提供一种可靠的单点登录解决方法（属于 Web SSO ）。CAS集群部署首先需要考虑的是ticket票据统一存储的问题，以便于达到每个节点访问的一致性，官方虽然提供了基于memcached方式，但未提供基于Redis方式，项目中需要使用redis，因此仿照memcached方式，新建cas-server-integration-redis工程，来完成工作需求，下面本站素文宅www.yoodb.com就分享一下CAS集群部署基于Redis缓存配置，仅供大家参考学习。</p> 
<p><br> </p> 
<p>主要特性，具体如下：</p> 
<p>1）开源的、多协议的 SSO 解决方案； Protocols ： Custom Protocol 、 CAS 、 OAuth 、 OpenID 、 RESTful API 、 SAML1.1 、 SAML2.0 等。</p> 
<p>2）支持多种认证机制： Active Directory 、 JAAS 、 JDBC 、 LDAP 、 X.509 Certificates 等；</p> 
<p>3）安全策略：使用票据（ Ticket ）来实现支持的认证协议；</p> 
<p>4）支持授权：可以决定哪些服务可以请求和验证服务票据（ Service Ticket ）；</p> 
<p>5） 提 供高可用性：通过把认证过的状态数据存储在 TicketRegistry 组件中，这些组件有很多支持分布式环境的实现， 如： BerkleyDB 、 Default 、 EhcacheTicketRegistry 、 JDBCTicketRegistry 、 JBOSS TreeCache 、 JpaTicketRegistry 、 MemcacheTicketRegistry 等；</p> 
<p>6）支持多种客户端： Java 、 .Net 、 PHP 、 Perl 、 Apache, uPortal 等。</p> 
<p><br> </p> 
<p>1、构建cas-server-integration-redis工程</p> 
<p>仿照cas-server-integration-memcached工程建立cas-server-integration-redis工程，pom.xml中添加redis的java客户端jar包，去掉memcached中需要的jar，最后依赖包如下：</p> 
<table class="syntaxhighlighter  bash  " border="0" cellpadding="0" cellspacing="0"><tbody><tr></tr></tbody></table> 
<table class="syntaxhighlighter  bash  " border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"> 
    <div class="container"> 
     <div class="line number1 index0 alt2"> 
      <code class="bash plain">&lt;!-- ~ Licensed to Jasig under one or </code> 
      <code class="bash functions">more</code>  
      <code class="bash plain">contributor license ~ agreements. </code> 
     </div> 
     <div class="line number2 index1 alt1"> 
      <code class="bash plain">See the NOTICE </code> 
      <code class="bash functions">file</code>  
      <code class="bash plain">distributed with this work ~ </code> 
      <code class="bash keyword">for</code>  
      <code class="bash plain">additional information </code> 
     </div> 
     <div class="line number3 index2 alt2"> 
      <code class="bash plain">regarding copyright ownership. ~ Jasig licenses this </code> 
      <code class="bash functions">file</code>  
      <code class="bash plain">to you under the </code> 
     </div> 
     <div class="line number4 index3 alt1"> 
      <code class="bash plain">Apache License, ~ Version 2.0 (the </code> 
      <code class="bash string">"License"</code> 
      <code class="bash plain">); you may not use this </code> 
      <code class="bash functions">file</code>  
     </div> 
     <div class="line number5 index4 alt2"> 
      <code class="bash plain">~ except </code> 
      <code class="bash keyword">in</code>  
      <code class="bash plain">compliance with the License. You may obtain a ~ copy of the License </code> 
     </div> 
     <div class="line number6 index5 alt1"> 
      <code class="bash plain">at the following location: ~ ~ http:</code> 
      <code class="bash plain">//www</code> 
      <code class="bash plain">.apache.org</code> 
      <code class="bash plain">/licenses/LICENSE-2</code> 
      <code class="bash plain">.0 </code> 
     </div> 
     <div class="line number7 index6 alt2"> 
      <code class="bash plain">~ ~ Unless required by applicable law or agreed to </code> 
      <code class="bash keyword">in</code>  
      <code class="bash plain">writing, ~ software </code> 
     </div> 
     <div class="line number8 index7 alt1"> 
      <code class="bash plain">distributed under the License is distributed on an ~ </code> 
      <code class="bash string">"AS IS"</code>  
      <code class="bash plain">BASIS, WITHOUT </code> 
     </div> 
     <div class="line number9 index8 alt2"> 
      <code class="bash plain">WARRANTIES OR CONDITIONS OF ANY ~ KIND, either express or implied. See the </code> 
     </div> 
     <div class="line number10 index9 alt1"> 
      <code class="bash plain">License </code> 
      <code class="bash keyword">for</code>  
      <code class="bash plain">the ~ specific language governing permissions and limitations </code> 
     </div> 
     <div class="line number11 index10 alt2"> 
      <code class="bash plain">~ under the License. --&gt;</code> 
     </div> 
     <div class="line number12 index11 alt1"> 
      <code class="bash plain">&lt;project xmlns=</code> 
      <code class="bash string">"http://maven.apache.org/POM/4.0.0"</code>  
      <code class="bash plain">xmlns:xsi=</code> 
      <code class="bash string">"http://www.w3.org/2001/XMLSchema-instance"</code> 
     </div> 
     <div class="line number13 index12 alt2"> 
      <code class="bash plain">xsi:schemaLocation=</code> 
      <code class="bash string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number14 index13 alt1"> 
      <code class="bash plain">&lt;parent&gt;</code> 
     </div> 
     <div class="line number15 index14 alt2"> 
      <code class="bash plain">&lt;groupId&gt;org.jasig.cas&lt;</code> 
      <code class="bash plain">/groupId</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number16 index15 alt1"> 
      <code class="bash plain">&lt;artifactId&gt;cas-server&lt;</code> 
      <code class="bash plain">/artifactId</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number17 index16 alt2"> 
      <code class="bash plain">&lt;version&gt;3.5.2&lt;</code> 
      <code class="bash plain">/version</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number18 index17 alt1"> 
      <code class="bash plain">&lt;</code> 
      <code class="bash plain">/parent</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number19 index18 alt2"> 
      <code class="bash plain">&lt;modelVersion&gt;4.0.0&lt;</code> 
      <code class="bash plain">/modelVersion</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number20 index19 alt1"> 
      <code class="bash plain">&lt;groupId&gt;org.jasig.cas&lt;</code> 
      <code class="bash plain">/groupId</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number21 index20 alt2"> 
      <code class="bash plain">&lt;artifactId&gt;cas-server-integration-redis&lt;</code> 
      <code class="bash plain">/artifactId</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number22 index21 alt1"> 
      <code class="bash plain">&lt;packaging&gt;jar&lt;</code> 
      <code class="bash plain">/packaging</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number23 index22 alt2"> 
      <code class="bash plain">&lt;name&gt;Jasig CAS Redis Integration&lt;</code> 
      <code class="bash plain">/name</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number24 index23 alt1"> 
      <code class="bash plain">&lt;dependencies&gt;</code> 
     </div> 
     <div class="line number25 index24 alt2"> 
      <code class="bash plain">&lt;dependency&gt;</code> 
     </div> 
     <div class="line number26 index25 alt1"> 
      <code class="bash plain">&lt;groupId&gt;org.jasig.cas&lt;</code> 
      <code class="bash plain">/groupId</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number27 index26 alt2"> 
      <code class="bash plain">&lt;artifactId&gt;cas-server-core&lt;</code> 
      <code class="bash plain">/artifactId</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number28 index27 alt1"> 
      <code class="bash plain">&lt;version&gt;${project.version}&lt;</code> 
      <code class="bash plain">/version</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number29 index28 alt2"> 
      <code class="bash plain">&lt;</code> 
      <code class="bash plain">/dependency</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number30 index29 alt1"> 
      <code class="bash plain">&lt;dependency&gt;</code> 
     </div> 
     <div class="line number31 index30 alt2"> 
      <code class="bash plain">&lt;groupId&gt;redis.clients&lt;</code> 
      <code class="bash plain">/groupId</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number32 index31 alt1"> 
      <code class="bash plain">&lt;artifactId&gt;jedis&lt;</code> 
      <code class="bash plain">/artifactId</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number33 index32 alt2"> 
      <code class="bash plain">&lt;version&gt;2.8.1&lt;</code> 
      <code class="bash plain">/version</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number34 index33 alt1"> 
      <code class="bash plain">&lt;</code> 
      <code class="bash plain">/dependency</code> 
      <code class="bash plain">&gt; &lt;!-- Test dependencies --&gt;</code> 
     </div> 
     <div class="line number35 index34 alt2"> 
      <code class="bash plain">&lt;dependency&gt;</code> 
     </div> 
     <div class="line number36 index35 alt1"> 
      <code class="bash spaces">    </code> 
      <code class="bash plain">&lt;groupId&gt;org.springframework.data&lt;</code> 
      <code class="bash plain">/groupId</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number37 index36 alt2"> 
      <code class="bash spaces">    </code> 
      <code class="bash plain">&lt;artifactId&gt;spring-data-redis&lt;</code> 
      <code class="bash plain">/artifactId</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number38 index37 alt1"> 
      <code class="bash spaces">    </code> 
      <code class="bash plain">&lt;version&gt;1.7.1.RELEASE&lt;</code> 
      <code class="bash plain">/version</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number39 index38 alt2"> 
      <code class="bash plain">&lt;</code> 
      <code class="bash plain">/dependency</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number40 index39 alt1"> 
      <code class="bash plain">&lt;dependency&gt;</code> 
     </div> 
     <div class="line number41 index40 alt2"> 
      <code class="bash plain">&lt;groupId&gt;org.mockito&lt;</code> 
      <code class="bash plain">/groupId</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number42 index41 alt1"> 
      <code class="bash plain">&lt;artifactId&gt;mockito-core&lt;</code> 
      <code class="bash plain">/artifactId</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number43 index42 alt2"> 
      <code class="bash plain">&lt;version&gt;1.9.0&lt;</code> 
      <code class="bash plain">/version</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number44 index43 alt1"> 
      <code class="bash plain">&lt;scope&gt;</code> 
      <code class="bash functions">test</code> 
      <code class="bash plain">&lt;</code> 
      <code class="bash plain">/scope</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number45 index44 alt2"> 
      <code class="bash plain">&lt;</code> 
      <code class="bash plain">/dependency</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number46 index45 alt1"> 
      <code class="bash plain">&lt;</code> 
      <code class="bash plain">/dependencies</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number47 index46 alt2"> 
      <code class="bash plain">&lt;</code> 
      <code class="bash plain">/project</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
    </div> </td></tr></tbody></table> 
<p>仿照MemCacheTicketRegistry.java类，定义RedisTicketRegistry.java类，此类是核心，它实现了TicketRegistry接口，具体代码如下：</p> 
<table class="syntaxhighlighter  java  " border="0" cellpadding="0" cellspacing="0"><tbody><tr></tr></tbody></table> 
<table class="syntaxhighlighter  java  " border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"> 
    <div class="container"> 
     <div class="line number1 index0 alt2"> 
      <code class="java keyword">public</code>  
      <code class="java keyword">class</code>  
      <code class="java plain">RedisTicketRegistry </code> 
      <code class="java keyword">extends</code>  
      <code class="java plain">AbstractDistributedTicketRegistry{<!-- --></code> 
     </div> 
     <div class="line number2 index1 alt1"> 
      <code class="java spaces">    </code> 
      <code class="java color1">@NotNull</code> 
     </div> 
     <div class="line number3 index2 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java keyword">private</code>  
      <code class="java keyword">final</code>  
      <code class="java plain">RedisTemplate&lt;String,Object&gt; reidsTemplate;</code> 
     </div> 
     <div class="line number4 index3 alt1"> 
      <code class="java spaces">    </code> 
      <code class="java preprocessor">/**</code> 
     </div> 
     <div class="line number5 index4 alt2"> 
      <code class="java spaces">     </code> 
      <code class="java preprocessor">* TGT cache entry timeout in seconds.</code> 
     </div> 
     <div class="line number6 index5 alt1"> 
      <code class="java spaces">     </code> 
      <code class="java preprocessor">*/</code> 
     </div> 
     <div class="line number7 index6 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java color1">@Min</code> 
      <code class="java plain">(</code> 
      <code class="java value">0</code> 
      <code class="java plain">)</code> 
     </div> 
     <div class="line number8 index7 alt1"> 
      <code class="java spaces">    </code> 
      <code class="java keyword">private</code>  
      <code class="java keyword">final</code>  
      <code class="java keyword">int</code>  
      <code class="java plain">tgtTimeout;</code> 
     </div> 
     <div class="line number9 index8 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java preprocessor">/**</code> 
     </div> 
     <div class="line number10 index9 alt1"> 
      <code class="java spaces">     </code> 
      <code class="java preprocessor">* ST cache entry timeout in seconds.</code> 
     </div> 
     <div class="line number11 index10 alt2"> 
      <code class="java spaces">     </code> 
      <code class="java preprocessor">*/</code> 
     </div> 
     <div class="line number12 index11 alt1"> 
      <code class="java spaces">    </code> 
      <code class="java color1">@Min</code> 
      <code class="java plain">(</code> 
      <code class="java value">0</code> 
      <code class="java plain">)</code> 
     </div> 
     <div class="line number13 index12 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java keyword">private</code>  
      <code class="java keyword">final</code>  
      <code class="java keyword">int</code>  
      <code class="java plain">stTimeout;</code> 
     </div> 
     <div class="line number14 index13 alt1"> 
      <code class="java spaces">    </code>  
     </div> 
     <div class="line number15 index14 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java keyword">public</code>  
      <code class="java plain">RedisTicketRegistry(RedisTemplate&lt;String,Object&gt; reidsTemplate,</code> 
      <code class="java keyword">int</code>  
      <code class="java plain">tgtTimeout,</code> 
      <code class="java keyword">int</code>  
      <code class="java plain">stTimeout){<!-- --></code> 
     </div> 
     <div class="line number16 index15 alt1"> 
      <code class="java spaces">        </code> 
      <code class="java keyword">this</code> 
      <code class="java plain">.reidsTemplate=reidsTemplate;</code> 
     </div> 
     <div class="line number17 index16 alt2"> 
      <code class="java spaces">        </code> 
      <code class="java keyword">this</code> 
      <code class="java plain">.tgtTimeout=tgtTimeout;</code> 
     </div> 
     <div class="line number18 index17 alt1"> 
      <code class="java spaces">        </code> 
      <code class="java keyword">this</code> 
      <code class="java plain">.stTimeout=stTimeout;</code> 
     </div> 
     <div class="line number19 index18 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java plain">}</code> 
     </div> 
     <div class="line number20 index19 alt1"> 
      <code class="java spaces">    </code> 
      <code class="java color1">@Override</code> 
     </div> 
     <div class="line number21 index20 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java keyword">public</code>  
      <code class="java keyword">void</code>  
      <code class="java plain">addTicket(Ticket ticket) {<!-- --></code> 
     </div> 
     <div class="line number22 index21 alt1"> 
      <code class="java spaces">        </code> 
      <code class="java plain">logger.debug(</code> 
      <code class="java string">"Adding ticket {}"</code> 
      <code class="java plain">, ticket);</code> 
     </div> 
     <div class="line number23 index22 alt2"> 
      <code class="java spaces">        </code> 
      <code class="java keyword">try</code>  
      <code class="java plain">{<!-- --></code> 
     </div> 
     <div class="line number24 index23 alt1"> 
      <code class="java spaces">            </code> 
      <code class="java plain">reidsTemplate.opsForValue().set(ticket.getId(),ticket, getTimeout(ticket), TimeUnit.SECONDS);</code> 
     </div> 
     <div class="line number25 index24 alt2"> 
      <code class="java spaces">        </code> 
      <code class="java plain">} </code> 
      <code class="java keyword">catch</code>  
      <code class="java plain">(</code> 
      <code class="java keyword">final</code>  
      <code class="java plain">Exception e) {<!-- --></code> 
     </div> 
     <div class="line number26 index25 alt1"> 
      <code class="java spaces">            </code> 
      <code class="java plain">logger.error(</code> 
      <code class="java string">"Failed adding {}"</code> 
      <code class="java plain">, ticket, e);</code> 
     </div> 
     <div class="line number27 index26 alt2"> 
      <code class="java spaces">        </code> 
      <code class="java plain">}</code> 
     </div> 
     <div class="line number28 index27 alt1"> 
      <code class="java spaces">    </code> 
      <code class="java plain">}</code> 
     </div> 
     <div class="line number29 index28 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java color1">@Override</code> 
     </div> 
     <div class="line number30 index29 alt1"> 
      <code class="java spaces">    </code> 
      <code class="java keyword">public</code>  
      <code class="java plain">Ticket getTicket(String ticketId) {<!-- --></code> 
     </div> 
     <div class="line number31 index30 alt2"> 
      <code class="java spaces">         </code> 
      <code class="java keyword">try</code>  
      <code class="java plain">{<!-- --></code> 
     </div> 
     <div class="line number32 index31 alt1"> 
      <code class="java spaces">                </code> 
      <code class="java keyword">final</code>  
      <code class="java plain">Ticket t = (Ticket) </code> 
      <code class="java keyword">this</code> 
      <code class="java plain">.reidsTemplate.opsForValue().get(ticketId);</code> 
     </div> 
     <div class="line number33 index32 alt2"> 
      <code class="java spaces">                </code> 
      <code class="java keyword">if</code>  
      <code class="java plain">(t != </code> 
      <code class="java keyword">null</code> 
      <code class="java plain">) {<!-- --></code> 
     </div> 
     <div class="line number34 index33 alt1"> 
      <code class="java spaces">                    </code> 
      <code class="java keyword">return</code>  
      <code class="java plain">getProxiedTicketInstance(t);</code> 
     </div> 
     <div class="line number35 index34 alt2"> 
      <code class="java spaces">                </code> 
      <code class="java plain">}</code> 
     </div> 
     <div class="line number36 index35 alt1"> 
      <code class="java spaces">            </code> 
      <code class="java plain">} </code> 
      <code class="java keyword">catch</code>  
      <code class="java plain">(</code> 
      <code class="java keyword">final</code>  
      <code class="java plain">Exception e) {<!-- --></code> 
     </div> 
     <div class="line number37 index36 alt2"> 
      <code class="java spaces">                </code> 
      <code class="java plain">logger.error(</code> 
      <code class="java string">"Failed fetching {} "</code> 
      <code class="java plain">, ticketId, e);</code> 
     </div> 
     <div class="line number38 index37 alt1"> 
      <code class="java spaces">            </code> 
      <code class="java plain">}</code> 
     </div> 
     <div class="line number39 index38 alt2"> 
      <code class="java spaces">            </code> 
      <code class="java keyword">return</code>  
      <code class="java keyword">null</code> 
      <code class="java plain">;</code> 
     </div> 
     <div class="line number40 index39 alt1"> 
      <code class="java spaces">    </code> 
      <code class="java plain">}</code> 
     </div> 
     <div class="line number41 index40 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java color1">@Override</code> 
     </div> 
     <div class="line number42 index41 alt1"> 
      <code class="java spaces">    </code> 
      <code class="java keyword">public</code>  
      <code class="java keyword">boolean</code>  
      <code class="java plain">deleteTicket(String ticketId) {<!-- --></code> 
     </div> 
     <div class="line number43 index42 alt2"> 
      <code class="java spaces">         </code> 
      <code class="java plain">logger.debug(</code> 
      <code class="java string">"Deleting ticket {}"</code> 
      <code class="java plain">, ticketId);</code> 
     </div> 
     <div class="line number44 index43 alt1"> 
      <code class="java spaces">            </code> 
      <code class="java keyword">try</code>  
      <code class="java plain">{<!-- --></code> 
     </div> 
     <div class="line number45 index44 alt2"> 
      <code class="java spaces">                 </code> 
      <code class="java keyword">this</code> 
      <code class="java plain">.reidsTemplate.delete(ticketId);</code> 
     </div> 
     <div class="line number46 index45 alt1"> 
      <code class="java spaces">                 </code> 
      <code class="java keyword">return</code>  
      <code class="java keyword">true</code> 
      <code class="java plain">;</code> 
     </div> 
     <div class="line number47 index46 alt2"> 
      <code class="java spaces">            </code> 
      <code class="java plain">} </code> 
      <code class="java keyword">catch</code>  
      <code class="java plain">(</code> 
      <code class="java keyword">final</code>  
      <code class="java plain">Exception e) {<!-- --></code> 
     </div> 
     <div class="line number48 index47 alt1"> 
      <code class="java spaces">                </code> 
      <code class="java plain">logger.error(</code> 
      <code class="java string">"Failed deleting {}"</code> 
      <code class="java plain">, ticketId, e);</code> 
     </div> 
     <div class="line number49 index48 alt2"> 
      <code class="java spaces">            </code> 
      <code class="java plain">}</code> 
     </div> 
     <div class="line number50 index49 alt1"> 
      <code class="java spaces">            </code> 
      <code class="java keyword">return</code>  
      <code class="java keyword">false</code> 
      <code class="java plain">;</code> 
     </div> 
     <div class="line number51 index50 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java plain">}</code> 
     </div> 
     <div class="line number52 index51 alt1"> 
      <code class="java spaces">    </code> 
      <code class="java color1">@Override</code> 
     </div> 
     <div class="line number53 index52 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java keyword">public</code>  
      <code class="java plain">Collection&lt;Ticket&gt; getTickets() {<!-- --></code> 
     </div> 
     <div class="line number54 index53 alt1"> 
      <code class="java spaces">         </code> 
      <code class="java keyword">throw</code>  
      <code class="java keyword">new</code>  
      <code class="java plain">UnsupportedOperationException(</code> 
      <code class="java string">"GetTickets not supported."</code> 
      <code class="java plain">);</code> 
     </div> 
     <div class="line number55 index54 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java plain">}</code> 
     </div> 
     <div class="line number56 index55 alt1"> 
      <code class="java spaces">    </code> 
      <code class="java color1">@Override</code> 
     </div> 
     <div class="line number57 index56 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java keyword">protected</code>  
      <code class="java keyword">void</code>  
      <code class="java plain">updateTicket(Ticket ticket) {<!-- --></code> 
     </div> 
     <div class="line number58 index57 alt1"> 
      <code class="java spaces">     </code> 
      <code class="java plain">logger.debug(</code> 
      <code class="java string">"Updating ticket {}"</code> 
      <code class="java plain">, ticket);</code> 
     </div> 
     <div class="line number59 index58 alt2"> 
      <code class="java spaces">        </code> 
      <code class="java keyword">try</code>  
      <code class="java plain">{<!-- --></code> 
     </div> 
     <div class="line number60 index59 alt1"> 
      <code class="java spaces">              </code> 
      <code class="java keyword">this</code> 
      <code class="java plain">.reidsTemplate.delete(ticket.getId());</code> 
     </div> 
     <div class="line number61 index60 alt2"> 
      <code class="java spaces">              </code> 
      <code class="java plain">reidsTemplate.opsForValue().set(ticket.getId(),ticket, getTimeout(ticket), TimeUnit.SECONDS);</code> 
     </div> 
     <div class="line number62 index61 alt1"> 
      <code class="java spaces">        </code> 
      <code class="java plain">} </code> 
      <code class="java keyword">catch</code>  
      <code class="java plain">(</code> 
      <code class="java keyword">final</code>  
      <code class="java plain">Exception e) {<!-- --></code> 
     </div> 
     <div class="line number63 index62 alt2"> 
      <code class="java spaces">            </code> 
      <code class="java plain">logger.error(</code> 
      <code class="java string">"Failed updating {}"</code> 
      <code class="java plain">, ticket, e);</code> 
     </div> 
     <div class="line number64 index63 alt1"> 
      <code class="java spaces">        </code> 
      <code class="java plain">}</code> 
     </div> 
     <div class="line number65 index64 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java plain">}</code> 
     </div> 
     <div class="line number66 index65 alt1"> 
      <code class="java spaces">    </code> 
      <code class="java color1">@Override</code> 
     </div> 
     <div class="line number67 index66 alt2"> 
      <code class="java spaces">    </code> 
      <code class="java keyword">protected</code>  
      <code class="java keyword">boolean</code>  
      <code class="java plain">needsCallback() {<!-- --></code> 
     </div> 
     <div class="line number68 index67 alt1"> 
      <code class="java spaces">        </code> 
      <code class="java comments">// TODO Auto-generated method stub</code> 
     </div> 
     <div class="line number69 index68 alt2"> 
      <code class="java spaces">        </code> 
      <code class="java keyword">return</code>  
      <code class="java keyword">true</code> 
      <code class="java plain">;</code> 
     </div> 
     <div class="line number70 index69 alt1"> 
      <code class="java spaces">    </code> 
      <code class="java plain">}</code> 
     </div> 
     <div class="line number71 index70 alt2"> 
      <code class="java spaces">   </code> 
      <code class="java keyword">private</code>  
      <code class="java keyword">int</code>  
      <code class="java plain">getTimeout(</code> 
      <code class="java keyword">final</code>  
      <code class="java plain">Ticket t) {<!-- --></code> 
     </div> 
     <div class="line number72 index71 alt1"> 
      <code class="java spaces">        </code> 
      <code class="java keyword">if</code>  
      <code class="java plain">(t </code> 
      <code class="java keyword">instanceof</code>  
      <code class="java plain">TicketGrantingTicket) {<!-- --></code> 
     </div> 
     <div class="line number73 index72 alt2"> 
      <code class="java spaces">            </code> 
      <code class="java keyword">return</code>  
      <code class="java keyword">this</code> 
      <code class="java plain">.tgtTimeout;</code> 
     </div> 
     <div class="line number74 index73 alt1"> 
      <code class="java spaces">        </code> 
      <code class="java plain">} </code> 
      <code class="java keyword">else</code>  
      <code class="java keyword">if</code>  
      <code class="java plain">(t </code> 
      <code class="java keyword">instanceof</code>  
      <code class="java plain">ServiceTicket) {<!-- --></code> 
     </div> 
     <div class="line number75 index74 alt2"> 
      <code class="java spaces">            </code> 
      <code class="java keyword">return</code>  
      <code class="java keyword">this</code> 
      <code class="java plain">.stTimeout;</code> 
     </div> 
     <div class="line number76 index75 alt1"> 
      <code class="java spaces">        </code> 
      <code class="java plain">}</code> 
     </div> 
     <div class="line number77 index76 alt2"> 
      <code class="java spaces">        </code> 
      <code class="java keyword">throw</code>  
      <code class="java keyword">new</code>  
      <code class="java plain">IllegalArgumentException(</code> 
      <code class="java string">"Invalid ticket type"</code> 
      <code class="java plain">);</code> 
     </div> 
     <div class="line number78 index77 alt1"> 
      <code class="java spaces">    </code> 
      <code class="java plain">}</code> 
     </div> 
     <div class="line number79 index78 alt2"> 
      <code class="java plain">}</code> 
     </div> 
    </div> </td></tr></tbody></table> 
<p><br> </p> 
<p>2、整合cas-server-webapp工程</p> 
<p>修改cas-server-webapp工程中ticketRegistry.xml文件，替换掉DefaultTicketRegistry，同时注释掉ticketRegistryCleaner相关所有定义，具体如下：</p> 
<table class="syntaxhighlighter  bash  " border="0" cellpadding="0" cellspacing="0"><tbody><tr></tr></tbody></table> 
<table class="syntaxhighlighter  bash  " border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"> 
    <div class="container"> 
     <div class="line number1 index0 alt2"> 
      <code class="bash plain">&lt;bean </code> 
      <code class="bash functions">id</code> 
      <code class="bash plain">=</code> 
      <code class="bash string">"ticketRegistry"</code>  
      <code class="bash plain">class=</code> 
      <code class="bash string">"com.test.cas.ticket.registry.RedisTicketRegistry"</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number2 index1 alt1"> 
      <code class="bash spaces">        </code> 
      <code class="bash plain">&lt;constructor-arg index=</code> 
      <code class="bash string">"0"</code>  
      <code class="bash plain">ref=</code> 
      <code class="bash string">"redisTemplate"</code>  
      <code class="bash plain">/&gt;</code> 
     </div> 
     <div class="line number3 index2 alt2"> 
      <code class="bash spaces">        </code> 
      <code class="bash plain">&lt;constructor-arg index=</code> 
      <code class="bash string">"1"</code>  
      <code class="bash plain">value=</code> 
      <code class="bash string">"1800"</code>  
      <code class="bash plain">/&gt;</code> 
     </div> 
     <div class="line number4 index3 alt1"> 
      <code class="bash spaces">        </code> 
      <code class="bash plain">&lt;constructor-arg index=</code> 
      <code class="bash string">"2"</code>  
      <code class="bash plain">value=</code> 
      <code class="bash string">"10"</code>  
      <code class="bash plain">/&gt;</code> 
     </div> 
     <div class="line number5 index4 alt2"> 
      <code class="bash spaces">    </code> 
      <code class="bash plain">&lt;</code> 
      <code class="bash plain">/bean</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number6 index5 alt1"> 
      <code class="bash spaces">    </code> 
      <code class="bash plain">&lt;bean </code> 
      <code class="bash functions">id</code> 
      <code class="bash plain">=</code> 
      <code class="bash string">"poolConfig"</code>  
      <code class="bash plain">class=</code> 
      <code class="bash string">"redis.clients.jedis.JedisPoolConfig"</code> 
      <code class="bash plain">&gt;  </code> 
     </div> 
     <div class="line number7 index6 alt2"> 
      <code class="bash spaces">        </code> 
      <code class="bash plain">&lt;property name=</code> 
      <code class="bash string">"maxIdle"</code>  
      <code class="bash plain">value=</code> 
      <code class="bash string">"200"</code>  
      <code class="bash plain">/&gt;  </code> 
     </div> 
     <div class="line number8 index7 alt1"> 
      <code class="bash spaces">        </code> 
      <code class="bash plain">&lt;property name=</code> 
      <code class="bash string">"testOnBorrow"</code>  
      <code class="bash plain">value=</code> 
      <code class="bash string">"true"</code>  
      <code class="bash plain">/&gt;  </code> 
     </div> 
     <div class="line number9 index8 alt2"> 
      <code class="bash spaces">    </code> 
      <code class="bash plain">&lt;</code> 
      <code class="bash plain">/bean</code> 
      <code class="bash plain">&gt;  </code> 
     </div> 
     <div class="line number10 index9 alt1"> 
      <code class="bash spaces">      </code>  
     </div> 
     <div class="line number11 index10 alt2"> 
      <code class="bash spaces">    </code> 
      <code class="bash plain">&lt;bean </code> 
      <code class="bash functions">id</code> 
      <code class="bash plain">=</code> 
      <code class="bash string">"connectionFactory"</code>  
      <code class="bash plain">class=</code> 
      <code class="bash string">"org.springframework.data.redis.connection.jedis.JedisConnectionFactory"</code>   
     </div> 
     <div class="line number12 index11 alt1"> 
      <code class="bash spaces">        </code> 
      <code class="bash plain">p:host-name=</code> 
      <code class="bash string">"127.0.0.1"</code>  
      <code class="bash plain">p:port=</code> 
      <code class="bash string">"6379"</code>    
      <code class="bash plain">p:pool-config-ref=</code> 
      <code class="bash string">"poolConfig"</code> 
      <code class="bash plain">/&gt;  &lt;!—host-name 服务端IP--&gt;</code> 
     </div> 
     <div class="line number13 index12 alt2"> 
      <code class="bash spaces">    </code> 
      <code class="bash plain">&lt;bean </code> 
      <code class="bash functions">id</code> 
      <code class="bash plain">=</code> 
      <code class="bash string">"redisTemplate"</code>  
      <code class="bash plain">class=</code> 
      <code class="bash string">"org.springframework.data.redis.core.RedisTemplate"</code> 
     </div> 
     <div class="line number14 index13 alt1"> 
      <code class="bash spaces">        </code> 
      <code class="bash plain">p:connection-factory-ref=</code> 
      <code class="bash string">"connectionFactory"</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number15 index14 alt2"> 
      <code class="bash spaces">    </code> 
      <code class="bash plain">&lt;</code> 
      <code class="bash plain">/bean</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
    </div> </td></tr></tbody></table> 
<p>使用Redis作为ticket票据的存储，需要将原来的配置给注释掉否则启动时报错，具体如下：</p> 
<table class="syntaxhighlighter  bash  " border="0" cellpadding="0" cellspacing="0"><tbody><tr></tr></tbody></table> 
<table class="syntaxhighlighter  bash  " border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"> 
    <div class="container"> 
     <div class="line number1 index0 alt2"> 
      <code class="bash plain">&lt;!--   &lt;bean </code> 
      <code class="bash functions">id</code> 
      <code class="bash plain">=</code> 
      <code class="bash string">"ticketRegistry"</code>  
      <code class="bash plain">class=</code> 
      <code class="bash string">"org.jasig.cas.ticket.registry.DefaultTicketRegistry"</code>  
      <code class="bash plain">/&gt; --&gt;　</code> 
     </div> 
     <div class="line number2 index1 alt1"> 
      <code class="bash plain">&lt;!--Quartz --&gt;</code> 
     </div> 
     <div class="line number3 index2 alt2"> 
      <code class="bash plain">&lt;!-- TICKET REGISTRY CLEANER --&gt;</code> 
     </div> 
     <div class="line number4 index3 alt1"> 
      <code class="bash plain">&lt;!-- &lt;bean </code> 
      <code class="bash functions">id</code> 
      <code class="bash plain">=</code> 
      <code class="bash string">"ticketRegistryCleaner"</code>  
      <code class="bash plain">class=</code> 
      <code class="bash string">"org.jasig.cas.ticket.registry.support.DefaultTicketRegistryCleaner"</code>  
      <code class="bash plain">--&gt;</code> 
     </div> 
     <div class="line number5 index4 alt2"> 
      <code class="bash plain">&lt;!-- p:ticketRegistry-ref=</code> 
      <code class="bash string">"ticketRegistry"</code>  
      <code class="bash plain">/&gt; --&gt;</code> 
     </div> 
     <div class="line number6 index5 alt1"> 
      <code class="bash plain">&lt;!-- &lt;bean </code> 
      <code class="bash functions">id</code> 
      <code class="bash plain">=</code> 
      <code class="bash string">"jobDetailTicketRegistryCleaner"</code>  
      <code class="bash plain">class=</code> 
      <code class="bash string">"org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean"</code>  
      <code class="bash plain">--&gt;</code> 
     </div> 
     <div class="line number7 index6 alt2"> 
      <code class="bash plain">&lt;!-- p:targetObject-ref=</code> 
      <code class="bash string">"ticketRegistryCleaner"</code>  
      <code class="bash plain">--&gt;</code> 
     </div> 
     <div class="line number8 index7 alt1"> 
      <code class="bash plain">&lt;!-- p:targetMethod=</code> 
      <code class="bash string">"clean"</code>  
      <code class="bash plain">/&gt; --&gt;</code> 
     </div> 
     <div class="line number9 index8 alt2"> 
      <code class="bash plain">&lt;!-- &lt;bean </code> 
      <code class="bash functions">id</code> 
      <code class="bash plain">=</code> 
      <code class="bash string">"triggerJobDetailTicketRegistryCleaner"</code>  
      <code class="bash plain">class=</code> 
      <code class="bash string">"org.springframework.scheduling.quartz.SimpleTriggerBean"</code>  
      <code class="bash plain">--&gt;</code> 
     </div> 
     <div class="line number10 index9 alt1"> 
      <code class="bash plain">&lt;!-- p:jobDetail-ref=</code> 
      <code class="bash string">"jobDetailTicketRegistryCleaner"</code>  
      <code class="bash plain">--&gt;</code> 
     </div> 
     <div class="line number11 index10 alt2"> 
      <code class="bash plain">&lt;!-- p:startDelay=</code> 
      <code class="bash string">"20000"</code>  
      <code class="bash plain">--&gt;</code> 
     </div> 
     <div class="line number12 index11 alt1"> 
      <code class="bash plain">&lt;!-- p:repeatInterval=</code> 
      <code class="bash string">"5000000"</code>  
      <code class="bash plain">/&gt; --&gt;</code> 
     </div> 
    </div> </td></tr></tbody></table> 
<p>在POM.xml中添加cas-server-integration-redis模块：</p> 
<table class="syntaxhighlighter  bash  " border="0" cellpadding="0" cellspacing="0"><tbody><tr></tr></tbody></table> 
<table class="syntaxhighlighter  bash  " border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"> 
    <div class="container"> 
     <div class="line number1 index0 alt2"> 
      <code class="bash plain">&lt;dependency&gt;</code> 
     </div> 
     <div class="line number2 index1 alt1"> 
      <code class="bash spaces"> </code> 
      <code class="bash plain">&lt;groupId&gt;org.jasig.cas&lt;</code> 
      <code class="bash plain">/groupId</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number3 index2 alt2"> 
      <code class="bash spaces"> </code> 
      <code class="bash plain">&lt;artifactId&gt;cas-server-integration-redis&lt;</code> 
      <code class="bash plain">/artifactId</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number4 index3 alt1"> 
      <code class="bash spaces"> </code> 
      <code class="bash plain">&lt;version&gt;${project.version}&lt;</code> 
      <code class="bash plain">/version</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number5 index4 alt2"> 
      <code class="bash spaces"> </code> 
      <code class="bash plain">&lt;scope&gt;compile&lt;</code> 
      <code class="bash plain">/scope</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
     <div class="line number6 index5 alt1"> 
      <code class="bash plain">&lt;</code> 
      <code class="bash plain">/dependency</code> 
      <code class="bash plain">&gt;</code> 
     </div> 
    </div> </td></tr></tbody></table> 
<p>此时CAS配置完毕，启动所有相关服务器即可使用，下面说说tomcat session集群同步的问题</p> 
<p><br> </p> 
<p>3、tomcat session集群同步</p> 
<p>　　保证多个实例下，session中的状态以及票据存储状态，是一致的，通过网络上查找资料，实现tomcat session集群同步可以采用开源的tomcat-redis-session-manager，git hub地址为：https://github.com/jcoleman/tomcat-redis-session-manager，注意使用的JDK是JDK1.7，服务器使用的是tomcat7</p> 
<p>　　1）拷贝编译打包之后的tomcat-redis-session-manager-VERSION.jar，jedis-2.7.2.jar，commons-pool2-2.2.jar到tomcat/lib目录下</p> 
<p>　　2）修改Tomcat context.xml (or the context block of the server.xml if applicable.)</p> 
<table class="syntaxhighlighter  bash  " border="0" cellpadding="0" cellspacing="0"><tbody><tr></tr></tbody></table> 
<table class="syntaxhighlighter  bash  " border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"> 
    <div class="container"> 
     <div class="line number1 index0 alt2"> 
      <code class="bash plain">&lt;Valve className=</code> 
      <code class="bash string">"com.orangefunction.tomcat.redissessions.RedisSessionHandlerValve"</code> 
      <code class="bash plain">/&gt;</code> 
     </div> 
     <div class="line number2 index1 alt1"> 
      <code class="bash plain">&lt;Manager className=</code> 
      <code class="bash string">"com.orangefunction.tomcat.redissessions.RedisSessionManager"</code> 
     </div> 
     <div class="line number3 index2 alt2"> 
      <code class="bash spaces">         </code> 
      <code class="bash plain">host=</code> 
      <code class="bash string">"127.0.0.1"</code> 
     </div> 
     <div class="line number4 index3 alt1"> 
      <code class="bash spaces">         </code> 
      <code class="bash plain">port=</code> 
      <code class="bash string">"6379"</code> 
     </div> 
     <div class="line number5 index4 alt2"> 
      <code class="bash spaces">         </code> 
      <code class="bash plain">database=</code> 
      <code class="bash string">"0"</code> 
     </div> 
     <div class="line number6 index5 alt1"> 
      <code class="bash spaces">         </code> 
      <code class="bash plain">maxInactiveInterval=</code> 
      <code class="bash string">"1800"</code> 
      <code class="bash plain">/&gt;</code> 
     </div> 
    </div> </td></tr></tbody></table> 
<p>到此为止，CAS集群部署工作完毕，欢迎大家收藏本站，有什么疑难问题，尽可留言。</p> 
<p></p> 
<h2 class="article-title">http://blog.yoodb.com/yoodb/article/detail/1221<br> </h2> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/31ea61743b07a80e568db00c29723e89/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">支持Windows和Linux的文件目录创建和删除操作</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6b98f3661fbe4ab09bae543ed9a311c1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python数据类型之“集合(Sets)与映射(Mapping)”</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>