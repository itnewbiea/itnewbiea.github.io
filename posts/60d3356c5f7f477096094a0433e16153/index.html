<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android 给广播接收器增加权限（permission）或signature签名权限 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android 给广播接收器增加权限（permission）或signature签名权限" />
<meta property="og:description" content="一. 普通权限
1.添加权限
当普通广播接收器需要增加权限时，需要在广播接收器所在的AndroidManifest.xml 文件中添加权限：
&lt;uses-permission android:name=&#34;com.android.permission.MY_PERMISSION&#34;/&gt; &lt;permission android:name = &#34;com.android.permission.MY_PERMISSION&#34;/&gt; 注：我查到的资料是在广播接收器所在的AndroidManifest.xml 文件中添加permission就行了，uses-permission是添加在广播发送方的，但在我实际调试中我发现uses-permission也得加上，否则收不到广播（注意，我调试的时候广播接收器在Android源码的SystemUI中，而发送广播则是普通的app）。
2.注册广播
如果是静态注册，则在广播接收器所在的AndroidManifest.xml 文件中，&lt;application&gt;标签内注册：
&lt;receiver android:name=&#34;.com.example.MyReceiver&#34; android:exported=&#34;true&#34; android:permission=&#34;com.android.permission.MY_PERMISSON&#34;&gt; &lt;intent-filter&gt; &lt;action android:name=&#34;com.my.permission&#34; /&gt; &lt;/intent-filter&gt; &lt;/receiver&gt; 如果广播接收器是内部类的话，则使用外部类$内部类的格式。
android:exported=&#34;true&#34; 是 AndroidManifest.xml 文件中的一个属性，用于指示一个组件（如 Activity、Service、BroadcastReceiver 或 ContentProvider）是否可以被其他应用程序或组件访问。 如果将 android:exported 设置为 true，则该组件可以被其他应用程序或组件调用，而不需要经过授权或权限检查。这通常用于提供公共 API 或服务。 但是，如果将 android:exported 设置为 false，则该组件只能被同一应用程序中的其他组件访问，而不能被其他应用程序或组件调用。这通常用于保护应用程序的私有数据或服务。 在开发应用程序时，需要小心使用 android:exported 属性，以确保不会意外地将应用程序暴露给未经授权的访问。
如果是动态注册广播，则在onCreate()方法中注册：
IntentFilter intentFilter = new IntentFilter(); intentFilter.addAction(&#34;com.my.permission&#34;); getContext().registerReceiver(new MyReceiver(), intentFilter, BROADCAST_PERMISSION, null); 其中关键点在于注册权限时传入的参数是四个。上述代码中BROADCAST_PERMISSION的就是在AndroidManifest.xml文件中自定义的权限。
private String BROADCAST_PERMISSION = &#34;com.android.permission.MY_PERMISSON&#34; 上述两种方法中各选一种注册方式即可。
3.发送广播：
只需要send的时候带上接收广播需要的权限就好了。
int broadcast = 0; Intent intent = new Intent(); intent." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/60d3356c5f7f477096094a0433e16153/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-01T17:30:09+08:00" />
<meta property="article:modified_time" content="2023-09-01T17:30:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android 给广播接收器增加权限（permission）或signature签名权限</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>一. 普通权限</p> 
<p>1.添加权限</p> 
<p>        当普通广播接收器需要增加权限时，需要在广播接收器所在的AndroidManifest.xml 文件中添加权限：</p> 
<pre><code class="language-java">    &lt;uses-permission android:name="com.android.permission.MY_PERMISSION"/&gt;
    &lt;permission android:name = "com.android.permission.MY_PERMISSION"/&gt;</code></pre> 
<p>注：我查到的资料是<strong>在广播接收器所在的AndroidManifest.xml 文件中添加permission</strong>就行了，uses-permission是添加在广播发送方的，但在我实际调试中我发现uses-permission也得加上，否则收不到广播（注意，我调试的时候广播接收器在Android源码的SystemUI中，而发送广播则是普通的app）。</p> 
<p>2.注册广播</p> 
<p>        如果是静态注册，则在广播接收器所在的AndroidManifest.xml 文件中，&lt;application&gt;标签内注册：</p> 
<pre><code class="language-java">&lt;receiver android:name=".com.example.MyReceiver"
        android:exported="true"
        android:permission="com.android.permission.MY_PERMISSON"&gt;
    &lt;intent-filter&gt;
        &lt;action android:name="com.my.permission" /&gt;
    &lt;/intent-filter&gt;
&lt;/receiver&gt;</code></pre> 
<p>如果广播接收器是内部类的话，则使用外部类$内部类的格式。</p> 
<blockquote> 
 <p>android:exported="true" 是 AndroidManifest.xml 文件中的一个属性，用于指示一个组件（如 Activity、Service、BroadcastReceiver 或 ContentProvider）是否可以被其他应用程序或组件访问。 如果将 android:exported 设置为 true，则该组件可以被其他应用程序或组件调用，而不需要经过授权或权限检查。这通常用于提供公共 API 或服务。 但是，如果将 android:exported 设置为 false，则该组件只能被同一应用程序中的其他组件访问，而不能被其他应用程序或组件调用。这通常用于保护应用程序的私有数据或服务。 在开发应用程序时，需要小心使用 android:exported 属性，以确保不会意外地将应用程序暴露给未经授权的访问。</p> 
</blockquote> 
<p>         如果是动态注册广播，则在onCreate()方法中注册：</p> 
<pre><code class="language-java">    IntentFilter intentFilter = new IntentFilter();
    intentFilter.addAction("com.my.permission");
    getContext().registerReceiver(new MyReceiver(), intentFilter, BROADCAST_PERMISSION, null);</code></pre> 
<p>其中关键点在于<strong>注册权限时传入的参数是四个</strong>。上述代码中BROADCAST_PERMISSION的就是在AndroidManifest.xml文件中自定义的权限。</p> 
<pre><code class="language-java">private String BROADCAST_PERMISSION = "com.android.permission.MY_PERMISSON"</code></pre> 
<p>上述两种方法中各选一种注册方式即可。</p> 
<p>3.发送广播：</p> 
<p>        只需要<strong>send的时候带上接收广播需要的权限</strong>就好了。</p> 
<pre><code class="language-java">int broadcast = 0;
Intent intent = new Intent();
intent.setAction("com.my.permission");
intent.putExtra("my broadcast", broadcast);
sendBroadcast(intent, "com.android.permission.MY_PERMISSION");</code></pre> 
<p>二.签名权限</p> 
<p>1.增加权限</p> 
<p>       增加android:protectionLevel="signature"即可：</p> 
<pre><code class="language-java">&lt;uses-permission android:name="com.android.permission.MY_PERMISSON"/&gt;
&lt;permission android:name = "com.android.permission.MY_PERMISSONT"
    android:protectionLevel="signature"/&gt;</code></pre> 
<p>        注册方式和发送广播的方式都不需要做改动。</p> 
<p>        在我调试的过程中，我发现，如果是静态注册的方式注册广播，那么增加签名限制时不能使用内部类，否则SystemUI会崩溃，如果要使用内部类，则需要将类写为static类。而动态注册则没有这个问题。</p> 
<p>        本帖子略过了如何写广播接收器，请自行根据需求写。</p> 
<p>2.给应用签名</p> 
<p>        在AndroidStudio中，点击build&gt;Generate Signed Bundle/APK，根据需要选择对应选项：</p> 
<p><img alt="" height="449" src="https://images2.imgbox.com/9a/d3/pzrGLBPk_o.png" width="627"></p> 
<p></p> 
<p>然后导入需要的签名文件，输入密码：</p> 
<p> <img alt="" height="449" src="https://images2.imgbox.com/5b/7b/2A0Ps78H_o.png" width="612"></p> 
<p>点击next等待build成功即可。 </p> 
<p></p> 
<p>如有错误请指正。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2ace4b15dc0af5dec760a44f5ecd83bc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python如何读取csv文件？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/55ebecf128d23be06260b5dc197a9597/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">详谈numpy.max,torch.max,argmax...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>