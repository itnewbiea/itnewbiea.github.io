<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>å¸¸è§çš„é™æµç®—æ³•åˆ†æä»¥åŠæ‰‹å†™å®ç°ï¼ˆè®¡æ•°å™¨ã€æ¼æ–—ã€ä»¤ç‰Œæ¡¶ï¼‰ - ITå­¦ä¹ è€…åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="å¸¸è§çš„é™æµç®—æ³•åˆ†æä»¥åŠæ‰‹å†™å®ç°ï¼ˆè®¡æ•°å™¨ã€æ¼æ–—ã€ä»¤ç‰Œæ¡¶ï¼‰" />
<meta property="og:description" content="å¸¸è§çš„é™æµç®—æ³•åˆ†æğŸ¥‚ ä¸ºä»€ä¹ˆè¦é™æµğŸ‘€ ğŸ‘©ğŸ»â€ğŸ«åœ¨ä¿è¯å¯ç”¨çš„æƒ…å†µä¸‹å°½å¯èƒ½å¤šå¢åŠ è¿›å…¥çš„äººæ•°,å…¶ä½™çš„äººåœ¨æ’é˜Ÿç­‰å¾…,æˆ–è€…è¿”å›å‹å¥½æç¤º,ä¿è¯é‡Œé¢çš„è¿›è¡Œç³»ç»Ÿçš„ç”¨æˆ·å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œé˜²æ­¢ç³»ç»Ÿé›ªå´©ã€‚
é™æµç®—æ³•ğŸŒ´ğŸŒ´ é™æµç®—æ³•å¾ˆå¤š,å¸¸è§çš„æœ‰ä¸‰ç±»,åˆ†åˆ«æ˜¯ è®¡æ•°å™¨ç®—æ³• ã€æ¼æ¡¶ç®—æ³•ã€ä»¤ç‰Œæ¡¶ç®—æ³• ã€‚
ï¼ˆ1ï¼‰è®¡æ•°å™¨ï¼š
åœ¨ä¸€æ®µæ—¶é—´é—´éš”å†…ï¼Œå¤„ç†è¯·æ±‚çš„æœ€å¤§æ•°é‡å›ºå®šï¼Œè¶…è¿‡éƒ¨åˆ†ä¸åšå¤„ç†ã€‚
ï¼ˆ2ï¼‰æ¼æ¡¶ï¼š
æ¼æ¡¶å¤§å°å›ºå®šï¼Œå¤„ç†é€Ÿåº¦å›ºå®šï¼Œä½†è¯·æ±‚è¿›å…¥é€Ÿåº¦ä¸å›ºå®šï¼ˆåœ¨çªå‘æƒ…å†µè¯·æ±‚è¿‡å¤šæ—¶ï¼Œä¼šä¸¢å¼ƒè¿‡å¤šçš„è¯·æ±‚ï¼‰ã€‚
ï¼ˆ3ï¼‰ä»¤ç‰Œæ¡¶ï¼š
ä»¤ç‰Œæ¡¶çš„å¤§å°å›ºå®šï¼Œä»¤ç‰Œçš„äº§ç”Ÿé€Ÿåº¦å›ºå®šï¼Œä½†æ˜¯æ¶ˆè€—ä»¤ç‰Œï¼ˆå³è¯·æ±‚ï¼‰é€Ÿåº¦ä¸å›ºå®šï¼ˆå¯ä»¥åº”å¯¹ä¸€äº›æŸäº›æ—¶é—´è¯·æ±‚è¿‡å¤šçš„æƒ…å†µï¼‰ï¼›æ¯ä¸ªè¯·æ±‚éƒ½ä¼šä»ä»¤ç‰Œæ¡¶ä¸­å–å‡ºä»¤ç‰Œï¼Œå¦‚æœæ²¡æœ‰ä»¤ç‰Œåˆ™ä¸¢å¼ƒè¯¥æ¬¡è¯·æ±‚ã€‚
è®¡æ•°å™¨é™æµâœ¨ ğŸºåœ¨ä¸€æ®µæ—¶é—´é—´éš”å†…ï¼Œå¤„ç†è¯·æ±‚çš„æœ€å¤§æ•°é‡å›ºå®šï¼Œè¶…è¿‡éƒ¨åˆ†ä¸åšå¤„ç†ã€‚
ä¸¾ä¸ªğŸŒ°,æ¯”å¦‚æˆ‘ä»¬è§„å®šå¯¹äºAæ¥å£ï¼Œæˆ‘ä»¬1åˆ†é’Ÿçš„è®¿é—®æ¬¡æ•°ä¸èƒ½è¶…è¿‡100æ¬¡ã€‚
é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š
ğŸˆåœ¨ä¸€å¼€ å§‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªè®¡æ•°å™¨counterï¼Œæ¯å½“ä¸€ä¸ªè¯·æ±‚è¿‡æ¥çš„æ—¶å€™ï¼Œcounterå°±åŠ 1ï¼Œå¦‚æœcounterçš„å€¼å¤§äº100å¹¶ä¸”è¯¥è¯·æ±‚ä¸ç¬¬ä¸€ä¸ªè¯·æ±‚çš„é—´éš”æ—¶é—´è¿˜åœ¨1åˆ†é’Ÿä¹‹å†…ï¼Œé‚£ä¹ˆè¯´æ˜è¯·æ±‚æ•°è¿‡å¤š,æ‹’ç»è®¿é—®ï¼›
ğŸ¬å¦‚æœè¯¥è¯·æ±‚ä¸ç¬¬ä¸€ä¸ªè¯·æ±‚çš„é—´éš”æ—¶é—´å¤§äº1åˆ†é’Ÿï¼Œä¸”counterçš„å€¼è¿˜åœ¨é™æµèŒƒå›´å†…ï¼Œé‚£ä¹ˆå°±é‡ç½® counter,å°±æ˜¯è¿™ä¹ˆç®€å•ç²—æš´ã€‚
ä»£ç å®ç°ï¼š ğŸ˜
import java.util.concurrent.CountDownLatch; import java.util.concurrent.ExecutorService; import java.util.concurrent.Executors; import java.util.concurrent.atomic.AtomicInteger; import java.util.concurrent.atomic.AtomicLong; //è®¡æ•°å™¨ é™æµ public class CounterLimiter { //èµ·å§‹æ—¶é—´ private static long startTime = System.currentTimeMillis(); //æ—¶é—´é—´éš”1000ms private static long interval = 1000; //æ¯ä¸ªæ—¶é—´é—´éš”å†…ï¼Œé™åˆ¶æ•°é‡ private static long limit = 3; //ç´¯åŠ å™¨ private static AtomicLong accumulator = new AtomicLong(); /** * true ä»£è¡¨æ”¾è¡Œï¼Œè¯·æ±‚å¯å·²é€šè¿‡ * false ä»£è¡¨é™åˆ¶ï¼Œä¸è®©è¯·æ±‚é€šè¿‡ */ public static boolean tryAcquire() { long nowTime = System." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/d45d6a03325408ee633da1f8bfc2d8b8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-17T22:36:55+08:00" />
<meta property="article:modified_time" content="2022-03-17T22:36:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ITå­¦ä¹ è€…åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ITå­¦ä¹ è€…åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">å¸¸è§çš„é™æµç®—æ³•åˆ†æä»¥åŠæ‰‹å†™å®ç°ï¼ˆè®¡æ•°å™¨ã€æ¼æ–—ã€ä»¤ç‰Œæ¡¶ï¼‰</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>å¸¸è§çš„é™æµç®—æ³•åˆ†æğŸ¥‚</h3> 
<h5><a id="_1"></a>ä¸ºä»€ä¹ˆè¦é™æµğŸ‘€</h5> 
<p>ğŸ‘©ğŸ»â€ğŸ«åœ¨ä¿è¯å¯ç”¨çš„æƒ…å†µä¸‹å°½å¯èƒ½å¤šå¢åŠ è¿›å…¥çš„äººæ•°,å…¶ä½™çš„äººåœ¨æ’é˜Ÿç­‰å¾…,æˆ–è€…è¿”å›å‹å¥½æç¤º,ä¿è¯é‡Œé¢çš„è¿›è¡Œç³»ç»Ÿçš„ç”¨æˆ·å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œ<strong><font color="blue">é˜²æ­¢ç³»ç»Ÿé›ªå´©</font></strong>ã€‚</p> 
<h5><a id="_4"></a>é™æµç®—æ³•ğŸŒ´ğŸŒ´</h5> 
<p>é™æµç®—æ³•å¾ˆå¤š,å¸¸è§çš„æœ‰ä¸‰ç±»,åˆ†åˆ«æ˜¯ <strong><font color="purple">è®¡æ•°å™¨ç®—æ³•</font> <strong>ã€</strong><font color="orange">æ¼æ¡¶ç®—æ³•</font></strong>ã€<strong><font color="green">ä»¤ç‰Œæ¡¶ç®—æ³•</font></strong> ã€‚</p> 
<blockquote> 
 <p>ï¼ˆ1ï¼‰<strong>è®¡æ•°å™¨ï¼š</strong></p> 
 <p>Â Â Â Â Â Â Â Â Â Â åœ¨ä¸€æ®µæ—¶é—´é—´éš”å†…ï¼Œå¤„ç†è¯·æ±‚çš„æœ€å¤§æ•°é‡å›ºå®šï¼Œè¶…è¿‡éƒ¨åˆ†ä¸åšå¤„ç†ã€‚</p> 
 <p>ï¼ˆ2ï¼‰<strong>æ¼æ¡¶ï¼š</strong></p> 
 <p>Â Â Â Â Â Â Â Â Â Â æ¼æ¡¶å¤§å°å›ºå®šï¼Œå¤„ç†é€Ÿåº¦å›ºå®šï¼Œä½†è¯·æ±‚è¿›å…¥é€Ÿåº¦ä¸å›ºå®šï¼ˆåœ¨çªå‘æƒ…å†µè¯·æ±‚è¿‡å¤šæ—¶ï¼Œä¼šä¸¢å¼ƒè¿‡å¤šçš„è¯·æ±‚ï¼‰ã€‚</p> 
 <p>ï¼ˆ3ï¼‰<strong>ä»¤ç‰Œæ¡¶ï¼š</strong></p> 
 <p>Â Â Â Â Â Â Â Â Â Â ä»¤ç‰Œæ¡¶çš„å¤§å°å›ºå®šï¼Œä»¤ç‰Œçš„äº§ç”Ÿé€Ÿåº¦å›ºå®šï¼Œä½†æ˜¯æ¶ˆè€—ä»¤ç‰Œï¼ˆå³è¯·æ±‚ï¼‰é€Ÿåº¦ä¸å›ºå®šï¼ˆå¯ä»¥åº”å¯¹ä¸€äº›æŸäº›æ—¶é—´è¯·æ±‚è¿‡å¤šçš„æƒ…å†µï¼‰ï¼›æ¯ä¸ªè¯·æ±‚éƒ½ä¼šä»ä»¤ç‰Œæ¡¶ä¸­å–å‡ºä»¤ç‰Œï¼Œå¦‚æœæ²¡æœ‰ä»¤ç‰Œåˆ™ä¸¢å¼ƒè¯¥æ¬¡è¯·æ±‚ã€‚</p> 
</blockquote> 
<h4><a id="_20"></a>è®¡æ•°å™¨é™æµâœ¨</h4> 
<p>ğŸº<strong>åœ¨ä¸€æ®µæ—¶é—´é—´éš”å†…ï¼Œå¤„ç†è¯·æ±‚çš„æœ€å¤§æ•°é‡å›ºå®šï¼Œè¶…è¿‡éƒ¨åˆ†ä¸åšå¤„ç†ã€‚</strong></p> 
<p>ä¸¾ä¸ªğŸŒ°,æ¯”å¦‚æˆ‘ä»¬è§„å®šå¯¹äºAæ¥å£ï¼Œæˆ‘ä»¬1åˆ†é’Ÿçš„è®¿é—®æ¬¡æ•°ä¸èƒ½è¶…è¿‡100æ¬¡ã€‚</p> 
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š</p> 
<p>ğŸˆåœ¨ä¸€å¼€ å§‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªè®¡æ•°å™¨counterï¼Œæ¯å½“ä¸€ä¸ªè¯·æ±‚è¿‡æ¥çš„æ—¶å€™ï¼Œcounterå°±åŠ 1ï¼Œå¦‚æœcounterçš„å€¼å¤§äº100å¹¶ä¸”è¯¥è¯·æ±‚ä¸ç¬¬ä¸€ä¸ªè¯·æ±‚çš„é—´éš”æ—¶é—´è¿˜åœ¨1åˆ†é’Ÿä¹‹å†…ï¼Œé‚£ä¹ˆè¯´æ˜è¯·æ±‚æ•°è¿‡å¤š,æ‹’ç»è®¿é—®ï¼›</p> 
<p>ğŸ¬å¦‚æœè¯¥è¯·æ±‚ä¸ç¬¬ä¸€ä¸ªè¯·æ±‚çš„é—´éš”æ—¶é—´å¤§äº1åˆ†é’Ÿï¼Œä¸”counterçš„å€¼è¿˜åœ¨é™æµèŒƒå›´å†…ï¼Œé‚£ä¹ˆå°±é‡ç½® counter,å°±æ˜¯è¿™ä¹ˆç®€å•ç²—æš´ã€‚</p> 
<p><img src="https://images2.imgbox.com/a3/44/BuddKL1r_o.png" alt="[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-pkGvVRdd-1647523333397)(/upload/2021/09/image-0cbbc44ec76d446896e989962e8122e5.png)]"></p> 
<p><strong>ä»£ç å®ç°ï¼š</strong> ğŸ˜</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>CountDownLatch<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>ExecutorService<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>Executors<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic<span class="token punctuation">.</span>AtomicInteger<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic<span class="token punctuation">.</span>AtomicLong<span class="token punctuation">;</span>

<span class="token comment">//è®¡æ•°å™¨ é™æµ</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CounterLimiter</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">//èµ·å§‹æ—¶é—´</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">long</span> startTime <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//æ—¶é—´é—´éš”1000ms</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">long</span> interval <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>

    <span class="token comment">//æ¯ä¸ªæ—¶é—´é—´éš”å†…ï¼Œé™åˆ¶æ•°é‡</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">long</span> limit <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

    <span class="token comment">//ç´¯åŠ å™¨</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> AtomicLong accumulator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicLong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * true ä»£è¡¨æ”¾è¡Œï¼Œè¯·æ±‚å¯å·²é€šè¿‡
     * false ä»£è¡¨é™åˆ¶ï¼Œä¸è®©è¯·æ±‚é€šè¿‡
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">tryAcquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">long</span> nowTime <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ¤æ–­æ˜¯å¦åœ¨ä¸Šä¸€ä¸ªæ—¶é—´é—´éš”å†…</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nowTime <span class="token operator">&lt;</span> startTime <span class="token operator">+</span> interval<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//å¦‚æœè¿˜åœ¨ä¸Šä¸ªæ—¶é—´é—´éš”å†…</span>
            <span class="token keyword">long</span> count <span class="token operator">=</span> accumulator<span class="token punctuation">.</span><span class="token function">incrementAndGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;=</span> limit<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//å¦‚æœä¸åœ¨ä¸Šä¸€ä¸ªæ—¶é—´é—´éš”å†…</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>CounterLimiter<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//é˜²æ­¢é‡å¤åˆå§‹åŒ–</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>nowTime <span class="token operator">&gt;</span> startTime <span class="token operator">+</span> interval<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    startTime <span class="token operator">=</span> nowTime<span class="token punctuation">;</span>
                    accumulator<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//å†æ¬¡è¿›è¡Œåˆ¤æ–­</span>
            <span class="token keyword">long</span> count <span class="token operator">=</span> accumulator<span class="token punctuation">.</span><span class="token function">incrementAndGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;=</span> limit<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token comment">// æµ‹è¯•</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

        <span class="token comment">//çº¿ç¨‹æ± ï¼Œç”¨äºå¤šçº¿ç¨‹æ¨¡æ‹Ÿæµ‹è¯•</span>
        ExecutorService pool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¢«é™åˆ¶çš„æ¬¡æ•°</span>
        AtomicInteger limited <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// çº¿ç¨‹æ•°</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> threads <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token comment">// æ¯æ¡çº¿ç¨‹çš„æ‰§è¡Œè½®æ•°</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> turns <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
        <span class="token comment">// åŒæ­¥å™¨</span>
        CountDownLatch countDownLatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CountDownLatch</span><span class="token punctuation">(</span>threads<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> start <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> threads<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            pool<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>

                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> turns<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

                        <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token function">tryAcquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token comment">// è¢«é™åˆ¶çš„æ¬¡æ•°ç´¯ç§¯</span>
                            limited<span class="token punctuation">.</span><span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">//ç­‰å¾…æ‰€æœ‰çº¿ç¨‹ç»“æŸ</span>
                countDownLatch<span class="token punctuation">.</span><span class="token function">countDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            countDownLatch<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">float</span> time <span class="token operator">=</span> <span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000F</span><span class="token punctuation">;</span>
        <span class="token comment">//è¾“å‡ºç»Ÿè®¡ç»“æœ</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"é™åˆ¶çš„æ¬¡æ•°ä¸ºï¼š"</span> <span class="token operator">+</span> limited<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token string">",é€šè¿‡çš„æ¬¡æ•°ä¸ºï¼š"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>threads <span class="token operator">*</span> turns <span class="token operator">-</span> limited<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"é™åˆ¶çš„æ¯”ä¾‹ä¸ºï¼š"</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> limited<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>threads <span class="token operator">*</span> turns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¿è¡Œçš„æ—¶é•¿ä¸ºï¼š"</span> <span class="token operator">+</span> time <span class="token operator">+</span> <span class="token string">"s"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<p><strong>è®¡æ•°å™¨é™æµçš„ä¸è¶³ï¼š</strong> ğŸ¤·â€â™€ï¸</p> 
<p>è¿™ä¸ªç®—æ³•è™½ç„¶ç®€å•ï¼Œä½†æ˜¯å­˜åœ¨<strong>ä¸´ç•Œé—®é¢˜</strong>ï¼Œæˆ‘ä»¬çœ‹ä¸‹å›¾ï¼š</p> 
<p><img src="https://images2.imgbox.com/70/3d/Bz4pLsAj_o.png" alt="[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-xUvgpono-1647523333398)(/upload/2021/09/image-d55d813bbcb544479109dd2248e90ff0.png)]"></p> 
<p>ğŸ‘‰ğŸ»ä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå‡è®¾æœ‰ä¸€ä¸ªæ¶æ„ç”¨æˆ·ï¼Œä»–åœ¨0:59æ—¶ï¼Œç¬é—´å‘é€äº†100ä¸ªè¯·æ±‚ï¼Œå¹¶ä¸”1:00åˆç¬é—´å‘é€äº†100ä¸ªè¯·æ±‚ï¼Œé‚£ä¹ˆå…¶å®è¿™ä¸ªç”¨æˆ·åœ¨ 1ç§’é‡Œé¢ï¼Œç¬é—´å‘é€äº†200ä¸ªè¯·æ±‚ã€‚</p> 
<p>ğŸ¦æˆ‘ä»¬åˆšæ‰è§„å®šçš„æ˜¯1åˆ†é’Ÿæœ€å¤š100ä¸ªè¯·æ±‚ï¼ˆè§„åˆ’çš„ååé‡ï¼‰ï¼Œä¹Ÿå°±æ˜¯æ¯ç§’é’Ÿæœ€å¤š1.7ä¸ªè¯·æ±‚ï¼Œç”¨æˆ·é€šè¿‡åœ¨æ—¶é—´çª—å£çš„é‡ç½®èŠ‚ç‚¹å¤„çªå‘è¯·æ±‚ï¼Œ å¯ä»¥ç¬é—´è¶…è¿‡æˆ‘ä»¬çš„é€Ÿç‡é™åˆ¶ã€‚</p> 
<p>ç”¨æˆ·æœ‰å¯èƒ½é€šè¿‡ç®—æ³•çš„è¿™ä¸ªæ¼æ´ï¼Œç¬é—´å‹å®æˆ‘ä»¬çš„åº”ç”¨ã€‚ğŸ™‡ğŸ»â€â™€ï¸</p> 
<p><br></p> 
<p><br></p> 
<h4><a id="_162"></a>æ¼æ¡¶é™æµâœ¨</h4> 
<p>ğŸ‹æ¼æ¡¶ç®—æ³•é™æµçš„åŸºæœ¬åŸç†ä¸ºï¼š<strong>æ°´ï¼ˆå¯¹åº”è¯·æ±‚ï¼‰ä»è¿›æ°´å£è¿›å…¥åˆ°æ¼æ¡¶é‡Œï¼Œæ¼æ¡¶ä»¥ä¸€å®šçš„é€Ÿåº¦å‡ºæ°´ï¼ˆè¯·æ±‚æ”¾è¡Œï¼‰ï¼Œå½“æ°´æµå…¥é€Ÿåº¦è¿‡å¤§ï¼Œæ¡¶å†…çš„æ€»æ°´é‡å¤§äºæ¡¶å®¹é‡ä¼šç›´æ¥æº¢å‡ºï¼Œè¯·æ±‚è¢«æ‹’ç»ã€‚</strong><br> å¤§è‡´çš„æ¼æ¡¶é™æµè§„åˆ™å¦‚ä¸‹ï¼šğŸ“<br> ï¼ˆ1ï¼‰è¿›æ°´å£ï¼ˆå¯¹åº”å®¢æˆ·ç«¯è¯·æ±‚ï¼‰ä»¥ä»»æ„é€Ÿç‡æµå…¥è¿›å…¥æ¼æ¡¶ã€‚<br> ï¼ˆ2ï¼‰æ¼æ¡¶çš„å®¹é‡æ˜¯å›ºå®šçš„ï¼Œå‡ºæ°´ï¼ˆæ”¾è¡Œï¼‰é€Ÿç‡ä¹Ÿæ˜¯å›ºå®šçš„ã€‚<br> ï¼ˆ3ï¼‰æ¼æ¡¶å®¹é‡æ˜¯ä¸å˜çš„ï¼Œå¦‚æœå¤„ç†é€Ÿåº¦å¤ªæ…¢ï¼Œæ¡¶å†…æ°´é‡ä¼šè¶…å‡ºäº†æ¡¶çš„å®¹é‡ï¼Œåˆ™åé¢æµå…¥çš„æ°´æ»´ä¼šæº¢å‡ºï¼Œè¡¨ç¤ºè¯·æ±‚æ‹’ç»ã€‚<br> <img src="https://images2.imgbox.com/16/42/OYGqHNyU_o.png" alt="[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-ohzhfhmz-1647523333399)(/upload/2021/09/image-afa56bce847f4d8b99e2dfd1eb3509aa.png)]"></p> 
<p>â­æ¼æ¡¶ç®—æ³•å…¶å®å¾ˆç®€å•ï¼Œå¯ä»¥ç²—ç•¥çš„è®¤ä¸ºå°±æ˜¯æ³¨æ°´æ¼æ°´è¿‡ç¨‹ï¼Œå¾€æ¡¶ä¸­ä»¥ä»»æ„é€Ÿç‡æµå…¥æ°´ï¼Œä»¥ä¸€å®šé€Ÿç‡æµå‡ºæ°´ï¼Œå½“æ°´è¶…è¿‡æ¡¶å®¹é‡ï¼ˆcapacityï¼‰åˆ™ä¸¢å¼ƒï¼Œå› ä¸ºæ¡¶å®¹é‡æ˜¯ä¸å˜çš„ï¼Œä¿è¯äº†æ•´ä½“çš„é€Ÿç‡ã€‚</p> 
<p>ä»¥ä¸€å®šé€Ÿç‡æµå‡ºæ°´ï¼Œ<br> <img src="https://images2.imgbox.com/e1/0a/LlvUclka_o.png" alt="[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-hFtmsnIH-1647523333399)(/upload/2021/09/image-c7d684d693f74fa5bf4077febb8fccbc.png)]"></p> 
<p><strong>å‰Šå³°ğŸ“ï¼š</strong> æœ‰å¤§é‡æµé‡è¿›å…¥æ—¶,ä¼šå‘ç”Ÿæº¢å‡º,ä»è€Œé™æµä¿æŠ¤æœåŠ¡å¯ç”¨</p> 
<p><strong>ç¼“å†²ğŸ“ï¼š</strong> ä¸è‡³äºç›´æ¥è¯·æ±‚åˆ°æœåŠ¡å™¨, ç¼“å†²å‹åŠ›</p> 
<p><strong>ä»£ç å®ç°ï¼š</strong> ğŸ˜</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>CountDownLatch<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>ExecutorService<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>Executors<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic<span class="token punctuation">.</span>AtomicInteger<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic<span class="token punctuation">.</span>AtomicLong<span class="token punctuation">;</span>

<span class="token comment">//æ¼æ–—é™æµ</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LeakBucketLimiter</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">//æ¡¶çš„å¤§å°</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">long</span> capacity <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token comment">//æµå‡ºé€Ÿç‡,æ¯ç§’ä¸¤ä¸ª</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">long</span> rate <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token comment">//å¼€å§‹æ—¶é—´</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">long</span> startTime <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ¡¶ä¸­å‰©ä½™çš„æ°´</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> AtomicLong water <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicLong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * true ä»£è¡¨æ”¾è¡Œï¼Œè¯·æ±‚å¯å·²é€šè¿‡
     * false ä»£è¡¨é™åˆ¶ï¼Œä¸è®©è¯·æ±‚é€šè¿‡
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">tryAcquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//å¦‚æœæ¡¶çš„ä½™é‡é—®0ï¼Œç›´æ¥æ”¾è¡Œ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>water<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            startTime <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            water<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//è®¡ç®—ä»å½“å‰æ—¶é—´åˆ°å¼€å§‹æ—¶é—´æµå‡ºçš„æ°´ï¼Œå’Œç°åœ¨æ¡¶ä¸­å‰©ä½™çš„æ°´</span>
        <span class="token comment">//æ¡¶ä¸­å‰©ä½™çš„æ°´</span>
        water<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>water<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startTime<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">*</span> rate<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é˜²æ­¢å‡ºç°&lt;0çš„æƒ…å†µ</span>
        water<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> water<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®æ–°çš„å¼€å§‹æ—¶é—´</span>
        startTime <span class="token operator">+=</span> <span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startTime<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span>
        <span class="token comment">//å¦‚æœå½“å‰æ°´å°äºå®¹é‡ï¼Œè¡¨ç¤ºå¯ä»¥æ”¾è¡Œ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>water<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            water<span class="token punctuation">.</span><span class="token function">incrementAndGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token comment">// æµ‹è¯•</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

        <span class="token comment">//çº¿ç¨‹æ± ï¼Œç”¨äºå¤šçº¿ç¨‹æ¨¡æ‹Ÿæµ‹è¯•</span>
        ExecutorService pool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¢«é™åˆ¶çš„æ¬¡æ•°</span>
        AtomicInteger limited <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// çº¿ç¨‹æ•°</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> threads <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token comment">// æ¯æ¡çº¿ç¨‹çš„æ‰§è¡Œè½®æ•°</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> turns <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
        <span class="token comment">// åŒæ­¥å™¨</span>
        CountDownLatch countDownLatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CountDownLatch</span><span class="token punctuation">(</span>threads<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> start <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> threads<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            pool<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>

                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> turns<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

                        <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token function">tryAcquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token comment">// è¢«é™åˆ¶çš„æ¬¡æ•°ç´¯ç§¯</span>
                            limited<span class="token punctuation">.</span><span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">//ç­‰å¾…æ‰€æœ‰çº¿ç¨‹ç»“æŸ</span>
                countDownLatch<span class="token punctuation">.</span><span class="token function">countDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            countDownLatch<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">float</span> time <span class="token operator">=</span> <span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000F</span><span class="token punctuation">;</span>
        <span class="token comment">//è¾“å‡ºç»Ÿè®¡ç»“æœ</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"é™åˆ¶çš„æ¬¡æ•°ä¸ºï¼š"</span> <span class="token operator">+</span> limited<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token string">",é€šè¿‡çš„æ¬¡æ•°ä¸ºï¼š"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>threads <span class="token operator">*</span> turns <span class="token operator">-</span> limited<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"é™åˆ¶çš„æ¯”ä¾‹ä¸ºï¼š"</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> limited<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>threads <span class="token operator">*</span> turns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¿è¡Œçš„æ—¶é•¿ä¸ºï¼š"</span> <span class="token operator">+</span> time <span class="token operator">+</span> <span class="token string">"s"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ¼æ¡¶çš„ä¸è¶³ï¼š</strong> ğŸ¤·â€â™€ï¸<br> æ¼æ¡¶çš„å‡ºæ°´é€Ÿåº¦å›ºå®šï¼Œä¹Ÿå°±æ˜¯è¯·æ±‚æ”¾è¡Œé€Ÿåº¦æ˜¯å›ºå®šçš„ã€‚<br> æ¼æ¡¶å‡ºå£çš„é€Ÿåº¦å›ºå®šï¼Œä¸èƒ½çµæ´»çš„åº”å¯¹åç«¯èƒ½åŠ›æå‡ã€‚æ¯”å¦‚ï¼Œé€šè¿‡åŠ¨æ€æ‰©å®¹ï¼Œåç«¯æµé‡ä»1000QPSæå‡åˆ°1WQPSï¼Œæ¼æ¡¶æ²¡æœ‰åŠæ³•ã€‚</p> 
<p><br></p> 
<p><br></p> 
<h4><a id="_290"></a>ä»¤ç‰Œæ¡¶é™æµâœ¨âœ¨âœ¨</h4> 
<p><strong>ğŸ¬ä»¤ç‰Œæ¡¶ç®—æ³•ä¸­æ–°è¯·æ±‚åˆ°æ¥æ—¶ä¼šä»æ¡¶é‡Œæ‹¿èµ°ä¸€ä¸ªä»¤ç‰Œï¼Œå¦‚æœæ¡¶å†…æ²¡æœ‰ä»¤ç‰Œå¯æ‹¿ï¼Œå°±æ‹’ç»æœåŠ¡ã€‚</strong> å½“ç„¶ï¼Œä»¤ç‰Œçš„æ•°é‡ä¹Ÿæ˜¯æœ‰ä¸Šé™çš„ã€‚ä»¤ç‰Œçš„æ•°é‡ä¸æ—¶é—´å’Œå‘æ”¾é€Ÿç‡å¼ºç›¸å…³ï¼Œæ—¶é—´æµé€çš„æ—¶é—´è¶Šé•¿ï¼Œä¼šä¸æ–­å¾€æ¡¶é‡ŒåŠ å…¥è¶Šå¤šçš„ä»¤ç‰Œï¼Œå¦‚æœä»¤ç‰Œå‘æ”¾çš„é€Ÿåº¦æ¯”ç”³è¯·é€Ÿåº¦å¿«ï¼Œä»¤ç‰Œæ¡¶ä¼šæ”¾æ»¡ä»¤ç‰Œï¼Œç›´åˆ°ä»¤ç‰Œå æ»¡æ•´ä¸ªä»¤ç‰Œæ¡¶ã€‚</p> 
<p>ä»¤ç‰Œæ¡¶é™æµå¤§è‡´çš„è§„åˆ™å¦‚ä¸‹ï¼šğŸ™‡ğŸ»â€â™€ï¸<br> ï¼ˆ1ï¼‰è¿›æ°´å£æŒ‰ç…§æŸä¸ªé€Ÿåº¦ï¼Œå‘æ¡¶ä¸­æ”¾å…¥ä»¤ç‰Œã€‚<br> ï¼ˆ2ï¼‰ä»¤ç‰Œçš„å®¹é‡æ˜¯å›ºå®šçš„ï¼Œä½†æ˜¯æ”¾è¡Œçš„é€Ÿåº¦ä¸æ˜¯å›ºå®šçš„ï¼Œåªè¦æ¡¶ä¸­è¿˜æœ‰å‰©ä½™ä»¤ç‰Œï¼Œä¸€æ—¦è¯·æ±‚è¿‡æ¥å°±èƒ½ç”³è¯·æˆåŠŸï¼Œç„¶åæ”¾è¡Œã€‚<br> ï¼ˆ3ï¼‰å¦‚æœä»¤ç‰Œçš„å‘æ”¾é€Ÿåº¦ï¼Œæ…¢äºè¯·æ±‚åˆ°æ¥é€Ÿåº¦ï¼Œæ¡¶å†…å°±æ— ç‰Œå¯é¢†ï¼Œè¯·æ±‚å°±ä¼šè¢«æ‹’ç»ã€‚</p> 
<p>æ€»ä¹‹ï¼Œä»¤ç‰Œçš„å‘é€é€Ÿç‡å¯ä»¥è®¾ç½®ï¼Œä»è€Œå¯ä»¥å¯¹çªå‘çš„å‡ºå£æµé‡è¿›è¡Œæœ‰æ•ˆçš„åº”å¯¹ã€‚<br> <img src="https://images2.imgbox.com/c5/93/p8GdaxYr_o.png" alt="[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-OlS9VCnB-1647523333401)(/upload/2021/09/image-f5b402eae3b2409c8939b34d8be41f9c.png)]"></p> 
<p><strong>ä»£ç å®ç°ï¼š</strong> ğŸ˜</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>CountDownLatch<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>ExecutorService<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>Executors<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic<span class="token punctuation">.</span>AtomicInteger<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic<span class="token punctuation">.</span>AtomicLong<span class="token punctuation">;</span>

<span class="token comment">//ä»¤ç‰Œæ¡¶</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TokenBucketLimiter</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//æ¡¶çš„å®¹é‡</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">long</span> capacity <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token comment">//æ”¾å…¥ä»¤ç‰Œçš„é€Ÿç‡,æ¯ç§’2ä¸ª</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">long</span> rate <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token comment">//ä¸Šæ¬¡æ”¾ç½®ä»¤ç‰Œçš„æ—¶é—´</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">long</span> lastTime <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ¡¶ä¸­ä»¤ç‰Œçš„ä½™é‡</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> AtomicLong tokenNum <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicLong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * true ä»£è¡¨æ”¾è¡Œï¼Œè¯·æ±‚å¯å·²é€šè¿‡
     * false ä»£è¡¨é™åˆ¶ï¼Œä¸è®©è¯·æ±‚é€šè¿‡
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">tryAcquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//æ›´æ–°æ¡¶ä¸­å‰©ä½™ä»¤ç‰Œçš„æ•°é‡</span>
        <span class="token keyword">long</span> now <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tokenNum<span class="token punctuation">.</span><span class="token function">addAndGet</span><span class="token punctuation">(</span><span class="token punctuation">(</span>now <span class="token operator">-</span> lastTime<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">*</span> rate<span class="token punctuation">)</span><span class="token punctuation">;</span>
        tokenNum<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>capacity<span class="token punctuation">,</span> tokenNum<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ›´æ–°æ—¶é—´</span>
        lastTime <span class="token operator">+=</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> lastTime<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span>
        <span class="token comment">//æ¡¶ä¸­è¿˜æœ‰ä»¤ç‰Œå°±æ”¾è¡Œ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>tokenNum<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            tokenNum<span class="token punctuation">.</span><span class="token function">decrementAndGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token comment">//æµ‹è¯•</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

        <span class="token comment">//çº¿ç¨‹æ± ï¼Œç”¨äºå¤šçº¿ç¨‹æ¨¡æ‹Ÿæµ‹è¯•</span>
        ExecutorService pool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¢«é™åˆ¶çš„æ¬¡æ•°</span>
        AtomicInteger limited <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// çº¿ç¨‹æ•°</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> threads <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token comment">// æ¯æ¡çº¿ç¨‹çš„æ‰§è¡Œè½®æ•°</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> turns <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
        <span class="token comment">// åŒæ­¥å™¨</span>
        CountDownLatch countDownLatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CountDownLatch</span><span class="token punctuation">(</span>threads<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> start <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> threads<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            pool<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>

                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> turns<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

                        <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token function">tryAcquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token comment">// è¢«é™åˆ¶çš„æ¬¡æ•°ç´¯ç§¯</span>
                            limited<span class="token punctuation">.</span><span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">//ç­‰å¾…æ‰€æœ‰çº¿ç¨‹ç»“æŸ</span>
                countDownLatch<span class="token punctuation">.</span><span class="token function">countDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            countDownLatch<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">float</span> time <span class="token operator">=</span> <span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000F</span><span class="token punctuation">;</span>
        <span class="token comment">//è¾“å‡ºç»Ÿè®¡ç»“æœ</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"é™åˆ¶çš„æ¬¡æ•°ä¸ºï¼š"</span> <span class="token operator">+</span> limited<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                <span class="token string">",é€šè¿‡çš„æ¬¡æ•°ä¸ºï¼š"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>threads <span class="token operator">*</span> turns <span class="token operator">-</span> limited<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"é™åˆ¶çš„æ¯”ä¾‹ä¸ºï¼š"</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> limited<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>threads <span class="token operator">*</span> turns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¿è¡Œçš„æ—¶é•¿ä¸ºï¼š"</span> <span class="token operator">+</span> time <span class="token operator">+</span> <span class="token string">"s"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p><strong>ä»¤ç‰Œæ¡¶çš„å¥½å¤„ï¼š</strong> ğŸš€ğŸš€ğŸš€<br> ä»¤ç‰Œæ¡¶çš„å¥½å¤„ä¹‹ä¸€å°±æ˜¯å¯ä»¥æ–¹ä¾¿åœ°åº”å¯¹ çªå‘å‡ºå£æµé‡ï¼ˆåç«¯èƒ½åŠ›çš„æå‡ï¼‰ã€‚</p> 
<p>æ¯”å¦‚ï¼Œå¯ä»¥æ”¹å˜ä»¤ç‰Œçš„å‘æ”¾é€Ÿåº¦ï¼Œç®—æ³•èƒ½æŒ‰ç…§æ–°çš„å‘é€é€Ÿç‡è°ƒå¤§ä»¤ç‰Œçš„å‘æ”¾æ•°é‡ï¼Œä½¿å¾—å‡ºå£çªå‘æµé‡èƒ½è¢«å¤„ç†ã€‚</p> 
<p><br></p> 
<p><img src="https://images2.imgbox.com/6e/2a/dxYg6hVg_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/800375dad409d8e37aa9c61a593f8be7/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">å²ä¸Šæœ€æ‹‰è·¨çš„å¯¼çº¿å¹³å·®ç¨‹åºï¼ˆ by C#ï¼‰</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/368d1db8f29d7ecde66a55afc8a9fbf2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">dockerç½‘ç»œæ–¹é¢ç®€å•é…ç½®</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ITå­¦ä¹ è€…åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>