<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Docker之Nacos的持久化和集群部署 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Docker之Nacos的持久化和集群部署" />
<meta property="og:description" content="注1：小插曲
由于虚拟机分配的内存为1G，开到第四个容器时，由于内存不够导致容器启动失败，重新设置4G内存后启动成功
ok，正式进入主题！
一、Docker mysql:5.7的持久化存储及远程连接 1、拉取相关镜像【目前网络模式为：bridge】 ①mysql镜像（docker mysql:5.7的持久化存储及远程连接）
docker pull mysql/mysql-server:5.7
注：后面的mysql标签是版本号，可选择，有：5.5/5.6/5.7/8.0
2、在宿主机中相关目录，用于挂载容器的相关数据 mkdir -p /data/mysql/{conf,data}
建立目录用来放置mysql数据的
3、添加my.cnf文件就相当于安装客户端mysql时需要添加的my.ini文件 添加到mysql中的conf目录下（conf就是前面我们自己创建的）
4、创建mysql5.7容器（同时启动） docker run -p 3306:3306 \
--name mysql \
-v /data/mysql/conf/my.cnf:/etc/my.cnf \
-v /data/mysql/data:/var/lib/mysql \
--privileged=true \
--restart=always \
-e MYSQL_ROOT_PASSWORD=123456 \
-d mysql/mysql-server:5.7 以上参数的解析如下：
-p 3306:3306：宿主机端口:容器端口
--name mysql：容器名字
-v：挂载宿主机的一个目录, 持久化存储的关键所在，将主机目录挂载到容器对应目录，分别是：配置文件、日志文件、数据文件
-v /data/mysql/conf:/etc/mysql/conf.d
-v /data/mysql/logs:/logs
-v /data/mysql/data:/var/lib/mysq
--privileged=true：使用该参数，container内的root拥有真正的root权限, 否则，container内的root只是外部的一个普通用户权限
--restart=always：容器自动启动参数，其值可以为[no,on-failure,always]
no为默认值，表示容器退出时，docker不自动重启容器
on-failure表示，若容器的退出状态非0，则docker自动重启容器,还可以指定重启次数，若超过指定次数未能启动容器则放弃
always表示，只要容器退出，则docker将自动重启容器
-e MYSQL_ROOT_PASSWORD=123456：设置root的密码
-d mysql/mysql-server:5.7：后台启动模式及使用的镜像
注意：
最好把没用的容器都清除掉，以防出现问题
清除所有容器：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/1984b97a5d792f794af2ac754683fcce/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-28T02:32:18+08:00" />
<meta property="article:modified_time" content="2022-12-28T02:32:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Docker之Nacos的持久化和集群部署</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>注1：小插曲<br>                   由于虚拟机分配的内存为1G，开到第四个容器时，由于内存不够导致容器启动失败，重新设置4G内存后启动成功<br><img alt="" height="498" src="https://images2.imgbox.com/26/47/J1VuGhji_o.png" width="672"></p> 
<p><img alt="" height="705" src="https://images2.imgbox.com/36/ea/IzCchJg6_o.png" width="736"></p> 
<hr> 
<p>ok，正式进入主题！</p> 
<h2>一、Docker mysql:5.7的持久化存储及远程连接</h2> 
<h3>1、拉取相关镜像【目前网络模式为：bridge】</h3> 
<p> ①mysql镜像（docker mysql:5.7的持久化存储及远程连接）</p> 
<blockquote> 
 <p>docker pull mysql/mysql-server:5.7</p> 
 <p>注：后面的mysql标签是版本号，可选择，有：5.5/5.6/5.7/8.0</p> 
</blockquote> 
<p><img alt="" height="579" src="https://images2.imgbox.com/e7/23/cA6w055g_o.png" width="821"></p> 
<h3> 2、在宿主机中相关目录，用于挂载容器的相关数据</h3> 
<blockquote> 
 <p>mkdir -p /data/mysql/{conf,data}</p> 
 <p>建立目录用来放置mysql数据的</p> 
</blockquote> 
<p><img alt="" height="582" src="https://images2.imgbox.com/44/0d/TDvzK4MF_o.png" width="786"></p> 
<h3>3、添加my.cnf文件就相当于安装客户端mysql时需要添加的my.ini文件</h3> 
<p>添加到mysql中的conf目录下（conf就是前面我们自己创建的）</p> 
<p><img alt="" height="676" src="https://images2.imgbox.com/99/24/CxIMESZf_o.png" width="1200"></p> 
<p><img alt="" height="74" src="https://images2.imgbox.com/a1/92/fyx4wcR5_o.png" width="547"></p> 
<h3>4、创建mysql5.7容器（同时启动） </h3> 
<blockquote> 
 <p>docker run -p 3306:3306 \<br>       --name mysql \<br>       -v /data/mysql/conf/my.cnf:/etc/my.cnf \<br>       -v /data/mysql/data:/var/lib/mysql \<br>       --privileged=true \<br>       --restart=always \<br>       -e MYSQL_ROOT_PASSWORD=123456 \<br>       -d mysql/mysql-server:5.7  </p> 
</blockquote> 
<p><img alt="" height="352" src="https://images2.imgbox.com/f5/d4/ItPGI9y0_o.png" width="745"> 以上参数的解析如下：</p> 
<blockquote> 
 <p>-p 3306:3306：宿主机端口:容器端口<br>     --name mysql：容器名字<br>     -v：挂载宿主机的一个目录, 持久化存储的关键所在，将主机目录挂载到容器对应目录，分别是：配置文件、日志文件、数据文件<br>     -v /data/mysql/conf:/etc/mysql/conf.d<br>     -v /data/mysql/logs:/logs<br>     -v /data/mysql/data:/var/lib/mysq<br>     --privileged=true：使用该参数，container内的root拥有真正的root权限, 否则，container内的root只是外部的一个普通用户权限<br>     --restart=always：容器自动启动参数，其值可以为[no,on-failure,always]<br>                       no为默认值，表示容器退出时，docker不自动重启容器<br>                       on-failure表示，若容器的退出状态非0，则docker自动重启容器,还可以指定重启次数，若超过指定次数未能启动容器则放弃<br>                       always表示，只要容器退出，则docker将自动重启容器<br>     -e MYSQL_ROOT_PASSWORD=123456：设置root的密码<br>     -d mysql/mysql-server:5.7：后台启动模式及使用的镜像</p> 
</blockquote> 
<blockquote> 
 <p><span style="color:#fe2c24;"><span style="background-color:#ffd900;">注意：</span></span></p> 
 <p>最好把没用的容器都清除掉，以防出现问题</p> 
 <p>清除所有容器：</p> 
 <p>docker rm -f $(docker ps -aq)</p> 
 <p><img alt="" height="80" src="https://images2.imgbox.com/96/64/YuX3vxXS_o.png" width="609"></p> 
 <p> 以及查看相关端口号是否被占用:</p> 
 <p>lsof -i:查看的端口号</p> 
 <p><img alt="" height="153" src="https://images2.imgbox.com/4b/76/vfhubWNj_o.png" width="749"></p> 
 <p> 查看某个端口的运行状态：</p> 
 <p>systemctl status mysqld</p> 
 <p><img alt="" height="293" src="https://images2.imgbox.com/be/61/dq3hdURE_o.png" width="795"></p> 
 <p> 关闭某个端口号的运行状态：</p> 
 <p>systemctl stop mysqld</p> 
 <p><img alt="" height="277" src="https://images2.imgbox.com/25/69/QfV16FKZ_o.png" width="806"></p> 
</blockquote> 
<h3>5、修改mysql运行Navicat远程连接</h3> 
<p>①进入mysql5.7容器</p> 
<blockquote> 
 <p>docker exec -it mysql /bin/bash</p> 
</blockquote> 
<p>②登录mysql服务器，之后输入</p> 
<blockquote> 
 <p>mysql -u root -p;</p> 
 <p>mysql密码:123456</p> 
</blockquote> 
<p>③给用户授权</p> 
<blockquote> 
 <p>grant all privileges on *.* to root@'%' identified by '123456' with grant option;  </p> 
</blockquote> 
<p>查看数据库字符集：</p> 
<blockquote> 
 <p> show variables like'character%';</p> 
</blockquote> 
<p>这三步操作步骤展示：</p> 
<p><img alt="" height="637" src="https://images2.imgbox.com/e7/61/Qa6LX9hx_o.png" width="826"></p> 
<p> ⑥.创建数据库nacos_config,并进行初始化</p> 
<p><img alt="" height="586" src="https://images2.imgbox.com/b9/a0/a2rnrjUo_o.png" width="618"></p> 
<p> 运行脚本</p> 
<p><img alt="" height="619" src="https://images2.imgbox.com/c1/c0/laIaxifp_o.png" width="1200"></p> 
<p> <img alt="" height="498" src="https://images2.imgbox.com/99/bd/0YtV6Dxj_o.png" width="585"></p> 
<hr> 
<h2>二、 nacos-docker镜像安装nacos并配置数据库(nacos单机版)【外网单节点部署】</h2> 
<p>OK，现在如果想用外网访问内部容器的可以使用桥接网络模式进行访问：<br> 步骤：【目前网络模式为：bridge】</p> 
<h3>1.拉取镜像</h3> 
<blockquote> 
 <p>docker  pull nacos/nacos-server:1.1.4</p> 
</blockquote> 
<p><img alt="" height="288" src="https://images2.imgbox.com/fc/24/L1ZtXVtC_o.png" width="652"></p> 
<p>拉取成功！</p> 
<h3>2.配置数据库(之前已完成)</h3> 
<h3>3.创建nacos容器</h3> 
<blockquote> 
 <p>docker run -d \<br>        -e PREFER_HOST_MODE=ip \<br>        -e MODE=standalone \<br>        -e SPRING_DATASOURCE_PLATFORM=mysql \<br>        -e MYSQL_MASTER_SERVICE_HOST=172.17.0.2 \<br>        -e MYSQL_MASTER_SERVICE_PORT=3306 \<br>        -e MYSQL_MASTER_SERVICE_USER=root \<br>        -e MYSQL_MASTER_SERVICE_PASSWORD=123456 \<br>        -e MYSQL_MASTER_SERVICE_DB_NAME=nacos_config \<br>        -e MYSQL_SLAVE_SERVICE_HOST=172.17.0.2 \<br>        -p 8848:8848 \<br>        --name nacos \<br>        --restart=always \<br>        nacos/nacos-server:1.1.4</p> 
</blockquote> 
<p><img alt="" height="255" src="https://images2.imgbox.com/65/6e/SplwiRcz_o.png" width="646"> </p> 
<p>参数解析：</p> 
<blockquote> 
 <p>docker run -d \                                                                              #后台支行模式<br>        -e PREFER_HOST_MODE=hostname \                                         #是否支持hostname，可选项：hostname/ip，默认值ip<br>        -e MODE=standalone \                                                                #cluster模式/standalone模式，可选项：cluster/standalone，默认值cluster<br>        -e SPRING_DATASOURCE_PLATFORM=mysql \                         #standalone支持 mysql，可选项：mysql/empty，默认值empty<br>        -e MYSQL_MASTER_SERVICE_HOST=172.17.0.2 \                      #mysql主节点数据库IP，这有个坑：因为网络模式为bridge重启系统后IP会变导致nacos的再次启动失败<br>        -e MYSQL_MASTER_SERVICE_PORT=3306 \                               #mysql主节点端口<br>        -e MYSQL_MASTER_SERVICE_USER=root \                                 #数据库用户名<br>        -e MYSQL_MASTER_SERVICE_PASSWORD=123456 \                 #数据库密码<br>        -e MYSQL_MASTER_SERVICE_DB_NAME=nacos_config \           #mysql主节点数据库名<br>        -e MYSQL_SLAVE_SERVICE_HOST=172.17.0.2 \                          #mysql从节点数据库IP<br>        -p 8848:8848 \                                                                              #主机端口映射<br>        --name nacos \                                                                             #容器名<br>        --restart=always \                                                                         #容器自动启动<br>        nacos/nacos-server:1.1.4                                                              #镜像名</p> 
 <p></p> 
 <p><span style="color:#fe2c24;"><span style="background-color:#ffd900;">注意：</span></span></p> 
 <p>注1：由于没有配置mysql的主、从集群、本以为MYSQL_SLAVE_SERVICE_HOST可以不用配置，但通过查看nacos容器内的config/application.properties文件，<br>                会发现这此值未设置默认值，所以会导致启动报错，容器启动不起来，这里可以与主数据库一致。还有一个解决方案就是<br>                ##删除从库的配置，将配置数据库数量改为1也行，后面例子就是这样做的 <br>                //-e MYSQL_SLAVE_SERVICE_HOST=172.17.0.2 \<br>                -e MYSQL_DATABASE_NUM=1 \</p> 
 <p>       注2：相关命令<br>                 #停止并删除所有容器<br>                 docker stop nacos &amp;&amp; docker rm nacos<br>                 #docker logs－查看docker容器日志<br>                 docker logs -f -t --tail=100 nacos</p> 
</blockquote> 
<h3>4.访问nacos</h3> 
<blockquote> 
 <p>   ip:8848/nacos<br>    http://192.168.3.128:8848/nacos</p> 
</blockquote> 
<p>登录进来 </p> 
<p><img alt="" height="731" src="https://images2.imgbox.com/ad/10/N1wv0ywW_o.png" width="769"></p> 
<p>查看容器的运行情况:</p> 
<blockquote> 
 <p>docker logs -f -t --tail=100 nacos</p> 
</blockquote> 
<p>启动成功则显示success：</p> 
<p><img alt="" height="748" src="https://images2.imgbox.com/25/3c/1Jquvwhz_o.png" width="823"> 这一步完成呢就代表着nacos搭建完成了，可以简单的测试一下。</p> 
<h3>5.测试</h3> 
<p>①进入控制器，并添加测试数据，新建配置test.yml并添加数据</p> 
<p>username：zs</p> 
<p><img alt="" height="790" src="https://images2.imgbox.com/ae/7a/TBqFCJqK_o.png" width="1200"></p> 
<p>②查看数据库是否更新</p> 
<p>数据库配置没有问题的话可以在表config_info中看到刚才新增的配置信息</p> 
<p>③在Linux控制台输入一下命令获得配置</p> 
<p>curl -X GET "http://192.168.3.128:8848/nacos/v1/cs/configs?dataId=test.yml&amp;group=DEFAULT_GROUP"</p> 
<p>即可获得配置信息。</p> 
<p><img alt="" height="93" src="https://images2.imgbox.com/ac/f5/2jEsKEI3_o.png" width="845"></p> 
<p>这样就拿到刚才我们所编辑的内容啦！ </p> 
<hr> 
<p> 但是这样是非常不安全的，nacos中的ip地址端口以及相关配置信息都会被外网所访问，所以我们会进入下一个环节，改为内网集群部署：</p> 
<h2>三、内网集群部署</h2> 
<p>优点：具备安全性和稳定性。</p> 
<p>还是老规矩为了接下来的演示，我将所有容器都删除，避免出现问题。</p> 
<p>删除所有容器：</p> 
<blockquote> 
 <p>docker rm -f $(docker ps -aq)</p> 
</blockquote> 
<p>既然容器删了，那么数据库也就连接不了了。</p> 
<p>步骤：【目前网络模式为：自定义网络mynet】</p> 
<h3>1.使用自定义网络mynet启动mysql容器</h3> 
<blockquote> 
 <p>docker run \<br>          --name mysql \<br>          --net mynet \<br>          --ip 192.168.0.11 \<br>          -v /data/mysql/conf/my.cnf:/etc/my.cnf \<br>          -v /data/mysql/data:/var/lib/mysql \<br>          --privileged=true \<br>          --restart=always \<br>          -e MYSQL_ROOT_PASSWORD=123456 \<br>          -d mysql/mysql-server:5.7</p> 
</blockquote> 
<p><img alt="" height="257" src="https://images2.imgbox.com/47/58/2cziyX7M_o.png" width="743"> </p> 
<p>①检查是否启动成功:</p> 
<blockquote> 
 <p>docker ps</p> 
</blockquote> 
<p>②守护进程方式进入容器</p> 
<blockquote> 
 <p>docker exec -it mysql /bin/bash</p> 
</blockquote> 
<p>③输入数据库账户和密码</p> 
<blockquote> 
 <p>mysql -u root -p</p> 
 <p>ex123456</p> 
</blockquote> 
<p><img alt="" height="263" src="https://images2.imgbox.com/6c/ac/Pg6e83gG_o.png" width="755"></p> 
<p>继续输入 :</p> 
<blockquote> 
 <p>show databases；</p> 
</blockquote> 
<p><img alt="" height="507" src="https://images2.imgbox.com/db/a1/LSRHUutu_o.png" width="728"></p> 
<p>这里我们可以看到在创建前面那个容器的时候创建的nacos_config文件，然后删除容器了，重新创建容器时，同样也会有这个文件，那么是什么原因呢？</p> 
<p>答：是因为挂载，在使用桥接模式挂载容器的时候，也就是创建第一个容器的时候，我们在容器中创建了该文件，那么既然挂载了，所有宿主机也会实时更新，创建同样的文件；即使把容器删除，宿主机中的文件是不会变动的，而这时候我们又重新创建了一个容器使用自定义网络模式挂载宿主机，那么容器就会自动创建该文件。</p> 
<h3>2.创建nacos集群    </h3> 
<blockquote> 
 <p>创建集群节点1：</p> 
 <p></p> 
 <p>docker run -d \<br>            --net mynet \<br>            --ip 192.168.0.21 \<br>            -e PREFER_HOST_MODE=ip \<br>            -e MODE=cluster \<br>            -e NACOS_SERVERS="192.168.0.22:8848 192.168.0.23:8848" \<br>            -e SPRING_DATASOURCE_PLATFORM=mysql \<br>            -e MYSQL_MASTER_SERVICE_HOST=192.168.0.11 \<br>            -e MYSQL_MASTER_SERVICE_PORT=3306 \<br>            -e MYSQL_MASTER_SERVICE_USER=root \<br>            -e MYSQL_MASTER_SERVICE_PASSWORD=123456 \<br>            -e MYSQL_MASTER_SERVICE_DB_NAME=nacos_config \<br>            -e MYSQL_DATABASE_NUM=1 \<br>            -e NACOS_SERVER_PORT=8848 \<br>            --name nacos01 \<br>            --restart=always \<br>            nacos/nacos-server:1.1.4</p> 
</blockquote> 
<blockquote> 
 <p>创建集群节点2：</p> 
 <p><br>          docker run -d \<br>            --net mynet \<br>            --ip 192.168.0.22 \<br>            -e PREFER_HOST_MODE=ip \<br>            -e MODE=cluster \<br>            -e NACOS_SERVERS="192.168.0.21:8848 192.168.0.23:8848" \<br>            -e SPRING_DATASOURCE_PLATFORM=mysql \<br>            -e MYSQL_MASTER_SERVICE_HOST=192.168.0.11 \<br>            -e MYSQL_MASTER_SERVICE_PORT=3306 \<br>            -e MYSQL_MASTER_SERVICE_USER=root \<br>            -e MYSQL_MASTER_SERVICE_PASSWORD=123456 \<br>            -e MYSQL_MASTER_SERVICE_DB_NAME=nacos_config \<br>            -e MYSQL_DATABASE_NUM=1 \<br>            -e NACOS_SERVER_PORT=8848 \<br>            --name nacos02 \<br>            --restart=always \<br>            nacos/nacos-server:1.1.4    </p> 
</blockquote> 
<blockquote> 
 <p>创建集群节点3：<br><br>          docker run -d \<br>            --net mynet \<br>            --ip 192.168.0.23 \<br>            -e PREFER_HOST_MODE=ip \<br>            -e MODE=cluster \<br>            -e NACOS_SERVERS="192.168.0.21:8848 192.168.0.22:8848" \<br>            -e SPRING_DATASOURCE_PLATFORM=mysql \<br>            -e MYSQL_MASTER_SERVICE_HOST=192.168.0.11 \<br>            -e MYSQL_MASTER_SERVICE_PORT=3306 \<br>            -e MYSQL_MASTER_SERVICE_USER=root \<br>            -e MYSQL_MASTER_SERVICE_PASSWORD=123456 \<br>            -e MYSQL_MASTER_SERVICE_DB_NAME=nacos_config \<br>            -e MYSQL_DATABASE_NUM=1 \<br>            -e NACOS_SERVER_PORT=8848 \<br>            --name nacos03 \<br>            --restart=always \<br>            nacos/nacos-server:1.1.4 </p> 
</blockquote> 
<p><img alt="" height="735" src="https://images2.imgbox.com/8b/95/PZZwy7UE_o.png" width="637"> </p> 
<h3>3.测试</h3> 
<p>容器创建完之后，不代表就启动了，输入以下命令可以查看是否跑完：</p> 
<blockquote> 
 <p>查看docker容器日志：</p> 
 <p>docker logs -f -t --tail=100 nacos</p> 
</blockquote> 
<p><img alt="" height="427" src="https://images2.imgbox.com/f7/d8/IsQcSZ34_o.png" width="692"></p> 
<p><img alt="" height="195" src="https://images2.imgbox.com/e7/5d/0diKh3UR_o.png" width="727"></p> 
<p>直到出现success才是启动完毕！ </p> 
<p>也可以通过访问任何一节点进行查看:</p> 
<blockquote> 
 <p>curl http://192.168.0.21:8848/nacos/index.html<br> curl http://192.168.0.22:8848/nacos/index.html   <br> curl http://192.168.0.23:8848/nacos/index.html</p> 
</blockquote> 
<p>如果出现拒绝访问则代表启动失败，可以删除重新创建了，若出现以下效果则代表启动成功：</p> 
<p><img alt="" height="574" src="https://images2.imgbox.com/29/55/9ArSQZdh_o.png" width="797"></p> 
<p> 同样的当我们在linux控制台输入以下内容，是可以看到text.yml文件中的内容的，只不过外网访问不到了：</p> 
<blockquote> 
 <p>curl -X GET "http://192.168.0.23:8848/nacos/v1/cs/configs?dataId=test.yml&amp;group=DEFAULT_GROUP"</p> 
</blockquote> 
<p><img alt="" height="90" src="https://images2.imgbox.com/e9/ca/DDStnuQh_o.png" width="760"></p> 
<hr> 
<p>所以这时候如何才能使外网能够访问我们内部呢，这里就需要使用到Nginx动态代理nacos集群啦！</p> 
<h2>四、Nginx动态代理Nacos集群</h2> 
<h3>1.创建nginx容器</h3> 
<blockquote> 
 <p>docker run \<br>        --name mynginx \<br>        -d -p 80:80 \<br>        -v /data/nginx/conf/nginx.conf:/etc/nginx/nginx.conf \<br>        -v /data/nginx/log:/var/log/nginx \<br>        -v /data/nginx/html:/usr/share/nginx/html \<br>        nginx:latest</p> 
</blockquote> 
<p><img alt="" height="133" src="https://images2.imgbox.com/53/78/NtCfcv2J_o.png" width="754"> </p> 
<h3>2.添加至自定义网络mynet并测试</h3> 
<blockquote> 
 <p>docker network connect mynet mynginx</p> 
</blockquote> 
<p><img alt="" height="113" src="https://images2.imgbox.com/22/39/ENiJOFTn_o.png" width="578"></p> 
<h3>3.修改nginx配置文件nginx.conf</h3> 
<p>首先要进入nginx的目录中去，找到原有的配置文件进行备份 </p> 
<p><img alt="" height="245" src="https://images2.imgbox.com/48/b3/w2HXImbG_o.png" width="693"></p> 
<p>然后将已经修改好的配置文件添加进去</p> 
<p><img alt="" height="410" src="https://images2.imgbox.com/94/52/4eYtCShh_o.png" width="1101"></p> 
<p> <img alt="" height="123" src="https://images2.imgbox.com/19/51/BQ35lbSK_o.png" width="551"></p> 
<p> 添加成功!</p> 
<p>已经编辑好的nginx.conf文件中的内容：</p> 
<p><img alt="" height="680" src="https://images2.imgbox.com/36/3b/xmSII6Ek_o.png" width="687"></p> 
<p> 由于修改了容器中的配置文件，所以需要重启容器：</p> 
<blockquote> 
 <p>docker restart mynginx</p> 
</blockquote> 
<p><img alt="" height="76" src="https://images2.imgbox.com/2c/e9/QInrGumw_o.png" width="637"></p> 
<h3>4.测试访问节点</h3> 
<p>浏览器输入：192.168.3.128/nacos/</p> 
<p> 访问成功！地址栏不会出现端口号以及nacas的相关配置信息。</p> 
<p><img alt="" height="834" src="https://images2.imgbox.com/01/2b/uJQQKesy_o.png" width="1200"></p> 
<p>在nginx.conf文件中，一共配置了三个节点，即使其中的一个节点挂了失效了，会重新找到其他的节点，依然能够访问成功！</p> 
<hr> 
<p>本篇内容分享到此结束，我们下期再见！ </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/52346509732f0b66eae8f1c33713b269/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">从数据分布的角度提高对抗样本的可迁移性</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ba93489fda450b9788d64b182f61336e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Field error in object ‘xxx‘ on field ‘xxx‘: rejected value [xx]；</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>