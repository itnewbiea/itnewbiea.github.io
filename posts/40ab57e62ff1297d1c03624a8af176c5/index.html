<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android自定义控件，可以滑动的导航栏(Navigation Bar) - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android自定义控件，可以滑动的导航栏(Navigation Bar)" />
<meta property="og:description" content="前段时间android项目中用到一个可以滑动的数量可变的导航栏，在网上也没找到合适的替代品，所以就自定义了个该控件，在此分享一下该控件，给有需要的人。
首先，来看看我们要实现的效果是什么样的。
上图就是我们要实现的最终效果图了，下面就说一下实现的过程。
考虑到能支持横向滑动，android提供的横向滑动的控件我选择了HorizontalScrollView作为基类，当然横向的ListView也是可以的，废话不多说先上代码。
public class CustomHorizontalScrollview extends HorizontalScrollView { Context context; int prevIndex = 0; public CenterLockHorizontalScrollview(Context context, AttributeSet attrs) { super(context, attrs); this.context = context; this.setSmoothScrollingEnabled(true); } public void setAdapter(Context context, CustomListAdapter mAdapter) { try { fillViewWithAdapter(mAdapter); } catch (ZeroChildException e) { e.printStackTrace(); } } public void fillViewWithAdapter(CustomListAdapter mAdapter) throws ZeroChildException { if (getChildCount() == 0) { throw new ZeroChildException( &#34;CenterLockHorizontalScrollView must have one child&#34;); } if (getChildCount() == 0 || mAdapter == null) return; ViewGroup parent = (ViewGroup) getChildAt(0); parent." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/40ab57e62ff1297d1c03624a8af176c5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-06-24T10:02:38+08:00" />
<meta property="article:modified_time" content="2016-06-24T10:02:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android自定义控件，可以滑动的导航栏(Navigation Bar)</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="white-space:pre"></span>前段时间android项目中用到一个可以滑动的数量可变的导航栏，在网上也没找到合适的替代品，所以就自定义了个该控件，在此分享一下该控件，给有需要的人。</p> 
<p><span style="white-space:pre"></span>首先，来看看我们要实现的效果是什么样的。</p> 
<p><img alt="" src="https://images2.imgbox.com/64/c3/zSpwr2Sv_o.png"><br> </p> 
<p>      上图就是我们要实现的最终效果图了，下面就说一下实现的过程。</p> 
<p><span style="white-space:pre"></span>考虑到能支持横向滑动，android提供的横向滑动的控件我选择了<span style="font-family:宋体; font-size:10.5pt; background-color:rgb(228,228,255)">HorizontalScrollView作为基类</span>，当然横向的ListView也是可以的，废话不多说先上代码。</p> 
<p></p> 
<pre><code class="language-java">public class CustomHorizontalScrollview extends HorizontalScrollView {
	Context context;
	int prevIndex = 0;

	public CenterLockHorizontalScrollview(Context context, AttributeSet attrs) {
		super(context, attrs);
		this.context = context;
		this.setSmoothScrollingEnabled(true);

	}

	public void setAdapter(Context context, CustomListAdapter mAdapter) {

		try {
			fillViewWithAdapter(mAdapter);
		} catch (ZeroChildException e) {

			e.printStackTrace();
		}
	}

	public void fillViewWithAdapter(CustomListAdapter mAdapter)
			throws ZeroChildException {
		if (getChildCount() == 0) {
			throw new ZeroChildException(
					"CenterLockHorizontalScrollView must have one child");
		}
		if (getChildCount() == 0 || mAdapter == null)
			return;

		ViewGroup parent = (ViewGroup) getChildAt(0);

		parent.removeAllViews();

		for (int i = 0; i &lt; mAdapter.getCount(); i++) {
			parent.addView(mAdapter.getView(i, null, parent));
		}
	}
}</code></pre> 
<pre><code class="language-java">fillViewWithAdapter数据变化后的刷新控件，所以在调用了notifyDataSetChanged()之后还有再调用一下fillViewWithAdapter()这个方法才能刷新自定义控件。</code></pre> 
<pre><code class="language-java">&lt;span style="font-family: 宋体; font-size: 10.5pt;"&gt;&lt;/span&gt;&lt;pre name="code" class="html"&gt;public class CustomListAdapter extends ArrayAdapter&lt;DepartmentBean&gt; implements View.OnClickListener{
	private  Context context;
	private ArrayList&lt;DepartmentBean&gt; list;
	int layoutId;
	Holder holder;
	public View view;
	public int currPosition = 0;
	private DepartmentItemCallback callback;
	public CustomListAdapter(Context context, int textViewResourceId,
			ArrayList&lt;DepartmentBean&gt; list) {
		super(context, android.R.layout.simple_list_item_1, list);
		this.context = context;
		this.list = list;
		layoutId = textViewResourceId;

	}

	@Override
	public int getCount() {
		return list.size();
	}

	@Override
	public DepartmentBean getItem(int position) {
		return list.get(position);
	}

	@Override
	public long getItemId(int i) {
		return 0;
	}

	@Override
	public View getView(final int position, View convertView, ViewGroup parent) {

		if (convertView == null) {
			convertView =  View.inflate(context, layoutId, null);
			holder = new Holder();
			holder.title = (TextView) convertView.findViewById(R.id.txtNewsSource);
			convertView.setTag(holder);
		} else {
			holder = (Holder) convertView.getTag();
		}
		if (position == list.size() - 1) {
			Drawable drawable = context.getResources().getDrawable(R.drawable.department_right);
			drawable.setBounds(0,0,drawable.getMinimumWidth(),drawable.getMinimumHeight());
			holder.title.setCompoundDrawables(null,null,drawable,null);
			holder.title.setBackgroundColor(Color.rgb(75,165,255));
		}else if (position == list.size() - 2) {
			Drawable drawable = context.getResources().getDrawable(R.drawable.department_right1);
			drawable.setBounds(0,0,drawable.getMinimumWidth(),drawable.getMinimumHeight());
			holder.title.setCompoundDrawables(null,null,drawable,null);
			holder.title.setBackgroundColor(Color.rgb(234,234,234));
		}else {
			Drawable drawable = context.getResources().getDrawable(R.drawable.department_right0);
			drawable.setBounds(0,0,drawable.getMinimumWidth(),drawable.getMinimumHeight());
			holder.title.setCompoundDrawables(null,null,drawable,null);
			holder.title.setBackgroundColor(Color.rgb(234,234,234));
		}
		String newsSource = getItem(position).getName();
		holder.title.setText(newsSource);
		holder.title.setTag(position);
		holder.title.setOnClickListener(this);
		Log.v("Test", "lo frm newsadpater");
		return convertView;
	}

	@Override
	public void onClick(View view) {
		int id = view.getId();
		if (id == R.id.txtNewsSource) {
			callback.onClick((Integer) view.getTag());
		}
	}


	private class Holder {
		public TextView title;

	}
	public int getCurrentPosition(){
		return currPosition;
	}

	@Override
	public void notifyDataSetChanged() {
		super.notifyDataSetChanged();
	}
}</code></pre> 
<br> 
<br> 
<p></p> 
<pre></pre> 
<pre><code class="language-java">&lt;span style="white-space:pre"&gt;	&lt;/span&gt;Adapter也贴一下，关于这个Adapter继承BaseAdapter或者其他的都行，看自己用什么方便用什么，要点在于Adapter的getView方法中位置不同，就要修改背景了。这里也就2个背景色，最后一个与其他的是有差别的，然后再是每个item的形状都是不规则的，所以就把它分为两部分，一部分用颜色填充另一部分使用png图片放置到右侧就能达到想要的效果了。那么单个的item的布局就很简单的了，右侧的图片直接使用drawableRight,下面item布局代码放上代码。</code></pre> 
<pre><code class="language-java">&lt;pre name="code" class="java"&gt;&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="42dp"
    android:layout_gravity="center"
    android:orientation="vertical" &gt;
    &lt;TextView
        android:id="@+id/txtNewsSource"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:gravity="center"
        android:background="#4ba5ff"
        android:text="移动部门"
        android:paddingLeft="10dp"
        android:drawableRight="@drawable/department_right"
        /&gt;
&lt;/RelativeLayout&gt;</code></pre> 
<pre><code class="language-java">
</code></pre> 
<p>改变右侧png图片在adapter中已经写了， setCompoundDrawables(Drawable left, Drawable top, Drawable right, Drawable bottom)方法四个参数分别是将图置于控件左、上、右、下。drawable.setBounds(0,0,drawable.getMinimumWidth(),drawable.getMinimumHeight())，setBounds()这个方法不能少，要获取到图的尺寸才能画上图，不然不会生效。</p> 
<p>最后放上<a target="_blank" href="http://download.csdn.net/detail/caicdd007/9558375" rel="noopener noreferrer">源代码</a>，也可以访问我的github <a target="_blank" href="http://github.com/xiaoyaomimi" rel="noopener noreferrer">点击查看</a>最新分享。</p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/92303f25037e5b904c3f52e164ba1341/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SQL Server百万级大数据量删除</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/db3467940cc894054f990cee1f0826d0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">理解赤池信息量（AIC）,贝叶斯信息量（BIC）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>