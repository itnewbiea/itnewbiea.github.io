<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python 常见文件的加密与解密 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python 常见文件的加密与解密" />
<meta property="og:description" content="一、代码1 代码如下（示例）：
import win32com.client, os, time from PyPDF2 import PdfFileWriter, PdfFileReader ###################### 对word加密 def word_encryption(path, password): # 若加密保存.docx时，覆盖原文件，则无法成功添加密码。但是保存为另一个文件名，则可以添加密码。 # 因此将A存为B，删A，再将B改为A。 dirname, tempname = os.path.split(path) path_temp = os.path.join(dirname, tempname) while os.path.exists(path_temp): tempname = f&#39;{len(tempname)}&#39; &#43; tempname path_temp = os.path.join(dirname, tempname) def w_encryption(fp, pt, pw): word_app = win32com.client.Dispatch(&#39;Word.Application&#39;) word_app.Visible = 0 word_app.DisplayAlerts = 0 doc = word_app.Documents.Open(fp, False, False, False, &#39;&#39;) doc.SaveAs2(pt, None, False, pw) doc.Close() word_app.Quit() w_encryption(path, path_temp, password) os.remove(path) # 删除原文件 os." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/28417176b60a352448c48eae5b635b20/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-02T21:00:49+08:00" />
<meta property="article:modified_time" content="2023-10-02T21:00:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python 常见文件的加密与解密</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1_0"></a>一、代码1</h2> 
<p>代码如下（示例）：</p> 
<pre><code class="prism language-c">import win32com<span class="token punctuation">.</span>client<span class="token punctuation">,</span> os<span class="token punctuation">,</span> time
from PyPDF2 import PdfFileWriter<span class="token punctuation">,</span> PdfFileReader
    
###################### 对word加密
def <span class="token function">word_encryption</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token operator">:</span>
    # 若加密保存<span class="token punctuation">.</span>docx时，覆盖原文件，则无法成功添加密码。但是保存为另一个文件名，则可以添加密码。
    # 因此将A存为B，删A，再将B改为A。
    dirname<span class="token punctuation">,</span> tempname <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    path_temp <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> tempname<span class="token punctuation">)</span>
    <span class="token keyword">while</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>path_temp<span class="token punctuation">)</span><span class="token operator">:</span>
        tempname <span class="token operator">=</span> f<span class="token char">'{len(tempname)}'</span> <span class="token operator">+</span> tempname
        path_temp <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> tempname<span class="token punctuation">)</span>

    def <span class="token function">w_encryption</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> pt<span class="token punctuation">,</span> pw<span class="token punctuation">)</span><span class="token operator">:</span>
        word_app <span class="token operator">=</span> win32com<span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">Dispatch</span><span class="token punctuation">(</span><span class="token char">'Word.Application'</span><span class="token punctuation">)</span>
        word_app<span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token number">0</span>
        word_app<span class="token punctuation">.</span>DisplayAlerts <span class="token operator">=</span> <span class="token number">0</span>
        doc <span class="token operator">=</span> word_app<span class="token punctuation">.</span>Documents<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> False<span class="token punctuation">,</span> False<span class="token punctuation">,</span> False<span class="token punctuation">,</span> <span class="token char">''</span><span class="token punctuation">)</span>
        doc<span class="token punctuation">.</span><span class="token function">SaveAs2</span><span class="token punctuation">(</span>pt<span class="token punctuation">,</span> None<span class="token punctuation">,</span> False<span class="token punctuation">,</span> pw<span class="token punctuation">)</span>
        doc<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        word_app<span class="token punctuation">.</span><span class="token function">Quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
    <span class="token function">w_encryption</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> path_temp<span class="token punctuation">,</span> password<span class="token punctuation">)</span>
    os<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>  # 删除原文件
    os<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span>path_temp<span class="token punctuation">,</span> path<span class="token punctuation">)</span>  # 改临时文件名称为原文件名称
    time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>  # 不要删除<span class="token punctuation">,</span>不要删除


###################### 对excel加密
def <span class="token function">excel_encryption</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token operator">:</span>
    dirname<span class="token punctuation">,</span> tempname <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    path_temp <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> tempname<span class="token punctuation">)</span>
    <span class="token keyword">while</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>path_temp<span class="token punctuation">)</span><span class="token operator">:</span>
        tempname <span class="token operator">=</span> f<span class="token char">'{len(tempname)}'</span> <span class="token operator">+</span> tempname
        path_temp <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> tempname<span class="token punctuation">)</span>
    def <span class="token function">e_encryption</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> pt<span class="token punctuation">,</span> pw<span class="token punctuation">)</span><span class="token operator">:</span>
        excel_app <span class="token operator">=</span> win32com<span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">Dispatch</span><span class="token punctuation">(</span><span class="token string">"Excel.Application"</span><span class="token punctuation">)</span>
        excel_app<span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token number">0</span>
        excel_app<span class="token punctuation">.</span>DisplayAlerts <span class="token operator">=</span> <span class="token number">0</span>
        exl <span class="token operator">=</span> excel_app<span class="token punctuation">.</span>Workbooks<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> False<span class="token punctuation">,</span> False<span class="token punctuation">,</span> None<span class="token punctuation">,</span> <span class="token char">''</span><span class="token punctuation">)</span>
        exl<span class="token punctuation">.</span><span class="token function">SaveAs</span><span class="token punctuation">(</span>pt<span class="token punctuation">,</span> None<span class="token punctuation">,</span>  pw <span class="token punctuation">,</span><span class="token char">''</span><span class="token punctuation">)</span>
        exl<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        excel_app<span class="token punctuation">.</span><span class="token function">Quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">e_encryption</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> path_temp<span class="token punctuation">,</span> password<span class="token punctuation">)</span>
    os<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>  # 删除原文件
    os<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span>path_temp<span class="token punctuation">,</span> path<span class="token punctuation">)</span>  # 改临时文件名称为原文件名称
    time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>  # 不要删除<span class="token punctuation">,</span>不要删除

###################### 对pdf加密
def <span class="token function">pdf_encryption</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token operator">:</span>
    dirname<span class="token punctuation">,</span> tempname <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    path_temp <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> tempname<span class="token punctuation">)</span>
    <span class="token keyword">while</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>path_temp<span class="token punctuation">)</span><span class="token operator">:</span>
        tempname <span class="token operator">=</span> f<span class="token char">'{len(tempname)}'</span> <span class="token operator">+</span> tempname
        path_temp <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> tempname<span class="token punctuation">)</span>
    def <span class="token function">p_encryption</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> pt<span class="token punctuation">,</span> pw<span class="token punctuation">)</span><span class="token operator">:</span>
        pdf_reader <span class="token operator">=</span> <span class="token function">PdfFileReader</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span>   #输入你想要操作的pdf文档的位置<span class="token operator">/</span>名称
        pdf_writer <span class="token operator">=</span> <span class="token function">PdfFileWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> page in <span class="token function">range</span><span class="token punctuation">(</span>pdf_reader<span class="token punctuation">.</span><span class="token function">getNumPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span>
            pdf_writer<span class="token punctuation">.</span><span class="token function">addPage</span><span class="token punctuation">(</span>pdf_reader<span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">)</span>
        pdf_writer<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>pw<span class="token punctuation">)</span>             #括号里面填写密码
        with <span class="token function">open</span><span class="token punctuation">(</span>pt<span class="token punctuation">,</span> <span class="token char">'wb'</span><span class="token punctuation">)</span> as out<span class="token operator">:</span>
            pdf_writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span>
    <span class="token function">p_encryption</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> path_temp<span class="token punctuation">,</span> password<span class="token punctuation">)</span>
    os<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>  # 删除原文件
    os<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span>path_temp<span class="token punctuation">,</span> path<span class="token punctuation">)</span>  # 改临时文件名称为原文件名称
    time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>  # 不要删除<span class="token punctuation">,</span>不要删除
    
###################### 对word加密时读取文件类型判断
def <span class="token function">elistdir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token operator">:</span>
    <span class="token keyword">for</span> file in os<span class="token punctuation">.</span><span class="token function">listdir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token operator">:</span>
        file_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> file<span class="token punctuation">)</span>
        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">isdir</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span> and file_path <span class="token operator">==</span> path<span class="token operator">:</span>  # 排除子路径
            <span class="token function">elistdir</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
            <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">print</span><span class="token expression"><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span></span></span>
        elif os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'.docx'</span><span class="token operator">:</span>
            <span class="token keyword">if</span> file_path <span class="token operator">!=</span> <span class="token char">''</span><span class="token operator">:</span>
                <span class="token function">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
                try<span class="token operator">:</span>
                    <span class="token function">word_encryption</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
                except<span class="token operator">:</span>
                    pass
        elif os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'.doc'</span><span class="token operator">:</span>
            <span class="token keyword">if</span> file_path <span class="token operator">!=</span> <span class="token char">''</span><span class="token operator">:</span>
                <span class="token function">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
                try<span class="token operator">:</span>
                    <span class="token function">word_encryption</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
                except<span class="token operator">:</span>
                    pass
        
        elif os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'.xlsx'</span><span class="token operator">:</span>
            <span class="token keyword">if</span> file_path <span class="token operator">!=</span> <span class="token char">''</span><span class="token operator">:</span>
                <span class="token function">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
                try<span class="token operator">:</span>
                    <span class="token function">excel_encryption</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
                except<span class="token operator">:</span>
                    pass
            
        elif os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'.xls'</span><span class="token operator">:</span>

            <span class="token keyword">if</span> file_path <span class="token operator">!=</span> <span class="token char">''</span><span class="token operator">:</span>
                <span class="token function">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
                try<span class="token operator">:</span>
                    <span class="token function">excel_encryption</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
                except<span class="token operator">:</span>
                    pass
        elif os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'.pdf'</span><span class="token operator">:</span>

            <span class="token keyword">if</span> file_path <span class="token operator">!=</span> <span class="token char">''</span><span class="token operator">:</span>
                <span class="token function">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
                try<span class="token operator">:</span>
                    <span class="token function">pdf_encryption</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
                except<span class="token operator">:</span>
                    pass       
                
        elif os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'.txt'</span><span class="token operator">:</span>

            <span class="token keyword">if</span> file_path <span class="token operator">!=</span> <span class="token char">''</span><span class="token operator">:</span>
                <span class="token function">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
                try<span class="token operator">:</span>
                    <span class="token function">txt_encryption</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
                except<span class="token operator">:</span>
                    pass 
# ###################### 对word解密
def <span class="token function">word_decryption</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token operator">:</span>
    # 若加密保存<span class="token punctuation">.</span>docx时，覆盖原文件，则无法成功添加密码。但是保存为另一个文件名，则可以添加密码。
    # 因此将A存为B，删A，再将B改为A。
    dirname<span class="token punctuation">,</span> tempname <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    path_temp <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> tempname<span class="token punctuation">)</span>
    <span class="token keyword">while</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>path_temp<span class="token punctuation">)</span><span class="token operator">:</span>
        tempname <span class="token operator">=</span> f<span class="token char">'{len(tempname)}'</span> <span class="token operator">+</span> tempname
        path_temp <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> tempname<span class="token punctuation">)</span>
    def <span class="token function">w_decryption</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> pt<span class="token punctuation">,</span> pw<span class="token punctuation">)</span><span class="token operator">:</span>
        word_app <span class="token operator">=</span> win32com<span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">Dispatch</span><span class="token punctuation">(</span><span class="token char">'Word.Application'</span><span class="token punctuation">)</span>
        word_app<span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token number">0</span>
        word_app<span class="token punctuation">.</span>DisplayAlerts <span class="token operator">=</span> <span class="token number">0</span>
        doc <span class="token operator">=</span> word_app<span class="token punctuation">.</span>Documents<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> False<span class="token punctuation">,</span> False<span class="token punctuation">,</span> False<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
        doc<span class="token punctuation">.</span><span class="token function">SaveAs2</span><span class="token punctuation">(</span>pt<span class="token punctuation">,</span> None<span class="token punctuation">,</span> False<span class="token punctuation">,</span> pw<span class="token punctuation">)</span>
        doc<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        word_app<span class="token punctuation">.</span><span class="token function">Quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
    <span class="token function">w_decryption</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> path_temp<span class="token punctuation">,</span> password<span class="token punctuation">)</span>
    os<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>  # 删除原文件
    os<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span>path_temp<span class="token punctuation">,</span> path<span class="token punctuation">)</span>  # 改临时文件名称为原文件名称
    time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>  # 不用删除

###################### 对word解密时读取文件类型判断
def <span class="token function">dlistdir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token operator">:</span>
    <span class="token keyword">for</span> file in os<span class="token punctuation">.</span><span class="token function">listdir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token operator">:</span>
        file_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> file<span class="token punctuation">)</span>
        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">isdir</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span> and file_path <span class="token operator">==</span> path<span class="token operator">:</span>  # 排除子路径
            <span class="token function">dlistdir</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
            <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">print</span><span class="token expression"><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span></span></span>
        elif os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'.docx'</span><span class="token operator">:</span>
            <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">list</span><span class="token expression">_name<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span></span></span>

            <span class="token keyword">if</span> file_path <span class="token operator">!=</span> <span class="token char">''</span><span class="token operator">:</span>
                <span class="token function">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
                try<span class="token operator">:</span>
                    <span class="token function">word_decryption</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token char">''</span><span class="token punctuation">)</span>
                except<span class="token operator">:</span>
                    pass


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token char">'__main__'</span><span class="token operator">:</span>
    key <span class="token operator">=</span> <span class="token char">'xh19970908'</span>  # 加密解密密匙
    filedir <span class="token operator">=</span> r<span class="token string">"C:\Xu-Data\问题记录"</span>  # 指定路径不包含子路径
    <span class="token function">elistdir</span><span class="token punctuation">(</span>filedir<span class="token punctuation">)</span>  # 遍历word
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'encrytion sucess\n Waiting...'</span><span class="token punctuation">)</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">time</span><span class="token expression"><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  # 设置时间随意操作</span></span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">dlistdir</span><span class="token expression"><span class="token punctuation">(</span>filedir<span class="token punctuation">)</span>  # 遍历word</span></span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">print</span><span class="token expression"><span class="token punctuation">(</span></span><span class="token char">'decrytion Done'</span><span class="token expression"><span class="token punctuation">)</span></span></span>
</code></pre> 
<h2><a id="2_178"></a>二、代码2</h2> 
<p>代码如下（示例）：</p> 
<pre><code class="prism language-c">import os

class <span class="token function">ecryption</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token operator">:</span>
    
    def <span class="token function">__init__</span><span class="token punctuation">(</span> self <span class="token punctuation">,</span> password <span class="token punctuation">,</span> ecryption_path <span class="token punctuation">,</span>save_path <span class="token punctuation">)</span><span class="token operator">:</span>
        self<span class="token punctuation">.</span>password <span class="token operator">=</span> password
        self<span class="token punctuation">.</span>ecryption_path <span class="token operator">=</span> ecryption_path
        self<span class="token punctuation">.</span>save_path <span class="token operator">=</span> save_path
        
    def <span class="token function">efiles</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token operator">:</span>
        cmd <span class="token operator">=</span> r<span class="token char">'C:\WinARA\WinRAR.exe a -p%s %s %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>password<span class="token punctuation">,</span> save_path <span class="token punctuation">,</span> ecryption_path<span class="token punctuation">)</span> #password为压缩密码
        os<span class="token punctuation">.</span><span class="token function">system</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
        <span class="token keyword">return</span> True

    def <span class="token function">elistdir</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token operator">:</span>
        <span class="token keyword">for</span> file in os<span class="token punctuation">.</span><span class="token function">listdir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token operator">:</span>
            file_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> file<span class="token punctuation">)</span>
        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">isdir</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span> and file_path <span class="token operator">==</span> path<span class="token operator">:</span>  # 排除子路径
            <span class="token function">elistdir</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
            <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">print</span><span class="token expression"><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span></span></span>
        elif os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'.docx'</span><span class="token operator">:</span>
            <span class="token keyword">if</span> file_path <span class="token operator">!=</span> <span class="token char">''</span><span class="token operator">:</span>
                <span class="token function">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
                try<span class="token operator">:</span>
                    <span class="token function">defiles</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
                except<span class="token operator">:</span>
                    pass
        elif os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'.doc'</span><span class="token operator">:</span>
            <span class="token keyword">if</span> file_path <span class="token operator">!=</span> <span class="token char">''</span><span class="token operator">:</span>
                <span class="token function">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
                try<span class="token operator">:</span>
                    <span class="token function">defiles</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
                except<span class="token operator">:</span>
                    pass
        
        elif os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'.xlsx'</span><span class="token operator">:</span>
            <span class="token keyword">if</span> file_path <span class="token operator">!=</span> <span class="token char">''</span><span class="token operator">:</span>
                <span class="token function">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
                try<span class="token operator">:</span>
                    <span class="token function">defiles</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
                except<span class="token operator">:</span>
                    pass
            
        elif os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'.xls'</span><span class="token operator">:</span>

            <span class="token keyword">if</span> file_path <span class="token operator">!=</span> <span class="token char">''</span><span class="token operator">:</span>
                <span class="token function">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
                try<span class="token operator">:</span>
                    <span class="token function">defiles</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
                except<span class="token operator">:</span>
                    pass
        elif os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'.pdf'</span><span class="token operator">:</span>

            <span class="token keyword">if</span> file_path <span class="token operator">!=</span> <span class="token char">''</span><span class="token operator">:</span>
                <span class="token function">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
                try<span class="token operator">:</span>
                    <span class="token function">defiles</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
                except<span class="token operator">:</span>
                    pass       
                
        elif os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">splitext</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'.txt'</span><span class="token operator">:</span>

            <span class="token keyword">if</span> file_path <span class="token operator">!=</span> <span class="token char">''</span><span class="token operator">:</span>
                <span class="token function">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
                try<span class="token operator">:</span>
                    <span class="token function">defiles</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
                except<span class="token operator">:</span>
                    pass 

    def <span class="token function">defiles</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token operator">:</span>
        cmd <span class="token operator">=</span> r<span class="token char">'C:\WinARA\WinRAR.exe a -p%s %s %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>password<span class="token punctuation">,</span> save_path <span class="token punctuation">,</span> ecryption_path<span class="token punctuation">)</span> #password为压缩密码
        os<span class="token punctuation">.</span><span class="token function">system</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
        <span class="token keyword">return</span> True

<span class="token keyword">if</span> __name__  <span class="token operator">==</span>  <span class="token char">'__main__'</span><span class="token operator">:</span>
    f <span class="token operator">=</span> <span class="token function">input</span><span class="token punctuation">(</span><span class="token char">'压缩文件夹或者单独文件:'</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token char">'密码:'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> f <span class="token operator">==</span> <span class="token char">'文件夹'</span><span class="token operator">:</span>
        ecryption_path1 <span class="token operator">=</span> r<span class="token char">'C:\Users\tuxia\Desktop\files'</span>
        save_path1 <span class="token operator">=</span> r<span class="token char">'C:\Users\tuxia\Desktop\xh\files.zip'</span>
        ep1 <span class="token operator">=</span> <span class="token function">ecryption</span><span class="token punctuation">(</span> password <span class="token punctuation">,</span> ecryption_path1 <span class="token punctuation">,</span>save_path1 <span class="token punctuation">)</span>
        ep1<span class="token punctuation">.</span><span class="token function">efiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token operator">:</span>
        ecryption_path2 <span class="token operator">=</span> r<span class="token char">'C:\Users\tuxia\Desktop\葛博士-论文.word'</span>
        save_path2 <span class="token operator">=</span> r<span class="token char">'C:\Users\tuxia\Desktop\xh\葛博士-论文.zip'</span>
        ep2 <span class="token operator">=</span> <span class="token function">ecryption</span><span class="token punctuation">(</span> password <span class="token punctuation">,</span> ecryption_path2 <span class="token punctuation">,</span>save_path2 <span class="token punctuation">)</span>
        ep2<span class="token punctuation">.</span><span class="token function">defiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="3_269"></a>三、代码3</h2> 
<p>代码如下（示例）：</p> 
<pre><code class="prism language-c">import os
password <span class="token operator">=</span> <span class="token string">""</span>
dirpath <span class="token operator">=</span> r<span class="token char">'C:\Users\tuxia\Desktop\xh'</span>#待压缩的文件路径及文件
outFullName <span class="token operator">=</span> r<span class="token char">'C:\Users\tuxia\Desktop\xh.zip'</span>#压缩文件的输出路径及文件名
cmd <span class="token operator">=</span> r<span class="token char">'C:\WinARA\WinRAR.exe a -p%s %s %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token char">'123456'</span><span class="token punctuation">,</span> outFullName<span class="token punctuation">,</span> dirpath<span class="token punctuation">)</span>#password为压缩密码
os<span class="token punctuation">.</span><span class="token function">system</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
import os
password <span class="token operator">=</span> <span class="token string">""</span>
dirpath <span class="token operator">=</span> r<span class="token char">'C:\Users\tuxia\Desktop\xh\t1.txt'</span> #待压缩的文件路径及文件
outFullName <span class="token operator">=</span> r<span class="token char">'C:\Users\tuxia\Desktop\xh\t1.rar'</span>#压缩文件的输出路径及文件名
cmd <span class="token operator">=</span> r'C<span class="token operator">:</span>\<span class="token string">"Program Files"</span>\WinRAR\WinRAR<span class="token punctuation">.</span>exe a <span class="token operator">-</span>p<span class="token operator">%</span>s <span class="token operator">%</span>s <span class="token operator">%</span>s' <span class="token operator">%</span> <span class="token punctuation">(</span>password<span class="token punctuation">,</span> outFullName<span class="token punctuation">,</span> dirpath<span class="token punctuation">)</span>#password为压缩密码
os<span class="token punctuation">.</span><span class="token function">system</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4e53eac479accd1ec1614b6382153c5a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python 指定word生成</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d0da51fb35ce6d4ab4a720a793a2c387/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python 文件查找</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>