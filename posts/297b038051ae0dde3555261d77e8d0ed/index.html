<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用iframe遇到的问题及解决 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用iframe遇到的问题及解决" />
<meta property="og:description" content="记录一下使用iframe遇到的bug 动态的iframe src与返回的bug 场景：iframe嵌入页面，有多个tab，切换tab修改iframe的src，显示不同的页面
&lt;ul&gt; &lt;li v-for=&#34;tab in tabList&#34; :key=&#34;tab.tabName&#34; class=&#34;tab-item&#34; :class=&#34;{ activeTab: activeTabName === tab.tabName }&#34; @click=&#34;changeTab(tab)&#34; &gt; {{ tab.tabName }} &lt;/li&gt; &lt;/ul&gt; &lt;iframe :src=&#34;iframePath&#34; frameborder=&#34;0&#34; width=&#34;100%&#34; height=&#34;600&#34; id=&#34;iframe&#34; &lt;/iframe&gt; data() { return { tabList: [ { path: &#34;http://www.test.com/firstPage.html&#34;, tabName: &#34;hover页面&#34;, }, { path: &#34;http://www.test.com/secondPage.html&#34;, tabName: &#34;关系图谱&#34;, }, { path: &#34;http://www.test.com/thirdPage.html&#34;, tabName: &#34;echart页面 &#34;, }, ], activeTabName: &#34;hover页面&#34;, iframePath: &#34;http://www.test.com/firstPage.html&#34;, }; }, methods: { changeTab(tab) { if(this.iframePath===tab.path) return this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/297b038051ae0dde3555261d77e8d0ed/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-24T22:39:06+08:00" />
<meta property="article:modified_time" content="2023-12-24T22:39:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用iframe遇到的问题及解决</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="iframebug_0"></a>记录一下使用iframe遇到的bug</h2> 
<h3><a id="iframe_srcbug_2"></a>动态的iframe src与返回的bug</h3> 
<p><strong>场景</strong>：iframe嵌入页面，有多个tab，切换tab修改iframe的src，显示不同的页面</p> 
<pre><code>    &lt;ul&gt;
      &lt;li
        v-for="tab in tabList"
        :key="tab.tabName"
        class="tab-item"
        :class="{ activeTab: activeTabName === tab.tabName }"
        @click="changeTab(tab)"
      &gt;
        {<!-- -->{ tab.tabName }}
      &lt;/li&gt;
    &lt;/ul&gt;
    &lt;iframe
      :src="iframePath"
      frameborder="0"
      width="100%"
      height="600"
      id="iframe"
   &lt;/iframe&gt;

  data() {
    return {
      tabList: [
        {
          path: "http://www.test.com/firstPage.html",
          tabName: "hover页面",
        },
        {
          path: "http://www.test.com/secondPage.html",
          tabName: "关系图谱",
        },
        {
          path: "http://www.test.com/thirdPage.html",
          tabName: "echart页面 ",
        },
      ],
      activeTabName: "hover页面",
      iframePath: "http://www.test.com/firstPage.html",
    };
  },
  methods: {
    changeTab(tab) {
       if(this.iframePath===tab.path) return
      this.activeTabName = tab.tabName;
      this.iframePath = tab.path;
    },
  },
</code></pre> 
<p><strong>操作步骤</strong>:切换tab，然后点击浏览器的返回，就会出现tab与页面内容对不上的情况</p> 
<p><strong>原因</strong>：修改iframe的src，window.history历史记录中也会添加一条记录（动态切换iframe的src会导致增加一条iframe的历史浏览记录）</p> 
<p><strong>解决方案</strong>：在切换src的时候把iframe给销毁再重新创建就行了。这样就是一个新的iframe，不会触发他的变更操作，也就不会往window.history中存入记录</p> 
<p>这种写法不太优雅,但是可以实现不添加历史记录：</p> 
<pre><code>      let parent = document.querySelector(".iframe-parent");

      let child = document.getElementById("iframe");

      let newElement = document.createElement("iframe");

      newElement.src = tab.path;

      newElement.id = "iframe";

      parent.replaceChild(newElement, child);
</code></pre> 
<p>由于vue中的key更改时会重新渲染这个组件,给iframe添加一个key,这样每次切换时，key不一样就会重新创建一个iframe，销毁原来的iframe,这样也能做到不添加历史记录：</p> 
<pre><code>    &lt;!-- 加了key会重新渲染iframe，不会往history中添加记录了 --&gt;

    &lt;iframe

      :src="iframePath"

      frameborder="0"

      width="100%"

      height="600"

      id="iframe"

      :key="iframePath"

    &gt;&lt;/iframe&gt;
</code></pre> 
<h3><a id="httphttps_99"></a>http与https的嵌入的问题</h3> 
<p>将已开发好的页面资源（http）通过iframe嵌入https的协议下，内容没有加载出来，结果发现控制台报错</p> 
<pre><code>Mixed Content: The page at 'https://' was loaded over HTTPS, but requested an insecure frame 'http://'. This request has been blocked; the content must be served over HTTPS.
</code></pre> 
<p><strong>混合内容</strong>：在某些情况下，HTTPS 站点也可能包含一些使用明文 HTTP 协议加载的元素，这将形成一个称为混合内容的情形，有时也称为“HTTP over HTTPS”</p> 
<p>1》主动混合内容：通过 HTTP 提供的元素或依赖项能够与整个网页交互并对网页进行更改，如js或api请求</p> 
<p>2》被动混合内容（显示混合内容）：未加密的 HTTP 内容仅限于站点上封装的并且无法与页面其余部分交互的元素，如图片与视频；攻击者可以阻止或替换通过 HTTP 加载的图片，但无法修改页面的其余部分</p> 
<p>大多数现代 Web 浏览器都在开发者控制台中提供针对混合内容的警告，并且阻止危险程度较高的混合内容类型。各种浏览器都有自己的一套规则，但一般而言，主动混合内容更有可能会被阻止，被动混合内容仅在开发者控制台中向用户提供混合内容警告</p> 
<p><strong>解决方案：</strong></p> 
<p>方案1：将外壳链接降为http</p> 
<p>方案2：将iframe的内容升级成https协议</p> 
<p>方案3：nginx代理</p> 
<p>第一种和第二种很容易被否决，因为要申请，流程比较麻烦</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4b1de2dca7ad8042f9476e9a44f6a657/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">毕业设计-基于深度学习的交通路面障碍物目标检测系统 YOLO python 卷积神经网络 人工智能</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d7118737bd8c416bb61a08101eb87252/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Matlab股票价格预测】基于BiLSTM双向长短期记忆网络的股票价格时间序列预测（附MATLAB代码）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>