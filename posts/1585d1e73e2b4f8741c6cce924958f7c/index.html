<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CentOS7通过yum安装httpd和php8.0 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CentOS7通过yum安装httpd和php8.0" />
<meta property="og:description" content="文章目录 前言一、配置firewalld二、安装httpd三、安装php8.0四、修改httpd配置五、修改php配置总结 前言 为了安装kodexplorer必须得部署php环境，所以首次接触了下php
记录一下自己安装php80并与httpd整合的过程
操作全是使用root权限进行操作
一、配置firewalld CentOS7默认使用firewall来配置防火墙
如果没有安装，则使用yum进行安装
yum install -y firewalld 启动服务
systemctl start firewalld 设置开机自启动
systemctl enable firewalld firewall的配置文件是以xml的格式，存储在 /usr/lib/firewalld/ 和 /etc/firewalld/ 目录中
可以通过命令行或者直接修改配置文件的方式修改firewall的配置
这里通过开放一下httpd和php80的端口
firewall-cmd --permanent --zone=public --add-port=80/tcp 重新加载防火墙
firewall-cmd --reload 二、安装httpd 使用yum直接安装。
yum install -y httpd 安装完成后启动服务
systemctl start httpd 查看httpd状态（没修改配置的话一般都能启动成功，配置我们后面再改）
systemctl status httpd 设置开机自启动
systemctl enable httpd 查看httpd版本（CentOS7 yum 安装的httpd版本目前是Apache/2.4.6）
httpd -V | head -n 1 这里可以通过自己创建个index文件简单验证一下服务是否正常
echo &#34;test&#34; &gt; /var/www/html/index.html 打开浏览器可以看到我们的测试主页（我使用的服务器IP是192.168.1.21）
通过yum安装的httpd默认文件和存放的目录是" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/1585d1e73e2b4f8741c6cce924958f7c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-13T13:53:47+08:00" />
<meta property="article:modified_time" content="2022-07-13T13:53:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CentOS7通过yum安装httpd和php8.0</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_4" rel="nofollow">前言</a></li><li><a href="#firewalld_10" rel="nofollow">一、配置firewalld</a></li><li><a href="#httpd_37" rel="nofollow">二、安装httpd</a></li><li><a href="#php80_72" rel="nofollow">三、安装php8.0</a></li><li><a href="#httpd_127" rel="nofollow">四、修改httpd配置</a></li><li><a href="#php_226" rel="nofollow">五、修改php配置</a></li><li><a href="#_231" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_4"></a>前言</h2> 
<p>为了安装kodexplorer必须得部署php环境，所以首次接触了下php<br> 记录一下自己安装php80并与httpd整合的过程<br> 操作全是使用root权限进行操作</p> 
<hr> 
<h2><a id="firewalld_10"></a>一、配置firewalld</h2> 
<p>CentOS7默认使用firewall来配置防火墙<br> 如果没有安装，则使用yum进行安装</p> 
<pre><code class="prism language-powershell">yum install <span class="token operator">-</span>y firewalld
</code></pre> 
<p>启动服务</p> 
<pre><code class="prism language-powershell">systemctl <span class="token function">start</span> firewalld
</code></pre> 
<p>设置开机自启动</p> 
<pre><code class="prism language-powershell">systemctl enable firewalld
</code></pre> 
<p>firewall的配置文件是以xml的格式，存储在 /usr/lib/firewalld/ 和 /etc/firewalld/ 目录中<br> 可以通过命令行或者直接修改配置文件的方式修改firewall的配置</p> 
<p>这里通过开放一下httpd和php80的端口</p> 
<pre><code class="prism language-powershell">firewall-cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>zone=public <span class="token operator">--</span><span class="token function">add-port</span>=80/tcp
</code></pre> 
<p>重新加载防火墙</p> 
<pre><code class="prism language-powershell">firewall-cmd <span class="token operator">--</span>reload
</code></pre> 
<h2><a id="httpd_37"></a>二、安装httpd</h2> 
<p>使用yum直接安装。</p> 
<pre><code class="prism language-powershell">yum install <span class="token operator">-</span>y httpd
</code></pre> 
<p>安装完成后启动服务</p> 
<pre><code class="prism language-powershell">systemctl <span class="token function">start</span> httpd
</code></pre> 
<p>查看httpd状态（没修改配置的话一般都能启动成功，配置我们后面再改）</p> 
<pre><code class="prism language-powershell">systemctl status httpd
</code></pre> 
<p>设置开机自启动</p> 
<pre><code class="prism language-powershell">systemctl enable httpd
</code></pre> 
<p>查看httpd版本（CentOS7 yum 安装的httpd版本目前是Apache/2.4.6）</p> 
<pre><code class="prism language-powershell">httpd <span class="token operator">-</span>V <span class="token punctuation">|</span> head <span class="token operator">-</span>n 1
</code></pre> 
<p>这里可以通过自己创建个index文件简单验证一下服务是否正常</p> 
<pre><code class="prism language-powershell"><span class="token function">echo</span> <span class="token string">"test"</span> &gt; <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>www/html/index<span class="token punctuation">.</span>html
</code></pre> 
<p>打开浏览器可以看到我们的测试主页（我使用的服务器IP是192.168.1.21）<br> <img src="https://images2.imgbox.com/71/ea/DngsJfJ6_o.png" alt="在这里插入图片描述"><br> 通过yum安装的httpd默认文件和存放的目录是<br> 服务目录： /etc/httpd<br> 主配置文件： /etc/httpd/conf/httpd.conf<br> 网站数据目录： /var/www/html<br> 访问日志： /var/log/httpd/access_log<br> 错误日志：/var/log/httpd/error_log</p> 
<h2><a id="php80_72"></a>三、安装php8.0</h2> 
<p>安装remi扩展源</p> 
<pre><code class="prism language-powershell">yum install <span class="token operator">-</span>y http:<span class="token operator">/</span><span class="token operator">/</span>rpms<span class="token punctuation">.</span>remirepo<span class="token punctuation">.</span>net/enterprise/remi-release-7<span class="token punctuation">.</span>rpm
</code></pre> 
<p>如果网不好的话可以考虑下清华软件源</p> 
<pre><code class="prism language-powershell">yum install https:<span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn/remi/enterprise/remi-release-7<span class="token punctuation">.</span>rpm
</code></pre> 
<p>确认一下能安装的php8.0和相关插件</p> 
<pre><code class="prism language-powershell">yum list <span class="token punctuation">|</span> grep php80
</code></pre> 
<p>安装php8.0和其他插件（插件功能可以自己查一下，这里把一些比较常用的都放进来了）</p> 
<pre><code class="prism language-powershell">yum <span class="token operator">-</span>y install −−enablerepo=remi-php80 php80 php80-php php80-php-xml php80-php-xmlrpc php80-php-pecl-mcrypt php80-php-fpm php80-php-pecl-apcu php80-php-mbstring php80-php-gd php80-php-json php80-php-pecl-json-post php80-php-pdo php80-php-mysqlnd php80-php-pecl-mysql php80-php-opcache php80-php-pear php80-php-soap php80-php-intl php80-php-pear
</code></pre> 
<p>确认安装结果</p> 
<pre><code class="prism language-powershell">yum list installed <span class="token punctuation">|</span> grep php
</code></pre> 
<p>通过remi安装的php的指令是php80，这里建立一下软链接</p> 
<pre><code class="prism language-powershell">ln <span class="token operator">-</span>sf <span class="token operator">/</span>usr/bin/php80 <span class="token operator">/</span>usr/bin/php
</code></pre> 
<p>查看安装的php版本</p> 
<pre><code class="prism language-powershell">php <span class="token operator">-</span>v
</code></pre> 
<p>启动php-fpm（有需要的话可以给服务改名，我这边就没改了）</p> 
<pre><code class="prism language-powershell">systemctl <span class="token function">start</span> php80-php-fpm
</code></pre> 
<p>设置为开机自启动</p> 
<pre><code class="prism language-powershell">systemctl enable php80-php-fpm
</code></pre> 
<p>重启一下httpd</p> 
<pre><code class="prism language-powershell">systemctl restart httpd
</code></pre> 
<p>这里可以通过自己创建个php文件简单验证一下服务是否正常</p> 
<pre><code class="prism language-powershell"><span class="token function">echo</span> <span class="token string">"&lt;?php phpinfo(); ?&gt;"</span> &gt; <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>www/html/info<span class="token punctuation">.</span>php
</code></pre> 
<p>打开浏览器可以看到我们的测试页面<br> <img src="https://images2.imgbox.com/dc/e8/Twrh7A4Y_o.png" alt="在这里插入图片描述"></p> 
<p>这样安装的php80的配置目录是/etc/opt/remi/php80/<br> 主配置文件是/etc/opt/remi/php80/php.ini</p> 
<p>到这里其实我们的部署就已经完成了，后面讲一下部分比较常用的配置修改</p> 
<h2><a id="httpd_127"></a>四、修改httpd配置</h2> 
<p>比较常用的就是修改httpd的监听端口，修改httpd的网站数据目录<br> 这里我们需要对/etc/httpd/conf/httpd.conf进行修改<br> 修改配置文件之前先对配置文件进行备份</p> 
<pre><code class="prism language-powershell"><span class="token function">cp</span> <span class="token operator">/</span>etc/httpd/conf/httpd<span class="token punctuation">.</span>conf <span class="token operator">/</span>etc/httpd/conf/httpd<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>bak
</code></pre> 
<ol><li>修改监听端口，我这里把端口修改为30080/tcp<br> <img src="https://images2.imgbox.com/54/7c/pb53vceg_o.png" alt="在这里插入图片描述"><br> 可在命令行执行sed指令进行修改</li></ol> 
<pre><code class="prism language-powershell">sed <span class="token operator">-</span>i <span class="token string">"42s/Listen 80/Listen 30080/g"</span> <span class="token operator">/</span>etc/httpd/conf/httpd<span class="token punctuation">.</span>conf
</code></pre> 
<p>因为30080为非标准端口，所以还得增加SELinux中的http端口（如果图方便可以直接关闭SELinux）</p> 
<pre><code class="prism language-powershell">getenforce 查看当前SELinux的模式
setenforce 0 关闭
setenforce 1 开启
</code></pre> 
<p>查看SELinux中http使用的端口</p> 
<pre><code class="prism language-powershell">semanage port <span class="token operator">-</span>l <span class="token punctuation">|</span> grep http
</code></pre> 
<p><img src="https://images2.imgbox.com/93/54/B816sFZE_o.png" alt="在这里插入图片描述"><br> 添加一下30080端口</p> 
<pre><code class="prism language-powershell">semanage port <span class="token operator">-</span>a <span class="token operator">-</span>t http_port_t <span class="token operator">-</span>p  tcp 30080
<span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">-</span>l是查询，<span class="token operator">-</span>a是添加
</code></pre> 
<p>再查看一下SELinux中http使用的端口<br> <img src="https://images2.imgbox.com/f8/50/0kAsPrXq_o.png" alt="在这里插入图片描述"><br> 添加成功</p> 
<p>重启httpd服务</p> 
<pre><code class="prism language-powershell">systemctl restart httpd
</code></pre> 
<p>防火墙关闭旧端口，开放新端口，并重新加载</p> 
<pre><code class="prism language-powershell">firewall-cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>zone=public <span class="token operator">--</span><span class="token function">remove-port</span>=80/tcp
firewall-cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>zone=public <span class="token operator">--</span><span class="token function">add-port</span>=30080/tcp
firewall-cmd <span class="token operator">--</span>reload
</code></pre> 
<ol start="2"><li>修改httpd的网站数据目录，我这里把目录修改为/home/wwwroot/<br> <img src="https://images2.imgbox.com/e5/78/VudT2cL7_o.png" alt="在这里插入图片描述"><br> 可在命令行执行sed指令进行修改，我这边是直接将原有的/var/www/html替换成/home/wwwroot</li></ol> 
<pre><code class="prism language-powershell">sed <span class="token operator">-</span>i <span class="token string">"s#/var/www/html#/home/wwwroot#g"</span> <span class="token operator">/</span>etc/httpd/conf/httpd<span class="token punctuation">.</span>conf 
</code></pre> 
<p><img src="https://images2.imgbox.com/21/ea/hFtJrU61_o.png" alt="在这里插入图片描述"><br> 中间的Option Indexes FollowSymLinks可以注释掉，它的作用是显示 Apache 目录列表<br> 如果你的文件根目录里有 index.html，浏览器就会显示 index.html的内容，如果没有 index.html，浏览器就会显示文件根目录的目录列表，目录列表包括文件根目录下的文件和子目录<br> 这里应该禁止掉（在前面加个#注释掉即可）</p> 
<p>创建目录</p> 
<pre><code class="prism language-powershell">mkdir <span class="token operator">-</span>p <span class="token operator">/</span>home/wwwroot
</code></pre> 
<p>需要修改新建目录的安全上下文<br> 查看默认目录的安全上下文</p> 
<pre><code class="prism language-powershell"><span class="token function">ls</span> <span class="token operator">-</span>lZd <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>www/html
</code></pre> 
<p><img src="https://images2.imgbox.com/c7/21/Nnq9fFIP_o.png" alt="在这里插入图片描述"><br> 修改新建目录的安全上下文</p> 
<pre><code class="prism language-powershell">semanage fcontext <span class="token operator">-</span>a <span class="token operator">-</span>t httpd_sys_content_t <span class="token operator">/</span>home/wwwroot/
semanage fcontext <span class="token operator">-</span>a <span class="token operator">-</span>t httpd_sys_content_t <span class="token operator">/</span>home/wwwroot/<span class="token operator">*</span>
</code></pre> 
<p>立即生效的命令</p> 
<pre><code class="prism language-powershell">restorecon <span class="token operator">-</span><span class="token function">Rv</span> <span class="token operator">/</span>home/wwwroot/
</code></pre> 
<p>查看新建目录的安全上下文<br> <img src="https://images2.imgbox.com/94/de/YYiVWYgQ_o.png" alt="在这里插入图片描述"><br> 到这步就基本没问题了，简单测试一下</p> 
<pre><code class="prism language-powershell"><span class="token function">echo</span> <span class="token string">"test"</span> &gt; <span class="token operator">/</span>home/wwwroot/index<span class="token punctuation">.</span>html
<span class="token function">echo</span> <span class="token string">"&lt;?php phpinfo(); ?&gt;"</span> &gt; <span class="token operator">/</span>home/wwwroot/info<span class="token punctuation">.</span>php
systemctl restart httpd
</code></pre> 
<p><img src="https://images2.imgbox.com/47/02/hUJvJ3MF_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/bf/00/ujdNxHI9_o.png" alt="在这里插入图片描述"><br> 另外，如果主页使用的是php，也应该在ifModule dir_module中添加index.php<br> <img src="https://images2.imgbox.com/c7/52/pZ4Z46l6_o.png" alt="在这里插入图片描述"><br> 在ifModule mine_module中添加一行AddType application/x-httpd-php .php<br> 如果需要将.txt、.html后缀文件也作为PHP文件解析的话，可以改为添加AddType application/x-httpd-php .php .html .txt<br> <img src="https://images2.imgbox.com/21/50/xe12ZyEY_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="php_226"></a>五、修改php配置</h2> 
<p>晚点再编辑，都是些常见配置项的说明</p> 
<hr> 
<h2><a id="_231"></a>总结</h2> 
<p>以上就是今天要讲的内容<br> 参考文档：<br> <a href="https://shimaichi.blog/centos7-php8/" rel="nofollow">初心者向け CentOS7.9 に PHP8.0をインストール</a><br> <a href="https://www.linuxprobe.com/basic-learning-10.html" rel="nofollow">使用Apache服务部署静态网站</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2734d74c0c9df6fee805b4cd2268a1bd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">leetCode 94. 二叉树的中序遍历</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f4f8fff8b16a7dc77f620e8cb76885ef/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">pytorch之常用函数整理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>