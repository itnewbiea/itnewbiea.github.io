<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>大数据——HBase数据库操作实例 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="大数据——HBase数据库操作实例" />
<meta property="og:description" content="大数据——四种数据库（MySQL,HBase,MongoDB,Redis）操作实例 问题描述： Student学生表
1. 根据上面给出的表格，用Hbase Shell模式设计student学生表格。
a) 设计完后，用scan指令浏览表的相关信息，给出截图。
b) 查询zhangsan 的Computer成绩,给出截图。
c) 修改lisi的Math成绩，改为95,给出截图。
2. 根据上面已经设计出的student，用Hbase API编程。
a) 添加数据：English:45 Math:89 Computer:100
b) 获取scofield的English成绩信息
解决问题： 1. 根据上面给出的表格，用Hbase Shell模式设计student学生表格。 设计表代码：（复制粘贴代码时，要删除注释部分，下同）
$ ssh localhost //检测自己的ssh服务器设置
$ cd /usr/local/hadoop
$ ./sbin/start-dfs.sh //启动Hadoop
$ jps 注：用以查看hadoop是否启动成功
$ cd /usr/local/hbase
$ bin/start-hbase.sh //启动hbase
$ jps 注：用以查看hbase是否启动成功
$ bin/hbase shell //打开hbase的shell操作
hbase(main):006:0&gt; create &#39;student&#39;,&#39;score&#39; //创建student，其包含一个列族score
hbase(main):007:0&gt; put &#39;student&#39;,&#39;zhangsan&#39;,&#39;score:English&#39;,&#39;69&#39; //添加行健，列限定符和写入单元格数据
hbase(main):008:0&gt; put &#39;student&#39;,&#39;zhangsan&#39;,&#39;score:Math&#39;,&#39;86&#39;
hbase(main):009:0&gt; put &#39;student&#39;,&#39;zhangsan&#39;,&#39;score:Computer&#39;,&#39;77&#39;
hbase(main):010:0&gt; put &#39;student&#39;,&#39;lisi&#39;,&#39;score:English&#39;,&#39;55&#39;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/761184ddd0041cc76921f6fe852d8d6a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-19T22:33:26+08:00" />
<meta property="article:modified_time" content="2020-05-19T22:33:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">大数据——HBase数据库操作实例</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4><a href="https://blog.csdn.net/weixin_43042683/article/details/106230370">大数据——四种数据库（MySQL,HBase,MongoDB,Redis）操作实例</a></h4> 
<h3>问题描述：</h3> 
<p style="margin-left:0pt;">                                                                    Student学生表</p> 
<p style="margin-left:0pt;"><img alt="" height="133" src="https://images2.imgbox.com/76/28/PeJAArtO_o.png" width="753"></p> 
<p style="margin-left:0pt;">1. 根据上面给出的表格，用Hbase Shell模式设计student学生表格。</p> 
<p style="margin-left:0pt;">     a) 设计完后，用scan指令浏览表的相关信息，给出截图。</p> 
<p style="margin-left:0pt;">     b) 查询zhangsan 的Computer成绩,给出截图。</p> 
<p style="margin-left:0pt;">     c) 修改lisi的Math成绩，改为95,给出截图。</p> 
<p style="margin-left:0pt;">2. 根据上面已经设计出的student，用Hbase API编程。</p> 
<p style="margin-left:0pt;">     a) 添加数据：English:45 Math:89 Computer:100</p> 
<p style="margin-left:0pt;"><img alt="" height="38" src="https://images2.imgbox.com/24/a4/EOraJlct_o.png" width="748"></p> 
<p>    b) 获取scofield的English成绩信息</p> 
<h3>解决问题：</h3> 
<h4>1. 根据上面给出的表格，用Hbase Shell模式设计student学生表格。</h4> 
<p style="margin-left:0pt;"><span style="color:#f33b45;">设计表代码：（复制粘贴代码时，要删除注释部分，下同）</span></p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">$ </span>ssh localhost<span style="color:#0000ff;"> //检测自己的ssh服务器设置</span></p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">$ </span>cd /usr/local/hadoop</p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">$ </span>./sbin/start-dfs.sh  <span style="color:#0000ff;">//启动Hadoop</span></p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">$ </span>jps     注：用以查看hadoop是否启动成功</p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">$ </span>cd /usr/local/hbase</p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">$ </span>bin/start-hbase.sh  <span style="color:#0000ff;">//启动hbase</span></p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">$ </span>jps     注：用以查看hbase是否启动成功</p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">$ </span>bin/hbase shell <span style="color:#0000ff;"> //打开hbase的shell操作</span></p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">hbase(main):006:0&gt; </span>create 'student','score' <span style="color:#0000ff;">//创建student，其包含一个列族score</span></p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">hbase(main):007:0&gt; </span>put 'student','zhangsan','score:English','69' <span style="color:#0000ff;">//添加行健，列限定符和写入单元格数据</span></p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">hbase(main):008:0&gt; </span>put 'student','zhangsan','score:Math','86'</p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">hbase(main):009:0&gt; </span>put 'student','zhangsan','score:Computer','77'</p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">hbase(main):010:0&gt; </span>put 'student','lisi','score:English','55'</p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">hbase(main):011:0&gt; </span>put 'student','lisi','score:Math','100'</p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">hbase(main):012:0&gt; </span>put 'student','lisi','score:Computer','88'</p> 
<p style="margin-left:0pt;"><span style="color:#f33b45;">对应的Linux终端运行截图：</span></p> 
<p style="margin-left:0pt;"><img alt="" height="275" src="https://images2.imgbox.com/9b/53/LfwwRW2x_o.png" width="507"></p> 
<p style="margin-left:0pt;"><strong>a) 设计完后，用scan指令浏览表的相关信息，给出截图。</strong></p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">hbase(main):013:0&gt; </span>scan 'student' <span style="color:#0000ff;">//查看student表中信息</span></p> 
<p style="margin-left:0pt;"><span style="color:#f33b45;">对应的Linux终端运行截图：</span></p> 
<p style="margin-left:0pt;"><img alt="" height="122" src="https://images2.imgbox.com/ed/47/qlQPb0iH_o.png" width="519"></p> 
<p style="margin-left:0pt;"><strong>b) 查询zhangsan 的Computer成绩,给出截图。</strong></p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">hbase(main):014:0&gt; </span>get 'student','zhangsan','score:Computer'<span style="color:#0000ff;">//</span><span style="color:#0000ff;">查询</span><span style="color:#0000ff;">zhangsan </span><span style="color:#0000ff;">的</span><span style="color:#0000ff;">Com</span><span style="color:#0000ff;">puter</span><span style="color:#0000ff;">成绩</span></p> 
<p style="margin-left:0pt;"><span style="color:#f33b45;">对应的Linux终端运行截图：</span></p> 
<p style="margin-left:0pt;"><img alt="" height="58" src="https://images2.imgbox.com/f8/c7/9BVz6pLw_o.png" width="388"></p> 
<p style="margin-left:0pt;"><strong>c) 修改lisi的Math成绩，改为95,给出截图。</strong></p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">hbase(main):015:0&gt; </span>put 'student','lisi','score:Math','95' <span style="color:#0000ff;">//</span><span style="color:#0000ff;">修改</span><span style="color:#0000ff;">lisi</span><span style="color:#0000ff;">的</span><span style="color:#0000ff;">Math成绩，</span><span style="color:#0000ff;">改</span><span style="color:#0000ff;">为95</span></p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">hbase(main):016:0&gt; </span>get 'student','lisi','score:Math'</p> 
<p style="margin-left:0pt;"><span style="color:#f33b45;">对应的Linux终端运行截图：</span></p> 
<p style="margin-left:0pt;"><img alt="" height="94" src="https://images2.imgbox.com/64/ce/t11mxYrg_o.png" width="387"></p> 
<h4 style="margin-left:0pt;">2. 根据上面已经设计出的student，用Hbase API编程</h4> 
<p style="margin-left:0pt;">（1）与使用MySQL的JAVA客户端相类似，建立Java Project，但请注意，建立project时，所使用的执行环境JRE为J2SE-1.5，如下图方框所示</p> 
<p style="margin-left:0pt;"><img alt="" height="417" src="https://images2.imgbox.com/a2/38/njYO170q_o.png" width="410"></p> 
<p style="margin-left:0pt;">（2）在工程中导入外部jar包：这里只需要导入hbase安装目录中的lib文件中的所有jar包如果没有jar包，可下载：<a href="https://download.csdn.net/download/weixin_43042683/12439546">https://download.csdn.net/download/weixin_43042683/12439546</a>）。如下图所示：</p> 
<p style="margin-left:0pt;"><img alt="" height="378" src="https://images2.imgbox.com/24/5c/Etweq5YQ_o.png" width="588"></p> 
<p style="margin-left:0pt;"><img alt="" height="441" src="https://images2.imgbox.com/28/6a/S8TiMQcy_o.png" width="586"></p> 
<p style="margin-left:0pt;"><strong>a) 添加数据：English:45 Math:89 Computer:100</strong></p> 
<p style="margin-left:0pt;">（1）新建class，并将如下代码复制到.java文件中，调试运行，给出结果截图。</p> 
<p style="margin-left:0pt;"><img alt="" height="88" src="https://images2.imgbox.com/6d/5e/VMkBB2bq_o.png" width="265"></p> 
<pre><code class="language-java">import java.io.IOException;
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.HBaseConfiguration;
import org.apache.hadoop.hbase.TableName;
import org.apache.hadoop.hbase.client.Admin;
import org.apache.hadoop.hbase.client.Connection;
import org.apache.hadoop.hbase.client.ConnectionFactory;
import org.apache.hadoop.hbase.client.Put;
import org.apache.hadoop.hbase.client.Table;


public class hbase_insert {

	/**
	 * @param args
	 */
      //三个静态成员对象
	  public static Configuration configuration;//管理HBase的配置信息
      public static Connection connection;//管理HBase的连接
      public static Admin admin;  //管理HBase数据库的表信息
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		 configuration  = HBaseConfiguration.create();//使用默认的HBase配置文件创建configuration          configuration.set("hbase.rootdir","hdfs://localhost:9000/hbase");//连接hbase
         try{
             connection = ConnectionFactory.createConnection(configuration);
             admin = connection.getAdmin();
         }catch (IOException e){
             e.printStackTrace();
         }
         try {//插入的信息
			insertRow("student","scofield","score","English","45");
			insertRow("student","scofield","score","Math","89");
			insertRow("student","scofield","score","Computer","100");
		} catch (IOException e) {//异常处理
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
         close();
	}
	 public static void insertRow(String tableName,String rowKey,String colFamily,
			 String col,String val) throws IOException {
         Table table = connection.getTable(TableName.valueOf(tableName));
         Put put = new Put(rowKey.getBytes());
         put.addColumn(colFamily.getBytes(), col.getBytes(), val.getBytes());
         table.put(put);
         table.close();
     }
      //关闭连接
	  public static void close(){
            try{
                if(admin != null){
                    admin.close();
                }
                if(null != connection){
                    connection.close();
                }
            }catch (IOException e){
                e.printStackTrace();
            }
        }
}</code></pre> 
<p><span style="color:#f33b45;"> Java运行结果：</span></p> 
<p> <img alt="" height="125" src="https://images2.imgbox.com/fd/54/mzP2xSDH_o.png" width="571"></p> 
<p><span style="color:#f33b45;">hbase检验结果：使用scan ‘student’查看数据是否被添加成功</span></p> 
<p><img alt="" height="274" src="https://images2.imgbox.com/86/26/JfnHkqbm_o.png" width="393"></p> 
<p><strong>b) 获取scofield的English成绩信息</strong></p> 
<p style="margin-left:0pt;">（1）获取scofield的English成绩信息，可以采用如下代码，调试运行，给出截图</p> 
<pre><code class="language-java">import java.io.IOException;
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.Cell;
import org.apache.hadoop.hbase.CellUtil;
import org.apache.hadoop.hbase.HBaseConfiguration;
import org.apache.hadoop.hbase.TableName;
import org.apache.hadoop.hbase.client.Admin;
import org.apache.hadoop.hbase.client.Connection;
import org.apache.hadoop.hbase.client.ConnectionFactory;
import org.apache.hadoop.hbase.client.Get;
import org.apache.hadoop.hbase.client.Put;
import org.apache.hadoop.hbase.client.Result;
import org.apache.hadoop.hbase.client.Table;

public class hbase_query {

	/**
	 * @param args
	 */
	  //三个静态成员对象
	  public static Configuration configuration;//管理HBase的配置信息
      public static Connection connection;//管理HBase的连接
      public static Admin admin;  //管理HBase数据库的表信息
	public static void main(String[] args) {
		// TODO Auto-generated method stub
configuration  = HBaseConfiguration.create();//使用默认的HBase配置文件创建configuration   
configuration.set("hbase.rootdir","hdfs://localhost:9000/hbase");//连接hbase         
try{
             connection = ConnectionFactory.createConnection(configuration);//连接hbase
             admin = connection.getAdmin();
         }catch (IOException e){
             e.printStackTrace();
         }
         try {
		getData("student","scofield","score","English");//获取scofield的English成绩信息
} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
         close();
	}
	  public static void getData(String tableName,String rowKey,String colFamily,
			  String col)throws  IOException{
          Table table = connection.getTable(TableName.valueOf(tableName));
          Get get = new Get(rowKey.getBytes());
          get.addColumn(colFamily.getBytes(),col.getBytes());
          Result result = table.get(get);//从指定的行的某些单元格中取出相应的值
          showCell(result);
          table.close();
      }
	  public static void showCell(Result result){//显示结果信息函数
          Cell[] cells = result.rawCells();
          for(Cell cell:cells){
              System.out.println("RowName:"+new String(CellUtil.cloneRow(cell))+" ");
              System.out.println("Timetamp:"+cell.getTimestamp()+" ");
              System.out.println("column Family:"+new String(CellUtil.cloneFamily(cell))+" ");
              System.out.println("row Name:"+new String(CellUtil.cloneQualifier(cell))+" ");
              System.out.println("value:"+new String(CellUtil.cloneValue(cell))+" ");
          }
      }
//关闭连接
	  public static void close(){
            try{
                if(admin != null){
                    admin.close();
                }
                if(null != connection){
                    connection.close();                }
            }catch (IOException e){
                e.printStackTrace();
            }
        }
}</code></pre> 
<p><span style="color:#f33b45;">Java 运行结果：</span></p> 
<p><img alt="" height="161" src="https://images2.imgbox.com/c8/42/5krzWltN_o.png" width="547"></p> 
<p style="margin-left:0pt;"><strong>PS：</strong>最后，别忘了停止hbase</p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">hbase(main):018:0&gt;</span> hbase(main):025:0&gt; exit</p> 
<p style="margin-left:0pt;"><span style="color:#86ca5e;">$ </span>bin/stop-hbase.sh</p> 
<p style="margin-left:0pt;"><span style="color:#f33b45;">linux终端运行截图：</span></p> 
<p style="margin-left:0pt;"><img alt="" height="65" src="https://images2.imgbox.com/98/d4/7dhqVHhU_o.png" width="436"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c5810456c6f8ac2b824ec4b210f6523a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">LeetCode JAVA 11. 盛最多水的容器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a011269f9e2770aba23e70ec7fbb5675/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL基本用法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>