<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Pandas多条件筛选 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Pandas多条件筛选" />
<meta property="og:description" content="1. ‘&amp;’和‘|’ import pandas as pd score={&#39;student&#39;:[&#39;LiLei&#39;,&#39;HanMeiMei&#39;,&#39;David&#39;,&#39;Mary&#39;,&#39;oldwang&#39;],&#39;chinese&#39;:[90,65,72,38,42],&#39;math&#39;:[68,32,75,60,92], &#39;english&#39;:[63,75,82,74,91],&#39;physics&#39;:[93,32,71,24,85]} data=pd.DataFrame(score) print(data) out: student chinese math english physics 0 LiLei 90 68 63 93 1 HanMeiMei 65 32 75 32 2 David 72 75 82 71 3 Mary 38 60 74 24 4 oldwang 42 92 91 85 #筛选数学大于60分且物理大于80分 data1=data.loc[(data.math&gt;60)&amp;(data.physics&gt;80)] print(data1) out: student chinese math english physics 0 LiLei 90 68 63 93 4 oldwang 42 92 91 85 #筛选语文大于80分或者物理低于60分 data2=data.loc[(data.chinese&gt;80)|(data.physics&lt;60)] print(data2) out: student chinese math english physics 0 LiLei 90 68 63 93 1 HanMeiMei 65 32 75 32 3 Mary 38 60 74 24 #筛选数学高于平均分，并且按照分数从高到低排列 data3=data[data[&#39;math&#39;]&gt;data[&#39;math&#39;]." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e662384ab684508679e5c01179fca6f2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-12T23:47:08+08:00" />
<meta property="article:modified_time" content="2023-06-12T23:47:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Pandas多条件筛选</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>1. ‘&amp;’和‘|’</h3> 
<pre><code class="language-python">import  pandas as pd

score={'student':['LiLei','HanMeiMei','David','Mary','oldwang'],'chinese':[90,65,72,38,42],'math':[68,32,75,60,92],
      'english':[63,75,82,74,91],'physics':[93,32,71,24,85]}

data=pd.DataFrame(score)

print(data)

out:
     student  chinese  math  english  physics
0      LiLei       90    68       63       93
1  HanMeiMei       65    32       75       32
2      David       72    75       82       71
3       Mary       38    60       74       24
4    oldwang       42    92       91       85

#筛选数学大于60分且物理大于80分

data1=data.loc[(data.math&gt;60)&amp;(data.physics&gt;80)]

print(data1)

out:
 student  chinese  math  english  physics
0    LiLei       90    68       63       93
4  oldwang       42    92       91       85


#筛选语文大于80分或者物理低于60分

data2=data.loc[(data.chinese&gt;80)|(data.physics&lt;60)]

print(data2)

out:
    student  chinese  math  english  physics
0      LiLei       90    68       63       93
1  HanMeiMei       65    32       75       32
3       Mary       38    60       74       24


#筛选数学高于平均分，并且按照分数从高到低排列
data3=data[data['math']&gt;data['math'].mean()].sort_values(by='math',ascending=False)

print(data3)

out:
student  chinese  math  english  physics
4  oldwang       42    92       91       85
2    David       72    75       82       71
0    LiLei       90    68       63       93</code></pre> 
<h3>2.isin</h3> 
<pre><code class="language-python">import  pandas as pd

score={'student':['LiLei','HanMeiMei','David','Mary','oldwang'],'chinese':[90,65,72,38,42],'math':[68,32,75,60,92],
      'english':[63,75,82,74,91],'physics':[93,32,71,24,85],'label':['A','C','B','C','A']}

data=pd.DataFrame(score)

print(data)

out:

     student  chinese  math  english  physics label
0      LiLei       90    68       63       93     A
1  HanMeiMei       65    32       75       32     C
2      David       72    75       82       71     B
3       Mary       38    60       74       24     C
4    oldwang       42    92       91       85     A


#筛选label为B或者C
data4=data.loc[data['label'].isin(['B','C']),:]

print(data4)

out:

  student  chinese  math  english  physics label
1  HanMeiMei       65    32       75       32     C
2      David       72    75       82       71     B
3       Mary       38    60       74       24     C


#当然也可以加取反~,查找不在B和C的

data5=data.loc[~data['label'].isin(['B','C']),:]

print(data5)

out:

  student  chinese  math  english  physics label
0    LiLei       90    68       63       93     A
4  oldwang       42    92       91       85     A</code></pre> 
<h3>3.str.contains</h3> 
<p>pandas可以用str.contains来模糊筛选，有点像SQL中的like</p> 
<pre><code class="language-python">#查找姓名中包含wang的同学

data6=data.loc[data['student'].str.contains('wang'),:]

print(data6)

out:

 student  chinese  math  english  physics label
4  oldwang       42    92       91       85     A</code></pre> 
<h3>4.Query</h3> 
<pre><code class="language-python">#查找语文大于70

data7=data.query('chinese&gt;70')

print(data7)

out:
  student  chinese  math  english  physics label
0   LiLei       90    68       63       93     A
2   David       72    75       82       71     B


# data.query('chinese&gt;70')==data[data.chinese&gt;70]
</code></pre> 
<h3>5.Filter</h3> 
<p>filter不筛选具体的数据，而是筛选特定的行和列。它支持三种筛选模式：</p> 
<p>        items：固定列名</p> 
<p>        regex：正则表达式</p> 
<p>        like:模糊查询</p> 
<pre><code class="language-python">#筛选语文和英语列
data8=data.filter(['chinese','english'])

print(data8)

out:

  chinese  english
0       90       63
1       65       75
2       72       82
3       38       74
4       42       91


#筛选列名中包含a的
data9=data.filter(regex='a',axis=1)

print(data9)

out:

 math label
0    68     A
1    32     C
2    75     B
3    60     C
4    92     A

#筛选索引中包含2的

data10=data.filter(like='2',axis=0)

print(data10)

out:

  student  chinese  math  english  physics label
2   David       72    75       82       71     B</code></pre> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/593b1f40134da5ff02f674bcdb6febae/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C&#43;&#43;编程(6)——类和对象的基本概念(二)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/39b7a09c535ad75f818e0599bf9b0216/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">一张图表上多个指标（第 04 部分）：晋升为一款智能交易系统</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>