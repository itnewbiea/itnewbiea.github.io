<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQL初学、精通者必看：10个学生成绩查询史上最强技巧全攻略 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SQL初学、精通者必看：10个学生成绩查询史上最强技巧全攻略" />
<meta property="og:description" content="SQL初学、精通者必看：10个学生成绩查询史上最强技巧全攻略 本文提供了一个含有学生、成绩、课程和教师信息的完整数据库，并为读者提供了 SQL 查询练习题，还包含了练习的答案以及解析。这些题目旨在帮助有一定SQL使用经验的读者更深入地了解学生成绩相关的知识，也有助于初学者提高其SQL使用技能。这些题目涉及学生成绩排名、平均成绩、选修课程及格率、选课信息等多个方面，且不同的题目有着不同的难度和解题思路。如果您是SQL查询方面的新手，这些题目可能会极具挑战性。但是，如果您已经具备一定的SQL使用经验，这些题目将是一个很好的检验和提高自己技能的途径。
一、完整数据库信息 – 创建课程表，用于存储课程信息 CREATE TABLE `course` ( `c_id` int(8) NOT NULL COMMENT &#39;课程ID&#39;, `c_name` varchar(16) DEFAULT NULL COMMENT &#39;课程名称&#39;, `t_id` int(8) DEFAULT NULL COMMENT &#39;教师ID&#39;, PRIMARY KEY (`c_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT=&#39;课程表&#39;; – 插入课程信息 INSERT INTO `course`(`c_id`,`c_name`,`t_id`) VALUES(1,&#39;语文&#39;,2),(2,&#39;数学&#39;,1),(3,&#39;英语&#39;,3); – 创建成绩表，用于存储学生课程成绩 CREATE TABLE `score` ( `s_id` int(8) DEFAULT NULL COMMENT &#39;学生ID&#39;, `c_id` int(8) DEFAULT NULL COMMENT &#39;课程ID&#39;, `s_score` int(8) DEFAULT NULL COMMENT &#39;成绩&#39;, INDEX `idx_score_cid`(`c_id`) COMMENT &#39;基于课程ID的索引&#39; ) ENGINE=InnoDB DEFAULT CHARSET=latin1 COMMENT=&#39;成绩表&#39;; – 插入学生课程成绩信息 INSERT INTO `score`(`s_id`,`c_id`,`s_score`) VALUES (1,1,80),(1,2,90),(1,3,99),(2,1,70),(2,2,60),(2,3,80), (3,1,80),(3,2,80),(3,3,80),(4,1,50),(4,2,30),(4,3,20), (5,1,76),(5,3,87),(6,1,31),(6,3,34),(7,3,89),(7,1,98); – 创建学生表，用于存储学生信息 CREATE TABLE `student` ( `s_id` int(8) NOT NULL AUTO_INCREMENT COMMENT &#39;学生ID&#39;, `s_name` varchar(16) DEFAULT NULL COMMENT &#39;学生姓名&#39;, `s_birth` date DEFAULT NULL COMMENT &#39;学生出生日期&#39;, `s_sex` char(1) DEFAULT NULL COMMENT &#39;学生性别&#39;, PRIMARY KEY (`s_id`) ) ENGINE=InnoDB AUTO_INCREMENT=10 DEFAULT CHARSET=utf8 COMMENT=&#39;学生表&#39;; – 插入学生信息 INSERT INTO `student`(`s_id`,`s_name`,`s_birth`,`s_sex`) VALUES (1,&#39;赵磊&#39;,&#39;2021-07-30&#39;,&#39;男&#39;),(2,&#39;钱电&#39;,&#39;2021-07-30&#39;,&#39;男&#39;), (3,&#39;孙峰&#39;,&#39;2021-07-29&#39;,&#39;男&#39;),(4,&#39;李白&#39;,&#39;2021-07-14&#39;,&#39;女&#39;), (5,&#39;二狗&#39;,&#39;2021-07-21&#39;,&#39;男&#39;),(6,&#39;吴兰&#39;,&#39;2021-07-07&#39;,&#39;女&#39;), (7,&#39;李顺&#39;,&#39;2021-07-13&#39;,&#39;女&#39;),(8,&#39;舟券&#39;,&#39;2021-09-01&#39;,&#39;男&#39;), (9,&#39;无邪&#39;,&#39;2021-07-07&#39;,&#39;男&#39;); – 创建教师表，用于存储教师信息 CREATE TABLE `teacher` ( `t_id` int(8) NOT NULL AUTO_INCREMENT COMMENT &#39;教师ID&#39;, `t_name` varchar(16) DEFAULT NULL COMMENT &#39;教师姓名&#39;, PRIMARY KEY (`t_id`) ) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8 COMMENT=&#39;教师表&#39;; – 插入教师信息 INSERT INTO `teacher`(`t_id`,`t_name`) VALUES(1,&#39;张三&#39;),(2,&#39;李四&#39;); 二、10个学生成绩查询题 问题1 - 查询&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/a1a3d7d426d74f94aae3b3c33e4e29c5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-25T11:44:44+08:00" />
<meta property="article:modified_time" content="2023-05-25T11:44:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQL初学、精通者必看：10个学生成绩查询史上最强技巧全攻略</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="SQL10_1"></a>SQL初学、精通者必看：10个学生成绩查询史上最强技巧全攻略</h2> 
<p>本文提供了一个含有学生、成绩、课程和教师信息的完整数据库，并为读者提供了 SQL 查询练习题，还包含了练习的答案以及解析。这些题目旨在帮助有一定SQL使用经验的读者更深入地了解学生成绩相关的知识，也有助于初学者提高其SQL使用技能。这些题目涉及学生成绩排名、平均成绩、选修课程及格率、选课信息等多个方面，且不同的题目有着不同的难度和解题思路。如果您是SQL查询方面的新手，这些题目可能会极具挑战性。但是，如果您已经具备一定的SQL使用经验，这些题目将是一个很好的检验和提高自己技能的途径。</p> 
<h3><a id="_7"></a>一、完整数据库信息</h3> 
<h4><a id="__9"></a>– 创建课程表，用于存储课程信息</h4> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>course<span class="token punctuation">`</span> <span class="token punctuation">(</span>
<span class="token punctuation">`</span>c_id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'课程ID'</span><span class="token punctuation">,</span>
<span class="token punctuation">`</span>c_name<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'课程名称'</span><span class="token punctuation">,</span>
<span class="token punctuation">`</span>t_id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'教师ID'</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>c_id<span class="token punctuation">`</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'课程表'</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="__20"></a>– 插入课程信息</h4> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span>course<span class="token punctuation">`</span><span class="token punctuation">(</span><span class="token punctuation">`</span>c_id<span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span>c_name<span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span>t_id<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'语文'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'数学'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'英语'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="__26"></a>– 创建成绩表，用于存储学生课程成绩</h4> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>score<span class="token punctuation">`</span> <span class="token punctuation">(</span>
<span class="token punctuation">`</span>s_id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'学生ID'</span><span class="token punctuation">,</span>
<span class="token punctuation">`</span>c_id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'课程ID'</span><span class="token punctuation">,</span>
<span class="token punctuation">`</span>s_score<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'成绩'</span><span class="token punctuation">,</span>
<span class="token keyword">INDEX</span> <span class="token punctuation">`</span>idx_score_cid<span class="token punctuation">`</span><span class="token punctuation">(</span><span class="token punctuation">`</span>c_id<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'基于课程ID的索引'</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>latin1 <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'成绩表'</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="__37"></a>– 插入学生课程成绩信息</h4> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span>score<span class="token punctuation">`</span><span class="token punctuation">(</span><span class="token punctuation">`</span>s_id<span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span>c_id<span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span>s_score<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">76</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="__46"></a>– 创建学生表，用于存储学生信息</h4> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>student<span class="token punctuation">`</span> <span class="token punctuation">(</span>
<span class="token punctuation">`</span>s_id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'学生ID'</span><span class="token punctuation">,</span>
<span class="token punctuation">`</span>s_name<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'学生姓名'</span><span class="token punctuation">,</span>
<span class="token punctuation">`</span>s_birth<span class="token punctuation">`</span> <span class="token keyword">date</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'学生出生日期'</span><span class="token punctuation">,</span>
<span class="token punctuation">`</span>s_sex<span class="token punctuation">`</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'学生性别'</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>s_id<span class="token punctuation">`</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">10</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'学生表'</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="__58"></a>– 插入学生信息</h4> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span>student<span class="token punctuation">`</span><span class="token punctuation">(</span><span class="token punctuation">`</span>s_id<span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span>s_name<span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span>s_birth<span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span>s_sex<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'赵磊'</span><span class="token punctuation">,</span><span class="token string">'2021-07-30'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'钱电'</span><span class="token punctuation">,</span><span class="token string">'2021-07-30'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'孙峰'</span><span class="token punctuation">,</span><span class="token string">'2021-07-29'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'李白'</span><span class="token punctuation">,</span><span class="token string">'2021-07-14'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'二狗'</span><span class="token punctuation">,</span><span class="token string">'2021-07-21'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'吴兰'</span><span class="token punctuation">,</span><span class="token string">'2021-07-07'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">'李顺'</span><span class="token punctuation">,</span><span class="token string">'2021-07-13'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'舟券'</span><span class="token punctuation">,</span><span class="token string">'2021-09-01'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'无邪'</span><span class="token punctuation">,</span><span class="token string">'2021-07-07'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="__69"></a>– 创建教师表，用于存储教师信息</h4> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>teacher<span class="token punctuation">`</span> <span class="token punctuation">(</span>
<span class="token punctuation">`</span>t_id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'教师ID'</span><span class="token punctuation">,</span>
<span class="token punctuation">`</span>t_name<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'教师姓名'</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>t_id<span class="token punctuation">`</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'教师表'</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="__79"></a>– 插入教师信息</h4> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span>teacher<span class="token punctuation">`</span><span class="token punctuation">(</span><span class="token punctuation">`</span>t_id<span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span>t_name<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="10_87"></a>二、10个学生成绩查询题</h3> 
<h4><a id="1__0102_89"></a>问题1 - 查询"01"课程比"02"课程成绩高的学生的信息及课程分数</h4> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> <span class="token string">'学生ID'</span><span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> <span class="token string">'学生姓名'</span><span class="token punctuation">,</span>
    sc<span class="token punctuation">.</span>s_score <span class="token keyword">AS</span> <span class="token string">'01课程分数'</span><span class="token punctuation">,</span> 
    sc2<span class="token punctuation">.</span>s_score <span class="token keyword">AS</span> <span class="token string">'02课程分数'</span>
<span class="token keyword">FROM</span> 
    student s 
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> score sc <span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc<span class="token punctuation">.</span>s_id <span class="token operator">AND</span> sc<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token string">'01'</span>
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> score sc2 <span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc2<span class="token punctuation">.</span>s_id <span class="token operator">AND</span> sc2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token string">'02'</span>
<span class="token keyword">WHERE</span> 
    sc<span class="token punctuation">.</span>s_score <span class="token operator">&gt;</span> sc2<span class="token punctuation">.</span>s_score<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>这是一个比较简单的SQL查询语句，使用INNER JOIN查询两个不同的课程成绩，然后使用WHERE子句将比较结果进行筛选返回满足条件的学生信息。</p> 
</blockquote> 
<h4><a id="2__60_109"></a>问题2 - 查询平均成绩小于60分的同学的学生编号和学生姓名和平均成绩（包括有成绩的和无成绩的）</h4> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> <span class="token string">'学生编号'</span><span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> <span class="token string">'学生姓名'</span><span class="token punctuation">,</span>
    <span class="token keyword">COALESCE</span><span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'平均成绩'</span>
<span class="token keyword">FROM</span> 
    student s 
    <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score sc <span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc<span class="token punctuation">.</span>s_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 
    s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> s<span class="token punctuation">.</span>s_name
<span class="token keyword">HAVING</span> 
    <span class="token function">AVG</span><span class="token punctuation">(</span><span class="token keyword">COALESCE</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>这个查询通过GROUP BY 和HAVING 条件子句来计算学生的平均成绩，并筛选出平均成绩小于60的学生信息。这个查询也考虑了学生没有成绩的情况，并将它们的平均成绩赋值为 0。</p> 
</blockquote> 
<h4><a id="3___130"></a>问题3 - 查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩</h4> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> <span class="token string">'学生编号'</span><span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> <span class="token string">'学生姓名'</span><span class="token punctuation">,</span>
    <span class="token function">COUNT</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>c_id<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'选课总数'</span><span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">COALESCE</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'总成绩'</span>
<span class="token keyword">FROM</span> 
    student s 
    <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score sc <span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc<span class="token punctuation">.</span>s_id
    <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> course c <span class="token keyword">ON</span> sc<span class="token punctuation">.</span>c_id <span class="token operator">=</span> c<span class="token punctuation">.</span>c_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 
    s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> s<span class="token punctuation">.</span>s_name<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>该查询使用左连接将学生表与成绩表和课程表连接起来，保证返回所有的学生信息。然后使用COUNT和SUM函数分别计算每个学生选修的课程总数和所有课程成绩的总和。</p> 
</blockquote> 
<h4><a id="4__0102_151"></a>问题4 - 查询学过编号为"01"并且也学过编号为"02"的课程的同学的信息</h4> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> <span class="token string">'学生编号'</span><span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> <span class="token string">'学生姓名'</span>
<span class="token keyword">FROM</span> 
    student s 
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> score sc <span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc<span class="token punctuation">.</span>s_id <span class="token operator">AND</span> sc<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token string">'01'</span>
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> score sc2 <span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc2<span class="token punctuation">.</span>s_id <span class="token operator">AND</span> sc2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token string">'02'</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>这个查询通过使用INNER JOIN将两个成绩表进行比较。仅返回学过编号为 ‘01’ 和编号为 ‘02’ 两门课程的学生信息。</p> 
</blockquote> 
<h4><a id="5__0102_168"></a>问题5 - 查询学过编号为"01"但是没有学过编号为"02"的课程的同学的信息</h4> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> <span class="token string">'学生编号'</span><span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> <span class="token string">'学生姓名'</span>
<span class="token keyword">FROM</span> 
    student s 
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> score sc <span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc<span class="token punctuation">.</span>s_id <span class="token operator">AND</span> sc<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token string">'01'</span>
    <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score sc2 <span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc2<span class="token punctuation">.</span>s_id <span class="token operator">AND</span> sc2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token string">'02'</span>
<span class="token keyword">WHERE</span> 
    sc2<span class="token punctuation">.</span>s_score <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>这个查询使用LEFT JOIN结合条件筛选出学过编号为 ‘01’ 但是没有学过编号为 ‘02’ 的学生信息。</p> 
</blockquote> 
<h4><a id="6___187"></a>问题6 - 查询没有学全所有课程的同学的信息</h4> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> <span class="token string">'学生编号'</span><span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> <span class="token string">'学生姓名'</span>
<span class="token keyword">FROM</span> 
    student s 
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> score sc <span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc<span class="token punctuation">.</span>s_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 
    s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> s<span class="token punctuation">.</span>s_name
<span class="token keyword">HAVING</span> 
    <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> sc<span class="token punctuation">.</span>c_id<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> course<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>该查询根据每个学生参加的课程数量进行分组。然后计算总课程数，并通过HAVING筛选出未学完所有课程的学生信息。</p> 
</blockquote> 
<h4><a id="7___207"></a>问题7 - 查询两门及其以上不及格课程的同学的学号，姓名及其不及格课程数</h4> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> <span class="token string">'学生编号'</span><span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> <span class="token string">'学生姓名'</span><span class="token punctuation">,</span>
    <span class="token keyword">COALESCE</span><span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'平均成绩'</span>
<span class="token keyword">FROM</span> 
    student s 
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> score sc <span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc<span class="token punctuation">.</span>s_id <span class="token operator">AND</span> sc<span class="token punctuation">.</span>s_score <span class="token operator">&lt;</span> <span class="token number">60</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 
    s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> s<span class="token punctuation">.</span>s_name
<span class="token keyword">HAVING</span> 
    <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> sc<span class="token punctuation">.</span>c_id<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>这个查询使用INNER JOIN 和GROUP BY来聚合学生成绩，并使用HAVING筛选出两门或以上超过不及格的课程的学生信息。</p> 
</blockquote> 
<h4><a id="8___228"></a>问题8 - 查询各科成绩最高分、最低分和平均分，以及及格率、中等率、优良率和优秀率</h4> 
<p>及格为&gt;=60，中等为：70-80，优良为：80-90，优秀为：&gt;=90</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
    c<span class="token punctuation">.</span>c_id <span class="token keyword">AS</span> <span class="token string">'课程ID'</span><span class="token punctuation">,</span>
    c<span class="token punctuation">.</span>c_name <span class="token keyword">AS</span> <span class="token string">'课程名称'</span><span class="token punctuation">,</span>
    <span class="token function">MAX</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'最高分'</span><span class="token punctuation">,</span>
    <span class="token function">MIN</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'最低分'</span><span class="token punctuation">,</span>
    <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'平均分'</span><span class="token punctuation">,</span>
    <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> s<span class="token punctuation">.</span>s_score <span class="token operator">&gt;=</span> <span class="token number">60</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'及格率'</span><span class="token punctuation">,</span>
    <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> s<span class="token punctuation">.</span>s_score <span class="token operator">&gt;=</span> <span class="token number">70</span> <span class="token operator">AND</span> s<span class="token punctuation">.</span>s_score <span class="token operator">&lt;</span> <span class="token number">80</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'中等率'</span><span class="token punctuation">,</span>
    <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> s<span class="token punctuation">.</span>s_score <span class="token operator">&gt;=</span> <span class="token number">80</span> <span class="token operator">AND</span> s<span class="token punctuation">.</span>s_score <span class="token operator">&lt;</span> <span class="token number">90</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'优良率'</span><span class="token punctuation">,</span>
    <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> s<span class="token punctuation">.</span>s_score <span class="token operator">&gt;=</span> <span class="token number">90</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'优秀率'</span>
<span class="token keyword">FROM</span>
    course c
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> score s <span class="token keyword">ON</span> c<span class="token punctuation">.</span>c_id <span class="token operator">=</span> s<span class="token punctuation">.</span>c_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
    c<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span> c<span class="token punctuation">.</span>c_name<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>这个查询分别计算了每个课程的最高分、最低分、平均分以及及格、中等、优良和优秀的百分比。这个查询演示了如何使用聚合函数和CASE语句来计算和分组数据。</p> 
</blockquote> 
<h4><a id="9___255"></a>问题9 - 按照平均成绩从高到低显示所有学生的信息和排名</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询每位学生的平均成绩和排名，并按照平均成绩进行排序</span>

<span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> <span class="token string">'学生编号'</span><span class="token punctuation">,</span>                         <span class="token comment">-- 选择学生表中的学生编号列，并将该列列别名定义为"学生编号"</span>
    s<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> <span class="token string">'学生姓名'</span><span class="token punctuation">,</span>                       <span class="token comment">-- 选择学生表中的学生姓名列，并将该列列别名定义为"学生姓名"</span>
    <span class="token function">AVG</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'平均成绩'</span><span class="token punctuation">,</span>                  <span class="token comment">-- 计算每位学生的平均成绩，并将该列列别名定义为"平均成绩"</span>
    <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>                       <span class="token comment">-- 使用子查询计算排名</span>
        <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> s2<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> <span class="token function">AVG</span><span class="token punctuation">(</span>sc2<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_score 
            <span class="token keyword">FROM</span> student s2 <span class="token keyword">JOIN</span> score sc2 <span class="token keyword">ON</span> s2<span class="token punctuation">.</span>s_id<span class="token operator">=</span>sc2<span class="token punctuation">.</span>s_id 
            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> s2<span class="token punctuation">.</span>s_id
        <span class="token punctuation">)</span> <span class="token keyword">AS</span> t2
        <span class="token keyword">WHERE</span> t2<span class="token punctuation">.</span>avg_score <span class="token operator">&gt;</span> <span class="token function">AVG</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> <span class="token operator">AND</span> t2<span class="token punctuation">.</span>s_id <span class="token operator">&lt;&gt;</span> s<span class="token punctuation">.</span>s_id     <span class="token comment">-- 当前学生的平均分数比其他学生的平均分数高时，排名+1</span>
    <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'排名'</span>                                      <span class="token comment">-- 将该列列别名定义为"排名"</span>
<span class="token keyword">FROM</span> 
    student s 
    <span class="token keyword">JOIN</span> score sc <span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id<span class="token operator">=</span>sc<span class="token punctuation">.</span>s_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 
    s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> s<span class="token punctuation">.</span>s_name                           <span class="token comment">-- 按学生编号和学生姓名进行分组</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 
    <span class="token function">AVG</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>                       <span class="token comment">-- 按平均成绩进行降序排列</span>
</code></pre> 
<blockquote> 
 <p>该查询使用了子查询以计算每个学生的排名，并使用AS语法在查询中为列指定了别名。在主查询的SELECT语句中，s.s_id, s.s_name和AVG(sc.s_score)分别是学生编号、学生姓名和平均成绩，而(SELECT COUNT()+1…)是计算出的排名。在使用子查询计算排名时，首先使用JOIN将学生表和成绩表连接，然后按学生编号进行分组，并计算每个学生的平均成绩。WHERE子句中的条件或排除了当前学生，以及那些平均分数高于当前学生但排名上比当前学生靠前的其他学生。最后，COUNT() + 1计算出当前学生的排名。在主查询中，按学生编号和学生姓名进行分组，然后计算每位学生的平均成绩和排名。在ORDER BY子句中按平均成绩进行降序排列。</p> 
</blockquote> 
<h5><a id="MySQL_8__SQL__SQL__284"></a>MySQL 8 以后的版本，可以使用窗口函数来完成分组后对某个字段的排序和排名。使用窗口函数可以减少代码量、简化 SQL 查询语句。以下是使用窗口函数的 SQL 查询语句：</h5> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> <span class="token string">'学生编号'</span><span class="token punctuation">,</span>                 <span class="token comment">-- 选择学生表中的学生编号列，并将该列列别名定义为"学生编号"</span>
    s<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> <span class="token string">'学生姓名'</span><span class="token punctuation">,</span>               <span class="token comment">-- 选择学生表中的学生姓名列，并将该列列别名定义为"学生姓名"</span>
    <span class="token function">AVG</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'平均分数'</span><span class="token punctuation">,</span>        <span class="token comment">-- 计算每位学生的平均成绩，并将该列列别名定义为"平均分数"</span>
    RANK<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span><span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token function">AVG</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>s_score<span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'排名'</span>    <span class="token comment">-- 使用RANK函数通过平均成绩进行排名，并将该列列别名定义为"排名"</span>
<span class="token keyword">FROM</span> 
    student s 
    <span class="token keyword">JOIN</span> score sc <span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc<span class="token punctuation">.</span>s_id     <span class="token comment">-- 使用学生表和成绩表进行连接</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 
    s<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> s<span class="token punctuation">.</span>s_name                <span class="token comment">-- 按学生编号和学生姓名进行分组</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 
    <span class="token string">'平均分数'</span> <span class="token keyword">DESC</span>                  <span class="token comment">-- 按平均成绩进行降序排列</span>
</code></pre> 
<blockquote> 
 <p>上述查询语句使用了 RANK() 窗口函数来计算排名。窗口函数 OVER() 定义了排序规则，我们将其设置为按照平均成绩从高到低排序。这样，RANK() 函数就会自动计算出每个学生的排名。</p> 
 <p>在 GROUP BY 语句中，我们分组查询每个学生的平均成绩，并将其命名为 avg_score。在最后的 ORDER BY 子句中，我们按照平均成绩从高到低进行排序。</p> 
</blockquote> 
<h4><a id="10__70_308"></a>问题10 - 查询任何一门课程成绩在70分以上的学生的姓名、课程名称和分数</h4> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
    s<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> <span class="token string">'学生姓名'</span><span class="token punctuation">,</span>
    c<span class="token punctuation">.</span>c_name <span class="token keyword">AS</span> <span class="token string">'课程名称'</span><span class="token punctuation">,</span>
    sc<span class="token punctuation">.</span>s_score <span class="token keyword">AS</span> <span class="token string">'分数'</span>
<span class="token keyword">FROM</span>
    student s
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> score sc <span class="token keyword">ON</span> s<span class="token punctuation">.</span>s_id <span class="token operator">=</span> sc<span class="token punctuation">.</span>s_id
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> course c <span class="token keyword">ON</span> sc<span class="token punctuation">.</span>c_id <span class="token operator">=</span> c<span class="token punctuation">.</span>c_id
<span class="token keyword">WHERE</span>
    sc<span class="token punctuation">.</span>s_score <span class="token operator">&gt;=</span> <span class="token number">70</span>
<span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>这个查询返回任何一名学生的分数超过70分的课程信息。如果多个学生分数超过70分，则只选择一个学生的信息返回，并使用LIMIT 1 来限制SELECT 子句返回的行数。</p> 
</blockquote> 
<p>从以上的SQL查询语句中，可以发现SQL语言的强大之处。通过巧妙的组合和运用各种SQL操作和函数，我们可以轻松地求出各种统计数据，快捷地查询所需信息。在实际开发中，我们应尽可能地熟练掌握SQL语言，善于发掘SQL语言的特性和优势，提高自己的开发效率和运维水平。</p> 
<p>总之，通过以上的问题和SQL查询语句的分析介绍，相信大家能更深入地理解SQL的运用及其丰富的操作手法和函数特性。对于SQL的学习及其技巧的掌握，更需要大家在实践中不断实践，享受其优越性和乐趣，深入挖掘其对数据整理、查询和分析的巨大价值。</p> 
<p>在学习过程中，我们应该尊重知识的来源，用积极的态度去学习和应用知识。如果您喜欢作者的内容，可以通过关注、点赞、分享等方式支持一下，这对于作者将是一份很好的鼓励。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a9e15af5e6e1b1cfd1594e6de36caaac/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java中正则表达式的转义问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/82d975f6ba1fc0eeba71810bea729775/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">计算机网络3：速率、带宽、时延、吞吐量、时延带宽积、往返时间和利用率</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>