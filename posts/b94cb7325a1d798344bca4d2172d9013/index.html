<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>网络层协议 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="网络层协议" />
<meta property="og:description" content="目录
一.网络层的功能
二.IP数据包头的格式
三.ICMP
1.ICMP协议功能介绍
2.ICMP协议的封装
3.ping命令的基本使用
四.ARP协议和RARP协议
1.ARP
2.RARP
3.Windows系统中的ARP协议
4.华为ensp中ARP命令
五.ARP攻击与ARP欺骗
1.arp攻击
2.arp欺骗
总结
一.网络层的功能 定义了基于IP地址的逻辑地址选择数据通过网络的最佳路径连接不同的媒介类型 二.IP数据包头的格式 版本号—— 占 4 位，指 IP 协议的版本。目前的 IP 协议版本号为 4 (即 IPv4)。首部长度： 占 4 位，可表示的最大数值是 15 个单位(一个单位为 4 字节)，因此 IP 的首部长度的最大值是 60 字节。 服务类型：占 8 位，用来获得更好的服务。总长度： 占 16 位，指包头和数据之和的长度，单位为字节，数据报的最大长度为 65535 字节。 总长度必须不超过最大传送单元 MTU。 标识：占 16 位，它是一个计数器，用来表示 IP 数据报的标识。标志：占 3 位，标志和分片一起被用来传递信息。标志字段的最低位是 MF (More Fragment)。MF = 1 表示后面“还有分片”。MF = 0 表示最后一个分片。标志字段中间的一位是 DF (Don&#39;t Fragment) 。只有当 DF = 0 时才允许分片。 片偏移：占13位，段偏移量中包含的信息是指在一个分片序列中如何将各分片重新连接起来。片偏移以 8 个字节为偏移单位。生存时间——占8 位，记为 TTL (Time To Live)，指示数据报在网络中可通过的路由器数的最大值，一个数据包每经过一个路由器，TTL将会减一。协议——占8 位，该字段用以指示在IP数据包中封装的是哪一个协议，是TCP还是UDP。 TCP协议号6" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/b94cb7325a1d798344bca4d2172d9013/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-18T22:15:12+08:00" />
<meta property="article:modified_time" content="2021-08-18T22:15:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">网络层协议</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80.%E7%BD%91%E7%BB%9C%E5%B1%82%E7%9A%84%E5%8A%9F%E8%83%BD-toc" style="margin-left:40px;"><a href="#%E4%B8%80.%E7%BD%91%E7%BB%9C%E5%B1%82%E7%9A%84%E5%8A%9F%E8%83%BD" rel="nofollow">一.网络层的功能</a></p> 
<p id="%E4%BA%8C.IP%E6%95%B0%E6%8D%AE%E5%8C%85%E5%A4%B4%E7%9A%84%E6%A0%BC%E5%BC%8F-toc" style="margin-left:40px;"><a href="#%E4%BA%8C.IP%E6%95%B0%E6%8D%AE%E5%8C%85%E5%A4%B4%E7%9A%84%E6%A0%BC%E5%BC%8F" rel="nofollow">二.IP数据包头的格式</a></p> 
<p id="%E4%B8%89.ICMP-toc" style="margin-left:40px;"><a href="#%E4%B8%89.ICMP" rel="nofollow">三.ICMP</a></p> 
<p id="1.ICMP%E5%8D%8F%E8%AE%AE%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D-toc" style="margin-left:80px;"><a href="#1.ICMP%E5%8D%8F%E8%AE%AE%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D" rel="nofollow">1.ICMP协议功能介绍</a></p> 
<p id="2.ICMP%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%B0%81%E8%A3%85-toc" style="margin-left:80px;"><a href="#2.ICMP%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%B0%81%E8%A3%85" rel="nofollow">2.ICMP协议的封装</a></p> 
<p id="3.ping%E5%91%BD%E4%BB%A4%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8-toc" style="margin-left:80px;"><a href="#3.ping%E5%91%BD%E4%BB%A4%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8" rel="nofollow">3.ping命令的基本使用</a></p> 
<p id="%C2%A0%E5%9B%9B.ARP%E5%8D%8F%E8%AE%AE%E5%92%8CRARP%E5%8D%8F%E8%AE%AE-toc" style="margin-left:40px;"><a href="#%C2%A0%E5%9B%9B.ARP%E5%8D%8F%E8%AE%AE%E5%92%8CRARP%E5%8D%8F%E8%AE%AE" rel="nofollow"> 四.ARP协议和RARP协议</a></p> 
<p id="1.ARP-toc" style="margin-left:80px;"><a href="#1.ARP" rel="nofollow">1.ARP</a></p> 
<p id="%C2%A02.RARP-toc" style="margin-left:80px;"><a href="#%C2%A02.RARP" rel="nofollow"> 2.RARP</a></p> 
<p id="3.Windows%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84ARP%E5%8D%8F%E8%AE%AE-toc" style="margin-left:80px;"><a href="#3.Windows%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84ARP%E5%8D%8F%E8%AE%AE" rel="nofollow">3.Windows系统中的ARP协议</a></p> 
<p id="4.%E5%8D%8E%E4%B8%BAensp%E4%B8%ADARP%E5%91%BD%E4%BB%A4-toc" style="margin-left:80px;"><a href="#4.%E5%8D%8E%E4%B8%BAensp%E4%B8%ADARP%E5%91%BD%E4%BB%A4" rel="nofollow">4.华为ensp中ARP命令</a></p> 
<p id="%C2%A0%E4%BA%94.ARP%E6%94%BB%E5%87%BB%E4%B8%8EARP%E6%AC%BA%E9%AA%97-toc" style="margin-left:40px;"><a href="#%C2%A0%E4%BA%94.ARP%E6%94%BB%E5%87%BB%E4%B8%8EARP%E6%AC%BA%E9%AA%97" rel="nofollow"> 五.ARP攻击与ARP欺骗</a></p> 
<p id="1.arp%E6%94%BB%E5%87%BB-toc" style="margin-left:80px;"><a href="#1.arp%E6%94%BB%E5%87%BB" rel="nofollow">1.arp攻击</a></p> 
<p id="2.arp%E6%AC%BA%E9%AA%97-toc" style="margin-left:80px;"><a href="#2.arp%E6%AC%BA%E9%AA%97" rel="nofollow">2.arp欺骗</a></p> 
<p id="%C2%A0%E6%80%BB%E7%BB%93-toc" style="margin-left:40px;"><a href="#%C2%A0%E6%80%BB%E7%BB%93" rel="nofollow"> 总结</a></p> 
<hr> 
<h3 id="%E4%B8%80.%E7%BD%91%E7%BB%9C%E5%B1%82%E7%9A%84%E5%8A%9F%E8%83%BD">一.网络层的功能</h3> 
<ul><li>定义了基于IP地址的逻辑地址</li><li>选择数据通过网络的最佳路径</li><li>连接不同的媒介类型</li></ul> 
<h3 id="%E4%BA%8C.IP%E6%95%B0%E6%8D%AE%E5%8C%85%E5%A4%B4%E7%9A%84%E6%A0%BC%E5%BC%8F">二.IP数据包头的格式</h3> 
<p><img alt="" height="721" src="https://images2.imgbox.com/7c/11/k5RbFjYj_o.png" width="1036"></p> 
<ul><li>版本号<span style="color:#000000;">——</span> 占 4 位，指 IP 协议的版本。目前的 IP 协议版本号为 4 (即 IPv4)。</li><li>首部长度： 占 4 位，可表示的最大数值是 15 个单位(一个单位为 4 字节)，因此 IP 的首部长度的最大值是 60 字节。 </li><li>服务类型：占 8 位，用来获得更好的服务。</li><li>总长度： 占 16 位，指包头和数据之和的长度，单位为字节，数据报的最大长度为 65535 字节。 <span style="color:#c00000;">总长度必须不超过最大传送单元 MTU</span><span style="color:#c00000;">。 </span></li><li>标识：<span style="color:#000000;">占 16 </span><span style="color:#000000;">位，它是一个计数器，用来表示 </span><span style="color:#c00000;">IP </span><span style="color:#c00000;">数据报</span><span style="color:#c00000;">的标识。</span></li><li>标志：<span style="color:#000000;">占 3 </span><span style="color:#000000;">位，标志和分片一起被用来传递信息。</span><span style="color:#c00000;">标志字段的最低位是 MF (More Fragment)</span><span style="color:#c00000;">。</span><span style="color:#000000;">MF =</span><span style="color:#000000;"> 1 </span><span style="color:#000000;">表示后面“还有分片”。</span><span style="color:#000000;">MF </span><span style="color:#000000;">=</span><span style="color:#000000;"> 0 </span><span style="color:#000000;">表示最后一个分片。</span><span style="color:#c00000;">标志字段中间的一位是 DF (Don't Fragment) </span><span style="color:#c00000;">。</span><span style="color:#000000;">只有当 DF </span><span style="color:#000000;">=</span><span style="color:#000000;"> 0 </span><span style="color:#000000;">时才允许分片。 </span></li><li style="text-align:left;"><span style="color:#000000;">片</span><span style="color:#000000;">偏移</span><span style="color:#000000;">：</span><span style="color:#000000;">占</span><span style="color:#000000;">13位，</span>段偏移量中包含的信息是指在一个分片序列中如何将各分片重新连接起来。<span style="color:#c00000;">片偏移以 8 </span><span style="color:#c00000;">个字节为偏移单位。</span></li><li style="text-align:left;"><span style="color:#000000;">生存时</span><span style="color:#000000;">间</span><span style="color:#000000;">——</span><span style="color:#000000;">占</span><span style="color:#000000;">8 </span><span style="color:#000000;">位，记</span><span style="color:#000000;">为 </span><span style="color:#000000;">TTL (Time To Live</span><span style="color:#000000;">)</span><span style="color:#000000;">，指示数据报在网络中可通过的路由器数的最大值，</span><span style="color:#be191c;">一个数据包每经过一个路由器，TTL将会减一</span><span style="color:#000000;">。</span></li><li style="text-align:left;"><span style="color:#000000;">协议</span><span style="color:#000000;">——</span><span style="color:#000000;">占</span><span style="color:#000000;">8 位，</span>该字段用以指示在IP数据包中封装的是哪一个协议，是TCP还是UDP。</li></ul> 
<blockquote> 
 <p style="text-align:left;"><span style="color:#0d0016;"><span style="background-color:#ffd900;">TCP协议号6</span></span></p> 
 <p style="text-align:left;"><span style="color:#0d0016;"><span style="background-color:#ffd900;">UDP协议号17</span></span></p> 
</blockquote> 
<ul><li style="text-align:left;"><span style="color:#000000;">首部检验</span><span style="color:#000000;">和</span><span style="color:#000000;">——</span><span style="color:#000000;">占</span><span style="color:#000000;">16 </span><span style="color:#000000;">位，</span><span style="color:#c00000;">只检验</span><span style="color:#c00000;">数据报的</span><span style="color:#c00000;">首部</span><span style="color:#c00000;">，</span><span style="color:#000000;">不检验数据部分。</span></li><li style="text-align:left;"><span style="color:#000000;">源地址——占四个字节。</span>该字段用于表示数据包的源地址。这是一个网络地址，指的是发送该数据包的设备的网络地址。</li><li style="text-align:left;"><span style="color:#000000;">目的地址——占四个字节。该字段用于表示数据包的目的地址。这是一个网络地址，指的是接收节点的网络地址。</span></li></ul> 
<h3 id="%E4%B8%89.ICMP" style="text-align:left;">三.ICMP</h3> 
<h4 id="1.ICMP%E5%8D%8F%E8%AE%AE%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D" style="text-align:left;">1.ICMP协议功能介绍</h4> 
<p style="text-align:left;">Internet控制报文协议</p> 
<ul><li>ICMP是一个错误侦测与回馈机制</li><li>通过IP数据包封装的</li><li>用来发送错误和控制消息</li></ul> 
<p>作用：测试网络的联通性并给予一定的反馈</p> 
<p>组成：ping     tracert 路由跟踪（最多30个跃点跟踪）</p> 
<h4 id="2.ICMP%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%B0%81%E8%A3%85">2.ICMP协议的封装</h4> 
<p>ICMP协议属于网络层协议</p> 
<p>ICMP数据的封装</p> 
<p><img alt="" height="436" src="https://images2.imgbox.com/9a/d0/niG5FP5f_o.png" width="1200"></p> 
<p>每个ICMP报文放在IP数据报的数据部分中通过互联网传递，而IP数据报本身放在帧的数据部分中通过物理网络传递。</p> 
<h4 id="3.ping%E5%91%BD%E4%BB%A4%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">3.ping命令的基本使用</h4> 
<p>1.ping -t 调试故障或需进行持续连通性测试时应用（测试是否丢包）</p> 
<p><img alt="" height="78" src="https://images2.imgbox.com/d0/f5/NHsKlYJ7_o.png" width="1183"></p> 
<blockquote> 
 <p> Ctrl+C强制中断</p> 
</blockquote> 
<p><img alt="" height="349" src="https://images2.imgbox.com/7a/30/3HfJNmVr_o.png" width="1200"></p> 
<p> 2.ping -a 显示目标主机的名字</p> 
<p><img alt="" height="355" src="https://images2.imgbox.com/01/04/t36izFzC_o.png" width="1200"></p> 
<p> 3.ping -l 10000(字节）用于简单测试通信质量</p> 
<p>默认ping包大小是32字节。</p> 
<p><img alt="" height="618" src="https://images2.imgbox.com/27/ac/7Qhjilwz_o.png" width="1200"></p> 
<h3 id="%C2%A0%E5%9B%9B.ARP%E5%8D%8F%E8%AE%AE%E5%92%8CRARP%E5%8D%8F%E8%AE%AE"> 四.ARP协议和RARP协议</h3> 
<h4 id="1.ARP">1.ARP</h4> 
<p><strong>正向地址解析协议</strong></p> 
<p>数据传输通讯地址：源IP 源MAC 目标IP 目标MAC</p> 
<p>使用场合：已知目标IP，未知目标MAC地址时使用</p> 
<p>工作原理：PC1已知PC2的IP地址，未知PC2的MAC地址时使用。PC1发送ARP广播给二层交换机，二层交换机接收到ARP广播消息后无条件泛洪处理，连接到二层交换机下的所有PC都将接收到此广播消息，每个PC都会把自身的IP地址进行对比，若一致则接收此广播消息，并回数据包给PC1，PC1接收到返回的数据包后会记录下PC2的IP和MAC地址，记录到ARP缓存表中，若不一致则丢弃处理。</p> 
<h4 id="%C2%A02.RARP"> 2.RARP</h4> 
<p><strong>反向地址解析协议</strong></p> 
<p>使用场合：已知目标MAC，未知目标IP地址时使用</p> 
<h4 id="3.Windows%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84ARP%E5%8D%8F%E8%AE%AE">3.Windows系统中的ARP协议</h4> 
<p>1.arp - a：查看ARP缓存表</p> 
<p><img alt="" height="897" src="https://images2.imgbox.com/8c/a3/EgzutrC7_o.png" width="1200">  2.arp - d：清除ARP缓存</p> 
<p><span style="background-color:#ffd900;">arp -d +ip地址  删除指定主机</span></p> 
<p><span style="background-color:#ffd900;">arp -d +*  删除所有主机</span></p> 
<p><img alt="" height="503" src="https://images2.imgbox.com/95/3f/mTGEF3Gr_o.png" width="1200"></p> 
<p> 3.arp绑定——— arp - s ip地址+mac地址</p> 
<p><img alt="" height="782" src="https://images2.imgbox.com/20/11/INaFzbah_o.png" width="1200"></p> 
<h4 id="4.%E5%8D%8E%E4%B8%BAensp%E4%B8%ADARP%E5%91%BD%E4%BB%A4">4.华为ensp中ARP命令</h4> 
<p>&lt; &gt;/【】display arp <span style="color:#fe2c24;">查看arp缓存</span></p> 
<p>【】arp static IP地址+MAC地址 <span style="color:#fe2c24;">arp捆绑</span></p> 
<p>&lt; &gt;reset arp all  <span style="color:#fe2c24;">清除所有ARP缓存</span></p> 
<p>&lt; &gt;reset arp static <span style="color:#fe2c24;">清除静态ARP缓存</span></p> 
<p><img alt="" height="805" src="https://images2.imgbox.com/8e/56/ZvGP6jhv_o.png" width="836"></p> 
<h3 id="%C2%A0%E4%BA%94.ARP%E6%94%BB%E5%87%BB%E4%B8%8EARP%E6%AC%BA%E9%AA%97"> 五.ARP攻击与ARP欺骗</h3> 
<h4 id="1.arp%E6%94%BB%E5%87%BB"><strong>1.arp攻击</strong></h4> 
<p>arp攻击的目的是使网络无法正常通信。会出现大面积掉网的情况。</p> 
<p>构造虚拟MAC地址</p> 
<p><img alt="" height="536" src="https://images2.imgbox.com/c4/e7/6Ewd1Ank_o.png" width="1113"></p> 
<h4 id="2.arp%E6%AC%BA%E9%AA%97" style="text-align:left;">2.arp欺骗</h4> 
<p style="text-align:left;">arp欺骗不会使网络无法正常通信，是通过冒充网关或者主机使到达网关或者主机的流量通过攻击主机进行转发。</p> 
<p style="text-align:left;">进行数据的窃取和流量的复制</p> 
<p style="text-align:left;"><img alt="" height="447" src="https://images2.imgbox.com/58/cd/lloTxIwi_o.png" width="814"></p> 
<p><img alt="" height="391" src="https://images2.imgbox.com/7e/c8/KOGY8pTn_o.png" width="695"></p> 
<h3 id="%C2%A0%E6%80%BB%E7%BB%93"> 总结</h3> 
<p>1.在网络中，ICMP协议的使用靠各种命令来实现，如ping </p> 
<p>2.ARP协议的基本功能是负责将一个已知IP地址解析成MAC地址，以便在交换机上通过MAC地址进行通信。</p> 
<p>3.ARP攻击和欺骗都是通过伪造ARP应答来实现的</p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/85fa7b53957446efae0ffe8e3e42aa89/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mysql通过xbk备份快速进行大数据量搭建gtid主从</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bf96f20a6c007f7f30e63e08bbd8478a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">STM32 使用sprintf 导致死机的一个解决方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>