<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>AppleScript 快速入门 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="AppleScript 快速入门" />
<meta property="og:description" content="AppleScript 快速入门 AppleScript 快速入门 一、让其他程序执行任务二、数据类型三、条件语句四、循环五、函数六、用户交互对话框七、使用词典八、操作其他程序的界面九、运行参数 AppleScript 顾名思义是苹果开发的一套脚本语言，利用 AppleScript 在 macOS 系统上可以对其他程序进行操作，点击按钮、发送消息、模拟自动化执行功能，比如可以打开浏览器，清空回收站等等一些操作，是一个非常有意思的脚本。说好了要快速入门，下面我们开始快速学习了解它吧。
一、让其他程序执行任务 在 macOS 上有一个应用叫脚本编辑器，通过 Launchpad 可以搜索到，打开脚本编辑器之后，可以看到支持编写和解析 AppleScript 和 JavaScript 两种脚本，如下图所示：
AppleScript 的语法和平时的英语语法很类似，你想让哪个程序执行操作，就 tell 它，比如你想让 Finder 清空回收站那就这样写：
tell application &#34;Finder&#34; empty the trash end tell 在脚本编辑器上点击运行按钮就可以看到回收站的内容被清空了，或者按快捷键 Command &#43; R 也能运行，运行之前记得回收站得有东西，不然可能会执行失败。
如果你想让系统说话，可以这样写：
tell application &#34;Finder&#34; say &#34;My name is exchen&#34; end tell 哈哈，记得把电脑的声音打开，是不是听到说话了？不仅支持英文和中文，其他国家语言，像德语、荷兰语笔者试过，同样也可以。
如果你想让浏览器打开 URL，可以这样写：
set myBlog to &#34;http://www.exchen.net&#34; # 告诉 Chrmoe 浏览器打开 URL tell application &#34;Google Chrome&#34; # 新建一个 chrome 窗口 set window1 to make new window tell window1 set currTab to active tab of window1 set URL of currTab to myBlog end tell end tell 看看 Chrmoe 浏览器是不是打开了你指定的 URL 了？有意思吧？" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/894c7691cfe8f75fe136069d6f778bb5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-08-12T00:27:10+08:00" />
<meta property="article:modified_time" content="2018-08-12T00:27:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">AppleScript 快速入门</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2 id="applescript-快速入门">AppleScript 快速入门</h2> 
<p></p> 
<div class="toc"> 
 <div class="toc"> 
  <ul><li><a href="#applescript-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8" rel="nofollow">AppleScript 快速入门</a> 
    <ul><li><a href="#%E4%B8%80%E8%AE%A9%E5%85%B6%E4%BB%96%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E4%BB%BB%E5%8A%A1" rel="nofollow">一、让其他程序执行任务</a></li><li><a href="#%E4%BA%8C%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B" rel="nofollow">二、数据类型</a></li><li><a href="#%E4%B8%89%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5" rel="nofollow">三、条件语句</a></li><li><a href="#%E5%9B%9B%E5%BE%AA%E7%8E%AF" rel="nofollow">四、循环</a></li><li><a href="#%E4%BA%94%E5%87%BD%E6%95%B0" rel="nofollow">五、函数</a></li><li><a href="#%E5%85%AD%E7%94%A8%E6%88%B7%E4%BA%A4%E4%BA%92%E5%AF%B9%E8%AF%9D%E6%A1%86" rel="nofollow">六、用户交互对话框</a></li><li><a href="#%E4%B8%83%E4%BD%BF%E7%94%A8%E8%AF%8D%E5%85%B8" rel="nofollow">七、使用词典</a></li><li><a href="#%E5%85%AB%E6%93%8D%E4%BD%9C%E5%85%B6%E4%BB%96%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%95%8C%E9%9D%A2" rel="nofollow">八、操作其他程序的界面</a></li><li><a href="#%E4%B9%9D%E8%BF%90%E8%A1%8C%E5%8F%82%E6%95%B0" rel="nofollow">九、运行参数</a></li></ul> </li></ul> 
 </div> 
</div> 
<p></p> 
<p>AppleScript 顾名思义是苹果开发的一套脚本语言，利用 AppleScript 在 macOS 系统上可以对其他程序进行操作，点击按钮、发送消息、模拟自动化执行功能，比如可以打开浏览器，清空回收站等等一些操作，是一个非常有意思的脚本。说好了要快速入门，下面我们开始快速学习了解它吧。</p> 
<h3 id="一让其他程序执行任务">一、让其他程序执行任务</h3> 
<p>在 macOS 上有一个应用叫脚本编辑器，通过 Launchpad 可以搜索到，打开脚本编辑器之后，可以看到支持编写和解析 AppleScript 和 JavaScript 两种脚本，如下图所示：</p> 
<p><img src="https://images2.imgbox.com/dc/eb/tZ5jfa31_o.png" alt="" title=""></p> 
<p>AppleScript 的语法和平时的英语语法很类似，你想让哪个程序执行操作，就 tell 它，比如你想让 Finder 清空回收站那就这样写：</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-keyword">tell</span> <span class="hljs-type">application</span> <span class="hljs-string">"Finder"</span>
    empty <span class="hljs-keyword">the</span> trash
<span class="hljs-keyword">end</span> <span class="hljs-keyword">tell</span></code></pre> 
<p>在脚本编辑器上点击运行按钮就可以看到回收站的内容被清空了，或者按快捷键 Command + R 也能运行，运行之前记得回收站得有东西，不然可能会执行失败。</p> 
<p>如果你想让系统说话，可以这样写：</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-keyword">tell</span> <span class="hljs-type">application</span> <span class="hljs-string">"Finder"</span>
    <span class="hljs-command">say</span> <span class="hljs-string">"My name is exchen"</span>
<span class="hljs-keyword">end</span> <span class="hljs-keyword">tell</span></code></pre> 
<p>哈哈，记得把电脑的声音打开，是不是听到说话了？不仅支持英文和中文，其他国家语言，像德语、荷兰语笔者试过，同样也可以。</p> 
<p>如果你想让浏览器打开 URL，可以这样写：</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-keyword">set</span> myBlog <span class="hljs-keyword">to</span> <span class="hljs-string">"http://www.exchen.net"</span>

<span class="hljs-comment"># 告诉 Chrmoe 浏览器打开 URL</span>
<span class="hljs-keyword">tell</span> <span class="hljs-type">application</span> <span class="hljs-string">"Google Chrome"</span>
    <span class="hljs-comment"># 新建一个 chrome 窗口</span>
    <span class="hljs-keyword">set</span> window1 <span class="hljs-keyword">to</span> make new window
    <span class="hljs-keyword">tell</span> window1
        <span class="hljs-keyword">set</span> currTab <span class="hljs-keyword">to</span> active <span class="hljs-constant">tab</span> <span class="hljs-keyword">of</span> window1
        <span class="hljs-keyword">set</span> URL <span class="hljs-keyword">of</span> currTab <span class="hljs-keyword">to</span> myBlog
    <span class="hljs-keyword">end</span> <span class="hljs-keyword">tell</span>
<span class="hljs-keyword">end</span> <span class="hljs-keyword">tell</span></code></pre> 
<p>看看 Chrmoe 浏览器是不是打开了你指定的 URL 了？有意思吧？</p> 
<p>上面的测试代码都是在脚本编辑器里运行的，如何脱离脚本编辑器，直接在系统上运行呢？我们可以保存或导出脚本，点击文件菜 -&gt; 存储，可以看到支持的格式有四种，如图所示：</p> 
<p><img src="https://images2.imgbox.com/e4/e3/MKFyzbAp_o.png" alt="" title=""></p> 
<p>保存为脚本类型，然后通过 osascript 来执行脚本，如下：</p> 
<pre class="prettyprint"><code class=" hljs avrasm">/usr/bin/osascript test1<span class="hljs-preprocessor">.scpt</span></code></pre> 
<p>如果保存为应用程序类型，就是一个 .app 的包，直接双击打开就能运行。</p> 
<h3 id="二数据类型">二、数据类型</h3> 
<p>AppleScript 的数据类型比较简单，一般常用的有 number、string、list、record，也就是数字类型、字符串类型、列表类型、字典类型。</p> 
<p>数字类型的赋值和使用如下：</p> 
<pre class="prettyprint"><code class=" hljs livecodeserver"><span class="hljs-built_in">set</span> num1 <span class="hljs-built_in">to</span> <span class="hljs-number">10</span> <span class="hljs-comment"># 给 num1 赋值</span>
<span class="hljs-built_in">set</span> num2 <span class="hljs-built_in">to</span> <span class="hljs-number">20</span> <span class="hljs-comment"># 给 num2 赋值</span>
<span class="hljs-built_in">set</span> num3 <span class="hljs-built_in">to</span> num1 + num2 <span class="hljs-comment"># num1 + num2 赋值给 num3</span>
<span class="hljs-built_in">set</span> num4 <span class="hljs-built_in">to</span> num3 * <span class="hljs-number">2</span> <span class="hljs-comment"># num3 * 2 赋值给 num4</span></code></pre> 
<p>字符串类型的赋值和使用如下：</p> 
<pre class="prettyprint"><code class=" hljs sql"><span class="hljs-operator"><span class="hljs-keyword">set</span> str1 <span class="hljs-keyword">to</span> <span class="hljs-string">"exchen.net"</span>
<span class="hljs-keyword">set</span> str2 <span class="hljs-keyword">to</span> <span class="hljs-string">"hehe"</span>
<span class="hljs-keyword">set</span> str3 <span class="hljs-keyword">to</span> str1 &amp; str2
</span></code></pre> 
<p>字符串与数字的转换方法如下：</p> 
<pre class="prettyprint"><code class=" hljs livecodeserver"><span class="hljs-built_in">set</span> str3Len <span class="hljs-built_in">to</span> <span class="hljs-operator">the</span> <span class="hljs-built_in">length</span> <span class="hljs-operator">of</span> str3
<span class="hljs-built_in">set</span> numToStr <span class="hljs-built_in">to</span> num1 <span class="hljs-keyword">as</span> <span class="hljs-keyword">string</span>
<span class="hljs-built_in">set</span> strToNum <span class="hljs-built_in">to</span> <span class="hljs-string">"123"</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">number</span></code></pre> 
<p>列表类型其实就是相当于数组，定义和操作列表类型的方法如下：</p> 
<pre class="prettyprint"><code class=" hljs livecodeserver"><span class="hljs-built_in">set</span> myLists <span class="hljs-built_in">to</span> {<!-- --><span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-string">"str"</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>} <span class="hljs-comment"># 定义列表数据</span>
<span class="hljs-built_in">set</span> <span class="hljs-keyword">item</span> <span class="hljs-number">3</span> <span class="hljs-operator">of</span> myLists <span class="hljs-built_in">to</span> <span class="hljs-string">"exchen"</span> <span class="hljs-comment">#操作第三列的数据</span>
<span class="hljs-built_in">get</span> myLists  <span class="hljs-comment"># 获取列表数据</span></code></pre> 
<p>字典类型的定义和操作方法如下：</p> 
<pre class="prettyprint"><code class=" hljs livecodeserver"><span class="hljs-built_in">set</span> myRecord <span class="hljs-built_in">to</span> {name:<span class="hljs-string">"exchen"</span>, blog:<span class="hljs-string">"http://www.exchen.net"</span>, body:<span class="hljs-string">"hehe"</span>} <span class="hljs-comment"># 定义 Record 数据</span>
<span class="hljs-built_in">set</span> <span class="hljs-built_in">value</span> <span class="hljs-built_in">to</span> <span class="hljs-operator">the</span> body <span class="hljs-operator">of</span> myRecord <span class="hljs-comment"># 从 Record 中获取 body 数据给 value</span>
<span class="hljs-built_in">get</span> <span class="hljs-built_in">value</span></code></pre> 
<h3 id="三条件语句">三、条件语句</h3> 
<p>既然是脚本语言，当然不能少了 if 和 else 语句，使用方法如下：</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-keyword">set</span> num <span class="hljs-keyword">to</span> <span class="hljs-number">123</span>
<span class="hljs-keyword">if</span> num = <span class="hljs-number">123</span> <span class="hljs-keyword">then</span>
    <span class="hljs-command">display dialog</span> <span class="hljs-string">"等于 123"</span>

<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> strToNum &gt; <span class="hljs-number">456</span> <span class="hljs-keyword">then</span>
    <span class="hljs-command">display dialog</span> <span class="hljs-string">"大于 456"</span>

<span class="hljs-keyword">else</span>
    <span class="hljs-command">display dialog</span> <span class="hljs-string">"不等于 123 也不大于 456"</span>
<span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span></code></pre> 
<p>通过 contains 方法来进行字符串的比较判断：</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-keyword">set</span> domainName <span class="hljs-keyword">to</span> <span class="hljs-string">"www.exchen.net"</span>
<span class="hljs-keyword">if</span> domainName <span class="hljs-keyword">contains</span> <span class="hljs-string">"exchen"</span> <span class="hljs-keyword">then</span>
    <span class="hljs-command">display dialog</span> <span class="hljs-string">"包含 exchen"</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-command">display dialog</span> <span class="hljs-string">"不包含 exchen"</span>
<span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span></code></pre> 
<h3 id="四循环">四、循环</h3> 
<p>循环的写法有好几种，不过都是使用 repeat … end repeat，比如循环 100 次可以这样写：</p> 
<pre class="prettyprint"><code class=" hljs livecodeserver"><span class="hljs-built_in">set</span> <span class="hljs-built_in">num</span> <span class="hljs-built_in">to</span> <span class="hljs-number">10</span>
<span class="hljs-keyword">repeat</span> <span class="hljs-number">100</span> times
    <span class="hljs-built_in">set</span> <span class="hljs-built_in">num</span> <span class="hljs-built_in">to</span> <span class="hljs-built_in">num</span> + <span class="hljs-number">1</span>
<span class="hljs-function"><span class="hljs-keyword">end</span> <span class="hljs-title">repeat</span></span>

<span class="hljs-built_in">get</span> <span class="hljs-built_in">num</span></code></pre> 
<p>类似于 for 循环，就这样写：</p> 
<pre class="prettyprint"><code class=" hljs livecodeserver"><span class="hljs-built_in">set</span> <span class="hljs-built_in">num</span> <span class="hljs-built_in">to</span> <span class="hljs-number">5</span>
<span class="hljs-keyword">repeat</span> <span class="hljs-operator">with</span> counter <span class="hljs-built_in">from</span> <span class="hljs-number">0</span> <span class="hljs-built_in">to</span> <span class="hljs-built_in">num</span> <span class="hljs-keyword">by</span> <span class="hljs-number">1</span>
    display dialog counter
<span class="hljs-function"><span class="hljs-keyword">end</span> <span class="hljs-title">repeat</span></span></code></pre> 
<p>类似于 while 循环，可以这样写：</p> 
<pre class="prettyprint"><code class=" hljs livecodeserver"><span class="hljs-built_in">set</span> <span class="hljs-built_in">num</span> <span class="hljs-built_in">to</span> <span class="hljs-number">0</span>
<span class="hljs-keyword">repeat</span> <span class="hljs-keyword">until</span> <span class="hljs-built_in">num</span> ≥ <span class="hljs-number">10</span>
    display dialog <span class="hljs-built_in">num</span>
    <span class="hljs-built_in">set</span> <span class="hljs-built_in">num</span> <span class="hljs-built_in">to</span> <span class="hljs-built_in">num</span> + <span class="hljs-number">3</span>
<span class="hljs-function"><span class="hljs-keyword">end</span> <span class="hljs-title">repeat</span></span></code></pre> 
<h3 id="五函数">五、函数</h3> 
<p>如果某些功能有重用性，应该要写成函数，AppleScript 也支持定义函数，定义和使用方法如下：</p> 
<pre class="prettyprint"><code class=" hljs livecodeserver"><span class="hljs-command"><span class="hljs-keyword">on</span> <span class="hljs-title">testFun</span>()</span>
    <span class="hljs-built_in">set</span> <span class="hljs-built_in">num</span> <span class="hljs-built_in">to</span> <span class="hljs-number">1</span>
<span class="hljs-function"><span class="hljs-keyword">end</span> <span class="hljs-title">testFun</span></span>

testFun()</code></pre> 
<p>函数当然会有返回值，通过 return 返回值：</p> 
<pre class="prettyprint"><code class=" hljs livecodeserver"><span class="hljs-command"><span class="hljs-keyword">on</span> <span class="hljs-title">testFun</span>()</span>
    <span class="hljs-built_in">set</span> <span class="hljs-built_in">num</span> <span class="hljs-built_in">to</span> <span class="hljs-number">1</span>
    <span class="hljs-constant">return</span> <span class="hljs-built_in">num</span>
<span class="hljs-function"><span class="hljs-keyword">end</span> <span class="hljs-title">testFun</span></span>

<span class="hljs-built_in">set</span> ret <span class="hljs-built_in">to</span> testFun()
<span class="hljs-built_in">get</span> ret
</code></pre> 
<p>另外函数可能还会带参数，带参数的方法使用如下：</p> 
<pre class="prettyprint"><code class=" hljs livecodeserver"><span class="hljs-command"><span class="hljs-keyword">on</span> <span class="hljs-title">testFun</span>(<span class="hljs-title">str</span>)</span>
    display dialog str

<span class="hljs-function"><span class="hljs-keyword">end</span> <span class="hljs-title">testFun</span></span>

testFun(<span class="hljs-string">"exchen"</span>)</code></pre> 
<p>函数有可能会带多个参数，使用方法如下：</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-function_start"><span class="hljs-keyword">on</span></span> testFun(str1, str2)
    <span class="hljs-command">display dialog</span> str1
    <span class="hljs-command">display dialog</span> str2

<span class="hljs-keyword">end</span> testFun

testFun(<span class="hljs-string">"exchen"</span>, <span class="hljs-string">"hehe"</span>)</code></pre> 
<h3 id="六用户交互对话框">六、用户交互对话框</h3> 
<p>在前面我们使用过 display dialog 弹出对话框，如果要指定标题通过 with title 关键字，代码如下：</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-command">display dialog</span> <span class="hljs-string">"这是内容"</span> <span class="hljs-keyword">with</span> title <span class="hljs-string">"这是标题"</span></code></pre> 
<p>指定按钮的内容，可以通过 buttons {“No”, “Yes”}，按钮个数最多三个，代码如下：</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-command">display dialog</span> <span class="hljs-string">"这是内容"</span> <span class="hljs-keyword">with</span> title <span class="hljs-string">"这是标题"</span> buttons {<!-- --><span class="hljs-string">"No"</span>, <span class="hljs-string">"Yes"</span>}</code></pre> 
<p>也可以通过 default button 设置默认选择的按钮，代码如下：</p> 
<pre class="prettyprint"><code class=" hljs javascript">display dialog <span class="hljs-string">"这是内容"</span> <span class="hljs-keyword">with</span> title <span class="hljs-string">"这是标题"</span> buttons {<!-- --><span class="hljs-string">"No"</span>, <span class="hljs-string">"Yes"</span>} <span class="hljs-keyword">default</span> button <span class="hljs-string">"Yes"</span></code></pre> 
<p>还可以指定对话框的图标，icon 图标可以指定 note/stop/caution 类型，或者指向文件路径，代码如下：</p> 
<pre class="prettyprint"><code class=" hljs javascript">display dialog <span class="hljs-string">"这是内容"</span> <span class="hljs-keyword">with</span> title <span class="hljs-string">"这是标题"</span> buttons {<!-- --><span class="hljs-string">"No"</span>, <span class="hljs-string">"Yes"</span>} <span class="hljs-keyword">default</span> button <span class="hljs-string">"Yes"</span> <span class="hljs-keyword">with</span> icon note</code></pre> 
<p>对话框一般是用于和用户进行交互，通过 button returned 可以获取用户点击了哪个按钮，然后进行相应用操作，代码如下：</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-command">display dialog</span> <span class="hljs-string">"这是内容"</span> <span class="hljs-keyword">with</span> title <span class="hljs-string">"这是标题"</span> buttons {<!-- --><span class="hljs-string">"No"</span>, <span class="hljs-string">"Yes"</span>} default button <span class="hljs-string">"Yes"</span>
<span class="hljs-keyword">if</span> button returned <span class="hljs-keyword">of</span> <span class="hljs-constant">result</span> = <span class="hljs-string">"Yes"</span> <span class="hljs-keyword">then</span>

<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> button returned <span class="hljs-keyword">of</span> <span class="hljs-constant">result</span> = <span class="hljs-string">"No"</span> <span class="hljs-keyword">then</span>

<span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span></code></pre> 
<p>对话框中也可以带输入框，让用户进行输入内容，代码如下：</p> 
<pre class="prettyprint"><code class=" hljs cs">display dialog <span class="hljs-string">"请输入内容："</span> <span class="hljs-keyword">default</span> answer <span class="hljs-string">""</span></code></pre> 
<p>带输入框的对话框的效果如下图：</p> 
<p><img src="https://images2.imgbox.com/95/75/Y6NK7Sbx_o.png" alt="" title=""></p> 
<p>输入内容之后，通过 text returned 来获取输入框的内容：</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-command">display dialog</span> <span class="hljs-string">"请输入内容："</span> default answer <span class="hljs-string">""</span>
<span class="hljs-keyword">if</span> <span class="hljs-type">text</span> returned <span class="hljs-keyword">of</span> <span class="hljs-constant">result</span> = <span class="hljs-string">"exchen"</span> <span class="hljs-keyword">then</span>
    <span class="hljs-keyword">get</span> <span class="hljs-string">"exchen.net"</span>
<span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span></code></pre> 
<h3 id="七使用词典">七、使用词典</h3> 
<p>在第一节我们知道了如何在其他程序中执行任务，比如让浏览器打开 URL、清空回收站，如果还想执行其他额外更多的功能怎么办？去哪儿查相应的方法名称？</p> 
<p>可以通过词典来找相应的方法名称，将应用直接拖到 Dock 上的脚本编辑器图标，然后就会显示扩展的词典，在这里可以查看该应用支持的相应方法名称说明，比如 Chrome 的词典如下图所示：</p> 
<p><img src="https://images2.imgbox.com/9f/1d/4NXfpA0j_o.png" alt="" title=""></p> 
<p>有些应用没有功能扩展的词典，就会提示打开词典失败，如下图所示：</p> 
<p><img src="https://images2.imgbox.com/96/21/viRXLJTb_o.png" alt="" title=""></p> 
<h3 id="八操作其他程序的界面">八、操作其他程序的界面</h3> 
<p>本小节我们来试一下操作其他程序来实现简单的自动化，打开计算器，使用 entire contents 显示出 UI 信息，代码如下：</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-keyword">tell</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>
    <span class="hljs-keyword">tell</span> process <span class="hljs-string">"Calculator"</span>
        entire <span class="hljs-property">contents</span>
    <span class="hljs-keyword">end</span> <span class="hljs-keyword">tell</span>
<span class="hljs-keyword">end</span> <span class="hljs-keyword">tell</span></code></pre> 
<p>返回 UI 信息如下：</p> 
<pre class="prettyprint"><code class=" hljs applescript">{window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, group <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, static <span class="hljs-type">text</span> <span class="hljs-string">"0"</span> <span class="hljs-keyword">of</span> group <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, group <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, button <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> group <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, button <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> group <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, button <span class="hljs-number">3</span> <span class="hljs-keyword">of</span> group <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, button <span class="hljs-number">4</span> <span class="hljs-keyword">of</span> group <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, button <span class="hljs-number">5</span> <span class="hljs-keyword">of</span> group <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, button <span class="hljs-number">6</span> <span class="hljs-keyword">of</span> group <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, button <span class="hljs-number">7</span> <span class="hljs-keyword">of</span> group <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, button <span class="hljs-number">8</span> <span class="hljs-keyword">of</span> group <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, button <span class="hljs-number">9</span> <span class="hljs-keyword">of</span> group <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, button <span class="hljs-number">10</span> <span class="hljs-keyword">of</span> group <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, button <span class="hljs-number">11</span> <span class="hljs-keyword">of</span> group <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, button <span class="hljs-number">12</span> <span class="hljs-keyword">of</span> group <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, ......

column <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> table <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> menu <span class="hljs-property">item</span> <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> menu <span class="hljs-string">"帮助"</span> <span class="hljs-keyword">of</span> menu bar <span class="hljs-property">item</span> <span class="hljs-string">"帮助"</span> <span class="hljs-keyword">of</span> menu bar <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>, menu <span class="hljs-property">item</span> <span class="hljs-string">"计算器帮助"</span> <span class="hljs-keyword">of</span> menu <span class="hljs-string">"帮助"</span> <span class="hljs-keyword">of</span> menu bar <span class="hljs-property">item</span> <span class="hljs-string">"帮助"</span> <span class="hljs-keyword">of</span> menu bar <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> process <span class="hljs-string">"Calculator"</span> <span class="hljs-keyword">of</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>}</code></pre> 
<p>比如我们关心的是按钮 9，信息比较多，一时看不出我们所关心的按钮，可以通过 Xcode 自带的工具 Accessibility Inspector 查看 UI 信息，打开 Xcode 菜单，在 Open Developer Tool 里可以找到它，打开之后点击捕获按钮，找到我们关心的按钮，效果如下图所示：</p> 
<p><img src="https://images2.imgbox.com/51/61/yeCbv9fZ_o.png" alt="" title=""></p> 
<p>在 Accessibility Inspector 界面往下拉，可以看到按钮 9 是在第二组的第四个，所图所示：</p> 
<p><img src="https://images2.imgbox.com/ef/00/4x04Eey9_o.png" alt="" title=""></p> 
<p>从返回的 UI 信息里可以找到按钮信息：</p> 
<pre class="prettyprint"><code class=" hljs vhdl">button <span class="hljs-number">4</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">group</span> <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> application <span class="hljs-keyword">process</span> <span class="hljs-string">"Calculator"</span></code></pre> 
<p>编写代码实现点击按钮：</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-keyword">tell</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>
    <span class="hljs-keyword">tell</span> process <span class="hljs-string">"Calculator"</span>
        entire <span class="hljs-property">contents</span>
        click button <span class="hljs-number">7</span> <span class="hljs-keyword">of</span> group <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> window <span class="hljs-number">1</span>
    <span class="hljs-keyword">end</span> <span class="hljs-keyword">tell</span>
<span class="hljs-keyword">end</span> <span class="hljs-keyword">tell</span></code></pre> 
<p>如果想点击菜单，在 UI 返回信息里你关心的菜单，编写代码如下：</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-keyword">tell</span> <span class="hljs-type">application</span> <span class="hljs-string">"System Events"</span>
    <span class="hljs-keyword">tell</span> process <span class="hljs-string">"Calculator"</span>
        click menu <span class="hljs-property">item</span> <span class="hljs-string">"关于计算器"</span> <span class="hljs-keyword">of</span> menu <span class="hljs-string">"计算器"</span> <span class="hljs-keyword">of</span> menu bar <span class="hljs-property">item</span> <span class="hljs-string">"计算器"</span> <span class="hljs-keyword">of</span> menu bar <span class="hljs-number">1</span>
    <span class="hljs-keyword">end</span> <span class="hljs-keyword">tell</span>
<span class="hljs-keyword">end</span> <span class="hljs-keyword">tell</span></code></pre> 
<p>执行之后，就相当于点击了 “关于计算器” 菜单，如下图所示：</p> 
<p><img src="https://images2.imgbox.com/4a/74/N2FoC0vu_o.png" alt="" title=""></p> 
<h3 id="九运行参数">九、运行参数</h3> 
<p>在第一节，我们知道通过 /usr/bin/osascript 能够执行脚本，如果脚本在启动的时候需要参数怎么办？通过 on run 定义好参数，代码如下：</p> 
<pre class="prettyprint"><code class=" hljs applescript"><span class="hljs-function_start"><span class="hljs-keyword">on</span></span> <span class="hljs-command">run</span> {parameter1, parameter2}
    <span class="hljs-command">display dialog</span> parameter1
<span class="hljs-keyword">end</span> <span class="hljs-command">run</span></code></pre> 
<p>然后在命令行执行的时候，后面跟参数执行就行了，命令如下：</p> 
<pre class="prettyprint"><code class=" hljs avrasm">/usr/bin/osascript test1<span class="hljs-preprocessor">.scpt</span> <span class="hljs-string">"exchen.net"</span> <span class="hljs-string">"parameter2"</span></code></pre> 
<p>原文地址：<a href="http://www.exchen.net/applescript-%e5%bf%ab%e9%80%9f%e5%85%a5%e9%97%a8.html" rel="nofollow">http://www.exchen.net/applescript-%e5%bf%ab%e9%80%9f%e5%85%a5%e9%97%a8.html</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ce7e7783feb8d86420f4d96f5c08f539/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">react&#43;webpack 打包，开发环境和生产环境集成一体拿来就能用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b02cdcdadd585774b4cf8a067a54efc6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux上ARP表，路由表的解释</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>