<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在Java中使用FileReader.read()进行读取文件时，为什么乱码？两个方法解决 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="在Java中使用FileReader.read()进行读取文件时，为什么乱码？两个方法解决" />
<meta property="og:description" content="public class FileReader_ { public static void main(String[] args) { } @Test public void m1() { String filePath = &#34;e:\\hello.txt&#34;; FileReader fileReader = null; try { fileReader = new FileReader(filePath); //循环读取 使用read while (fileReader.read()!=-1){ System.out.print((char) fileReader.read());//默认输出的是int,因此需要转化为char } } catch (IOException e) { e.printStackTrace(); } finally { try { if (fileReader != null) { fileReader.close(); } } catch (IOException e) { e.printStackTrace(); } } } } 以上代码是有可能出现代码输出混乱的情况的，输出效果如下：
可能会出现乱码的问题：
原因可能是文件编码与程序读取时使用的编码不一致。在创建FileReader对象时，没有指定文件的编码格式，因此默认使用的是系统默认的编码格式。如果文件中包含非系统默认编码格式的字符，那么在读取时就会出现乱码。
为了解决这个问题，可以在创建FileReader对象时指定文件的编码格式。例如，如果文件是使用UTF-8编码的，可以这样修改代码：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e0ac9552a87729f093a0de4a931a61a5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-26T22:44:25+08:00" />
<meta property="article:modified_time" content="2023-10-26T22:44:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在Java中使用FileReader.read()进行读取文件时，为什么乱码？两个方法解决</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre><code class="language-java">public class FileReader_ {
    public static void main(String[] args) {
    }

    @Test
    public void m1() {
        String filePath = "e:\\hello.txt";
        FileReader fileReader = null;
        try {
            fileReader = new FileReader(filePath);
            //循环读取 使用read
            while (fileReader.read()!=-1){
                System.out.print((char) fileReader.read());//默认输出的是int,因此需要转化为char
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                if (fileReader != null) {
                    fileReader.close();
                }
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
}</code></pre> 
<p> 以上代码是有可能出现代码输出混乱的情况的，输出效果如下：</p> 
<p><img alt="" height="475" src="https://images2.imgbox.com/f4/2b/U4Z6jZTt_o.png" width="340"></p> 
<p><strong>可能会出现乱码的问题：</strong></p> 
<p>原因可能是文件编码与程序读取时使用的编码不一致。在创建<code>FileReader</code>对象时，没有指定文件的编码格式，因此默认使用的是系统默认的编码格式。如果文件中包含非系统默认编码格式的字符，那么在读取时就会出现乱码。</p> 
<p>为了解决这个问题，可以在创建<code>FileReader</code>对象时指定文件的编码格式。例如，<strong>如果文件是使用UTF-8编码的，可以这样修改代码：</strong></p> 
<pre><code class="language-java">public void m1() {
    String filePath = "e:\\hello.txt";
    FileReader fileReader = null;
    int data = 0;
    try {
        // 指定字符编码为UTF-8
        fileReader = new FileReader(filePath, StandardCharsets.UTF_8);
        //循环读取 使用read
        while ((data=fileReader.read())!=-1){
            System.out.print((char) data); // 修改这里
        }
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        try {
            if (fileReader != null) {
                fileReader.close();
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
</code></pre> 
<p>上面这种方法，按理说也可以，但是我使用后发现报错了，不能调用UTF-8，感兴趣的小伙伴，自行尝试 ~</p> 
<p>在Java中，<code>FileReader.read()</code>方法返回的是读取到的字节（int类型），而不是字符（char类型）。因此，需要使用强制类型转换将其转换为字符。</p> 
<p> 我们需要使用int类型的date来，接受fileReader.read()，当接受的数据不为空时，一直循环下去，直到接受到最后一个字符，然后每接受一个数据，就强制转换成 char 打印到控制台，就不会出现乱码的情况了</p> 
<pre><code class="language-java">public class FileReader02_ {
    public static void main(String[] args) {

    }
    @Test
    public void m1() {

        String filePath = "e:\\hello.txt";
        FileReader fileReader = null;
        int date=0;
        try {
            fileReader = new FileReader(filePath);
            //循环读取 使用read
            while ((date=fileReader.read())!=-1){
                System.out.print((char) date);
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                if (fileReader != null) {
                    fileReader.close();
                }
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
}
</code></pre> 
<p> 控制台打印输出：</p> 
<p><img alt="" height="575" src="https://images2.imgbox.com/ae/af/mh8gwXCX_o.png" width="593"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/28d31b96f3aa95de3d88d95a64ba150a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java Boolean类，Java Character类，Java Number类</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0ec9e497ec099d92e9a26fe48f047f3f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">一致性哈希算法（consistent hashing）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>