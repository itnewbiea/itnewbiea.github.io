<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>原生ajax请求时出现xhr.status==0及POST请求无响应问题 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="原生ajax请求时出现xhr.status==0及POST请求无响应问题" />
<meta property="og:description" content="用原生ajax请求时发现xhr.status == 0，于是找了好久，竟然发现是绑定事件的元素不是我点击的元素。参考以下资源
AJAX问题之XMLHttpRequest status = 0
xhr.status状态码
1、If the state is UNSENT or OPENED, return 0.（如果状态是UNSENT或者OPENED，返回0）
2、If the error flag is set, return 0.（如果错误标签被设置，返回0）
3、Return the HTTP status code.（返回HTTP状态码）
POST请求无响应
POST请求函数如下：
function post(url, data){ var req = createXMLHTTPRequest(); if(req){ //post请求需要添加请求头，否则会报错 req.setRequestHeader(&#34;Content-type&#34;,&#34;application/x-www-form-urlencoded&#34;); req.open(&#34;POST&#34;, url, true); //发送请求 req.onreadystatechange = function(){ //判断是否服务器响应 if(req.readyState == 4 &amp;&amp; req.status == 200) requestSuccess(); } req.send(data); } } 把req.setRequestHeader(&#34;Content-type&#34;,&#34;application/x-www-form-urlencoded&#34;);注释掉反而可以请求，而添加了这句就不可以，我怀疑是&lt;a&gt;标签不适用这种请求头，于是查了content-type的这种类型及说明：HTTP中application/x-www-form-urlencoded字符说明 还是没能解决问题。于是我仔细的对照网上的POST请求，发现应该先open,再setRequestHeader
req.open(&#34;POST&#34;, url, true); req.setRequestHeader(&#34;Content-type&#34;,&#34;application/x-www-form-urlencoded&#34;); 参考：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/7b1334ede45d908d373d7e7bc5888ef9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-10-10T11:26:26+08:00" />
<meta property="article:modified_time" content="2018-10-10T11:26:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">原生ajax请求时出现xhr.status==0及POST请求无响应问题</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>用原生ajax请求时发现xhr.status == 0，于是找了好久，竟然发现是绑定事件的元素不是我点击的元素。参考以下资源</p> 
<p><a href="https://blog.csdn.net/iaiti/article/details/42192659">AJAX问题之XMLHttpRequest status = 0</a></p> 
<p>xhr.status状态码</p> 
<p style="text-indent:0;">  1、If the state is UNSENT or OPENED, return 0.（如果状态是UNSENT或者OPENED，返回0）<br>   2、If the error flag is set, return 0.（如果错误标签被设置，返回0）<br>   3、Return the HTTP status code.（返回HTTP状态码）</p> 
<p style="text-indent:0;"> </p> 
<p style="text-indent:0;">POST请求无响应</p> 
<p style="text-indent:0;">POST请求函数如下：</p> 
<pre class="has"><code class="language-javascript">function post(url, data){
	var req = createXMLHTTPRequest();
	if(req){
		//post请求需要添加请求头，否则会报错
		req.setRequestHeader("Content-type","application/x-www-form-urlencoded");
                req.open("POST", url, true);
		//发送请求
		req.onreadystatechange = function(){
			//判断是否服务器响应
			if(req.readyState == 4 &amp;&amp; req.status == 200)
				requestSuccess();
		}
		req.send(data);
	}
}</code></pre> 
<p>把req.setRequestHeader("Content-type","application/x-www-form-urlencoded");注释掉反而可以请求，而添加了这句就不可以，我怀疑是&lt;a&gt;标签不适用这种请求头，于是查了content-type的这种类型及说明：<a href="https://blog.csdn.net/qq_28702545/article/details/51719199">HTTP中application/x-www-form-urlencoded字符说明</a> 还是没能解决问题。于是我仔细的对照网上的POST请求，发现应该先open,再setRequestHeader</p> 
<pre class="has"><code class="language-javascript">req.open("POST", url, true);
req.setRequestHeader("Content-type","application/x-www-form-urlencoded");</code></pre> 
<p> </p> 
<p>参考：</p> 
<p style="text-indent:50px;"><a href="http://www.cnblogs.com/cythia/p/6978323.html" rel="nofollow">原生js的ajax请求</a>：最初看的，后来发现里面的POST请求头和open()位置写颠倒了</p> 
<p style="text-indent:50px;"><a href="https://blog.csdn.net/lingbo_li/article/details/79745629">原生ajax与jQuery ajax的比较</a></p> 
<p style="text-indent:50px;"><a href="https://blog.csdn.net/liuhenghui5201/article/details/21297235">AJAX简单使用介绍</a></p> 
<p style="text-indent:50px;"><a href="https://blog.csdn.net/qq_36238595/article/details/75507020">ajax获取servlet发送的数据</a></p> 
<p style="text-indent:50px;"><a href="http://www.cnblogs.com/colima/p/5339227.html" rel="nofollow">原生js实现Ajax</a></p> 
<p style="text-indent:50px;"><a href="http://sjpsega.iteye.com/blog/1729350" rel="nofollow">生Ajax书写</a></p> 
<p style="text-indent:50px;"><a href="https://blog.csdn.net/qq_28702545/article/details/51719199">HTTP中application/x-www-form-urlencoded字符说明</a></p> 
<p style="text-indent:50px;"> </p> 
<p style="text-indent:0;">关于错误总结：</p> 
<p style="text-indent:50px;">1.get和post提交到servlet是分别由get和post处理，看看是不是servlet的get方法或者post方法没有设置好</p> 
<p style="text-indent:50px;">2.是不是点击事件并步对应到绑定点击事件的元素</p> 
<p style="text-indent:50px;">3.是否POST顺序设置有问题，先open()，再设置消息头</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ea3128ffd07a033de0e8d2ded37fda96/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【火炉炼AI】机器学习038-NLP创建词袋模型</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/64e2b8d367b3264f7f2b68bb6fd57ae1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">window.open（）在谷歌浏览器不支持问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>