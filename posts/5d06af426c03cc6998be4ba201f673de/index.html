<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Windows Knowledge - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Windows Knowledge" />
<meta property="og:description" content="1 GRUB简介
1.1 MBR和PBR
MBR分为GRUB.MBR和DOS.MBR。
由于硬盘上扇区从偏移0到偏移62属于同一个磁道0，虽然DOS.MBR仅占用一个扇区，但是需要将DOS.MBR后面的偏移1到偏移62保留，所以磁盘上第一个分区的第一个扇区是从偏移63开始的。fbinst软件会保留1-16064扇区，等于硬盘1个柱面的大小255 x 63 x 512 = 8MB，所以第一个分区是从扇区16065开始的。
USB-ZIP和USB-FDD会将U盘的第一个扇区格式化成DOS.PBR而不是DOS.MBR。
USB-FDD和USB-ZIP的来历：软盘的容量小，没有分区结构，所以软盘是没有MBR的，整个软盘只有一个分区，第一个扇区就是PBR；FDD和ZIP模式在DOS下启动后U盘的盘符是A。
1.2 GRUB
- GRUB又叫OS Loader；在Android系统上，kernelflinger是OS Loader的一个EFI应用
- GRUB镜像组成：GRUB.MBR（boot.img）, 硬盘扇区offset 1 到offset 62放置GRUB的core.img，/boot分区的boot/grub/grub.cfg
1.3 创建USB-FDD或者USB-ZIP格式U盘步骤
1）Android上：dd if=/dev/zero of=/dev/block/sda bs=512 count=4
2）Windows上：快速格式化该U盘，这个U盘就只有PBR扇区而没有MBR扇区
2 Windows安装
2.1 BIOS设置
进入BIOS设置，一般有Del、Enter、Esc等键。
2.2 Windows ISO刻录方法
Windows上的Universal USB Installer工具软件：刻录操作系统ISO文件到U盘
Linux下将操作系统ISO文件刻录到U盘：dd if=xxx.iso of=/dev/sda 注意使用的是整个磁盘，所以用的是sda而不是sda1
2.3 Windows GHO镜像安装方法 - 比较常见
1) 制作PE启动U盘
2) 下载Windows ISO镜像后（番茄花园），解压出来，里面包含GHO文件，拷贝到PE启动U盘的GHO文件夹（或者提前将文件.gho拷贝入待装系统的电脑D盘根目录）。
3) 插入PE启动U盘到电脑USB 2.0口，选择从U盘启动，启动到PE界面后，选ghost方式安装，ghost镜像的后缀名.gho。
2.4 Win10临时关闭驱动签名
This PC - Advanced system settings - Advanced - Environment Variables" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/5d06af426c03cc6998be4ba201f673de/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-13T16:02:31+08:00" />
<meta property="article:modified_time" content="2023-12-13T16:02:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Windows Knowledge</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>1 GRUB简介<br> 1.1 MBR和PBR<br> MBR分为GRUB.MBR和DOS.MBR。<br><br> 由于硬盘上扇区从偏移0到偏移62属于同一个磁道0，虽然DOS.MBR仅占用一个扇区，但是需要将DOS.MBR后面的偏移1到偏移62保留，所以磁盘上第一个分区的第一个扇区是从偏移63开始的。fbinst软件会保留1-16064扇区，等于硬盘1个柱面的大小255 x 63 x 512 = 8MB，所以第一个分区是从扇区16065开始的。<br><br> USB-ZIP和USB-FDD会将U盘的第一个扇区格式化成DOS.PBR而不是DOS.MBR。<br> USB-FDD和USB-ZIP的来历：软盘的容量小，没有分区结构，所以软盘是没有MBR的，整个软盘只有一个分区，第一个扇区就是PBR；FDD和ZIP模式在DOS下启动后U盘的盘符是A。<br><br> 1.2 GRUB<br> - GRUB又叫OS Loader；在Android系统上，kernelflinger是OS Loader的一个EFI应用<br> - GRUB镜像组成：GRUB.MBR（boot.img）, 硬盘扇区offset 1 到offset 62放置GRUB的core.img，/boot分区的boot/grub/grub.cfg<br><br> 1.3 创建USB-FDD或者USB-ZIP格式U盘步骤<br> 1）Android上：dd if=/dev/zero of=/dev/block/sda bs=512 count=4<br> 2）Windows上：快速格式化该U盘，这个U盘就只有PBR扇区而没有MBR扇区<br><br> 2 Windows安装<br> 2.1 BIOS设置<br> 进入BIOS设置，一般有Del、Enter、Esc等键。<br><br> 2.2 Windows ISO刻录方法<br> Windows上的Universal USB Installer工具软件：刻录操作系统ISO文件到U盘<br> Linux下将操作系统ISO文件刻录到U盘：dd if=xxx.iso of=/dev/sda 注意使用的是整个磁盘，所以用的是sda而不是sda1<br><br> 2.3 Windows GHO镜像安装方法 - 比较常见<br> 1)  制作PE启动U盘<br> 2) 下载Windows ISO镜像后（番茄花园），解压出来，里面包含GHO文件，拷贝到PE启动U盘的GHO文件夹（或者提前将文件.gho拷贝入待装系统的电脑D盘根目录）。<br> 3) 插入PE启动U盘到电脑USB 2.0口，选择从U盘启动，启动到PE界面后，选ghost方式安装，ghost镜像的后缀名.gho。<br><br> 2.4 Win10临时关闭驱动签名<br> This PC - Advanced system settings - Advanced - Environment Variables<br><br> 开始 - 设置 - 更新和安全 - 恢复 - 点击右边高级启动项下方的立即重启，进入高级启动 - 选择疑难解答 - 高级选项 - 启动设置 - 重启 - 再按数字键7或F7禁止驱动签名<br> 期间可能要求输入Bitlocker Recovery Key，提前从如下的网址中获取，或者在别人电脑登录获取。<br> https://myaccount.microsoft.com/device-list<br><br> 2.5 Printer<br> 2.5.1 Printer<br> 1）HP LaserJet M1005 MFP<br> 2）Nantian PR9 并口-OKI仿真驱动<br><br> 2.5.2 Canon TS308 Cartridge<br> CL-846S Color, PG-845S Black. CL stands for ChromaLife, PG stands for Pigment Based, 8 is for China market, S stands for small.<br> FINE: Canon Full-photolithography Inkjet Nozzle Engineering<br> PIXMA: PIxel Maximum and Power<br> SELPHY: do it yourSELf PHotographY<br><br> How to print without a color cartridge- Canon Pixma?<br> https://www.computerhope.com/forum/index.php?topic=105910.0<br> Having just experienced this same problem with another model (Pixma all in one) from Canon and talking with their tech support I can contribute the following. When ANY cartridge becomes either defective or empty you CANNOT use any of the other components of the device.<br><br> 2.5.3 HP 803 Cartridge Pinout<br> CSYNC: Data group switching line<br> D1: yellow<br> D2: magenta<br> D3: cyan<br> DCLK, S1-S5: clock line<br> F3, F5: Print trigger line<br> TS: Thermal sensor<br><br> 2.5.4 CPU<br> Canon uses Conexant SoC<br> Canon CP-200<br> NEC uPD703107: 32 bit 256 KB mask ROM in 2004<br> Cypress SL811HST<br> Epson REALOID (NEC 90nm)<br><br> 2.5.5 WLAN module<br> Canon<br> ALPS ZE-5P3A, based on marvell 88W8782<br> Canon MG7780<br> Canon USB WLAN K30365, based on Marvell 88W8801<br> Ricoh SP 150SUw<br> USB WLAN WN4616L, based on RTL8192EU<br><br> 3 Windows网络<br> 3.1 CMD方式配置IP地址<br> :: netsh: Network Shell<br> @echo off<br> if [%1] == [] (<br>     echo "Usage:"<br>     echo "WIN_IP.bat static"<br>     echo "WIN_IP.bat dhcp"<br>     echo "WIN_IP.bat speed"<br>     goto :EOF<br> )<br><br> if %1 == static (<br>     call :static_ip 192.168.0.100<br> ) else if %1 == dhcp (<br>     call :dhcp_ip<br> ) else if %1 == speed (<br>     call :nic_speed<br> )<br> goto :EOF<br><br> :static_ip<br> set name="Ethernet"<br> set ip=%~1<br> set mask=255.255.255.0<br> :: gwmetric=1<br> echo "setting static ip address..."<br> netsh interface ipv4 set address %name% static %ip% %mask% none 1<br> :: netsh interface ipv4 set dns %name% static 114.114.114.114<br> :: netsh interface ipv4 add dns %name% 8.8.8.8<br><br> :: Device Manager - Network adapters - Properties - Advanced - VLAN ID<br> PowerShell Get-NetAdapter<br> PowerShell Set-NetAdapterAdvancedProperty -Name %name% -DisplayName \"VLAN ID\" -DisplayValue 60<br> goto :EOF<br><br> :dhcp_ip<br> set name="Ethernet"<br> echo "setting dhcp..."<br> netsh interface ipv4 set address %name% dhcp<br> netsh interface ipv4 set dns %name% dhcp<br><br> PowerShell Reset-NetAdapterAdvancedProperty -Name %name% -DisplayName \"VLAN ID\"<br> goto :EOF<br><br> :nic_speed<br> wmic NIC where NetEnabled=true get Name, Speed<br><br> 3.2 DNS查询流程<br> 1) 现有的DNS缓存<br> ipconfig /displaydns<br> 2) 查询hosts文件<br> C:WindowsSystem32driversetchosts<br> 3) 请求发往DNS服务器<br> ipconfig /all<br><br> 3.3 firewall<br> appwiz.cpl<br> msconfig<br> wf.msc<br> Inbound Rules and Outbound Rules<br> Enable 4 File and Printer Sharing (Echo Request - ICMPv4-Out)<br><br> netsh advfirewall firewall add rule name="UDP ports" protocol=UDP dir=in localport=8080 action=allow<br><br> https://github.com/DynamoRIO/drmemory/wiki/Downloads<br><br> 3.4 Multicast<br> - Windows组播client需要使用setsockopt()设置IP_ADD_MEMBERSHIP（加入指定的组播组）才能接收组播server发送的数据。<br> - 组播MAC地址是指第一个字节的最低位是1的MAC地址。<br> - 组播MAC地址的前3个字节固定为01:00:5e，后3个字节使用组播IP的后23位。例如239.192.255.251的MAC地址为01:00:5e:40:ff:fb。<br> - Windows 10 Wireshark要抓取SOME/IP组播报文，需要使用SocketTool工具监听239.192.255.251:30490，然后Wireshark才会显示组播报文，否则不显示（Windows netmon不需要任何设置，就可以抓到全部报文）。<br><br> netsh interface ip show joins<br><br> Win 10 PowerShell:<br> Get-NetAdapter | Format-List -Property ifAlias,PromiscuousMode<br><br> In Linux, map IP addr to multicast MAC is function ip_eth_mc_map(), kernel eventually calls driver ndo_set_rx_mode() to set multicast MAC to NIC RX MAC filter table.<br><br> 3.5 NAT<br> 查看当前机器的NAT端口代理表：<br> netsh interface portproxy show all<br><br> 1) 第三方软件PortTunnel。<br> 2) ICS（Internet Connection Sharing）是NAT的简化版。<br> 3) showcase: USB Reverse Tethering<br><br> 3.6 route命令用法<br> route [-f] [-p] [command [destination] [mask netmask] [gateway] [metric metric] [if interface]]<br><br> route print<br> ::增加一条到192.168.0.10/24网络的路由，网关是192.168.0.1，最后一个if参数是数字，可以使用route print查询，类似于Android的NetId。<br> route add 192.168.0.0 mask 255.255.255.0 192.168.0.1 metric 1 if 11<br> ::删除192.168.0.10这条路由<br> route delete 192.168.0.0<br><br> 3.7 WiFi AP<br> 1) get password<br> netsh wlan show profiles<br> netsh wlan show profiles name="FAST_ABCD" key=clear<br><br> 2) enable Soft AP<br> netsh wlan show drivers<br> ::netsh wlan set hostednetwork mode=allow<br> netsh wlan set hostednetwork mode=allow ssid=myWIFI key=12345678<br> netsh wlan start hostednetwork<br> ::netsh wlan stop hostednetwork<br><br> 3.8 Malicious software<br> Task Manager<br> Find process name, open file location, remove xxx.exe, rename empty xxx.txt to xxx.exe<br><br> 4 Office<br> 4.1 Excel<br> 4.1.1 插入符号<br> Insert<br> Symbol<br> More Symbols<br> Wingdings 2<br><br> 4.1.2 excel百分比的计算<br> 删除数字之间的空格：fx=SUBSTITUE(C2, " ", "")<br> 选中一个单元格，找到行的坐标，譬如C2和B2，则percent的公式是fx=(C2-B2)/B2。<br> 然后选中D列，右键选择Format Cells...，Percentage - Decimal Places的值为2，会将D列数据转成百分比了。<br><br> 4.2 Outlook<br> 4.2.1 邮箱清理<br> File - Info - Tools - Mailbox Cleanup - AutoArchive<br><br> Calendar (Left Bottom) - View (Change View to Calendar) - Choose Menu Month<br><br> 4.2.2 TCAM filter rule<br> Home - ... - Rules - Create Rule (Manage Rules &amp; Alerts) - Title<br><br> 4.2.3 Automatic Replies<br> File, Info, Automatic Replies<br><br> 4.2.4 邮件组<br> Home - New Items - More Items - Contact Group - Add Members - From Outlook Contacts - Save &amp; Close<br><br> 4.3 Powerpoint画图<br> 插入 - &gt; 形状<br> Insert - &gt; Shapes<br><br> 4.4 Word<br> 升级目录<br> [References][Update Table]<br><br> 5 Sprax EA<br> 5.1 Install<br> Windows - Self Service Client - Find Enterprise Architect - Install<br><br> 5.2 Version Control Settings<br> Working Copy Path: project path - The project folder includes many xml files.<br> Subversion Exe Path: \path\to\TortoiseSVN\bin\svn.exe<br><br> 项目右键 - Package Control - Version Control Settings...<br> EA opens .qea (64bit EA project) for Version Control Settings.<br><br> How to edit specific page?<br> Right-click the specific folder in GUI, choose Package Control - Check Out...<br><br> How to find who locks the editor?<br> Go to the project folder through Windows Explorer, right-click the specific folder, choose TortoiseSVN - Check for modifications - Check repository, find who has locked the folder.<br><br> 5.3 Package拷贝粘贴<br> 拷贝一个package，右键选择Copy - Full Structure for Duplication，然后找到要粘贴的上级package，右键Paste - Package from Clipboard。<br><br> 5.4 Drawing<br> Design - Toolbox<br> Lifeline &amp; Message (Message/Argument/Return Value, Is Return)<br> 拷贝到Word文档中的命令：Publish - Save - Save to Clipboard<br><br> 6 CodeSonar<br> Windows Settings - Apps - Optional features - Add a feature - Find OpenSSH Client - Install<br> Microsoft VS code left - Remote Explorer - SSH Targets - +<br><br> 7 USB<br> Win7 CMD:<br> wmic path Win32_PnPSignedDriver | find "Android"<br> wmic path Win32_PnPSignedDriver | find "USB"<br> :: similar to Linux lsusb<br> wmic path Win32_USBControllerDevice get Dependent<br><br> 8 Abbreviations<br> CAB: Capacity Approval Board<br> NPcap: Nmap Packet Capture<br> wmic: Windows Management Instrumentation Command-line</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5c756acfb01a4a7790ea159b6faadf07/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Spark RDD的转换</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e529972c2522d531f5c72595c4f543ec/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">滤光片的作用和原理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>