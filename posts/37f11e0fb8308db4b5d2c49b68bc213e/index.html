<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mysql根据日周月分组计算 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mysql根据日周月分组计算" />
<meta property="og:description" content="mysql根据日周月分组计算 一、mysql生成默认当前日前往前的日期 1、按月份默认生成
(SELECT DATE_FORMAT( @cdate := date_add( @cdate, INTERVAL - 1 MONTH ), &#39;%Y-%m&#39; ) date FROM ( SELECT @cdate := date_add( CURDATE(), INTERVAL 1 MONTH ) FROM `mysql`.`help_topic` LIMIT 14) a) 生成结果
2、按天默认生成
(select (curdate() &#43; interval (cast(`mysql`.`help_topic`.`help_topic_id` as signed) - 10) day) AS date from `mysql`.`help_topic` having (date &lt;= date_format(curdate(),&#39;%Y-%m-%d&#39;))) 生成结果
二、mysql按日周月分组统计 1、获取原始数据
SELECT wgwl_date_event_volume,date_processing_capacity,date_unprocessed_volume,zjg_date_event_volume,date_case_volume, overView_time FROM task_status_statistics 获取结果
2、按日统计默认最近10天的数据
SELECT SUM(b.zjg_date_event_volume)zjg_date_event_volume,SUM(b.date_case_volume)date_case_volume,temp.date overView_time FROM (select (curdate() &#43; interval (cast(`mysql`." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/37f11e0fb8308db4b5d2c49b68bc213e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-08T09:40:44+08:00" />
<meta property="article:modified_time" content="2022-08-08T09:40:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mysql根据日周月分组计算</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="mysql_0"></a>mysql根据日周月分组计算</h3> 
<h4><a id="mysql_2"></a>一、mysql生成默认当前日前往前的日期</h4> 
<p>1、按月份默认生成</p> 
<pre><code class="prism language-sql"><span class="token punctuation">(</span><span class="token keyword">SELECT</span> DATE_FORMAT<span class="token punctuation">(</span> <span class="token variable">@cdate</span> :<span class="token operator">=</span> date_add<span class="token punctuation">(</span> <span class="token variable">@cdate</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">MONTH</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%Y-%m'</span> <span class="token punctuation">)</span> <span class="token keyword">date</span> <span class="token keyword">FROM</span> <span class="token punctuation">(</span> <span class="token keyword">SELECT</span> <span class="token variable">@cdate</span> :<span class="token operator">=</span> date_add<span class="token punctuation">(</span> CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">MONTH</span> <span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>mysql<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>help_topic<span class="token punctuation">`</span></span>  <span class="token keyword">LIMIT</span> <span class="token number">14</span><span class="token punctuation">)</span> a<span class="token punctuation">)</span>
</code></pre> 
<p>生成结果<br> <img src="https://images2.imgbox.com/86/e0/gUO2RdvR_o.png" alt="在这里插入图片描述"></p> 
<p>2、按天默认生成</p> 
<pre><code class="prism language-sql"><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token punctuation">(</span>curdate<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">interval</span> <span class="token punctuation">(</span>cast<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>mysql<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>help_topic<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>help_topic_id<span class="token punctuation">`</span></span> <span class="token keyword">as</span> signed<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">day</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token keyword">date</span> <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>mysql<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>help_topic<span class="token punctuation">`</span></span> <span class="token keyword">having</span> <span class="token punctuation">(</span><span class="token keyword">date</span> <span class="token operator">&lt;=</span> date_format<span class="token punctuation">(</span>curdate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>生成结果<br> <img src="https://images2.imgbox.com/d6/8e/VHx5K18x_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="mysql_20"></a>二、mysql按日周月分组统计</h4> 
<p>1、获取原始数据</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> wgwl_date_event_volume<span class="token punctuation">,</span>date_processing_capacity<span class="token punctuation">,</span>date_unprocessed_volume<span class="token punctuation">,</span>zjg_date_event_volume<span class="token punctuation">,</span>date_case_volume<span class="token punctuation">,</span> overView_time <span class="token keyword">FROM</span> task_status_statistics
</code></pre> 
<p>获取结果<br> <img src="https://images2.imgbox.com/dd/a7/9ot3Qzyr_o.png" alt="在这里插入图片描述"><br> 2、按日统计默认最近10天的数据</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>   <span class="token function">SUM</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>zjg_date_event_volume<span class="token punctuation">)</span>zjg_date_event_volume<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>date_case_volume<span class="token punctuation">)</span>date_case_volume<span class="token punctuation">,</span><span class="token keyword">temp</span><span class="token punctuation">.</span><span class="token keyword">date</span> overView_time
<span class="token keyword">FROM</span>
     <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token punctuation">(</span>curdate<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">interval</span> <span class="token punctuation">(</span>cast<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>mysql<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>help_topic<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>help_topic_id<span class="token punctuation">`</span></span> <span class="token keyword">as</span> signed<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">day</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token keyword">date</span> <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>mysql<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>help_topic<span class="token punctuation">`</span></span> <span class="token keyword">having</span> <span class="token punctuation">(</span><span class="token keyword">date</span> <span class="token operator">&lt;=</span> date_format<span class="token punctuation">(</span>curdate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">temp</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">select</span> zjg_date_event_volume<span class="token punctuation">,</span>date_case_volume<span class="token punctuation">,</span> overView_time <span class="token keyword">from</span> task_status_statistics <span class="token keyword">where</span> overview_time <span class="token operator">&gt;=</span>DATE_SUB<span class="token punctuation">(</span>CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">10</span>  <span class="token keyword">DAY</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      b <span class="token keyword">on</span> <span class="token keyword">temp</span><span class="token punctuation">.</span><span class="token keyword">date</span> <span class="token operator">=</span> DATE_FORMAT<span class="token punctuation">(</span>b<span class="token punctuation">.</span>overview_time<span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">temp</span><span class="token punctuation">.</span><span class="token keyword">date</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token keyword">temp</span><span class="token punctuation">.</span><span class="token keyword">date</span> <span class="token keyword">DESC</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span>
</code></pre> 
<p>统计结果<br> <img src="https://images2.imgbox.com/34/26/O7zo5k4t_o.png" alt="在这里插入图片描述"><br> 3、按周统计默认最近10个周的数据</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>zjg_date_event_volume<span class="token punctuation">)</span> zjg_date_event_volume<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>date_case_volume<span class="token punctuation">)</span> date_case_volume<span class="token punctuation">,</span>CONCAT<span class="token punctuation">(</span>SUBSTR<span class="token punctuation">(</span>DATE_FORMAT<span class="token punctuation">(</span><span class="token keyword">temp</span><span class="token punctuation">.</span><span class="token keyword">date</span><span class="token punctuation">,</span><span class="token string">'%Y-%u'</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token number">1</span> <span class="token keyword">FOR</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'年第'</span><span class="token punctuation">,</span>SUBSTR<span class="token punctuation">(</span>DATE_FORMAT<span class="token punctuation">(</span><span class="token keyword">temp</span><span class="token punctuation">.</span><span class="token keyword">date</span><span class="token punctuation">,</span><span class="token string">'%Y-%u'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'周'</span><span class="token punctuation">)</span> weeks<span class="token punctuation">,</span><span class="token keyword">temp</span><span class="token punctuation">.</span><span class="token keyword">date</span> overView_time
<span class="token keyword">FROM</span>
       <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token punctuation">(</span>curdate<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">interval</span> <span class="token punctuation">(</span>cast<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>mysql<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>help_topic<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>help_topic_id<span class="token punctuation">`</span></span> <span class="token keyword">as</span> signed<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">day</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token keyword">date</span> <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>mysql<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>help_topic<span class="token punctuation">`</span></span> <span class="token keyword">having</span> <span class="token punctuation">(</span><span class="token keyword">date</span> <span class="token operator">&lt;=</span> date_format<span class="token punctuation">(</span>curdate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">temp</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">select</span> zjg_date_event_volume<span class="token punctuation">,</span>date_case_volume<span class="token punctuation">,</span> overView_time <span class="token keyword">from</span> task_status_statistics <span class="token keyword">where</span> overview_time <span class="token operator">&gt;=</span>DATE_SUB<span class="token punctuation">(</span>CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">76</span>  <span class="token keyword">DAY</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        b <span class="token keyword">on</span> <span class="token keyword">temp</span><span class="token punctuation">.</span><span class="token keyword">date</span> <span class="token operator">=</span> DATE_FORMAT<span class="token punctuation">(</span>b<span class="token punctuation">.</span>overview_time<span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> date_format<span class="token punctuation">(</span><span class="token keyword">temp</span><span class="token punctuation">.</span><span class="token keyword">date</span><span class="token punctuation">,</span> <span class="token string">'%Y-%u'</span><span class="token punctuation">)</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token keyword">temp</span><span class="token punctuation">.</span><span class="token keyword">date</span> <span class="token keyword">DESC</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span>
</code></pre> 
<p>统计结果<br> <img src="https://images2.imgbox.com/b1/7b/kBSskGv6_o.png" alt="在这里插入图片描述"><br> 4、按月统计默认最近10个月的数据</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 
    <span class="token function">SUM</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>zjg_date_event_volume<span class="token punctuation">)</span> zjg_date_event_volume<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>date_case_volume<span class="token punctuation">)</span> date_case_volume<span class="token punctuation">,</span>aa<span class="token punctuation">.</span><span class="token keyword">date</span> overView_time
<span class="token keyword">FROM</span>
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> DATE_FORMAT<span class="token punctuation">(</span> <span class="token variable">@cdate</span> :<span class="token operator">=</span> date_add<span class="token punctuation">(</span> <span class="token variable">@cdate</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">MONTH</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%Y-%m'</span> <span class="token punctuation">)</span> <span class="token keyword">date</span> <span class="token keyword">FROM</span> <span class="token punctuation">(</span> <span class="token keyword">SELECT</span> <span class="token variable">@cdate</span> :<span class="token operator">=</span> date_add<span class="token punctuation">(</span> CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">MONTH</span> <span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>mysql<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>help_topic<span class="token punctuation">`</span></span>  <span class="token keyword">LIMIT</span> <span class="token number">14</span><span class="token punctuation">)</span> a<span class="token punctuation">)</span> aa 
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> zjg_date_event_volume<span class="token punctuation">,</span>date_case_volume<span class="token punctuation">,</span>mon overView_time <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> zjg_date_event_volume<span class="token punctuation">,</span>date_case_volume<span class="token punctuation">,</span>overView_time<span class="token punctuation">,</span> DATE_FORMAT<span class="token punctuation">(</span>overView_time<span class="token punctuation">,</span><span class="token string">'%Y-%m'</span><span class="token punctuation">)</span> mon <span class="token keyword">FROM</span> task_status_statistics <span class="token keyword">WHERE</span> overView_time <span class="token operator">&gt;=</span> DATE_SUB<span class="token punctuation">(</span>CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">YEAR</span><span class="token punctuation">)</span><span class="token punctuation">)</span> a<span class="token punctuation">)</span> b <span class="token keyword">on</span> aa<span class="token punctuation">.</span><span class="token keyword">date</span> <span class="token operator">=</span> b<span class="token punctuation">.</span>overView_time
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> aa<span class="token punctuation">.</span><span class="token keyword">date</span> <span class="token keyword">order</span> <span class="token keyword">by</span> aa<span class="token punctuation">.</span><span class="token keyword">date</span> <span class="token keyword">desc</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span>
</code></pre> 
<p>统计结果<br> <img src="https://images2.imgbox.com/94/fb/zR6fAmTX_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/158eb6b34e40bd2ab48764866a2da134/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">​stp文件转ply</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cba8f53d345935749ab389057345a86b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">解决deep freeze冰点还原软件无法冻结的问题：计算机正在完成Deep Freeze冰点检测到的待定Windows更新</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>