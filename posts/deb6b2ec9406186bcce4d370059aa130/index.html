<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CSerialPort教程4.3.x (8) - CSerialPort调试模式的使用 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CSerialPort教程4.3.x (8) - CSerialPort调试模式的使用" />
<meta property="og:description" content="CSerialPort教程4.3.x (8) - CSerialPort调试模式的使用 前言 CSerialPort项目是一个基于C/C&#43;&#43;的轻量级开源跨平台串口类库，可以轻松实现跨平台多操作系统的串口读写，同时还支持C#, Java, Python, Node.js等。
CSerialPort项目的开源协议自 V3.0.0.171216 版本后采用GNU Lesser General Public License v3.0
为了让开发者更好的使用CSerialPort进行开发，特编写基于4.3.x版本的CSerialPort教程系列。
CSerialPort项目地址：
https://github.com/itas109/CSerialPorthttps://gitee.com/itas109/CSerialPort 本文将介绍CSerialPort如何输出详细调试信息及日志。
1. 开启CSerialPort输出详细调试信息及日志 默认情况下，CSerialPort不会输出详细调试信息及日志。
可以通过宏定义CSERIALPORT_DEBUG来开启输出调试信息及日志(v4.2.2及以后版本支持)。
可以输出串口初始化、发送、接收、写缓冲区等详细调试信息。
相关代码位于include\CSerialPort\SerialPort_global.h中
#ifdef CSERIALPORT_DEBUG #include &lt;stdio.h&gt; #include &lt;string.h&gt; // strrchr #ifdef _WIN32 #ifndef __func__ #define __func__ __FUNCTION__ #endif #define LOG_INFO(format, ...) printf(&#34;[CSERIALPORT_DEBUG] %s - &#34; format &#34;\n&#34;, __func__, ##__VA_ARGS__) #else #define LOG_INFO(format, ...) printf(&#34;[CSERIALPORT_DEBUG] %s - &#34; format &#34;\n&#34;, __func__, ##__VA_ARGS__) #endif #else #define LOG_INFO(format, ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/deb6b2ec9406186bcce4d370059aa130/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-20T10:41:51+08:00" />
<meta property="article:modified_time" content="2023-08-20T10:41:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CSerialPort教程4.3.x (8) - CSerialPort调试模式的使用</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="CSerialPort43x_8__CSerialPort_0"></a>CSerialPort教程4.3.x (8) - CSerialPort调试模式的使用</h2> 
<h3><a id="_2"></a>前言</h3> 
<p><a href="https://github.com/itas109/CSerialPort">CSerialPort</a>项目是一个基于C/C++的轻量级开源跨平台串口类库，可以轻松实现跨平台多操作系统的串口读写，同时还支持C#, Java, Python, Node.js等。</p> 
<p>CSerialPort项目的开源协议自 V3.0.0.171216 版本后采用<a href="https://github.com/itas109/CSerialPort/blob/master/LICENSE">GNU Lesser General Public License v3.0</a></p> 
<p>为了让开发者更好的使用CSerialPort进行开发，特编写基于4.3.x版本的CSerialPort教程系列。</p> 
<p>CSerialPort项目地址：</p> 
<ul><li><a href="https://github.com/itas109/CSerialPort">https://github.com/itas109/CSerialPort</a></li><li><a href="https://gitee.com/itas109/CSerialPort" rel="nofollow">https://gitee.com/itas109/CSerialPort</a></li></ul> 
<p><strong>本文将介绍CSerialPort如何输出详细调试信息及日志。</strong></p> 
<h3><a id="1_CSerialPort_16"></a>1. 开启CSerialPort输出详细调试信息及日志</h3> 
<p>默认情况下，CSerialPort不会输出详细调试信息及日志。</p> 
<p>可以通过宏定义<code>CSERIALPORT_DEBUG</code>来开启输出调试信息及日志(v4.2.2及以后版本支持)。</p> 
<p>可以输出串口初始化、发送、接收、写缓冲区等详细调试信息。</p> 
<p>相关代码位于<code>include\CSerialPort\SerialPort_global.h</code>中</p> 
<pre><code>#ifdef CSERIALPORT_DEBUG
#include &lt;stdio.h&gt;
#include &lt;string.h&gt; // strrchr
#ifdef _WIN32
#ifndef __func__
#define __func__ __FUNCTION__
#endif
#define LOG_INFO(format, ...) printf("[CSERIALPORT_DEBUG] %s - " format "\n", __func__, ##__VA_ARGS__)
#else
#define LOG_INFO(format, ...) printf("[CSERIALPORT_DEBUG] %s - " format "\n", __func__, ##__VA_ARGS__)
#endif
#else
#define LOG_INFO(format, ...)
#endif
</code></pre> 
<h3><a id="2_CSerialPort_44"></a>2. 控制台中查看CSerialPort详细调试信息</h3> 
<p>控制台示例程序位于<code>examples\CommNoGui</code>，通过在<code>CMakeLists.txt</code>中增加宏定义<code>CSERIALPORT_DEBUG</code>开启输出调试信息及日志。</p> 
<pre><code>add_definitions(-DCSERIALPORT_DEBUG)
</code></pre> 
<p>结果：</p> 
<pre><code>Version: https://github.com/itas109/CSerialPort - V4.3.0.230215

availableFriendlyPorts:
1 - COM1 USB-SERIAL CH340  USB\VID_1A86&amp;PID_7523&amp;REV_0264

Please Input The Index Of Port(1 - 1)
1
Port Name: COM1
[CSERIALPORT_DEBUG] CSerialPortWinBase::openPort - portName: COM1, baudRate: 9600, dataBit: 8, parity: 0, stopBit: 0, flowControl: 0, mode: async, readBufferSize:4096(4096), readIntervalTimeoutMS: 0, minByteReadNotify: 1
[CSERIALPORT_DEBUG] CSerialPortWinBase::openPort - open COM1. code: 0, message: success
Open COM1 Success. Code: 0, Message: success
[CSERIALPORT_DEBUG] CSerialPortWinBase::writeData - write. len: 5, hex(top100): 3132333435
[CSERIALPORT_DEBUG] CSerialPortWinBase::writeData - write. len: 7, hex(top100): 69746173313039
[CSERIALPORT_DEBUG] CSerialPortWinBase::commThreadMonitor - write buffer(usedLen 12). len: 12, hex(top100): 313233343569746173313039
[CSERIALPORT_DEBUG] CSerialPortWinBase::commThreadMonitor - onReadEvent. portName: COM1, readLen: 12
[CSERIALPORT_DEBUG] CSerialPortWinBase::readData - read. len: 12, hex(top100): 313233343569746173313039
COM1 - Count: 1, Length: 12, Str: 12345itas109, Hex: 0x31 0x32 0x33 0x34 0x35 0x69 0x74 0x61 0x73 0x31 0x30 0x39
</code></pre> 
<h3><a id="3_MFCGUICSerialPort_70"></a>3. MFC等GUI中查看CSerialPort详细调试信息</h3> 
<p>有GUI的程序不能直接查看控制台输出的信息，这里我们使用重定向的方式将控制台信息输出到日志。</p> 
<p>这里以<code>examples\CommMFC</code>为例。<br> 在<code>CMakeLists.txt</code>中增加宏定义<code>CSERIALPORT_DEBUG</code>开启输出调试信息及日志。</p> 
<pre><code>add_definitions(-DCSERIALPORT_DEBUG)
</code></pre> 
<p>控制台中以重定向的方式运行CommMFC.exe</p> 
<pre><code>CommMFC.exe &gt; CSerialPort.log
</code></pre> 
<p>正常操作后，关闭CommMFC.exe。</p> 
<p>结果：</p> 
<p>CSerialPort.log</p> 
<pre><code>[CSERIALPORT_DEBUG] CSerialPortWinBase::openPort - portName: COM1, baudRate: 9600, dataBit: 8, parity: 0, stopBit: 0, flowControl: 0, mode: async, readBufferSize:4096(4096), readIntervalTimeoutMS: 0, minByteReadNotify: 1
[CSERIALPORT_DEBUG] CSerialPortWinBase::openPort - open COM1. code: 0, message: success
[CSERIALPORT_DEBUG] CSerialPortWinBase::writeData - write. len: 29, hex(top100): 68747470733A2F2F626C6F672E6373646E2E6E65742F69746173313039
[CSERIALPORT_DEBUG] CSerialPortWinBase::commThreadMonitor - write buffer(usedLen 29). len: 29, hex(top100): 68747470733A2F2F626C6F672E6373646E2E6E65742F69746173313039
[CSERIALPORT_DEBUG] CSerialPortWinBase::commThreadMonitor - onReadEvent. portName: COM1, readLen: 29
[CSERIALPORT_DEBUG] CSerialPortWinBase::readData - read. len: 29, hex(top100): 68747470733A2F2F626C6F672E6373646E2E6E65742F69746173313039
</code></pre> 
<hr> 
<p><strong>License</strong></p> 
<p><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" rel="nofollow"><em>License under CC BY-NC-ND 4.0: 署名-非商业使用-禁止演绎</em></a></p> 
<hr> 
<p>Reference:</p> 
<ol><li><a href="https://github.com/itas109/CSerialPort">https://github.com/itas109/CSerialPort</a></li><li><a href="https://gitee.com/itas109/CSerialPort" rel="nofollow">https://gitee.com/itas109/CSerialPort</a></li><li><a href="https://blog.csdn.net/itas109">https://blog.csdn.net/itas109</a></li></ol>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/12005557aecbb2d2ec8ee96a860a999d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mybatis入门的环境搭建及快速完成CRUD(增删改查)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8791f37beaea296b7d813dcb632e3f98/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Docker】完整的搭建和发布过程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>