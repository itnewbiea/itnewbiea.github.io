<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Zookeeper的本地安装部署和分布式安装部署 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Zookeeper的本地安装部署和分布式安装部署" />
<meta property="og:description" content="文章目录 一. 本地模式安装部署1）安装前准备2）配置修改3）操作Zookeeper 1.2 配置参数解读 二. 分布式安装部署1）集群规划2）解压安装3）配置服务器编号4）配置zoo.cfg文件5）集群操作 客户端命令行操作1）启动客户端2）显示所有操作命令3）查看当前znode中所包含的内容4）查看当前节点详细数据 8）创建带序号的节点 一. 本地模式安装部署 1）安装前准备 （1）安装Jdk
（2）拷贝Zookeeper安装包到Linux系统下
（3）解压到指定目录
[atbigdata@hadoop102 software]$ tar -zxvf zookeeper-3.5.7.tar.gz -C /opt/module/ 2）配置修改 （1）将/opt/module/zookeeper-3.5.7/conf这个路径下的zoo_sample.cfg修改为zoo.cfg；
[atbigdata@hadoop102 conf]$ mv zoo_sample.cfg zoo.cfg （2）打开zoo.cfg文件，修改dataDir路径： [atbigdata@hadoop102 zookeeper-3.5.7]$ vim zoo.cfg
修改如下内容：
dataDir=/opt/module/zookeeper-3.5.7/zkData （3）在/opt/module/zookeeper-3.5.7/这个目录上创建zkData文件夹 [atbigdata@hadoop102 zookeeper-3.5.7]$ mkdir zkData 3）操作Zookeeper （1）启动Zookeeper
[atbigdata@hadoop102 zookeeper-3.5.7]$ bin/zkServer.sh start （2）查看进程是否启动
[atbigdata@hadoop102 zookeeper-3.5.7]$ jps 4020 Jps
4001 QuorumPeerMain
（3）查看状态：
[atbigdata@hadoop102 zookeeper-3.5.7]$ bin/zkServer.sh status ZooKeeper JMX enabled by default
Using config: /opt/module/zookeeper-3.5.7/bin/…/conf/zoo.cfg
Mode: standalone" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/99a780ec284e16c8882ede155b8198c4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-21T21:12:47+08:00" />
<meta property="article:modified_time" content="2023-01-21T21:12:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Zookeeper的本地安装部署和分布式安装部署</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#__2" rel="nofollow">一. 本地模式安装部署</a></li><li><ul><li><ul><li><a href="#1_4" rel="nofollow">1）安装前准备</a></li><li><a href="#2_14" rel="nofollow">2）配置修改</a></li><li><a href="#3Zookeeper_35" rel="nofollow">3）操作Zookeeper</a></li></ul> 
   </li><li><a href="#12__78" rel="nofollow">1.2 配置参数解读</a></li></ul> 
  </li><li><a href="#___93" rel="nofollow">二. 分布式安装部署</a></li><li><ul><li><ul><li><a href="#1_95" rel="nofollow">1）集群规划</a></li><li><a href="#2_99" rel="nofollow">2）解压安装</a></li><li><a href="#3_113" rel="nofollow">3）配置服务器编号</a></li><li><a href="#4zoocfg_139" rel="nofollow">4）配置zoo.cfg文件</a></li><li><a href="#5_177" rel="nofollow">5）集群操作</a></li></ul> 
   </li><li><a href="#_213" rel="nofollow">客户端命令行操作</a></li><li><ul><li><a href="#1_216" rel="nofollow">1）启动客户端</a></li><li><a href="#2_222" rel="nofollow">2）显示所有操作命令</a></li><li><a href="#3znode_228" rel="nofollow">3）查看当前znode中所包含的内容</a></li><li><a href="#4_236" rel="nofollow">4）查看当前节点详细数据</a></li></ul> 
   </li><li><a href="#8_328" rel="nofollow">8）创建带序号的节点</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="__2"></a>一. 本地模式安装部署</h2> 
<h4><a id="1_4"></a>1）安装前准备</h4> 
<p>（1）安装Jdk<br> （2）拷贝Zookeeper安装包到Linux系统下<br> （3）解压到指定目录</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> software<span class="token punctuation">]</span>$ tar <span class="token operator">-</span>zxvf zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span><span class="token class-name">C</span> <span class="token operator">/</span>opt<span class="token operator">/</span><span class="token keyword">module</span><span class="token operator">/</span>
</code></pre> 
<h4><a id="2_14"></a>2）配置修改</h4> 
<p>（1）将/opt/module/zookeeper-3.5.7/conf这个路径下的zoo_sample.cfg修改为zoo.cfg；</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> conf<span class="token punctuation">]</span>$ mv zoo_sample<span class="token punctuation">.</span>cfg zoo<span class="token punctuation">.</span>cfg
</code></pre> 
<pre><code>（2）打开zoo.cfg文件，修改dataDir路径：
</code></pre> 
<p>[atbigdata@hadoop102 zookeeper-3.5.7]$ vim zoo.cfg<br> 修改如下内容：</p> 
<pre><code class="prism language-java">dataDir<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span><span class="token keyword">module</span><span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token operator">/</span>zkData
</code></pre> 
<pre><code>（3）在/opt/module/zookeeper-3.5.7/这个目录上创建zkData文件夹
</code></pre> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span>$ mkdir zkData
</code></pre> 
<h4><a id="3Zookeeper_35"></a>3）操作Zookeeper</h4> 
<p>（1）启动Zookeeper</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span>$ bin<span class="token operator">/</span>zkServer<span class="token punctuation">.</span>sh start
</code></pre> 
<p>（2）查看进程是否启动</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span>$ jps
</code></pre> 
<p>4020 Jps<br> 4001 QuorumPeerMain<br> （3）查看状态：</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span>$ bin<span class="token operator">/</span>zkServer<span class="token punctuation">.</span>sh status
</code></pre> 
<p>ZooKeeper JMX enabled by default<br> Using config: /opt/module/zookeeper-3.5.7/bin/…/conf/zoo.cfg<br> Mode: standalone<br> （4）启动客户端：</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span>$ bin<span class="token operator">/</span>zkCli<span class="token punctuation">.</span>sh
</code></pre> 
<p>（5）退出客户端：</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">0</span><span class="token punctuation">]</span> quit
</code></pre> 
<p>（6）停止Zookeeper</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span>$ bin<span class="token operator">/</span>zkServer<span class="token punctuation">.</span>sh stop
</code></pre> 
<h3><a id="12__78"></a>1.2 配置参数解读</h3> 
<p>Zookeeper中的配置文件zoo.cfg中参数含义解读如下：<br> 1）tickTime =2000：通信心跳数，Zookeeper服务器与客户端心跳时间，单位毫秒<br> Zookeeper使用的基本时间，服务器之间或客户端与服务器之间维持心跳的时间间隔，也就是每个tickTime时间就会发送一个心跳，时间单位为毫秒。<br> 它用于心跳机制，并且设置最小的session超时时间为两倍心跳时间。(session的最小超时时间是2*tickTime)<br> 2）initLimit =10：LF初始通信时限<br> 集群中的Follower跟随者服务器与Leader领导者服务器之间初始连接时能容忍的最多心跳数（tickTime的数量），用它来限定集群中的Zookeeper服务器连接到Leader的时限。<br> 3）syncLimit =5：LF同步通信时限<br> 集群中Leader与Follower之间的最大响应时间单位，假如响应超过syncLimit * tickTime，Leader认为Follwer死掉，从服务器列表中删除Follwer。<br> 4）dataDir：数据文件目录+数据持久化路径<br> 主要用于保存Zookeeper中的数据。<br> 5）clientPort =2181：客户端连接端口<br> 监听客户端连接的端口。</p> 
<h2><a id="___93"></a>二. 分布式安装部署</h2> 
<h4><a id="1_95"></a>1）集群规划</h4> 
<p>在hadoop102、hadoop103和hadoop104三个节点上部署Zookeeper。</p> 
<h4><a id="2_99"></a>2）解压安装</h4> 
<p>（1）解压Zookeeper安装包到/opt/module/目录下</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> software<span class="token punctuation">]</span>$ tar <span class="token operator">-</span>zxvf zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span><span class="token class-name">C</span> <span class="token operator">/</span>opt<span class="token operator">/</span><span class="token keyword">module</span><span class="token operator">/</span>
</code></pre> 
<p>（2）同步/opt/module/zookeeper-3.5.7目录内容到hadoop103、hadoop104</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> <span class="token keyword">module</span><span class="token punctuation">]</span>$ xsync zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token operator">/</span>
</code></pre> 
<h4><a id="3_113"></a>3）配置服务器编号</h4> 
<p>（1）在/opt/module/zookeeper-3.5.7/这个目录下创建zkData</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span>$ mkdir <span class="token operator">-</span>p zkData
</code></pre> 
<p>（2）在/opt/module/zookeeper-3.5.7/zkData目录下创建一个myid的文件</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> zkData<span class="token punctuation">]</span>$ touch myid
</code></pre> 
<p>添加myid文件，注意一定要在linux里面创建，在notepad++里面很可能乱码<br> （3）编辑myid文件<br> [atbigdata@hadoop102 zkData]$ vi myid<br> 在文件中添加与server对应的编号：2<br> （4）拷贝配置好的zookeeper到其他机器上</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> zkData<span class="token punctuation">]</span>$ xsync myid
</code></pre> 
<p>并分别在hadoop103、hadoop104上修改myid文件中内容为3、4</p> 
<h4><a id="4zoocfg_139"></a>4）配置zoo.cfg文件</h4> 
<p>（1）重命名/opt/module/zookeeper-3.5.7/conf这个目录下的zoo_sample.cfg为zoo.cfg</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> conf<span class="token punctuation">]</span>$ mv zoo_sample<span class="token punctuation">.</span>cfg zoo<span class="token punctuation">.</span>cfg
</code></pre> 
<p>（2）打开zoo.cfg文件</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> conf<span class="token punctuation">]</span>$ vim zoo<span class="token punctuation">.</span>cfg
</code></pre> 
<pre><code class="prism language-java">修改数据存储路径配置
dataDir<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span><span class="token keyword">module</span><span class="token operator">/</span>zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token operator">/</span>zkData
增加如下配置
#######################cluster##########################
server<span class="token punctuation">.</span><span class="token number">2</span><span class="token operator">=</span>hadoop102<span class="token operator">:</span><span class="token number">2888</span><span class="token operator">:</span><span class="token number">3888</span>
server<span class="token punctuation">.</span><span class="token number">3</span><span class="token operator">=</span>hadoop103<span class="token operator">:</span><span class="token number">2888</span><span class="token operator">:</span><span class="token number">3888</span>
server<span class="token punctuation">.</span><span class="token number">4</span><span class="token operator">=</span>hadoop104<span class="token operator">:</span><span class="token number">2888</span><span class="token operator">:</span><span class="token number">3888</span>
</code></pre> 
<p>（3）同步zoo.cfg配置文件</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> conf<span class="token punctuation">]</span>$ xsync zoo<span class="token punctuation">.</span>cfg
</code></pre> 
<p>（4）配置参数解读<br> server.A=B:C:D。<br> A是一个数字，表示这个是第几号服务器；<br> 集群模式下配置一个文件myid，这个文件在dataDir目录下，这个文件里面有一个数据就是A的值，Zookeeper启动时读取此文件，拿到里面的数据与zoo.cfg里面的配置信息比较从而判断到底是哪个server。<br> B是这个服务器的地址；<br> C是这个服务器Follower与集群中的Leader服务器交换信息的端口；<br> D是万一集群中的Leader服务器挂了，需要一个端口来重新进行选举，选出一个新的Leader，而这个端口就是用来执行选举时服务器相互通信的端口。</p> 
<h4><a id="5_177"></a>5）集群操作</h4> 
<p>（1）分别启动Zookeeper</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span>$ bin<span class="token operator">/</span>zkServer<span class="token punctuation">.</span>sh start
<span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop103</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span>$ bin<span class="token operator">/</span>zkServer<span class="token punctuation">.</span>sh start
<span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop104</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span>$ bin<span class="token operator">/</span>zkServer<span class="token punctuation">.</span>sh start
</code></pre> 
<p>（2）查看状态</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop102</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span># bin<span class="token operator">/</span>zkServer<span class="token punctuation">.</span>sh status
</code></pre> 
<p>JMX enabled by default<br> Using config: /opt/module/zookeeper-3.5.7/bin/…/conf/zoo.cfg<br> Mode: follower</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop103</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span># bin<span class="token operator">/</span>zkServer<span class="token punctuation">.</span>sh status
</code></pre> 
<p>JMX enabled by default<br> Using config: /opt/module/zookeeper-3.5.7/bin/…/conf/zoo.cfg<br> Mode: leader</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop104</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span># bin<span class="token operator">/</span>zkServer<span class="token punctuation">.</span>sh status
</code></pre> 
<p>JMX enabled by default<br> Using config: /opt/module/zookeeper-3.5.7/bin/…/conf/zoo.cfg<br> Mode: follower</p> 
<h3><a id="_213"></a>客户端命令行操作</h3> 
<p><img src="https://images2.imgbox.com/02/04/mJSW8geM_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="1_216"></a>1）启动客户端</h4> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop103</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span>$ bin<span class="token operator">/</span>zkCli<span class="token punctuation">.</span>sh
</code></pre> 
<h4><a id="2_222"></a>2）显示所有操作命令</h4> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">]</span> help
</code></pre> 
<h4><a id="3znode_228"></a>3）查看当前znode中所包含的内容</h4> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">0</span><span class="token punctuation">]</span> ls <span class="token operator">/</span>
</code></pre> 
<p>[zookeeper]</p> 
<h4><a id="4_236"></a>4）查看当前节点详细数据</h4> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">]</span> ls <span class="token operator">-</span>s <span class="token operator">/</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zookeeper<span class="token punctuation">]</span>
cZxid <span class="token operator">=</span> <span class="token number">0x0</span>
ctime <span class="token operator">=</span> <span class="token class-name">Thu</span> <span class="token class-name">Jan</span> <span class="token number">01</span> <span class="token number">08</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> <span class="token constant">CST</span> <span class="token number">1970</span>
mZxid <span class="token operator">=</span> <span class="token number">0x0</span>
mtime <span class="token operator">=</span> <span class="token class-name">Thu</span> <span class="token class-name">Jan</span> <span class="token number">01</span> <span class="token number">08</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> <span class="token constant">CST</span> <span class="token number">1970</span>
pZxid <span class="token operator">=</span> <span class="token number">0x0</span>
cversion <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
dataVersion <span class="token operator">=</span> <span class="token number">0</span>
aclVersion <span class="token operator">=</span> <span class="token number">0</span>
ephemeralOwner <span class="token operator">=</span> <span class="token number">0x0</span>
dataLength <span class="token operator">=</span> <span class="token number">0</span>
numChildren <span class="token operator">=</span> <span class="token number">1</span>
</code></pre> 
<p>5）分别创建2个普通节点</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">3</span><span class="token punctuation">]</span> create <span class="token operator">/</span>sanguo <span class="token string">"diaochan"</span>
<span class="token class-name">Created</span> <span class="token operator">/</span>sanguo
<span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">4</span><span class="token punctuation">]</span> create <span class="token operator">/</span>sanguo<span class="token operator">/</span>shuguo <span class="token string">"liubei"</span>
<span class="token class-name">Created</span> <span class="token operator">/</span>sanguo<span class="token operator">/</span>shuguo
</code></pre> 
<p>6）获得节点的值</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">5</span><span class="token punctuation">]</span> get <span class="token operator">/</span>sanguo
diaochan
<span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">6</span><span class="token punctuation">]</span> get <span class="token operator">-</span>s <span class="token operator">/</span>sanguo
diaochan
cZxid <span class="token operator">=</span> <span class="token number">0x100000003</span>
ctime <span class="token operator">=</span> <span class="token class-name">Wed</span> <span class="token class-name">Aug</span> <span class="token number">29</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">03</span><span class="token operator">:</span><span class="token number">23</span> <span class="token constant">CST</span> <span class="token number">2018</span>
mZxid <span class="token operator">=</span> <span class="token number">0x100000003</span>
mtime <span class="token operator">=</span> <span class="token class-name">Wed</span> <span class="token class-name">Aug</span> <span class="token number">29</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">03</span><span class="token operator">:</span><span class="token number">23</span> <span class="token constant">CST</span> <span class="token number">2018</span>
pZxid <span class="token operator">=</span> <span class="token number">0x100000004</span>
cversion <span class="token operator">=</span> <span class="token number">1</span>
dataVersion <span class="token operator">=</span> <span class="token number">0</span>
aclVersion <span class="token operator">=</span> <span class="token number">0</span>
ephemeralOwner <span class="token operator">=</span> <span class="token number">0x0</span>
dataLength <span class="token operator">=</span> <span class="token number">7</span>
numChildren <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">7</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">7</span><span class="token punctuation">]</span> get <span class="token operator">-</span>s <span class="token operator">/</span>sanguo<span class="token operator">/</span>shuguo
liubei
cZxid <span class="token operator">=</span> <span class="token number">0x100000004</span>
ctime <span class="token operator">=</span> <span class="token class-name">Wed</span> <span class="token class-name">Aug</span> <span class="token number">29</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">04</span><span class="token operator">:</span><span class="token number">35</span> <span class="token constant">CST</span> <span class="token number">2018</span>
mZxid <span class="token operator">=</span> <span class="token number">0x100000004</span>
mtime <span class="token operator">=</span> <span class="token class-name">Wed</span> <span class="token class-name">Aug</span> <span class="token number">29</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">04</span><span class="token operator">:</span><span class="token number">35</span> <span class="token constant">CST</span> <span class="token number">2018</span>
pZxid <span class="token operator">=</span> <span class="token number">0x100000004</span>
cversion <span class="token operator">=</span> <span class="token number">0</span>
dataVersion <span class="token operator">=</span> <span class="token number">0</span>
aclVersion <span class="token operator">=</span> <span class="token number">0</span>
ephemeralOwner <span class="token operator">=</span> <span class="token number">0x0</span>
dataLength <span class="token operator">=</span> <span class="token number">6</span>
numChildren <span class="token operator">=</span> <span class="token number">0</span>
</code></pre> 
<p>7）创建临时节点</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">7</span><span class="token punctuation">]</span> create <span class="token operator">-</span>e <span class="token operator">/</span>sanguo<span class="token operator">/</span>wuguo <span class="token string">"zhouyu"</span>
<span class="token class-name">Created</span> <span class="token operator">/</span>sanguo<span class="token operator">/</span>wuguo
</code></pre> 
<p>（1）在当前客户端是能查看到的</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">3</span><span class="token punctuation">]</span> ls <span class="token operator">/</span>sanguo 
<span class="token punctuation">[</span>wuguo<span class="token punctuation">,</span> shuguo<span class="token punctuation">]</span>
</code></pre> 
<p>（2）退出当前客户端然后再重启客户端</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">12</span><span class="token punctuation">]</span> quit
<span class="token punctuation">[</span>atbigdata<span class="token annotation punctuation">@hadoop104</span> zookeeper<span class="token operator">-</span><span class="token number">3.5</span><span class="token number">.7</span><span class="token punctuation">]</span>$ bin<span class="token operator">/</span>zkCli<span class="token punctuation">.</span>sh
</code></pre> 
<p>（3）再次查看根目录下短暂节点已经删除</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">0</span><span class="token punctuation">]</span> ls <span class="token operator">/</span>sanguo
<span class="token punctuation">[</span>shuguo<span class="token punctuation">]</span>
</code></pre> 
<h3><a id="8_328"></a>8）创建带序号的节点</h3> 
<pre><code>（1）先创建一个普通的根节点/sanguo/weiguo
</code></pre> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">]</span> create <span class="token operator">/</span>sanguo<span class="token operator">/</span>weiguo <span class="token string">"caocao"</span>
<span class="token class-name">Created</span> <span class="token operator">/</span>sanguo<span class="token operator">/</span>weiguo
</code></pre> 
<pre><code>（2）创建带序号的节点
</code></pre> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">2</span><span class="token punctuation">]</span> create <span class="token operator">/</span>sanguo<span class="token operator">/</span>weiguo <span class="token string">"caocao"</span>
<span class="token class-name">Node</span> already exists<span class="token operator">:</span> <span class="token operator">/</span>sanguo<span class="token operator">/</span>weiguo
<span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">3</span><span class="token punctuation">]</span> create <span class="token operator">-</span>s <span class="token operator">/</span>sanguo<span class="token operator">/</span>weiguo <span class="token string">"caocao"</span>
<span class="token class-name">Created</span> <span class="token operator">/</span>sanguo<span class="token operator">/</span>weiguo0000000000
<span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">4</span><span class="token punctuation">]</span> create <span class="token operator">-</span>s <span class="token operator">/</span>sanguo<span class="token operator">/</span>weiguo <span class="token string">"caocao"</span>
<span class="token class-name">Created</span> <span class="token operator">/</span>sanguo<span class="token operator">/</span>weiguo0000000001
<span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">5</span><span class="token punctuation">]</span> create <span class="token operator">-</span>s <span class="token operator">/</span>sanguo<span class="token operator">/</span>weiguo <span class="token string">"caocao"</span>
<span class="token class-name">Created</span> <span class="token operator">/</span>sanguo<span class="token operator">/</span>weiguo0000000002
<span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">6</span><span class="token punctuation">]</span> ls <span class="token operator">/</span>sanguo
<span class="token punctuation">[</span>shuguo<span class="token punctuation">,</span> weiguo<span class="token punctuation">,</span> weiguo0000000000<span class="token punctuation">,</span> weiguo0000000001<span class="token punctuation">,</span> weiguo0000000002<span class="token punctuation">,</span> wuguo<span class="token punctuation">]</span>
<span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">6</span><span class="token punctuation">]</span>
</code></pre> 
<p>如果节点下原来没有子节点，序号从0开始依次递增。如果原节点下已有2个节点，则再排序时从2开始，以此类推。<br> 9）修改节点数据值</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">6</span><span class="token punctuation">]</span> set <span class="token operator">/</span>sanguo<span class="token operator">/</span>weiguo <span class="token string">"caopi"</span>
</code></pre> 
<p>10）节点的值变化监听<br> （1）在hadoop104主机上注册监听/sanguo节点数据变化</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">26</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">8</span><span class="token punctuation">]</span> get <span class="token operator">-</span>w <span class="token operator">/</span>sanguo
</code></pre> 
<pre><code>（2）在hadoop103主机上修改/sanguo节点的数据
</code></pre> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">]</span> set <span class="token operator">/</span>sanguo <span class="token string">"xishi"</span>
</code></pre> 
<pre><code>（3）观察hadoop104主机收到数据变化的监听
</code></pre> 
<pre><code class="prism language-java"><span class="token constant">WATCHER</span><span class="token operator">::</span>
<span class="token class-name">WatchedEvent</span> state<span class="token operator">:</span><span class="token class-name">SyncConnected</span> type<span class="token operator">:</span><span class="token class-name">NodeDataChanged</span> path<span class="token operator">:</span><span class="token operator">/</span>sanguo
</code></pre> 
<p>11）节点的子节点变化监听（路径变化）<br> （1）在hadoop104主机上注册监听/sanguo节点的子节点变化</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">]</span> ls <span class="token operator">-</span>w <span class="token operator">/</span>sanguo
<span class="token punctuation">[</span>aa0000000001<span class="token punctuation">,</span> server101<span class="token punctuation">]</span>
</code></pre> 
<pre><code>（2）在hadoop103主机/sanguo节点上创建子节点
</code></pre> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">2</span><span class="token punctuation">]</span> create <span class="token operator">/</span>sanguo<span class="token operator">/</span>jin <span class="token string">"simayi"</span>
<span class="token class-name">Created</span> <span class="token operator">/</span>sanguo<span class="token operator">/</span>jin
</code></pre> 
<pre><code>（3）观察hadoop104主机收到子节点变化的监听
</code></pre> 
<pre><code class="prism language-java"><span class="token constant">WATCHER</span><span class="token operator">::</span>
<span class="token class-name">WatchedEvent</span> state<span class="token operator">:</span><span class="token class-name">SyncConnected</span> type<span class="token operator">:</span><span class="token class-name">NodeChildrenChanged</span> path<span class="token operator">:</span><span class="token operator">/</span>sanguo
</code></pre> 
<p>12）删除节点</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">4</span><span class="token punctuation">]</span> delete <span class="token operator">/</span>sanguo<span class="token operator">/</span>jin
</code></pre> 
<p>13）递归删除节点</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">15</span><span class="token punctuation">]</span> deleteall <span class="token operator">/</span>sanguo<span class="token operator">/</span>shuguo
</code></pre> 
<p>14）查看节点状态</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>zk<span class="token operator">:</span> localhost<span class="token operator">:</span><span class="token function">2181</span><span class="token punctuation">(</span><span class="token constant">CONNECTED</span><span class="token punctuation">)</span> <span class="token number">17</span><span class="token punctuation">]</span> stat <span class="token operator">/</span>sanguo
cZxid <span class="token operator">=</span> <span class="token number">0x100000003</span>
ctime <span class="token operator">=</span> <span class="token class-name">Wed</span> <span class="token class-name">Aug</span> <span class="token number">29</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">03</span><span class="token operator">:</span><span class="token number">23</span> <span class="token constant">CST</span> <span class="token number">2018</span>
mZxid <span class="token operator">=</span> <span class="token number">0x100000011</span>
mtime <span class="token operator">=</span> <span class="token class-name">Wed</span> <span class="token class-name">Aug</span> <span class="token number">29</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">21</span><span class="token operator">:</span><span class="token number">23</span> <span class="token constant">CST</span> <span class="token number">2018</span>
pZxid <span class="token operator">=</span> <span class="token number">0x100000014</span>
cversion <span class="token operator">=</span> <span class="token number">9</span>
dataVersion <span class="token operator">=</span> <span class="token number">1</span>
aclVersion <span class="token operator">=</span> <span class="token number">0</span>
ephemeralOwner <span class="token operator">=</span> <span class="token number">0x0</span>
dataLength <span class="token operator">=</span> <span class="token number">4</span>
numChildren <span class="token operator">=</span> <span class="token number">1</span>
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3ea14953b02b05b76d7e69834ef0e913/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">指定不同版本的pcl</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/989b7af1d803d917326e03e456fbb467/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">最简单的python爬取网页小说</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>