<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【React 】react 中的路由鉴权与路由拦截 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【React 】react 中的路由鉴权与路由拦截" />
<meta property="og:description" content="react 中的路由鉴权与路由拦截 1 路由拦截2 路由鉴权3 路由拦截和路由鉴权结合使用 在 React 中， 路由拦截和 路由鉴权是两个相关但不完全相同的概念。 1 路由拦截 路由拦截（Route Interception）**是指在用户导航到某个路由之前，通过某种逻辑来拦截、检查或修改导航行为。**它可以用于实现权限控制、身份验证、页面加载前的准备工作等场景。在路由拦截中，你可以决定是否允许用户继续访问目标路由或进行其他操作。
实现路由拦截可以借助 React 路由库中提供的特性。下面以 React Router 作为示例，介绍如何实现路由拦截：
首先，确保你的 React 应用中已经安装并导入了 React Router 库。在你的应用中定义路由配置，包括需要拦截的路由以及对应的组件。例如： import { BrowserRouter as Router, Route, Redirect } from &#39;react-router-dom&#39;; function App() { return ( &lt;Router&gt; &lt;Route path=&#34;/private&#34; component={PrivateComponent} /&gt; &lt;Route path=&#34;/public&#34; component={PublicComponent} /&gt; &lt;/Router&gt; ); } 在需要进行拦截的组件中，使用 Route 组件的 render 属性来定义拦截逻辑。例如，实现需要登录才能访问的私有页面 import { Route, Redirect } from &#39;react-router-dom&#39;; // 私有页面（登录才能访问） function PrivateComponent() {、 // 检查用户是否已经登录 const isAuthenticated = checkUserAuthentication(); // 未登录则重定向到登录页面 if (!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/024764057e7de9cc7d6ac3d02db1d1f3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-23T17:39:28+08:00" />
<meta property="article:modified_time" content="2023-08-23T17:39:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【React 】react 中的路由鉴权与路由拦截</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>react 中的路由鉴权与路由拦截</h4> 
 <ul><li><ul><li><ul><li><a href="#1__3" rel="nofollow">1 路由拦截</a></li><li><a href="#2__81" rel="nofollow">2 路由鉴权</a></li><li><a href="#3__159" rel="nofollow">3 路由拦截和路由鉴权结合使用</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<br> 在 React 中， 
<strong>路由拦截</strong>和 
<strong>路由鉴权</strong>是两个相关但不完全相同的概念。 
<p></p> 
<h4><a id="1__3"></a>1 路由拦截</h4> 
<p>路由拦截（Route Interception）**是指在用户导航到某个路由之前，通过某种逻辑来拦截、检查或修改导航行为。**它可以用于实现权限控制、身份验证、页面加载前的准备工作等场景。在路由拦截中，你可以决定是否允许用户继续访问目标路由或进行其他操作。</p> 
<p>实现路由拦截可以借助 React 路由库中提供的特性。下面以 React Router 作为示例，介绍如何实现路由拦截：</p> 
<ol><li>首先，确保你的 React 应用中已经安装并导入了 React Router 库。</li><li>在你的应用中定义路由配置，包括需要拦截的路由以及对应的组件。例如：</li></ol> 
<pre><code class="prism language-jsx">import { BrowserRouter as Router, Route, Redirect } from 'react-router-dom';

function App() {
  return (
    &lt;Router&gt;
      &lt;Route path="/private" component={PrivateComponent} /&gt;
      &lt;Route path="/public" component={PublicComponent} /&gt;
    &lt;/Router&gt;
  );
}
</code></pre> 
<ol start="3"><li>在需要进行拦截的组件中，使用 <code>Route</code> 组件的 <code>render</code> 属性来定义拦截逻辑。例如，实现需要登录才能访问的私有页面</li></ol> 
<pre><code class="prism language-jsx">import { Route, Redirect } from 'react-router-dom';

// 私有页面（登录才能访问）
function PrivateComponent() {、
  // 检查用户是否已经登录
  const isAuthenticated = checkUserAuthentication(); 

  // 未登录则重定向到登录页面                           
  if (!isAuthenticated) {
    return &lt;Redirect to="/login" /&gt;; 
  }
                             
  // 已登录则显示私有组件
  return &lt;h1&gt;Private Component&lt;/h1&gt;; 
}

</code></pre> 
<p>在上述示例中，通过 <code>checkUserAuthentication</code> 函数检查用户是否已经登录，若未登录则使用 <code>Redirect</code> 组件将用户重定向到登录页面。</p> 
<ol start="4"><li>在根组件中，使用 <code>Route</code> 组件来定义全局的路由拦截逻辑。例如，实现需要身份验证才能访问的所有页面：</li></ol> 
<pre><code class="prism language-jsx">import { BrowserRouter as Router, Route, Redirect } from 'react-router-dom';

function App() {
  const isAuthenticated = checkUserAuthentication(); // 检查用户是否已经登录

  return (
    &lt;Router&gt;
      &lt;Route
        path="/"
        render={() =&gt;
          isAuthenticated ? (
            &lt;Redirect to="/private" /&gt; // 已登录则重定向到私有页面
          ) : (
            &lt;Redirect to="/public" /&gt; // 未登录则重定向到公共页面
          )
        }
      /&gt;
      &lt;Route path="/private" component={PrivateComponent} /&gt;
      &lt;Route path="/public" component={PublicComponent} /&gt;
    &lt;/Router&gt;
  );
}
</code></pre> 
<p>在上述示例中，根据 <code>isAuthenticated</code> 的值，通过 <code>render</code> 属性动态决定用户访问根路由时的跳转目标。</p> 
<p>通过以上步骤，你可以实现基本的路由拦截功能。根据具体需求，你可以根据拦截逻辑进行更复杂的处理，比如从后端获取权限信息、展示不同的错误提示等。请根据你使用的具体路由库的文档和 API 进一步了解和实现路由拦截的细节。</p> 
<h4><a id="2__81"></a>2 路由鉴权</h4> 
<p>路由鉴权（Route Authorization）则**是一种在用户访问某个路由之前验证用户权限或角色的过程。**它用于限制用户访问特定页面或功能。在路由鉴权中，你会通过判断用户的权限或角色来决定是否允许用户访问目标路由。如果用户权限不满足要求，你可以重定向到其他页面或展示相应的提示信息。</p> 
<p>以下是一个示例，展示如何在 React 应用中实现基本的路由鉴权：</p> 
<ol><li>首先，确保你的 React 应用中已经安装并导入了 React Router 库。</li><li>在你的应用中定义路由配置，并为需要进行鉴权的路由添加所需的角色或权限信息。例如：</li></ol> 
<pre><code class="prism language-jsx">import { BrowserRouter as Router, Route, Redirect } from 'react-router-dom';

const routes = [
  {
    path: '/public',
    component: PublicComponent,
    allowedRoles: ['guest', 'user'], // 允许的角色
  },
  {
    path: '/private',
    component: PrivateComponent,
    allowedRoles: ['user', 'admin'], // 允许的角色
  },
];

function App() {
  return (
    &lt;Router&gt;
      {routes.map((route, index) =&gt; (
        &lt;Route
          key={index}
          path={route.path}
          render={(props) =&gt; (
            &lt;AuthorizedRoute
              component={route.component}
              allowedRoles={route.allowedRoles}
              {...props}
            /&gt;
          )}
        /&gt;
      ))}
    &lt;/Router&gt;
  );
}
</code></pre> 
<ol start="3"><li>创建一个自定义的 <code>AuthorizedRoute</code> 组件，用于检查用户的角色是否满足该路由所需的角色。例如：</li></ol> 
<pre><code class="prism language-jsx">import { Route, Redirect } from 'react-router-dom';

function AuthorizedRoute({ component: Component, allowedRoles, ...rest }) {
  const userRoles = getUserRoles(); // 获取当前用户的角色信息

  if (!userRoles || !allowedRoles.includes(userRoles)) {
    return &lt;Redirect to="/unauthorized" /&gt;; // 角色不匹配，则重定向到未授权页面
  }

  return &lt;Route {...rest} render={(props) =&gt; &lt;Component {...props} /&gt;} /&gt;;
}
</code></pre> 
<p>在上述示例中，使用 <code>getUserRoles</code> 函数获取当前用户的角色信息，并根据角色信息判断是否满足路由所需的角色。如果不满足，则使用 <code>Redirect</code> 组件将用户重定向到未授权页面；如果满足，则渲染对应的路由组件。</p> 
<ol start="4"><li>在你的应用中定义未授权页面（Unauthorized Page），用于展示用户未被授权访问的提示信息。</li></ol> 
<pre><code class="prism language-jsx">function UnauthorizedPage() {
  return &lt;h1&gt;Unauthorized Access&lt;/h1&gt;;
}
</code></pre> 
<p>在路由配置中添加未授权页面的路由，以便在角色不匹配时显示该页面。</p> 
<p>通过以上步骤，你可以实现基本的路由鉴权功能。根据具体需求，你可以扩展鉴权逻辑，比如从后端获取用户角色信息、动态控制路由的可访问性等。请根据你使用的具体路由库的文档和 API 进一步了解和实现路由鉴权的细节。</p> 
<h4><a id="3__159"></a>3 路由拦截和路由鉴权结合使用</h4> 
<p>在实际应用中，路由拦截和路由鉴权通常会结合使用，以实现更完整的访问控制和权限管理。</p> 
<p>以下是一个示例，展示如何在 React 中结合使用路由拦截和路由鉴权：</p> 
<ol><li>首先，确保你的 React 应用中已经安装并导入了 React Router 库。</li><li>定义路由配置和相关组件，包括需要拦截和鉴权的路由以及对应的组件。</li><li>创建一个高阶组件（Higher-Order Component，HOC），用于实现路由拦截和鉴权的逻辑。例如：</li></ol> 
<pre><code class="prism language-jsx">import { Route, Redirect } from 'react-router-dom';

function withAuthorization(Component, allowedRoles) {
  return function AuthorizedRoute(props) {
    const isAuthenticated = checkUserAuthentication(); // 检查用户是否已经登录
    const userRoles = getUserRoles(); // 获取当前用户的角色信息

    if (!isAuthenticated) {
      return &lt;Redirect to="/login" /&gt;; // 未登录则重定向到登录页面
    }

    if (!userRoles || !allowedRoles.includes(userRoles)) {
      return &lt;Redirect to="/unauthorized" /&gt;; // 角色不匹配，则重定向到未授权页面
    }

    return &lt;Component {...props} /&gt;;
  };
}
</code></pre> 
<p>在上述示例中，<code>withAuthorization</code> 是一个高阶组件，接受一个组件和允许的角色列表作为参数。它根据用户的登录状态和角色信息来判断是否允许用户访问目标路由，如果不允许，则进行相应的重定向。</p> 
<ol start="4"><li>在路由配置中使用高阶组件包装需要进行拦截和鉴权的路由组件。例如：</li></ol> 
<pre><code class="prism language-jsx">import { BrowserRouter as Router, Route } from 'react-router-dom';

function App() {
  return (
    &lt;Router&gt;
      &lt;Route
        path="/public"
        component={PublicComponent}
      /&gt;
      &lt;Route
        path="/private"
        component={withAuthorization(PrivateComponent, ['user', 'admin'])}
      /&gt;
      &lt;Route
        path="/unauthorized"
        component={UnauthorizedPage}
      /&gt;
    &lt;/Router&gt;
  );
}
</code></pre> 
<p>在上述示例中，<code>PrivateComponent</code> 组件通过 <code>withAuthorization</code> 高阶组件进行鉴权，只有角色为 ‘user’ 或 ‘admin’ 的用户才能访问该路由。如果用户角色不满足要求，则重定向到 <code>/unauthorized</code> 页面。</p> 
<p>通过以上步骤，你可以结合路由拦截和路由鉴权实现访问控制和权限管理的功能。根据具体需求，你可以根据实际情况对路由拦截和鉴权的逻辑进行进一步的扩展和优化。请根据你使用的具体路由库的文档和 API 进一步了解和实现路由拦击和路由鉴权的细节。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8ce230b6dcc85c458923783a18df98d6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">js改变div大小</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8c080366108636c4c04db86a76d0c538/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">组策略应用（二）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>