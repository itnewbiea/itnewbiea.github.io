<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>æ¯•ä¸šè®¾è®¡-åŸºäºæ·±åº¦å­¦ä¹ çš„è¡Œäººè½¦è¾†é—¯çº¢ç¯å®æ—¶æ£€æµ‹ç®—æ³•ç³»ç»Ÿ YOLO python å·ç§¯ç¥ç»ç½‘ç»œ äººå·¥æ™ºèƒ½ - ITå­¦ä¹ è€…åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="æ¯•ä¸šè®¾è®¡-åŸºäºæ·±åº¦å­¦ä¹ çš„è¡Œäººè½¦è¾†é—¯çº¢ç¯å®æ—¶æ£€æµ‹ç®—æ³•ç³»ç»Ÿ YOLO python å·ç§¯ç¥ç»ç½‘ç»œ äººå·¥æ™ºèƒ½" />
<meta property="og:description" content="ç›®å½•
å‰è¨€
è®¾è®¡æ€è·¯
ä¸€ã€è¯¾é¢˜èƒŒæ™¯ä¸æ„ä¹‰
äºŒã€ç®—æ³•ç†è®ºåŸç†
2.1 YOLOv5ç®—æ³•
2.2 DeepSortç®—æ³•
ä¸‰ã€é—¯çº¢ç¯æ£€æµ‹çš„å®ç°
3.1 æ•°æ®é›†
3.2 å®éªŒç¯å¢ƒæ­å»º
3.2 å®éªŒåŠç»“æœåˆ†æ
å®ç°æ•ˆæœå›¾æ ·ä¾‹
æœ€å
å‰è¨€ ğŸ“…å¤§å››æ˜¯æ•´ä¸ªå¤§å­¦æœŸé—´æœ€å¿™ç¢Œçš„æ—¶å…‰,ä¸€è¾¹è¦å¿™ç€å¤‡è€ƒæˆ–å®ä¹ ä¸ºæ¯•ä¸šåé¢ä¸´çš„å°±ä¸šå‡å­¦åšå‡†å¤‡,ä¸€è¾¹è¦ä¸ºæ¯•ä¸šè®¾è®¡è€—è´¹å¤§é‡ç²¾åŠ›ã€‚è¿‘å‡ å¹´å„ä¸ªå­¦æ ¡è¦æ±‚çš„æ¯•è®¾é¡¹ç›®è¶Šæ¥è¶Šéš¾,æœ‰ä¸å°‘è¯¾é¢˜æ˜¯ç ”ç©¶ç”Ÿçº§åˆ«éš¾åº¦çš„,å¯¹æœ¬ç§‘åŒå­¦æ¥è¯´æ˜¯å……æ»¡æŒ‘æˆ˜ã€‚ä¸ºå¸®åŠ©å¤§å®¶é¡ºåˆ©é€šè¿‡å’ŒèŠ‚çœæ—¶é—´ä¸ç²¾åŠ›æŠ•å…¥åˆ°æ›´é‡è¦çš„å°±ä¸šå’Œè€ƒè¯•ä¸­å»,å­¦é•¿åˆ†äº«ä¼˜è´¨çš„é€‰é¢˜ç»éªŒå’Œæ¯•è®¾é¡¹ç›®ä¸æŠ€æœ¯æ€è·¯ã€‚
ğŸš€å¯¹æ¯•è®¾æœ‰ä»»ä½•ç–‘é—®éƒ½å¯ä»¥é—®å­¦é•¿å“¦!
é€‰é¢˜æŒ‡å¯¼:
æœ€æ–°æœ€å…¨è®¡ç®—æœºä¸“ä¸šæ¯•è®¾é€‰é¢˜ç²¾é€‰æ¨èæ±‡æ€»
è®¾è®¡æ€è·¯ ä¸€ã€è¯¾é¢˜èƒŒæ™¯ä¸æ„ä¹‰ ä»¥å›¾åƒæˆ–è§†é¢‘ä¸ºç ”ç©¶å¯¹è±¡ï¼Œé€šè¿‡å›¾åƒå¤„ç†æŠ€æœ¯è¯†åˆ«å‡ºé“è·¯æƒ…å†µï¼Œä¸ä»…è¦æ£€æµ‹å‡ºæ±½è½¦ã€è¡Œäººç­‰ç›®æ ‡ï¼Œè¿˜è¦åˆ¤æ–­å‡ºäº¤é€šä¿¡å·ã€‚è€Œæ ¹æ®è¿™é¡¹æŠ€æœ¯ï¼Œé€šè¿‡æé†’è¡Œäººå’Œè½¦è¾†ä¸è¦è¿åäº¤é€šè§„åˆ™å¯ä»¥è§£å†³äº¤é€šå®‰å…¨å…¨ä¸–ç•Œæ­»äº¡ç‡æ’åå‰åˆ—çš„é—®é¢˜ã€‚
äºŒã€ç®—æ³•ç†è®ºåŸç† 2.1 YOLOv5ç®—æ³• YOLOç®—æ³•ç”¨å›å½’æ–¹æ³•å¯¹ç›®æ ‡è¿›è¡Œæ£€æµ‹ï¼Œæœ‰ç€å¿«é€Ÿæ£€æµ‹çš„èƒ½åŠ›ã€‚YOLOv5åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«ä¸ºinputç«¯ï¼Œbackboneç«¯ï¼Œneckç«¯ï¼Œpredictionç«¯å››ä¸ªéƒ¨åˆ†ã€‚
YOLOv5åœ¨ç›®æ ‡æ£€æµ‹æ–¹é¢æœ‰ç€ä¼˜ç§€çš„æ€§èƒ½ï¼Œå…¶ä¸»è¦åŸå› å¦‚ä¸‹ï¼š
(1) Inputç«¯åŒ…æ‹¬Mosaicæ•°æ®å¢å¼ºï¼Œæ–°å¢äº†å›¾ç‰‡å°ºå¯¸å¤„ç†ã€è‡ªé€‚åº”é”šæ¡†è®¡ç®—ä¸‰éƒ¨åˆ†ï¼Œå¢å¼ºå°ç›®æ ‡æ£€æµ‹æ€§èƒ½ï¼ŒåŠ å¿«å›¾ç‰‡å¤„ç†é€Ÿç‡ã€‚
(2) Backboneæ–°å¢äº†Focusç»“æ„å¹¶ä¸”æ”¹è¿›äº†CSPç»“æ„ï¼ŒFocusç»“æ„å‡å°‘äº†å†—ä½™ä¿¡ã€‚CSP1ç”¨äºç‰¹å¾æå–éƒ¨åˆ†ï¼ŒCSP2ç”¨äºç‰¹å¾èåˆéƒ¨åˆ†ã€‚
(3) NeckåŒ…æ‹¬FPN&#43;PANçš„ç»“æ„ï¼ŒåŠ å¼ºç½‘ç»œç‰¹å¾èåˆçš„èƒ½åŠ›ã€‚
(4) Outputç«¯åŒ…æ‹¬GIOU_Lossä½œä¸ºæŸå¤±å‡½æ•°ï¼Œæ–°å¢äº†GIOU_NMSéæå¤§å€¼æŠ‘åˆ¶ã€‚æœ€å°åŒ–é¢„æµ‹æ¡†å’Œç›®æ ‡æ¡†ä¹‹é—´çš„å½’ä¸€åŒ–è·ç¦»ï¼Œå¢å¼ºäº†é®æŒ¡é‡å çš„ç›®æ ‡çš„è¯†åˆ«ç‡ã€‚
2.2 DeepSortç®—æ³• DeepSortæ˜¯ç”±sortå‡çº§è€Œæ¥ã€‚å½“ç‰©ä½“å‘ç”Ÿé®æŒ¡çš„æ—¶å€™ï¼Œä½¿ç”¨sortç®—æ³•å®¹æ˜“ä¸¢å¤±è‡ªå·±çš„IDï¼Œè€Œæ–°å¢çš„Deep Association MetricæŠŠè½¨è¿¹åˆ†ä¸ºç¡®è®¤æ€å’Œä¸ç¡®è®¤æ€ï¼Œæ–°äº§ç”Ÿçš„è½¨è¿¹æ˜¯ä¸ç¡®è®¤æ€çš„ï¼Œä¸ç¡®è®¤æ€çš„è½¨è¿¹å¿…é¡»è¦å’Œç›®æ ‡è¿ç»­åŒ¹é…å¤šæ¬¡ï¼ˆé»˜è®¤3æ¬¡ï¼‰æ‰å¯ä»¥è½¬åŒ–æˆç¡®è®¤æ€ã€‚ç¡®è®¤æ€çš„è½¨è¿¹å¿…é¡»å’Œç›®æ ‡è¿ç»­ä¸åŒ¹é…å¤šæ¬¡ï¼ˆé»˜è®¤30æ¬¡ï¼‰ï¼Œæ‰å¯å‰”é™¤IDã€‚
ç›¸å…³ä»£ç ç¤ºä¾‹ï¼š
import torch import torch.nn as nn class YOLO(nn.Module): def __init__(self, num_classes, num_anchors): super(YOLO, self).__init__() self.num_classes = num_classes self.num_anchors = num_anchors # Define your network architecture here self." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/37ab078f1ba96a738617f30481663a0f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-06T21:44:59+08:00" />
<meta property="article:modified_time" content="2023-12-06T21:44:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ITå­¦ä¹ è€…åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ITå­¦ä¹ è€…åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">æ¯•ä¸šè®¾è®¡-åŸºäºæ·±åº¦å­¦ä¹ çš„è¡Œäººè½¦è¾†é—¯çº¢ç¯å®æ—¶æ£€æµ‹ç®—æ³•ç³»ç»Ÿ YOLO python å·ç§¯ç¥ç»ç½‘ç»œ äººå·¥æ™ºèƒ½</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>ç›®å½•</strong></p> 
<p id="main-toc-toc" style="margin-left:0px;"><a href="#main-toc" rel="nofollow">å‰è¨€</a></p> 
<p id="%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF-toc" style="margin-left:0px;"><a href="#%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF" rel="nofollow">è®¾è®¡æ€è·¯</a></p> 
<p id="%E4%B8%80%E3%80%81%E8%AF%BE%E9%A2%98%E8%83%8C%E6%99%AF%E4%B8%8E%E6%84%8F%E4%B9%89-toc" style="margin-left:40px;"><a href="#%E4%B8%80%E3%80%81%E8%AF%BE%E9%A2%98%E8%83%8C%E6%99%AF%E4%B8%8E%E6%84%8F%E4%B9%89" rel="nofollow">ä¸€ã€è¯¾é¢˜èƒŒæ™¯ä¸æ„ä¹‰</a></p> 
<p id="%E4%BA%8C%E3%80%81%E7%AE%97%E6%B3%95%E7%90%86%E8%AE%BA%E5%8E%9F%E7%90%86-toc" style="margin-left:40px;"><a href="#%E4%BA%8C%E3%80%81%E7%AE%97%E6%B3%95%E7%90%86%E8%AE%BA%E5%8E%9F%E7%90%86" rel="nofollow">äºŒã€ç®—æ³•ç†è®ºåŸç†</a></p> 
<p id="2.1%20YOLOv5%E7%AE%97%E6%B3%95-toc" style="margin-left:80px;"><a href="#2.1%20YOLOv5%E7%AE%97%E6%B3%95" rel="nofollow">2.1 YOLOv5ç®—æ³•</a></p> 
<p id="2.1%20DeepSort%E7%AE%97%E6%B3%95-toc" style="margin-left:80px;"><a href="#2.1%20DeepSort%E7%AE%97%E6%B3%95" rel="nofollow">2.2 DeepSortç®—æ³•</a></p> 
<p id="%E4%B8%89%E3%80%81%E9%97%AF%E7%BA%A2%E7%81%AF%E6%A3%80%E6%B5%8B%E7%9A%84%E5%AE%9E%E7%8E%B0-toc" style="margin-left:40px;"><a href="#%E4%B8%89%E3%80%81%E9%97%AF%E7%BA%A2%E7%81%AF%E6%A3%80%E6%B5%8B%E7%9A%84%E5%AE%9E%E7%8E%B0" rel="nofollow">ä¸‰ã€é—¯çº¢ç¯æ£€æµ‹çš„å®ç°</a></p> 
<p id="3.1%20%E6%95%B0%E6%8D%AE%E9%9B%86-toc" style="margin-left:80px;"><a href="#3.1%20%E6%95%B0%E6%8D%AE%E9%9B%86" rel="nofollow">3.1 æ•°æ®é›†</a></p> 
<p id="3.2%20%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-toc" style="margin-left:80px;"><a href="#3.2%20%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA" rel="nofollow">3.2 å®éªŒç¯å¢ƒæ­å»º</a></p> 
<p id="3.2%20%E5%AE%9E%E9%AA%8C%E5%8F%8A%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90-toc" style="margin-left:80px;"><a href="#3.2%20%E5%AE%9E%E9%AA%8C%E5%8F%8A%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90" rel="nofollow">3.2 å®éªŒåŠç»“æœåˆ†æ</a></p> 
<p id="%E5%AE%9E%E7%8E%B0%E6%95%88%E6%9E%9C%E5%9B%BE%E6%A0%B7%E4%BE%8B-toc" style="margin-left:0px;"><a href="#%E5%AE%9E%E7%8E%B0%E6%95%88%E6%9E%9C%E5%9B%BE%E6%A0%B7%E4%BE%8B" rel="nofollow">å®ç°æ•ˆæœå›¾æ ·ä¾‹</a></p> 
<p id="%E6%9C%80%E5%90%8E-toc" style="margin-left:0px;"><a href="#%E6%9C%80%E5%90%8E" rel="nofollow">æœ€å</a></p> 
<hr id="hr-toc"> 
<h2 style="background-color:transparent;">å‰è¨€</h2> 
<p>Â  Â  Â  Â ğŸ“…å¤§å››æ˜¯æ•´ä¸ªå¤§å­¦æœŸé—´æœ€å¿™ç¢Œçš„æ—¶å…‰,ä¸€è¾¹è¦å¿™ç€å¤‡è€ƒæˆ–å®ä¹ ä¸ºæ¯•ä¸šåé¢ä¸´çš„å°±ä¸šå‡å­¦åšå‡†å¤‡,ä¸€è¾¹è¦ä¸ºæ¯•ä¸šè®¾è®¡è€—è´¹å¤§é‡ç²¾åŠ›ã€‚è¿‘å‡ å¹´å„ä¸ªå­¦æ ¡è¦æ±‚çš„æ¯•è®¾é¡¹ç›®è¶Šæ¥è¶Šéš¾,æœ‰ä¸å°‘è¯¾é¢˜æ˜¯ç ”ç©¶ç”Ÿçº§åˆ«éš¾åº¦çš„,å¯¹æœ¬ç§‘åŒå­¦æ¥è¯´æ˜¯å……æ»¡æŒ‘æˆ˜ã€‚ä¸ºå¸®åŠ©å¤§å®¶é¡ºåˆ©é€šè¿‡å’ŒèŠ‚çœæ—¶é—´ä¸ç²¾åŠ›æŠ•å…¥åˆ°æ›´é‡è¦çš„å°±ä¸šå’Œè€ƒè¯•ä¸­å»,å­¦é•¿åˆ†äº«ä¼˜è´¨çš„é€‰é¢˜ç»éªŒå’Œæ¯•è®¾é¡¹ç›®ä¸æŠ€æœ¯æ€è·¯ã€‚</p> 
<p>Â  Â  Â  Â Â <span style="color:#fe2c24;"><strong>ğŸš€å¯¹æ¯•è®¾æœ‰ä»»ä½•ç–‘é—®éƒ½å¯ä»¥é—®å­¦é•¿å“¦!</strong></span></p> 
<p>Â  Â  Â  Â  Â é€‰é¢˜æŒ‡å¯¼:</p> 
<p><a href="https://blog.csdn.net/qq_37340229/article/details/132467286" title="Â  Â  Â  Â  æœ€æ–°æœ€å…¨è®¡ç®—æœºä¸“ä¸šæ¯•è®¾é€‰é¢˜ç²¾é€‰æ¨èæ±‡æ€»">Â  Â  Â  Â  æœ€æ–°æœ€å…¨è®¡ç®—æœºä¸“ä¸šæ¯•è®¾é€‰é¢˜ç²¾é€‰æ¨èæ±‡æ€»</a></p> 
<p class="img-center"><img alt="æ¯•ä¸šè®¾è®¡-åŸºäºæ·±åº¦å­¦ä¹ çš„è¡Œäººè½¦è¾†é—¯çº¢ç¯å®æ—¶æ£€æµ‹ç®—æ³•ç³»ç»Ÿ YOLO python å·ç§¯ç¥ç»ç½‘ç»œ äººå·¥æ™ºèƒ½" height="297" src="https://images2.imgbox.com/3c/6e/P41gUUpC_o.png" width="455"></p> 
<h2 id="%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF">è®¾è®¡æ€è·¯</h2> 
<h3 id="%E4%B8%80%E3%80%81%E8%AF%BE%E9%A2%98%E8%83%8C%E6%99%AF%E4%B8%8E%E6%84%8F%E4%B9%89">ä¸€ã€è¯¾é¢˜èƒŒæ™¯ä¸æ„ä¹‰</h3> 
<p>Â  Â  Â  Â  ä»¥å›¾åƒæˆ–è§†é¢‘ä¸ºç ”ç©¶å¯¹è±¡ï¼Œé€šè¿‡å›¾åƒå¤„ç†æŠ€æœ¯è¯†åˆ«å‡ºé“è·¯æƒ…å†µï¼Œä¸ä»…è¦æ£€æµ‹å‡ºæ±½è½¦ã€è¡Œäººç­‰ç›®æ ‡ï¼Œè¿˜è¦åˆ¤æ–­å‡ºäº¤é€šä¿¡å·ã€‚è€Œæ ¹æ®è¿™é¡¹æŠ€æœ¯ï¼Œé€šè¿‡æé†’è¡Œäººå’Œè½¦è¾†ä¸è¦è¿åäº¤é€šè§„åˆ™å¯ä»¥è§£å†³äº¤é€šå®‰å…¨å…¨ä¸–ç•Œæ­»äº¡ç‡æ’åå‰åˆ—çš„é—®é¢˜ã€‚</p> 
<h3 id="%E4%BA%8C%E3%80%81%E7%AE%97%E6%B3%95%E7%90%86%E8%AE%BA%E5%8E%9F%E7%90%86">äºŒã€ç®—æ³•ç†è®ºåŸç†</h3> 
<h4 id="2.1%20YOLOv5%E7%AE%97%E6%B3%95">2.1 YOLOv5ç®—æ³•</h4> 
<p>Â  Â  Â  Â  YOLOç®—æ³•ç”¨å›å½’æ–¹æ³•å¯¹ç›®æ ‡è¿›è¡Œæ£€æµ‹ï¼Œæœ‰ç€å¿«é€Ÿæ£€æµ‹çš„èƒ½åŠ›ã€‚YOLOv5åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«ä¸ºinputç«¯ï¼Œbackboneç«¯ï¼Œneckç«¯ï¼Œpredictionç«¯å››ä¸ªéƒ¨åˆ†ã€‚</p> 
<p>Â  Â  Â  Â  YOLOv5åœ¨ç›®æ ‡æ£€æµ‹æ–¹é¢æœ‰ç€ä¼˜ç§€çš„æ€§èƒ½ï¼Œå…¶ä¸»è¦åŸå› å¦‚ä¸‹ï¼š<br> (1) Inputç«¯åŒ…æ‹¬Mosaicæ•°æ®å¢å¼ºï¼Œæ–°å¢äº†å›¾ç‰‡å°ºå¯¸å¤„ç†ã€è‡ªé€‚åº”é”šæ¡†è®¡ç®—ä¸‰éƒ¨åˆ†ï¼Œå¢å¼ºå°ç›®æ ‡æ£€æµ‹æ€§èƒ½ï¼ŒåŠ å¿«å›¾ç‰‡å¤„ç†é€Ÿç‡ã€‚<br> (2) Backboneæ–°å¢äº†Focusç»“æ„å¹¶ä¸”æ”¹è¿›äº†CSPç»“æ„ï¼ŒFocusç»“æ„å‡å°‘äº†å†—ä½™ä¿¡ã€‚CSP1ç”¨äºç‰¹å¾æå–éƒ¨åˆ†ï¼ŒCSP2ç”¨äºç‰¹å¾èåˆéƒ¨åˆ†ã€‚</p> 
<p class="img-center"><img alt="æ¯•ä¸šè®¾è®¡-åŸºäºæ·±åº¦å­¦ä¹ çš„è¡Œäººè½¦è¾†é—¯çº¢ç¯å®æ—¶æ£€æµ‹ç®—æ³•ç³»ç»Ÿ YOLO python å·ç§¯ç¥ç»ç½‘ç»œ äººå·¥æ™ºèƒ½" height="157" src="https://images2.imgbox.com/9f/96/XIoZ7JGI_o.png" width="476"></p> 
<p>(3) NeckåŒ…æ‹¬FPN+PANçš„ç»“æ„ï¼ŒåŠ å¼ºç½‘ç»œç‰¹å¾èåˆçš„èƒ½åŠ›ã€‚<br> (4) Outputç«¯åŒ…æ‹¬GIOU_Lossä½œä¸ºæŸå¤±å‡½æ•°ï¼Œæ–°å¢äº†GIOU_NMSéæå¤§å€¼æŠ‘åˆ¶ã€‚æœ€å°åŒ–é¢„æµ‹æ¡†å’Œç›®æ ‡æ¡†ä¹‹é—´çš„å½’ä¸€åŒ–è·ç¦»ï¼Œå¢å¼ºäº†é®æŒ¡é‡å çš„ç›®æ ‡çš„è¯†åˆ«ç‡ã€‚</p> 
<p class="img-center"><img alt="æ¯•ä¸šè®¾è®¡-åŸºäºæ·±åº¦å­¦ä¹ çš„è¡Œäººè½¦è¾†é—¯çº¢ç¯å®æ—¶æ£€æµ‹ç®—æ³•ç³»ç»Ÿ YOLO python å·ç§¯ç¥ç»ç½‘ç»œ äººå·¥æ™ºèƒ½" height="117" src="https://images2.imgbox.com/0a/e1/0NEw0uHm_o.png" width="498"></p> 
<h4 id="2.1%20DeepSort%E7%AE%97%E6%B3%95">2.2 DeepSortç®—æ³•</h4> 
<p>Â  Â  Â  Â  DeepSortæ˜¯ç”±sortå‡çº§è€Œæ¥ã€‚å½“ç‰©ä½“å‘ç”Ÿé®æŒ¡çš„æ—¶å€™ï¼Œä½¿ç”¨sortç®—æ³•å®¹æ˜“ä¸¢å¤±è‡ªå·±çš„IDï¼Œè€Œæ–°å¢çš„Deep Association MetricæŠŠè½¨è¿¹åˆ†ä¸ºç¡®è®¤æ€å’Œä¸ç¡®è®¤æ€ï¼Œæ–°äº§ç”Ÿçš„è½¨è¿¹æ˜¯ä¸ç¡®è®¤æ€çš„ï¼Œä¸ç¡®è®¤æ€çš„è½¨è¿¹å¿…é¡»è¦å’Œç›®æ ‡è¿ç»­åŒ¹é…å¤šæ¬¡ï¼ˆé»˜è®¤3æ¬¡ï¼‰æ‰å¯ä»¥è½¬åŒ–æˆç¡®è®¤æ€ã€‚ç¡®è®¤æ€çš„è½¨è¿¹å¿…é¡»å’Œç›®æ ‡è¿ç»­ä¸åŒ¹é…å¤šæ¬¡ï¼ˆé»˜è®¤30æ¬¡ï¼‰ï¼Œæ‰å¯å‰”é™¤IDã€‚</p> 
<p class="img-center"><img alt="æ¯•ä¸šè®¾è®¡-åŸºäºæ·±åº¦å­¦ä¹ çš„è¡Œäººè½¦è¾†é—¯çº¢ç¯å®æ—¶æ£€æµ‹ç®—æ³•ç³»ç»Ÿ YOLO python å·ç§¯ç¥ç»ç½‘ç»œ äººå·¥æ™ºèƒ½" height="187" src="https://images2.imgbox.com/0c/e0/JUzv4tNX_o.png" width="421"></p> 
<p>ç›¸å…³ä»£ç ç¤ºä¾‹ï¼š</p> 
<pre><code>import torch
import torch.nn as nn

class YOLO(nn.Module):
    def __init__(self, num_classes, num_anchors):
        super(YOLO, self).__init__()
        self.num_classes = num_classes
        self.num_anchors = num_anchors
        
        # Define your network architecture here
        
        self.conv = nn.Conv2d(in_channels, out_channels, kernel_size, stride, padding)
        self.fc = nn.Linear(in_features, out_features)
        self.sigmoid = nn.Sigmoid()
        
    def forward(self, x):
        # Forward pass through your network
        
        out = self.conv(x)
        out = self.fc(out)
        out = self.sigmoid(out)
        
        return out

    def detect_objects(self, output, confidence_threshold):
        # Perform post-processing to obtain object detections
        
        batch_size, _, grid_h, grid_w = output.size()
        num_attrib = self.num_classes + 5  # 5 = 4 (bbox offsets) + 1 (object confidence)
        num_anchors = self.num_anchors
        
        # Reshape the output to be compatible with bounding box calculations
        output = output.view(batch_size, num_attrib * num_anchors, grid_h * grid_w)
        output = output.transpose(1, 2).contiguous()
        output = output.view(batch_size, grid_h * grid_w * num_anchors, num_attrib)
        
        # Apply sigmoid activation to class scores and object confidence
        output[:, :, :2] = self.sigmoid(output[:, :, :2])
        
        # Get the class scores, object confidence, and bounding box parameters
        class_scores = output[:, :, 5:]  # Shape: (batch_size, grid_h * grid_w * num_anchors, num_classes)
        object_confidence = output[:, :, 4]  # Shape: (batch_size, grid_h * grid_w * num_anchors)
        bbox_offsets = output[:, :, :4]  # Shape: (batch_size, grid_h * grid_w * num_anchors, 4)</code></pre> 
<h3 id="%E4%B8%89%E3%80%81%E9%97%AF%E7%BA%A2%E7%81%AF%E6%A3%80%E6%B5%8B%E7%9A%84%E5%AE%9E%E7%8E%B0">ä¸‰ã€é—¯çº¢ç¯æ£€æµ‹çš„å®ç°</h3> 
<h4 id="3.1%20%E6%95%B0%E6%8D%AE%E9%9B%86">3.1 æ•°æ®é›†</h4> 
<p>Â  Â  Â  Â  å®éªŒç”¨å­¦é•¿è‡ªå·±åˆ¶ä½œçš„æ•°æ®é›†è®­ç»ƒçš„YOLOV5æ£€æµ‹è¡Œäººå’Œè½¦è¾†æ˜¯å¦é—¯çº¢ç¯çº¢ç»¿ç¯ï¼Œæ•°æ®é›†åŒ…æ‹¬ä¸åŒäº¤é€šåœºæ™¯ã€‚è¯†åˆ«è¡Œäººå’Œè½¦è¾†é—¯çº¢ç¯åˆ†ä¸ºå››ä¸ªæ¨¡å—ï¼Œåˆ†åˆ«ä¸ºäººè¡Œæ¨ªé“çš„æ£€æµ‹ï¼›è¡Œäººï¼Œè½¦è¾†å’Œçº¢ç»¿ç¯çš„æ£€æµ‹ï¼›çº¢ç»¿ç¯è¯†åˆ«ï¼›é—¯çº¢ç¯è¯†åˆ«ã€‚</p> 
<p class="img-center"><img alt="æ¯•ä¸šè®¾è®¡-åŸºäºæ·±åº¦å­¦ä¹ çš„è¡Œäººè½¦è¾†é—¯çº¢ç¯å®æ—¶æ£€æµ‹ç®—æ³•ç³»ç»Ÿ YOLO python å·ç§¯ç¥ç»ç½‘ç»œ äººå·¥æ™ºèƒ½" height="292" src="https://images2.imgbox.com/ea/dd/9OS7ejMA_o.png" width="460"></p> 
<p>Â  Â  Â  Â  äººè¡Œæ¨ªé“æ£€æµ‹ï¼šæ–‘é©¬çº¿æœ‰å››ä¸ªç‰¹å¾ï¼Œåˆ†åˆ«æ˜¯æ¢¯åº¦ä¸€è‡´ï¼Œç­‰é—´éš”ï¼Œå¤šæ ¹çº¿ï¼Œæ¯”è½¦é“çº¿å®½ã€‚æ¢¯åº¦ä¸€è‡´æ€§å’Œç­‰é—´éš”æ˜¯ä¸¤ä¸ªå¼ºåˆ†ç±»ç‰¹å¾ï¼Œå…¶ä¸­æ¢¯åº¦ä¸€è‡´æ€§ç‰¹å¾æ˜“å¬å›ï¼Œç­‰é—´éš”ç‰¹å¾å¼ºç²¾åº¦ã€‚</p> 
<pre><code>blob = cv2.dnn.blobFromImage(image, 1.0, (300, 300), (104.0, 177.0, 123.0), False, False)

model.setInput(blob)
detections = model.forward()

for i in range(detections.shape[2]):
    confidence = detections[0, 0, i, 2]
    if confidence &gt; 0.5:  # é˜ˆå€¼å¯ä»¥æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´
        box = detections[0, 0, i, 3:7] * np.array([image.shape[1], image.shape[0], image.shape[1], image.shape[0]])
        (startX, startY, endX, endY) = box.astype(int)
        cv2.rectangle(image, (startX, startY), (endX, endY), (0, 255, 0), 2)</code></pre> 
<p>Â  Â  Â  Â  çº¢ç»¿ç¯è¯†åˆ«ï¼šç”¨å·ç§¯ç¥ç»ç½‘ç»œCNNä¸ºè¾“å…¥çº¢ç»¿ç¯å›¾ç‰‡åˆ†ç±»ã€‚CNNé€šè¿‡é‡‡ç”¨æ¢¯åº¦ä¸‹é™æ³•æœ€å°åŒ–æŸå¤±å‡½æ•°å¯¹çº¢ç»¿ç¯å›¾ç‰‡ä¸­çš„æƒé‡å‚æ•°é€å±‚åå‘è°ƒèŠ‚ï¼Œé€šè¿‡é¢‘ç¹çš„è¿­ä»£è®­ç»ƒæé«˜è¯†åˆ«çº¢ç»¿ç¯çš„ç²¾åº¦ï¼ŒCNNçš„ç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚çš„è¾“å…¥æ˜¯ç”±å·ç§¯å±‚å’Œå­é‡‡æ ·å±‚è¿›è¡Œç‰¹å¾æå–å¾—åˆ°çš„çº¢ç»¿ç¯çš„ç‰¹å¾å›¾åƒã€‚æœ€åä¸€å±‚è¾“å‡ºå±‚æ˜¯ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œé‡‡ç”¨Softmaxå›å½’å¯¹çº¢ç»¿ç¯å›¾åƒè¿›è¡Œåˆ†ç±»ã€‚</p> 
<pre><code># å®šä¹‰å·ç§¯ç¥ç»ç½‘ç»œæ¨¡å‹
class CNN(nn.Module):
    def __init__(self, num_classes):
        super(CNN, self).__init__()
        # å®šä¹‰ç½‘ç»œç»“æ„
        
    def forward(self, x):
        # å‰å‘ä¼ æ’­é€»è¾‘
        return x

# åˆ›å»ºCNNæ¨¡å‹å®ä¾‹
model = CNN(num_classes)

# å®šä¹‰æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨
criterion = nn.CrossEntropyLoss()
optimizer = optim.SGD(model.parameters(), lr=learning_rate)

# è¿­ä»£è®­ç»ƒ
for epoch in range(num_epochs):
    # è®­ç»ƒæ­¥éª¤</code></pre> 
<p>Â  Â  Â  Â  é—¯çº¢ç¯è¯†åˆ«ï¼šå½“è§†é¢‘ä¸­çš„äº¤é€šç¯ä¸ºç»¿ç¯æ—¶ç›¸å¯¹äºè¡Œäººæ˜¯çº¢ç¯ï¼Œè®¡ç®—è¡Œäººçš„è¾¹ç•Œæ¡†å’Œäººè¡Œæ¨ªé“è¾¹ç•Œæ¡†çš„ä½ç½®å…³ç³»ï¼Œå½“äºŒè€…è·ç¦»å¤§äºæŸä¸ªé˜ˆå€¼ï¼Œåˆ™è¯´æ˜è¯¥è¡Œäººé—¯çº¢ç¯ã€‚å½“è§†é¢‘ä¸­çš„äº¤é€šç¯ä¸ºç»¿ç¯æ—¶ï¼Œç›¸å¯¹äºè¡Œäººæ˜¯çº¢ç¯ï¼Œè®¡ç®—è¡Œäººçš„è¾¹ç•Œæ¡†å’Œäººè¡Œæ¨ªé“è¾¹ç•Œæ¡†çš„ä½ç½®å…³ç³»ï¼Œå½“äºŒè€…è·ç¦»å¤§äºæŸä¸ªé˜ˆå€¼ï¼Œåˆ™è¯´æ˜è¯¥è¡Œäººé—¯çº¢ç¯ã€‚å½“çº¢ç¯ä¸ºçº¢ç¯æ—¶ï¼Œæ£€æµ‹è½¦è¾†è¡Œé©¶çš„æ–¹å‘ï¼Œå¦‚æœæœçº¢ç¯æ‰€åœ¨çš„æ–¹å‘è¡Œé©¶ï¼Œåˆ™è¯´æ˜è¯¥è½¦è¾†é—¯çº¢ç¯ã€‚</p> 
<pre><code>def detect_red_light(image, pedestrian_bbox, crosswalk_bbox, traffic_light_color, distance_threshold):
    if traffic_light_color == "green":
        pedestrian_center = (pedestrian_bbox[0] + pedestrian_bbox[2]) / 2
        crosswalk_center = (crosswalk_bbox[0] + crosswalk_bbox[2]) / 2
        distance = abs(pedestrian_center - crosswalk_center)
        if distance &gt; distance_threshold:
            return "Pedestrian violated red light"
        else:
            return "No violation"
    elif traffic_light_color == "red":
        vehicle_direction = detect_vehicle_direction(image)
        if vehicle_direction == "towards_red_light":
            return "Vehicle violated red light"
        else:
            return "No violation"</code></pre> 
<h4 id="3.2%20%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA">3.2 å®éªŒç¯å¢ƒæ­å»º</h4> 
<p>Â  Â  Â  Â  å®éªŒå¹³å°é‡‡ç”¨windowsç¯å¢ƒä¸‹ï¼ŒRAMä¸º8Gï¼Œæ˜¾å­˜4Gï¼Œæ˜¾å¡ä¸ºGTX1650ï¼Œæ¡†æ¶ä¸ºPyTorchï¼Œè¯­è¨€ä¸ºPythonã€‚</p> 
<h4 id="3.2%20%E5%AE%9E%E9%AA%8C%E5%8F%8A%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90">3.2 å®éªŒåŠç»“æœåˆ†æ</h4> 
<p>Â  Â  Â  Â  åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹åœ¨ç¬¬100ä¸ªepochå¤„å¼€å§‹æ”¶æ•›ï¼Œæ•´ä½“ç»“æœå‘ˆçº¿æ€§å‘å±•ï¼Œæ— è¿‡æ‹Ÿåˆå‘ç”Ÿã€‚ä»¥ä¸‹ä¸ºè®­ç»ƒæ•°æ®é›†ç»“æœã€‚</p> 
<p class="img-center"><img alt="æ¯•ä¸šè®¾è®¡-åŸºäºæ·±åº¦å­¦ä¹ çš„è¡Œäººè½¦è¾†é—¯çº¢ç¯å®æ—¶æ£€æµ‹ç®—æ³•ç³»ç»Ÿ YOLO python å·ç§¯ç¥ç»ç½‘ç»œ äººå·¥æ™ºèƒ½" height="222" src="https://images2.imgbox.com/94/e6/q1AOYYi5_o.png" width="429"></p> 
<p>éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code>
traffic_light_model = torch.hub.load('ultralytics/yolov5', 'yolov5s', pretrained=True)  # 

def detect_red_light(image):
    # åœ¨å›¾åƒä¸­æ£€æµ‹çº¢ç»¿ç¯
    results = traffic_light_model(image)

    # å¤„ç†æ£€æµ‹ç»“æœ
    # ...

    return results

def detect_violations(image_path):
    # æ‰“å¼€å›¾åƒ
    image = Image.open(image_path)

    # ä½¿ç”¨YOLOv5æ£€æµ‹è¡Œäººå’ŒæœºåŠ¨è½¦
    results = model(image)

    # å¤„ç†æ£€æµ‹ç»“æœ
    # ...

    # æ£€æµ‹çº¢ç»¿ç¯
    red_light_results = detect_red_light(image)

</code></pre> 
<h2 id="%E5%AE%9E%E7%8E%B0%E6%95%88%E6%9E%9C%E5%9B%BE%E6%A0%B7%E4%BE%8B">å®ç°æ•ˆæœå›¾æ ·ä¾‹</h2> 
<p class="img-center"><img alt="æ¯•ä¸šè®¾è®¡-åŸºäºæ·±åº¦å­¦ä¹ çš„è¡Œäººè½¦è¾†é—¯çº¢ç¯å®æ—¶æ£€æµ‹ç®—æ³•ç³»ç»Ÿ YOLO python å·ç§¯ç¥ç»ç½‘ç»œ äººå·¥æ™ºèƒ½" height="297" src="https://images2.imgbox.com/5f/3d/nwCc38BO_o.png" width="455"></p> 
<p><span style="color:#fe2c24;"><strong>åˆ›ä½œä¸æ˜“,æ¬¢è¿ç‚¹èµã€å…³æ³¨ã€æ”¶è—ã€‚</strong></span></p> 
<p><span style="color:#fe2c24;"><strong>æ¯•è®¾å¸®åŠ©ï¼Œç–‘éš¾è§£ç­”ï¼Œæ¬¢è¿æ‰“æ‰°ï¼</strong></span></p> 
<h2 id="%E6%9C%80%E5%90%8E" style="background-color:transparent;">æœ€å</h2>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d2956eff3f8209e82d0de7c589da1ac6/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">TikTok APIæ¥å£ï¼Œåšä¸»è§†é¢‘åˆ—è¡¨</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/aa25f38b0b76403057e353278e130aa5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">Cè¯­è¨€åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸æ˜¯å›æ–‡å­—ç¬¦ä¸²æ¡ˆä¾‹è®²è§£</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ITå­¦ä¹ è€…åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>