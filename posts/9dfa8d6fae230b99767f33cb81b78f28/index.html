<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>centos7升级gcc&amp;glibc(踩坑) - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="centos7升级gcc&amp;glibc(踩坑)" />
<meta property="og:description" content="公司新到的服务器，需要安装常用的数据库，在mysql，postgresql等安装的时候都非常的顺利，但是在安装SqlServer的时候发现缺少依赖的glibc2.18和glibc2.27，于是便有了这次的踩坑之旅。
刚开始是看缺什么就装什么，先下载了glibc2.18和glibc2.27，2.18版本的安装很顺利，但是在2.27安装的时候就开始报错了(最后发现是缺少一个libc-2.27.so的文件，但是一部分文件已经变成了2.27版本，一部分还是2.18的，导致版本不一致，环境就出问题了)，然后各种百度尝试解决，还有修改lib64里面的软链接，*.so文件等，最后系统坏了只能含泪重装了一次。
然后重装后依然采用第一次升级的方式，发现还是这个坎没有过去，系统又坏了，于是含泪第二次重装了系统，也学到了一些知识：glibc生成的*.so文件和一些软链接什么的都是系统运行依赖的，一旦出了问题，系统运行就会受影响，升级的时候一定要慎重以及安全操作，最好做备份。
第二次重装之后没有着急去升级glibc，而是先升级了gcc(系统默认的是4.8.5，升级到了9.3.0)，升级了make(系统默认是3.X来着，升级到了4.3)，最后才升级了glibc(直接升级到了2.31，会包含之前的老版本)，最后终于成功了，具体操作请看下面。
1.源码编译升级gcc9.3.0
1）编译升级gcc
wget https://mirrors.aliyun.com/gnu/gcc/gcc-9.3.0/gcc-9.3.0.tar.gz cp gcc-9.3.0.tar.gz /opt cd /opt tar -zxf gcc-9.3.0.tar.gz cd gcc-9.3.0/ ./contrib/download_prerequisites #建议先手动下载依赖的这四个包，下载地址ftp://gcc.gnu.org/pub/gcc/infrastructure/ cat /proc/cpuinfo| grep &#34;processor&#34;| wc -l mkdir build cd build ../configure --enable-checking=release --enable-language=c,c&#43;&#43; --disable-multilib --prefix=/usr make -j6 make install 2)升级成功后gcc版本检查
cd /usr/lib64 ll libstdc&#43;&#43;* gcc -v gcc --version 2.源码编译升级make
1）编译升级make
wget https://mirrors.aliyun.com/gnu/make/make-4.3.tar.gz cp make-4.3.tar.gz /opt cd /opt/ tar -zxf make-4.3.tar.gz cd make-4.3/ mkdir build cd build ../configure --prefix=/usr &amp;&amp; make &amp;&amp; make install 2)检查升级后的make版本信息" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/9dfa8d6fae230b99767f33cb81b78f28/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-26T13:29:49+08:00" />
<meta property="article:modified_time" content="2021-12-26T13:29:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">centos7升级gcc&amp;glibc(踩坑)</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>公司新到的服务器，需要安装常用的数据库，在mysql，postgresql等安装的时候都非常的顺利，但是在安装SqlServer的时候发现缺少依赖的glibc2.18和glibc2.27，于是便有了这次的踩坑之旅。</p> 
<p>刚开始是看缺什么就装什么，先下载了glibc2.18和glibc2.27，2.18版本的安装很顺利，但是在2.27安装的时候就开始报错了(最后发现是缺少一个libc-2.27.so的文件，但是一部分文件已经变成了2.27版本，一部分还是2.18的，导致版本不一致，环境就出问题了)，然后各种百度尝试解决，还有修改lib64里面的软链接，*.so文件等，最后系统坏了只能含泪重装了一次。</p> 
<p>然后重装后依然采用第一次升级的方式，发现还是这个坎没有过去，系统又坏了，于是含泪第二次重装了系统，也学到了一些知识：glibc生成的*.so文件和一些软链接什么的都是系统运行依赖的，一旦出了问题，系统运行就会受影响，升级的时候一定要慎重以及安全操作，最好做备份。</p> 
<p>第二次重装之后没有着急去升级glibc，而是先升级了gcc(系统默认的是4.8.5，升级到了9.3.0)，升级了make(系统默认是3.X来着，升级到了4.3)，最后才升级了glibc(直接升级到了2.31，会包含之前的老版本)，最后终于成功了，具体操作请看下面。</p> 
<p><strong>1.源码编译升级gcc9.3.0</strong></p> 
<p>1）编译升级gcc</p> 
<pre><code>wget https://mirrors.aliyun.com/gnu/gcc/gcc-9.3.0/gcc-9.3.0.tar.gz
cp gcc-9.3.0.tar.gz /opt
cd /opt
tar -zxf gcc-9.3.0.tar.gz
cd gcc-9.3.0/

 ./contrib/download_prerequisites
#建议先手动下载依赖的这四个包，下载地址ftp://gcc.gnu.org/pub/gcc/infrastructure/
cat /proc/cpuinfo| grep "processor"| wc -l

mkdir build
cd build
../configure --enable-checking=release --enable-language=c,c++ --disable-multilib --prefix=/usr

make -j6
make install</code></pre> 
<p>2)升级成功后gcc版本检查</p> 
<pre><code>cd /usr/lib64
ll libstdc++*
gcc -v
gcc --version</code></pre> 
<p>2.<strong>源码编译升级make</strong></p> 
<p>1）编译升级make</p> 
<pre><code>wget https://mirrors.aliyun.com/gnu/make/make-4.3.tar.gz
cp make-4.3.tar.gz /opt
cd /opt/
tar -zxf make-4.3.tar.gz 
cd make-4.3/
mkdir build
cd build
../configure --prefix=/usr &amp;&amp; make &amp;&amp; make install</code></pre> 
<p>2)检查升级后的make版本信息</p> 
<pre><code>make -v</code></pre> 
<p><strong>3、升级glibc-2.31</strong></p> 
<pre><code>cd /opt
wget https://mirrors.aliyun.com/gnu/glibc/glibc-2.31.tar.gz
tar -zxf glibc-2.31.tar.gz
cd glibc-2.31/
cat INSTALL | grep -E "newer|later"
mkdir build
cd build
../configure  --prefix=/usr --disable-profile --enable-add-ons --with-headers=/usr/include --with-binutils=/usr/bin --disable-sanity-checks --disable-werror
yum install python3 #一定要有这一步，python2安装会报错的
make -j6
make install
make localedata/install-locales</code></pre> 
<p> 最后升级完成后的页面，会有一个error，可以忽略，如下：</p> 
<p><img alt="" height="708" src="https://images2.imgbox.com/92/37/EZQgOCy9_o.png" width="1200"></p> 
<p> 最后验证升级后的glibc版本</p> 
<pre><code>strings /lib64/libc.so.6 | grep GLIBC
ll /lib64/libc.so*</code></pre> 
<p><img alt="" height="837" src="https://images2.imgbox.com/94/6d/eZNVKIIE_o.png" width="868"></p> 
<p><img alt="" height="104" src="https://images2.imgbox.com/2f/46/O9J5Evud_o.png" width="1070"></p> 
<p> 至此，gcc和glibc升级完成！</p> 
<p> 以上内容转载自文章：<a href="https://cloud.tencent.com/developer/article/1669876" rel="nofollow" title="CentOS7下升级GLIBC2.31 - 云+社区 - 腾讯云 (tencent.com)">CentOS7下升级GLIBC2.31 - 云+社区 - 腾讯云 (tencent.com)</a></p> 
<p> 感谢大佬的文章帮助解决问题</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2f498a8d2941e6c8665425d7039cb45c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Dubbo之入门</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c2318a23750592992396757806894314/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">centos7安装SqlServer2019数据库</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>