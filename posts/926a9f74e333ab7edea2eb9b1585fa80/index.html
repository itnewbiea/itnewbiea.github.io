<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>hdu5895Mathematician QSC - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="hdu5895Mathematician QSC" />
<meta property="og:description" content="链接：http://acm.hdu.edu.cn/showproblem.php?pid=5895 题意：给定f(0)=0,f(1)=1,f(n)=f(n-2)&#43;2*f(n-1)，g(n)=sigma(f(i)^2){0&lt;=i&lt;=n}。给定多组n,y,x,s，求x^g(n*y)%(s&#43;1)。 分析：写出矩阵递推式，然后就是矩阵快速幂啦。矩阵递推式见代码。 代码： #include&lt;map&gt; #include&lt;set&gt; #include&lt;cmath&gt; #include&lt;queue&gt; #include&lt;bitset&gt; #include&lt;math.h&gt; #include&lt;vector&gt; #include&lt;string&gt; #include&lt;stdio.h&gt; #include&lt;cstring&gt; #include&lt;iostream&gt; #include&lt;algorithm&gt; #pragma comment(linker, &#34;/STACK:102400000,102400000&#34;) using namespace std; const int N=3010; const int M=50010; const int mod=1000000007; const int MOD1=1000000007; const int MOD2=1000000009; const double EPS=0.00000001; typedef long long ll; const ll MOD=1000000007; const int INF=1000000010; const ll MAX=1ll&lt;&lt;55; const double eps=1e-5; const double inf=~0u&gt;&gt;1; const double pi=acos(-1.0); typedef double db; typedef unsigned int uint; typedef unsigned long long ull; struct martrix{ ll x[5][5]; }p; ll phi(ll n) { ll i,ans=n,m=(ll)sqrt(n&#43;0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/926a9f74e333ab7edea2eb9b1585fa80/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-09-22T19:58:12+08:00" />
<meta property="article:modified_time" content="2016-09-22T19:58:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">hdu5895Mathematician QSC</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>链接：<a target="_blank" href="http://acm.hdu.edu.cn/showproblem.php?pid=5895" rel="nofollow noopener noreferrer">http://acm.hdu.edu.cn/showproblem.php?pid=5895</a></h4> 
<h4>题意：<span style="font-weight:normal">给定f(0)=0,f(1)=1,f(n)=f(n-2)+2*f(n-1)，g(n)=sigma(f(i)^2){0&lt;=i&lt;=n}。给定多组n,y,x,s，求x^g(n*y)%(s+1)。</span></h4> 
<h4>分析：<span style="font-weight:normal">写出矩阵递推式，然后就是矩阵快速幂啦。矩阵递推式见代码。</span></h4> 
<h4>代码：</h4> 
<div> 
 <pre><code class="language-cpp">#include&lt;map&gt;
#include&lt;set&gt;
#include&lt;cmath&gt;
#include&lt;queue&gt;
#include&lt;bitset&gt;
#include&lt;math.h&gt;
#include&lt;vector&gt;
#include&lt;string&gt;
#include&lt;stdio.h&gt;
#include&lt;cstring&gt;
#include&lt;iostream&gt;
#include&lt;algorithm&gt;
#pragma comment(linker, "/STACK:102400000,102400000")
using namespace std;
const int N=3010;
const int M=50010;
const int mod=1000000007;
const int MOD1=1000000007;
const int MOD2=1000000009;
const double EPS=0.00000001;
typedef long long ll;
const ll MOD=1000000007;
const int INF=1000000010;
const ll MAX=1ll&lt;&lt;55;
const double eps=1e-5;
const double inf=~0u&gt;&gt;1;
const double pi=acos(-1.0);
typedef double db;
typedef unsigned int uint;
typedef unsigned long long ull;
struct martrix{
    ll x[5][5];
}p;
ll phi(ll n) {
    ll i,ans=n,m=(ll)sqrt(n+0.5);
    for (i=2;i&lt;=m;i++)
    if (n%i==0) {
        ans=ans/i*(i-1);
        while (n%i==0) n/=i;
    }
    if (n&gt;1) ans=ans/n*(n-1);
    return ans;
}
martrix mul(martrix a,martrix b,ll mo) {
    martrix ret;
    memset(ret.x,0,sizeof(ret.x));
    for (int i=1;i&lt;5;i++)
        for (int j=1;j&lt;5;j++)
            for (int k=1;k&lt;5;k++) (ret.x[i][j]+=a.x[i][k]*b.x[k][j])%=mo;
    return ret;
}
martrix qpowm(ll x,ll mo) {
    martrix ret,now=p;
    memset(ret.x,0,sizeof(ret.x));
    for (int i=1;i&lt;5;i++) ret.x[i][i]=1;
    while (x) {
        if (x&amp;1) ret=mul(ret,now,mo);
        now=mul(now,now,mo);x&gt;&gt;=1;
    }
    return ret;
}
ll getmi(ll n,ll mo) {
    if (n&lt;=1) return n;
    martrix ans=qpowm(n-1,mo);
    return ((ans.x[2][4]+ans.x[4][4])%mo+mo)%mo;
}
ll qpow(ll x,ll y,ll mo) {
    ll ret=1;
    while (y) {
        if (y&amp;1) (ret*=x)%=mo;
        (x*=x)%=mo;y&gt;&gt;=1;
    }
    return (ret+mo)%mo;
}
int main()
{
    /*
    矩阵递推式
    [f(n-2)^2,f(n-1)^2,f(n-2)*f(n-1),g(n-1)]*[0,1,0,1]
                                             [1,4,2,4]
                                             [0,4,1,4]
                                             [0,0,0,1]
    =[f(n-1)^2,f(n)^2,f(n-1)*f(n),g(n)]
    */
    int i,t;
    ll n,y,x,s,z;
    p.x[1][1]=0;p.x[1][2]=1;p.x[1][3]=0;p.x[1][4]=1;
    p.x[2][1]=1;p.x[2][2]=4;p.x[2][3]=2;p.x[2][4]=4;
    p.x[3][1]=0;p.x[3][2]=4;p.x[3][3]=1;p.x[3][4]=4;
    p.x[4][1]=0;p.x[4][2]=0;p.x[4][3]=0;p.x[4][4]=1;
    scanf("%d", &amp;t);
    while (t--) {
        scanf("%lld%lld%lld%lld", &amp;n, &amp;y, &amp;x, &amp;s);
        z=phi(s+1);
        printf("%lld\n", qpow(x,getmi(n*y,z)+z,s+1));
    }
    return 0;
}</code></pre> 
 <br> 
 <br> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d1179607099f0978c1e9683677df6e04/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Loadrunner关联取参及设置检查点</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/68dc90ec2413a8849f16a79a1a40852c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linq表达式和Lambda表达式用法对比</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>