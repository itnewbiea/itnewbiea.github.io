<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java 类加载器 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java 类加载器" />
<meta property="og:description" content="开发过程中经常会遇到java.lang.ClassNotFoundExcetpion的异常，为何会有这个异常呢？因为你想要使用的类并未加载到虚拟机当中。本文将介绍java的类加载器，让你了解一个class文件加载到虚拟机中的机制，并介绍了如何自定义类加载器。结合代码验证理论。
JVM预定义的三种类加载器 JVM预定义了三种类加载器，分别是：
启动类加载器（BootStrap）扩展类加载器（Extension）系统类加载器（System） 启动类加载器 启动类加载器是使用本地代码实现的，类似于我们看源码时的native方法，找不到具体的class。它负载将JAVA_HOME/lib下的核心类库或-Xbootclasspath选项指定的路径下的jar加载到虚拟机当中。
System.getProperty(“sun.boot.class.path”)参数可以查看该类加载器加载的路径。
因为没有具体的class，所以没法看类图。
扩展类加载器 扩展类加载器是sun.misc.Launcher$ExtClassLoader。它负责将JAVA_HOME /lib/ext或者由系统变量-Djava.ext.dir指定位置中的类库加载到内存中。
System.getProperty(“java.ext.dirs”)参数可以查看该类加载器加载的路径。
类图如下：
它是sun.misc.Launcher的内部类。
系统类加载器 系统类加载器是sun.misc.Launcher$AppClassLoader。它负责将用户类路径(java -classpath或-Djava.class.path变量所指的目录，即当前类所在路径及其引用的第三方类库的路径下的类库加载到内存中。开发者可以直接使用系统类加载器。
System.getProperty(“java.class.path”)可查看该类加载器加载的路径。
类图如下：
与扩展类加载器一样，它也是sun.misc.Launcher的内部类。
三种类加载的文件路径测试代码 下面的代码分别打印了三种类加载器加载了哪些路径的jar包，验证上面的介绍
package ClassLoader; /** * @author ludengke * @title: ClassLoader.TestClassLoader * @projectName springcloud-demo * @description: TODO * @date 2021/12/2615:15 */ public class TestClassLoader { public static void main(String[] args) { bootStrapClassLoader(); extClassLoader(); appClassLoader(); // testClassLoader(); } /** * 测试TestBean被哪个类加载器加载的，这个加载器加载的路径是啥 */ // private static void testClassLoader(){ // try { // //查看当前系统类路径中包含的路径条目 // System." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/71acc53bfc334414f570799e245d8d10/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-05T23:13:39+08:00" />
<meta property="article:modified_time" content="2022-01-05T23:13:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java 类加载器</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>开发过程中经常会遇到java.lang.ClassNotFoundExcetpion的异常，为何会有这个异常呢？因为你想要使用的类并未加载到虚拟机当中。本文将介绍java的类加载器，让你了解一个class文件加载到虚拟机中的机制，并介绍了如何自定义类加载器。结合代码验证理论。</p> 
<h2><a id="JVM_1"></a>JVM预定义的三种类加载器</h2> 
<p>JVM预定义了三种类加载器，分别是：</p> 
<ul><li>启动类加载器（BootStrap）</li><li>扩展类加载器（Extension）</li><li>系统类加载器（System）</li></ul> 
<h3><a id="_6"></a>启动类加载器</h3> 
<p>启动类加载器是使用本地代码实现的，类似于我们看源码时的native方法，找不到具体的class。它负载将JAVA_HOME/lib下的核心类库或-Xbootclasspath选项指定的路径下的jar加载到虚拟机当中。</p> 
<p>System.getProperty(“sun.boot.class.path”)参数可以查看该类加载器加载的路径。</p> 
<p>因为没有具体的class，所以没法看类图。</p> 
<h3><a id="_12"></a>扩展类加载器</h3> 
<p>扩展类加载器是sun.misc.Launcher$ExtClassLoader。它负责将JAVA_HOME /lib/ext或者由系统变量-Djava.ext.dir指定位置中的类库加载到内存中。</p> 
<p>System.getProperty(“java.ext.dirs”)参数可以查看该类加载器加载的路径。</p> 
<p>类图如下：<br> <img src="https://images2.imgbox.com/71/86/YgrGVE9T_o.png" alt="在这里插入图片描述"><br> 它是sun.misc.Launcher的内部类。</p> 
<h3><a id="_20"></a>系统类加载器</h3> 
<p>系统类加载器是sun.misc.Launcher$AppClassLoader。它负责将用户类路径(java -classpath或-Djava.class.path变量所指的目录，即当前类所在路径及其引用的第三方类库的路径下的类库加载到内存中。开发者可以直接使用系统类加载器。</p> 
<p>System.getProperty(“java.class.path”)可查看该类加载器加载的路径。</p> 
<p>类图如下：<br> <img src="https://images2.imgbox.com/5e/e4/2LXbBtE9_o.png" alt="在这里插入图片描述"><br> 与扩展类加载器一样，它也是sun.misc.Launcher的内部类。</p> 
<h3><a id="_28"></a>三种类加载的文件路径测试代码</h3> 
<p>下面的代码分别打印了三种类加载器加载了哪些路径的jar包，验证上面的介绍</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token class-name">ClassLoader</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author ludengke
 * @title: ClassLoader.TestClassLoader
 * @projectName springcloud-demo
 * @description: TODO
 * @date 2021/12/2615:15
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestClassLoader</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">bootStrapClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">extClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">appClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        testClassLoader();</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 测试TestBean被哪个类加载器加载的，这个加载器加载的路径是啥
     */</span>
<span class="token comment">//    private static void testClassLoader(){<!-- --></span>
<span class="token comment">//        try {<!-- --></span>
<span class="token comment">//            //查看当前系统类路径中包含的路径条目</span>
<span class="token comment">//            System.out.println(System.getProperty("java.class.path"));</span>
<span class="token comment">//            //调用加载当前类的类加载器（这里即为系统类加载器）加载TestBean</span>
<span class="token comment">//            Class typeLoaded = Class.forName("sun.net.spi.nameservice.dns.DNSNameService");</span>
<span class="token comment">//            Class typeLoaded2 = Class.forName("ClassLoader.TestBean");</span>
<span class="token comment">//            //查看被加载的TestBean类型是被那个类加载器加载的</span>
<span class="token comment">//            System.out.println(typeLoaded.getClassLoader());</span>
<span class="token comment">//            System.out.println(typeLoaded2.getClassLoader());</span>
<span class="token comment">//        } catch (Exception e) {<!-- --></span>
<span class="token comment">//            e.printStackTrace();</span>
<span class="token comment">//        }</span>
<span class="token comment">//    }</span>
    <span class="token comment">/***
    *@Description 测试bootstrap加载的路径
    *@Param []
    *@Return void
    *@Author ludengke
    *@Date 2021/12/26
    *@Time 15:17
    */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">bootStrapClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"bootstrap start:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"sun.boot.class.path"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"bootstrap end:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token comment">/***
    *@Description extClassLoader加载的路径
    *@Param []
    *@Return void
    *@Author ludengke
    *@Date 2021/12/26
    *@Time 15:26
    */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">extClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//testClassLoaderParent();</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ext start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"java.ext.dirs"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ext end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取类加载器的parent
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testClassLoaderParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
    *@Description appClassLoader加载的路径
    *@Param []
    *@Return void
    *@Author ludengke
    *@Date 2021/12/26
    *@Time 15:29
    */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">appClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"app start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"java.class.path"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"app end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>测试类执行结果如下：</p> 
<pre><code class="prism language-java"><span class="token class-name">D</span><span class="token operator">:</span>\work\java\bin\java<span class="token punctuation">.</span>exe <span class="token string">"-javaagent:C:\Program Files\JetBrains\IntelliJ IDEA 2019.3.3\lib\idea_rt.jar=54689:C:\Program Files\JetBrains\IntelliJ IDEA 2019.3.3\bin"</span> <span class="token operator">-</span><span class="token class-name">Dfile</span><span class="token punctuation">.</span>encoding<span class="token operator">=</span>UTF<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span>classpath <span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\charsets<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\deploy<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\access<span class="token operator">-</span>bridge<span class="token operator">-</span><span class="token number">64.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\cldrdata<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\dnsns<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\jaccess<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\jfxrt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\localedata<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\nashorn<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunec<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunjce_provider<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunmscapi<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunpkcs11<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\zipfs<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\javaws<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jce<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jfr<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jfxswt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jsse<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\management<span class="token operator">-</span>agent<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\plugin<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\resources<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\rt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\springcloud<span class="token operator">-</span>demo\study\target\classes<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\maven\mavenstore\org\openjdk\jol\jol<span class="token operator">-</span>core\<span class="token number">0.9</span>\jol<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">0.9</span><span class="token punctuation">.</span>jar <span class="token class-name">ClassLoader<span class="token punctuation">.</span>TestClassLoader</span>
bootstrap start<span class="token operator">:</span>
<span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\resources<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\rt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\sunrsasign<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jsse<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jce<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\charsets<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jfr<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\classes
bootstrap end<span class="token operator">:</span>
ext start
<span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext<span class="token punctuation">;</span><span class="token class-name">C</span><span class="token operator">:</span>\WINDOWS\<span class="token class-name">Sun</span>\<span class="token class-name">Java</span>\lib\ext
ext end
app start
<span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\charsets<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\deploy<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\access<span class="token operator">-</span>bridge<span class="token operator">-</span><span class="token number">64.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\cldrdata<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\dnsns<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\jaccess<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\jfxrt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\localedata<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\nashorn<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunec<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunjce_provider<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunmscapi<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunpkcs11<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\zipfs<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\javaws<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jce<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jfr<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jfxswt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jsse<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\management<span class="token operator">-</span>agent<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\plugin<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\resources<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\rt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\springcloud<span class="token operator">-</span>demo\study\target\classes<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\maven\mavenstore\org\openjdk\jol\jol<span class="token operator">-</span>core\<span class="token number">0.9</span>\jol<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">0.9</span><span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">C</span><span class="token operator">:</span>\<span class="token class-name">Program</span> <span class="token class-name">Files</span>\<span class="token class-name">JetBrains</span>\<span class="token class-name">IntelliJ</span> IDEA <span class="token number">2019.3</span><span class="token number">.3</span>\lib\idea_rt<span class="token punctuation">.</span>jar
app end

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>
</code></pre> 
<p>从测试结果可以看出系统类加载器也加载了启动类加载器、扩展类加载应该加载的路径，这会不会有问题呢？<br> 应该不会，下面介绍类加载机制。</p> 
<h2><a id="_140"></a>类加载机制（双亲委派机制）</h2> 
<p>类加载器的继承关系如下，这里的继承关系不是真正的继承，是类加载器的父子委托关系<br> <img src="https://images2.imgbox.com/ba/b2/ctILFVsC_o.png" alt="在这里插入图片描述"><br> 双亲委派机制：</p> 
<ul><li>当类加载器接收到加载某个类的请求时，先看看该类加载器是否加载过此类，若加载过则不需要加载，直接使用，若未加载过此类，则委托给父类加载器加载。</li><li>以此类推，直至BootStrapClassLoader。</li><li>若BootStrapClassLoader加载不到该类，则委托给它的子类加载器ExtClassLoader加载。</li><li>以此类推，直至最底层的类加载器。</li><li>若都加载不到，那就是找不到该类的错误了。<br> <img src="https://images2.imgbox.com/82/ad/xApagpHL_o.jpg" alt="在这里插入图片描述"><br> 双亲委派机制的作用：<br> 为什么这么设计呢？<br> 从这个加载机制可以看出顶层的类加载器优先级高很多，会覆盖掉底层类加载器加载的类。<br> 委托给父类加载器时，若父类已经加载该类，则直接用，不需要再重新加载，且保证不覆盖父类加载器加载的内容，保证数据安全。<br> 上层的类加载器实在加载不到，不能憋着，只能儿孙们自己动手加载。不然底层加载器没有了。<br> <em><strong>总结起来一句话：孩子们很懒，已经加载过该类则直接用，否则找长辈们要。如果长辈们也没有，孩子们才自己动手加载。</strong></em></li><li>防止重复加载同一个.class。通过委托去向上面问一问，加载过了，就不用再加载一遍。保证数据安全。</li><li>保证核心.class不能被篡改。通过委托方式，不会去篡改核心.clas，即使篡改也不会去加载，即使加载也不会是同一个.class对象了。不同的加载器加载同一个.class也不是同一个Class对象。这样保证了Class执行安全。</li></ul> 
<h2><a id="_158"></a>测试类加载机制</h2> 
<ul><li>测试代码如下<br> 随便写一个类TestBean</li></ul> 
<pre><code class="prism language-java">
<span class="token keyword">package</span> <span class="token class-name">ClassLoader</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestBean</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token class-name">TestBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>测试类，主要看testClassLoader()方法</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token class-name">ClassLoader</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author ludengke
 * @title: ClassLoader.TestClassLoader
 * @projectName springcloud-demo
 * @description: TODO
 * @date 2021/12/2615:15
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestClassLoader</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">//        bootStrapClassLoader();</span>
<span class="token comment">//        extClassLoader();</span>
<span class="token comment">//        appClassLoader();</span>
        <span class="token function">testClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 测试TestBean被哪个类加载器加载的，这个加载器加载的路径是啥
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//查看当前系统类路径中包含的路径条目</span>
<span class="token comment">//            System.out.println(System.getProperty("java.class.path"));</span>
            <span class="token comment">//调用加载当前类的类加载器（这里即为系统类加载器）加载TestBean</span>
            <span class="token class-name">Class</span> typeLoaded <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"sun.net.spi.nameservice.dns.DNSNameService"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Class</span> typeLoaded2 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"ClassLoader.TestBean"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//查看被加载的TestBean类型是被那个类加载器加载的</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>typeLoaded<span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>typeLoaded2<span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/***
    *@Description 测试bootstrap加载的路径
    *@Param []
    *@Return void
    *@Author ludengke
    *@Date 2021/12/26
    *@Time 15:17
    */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">bootStrapClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"bootstrap start:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"sun.boot.class.path"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"bootstrap end:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token comment">/***
    *@Description extClassLoader加载的路径
    *@Param []
    *@Return void
    *@Author ludengke
    *@Date 2021/12/26
    *@Time 15:26
    */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">extClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token comment">//        testClassLoaderParent();</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ext start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"java.ext.dirs"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ext end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取类加载器的parent
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testClassLoaderParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
    *@Description appClassLoader加载的路径
    *@Param []
    *@Return void
    *@Author ludengke
    *@Date 2021/12/26
    *@Time 15:29
    */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">appClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"app start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"java.class.path"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"app end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<ul><li>运行测试类</li></ul> 
<pre><code class="prism language-java"><span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Launcher</span>$<span class="token class-name">ExtClassLoader</span><span class="token annotation punctuation">@7f31245a</span>
<span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Launcher</span>$<span class="token class-name">AppClassLoader</span><span class="token annotation punctuation">@18b4aac2</span>

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>
</code></pre> 
<ul><li>sun.net.spi.nameservice.dns.DNSNameService这个类是扩展类加载器加载的路径中的类，暂时不看。主要看ClassLoader.TestBean，该类是用AppClassLoader加载的，加载的是上面写的那个类。</li><li>将ClassLoader.TestBean类生成testjar.jar，将该jar包拷贝到JAVA_HOME\jre\lib\ext下，再次运行，结果如下。可以看出ClassLoader.TestBean类是ExtClassLoader类加载器加载的，加载的是JAVA_HOME\jre\lib\ext下testjar的内容。可以验证双亲委派机制。</li></ul> 
<pre><code class="prism language-java"><span class="token class-name">D</span><span class="token operator">:</span>\work\java\bin\java<span class="token punctuation">.</span>exe <span class="token string">"-javaagent:C:\Program Files\JetBrains\IntelliJ IDEA 2019.3.3\lib\idea_rt.jar=62498:C:\Program Files\JetBrains\IntelliJ IDEA 2019.3.3\bin"</span> <span class="token operator">-</span><span class="token class-name">Dfile</span><span class="token punctuation">.</span>encoding<span class="token operator">=</span>UTF<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span>classpath <span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\charsets<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\deploy<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\access<span class="token operator">-</span>bridge<span class="token operator">-</span><span class="token number">64.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\cldrdata<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\dnsns<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\jaccess<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\jfxrt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\localedata<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\nashorn<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunec<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunjce_provider<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunmscapi<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunpkcs11<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\zipfs<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\javaws<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jce<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jfr<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jfxswt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jsse<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\management<span class="token operator">-</span>agent<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\plugin<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\resources<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\rt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\springcloud<span class="token operator">-</span>demo\study\target\classes<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\maven\mavenstore\org\openjdk\jol\jol<span class="token operator">-</span>core\<span class="token number">0.9</span>\jol<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">0.9</span><span class="token punctuation">.</span>jar <span class="token class-name">ClassLoader<span class="token punctuation">.</span>TestClassLoader</span>
<span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Launcher</span>$<span class="token class-name">ExtClassLoader</span><span class="token annotation punctuation">@7f31245a</span>
<span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Launcher</span>$<span class="token class-name">ExtClassLoader</span><span class="token annotation punctuation">@7f31245a</span>

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>

</code></pre> 
<ul><li>将testjar.jar拷贝到JAVA_HOME/lib 下，再次运行测试类，结果如下。按理来说启动类加载器应该加载testjar.jar中的ClassLoader.TestBean，可是没有。为啥呢？你什么都往里面写，jdk就不安全了，所以他不认识的东西不加载，保证了安全。</li></ul> 
<pre><code class="prism language-java"><span class="token class-name">D</span><span class="token operator">:</span>\work\java\bin\java<span class="token punctuation">.</span>exe <span class="token string">"-javaagent:C:\Program Files\JetBrains\IntelliJ IDEA 2019.3.3\lib\idea_rt.jar=62680:C:\Program Files\JetBrains\IntelliJ IDEA 2019.3.3\bin"</span> <span class="token operator">-</span><span class="token class-name">Dfile</span><span class="token punctuation">.</span>encoding<span class="token operator">=</span>UTF<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span>classpath <span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\charsets<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\deploy<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\access<span class="token operator">-</span>bridge<span class="token operator">-</span><span class="token number">64.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\cldrdata<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\dnsns<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\jaccess<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\jfxrt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\localedata<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\nashorn<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunec<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunjce_provider<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunmscapi<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunpkcs11<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\zipfs<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\javaws<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jce<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jfr<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jfxswt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jsse<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\management<span class="token operator">-</span>agent<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\plugin<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\resources<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\rt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\springcloud<span class="token operator">-</span>demo\study\target\classes<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\maven\mavenstore\org\openjdk\jol\jol<span class="token operator">-</span>core\<span class="token number">0.9</span>\jol<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">0.9</span><span class="token punctuation">.</span>jar <span class="token class-name">ClassLoader<span class="token punctuation">.</span>TestClassLoader</span>
<span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Launcher</span>$<span class="token class-name">ExtClassLoader</span><span class="token annotation punctuation">@7f31245a</span>
<span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Launcher</span>$<span class="token class-name">ExtClassLoader</span><span class="token annotation punctuation">@7f31245a</span>

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>

</code></pre> 
<h2><a id="_294"></a>自定义类加载器</h2> 
<p>为什么需要自定义类加载器呢？<br> 因为系统的ClassLoader只会加载指定目录下的class文件,如果你想加载自己的class文件,那么就可以自定义一个ClassLoader。<br> 而且可以使用加密的class文件，加载该class文件时，只有懂得如何解密才能使用，这时也需要自定义的类加载器。</p> 
<p>而且我们可以根据自己的需求，对class文件进行加密和解密。</p> 
<ul><li>编写被加载的类，里面随便写个方法，代码如下：</li></ul> 
<pre><code class="prism language-java">
<span class="token keyword">package</span> <span class="token class-name">ClassLoader</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestBean</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token class-name">TestBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ClassLoader.TestBean.testMethod()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<ul><li>编写自定义的类加载器MyClassLoader，继承java.lang.ClassLoader，重写findClass方法，代码如下：</li></ul> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token class-name">ClassLoader</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileInputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author ludengke
 * @title: MyCloassLoader
 * @projectName springcloud-demo
 * @description: TODO
 * @date 2022/1/522:41
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCloassLoader</span> <span class="token keyword">extends</span> <span class="token class-name">ClassLoader</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> path<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyCloassLoader</span><span class="token punctuation">(</span><span class="token class-name">String</span> path<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>path <span class="token operator">=</span> path<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 重父类的该方法
     *
     * @param name
     * @return
     * @throws ClassNotFoundException
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">findClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Class</span> log <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取该class文件字节码数组</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> classData <span class="token operator">=</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>classData <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 将class的字节码数组转换成Class类的实例</span>
            log <span class="token operator">=</span> <span class="token function">defineClass</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> classData<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> classData<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> log<span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取class文件的字节码
     * @return
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">FileInputStream</span> in <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token class-name">ByteArrayOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
                out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>size <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    out<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                    in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> out<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<ul><li>编写测试类，代码如下：</li></ul> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token class-name">ClassLoader</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author ludengke
 * @title: ClassLoader.TestClassLoader
 * @projectName springcloud-demo
 * @description: TODO
 * @date 2021/12/2615:15
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestClassLoader</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">testMyClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 测试自定义的类加载器
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testMyClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//实例类加载器</span>
            <span class="token class-name">MyCloassLoader</span> cloassLoader<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MyCloassLoader</span><span class="token punctuation">(</span><span class="token string">"D:\\work\\springcloud-demo\\study\\target\\classes\\ClassLoader\\TestBean.class"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"自定义的类加载器的父类加载器是："</span><span class="token operator">+</span>cloassLoader<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//通过自定义的类加载器加载类</span>
            <span class="token class-name">Class</span> testBeanClass<span class="token operator">=</span>cloassLoader<span class="token punctuation">.</span><span class="token function">findClass</span><span class="token punctuation">(</span><span class="token string">"ClassLoader.TestBean"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//加载出来的类的类加载器</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"类加载器是:"</span> <span class="token operator">+</span> testBeanClass<span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//通过反射调用类的方法</span>
            <span class="token class-name">Method</span> method <span class="token operator">=</span> testBeanClass<span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"testMethod"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Object</span> object <span class="token operator">=</span> testBeanClass<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//调用类的方法</span>
            method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
   
<span class="token punctuation">}</span>

</code></pre> 
<ul><li>运行测试类，结果如下：</li></ul> 
<pre><code class="prism language-java"><span class="token class-name">D</span><span class="token operator">:</span>\work\java\bin\java<span class="token punctuation">.</span>exe <span class="token string">"-javaagent:C:\Program Files\JetBrains\IntelliJ IDEA 2019.3.3\lib\idea_rt.jar=63921:C:\Program Files\JetBrains\IntelliJ IDEA 2019.3.3\bin"</span> <span class="token operator">-</span><span class="token class-name">Dfile</span><span class="token punctuation">.</span>encoding<span class="token operator">=</span>UTF<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span>classpath <span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\charsets<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\deploy<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\access<span class="token operator">-</span>bridge<span class="token operator">-</span><span class="token number">64.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\cldrdata<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\dnsns<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\jaccess<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\jfxrt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\localedata<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\nashorn<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunec<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunjce_provider<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunmscapi<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\sunpkcs11<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\ext\zipfs<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\javaws<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jce<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jfr<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jfxswt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\jsse<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\management<span class="token operator">-</span>agent<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\plugin<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\resources<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\java\jre\lib\rt<span class="token punctuation">.</span>jar<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\springcloud<span class="token operator">-</span>demo\study\target\classes<span class="token punctuation">;</span><span class="token class-name">D</span><span class="token operator">:</span>\work\maven\mavenstore\org\openjdk\jol\jol<span class="token operator">-</span>core\<span class="token number">0.9</span>\jol<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">0.9</span><span class="token punctuation">.</span>jar <span class="token class-name">ClassLoader<span class="token punctuation">.</span>TestClassLoader</span>
自定义的类加载器的父类加载器是：<span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Launcher</span>$<span class="token class-name">AppClassLoader</span><span class="token annotation punctuation">@18b4aac2</span>
类加载器是<span class="token operator">:</span><span class="token class-name">ClassLoader<span class="token punctuation">.</span>MyCloassLoader</span><span class="token annotation punctuation">@1540e19d</span>
<span class="token class-name">ClassLoader<span class="token punctuation">.</span>TestBean</span><span class="token punctuation">.</span><span class="token function">testMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span>

</code></pre> 
<ul><li>分析：</li></ul> 
<p>1、自定义的类加载器需要继承java.lang.ClassLoader，重写findClass方法。<br> 2、findClass方法的内容是加载指定路径下的class文件，将其转为字节数组，调用父类的defineClass方法将字节数组转为Class对象。<br> 3、通过测试类可以看出，自定义类加载器的父类加载器是sun.misc.Launcher$AppClassLoader。<br> 4、通过测试结果可以看出，自定义类加载器成功加载指定路径下的class文件，设计成功。</p> 
<p>参考博客<br> https://www.jianshu.com/p/1e4011617650<br> https://blog.csdn.net/huazai30000/article/details/85296671</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9ca099a85800e7e1c06d0d66082add3a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">004. 虚拟机常见配置：网络-防火墙-软件安装限制-关机</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/64883463b4bbce47915d3ca212c888c5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java NIO ServerSocketChannel与SocketChannel区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>