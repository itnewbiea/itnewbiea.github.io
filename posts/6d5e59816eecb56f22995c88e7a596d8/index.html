<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Ubuntu 22.04 安装ftp实现与windows文件互传 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Ubuntu 22.04 安装ftp实现与windows文件互传" />
<meta property="og:description" content="Ubuntu 22.04 安装ftp实现与windows文件互传 1、配置安装 安装：
sudo apt install vsftpd -y 使能开机自启：
sudo systemctl enable vsftpd 启动：
sudo systemctl start vsftpd 创建ftp工作目录：
sudo mkdir -p /home/ftp/uftp 创建一个用于ftp的工作用户uftp：
sudo useradd -d /home/ftp/uftp -m uftp 设置uftp的密码：
sudo passwd uftp 改变ftp工作目录的读写权限：
chmod -R 777 /home/ftp 修改ftp配置文件/etc/vsftpd.conf：
先备份一下原文件：
sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.bak 使用vi编辑器修改：
sudo vim /etc/vsftpd.conf 主要修改的有：
listen=YES listen_ipv6=NO chroot_local_user=YES \\去掉注释 在该文件默认增加：
userlist_deny=NO userlist_enable=YES userlist_file=/etc/allowed_users local_enable=YES write_enable=YES pasv_promiscuous=YES anonymous_enable=NO allow_writeable_chroot=YES 在/etc目录下创建文件allowed_users，该文件中是存储允许ftp登录的本地用户，直接执行以下命令，将我们刚才创建的uftp用户添加进这个文件：
echo uftp &gt;&gt; /etc/allowed_users 最后，重启vsftpd：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/6d5e59816eecb56f22995c88e7a596d8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-28T15:08:43+08:00" />
<meta property="article:modified_time" content="2023-12-28T15:08:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Ubuntu 22.04 安装ftp实现与windows文件互传</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Ubuntu_2204_ftpwindows_0"></a>Ubuntu 22.04 安装ftp实现与windows文件互传</h2> 
<hr> 
<h4><a id="1_4"></a>1、配置安装</h4> 
<p>安装：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> vsftpd <span class="token parameter variable">-y</span>
</code></pre> 
<p>使能开机自启：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> vsftpd 
</code></pre> 
<p>启动：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl start vsftpd
</code></pre> 
<p>创建ftp工作目录：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /home/ftp/uftp
</code></pre> 
<p>创建一个用于ftp的工作用户uftp：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">useradd</span> <span class="token parameter variable">-d</span> /home/ftp/uftp <span class="token parameter variable">-m</span> uftp
</code></pre> 
<p>设置uftp的密码：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">passwd</span> uftp
</code></pre> 
<p>改变ftp工作目录的读写权限：</p> 
<pre><code class="prism language-bash"><span class="token function">chmod</span> <span class="token parameter variable">-R</span> <span class="token number">777</span> /home/ftp
</code></pre> 
<p>修改ftp配置文件<code>/etc/vsftpd.conf</code>：</p> 
<p>先备份一下原文件：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">cp</span> /etc/vsftpd.conf /etc/vsftpd.conf.bak
</code></pre> 
<p>使用vi编辑器修改：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/vsftpd.conf
</code></pre> 
<p>主要修改的有：</p> 
<pre><code class="prism language-bash"><span class="token assign-left variable">listen</span><span class="token operator">=</span>YES
<span class="token assign-left variable">listen_ipv6</span><span class="token operator">=</span>NO
<span class="token assign-left variable">chroot_local_user</span><span class="token operator">=</span>YES   <span class="token punctuation">\</span><span class="token punctuation">\</span>去掉注释
</code></pre> 
<p>在该文件默认增加：</p> 
<pre><code class="prism language-bash"><span class="token assign-left variable">userlist_deny</span><span class="token operator">=</span>NO
<span class="token assign-left variable">userlist_enable</span><span class="token operator">=</span>YES
<span class="token assign-left variable">userlist_file</span><span class="token operator">=</span>/etc/allowed_users
<span class="token assign-left variable">local_enable</span><span class="token operator">=</span>YES
<span class="token assign-left variable">write_enable</span><span class="token operator">=</span>YES
<span class="token assign-left variable">pasv_promiscuous</span><span class="token operator">=</span>YES
<span class="token assign-left variable">anonymous_enable</span><span class="token operator">=</span>NO
<span class="token assign-left variable">allow_writeable_chroot</span><span class="token operator">=</span>YES 
</code></pre> 
<p>在/etc目录下创建文件allowed_users，该文件中是存储允许ftp登录的本地用户，直接执行以下命令，将我们刚才创建的uftp用户添加进这个文件：</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> uftp <span class="token operator">&gt;&gt;</span> /etc/allowed_users
</code></pre> 
<p>最后，重启vsftpd：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl restart vsftpd
</code></pre> 
<hr> 
<h4><a id="2_89"></a>2、测试验证</h4> 
<p>Windows端使用软件FileZilla：</p> 
<p><img src="https://images2.imgbox.com/51/2b/Mntva4gG_o.png" alt=""></p> 
<p>将文件或者文件夹上传到linux：</p> 
<p><img src="https://images2.imgbox.com/45/b7/Qocz1mwz_o.png" alt=""></p> 
<hr> 
<h4><a id="3_101"></a>3、补充说明</h4> 
<p><code>vsftpd.conf</code>配置文件说明：</p> 
<pre><code class="prism language-bash"><span class="token comment"># 示例配置文件，地址： /etc/vsftpd.conf</span>
<span class="token comment">#</span>
<span class="token comment"># vsftpd的默认编译设置比较谨慎，这个示例文件会放宽一些限制，使ftp服务更加易用。</span>
<span class="token comment"># 同时建议查看vsftpd.conf.5文件以了解所有编译默认值。</span>
<span class="token comment">#</span>
<span class="token comment"># 特别提醒：这个示例文件并不包含vsftpd选项的所有内容，建议阅读vsftpd.conf.5手册页以充分了解vsftpd的功能。</span>
<span class="token comment">#</span>
<span class="token comment">#</span>
<span class="token comment"># </span>
<span class="token comment"># 用来设置vsftpd是否以独立守护进程运行。</span>
<span class="token comment"># 如果设置为"listen=YES"，则表示vsftpd将作为独立守护进程运行；</span>
<span class="token comment"># 如果设置为"listen=NO"，则表示vsftpd将不会以独立守护进程运行，而是通过inetd或者initscript启动。</span>
<span class="token assign-left variable">listen</span><span class="token operator">=</span>NO
<span class="token comment">#</span>
<span class="token comment"># 设置vsftpd是否启用IPv6监听。</span>
<span class="token comment"># 如果设置为"listen_ipv6=YES"，则表示vsftpd将启用IPv6监听；</span>
<span class="token comment"># 如果设置为"listen_ipv6=NO"，则表示vsftpd将不会启用IPv6监听。</span>
<span class="token comment"># 默认情况下，IPv6监听地址为"::"，同时可以接受IPv6和IPv4客户端的连接。</span>
<span class="token comment"># 如果你只需要监听IPv4或IPv6地址，则不需要同时启用两种监听，如果你需要同时监听特定的IPv4和IPv6地址，则需要运行两个vsftpd实例，并使用两个不同的配置文件来进行配置。</span>
<span class="token assign-left variable">listen_ipv6</span><span class="token operator">=</span>YES
<span class="token comment">#</span>
<span class="token comment"># 设置是否允许匿名FTP登录。</span>
<span class="token assign-left variable">anonymous_enable</span><span class="token operator">=</span>NO
<span class="token comment">#</span>
<span class="token comment"># 设置是否允许本地用户登录FTP服务器。</span>
<span class="token assign-left variable">local_enable</span><span class="token operator">=</span>YES
<span class="token comment">#</span>
<span class="token comment"># 设置是否允许FTP用户执行写入操作。</span>
<span class="token comment"># write_enable=YES</span>
<span class="token comment">#</span>
<span class="token comment"># 设置本地用户的默认umask值。</span>
<span class="token comment"># umask是一个三位八进制数，用来控制新建文件或目录的访问权限。</span>
<span class="token comment"># 在FTP服务器中，local_umask选项用来设置本地用户上传文件或创建目录时的默认权限。</span>
<span class="token comment"># 默认情况下，local_umask的值为077，表示新建的文件或目录权限为只有所有者可读、可写、可执行，其他用户无权访问。</span>
<span class="token comment"># 如果你的用户希望默认权限为所有者可读、可写、可执行，其他用户可读、可执行，则可以将local_umask的值设置为022。</span>
<span class="token assign-left variable">local_umask</span><span class="token operator">=</span>022
<span class="token comment">#</span>
<span class="token comment"># 设置是否允许匿名FTP用户上传文件。</span>
<span class="token comment"># 如果将该选项的注释去掉（即将“#”删去），并将其值设置为YES，则表示允许匿名FTP用户上传文件。</span>
<span class="token comment"># 但是，这个选项只有在全局写入权限被激活时才会生效。此外，你还需要创建一个由FTP用户可写的目录，以便匿名FTP用户可以上传文件。</span>
<span class="token comment"># 需要注意的是，开启匿名FTP用户上传文件功能可能存在一定的安全风险，因此需要谨慎使用。</span>
<span class="token comment"># anon_upload_enable=YES</span>
<span class="token comment">#</span>
<span class="token comment"># 设置是否允许匿名FTP用户创建新目录。</span>
<span class="token comment"># 如果将该选项的注释去掉（即将“#”删去），并将其值设置为YES，则表示允许匿名FTP用户创建新目录。</span>
<span class="token comment"># 需要注意的是，开启匿名FTP用户创建新目录功能可能存在一定的安全风险，因此需要谨慎使用。</span>
<span class="token comment"># anon_mkdir_write_enable=YES</span>
<span class="token comment">#</span>
<span class="token comment"># 这段配置文件是用来设置是否启用目录消息功能。</span>
<span class="token comment"># 如果设置为YES，则表示启用目录消息功能。当远程用户进入某个目录时，会显示该目录的消息。</span>
<span class="token assign-left variable">dirmessage_enable</span><span class="token operator">=</span>YES
<span class="token comment">#</span>
<span class="token comment"># 设置是否启用本地时间功能。</span>
<span class="token comment"># 启用本地时间功能后，vsftpd将会在目录列表中显示本地时间而非GMT时间。</span>
<span class="token assign-left variable">use_localtime</span><span class="token operator">=</span>YES
<span class="token comment">#</span>
<span class="token comment"># 启用上传和下载日志记录功能。</span>
<span class="token comment"># 启用该功能后，vsftpd会记录每个用户的上传和下载操作，并将其记录到指定的日志文件中。</span>
<span class="token assign-left variable">xferlog_enable</span><span class="token operator">=</span>YES
<span class="token comment">#</span>
<span class="token comment"># 设置数据传输的端口号。</span>
<span class="token comment"># 将其值设置为YES，则表示数据传输使用的端口号为20。</span>
<span class="token assign-left variable">connect_from_port_20</span><span class="token operator">=</span>YES
<span class="token comment">#</span>
<span class="token comment"># 设置匿名用户上传的文件的所有者。</span>
<span class="token comment"># 设置为YES，则表示上传的文件将会被转换为指定用户的所有权。</span>
<span class="token comment"># chown_uploads=YES</span>
<span class="token comment"># 设置为指定的用户名。</span>
<span class="token comment"># chown_username=whoever</span>
<span class="token comment">#</span>
<span class="token comment"># 设置vsftpd日志文件的路径。该路径必须具有可写权限，并且对于vsftpd进程来说，必须具有可访问权限。</span>
<span class="token comment"># xferlog_file=/var/log/vsftpd.log</span>
<span class="token comment">#</span>
<span class="token comment"># 设置vsftpd日志文件的格式。设备为YES则存储为标准ftpd xferlog格式。</span>
<span class="token comment"># xferlog_std_format=YES</span>
<span class="token comment">#</span>
<span class="token comment"># 设置vsftpd空闲会话超时的时间（以秒为单位）。</span>
<span class="token comment"># idle_session_timeout=600</span>
<span class="token comment">#</span>
<span class="token comment"># 设置vsftpd数据连接超时的时间（以秒为单位）。</span>
<span class="token comment"># data_connection_timeout=120</span>
<span class="token comment">#</span>
<span class="token comment"># vsftpd建议在系统中定义一个唯一的用户，供FTP服务器使用，作为完全隔离和无特权的用户。</span>
<span class="token comment"># nopriv_user选项可以用来指定该用户的用户名。</span>
<span class="token comment"># nopriv_user=ftpsecure</span>
<span class="token comment">#</span>
<span class="token comment"># 用于启用异步ABOR请求的识别。</span>
<span class="token comment"># 异步ABOR请求是一种FTP客户端请求，用于取消当前正在进行的数据传输操作。</span>
<span class="token comment"># 启用该选项可以提高FTP服务器的性能，但也会增加安全风险。因为异步ABOR请求的代码比较复杂，可能会被黑客利用进行恶意攻击。</span>
<span class="token comment"># 所以，如果安全性是首要考虑因素，则不建议启用该选项。</span>
<span class="token comment"># async_abor_enable=YES</span>
<span class="token comment">#</span>
<span class="token comment"># 用于控制FTP服务器是否启用ASCII模式下的文件转换功能。</span>
<span class="token comment"># 默认情况下，FTP服务器会假装允许ASCII模式，但实际上会忽略该请求。</span>
<span class="token comment"># 如果需要启用ASCII模式下的文件转换功能，则可以将ascii_upload_enable和ascii_download_enable选项的注释去掉，并将它们的值设置为YES。</span>
<span class="token comment"># 在ASCII模式下，FTP服务器会将文本文件中的换行符和回车符进行转换，以便在不同操作系统之间进行传输。</span>
<span class="token comment"># 但是，需要注意的是，ASCII模式下可能存在一些安全风险。例如，攻击者可以利用SIZE命令在ASCII模式下发送一个超大文件名，导致FTP服务器崩溃。</span>
<span class="token comment"># 因此，建议谨慎使用ASCII模式，并确保FTP服务器已经做好了相应的安全措施。</span>
<span class="token comment"># ascii_upload_enable=YES</span>
<span class="token comment"># ascii_download_enable=YES</span>
<span class="token comment">#</span>
<span class="token comment"># vsftpd的登录横幅的设置，你可以理解为登录成功后的欢迎词。</span>
<span class="token comment"># ftpd_banner=Welcome to blah FTP service.</span>
<span class="token comment">#</span>
<span class="token comment"># 设备是否拒绝匿名电子邮件地址</span>
<span class="token comment"># 有助于减轻利用匿名访问FTP服务器进行的拒绝服务（DoS）攻击。如果检测到被禁止的电子邮件地址，服务器将拒绝该用户的访问。</span>
<span class="token comment"># deny_email_enable=YES</span>
<span class="token comment"># 如果启用了拒绝匿名电子邮件地址的选项，则通过从指定的文件“/etc/vsftpd.banned_emails”读取被禁止的电子邮件地址列表。</span>
<span class="token comment"># banned_email_file=/etc/vsftpd.banned_emails</span>
<span class="token comment">#</span>
<span class="token comment"># 设备限制本地用户仅访问其home目录。</span>
<span class="token comment"># 如果启用，则本地用户将仅访问其home目录和其子目录，无法访问其他目录。</span>
<span class="token comment"># chroot_local_user=YES</span>
<span class="token comment">#</span>
<span class="token comment"># 是否允许本地用户，是否将本地用户限制在其主目录中，如果设置为YES，则不会将列在chroot_list_file中的用户限制在其主目录中。</span>
<span class="token comment"># chroot_local_user=YES</span>
<span class="token comment"># 是否启用chroot_list_file列表，用于指定哪些用户不应该被限制在主目录中。</span>
<span class="token comment"># chroot_list_enable=YES</span>
<span class="token comment"># 指定了chroot_list_file列表的路径和名称。一行一个用户名。</span>
<span class="token comment"># chroot_list_file=/etc/vsftpd.chroot_list</span>
<span class="token comment">#</span>
<span class="token comment"># 否启用ls命令的递归选项“-R”，该选项可以在列出目录内容时递归地列出子目录。</span>
<span class="token comment"># 默认情况下，该选项被禁用以避免远程用户在大型站点上引起过多的I/O。</span>
<span class="token comment"># ls_recurse_enable=YES</span>
<span class="token comment">#</span>
<span class="token comment"># 自定义配置：</span>
<span class="token comment">#</span>
<span class="token comment"># 指定了一个空目录作为安全chroot() jail。</span>
<span class="token comment"># 在某些情况下，vsftpd不需要访问文件系统，因此可以将FTP用户限制在这个空目录中，以增强安全性。该目录应该为空，并且不应该被FTP用户写入。</span>
<span class="token assign-left variable">secure_chroot_dir</span><span class="token operator">=</span>/var/run/vsftpd/empty
<span class="token comment">#</span>
<span class="token comment"># 指定vsftpd将使用的PAM服务的名称。</span>
<span class="token comment"># 默认情况下，pam_service_name的值为“vsftpd”，这意味着vsftpd将使用名为“vsftpd”的PAM服务来进行认证。</span>
<span class="token comment"># 如果需要使用其他的PAM服务，可以修改该选项的值。</span>
<span class="token assign-left variable">pam_service_name</span><span class="token operator">=</span>vsftpd
<span class="token comment">#</span>
<span class="token comment"># 用于指定在SSL加密连接中使用的RSA证书的位置。</span>
<span class="token comment"># 通过设置rsa_cert_file和rsa_private_key_file选项来指定RSA证书和私钥的位置。</span>
<span class="token comment"># 其中，rsa_cert_file选项用于指定证书文件的位置，而rsa_private_key_file选项用于指定私钥文件的位置。</span>
<span class="token assign-left variable">rsa_cert_file</span><span class="token operator">=</span>/etc/ssl/certs/ssl-cert-snakeoil.pem
<span class="token assign-left variable">rsa_private_key_file</span><span class="token operator">=</span>/etc/ssl/private/ssl-cert-snakeoil.key
<span class="token comment"># 是否启用SSL加密连接。</span>
<span class="token assign-left variable">ssl_enable</span><span class="token operator">=</span>NO
<span class="token comment">#</span>
<span class="token comment"># 指定是否在vsftpd中使用UTF-8编码的文件系统。</span>
<span class="token comment"># utf8_filesystem=YES</span>
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e8b0753b9e3749659c94f792b1f9b1b0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">内网穿透的应用-开源表格工具APITable本地部署结合内网穿透实现公网访问</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f4e073bbca9f024b1f0a32dd722654c4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">maven中dependencyManagement标签</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>