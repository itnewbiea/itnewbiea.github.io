<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>菜鸟学Linux命令:ssh命令 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="菜鸟学Linux命令:ssh命令" />
<meta property="og:description" content="转载自品略图书馆 http://www.pinlue.com/article/2020/04/1003/1210139769049.html
1、查看SSH客户端版本
有的时候需要确认一下SSH客户端及其相应的版本号。使用ssh -V命令可以得到版本号。需要注意的是，Linux一般自带的是OpenSSH: 下面的例子即表明该系统正在使用OpenSSH：
1
2
$ ssh -V
OpenSSH_3.9p1, OpenSSL 0.9.7a Feb 19 2003
下面的例子表明该系统正在使用SSH2：
1
2
$ ssh -V
ssh: SSH Secure Shell 3.2.9.1 (non-commercial version) on i686-pc-linux-gnu
2、连接到远程主机：
命令格式 ：
1
2
ssh name@remoteserver #或者
ssh remoteserver -l name
说明：以上两种方式都可以远程登录到远程主机，server代表远程主机，name为登录远程主机的用户名。
3、连接到远程主机指定的端口：
命令格式：
1
2
ssh name@remoteserver -p 2222 #或者
ssh remoteserver -l name -p 2222
说明：p 参数指定端口号，通常在路由里做端口映射时，我们不会把22端口直接映射出去，而是转换成其他端口号，这时就需要使用-p端口号命令格式。
4、通过远程主机1跳到远程主机2：
命令格式：
1
ssh -t remoteserver1 ssh remoteserver2" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8d8225404f3b74a9692d3d5066bf732e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-04-13T13:00:23+08:00" />
<meta property="article:modified_time" content="2020-04-13T13:00:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">菜鸟学Linux命令:ssh命令</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>转载自品略图书馆 <a href="http://www.pinlue.com/article/2020/04/1003/1210139769049.html" rel="nofollow">http://www.pinlue.com/article/2020/04/1003/1210139769049.html</a></p> 
<p> </p> 
<p>1、查看SSH客户端版本</p> 
<p>有的时候需要确认一下SSH客户端及其相应的版本号。使用ssh -V命令可以得到版本号。需要注意的是，Linux一般自带的是OpenSSH: 下面的例子即表明该系统正在使用OpenSSH：</p> 
<p>1</p> 
<p>2</p> 
<p>$ ssh -V</p> 
<p>OpenSSH_3.9p1, OpenSSL 0.9.7a Feb 19 2003</p> 
<p>下面的例子表明该系统正在使用SSH2：</p> 
<p>1</p> 
<p>2</p> 
<p>$ ssh -V</p> 
<p>ssh: SSH Secure Shell 3.2.9.1 (non-commercial version) on i686-pc-linux-gnu</p> 
<p>2、连接到远程主机：</p> 
<p>命令格式 ：</p> 
<p>1</p> 
<p>2</p> 
<p>ssh name@remoteserver #或者</p> 
<p>ssh remoteserver -l name</p> 
<p>说明：以上两种方式都可以远程登录到远程主机，server代表远程主机，name为登录远程主机的用户名。</p> 
<p>3、连接到远程主机指定的端口：</p> 
<p>命令格式：</p> 
<p>1</p> 
<p>2</p> 
<p>ssh name@remoteserver -p 2222 #或者</p> 
<p>ssh remoteserver -l name -p 2222</p> 
<p>说明：p 参数指定端口号，通常在路由里做端口映射时，我们不会把22端口直接映射出去，而是转换成其他端口号，这时就需要使用-p端口号命令格式。</p> 
<p>4、通过远程主机1跳到远程主机2：</p> 
<p>命令格式：</p> 
<p>1</p> 
<p>ssh -t remoteserver1 ssh remoteserver2</p> 
<p>说明：当远程主机remoteserver2无法直接到达时，可以使用-t参数，然后由remoteserver1跳转到remoteserver2。在此过程中要先输入remoteserver1的密码，然后再输入remoteserver2的密码，然后就可以操作remoteserver2了。</p> 
<p>5、通过SSH运行远程shell命令：</p> 
<p>命令格式：</p> 
<p>1</p> 
<p>ssh -l name remoteserver ‘command'</p> 
<p>说明：连接到远程主机，并执行远程主机的command命令。例如：查看远程主机的内存使用情况。</p> 
<p>1</p> 
<p>$ ssh -l root 192.168.1.100 svmon -G</p> 
<p>6、修改SSH监听端口：</p> 
<p>默认情况下，SSH监听连接端口22，攻击者使用端口扫描软件就可以看到主机是否运行有SSH服务，将SSH端口修改为大于1024的端口是一个明智的选择，因为大多数端口扫描软件（包括nmap）默认情况都不扫描高位端口。打开/etc/ssh/sshd_config文件并查找下面这样的行：</p> 
<p>Port 22</p> 
<p>去掉该行前面的# 号，然后修改端口号并重新启动SSH服务：</p> 
<p>1</p> 
<p>$ /etc/init.d/ssh restart</p> 
<p>7、仅允许SSH协议版本2：</p> 
<p>有两个SSH协议版本，仅使用SSH协议版本2会更安全，SSH协议版本1有安全问题，包括中间人攻击（man-in-the-middle）和注入（insertion）攻击。编辑/etc/ssh/sshd_config文件并查找下面这样的行：</p> 
<p>1</p> 
<p>2</p> 
<p>3</p> 
<p># Protocol 2，1</p> 
<p>修改为</p> 
<p>Protocol 2</p> 
<p>8、禁止root用户登录：</p> 
<p>通常情况下，不采用直接用root用户登录到远程主机，由于root用户拥有超级权限，这样会带来安全隐患，所以，一般我们用普通用户登录，当需要管理远程主机时，再切换到root用户下。打开/etc/ssh/sshd_config文件并查找下面这样的行：</p> 
<p>1</p> 
<p>#PermitRootLogin yes</p> 
<p>将#号去掉，然后将yes修改成no，重启ssh服务，这样就可以禁止root用户登录。</p> 
<p>将#号去掉，然后将bannertest.txt文件的全路径替换/some/path，然后保存，重启ssh服务。当客户端登录时，就会看到bannertest.txt文件中的提示信息。</p> 
<p>9、进行端口映射：</p> 
<p>假如公司内网有台web服务器，但是只对内不对外，这样，外网就无法访问，可以用ssh进行端口映射来实现外网访问内网的web服务器。假如web服务器名为webserver，webserver可以用ssh访问到远端主机remoteserver，登录到webserver，然后用下面命令进行映射</p> 
<p>命令格式：</p> 
<p>1</p> 
<p>ssh -R 3000:localhost:80 remoteserver</p> 
<p>执行完成后，在remoteserver机器上，执行netstat -an | grep 3000，查看有没有开通3000端口。并执行以下命令观察是否可以打开webserver上的网页</p> 
<p>1</p> 
<p>$ w3m http://127.0.0.1:3000</p> 
<p>如果能打开界面，说明映射成功.但是，这只限于本机访问web服务器，即只能remoteserver机器访问webserver。因为3000端口绑定的是remoteserver机器的127.0.0.1端口。可以编辑remoteserver机器上的/etc/ssh/sshd_config文件并添加如下内容：</p> 
<p>添加 GatewayPorts yes 内容，把监听端口3000绑定到 0.0.0.0 地址上，这样外部的所有机器都能访问到这个监听端口，然后保存退出。并重启ssh服务。完成后其它机器就可以在浏览器中输入 http://remoteserver:3000来访问webserver了。</p> 
<p>10、设置登录时提示信息</p> 
<p>首先编辑一个文件，如bannertest.txt，文件内容自行定义。然后打开/etc/ssh/sshd_config文件并查找下面这样的行：</p> 
<p>1</p> 
<p>#Banner /some/path</p> 
<p>以上就是本文的全部内容，希望对大家的学习有所帮助</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/326094bd2b341e90a12bfb80c4805774/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python3.7 安装dlib和face_recognition</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b427ce2bca512f65354118f94f183e54/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java项目和Web项目的区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>