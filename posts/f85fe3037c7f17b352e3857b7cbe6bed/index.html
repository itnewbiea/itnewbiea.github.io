<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>人鼠基因同源转换 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="人鼠基因同源转换" />
<meta property="og:description" content="工具：R语言biomaRt包
生物学背景：同源，最基本的意义就是具有共同祖先。当然这里不是说人和鼠有相同的祖先，我们这里的分子水平的同源性。从分子水平讲则是指两个核酸分子的核苷酸序列或两个蛋白质分子的氨基酸序列间的相似程度，那我们就说二者同源，就是说可以相互转化的基因具有一定的序列相似性，那么二者的基因便可以成为同源基因。许多不同的物种间都具有同源性。现代分子生物学中的同源性描述的是基因与基因之间相似关系，它表明的是两个相比较的序列之间的匹配程度。一般来说，如果两条基因序列相似性达80% ，就可以把它们称为“同源基因(homologousgene)”。
安装biomaRt包 install.packages(&#34;BiocManager&#34;) BiocManager::install(&#34;biomaRt&#34;) 选择目标数据库和数据集（人和小鼠） library(biomaRt) human=useMart(&#34;ensembl&#34;,dataset=&#34;hsapiens_gene_ensembl&#34;) class(human) mouse=useMart(&#34;ensembl&#34;,dataset=&#34;mmusculus_gene_ensembl&#34;) class(mouse) #useMart一般跟两个参数，第一个借助ensemble数据库，第二个参数是选择的物种数据集
构造测试基因集 genes=c(&#34;Tmx2&#34;,&#34;Trp53&#34;,&#34;Zfp286&#34;) 小鼠基因同源映射到人 genes=getLDS(attributes=c(&#34;mgi_symbol&#34;),filters=&#34;mgi_symbol&#34;, values=genes,mart=mouse, attributesL=c(&#34;hgnc_symbol&#34;,&#34;chromosome_name&#34;,&#34;start_position&#34;,&#34;end_position&#34;), martL=human, uniqueRows=T) #attributes指所要检索数据集的属性参数,可用listAttributes函数检索属性列表
#values指构造的数据集（即输入的数据集）
#mart指输入数据的对象（如mouse）
#attributesL指需要转化的目标数据集
#martL指输出的对象（如human）
结果如下
写一个简单的封装函数并测试 transMG&lt;-function(x){ require(&#34;biomaRt&#34;) human=useMart(&#34;ensembl&#34;,dataset=&#34;hsapiens_gene_ensembl&#34;) mouse=useMart(&#34;ensembl&#34;,dataset=&#34;mmusculus_gene_ensembl&#34;) gs=getLDS(attributes=c(&#34;mgi_symbol&#34;),filters=&#34;mgi_symbol&#34;, values=x,mart=mouse, attributesL=c(&#34;hgnc_symbol&#34;),martL=human,uniqueRows=T) return(gs)	} transMG(genes) 结果如下
人转小鼠基因同理 genes1=c(&#34;TMX2&#34;,&#34;TP53&#34;,&#34;ZNF286A&#34;,&#34;EGF&#34;) transHG&lt;-function(x){ require(&#34;biomaRt&#34;) human=useMart(&#34;ensembl&#34;,dataset=&#34;hsapiens_gene_ensembl&#34;) mouse=useMart(&#34;ensembl&#34;,dataset=&#34;mmusculus_gene_ensembl&#34;) gs1=getLDS(attributes=c(&#34;hgnc_symbol&#34;),filters=&#34;hgnc_symbol&#34;, values=x,mart=human, attributesL=c(&#34;mgi_symbol&#34;),martL=mouse,uniqueRows=T) return(gs1)	} transHG(genes1) 结果如下
以上，就是跨物种基因同源转换的方法之一，biomaRt包用起来真的很方便，不过在转换的时候可能会出现一对多的现象。
参考：https://www.jianshu.com/p/96039fc8f4eb" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/f85fe3037c7f17b352e3857b7cbe6bed/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-11T17:05:49+08:00" />
<meta property="article:modified_time" content="2021-09-11T17:05:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">人鼠基因同源转换</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>工具：R语言biomaRt包</strong><br> <strong>生物学背景：<strong>同源，最基本的意义就是具有共同祖先。当然这里不是说人和鼠有相同的祖先，我们这里的</strong>分子水平的同源性</strong>。从分子水平讲则是指<strong>两个核酸分子的核苷酸序列或两个蛋白质分子的氨基酸序列间的相似程度</strong>，那我们就说二者同源，就是说<strong>可以相互转化的基因具有一定的序列相似性，那么二者的基因便可以成为同源基因</strong>。许多不同的物种间都具有同源性。现代分子生物学中的同源性描述的是基因与基因之间相似关系，它表明的是<strong>两个相比较的序列之间的匹配程度</strong>。一般来说，如果<strong>两条基因序列相似性达80% ，就可以把它们称为“同源基因(homologousgene)”</strong>。</p> 
<ul><li><strong>安装biomaRt包</strong></li></ul> 
<pre><code class="prism language-r">install.packages<span class="token punctuation">(</span><span class="token string">"BiocManager"</span><span class="token punctuation">)</span>
BiocManager<span class="token operator">::</span>install<span class="token punctuation">(</span><span class="token string">"biomaRt"</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li><strong>选择目标数据库和数据集（人和小鼠）</strong></li></ul> 
<pre><code class="prism language-r">library<span class="token punctuation">(</span>biomaRt<span class="token punctuation">)</span>
human<span class="token operator">=</span>useMart<span class="token punctuation">(</span><span class="token string">"ensembl"</span><span class="token punctuation">,</span>dataset<span class="token operator">=</span><span class="token string">"hsapiens_gene_ensembl"</span><span class="token punctuation">)</span>
class<span class="token punctuation">(</span>human<span class="token punctuation">)</span>
mouse<span class="token operator">=</span>useMart<span class="token punctuation">(</span><span class="token string">"ensembl"</span><span class="token punctuation">,</span>dataset<span class="token operator">=</span><span class="token string">"mmusculus_gene_ensembl"</span><span class="token punctuation">)</span>
class<span class="token punctuation">(</span>mouse<span class="token punctuation">)</span> 
</code></pre> 
<p>#useMart一般跟两个参数，第一个借助ensemble数据库，第二个参数是选择的物种数据集</p> 
<ul><li><strong>构造测试基因集</strong></li></ul> 
<pre><code class="prism language-r">genes<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"Tmx2"</span><span class="token punctuation">,</span><span class="token string">"Trp53"</span><span class="token punctuation">,</span><span class="token string">"Zfp286"</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li><strong>小鼠基因同源映射到人</strong></li></ul> 
<pre><code class="prism language-r">genes<span class="token operator">=</span>getLDS<span class="token punctuation">(</span>attributes<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"mgi_symbol"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>filters<span class="token operator">=</span><span class="token string">"mgi_symbol"</span><span class="token punctuation">,</span>
             values<span class="token operator">=</span>genes<span class="token punctuation">,</span>mart<span class="token operator">=</span>mouse<span class="token punctuation">,</span>
			 attributesL<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"hgnc_symbol"</span><span class="token punctuation">,</span><span class="token string">"chromosome_name"</span><span class="token punctuation">,</span><span class="token string">"start_position"</span><span class="token punctuation">,</span><span class="token string">"end_position"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			 martL<span class="token operator">=</span>human<span class="token punctuation">,</span>
			 uniqueRows<span class="token operator">=</span>T<span class="token punctuation">)</span>
</code></pre> 
<p>#attributes指所要检索数据集的属性参数,可用listAttributes函数检索属性列表<br> #values指构造的数据集（即输入的数据集）<br> #mart指输入数据的对象（如mouse）<br> #attributesL指需要转化的目标数据集<br> #martL指输出的对象（如human）</p> 
<p><em>结果如下</em><br> <img src="https://images2.imgbox.com/6d/a5/tMSIstms_o.png" alt="在这里插入图片描述"></p> 
<ul><li><strong>写一个简单的封装函数并测试</strong></li></ul> 
<pre><code class="prism language-r">transMG<span class="token operator">&lt;-</span><span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
require<span class="token punctuation">(</span><span class="token string">"biomaRt"</span><span class="token punctuation">)</span>
human<span class="token operator">=</span>useMart<span class="token punctuation">(</span><span class="token string">"ensembl"</span><span class="token punctuation">,</span>dataset<span class="token operator">=</span><span class="token string">"hsapiens_gene_ensembl"</span><span class="token punctuation">)</span>
mouse<span class="token operator">=</span>useMart<span class="token punctuation">(</span><span class="token string">"ensembl"</span><span class="token punctuation">,</span>dataset<span class="token operator">=</span><span class="token string">"mmusculus_gene_ensembl"</span><span class="token punctuation">)</span>
gs<span class="token operator">=</span>getLDS<span class="token punctuation">(</span>attributes<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"mgi_symbol"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>filters<span class="token operator">=</span><span class="token string">"mgi_symbol"</span><span class="token punctuation">,</span>
             values<span class="token operator">=</span>x<span class="token punctuation">,</span>mart<span class="token operator">=</span>mouse<span class="token punctuation">,</span>
			 attributesL<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"hgnc_symbol"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>martL<span class="token operator">=</span>human<span class="token punctuation">,</span>uniqueRows<span class="token operator">=</span>T<span class="token punctuation">)</span>
return<span class="token punctuation">(</span>gs<span class="token punctuation">)</span>		 
<span class="token punctuation">}</span>
transMG<span class="token punctuation">(</span>genes<span class="token punctuation">)</span>
</code></pre> 
<p><em>结果如下</em><br> <img src="https://images2.imgbox.com/68/f5/cnfcEROe_o.png" alt="在这里插入图片描述"></p> 
<ul><li><strong>人转小鼠基因同理</strong></li></ul> 
<pre><code class="prism language-r">genes1<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"TMX2"</span><span class="token punctuation">,</span><span class="token string">"TP53"</span><span class="token punctuation">,</span><span class="token string">"ZNF286A"</span><span class="token punctuation">,</span><span class="token string">"EGF"</span><span class="token punctuation">)</span>
transHG<span class="token operator">&lt;-</span><span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
require<span class="token punctuation">(</span><span class="token string">"biomaRt"</span><span class="token punctuation">)</span>
human<span class="token operator">=</span>useMart<span class="token punctuation">(</span><span class="token string">"ensembl"</span><span class="token punctuation">,</span>dataset<span class="token operator">=</span><span class="token string">"hsapiens_gene_ensembl"</span><span class="token punctuation">)</span>
mouse<span class="token operator">=</span>useMart<span class="token punctuation">(</span><span class="token string">"ensembl"</span><span class="token punctuation">,</span>dataset<span class="token operator">=</span><span class="token string">"mmusculus_gene_ensembl"</span><span class="token punctuation">)</span>
gs1<span class="token operator">=</span>getLDS<span class="token punctuation">(</span>attributes<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"hgnc_symbol"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>filters<span class="token operator">=</span><span class="token string">"hgnc_symbol"</span><span class="token punctuation">,</span>
             values<span class="token operator">=</span>x<span class="token punctuation">,</span>mart<span class="token operator">=</span>human<span class="token punctuation">,</span>
			 attributesL<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"mgi_symbol"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>martL<span class="token operator">=</span>mouse<span class="token punctuation">,</span>uniqueRows<span class="token operator">=</span>T<span class="token punctuation">)</span>
return<span class="token punctuation">(</span>gs1<span class="token punctuation">)</span>		 
<span class="token punctuation">}</span>
transHG<span class="token punctuation">(</span>genes1<span class="token punctuation">)</span> 
</code></pre> 
<p><em>结果如下</em><br> <img src="https://images2.imgbox.com/33/76/3ywMRyKU_o.png" alt="在这里插入图片描述"><br> 以上，就是跨物种基因同源转换的方法之一，biomaRt包用起来真的很方便，不过在转换的时候可能会出现一对多的现象。<br> 参考：https://www.jianshu.com/p/96039fc8f4eb</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1a148c8f3628252edefeacb5826001fa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【工具介绍】fastcopy的下载与使用方法，可用于硬盘对拷</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3d976fb26c9692b49723a6a26cfaa31d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java异步编排 2021-09-11</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>