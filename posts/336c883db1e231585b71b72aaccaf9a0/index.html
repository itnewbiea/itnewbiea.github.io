<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>QNAP&#43;Transmission - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="QNAP&#43;Transmission" />
<meta property="og:description" content="文章目录 QNAP&#43;Transmission目标硬件及系统安装 Transmission安装 Transmission Web Control启动 Transmission登录 Transmission配置 Transmission自定义限速时间修改Transmission Web 端口号使transmission 端口测试显示开启问题描述错误原因解决办法： 利用反向代理配置HTTPS访问ssl 证书验证问题 QNAP&#43;Transmission 目标 在QNAP的TS-453Dmini上安装Transmission并进行设置。
硬件及系统 QNAP的TS-453Dmini8G内存QTS 5.1.0.1986(2022/03/24)
安装 Transmission 下载：从QNAP商店下载架构为TS-NASX86_64的安装包QTransmission3_3.0.0.2_x86_64.qpkg；1安装：QTS的APPCenter，点击右上角的手动安装，通过浏览选定刚刚下载的qpkg文件后点击安装，等待安装完成。2 安装 Transmission Web Control 下载：从QNAP商店下载架构为TS-NASX86_64的安装包TransmissionWC_1.6.1_x86_64.qpk；1安装：QTS的APPCenter，点击右上角的手动安装，通过浏览选定刚刚下载的qpkg文件后点击安装，等待安装完成。2 启动 Transmission 在QTS中启动Transmission 和 Transmission web control。
登录 Transmission 在QTS中点击左上角的主菜单(三条横线)图标，找到Transmission，单击打开，或者也可以直接通过网址nas ip:49092 打开，用户名和密码均为qnap。
配置 Transmission 启用QTS的ssh连接：主菜单&gt;&gt;控制台&gt;&gt;网络文件服务&gt;&gt;Telnet/SSH，勾选允许SSH连接（只有管理员群组可远程登陆）后点击应用；建立 SSH 连接：通过CMD或专门的ssh连接管理软件，例如 finalshell，远程连接 QTS；停止运行transmission；使用vim 打开配置文件： sudo vim /share/CACHEDEV1_DATA/.qpkg/QTransmission3/etc/settings.json 其中各参数含义如下，注意：json 并不支持注释，下文代码块中的 #注释只是为了方便说明3
{ &#34;alt-speed-down&#34;: 50, # 限速时段下载限速值 &#34;alt-speed-enabled&#34;: false, &#34;alt-speed-time-begin&#34;: 540, &#34;alt-speed-time-day&#34;: 127, # 时段限速日期（星期几），127 表示每天， # 更复杂配置参考官网。用 7 位二进制数表示，然后转换成十进制数， # 0000001 表示周日，1000000 表示周六，0000010 表示周一， # 0000100 表示周二。如果你只要在周末限速，该数应该 1000001， # 转换为十进制就是 65 &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/336c883db1e231585b71b72aaccaf9a0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-05T11:08:47+08:00" />
<meta property="article:modified_time" content="2023-04-05T11:08:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">QNAP&#43;Transmission</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#QNAPTransmission_1" rel="nofollow">QNAP+Transmission</a></li><li><ul><li><a href="#_2" rel="nofollow">目标</a></li><li><a href="#_4" rel="nofollow">硬件及系统</a></li><li><a href="#_Transmission_9" rel="nofollow">安装 Transmission</a></li><li><a href="#_Transmission_Web_Control_12" rel="nofollow">安装 Transmission Web Control</a></li><li><a href="#_Transmission_16" rel="nofollow">启动 Transmission</a></li><li><a href="#_Transmission_19" rel="nofollow">登录 Transmission</a></li><li><a href="#_Transmission_22" rel="nofollow">配置 Transmission</a></li><li><a href="#_119" rel="nofollow">自定义限速时间</a></li><li><a href="#Transmission_Web__145" rel="nofollow">修改Transmission Web 端口号</a></li><li><a href="#transmission__200" rel="nofollow">使transmission 端口测试显示开启</a></li><li><ul><li><a href="#_201" rel="nofollow">问题描述</a></li><li><a href="#_203" rel="nofollow">错误原因</a></li><li><a href="#_223" rel="nofollow">解决办法：</a></li></ul> 
   </li><li><a href="#HTTPS_239" rel="nofollow">利用反向代理配置HTTPS访问</a></li><li><a href="#ssl__247" rel="nofollow">ssl 证书验证问题</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="QNAPTransmission_1"></a>QNAP+Transmission</h2> 
<h3><a id="_2"></a>目标</h3> 
<p>在<code>QNAP</code>的<code>TS-453Dmini</code>上安装<code>Transmission</code>并进行设置。</p> 
<h3><a id="_4"></a>硬件及系统</h3> 
<ul><li><code>QNAP</code>的<code>TS-453Dmini</code></li><li>8G内存</li><li><code>QTS 5.1.0.1986(2022/03/24)</code><br> <img src="https://images2.imgbox.com/d5/20/1T841LIR_o.png" alt="QNAP TS-453Dmini" width="300" height="400"></li></ul> 
<h3><a id="_Transmission_9"></a>安装 Transmission</h3> 
<ol><li>下载：从<a href="https://qnapclub.eu/en/qpkg/976" rel="nofollow">QNAP商店</a>下载架构为<code>TS-NASX86_64</code>的安装包<a href="https://qnapclub.eu/en/qpkg/model/download/470568/QTransmission3_3.0.0.2_x86_64.qpkg" rel="nofollow">QTransmission3_3.0.0.2_x86_64.qpkg</a>；<sup class="footnote-ref"><a href="#fn1" rel="nofollow" id="fnref1">1</a></sup></li><li>安装：<code>QTS</code>的<code>APPCenter</code>，点击右上角的<code>手动安装</code>，通过<code>浏览</code>选定刚刚下载的<code>qpkg</code>文件后点击安装，等待安装完成。<sup class="footnote-ref"><a href="#fn2" rel="nofollow" id="fnref2">2</a></sup></li></ol> 
<h3><a id="_Transmission_Web_Control_12"></a>安装 Transmission Web Control</h3> 
<ol><li>下载：从<a href="https://qnapclub.eu/en/qpkg/984" rel="nofollow">QNAP商店</a>下载架构为<code>TS-NASX86_64</code>的安装包<a href="https://qnapclub.eu/en/qpkg/model/download/471645/TransmissionWC_1.6.1_x86_64.qpkg" rel="nofollow">TransmissionWC_1.6.1_x86_64.qpk</a>；<sup class="footnote-ref"><a href="#fn1" rel="nofollow" id="fnref1:1">1</a></sup></li><li>安装：<code>QTS</code>的<code>APPCenter</code>，点击右上角的<code>手动安装</code>，通过<code>浏览</code>选定刚刚下载的<code>qpkg</code>文件后点击安装，等待安装完成。<sup class="footnote-ref"><a href="#fn2" rel="nofollow" id="fnref2:1">2</a></sup></li></ol> 
<h3><a id="_Transmission_16"></a>启动 Transmission</h3> 
<p>在<code>QTS</code>中启动<code>Transmission</code> 和 <code>Transmission web control</code>。</p> 
<h3><a id="_Transmission_19"></a>登录 Transmission</h3> 
<p>在<code>QTS</code>中点击左上角的<code>主菜单</code>(三条横线)图标，找到<code>Transmission</code>，单击打开，或者也可以直接通过网址<code>nas ip:49092</code> 打开，用户名和密码均为<code>qnap</code>。</p> 
<h3><a id="_Transmission_22"></a>配置 Transmission</h3> 
<ol><li>启用<code>QTS</code>的<code>ssh</code>连接：<code>主菜单</code>&gt;&gt;<code>控制台</code>&gt;&gt;<code>网络文件服务</code>&gt;&gt;<code>Telnet/SSH</code>，勾选<code>允许SSH连接（只有管理员群组可远程登陆）</code>后点击应用；</li><li>建立 <code>SSH</code> 连接：通过<code>CMD</code>或专门的<code>ssh</code>连接管理软件，例如 <a href="https://www.hostbuf.com/" rel="nofollow">finalshell</a>，远程连接 <code>QTS</code>；</li><li>停止运行<code>transmission</code>；</li><li>使用<code>vim</code> 打开配置文件：</li></ol> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /share/CACHEDEV1_DATA/.qpkg/QTransmission3/etc/settings.json
</code></pre> 
<p>其中各参数含义如下，注意：<strong>json 并不支持注释，下文代码块中的 #注释只是为了方便说明</strong><sup class="footnote-ref"><a href="#fn3" rel="nofollow" id="fnref3">3</a></sup></p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"alt-speed-down"</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>  # 限速时段下载限速值
    <span class="token string-property property">"alt-speed-enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  
    <span class="token string-property property">"alt-speed-time-begin"</span><span class="token operator">:</span> <span class="token number">540</span><span class="token punctuation">,</span>
    <span class="token string-property property">"alt-speed-time-day"</span><span class="token operator">:</span> <span class="token number">127</span><span class="token punctuation">,</span>  # 时段限速日期（星期几），<span class="token number">127</span> 表示每天，
    # 更复杂配置参考官网。用 <span class="token number">7</span> 位二进制数表示，然后转换成十进制数，
    # <span class="token number">0000001</span> 表示周日，<span class="token number">1000000</span> 表示周六，<span class="token number">0000010</span> 表示周一，
    # <span class="token number">0000100</span> 表示周二。如果你只要在周末限速，该数应该 <span class="token number">1000001</span>，
    # 转换为十进制就是 <span class="token number">65</span>
    <span class="token string-property property">"alt-speed-time-enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> # 启用限速，为 <span class="token boolean">false</span> 时，以上计划配置则不生效，
    # 生效时会自动禁用 alt<span class="token operator">-</span>speed<span class="token operator">-</span>enabled 配置，二者只能选一个
    <span class="token string-property property">"alt-speed-time-end"</span><span class="token operator">:</span> <span class="token number">1020</span><span class="token punctuation">,</span>  # 限速时段结束时间，这个配置表示的是凌晨零点到
    # 开始时间的分钟数，比如 <span class="token number">7</span><span class="token operator">:</span><span class="token number">00</span><span class="token punctuation">(</span>nas系统里的时间<span class="token punctuation">)</span> 就是 <span class="token number">7</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">=</span><span class="token number">420</span>。
    <span class="token string-property property">"alt-speed-up"</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>  # 限速时段上传限速值，单位<span class="token constant">KB</span><span class="token operator">/</span><span class="token constant">S</span>
    <span class="token string-property property">"bind-address-ipv4"</span><span class="token operator">:</span> <span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span>  # IPv4 地址绑定，一般不要改动
    <span class="token string-property property">"bind-address-ipv6"</span><span class="token operator">:</span> <span class="token string">"::"</span><span class="token punctuation">,</span>  #IPv6 地址绑定，一般不要改动
    <span class="token string-property property">"blocklist-enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  # 启动白名单，默认不启动，需要启动改为 <span class="token boolean">true</span>
    <span class="token string-property property">"blocklist-url"</span><span class="token operator">:</span> <span class="token string">"http://www.example.com/blocklist"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"cache-size-mb"</span><span class="token operator">:</span> <span class="token number">1024</span><span class="token punctuation">,</span>  #缓存大小，以 <span class="token constant">MB</span> 为单位，建议设大一些，
    # 避免频繁读写硬盘而伤硬盘，建议设为内存大小的 <span class="token number">1</span><span class="token operator">/</span><span class="token number">6</span>～<span class="token number">1</span><span class="token operator">/</span><span class="token number">4</span>
    <span class="token string-property property">"dht-enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  #关闭 <span class="token constant">DHT</span>（不通过 tracker 寻找节点）功能，
    # 不少 <span class="token constant">PT</span> 站的要求，但 <span class="token constant">BT</span> 下载设置为 <span class="token boolean">true</span> 会使得下载更好
    <span class="token string-property property">"download-dir"</span><span class="token operator">:</span> <span class="token string">"/share/Public"</span><span class="token punctuation">,</span>  #下载的内容存放的目录
    <span class="token string-property property">"download-queue-enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  # 下载队列开关
    <span class="token string-property property">"download-queue-size"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>  # 下载队列数量
    <span class="token string-property property">"encryption"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  # 加密。指定节点的加密模式，默认 <span class="token number">1</span>。
    # <span class="token number">0</span> 表示关闭 <span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">=</span> 不加密，<span class="token number">1</span><span class="token operator">=</span> 优先加密，<span class="token number">2</span><span class="token operator">=</span> 必须加密
    <span class="token string-property property">"idle-seeding-limit"</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
    <span class="token string-property property">"idle-seeding-limit-enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">"incomplete-dir"</span><span class="token operator">:</span> <span class="token string">"/share/Public"</span><span class="token punctuation">,</span>  # 临时文件路径
    <span class="token string-property property">"incomplete-dir-enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> 
    <span class="token string-property property">"lpd-enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  #禁用 <span class="token constant">LDP</span>（本地节点发现，用于在本地网络寻找节点）<span class="token punctuation">,</span> 不少 <span class="token constant">PT</span> 站的要求
    <span class="token string-property property">"message-level"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token string-property property">"peer-congestion-algorithm"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token string-property property">"peer-id-ttl-hours"</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token string-property property">"peer-limit-global"</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>  # 全局连接数
    <span class="token string-property property">"peer-limit-per-torrent"</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>  # 每个种子最多的连接数
    <span class="token string-property property">"peer-port"</span><span class="token operator">:</span> <span class="token number">51413</span><span class="token punctuation">,</span>  # 传入端口，预设的 port 口
    <span class="token string-property property">"peer-port-random-high"</span><span class="token operator">:</span> <span class="token number">65535</span><span class="token punctuation">,</span>  # 传入端口随机值范围上限
    <span class="token string-property property">"peer-port-random-low"</span><span class="token operator">:</span> <span class="token number">49152</span><span class="token punctuation">,</span>  # 传入端口随机值范围下限
    <span class="token string-property property">"peer-port-random-on-start"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  # 启用随机端口，默认关闭，不建议改为 <span class="token boolean">true</span>
    <span class="token string-property property">"peer-socket-tos"</span><span class="token operator">:</span> <span class="token string">"default"</span><span class="token punctuation">,</span>  
    <span class="token string-property property">"pex-enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> # 是否启用用户交换，默认为 <span class="token boolean">true</span>，关于 <span class="token constant">PEX</span>，
    # 有兴趣的朋友可参考 http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>en<span class="token punctuation">.</span>wikipedia<span class="token punctuation">.</span>org<span class="token operator">/</span>wiki<span class="token operator">/</span>Peer_exchange，对于只用 <span class="token constant">PT</span> 的朋友，
    # 可以设为 <span class="token boolean">false</span><span class="token punctuation">,</span> 禁用 <span class="token constant">PEX</span>（节点交换，用于同已与您相连接的节点交换节点名单）<span class="token punctuation">,</span> 不少 <span class="token constant">PT</span> 站的要求
    <span class="token string-property property">"port-forwarding-enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  # 启用端口转发（uPnP），如果路由支持并且也开启了 uPnP，
    # 则路由会自动做端口映射，但是需要注意的是如果内网有几台机器同时使用 transmission，
    # 就必须更改 peer<span class="token operator">-</span>port 值为不一样
    <span class="token string-property property">"preallocation"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  # 预分配文件磁盘空间，<span class="token number">0</span><span class="token operator">=</span> 关闭，<span class="token number">1</span><span class="token operator">=</span> 快速，<span class="token number">2</span><span class="token operator">=</span> 完全。
    # 建议取 <span class="token number">1</span> 开启该功能，防止下载大半了才发现磁盘不够。取 <span class="token number">2</span> 时，可以减少磁盘碎片，但速度较慢。
    <span class="token string-property property">"prefetch-enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">"queue-stalled-enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string-property property">"queue-stalled-minutes"</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
    <span class="token string-property property">"ratio-limit"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  # 分享率限制
    <span class="token string-property property">"ratio-limit-enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  # 启用分享率限制，默认不启用
    <span class="token string-property property">"rename-partial-files"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  #在未完成的文件名后添加后缀<span class="token punctuation">.</span>part<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token operator">=</span> 禁用
    <span class="token string-property property">"rpc-authentication-required"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  # 远程控制需要验证，默认为需要
    <span class="token string-property property">"rpc-bind-address"</span><span class="token operator">:</span> <span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span>  # 远程控制地址绑定，允许 <span class="token constant">IP</span> 通过 <span class="token constant">RPC</span> 访问，
    # 默认值表示任何地址都可以访问
    <span class="token string-property property">"rpc-enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>   # 启用远程控制，默认启用
    <span class="token string-property property">"rpc-host-whitelist"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>  # 白名单，如果需要远程访问，最好配置
    <span class="token string-property property">"rpc-host-whitelist-enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  # 是否开启主机白名单
    <span class="token string-property property">"rpc-password"</span><span class="token operator">:</span> <span class="token string">"{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span><span class="token punctuation">,</span>  #web<span class="token operator">-</span>ui 的密码，可直接修改，
    # 重新运行或者 reload 服务的时候密码会自动 <span class="token constant">HASH</span> 增加安全性
    <span class="token string-property property">"rpc-port"</span><span class="token operator">:</span> <span class="token number">49092</span><span class="token punctuation">,</span>  # 默认 web<span class="token operator">-</span>ui 的 port 口，也是远程控制端口，可自行更改
    <span class="token string-property property">"rpc-url"</span><span class="token operator">:</span> <span class="token string">"/transmission/"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"rpc-username"</span><span class="token operator">:</span> <span class="token string">"qnap"</span><span class="token punctuation">,</span>  #默认登入名称，也是远程控制用户名<span class="token punctuation">,</span> 默认为 qnap
    <span class="token string-property property">"rpc-whitelist"</span><span class="token operator">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>  # 远程控制白名单，默认值为所有地址，支持通配符<span class="token operator">*</span>，如 <span class="token number">192.168</span><span class="token number">.2</span><span class="token punctuation">.</span><span class="token operator">*</span>
    <span class="token string-property property">"rpc-whitelist-enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">"scrape-paused-torrents-enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string-property property">"script-torrent-done-enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">"script-torrent-done-filename"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token string-property property">"seed-queue-enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">"seed-queue-size"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token string-property property">"speed-limit-down"</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>  #平时的下载限速，单位<span class="token constant">KB</span><span class="token operator">/</span>s
    <span class="token string-property property">"speed-limit-down-enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  #启用平时下载限速
    <span class="token string-property property">"speed-limit-up"</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>  #平时上传限速，单位<span class="token constant">KB</span><span class="token operator">/</span>s
    <span class="token string-property property">"speed-limit-up-enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  #启用平时上传限速
    <span class="token string-property property">"start-added-torrents"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string-property property">"trash-original-torrent-files"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">"umask"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token string-property property">"upload-slots-per-torrent"</span><span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token string-property property">"utp-enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string-property property">"watch-dir"</span><span class="token operator">:</span> <span class="token string">"/share/Public/torrent"</span><span class="token punctuation">,</span>  # 监听文件夹目录
    <span class="token string-property property">"watch-dir-enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span>  # 是否监听文件夹<span class="token punctuation">,</span>经测试无效
</code></pre> 
<h3><a id="_119"></a>自定义限速时间</h3> 
<p><strong>目标</strong>：每天定时（北京时间<code>20:00</code>–<code>23:59</code>）启动限速，上传限速<code>2500 KB/s</code>，下载限速<code>30000 KB/s</code>。<br> 注意：<strong>json 并不支持注释，下文代码块中的 #注释只是为了方便说明</strong></p> 
<pre><code class="prism language-json">    <span class="token string-property property">"alt-speed-up"</span><span class="token operator">:</span> <span class="token number">2500</span><span class="token punctuation">,</span>  # 限速时段上传限速值，单位<span class="token constant">KB</span><span class="token operator">/</span><span class="token constant">S</span>
    <span class="token string-property property">"alt-speed-down"</span><span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span>  # 限速时段下载限速值，单位<span class="token constant">KB</span><span class="token operator">/</span><span class="token constant">S</span>
    <span class="token string-property property">"alt-speed-enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  # 启用全局限速
    
    <span class="token string-property property">"alt-speed-time-day"</span><span class="token operator">:</span> <span class="token number">127</span><span class="token punctuation">,</span>  # 时段限速日期（星期几），<span class="token number">127</span> 表示每天，
    # 更复杂配置参考官网。用 <span class="token number">7</span> 位二进制数表示，然后转换成十进制数，
    # <span class="token number">0000001</span> 表示周日，<span class="token number">1000000</span> 表示周六，<span class="token number">0000010</span> 表示周一，
    # <span class="token number">0000100</span> 表示周二。如果你只要在周末限速，该数应该 <span class="token number">1000001</span>，
    # 转换为十进制就是 <span class="token number">65</span>
    <span class="token string-property property">"alt-speed-time-begin"</span><span class="token operator">:</span> <span class="token number">1200</span><span class="token punctuation">,</span>  # 北京时间<span class="token number">20</span>点，<span class="token number">20</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">=</span><span class="token number">1200</span>
    <span class="token string-property property">"alt-speed-time-end"</span><span class="token operator">:</span> <span class="token number">1439</span><span class="token punctuation">,</span>  # 北京时间<span class="token number">23</span>点<span class="token number">59</span>分，<span class="token number">24</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1439</span>
    # 限速时段结束时间，这个配置表示的是凌晨零点到
    # 开始时间的分钟数，比如 <span class="token number">7</span><span class="token operator">:</span><span class="token number">00</span> 就是 <span class="token number">7</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">=</span><span class="token number">420</span>。
    # 经测试，该时间将同 <span class="token constant">NAS</span> 当前时间直接进行比较，并不一定是 <span class="token constant">GMT</span> 时间！！！
    <span class="token string-property property">"alt-speed-time-enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> # 启用限速，为 <span class="token boolean">false</span> 时，以上计划配置则不生效，
    # <span class="token boolean">true</span> 表示开启自动限速，则在限速时间段内将会自动启动限速
    # 生效时会自动禁用 alt<span class="token operator">-</span>speed<span class="token operator">-</span>enabled 配置，二者只能选一个
</code></pre> 
<p><strong>效果</strong>：在限速时间段内：<br> <img src="https://images2.imgbox.com/3f/19/UaPzvbzJ_o.png" alt="Transmission alternative speeds" width="800"></p> 
<h3><a id="Transmission_Web__145"></a>修改Transmission Web 端口号</h3> 
<ol><li>启用<code>QTS</code>的<code>ssh</code>连接：<code>主菜单</code>&gt;&gt;<code>控制台</code>&gt;&gt;<code>网络文件服务</code>&gt;&gt;<code>Telnet/SSH</code>，勾选<code>允许SSH连接（只有管理员群组可远程登陆）</code>后点击应用；</li><li>建立 <code>SSH</code> 连接：通过<code>CMD</code>或专门的<code>ssh</code>连接管理软件，例如 <a href="https://www.hostbuf.com/" rel="nofollow">finalshell</a>，远程连接 <code>QTS</code>；</li><li>停止运行<code>Transmission</code>；</li><li>使用<code>vim</code> 打开配置文件：</li></ol> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /share/CACHEDEV1_DATA/.qpkg/QTransmission3/etc/settings.json
</code></pre> 
<ol start="5"><li>修改<code>rpc-port</code>：</li></ol> 
<pre><code class="prism language-json"><span class="token string-property property">"rpc-port"</span><span class="token operator">:</span> xxxxx<span class="token punctuation">,</span>  # 修改xxxxx为自己的端口号
</code></pre> 
<ol start="6"><li>使用<code>vim</code> 打开配置文件：</li></ol> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /mnt/HDA_ROOT/.config/qpkg.conf
</code></pre> 
<ol start="7"><li>定位至<code>Transmission</code>并修改：</li></ol> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>QTransmission3<span class="token punctuation">]</span>
Status <span class="token operator">=</span> complete
Name <span class="token operator">=</span> QTransmission3
Build <span class="token operator">=</span> <span class="token number">20200626</span>
Display_Name <span class="token operator">=</span> Transmission
Version <span class="token operator">=</span> <span class="token number">3.0</span>.0.2
Author <span class="token operator">=</span> QoolBox
QPKG_File <span class="token operator">=</span> QTransmission3.qpkg
Date <span class="token operator">=</span> <span class="token number">2022</span>-01-16
Shell <span class="token operator">=</span> /share/CACHEDEV1_DATA/.qpkg/QTransmission3/QTransmission3.sh
Service_Port <span class="token operator">=</span> xxxxx  <span class="token comment"># 修改xxxxx为自己的端口号</span>
Volume_Select <span class="token operator">=</span> <span class="token number">3</span>
Install_Path <span class="token operator">=</span> /share/CACHEDEV1_DATA/.qpkg/QTransmission3
WebUI <span class="token operator">=</span> /transmission
Web_Port <span class="token operator">=</span> xxxxx  <span class="token comment"># 修改xxxxx为自己的端口号</span>
RC_Number <span class="token operator">=</span> <span class="token number">161</span>
FW_Ver_Min <span class="token operator">=</span> <span class="token number">4.2</span>.6
FW_Ver_Max <span class="token operator">=</span> <span class="token number">5.0</span>.0
Enable <span class="token operator">=</span> TRUE

<span class="token punctuation">[</span>TransmissionWC<span class="token punctuation">]</span>
Status <span class="token operator">=</span> complete
Name <span class="token operator">=</span> TransmissionWC
Build <span class="token operator">=</span> <span class="token number">20201002</span>
Display_Name <span class="token operator">=</span> Transmission Web control
Version <span class="token operator">=</span> <span class="token number">1.6</span>.1
Author <span class="token operator">=</span> QoolBox
QPKG_File <span class="token operator">=</span> TransmissionWC.qpkg
Date <span class="token operator">=</span> <span class="token number">2022</span>-01-16
Shell <span class="token operator">=</span> /share/CACHEDEV1_DATA/.qpkg/TransmissionWC/TransmissionWC.sh
Install_Path <span class="token operator">=</span> /share/CACHEDEV1_DATA/.qpkg/TransmissionWC
RC_Number <span class="token operator">=</span> <span class="token number">162</span>
FW_Ver_Min <span class="token operator">=</span> <span class="token number">4.2</span>.6
FW_Ver_Max <span class="token operator">=</span> <span class="token number">5.0</span>.0
Enable <span class="token operator">=</span> TRUE
</code></pre> 
<h3><a id="transmission__200"></a>使transmission 端口测试显示开启</h3> 
<h4><a id="_201"></a>问题描述</h4> 
<p>在上述配置文件中指定的<code>"peer-port"</code>为<code>transmission</code>同其他<code>peer</code>通信的端口号，在<code>transmission 3.0.0.2</code>中，在<code>QNAP NAS</code>的<code>QuFirewall</code>中添加该端口的<code>IPV4</code>和<code>IPV6</code>的通行规则后，并在路由器中配置端口转发后，<code>transmission web UI</code>中的端口测试仍不通过，具体表现在网页端点击<code>Test the port</code>后，一直显示<code>testing</code>而没结果，而在windows的<a href="https://github.com/transmission-remote-gui/transgui">Transmission Remote GUI</a> 中则会提示<code>http error 400 bad request</code>。但在<a href="https://canyouseeme.org/" rel="nofollow">https://canyouseeme.org/</a>中测试端口是开启的。</p> 
<h4><a id="_203"></a>错误原因</h4> 
<p>端口测试会访问<code>portcheck.transmissionbt</code>，但该域名的<code>DNS</code>解析中<code>IPV6</code>优先级高于<code>IPV4</code>，而我们通过<code>IPV4</code>访问会返回正确结果，而通过<code>IPV6</code>访问则会返回<code>HTTP/1.1 400 Bad Request</code>：<sup class="footnote-ref"><a href="#fn4" rel="nofollow" id="fnref4">4</a></sup></p> 
<pre><code class="prism language-bash">$ <span class="token function">curl</span> -i -4 http://portcheck.transmissionbt.com/52955  <span class="token comment"># 我的 peer port 为52955</span>
HTTP/1.1 <span class="token number">200</span> OK
Server: nginx/1.10.3 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span>
Date: Sat, <span class="token number">21</span> May <span class="token number">2022</span> 08:40:37 GMT
Content-Type: text/html<span class="token punctuation">;</span> <span class="token assign-left variable">charset</span><span class="token operator">=</span>ISO-8859-1
Transfer-Encoding: chunked
Connection: keep-alive

$ <span class="token function">curl</span> -i -6 http://portcheck.transmissionbt.com/52955
HTTP/1.1 <span class="token number">400</span> Bad Request
Server: nginx/1.10.3 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span>
Date: Sat, <span class="token number">21</span> May <span class="token number">2022</span> 08:40:50 GMT
Content-Type: text/html<span class="token punctuation">;</span> <span class="token assign-left variable">charset</span><span class="token operator">=</span>ISO-8859-1
Transfer-Encoding: chunked
Connection: keep-alive
</code></pre> 
<h4><a id="_223"></a>解决办法：</h4> 
<ol><li>启用<code>QTS</code>的<code>ssh</code>连接：<code>主菜单</code>&gt;&gt;<code>控制台</code>&gt;&gt;<code>网络文件服务</code>&gt;&gt;<code>Telnet/SSH</code>，勾选<code>允许SSH连接（只有管理员群组可远程登陆）</code>后点击应用；</li><li>建立 <code>SSH</code> 连接：通过<code>CMD</code>或专门的<code>ssh</code>连接管理软件，例如 <a href="https://www.hostbuf.com/" rel="nofollow">finalshell</a>，远程连接 <code>QTS</code>；</li><li>运行命令：</li></ol> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/hosts
</code></pre> 
<ol start="4"><li>在<code>hosts</code>文件尾部添加<sup class="footnote-ref"><a href="#fn4" rel="nofollow" id="fnref4:1">4</a></sup></li></ol> 
<pre><code>87.98.162.88 portcheck.transmissionbt.com
</code></pre> 
<ol start="5"><li>再次测试端口，验证结果：<br> <img src="https://images2.imgbox.com/a4/74/IXI9HNMN_o.png" alt="test port" width="800"></li></ol> 
<h3><a id="HTTPS_239"></a>利用反向代理配置HTTPS访问</h3> 
<p>登录威联通<code>NAS</code>网页端，<code>控制台</code>&gt;&gt;<code>网络访问</code>&gt;&gt;<code>反向代理</code>，点击<code>添加</code>，规则名称可填写<code>transmission</code>。<br> <code>来源</code>这一部分表示我们从<strong>外部</strong>将通过哪个域名的哪个端口来经<code>HTTPS</code>访问<code>NAS</code>内部的<code>Transmission</code>，故<code>协议</code>选择<code>HTTPS</code>，<code>域名</code>填写访问<code>NAS</code>用的域名，<code>端口</code>填写一个<strong>未被</strong><code>NAS</code>内各种服务<strong>占用</strong>的端口（端口1），<code>访问控制配置文件</code>选择<code>允许所有连接</code>。<br> 相反的，<code>目标</code>这一部分表示是我们要通过这个代理来访问<code>NAS</code><strong>内部</strong>的哪个服务，这里我们是为了访问<code>Transmission</code>，内部是没有<code>SSL</code>的，故<code>协议</code>选择<code>HTTP</code>，<code>主机名</code>保持默认，<code>端口号</code>填写内网中访问<code>Transmission Web UI</code> 的端口号（端口2）。然后点击<code>应用</code>，在<code>反向代理</code>对话框中将列出新添加的<code>Transmission</code>规则，<code>状态</code>为<code>已启用</code>。然后再在路由器中配置<strong>端口转发</strong>，将<code>来源</code>部分填写的端口号（端口1）转发出去，便可通过外网<code>https://domain:端口1</code>访问<code>Transmission Web UI</code>。<br> <img src="https://images2.imgbox.com/62/bf/1ZF1FwKB_o.png" alt="方向代理 来源" width="800"><br> <img src="https://images2.imgbox.com/b5/40/qPZhfjtV_o.png" alt="反向代理目标" width="800"><br> <img src="https://images2.imgbox.com/63/57/sb0ceWop_o.png" alt="反向代理结果" width="800"></p> 
<h3><a id="ssl__247"></a>ssl 证书验证问题</h3> 
<ul><li>问题：<font color="#FFFF00">黄种</font> <font color="#FF0000">could not connect to tracker</font></li><li>解决办法：</li></ul> 
<p>方法1. 从 <a href="https://www.qnapclub.eu/en" rel="nofollow">qnapclub</a> 依次安装 <a href="https://www.qnapclub.eu/en/qpkg/241" rel="nofollow">Qperl</a> 和 <a href="https://www.qnapclub.eu/en/qpkg/238" rel="nofollow">CACert</a>，无需重启 <code>transmission</code>， 等待片刻便可连接 <code>https</code> <code>tracker</code> 成功。<sup class="footnote-ref"><a href="#fn5" rel="nofollow" id="fnref5">5</a></sup></p> 
<p>方法2<sup class="footnote-ref"><a href="#fn6" rel="nofollow" id="fnref6">6</a></sup>: 禁用<code>transmission</code>的<code>ssl</code>验证<br> 在AppCenter中将TR停止掉，然后，</p> 
<p>You just need to add 2 lines in the QTransmission3.sh file under the .qpkg folder QTransmission3:<br> (我的是这个文件：<code>/share/CACHEDEV1_DATA/.qpkg/QTransmission3/Qtransmission3.sh</code>，需要通过ssh登入，使用sudo权限来写入)</p> 
<pre><code class="prism language-bash"><span class="token assign-left variable">TR_CURL_SSL_NO_VERIFY</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token builtin class-name">export</span> TR_CURL_SSL_NO_VERIFY
</code></pre> 
<p>The file should look like this:</p> 
<pre><code class="prism language-bash"><span class="token shebang important">#!/bin/sh</span>
<span class="token assign-left variable">CONF</span><span class="token operator">=</span>/etc/config/qpkg.conf
<span class="token assign-left variable">QPKG_NAME</span><span class="token operator">=</span><span class="token string">"QTransmission3"</span>
<span class="token assign-left variable">TR_CURL_SSL_NO_VERIFY</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">QPKG_ROOT</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>/sbin/getcfg $QPKG_NAME Install_Path -f $<span class="token punctuation">{<!-- --></span>CONF<span class="token punctuation">}</span><span class="token variable">`</span></span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">QNAP_QPKG</span><span class="token operator">=</span><span class="token variable">$QPKG_NAME</span>
<span class="token builtin class-name">export</span> QPKG_ROOT QPKG_NAME
<span class="token builtin class-name">export</span> TR_CURL_SSL_NO_VERIFY
<span class="token punctuation">..</span>.
</code></pre> 
<p>更改好后重启<code>transmission</code>即可。</p> 
<p>参考：</p> 
<hr class="footnotes-sep"> 
<section class="footnotes"> 
 <ol class="footnotes-list"><li id="fn1" class="footnote-item"><p><a href="https://post.smzdm.com/p/a0dl87ew/" rel="nofollow">威联通QANP安装Transmission和中文UI改端口登陆用户名密码以及解决错误Couldn’t find Transmission’s web…</a> <a href="#fnref1" rel="nofollow" class="footnote-backref">↩︎</a> <a href="#fnref1:1" rel="nofollow" class="footnote-backref">↩︎</a></p> </li><li id="fn2" class="footnote-item"><p><a href="https://post.smzdm.com/p/aoo65m5n/" rel="nofollow">我的NAS 篇二：QNAP TS-453BMINI 新手设置和transmission设置</a> <a href="#fnref2" rel="nofollow" class="footnote-backref">↩︎</a> <a href="#fnref2:1" rel="nofollow" class="footnote-backref">↩︎</a></p> </li><li id="fn3" class="footnote-item"><p><a href="https://kris.run/qnap-nas-%E5%AE%89%E8%A3%85-transmission-%E5%90%8E%E9%87%8D%E8%A6%81%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3/" rel="nofollow">Qnap Nas 安装 Transmission 后重要配置详解</a> <a href="#fnref3" rel="nofollow" class="footnote-backref">↩︎</a></p> </li><li id="fn4" class="footnote-item"><p><a href="https://github.com/transmission/transmission/issues/407">transmission port is closed #407</a> <a href="#fnref4" rel="nofollow" class="footnote-backref">↩︎</a> <a href="#fnref4:1" rel="nofollow" class="footnote-backref">↩︎</a></p> </li><li id="fn5" class="footnote-item"><p><a href="https://forum.transmissionbt.com/viewtopic.php?p=78853" rel="nofollow">Transmission 3.0 does not support SSL why ?</a> <a href="#fnref5" rel="nofollow" class="footnote-backref">↩︎</a></p> </li><li id="fn6" class="footnote-item"><p><a href="https://forum.qnap.com/viewtopic.php?p=798783#p798783" rel="nofollow">I figured out how to make the https trackers work.</a> <a href="#fnref6" rel="nofollow" class="footnote-backref">↩︎</a></p> </li></ol> 
</section>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/522f985addefda475dc942739f32ea70/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">qnap&#43;qBitorrent</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d7f743221f0ea80897411b7c540e97bd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">脑电项目探索和实现(EEG) (上)：研究数据集选取和介绍SEED</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>