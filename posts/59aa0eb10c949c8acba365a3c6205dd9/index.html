<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#.NET调用jar包（java环境配置及ikvm安装） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#.NET调用jar包（java环境配置及ikvm安装）" />
<meta property="og:description" content="在ASP.NET(C#)项目中需要调用java中的方法，在VS平台中简单调用jar包的方法就是将jar包转换成dll库，之后 通过引用dll库，就可以直接使用java中的类了。C#语言和Java语言有着很多相似之处，其中的jar包和dll库就是非常相似的。
java se 6环境配置
注意：java环境需要安装 java SE 6 版本 ，否则会出现源码格式无法识别的问题
简单说下java 安装：
1.去官方网站下载jdk JAVA SE 6 ：http://www.oracle.com/technetwork/java/javasebusiness/downloads/java-archive-downloads-javase6-419409.html
2.下载安装包后直接安装即可，然后需要对环境变量进行配置
新建 CLASSPATH(最前面需要加 【.;】点号和分号表示在所有目录下都可以使用java类)
.;%JAVA_HOME%\lib;%JAVA_HOME%\lib\tools.jar
新建 JAVA_HOME (设置为安装jdk的目录)
C:\Program Files (x86)\Java\jdk1.6.0_43
PATH变量中添加
;%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;
3.运行cmd命令进行测试 4.编译一个java文件进行测试 5.编译后并将创建的该类打包为jar文件
IKVM.NET使用
Java环境配置后，需要下载一个IKVM.NET的工具 IKVM.NET ：http://www.ikvm.net/
去Download页面，下载 ikvmbin-7.2.4630.5 包，之后将其解压，并在【环境变量】-&gt;【系统变量】中设置path路径，路径为解压的目录
;D:\ikvm\bin
安装完成后，可以开始将jar包转为dll库，使用一个命令即可
ikvmc -out:ikDllName.dll TestHw.jar //将jar文件转换成dll类库
从java源码到dll库用到的cmd命令如下图 javac HwJavaClass.java
jar cvf HwJarName.jar HwJavaClass.class
ikvmc -out:HwDllname.dll HwJarName.jar
在VS中使用jar转换后的dll库
这里直接在ASP.NET项目中新建web窗体；引用IKVM创建的dll库（除了自己创建的还需要引用另外三个IKVM自身的dll库,在解压目录的bin文件下） HwDllname.dll IKVM.OpenJDK.Core.dll IKVM.Runtime.dll IKVM.Runtime.JNI.dll
之后，可看到dll库中存在命名空间和类方法 代码如下：
using System;
using nameSpaceH; //package nameSpaceH" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/59aa0eb10c949c8acba365a3c6205dd9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-10-17T15:19:14+08:00" />
<meta property="article:modified_time" content="2018-10-17T15:19:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#.NET调用jar包（java环境配置及ikvm安装）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在ASP.NET(C#)项目中需要调用java中的方法，在VS平台中简单调用jar包的方法就是将jar包转换成dll库，之后 通过引用dll库，就可以直接使用java中的类了。C#语言和Java语言有着很多相似之处，其中的jar包和dll库就是非常相似的。<br> java se 6环境配置<br> 注意：java环境需要安装 java SE 6 版本  ，否则会出现源码格式无法识别的问题<br> 简单说下java 安装：<br> 1.去官方网站下载jdk <br> JAVA SE 6 ：http://www.oracle.com/technetwork/java/javasebusiness/downloads/java-archive-downloads-javase6-419409.html</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/7f/81/aLWoFGVd_o.png"><br> 2.下载安装包后直接安装即可，然后需要对环境变量进行配置</p> 
<p>新建  CLASSPATH(最前面需要加 【.;】点号和分号表示在所有目录下都可以使用java类)<br> .;%JAVA_HOME%\lib;%JAVA_HOME%\lib\tools.jar</p> 
<p>新建 JAVA_HOME (设置为安装jdk的目录)<br> C:\Program Files (x86)\Java\jdk1.6.0_43</p> 
<p>PATH变量中添加<br> ;%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;</p> 
<p>3.运行cmd命令进行测试 </p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/14/8c/lf2vTsvY_o.png"><br> 4.编译一个java文件进行测试 </p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/dc/21/eCsxHGIR_o.png"><br> 5.编译后并将创建的该类打包为jar文件</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/3e/23/fVGhCPvT_o.png"></p> 
<p>IKVM.NET使用<br> Java环境配置后，需要下载一个IKVM.NET的工具 <br> IKVM.NET ：http://www.ikvm.net/</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/04/11/TpTQ5Awn_o.png"><br> 去Download页面，下载 ikvmbin-7.2.4630.5 包，之后将其解压，并在【环境变量】-&gt;【系统变量】中设置path路径，路径为解压的目录</p> 
<p>;D:\ikvm\bin</p> 
<p>安装完成后，可以开始将jar包转为dll库，使用一个命令即可</p> 
<p><span style="color:#f33b45;">ikvmc -out:ikDllName.dll TestHw.jar</span> //将jar文件转换成dll类库</p> 
<p>从java源码到dll库用到的cmd命令如下图 </p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/60/a3/g5bHgqXP_o.png"><br> javac HwJavaClass.java<br> jar cvf HwJarName.jar HwJavaClass.class<br> ikvmc -out:HwDllname.dll HwJarName.jar</p> 
<p><strong>在VS中使用jar转换后的dll库</strong><br> 这里直接在ASP.NET项目中新建web窗体；引用IKVM创建的dll库（除了自己创建的还需要引用另外三个IKVM自身的dll库,在解压目录的bin文件下） </p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/90/a1/W74QUXJU_o.png"><br> HwDllname.dll <br> IKVM.OpenJDK.Core.dll <br> IKVM.Runtime.dll <br> IKVM.Runtime.JNI.dll</p> 
<p>之后，可看到dll库中存在命名空间和类方法 </p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/fc/75/RPnj9Z5g_o.png"></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/84/52/5T8E3jEB_o.png"><br> 代码如下：</p> 
<p>using System;</p> 
<p>using nameSpaceH;       //package nameSpaceH</p> 
<p>namespace ADOTest<br> {<!-- --><br>     public partial class test123 : System.Web.UI.Page<br>     {<!-- --><br>         protected void Page_Load(object sender, EventArgs e)<br>         {<!-- --><br>             HwJavaClass mao = new HwJavaClass();    //public class HwJavaClass(){}<br>             string a = mao.returnString();</p> 
<p>            Response.Write(a);</p> 
<p>        }<br>     }<br> }</p> 
<p>DLL动态链接库： <br> DLL文件中存放的是各类程序的函数(子过程)实现过程，当程序需要调用函数时需要先载入DLL，然后取得函数的地址，最后进行调用。使用DLL文件的好处是程序不需要在运行之初加载所有代码，只有在程序需要某个函数的时候才从DLL中取出。另外，使用DLL文件还可以减小程序的体积。</p> 
<p>打开控制面板，程序，打开或关闭windows功能，勾选telnet客户端 <br> 然后输入</p> 
<p>telnet towel.blinkenlights.nl <br> 可以看到dos版星球大战</p> 
<p>输入</p> 
<p>shutdown -s -t 3600 <br> shutdown -a <br> 定时关机30分钟之后，-a注销命令</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cef37800174ca48bf171cca4ac5394b8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">nvme-cli常用指令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/725670433ad821af14102d1921651f4a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">斯坦福大学-自然语言处理入门 笔记 第七课 情感分析（sentiment analysis）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>