<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>海康机器人工业相机常用参数功能设置与获取（持续更新全-C语言） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="海康机器人工业相机常用参数功能设置与获取（持续更新全-C语言）" />
<meta property="og:description" content="海康机器人工业相机常用参数功能设置与获取（C语言） 前言相机属性树1.设备控制/DeviceControl1.1相机序列号获取/DeviceSerialNumber1.2相机自定义命名设置与获取/DeviceUserID1.3相机上电时间获取/DeviceUptime 2.相机格式控制/ImageFormatControl2.1获取相机图像最大宽、高值2.2设置相机图像ROI区域2.3恢复相机图像ROI区域，恢复最大值2.4获取相机支持的图像格式2.5修改相机图像格式2.6打开/关闭相机自带测试图像2.6.1关闭测试图像（默认状态）2.6.2打开测试图像 2.7打开/关闭相机图像X镜像、Y镜像2.8打开/关闭相机嵌入式图像水印功能 3.采集控制/AcquisitionControl3.1采集模式设置3.2多帧采集设置/AcquisitionBurstFrameCount3.3帧率控制/AcquisitionFrameRate3.4触发模式设置3.4.1软触发设置/Software3.4.2硬触发设置/line3.4.3任意触发设置/Anyway 3.5曝光设置3.5.1手动曝光设置3.5.2自动曝光设置3.5.3超短曝光设置 3.6HDR多曝光增益切换 4.模拟控制/AnalogControl4.1模拟增益设置4.2数字增益设置4.3伽马设置/Gamma4.4锐度设置/Sharpness4.4.1相机锐度设置4.4.2SDK锐度设置 4.5白平衡设置/BalanceWhiteAuto4.5.1 自动白平衡4.5.2 手动白平衡 5.数字IO控制/DigitalIOControl5.1IO输出控制5.2IO输出输出事件介绍 6.动作命令控制/ActionControl7.文件访问控制/FileAccessControl8.事件监视/EventControl8.1曝光结束时间 9.数据块控制/ChunkDataControl10.传输层控制/TransportLayerControl10.1心跳时间设置 11.用户集控制/UserSetControl11.1保存参数到相机11.2恢复出厂默认参数 前言 本文简单直接粗糙的介绍下海康工业相机常用的参数的设置方法与获取方法
1.海康工业SDK简介：海康机器人工业相机sdk简介
2.海康工业相机参数设置获取通用方法：海康工业相机参数设置与获取
如果不心急，就先简单阅读上述两篇博客，可以更加熟悉海康的工业相机sdk的整体构成
参数实在是太多，有空慢慢更新啦…
相机属性树 1.设备控制/DeviceControl 1.1相机序列号获取/DeviceSerialNumber MVCC_STRINGVALUE stStrValue; memset(&amp;stStrValue, 0, sizeof(MVCC_STRINGVALUE)); nRet = MV_CC_GetStringValue(handle, &#34;DeviceSerialNumber&#34;, &amp;stStrValue); if (MV_OK != nRet) { printf(&#34;Get DeviceSerialNumber fail! nRet [0x%x]\n&#34;, nRet); } printf(&#34;Current DeviceSerialNumber [%s]\n&#34;, stStrValue.chCurValue); 结果：
1.2相机自定义命名设置与获取/DeviceUserID nRet = MV_CC_SetStringValue(handle, &#34;DeviceUserID&#34;, &#34;UserIDChanged&#34;); if (MV_OK != nRet) { printf(&#34;Set DeviceUserID fail! nRet [0x%x]\n&#34;, nRet); } MVCC_STRINGVALUE stStrValue; memset(&amp;stStrValue, 0, sizeof(MVCC_STRINGVALUE)); nRet = MV_CC_GetStringValue(handle, &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/f9bb4712e3cc85295dc20b3788b6097c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-02T15:24:15+08:00" />
<meta property="article:modified_time" content="2021-11-02T15:24:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">海康机器人工业相机常用参数功能设置与获取（持续更新全-C语言）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>海康机器人工业相机常用参数功能设置与获取（C语言）</h4> 
 <ul><li><a href="#_1" rel="nofollow">前言</a></li><li><a href="#_7" rel="nofollow">相机属性树</a></li><li><ul><li><a href="#1DeviceControl_8" rel="nofollow">1.设备控制/DeviceControl</a></li><li><ul><li><a href="#11DeviceSerialNumber_9" rel="nofollow">1.1相机序列号获取/DeviceSerialNumber</a></li><li><a href="#12DeviceUserID_23" rel="nofollow">1.2相机自定义命名设置与获取/DeviceUserID</a></li><li><a href="#13DeviceUptime_41" rel="nofollow">1.3相机上电时间获取/DeviceUptime</a></li></ul> 
   </li><li><a href="#2ImageFormatControl_54" rel="nofollow">2.相机格式控制/ImageFormatControl</a></li><li><ul><li><a href="#21_55" rel="nofollow">2.1获取相机图像最大宽、高值</a></li><li><a href="#22ROI_71" rel="nofollow">2.2设置相机图像ROI区域</a></li><li><a href="#23ROI_144" rel="nofollow">2.3恢复相机图像ROI区域，恢复最大值</a></li><li><a href="#24_171" rel="nofollow">2.4获取相机支持的图像格式</a></li><li><a href="#25_210" rel="nofollow">2.5修改相机图像格式</a></li><li><a href="#26_221" rel="nofollow">2.6打开/关闭相机自带测试图像</a></li><li><ul><li><a href="#261_222" rel="nofollow">2.6.1关闭测试图像（默认状态）</a></li><li><a href="#262_231" rel="nofollow">2.6.2打开测试图像</a></li></ul> 
    </li><li><a href="#27XY_243" rel="nofollow">2.7打开/关闭相机图像X镜像、Y镜像</a></li><li><a href="#28_263" rel="nofollow">2.8打开/关闭相机嵌入式图像水印功能</a></li></ul> 
   </li><li><a href="#3AcquisitionControl_301" rel="nofollow">3.采集控制/AcquisitionControl</a></li><li><ul><li><a href="#31_302" rel="nofollow">3.1采集模式设置</a></li><li><a href="#32AcquisitionBurstFrameCount_314" rel="nofollow">3.2多帧采集设置/AcquisitionBurstFrameCount</a></li><li><a href="#33AcquisitionFrameRate_324" rel="nofollow">3.3帧率控制/AcquisitionFrameRate</a></li><li><a href="#34_340" rel="nofollow">3.4触发模式设置</a></li><li><ul><li><a href="#341Software_341" rel="nofollow">3.4.1软触发设置/Software</a></li><li><a href="#342line_364" rel="nofollow">3.4.2硬触发设置/line</a></li><li><a href="#343Anyway_387" rel="nofollow">3.4.3任意触发设置/Anyway</a></li></ul> 
    </li><li><a href="#35_404" rel="nofollow">3.5曝光设置</a></li><li><ul><li><a href="#351_405" rel="nofollow">3.5.1手动曝光设置</a></li><li><a href="#352_414" rel="nofollow">3.5.2自动曝光设置</a></li><li><a href="#353_433" rel="nofollow">3.5.3超短曝光设置</a></li></ul> 
    </li><li><a href="#36HDR_469" rel="nofollow">3.6HDR多曝光增益切换</a></li></ul> 
   </li><li><a href="#4AnalogControl_493" rel="nofollow">4.模拟控制/AnalogControl</a></li><li><ul><li><a href="#41_494" rel="nofollow">4.1模拟增益设置</a></li><li><a href="#42_502" rel="nofollow">4.2数字增益设置</a></li><li><a href="#43Gamma_517" rel="nofollow">4.3伽马设置/Gamma</a></li><li><a href="#44Sharpness_538" rel="nofollow">4.4锐度设置/Sharpness</a></li><li><ul><li><a href="#441_539" rel="nofollow">4.4.1相机锐度设置</a></li><li><a href="#442SDK_556" rel="nofollow">4.4.2SDK锐度设置</a></li></ul> 
    </li><li><a href="#45BalanceWhiteAuto_719" rel="nofollow">4.5白平衡设置/BalanceWhiteAuto</a></li><li><a href="#451__720" rel="nofollow">4.5.1 自动白平衡</a></li><li><a href="#452__738" rel="nofollow">4.5.2 手动白平衡</a></li></ul> 
   </li><li><a href="#5IODigitalIOControl_756" rel="nofollow">5.数字IO控制/DigitalIOControl</a></li><li><ul><li><a href="#51IO_757" rel="nofollow">5.1IO输出控制</a></li><li><a href="#52IO_759" rel="nofollow">5.2IO输出输出事件介绍</a></li></ul> 
   </li><li><a href="#6ActionControl_793" rel="nofollow">6.动作命令控制/ActionControl</a></li><li><a href="#7FileAccessControl_795" rel="nofollow">7.文件访问控制/FileAccessControl</a></li><li><a href="#8EventControl_796" rel="nofollow">8.事件监视/EventControl</a></li><li><ul><li><a href="#81_797" rel="nofollow">8.1曝光结束时间</a></li></ul> 
   </li><li><a href="#9ChunkDataControl_798" rel="nofollow">9.数据块控制/ChunkDataControl</a></li><li><a href="#10TransportLayerControl_799" rel="nofollow">10.传输层控制/TransportLayerControl</a></li><li><ul><li><a href="#101_800" rel="nofollow">10.1心跳时间设置</a></li></ul> 
   </li><li><a href="#11UserSetControl_810" rel="nofollow">11.用户集控制/UserSetControl</a></li><li><ul><li><a href="#111_811" rel="nofollow">11.1保存参数到相机</a></li><li><a href="#112_834" rel="nofollow">11.2恢复出厂默认参数</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>前言</h2> 
<p>本文简单直接粗糙的介绍下海康工业相机常用的参数的设置方法与获取方法<br> 1.海康工业SDK简介：<a href="https://blog.csdn.net/qq_23107577/article/details/112654236?spm=1001.2014.3001.5501">海康机器人工业相机sdk简介</a><br> 2.海康工业相机参数设置获取通用方法：<a href="https://blog.csdn.net/qq_23107577/article/details/113757126?spm=1001.2014.3001.5501">海康工业相机参数设置与获取</a><br> <strong>如果不心急，就先简单阅读上述两篇博客，可以更加熟悉海康的工业相机sdk的整体构成</strong><br> 参数实在是太多，有空慢慢更新啦…</p> 
<h2><a id="_7"></a>相机属性树</h2> 
<h3><a id="1DeviceControl_8"></a>1.设备控制/DeviceControl</h3> 
<h4><a id="11DeviceSerialNumber_9"></a>1.1相机序列号获取/DeviceSerialNumber</h4> 
<pre><code class="prism language-c">	MVCC_STRINGVALUE stStrValue<span class="token punctuation">;</span>
	<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>stStrValue<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>MVCC_STRINGVALUE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_GetStringValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"DeviceSerialNumber"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>stStrValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Get DeviceSerialNumber fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Current DeviceSerialNumber [%s]\n"</span><span class="token punctuation">,</span> stStrValue<span class="token punctuation">.</span>chCurValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
</code></pre> 
<p>结果：<br> <img src="https://images2.imgbox.com/7d/f4/snLYD5qN_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="12DeviceUserID_23"></a>1.2相机自定义命名设置与获取/DeviceUserID</h4> 
<pre><code class="prism language-c">	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetStringValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"DeviceUserID"</span><span class="token punctuation">,</span> <span class="token string">"UserIDChanged"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set DeviceUserID fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	MVCC_STRINGVALUE stStrValue<span class="token punctuation">;</span>
	<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>stStrValue<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>MVCC_STRINGVALUE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_GetStringValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"DeviceUserID"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>stStrValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Get DeviceUserID fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Rename DeviceUserID [%s]\n"</span><span class="token punctuation">,</span> stStrValue<span class="token punctuation">.</span>chCurValue<span class="token punctuation">)</span><span class="token punctuation">;</span>	
</code></pre> 
<p>结果:<br> <img src="https://images2.imgbox.com/6d/6c/qUU3VKeb_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="13DeviceUptime_41"></a>1.3相机上电时间获取/DeviceUptime</h4> 
<pre><code class="prism language-c">	MVCC_INTVALUE_EX stIntValue <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    nRet <span class="token operator">=</span> <span class="token function">MV_CC_GetIntValueEx</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"DeviceUptime"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>stIntValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Get DeviceUptime fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"DeviceUptime [%d]\n"</span><span class="token punctuation">,</span> stIntValue<span class="token punctuation">.</span>nCurValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：<br> <img src="https://images2.imgbox.com/67/60/d2q7wfB1_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2ImageFormatControl_54"></a>2.相机格式控制/ImageFormatControl</h3> 
<h4><a id="21_55"></a>2.1获取相机图像最大宽、高值</h4> 
<pre><code class="prism language-c">	MVCC_INTVALUE_EX nWidthMaxValue<span class="token operator">=</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>nHeightMaxValue <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>	
	<span class="token comment">//如需获取当前相机图像宽高，需要将WidthMax替换成Width	</span>
    nRet <span class="token operator">=</span> <span class="token function">MV_CC_GetIntValueEx</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"WidthMax"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>nWidthMaxValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
    	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Get WidthMax fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//如需获取当前相机图像宽高，需要将HeightMax替换成Height</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_GetIntValueEx</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"HeightMax"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>nHeightMaxValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Get HeightMax fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h4><a id="22ROI_71"></a>2.2设置相机图像ROI区域</h4> 
<p>注意事项：相机设置图像宽高时，<strong>相机不能取流</strong>：需要在startgrabing之前设置或者stopgrabing之后设置</p> 
<pre><code class="prism language-c">	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> m_Width<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>m_Height<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span><span class="token comment">//要设置的步进值</span>
	<span class="token comment">//offset，设置的偏移值，图像左上角为原点，一般需要是2的倍数，不能是奇数</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> m_OffsetX<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>m_OffsetY<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">;</span>
	<span class="token comment">//获取图像宽高最大最小值，获取步进值</span>
	MVCC_INTVALUE_EX nWidthValue<span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>nHeightValue <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>	
	<span class="token comment">//获取相机支持的宽高最大值	</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_GetIntValueEx</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"Width"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>nWidthValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_GetIntValueEx</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"Height"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>nHeightValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>m_Width<span class="token operator">&gt;</span>nWidthValue<span class="token punctuation">.</span>nMax<span class="token operator">||</span>
		m_Height <span class="token operator">&gt;</span> nHeightValue<span class="token punctuation">.</span>nMax<span class="token operator">||</span>
		m_Width<span class="token operator">&lt;</span>nWidthValue<span class="token punctuation">.</span>nMin<span class="token operator">||</span>
		m_Height <span class="token operator">&lt;</span> nHeightValue<span class="token punctuation">.</span>nMin<span class="token operator">||</span>
		<span class="token punctuation">(</span>m_Width<span class="token operator">+</span>m_OffsetX<span class="token punctuation">)</span><span class="token operator">&gt;</span>nWidthValue<span class="token punctuation">.</span>nMax<span class="token operator">||</span>		<span class="token comment">//偏移值+设置值必须小于宽高的最大值</span>
		<span class="token punctuation">(</span>m_Height <span class="token operator">+</span>m_OffsetY<span class="token punctuation">)</span><span class="token operator">&gt;</span>nHeightValue<span class="token punctuation">.</span>nMax<span class="token operator">||</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//判断有没有超出范围，超出范围就报错！！！</span>
		 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set Image Width or Height out of range !!\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> 
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//避免offset有偏移值，导致后续设置宽高失败</span>
		nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"OffsetX"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"OffsetY"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>m_Width<span class="token operator">%</span>nWidthValue<span class="token punctuation">.</span>nInc<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>m_Height<span class="token operator">%</span>nHeightValue<span class="token punctuation">.</span>nInc<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//符合步进值才设置进去</span>
		<span class="token punctuation">{<!-- --></span>	
			nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"Width"</span><span class="token punctuation">,</span>m_Width<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
               	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set Width  fail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
			nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"Height"</span><span class="token punctuation">,</span>m_Height<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set Height  fail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"OffsetX"</span><span class="token punctuation">,</span>m_OffsetX<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set OffsetX fail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
			nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"OffsetY"</span><span class="token punctuation">,</span>m_OffsetY<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set OffsetY fail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//不符合步进，减去余数再去设置宽高，此时设置的宽高与原宽高有差异</span>
			nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"Width"</span><span class="token punctuation">,</span>m_Width<span class="token operator">-</span>m_Width<span class="token operator">%</span>nWidthValue<span class="token punctuation">.</span>nInc<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set Width  fail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
			nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"Height"</span><span class="token punctuation">,</span>m_Height<span class="token operator">-</span>m_Height<span class="token operator">%</span>nHeightValue<span class="token punctuation">.</span>nInc<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set Height  fail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
           	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"OffsetX"</span><span class="token punctuation">,</span>m_OffsetX<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set OffsetX fail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
			nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"OffsetY"</span><span class="token punctuation">,</span>m_OffsetY<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set OffsetY fail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
		<span class="token punctuation">}</span>		
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="23ROI_144"></a>2.3恢复相机图像ROI区域，恢复最大值</h4> 
<pre><code class="prism language-c">	MVCC_INTVALUE_EX nWidthMaxValue<span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>nHeightMaxValue <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>		
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_GetIntValueEx</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"WidthMax"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>nWidthMaxValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Get WidthMax fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_GetIntValueEx</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"HeightMax"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>nHeightMaxValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Get HeightMax fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>	
	<span class="token comment">//一定要先还原相机的偏移值，再去设置相机宽高</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"OffsetX"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"OffsetY"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"Width"</span><span class="token punctuation">,</span>nWidthMaxValue<span class="token punctuation">.</span>nCurValue<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置为最大值</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set Width  fail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"Height"</span><span class="token punctuation">,</span>nHeightMaxValue<span class="token punctuation">.</span>nCurValue<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置为最大值</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set Height  fail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="24_171"></a>2.4获取相机支持的图像格式</h4> 
<pre><code class="prism language-c">MV_XML_NODE_FEATURE stNodeFeature<span class="token punctuation">;</span>
MV_XML_FEATURE_Enumeration stFeatureEnm<span class="token punctuation">;</span>
<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>stNodeFeature<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>MV_XML_NODE_FEATURE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>stFeatureEnm<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>MV_XML_FEATURE_Enumeration<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">strncpy</span><span class="token punctuation">(</span>stNodeFeature<span class="token punctuation">.</span>strName<span class="token punctuation">,</span> <span class="token string">"PixelFormat"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token string">"PixelFormat"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
stNodeFeature<span class="token punctuation">.</span>enType <span class="token operator">=</span> IFT_IEnumeration<span class="token punctuation">;</span>
nRet <span class="token operator">=</span> <span class="token function">MV_XML_GetNodeFeature</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token operator">&amp;</span>stNodeFeature<span class="token punctuation">,</span><span class="token operator">&amp;</span>stFeatureEnm<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> nRet<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> stFeatureEnm<span class="token punctuation">.</span>nSymbolicNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"PixelFormat:%s \r\n"</span><span class="token punctuation">,</span> stFeatureEnm<span class="token punctuation">.</span>strSymbolic<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印出相机支持的所有像素格式</span>
				
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> stFeatureEnm<span class="token punctuation">.</span>nSymbolicNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>stFeatureEnm<span class="token punctuation">.</span>strSymbolic<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">,</span><span class="token string">"BayerBG8"</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token operator">||</span> 
			<span class="token function">strcmp</span><span class="token punctuation">(</span>stFeatureEnm<span class="token punctuation">.</span>strSymbolic<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"BayerRG8"</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token operator">||</span> 
			<span class="token function">strcmp</span><span class="token punctuation">(</span>stFeatureEnm<span class="token punctuation">.</span>strSymbolic<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"BayerGB8"</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token operator">||</span> 
			<span class="token function">strcmp</span><span class="token punctuation">(</span>stFeatureEnm<span class="token punctuation">.</span>strSymbolic<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"BayerGR8"</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token operator">||</span>
			<span class="token function">strcmp</span><span class="token punctuation">(</span>stFeatureEnm<span class="token punctuation">.</span>strSymbolic<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"RGB8Packed"</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token operator">||</span> 
			<span class="token function">strcmp</span><span class="token punctuation">(</span>stFeatureEnm<span class="token punctuation">.</span>strSymbolic<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"BGR8Packed"</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//比较相机参数格式，这里仅比较了bayer与RGB</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"This is a Color camera \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>结果：<br> <img src="https://images2.imgbox.com/77/b2/Aph3rzb3_o.png" alt="黑白相机：![在这里插入图片描述](https://img-blog.csdnimg.cn/81aa4d9a473442bcb28dc8114137f7c9.png)彩色相机："></p> 
<h4><a id="25_210"></a>2.5修改相机图像格式</h4> 
<pre><code class="prism language-c">	<span class="token comment">//设置Enum型参数-相机图像格式</span>
	<span class="token comment">//注意点1：相机图像格式设置时，只有在MV_CC_Startgrab接口调用前才能设置,取流过程中，不能修改图像格式</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"PixelFormat"</span><span class="token punctuation">,</span> PixelType_Gvsp_Mono12<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"error: Set PixelFormat fail [%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="26_221"></a>2.6打开/关闭相机自带测试图像</h4> 
<h5><a id="261_222"></a>2.6.1关闭测试图像（默认状态）</h5> 
<pre><code class="prism language-c">	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"TestPattern"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set TestPattern fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="262_231"></a>2.6.2打开测试图像</h5> 
<pre><code class="prism language-c">	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"TestPattern"</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//0:off,9:ColorBar,14:ObliqueMonoBar,17:TestImage1</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set TestPattern fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<p>效果：<br> <img src="https://images2.imgbox.com/1c/e4/w8uRgmOO_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="27XY_243"></a>2.7打开/关闭相机图像X镜像、Y镜像</h4> 
<pre><code class="prism language-c">	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetBoolValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"ReverseX"</span><span class="token punctuation">,</span> true<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set ReverseX fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//Y镜像需要注意两点</span>
	<span class="token comment">//1.部分相机不支持，所以可能设置不了，具体看相机规格书spec</span>
	<span class="token comment">//2.Y镜像需要停止采集状态下设置，不像X镜像一样可以实时设置，一般在MV_CC_StartGrabbing接口之前调用</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetBoolValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"ReverseY"</span><span class="token punctuation">,</span> true<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set ReverseY fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<p>效果：<br> <img src="https://images2.imgbox.com/42/b9/Dc4oaFL8_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="28_263"></a>2.8打开/关闭相机嵌入式图像水印功能</h4> 
<p>相机的图像水印信息，用于打印记录相机内部信息，水印信息在取流接口中，图像结构体里面获取<br> 相机水印的本质原理是取代图像头部开始的小部分有效信息，占用约40个字节的真实数据信息，供信息传输，不造成图像数据大小的变化<br> <img src="https://images2.imgbox.com/67/f8/ox5VVjvI_o.png" alt="在这里插入图片描述"></p> 
<table><thead><tr><th>参数</th><th>关键词</th><th>参数值</th></tr></thead><tbody><tr><td>时间戳</td><td>Timestamp</td><td>0</td></tr><tr><td>增益</td><td>Gain</td><td>1</td></tr><tr><td>曝光</td><td>Exposure</td><td>2</td></tr><tr><td>平均亮度</td><td>BrightnessInfo</td><td>3</td></tr><tr><td>白平衡</td><td>WhiteBalance</td><td>4</td></tr><tr><td>帧号</td><td>Framecounter</td><td>5</td></tr><tr><td>触发计数</td><td>ExtTriggerCount</td><td>6</td></tr><tr><td>IO输入输出电平状态</td><td>LineInputOutput</td><td>7</td></tr><tr><td>ROI区域</td><td>ROIPosition</td><td>8</td></tr></tbody></table> 
<pre><code class="prism language-c">	<span class="token comment">//必须停止采集状态下设置，一般在MV_CC_StartGrabbing接口之前调用</span>
	<span class="token comment">//开启相机图像水印，如下，打开了Exposure、BrightnessInfo、Framecounter</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"FrameSpecInfoSelector"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Exposure</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetBoolValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"FrameSpecInfo"</span><span class="token punctuation">,</span> true<span class="token punctuation">)</span><span class="token punctuation">;</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"FrameSpecInfoSelector"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//BrightnessInfo</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetBoolValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"FrameSpecInfo"</span><span class="token punctuation">,</span> true<span class="token punctuation">)</span><span class="token punctuation">;</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"FrameSpecInfoSelector"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Framecounter</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetBoolValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"FrameSpecInfo"</span><span class="token punctuation">,</span> true<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set FrameSpecInfofail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<p>效果：<br> 主动取流中，图像结构体中获取水印信息<br> <img src="https://images2.imgbox.com/ec/54/noV1DpZg_o.png" alt="在这里插入图片描述"><br> 关闭水印功能</p> 
<pre><code class="prism language-c">	<span class="token comment">//必须停止采集状态下设置，一般在MV_CC_StartGrabbing接口之前调用</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"FrameSpecInfoSelector"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Framecounter</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetBoolValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"FrameSpecInfo"</span><span class="token punctuation">,</span> false<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="3AcquisitionControl_301"></a>3.采集控制/AcquisitionControl</h3> 
<h4><a id="31_302"></a>3.1采集模式设置</h4> 
<table><thead><tr><th align="center">参数</th><th>关键词</th><th align="center">参数值</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">单帧采集</td><td>SingleFrame</td><td align="center">0</td><td align="center">一般用于visionpro等特殊软件，正常<strong>不推荐使用这个模式</strong></td></tr><tr><td align="center">连续采集</td><td>Continuous</td><td align="center">2</td><td align="center">常用的模式，软触发的单帧采集，硬触发采集，连续拍照，都使用这个模式</td></tr></tbody></table> 
<pre><code class="prism language-c">	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"AcquisitionMode"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set FrameSpecInfofail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="32AcquisitionBurstFrameCount_314"></a>3.2多帧采集设置/AcquisitionBurstFrameCount</h4> 
<p>AcquisitionBurstFrameCount：在触发模式下，触发一次，采集多少帧，默认为1；<br> 假设设置为2，相机收到一个信号，自动采集两帧，采集频率根据帧率变化</p> 
<pre><code class="prism language-c">	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"AcquisitionBurstFrameCount"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set AcquisitionBurstFrameCountfail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="33AcquisitionFrameRate_324"></a>3.3帧率控制/AcquisitionFrameRate</h4> 
<pre><code class="prism language-c">	<span class="token comment">//设置相机帧率，需注意不要超过相机支持的最大的帧率（相机规格书），超过了也没有意义</span>
	nRet <span class="token operator">=</span><span class="token function">MV_CC_SetFloatValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"AcquisitionFrameRate"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set AcquisitionBurstFrameCountfail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//帧率控制使能，true表示打开，false标识关闭</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetBoolValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"AcquisitionFrameRateEnable"</span><span class="token punctuation">,</span> true<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set AcquisitionBurstFrameCountfail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="34_340"></a>3.4触发模式设置</h4> 
<h5><a id="341Software_341"></a>3.4.1软触发设置/Software</h5> 
<pre><code class="prism language-c">	<span class="token comment">// ch:设置触发模式为on </span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"TriggerMode"</span><span class="token punctuation">,</span> MV_TRIGGER_MODE_ON<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set Trigger Mode fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// ch:设置触发源为软触发</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"TriggerSource"</span><span class="token punctuation">,</span>MV_TRIGGER_SOURCE_SOFTWARE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//TriggerSource：7</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set Trigger Source fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<p>在需要拍摄图片的时刻，执行command命令，执行一次，相机拍摄一张图片（需在startgrabing命令开启后才行）</p> 
<pre><code class="prism language-c">	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetCommandValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"TriggerSoftware"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//相机拍照</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"TriggerSoftware fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="342line_364"></a>3.4.2硬触发设置/line</h5> 
<p><strong>硬触发要配合硬触发接线，配合的参数还有很多</strong>，参考：<a href="https://blog.csdn.net/qq_23107577/article/details/114106514?spm=1001.2014.3001.5501">海康工业相机功能模块-IO输入输出控制</a><br> 包括：<br> 1、触发模式：TriggerMode设置为1，开启触发模式<br> 2、触发源选择：TriggerSource设置为0，选择line0，也可以选择line2，或者选择anyway；line0、line2取决于硬件电路接线，anyway支持软触发、硬触发同时使用，需要看相机是否支持<br> 3、沿信号TriggerActivation：默认上升沿触发（可以不设置）<br> 4、触发缓存TriggerCacheEnable：默认不开启。当相机同时收到两个触发信号时，不开启此功能，相机只会响应1个信号，出一张图；开启后，相机会自动缓存第二个信号，上个信号处理完毕后，立即处理缓存信号<br> 5、触发延时TriggerDelay：收到信号后，固定延迟一段时间再曝光<br> 6、滤波设置 LineDebouncerTime：去除信号毛刺抖动，根据实际情况进行调节</p> 
<pre><code class="prism language-c">	<span class="token comment">// ch:设置触发模式为on </span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"TriggerMode"</span><span class="token punctuation">,</span> MV_TRIGGER_MODE_ON<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set Trigger Mode fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// ch:设置触发源为line硬触发</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"TriggerSource"</span><span class="token punctuation">,</span>MV_TRIGGER_SOURCE_LINE0<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//line0：0，line2：2</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set Trigger Source fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="343Anyway_387"></a>3.4.3任意触发设置/Anyway</h5> 
<p>Anyway即相机可以响应<strong>软触发命令，也可以响应line0、line2的硬触发信号</strong><br> 注意需要使用此功能时，需要了解相机是否支持该功能</p> 
<pre><code class="prism language-c">	<span class="token comment">// ch:设置触发模式为on </span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"TriggerMode"</span><span class="token punctuation">,</span> MV_TRIGGER_MODE_ON<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set Trigger Mode fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// ch:设置触发源为anyway</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"TriggerSource"</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//line0：0，line2：2，anyway：24</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set Trigger Source fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="35_404"></a>3.5曝光设置</h4> 
<h5><a id="351_405"></a>3.5.1手动曝光设置</h5> 
<pre><code class="prism language-c">	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"ExposureMode"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//0：Timed</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetFloatValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"ExposureTime"</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set ExposureTime fail nRet [0xd%]\n!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="352_414"></a>3.5.2自动曝光设置</h5> 
<pre><code class="prism language-c">	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"ExposureMode"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//0：Timed</span>
	<span class="token comment">//ExposureAuto</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetFloatValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"ExposureAuto"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//0：off 1：once 2：Continuous</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set ExposureAuto fail nRet [0xd%]\n!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
		<span class="token comment">//只有自动曝光或者自动增益开启后，Brightness亮度值方可设置</span>
		nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"Brightness"</span><span class="token punctuation">,</span><span class="token number">160</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set BrightnessnRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="353_433"></a>3.5.3超短曝光设置</h5> 
<pre><code class="prism language-c">		<span class="token comment">//标准曝光模式</span>
		nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"ExposureMode"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//0：Timed</span>
		nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"ExposureTimeMode"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//0：Standard，1：UltraShort</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set Trigger Mode fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ExposureTimeMode :Standard\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//需要注意曝光值范围</span>
			nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetFloatValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"ExposureTime"</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set ExposureTime fail nRet [0xd%]\n!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//超短曝光模式</span>
		nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"ExposureTimeMode"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//0：standard，1：UltraShort</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set Trigger Mode fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ExposureTimeMode :UltraShort\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//需要注意曝光值范围</span>
			nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetFloatValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"ExposureTime"</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set ExposureTime fail nRet [0xd%]\n!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="36HDR_469"></a>3.6HDR多曝光增益切换</h4> 
<pre><code class="prism language-c">	<span class="token keyword">unsigned</span> ExpValue<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">2000</span><span class="token punctuation">,</span><span class="token number">3000</span><span class="token punctuation">,</span><span class="token number">2500</span><span class="token punctuation">,</span><span class="token number">1300</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> GainValue<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"HDRSelector"</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置为最大值</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set HDRSelector  fail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"HDRShutter"</span><span class="token punctuation">,</span>ExpValue<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置为最大值</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set HDRShutter  fail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		nRet <span class="token operator">=</span><span class="token function">MV_CC_SetFloatValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"HDRGain"</span><span class="token punctuation">,</span> GainValue<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set HDRGain nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="4AnalogControl_493"></a>4.模拟控制/AnalogControl</h3> 
<h4><a id="41_494"></a>4.1模拟增益设置</h4> 
<pre><code class="prism language-c">	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetFloatValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"Gain"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set Gainfail fail nRet [0xd%]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="42_502"></a>4.2数字增益设置</h4> 
<pre><code class="prism language-c">	<span class="token comment">//打开数字增益使能</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetBoolValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"DigitalShiftEnable"</span><span class="token punctuation">,</span> true<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set DigitalShiftEnable fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//设置数字增益，范围-6~6db</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetFloatValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"DigitalShift"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set DigitalShift fail !nRet [0xd%]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="43Gamma_517"></a>4.3伽马设置/Gamma</h4> 
<pre><code class="prism language-c">	<span class="token comment">//1.打开数字增益使能</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetBoolValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"GammaEnable"</span><span class="token punctuation">,</span> true<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set GammaEnable fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//2.设置gamma类型，user：1，sRGB：2</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"GammaSelector"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set GammaSelector fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//3.设置gamma值，推荐范围0.5-2，1为线性拉伸</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetFloatValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"Gamma"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set Gamma failed! nRet [0xd%]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="44Sharpness_538"></a>4.4锐度设置/Sharpness</h4> 
<h5><a id="441_539"></a>4.4.1相机锐度设置</h5> 
<p>工业相机本身内部处理，支持锐度设置（相机硬件ISP处理）<br> 锐度需要注意相机图像格式，例如YUV、RGB、MONO10、MONO12等格式就不支持锐度，就需要通过其他方式实现</p> 
<pre><code class="prism language-c">	<span class="token comment">//打开锐度使能</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetBoolValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"SharpnessEnable"</span><span class="token punctuation">,</span> true<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set SharpnessEnable failed! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//设置锐度，范围0-100</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetFloatValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"Sharpness"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set Sharpness failed nRet [0xd%]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="442SDK_556"></a>4.4.2SDK锐度设置</h5> 
<p>当相机硬件在某些情况不支持锐度处理时，海康SDK提供了软件层面的锐度接口调用<br> 仅支持mono8格式与RGB格式，其他图像格式需要先行转化成这两种格式</p> 
<pre><code class="prism language-c"><span class="token keyword">static</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> __stdcall <span class="token function">WorkThread</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span> pUser<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> nRet <span class="token operator">=</span> MV_OK<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pConvertData <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pSharpenData <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> nConvertDataSize <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    MV_FRAME_OUT stImageInfo <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>					<span class="token comment">//图像帧信息结构体</span>
    MV_DISPLAY_FRAME_INFO stDisplayInfo <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>		<span class="token comment">//用于显示的</span>
	MV_CC_PIXEL_CONVERT_PARAM stConvertParam <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//用于格式转化的</span>
	MV_CC_SHARPEN_PARAM stSharpenParam <span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>	    <span class="token comment">//用于锐度的</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        nRet <span class="token operator">=</span> <span class="token function">MV_CC_GetImageBuffer</span><span class="token punctuation">(</span>pUser<span class="token punctuation">,</span> <span class="token operator">&amp;</span>stImageInfo<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//取一帧图像</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nRet <span class="token operator">==</span> MV_OK<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Get Image Buffer: Width[%d], Height[%d], FrameNum[%d]\n"</span><span class="token punctuation">,</span> 
                stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nWidth<span class="token punctuation">,</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nHeight<span class="token punctuation">,</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nFrameNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
			MvGvspPixelType enDstPixelType <span class="token operator">=</span> PixelType_Gvsp_Undefined<span class="token punctuation">;</span>
            <span class="token keyword">unsigned</span> <span class="token keyword">int</span> nChannelNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//用于判断图像通道数</span>
            <span class="token keyword">char</span> chFileName<span class="token punctuation">[</span>MAX_PATH<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token comment">//如果是彩色则转成RGB8</span>
            <span class="token comment">//isColor，isMono函数，看相机图像格式介绍章节</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsColor</span><span class="token punctuation">(</span>stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>enPixelType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//判断相机图像原始数据格式是什么</span>
            <span class="token punctuation">{<!-- --></span>
                nChannelNum <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
                enDstPixelType <span class="token operator">=</span> PixelType_Gvsp_RGB8_Packed<span class="token punctuation">;</span>
                <span class="token function">sprintf</span><span class="token punctuation">(</span>chFileName<span class="token punctuation">,</span> <span class="token string">"AfterConvert.rgb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//如果是黑白则转换成Mono8</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsMono</span><span class="token punctuation">(</span>stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>enPixelType<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                nChannelNum <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                enDstPixelType <span class="token operator">=</span> PixelType_Gvsp_Mono8<span class="token punctuation">;</span>
                <span class="token function">sprintf</span><span class="token punctuation">(</span>chFileName<span class="token punctuation">,</span> <span class="token string">"AfterConvert.gray"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Don't need to convert!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>enDstPixelType <span class="token operator">!=</span> PixelType_Gvsp_Undefined<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> pConvertData<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
				<span class="token comment">//分配一块区域用于格式转化</span>
					pConvertData <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nWidth <span class="token operator">*</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nHeight <span class="token operator">*</span> nChannelNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> pConvertData<span class="token punctuation">)</span>
					<span class="token punctuation">{<!-- --></span>
						<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc pConvertData fail!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						nRet <span class="token operator">=</span> MV_E_RESOURCE<span class="token punctuation">;</span>
						<span class="token keyword">break</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>                  
                nConvertDataSize <span class="token operator">=</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nWidth <span class="token operator">*</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nHeight <span class="token operator">*</span> nChannelNum<span class="token punctuation">;</span>
                <span class="token comment">// ch:像素格式转换 | en:Convert pixel format </span>
              
                stConvertParam<span class="token punctuation">.</span>nWidth <span class="token operator">=</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nWidth<span class="token punctuation">;</span>                 <span class="token comment">//ch:图像宽 | en:image width</span>
                stConvertParam<span class="token punctuation">.</span>nHeight <span class="token operator">=</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nHeight<span class="token punctuation">;</span>               <span class="token comment">//ch:图像高 | en:image height</span>
                stConvertParam<span class="token punctuation">.</span>pSrcData <span class="token operator">=</span> stImageInfo<span class="token punctuation">.</span>pBufAddr<span class="token punctuation">;</span>                         <span class="token comment">//ch:输入数据缓存 | en:input data buffer</span>
                stConvertParam<span class="token punctuation">.</span>nSrcDataLen <span class="token operator">=</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nFrameLen<span class="token punctuation">;</span>         <span class="token comment">//ch:输入数据大小 | en:input data size</span>
                stConvertParam<span class="token punctuation">.</span>enSrcPixelType <span class="token operator">=</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>enPixelType<span class="token punctuation">;</span>    <span class="token comment">//ch:输入像素格式 | en:input pixel format</span>
                stConvertParam<span class="token punctuation">.</span>enDstPixelType <span class="token operator">=</span> enDstPixelType<span class="token punctuation">;</span>                         <span class="token comment">//ch:输出像素格式 | en:output pixel format</span>
                stConvertParam<span class="token punctuation">.</span>pDstBuffer <span class="token operator">=</span> pConvertData<span class="token punctuation">;</span>                               <span class="token comment">//ch:输出数据缓存 | en:output data buffer</span>
                stConvertParam<span class="token punctuation">.</span>nDstBufferSize <span class="token operator">=</span> nConvertDataSize<span class="token punctuation">;</span>                       <span class="token comment">//ch:输出缓存大小 | en:output buffer size</span>
                nRet <span class="token operator">=</span> <span class="token function">MV_CC_ConvertPixelType</span><span class="token punctuation">(</span>pUser<span class="token punctuation">,</span> <span class="token operator">&amp;</span>stConvertParam<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//图像格式转化</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Convert Pixel Type fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span>
				<span class="token punctuation">{<!-- --></span>
					 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Convert Pixel Type ok!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>		
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>g_Sharpen<span class="token punctuation">)</span><span class="token comment">//全局变量，用于判断要不要做锐化</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> pSharpenData<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					pSharpenData <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nWidth <span class="token operator">*</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nHeight <span class="token operator">*</span> nChannelNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> pSharpenData<span class="token punctuation">)</span>
					<span class="token punctuation">{<!-- --></span>
						<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"malloc pConvertData fail!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						nRet <span class="token operator">=</span> MV_E_RESOURCE<span class="token punctuation">;</span>
						<span class="token keyword">break</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
				stSharpenParam<span class="token punctuation">.</span>nWidth <span class="token operator">=</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nWidth<span class="token punctuation">;</span>
				stSharpenParam<span class="token punctuation">.</span>nHeight <span class="token operator">=</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nHeight<span class="token punctuation">;</span>
				stSharpenParam<span class="token punctuation">.</span>enPixelType <span class="token operator">=</span> enDstPixelType<span class="token punctuation">;</span>				<span class="token comment">//像素格式变化,用转化后的图像格式传入</span>
				stSharpenParam<span class="token punctuation">.</span>pSrcBuf <span class="token operator">=</span> stConvertParam<span class="token punctuation">.</span>pDstBuffer<span class="token punctuation">;</span>			<span class="token comment">//输入</span>
				stSharpenParam<span class="token punctuation">.</span>nSrcBufLen <span class="token operator">=</span> stConvertParam<span class="token punctuation">.</span>nDstBufferSize<span class="token punctuation">;</span><span class="token comment">//数据大小变化</span>
				stSharpenParam<span class="token punctuation">.</span>pDstBuf <span class="token operator">=</span> pSharpenData<span class="token punctuation">;</span>						<span class="token comment">//输出，后续处理要用这个数据啦</span>
				stSharpenParam<span class="token punctuation">.</span>nDstBufSize <span class="token operator">=</span> stConvertParam<span class="token punctuation">.</span>nDstBufferSize<span class="token punctuation">;</span>	<span class="token comment">//数据大小变化</span>
				stSharpenParam<span class="token punctuation">.</span>nSharpenAmount <span class="token operator">=</span> m_nSharpenAmount<span class="token punctuation">;</span>
				stSharpenParam<span class="token punctuation">.</span>nSharpenRadius <span class="token operator">=</span> m_nSharpenRadius<span class="token punctuation">;</span>
				stSharpenParam<span class="token punctuation">.</span>nSharpenThreshold <span class="token operator">=</span> m_nSharpenThreshold<span class="token punctuation">;</span>
				nRet <span class="token operator">=</span> <span class="token function">MV_CC_ImageSharpen</span><span class="token punctuation">(</span>pUser<span class="token punctuation">,</span> <span class="token operator">&amp;</span>stSharpenParam<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Image Sharpen fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span>
				<span class="token punctuation">{<!-- --></span>
					 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Sharpen :50 ok!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			T2<span class="token operator">=</span><span class="token function">qMyMilliseconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//计时函数，可以删除</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Grab ok!，costtime：%f\n"</span><span class="token punctuation">,</span>T2<span class="token operator">-</span>T1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>g_hwnd<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                stDisplayInfo<span class="token punctuation">.</span>hWnd <span class="token operator">=</span> g_hwnd<span class="token punctuation">;</span>
                stDisplayInfo<span class="token punctuation">.</span>pData <span class="token operator">=</span> pSharpenData<span class="token punctuation">;</span>
                stDisplayInfo<span class="token punctuation">.</span>nDataLen <span class="token operator">=</span> nConvertDataSize<span class="token punctuation">;</span>
                stDisplayInfo<span class="token punctuation">.</span>nWidth <span class="token operator">=</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nWidth<span class="token punctuation">;</span>
                stDisplayInfo<span class="token punctuation">.</span>nHeight <span class="token operator">=</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nHeight<span class="token punctuation">;</span>
                stDisplayInfo<span class="token punctuation">.</span>enPixelType <span class="token operator">=</span> enDstPixelType<span class="token punctuation">;</span><span class="token comment">//像素格式变化</span>
                nRet <span class="token operator">=</span><span class="token function">MV_CC_DisplayOneFrame</span><span class="token punctuation">(</span>pUser<span class="token punctuation">,</span> <span class="token operator">&amp;</span>stDisplayInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
			MV_SAVE_IMG_TO_FILE_PARAM stSaveFileParam<span class="token punctuation">;</span><span class="token comment">//存图测试，可以删除，不调用</span>
			<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>stSaveFileParam<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>MV_SAVE_IMG_TO_FILE_PARAM<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			stSaveFileParam<span class="token punctuation">.</span>enImageType <span class="token operator">=</span> MV_Image_Bmp<span class="token punctuation">;</span> <span class="token comment">// ch:需要保存的图像类型 | en:Image format to save</span>
			stSaveFileParam<span class="token punctuation">.</span>enPixelType <span class="token operator">=</span> enDstPixelType<span class="token punctuation">;</span>  <span class="token comment">// ch:相机对应的像素格式 | en:Camera pixel type</span>
			stSaveFileParam<span class="token punctuation">.</span>nWidth      <span class="token operator">=</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nWidth<span class="token punctuation">;</span>         <span class="token comment">// ch:相机对应的宽 | en:Width</span>
			stSaveFileParam<span class="token punctuation">.</span>nHeight     <span class="token operator">=</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nHeight<span class="token punctuation">;</span>          <span class="token comment">// ch:相机对应的高 | en:Height</span>
			stSaveFileParam<span class="token punctuation">.</span>nDataLen    <span class="token operator">=</span> nConvertDataSize<span class="token punctuation">;</span>
			stSaveFileParam<span class="token punctuation">.</span>pData       <span class="token operator">=</span> pSharpenData<span class="token punctuation">;</span>
			stSaveFileParam<span class="token punctuation">.</span>iMethodValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			 <span class="token comment">// ch:jpg图像质量范围为(50-99], png图像质量范围为[0-9] | en:jpg image nQuality range is (50-99], png image nQuality range is [0-9]</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_Image_Bmp <span class="token operator">==</span> stSaveFileParam<span class="token punctuation">.</span>enImageType<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">sprintf_s</span><span class="token punctuation">(</span>stSaveFileParam<span class="token punctuation">.</span>pImagePath<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token string">"Image_w%d_h%d_fn%03d_%d_%d_%d.bmp"</span><span class="token punctuation">,</span> stSaveFileParam<span class="token punctuation">.</span>nWidth<span class="token punctuation">,</span> stSaveFileParam<span class="token punctuation">.</span>nHeight<span class="token punctuation">,</span> stImageInfo<span class="token punctuation">.</span>stFrameInfo<span class="token punctuation">.</span>nFrameNum<span class="token punctuation">,</span>m_nSharpenAmount<span class="token punctuation">,</span>m_nSharpenAmount<span class="token punctuation">,</span>m_nSharpenThreshold<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			nRet <span class="token operator">=</span> <span class="token function">MV_CC_SaveImageToFile</span><span class="token punctuation">(</span>pUser<span class="token punctuation">,</span><span class="token operator">&amp;</span>stSaveFileParam<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"MV_CC_SaveImageToFile fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span>
				<span class="token punctuation">{<!-- --></span>
					 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"MV_CC_SaveImageToFile  ok!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

            nRet <span class="token operator">=</span> <span class="token function">MV_CC_FreeImageBuffer</span><span class="token punctuation">(</span>pUser<span class="token punctuation">,</span> <span class="token operator">&amp;</span>stImageInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Free Image Buffer fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//printf("Get Image fail! nRet [0x%x]\n", nRet);</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>g_bExit<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="45BalanceWhiteAuto_719"></a>4.5白平衡设置/BalanceWhiteAuto</h4> 
<h4><a id="451__720"></a>4.5.1 自动白平衡</h4> 
<pre><code class="prism language-c">	<span class="token comment">//开启自动白平衡</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"BalanceWhiteAuto"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set BalanceWhiteAuto  fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//取流之后，自动白平衡采集一段时间，相机自动调整</span>
	<span class="token comment">//调整完毕后后，关闭自动白平衡，即可</span>
	<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//关闭自动白平衡</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"BalanceWhiteAuto"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set BalanceWhiteAuto  fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="452__738"></a>4.5.2 手动白平衡</h4> 
<pre><code class="prism language-c">	<span class="token comment">//关闭自动白平衡</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"BalanceWhiteAuto"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Set BalanceWhiteAuto  fail! nRet [0x%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//手动白平衡设置</span>
	<span class="token keyword">int</span> BalanceRatio_Value<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">1100</span><span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token number">1800</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//R、G、B</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"BalanceRatioSelector"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"BalanceRatio"</span><span class="token punctuation">,</span>BalanceRatio_Value<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="5IODigitalIOControl_756"></a>5.数字IO控制/DigitalIOControl</h3> 
<h4><a id="51IO_757"></a>5.1IO输出控制</h4> 
<p><strong>相机IO控制，主要用于控制IO信号输出</strong>，详情参考文章IO输出部分：<a href="https://blog.csdn.net/qq_23107577/article/details/114106514?spm=1001.2014.3001.5501">海康工业相机功能模块-IO输入输出控制</a></p> 
<h4><a id="52IO_759"></a>5.2IO输出输出事件介绍</h4> 
<p>IO输出也可以由相机控制，在相机工作的不同的时间段，给出一个输出信号，控制外部设备，海康工业相机支持的IO事件包括如下几种</p> 
<table><thead><tr><th>事件源名称</th><th>关键词</th><th>参数值</th><th>功能说明</th></tr></thead><tbody><tr><td>曝光开始</td><td>ExposureStartActive</td><td>0</td><td>sensor开始曝光时，输出信号</td></tr><tr><td>采集开始</td><td>AcquisitionStartActive</td><td>1</td><td>数据开始读出时输出信号，帧读出开始时刻</td></tr><tr><td>采集结束</td><td>AcquisitionStopActive</td><td>2</td><td>数据结束读出时输出信号，帧读出结束时刻</td></tr><tr><td>出图开始</td><td>FrameBurstStartActive</td><td>3</td><td>图像数据开始通过链路发送时刻输出信号，brust&gt;2才有信号输出，往往没啥用</td></tr><tr><td>出图结束</td><td>FrameBurstEndActive</td><td>4</td><td>图像数据通过链路发送结束时刻输出信号，brust&gt;2才有信号输出，往往没啥用</td></tr><tr><td>软触发输出</td><td>SoftTriggerActive</td><td>5</td><td>软件调用command命令时刻，输出，用户自主可控</td></tr><tr><td>硬触发输出</td><td>HardTriggerActive</td><td>6</td><td>相机输入信号line0\2收到输入信号时，输出一个输出信号</td></tr><tr><td>计数器输出</td><td>TimerActive</td><td>7</td><td>计时器，计算line0、line2收到指定信号个数，输出一个输出信号</td></tr><tr><td>触发等待输出</td><td>FrameTriggerWait</td><td>8</td><td>相机可以被触发，可以曝光采集时，触发信号</td></tr></tbody></table> 
<p>常用的有曝光开始、软触发输出、硬触发输出<br> 举例：</p> 
<pre><code class="prism language-c">	<span class="token comment">//参数初始化</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"LineSelector"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//选择对应的硬件输出源</span>
	<span class="token comment">//0:Line0 1:Line1 2:Line2 </span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"LineMode"</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//仅line2需要设置</span>
	<span class="token comment">//0:Input 1:Output 8:Strobe </span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"LineSource"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//0:ExposureStartActive 5:SoftTriggerActive  6:HardTriggerActive</span>
	<span class="token keyword">int</span> DurationValue<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>DelayValue<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>PreDelayValue<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//us</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"StrobeLineDuration"</span><span class="token punctuation">,</span>DurationValue<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//脉宽持续时间</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"StrobeLineDelay"</span><span class="token punctuation">,</span>DelayValue<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//strobe延时，从曝光开始，延时多久输出</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"StrobeLinePreDelay"</span><span class="token punctuation">,</span>PreDelayValue<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//strobe提前输出，曝光延后开始</span>
	nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetBoolValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"StrobeEnable"</span><span class="token punctuation">,</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//Strobe输出使能，使能之后，上面配置参数生效，IO输出与LineSource同步</span>
<span class="token comment">//-------------------------------------------------------------------------------------</span>
<span class="token comment">//输出IO信号命令，需要时，调用此行代码，相机通过line2输出一个周期1100us的方波，有效脉宽1000us</span>
nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetCommandValue</span><span class="token punctuation">(</span>m_handle<span class="token punctuation">,</span> <span class="token string">"LineTriggerSoftware"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="6ActionControl_793"></a>6.动作命令控制/ActionControl</h3> 
<h3><a id="7FileAccessControl_795"></a>7.文件访问控制/FileAccessControl</h3> 
<h3><a id="8EventControl_796"></a>8.事件监视/EventControl</h3> 
<h4><a id="81_797"></a>8.1曝光结束时间</h4> 
<h3><a id="9ChunkDataControl_798"></a>9.数据块控制/ChunkDataControl</h3> 
<h3><a id="10TransportLayerControl_799"></a>10.传输层控制/TransportLayerControl</h3> 
<h4><a id="101_800"></a>10.1心跳时间设置</h4> 
<pre><code class="prism language-c"><span class="token comment">//mv_cc_Opendevice之后调用</span>
<span class="token comment">//推荐值3000-60000ms，不建议低于3000ms，容易掉线</span>
nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetIntValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span><span class="token string">"GevHeartbeatTimeout"</span><span class="token punctuation">,</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//单位ms</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>nRet <span class="token operator">!=</span> MV_OK<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Warning: Set Width  fail nRet [0x%x]!"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="11UserSetControl_810"></a>11.用户集控制/UserSetControl</h3> 
<h4><a id="111_811"></a>11.1保存参数到相机</h4> 
<p>保存参数到userset，确保相机掉电后，参数不消失</p> 
<pre><code class="prism language-c"><span class="token comment">//初始化部分，放在Opendevice之后即可</span>
nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"UserSetSelector"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//支持1、2、3组，3组不同参数保存</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"error: SetEnumValue UserSetSelector fail [%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"UserSetDefault"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//选择上电后，默认加载那一组参数</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"error: SetEnumValue UserSetDefault fail [%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">//大部分参数修改完成后，调用此命令进行保存，不建议频繁调用</span>
nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetCommandValue</span><span class="token punctuation">(</span>m_handle<span class="token punctuation">,</span> <span class="token string">"UserSetSave"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//保存命令</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"error: SetCommandValue fail [%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="112_834"></a>11.2恢复出厂默认参数</h4> 
<pre><code class="prism language-c"><span class="token comment">//相机停止采集后才能调用</span>
nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetEnumValue</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">"UserSetSelector"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//1、2、3是用户自己保存的参数，0是相机出厂参数</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"error: SetEnumValue UserSetSelector fail [%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
nRet <span class="token operator">=</span> <span class="token function">MV_CC_SetCommandValue</span><span class="token punctuation">(</span>m_handle<span class="token punctuation">,</span> <span class="token string">"UserSetLoad"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//加载0组参数</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>MV_OK <span class="token operator">!=</span> nRet<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"error: SetCommandValue fail [%x]\n"</span><span class="token punctuation">,</span> nRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e98461188d3483c816a11640cb7c3814/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">火狐：导入一个相同证书报错</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bb062cd4e139fd27b8891be7d5c2629f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">模电_第八章_功率放大电路</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>