<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>React note9（脚手架：性能优化&amp;react脚手架端口&amp;项目如何启动&amp;避开eslint语法检查） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="React note9（脚手架：性能优化&amp;react脚手架端口&amp;项目如何启动&amp;避开eslint语法检查）" />
<meta property="og:description" content="性能优化 勾选变色
我们先用传统写法来完成勾选变色的功能，会使用到父子组件间的正传、逆传。
在判 &#34; 勾选的是谁 &#34; 时，思路是这样的：先是父组件正传一个函数给子组件，子组件将同时传过来的数组里某个对象的index绑定给父组件传过来的函数，然后在父组件的函数体里面通过子组件反传的变量index判断当前需要改变的元素是数组里面的哪个元素，然后改变该元素的style值。
当然，真正的dom元素样式改变是在子组件里面，通过判断父组件正传过来的style的值为true就变色，为false就不变色。
&gt;&gt;Check1.jsx --- 父 import React, { Component } from &#39;react&#39; import Check2 from &#34;./check2.jsx&#34; export default class check2 extends Component { constructor(props){ super(props) this.state={ arr:[ {name:&#34;路飞&#34;,style:false}, {name:&#34;呢子扣&#34;,style:false}, {name:&#34;炭治郎&#34;,style:false}, ] } } fun=(num)=&gt;{ //console.log(num);//找到勾选的是谁 let newarr=this.state.arr; newarr[num].style=!newarr[num].style; this.setState({ arr:newarr }) } list=()=&gt;{ // 不在render里写，避免污染 return this.state.arr.map((item,index)=&gt;{ return( &lt;Check2 key={index} name={item.name} style={item.style} num={index} listfun={this.fun} /&gt; ) }) } render() { return ( &lt;div&gt; &lt;h4&gt;I&#39; check1 as a father." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/916667612387a0169ab561e66b6387af/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-31T16:32:34+08:00" />
<meta property="article:modified_time" content="2020-08-31T16:32:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">React note9（脚手架：性能优化&amp;react脚手架端口&amp;项目如何启动&amp;避开eslint语法检查）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_2"></a>性能优化</h2> 
<hr> 
<p>勾选变色</p> 
<p>我们先用传统写法来完成勾选变色的功能，会使用到父子组件间的正传、逆传。</p> 
<p>在判 " 勾选的是谁 " 时，思路是这样的：先是父组件正传一个函数给子组件，子组件将同时传过来的数组里某个对象的index绑定给父组件传过来的函数，然后在父组件的函数体里面通过子组件反传的变量index判断当前需要改变的元素是数组里面的哪个元素，然后改变该元素的style值。</p> 
<p>当然，真正的dom元素样式改变是在子组件里面，通过判断父组件正传过来的style的值为true就变色，为false就不变色。</p> 
<pre><code class="prism language-js"><span class="token operator">&gt;&gt;</span>Check1<span class="token punctuation">.</span>jsx <span class="token operator">--</span><span class="token operator">-</span> 父

<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> Check2 <span class="token keyword">from</span> <span class="token string">"./check2.jsx"</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">check2</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
            arr<span class="token punctuation">:</span><span class="token punctuation">[</span>
                <span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span><span class="token string">"路飞"</span><span class="token punctuation">,</span>style<span class="token punctuation">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span><span class="token string">"呢子扣"</span><span class="token punctuation">,</span>style<span class="token punctuation">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span><span class="token string">"炭治郎"</span><span class="token punctuation">,</span>style<span class="token punctuation">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">fun</span><span class="token operator">=</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//console.log(num);//找到勾选的是谁</span>
        <span class="token keyword">let</span> newarr<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>arr<span class="token punctuation">;</span>
        newarr<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token operator">=</span><span class="token operator">!</span>newarr<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            arr<span class="token punctuation">:</span>newarr
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">list</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 不在render里写，避免污染</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span><span class="token punctuation">(</span>
                <span class="token operator">&lt;</span>Check2 key<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>index<span class="token punctuation">}</span> name<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span> style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">.</span>style<span class="token punctuation">}</span> num<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>index<span class="token punctuation">}</span> listfun<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>fun<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>h4<span class="token operator">&gt;</span><span class="token constant">I</span>' check1 <span class="token keyword">as</span> a father<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>h4<span class="token operator">&gt;</span>
                <span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-js"><span class="token operator">&gt;&gt;</span>Check2<span class="token punctuation">.</span>jsx<span class="token operator">--</span><span class="token operator">-</span>子

<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">check2</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">let</span> <span class="token punctuation">{<!-- --></span>name<span class="token punctuation">,</span>style<span class="token punctuation">,</span>num<span class="token punctuation">,</span>listfun<span class="token punctuation">}</span><span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>
        <span class="token comment">//console.log("我是子组件");</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>color<span class="token punctuation">:</span>style<span class="token operator">?</span><span class="token string">"red"</span><span class="token punctuation">:</span><span class="token string">""</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"checkbox"</span> onChange<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>listfun<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span><span class="token comment">/*逆向传值*/</span><span class="token punctuation">}</span>
                <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f2/0d/arluyfoC_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>有没有发现一个问题：<br> 咱们在子组件的render中添加一个输出，发现每次运行的时候子组件都被调用了多次。为什么会这样？</p> 
<p>原因是我们在更新数据的时候，使用setState修改整个数据，而当数据变了，在遍历的时候所有内容都要被重新渲染。</p> 
<p>如果数据数量少还好，如果遍历出来的数据很多，就会严重影响性能。</p> 
<p>做项目时尽量避免这种逆传。</p> 
<p>那有没有什么解决方案呢？整理了三种。</p> 
<br> 
<h4><a id="1_89"></a>提高性能–方案1</h4> 
<p>使用生命周期的钩子：</p> 
<pre><code>shouldComponentUpdate(nextProps,nextState)  // 判定组件是否要更新

//nextProps---最新的props ; nextState---最新的state
</code></pre> 
<p><img src="https://images2.imgbox.com/de/ec/BWSiFrlh_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ba/56/QMSXFeP5_o.png" alt="在这里插入图片描述"><br> 运行之后发现可以减少不必要的渲染，提高性能。</p> 
<br> 
<h4><a id="2_102"></a>提高性能–方案2</h4> 
<p>纯组件（PureComponent）— <strong>类组件</strong>中使用。</p> 
<p><code>PureComponent</code>是优化react应用程序最重要的方法。组件发生更新时，组件的props和state没有改变，render方法就不会触发 。可以减少不必要的render次数，提高性能。</p> 
<p>省去虚拟dom生成和对比的过程，其实就是react自动帮忙做了一个浅比较（它只比较props和state的内存地址，如果内存地址相同，则shouldComponentUpdate生命周期就返回false。）<br> <img src="https://images2.imgbox.com/06/80/4SuyWY3p_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/89/bf/OtUaXzSF_o.png" alt="在这里插入图片描述"></p> 
<br> 
<h4><a id="3_113"></a>提高性能–方案3</h4> 
<p><code>React.memo()</code> — <strong>无状态组件</strong>中使用。</p> 
<p>类似于PureComponent，不过React.memo是函数/无状态组件，React.PureComponent是类组件。</p> 
<p>memo依然是一种对象的浅比较。<br> <img src="https://images2.imgbox.com/e5/2e/rrTeulyc_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/f7/95/hgBPCftx_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="react_125"></a>修改react脚手架端口</h2> 
<hr> 
<pre><code>react脚手架端口号：默认是3000

修改路径：
当前项目路径/node_modules/react-scripts/scripts/start.js

改端口： 
onst DEFAULT_PORT = parseInt(process.env.PORT, 10) || 5000（你要修改的端口）;
</code></pre> 
<p><img src="https://images2.imgbox.com/f6/16/50P9NyN5_o.png" alt="在这里插入图片描述"></p> 
<br> 
<h2><a id="_140"></a>怎么知道项目是如何启动的</h2> 
<hr> 
<p>为什么create-react-app的启动命令是 npm start？和vue不一样？</p> 
<p>怎么知道启动项目的方法？</p> 
<p>找到项目中的 package.json文件找到 scripts属性：<br> <img src="https://images2.imgbox.com/cf/9d/k5qpPuA9_o.png" alt="在这里插入图片描述"></p> 
<p>大家发现是start，那么启动命令就是 npm run start / npm start（只有是start的时候可以省略run 别的不行）<br> <img src="https://images2.imgbox.com/9f/a2/igeMt7nh_o.png" alt="在这里插入图片描述"></p> 
<p>修改之后 那么启动项目就必须是 npm run dev 。</p> 
<br> 
<h2><a id="_157"></a>项目中遇到的问题</h2> 
<hr> 
<p>在react脚手架中使用 confirm 有时会报错，原因是 eslint 屏蔽了这个方法。<br> <img src="https://images2.imgbox.com/d9/46/FWUCXj2o_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/2d/ce/IYxqEwuw_o.png" alt="在这里插入图片描述"></p> 
<p>解决方式：使用 <code>// eslint-disable-next-line</code>这句注解js语句，就不用进行eslint语法检查了。<br> <img src="https://images2.imgbox.com/fe/b8/UIexVMuI_o.png" alt="在这里插入图片描述"></p> 
<p>Eslint：脚手架中默认安装了，但是建议在没有特殊需求的情况下不要去配置，以免不小心修改其他配置内容。</p> 
<br> 
<h2><a id="_172"></a>总结</h2> 
<hr> 
<p>一、为了解决上面这种消耗性能的情况，然后为了提高性能， 3种解决方式：</p> 
<p>1、钩子 <code>shouldComponentUpdate(nextProps,nextState)</code><br> 2、纯组件 <code>PureComponent</code><br> 3、无状态组件中使用的性能优化 <code>React.memo()</code></p> 
<p>二、在react项目中，如果想改变端口号，可以在/node_modules/react-scripts/scripts/start.js中进行修改。</p> 
<p><img src="https://images2.imgbox.com/a1/2b/sIGk5AZk_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p>三、// eslint-disable-next-line 可以让下面一句取消eslint验证。</p> 
<p>四、react脚手架中，通过 npm start 或者 npm run start 启动项目，不是所有命令都可以通过 npm 命令名 来实现。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/68408ed8c7fbe8d4c7a22f1387f66d3c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">214. 最短回文串20200831</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/eb2e45e162828badf4b12c5612283c21/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">js遍历数组三种方式对比利弊</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>