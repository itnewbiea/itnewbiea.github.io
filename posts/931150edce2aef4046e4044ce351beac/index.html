<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>k8s陈述式资源管理（命令行） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="k8s陈述式资源管理（命令行）" />
<meta property="og:description" content="1、资源管理 （1）陈述式资源管理（常用——查、增）
使用kubectl工具进行命令行管理
①特点：对资源的增删查比较方便，对改不友好
②优点：90%以上的场景都可以满足
③缺点：命令冗长、复杂
（2）声明式资源管理（常用——部署资源）
使用yml文件进行声明式资源管理
（3）GUI图形化资源管理
2、kubectl命令详解 （1）查看 kubectl命令大全网站http://docs.kubernetes.org.cn/683.html
查看版本信息
kubectl version
查看所有api的资源对象
kubectl api-resources
查看k8s的集群信息
kubectl cluster-info
自动补齐命令
基本信息查看
查看master节点的状态
kubectl get cs
查看默认命名空间内的pod信息
kubectl get pod
查看当前集群所有命名空间
kubectl get namespaces
查看指定命名空间里的pod
kubectl get pod -n 命名空间名称
查看默认命名空间内pod的详细信息
kubectl get pod -o wide
查看指定命名空间内的pod详细信息
kubectl get pod -o wide -n 命名空间名称
查看node节点信息和状态
kubectl get node
查看node节点的详细信息
kubectl get node -o wide
查看已经部署好的pod的详细信息
kubectl describe pod pod名称" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/931150edce2aef4046e4044ce351beac/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-01T23:12:04+08:00" />
<meta property="article:modified_time" content="2024-01-01T23:12:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">k8s陈述式资源管理（命令行）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="margin-left:.0001pt;text-align:left;"><strong><strong>1、资源管理</strong></strong></h2> 
<p style="margin-left:.0001pt;text-align:left;"><strong><strong>（1）陈述式资源管理</strong></strong><strong><span style="color:#ff0000;"><strong>（常用——查、增）</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;">使用kubectl工具进行命令行管理</p> 
<p style="margin-left:.0001pt;text-align:left;">①特点：对资源的增删查比较方便，对改不友好</p> 
<p style="margin-left:.0001pt;text-align:left;">②优点：90%以上的场景都可以满足</p> 
<p style="margin-left:.0001pt;text-align:left;">③缺点：命令冗长、复杂</p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><strong>（2）声明式资源管理</strong></strong><strong><span style="color:#ff0000;"><strong>（常用——部署资源）</strong></span></strong></p> 
<p style="margin-left:.0001pt;text-align:left;">使用yml文件进行声明式资源管理</p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><strong>（</strong></strong><strong><strong>3</strong></strong><strong><strong>）</strong></strong><strong><strong>GUI图形化资源管理</strong></strong></p> 
<h2 style="background-color:transparent;margin-left:.0001pt;text-align:left;"><strong><strong>2、kubectl命令详解</strong></strong></h2> 
<h3 style="background-color:transparent;margin-left:.0001pt;text-align:left;"><strong><strong>（1）查看</strong></strong></h3> 
<p style="margin-left:.0001pt;text-align:left;">kubectl命令大全网站http://docs.kubernetes.org.cn/683.html</p> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="566" src="https://images2.imgbox.com/52/c4/eMxab9SG_o.png" width="404"></p> 
<table border="1" cellspacing="0"><tbody><tr><td> <p style="margin-left:.0001pt;text-align:left;">查看版本信息</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl version</p> </td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">查看所有api的资源对象</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl api-resources</p> </td></tr><tr><td colspan="2"><img alt="" height="196" src="https://images2.imgbox.com/c4/7d/KAxcWZUp_o.png" width="651"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">查看k8s的集群信息</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl cluster-info</p> </td></tr><tr><td colspan="2"><img alt="" height="158" src="https://images2.imgbox.com/80/f7/nTBxvQjs_o.png" width="740"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">自动补齐命令</p> </td><td><img alt="" height="35" src="https://images2.imgbox.com/89/34/WkIsjJOd_o.png" width="553"></td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:center;"><strong><strong>基本信息查看</strong></strong></p> </td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">查看master节点的状态</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl get cs</p> </td></tr><tr><td colspan="2"><img alt="" height="135" src="https://images2.imgbox.com/a6/5a/jTF61RCx_o.png" width="667"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">查看默认命名空间内的pod信息</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl get pod</p> </td></tr><tr><td colspan="2"><img alt="" height="112" src="https://images2.imgbox.com/36/68/SRfQLZr6_o.png" width="741"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">查看当前集群所有命名空间</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl get namespaces</p> </td></tr><tr><td colspan="2"><img alt="" height="160" src="https://images2.imgbox.com/ba/91/vflaEuL5_o.png" width="513"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">查看指定命名空间里的pod</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl get pod -n 命名空间名称</p> </td></tr><tr><td colspan="2"><img alt="" height="351" src="https://images2.imgbox.com/f8/1a/8Xk5pHks_o.png" width="739"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">查看默认命名空间内pod的详细信息</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl get pod -o wide</p> </td></tr><tr><td colspan="2"><img alt="" height="72" src="https://images2.imgbox.com/0d/01/gbC0OZ3q_o.png" width="831"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">查看指定命名空间内的pod详细信息</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl get pod -o wide -n 命名空间名称</p> </td></tr><tr><td colspan="2"><img alt="" height="70" src="https://images2.imgbox.com/39/8f/pycb2N8X_o.png" width="830"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">查看node节点信息和状态</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl get node</p> </td></tr><tr><td colspan="2"><img alt="" height="108" src="https://images2.imgbox.com/32/24/AbkXgBtn_o.png" width="637"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">查看node节点的详细信息</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl get node -o wide</p> </td></tr><tr><td colspan="2"><img alt="" height="54" src="https://images2.imgbox.com/0c/27/WhkfY8nm_o.png" width="830"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">查看已经部署好的pod的详细信息</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl describe pod <strong><strong>pod名称</strong></strong></p> </td></tr><tr><td colspan="2"><img alt="" height="296" src="https://images2.imgbox.com/ba/a2/L0Kkc9AN_o.png" width="726"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">查看指定命名空间里的pod的详细情况</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl describe pod <strong><strong>pod名称</strong></strong> -n 命名空间名称</p> </td></tr><tr><td colspan="2"><img alt="" height="174" src="https://images2.imgbox.com/b5/9c/l3Ok8p4X_o.png" width="745"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">动态查看pod日志</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl logs -f <strong><strong>pod名称</strong></strong></p> </td></tr><tr><td colspan="2"><img alt="" height="280" src="https://images2.imgbox.com/9b/55/TEQAPUyM_o.png" width="745"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">动态查看指定命名空间的pod日志</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl logs -f <strong><strong>pod名称 </strong></strong>-n 命名空间名称</p> </td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">创建命名空间</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl create ns 名称</p> </td></tr><tr><td colspan="2"><img alt="" height="225" src="https://images2.imgbox.com/ff/a5/AxXOgk0T_o.png" width="535"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">删除命名空间</p> </td><td> <p style="margin-left:.0001pt;text-align:left;">kubectl delete ns 名称</p> </td></tr><tr><td colspan="2"><img alt="" height="380" src="https://images2.imgbox.com/28/c2/nARo9Sgh_o.png" width="524"></td></tr><tr><td> <p style="margin-left:.0001pt;text-align:left;">删除pod（没有真正删除）</p> </td><td> <p style="margin-left:.0001pt;text-align:left;"> kubectl delete pod <strong><strong>pod名称</strong></strong></p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="201" src="https://images2.imgbox.com/ac/a0/Tgo4k7ar_o.png" width="761"><img alt="" height="177" src="https://images2.imgbox.com/aa/24/tCNlQYGo_o.png" width="738">生成一个新的pod</p> </td></tr></tbody></table> 
<h3 style="margin-left:.0001pt;text-align:left;"><strong><strong>（2）部署</strong></strong></h3> 
<h4 style="margin-left:.0001pt;text-align:left;"><strong><strong>1）deployment部署pod的两种方式</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:left;">①陈述式部署（命令行）</p> 
<p style="margin-left:.0001pt;text-align:left;">②声明式部署（yml）</p> 
<h4 style="margin-left:.0001pt;text-align:left;"><strong><strong>2）特点</strong></strong></h4> 
<p style="margin-left:.0001pt;text-align:left;"><strong><strong>①滚动更新：</strong></strong>不是一次性把所有pod全部部署，而是依次部署，主要在pod更新时使用，逐步引入新的pod，逐步减少旧的pod</p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><strong>②自我修复：</strong></strong>若有pod节点发生故障，deployment会自动启动新的pod进行代替</p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><strong>③回滚：</strong></strong>若更新有问题，deployment会提供还原点，可以手动还原到未更新前的状态</p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><strong>④扩容和缩容：</strong></strong>deployment可以随时调整pod的数量，以适应流量的变化</p> 
<p style="margin-left:.0001pt;text-align:left;"><strong><strong>注：必须基于deployment创建的服务才能实现以上功能</strong></strong><strong><span style="color:#ff0000;"><strong>（绝大多数都使用deployment创建）</strong></span></strong></p> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:375.9pt;"> <p style="margin-left:.0001pt;text-align:left;">查看默认命名空间里基于deployment创建的pod</p> </td><td style="width:332.8pt;"> <p style="margin-left:.0001pt;text-align:left;"> kubectl get deployments.apps</p> </td></tr><tr><td colspan="2"><img alt="" height="95" src="https://images2.imgbox.com/0f/b9/EWTSALbu_o.png" width="572"></td></tr><tr><td style="width:375.9pt;"> <p style="margin-left:.0001pt;text-align:left;">查看指定命名空间里deployment创建的pod</p> </td><td style="width:332.8pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl get deployments.apps -n kube-system</p> </td></tr><tr><td colspan="2"><img alt="" height="68" src="https://images2.imgbox.com/20/b5/DM6TI5WF_o.png" width="684"></td></tr><tr><td style="width:375.9pt;"> <p style="margin-left:.0001pt;text-align:left;">查看默认空间里daemonsets创建的pod</p> </td><td style="width:332.8pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl get daemonsets.apps</p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;">daemonset不能在命令行创建，只能用yml文件来创建pod，后台运行创建，在每个节点上创建一个方式相同、版本相同的容器运行的pod。一般是依赖环境和重要组件，不会对这些资源进行操作</p> </td></tr><tr><td colspan="2"> <p><img alt="" height="154" src="https://images2.imgbox.com/73/40/IiWs6S2H_o.png" width="672"></p> <p><img alt="" height="94" src="https://images2.imgbox.com/ec/b2/upGCWCXC_o.png" width="1125"></p> </td></tr><tr><td style="width:375.9pt;"> <p style="margin-left:.0001pt;text-align:left;">创建pod</p> <p style="margin-left:.0001pt;text-align:left;">（同一个命名空间pod不能重名）</p> </td><td style="width:332.8pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl create deployment <strong><strong>pod名称</strong></strong> --image=nginx (--replicas=3)</p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;"><strong><strong>注：若是基于deployment方式创建的pod ，或基于daemonset方式创建的pod，均是由控制器创建的pod，使用delete删除pod无法删除，相当于重启pod。先删除控制器，才能删除pod，但删除控制器，所有基于这个控制器的pod全部被删除</strong></strong><strong><span style="color:#ff0000;"><strong>（慎用）</strong></span></strong></p> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="180" src="https://images2.imgbox.com/03/27/vk5gzKs8_o.png" width="783"></p> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="202" src="https://images2.imgbox.com/c7/21/yCeuHI4m_o.png" width="835"></p> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="314" src="https://images2.imgbox.com/22/1e/zWDQX5Vw_o.png" width="873"></p> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="45" src="https://images2.imgbox.com/0a/4a/USaLRZaf_o.png" width="986"></p> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="119" src="https://images2.imgbox.com/e4/5f/IDPwLU2u_o.png" width="676"></p> <p style="margin-left:.0001pt;text-align:left;">kubectl delete deployments.apps nginx</p> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="292" src="https://images2.imgbox.com/e4/f3/TaEWd9I5_o.png" width="748"></p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;">kubectl delete deployments.apps nginx</p> </td></tr><tr><td style="width:375.9pt;"> <p style="margin-left:.0001pt;text-align:left;">不是基于控制器创建的pod</p> <p style="margin-left:.0001pt;text-align:left;"><span style="color:#ff0000;">（可以直接删除，很少用）</span></p> </td><td style="width:332.8pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl run <strong><strong>pod名称</strong></strong> --image=nginx</p> </td></tr><tr><td colspan="2"><img alt="" height="378" src="https://images2.imgbox.com/03/42/spk2EwyV_o.png" width="771"></td></tr><tr><td style="width:375.9pt;"> <p style="margin-left:.0001pt;text-align:left;">远程进入节点容器</p> </td><td style="width:332.8pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl exec -it 容器名称 bash</p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;"><strong><strong>注：docker的exec只能在本机使用，kubectl的exec可以跨主机进入容器</strong></strong></p> </td></tr><tr><td colspan="2"> <p><img alt="" height="116" src="https://images2.imgbox.com/53/d4/C0vIfkUJ_o.png" width="1200"></p> <p><img alt="" height="154" src="https://images2.imgbox.com/15/2e/VlaWEPxE_o.png" width="888"></p> </td></tr><tr><td style="width:375.9pt;"> <p style="margin-left:.0001pt;text-align:left;">指定命名空间进入容器</p> </td><td style="width:332.8pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl exec -it 容器名称 bash -n 命名空间名称</p> </td></tr><tr><td colspan="2"><img alt="" height="452" src="https://images2.imgbox.com/13/1e/PWqlm8rR_o.png" width="1200"></td></tr><tr><td style="width:375.9pt;"> <p style="margin-left:.0001pt;text-align:left;">快速结束容器</p> <p style="margin-left:.0001pt;text-align:left;"><span style="color:#ff0000;">（用于结束卡在销毁状态的pod）</span></p> </td><td style="width:332.8pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl delete pod nginx-6799fc88d8-j4hxc --force --grace-period=0</p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;">--grace-period表示过度的存活期（默认30秒，可以让pod优雅的结束容器内的进程，然后退出pod）</p> <p style="margin-left:.0001pt;text-align:left;">--grace-period=0表示立刻退出</p> </td></tr><tr><td colspan="2"> <p><img alt="" height="115" src="https://images2.imgbox.com/32/82/Ys0pTH7L_o.png" width="776"></p> <p><img alt="" height="73" src="https://images2.imgbox.com/3a/3a/SMJypLUi_o.png" width="1200"></p> </td></tr><tr><td style="width:375.9pt;"> <p style="margin-left:.0001pt;text-align:left;">对deployment创建的pod扩、缩容</p> <p style="margin-left:.0001pt;text-align:left;"><span style="color:#ff0000;">（仅限于deployment控制器）</span></p> </td><td style="width:332.8pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl scale deployment nginx1 --replicas=3</p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="218" src="https://images2.imgbox.com/09/88/6Y2ZTVKU_o.png" width="733"></p> <p style="margin-left:.0001pt;text-align:left;">扩容：</p> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="51" src="https://images2.imgbox.com/fd/57/qj6aqCM1_o.png" width="734"></p> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="217" src="https://images2.imgbox.com/07/85/L25aATxT_o.png" width="850"></p> <p style="margin-left:.0001pt;text-align:left;">缩容：<img alt="" height="205" src="https://images2.imgbox.com/6f/aa/AUOLoWUa_o.png" width="871"></p> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="334" src="https://images2.imgbox.com/fe/0a/u7tKN6z3_o.png" width="871"></p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:center;"><strong><strong>发布服务的service</strong></strong></p> </td></tr><tr><td colspan="2"> <p><img alt="" height="46" src="https://images2.imgbox.com/98/8b/7XWv4VHo_o.png" width="904"></p> <p><img alt="" height="112" src="https://images2.imgbox.com/bf/6b/zMxVJI3m_o.png" width="650"></p> </td></tr><tr><td style="width:375.9pt;"> <p style="margin-left:.0001pt;text-align:left;">查看当前命名空间的service</p> </td><td style="width:332.8pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl get svc</p> </td></tr><tr><td colspan="2"><img alt="" height="94" src="https://images2.imgbox.com/ca/c5/lTxeju6W_o.png" width="828"></td></tr><tr><td style="width:375.9pt;"> <p style="margin-left:.0001pt;text-align:left;">删除service</p> </td><td style="width:332.8pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl delete svc nginx</p> </td></tr><tr><td colspan="2"><img alt="" height="200" src="https://images2.imgbox.com/45/b1/jYeMO7kb_o.png" width="841"></td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:center;"><strong><strong>service的类型</strong></strong></p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;"><strong><strong>①ClusterIP：</strong></strong>创建service的默认类型，提供一个集群内部的虚拟IP地址，通过这个虚拟IP可以直接访问pod的资源，仅限于pod内部，无法对外提供访问</p> <p style="margin-left:.0001pt;text-align:left;"><strong><strong>②NodePort</strong></strong><strong><span style="color:#ff0000;"><strong>（常用）</strong></span></strong><strong><strong>：</strong></strong>在每个node节点上都开放一个相同的端口，外部可以通过node的本机IP+端口访问pod资源，这是集群外部访问service资源的一种方式（四层代理），基于deployment创建的pod可以使用这种方式</p> <p style="margin-left:.0001pt;text-align:left;">nodeip:nodeport<strong><strong>（nodeport可随机指派，也可指定，范围30000~32767）</strong></strong></p> </td></tr><tr><td style="width:375.9pt;"> <p style="margin-left:.0001pt;text-align:left;">对外暴露service端口</p> </td><td style="width:332.8pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl expose deployment nginx --port=80 --target-port=80 --name=nginx-service --type=NodePort</p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;">--port=80    service集群的端口（可随意指定）</p> <p style="margin-left:.0001pt;text-align:left;">--target-port=80    pod内部容器的端口（服务固定的端口号）</p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="136" src="https://images2.imgbox.com/bf/bb/YWuLicps_o.png" width="1200"></p> <p style="margin-left:.0001pt;text-align:left;">10.96.26.83：集群内部的IP地址，外部不可以访问</p> <p style="margin-left:.0001pt;text-align:left;">80：对应的是内部的service 端口</p> <p style="margin-left:.0001pt;text-align:left;">30934：和内部的service的80端口做映射</p> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="650" src="https://images2.imgbox.com/05/ae/k5VQ1qAn_o.png" width="1200"></p> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="190" src="https://images2.imgbox.com/5b/c8/69elYORU_o.png" width="391"><img alt="" height="185" src="https://images2.imgbox.com/ff/eb/bWPuP5rg_o.png" width="424"><img alt="" height="182" src="https://images2.imgbox.com/98/f2/PFsWOkYS_o.png" width="380"></p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="230" src="https://images2.imgbox.com/4c/84/UBS0hthR_o.png" width="626"></p> <p style="margin-left:.0001pt;text-align:left;">pod内部的容器的端口是固定的，--port是service和容器映射端口，可以随意指定</p> <p style="margin-left:.0001pt;text-align:left;">--target-port是容器内部的服务端口</p> </td></tr><tr><td style="width:375.9pt;"> <p style="margin-left:.0001pt;text-align:left;">修改service端口</p> </td><td style="width:332.8pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl edit svc <strong><strong>service名称</strong></strong></p> </td></tr><tr><td colspan="2"> <p><img alt="" height="26" src="https://images2.imgbox.com/9d/4b/XiyRqTXp_o.png" width="540"></p> <p><img alt="" height="630" src="https://images2.imgbox.com/d1/3c/B3Qaiwwh_o.png" width="579"></p> <p><img alt="" height="137" src="https://images2.imgbox.com/d4/e7/UcywJGBm_o.png" width="948"></p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;"><strong><strong>③LoadBalance：</strong></strong>若service类型设定为LoadBalance，映射地址（云平台提供LoadBalance的地址，需要付费），这种用法仅用于公有云服务供应商在云台上设置的service的场景，外部访问，实现负载均衡</p> <p style="margin-left:.0001pt;text-align:left;">创建service，指定类型为LoadBalance</p> </td></tr><tr><td colspan="2"><img alt="" height="376" src="https://images2.imgbox.com/7a/99/bzkiuiiO_o.png" width="1200"></td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;"><strong><strong>④ExternalName</strong></strong><strong><span style="color:#ff0000;"><strong>（常用）</strong></span></strong>：DNS映射，给service分配一个域名，通过域名来访问后端pod的资源，ExternalName的service类型不能提供负载均衡，必须设置一个LoadBalance地址才能实现负载均衡</p> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="490" src="https://images2.imgbox.com/a3/f1/cu4lDgkW_o.png" width="513"></p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;">注：企业内部最常见的是<strong><strong>NodePort和ExternalName</strong></strong>结合一起使用</p> </td></tr></tbody></table> 
<h3 style="margin-left:.0001pt;text-align:left;"><strong><strong>（</strong></strong><strong><strong>3</strong></strong><strong><strong>）</strong></strong><strong><strong>更新、回滚、发布方式</strong></strong></h3> 
<p style="margin-left:.0001pt;text-align:left;">项目的生命周期：创建——发布——更新——回滚——删除</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:345.65pt;"> <p style="margin-left:.0001pt;text-align:left;">更新服务版本</p> </td><td style="width:363.05pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl set image deployment nginx nginx=nginx:1.22.0</p> </td></tr><tr><td colspan="2"> <p><img alt="" height="235" src="https://images2.imgbox.com/9d/ce/ua8s2RYv_o.png" width="543"></p> <p><img alt="" height="49" src="https://images2.imgbox.com/3e/9e/BZNkH5Pt_o.png" width="837"></p> <p><img alt="" height="228" src="https://images2.imgbox.com/c1/fb/u7wuN5K3_o.png" width="522"></p> </td></tr><tr><td style="width:345.65pt;"> <p style="margin-left:.0001pt;text-align:left;">查看还原点</p> </td><td style="width:363.05pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl rollout history deployment nginx</p> </td></tr><tr><td colspan="2"> <p style="margin-left:.0001pt;text-align:left;"><img alt="" height="119" src="https://images2.imgbox.com/d6/33/AIGFJEz1_o.png" width="669">数字越大，就是最近的一次的操作</p> </td></tr><tr><td style="width:345.65pt;"> <p style="margin-left:.0001pt;text-align:left;">设置还原点时加上标识便于识别还原点</p> </td><td style="width:363.05pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl set image deployment nginx nginx=nginx:1.15<strong><strong> --record</strong></strong></p> </td></tr><tr><td colspan="2"> <p><img alt="" height="51" src="https://images2.imgbox.com/0d/cd/lGxYZTLC_o.png" width="875"></p> <p><img alt="" height="148" src="https://images2.imgbox.com/62/e0/aVmsjlsc_o.png" width="874"></p> <p><img alt="" height="224" src="https://images2.imgbox.com/6c/20/24UYScuT_o.png" width="531"></p> </td></tr><tr><td style="width:345.65pt;"> <p style="margin-left:.0001pt;text-align:left;">回滚</p> </td><td style="width:363.05pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl rollout undo deployment nginx --to-revision=1</p> </td></tr><tr><td colspan="2"> <p><img alt="" height="203" src="https://images2.imgbox.com/6b/8a/4VGXKF1w_o.png" width="866"></p> <p><img alt="" height="243" src="https://images2.imgbox.com/ef/95/D8lq7MtK_o.png" width="602"></p> </td></tr><tr><td style="width:345.65pt;"> <p style="margin-left:.0001pt;text-align:left;">查看还原状态</p> </td><td style="width:363.05pt;"> <p style="margin-left:.0001pt;text-align:left;">①kubectl rollout status deployment nginx</p> <p style="margin-left:.0001pt;text-align:left;">②kubectl get pod -w动态查看</p> </td></tr><tr><td colspan="2"><img alt="" height="171" src="https://images2.imgbox.com/83/ca/TYaYQz7f_o.png" width="793"></td></tr><tr><td style="width:345.65pt;"> <p style="margin-left:.0001pt;text-align:left;">查看默认命名空间集群内的所有信息</p> </td><td style="width:363.05pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl get all</p> </td></tr><tr><td colspan="2"><img alt="" height="399" src="https://images2.imgbox.com/7d/1e/YcWi1qA5_o.png" width="1039"></td></tr><tr><td style="width:345.65pt;"> <p style="margin-left:.0001pt;text-align:left;">看默认命名空间集群内的所有详细信息</p> </td><td style="width:363.05pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl get all -o wide</p> </td></tr><tr><td colspan="2"><img alt="" height="300" src="https://images2.imgbox.com/30/47/PoZcaB1c_o.png" width="1144"></td></tr><tr><td style="width:345.65pt;"> <p style="margin-left:.0001pt;text-align:left;">查看指定命名空间集群内的所有详细信息</p> </td><td style="width:363.05pt;"> <p style="margin-left:.0001pt;text-align:left;">kubectl get all -o wide -n 命名空间名称</p> </td></tr><tr><td colspan="2"><img alt="" height="458" src="https://images2.imgbox.com/bb/2d/aBlvtiWi_o.png" width="1200"></td></tr></tbody></table>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dd81264edad486fe42d273e88fe5b84a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">将学习自动化测试时的医药管理信息系统项目用idea运行</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/01348bfabccbee47eb4c5a00ff5c620f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关于“Python”的核心知识点整理大全55</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>