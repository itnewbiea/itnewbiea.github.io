<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>微信小程序：selectComponent返回null的问题 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="微信小程序：selectComponent返回null的问题" />
<meta property="og:description" content="当小程序自带的组件无法满足所有需求的时候，我们可以参考很多自定义组件。我们这次排查问题就拿比较常用的vant-weapp作为示例：使用selectComponent获取自定义组件对象时，返回null的问题
1、json引入组件 &#34;usingComponents&#34;: { &#34;van-button&#34;: &#34;@vant/weapp/button/index&#34;, &#34;van-count-down&#34;: &#34;@vant/weapp/count-down/index&#34; } 2、看看wxml文件里面的选择器是否设置选择器 &lt;view&gt; &lt;van-button plain hairline type=&#34;primary&#34; wx:if=&#34;{{isShowCountDown}}&#34; &gt; &lt;view&gt;获取验证码&lt;/view&gt; &lt;/van-button&gt; &lt;van-button plain hairline type=&#34;primary&#34; wx:if=&#34;{{!isShowCountDown}}&#34; &gt; &lt;view class=&#34;flex-start&#34;&gt; &lt;view&gt; &lt;van-count-down class=&#34;control-count-down&#34; millisecond time=&#34;{{ time }}&#34; auto-start=&#34;{{ false }}&#34; format=&#34;ss&#34;/&gt; &lt;view&gt; &lt;view&gt;秒后重新获取验证码&lt;/view&gt; &lt;/view&gt; &lt;/van-button&gt; &lt;/view&gt; 3、看看在页面的js文件里面引用的代码 let _this = this; const countDown = _this .selectComponent(&#39;.control-count-down&#39;); console.log(&#34;countDown &gt;&gt; &#34; &#43; countDown ); 注意这个selectComponent方法里面的参数要与wxml里面设置的class选择器的值相对应，比如我的用的class选择器就用点&#43;class名称
如果检查过后上面说的，全都没问题的话，那多半就是wxml中自定义组件的那段代码还没渲染到就使用selectComponent引用了组件，这个时候的返回值null。产生这种大致就下面两种情况
1、wx:if属性使用不当。 这里不得不提一下wx:if与hidden属性的区别，这两个属性我想大家都比较熟悉，都是用来控制显示与隐藏的。要说有什么区别，有些可爱的同学就会脱口而出：“wx:if条件为true就显示，反之则隐藏；hidden条件为true就隐藏，反之则显示！”。嗯，说的没错，这确实是最直观最明显的区别。但是说的并不全！他们还有一个区别，就是如果你用wx:if包裹了一段代码，界面在渲染的时候，当wx:if的条件为false的时候是不会渲染这段代码的，只有wx:if的条件为true才会渲染这段代码；而用hidden包裹的代码无论条件是为true还是false都会渲染它包裹的代码，只不过为true时将这段布局隐藏了而已。
2.自定义组件所在层级太深 如果你的自定义组件嵌套的非常深，而这个时候你在页面还未渲染完成的时候就开始使用selectComponent引用组件，获取到的对象也有可能是会为null，这个情况不会太稳定，有时候渲染的速度不一样，出现偶尔引用成功，偶尔引用失败的情况
以上情况分析，我们将我们代码优化了下
&lt;view class=&#34;flex-start&#34;&gt; &lt;view hidden=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/9b072a97b7846abb772873b5590d073a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T02:28:31+08:00" />
<meta property="article:modified_time" content="2024-01-05T02:28:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">微信小程序：selectComponent返回null的问题</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>当小程序自带的组件无法满足所有需求的时候，我们可以参考很多自定义组件。我们这次排查问题就拿比较常用的vant-weapp作为示例：使用selectComponent获取自定义组件对象时，返回null的问题</p> 
<h4>1、json引入组件</h4> 
<pre><code>"usingComponents": {
  "van-button": "@vant/weapp/button/index",
  "van-count-down": "@vant/weapp/count-down/index"
}</code></pre> 
<h4>2、看看wxml文件里面的选择器是否设置选择器</h4> 
<pre><code>&lt;view&gt;
    &lt;van-button plain hairline type="primary" wx:if="{<!-- -->{isShowCountDown}}" &gt;
        &lt;view&gt;获取验证码&lt;/view&gt;
    &lt;/van-button&gt;
    &lt;van-button plain hairline type="primary" wx:if="{<!-- -->{!isShowCountDown}}" &gt;
        &lt;view class="flex-start"&gt;
            &lt;view&gt;
                &lt;van-count-down class="control-count-down" millisecond time="{<!-- -->{ time }}" auto-start="{<!-- -->{ false }}" format="ss"/&gt;
            &lt;view&gt;
            &lt;view&gt;秒后重新获取验证码&lt;/view&gt;
        &lt;/view&gt;
    &lt;/van-button&gt;
&lt;/view&gt;</code></pre> 
<h4>3、看看在页面的js文件里面引用的代码</h4> 
<pre><code>let _this = this;
const countDown = _this .selectComponent('.control-count-down');
console.log("countDown &gt;&gt; " + countDown );</code></pre> 
<blockquote> 
 <p>注意这个selectComponent方法里面的参数要与wxml里面设置的class选择器的值相对应，比如我的用的class选择器就用点+class名称</p> 
</blockquote> 
<p><strong>如果检查过后上面说的，全都没问题的话，那多半就是wxml中自定义组件的那段代码还没渲染到就使用selectComponent引用了组件，这个时候的返回值null。产生这种大致就下面两种情况</strong></p> 
<h4><span style="color:#fe2c24;"><strong>1、wx:if属性使用不当。</strong></span></h4> 
<blockquote> 
 <p>这里不得不提一下wx:if与hidden属性的区别，这两个属性我想大家都比较熟悉，都是用来控制显示与隐藏的。要说有什么区别，有些可爱的同学就会脱口而出：“wx:if条件为true就显示，反之则隐藏；hidden条件为true就隐藏，反之则显示！”。嗯，说的没错，这确实是最直观最明显的区别。但是说的并不全！他们还有一个区别，就是如果你用wx:if包裹了一段代码，界面在渲染的时候，当wx:if的条件为false的时候是不会渲染这段代码的，只有wx:if的条件为true才会渲染这段代码；而用hidden包裹的代码无论条件是为true还是false都会渲染它包裹的代码，只不过为true时将这段布局隐藏了而已。</p> 
</blockquote> 
<h4><span style="color:#fe2c24;"><strong>2.自定义组件所在层级太深</strong></span></h4> 
<blockquote> 
 <p>如果你的自定义组件嵌套的非常深，而这个时候你在页面还未渲染完成的时候就开始使用selectComponent引用组件，获取到的对象也有可能是会为null，这个情况不会太稳定，有时候渲染的速度不一样，出现偶尔引用成功，偶尔引用失败的情况</p> 
</blockquote> 
<p>以上情况分析，我们将我们代码优化了下</p> 
<pre><code>&lt;view class="flex-start"&gt;
    &lt;view hidden="{<!-- -->{!isShowCountDown}}"&gt;
        &lt;van-count-down class="control-count-down" millisecond time="{<!-- -->{ time }}" auto-start="{<!-- -->{ false }}" format="ss" bind:finish="onCountDownFinished" /&gt;
    &lt;/view&gt;
    &lt;view wx:if="{<!-- -->{isShowCountDown}}" class="phone-code-get"&gt; 秒重新获取&lt;/view&gt;
    &lt;view wx:if="{<!-- -->{!isShowCountDown}}"&gt;获取验证&lt;/view&gt;
&lt;/view&gt;</code></pre> 
<p>这样之后正常获取了~~~~</p> 
<p>其实只要记住_this.selectComponent()返回为null的情况以上两种，要么是引用错误，要么就是未找到自定义组件节点。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ea4fa64accf7d51384c966507b727bff/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【期末不挂科-考前速过系列P1】单片机[接口与总线]——经典例题盘点【选择题＆判断题＆填空题】（带图解析）（第一章：27题搞定单片机＆其工作原理）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e1bb426dd3cbd9e3ad1d134031f703d9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">华为od机考 Python【A卷&#43;B卷&#43;C卷&#43;D卷】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>