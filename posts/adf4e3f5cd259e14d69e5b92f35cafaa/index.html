<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>如何用 Python 和 Selenium 构建一个股票分析器 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="如何用 Python 和 Selenium 构建一个股票分析器" />
<meta property="og:description" content="正文 在金融市场中，股票价格是一个重要的指标，它反映了公司的经营状况、市场需求和供应、投资者的预期和情绪等因素。股票价格的变化会影响投资者的决策和收益，因此，实时分析股票价格是一项有价值的技能。在本文中，我们将介绍如何使用 Python 语言和 Selenium 库来实时分析雅虎财经中的股票价格，并展示一个简单的示例代码。
概述 雅虎财经是一个提供全球金融信息和新闻的网站，它包含了各种股票、指数、基金、期货、期权、外汇等市场数据。Python 是一种通用的高级编程语言，它具有简洁、优雅、易读、易写、易学等特点，适合进行数据分析和可视化等任务。Selenium 是一个用于自动化 Web 浏览器操作的工具，它可以模拟真实用户的行为，如点击、输入、滚动等，并获取网页上的元素和内容。我们需要先安装 Python 和 Selenium 库，然后导入 selenium.webdriver 模块。我们可以使用 selenium.webdriver.Chrome() 方法来创建一个 Chrome 浏览器对象，并使用 get() 方法来打开一个网页。我们可以使用 find_element_by_id() 方法来根据元素的 id 属性来定位一个网页元素，并使用 send_keys() 方法来输入一个股票代码。我们可以使用 find_element_by_xpath() 方法来根据元素的 XPath 表达式来定位一个网页元素，并使用 text 属性来获取元素的文本内容。我们可以使用 time.sleep() 函数来暂停程序的执行，以便等待网页加载完成。我们可以使用 while 循环来不断地获取和打印股票价格，并使用 datetime.datetime.now() 函数来获取当前时间。 亮点 使用 Python 语言和 Selenium 库可以方便地实时分析雅虎财经中的股票价格。使用 Selenium 库可以模拟真实浏览器获取信息，避免被网站识别为爬虫。 案例 下面是一个简单的示例代码，用于实时分析雅虎财经中苹果公司（AAPL）的股票价格，并存入Excel文件：
# 导入 selenium.webdriver 模块 from selenium import webdriver # 导入 time 和 datetime 模块 import time import datetime # 导入 pandas 模块 import pandas as pd # 亿牛云 爬虫代理加强版 设置代理服务器信息 proxyHost = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/adf4e3f5cd259e14d69e5b92f35cafaa/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-18T14:19:43+08:00" />
<meta property="article:modified_time" content="2023-07-18T14:19:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">如何用 Python 和 Selenium 构建一个股票分析器</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="g5587jpeghttpsimgblogcsdnimgcnimg_convert8ca1629c770f069054644e626c0824c3jpegaverageHue6c89a8clientIdu7e79e72f551f4fromuiidua6e6bd53originHeight508originWidth535originalTypebinaryratio2rotation0showTitlefalsesize57790statusdonestylenonetaskIdu0655de53dfbd4658a42cf3bdc893d0ftitle_0"></a><img src="https://images2.imgbox.com/09/b0/wCgyWYnY_o.jpg" alt="g-5587.jpeg"></h3> 
<h3><a id="_1"></a>正文</h3> 
<p>在金融市场中，股票价格是一个重要的指标，它反映了公司的经营状况、市场需求和供应、投资者的预期和情绪等因素。股票价格的变化会影响投资者的决策和收益，因此，实时分析股票价格是一项有价值的技能。在本文中，我们将介绍如何使用 Python 语言和 Selenium 库来实时分析雅虎财经中的股票价格，并展示一个简单的示例代码。</p> 
<h3><a id="_3"></a>概述</h3> 
<ul><li>雅虎财经是一个提供全球金融信息和新闻的网站，它包含了各种股票、指数、基金、期货、期权、外汇等市场数据。</li><li>Python 是一种通用的高级编程语言，它具有简洁、优雅、易读、易写、易学等特点，适合进行数据分析和可视化等任务。</li><li>Selenium 是一个用于自动化 Web 浏览器操作的工具，它可以模拟真实用户的行为，如点击、输入、滚动等，并获取网页上的元素和内容。</li><li>我们需要先安装 Python 和 Selenium 库，然后导入 selenium.webdriver 模块。</li><li>我们可以使用 selenium.webdriver.Chrome() 方法来创建一个 Chrome 浏览器对象，并使用 get() 方法来打开一个网页。</li><li>我们可以使用 find_element_by_id() 方法来根据元素的 id 属性来定位一个网页元素，并使用 send_keys() 方法来输入一个股票代码。</li><li>我们可以使用 find_element_by_xpath() 方法来根据元素的 XPath 表达式来定位一个网页元素，并使用 text 属性来获取元素的文本内容。</li><li>我们可以使用 time.sleep() 函数来暂停程序的执行，以便等待网页加载完成。</li><li>我们可以使用 while 循环来不断地获取和打印股票价格，并使用 datetime.datetime.now() 函数来获取当前时间。</li></ul> 
<h3><a id="_14"></a>亮点</h3> 
<ul><li>使用 Python 语言和 Selenium 库可以方便地实时分析雅虎财经中的股票价格。</li><li>使用 Selenium 库可以模拟真实浏览器获取信息，避免被网站识别为爬虫。</li></ul> 
<h3><a id="_18"></a>案例</h3> 
<p>下面是一个简单的示例代码，用于实时分析雅虎财经中苹果公司（AAPL）的股票价格，并存入Excel文件：</p> 
<pre><code class="prism language-python"><span class="token comment"># 导入 selenium.webdriver 模块</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># 导入 time 和 datetime 模块</span>
<span class="token keyword">import</span> time
<span class="token keyword">import</span> datetime

<span class="token comment"># 导入 pandas 模块</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 亿牛云 爬虫代理加强版 设置代理服务器信息</span>
proxyHost <span class="token operator">=</span> <span class="token string">"www.16yun.cn"</span>
proxyPort <span class="token operator">=</span> <span class="token string">"31111"</span>

<span class="token comment"># 设置代理验证信息</span>
proxyUser <span class="token operator">=</span> <span class="token string">"16YUN"</span>
proxyPass <span class="token operator">=</span> <span class="token string">"16IP"</span>

<span class="token comment"># 构造代理字典</span>
proxies <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"http"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"http://</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>proxyUser<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>proxyPass<span class="token punctuation">}</span></span><span class="token string">@</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>proxyHost<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>proxyPort<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
    <span class="token string">"https"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"https://</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>proxyUser<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>proxyPass<span class="token punctuation">}</span></span><span class="token string">@</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>proxyHost<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>proxyPort<span class="token punctuation">}</span></span><span class="token string">"</span></span>
<span class="token punctuation">}</span>

<span class="token comment"># 创建一个 Chrome 浏览器对象，并设置代理选项</span>
options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"--proxy-server=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>proxies<span class="token punctuation">[</span><span class="token string">'http'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>options<span class="token operator">=</span>options<span class="token punctuation">)</span>

<span class="token comment"># 打开雅虎财经网页</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://finance.yahoo.com/"</span><span class="token punctuation">)</span>

<span class="token comment"># 定位搜索框元素，并输入苹果公司的股票代码 AAPL</span>
search_box <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"yfin-usr-qry"</span><span class="token punctuation">)</span>
search_box<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"AAPL"</span><span class="token punctuation">)</span>

<span class="token comment"># 暂停 3 秒，等待网页加载完成</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment"># 定位股票价格元素，并获取其文本内容</span>
price_element <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">"//span[@class='Trsdu(0\.5s) Fw(b) Fz(36px) Mb(-4px) D(ib)']"</span><span class="token punctuation">)</span>
price_text <span class="token operator">=</span> price_element<span class="token punctuation">.</span>text

<span class="token comment"># 获取当前时间，并打印股票价格和时间</span>
current_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"AAPL price: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>price_text<span class="token punctuation">}</span></span><span class="token string">, time: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>current_time<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># 创建一个空的 DataFrame 对象，用来存储股票价格和时间</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Price'</span><span class="token punctuation">,</span> <span class="token string">'Time'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 创建一个 ExcelWriter 对象，用来写入 Excel 文件</span>
writer <span class="token operator">=</span> pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span><span class="token string">'AAPL.xlsx'</span><span class="token punctuation">,</span> engine<span class="token operator">=</span><span class="token string">'xlsxwriter'</span><span class="token punctuation">)</span>

<span class="token comment"># 使用 while 循环，每隔 10 秒获取并打印一次股票价格和时间，并写入 Excel 文件</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token comment"># 暂停 10 秒，等待网页更新</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

    <span class="token comment"># 定位股票价格元素，并获取其文本内容</span>
    price_element <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">"//span[@class='Trsdu(0\.5s) Fw(b) Fz(36px) Mb(-4px) D(ib)']"</span><span class="token punctuation">)</span>
    price_text <span class="token operator">=</span> price_element<span class="token punctuation">.</span>text

    <span class="token comment"># 获取当前时间，并打印股票价格和时间</span>
    current_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"AAPL price: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>price_text<span class="token punctuation">}</span></span><span class="token string">, time: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>current_time<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token comment"># 将股票价格和时间追加到 DataFrame 对象中</span>
    df <span class="token operator">=</span> df<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'Price'</span><span class="token punctuation">:</span> price_text<span class="token punctuation">,</span> <span class="token string">'Time'</span><span class="token punctuation">:</span> current_time<span class="token punctuation">}</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token comment"># 将 DataFrame 对象写入 Excel 文件中的 Sheet1 工作表，并设置列名和索引名</span>
    df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'Sheet1'</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> index_label<span class="token operator">=</span><span class="token string">'Index'</span><span class="token punctuation">)</span>

    <span class="token comment"># 保存 Excel 文件的更改</span>
    writer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="_97"></a>结语</h3> 
<p>通过本文，我们学习了如何使用 Python 语言和 Selenium 库来实时分析雅虎财经中的股票价格，并使用了一个简单的示例代码来演示。我们还了解了如何使用代理服务器来提高爬虫的效率和安全性。希望本文对你有所帮助，如果你有任何问题或建议，欢迎留言。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4fe655204e89459cddbefa5b4ec8bfb2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java-logback记录日志到指定文件并且压缩保存日志</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e907a27400b1e0396a25ce469056f8f2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Antd ＜a-form＞表单校验：v-model、v-decorator</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>