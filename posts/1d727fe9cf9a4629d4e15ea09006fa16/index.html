<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Seata(一): Seata-Server安装 &amp; 配置 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Seata(一): Seata-Server安装 &amp; 配置" />
<meta property="og:description" content="一、官方文档 Seata分布式事物解决方案中间件。 https://seata.io/zh-cn/docs/overview/what-is-seata.htmlhttps://seata.io/zh-cn/docs/overview/what-is-seata.html
Server端配置文件
https://github.com/seata/seata/tree/1.3.0/script/serverhttps://github.com/seata/seata/tree/1.3.0/script/server
二、启动和运行 1、单节点运行 1.1、docker方式运行 $ sh /usr/local/deploy/seata-server/docker-run.sh docker-run.sh 脚本文件
docker run --name seata-server --net=host \ -e SEATA_IP=172.18.75.176 \ -e SEATA_PORT=8091 \ -e STORE_MODE=db \ -e SERVER_NODE=1 \ -e SEATA_CONFIG_NAME=file:/root/seata-config/registry \ -v ./seata-config:/root/seata-config \ -v ./logs:/root/logs \ -d seataio/seata-server:1.3.0 1.2、docker-compose方式运行 $ sh /usr/local/deploy/seata-server/docker-compose-run.sh docker-compose-run.sh 脚本文件 docker-compose -f docker-compose.yml up -d 2、高可用多节点运行 这块后续需要调整为Helm形式多节点启动执行，目前这种先保证快速运行起来。
$ sh /usr/local/deploy/seata-server/docker-compose-run-ha.sh docker-compose-run-ha.sh 脚本文件 docker-compose -f docker-compose-ha.yml up -d 三、Seata Server安装和配置 采用Docker方式安装部署。 官方安装文档 https://seata." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/1d727fe9cf9a4629d4e15ea09006fa16/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-04T20:19:57+08:00" />
<meta property="article:modified_time" content="2022-04-04T20:19:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Seata(一): Seata-Server安装 &amp; 配置</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、官方文档</h2> 
<blockquote> 
 <strong>Seata分布式事物解决方案中间件。</strong> 
</blockquote> 
<p><a class="link-info has-card" href="https://seata.io/zh-cn/docs/overview/what-is-seata.html" rel="nofollow" title="https://seata.io/zh-cn/docs/overview/what-is-seata.html"><span class="link-card-box"><span class="link-title">https://seata.io/zh-cn/docs/overview/what-is-seata.html</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/c6/e5/KboVViGc_o.png">https://seata.io/zh-cn/docs/overview/what-is-seata.html</span></span></a></p> 
<p><strong>Server端配置文件</strong></p> 
<p><a class="link-info has-card" href="https://github.com/seata/seata/tree/1.3.0/script/server" title="https://github.com/seata/seata/tree/1.3.0/script/server"><span class="link-card-box"><span class="link-title">https://github.com/seata/seata/tree/1.3.0/script/server</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/f9/33/0qkPKs4e_o.png">https://github.com/seata/seata/tree/1.3.0/script/server</span></span></a></p> 
<h2>二、启动和运行</h2> 
<h3>1、单节点运行</h3> 
<h4><strong>1.1、docker方式运行</strong></h4> 
<pre><code class="language-bash">$ sh /usr/local/deploy/seata-server/docker-run.sh</code></pre> 
<p><strong><span style="color:#be191c;">docker-run.sh </span>脚本文件</strong></p> 
<pre><code class="language-bash">docker run --name seata-server --net=host \
        -e SEATA_IP=172.18.75.176 \
        -e SEATA_PORT=8091 \
        -e STORE_MODE=db \
        -e SERVER_NODE=1 \
        -e SEATA_CONFIG_NAME=file:/root/seata-config/registry \
        -v ./seata-config:/root/seata-config  \
        -v ./logs:/root/logs \
        -d seataio/seata-server:1.3.0</code></pre> 
<h4><strong>1.2、docker-compose方式运行</strong></h4> 
<pre><code class="language-bash">$ sh /usr/local/deploy/seata-server/docker-compose-run.sh</code></pre> 
<p><strong><span style="color:#be191c;">docker-compose-run.sh</span> 脚本文件 </strong></p> 
<pre><code class="language-bash">docker-compose -f docker-compose.yml up -d</code></pre> 
<h3>2、高可用多节点运行</h3> 
<p><strong>这块后续需要调整为Helm形式多节点启动执行，目前这种先保证快速运行起来。</strong></p> 
<pre><code class="language-bash">$ sh /usr/local/deploy/seata-server/docker-compose-run-ha.sh</code></pre> 
<p><strong><span style="color:#be191c;">docker-compose-run-ha.sh</span> 脚本文件 </strong></p> 
<pre><code class="language-bash">docker-compose -f docker-compose-ha.yml up -d</code></pre> 
<h2>三、Seata Server安装和配置</h2> 
<blockquote> 
 <strong>采用Docker方式安装部署。</strong> 
</blockquote> 
<ul><li><strong>官方安装文档</strong></li></ul> 
<p>https://seata.io/zh-cn/docs/ops/deploy-by-docker.html</p> 
<h3>1、Seata Docker官方镜像地址</h3> 
<p>https://hub.docker.com/r/seataio/seata-server</p> 
<h3>2、控制台拉取镜像</h3> 
<pre><code class="language-bash"># latest 默认为拉取最新版本

docker pull seataio/seata-server:latest

# 拉取指定版本: 1.4.2

docker pull seataio/seata-server:1.4.2

# 查询拉取的镜像

docker images</code></pre> 
<p></p> 
<p><img alt="" height="123" src="https://images2.imgbox.com/59/64/JAMMvj0e_o.png" width="617"></p> 
<p></p> 
<h3>3、使用自定义配置文件</h3> 
<blockquote> 
 <span style="color:#be191c;"><strong>官方文档说明，红色为重点说明</strong></span> 
</blockquote> 
<p><img alt="" height="371" src="https://images2.imgbox.com/14/77/1eex5W0Z_o.png" width="464"></p> 
<h4>3.1、registry.conf配置文件</h4> 
<pre><code class="language-bash">registry {
  # file 、nacos 、eureka、redis、zk、consul、etcd3、sofa
  # 采用nacos为注册中心
  type = "nacos"

  nacos {
    # 注册到Nacos的应用名称
    application = "seata-server"
    # nacos服务器注册地址
    serverAddr = "172.18.75.176:8988"
    # 注册到nacos的组名
    group = "SEATA_GROUP"
    # 注册到nacos的命名空间
    namespace = "xxxx-global-dev"
    cluster = "default"
    username = ""
    password = ""
  }
  eureka {
    serviceUrl = "http://localhost:8761/eureka"
    application = "default"
    weight = "1"
  }
  redis {
    serverAddr = "localhost:6379"
    db = 0
    password = ""
    cluster = "default"
    timeout = 0
  }
  zk {
    cluster = "default"
    serverAddr = "127.0.0.1:2181"
    sessionTimeout = 6000
    connectTimeout = 2000
    username = ""
    password = ""
  }
  consul {
    cluster = "default"
    serverAddr = "127.0.0.1:8500"
    aclToken = ""
  }
  etcd3 {
    cluster = "default"
    serverAddr = "http://localhost:2379"
  }
  sofa {
    serverAddr = "127.0.0.1:9603"
    application = "default"
    region = "DEFAULT_ZONE"
    datacenter = "DefaultDataCenter"
    cluster = "default"
    group = "SEATA_GROUP"
    addressWaitTime = "3000"
  }
  file {
    # 如果是File类型，需要更改，这里采用的是Nacos类型，如果是Docker运行，顺带改了
    # 指定 file.conf 配置文件，则需要在 registry.conf 文件中将 config 配置改为以下内容，name 的值为容器中对应的路径
    name = "file:/root/seata-config/file.conf"
  }
}

config {
  # file、nacos 、apollo、zk、consul、etcd3
  type = "file"

  file {
    # 指定 file.conf 配置文件，则需要在 registry.conf 文件中将 config 配置改为以下内容，name 的值为容器中对应的路径
    name = "file:/root/seata-config/file.conf"
  }
  nacos {
    serverAddr = "127.0.0.1:8848"
    namespace = ""
    group = "SEATA_GROUP"
    username = ""
    password = ""
    dataId = "seataServer.properties"
  }
  consul {
    serverAddr = "127.0.0.1:8500"
    aclToken = ""
  }
  apollo {
    appId = "seata-server"
    ## apolloConfigService will cover apolloMeta
    apolloMeta = "http://192.168.1.204:8801"
    apolloConfigService = "http://192.168.1.204:8080"
    namespace = "application"
    apolloAccesskeySecret = ""
    cluster = "seata"
  }
  zk {
    serverAddr = "127.0.0.1:2181"
    sessionTimeout = 6000
    connectTimeout = 2000
    username = ""
    password = ""
    nodePath = "/seata/seata.properties"
  }
  etcd3 {
    serverAddr = "http://localhost:2379"
  }
}

    </code></pre> 
<ul><li><strong>配置Nacos注册中心信息</strong></li></ul> 
<p><span style="color:#be191c;">采用的Nacos，只需要关注nacos配置块的配置即可。</span></p> 
<p><img alt="" height="290" src="https://images2.imgbox.com/c0/9a/iDApkLSZ_o.png" width="512"></p> 
<ul><li><strong>配置中心配置</strong></li></ul> 
<p><span style="color:#be191c;">配置中心采用的本地file类型</span></p> 
<p><span style="color:#be191c;">注意file的路径需要修改为Docker容器中的路径</span></p> 
<p><span style="color:#be191c;"><img alt="" height="229" src="https://images2.imgbox.com/e0/4e/qLUjjfj4_o.png" width="493"></span></p> 
<h4>3.2、file.conf配置文件</h4> 
<p></p> 
<pre><code class="language-bash">## transaction log store, only used in seata-server
store {
  ## store mode: file、db、redis
  mode = "db"
  ## rsa decryption public key
  publicKey = ""
  ## file store property
  file {
    ## store location dir
    dir = "sessionStore"
    # branch session size , if exceeded first try compress lockkey, still exceeded throws exceptions
    maxBranchSessionSize = 16384
    # globe session size , if exceeded throws exceptions
    maxGlobalSessionSize = 512
    # file buffer size , if exceeded allocate new buffer
    fileWriteBufferCacheSize = 16384
    # when recover batch read size
    sessionReloadReadSize = 100
    # async, sync
    flushDiskMode = async
  }

  ## database store property
  db {
    ## the implement of javax.sql.DataSource, such as DruidDataSource(druid)/BasicDataSource(dbcp)/HikariDataSource(hikari) etc.
    datasource = "druid"
    ## mysql/oracle/postgresql/h2/oceanbase etc.
    dbType = "mysql"
    driverClassName = "com.mysql.jdbc.Driver"
    ## if using mysql to store the data, recommend add rewriteBatchedStatements=true in jdbc connection param
    url = "jdbc:mysql://172.18.75.176:3306/seata?rewriteBatchedStatements=true&amp;useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai&amp;autoReconnect=true"
    user = "xxx_global_rw"
    password = "hYO4BLE"
    minConn = 5
    maxConn = 100
    globalTable = "global_table"
    branchTable = "branch_table"
    lockTable = "lock_table"
    queryLimit = 100
    maxWait = 5000
  }

  ## redis store property
  redis {
    ## redis mode: single、sentinel
    mode = "single"
    ## single mode property
    single {
      host = "127.0.0.1"
      port = "6379"
    }
    ## sentinel mode property
    sentinel {
      masterName = ""
      ## such as "10.28.235.65:26379,10.28.235.65:26380,10.28.235.65:26381"
      sentinelHosts = ""
    }
    password = ""
    database = "0"
    minConn = 1
    maxConn = 10
    maxTotal = 100
    queryLimit = 100
  }
}

    </code></pre> 
<p><strong>如果需要做高可用，采用</strong><span style="color:#be191c;"><code><strong>db</strong></code></span><strong>模式为最佳</strong></p> 
<p><span style="color:#be191c;"><strong>只需关注db配置块的信息即可</strong></span></p> 
<p></p> 
<ul><li><strong>设置存储类型为db</strong></li></ul> 
<p><img alt="" height="311" src="https://images2.imgbox.com/c9/4d/oNE0morS_o.png" width="501"></p> 
<ul><li><strong>配置db连接、用户名和密码等相关信</strong></li></ul> 
<p><img alt="" height="225" src="https://images2.imgbox.com/01/41/8yIFX56Z_o.png" width="506"></p> 
<h3>4、新建DB库和表</h3> 
<blockquote> 
 <strong>db模式需要在数据库创建 </strong> 
 <span style="color:#be191c;"><code><strong>global_table</strong></code></span> 
 <strong>, </strong> 
 <span style="color:#be191c;"><code><strong>branch_table</strong></code></span> 
 <strong>, </strong> 
 <span style="color:#be191c;"><code><strong>lock_table</strong></code></span> 
 <strong>表</strong> 
</blockquote> 
<ul><li><strong>参考文档</strong></li></ul> 
<p><a class="link-info has-card" href="https://seata.io/zh-cn/docs/ops/deploy-ha.html" rel="nofollow" title="https://seata.io/zh-cn/docs/ops/deploy-ha.html"><span class="link-card-box"><span class="link-title">https://seata.io/zh-cn/docs/ops/deploy-ha.html</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/f7/97/Xl5fGJ9t_o.png">https://seata.io/zh-cn/docs/ops/deploy-ha.html</span></span></a></p> 
<p></p> 
<p><img alt="" height="277" src="https://images2.imgbox.com/13/bb/1IMcU1Qr_o.png" width="627"></p> 
<h4> 4.1、MySQL DB脚本</h4> 
<pre><code class="language-sql">-- -------------------------------- The script used when storeMode is 'db' --------------------------------
-- the table to store GlobalSession data
CREATE TABLE IF NOT EXISTS `global_table`
(
    `xid`                       VARCHAR(128) NOT NULL,
    `transaction_id`            BIGINT,
    `status`                    TINYINT      NOT NULL,
    `application_id`            VARCHAR(32),
    `transaction_service_group` VARCHAR(32),
    `transaction_name`          VARCHAR(128),
    `timeout`                   INT,
    `begin_time`                BIGINT,
    `application_data`          VARCHAR(2000),
    `gmt_create`                DATETIME,
    `gmt_modified`              DATETIME,
    PRIMARY KEY (`xid`),
    KEY `idx_gmt_modified_status` (`gmt_modified`, `status`),
    KEY `idx_transaction_id` (`transaction_id`)
) ENGINE = InnoDB
  DEFAULT CHARSET = utf8;

-- the table to store BranchSession data
CREATE TABLE IF NOT EXISTS `branch_table`
(
    `branch_id`         BIGINT       NOT NULL,
    `xid`               VARCHAR(128) NOT NULL,
    `transaction_id`    BIGINT,
    `resource_group_id` VARCHAR(32),
    `resource_id`       VARCHAR(256),
    `branch_type`       VARCHAR(8),
    `status`            TINYINT,
    `client_id`         VARCHAR(64),
    `application_data`  VARCHAR(2000),
    `gmt_create`        DATETIME(6),
    `gmt_modified`      DATETIME(6),
    PRIMARY KEY (`branch_id`),
    KEY `idx_xid` (`xid`)
) ENGINE = InnoDB
  DEFAULT CHARSET = utf8;

-- the table to store lock data
CREATE TABLE IF NOT EXISTS `lock_table`
(
    `row_key`        VARCHAR(128) NOT NULL,
    `xid`            VARCHAR(128),
    `transaction_id` BIGINT,
    `branch_id`      BIGINT       NOT NULL,
    `resource_id`    VARCHAR(256),
    `table_name`     VARCHAR(32),
    `pk`             VARCHAR(36),
    `gmt_create`     DATETIME,
    `gmt_modified`   DATETIME,
    PRIMARY KEY (`row_key`),
    KEY `idx_branch_id` (`branch_id`)
) ENGINE = InnoDB
  DEFAULT CHARSET = utf8;

CREATE TABLE IF NOT EXISTS `distributed_lock`
(
    `lock_key`       CHAR(20) NOT NULL,
    `lock_value`     VARCHAR(20) NOT NULL,
    `expire`         BIGINT,
    primary key (`lock_key`)
) ENGINE = InnoDB
  DEFAULT CHARSET = utf8mb4;

INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES ('AsyncCommitting', ' ', 0);
INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES ('RetryCommitting', ' ', 0);
INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES ('RetryRollbacking', ' ', 0);
INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES ('TxTimeoutCheck', ' ', 0);

    </code></pre> 
<p><a class="has-card" href="https://github.com/seata/seata/tree/develop/script/server/db" title="seata/script/server/db at develop · seata/seata · GitHub"><span class="link-card-box"><span class="link-title">seata/script/server/db at develop · seata/seata · GitHub</span><span class="link-desc">:fire: Seata is an easy-to-use, high-performance, open source distributed transaction solution. - seata/script/server/db at develop · seata/seata</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/77/d4/UsaFeEup_o.png">https://github.com/seata/seata/tree/develop/script/server/db</span></span></a></p> 
<h4>4.2、最终执行后的DB库和表</h4> 
<p><img alt="" height="211" src="https://images2.imgbox.com/d3/25/CDGeDMm2_o.png" width="574"></p> 
<h3>5、Docker启动运行</h3> 
<p><span style="color:#be191c;"><strong>特别注意：如果Nacos和MySQL数据不是采用Docker安装的，Docker容器需要访问宿主机的网络，需要特别的设置。特别是Mac系统</strong></span></p> 
<p></p> 
<ul><li><strong>参考文档</strong></li></ul> 
<p><a class="link-info has-card" href="https://swiftflamel.com/2021/04/01/docker-container%E5%AE%B9%E5%99%A8%E5%86%85%E8%AE%BF%E9%97%AE%E5%AE%BF%E4%B8%BB%E6%9C%BAhost%E6%9C%8D%E5%8A%A1/" rel="nofollow" title="https://swiftflamel.com/2021/04/01/docker-container%e5%ae%b9%e5%99%a8%e5%86%85%e8%ae%bf%e9%97%ae%e5%ae%bf%e4%b8%bb%e6%9c%bahost%e6%9c%8d%e5%8a%a1/"><span class="link-card-box"><span class="link-title">https://swiftflamel.com/2021/04/01/docker-container%e5%ae%b9%e5%99%a8%e5%86%85%e8%ae%bf%e9%97%ae%e5%ae%bf%e4%b8%bb%e6%9c%bahost%e6%9c%8d%e5%8a%a1/</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/f8/17/ZdBz2AFs_o.png">https://swiftflamel.com/2021/04/01/docker-container%E5%AE%B9%E5%99%A8%E5%86%85%E8%AE%BF%E9%97%AE%E5%AE%BF%E4%B8%BB%E6%9C%BAhost%E6%9C%8D%E5%8A%A1/</span></span></a><a class="has-card" href="https://stackoverflow.com/questions/31324981/how-to-access-host-port-from-docker-container/43541732#43541732" rel="nofollow" title="How to access host port from docker container - Stack Overflow"><span class="link-card-box"><span class="link-title">How to access host port from docker container - Stack Overflow</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/69/17/tLFF5gHB_o.png">https://stackoverflow.com/questions/31324981/how-to-access-host-port-from-docker-container/43541732#43541732</span></span></a></p> 
<p><img alt="" height="282" src="https://images2.imgbox.com/7c/9e/KXLBUMTD_o.png" width="509"></p> 
<p></p> 
<h4>5.1、Docker运行脚本</h4> 
<ul><li><strong>启动环境变量参考文档</strong></li><li><a class="has-card" href="https://seata.io/zh-cn/docs/ops/deploy-by-docker.html" rel="nofollow" title="使用 Docker 部署 Seata Server"><span class="link-card-box"><span class="link-title">使用 Docker 部署 Seata Server</span><span class="link-desc">使用 Docker 部署 Seata Server</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/95/4a/5tKdVolj_o.jpg">https://seata.io/zh-cn/docs/ops/deploy-by-docker.html</span></span></a><img alt="" height="345" src="https://images2.imgbox.com/6b/a0/lxdI9dYY_o.png" width="424"></li></ul> 
<pre><code class="language-bash">docker run --name seata-server --net=host \
        -e SEATA_IP=172.18.75.176 \
        -e SEATA_PORT=8091 \
        -e STORE_MODE=db \
        -e SERVER_NODE=1 \
        -e SEATA_CONFIG_NAME=file:/root/seata-config/registry \
        -v /usr/local/deploy/seata-server/seata-config:/root/seata-config  \
        -v /usr/local/deploy/seata-server/logs:/root/logs \
        -d seataio/seata-server:1.4.2</code></pre> 
<blockquote> 
 <p></p> 
 <ul><li><strong>--name seata-server 启动的容器名称</strong></li><li><span style="color:#be191c;"><strong>--net=host 本地网络模式【Nacos没有采用Docker方式启动，方便Docker容器访问宿主机网络】</strong></span></li><li><strong>-e SEATA_IP=172.18.75.176 指定seata-server启动的IP, 该IP用于向注册中心注册时使用, 如eureka、nacos等</strong></li><li><strong>-e SEATA_PORT=8091 指定seata-server启动的端口, 默认为 </strong><code><strong>8091</strong></code></li><li><strong>-e STORE_MODE=db 指定seata-server的事务日志存储方式, 支持</strong><code><strong>db</strong></code><strong> ,</strong><code><strong>file</strong></code><strong>,redis(Seata-Server 1.3及以上版本支持), 默认是 </strong><code><strong>file</strong></code></li><li><strong>-e SERVER_NODE=1 用于指定seata-server节点ID, 如 </strong><code><strong>1</strong></code><strong>,</strong><code><strong>2</strong></code><strong>,</strong><code><strong>3</strong></code><strong>..., 默认为 </strong><code><strong>根据ip生成</strong></code></li><li><strong>-e SEATA_CONFIG_NAME=file:/root/seata-config/registry 指定配置文件位置</strong></li><li><strong>-v /usr/local/deploy/seata-server/seata-config:/root/seata-config 挂载配置目录卷</strong></li><li><strong>/usr/local/deploy/seata-server/logs:/root/logs 挂载日志目录卷</strong></li><li><strong>-d seataio/seata-server:1.4.2 后台启动运行镜像文件</strong></li></ul> 
</blockquote> 
<h4>5.2、docker-compose运行启动</h4> 
<pre><code class="language-bash"># 后台运行seata-server
docker-compose -f docker-compose.yml up -d</code></pre> 
<ul><li><span style="color:#be191c;"><strong>docker-compose.yml配置文件(单节点)</strong></span></li></ul> 
<pre><code class="language-bash">version: "3"
services:
  # 指定服务名称
  seata-server-1:
    # 指定服务使用的镜像
    image: seataio/seata-server:1.4.2
    # 指定容器名称
    container_name: seata-server-1
    # 指定服务运行的端口
    #ports:
    #  - 8091:8091
    # 指定容器中需要挂载的文件
    volumes:
      # 挂载的配置文件目录
      - /usr/local/deploy/seata-server/seata-config:/root/seata-config
      # 挂载的日志目录
      - /usr/local/deploy/seata-server/logs:/root/logs
      # 指定容器的环境变量
    environment:
      # 指定seata-server启动的IP, 该IP用于向注册中心注册时使用,比如naocs注册中心
      # 默认使用的内网ip,seata-client通过nacos注册中心连接时,获取seata-server获取到的连接地址
      - SEATA_IP=172.18.75.176
      # 指定seata-server启动的端口, 默认为 8091
      - SEATA_PORT=8091
      # 指定seata-server的事务日志存储方式, 支持db ,file,redis(Seata-Server 1.3及以上版本支持), 默认是 file
      - STORE_MODE=db
      # 用于指定seata-server节点ID, 如 1,2,3..., 默认为 根据ip生成
      - SERVER_NODE=1
      # 指定配置文件位置
      - SEATA_CONFIG_NAME=file:/root/seata-config/registry
      # 设置网络模式
    network_mode: "host"</code></pre> 
<p><span style="color:#be191c;"> <strong>很关键，很核心的配置</strong></span></p> 
<p><span style="color:#be191c;"><strong><img alt="" height="300" src="https://images2.imgbox.com/32/79/tPIYnVn9_o.png" width="515"></strong></span></p> 
<h3>6、容器命令行及查看日志</h3> 
<h4>6.1、进入容器</h4> 
<pre><code class="language-bash">$ docker exec -it seata-server sh</code></pre> 
<p style="text-align:center;"><img alt="" class="left" height="226" src="https://images2.imgbox.com/e7/54/yyp1kUiX_o.png" width="546"></p> 
<h4> 6.1、查看日志</h4> 
<pre><code class="language-bash">$ docker logs -f seata-server</code></pre> 
<blockquote> 
 <p><span style="color:#be191c;"><strong>这些日志可以在启动运行时，挂载映射日志目录中查看</strong></span></p> 
 <p><em><strong># 挂载的日志目录</strong></em></p> 
 <p><strong>- /usr/local/deploy/seata-server/logs:/root/logs</strong>  </p> 
</blockquote> 
<p> <img alt="" height="144" src="https://images2.imgbox.com/ca/8c/C3vOVCd0_o.png" width="569"></p> 
<p></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d835120bf24c275ddce0b8bb268a201b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL高性能索引策略</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/aa92e9f66f46b1c667a8f8b77ebb0518/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">BUUCTF-强网杯2019随便注 write up（笔记系列）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>