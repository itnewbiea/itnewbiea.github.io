<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>第一个Unity项目——Flappy Bird - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="第一个Unity项目——Flappy Bird" />
<meta property="og:description" content="Unity是什么：
它就是一个2D/3D编辑器，同时又是一个游戏引擎
游戏引擎：使用者只需要调用这些功能，而不需要重写实现这些功能
第一步：资源导入与资源处理 资源导入的方法：
直接将资源拖入Project面板
资源处理
2D游戏总的来说是依靠Sprites(图片精灵)
Sprite的类型
Default——默认纹理类型
Normal map——法线贴图资源
Editor GUI and Legacy ——用户界面的特图资源
Sprite——图片精灵
Cursor——鼠标光标
Cookie——光斑
Lightmap——光照贴图
Directional Lightmap——方向光贴图
Single Channel——单通道纹理
主角图片的创建
首先要将Single(单张图片) 变为Multiple(多张图片)
然后点击Sprite Editor 进行图片编辑
对图片进行分割
Automatic 自动
Grid By Cell Size 按照每一格像素切割
Gird By Cell Count 按照图片的数量切割
透明模式与颜色模式
场景创建 场景的层级关系
不同的图片处于不同的层级
Sorting Layer 层级的设置
Order in Layer 层级的优先级
1、
同一层级的图片，优先级越大，图片越处在前面
2、
添加新的图层，越在下的图层就越在前。
项目开始：快捷Ctrl&#43;P
主角组件创建
增加组件
2D物理组件
2D刚体
圆形碰撞器
场景组件创建
添加Colider(碰撞器)
编辑编辑器
第二步：添加代码脚本 设置代码编辑器：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/0d17c5e11be9b0fd2a06b30541e57781/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-11T16:05:20+08:00" />
<meta property="article:modified_time" content="2022-04-11T16:05:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">第一个Unity项目——Flappy Bird</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>Unity是什么：<br> 它就是一个2D/3D编辑器，同时又是一个游戏引擎<br> 游戏引擎：使用者只需要调用这些功能，而不需要重写实现这些功能</p> 
<h3><a id="_5"></a>第一步：资源导入与资源处理</h3> 
<p><strong>资源导入的方法：</strong></p> 
<ol><li> <p><img src="https://images2.imgbox.com/03/ae/Wd9wGNG3_o.png" alt="在这里插入图片描述"></p> </li><li> <p>直接将资源拖入<strong>Project面板</strong></p> </li></ol> 
<p><strong>资源处理</strong><br> 2D游戏总的来说是依靠Sprites(图片精灵)</p> 
<p><img src="https://images2.imgbox.com/00/e0/9nRCZ3Xk_o.png" alt="在这里插入图片描述"><br> Sprite的类型<br> Default——默认纹理类型<br> Normal map——法线贴图资源<br> Editor GUI and Legacy ——用户界面的特图资源<br> Sprite——图片精灵<br> Cursor——鼠标光标<br> Cookie——光斑<br> Lightmap——光照贴图<br> Directional Lightmap——方向光贴图<br> Single Channel——单通道纹理</p> 
<p><strong>主角图片的创建</strong><br> <img src="https://images2.imgbox.com/e6/bb/NUYTd2uj_o.png" alt="在这里插入图片描述"><br> 首先要将<strong>Single</strong>(单张图片) 变为<strong>Multiple</strong>(多张图片)<br> 然后点击Sprite Editor 进行图片编辑<br> <img src="https://images2.imgbox.com/db/0b/1437t9bQ_o.png" alt="在这里插入图片描述"><br> 对图片进行分割<br> Automatic 自动<br> Grid By Cell Size 按照每一格像素切割<br> Gird By Cell Count 按照图片的数量切割</p> 
<p><img src="https://images2.imgbox.com/d6/07/kZ1CHM7r_o.png" alt="在这里插入图片描述"><br> 透明模式与颜色模式</p> 
<h3><a id="_40"></a>场景创建</h3> 
<p><img src="https://images2.imgbox.com/52/fc/W77tKLMV_o.png" alt="在这里插入图片描述"><br> 场景的层级关系<br> 不同的图片处于不同的层级<br> Sorting Layer 层级的设置<br> Order in Layer 层级的优先级<br> 1、<br> 同一层级的图片，优先级越大，图片越处在前面</p> 
<p>2、<br> <img src="https://images2.imgbox.com/1b/32/VYo7ptCl_o.png" alt="在这里插入图片描述"><br> 添加新的图层，越在下的图层就越在前。</p> 
<p>项目开始：快捷<strong>Ctrl+P</strong></p> 
<p><strong>主角组件创建</strong></p> 
<p><img src="https://images2.imgbox.com/e2/7f/np8E9Rsf_o.png" alt="在这里插入图片描述"><br> 增加组件</p> 
<p><img src="https://images2.imgbox.com/f3/51/mvMFmfhW_o.png" alt="在这里插入图片描述"><br> 2D物理组件<br> <img src="https://images2.imgbox.com/c6/f6/VY3Vm1sQ_o.png" alt="2d"><br> 2D刚体</p> 
<p><img src="https://images2.imgbox.com/18/8e/bCZxSM3F_o.png" alt="在这里插入图片描述"><br> 圆形碰撞器</p> 
<p><strong>场景组件创建</strong></p> 
<p><img src="https://images2.imgbox.com/bf/2a/9sOUEMWh_o.png" alt="在这里插入图片描述"><br> 添加Colider(碰撞器)</p> 
<p><img src="https://images2.imgbox.com/8c/03/Hg7TA2n3_o.png" alt="在这里插入图片描述"><br> 编辑编辑器</p> 
<h3><a id="_81"></a>第二步：添加代码脚本</h3> 
<p>设置代码编辑器：<br> <img src="https://images2.imgbox.com/44/21/AbKrEVmX_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/61/a0/3GPIwBXR_o.png" alt="在这里插入图片描述"><br> 常见的MonoBehaviour类的消息<br> <img src="https://images2.imgbox.com/5d/46/E93R3R7U_o.png" alt="在这里插入图片描述"><br> 快捷使用unity的各类方法(消息)<br> <img src="https://images2.imgbox.com/4b/66/4oD9am0J_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/95/85/XLd60uQ5_o.png" alt="在这里插入图片描述"></p> 
<ol><li>点击屏幕时，使Bird能够飞翔</li></ol> 
<pre><code class="prism language-csharp">  <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButtonUp</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//Input为unity的一个类，调用这个类中的GetMouseButtonUp()的方法 ，检查鼠标是否按下。(0位左键，1为右键)</span>
            <span class="token punctuation">{<!-- --></span>
                rb2d<span class="token punctuation">.</span>velocity <span class="token operator">=</span> Vector2<span class="token punctuation">.</span>zero<span class="token punctuation">;</span><span class="token comment">//将速度设置为0,每一帧的速度都为0</span>

                rb2d<span class="token punctuation">.</span><span class="token function">AddForce</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">360</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一个向上的力</span>
            <span class="token punctuation">}</span>
</code></pre> 
<p>2.小鸟碰撞与死亡</p> 
<pre><code class="prism language-csharp">   <span class="token class-name"><span class="token keyword">bool</span></span> isDead<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnCollisionEnter2D</span><span class="token punctuation">(</span><span class="token class-name">Collision2D</span> collision<span class="token punctuation">)</span><span class="token comment">//碰撞检测</span>
    <span class="token punctuation">{<!-- --></span>
        isDead <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
</code></pre> 
<p>碰撞有三种状态<br> 1、OnCollisionStay2D 碰撞进行<br> 2、OnCollisionEnter2D 碰撞开始<br> 3、OnCollisionExit2D 碰撞退出</p> 
<p>思考题<br> 1、Unity引擎是如何知道我们的脚本中没有写特定名字的方法的？又是如何调用的？<br> 通过反射，查找特定的名字<br> 通过反射直接调用该方法<br> 2、能否将碰撞处理放在Ground对象上？<br> 能</p> 
<pre><code class="prism language-csharp">   <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnCollisionEnter2D</span><span class="token punctuation">(</span><span class="token class-name">Collision2D</span> collision<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//collision.gameObject.GetComponent&lt;SpriteRenderer&gt;().enabled = false;//获得碰撞体的SpriteRenderer组件，并启用状态设为关闭</span>

        collision<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Bird<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isDead <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//将碰撞体的Bird组件的isDead设为ture</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>3、一个对象A的子对象B发生1碰撞，A会不会收到碰撞信息</p> 
<p>1、如果父节点和子节点都有Rigidbody，就相当于两个独立的物体，各自碰各自的。<br> 2、如果父节点有Rigidbody，子节点没有，子节点相当于父节点的一部分，就看在谁的身上有响应的接口，在父节点有响应接口，父节点响应，子节点有接口，子节点响应，两者都有接口，父节点不会影响到子节点，但子节点响应会让父节点也响应。<br> 3、如果父节点没有Rigidbody，子节点有，子节点会响应，父节点没有响应。</p> 
<p>GameObject 和gameobject的区别</p> 
<p>GameObject是Unity场景中所有实体的基类，是一个类型<br> gameobject是一个对象，就和this一样，指这个脚本所附着的游戏物体</p> 
<h3><a id="__153"></a>第三步 动画创建</h3> 
<p><a href="https://editor.csdn.net/md?not_checkout=1&amp;articleId=124061440" rel="nofollow">unity中的动画系统</a></p> 
<p><strong>1、选中游戏对象</strong><br> <img src="https://images2.imgbox.com/1e/12/mfdDwMQT_o.png" alt="在这里插入图片描述"><br> <strong>2、创建动画并命名</strong><br> <img src="https://images2.imgbox.com/08/03/PQ25YHnC_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/56/d0/rAZbuJVI_o.png" alt="在这里插入图片描述"><br> 动画控制器<br> <img src="https://images2.imgbox.com/22/9b/gT8fYZ5z_o.png" alt="在这里插入图片描述"><br> 游戏对象上Animator都会有一个动画控制器</p> 
<p><img src="https://images2.imgbox.com/31/3f/yyEWa90f_o.png" alt="在这里插入图片描述"><br> 动画片段</p> 
<p><strong>3、动画制作</strong><br> 打开动画片段后，选中游戏对象</p> 
<p>进入动画编辑界面<br> <img src="https://images2.imgbox.com/64/39/3pD5eShI_o.png" alt="在这里插入图片描述"><br> 开启记录关键帧，将图片拖入动画，将采样率设置为1,。<br> 定位到第一秒中的位置<br> 添加关键帧(keyframe)<br> 最后停止记录关键帧</p> 
<p><strong>4、动画控制器设置</strong><br> 进入动画控制器中，建立各个动画之间的转换<br> <img src="https://images2.imgbox.com/e3/93/eSC6O99J_o.png" alt="在这里插入图片描述"><br> 添加两个触发器<br> <img src="https://images2.imgbox.com/8e/96/IZqHyK5J_o.png" alt="在这里插入图片描述"><br> 在Idle转换Flap中，将触发器设置为转换的条件<br> Conditions：条件<br> <img src="https://images2.imgbox.com/7b/e8/OjNCF1ME_o.png" alt="在这里插入图片描述"><br> 然后通过代码进行控制</p> 
<pre><code class="prism language-csharp">   <span class="token class-name">Animator</span> anim<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-csharp"> anim <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-csharp">   anim<span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Flap"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>完成后发现动画播放比较慢，将<br> <img src="https://images2.imgbox.com/7a/70/xnfvEGaa_o.png" alt="在这里插入图片描述"><br> 取消。<br> 它的作用就是是否等待上一个动画播放结束。</p> 
<p>将Idle与Flap相互联系，可以让Idle和Flap相互转换，但注意在Flap转换Idle时，要将Has Exit Time 勾上，以防止在长时间没有Flap下，可以让Flap自动转换为Idle。<br> <img src="https://images2.imgbox.com/2e/8d/tNx5U79r_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_UI_212"></a>第四步 UI设计</h3> 
<p>添加三个Text<br> 分别是 Score、Gameover、HinText<br> 用于显示分数、游戏结束、游戏提示</p> 
<p><img src="https://images2.imgbox.com/3b/a7/n0Dd94eV_o.png" alt="在这里插入图片描述"></p> 
<p>然后进行UI设计</p> 
<p><img src="https://images2.imgbox.com/82/54/oMofdECq_o.png" alt="在这里插入图片描述"></p> 
<p>Text：文本内容设置<br> Font ：文本字体设置<br> Font Size ：文本字体大小设置<br> Horizontal Overflow :水平溢出<br> Vertical Overflow：垂直溢出<br> Color：颜色</p> 
<h3><a id="_230"></a>第五步：游戏逻辑控制器</h3> 
<p>添加一个空对象作为游戏逻辑控制器<br> <img src="https://images2.imgbox.com/67/2d/GbRayA6v_o.png" alt="在这里插入图片描述"><br> 然后增加一个游戏逻辑控制脚本</p> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GameControl</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">bool</span></span> gameOver <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> gameovertext<span class="token punctuation">;</span><span class="token comment">//设置一个Hierarchy层的游戏对象</span>
    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> hintext<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> scoretext<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token function">GameControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">GameControl</span> instance <span class="token punctuation">;</span><span class="token comment">//游戏控制器一般只有一个，所以使用单例模式</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">GameControl</span> <span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GameControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        instance <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        
    <span class="token punctuation">}</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>gameOver<span class="token operator">==</span><span class="token boolean">true</span> <span class="token operator">&amp;&amp;</span> Input<span class="token punctuation">.</span><span class="token function">GetMouseButtonUp</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            SceneManager<span class="token punctuation">.</span><span class="token function">LoadScene</span><span class="token punctuation">(</span><span class="token string">"Main"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//加载场景</span>
        <span class="token punctuation">}</span>
        
    <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span>  <span class="token function">OnBirdDied</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        gameOver <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        gameovertext<span class="token punctuation">.</span><span class="token function">SetActive</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//死亡后使Text显示处理</span>
        hintext<span class="token punctuation">.</span><span class="token function">SetActive</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
<span class="token punctuation">}</span>

碰撞时调用上面的<span class="token function">OnBirdDied</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法
Brid类
  <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnCollisionEnter2D</span><span class="token punctuation">(</span><span class="token class-name">Collision2D</span> collision<span class="token punctuation">)</span><span class="token comment">//碰撞检测</span>
    <span class="token punctuation">{<!-- --></span>
        isDead <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//优先更改数据，再进行画面表现</span>
        anim<span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Die"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        GameControl<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">OnBirdDied</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用方法</span>

    <span class="token punctuation">}</span>

</code></pre> 
<p>同时注意要将代码中的字段与游戏物体相关联。<br> <img src="https://images2.imgbox.com/17/cd/IpsSRsOB_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="__300"></a>第六步 制作卷轴背景</h3> 
<p>方法一：通过动画实现<br> 添加两个动画控制器，分别控制两个不同的背景进行滚动<br> <img src="https://images2.imgbox.com/70/f8/NYKPMrSp_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6e/3a/aivaNChz_o.png" alt="在这里插入图片描述"><br> 注意动画播放的速度要改为匀速</p> 
<p>方法二：通过代码控制</p> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Scrolling</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Rigidbody2D</span> rb2d<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">float</span></span> startPosx<span class="token punctuation">;</span><span class="token comment">//起始的位置</span>
    <span class="token class-name"><span class="token keyword">float</span></span> width<span class="token punctuation">;</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        rb2d <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rigidbody2D<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rb2d<span class="token punctuation">.</span>velocity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        width <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>BoxCollider2D<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
        startPosx <span class="token operator">=</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x<span class="token punctuation">;</span>


    <span class="token punctuation">}</span>


    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>GameControl<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>gameOver <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            rb2d<span class="token punctuation">.</span>velocity <span class="token operator">=</span> Vector2<span class="token punctuation">.</span>zero<span class="token punctuation">;</span><span class="token comment">//将卷轴停下</span>
     
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">if</span> <span class="token punctuation">(</span>startPosx <span class="token operator">-</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">&gt;=</span> width<span class="token punctuation">)</span><span class="token comment">//如果起始位置-现在的位置</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Vector3</span> pos <span class="token operator">=</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span><span class="token comment">//trsnsfrom作为结构体，position属性无法直接赋值</span>
            pos<span class="token punctuation">.</span>x <span class="token operator">=</span> startPosx<span class="token punctuation">;</span>
            transform<span class="token punctuation">.</span>position <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="__351"></a>第七步 添加障碍</h3> 
<p><img src="https://images2.imgbox.com/20/fe/ANhDxVFs_o.png" alt="在这里插入图片描述"><br> 将障碍设置为预制体，然后给障碍添加滚动的脚本。</p> 
<p><img src="https://images2.imgbox.com/6a/4c/tDqE5ZiS_o.png" alt="在这里插入图片描述"><br> 在原有的scrolling脚本上修改。</p> 
<p>public 让外界可以控制障碍回头的距离，方便与其他有相同的游戏物体区分。<br> if(width==0) 是让与障碍相同的脚本的游戏物体可以共用脚本。</p> 
<hr> 
<p>注意：<br> 要将刚体组件设置为<strong>Kinematic.</strong>，让游戏物体<strong>不受物理影响</strong></p> 
<p><img src="https://images2.imgbox.com/89/71/Qvie1bsu_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="__369"></a>第八步 通过障碍加分</h3> 
<p><img src="https://images2.imgbox.com/95/48/q25UvK6l_o.png" alt="在这里插入图片描述"></p> 
<p>在预制体中，给障碍添加一个得分的碰撞器，然后将碰撞器改为 Trigger触发器的模式</p> 
<p>代码</p> 
<p>Control类</p> 
<pre><code class="prism language-csharp">  <span class="token keyword">public</span> <span class="token class-name">GameObject</span> scoretext<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">int</span></span> score <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        score <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        scoretext<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Text<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"Score:{0}"</span><span class="token punctuation">,</span> score<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>Bird类</p> 
<pre><code class="prism language-csharp">  <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnTriggerExit2D</span><span class="token punctuation">(</span><span class="token class-name">Collider2D</span> collision<span class="token punctuation">)</span><span class="token comment">//触发检测</span>
    <span class="token punctuation">{<!-- --></span>
        GameControl<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">OnScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="__396"></a>第九步 动态生成障碍</h3> 
<p><img src="https://images2.imgbox.com/20/78/1aWVf4Re_o.png" alt="在这里插入图片描述"><br> 添加两个空节点Upper 和Lower 作为最小上界 和最小下界</p> 
<p>代码</p> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Spawner</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span><span class="token comment">//Spawner 生成者</span>

    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> gamePrefab<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> lowerbound<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> upperbound<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> interval <span class="token operator">=</span> <span class="token number">4f</span><span class="token punctuation">;</span> <span class="token comment">//时间间隔</span>
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">InvokeRepeating</span><span class="token punctuation">(</span><span class="token string">"Spawn"</span><span class="token punctuation">,</span>interval<span class="token punctuation">,</span>interval<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Invoke:调用 Repeating:重复 //4秒已后，每隔4秒，重复执行“Spawner”方法</span>
        
    <span class="token punctuation">}</span>
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Spawn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//GameObject column = new GameObject();</span>
        <span class="token comment">//column = gamePrefab;</span>

       <span class="token class-name">GameObject</span> column<span class="token operator">=</span>  <span class="token function">Instantiate</span><span class="token punctuation">(</span>gamePrefab<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//根据预制体实例化一个对象</span>
        column<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position <span class="token operator">=</span> Vector3<span class="token punctuation">.</span><span class="token function">Lerp</span><span class="token punctuation">(</span>lowerbound<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>upperbound<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token number">0f</span><span class="token punctuation">,</span><span class="token number">1f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        
    <span class="token punctuation">}</span>


    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>定点消除障碍<br> Scrolling类</p> 
<pre><code class="prism language-csharp">  <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">bool</span></span> destory <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>startPosx <span class="token operator">-</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">&gt;=</span> width<span class="token punctuation">)</span><span class="token comment">//如果起始位置-现在的位置</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>destory <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token comment">//将destory勾上，就可以执行到这</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">Destroy</span><span class="token punctuation">(</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Vector3</span> pos <span class="token operator">=</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span><span class="token comment">//trsnsfrom作为结构体，position属性无法直接赋值</span>
            pos<span class="token punctuation">.</span>x <span class="token operator">=</span> startPosx<span class="token punctuation">;</span>
            transform<span class="token punctuation">.</span>position <span class="token operator">=</span> pos<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            
          
        <span class="token punctuation">}</span>
</code></pre> 
<p>注意在预制体中<br> <img src="https://images2.imgbox.com/98/12/ITMr7Xop_o.png" alt="在这里插入图片描述"><br> 因为要执行到destory。</p> 
<h3><a id="__460"></a>补充 对象池的使用</h3> 
<p>动态生成障碍，会造成内存碎片。</p> 
<p>代码</p> 
<p>ColumnPool类</p> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ColumnsPool</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
   <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> poolsize <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> gamePrefab<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> lowerbound<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> upperbound<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> interval <span class="token operator">=</span> <span class="token number">4f</span><span class="token punctuation">;</span> <span class="token comment">//时间间隔</span>

    <span class="token keyword">public</span> <span class="token class-name">Queue<span class="token punctuation">&lt;</span>GameObject<span class="token punctuation">&gt;</span></span> pools<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ColumnsPool</span> instance<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        instance <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        pools <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Queue<span class="token punctuation">&lt;</span>GameObject<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> poolsize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//实例化一百个柱子，将其设为关闭。然后入队</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">GameObject</span> column <span class="token operator">=</span> <span class="token function">Instantiate</span><span class="token punctuation">(</span>gamePrefab<span class="token punctuation">)</span><span class="token punctuation">;</span>
            column<span class="token punctuation">.</span><span class="token function">SetActive</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            pools<span class="token punctuation">.</span><span class="token function">Enqueue</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">InvokeRepeating</span><span class="token punctuation">(</span><span class="token string">"Spawn"</span><span class="token punctuation">,</span> interval<span class="token punctuation">,</span> interval<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Spawn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//栈内的柱子预制体出队，将其启动，然后柱子在上界和下界取随机值，生成不同的柱子。</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">GameObject</span> column <span class="token operator">=</span> pools<span class="token punctuation">.</span><span class="token function">Dequeue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        column<span class="token punctuation">.</span><span class="token function">SetActive</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        column<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position <span class="token operator">=</span> Vector3<span class="token punctuation">.</span><span class="token function">Lerp</span><span class="token punctuation">(</span>lowerbound<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span> upperbound<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span> Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token number">0f</span><span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Despawn</span><span class="token punctuation">(</span><span class="token class-name">GameObject</span> go<span class="token punctuation">)</span><span class="token comment">//将柱子关闭并重新入队</span>
    <span class="token punctuation">{<!-- --></span>
        go<span class="token punctuation">.</span><span class="token function">SetActive</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pools<span class="token punctuation">.</span><span class="token function">Enqueue</span><span class="token punctuation">(</span>go<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<p>Scrolling类调用Despawn方法</p> 
<pre><code class="prism language-csharp">   ColumnsPool<span class="token punctuation">.</span>instance<span class="token punctuation">.</span><span class="token function">Despawn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>对象池的好处：在生成一个固定的游戏物体时，可以减少不断重复实例化带来的内存碎片。<br> 实质：利用队列先进先出的特性，使障碍一直保持固定的数量，不增加内存的消耗。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e08fa3c6b7f516094d938098f979d779/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JS闭包问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f1cdaca07b1c4cd884ae69836bd8cb9e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringSecurity-OAuth2万文详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>