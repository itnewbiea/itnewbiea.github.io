<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>oracle dat文件导入 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="oracle dat文件导入" />
<meta property="og:description" content="今天在执行dat文件导入的时候，由于很久没执行过这种操作了，因此又变得生疏了，花了比较长的时间才弄好。然后看到网上关于oracle dat文件的导入介绍的都是一部分，所以特在这里总结一下。 一、dmp文件和dat文件的区别 1、dmp文件包含的信息有数据库的版本信息、数据文件的字符集、数据文件导出路径信息、数据库用户信息、数据库导出的表的信息、索引信息、表空间信息等数据库的详细信息。dat文件只是导入的表的数据信息。 2、oracle可以一次性导入多张表到dmp文件中，但是只能导一张表到dat文件中。 3、dmp文件可以包括表空间、索引、用户、表、序列、存储过程、视图等数据库的所有信息，并可以用这些信息还原整个数据库，但是dat文件只是用来存放表的数据信息，只能还原表的数据信息。 4、对于单张表的数据导入（即不需要创建表、创建表索引等信息）时，dat文件的导入要比dmp文件导入快很多，由其是对于数据量非常大的表。 5、dmp文件主要用于数据库备份、数据迁移等需要多张表操作或需要创建表信息的操作。dat文件主要用于纯数据的迁移和备份。 二、dat文件转换为控制文件（.ctl文件） 1、control文件 ------------------------------------------------------------------------ --SQL --程序功能： 在命令行用sqlplue自动生成sql*load控制文件 --输入参数： --&amp;1 表名 --&amp;2 数据文件名 --&amp;3 目录名 --返回值结果：生成文件为：目录名＋表名＋.ctl --调用: sqlplus PAS/pas123 @d:\control.sql jksj_ll 20091231_005_LL.dat d:\ --created by hqx 2010-03-26 --修改记录： ------------------------------------------------------------------------ set echo off set heading off set verify off set feedback off set show off set trim off set pages 0 set concat on set lines 300 set trimspool on set trimout on spool &amp;3&amp;1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/d4dc24822a7e57ce41db986e1edfe329/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2013-06-03T15:57:56+08:00" />
<meta property="article:modified_time" content="2013-06-03T15:57:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">oracle dat文件导入</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    今天在执行dat文件导入的时候，由于很久没执行过这种操作了，因此又变得生疏了，花了比较长的时间才弄好。然后看到网上关于oracle dat文件的导入介绍的都是一部分，所以特在这里总结一下。 
<br> 
<br> 一、dmp文件和dat文件的区别 
<br> 1、dmp文件包含的信息有数据库的版本信息、数据文件的字符集、数据文件导出路径信息、数据库用户信息、数据库导出的表的信息、索引信息、表空间信息等数据库的详细信息。dat文件只是导入的表的数据信息。 
<br> 2、oracle可以一次性导入多张表到dmp文件中，但是只能导一张表到dat文件中。 
<br> 3、dmp文件可以包括表空间、索引、用户、表、序列、存储过程、视图等数据库的所有信息，并可以用这些信息还原整个数据库，但是dat文件只是用来存放表的数据信息，只能还原表的数据信息。 
<br> 4、对于单张表的数据导入（即不需要创建表、创建表索引等信息）时，dat文件的导入要比dmp文件导入快很多，由其是对于数据量非常大的表。 
<br> 5、dmp文件主要用于数据库备份、数据迁移等需要多张表操作或需要创建表信息的操作。dat文件主要用于纯数据的迁移和备份。 
<br> 二、dat文件转换为控制文件（.ctl文件） 
<br> 1、control文件 
<br> ------------------------------------------------------------------------ 
<br> --SQL 
<br> --程序功能： 
<span style="white-space:pre"> </span>在命令行用sqlplue自动生成sql*load控制文件 
<br> --输入参数： 
<br> --&amp;1   表名 
<br> --&amp;2   数据文件名 
<br> --&amp;3   目录名 
<br> --返回值结果：生成文件为：目录名＋表名＋.ctl   
<br> --调用: sqlplus PAS/pas123 @d:\control.sql jksj_ll 20091231_005_LL.dat d:\ 
<br> --created by hqx  2010-03-26 
<br> --修改记录： 
<br> 
<br> 
<br> ------------------------------------------------------------------------  
<br> set echo off 
<br> set heading off 
<br> set verify off 
<br> set feedback off 
<br> set show off 
<br> set trim off 
<br> set pages 0 
<br> set concat on 
<br> set lines 300 
<br> set trimspool on 
<br> set trimout on  
<br> spool &amp;3&amp;1..ctl 
<br> 
<br> 
<br> select 'LOAD DATA'||chr (10)||         
<br>        'INFILE ''&amp;3&amp;2'''||chr (10)||    --说明导入文件的路径 
<br>        'APPEND INTO TABLE '||table_name||chr (10)||   --说明导入至的数据库表名 
<br>        'FIELDS TERMINATED BY '','''||chr (10)||   --说明dat文件列与列之间的分隔符 
<br>        'OPTIONALLY ENCLOSED BY ''"'''||chr (10)|| --说明包装数据类型的符号，即当在dat文件中用“”包装数据，这时需要配置“，数据库才不会读”. 
<br>        'TRAILING NULLCOLS'||chr (10)||'(' 
<br> from   all_tables 
<br> where  table_name = upper ('&amp;1'); 
<br> 
<br> 
<br> select decode (column_id, 1, '   ', ' , ')|| 
<br>        rpad (column_name, 33, ' ')|| 
<br>        decode (data_type, 
<br>                'VARCHAR2', 'CHAR NULLIF ('||column_name||'=BLANKS)',  --定义各datatype的为空时的处理方式 
<br>                'FLOAT',    'DECIMAL EXTERNAL NULLIF('||column_name||'=BLANKS)', 
<br>                'NUMBER',   decode (data_precision, 0, 
<br>                            'INTEGER EXTERNAL NULLIF ('||column_name|| 
<br>                            '=BLANKS)', decode (data_scale, 0, 
<br>                            'INTEGER EXTERNAL NULLIF ('|| 
<br>                            column_name||'=BLANKS)', 
<br>                            'DECIMAL EXTERNAL NULLIF ('|| 
<br>                            column_name||'=BLANKS)')), 
<br>                'DATE',     'DATE "MM/DD/YY"  NULLIF ('||column_name||'=BLANKS)', 
<br>                null) 
<br> from   user_tab_columns 
<br> where  table_name = upper ('&amp;1') 
<br> order  by column_id; 
<br> 
<br> 
<br> 
<br> 
<br> select ')'  
<br> from sys.dual; 
<br> spool off 
<br> exit 
<br> 2、根据control.sql文件生成对应的控制文件 
<br> 执行sqlplus student/869160 @C:\Users\Administrator\Desktop\control.sql JKSJ_DKBJLXSH DKSX.dat C:\Users\Administrator\Desktop\ 
<br> 这里的JKSJ_DKBJLXSH为control.sql里面的&amp;1，DKSX.dat为control.sql里面的&amp;2，C:\Users\Administrator\Desktop\为control.sql里面的&amp;3 
<br> 这样就生成了以表名JKSJ_DKBJLXSH为文件名的控制文件JKSJ_DKBJLXSH.ctl。如下： 
<br> LOAD DATA 
<br> INFILE 'C:\Users\Administrator\Desktop\DKSX.dat' 
<br> APPEND INTO TABLE JKSJ_DKBJLXSH 
<br> FIELDS TERMINATED BY ',' 
<br> OPTIONALLY ENCLOSED BY '"' 
<br> TRAILING NULLCOLS 
<br> ( 
<br> 
<br> 
<br>    ZHDH                             CHAR NULLIF (ZHDH=BLANKS) 
<br>  , JYRQ                             INTEGER EXTERNAL NULLIF (JYRQ=BLANKS) 
<br>  , ZJLSH                            CHAR NULLIF (ZJLSH=BLANKS) 
<br>  , QXRQ                             INTEGER EXTERNAL NULLIF (QXRQ=BLANKS) 
<br>  , JXRQ                             INTEGER EXTERNAL NULLIF (JXRQ=BLANKS) 
<br>  , BS                               CHAR NULLIF (BS=BLANKS) 
<br>  , JGDH                             CHAR NULLIF (JGDH=BLANKS) 
<br>  , KMH                              CHAR NULLIF (KMH=BLANKS) 
<br>  , JE                               DECIMAL EXTERNAL NULLIF (JE=BLANKS) 
<br>  , FL                               DECIMAL EXTERNAL NULLIF (FL=BLANKS) 
<br>  , WSFL                             DECIMAL EXTERNAL NULLIF (WSFL=BLANKS) 
<br>  , JXBJ                             DECIMAL EXTERNAL NULLIF (JXBJ=BLANKS) 
<br>  , JXLX                             DECIMAL EXTERNAL NULLIF (JXLX=BLANKS) 
<br>  , SQLX                             DECIMAL EXTERNAL NULLIF (SQLX=BLANKS) 
<br>  , JYM                              CHAR NULLIF (JYM=BLANKS) 
<br>  , BQYHBJ                           DECIMAL EXTERNAL NULLIF (BQYHBJ=BLANKS) 
<br>  , BQYHLX                           DECIMAL EXTERNAL NULLIF (BQYHLX=BLANKS) 
<br> ) 
<br> 
<br> 
<br> 3、根据生成的控制文件将数据文件导入数据库 
<br> 执行： 
<br> sqlldr userid=student/869160 control=C:\Users\Administrator\Desktop\JKSJ_DKBJLXSH.ctl log=C:\Users\Administrator\Desktop\JKSJ_DKBJLXSH.log direct=true； 
<br> 即语句为sqlldr userid=数据库用户名/密码 control=控制文件的绝对路径 log=日志文件存放绝对路径 direct=参数 
<br> 如果语句执行成功，会出现： 
<br> 
<br> 
<img src="https://images2.imgbox.com/3e/01/EcrJta14_o.jpg" alt=""> 
<br> 
<br> 
<br> 
<p>注：在windows环境下，在cmd窗口执行生成控制文件的语句时，由于设置了sqlplus，在.ctl控制文件中，可能会存在时间信息，这是需要手工删除这些信息，否则在执行数据文件导入时会报错。</p> 
<p><img src="https://images2.imgbox.com/99/9e/RWfbbvMW_o.jpg" alt=""><br> </p> 
<br> 
<br> 
<br> 
<br> 
<br> 
<br> 
<br> 
<br> 
<br> 
<br> 
<br> 
<br> 
<br> 
<br> 
<br>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7d3a45ca6c52689ea011e2ae5d1f88a7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">QT  用户界面美工</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f6049b8f235e62f73f8cda5bf84a498a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">遥感技术与应用介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>