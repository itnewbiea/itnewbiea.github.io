<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Required Long parameter ‘xx‘ is not present,请求的Long类型参数不存在 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Required Long parameter ‘xx‘ is not present,请求的Long类型参数不存在" />
<meta property="og:description" content="目录 第一次测试第二次测试第三次测试第四次测试第五次尝试第六 直接看这里,没有废话本次涉及到的两个注解@RequestParam和@RequestBody 关于前后端交互中传参的问题
起因是前端需要给后端传递两个long类型的id,如果是get请求那没问题,可我需要的是post请求,现在我就来一一复现我出错的原因,直接看第六
第一次测试 前端是用postman传json(就是这让我入坑,坑死我了)
这个json很有问题,后面再说
{ &#34;id1&#34;:64, &#34;id2&#34;:919 } 后端代码
public ResponseData focus(long id1, long id2){} 然后运行出错
//可选的长参数“id1”存在，但由于被声明为基元类型，因此无法转换为空值。考虑将其声明为对应基元类型的对象包装器 java.lang.IllegalStateException: Optional long parameter &#39;id1&#39; is present but cannot be translated into a null value due to being declared as a primitive type. Consider declaring it as object wrapper for the corresponding primitive type. 我就改成包装类Long继续测试
第二次测试 最大的bug来了,类型改为了包装类
public ResponseData focus(Long id1, Long id2){} 但是后端根本就取不到这个Long类型的id,这怎么行呢,get请求都没问题,一度想让我放弃post改用get
第三次测试 然后我就再改
//注意@RequestParam注解要有默认值或者@RequestParam(value = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/2baf74a0327cdbad7cf4aabe99b8fe6a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-22T19:07:09+08:00" />
<meta property="article:modified_time" content="2022-10-22T19:07:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Required Long parameter ‘xx‘ is not present,请求的Long类型参数不存在</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_4" rel="nofollow">第一次测试</a></li><li><a href="#_28" rel="nofollow">第二次测试</a></li><li><a href="#_36" rel="nofollow">第三次测试</a></li><li><a href="#_50" rel="nofollow">第四次测试</a></li><li><a href="#_69" rel="nofollow">第五次尝试</a></li><li><a href="#__82" rel="nofollow">第六 直接看这里,没有废话</a></li><li><a href="#RequestParamRequestBody_96" rel="nofollow">本次涉及到的两个注解@RequestParam和@RequestBody</a></li></ul> 
</div> 
<p></p> 
<p>关于前后端交互中传参的问题<br> 起因是前端需要给后端传递两个long类型的id,如果是get请求那没问题,可我需要的是post请求,现在我就来一一复现我出错的原因,<strong>直接看第六</strong></p> 
<h2><a id="_4"></a>第一次测试</h2> 
<p>前端是用postman传json(就是这让我入坑,坑死我了)<br> <img src="https://images2.imgbox.com/ca/f8/fhV1gzeb_o.png" alt="在这里插入图片描述"><br> 这个json很有问题,后面再说</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"id1"</span><span class="token operator">:</span><span class="token number">64</span><span class="token punctuation">,</span>
    <span class="token string-property property">"id2"</span><span class="token operator">:</span><span class="token number">919</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>后端代码</p> 
<pre><code>public ResponseData focus(long id1, long id2){}
</code></pre> 
<p>然后运行出错</p> 
<pre><code class="prism language-java"><span class="token comment">//可选的长参数“id1”存在，但由于被声明为基元类型，因此无法转换为空值。考虑将其声明为对应基元类型的对象包装器</span>
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>IllegalStateException</span><span class="token operator">:</span> <span class="token class-name">Optional</span> <span class="token keyword">long</span> parameter <span class="token char">'id1'</span> is present but cannot be translated into a <span class="token keyword">null</span> value due <span class="token keyword">to</span> <span class="token namespace">being</span> declared as a primitive <span class="token class-name"><span class="token namespace">type<span class="token punctuation">.</span></span> Consider</span> declaring it as object wrapper <span class="token keyword">for</span> the corresponding primitive type<span class="token punctuation">.</span>
	
</code></pre> 
<p>我就改成包装类Long继续测试</p> 
<h2><a id="_28"></a>第二次测试</h2> 
<p>最大的bug来了,类型改为了包装类</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">ResponseData</span> <span class="token function">focus</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id1<span class="token punctuation">,</span> <span class="token class-name">Long</span> id2<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
</code></pre> 
<p>但是后端根本就取不到这个Long类型的id,这怎么行呢,get请求都没问题,一度想让我放弃post改用get<br> <img src="https://images2.imgbox.com/77/ee/fmpD3P1v_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_36"></a>第三次测试</h2> 
<p>然后我就再改</p> 
<pre><code class="prism language-java"><span class="token comment">//注意@RequestParam注解要有默认值或者@RequestParam(value = "id1",required = false)不然出问题</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseData</span> <span class="token function">focus</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"id1"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id1<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"id2"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id2<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>
</code></pre> 
<p>错误原因</p> 
<pre><code class="prism language-java"><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span></span>MissingServletRequestParameterException</span><span class="token operator">:</span> <span class="token class-name">Required</span> <span class="token class-name">Long</span> parameter <span class="token char">'id1'</span> is not present
</code></pre> 
<p>因为后端没有得到id1这个参数,所以报错了,意思是:不存在必需的字符串参数’id1’<br> 所以除非一定有值否则@RequestParam注解要有默认值或者@RequestParam(value = “id1”,required = false)不然出问题</p> 
<h2><a id="_50"></a>第四次测试</h2> 
<p>不过依旧没解决我的问题,我在网上搜索,后端不再接收两个long类型参数了,改成数组代码如下</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">ResponseData</span> <span class="token function">focus</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> ids<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"ids"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">919</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>不过情况依旧没有好转</p> 
<pre><code class="prism language-java"><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span>converter<span class="token punctuation">.</span></span>HttpMessageNotReadableException</span><span class="token operator">:</span> JSON parse error<span class="token operator">:</span> <span class="token class-name">Cannot</span> deserialize instance of `<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>ArrayList</span>` out of <span class="token class-name">START_OBJECT</span> token<span class="token punctuation">;</span> nested exception is <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span>exc<span class="token punctuation">.</span></span>MismatchedInputException</span><span class="token operator">:</span> <span class="token class-name">Cannot</span> deserialize instance of `<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>ArrayList</span>` out of START_OBJECT token
 at <span class="token punctuation">[</span><span class="token class-name">Source</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token class-name">PushbackInputStream</span><span class="token punctuation">)</span><span class="token punctuation">;</span> line<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">]</span>
</code></pre> 
<h2><a id="_69"></a>第五次尝试</h2> 
<p>后来我把代码改成如下</p> 
<pre><code>public ResponseData focus(@RequestBody Long[] ids){}
</code></pre> 
<p>发生了如下错误</p> 
<pre><code class="prism language-java"><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span>converter<span class="token punctuation">.</span></span>HttpMessageNotReadableException</span><span class="token operator">:</span> JSON parse error<span class="token operator">:</span> <span class="token class-name">Cannot</span> deserialize instance of `<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span>` out of <span class="token class-name">START_OBJECT</span> token<span class="token punctuation">;</span> nested exception is <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span>exc<span class="token punctuation">.</span></span>MismatchedInputException</span><span class="token operator">:</span> <span class="token class-name">Cannot</span> deserialize instance of `<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span>` out of START_OBJECT token
 at <span class="token punctuation">[</span><span class="token class-name">Source</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token class-name">PushbackInputStream</span><span class="token punctuation">)</span><span class="token punctuation">;</span> line<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">]</span>
</code></pre> 
<h2><a id="__82"></a>第六 直接看这里,没有废话</h2> 
<p><font size="4" color="red">原来是前端传参的问题,我不知道这个大括号不能乱用,这个代表对象,既然是对象,那么后端存放对象的变量也得是对象,我只知道每次使用json都有个大括号,我以为是固定格式,导致我一直用错误的方法去接收前端的参数,导致大坑,既然后端要接收数组,去掉大括号就行了</font></p> 
<pre><code>//{
//    "ids":[64,919]
//}
[64,919]
</code></pre> 
<p>后端,只要前端传数组,下面写法都没问题,@RequestBody注解一定要有</p> 
<pre><code>public ResponseData focus(@RequestBody Long[] ids){}
public ResponseData focus(@RequestBody long[] ids){}
</code></pre> 
<h2><a id="RequestParamRequestBody_96"></a>本次涉及到的两个注解@RequestParam和@RequestBody</h2> 
<p><font color="red">除非一定有值否则@RequestParam注解要有默认值或者@RequestParam(value = “id1”,required = false)不然出问题(详情看第三次)<br> @RequestBody这是本次重点,可以作用在类上,表示类的所有方法都接收json/xml格式参数,作用在方法上,代表前端传参的类型是json或者xml,现在一般是json,所以前端传json,如果没有这个注解后端是取不到值的,为null,这一点一定要注意<br> 前端我一窍不通,我不知道这个大括号不能乱用,这个代表对象,既然是对象,那么后端存放对象的变量也得是对象,我只知道每次使用json都有个大括号,我以为是固定格式,导致我一直用错误的方法去接收前端的参数,导致大坑,既然后端要接收数组,去掉大括号就行了<br> @ResponseBody与之正好相反,一个是接收一个是返回,这是代表返回json格式的数据,也可以作用在类上和方法上</font></p> 
<p><strong>还有要注意的是对象与数组的json格式,可不能一上来就大括号{},通过这次试错,使我对json的理解更加深入,也让我更加理解@RequestBody这个注解,这也算是一大收获吧</strong></p> 
<pre><code>--------------------------------------------
//对象传输格式,属性一定要加双引号
{
	"id":"123",
	"name":"xiao"
}
--------------------------------------------
//普通数组
[123,34,67]
--------------------------------------------
//字符串数组
["小明","小刚","小陈"]
--------------------------------------------
//对象数组
[
	{
		"id":"123",
	    "name":"xiao"
	},
	{
		"id":"456",
	   "name":"ming"
	   }
]
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/08558e997a69d5122edf76991f138f24/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【配置文件】Redis - redis.conf - 学习/实践</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/256cd50c369ea7a766ebdb586482956c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[1166]CDH集群删除主机节点</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>