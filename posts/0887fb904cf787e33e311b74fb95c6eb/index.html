<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>lsof命令常见参数说明 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="lsof命令常见参数说明" />
<meta property="og:description" content="原文地址：http://www.linuxfly.org/post/182.htm lsof全名list opened files，也就是列举系统中已经被打开的文件。我 们都知道，linux环境中，任何事物都是文件，设备是文件，目录是文件，甚至sockets也是文件。所以，用好lsof命令，对日常的linux管理 非常有帮助。以下的说明，大部分内容来自lsof的manual文档。我所做的只是在中文翻译的基础上，进行简单的分类说明，并列举最常用的参数。 一、输出说明 lsof是linux最常用的命令之一，通常的输出格式为： 引用 COMMAND PID USER FD TYPE DEVICE SIZE NODE NAME 常见包括如下几个字段：更多的可见manual。 1、COMMAND 默认以9个字符长度显示的命令名称。可使用&#43;c参数指定显示的宽度，若&#43;c后跟的参数为零，则显示命令的全名 2、PID：进程的ID号 3、PPID 父进程的IP号，默认不显示，当使用-R参数可打开。 4、PGID 进程组的ID编号，默认也不会显示，当使用-g参数时可打开。 5、USER 命令的执行UID或系统中登陆的用户名称。默认显示为用户名，当使用-l参数时，可显示UID。 6、FD 是文件的File Descriptor number，或者如下的内容： （这里很难翻译对应的意思，保留英文） 引用 cwd current working directory; Lnn library references (AIX); jld jail directory (FreeBSD); ltx shared library text (code and data); Mxx hex memory-mapped type number xx. m86 DOS Merge mapped file; mem memory-mapped file; mmap memory-mapped device; pd parent directory; rtd root directory; tr kernel trace file (OpenBSD); txt program text (code and data); v86 VP/ix mapped file; 文件的File Descriptor number显示模式有： 引用 r for read access; w for write access; u for read and write access; N for a Solaris NFS lock of unknown type; r for read lock on part of the file; R for a read lock on the entire file; w for a write lock on part of the file; W for a write lock on the entire file; u for a read and write lock of any length; U for a lock of unknown type; x for an SCO OpenServer Xenix lock on part of the file; X for an SCO OpenServer Xenix lock on the entire file; space if there is no lock." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/0887fb904cf787e33e311b74fb95c6eb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2008-05-07T13:24:00+08:00" />
<meta property="article:modified_time" content="2008-05-07T13:24:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">lsof命令常见参数说明</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    原文地址：http://www.linuxfly.org/post/182.htm 
<br> 
<br>  
<span style="color: rgb(255, 69, 0);">lsof全名list opened files，也就是列举系统中已经被打开的文件。</span>我 们都知道，linux环境中，任何事物都是文件，设备是文件，目录是文件，甚至sockets也是文件。所以，用好lsof命令，对日常的linux管理 非常有帮助。以下的说明，大部分内容来自lsof的manual文档。我所做的只是在中文翻译的基础上，进行简单的分类说明，并列举最常用的参数。 
<br> 
<br> 
<strong><span style="color: rgb(65, 105, 225);">一、输出说明</span></strong> 
<br>    lsof是linux最常用的命令之一，通常的输出格式为： 
<br> 
<div class="quote"> 
 <div class="quote-title">
   引用 
 </div> 
 <div class="quote-content">
   COMMAND     PID   USER   FD      TYPE     DEVICE     SIZE       NODE NAME 
 </div> 
</div> 
<br>常见包括如下几个字段：更多的可见manual。 
<br> 
<strong>1、COMMAND</strong> 
<br>默认以9个字符长度显示的命令名称。可使用+c参数指定显示的宽度，若+c后跟的参数为零，则显示命令的全名 
<br> 
<strong>2、PID：进程的ID号</strong> 
<br> 
<strong>3、PPID</strong> 
<br>父进程的IP号，默认不显示，当使用-R参数可打开。 
<br> 
<strong>4、PGID</strong> 
<br>进程组的ID编号，默认也不会显示，当使用-g参数时可打开。 
<br> 
<strong>5、USER</strong> 
<br>命令的执行UID或系统中登陆的用户名称。默认显示为用户名，当使用-l参数时，可显示UID。 
<br> 
<strong>6、FD</strong> 
<br>是文件的File Descriptor number，或者如下的内容： 
<br>（这里很难翻译对应的意思，保留英文） 
<br> 
<div class="quote"> 
 <div class="quote-title">
   引用 
 </div> 
 <div class="quote-content">
   cwd  current working directory; 
  <br>Lnn  library references (AIX); 
  <br>jld  jail directory (FreeBSD); 
  <br>ltx  shared library text (code and data); 
  <br>Mxx  hex memory-mapped type number xx. 
  <br>m86  DOS Merge mapped file; 
  <br>mem  memory-mapped file; 
  <br>mmap memory-mapped device; 
  <br>pd   parent directory; 
  <br>rtd  root directory; 
  <br>tr   kernel trace file (OpenBSD); 
  <br>txt  program text (code and data); 
  <br>v86  VP/ix mapped file; 
 </div> 
</div> 
<br>文件的File Descriptor number显示模式有： 
<br> 
<div class="quote"> 
 <div class="quote-title">
   引用 
 </div> 
 <div class="quote-content">
   r for read access; 
  <br>w for write access; 
  <br>u for read and write access; 
  <br>N for a Solaris NFS lock of unknown type; 
  <br>r for read lock on part of the file; 
  <br>R for a read lock on the entire file; 
  <br>w for a write lock on part of the file; 
  <br>W for a write lock on the entire file; 
  <br>u for a read and write lock of any length; 
  <br>U for a lock of unknown type; 
  <br>x for an SCO OpenServer Xenix lock on part  of the file; 
  <br>X  for an SCO OpenServer Xenix lock on the entire file; 
  <br>space if there is no lock. 
 </div> 
</div> 
<br> 
<strong>7、TYPE</strong> 
<br> 
<div class="quote"> 
 <div class="quote-title">
   引用 
 </div> 
 <div class="quote-content">
   IPv4 IPv4的包； 
  <br>IPv6 使用IPv6格式的包，即使地址是IPv4的，也会显示为IPv6，而映射到IPv6的地址； 
  <br>DIR 目录 
  <br>LINK 链接文件 
 </div> 
</div> 
<br>详情请看manual中更多的注释。 
<br> 
<strong>8、DEVICE</strong> 
<br>使用character special、block special表示的设备号 
<br> 
<strong>9、SIZE</strong> 
<br>文件的大小，如果不能用大小表示的，会留空。使用-s参数控制。 
<br> 
<strong>10、NODE</strong> 
<br>本地文件的node码，或者协议，如TCP等 
<br> 
<strong>11、NAME</strong> 
<br>挂载点和文件的全路径（链接会被解析为实际路径），或者连接双方的地址和端口、状态等 
<br> 
<br> 
<strong><span style="color: rgb(65, 105, 225);">二、参数</span></strong> 
<br> 
<strong>1、不带额外参数运行</strong> 
<br> 
<div class="code">
  lsof path/filename 
</div> 
<br>显示已打开该目录或文件的所有进程信息 
<br> 
<div class="code">
  lsof `which httpd` 
</div> 
<br>显示指定命令的信息 
<br> 
<strong>2、参见参数</strong> 
<br>-c w 显示以w开头命令的已打开文件的信息 
<br> 
<div class="code">
  lsof -c sshd 
</div> 
<br>-p PID 显示指定PID已打开文件的信息 
<br> 
<div class="code">
  lsof -p 4401 
</div> 
<br>+d dir 依照文件夹dir来搜寻，但不会打开子目录 
<br> 
<div class="code">
  lsof +d /root 
</div> 
<br>+D dir 打开dir文件夹以及其子目录搜寻 
<br> 
<div class="code">
  lsof +D /root/ 
</div> 
<br>-d s 以FD列的信息进行匹配，可使用3-10，表示范围，3,10表示某些值 
<br> 
<div class="code">
  lsof -d 3-10 
</div> 
<br>-u 显示某用户的已经打开的文件（或该用户执行程序已经打开的文件） 
<br> 
<div class="code">
  lsof -u root 
 <br>lsof -u 0 
</div> 
<br> 
<span style="color: rgb(255, 69, 0);">◎可配合正规表达式使用</span> 
<br>表示不包括root用户的信息： 
<br> 
<div class="code">
  lsof -u ^root 
</div> 
<br>-i 监听指定的协议、端口、主机等的网络信息，格式为： 
<br> 
<div class="quote"> 
 <div class="quote-title">
   引用 
 </div> 
 <div class="quote-content">
   [46][proto][@host|addr][:svc_list|port_list] 
 </div> 
</div> 
<br>例如： 
<br> 
<div class="code">
  lsof -i tcp@192.168.228.244 
 <br>lsof -i:22 
</div> 
<br>还可以使用一些参数控制显示结果： 
<br> 
<div class="quote"> 
 <div class="quote-title">
   引用 
 </div> 
 <div class="quote-content">
   -l 禁止将userID转换为登陆名称，即显示UID 
  <br>-n 禁止将IP地址转换为hostname主机文件 
  <br>-P 不显示端口名称 
 </div> 
</div> 
<br>-g s 从PGID列进行匹配 
<br> 
<div class="code">
  lsof -g 3-10 
</div> 
<br> 
<br> 
<strong>3、其他参数</strong> 
<br>+f 所有路径参数都必须是文件系统，否则不能执行 
<br>-f 所有路径参数都将作为普通的文件，例如："-f -- /"中的/，只会匹配单个/路径，而不会是根目录中的所有文件 
<br>+f和-f后都应加上“--”表终结符： 
<br> 
<div class="code">
  lsof -f -- / 
</div> 
<br>+L/-L 打开或关闭文件的连结数计算，当+L没有指定时，所有的连结数都会显示（默认）；若+L后指定数字，则只要连结数小于该数字的信息会显示； 
<span style="color: rgb(255, 69, 0);">连结数会显示在NLINK列</span>。 
<br>例如：+L1将显示没有unlinked的文件信息；+aL1，则显示指定文件系统所有unlinked的文件信息 
<br>-L 默认参数，其后不能跟数字，将不显示连结数信息 
<br> 
<div class="code">
  lsof +L1 
</div> 
<br>-t 仅打印进程，方便shell脚本调用 
<br> 
<div class="code">
  lsof -t -c sshd 
</div> 
<br>-F 指定输出那个列，可通过lsof -F?查看 
<br>-r 不断执行lsof命令，默认每15秒间隔执行一次 
<br>+r 也是不断执行lsof命令，但直到没有接受到文件信息，则停止 
<br> 
<br> 
<strong><span style="color: rgb(0, 0, 139);">※部分参数未能完全理解，待以后补充。</span></strong>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0cb600bcf347994a16023f1e032dffa2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">清除冗余记录的SQL语句</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a4c5e8c54cfcadc117f8b1003fb5de07/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SQL查询重复数据和清除重复数据</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>