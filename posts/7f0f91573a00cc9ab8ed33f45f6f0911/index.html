<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ORACLE 中 VARRAY的用法 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ORACLE 中 VARRAY的用法" />
<meta property="og:description" content="看到同事写的存储过程里面有这样一句：
TYPE ARRAY_TYPE IS VARRAY(10000) OF VARCHAR2(60);
感到很茫然，幸好还有网络可以求助，我理解成是：长度为10000的数组，其每个为长度为最大长度为60的varchar2类型。不知是否准确？
1. 声明和初始化VARRAY变量
你不可以直接声明一个VARRAY变量。必须先声明一个包含这个数组最大容量的类型：
TYPE MY_ARRAY_TYPE IS VARRAY(10) OF NUMBER; 然后，你就可以用这个类型声明VARRAY变量：
V MY_ARRAY_TYPE; 在你对这个数组进行操作以前，必须先初始化该数组。你既可以在声明它的时候对其初始化，也可以在声明后对其赋值。下面展示了在声明的同时对其进行初始化：
V MY_ARRAY_TYPE := MY_ARRAY_TYPE (); 2. 从指定的条目处取值
把条目的数目作为下标。下标可以是返回整数值(该值小于或等于数组条目数)的任意表达式，如：
K := V(3); I := 2; L := V(I&#43;1); 3. 得到数组的容量
对VARRAY变量使用COUNT()方法。注意，你不需要指定圆括号，因为这个方法没有输入参数：
N_ENTRIES := V.COUNT(); 这告诉你这个数组中正在使用的条目数。当VARRAY类型被声明的时候，其最大的容量也就被定义了。你可以用LIMIT()方法得到该容量：
ARRAY_CAPACITY := V.LIMIT(); 4. 遍历VARRAY中的值
你可以使用多种技术。最简单的是使用FOR循环：
FOR I IN 1..V.COUNT() LOOP DBMS_OUTPUT.PUT_LINE(&#39;V(&#39;||I||&#39;)=&#39; || V(I)); END LOOP; 你也可以使用FIRST()和LAST()方法。FIRST()返回数组的第一个条目的下标(总是1)，LAST()返回数组的最后一个条目的下标(与COUNT方法相同)。
FOR I IN V.FIRST()..V.LAST() LOOP DBMS_OUTPUT.PUT_LINE(&#39;V(&#39;||I||&#39;)=&#39; || V(I)); END LOOP; 你也可以使用PRIOR(n)和NEXT(n)方法，这两个方法分别返回给定条目的前一个和后一个条目的下标。例如，下面的代码用来向后遍历整个数组：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/7f0f91573a00cc9ab8ed33f45f6f0911/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-05-03T09:47:15+08:00" />
<meta property="article:modified_time" content="2012-05-03T09:47:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ORACLE 中 VARRAY的用法</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> 看到同事写的存储过程里面有这样一句：</p> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px">     TYPE ARRAY_TYPE IS VARRAY(10000) OF VARCHAR2(60);</p> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px">     感到很茫然，幸好还有网络可以求助，我理解成是：长度为10000的数组，其每个为长度为最大长度为60的varchar2类型。不知是否准确？</p> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> <strong>1. 声明和初始化VARRAY变量</strong></p> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> 你不可以直接声明一个VARRAY变量。必须先声明一个包含这个数组最大容量的类型：</p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>TYPE MY_ARRAY_TYPE IS VARRAY(10) OF NUMBER; </li></ol></pre> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> 然后，你就可以用这个类型声明VARRAY变量：</p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>V MY_ARRAY_TYPE; </li></ol></pre> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> 在你对这个数组进行操作以前，必须先初始化该数组。你既可以在声明它的时候对其初始化，也可以在声明后对其赋值。下面展示了在声明的同时对其进行初始化：</p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>V MY_ARRAY_TYPE := MY_ARRAY_TYPE (); </li></ol></pre> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> <span style="font-family:Courier New"><strong>2. 从指定的条目处取值</strong></span></p> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> <span style="font-family:Courier New">把条目的数目作为下标。下标可以是返回整数值(该值小于或等于数组条目数)的任意表达式，如：</span></p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>K := V(3);  </li><li>I := 2;  </li><li>L := V(I+1); </li></ol></pre> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> <strong>3. 得到数组的容量</strong></p> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> 对VARRAY变量使用COUNT()方法。注意，你不需要指定圆括号，因为这个方法没有输入参数：</p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>N_ENTRIES := V.COUNT(); </li></ol></pre> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> 这告诉你这个数组中正在使用的条目数。当VARRAY类型被声明的时候，其最大的容量也就被定义了。你可以用LIMIT()方法得到该容量：</p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>ARRAY_CAPACITY := V.LIMIT(); </li></ol></pre> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> <strong>4. 遍历VARRAY中的值</strong></p> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> 你可以使用多种技术。最简单的是使用FOR循环：</p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>FOR I IN 1..V.COUNT() LOOP  </li><li>DBMS_OUTPUT.PUT_LINE('V('||I||')=' || V(I));  </li><li>END LOOP; </li></ol></pre> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> 你也可以使用FIRST()和LAST()方法。FIRST()返回数组的第一个条目的下标(总是1)，LAST()返回数组的最后一个条目的下标(与COUNT方法相同)。</p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>FOR I IN V.FIRST()..V.LAST() LOOP  </li><li>DBMS_OUTPUT.PUT_LINE('V('||I||')=' || V(I));  </li><li>END LOOP; </li></ol></pre> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> 你也可以使用PRIOR(n)和NEXT(n)方法，这两个方法分别返回给定条目的前一个和后一个条目的下标。例如，下面的代码用来向后遍历整个数组：</p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>I := V.COUNT();  </li><li>WHILE I IS NOT NULL LOOP  </li><li>DBMS_OUTPUT.PUT_LINE('V('||I||')=' || V(I));  </li><li>I := V.PRIOR(I);  </li><li>END LOOP; </li></ol></pre> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> <span style="font-family:Courier New">PRIOR(n)和n-1是一样的，NEXT(n)和n+1是一样的，但是PRIOR(1)和NEXT (V.COUNT())则返回NULL。</span></p> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> <span style="font-family:Courier New"><strong>5. 对VARRAY的扩展</strong></span></p> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> <span style="font-family:Courier New">使用EXTEND(k)方法。这个方法可以在VARRAY的最后追加k个新的条目。如果k没有被指定，只增加一个条目。新增的条目没有值(默认为NULL)，但是你可以对它们进行初始化。COUNT()和LAST()方法现在可以反映VARRAY新的容量。以下代码向数组中添加两个条目并对其进行初始化：</span></p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>I := V.LAST();  </li><li>V.EXTEND(2);  </li><li>V(I+1) := 5;  </li><li>V(I+2) := 6; </li></ol></pre> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> 注意，你对VARRAY的扩展不可以超过其最大容量(通过LIMIT()方法得到)，且在对VARRAY扩展前必须要对其进行初始化。以下代码是无效的：</p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>VT MY_ARRAY_TYPE;  </li><li>VT.EXTEND(5); </li></ol></pre> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> 下面的代码是有效的：</p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>VT MY_ARRAY_TYPE;  </li><li>VT := MY_ARRAY_TYPE();  </li><li>VT.EXTEND(5); </li></ol></pre> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> <strong>6. 对VARRAY的缩减</strong></p> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> 使用TRIM(k)方法。这个方法在VARRAY的尾部删除最后k个条目。当k没有被指定时，删除最后一个条目。已被删除的条目的值将丢失。COUNT()和LAST()方法反映了新的容量。下面从VARRAY中删除最后一个条目：</p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>V.TRIM; </li></ol></pre> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> 你也可以用以下方式删除数组中的所有条目：</p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>V.TRIM(V.COUNT()); </li></ol></pre> 
<p style="line-height:25px; margin-top:10px; margin-bottom:10px; font-family:Verdana,Arial,Helvetica,宋体,sans-serif; font-size:14px"> 或者用具有效果相同的DELETE()方法。该方法删除数组中的所有条目，并把其容量设置为0(也就是说，V.COUNT()现在的返回值为0)。</p> 
<pre style="line-height:25px; font-size:14px; background-color:rgb(255,255,255)"> 
 <ol><li>V.DELETE() </li></ol></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5a95ef026e5e64e1294f05e1ebda99e2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">信息抽取，自然语言处理之谈</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1938e0522f032897bf6a048e4eca4563/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">不允许一个用户使用一个以上用户名与一个服务器或共享资源的多重连接</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>