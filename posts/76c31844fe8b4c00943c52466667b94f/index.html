<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQLite3中按时间范围分类排名(top 10) - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SQLite3中按时间范围分类排名(top 10)" />
<meta property="og:description" content="时间单位是C#中的DateTime.ToFileTime() / 1000000000
创建表：
create table if not exists table_wpp_status( wpp_id integer primary key autoincrement not null, wpp_sn varchar(64) not null, wpp_emp_id varchar(32) not null, wpp_class varchar(32) not null, wpp_state integer default(0), wpp_in_time integer default(0), wpp_out_time integer default(0)) 插入表数据：
insert into table_wpp_status( wpp_sn, wpp_emp_id, wpp_class, wpp_state, wpp_in_time, wpp_out_time) values (&#39;XBX20091021&#39;, &#39;Perry1&#39;, &#39;ABC&#39;, 0, 129384821, 0) insert into table_wpp_status( wpp_sn, wpp_emp_id, wpp_class, wpp_state, wpp_in_time, wpp_out_time) values (&#39;XBX20091022&#39;, &#39;Perry2&#39;, &#39;ABC&#39;, 0, 129384824, 0) insert into table_wpp_status( wpp_sn, wpp_emp_id, wpp_class, wpp_state, wpp_in_time, wpp_out_time) values (&#39;XBX20091023&#39;, &#39;Perry3&#39;, &#39;ABC&#39;, 0, 129384829, 0) insert into table_wpp_status( wpp_sn, wpp_emp_id, wpp_class, wpp_state, wpp_in_time, wpp_out_time) values (&#39;XBX20091024&#39;, &#39;Perry3&#39;, &#39;ABC&#39;, 0, 129384830, 0) 修改数据：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/76c31844fe8b4c00943c52466667b94f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2011-09-28T09:53:45+08:00" />
<meta property="article:modified_time" content="2011-09-28T09:53:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQLite3中按时间范围分类排名(top 10)</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>时间单位是C#中的DateTime.ToFileTime() / 1000000000</p> 
<p> </p> 
<p>创建表：</p> 
<pre><code class="language-sql">
create table
  if not exists
    table_wpp_status(
      wpp_id integer primary key autoincrement not null, 
      wpp_sn varchar(64) not null, 
      wpp_emp_id varchar(32) not null, 
      wpp_class varchar(32) not null, 
      wpp_state integer default(0), 
      wpp_in_time integer default(0), 
      wpp_out_time integer default(0))
</code></pre> 
<p><br> 插入表数据：</p> 
<pre><code class="language-sql">
insert into
  table_wpp_status(
    wpp_sn,
    wpp_emp_id,
    wpp_class,
    wpp_state,
    wpp_in_time,
    wpp_out_time)
values
  ('XBX20091021',
   'Perry1',
   'ABC',
   0,
   129384821,
   0)

insert into
  table_wpp_status(
    wpp_sn,
    wpp_emp_id,
    wpp_class,
    wpp_state,
    wpp_in_time,
    wpp_out_time)
values
  ('XBX20091022',
   'Perry2',
   'ABC',
   0,
   129384824,
   0)

insert into
  table_wpp_status(
    wpp_sn,
    wpp_emp_id,
    wpp_class,
    wpp_state,
    wpp_in_time,
    wpp_out_time)
values
  ('XBX20091023',
   'Perry3',
   'ABC',
   0,
   129384829,
   0)

insert into
  table_wpp_status(
    wpp_sn,
    wpp_emp_id,
    wpp_class,
    wpp_state,
    wpp_in_time,
    wpp_out_time)
values
  ('XBX20091024',
   'Perry3',
   'ABC',
   0,
   129384830,
   0)
</code></pre> 
<p><br> 修改数据：</p> 
<pre><code class="language-sql">
update
  table_wpp_status
set
  wpp_state = 1,
  wpp_out_time = 129384848
where
  wpp_sn='XBX20091022' and
  wpp_class='ABC' and
  wpp_state = 0

update
  table_wpp_status
set
  wpp_state = 1, 
  wpp_out_time = 129384848
where 
  wpp_sn='XBX20091023' and
  wpp_class='ABC' and
  wpp_state = 0

update
  table_wpp_status
set
  wpp_state = 1,
  wpp_out_time = 129384848
where
  wpp_sn='XBX20091024' and
  wpp_class='ABC' and
  wpp_state = 0
</code></pre> 
<p><br> 查询数据：</p> 
<pre><code class="language-sql">select
  s1.wpp_emp_id as emp_id,
  count(s1.wpp_id) as total_input,
  count
  ( case when
      s1.wpp_state &gt;= 1 and
      s1.wpp_out_time &gt;= 129382848
    then
      s1.wpp_id
    end) as total_output
from
  table_wpp_status as s1
where
  s1.wpp_class = 'ABC' and
  s1.wpp_emp_id in
  ( select
      distinct s2.wpp_emp_id
    from
      table_wpp_status as s2
    where
      s2.wpp_in_time &gt;= 129382848) and
  s1.wpp_in_time &gt;= 129382848
group by
  s1.wpp_emp_id
order by
  total_output desc
limit
  10;
</code></pre> 
<p>输出结果：</p> 
<pre><code class="language-sql">
emp_id     total_input      total_output
Perry3     2                2
Perry2     1                1
Perry1     1                0
</code></pre> 
<p><br> <br>  </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/761032d34646cc0276b43e56c8e20f3d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VirtualBox 4.1.2 联网方式 Host-Only &#43;NAT 实现 上网 &#43; 双通</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9fb4298521c8ee941e69fd53605c12ab/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">计算机概念</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>