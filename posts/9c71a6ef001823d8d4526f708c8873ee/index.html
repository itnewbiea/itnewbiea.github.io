<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Javaï¼šåšå®¢ç³»ç»Ÿï¼Œå®ç°åŠ ç›åŠ å¯†ï¼Œåˆ†é¡µï¼Œè‰ç¨¿ç®±ï¼Œå®šæ—¶å‘å¸ƒ - ITå­¦ä¹ è€…åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Javaï¼šåšå®¢ç³»ç»Ÿï¼Œå®ç°åŠ ç›åŠ å¯†ï¼Œåˆ†é¡µï¼Œè‰ç¨¿ç®±ï¼Œå®šæ—¶å‘å¸ƒ" />
<meta property="og:description" content="æ–‡ç« ç›®å½• 1. é¡¹ç›®æ¦‚è¿°2. å‡†å¤‡å·¥ä½œ2.1 æ•°æ®åº“è¡¨æ ¼ä»£ç 2.2 å‰ç«¯ä»£ç 2.3 é…ç½®æ–‡ä»¶ 3. å‡†å¤‡é¡¹ç›®ç»“æ„3.1 æ‹·è´å‰ç«¯æ¨¡æ¿3.2 å®šä¹‰å®ä½“ç±»3.3 å®šä¹‰mapperæ¥å£å’Œ xml æ–‡ä»¶3.4 åˆ›å»ºå…¶ä»–åŒ… 4. ç»Ÿä¸€æ•°æ®è¿”å›4.1 Result ç±»4.2 ç»Ÿä¸€æ•°æ®æ ¼å¼ 5. æ³¨å†Œ5.1 é€»è¾‘5.2 éªŒè¯æ•°æ®è§„èŒƒæ€§5.3 å®ç°æ³¨å†Œ5.4 å‰ç«¯ä»£ç å®Œå–„ 6. ç™»å½•6.1 å‰ç«¯ä»£ç 6.2 åç«¯ä»£ç  7. æ‹¦æˆªå™¨7.1 é€»è¾‘7.2 æ‹¦æˆªè§„åˆ™7.3 æ‹¦æˆªå™¨æ‰€ä½œç”¨çš„èŒƒå›´ 8. åšå®¢ç¼–è¾‘é¡µ8.1 é€»è¾‘8.2 è§¦å‘ç™»å½•éªŒè¯8.3 å‘å¸ƒæ–‡ç« 8.4 ä¿å­˜è‡³è‰ç¨¿ç®±8.5 é€€å‡ºè´¦å· 9. ä¸ªäººä¸»é¡µ9.1 è·å–ç”¨æˆ·ä¿¡æ¯æ 9.2 è·å–ä¸ªäººä¸»é¡µæ‰€æœ‰æ–‡ç« 9.3 åˆ é™¤æ–‡ç«  10. åšå®¢è¯¦æƒ…é¡µ10.1 è·å– URL ä¸­çš„å‚æ•°10.2 å·¦ä¾§ä½œè€…ä¿¡æ¯10.3 å³ä¾§æ–‡ç« è¯¦æƒ… 11. ä¿®æ”¹æ–‡ç« é¡µ11.1 åŠ è½½æ–‡ç« å†…å®¹11.2 å°†æ–‡ç« ä¿å­˜ä¸ºè‰ç¨¿11.3 ä¿®æ”¹åå‘è¡¨ 12. åšå®¢ä¸»é¡µ12.1 åˆ†é¡µ12.2 å‰ç«¯12.3 åç«¯12.4 å®ç°å‰©ä¸‹å››ä¸ªæŒ‰é’® 13. å¯†ç åŠ ç›åŠ å¯†13.1 åŠ ç›åŠ å¯†13.2 éªŒè¯13.3 æ›´æ–° 14." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/9c71a6ef001823d8d4526f708c8873ee/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-23T13:37:46+08:00" />
<meta property="article:modified_time" content="2023-02-23T13:37:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ITå­¦ä¹ è€…åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ITå­¦ä¹ è€…åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Javaï¼šåšå®¢ç³»ç»Ÿï¼Œå®ç°åŠ ç›åŠ å¯†ï¼Œåˆ†é¡µï¼Œè‰ç¨¿ç®±ï¼Œå®šæ—¶å‘å¸ƒ</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><a href="#1__1" rel="nofollow">1. é¡¹ç›®æ¦‚è¿°</a></li><li><a href="#2__28" rel="nofollow">2. å‡†å¤‡å·¥ä½œ</a></li><li><ul><li><a href="#21__29" rel="nofollow">2.1 æ•°æ®åº“è¡¨æ ¼ä»£ç </a></li><li><a href="#22__76" rel="nofollow">2.2 å‰ç«¯ä»£ç </a></li><li><a href="#23__80" rel="nofollow">2.3 é…ç½®æ–‡ä»¶</a></li></ul> 
  </li><li><a href="#3__107" rel="nofollow">3. å‡†å¤‡é¡¹ç›®ç»“æ„</a></li><li><ul><li><a href="#31__110" rel="nofollow">3.1 æ‹·è´å‰ç«¯æ¨¡æ¿</a></li><li><a href="#32__114" rel="nofollow">3.2 å®šä¹‰å®ä½“ç±»</a></li><li><a href="#33_mapper_xml__148" rel="nofollow">3.3 å®šä¹‰mapperæ¥å£å’Œ xml æ–‡ä»¶</a></li><li><a href="#34__185" rel="nofollow">3.4 åˆ›å»ºå…¶ä»–åŒ…</a></li></ul> 
  </li><li><a href="#4__190" rel="nofollow">4. ç»Ÿä¸€æ•°æ®è¿”å›</a></li><li><ul><li><a href="#41_Result__194" rel="nofollow">4.1 Result ç±»</a></li><li><a href="#42__231" rel="nofollow">4.2 ç»Ÿä¸€æ•°æ®æ ¼å¼</a></li></ul> 
  </li><li><a href="#5__279" rel="nofollow">5. æ³¨å†Œ</a></li><li><ul><li><a href="#51__281" rel="nofollow">5.1 é€»è¾‘</a></li><li><a href="#52__290" rel="nofollow">5.2 éªŒè¯æ•°æ®è§„èŒƒæ€§</a></li><li><a href="#53__328" rel="nofollow">5.3 å®ç°æ³¨å†Œ</a></li><li><a href="#54__376" rel="nofollow">5.4 å‰ç«¯ä»£ç å®Œå–„</a></li></ul> 
  </li><li><a href="#6__400" rel="nofollow">6. ç™»å½•</a></li><li><ul><li><a href="#61__403" rel="nofollow">6.1 å‰ç«¯ä»£ç </a></li><li><a href="#62__440" rel="nofollow">6.2 åç«¯ä»£ç </a></li></ul> 
  </li><li><a href="#7__482" rel="nofollow">7. æ‹¦æˆªå™¨</a></li><li><ul><li><a href="#71__489" rel="nofollow">7.1 é€»è¾‘</a></li><li><a href="#72__496" rel="nofollow">7.2 æ‹¦æˆªè§„åˆ™</a></li><li><a href="#73__516" rel="nofollow">7.3 æ‹¦æˆªå™¨æ‰€ä½œç”¨çš„èŒƒå›´</a></li></ul> 
  </li><li><a href="#8__550" rel="nofollow">8. åšå®¢ç¼–è¾‘é¡µ</a></li><li><ul><li><a href="#81__551" rel="nofollow">8.1 é€»è¾‘</a></li><li><a href="#82__560" rel="nofollow">8.2 è§¦å‘ç™»å½•éªŒè¯</a></li><li><a href="#83__621" rel="nofollow">8.3 å‘å¸ƒæ–‡ç« </a></li><li><a href="#84__685" rel="nofollow">8.4 ä¿å­˜è‡³è‰ç¨¿ç®±</a></li><li><a href="#85__744" rel="nofollow">8.5 é€€å‡ºè´¦å·</a></li></ul> 
  </li><li><a href="#9__790" rel="nofollow">9. ä¸ªäººä¸»é¡µ</a></li><li><ul><li><a href="#91__793" rel="nofollow">9.1 è·å–ç”¨æˆ·ä¿¡æ¯æ </a></li><li><a href="#92__852" rel="nofollow">9.2 è·å–ä¸ªäººä¸»é¡µæ‰€æœ‰æ–‡ç« </a></li><li><a href="#93__929" rel="nofollow">9.3 åˆ é™¤æ–‡ç« </a></li></ul> 
  </li><li><a href="#10__984" rel="nofollow">10. åšå®¢è¯¦æƒ…é¡µ</a></li><li><ul><li><a href="#101__URL__992" rel="nofollow">10.1 è·å– URL ä¸­çš„å‚æ•°</a></li><li><a href="#102__1016" rel="nofollow">10.2 å·¦ä¾§ä½œè€…ä¿¡æ¯</a></li><li><a href="#103__1076" rel="nofollow">10.3 å³ä¾§æ–‡ç« è¯¦æƒ…</a></li></ul> 
  </li><li><a href="#11__1138" rel="nofollow">11. ä¿®æ”¹æ–‡ç« é¡µ</a></li><li><ul><li><a href="#111__1149" rel="nofollow">11.1 åŠ è½½æ–‡ç« å†…å®¹</a></li><li><a href="#112__1211" rel="nofollow">11.2 å°†æ–‡ç« ä¿å­˜ä¸ºè‰ç¨¿</a></li><li><a href="#113__1288" rel="nofollow">11.3 ä¿®æ”¹åå‘è¡¨</a></li></ul> 
  </li><li><a href="#12__1351" rel="nofollow">12. åšå®¢ä¸»é¡µ</a></li><li><ul><li><a href="#121__1355" rel="nofollow">12.1 åˆ†é¡µ</a></li><li><a href="#122__1360" rel="nofollow">12.2 å‰ç«¯</a></li><li><a href="#123__1426" rel="nofollow">12.3 åç«¯</a></li><li><a href="#124__1451" rel="nofollow">12.4 å®ç°å‰©ä¸‹å››ä¸ªæŒ‰é’®</a></li></ul> 
  </li><li><a href="#13__1553" rel="nofollow">13. å¯†ç åŠ ç›åŠ å¯†</a></li><li><ul><li><a href="#131__1572" rel="nofollow">13.1 åŠ ç›åŠ å¯†</a></li><li><a href="#132__1602" rel="nofollow">13.2 éªŒè¯</a></li><li><a href="#133__1624" rel="nofollow">13.3 æ›´æ–°</a></li></ul> 
  </li><li><a href="#14_Session__1647" rel="nofollow">14. Session æŒä¹…åŒ–</a></li><li><a href="#15__1704" rel="nofollow">15. å®ç°å®šæ—¶å‘å¸ƒåŠŸèƒ½</a></li><li><ul><li><a href="#151__1706" rel="nofollow">15.1 é€»è¾‘</a></li><li><a href="#152__1715" rel="nofollow">15.2 å»ºè¡¨</a></li><li><a href="#153__1752" rel="nofollow">15.3 åç«¯å®ç°</a></li><li><ul><li><a href="#1531__1753" rel="nofollow">15.3.1 æ—¶é—´æˆ³é—®é¢˜</a></li><li><a href="#1532__1769" rel="nofollow">15.3.2 æ„é€ æ–¹æ³•ä¸å°æ ¹å †</a></li><li><a href="#1533__1793" rel="nofollow">15.3.3 å¯åŠ¨çº¿ç¨‹</a></li><li><a href="#1534__1848" rel="nofollow">15.3.4 è¿è¡Œè¿‡ç¨‹ä¸­æ·»åŠ å®šæ—¶å‘å¸ƒçš„æ–‡ç« </a></li><li><a href="#1535__1879" rel="nofollow">15.3.5 å‰ç«¯éƒ¨åˆ†</a></li></ul> 
  </li></ul> 
  </li><li><a href="#16__1974" rel="nofollow">16. å…¨ä»£ç </a></li></ul> 
</div> 
<p></p> 
<h2><a id="1__1"></a>1. é¡¹ç›®æ¦‚è¿°</h2> 
<p>åšå®¢ç³»ç»Ÿï¼Œå¯ä»¥è¯´æ˜¯éå¸¸ç»å…¸çš„é¡¹ç›®äº†ã€‚è¯¥åšå®¢ç³»ç»Ÿæ˜¯åŸºäº SSM æ¡†æ¶æ‰€å®ç°çš„ï¼Œé™¤äº†åšå®¢çš„æ¸¸è§ˆï¼Œå‘å¸ƒç­‰åŠŸèƒ½ï¼Œè¿˜å®ç°äº†ï¼šåˆ†é¡µæŸ¥è¯¢ï¼ŒMySQLä¸­ç”¨æˆ·å¯†ç çš„å¯†æ–‡å­˜å‚¨ï¼ˆä½¿ç”¨MD5åŠ å¯†æ­é…åŠ ç›å®ç°ï¼‰ï¼Œè‰ç¨¿ç®±ï¼Œå®šæ—¶å‘å¸ƒç­‰åŠŸèƒ½</p> 
<p>æœ¬åšå®¢ç³»ç»Ÿä¸»è¦çš„é¡µé¢æœ‰ç™»å½•é¡µï¼Œæ³¨å†Œé¡µï¼Œä¸ªäººåšå®¢é¡µï¼Œä¸»é¡µï¼Œåšå®¢è¯¦æƒ…é¡µï¼Œåšå®¢ç¼–è¾‘é¡µï¼Œåšå®¢ä¿®æ”¹é¡µã€‚è¿™äº›é¡µé¢çš„å…·ä½“å·¥ä½œï¼Œæ ¹æ®ç”Ÿæ´»ç»éªŒå’Œé¡µé¢åå­—ä¹Ÿéƒ½èƒ½å¾—çŸ¥ã€‚</p> 
<p>ä»¥ä¸‹æ˜¯å„ä¸ªé¡µé¢çš„å±•ç¤ºæ•ˆæœ</p> 
<p>ç™»å½•é¡µ<br> <img src="https://images2.imgbox.com/95/63/vdEKqWkB_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æ³¨å†Œé¡µï¼ˆæ¯”ç™»å½•é¡µå°‘äº†ä¸ªæ³¨å†Œï¼‰<br> <img src="https://images2.imgbox.com/5b/4e/zwTPNOWR_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">ä¸ªäººåšå®¢é¡µ<br> <img src="https://images2.imgbox.com/36/27/89RJGP7P_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ä¸»é¡µ<br> <img src="https://images2.imgbox.com/c0/97/LDcrHpZf_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>åšå®¢ç¼–è¾‘é¡µ<br> <img src="https://images2.imgbox.com/5b/2c/ZWL0037z_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>æ–‡ç« è¯¦æƒ…é¡µ<br> <img src="https://images2.imgbox.com/c7/64/dK0HcJA4_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="2__28"></a>2. å‡†å¤‡å·¥ä½œ</h2> 
<h3><a id="21__29"></a>2.1 æ•°æ®åº“è¡¨æ ¼ä»£ç </h3> 
<p>é¦–å…ˆåœ¨è‡ªå·±çš„ç”µè„‘ä¸Šåˆ›å»ºæ•°æ®åº“ï¼Œå®šä¹‰è¡¨æ ¼ï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶ç²˜è´´ä»¥ä¸‹ä»£ç ï¼š<br> åˆ›å»ºäº†ä¸¤ä¸ªè¡¨æ ¼ï¼Œç”¨æˆ·è¡¨å’Œæ–‡ç« è¡¨</p> 
<pre><code class="prism language-sql"><span class="token comment">-- åˆ›å»ºæ•°æ®åº“</span>
<span class="token keyword">drop</span> <span class="token keyword">database</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> blog_system<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> blog_system <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4<span class="token punctuation">;</span>

<span class="token comment">-- ä½¿ç”¨æ•°æ®æ•°æ®</span>
<span class="token keyword">use</span> blog_system<span class="token punctuation">;</span>

<span class="token comment">-- åˆ›å»ºè¡¨[ç”¨æˆ·è¡¨]</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span>  userinfo<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> userinfo<span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    username <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    password <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    photo <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">''</span><span class="token punctuation">,</span>
    createtime <span class="token keyword">datetime</span> <span class="token keyword">default</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    updatetime <span class="token keyword">datetime</span> <span class="token keyword">default</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>state<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">1</span>
<span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token keyword">charset</span> <span class="token string">'utf8mb4'</span><span class="token punctuation">;</span>

<span class="token comment">-- åˆ›å»ºæ–‡ç« è¡¨</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span>  articleinfo<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> articleinfo<span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    title <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    content <span class="token keyword">text</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    createtime <span class="token keyword">datetime</span> <span class="token keyword">default</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    updatetime <span class="token keyword">datetime</span> <span class="token keyword">default</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    rcount <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">default</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">`</span>state<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">1</span>
<span class="token punctuation">)</span><span class="token keyword">default</span> <span class="token keyword">charset</span> <span class="token string">'utf8mb4'</span><span class="token punctuation">;</span>

<span class="token comment">-- æ·»åŠ ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>blog_system<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>userinfo<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>photo<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>createtime<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>updatetime<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>state<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span> 
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'boy'</span><span class="token punctuation">,</span> <span class="token string">'boy'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'2021-12-06 17:10:48'</span><span class="token punctuation">,</span> <span class="token string">'2021-12-06 17:10:48'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- æ–‡ç« æ·»åŠ æµ‹è¯•æ•°æ®</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> articleinfo<span class="token punctuation">(</span>title<span class="token punctuation">,</span>content<span class="token punctuation">,</span>uid<span class="token punctuation">)</span>
    <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'blog_system'</span><span class="token punctuation">,</span><span class="token string">'è¿™ä¸ªæ˜¯æ­£æ–‡'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
</code></pre> 
<h3><a id="22__76"></a>2.2 å‰ç«¯ä»£ç </h3> 
<p>å‰ç«¯ä»£ç ç›´æ¥ä½¿ç”¨æ¨¡æ¿ï¼š<br> <a href="https://gitee.com/enthusiastic-citizens6/project/tree/master/blogSystemSSM-show" rel="nofollow">å‰ç«¯æ¨¡æ¿</a></p> 
<h3><a id="23__80"></a>2.3 é…ç½®æ–‡ä»¶</h3> 
<p>Spring é¡¹ç›®çš„åˆ›å»ºä¸å†èµ˜è¿°ï¼Œä»¥ä¸‹æ˜¯Springé¡¹ç›®çš„é…ç½®æ–‡ä»¶</p> 
<pre><code class="prism language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
  	<span class="token comment"># ä¸‹é¢è¿™è¡Œçš„ blog_system æ˜¯æˆ‘æ•°æ®åº“çš„åå­—ï¼Œå¤§å®¶éœ€è¦æ ¹æ®æƒ…å†µä¿®æ”¹</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span>3306/blog_system<span class="token punctuation">?</span>characterEncoding=utf8
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root 
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver


<span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token key atrule">mapper-locations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>mapper/<span class="token important">**Mapper.xml</span> <span class="token comment"># é…ç½® MyBatis ä¸­ xml æ–‡ä»¶çš„æ ¼å¼</span>
  <span class="token key atrule">configuration</span><span class="token punctuation">:</span> <span class="token comment"># é…ç½®æ‰“å° MyBatis æ‰§è¡Œçš„ SQL</span>
    <span class="token key atrule">log-impl</span><span class="token punctuation">:</span> org.apache.ibatis.logging.stdout.StdOutImpl
<span class="token comment"># é…ç½®æ‰“å° MyBatis æ‰§è¡Œçš„ SQL</span>
<span class="token comment"># é…ç½®æ—¥å¿—æ‰“å°ä¿¡æ¯</span>
<span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">com</span><span class="token punctuation">:</span>
      <span class="token key atrule">example</span><span class="token punctuation">:</span>
        <span class="token key atrule">demo</span><span class="token punctuation">:</span> debug
</code></pre> 
<h2><a id="3__107"></a>3. å‡†å¤‡é¡¹ç›®ç»“æ„</h2> 
<p>åˆ›å»ºå®Œé¡¹ç›®ï¼ŒæŒ‡ä»¤äº†é…ç½®ä¿¡æ¯ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°†é¡¹ç›®çš„ç»“æ„å…ˆæ„å»ºå‡ºæ¥</p> 
<h3><a id="31__110"></a>3.1 æ‹·è´å‰ç«¯æ¨¡æ¿</h3> 
<p>å°†å‰ç«¯æ¨¡æ¿çš„ä»£ç æ‹·è´ä¸€ä»½åˆ° <code>static</code> æ–‡ä»¶ä¸­</p> 
<p><img src="https://images2.imgbox.com/1f/8e/r5cTGsqR_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="32__114"></a>3.2 å®šä¹‰å®ä½“ç±»</h3> 
<p>å®šä¹‰å®ä½“ç±»ï¼Œå¹¶ä¸”æ”¾åœ¨<code>model</code>åŒ…ä¸­ã€‚è¿™é‡Œåˆ†åˆ«å®šä¹‰ä¸º<code>User</code>ç±»å’Œ <code>Article</code>ç±»</p> 
<p>â­<code>User</code> ç±»å’Œ <code>Article</code>ç±»åˆ†åˆ«ã€Œå¯¹åº”ã€æ•°æ®åº“ä¸­çš„<code>userinfo</code>å’Œ<code>articleinfo</code>ä¸¤å¼ è¡¨çš„ä¸€æ¡æ•°æ®ï¼Œå¹¶ä¸”è¡¨çš„å­—æ®µåéœ€è¦å’Œå®ä½“ç±»çš„å±æ€§åä¸€æ ·ï¼ˆå¦‚æœä¸ä¸€æ ·ï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨<code>ResultMap</code>è¿›è¡Œé‡æ˜ å°„ï¼Œæœ¬é¡¹ç›®ä¸æ¶‰åŠï¼‰ä»£ç å¦‚ä¸‹<br> <img src="https://images2.imgbox.com/38/e3/BAcv47NY_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Data</span> <span class="token comment">// å‡å°‘ä»£ç å†—ä½™ï¼Œå†…ç½® toString(), get(), set() ç­‰å¸¸è§æ–¹æ³•</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>            <span class="token comment">// ç”¨æˆ· ID</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>ã€€ <span class="token comment">// ç”¨æˆ·å</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>   <span class="token comment">// ç”¨æˆ·å¯†ç </span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> photo<span class="token punctuation">;</span>      <span class="token comment">// å¤´åƒ (å¯ä»¥ç”¨æ¥æ‹“å±•åšå®¢åŠŸèƒ½)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> createtime<span class="token punctuation">;</span> <span class="token comment">// åˆ›å»ºæ—¶é—´ (é»˜è®¤æ˜¯å½“å‰æ—¶é—´)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> updatetime<span class="token punctuation">;</span> <span class="token comment">// æ›´æ–°æ—¶é—´ (é»˜è®¤æ˜¯å½“å‰æ—¶é—´)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> state<span class="token punctuation">;</span>         <span class="token comment">// çŠ¶æ€</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Article</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>             <span class="token comment">// æ–‡ç«  ID</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>       <span class="token comment">// æ ‡é¢˜</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>     <span class="token comment">// æ­£æ–‡</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> createtime<span class="token punctuation">;</span>  <span class="token comment">// åˆ›å»ºæ—¶é—´ (é»˜è®¤æ˜¯å½“å‰æ—¶é—´)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> updatetime<span class="token punctuation">;</span>  <span class="token comment">// æ›´æ–°æ—¶é—´ (é»˜è®¤æ˜¯å½“å‰æ—¶é—´)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> uid<span class="token punctuation">;</span>            <span class="token comment">// ç”¨æˆ· ID</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> rcount<span class="token punctuation">;</span>         <span class="token comment">// è®¿é—®é‡ (é˜…è¯»é‡)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> state<span class="token punctuation">;</span>          <span class="token comment">// çŠ¶æ€</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="33_mapper_xml__148"></a>3.3 å®šä¹‰mapperæ¥å£å’Œ xml æ–‡ä»¶</h3> 
<p>åˆ›å»º <code>mapper</code>ç›®å½•ï¼Œå®šä¹‰ä¸¤ä¸ªæ¥å£ï¼Œæ¥åˆ†åˆ«æ“ä½œ MyBatisï¼Œå¹¶ä¸”æ³¨æ„åŠ ä¸Š<code>@Mapper</code>æ³¨è§£ï¼Œè¿™é‡Œä¸å¤šè¯´</p> 
<p><img src="https://images2.imgbox.com/60/86/aQ8BSH72_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ğŸ“åˆ›å»ºè¿™ä¸¤ä¸ªæ¥å£å¯¹åº”çš„ xml æ–‡ä»¶ï¼Œè¿™é‡Œè¦æ ¹æ®é…ç½®æ–‡ä»¶ä¸­çº¦å®šçš„æ ¼å¼æ¥ï¼›è€Œå¯¹äºæˆ‘ä¸Šé¢æ‰€é…ç½®çš„çº¦å®šï¼Œéœ€è¦åœ¨ resources ä¸‹åˆ›å»º mapper æ–‡ä»¶å¤¹ï¼Œç„¶å xml æ–‡ä»¶ä»¥ xxMapper.xml çš„æ ¼å¼æ¥å‘½åğŸ‘‡ï¼š</p> 
<p><img src="https://images2.imgbox.com/24/ab/3GLHRvhi_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> æ¥ç€åœ¨ xml æ–‡ä»¶ä¸­åŠ ä¸Šå›ºå®šçš„ä»£ç å—ï¼Œå¹¶åœ¨<code>namespace</code>ä¸­å¡«å†™æŒ‡å®šçš„æ¥å£è·¯å¾„</p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span> <span class="token name">PUBLIC</span> <span class="token string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="token string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.demo.mapper.xxx<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- è¿™é‡Œçš„namespaceéœ€è¦è‡ªå·±æŒ‡å®šè·¯å¾„ --&gt;</span>
   
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>ä»£ç å¦‚ä¸‹ï¼š<br> <code>ArticleMapper.xml</code></p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span> <span class="token name">PUBLIC</span> <span class="token string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="token string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.blogsystemssm.mapper.ArticleMapper<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><code>UserMapper.xml</code></p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> mapper <span class="token constant">PUBLIC</span> <span class="token string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="token string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>mapper namespace<span class="token operator">=</span><span class="token string">"com.example.blogsystemssm.mapper.UserMapper"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>mapper<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="34__185"></a>3.4 åˆ›å»ºå…¶ä»–åŒ…</h3> 
<p>ç„¶åå†åˆ†åˆ«åˆ›å»ºcontroller, service, common ä¸‰ä¸ªåŒ…ï¼Œå…¶ä¸­ common è¡¨ç¤ºå…¬å…±çš„ï¼Œè¿™ä¸ªåŒ…ç”¨æ¥é˜²æ”¾ç½®ä¸€ä¸‹å¤§å®¶éƒ½è¦å¯ä»¥ç”¨åˆ°çš„ç±»ï¼Œconroller åŒ…ä¸­å†åˆ›å»º<code>ArticleController</code>å’Œ<code>UserController</code>ï¼Œservice åŒ…åˆ›å»º<code>ArticleService</code>å’Œ <code>UserService</code>ï¼Œå¹¶ä¸”åŠ ä¸Šç›¸åº”çš„æ³¨è§£ã€‚</p> 
<p>æ­¤æ¬¡ï¼Œé¡¹ç›®çš„å¤§è‡´ç»“æ„å°±å®Œæˆäº†ï¼Œç›®å½•ç»“æœå¤§è‡´å¦‚ä¸‹ï¼š<br> <img src="https://images2.imgbox.com/fd/b3/qubpLApX_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="4__190"></a>4. ç»Ÿä¸€æ•°æ®è¿”å›</h2> 
<p>åœ¨é¡¹ç›®æ­£å¼å¼€å§‹å‰ï¼Œå¯ä»¥å…ˆåˆ©ç”¨ AOP æ€æƒ³æ¥å¤„ç†æ‰€æœ‰è¿”å›ç»™å‰ç«¯çš„æ•°æ®ã€‚</p> 
<h3><a id="41_Result__194"></a>4.1 Result ç±»</h3> 
<p>â­å¦‚æœæƒ³è¦è¾¾æˆä¸€ä¸ªç›®çš„ï¼šè¿”å›ç»™å‰ç«¯çš„æ•°æ®å¿…é¡»è¦æœ‰ä¸‰ä¸ªå±æ€§ï¼ŒçŠ¶æ€ç <code>state</code>ï¼Œå…¶ä»–ä¿¡æ¯<code>msg</code>ï¼Œä¸šåŠ¡æ‰§è¡Œå®Œåè¿”å›ç»™å‰ç«¯çš„æ•°æ®<code>data</code></p> 
<p>é‚£ä¹ˆæˆ‘ä»¬æ— æ³•ä¿è¯æ¯ä¸ªç¨‹åºå‘˜éƒ½èƒ½å¤Ÿå¯¹ä¸šåŠ¡æ‰§è¡Œå®Œæˆä¹‹åçš„ç»“æœ<code>data</code>ç»è¿‡ä¸€å±‚åŒ…è£…ï¼Œå…·å¤‡ä¸Šè¿°ä¸‰ä¸ªå±æ€§ä¹‹åï¼Œå†è¿”å›ç»™å‰ç«¯ã€‚</p> 
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç±»<code>Result</code>ï¼Œé‡Œé¢æä¾›åŒ…è£…<code>data</code>çš„æ–¹æ³•ï¼Œå¤§å®¶çœ‹ä»¥ä¸‹ä»£ç å°±æ‡‚äº†ï¼ˆç»“åˆæ³¨é‡Šç†è§£ï¼‰ï¼š</p> 
<pre><code class="prism language-java"><span class="token comment">/**
 * è¿”å›ç»“æœä¸€å®šè¦æœ‰ä¸‰ä¸ªå€¼: state(çŠ¶æ€ç ), msg(ä¼ é€’ç»™å‰ç«¯çš„æ¶ˆæ¯), data(ä¸šåŠ¡æ‰§è¡Œæ•°æ®)
 * è¯¥æ–¹æ³•ä¸“é—¨ç”¨æ¥åŒ…è£…è¿”å›ç»“æœ(ä¹Ÿå°±æ˜¯data)ï¼ŒåŒ…è£…æˆ HashMap
 * å¹¶ä¸”è§„å®š state = 200 çš„æ—¶å€™ï¼Œè¡¨ç¤ºä¸šåŠ¡ä»£ç æ‰§è¡Œé¡ºåˆ©
 *         state = -1  çš„æ—¶å€™ï¼Œè¡¨ç¤ºä¸šåŠ¡ä»£ç å‡ºç°å¼‚å¸¸
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Result</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// ä¸šåŠ¡æ‰§è¡ŒæˆåŠŸ</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">succeed</span><span class="token punctuation">(</span><span class="token class-name">Object</span> data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"state"</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	<span class="token comment">// ä¸šåŠ¡å‡ºç°æœ‰è¯¯</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"state"</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>æ‰€ä»¥åç«¯ç¨‹åºå‘˜å¯ä»¥å°†è¿”å›ç»™å‰ç«¯çš„ç»“æœå†ç»è¿‡ <code>Result.succeed()</code> æˆ–è€… <code>Result.fail()</code>è¿›è¡ŒåŒ…è£…ï¼Œå‰ç«¯å°±å¯ä»¥è·å–æ›´æ¸…æ™°çš„ç»“æœã€‚</p> 
<p>å½“ç„¶ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡é‡è½½çš„æ–¹å¼æ¥ä¸°å¯Œ <code>succeed å’Œ fail</code> ä¸­çš„å‚æ•°</p> 
<h3><a id="42__231"></a>4.2 ç»Ÿä¸€æ•°æ®æ ¼å¼</h3> 
<p>è™½ç„¶å·²ç»æœ‰äº† <code>Result</code> ç±»ï¼Œç¨‹åºå¯ä»¥é€šè¿‡æ‰‹åŠ¨<code>Result.succeed(data)</code>æˆ–è€…<code>Result.fail(data)</code> çš„æ–¹å¼å‘å‰ç«¯å‘é€æ•°æ®ï¼Œä½†æ˜¯ä¸ºäº†ä¿è¯æ²¡æœ‰æ¼ç½‘ä¹‹é±¼ï¼Œå¯ä»¥æ·»åŠ ä¸€å±‚ä¿åº• â€”â€” ç»Ÿä¸€æ•°æ®æ ¼å¼</p> 
<p>å®ƒå¯ä»¥åœ¨çœŸæ­£å°†æ•°æ®è¿”å›ç»™å‰ç«¯ä¹‹å‰å†è¿›è¡Œä¸€æ¬¡å¤„ç†ï¼šå¦‚æœè¿”å›ç»™å‰ç«¯çš„æ•°æ®å·²ç»ç»è¿‡<code>Result</code>å¤„ç†äº†ï¼Œè¿™æ—¶å€™å°±ä¸éœ€è¦å†åŒ…è£…ä¸€å±‚ï¼›è€Œå¦‚æœæ•°æ®æ²¡æœ‰ç»è¿‡<code>Result</code>å¤„ç†ï¼Œè€Œæ˜¯ç›´æ¥è¿”å› -1 ç­‰ç­‰ï¼Œé‚£ä¹ˆè¿™æ—¶å€™æˆ‘ä»¬å°±è¦ã€Œè¡¥æ•‘ã€</p> 
<p>å®ç°æ­¥éª¤ï¼š<br> â… . åˆ›å»ºä¸€ä¸ªç±»ï¼Œè¯¥ç±»ä½¿ç”¨<code>@ControllerAdvice</code> æ³¨è§£ä¿®é¥°<br> â…¡. è¯¥ç±»éœ€è¦å®ç°<code>ResponseBodyAdvice</code>æ¥å£<br> â…¢. é‡å†™<code>supports</code> å’Œ <code>beforeBodyWrite</code>æ–¹æ³•ï¼Œå¹¶ä¸” <code>supports</code>æ–¹æ³•ç›´æ¥è¿”å› <code>true</code></p> 
<p>ä»¥ä¸Šæ˜¯ã€Œç»Ÿä¸€æ•°æ®æ ¼å¼ã€çš„è§„èŒƒï¼Œä»£ç å¦‚ä¸‹</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@ControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ResponseAdvice</span> <span class="token keyword">implements</span> <span class="token class-name">ResponseBodyAdvice</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supports</span><span class="token punctuation">(</span><span class="token class-name">MethodParameter</span> returnType<span class="token punctuation">,</span> <span class="token class-name">Class</span> converterType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">beforeBodyWrite</span><span class="token punctuation">(</span><span class="token class-name">Object</span> body<span class="token punctuation">,</span> <span class="token class-name">MethodParameter</span> returnType<span class="token punctuation">,</span> <span class="token class-name">MediaType</span> selectedContentType<span class="token punctuation">,</span> <span class="token class-name">Class</span> selectedConverterType<span class="token punctuation">,</span> <span class="token class-name">ServerHttpRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">ServerHttpResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>ç„¶åæœ€åä¸€å±‚ã€Œä¿åº•ã€æŒ‡çš„å°±æ˜¯è¿™ä¸ª<code>beforeBodyWrite</code>æ–¹æ³•äº†ï¼Œè€Œå…¶ä¸­çš„å‚æ•°<code>Object body</code>å°±æ˜¯è¿”å›ç»™å‰ç«¯çš„æ•°æ®ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ªæ•°æ®è¿›è¡Œå¤„ç†ã€‚å’Œå‰è¾¹æ‰€è¯´çš„é€»è¾‘ä¸€æ ·ï¼šå¦‚æœæ•°æ®å·²ç»è¢«åŒ…è£…äº†ï¼Œé‚£å°±ç›´æ¥è¿”å›ï¼Œå¦‚æœè¿˜æ²¡ï¼Œé‚£å°±åœ¨è¿™é‡Œè¿›è¡ŒåŒ…è£…ã€‚ä»£ç å¦‚ä¸‹</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">beforeBodyWrite</span><span class="token punctuation">(</span><span class="token class-name">Object</span> body<span class="token punctuation">,</span> <span class="token class-name">MethodParameter</span> returnType<span class="token punctuation">,</span> <span class="token class-name">MediaType</span> selectedContentType<span class="token punctuation">,</span> <span class="token class-name">Class</span> selectedConverterType<span class="token punctuation">,</span> <span class="token class-name">ServerHttpRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">ServerHttpResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// å¦‚æœå·²ç»ç»è¿‡ Result åŒ…è£…äº†ï¼Œé‚£å°±æ˜¯ HashMap ç±»å‹çš„ï¼Œç›´æ¥è¿”å›</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>body <span class="token keyword">instanceof</span> <span class="token class-name">HashMap</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> body<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// å¦‚æœè¿”å›çš„æ•°æ®æ˜¯ å­—ç¬¦ä¸²ç±»å‹çš„</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>body <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">ObjectMapper</span> objectMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> objectMapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span><span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">succeed</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// æ¯ç»è¿‡å¤„ç†ï¼Œé‚£å°±é€šè¿‡æ­¤å¤„ è¿›è¡ŒåŒ…è£…</span>
        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">succeed</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>ä½†æ˜¯å¤§ä¼™çœ‹åˆ°è¿™å¯èƒ½ä¼šæ„Ÿè§‰æœ‰ç‚¹å¥‡æ€ªï¼Œä¸ºä»€ä¹ˆä¸Šè¿°ä»£ç è¦ç‰¹æ®Šå¤„ç† <code>body </code>æ˜¯ <code>String</code>ç±»å‹çš„æƒ…å†µï¼Ÿå¤§å®¶æ„Ÿå…´è¶£å¯ä»¥çœ‹è¿™ç¯‡åšå®¢ï¼š<br> <a href="https://blog.csdn.net/weixin_45176654/article/details/109689869?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167595105316800184110657%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=167595105316800184110657&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-1-109689869-null-null.142%5Ev73%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev1%5Econtrol&amp;utm_term=%E8%BF%94%E5%9B%9E%E5%80%BC%E6%8A%A5cannot%20be%20cast%20to%20&amp;spm=1018.2226.3001.4449">ResponseBodyAdviceã€Stringè¿”å›å€¼æŠ¥cannot be cast to java.lang.Stringçš„è§£å†³åŠæ³•</a><br> åšå®¢å†™çš„å¾ˆå¥½ï¼Œä»‹ç»å¾—å¾ˆè¯¦ç»†ï¼Œæˆ‘å°±ä¸è¯´ä»€ä¹ˆäº†</p> 
<h2><a id="5__279"></a>5. æ³¨å†Œ</h2> 
<p>æ¥ä¸‹æ¥æ‰æ˜¯æ­£æ–‡</p> 
<h3><a id="51__281"></a>5.1 é€»è¾‘</h3> 
<p>é¦–å…ˆå®ç°æœ€ç®€å•çš„æ³¨å†ŒåŠŸèƒ½<br> <img src="https://images2.imgbox.com/7d/d0/PUcQmxVQ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> è¿™é‡Œå®ç°çš„æ³¨å†ŒåŠŸèƒ½æœ‰å‡ ç‚¹è¦æ±‚ï¼š<br> â… . ä¸‰é¡¹æ•°æ®éƒ½ä¸èƒ½ä¸ºç©ºï¼Œå¦åˆ™æç¤ºç”¨æˆ·<br> â…¡. å¯†ç å’Œç¡®è®¤å¯†ç è¦ç›¸ç­‰ï¼Œå‰ç«¯å¯ä»¥è¿›è¡ŒéªŒè¯<br> â…¢. ç”¨æˆ·åå”¯ä¸€ï¼Œå¦‚æœåç«¯å·²ç»å­˜åœ¨è¿™ä¸ªç”¨æˆ·åï¼Œåˆ™æ³¨å†Œå¤±è´¥<br> â…£. æ»¡è¶³ä¸Šè¿°è¦æ±‚ï¼Œåˆ™å°†ç”¨æˆ·åå’Œå¯†ç å­˜å‚¨åˆ°æ•°æ®åº“ä¸­</p> 
<h3><a id="52__290"></a>5.2 éªŒè¯æ•°æ®è§„èŒƒæ€§</h3> 
<p>é¦–å…ˆå…ˆå¼•å…¥ jQuery</p> 
<pre><code class="prism language-js">    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"js/jquery.min.js"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p>å¯¹äº â…  å’Œ â…¡ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥åœ¨å‰ç«¯å®ç°ï¼Œè€Œå¯¹äºä¸Šé¢çš„æ‰€æœ‰æ­¥éª¤ï¼Œéƒ½éœ€è¦ç‚¹å‡»ã€Œæäº¤ã€ä¹‹åè§¦å‘ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æäº¤æŒ‰é’®ä¸Šå¯ä»¥åŠ ä¸ª onclick<br> <img src="https://images2.imgbox.com/10/8b/vEkzc7ma_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> é€šè¿‡ç‚¹å‡»è¿™ä¸ªæäº¤ï¼Œå°±å¯ä»¥è§¦å‘<code>onclick</code>è¿™ä¸ªæ–¹æ³•ï¼Œç„¶åç¼–å†™ js çš„ä»£ç ï¼š</p> 
<pre><code class="prism language-js">    <span class="token keyword">function</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> username <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> password <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> passwordagain <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#passwordagain"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>username<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"è´¦å·ä¸ºç©º"</span><span class="token punctuation">)</span>
            username<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>password<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"å¯†ç ä¸ºç©º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            password<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>passwordagain<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"ç¡®è®¤å¯†ç ä¸ºç©º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            passwordagain<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>password<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> passwordagain<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            password<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="53__328"></a>5.3 å®ç°æ³¨å†Œ</h3> 
<p>é€šè¿‡äº†ä¸Šé¢ js ä»£ç çš„åˆ¤æ–­ä¹‹åï¼Œå°±éƒ½æ»¡è¶³â… å’Œ â…¡ ä¸¤ä¸ªè¦æ±‚äº†ï¼Œæ‰€ä»¥å°±å¯ä»¥å°†ç”¨æˆ·åå’Œå¯†ç é€šè¿‡ Ajax å‘é€ç»™åç«¯ï¼Œå¹¶çº¦å®šè·¯ç”±ä¸º<code>/user/registry</code><br> ç”±åˆšåˆšçš„ <code>onclick</code> æ–¹æ³•ç»§ç»­ä¸‹é¢ js ä»£ç </p> 
<pre><code class="prism language-js">        jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">"/user/registry"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">"POST"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">username</span><span class="token operator">:</span>username<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token literal-property property">password</span><span class="token operator">:</span>password<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// ç­‰å¾…</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>ç„¶åå°±å¯ä»¥åœ¨<code>UserController</code>ä¸­ç¼–å†™ä»£ç <br> â… . åç«¯å¯¹æ¥æ”¶åˆ°çš„<code>username</code> å’Œ <code>password</code>ä»ç„¶éœ€è¦è¿›è¡Œéç©ºæ ¡éªŒ</p> 
<p>â…¡. æ£€éªŒç”¨æˆ·åæ˜¯å¦é‡å¤ï¼Œè¿™ä¸ªå¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨æ•°æ®åº“ä¸­æŸ¥è¯¢ <code>username</code>ï¼Œå¦‚æœè¿”å›ç»“æœä¸ºç©ºï¼Œè¯´æ˜æ²¡é‡å¤ï¼Œå°†è¿™ä¸ªç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å­˜å…¥æ•°æ®åº“ä¸­ï¼›å¦åˆ™ï¼Œçº¦å®šåç«¯è¿”å›çŠ¶æ€ç <code>state</code>ä¸º -2çš„æ—¶å€™ï¼Œè¡¨ç¤ºç”¨æˆ·åé‡å¤</p> 
<p>è¿™é‡Œæ¶‰åŠåˆ°çš„ sql è¯­å¥æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œè®²å¿«ä¸€äº›ï¼Œå…¶ä¸­ <code>StringUtils</code>æ˜¯å­—ç¬¦ä¸²å·¥å…·ç±»ï¼Œå®ƒçš„é™æ€æ–¹æ³•<code>hasLength()</code>å¯ä»¥ç”¨æ¥åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æœ‰é•¿åº¦</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/registry"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">registry</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// éç©ºæ£€éªŒ, å¦‚æœä¸¤ä¸ªä»»æ„ä¸€ä¸ªä¸ºç©ºï¼Œæˆ–è€…ä¸¤ä¸ªä¸­ä»»æ„ä¸€ä¸ªæ²¡æœ‰å†…å®¹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"è´¦å·å¯†ç ä¸ºç©º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢æŒ‡å®šç”¨æˆ·</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">selectByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// ä¸ä¸ºç©ºï¼Œè¯´æ˜é‡å¤äº†ï¼ŒçŠ¶æ€ç è¿”å› -2</span>
            <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"ç”¨æˆ·åé‡å¤"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment">// æ–°å¢ï¼ˆæ³¨å†Œï¼‰ä¸€ä¸ªç”¨æˆ·</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// å¦‚æœå—å½±å“çš„è¡Œæ•°ä¸º 1</span>
            <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">succeed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// å—å½±å“è¡Œæ•°ä¸ä¸º 1</span>
            <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="54__376"></a>5.4 å‰ç«¯ä»£ç å®Œå–„</h3> 
<p>åˆšåˆšæ˜¯å®Œæˆäº†åç«¯é€»è¾‘ï¼Œé‚£ä¹ˆå‰ç«¯æ¥æ”¶åˆ°å“åº”ä¹‹åï¼Œå°±è¦å¯¹æ•°æ®çš„çŠ¶æ€ç è¿›è¡Œå¤„ç†ï¼Œåˆšåˆšè¯´åˆ°ï¼Œ<code>state = -2</code>è¯´æ˜è´¦å·è¢«æ³¨å†Œï¼Œ<code>state = 200</code> è¯´æ˜ä¸€åˆ‡æ­£å¸¸ï¼Œæ³¨å†ŒæˆåŠŸï¼Œ<code>state = -1</code> è¡¨ç¤ºæ³¨å†Œè¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸æˆ–è€…å‚æ•°æœ‰è¯¯ã€‚</p> 
<p>â­è€Œæ³¨å†ŒæˆåŠŸåï¼Œå°±å¯ä»¥å°†é¡µé¢è·³è½¬åˆ°ç™»å½•é¡µ</p> 
<p>æ‰€ä»¥ Ajax çš„å›è°ƒå‡½æ•°ä»£ç å¦‚ä¸‹</p> 
<pre><code class="prism language-java">            success<span class="token operator">:</span><span class="token function">function</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// çŠ¶æ€ç æ­£å¸¸, å¹¶ä¸”æ•°æ®åº“å—å½±å“è¡Œæ•° ä¸º1</span>
                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ³¨å†ŒæˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"login.html"</span><span class="token punctuation">;</span> <span class="token comment">// è·³è½¬åˆ°ç™»å½•é¡µ</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"è¯¥ç”¨æˆ·åå·²ç»è¢«æ³¨å†Œ!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        username<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ³¨å†Œå‚æ•°æœ‰è¯¯, è¯·é‡æ–°æ³¨å†Œ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
</code></pre> 
<p>æœ€ç®€å•çš„æ³¨å†Œé¡µé¢å°±å®Œæˆäº†ï¼Œä½†æ˜¯è¿˜æœ‰ç‚¹é—®é¢˜ï¼Œåœ¨æœåŠ¡å™¨ä¸­ï¼Œå¯†ç æ˜¯ç›´æ¥ä»¥æ˜æ–‡çš„å½¢å¼å­˜å‚¨åœ¨ MySQL ä¸­çš„ï¼Œè¿™å°±æœ‰ä¸€å®šçš„å®‰å…¨é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å¯†ç è¿›è¡ŒåŠ å¯†ä¹‹åå†è¿›è¡Œå­˜å‚¨ï¼Œæˆ‘ä»¬åé¢å†æåŠ</p> 
<h2><a id="6__400"></a>6. ç™»å½•</h2> 
<p>åªéœ€è¦ç”¨æˆ·å°†ç”¨æˆ·åå’Œå¯†ç è¾“å…¥åï¼Œå‰ç«¯åˆ¤æ–­æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œé‚£ä¹ˆå°†ä¸¤ä¸ªæ•°æ®å‘é€ç»™åç«¯ï¼Œçº¦å®šæ¥å£ä¸º<code>/user/login</code>ï¼Œåç«¯å†æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢å‡ºè¿™ä¸ªç”¨æˆ·ï¼Œåˆ¤æ–­è¾“å…¥å¯†ç å’ŒçœŸå®å¯†ç æ˜¯å¦ä¸€è‡´ï¼Œè¿”å› 1 è¡¨ç¤ºä¸€è‡´ï¼Œè¿”å› 0 è¡¨ç¤ºç™»å½•å¤±è´¥ã€‚å¹¶ä¸”ç™»å½•æˆåŠŸä¹‹åå°†é¡µé¢è·³è½¬åˆ°ã€Œä¸ªäººä¸»é¡µã€</p> 
<h3><a id="61__403"></a>6.1 å‰ç«¯ä»£ç </h3> 
<p>é¦–å…ˆè®©æäº¤æŒ‰é’®èƒ½å¤Ÿè§¦å‘ js çš„æ–¹æ³•ï¼ŒéªŒè¯æœ‰æ•ˆæ€§ä¹‹åï¼Œé€šè¿‡ Ajax å‘é€è¯·æ±‚ç»™åç«¯ï¼Œå¦‚æœçŠ¶æ€ç æ­£å¸¸å¹¶ä¸” <code>data</code> ä¸º1ï¼Œè¡¨ç¤ºç™»å½•æˆåŠŸï¼Œå¦åˆ™æç¤ºç”¨æˆ·è´¦å·æˆ–è€…å¯†ç é”™è¯¯</p> 
<pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>script<span class="token punctuation">&gt;</span></span>
    function <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> username <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> password <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>username<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"ç”¨æˆ·åä¸ºç©º, è¯·é‡æ–°è¾“å…¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            username<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>password<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>     
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"å¯†ç ä¸ºç©º, è¯·é‡æ–°è¾“å…¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            password<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            url<span class="token operator">:</span><span class="token string">"/user/login"</span><span class="token punctuation">,</span>
            type<span class="token operator">:</span><span class="token string">"POST"</span><span class="token punctuation">,</span>
            data<span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                <span class="token string">"username"</span><span class="token operator">:</span>username<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">"password"</span><span class="token operator">:</span>password<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            success<span class="token operator">:</span><span class="token function">function</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"myblog_list.html"</span><span class="token punctuation">;</span> <span class="token comment">// è·³è½¬åˆ°ä¸ªäººä¸»é¡µ</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    username<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> 
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="62__440"></a>6.2 åç«¯ä»£ç </h3> 
<p>æ¥æ”¶åˆ°æ•°æ®ä¹‹åï¼Œå¦‚æœç™»å½•æˆåŠŸï¼Œé‚£ä¹ˆä¸ºäº†åç»­çš„ç”¨æˆ·ä½“éªŒï¼Œè¿˜éœ€è¦æ·»åŠ ä¼šè¯ï¼Œå› æ­¤è¿™ä¸ªæ–¹æ³•ä¸­çš„å‚æ•°è¿˜éœ€è¦<code>HttpServletSession request</code>ï¼Œé€šè¿‡<code>request.getSession()</code> æ¥è·å–ä¼šè¯ï¼Œå¹¶ä¸”è®¾ç½®å‚æ•°ä¸º trueï¼Œè¡¨ç¤ºå¦‚æœä¸å­˜åœ¨ä¼šè¯ï¼Œé‚£å°±ä¸ºå½“å‰ç”¨æˆ·åˆ›å»ºä¸€ä¸ªä¼šè¯ã€‚</p> 
<p>ç„¶åéœ€è¦å¾€ä¼šè¯ä¸­å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Œå¯ä»¥è®¾ç½® key ä¸ºä¸€ä¸ªå›ºå®šå€¼ï¼Œkey å¯¹åº”çš„ value å°±æ˜¯ç”¨æˆ·ä¿¡æ¯ã€‚<br> è¿™ä¸ªå›ºå®šå€¼å¯ä»¥æ”¾åœ¨ä¸€ä¸ª<code>Constants</code>ï¼ˆå¸¸é‡ï¼‰ç±»ä¸­è¿›è¡Œç®¡ç†</p> 
<pre><code class="prism language-java"><span class="token comment">// ç”¨æ¥ç®¡ç†å¸¸é‡</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Constants</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// ä¼šè¯ä¸­ å­˜å‚¨ç”¨æˆ·ä¿¡æ¯çš„ key å€¼</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">USER_SESSION_KEY</span> <span class="token operator">=</span> <span class="token string">"user_session_key"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>åç«¯ç™»å½•ä¸šåŠ¡ä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-java">    <span class="token comment">// ç™»å½•</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// å…¶ä¸­ä¸€ä¸ªä¸ºç©º</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">User</span> user <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">selectByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">boolean</span> isCorrect <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ•°æ®æœ‰æ•ˆ å¹¶ä¸” å¯†ç æ­£ç¡®</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> isCorrect<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// è·å–ä¼šè¯ï¼Œå¦‚æœä¸å­˜åœ¨ä¼šè¯ï¼Œé‚£ä¹ˆåˆ›å»ºä¸€ä¸ªä¼šè¯</span>
            <span class="token class-name">HttpSession</span> httpSession <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// å­˜å‚¨ç”¨æˆ·ä¿¡æ¯</span>
            httpSession<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">USER_SESSION_KEY</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h2><a id="7__482"></a>7. æ‹¦æˆªå™¨</h2> 
<p>ä¸ºäº†åç»­çš„ç”¨æˆ·ä½“éªŒï¼Œæ‹¦æˆªå™¨å¯ä»¥é€šè¿‡é…ç½®çš„æ–¹å¼æ¥æ‹¦æˆªæŸä¸€ç±»é¡µé¢ã€‚</p> 
<p>â… . å¦‚æœç”¨æˆ·æ²¡æœ‰ç™»å½•ï¼Œé‚£ä¹ˆè¿™äº›ç”¨æˆ·æ˜¯æ²¡æœ‰æ— æ³•è®¿é—®ã€Œä¸ªäººä¸»é¡µã€ï¼Œã€Œç¼–è¾‘åšå®¢ã€è¿™äº›é¡µé¢çš„ã€‚<br> â…¡. å¦‚æœç™»å½•äº†ï¼Œé‚£ä¹ˆåç»­é¡µé¢å°±ä¸éœ€è¦è¿›è¡Œé‡å¤ç™»å½•<br> â…¢. æ‹¦æˆªçš„è§„åˆ™å¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨è®¿é—®é¡µé¢æˆ–è€…æ¥å£çš„æ—¶å€™ï¼ŒéªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œå¯ä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¼šè¯ï¼Œä¼šè¯ä¸­æ˜¯å¦å­˜åœ¨ç”¨æˆ·ä¿¡æ¯æ¥è¿›è¡Œåˆ¤æ–­</p> 
<h3><a id="71__489"></a>7.1 é€»è¾‘</h3> 
<p>æ‹¦æˆªå™¨å®ç°èµ·æ¥å’Œç»Ÿä¸€æ•°æ®æ ¼å¼ä¸€æ ·ï¼Œéœ€è¦æŒ‰ç…§çº¦å®šç¼–å†™ä»£ç </p> 
<p>â… . è‡ªå·±å®šä¹‰ä¸€ä¸ªç±», éœ€è¦å®ç° HandleInterceptor æ¥å£, ç„¶åé‡å†™ preHandle æ–¹æ³•ï¼Œè¿™ä¸ªç±»ç”¨æ¥å®šä¹‰æ‹¦æˆªçš„è§„åˆ™<br> â…¡. å†å®šä¹‰ä¸€ä¸ªç±», å†å®ç° WebMvcConfigurer æ¥å£, é‡å†™é‡Œé¢çš„ addInterceptors æ–¹æ³•ï¼Œè¿™ç”¨æ¥å®šä¹‰éœ€è¦æ‹¦æˆªä»€ä¹ˆï¼Œä¸éœ€è¦æ‹¦æˆªä»€ä¹ˆ<br> â…¢. å°†ç¬¬ä¸€ä¸ªç±»å¯¹è±¡ä½œä¸ºå‚æ•°æ¥å¢åŠ æ‹¦æˆªå™¨, éœ€è¦ä½¿ç”¨ addInterceptor æ–¹æ³•, å†ç”¨ addPathPatterns å’Œ excludePathPatterns æ¥é€‰æ‹©æ‹¦æˆªå¯¹è±¡ã€‚ï¼ˆä¸¤ä¸ªç±»éƒ½éœ€è¦ç”± Spring è¿›è¡Œç®¡ç†ï¼‰</p> 
<h3><a id="72__496"></a>7.2 æ‹¦æˆªè§„åˆ™</h3> 
<p>è¿™ä¹Ÿå°±æ˜¯ç¬¬â… æ­¥çš„ä»£ç ï¼Œå®šä¹‰è¿™ä¸ªç±»ä¸º <code>LoginInterceptor</code> ï¼Œæ‹¦æˆªè§„åˆ™å°±æ˜¯æ ¹æ®æœ‰æ²¡æœ‰ç™»å½•ï¼ˆä¼šè¯ï¼‰æ¥åˆ¤æ–­æ˜¯å¦æ”¾è¡Œ</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// è¿™ä¸ªæ–¹æ³•ç”¨æ¥å®šä¹‰æ‹¦æˆªçš„è§„åˆ™</span>
        <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœä¸å­˜åœ¨ä¼šè¯ï¼Œæˆ–è€…ä¼šè¯ä¸­çš„ä¿¡æ¯ä¸å­˜åœ¨</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>session <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">USER_SESSION_KEY</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            response<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token comment">// ä¸èƒ½è®¿é—®</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token comment">// å¯ä»¥è®¿é—®</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="73__516"></a>7.3 æ‹¦æˆªå™¨æ‰€ä½œç”¨çš„èŒƒå›´</h3> 
<p>ç„¶åæ˜¯ç¬¬ â…¡ å’Œ â…¢ æ­¥ï¼Œç¬¬ â…¡ æ­¥ä¸­çš„ç±»è¿™é‡Œå®šä¹‰ä¸º<code>InterceptorScope</code>ï¼ˆæ‹¦æˆªå™¨èŒƒå›´ï¼‰ï¼Œé‡å†™<code>addInterceptors</code>æ–¹æ³•ä¹‹åï¼Œè¿™ä¸ªæ–¹æ³•é‡Œæœ‰ä¸ªå‚æ•°<code>InterceptorRegistry registry</code>ï¼Œç„¶åé€šè¿‡<code>registry.addInterceptor(å‚æ•°)</code>æ–¹æ³•ï¼Œå¹¶å°†<code>LoginInterceptor</code>ä½œä¸ºå‚æ•°å°±å¯ä»¥æ„å»ºä¸€ä¸ªæ„é€ å™¨äº†<br> â­å†å†å†é€šè¿‡è¿™ä¸ªæ„é€ å™¨çš„<code>addPathPatterns</code> å’Œ <code>excludePathPatterns</code>æ–¹æ³•æ¥æ·»åŠ å’Œå»é™¤éœ€è¦æ‹¦æˆªå™¨æ‰€éœ€è¦è¿‡æ»¤çš„é¡µé¢æˆ–è€…æ¥å£</p> 
<p>å¯ä»¥ç›´æ¥æ‹¦æˆªæ‰€æœ‰çš„é¡µé¢å’Œè·¯ç”±ï¼Œç„¶åå†å»é™¤æ‰ä¸€éƒ¨åˆ†æˆ‘ä»¬ä¸æ‹¦æˆªçš„ï¼š<br> â… . æ‰€æœ‰çš„é™æ€é¡µé¢éƒ½ä¸éœ€è¦æ‹¦æˆª<br> â…¡. markdownæ–‡æœ¬ç¼–è¾‘å™¨ä¸éœ€è¦æ‹¦æˆª<br> <img src="https://images2.imgbox.com/cf/6e/5042CruM_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> â…¢. æ‰€æœ‰çš„ js ä»£ç å’Œ css ä»£ç ä¹Ÿä¸éœ€è¦æ‹¦æˆª<br> â…£. å›¾ç‰‡ä¸éœ€è¦æ‹¦æˆª<br> â…¤. å‰ç«¯å‘åç«¯å‘é€çš„æ³¨å†Œå’Œç™»å½•è¯·æ±‚ä¹Ÿä¸éœ€è¦æ‹¦æˆª</p> 
<p>ç»¼ä¸Šï¼Œè¯¥éƒ¨åˆ†ä»£ç æš‚æ—¶å¯ä»¥æ˜¯ï¼š</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InterceptorScope</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">LoginInterceptor</span> loginInterceptor <span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token class-name">InterceptorRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span>loginInterceptor<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">)</span>               <span class="token comment">// æ‰€æœ‰çš„ä¸€åˆ‡ éƒ½æ‹¦æˆª</span>
                <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/**/*.html"</span><span class="token punctuation">)</span>    <span class="token comment">// é™¤äº† ...</span>
                <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/editor.md/**"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/js/**"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/css/**"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/img/**"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/user/login"</span><span class="token punctuation">)</span>  <span class="token comment">// ä¸æ‹¦æˆª ç™»å½• é¡µé¢</span>
                <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/user/registry"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ä¸æ‹¦æˆª æ³¨å†Œ é¡µé¢</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="8__550"></a>8. åšå®¢ç¼–è¾‘é¡µ</h2> 
<h3><a id="81__551"></a>8.1 é€»è¾‘</h3> 
<p>ç™»å½•ä¹‹åä¼šè·³åˆ°ä¸ªäººä¸»é¡µï¼Œä½†æ˜¯ä¸ªäººä¸»é¡µæ™šç‚¹è¯´ï¼Œå…ˆè¯´ç®€å•çš„ã€‚<br> åšå®¢ç¼–è¾‘é¡µï¼Œå¯ä»¥å°†å†™çš„æ–‡ç« å­˜å…¥è‰ç¨¿ç®±ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å°†å°†æ–‡ç« å‘å¸ƒå‡ºå»ã€‚<br> <img src="https://images2.imgbox.com/82/d3/RD9Xq7J0_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">å®ç°é€»è¾‘ï¼š</p> 
<p>â… . ç”±äºåˆšåˆšæ‹¦æˆªå™¨ä¸€é”®æ”¾è¡Œäº†æ‰€æœ‰çš„é™æ€é¡µé¢ï¼Œè¿™é‡Œè¦å†™åšå®¢ï¼Œä¸€å®šè¦ç™»å½•ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥å¾€åç«¯å‘é€è¯·æ±‚ï¼Œåœ¨åç«¯éªŒè¯ç™»å½•çŠ¶æ€ï¼Œå¦‚æœæ²¡ç™»å½•ï¼Œå‰ç«¯å°±ç›´æ¥å°†é¡µé¢è·³è½¬åˆ°ç™»å½•é¡µ<br> â…¡. å‰ç«¯æ£€éªŒæ•°æ®æœ‰æ•ˆæ€§ï¼ˆæ ‡é¢˜ä¸èƒ½ä¸ºç©ºï¼Œæ­£æ–‡ä¸èƒ½å°‘äº 100 ä¸ªå­—ç¬¦ï¼‰<br> â…¢. å°†æ ‡é¢˜å’Œæ­£æ–‡å‘é€ç»™åç«¯ï¼Œåç«¯é€šè¿‡ä¼šè¯ï¼Œå°†æ–‡ç« å†…å®¹ç»“åˆä¼šè¯ä¸­çš„ç”¨æˆ·ä¿¡æ¯å­˜å…¥æ–‡ç« è¡¨ä¸­</p> 
<h3><a id="82__560"></a>8.2 è§¦å‘ç™»å½•éªŒè¯</h3> 
<p>è¿™å®ç°èµ·æ¥å¾ˆå®¹æ˜“ï¼Œçº¦å®šä¸€ä¸ªæ¥å£<code>/islogged</code>ï¼Œåç«¯å†è·å–ä¼šè¯ï¼Œå¦‚æœç™»å½•äº†ï¼Œè¿”å›1ï¼Œå¦åˆ™è¿”å›0</p> 
<p>ç”±äºè¿™ä¸ªé¡¹ç›®éœ€è¦é¢‘ç¹éªŒè¯ç™»å½•çŠ¶æ€ï¼Œæ‰€ä»¥å¯ä»¥å°†ä¼šè¯çš„è·å–åŒ…è£…ä¸€ä¸‹ï¼š</p> 
<pre><code class="prism language-java"><span class="token comment">// è·å–ç”¨æˆ·ç™»å½•ä¿¡æ¯</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SessionUtil</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// è·å–ç™»å½•ç”¨æˆ·</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">User</span> <span class="token function">getLoginUser</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>session <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">USER_SESSION_KEY</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">USER_SESSION_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>å‰ç«¯ç”¨ Ajax å‘é€è¯·æ±‚ï¼š</p> 
<pre><code class="prism language-js">        <span class="token comment">// æ£€æŸ¥æ˜¯å¦å·²ç»ç™»å½•äº†</span>
        <span class="token keyword">function</span> <span class="token function">checkIsLogged</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">"/user/islogged"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">"GET"</span><span class="token punctuation">,</span>
                <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token comment">// å·²ç»ç™»å½•ï¼Œå°±å¯ä»¥ç»§ç»­</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">error</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"è¯·æ‚¨å…ˆç™»å½•è´¦å·"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"login.html"</span><span class="token punctuation">;</span> <span class="token comment">// æ²¡æœ‰ç™»å½•ï¼Œè¿›è¡Œè·³è½¬</span>
                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> 
        <span class="token function">checkIsLogged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>åç«¯ï¼š</p> 
<pre><code class="prism language-java">    <span class="token comment">/**
     * éªŒè¯æ˜¯å¦å·²ç»ç™»å½•
     * å·²ç™»å½•è¿”å› 1
     * æœªç™»å½•è¿”å› 0
     * @return
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/islogged"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">isLogged</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token class-name">SessionUtil</span><span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            response<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="83__621"></a>8.3 å‘å¸ƒæ–‡ç« </h3> 
<p>é¦–å…ˆä¸ºè¿™ä¸ªæ ‡é¢˜åŠ ä¸Šä¸€ä¸ª ID<br> <img src="https://images2.imgbox.com/0f/2f/plDT8ncN_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>å‰ç«¯éªŒè¯å®Œæ•°æ®åˆæ³•æ€§ä¹‹åç‚¹å‡»ã€Œå‘è¡¨æ–‡ç« ã€è§¦å‘ js çš„æ–¹æ³•ï¼Œç„¶åçº¦å®šæ¥å£<code>/article/submit</code>å‘é€ç»™åç«¯ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ï¼š<br> <img src="https://images2.imgbox.com/b0/e1/dzitl9w9_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>æœ¬é¡¹ç›®å®ç°äº†è‰ç¨¿ç®±åŠŸèƒ½ï¼Œå…¶ä¾èµ–äº userinfo è¡¨ä¸­çš„ state å­—æ®µï¼Œè§† state = 1 çš„æ—¶å€™ï¼Œæ–‡ç« æ˜¯å‘è¡¨çŠ¶æ€ï¼Œè§† state = 2 çš„æ—¶å€™ï¼Œè§†ä¸ºæ˜¯è‰ç¨¿ç®±çŠ¶æ€ã€‚è€Œè¡¨ä¸­çš„ state å­—æ®µé»˜è®¤æ˜¯ 1ï¼Œæ‰€ä»¥ç›´æ¥æ’å…¥å³å¯</p> 
<p>æ’å…¥åè¿”å›å—å½±å“çš„è¡Œæ•°ï¼Œå¦‚æœæ˜¯ 1ï¼Œè¯´æ˜ä¸€åˆ‡æ­£å¸¸ï¼Œæ–‡ç« å‘è¡¨å®Œæˆï¼Œå‰ç«¯å°†é¡µé¢è·³è½¬åˆ°ä¸ªäººä¸»é¡µï¼Œå‰ç«¯ä»£ç ï¼š</p> 
<pre><code class="prism language-js">        <span class="token comment">// æäº¤</span>
        <span class="token keyword">function</span> <span class="token function">mysub</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> title <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#title"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> content <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>title<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> title<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ ‡é¢˜ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>content <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> content<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ–‡ç« å†…å®¹ä¸èƒ½å°‘äº100å­—"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">"/article/submit"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">"POST"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token string-property property">"title"</span><span class="token operator">:</span>title<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"content"</span><span class="token operator">:</span>content
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// å—å½±å“çš„è¡Œæ•°ä¸º 1</span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ–‡ç« ä¸Šä¼ æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"myblog_list.html"</span><span class="token punctuation">;</span> <span class="token comment">// è·³è½¬</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"è´¦å·æœªç™»å½•æˆ–æ–‡ç« å‚æ•°æœ‰è¯¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p>åç«¯ï¼š</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArticleController</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">ArticleService</span> articleService <span class="token punctuation">;</span>

    <span class="token comment">// å‘è¡¨ä¸€ç¯‡æ–‡ç« </span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/submit"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token class-name">SessionUtil</span><span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> articleService<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> title<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="84__685"></a>8.4 ä¿å­˜è‡³è‰ç¨¿ç®±</h3> 
<p>é™¤äº†ç›´æ¥å‘è¡¨æ–‡ç« ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¿å­˜åˆ°è‰ç¨¿ç®±ä¸­ï¼Œè¿™é‡Œçš„é€»è¾‘å’Œå‘è¡¨æ–‡ç« éå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯æ’å…¥çš„æ–‡ç«  state è®¾ç½®ä¸º 2 å³å¯ã€‚ğŸ“çº¦å®šæ¥å£ä¸º<code>/artilce/draft</code><br> <img src="https://images2.imgbox.com/13/c1/TCJpIWx3_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>å‰ç«¯ä»£ç </p> 
<pre><code class="prism language-js">        <span class="token comment">// ä¿å­˜ä¸ºè‰ç¨¿é¡¹</span>
        <span class="token keyword">function</span> <span class="token function">saveAsDraft</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> title <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#title"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> content <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>title<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> title<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ ‡é¢˜ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>content <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> content<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ–‡ç« å†…å®¹ä¸èƒ½å°‘äº100å­—"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">"/article/draft"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">"POST"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token string-property property">"title"</span><span class="token operator">:</span>title<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"content"</span><span class="token operator">:</span>content
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸä¿å­˜åˆ°è‰ç¨¿ç®±"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"myblog_list.html"</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"è´¦å·æœªç™»å½•æˆ–è€…å‚æ•°æœ‰è¯¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p>åç«¯ä»£ç å’Œåˆšåˆšçš„å‘è¡¨æ–‡ç« ååˆ†ç›¸ä¼¼ï¼Œå¦‚ä¸‹æ˜¯ xml æ–‡ä»¶çš„çš„ sql è¯­å¥</p> 
<p><img src="https://images2.imgbox.com/9f/75/ctcdrWkd_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> ä»£ç å¦‚ä¸‹</p> 
<pre><code class="prism language-java">    <span class="token comment">/**
     * å®ç°: å°†æ–‡ç« ä¿å­˜åˆ°è‰ç¨¿ç®±ä¸­
     * ç›¸å½“äºæ™®é€šçš„æ’å…¥æ–‡ç« , ä½†æ˜¯ state = 2
     * å‰ç«¯è¿”å›ä¸¤ä¸ªå‚æ•°: title, content
     * @return è¿”å›å—å½±å“çš„è¡Œæ•°
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/draft"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">saveAsDraft</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token class-name">SessionUtil</span><span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> articleService<span class="token punctuation">.</span><span class="token function">submitToDraft</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> title<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="85__744"></a>8.5 é€€å‡ºè´¦å·</h3> 
<p>åœ¨åšå®¢ç¼–è¾‘é¡µä¸­ï¼Œå¦‚ä¸‹ï¼Œå³ä¸Šè§’ä¸­è¿˜æœ‰ä¸ªé€€å‡ºåŠŸèƒ½<br> <img src="https://images2.imgbox.com/88/ef/I39O9bM9_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> è¿˜æ˜¯ä¸€æ ·ï¼Œä¸ºè¿™ä¸ªæŒ‰é’®æ·»åŠ ä¸€ä¸ª onclick<br> <img src="https://images2.imgbox.com/d3/e1/iJPjOPBJ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> è¿™ä¸ªå®ç°ä¹Ÿéå¸¸ç®€å•ï¼Œå‘çº¦å®šçš„æ¥å£<code>/user/logout</code>å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œç„¶ååç«¯å°†ç›¸å…³çš„ä¼šè¯åˆ é™¤æ‰ï¼Œå‰ç«¯å†è·³è½¬åˆ°ç™»å½•é¡µå°±å¯ä»¥äº†</p> 
<p>å‰ç«¯ä»£ç ï¼š</p> 
<pre><code class="prism language-js">        <span class="token keyword">function</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"ç¡®å®šè¦é€€å‡ºè´¦å·å—?"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// æ¥ä¸ªç¡®è®¤æŒ‰é’®</span>
                jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">"/user/logout"</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">"POST"</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// ä¸éœ€è¦æ•°æ®</span>
                    <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ³¨é”€æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"login.html"</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token function-variable function">error</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">// è¿™ç§æƒ…å†µå°±æ˜¯è¢«æ‹¦æˆªå™¨é”æ‹¦æˆªäº†</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">401</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"ç”¨æˆ·æœªç™»å½•"</span><span class="token punctuation">)</span>
                            location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"/login.html"</span><span class="token punctuation">;</span> <span class="token comment">// è¿›è¡Œè·³è½¬</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p>åç«¯ä»£ç ä¹Ÿå¾ˆç®€å•</p> 
<pre><code class="prism language-java">    <span class="token comment">// é€€å‡ºè´¦å·</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/logout"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">logout</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœå­˜åœ¨ä¼šè¯  å¹¶ä¸”  ä¼šè¯ä¸­æœ‰ä¿¡æ¯</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>session <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">USER_SESSION_KEY</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// é‚£å°±åˆ é™¤è¿™ä¸ªä¿¡æ¯</span>
            session<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">USER_SESSION_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// é€€å‡ºæˆåŠŸ</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="9__790"></a>9. ä¸ªäººä¸»é¡µ</h2> 
<p><img src="https://images2.imgbox.com/ce/16/3nM42JWg_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">è¿™ä¸ªé¡µé¢å°±æ˜¯å±•ç¤ºç”¨æˆ·ç™»å½•åçš„ä¸ªäººä¸»é¡µï¼Œå±•ç¤ºæ‰€æœ‰æ–‡ç« ï¼ŒåŒ…æ‹¬è‰ç¨¿ç®±ä¸­çš„æ–‡ç« ï¼Œå¹¶ä¸”å·¦ä¾§çš„ä¸ªäººä¿¡æ¯æ ï¼Œéœ€è¦æ˜¾ç¤ºç”¨æˆ·çš„å§“åå’Œæ–‡ç« æ•°é‡ï¼ˆå¤´åƒä¹Ÿå¯ä»¥è¿›è¡Œæ›´æ–°ï¼‰ï¼Œâ­ä½†æ˜¯è¿™é‡Œçš„æ–‡ç« æ•°é‡æ˜¯ä¸åŒ…æ‹¬è‰ç¨¿ç®±é‡Œé¢çš„æ–‡ç« çš„</p> 
<h3><a id="91__793"></a>9.1 è·å–ç”¨æˆ·ä¿¡æ¯æ </h3> 
<p>è¿™é‡Œéœ€è¦å°†å·¦ä¾§ä¿¡æ¯æ¸²æŸ“å®Œæ•´ï¼Œå‘åç«¯å‘é€è¯·æ±‚ï¼Œçº¦å®šè·¯ç”±ä¸º<code>/user/myinfo</code>ï¼Œå¹¶ä¸”è¿™ä¸ªé¡µé¢å¯åŠ¨çš„æ—¶å€™å°±éœ€è¦å‘å‰ç«¯å‘é€è¯·æ±‚<br> <img src="https://images2.imgbox.com/84/95/nmYVA6WL_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">å¹¶ä¸”åç«¯éœ€è¦è¿”å›ä¸¤ä¸ªæ•°æ®ï¼šâ‘  ç”¨æˆ·æ–‡ç« æ€»æ•°ï¼ˆå·²å‘å¸ƒæ–‡ç« æ•°ï¼‰ â‘¡ ç”¨æˆ·åï¼ˆä¹Ÿå¯ä»¥æ˜¯è¿™ä¸ªç”¨æˆ·å¯¹è±¡ï¼‰ï¼Œåç«¯è¦æŠŠä¸¤ä¸ªæ•°æ®è¿›è¡Œæ‰“åŒ…è¿”å›ç»™å‰ç«¯</p> 
<p>æ‰€ä»¥å‰ç«¯æ‹¿åˆ°æ•°æ®åï¼Œå°±å¯ä»¥å¯¹ ä»¥ä¸Šä¸¤é¡¹æ•°æ® è¿›è¡Œæ¸²æŸ“ï¼Œä»£ç å¦‚ä¸‹</p> 
<pre><code class="prism language-js">        <span class="token comment">// åŠ è½½å·¦ä¾§ç”¨æˆ·ä¿¡æ¯</span>
        <span class="token keyword">function</span> <span class="token function">getMyInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">"/user/myinfo"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">"GET"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    	<span class="token comment">// å¯¹è¿™ä¸¤ä¸ªæ ‡ç­¾çš„å†…å®¹è¿›è¡Œå¡«å……</span>
                        <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#username"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>user<span class="token punctuation">.</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ç”¨æˆ·å§“å</span>
                        <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#articleCount"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>articleCount<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// ç”¨æˆ·æ–‡ç« æ€»æ•°</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">error</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">401</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">// è¢«æ‹¦æˆªäº†</span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"ç”¨æˆ·æœªç™»å½•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"login.html"</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">getMyInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é¡µé¢åœ¨åŠ è½½çš„æ—¶å€™å°±å‘é€è¯·æ±‚è¿›è¡Œè·å–</span>

</code></pre> 
<p>åç«¯ä»£ç å¦‚ä¸‹</p> 
<p><img src="https://images2.imgbox.com/af/6e/actRvQZf_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<pre><code class="prism language-java">    <span class="token comment">/**
     * è·å–ä¸ªäººä¸»é¡µçš„ ç”¨æˆ·å ä»¥åŠåˆ›ä½œæ€»æ•°
     * @return
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/myinfo"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getMyInfo</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token class-name">SessionUtil</span><span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// ç”¨æ¥åŒ…è£…ç»“æœ</span>
        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å­˜æ”¾è¿™ä¸ªå¯¹è±¡</span>

        <span class="token comment">// è·å–æ–‡ç« æ€»æ•°</span>
        <span class="token keyword">int</span> sum <span class="token operator">=</span> articleService<span class="token punctuation">.</span><span class="token function">getArticleCountByUid</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"articleCount"</span><span class="token punctuation">,</span> sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">succeed</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="92__852"></a>9.2 è·å–ä¸ªäººä¸»é¡µæ‰€æœ‰æ–‡ç« </h3> 
<p>å·¦ä¾§æ˜¯æ˜¾ç¤ºç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ï¼Œå³ä¾§æ˜¯è¯¥ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æ–‡ç« äº†ï¼ˆåŒ…æ‹¬å·²å‘è¡¨æ–‡ç« å’Œä¿å­˜åœ¨è‰ç¨¿ç®±ä¸­çš„æ–‡ç« ï¼‰ï¼Œå¹¶ä¸”å¯¹äºæ¯ä¸€ä¸ªæ–‡ç« ï¼Œç”¨æˆ·éƒ½å¯ä»¥è¿›è¡Œã€ŒæŸ¥çœ‹è¯¦ç»†ã€ï¼Œã€Œä¿®æ”¹ã€å’Œã€Œåˆ é™¤ã€</p> 
<p>å› æ­¤ï¼Œæˆ‘ä»¬å°±éœ€è¦å¯¹è¿™ä¸€æ®µå‰ç«¯ä»£ç è¿›è¡Œæ¸²æŸ“</p> 
<ol><li>åœ¨â‘ è¿™ä¸ªæ ‡ç­¾å†åŠ ä¸€ä¸ª <code>id="articleListDiv"</code>ï¼Œç„¶åå†å°†è¿™ä¸ªç”¨æˆ·çš„æ‰€æœ‰æ–‡ç« é€šè¿‡ For å¾ªç¯ï¼Œæ·»åŠ åˆ°è¿™ä¸ªæ ‡ç­¾ä¹‹ä¸­ï¼Œæ¯ä¸€ä¸ªæ–‡ç« å°±ç›¸å½“äºä¸€ä¸ª<code>class=blog</code>çš„æ ‡ç­¾</li><li>åƒâ‘¡çš„æ ‡é¢˜ï¼Œæ—¥æœŸï¼Œæ‘˜è¦ï¼Œå°±è¦é‡æ–°è°ƒæ•´å…·ä½“çš„å€¼ï¼Œå°†æ¯ä¸€ç¯‡åšå®¢çš„ç›¸å…³å±æ€§æ‹¼æ¥ä¸Šå»</li><li>â‘£å’Œâ‘¤ä¹Ÿæ˜¯åŒç†ï¼Œåœ¨æ¸¸è§ˆå™¨æ¸²æŸ“çš„æ—¶å€™ï¼Œå°±æŠŠè¿™ä¸‰ä¸ªæ ‡ç­¾ç»™æ„é€ å¥½ï¼Œâ‘£æ˜¯æ„é€ å¥½é“¾æ¥ï¼Œâ‘¤æ˜¯ä¸ºäº†ç‚¹å‡»åˆ é™¤çš„æ—¶å€™ï¼Œèƒ½è§¦å‘ js ä¸­çš„æ–¹æ³•</li><li>è€Œåƒâ‘¢è¿™ç§ï¼Œå°±è¦åˆ¤æ–­å½“å‰æ–‡ç« çš„state æ˜¯å¦ä¸º 2ï¼Œæ¥å†³å®šæ·»åŠ ä¸å¦</li></ol> 
<p><img src="https://images2.imgbox.com/0b/11/WGRpTJYr_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> çº¦å®šå‰ç«¯å‘é€çš„è·¯ç”±ä¸º<code>/article/mylist</code>ï¼Œå¹¶ä¸”åç«¯å¿…ç„¶æ˜¯è¿”å› Listï¼Œç„¶åå‰ç«¯éå†æ¥æ”¶åˆ°çš„æ•°æ®ï¼Œæ²¡ä¸€ä¸ªæ•°æ®éƒ½é‡æ–°ç»„è£…æˆä¸€ä¸ª<code>class=blog</code>çš„ div å…ƒç´ ï¼Œå¹¶ä½œä¸ºæœ€å¤–å±‚Divï¼ˆarticleListDivï¼‰çš„å­å…ƒç´ ã€‚</p> 
<p>ä½†æ˜¯åœ¨ä¸ªäººä¸»é¡µä¸­ï¼Œæ˜¾ç¤ºçš„æ¯ä¸€ç¯‡æ–‡ç« ï¼Œéƒ½ä¸èƒ½å®Œå…¨å±•ç¤ºæ­£æ–‡ï¼Œè€Œåº”è¯¥å±•ç¤ºæ‘˜è¦ï¼Œæ‰€ä»¥è¿˜éœ€è¦å¯¹æ­£æ–‡è¿›è¡Œæå–ï¼Œæ­¤å¤„æˆ‘ä»¬å¯¹è¯¥æ­£æ–‡çš„å‰100ä¸ªå­—ç¬¦ä½œä¸ºæ‘˜è¦</p> 
<p>å‰ç«¯ä»£ç å¦‚ä¸‹</p> 
<pre><code class="prism language-js">        <span class="token comment">// è·å–æ–‡ç« çš„å¼€å¤´</span>
        <span class="token keyword">function</span> <span class="token function">getBeginning</span><span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>content<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// å¦‚æœæ–‡ç« å­—ç¬¦ä¸²é•¿åº¦å°äº 100</span>
                <span class="token keyword">return</span> content<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> content<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword">function</span> <span class="token function">getMyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">// åˆå§‹åŒ–ä¸ªäººä¸»é¡µçš„åšå®¢ä¿¡æ¯</span>
            jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">"/article/mylist"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">"GET"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// çŠ¶æ€ç æ­£å¸¸ &amp;&amp; åç«¯æœ‰è¿”å›æ•°æ® &amp;&amp; è¿”å›çš„æ•°æ®è‡³å°‘æœ‰ ä¸€ç¯‡æ–‡ç« </span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                        result<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">article</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            html <span class="token operator">+=</span> <span class="token string">'&lt;div class="blog"&gt;'</span><span class="token punctuation">;</span>
                            html <span class="token operator">+=</span> <span class="token string">'&lt;div class="title"&gt;'</span> <span class="token operator">+</span> article<span class="token punctuation">.</span>title <span class="token operator">+</span><span class="token string">'&lt;/div&gt;'</span><span class="token punctuation">;</span>
                            html <span class="token operator">+=</span> <span class="token string">'&lt;div class="date"&gt;'</span> <span class="token operator">+</span> article<span class="token punctuation">.</span>createtime <span class="token operator">+</span> <span class="token string">'&lt;/div&gt;'</span><span class="token punctuation">;</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>article<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// å¦‚æœè¯¥æ–‡ç« æ˜¯è‰ç¨¿, é‚£ä¹ˆç‰¹æ®Šå¤‡æ³¨ä¸€ä¸‹</span>
                                html <span class="token operator">+=</span> <span class="token string">'&lt;div style="font-weight:bold; color:red; text-align: center;";&gt;äºè‰ç¨¿ç®±ä¸­&lt;/div&gt;'</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            html <span class="token operator">+=</span> <span class="token string">'&lt;div class="desc"&gt;'</span> <span class="token operator">+</span> <span class="token function">getBeginning</span><span class="token punctuation">(</span>article<span class="token punctuation">.</span>content<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'  &lt;/div&gt;'</span><span class="token punctuation">;</span>
                            html <span class="token operator">+=</span> <span class="token string">'&lt;div style="margin-top: 50px; text-align: center;"&gt;'</span><span class="token punctuation">;</span>
                            html <span class="token operator">+=</span> <span class="token string">'&lt;a href="blog_content.html?id='</span><span class="token operator">+</span> article<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">'"&gt;æŸ¥çœ‹å…¨æ–‡&lt;/a&gt;&amp;nbsp&amp;nbsp'</span><span class="token punctuation">;</span>
                            html <span class="token operator">+=</span> <span class="token string">'&lt;a href="blog_modify.html?id='</span><span class="token operator">+</span> article<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">'"&gt;ä¿®æ”¹&lt;/a&gt;&amp;nbsp&amp;nbsp'</span><span class="token punctuation">;</span>
                            html <span class="token operator">+=</span> <span class="token string">'&lt;a href="javascript:del('</span><span class="token operator">+</span> article<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">')"&gt;åˆ é™¤&lt;/a&gt;'</span><span class="token punctuation">;</span>
                            html <span class="token operator">+=</span> <span class="token string">'&lt;/div&gt;'</span> <span class="token operator">+</span> <span class="token string">'&lt;/div&gt;'</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#articleListDiv"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å…¨éƒ¨åŠ åˆ° articleListDiv ä¸­</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// æ²¡æœ‰å‘è¡¨è¿‡æ–‡ç« </span>
                        <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#articleListDiv"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt;æš‚æ— æ•°æ®&lt;/h1&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">getMyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿›å…¥è¿™ä¸ªé¡µé¢å°±éœ€è¦æ‰§è¡Œ</span>
</code></pre> 
<p>è¿™é‡Œåç«¯ä»£ç æ¯”å‰ç«¯ä»£ç ç®€å•å¤šäº†ï¼Œå¦‚ä¸‹</p> 
<pre><code class="prism language-java">    <span class="token comment">/**
     * è·å–ç”¨æˆ·çš„æ‰€æœ‰æ–‡ç« 
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/mylist"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Article</span><span class="token punctuation">&gt;</span></span> <span class="token function">getMyList</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token class-name">SessionUtil</span><span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Article</span><span class="token punctuation">&gt;</span></span> articles <span class="token operator">=</span> articleService<span class="token punctuation">.</span><span class="token function">getAllByUid</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> articles<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="93__929"></a>9.3 åˆ é™¤æ–‡ç« </h3> 
<p>ä¸Šè¿°é¡µé¢æµ‹è¯•æ•ˆæœå¦‚ä¸‹ğŸ‘‡ï¼Œå¹¶ä¸”åœ¨è¿™ä¸ªé¡µé¢ä¸­ï¼Œæ¯ä¸€ç¯‡æ–‡ç« éƒ½æœ‰ä¸‰ä¸ªæ ‡ç­¾ï¼Œè¿™é‡Œå…ˆå®ç°åˆ é™¤åŠŸèƒ½ã€‚</p> 
<p><img src="https://images2.imgbox.com/24/66/gU0tG9P0_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>è¿™ä¸ªå®ç°ä¹Ÿç®€å•ï¼Œçº¦å®šæ¥å£ä¸º<code>/article/delete</code>ï¼Œå‰ç«¯æŠŠè¿™ä¸ª æ–‡ç« çš„ ID å‘é€ç»™åç«¯ï¼Œç„¶ååç«¯è¿›å…¥æ•°æ®åº“ä¸­è¿›è¡Œåˆ é™¤ï¼Œå®Œäº‹äº†ä¹‹åå‰ç«¯å†è·³è½¬åˆ°ä¸ªäººä¸»é¡µï¼ˆç›¸å½“äºåˆ·æ–°ï¼‰</p> 
<p>å‰ç«¯ä»£ç ï¼š</p> 
<pre><code class="prism language-java">		 <span class="token comment">// é€šè¿‡ç‚¹å‡»åˆ é™¤æŒ‰é’®è§¦å‘è¿™ä¸ªæ–¹æ³•</span>
        function <span class="token function">del</span><span class="token punctuation">(</span>articleId<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">// åˆ é™¤æ–‡ç« </span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"æ‚¨ç¡®å®šè¦åˆ é™¤è¯¥æ–‡ç« å—"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    url<span class="token operator">:</span><span class="token string">"/article/delete"</span><span class="token punctuation">,</span>
                    type<span class="token operator">:</span><span class="token string">"GET"</span><span class="token punctuation">,</span>
                    data<span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                        <span class="token string">"articleId"</span><span class="token operator">:</span>articleId
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    success<span class="token operator">:</span><span class="token function">function</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// åˆ é™¤çš„æ–‡ç« æ•°é‡ä¸º 1</span>
                            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"åˆ é™¤æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"myblog_list.html"</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"å‚æ•°å¼‚å¸¸, åˆ é™¤å¤±è´¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p>éœ€è¦æ³¨æ„ï¼šç”±äºæ˜¯åˆ é™¤æ–‡ç« ï¼Œæ‰€ä»¥ä¼šè¯ç”¨æˆ·çš„ ID å¿…é¡»å’Œå¾…åˆ é™¤æ–‡ç« çš„ UID ä¸€è‡´ï¼Œå¦åˆ™æ²¡æœ‰æƒé™ï¼</p> 
<pre><code class="prism language-java">    <span class="token comment">// åˆ é™¤æŒ‡å®šæ–‡ç« </span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/delete"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">Integer</span> articleId<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>articleId <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> articleId <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// è·å–å½“å‰ä¼šè¯ç”¨æˆ·</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token class-name">SessionUtil</span><span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–è¿™ç¯‡æ–‡ç« å¯¹è±¡</span>
        <span class="token class-name">Article</span> article <span class="token operator">=</span> articleService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>articleId<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// ä¸¤ä¸ªéƒ½ä¸ä¸ºç©ºï¼Œå¹¶ä¸”æ–‡ç« å¾—æ˜¯è‡ªå·±çš„, æ‰èƒ½åˆ é™¤</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> article <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> article<span class="token punctuation">.</span><span class="token function">getUid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> articleService<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>articleId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>ä¸ªäººä¸»é¡µåŸºæœ¬ä¸Šå°±å·®ä¸å¤šäº†ï¼Œä½†æ˜¯å³ä¸Šè§’è¿˜æœ‰ä¸€ä¸ªé€€å‡ºæŒ‰é’®ï¼Œè¿™é‡Œçš„é€»è¾‘ä»£ç éƒ½å’Œä¹‹å‰çš„ä¸€æ ·ï¼Œç›´æ¥å¤åˆ¶è¿‡æ¥å°±å¥½äº†</p> 
<h2><a id="10__984"></a>10. åšå®¢è¯¦æƒ…é¡µ</h2> 
<p>ä¸ªäººä¸»é¡µè¿˜æœ‰ä¸¤ä¸ªæŒ‰é’®æ²¡æœ‰å®ç°ï¼šã€Œä¿®æ”¹ã€å’Œã€ŒæŸ¥çœ‹å…¨æ–‡ã€</p> 
<p>å…ˆå®ç°ã€ŒæŸ¥çœ‹å…¨æ–‡ã€ï¼Œç‚¹å¼€ä»¥åå…¶å®å°±æ˜¯åšå®¢è¯¦æƒ…é¡µ<br> å¦‚ä¸‹æ˜¯åšå®¢è¯¦æƒ…é¡µçš„ç»“æ„</p> 
<p><img src="https://images2.imgbox.com/cf/b4/hDOuBHat_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="101__URL__992"></a>10.1 è·å– URL ä¸­çš„å‚æ•°</h3> 
<p>å›é¡¾ä¸€ä¸‹åšå®¢è¯¦æƒ…é¡µæ˜¯æ€ä¹ˆè¿›è¡Œè·³è½¬çš„ï¼Ÿå¦‚ä¸‹ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªæ‹¼æ¥äº†æ–‡ç«  ID çš„é“¾æ¥ï¼Œè€Œç°åœ¨æ—¢è¦å¯¹å·¦ä¾§ä¿¡æ¯æ è¿›è¡Œæ¸²æŸ“ï¼Œä¹Ÿè¦æ¸²æŸ“å³è¾¹çš„æ–‡ç« ï¼Œå°±æœ‰äº†ä¸€ä¸ªå¿…è¦æ¡ä»¶â€”â€”éœ€è¦è·å– URL ä¸­çš„ ID å‘é€ç»™åç«¯<br> <img src="https://images2.imgbox.com/66/b6/lTtI6Tz6_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">è·å–URLä¸­æŒ‡å®šçš„å‚æ•°ä¹Ÿä¸éš¾ï¼Œå¦‚ä¸‹ js ä»£ç ï¼Œå½“æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ª key å€¼ï¼Œå°±å¯ä»¥è·å–è¿™ä¸ª key åœ¨ URL ä¸­å¯¹åº”çš„ value å€¼</p> 
<pre><code class="prism language-js">            <span class="token comment">// è·å–å½“å‰ url ä¸­çš„æŸä¸ªå‚æ•°</span>
            <span class="token keyword">function</span> <span class="token function">getURLParam</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> params <span class="token operator">=</span> location<span class="token punctuation">.</span>search<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"?"</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// å¦‚æœæœ‰æŸ¥è¯¢å­—ç¬¦ä¸²</span>
                    params <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"?"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> ary <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"&amp;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å– è¿™ä¸ª url ä¸­æ‰€æœ‰çš„é”®å€¼å¯¹ æ•°ç»„</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ary<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">var</span> key_value <span class="token operator">=</span> ary<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å¾—é”®å€¼å¯¹, key_value[0] æ˜¯é”®, key_value[1] æ˜¯å€¼</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>key_value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// å¦‚æœæ‰¾åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„ é”®</span>
                            <span class="token keyword">return</span> key_value<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span> 
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="102__1016"></a>10.2 å·¦ä¾§ä½œè€…ä¿¡æ¯</h3> 
<p>æœ‰äº†ä¸Šè¿°æ–¹æ³•ä¹‹åï¼Œå°±å¯ä»¥å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡<code>curId</code>æ¥æ¥æ”¶å½“å‰é¡µé¢çš„ æ–‡ç«  ID</p> 
<pre><code class="prism language-java">       <span class="token keyword">var</span> curId <span class="token operator">=</span> <span class="token function">getURLParam</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// å°†å½“å‰é¡µé¢çš„æ–‡ç«  id èµ‹å€¼ç»™å…¨å±€å˜é‡ curId</span>
</code></pre> 
<p>æ¥ç€å°±æ˜¯å¤„ç†å·¦ä¾§çš„ç”¨æˆ·ä¿¡æ¯ï¼Œä½†æ˜¯è¿™é‡Œä¸ä¸€æ ·äº†ï¼Œåˆšåˆšæ˜¯ä¸ªäººä¸»é¡µï¼Œæ˜¾ç¤ºè‡ªå·±çš„ä¿¡æ¯å¾ˆæ­£å¸¸ï¼Œä½†æ˜¯ç°åœ¨æ˜¯åšå®¢è¯¦æƒ…é¡µï¼Œæ˜¾ç¤ºè¯¥æ–‡ç« çš„ä½œè€…ç›¸å…³ä¿¡æ¯ä¼šæ›´åŠ åˆç†ã€‚ä½†æ˜¯å‰ç«¯çš„æ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬ç¨ä½œä¿®æ”¹å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ğŸ‘‡ï¼Œç„¶åçº¦å®šè·¯ç”±æ˜¯<code>/user/userinfo</code></p> 
<p>ï¼ˆæ³¨æ„è¿™ä¸ªé¡µé¢çš„ç”¨æˆ·åå’Œæ–‡ç« æ•°çš„ div åŠ ä¸Š idï¼‰</p> 
<pre><code class="prism language-java">    <span class="token comment">// ç„¶åå½“å‰æ–‡ç« ä½œè€…çš„ ä¸ªäººä¿¡æ¯ ä»¥åŠ ä¸ªäººåˆ›ä½œæ€»é‡</span>
        function <span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                url<span class="token operator">:</span><span class="token string">"/user/userinfo"</span><span class="token punctuation">,</span>
                type<span class="token operator">:</span><span class="token string">"GET"</span><span class="token punctuation">,</span>
                data<span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token string">"articleId"</span><span class="token operator">:</span>curId<span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// å‘é€è¯¥æ–‡ç« çš„ id</span>
                success<span class="token operator">:</span><span class="token function">function</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#username"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>user<span class="token punctuation">.</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ç”¨æˆ·å§“å</span>
                        <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#articleCount"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>articleCount<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// ç”¨æˆ·æ–‡ç« æ€»æ•°</span>
                    <span class="token punctuation">}</span> <span class="token comment">// å¦åˆ™å°±æ˜¯å¼‚å¸¸æƒ…å†µ</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>åç«¯å°±æ ¹æ® æ–‡æ¡£ iD è·å–ç”¨æˆ·å¯¹è±¡ï¼Œç„¶åå†è·å–ç”¨æˆ·å¯¹è±¡è¿”å›ç»™å‰ç«¯å³å¯</p> 
<pre><code class="prism language-java">    <span class="token comment">/**
     * è·å–ç”¨æˆ·çš„å·¦ä¾§ç”¨æˆ·ä¿¡æ¯ï¼Œä»¥åŠå·²å‘å¸ƒçš„æ–‡ç« æ€»é‡
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/userinfo"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> articleId<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// æ•°å€¼æ— æ•ˆ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>articleId <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> articleId <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// è·å–è¿™ä¸ªç”¨æˆ·</span>
        <span class="token class-name">Article</span> article <span class="token operator">=</span> articleService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>articleId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>article <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// åœ¨è·å–è¿™ä¸ªç”¨æˆ· å¯¹è±¡</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>article<span class="token punctuation">.</span><span class="token function">getUid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å†è·å–è¿™ä¸ª ç”¨æˆ· çš„æ‰€æœ‰å·²ç»å‘å¸ƒçš„æ–‡ç« </span>
        <span class="token keyword">int</span> sum <span class="token operator">=</span> articleService<span class="token punctuation">.</span><span class="token function">getArticleCountByUid</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"articleCount"</span><span class="token punctuation">,</span> sum<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">succeed</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="103__1076"></a>10.3 å³ä¾§æ–‡ç« è¯¦æƒ…</h3> 
<p>è¿˜æ˜¯ä¸€æ ·ï¼Œåœ¨é¡µé¢å¯åŠ¨çš„æ—¶å€™å°±è§¦å‘æ–¹æ³•<code>getArticleDetail</code>ï¼Œçº¦å®šæ¥å£ä¸º<code>/article/detail</code>ï¼Œåç«¯è¿”å›ä¸€ä¸ª Article å¯¹è±¡ï¼Œå‰ç«¯å†ä¾æ¬¡å¯¹ç›¸åº”çš„æ ‡ç­¾è¿›è¡Œæ“ä½œï¼š</p> 
<pre><code class="prism language-java">        <span class="token comment">//è·å–æ–‡ç« çš„è¯¦æƒ…é¡µ: ç„¶åæ ¹æ® url ä¸­çš„å‚æ•°å‘åç«¯å‘é€è¯·æ±‚</span>
        function <span class="token function">getArticleDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                url<span class="token operator">:</span><span class="token string">"/article/detail"</span><span class="token punctuation">,</span>
                type<span class="token operator">:</span><span class="token string">"GET"</span><span class="token punctuation">,</span>
                data<span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token string">"articleId"</span><span class="token operator">:</span>curId<span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function">success</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// çŠ¶æ€ç æ­£å¸¸, å¹¶ä¸”åç«¯è¿”å›çš„æ•°æ®ä¸ä¸ºç©º</span>
                        <span class="token keyword">var</span> title <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#title"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#date"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> content <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#editorDiv"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> rcount <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#rcount"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                        title<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        rcount<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>rcount<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        date<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>createtime<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token comment">// å†™å…¥çš„æ˜¯ markdown æ ¼å¼çš„æ–‡ç« , è¿™é‡Œéœ€è¦ç‰¹æ®Šå¤„ç†ä¸€ä¸‹</span>
                        editormd <span class="token operator">=</span> editormd<span class="token punctuation">.</span><span class="token function">markdownToHTML</span><span class="token punctuation">(</span><span class="token string">"editorDiv"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>markdown <span class="token operator">:</span> result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>content<span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">getArticleDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è°ƒç”¨è¿™ä¸ªæ–¹æ³•, æ˜¾ç¤ºå‡ºåšå®¢å…¨æ–‡</span>
</code></pre> 
<p>åç«¯çš„ä»»åŠ¡é™¤äº†å°†è¿™ä¸ªæ–‡ç« è¿”å›ä¹‹å¤–ï¼Œè¿˜æœ‰ç”±äºè®¿é—®äº†è¿™ä¸ªæ–‡ç« è¯¦æƒ…ï¼Œæ‰€ä»¥åŒæ—¶éœ€è¦å¯¹è¿™ä¸ªæ–‡ç« é˜…è¯»é‡ +1<br> <img src="https://images2.imgbox.com/84/f3/KZY2ireK_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ä½†æ˜¯<br> å¦‚æœç”¨æˆ·æœªç™»å½•ï¼Œæ–‡ç« åˆæ˜¯è‰ç¨¿ç®±çŠ¶æ€ï¼Œé‚£ä¹ˆæ— æƒé™è®¿é—®<br> å¦‚æœå½“å‰æ–‡ç« æ˜¯è‰ç¨¿ç®±çŠ¶æ€ å¹¶ä¸” è¿™ä¸ªæ–‡ç« åˆä¸æ˜¯è‡ªå·±çš„æ–‡ç« ï¼Œè¿˜æ˜¯æ²¡æœ‰æƒé™è®¿é—®ã€‚ä»£ç å¦‚ä¸‹</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/detail"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">detail</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">Integer</span> articleId<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>articleId <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> articleId <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token class-name">SessionUtil</span><span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–è¿™ç¯‡æ–‡ç« </span>
        <span class="token class-name">Article</span> article <span class="token operator">=</span> articleService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>articleId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœæ²¡æœ‰è¿™ç¯‡æ–‡ç«   æˆ–è€…  ç”¨æˆ·æ²¡ç™»å½•å¹¶ä¸”æ–‡ç« æ˜¯è‰ç¨¿ç®±çŠ¶æ€  æˆ–è€…  æ–‡ç« æ˜¯è‰ç¨¿ç®±çŠ¶æ€å¹¶ä¸”æ–‡ç« ä¸æ˜¯è‡ªå·±çš„</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>article <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> article<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">||</span>
                <span class="token punctuation">(</span>article<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> article<span class="token punctuation">.</span><span class="token function">getUid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// åŒæ—¶è¿›è¡Œé˜…è¯»é‡è‡ªå¢ 1</span>
        articleService<span class="token punctuation">.</span><span class="token function">rcountIncrease</span><span class="token punctuation">(</span>articleId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¿”å›ç»™å‰ç«¯çš„æ–‡ç«  é˜…è¯»é‡ä¹Ÿè¦æ›´æ–°</span>
        article<span class="token punctuation">.</span><span class="token function">setRcount</span><span class="token punctuation">(</span>article<span class="token punctuation">.</span><span class="token function">getRcount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">succeed</span><span class="token punctuation">(</span>article<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>åˆ°è¿™é‡Œï¼Œåšå®¢è¯¦æƒ…é¡µåŸºæœ¬å°±å®Œæˆäº†ï¼Œä½†æ˜¯è¿˜æœ‰ç‚¹ç»†èŠ‚<br> ç”±äºåšå®¢è¯¦æƒ…é¡µæ˜¯ä¸éœ€è¦ç™»å½•çŠ¶æ€ä¹Ÿå¯ä»¥è®¿é—®çš„ï¼Œæ‰€ä»¥æ‹¦æˆªå™¨è¦ä¸º<code>/article/detail</code>å’Œ <code>/user/userinfo</code>æ”¾è¡Œ</p> 
<p><img src="https://images2.imgbox.com/18/d3/C1bXrRgv_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="11__1138"></a>11. ä¿®æ”¹æ–‡ç« é¡µ</h2> 
<p>åœ¨ä¸ªäººä¸»é¡µä¸­çš„æ¯ä¸ªæ–‡ç« çš„ä¸‰ä¸ªæŒ‰é’®ï¼Œç°åœ¨å°±åªå‰©ä¸€ä¸ªæ²¡å®Œæˆäº†â€”â€”ä¿®æ”¹</p> 
<p>ä¿®æ”¹åšå®¢çš„å®ç°å…¶å®å’Œ ç¼–è¾‘åšå®¢ å¾ˆç›¸ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°† ã€Œæ–‡ç« ç¼–è¾‘é¡µã€ æ‹·è´ä¸€ä»½ï¼Œé‡å‘½åä¸ºã€Œæ–‡ç« ä¿®æ”¹é¡µã€ï¼Œç„¶åä¿®æ”¹ä¸€éƒ¨åˆ†ä»£ç å°±è¡Œ</p> 
<p><img src="https://images2.imgbox.com/15/2b/GfzVq7x4_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">å¦‚ä¸Šï¼Œä¿®æ”¹é¡µé¢çš„ç½‘å€ä¹Ÿå°±åŒ…å«äº† æ–‡ç«  IDï¼Œæ‰€ä»¥è¿™é‡Œè¿˜éœ€è¦ç”¨åˆ°è·å– URL å‚æ•°çš„ js æ–¹æ³•ï¼ŒåŒæ ·æ˜¯æ‹·è´ä¸€ä»½ï¼Œç„¶åä½¿ç”¨å…¨å±€å˜é‡æ¥æ”¶å½“å‰é¡µé¢çš„ æ–‡ç«  ID</p> 
<pre><code class="prism language-js">        <span class="token keyword">var</span> curId <span class="token operator">=</span> <span class="token function">getURLParam</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// å°†å½“å‰é¡µé¢çš„æ–‡ç«  id èµ‹å€¼ç»™å…¨å±€å˜é‡ curId</span>
</code></pre> 
<h3><a id="111__1149"></a>11.1 åŠ è½½æ–‡ç« å†…å®¹</h3> 
<p>ç”±äºæ˜¯ä¿®æ”¹é¡µé¢ï¼Œæ‰€ä»¥è¿›å…¥è¿™ä¸ªé¡µé¢çš„æ—¶å€™ï¼Œå°±éœ€è¦å°†è¿™ä¸ªæ–‡ç« çš„æ ‡é¢˜å’Œå†…å®¹è½½å…¥è¯¥é¡µé¢ï¼Œå®šä¹‰è¿™ä¸ªæ–¹æ³•ä¸º<code>showArticle()</code>ï¼Œçº¦å®šè·¯ç”±<code>/article/show</code>ã€‚å¹¶ä¸”è¿™ä¸ªé¡µé¢ä¹Ÿéœ€è¦ç™»å½•æ‰å¯ä»¥ä½¿ç”¨ï¼Œè€Œæ‹¦æˆªå™¨ä¹Ÿä¼šæ‹¦æˆªè¿™ä¸ª <code>/artilce/show</code>è¿™ä¸ªè¯·æ±‚æ¥éªŒè¯ç™»å½•çŠ¶æ€ï¼Œæ‰€ä»¥ä¸‹è¾¹è¿™ä¸ªæ–¹æ³•å°±å¯ä»¥åˆ æ‰</p> 
<pre><code class="prism language-js">        <span class="token function">checkIsLogged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ï¼ˆå¤šä½™çš„ï¼‰
</code></pre> 
<p>åœ¨ Markdown ç¼–è¯‘å™¨ä¸­è½½å…¥æ­£æ–‡çš„å®ç°ï¼šè¿™ä¸ª Markdown æä¾›äº†ä¸€ä¸ªæ–¹æ³•</p> 
<pre><code class="prism language-java">        <span class="token function">initEdit</span><span class="token punctuation">(</span><span class="token string">"# åœ¨è¿™é‡Œå†™ä¸‹ä¸€ç¯‡åšå®¢"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆå§‹åŒ–ç¼–è¯‘å™¨çš„å€¼</span>
</code></pre> 
<p>å°†è¿™ä¸ªæ–¹æ³•åˆ æ‰ï¼Œç„¶åæ”¾åˆ°<code>showArtilce()</code>ä¸­ï¼Œå°†<code>initEdit()</code>çš„å‚æ•°æ›¿æ¢æˆæ­£æ–‡å°±å¯ä»¥å®ç°<br> å‰ç«¯ä»£ç å¦‚ä¸‹</p> 
<pre><code class="prism language-js">        <span class="token comment">// ç„¶åå°†è¿™ç¯‡æ–‡ç« çš„æ ‡é¢˜å’Œå†…å®¹è¿›å…¥æ³¨å…¥</span>
        <span class="token keyword">function</span> <span class="token function">showArticle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">"/article/show"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">"GET"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token string-property property">"articleId"</span><span class="token operator">:</span>curId<span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#title"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// å°†æ ‡é¢˜é‡æ–°è¾“å…¥</span>
                        <span class="token function">initEdit</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å°†æ–‡ç« æ­£æ–‡å†è¾“å…¥åˆ° markdown ç¼–è¯‘å™¨ä¸­        </span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
                        <span class="token comment">// å‚æ•°æœ‰è¯¯</span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"å‚æ•°æœ‰è¯¯"</span><span class="token punctuation">)</span>
                        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"/blog_list.html"</span><span class="token punctuation">;</span> <span class="token comment">// è·³è½¬åˆ°ä¸»é¡µ</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">error</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// è¿™ç§æƒ…å†µå°±æ˜¯è¢«æ‹¦æˆªå™¨é”æ‹¦æˆªäº†</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">401</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"ç”¨æˆ·æœªç™»å½•"</span><span class="token punctuation">)</span>
                        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"/login.html"</span><span class="token punctuation">;</span> <span class="token comment">// è·³è½¬åˆ°ç™»å½•é¡µ</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">showArticle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>åç«¯ä»£ç ï¼Œå’Œä¹‹å‰çš„ä»£ç å¾ˆç›¸ä¼¼ï¼Œè¦è¿›å…¥ä¿®æ”¹é¡µï¼Œå¿…é¡»æ–‡ç« æ˜¯è‡ªå·±çš„æ‰å¯ä»¥</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/show"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">Integer</span> articleId<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>articleId <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> articleId <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// è·å–ä¼šè¯ç”¨æˆ·</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token class-name">SessionUtil</span><span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–æ–‡ç« ä¿¡æ¯</span>
        <span class="token class-name">Article</span> article <span class="token operator">=</span> articleService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>articleId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœæ–‡ç« æŸ¥ä¸åˆ°ï¼Œæˆ–è€…ç”¨æˆ·æ²¡ç™»å½• æˆ–è€… æ–‡ç« ä¸æ˜¯ä¼šè¯ç”¨æˆ·çš„æ–‡ç« </span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>article <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> user <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> article<span class="token punctuation">.</span><span class="token function">getUid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">succeed</span><span class="token punctuation">(</span>article<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å›</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="112__1211"></a>11.2 å°†æ–‡ç« ä¿å­˜ä¸ºè‰ç¨¿</h3> 
<p>å½“ç‚¹å‡» ã€Œä¿å­˜ä¸ºè‰ç¨¿ã€çš„æŒ‰é’®çš„æ—¶å€™ï¼Œè§¦å‘ js ä¸­çš„æ–¹æ³•ï¼Œå‘é€è¯·æ±‚ç»™åç«¯ï¼Œç„¶ååç«¯è¿›è¡Œä¿®æ”¹çš„æ–‡ç« æœ‰ä¸¤ç§å¯èƒ½ï¼š<br> â… . æ˜¯æœ¬æ¥å°±åœ¨è‰ç¨¿ç®±ï¼Œç°åœ¨ç»§ç»­å†™ï¼Œå†™å®Œå†æ”¾è‰ç¨¿ç®±<br> â…¡. å¦ä¸€ç§æ˜¯è¿™ä¸ªæ–‡ç« å·²ç»å‘è¡¨äº†ï¼Œä½†æ˜¯ç”±äºæŸç§åŸå› ï¼Œä¿®æ”¹å®Œåæ”¾å…¥è‰ç¨¿ç®±</p> 
<p>ä½†æ˜¯ä¸¤ç§æƒ…å†µæœ¬è´¨éƒ½æ˜¯ä¸€æ ·çš„ï¼Œstate ç»Ÿä¸€è®¾ç½®ä¸º 2 å³å¯</p> 
<p>è¿™é‡Œå¯ä»¥çº¦å®šæ¥å£ä¸º <code>/article/draft</code>ï¼Œä½†æ˜¯ç»†å¿ƒçš„å¯ä»¥ä¼šå‘ç°è¿™ä¸ªè·¯ç”±å‰é¢å·²ç»ä½¿ç”¨è¿‡äº†ï¼Œå‰é¢ä½¿ç”¨çš„æ—¶å€™æ˜¯ã€Œå°†æ–‡ç« æ”¾ç½®åˆ°è‰ç¨¿ç®±ä¸­ã€ï¼Œå¹¶ä¸”ä¼ å…¥çš„å‚æ•°æ˜¯<br> <img src="https://images2.imgbox.com/35/7e/acFsBzBJ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">ä½†æ˜¯åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸šåŠ¡æ˜¯ä¿®æ”¹æ–‡ç« ï¼Œæ‰€ä»¥å‚æ•°ä¸­ä¼šå¤šä¸€ä¸ª <code>articleId</code>â­æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ ¹æ® <code>articleId</code>æ˜¯å¦ä¸ºç©ºï¼Œæ¥åŒºåˆ†ä¸¤ç§ä¸šåŠ¡ï¼Œå°±å¯ä»¥å°†ä¸¤ä¸ªä¸šåŠ¡åˆå¹¶åˆ°ä¸€èµ·</p> 
<p>å‰ç«¯ä»£ç ï¼š</p> 
<pre><code class="prism language-js">        <span class="token comment">// ä¿å­˜ä¸ºè‰ç¨¿é¡¹</span>
        <span class="token keyword">function</span> <span class="token function">saveAsDraft</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> title <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#title"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> content <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>title<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> title<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ ‡é¢˜ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>content <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> content<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ–‡ç« å†…å®¹ä¸èƒ½å°‘äº100å­—"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">"/article/draft"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">"POST"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token string-property property">"title"</span><span class="token operator">:</span>title<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"content"</span><span class="token operator">:</span>content<span class="token punctuation">,</span>
                    <span class="token string-property property">"articleId"</span><span class="token operator">:</span>curId
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸä¿å­˜åˆ°è‰ç¨¿ç®±"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"myblog_list.html"</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"è´¦å·æœªç™»å½•æˆ–è€…å‚æ•°æœ‰è¯¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p>åœ¨ xml æ–‡ä»¶ä¸­æ›´æ–°æ–‡ç« çš„ sql è¯­å¥ï¼š<br> <img src="https://images2.imgbox.com/2d/60/WAyKpo1R_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> <code>ArticleContoller</code>çš„ä»£ç </p> 
<pre><code class="prism language-java">    <span class="token comment">/**
     * å®ç°: å°†æ–‡ç« ä¿å­˜åˆ°è‰ç¨¿ç®±ä¸­
     * ç›¸å½“äºæ™®é€šçš„æ’å…¥æ–‡ç« , ä½†æ˜¯ state = 2
     * å‰ç«¯è¿”å›ä¸¤ä¸ªå‚æ•°: title, content
     * @return è¿”å›å—å½±å“çš„è¡Œæ•°
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/draft"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">saveAsDraft</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">Integer</span> articleId<span class="token punctuation">,</span> <span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token class-name">SessionUtil</span><span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// å­˜åœ¨ articlaId è¯´æ˜æ˜¯ ä¿®æ”¹æ–‡ç« å¹¶å­˜å…¥è‰ç¨¿ç®±</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>articleId <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// è·å–è¿™ç¯‡æ–‡ç« </span>
            <span class="token class-name">Article</span> article <span class="token operator">=</span> articleService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>articleId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// ä¸å­˜åœ¨è¿™ç¯‡æ–‡ç« , æˆ–è€… æ–‡ç« ä½œè€… ä¸æ˜¯ ä¼šè¯ç”¨æˆ·</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>article <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> article<span class="token punctuation">.</span><span class="token function">getUid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> articleService<span class="token punctuation">.</span><span class="token function">updateToDraft</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> articleId<span class="token punctuation">,</span> title<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å¦åˆ™å°±æ˜¯ æ–°å¢æ–‡ç« åˆ°è‰ç¨¿ç®±ä¸­</span>
        <span class="token keyword">return</span> articleService<span class="token punctuation">.</span><span class="token function">submitToDraft</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> title<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="113__1288"></a>11.3 ä¿®æ”¹åå‘è¡¨</h3> 
<p>è¿™ä¸ªé€»è¾‘å°±å¾ˆå®¹æ˜“å®ç°äº†ï¼Œæ— éå°±æ˜¯æ›´æ–°æ–‡ç« çš„å‘å¸ƒçŠ¶æ€ä¸º 1ï¼Œçº¦å®šè·¯ç”±ä¸º<code>/article/update</code></p> 
<pre><code class="prism language-js">        <span class="token comment">// æäº¤</span>
        <span class="token keyword">function</span> <span class="token function">mysub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> title <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#title"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> content <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>title<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> title<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ ‡é¢˜ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                title<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>   
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>content <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> content<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ–‡ç« æ­£æ–‡å­—æ•°éœ€è¦è¶…è¿‡100ä¸ªå­—"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// å‘é€è¯·æ±‚ç»™åç«¯</span>
            jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">"/article/update"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">"POST"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token string-property property">"articleId"</span><span class="token operator">:</span>curId<span class="token punctuation">,</span>
                    <span class="token string-property property">"title"</span><span class="token operator">:</span>title<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token string-property property">"content"</span><span class="token operator">:</span>content
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span>  result<span class="token punctuation">.</span>data <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// åç«¯è¿”å›çš„æ˜¯å—å½±å“çš„è¡Œæ•°</span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"ä¿®æ”¹æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token comment">// è·³è½¬åˆ° "æˆ‘çš„ä¸»é¡µ"</span>
                        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"myblog_list.html"</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"ä¿®æ”¹å¤±è´¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">error</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">401</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"è¯·å…ˆç™»å½•è´¦å·"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"login.html"</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p>è¿™é‡Œçš„åç«¯ä»£ç å’Œå‰é¢ä¹Ÿæ˜¯å¾ˆç›¸ä¼¼äº†ï¼š</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/update"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">Integer</span> articleId<span class="token punctuation">,</span> <span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token class-name">SessionUtil</span><span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Article</span> article <span class="token operator">=</span> articleService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>articleId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ–‡ç« ä¸å­˜åœ¨ æˆ–è€… æ–‡ç« ä¸æ˜¯ç™»å½•ç”¨æˆ·çš„</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>article <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> article<span class="token punctuation">.</span><span class="token function">getUid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> articleService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> articleId<span class="token punctuation">,</span> title<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre> 
<h2><a id="12__1351"></a>12. åšå®¢ä¸»é¡µ</h2> 
<p>é¦–é¡µè¿™ä¸ªé¡µé¢ç”¨äºå°±æ˜¯å±•ç¤ºæ‰€æœ‰ç”¨æˆ·çš„æ–‡ç« ï¼Œå¦‚ä¸‹å¹¶ä¸”æœ‰åˆ†é¡µçš„æŒ‰é’®ï¼Œä¹Ÿå°±æ˜¯æŒ‰ç…§ç”¨æˆ·çš„é¡µé¢å±•ç¤ºè¯¥éƒ¨åˆ†çš„æ–‡ç« ï¼Œé¦–å…ˆè¯´ä»¥ä¸‹è¿™ä¸ªåˆ†é¡µï¼š</p> 
<p><img src="https://images2.imgbox.com/e2/be/FqKSn55N_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="121__1355"></a>12.1 åˆ†é¡µ</h3> 
<p>è¿™ä¸ªåŠŸèƒ½éœ€è¦ä¸¤ä¸ªå…³é”®å±æ€§â€”â€”ç¬¬å‡ é¡µ<code>pageIndex</code>ï¼Œä»¥åŠä¸€é¡µæœ€å¤šæ˜¾ç¤ºæœ€å°‘ç¯‡æ–‡ç« <code>pageSize</code>ï¼Œä¸ºäº†æµ‹è¯•æ–¹ä¾¿å’Œç®€å•è€ƒè™‘ï¼ŒğŸ“æ­¤å¤„å°† ä¸€é¡µæœ€å¤§æ–‡ç« æ•°è®¾ç½®ä¸º 2</p> 
<p>æ­¤å¤–ï¼Œ<code>pageIndex</code>å’Œ <code>pageSize</code> è¿™ä¸¤ä¸ªä¿¡æ¯å¯ä»¥æ”¾åœ¨ URL ä¸Šï¼Œç„¶åè¿™ä¸ªé¡µé¢åœ¨åŠ è½½çš„æ—¶å€™å°±å¯ä»¥æ ¹æ® URL ä¸Šçš„è¿™ä¸¤ä¸ªå‚æ•°å‘åç«¯å‘é€è¯·æ±‚ï¼Œåç«¯è¿”å›æŒ‡å®šèŒƒå›´çš„æ–‡ç« äº¤ç»™å‰ç«¯æ¸²æŸ“ã€‚å¹¶ä¸”å¦‚æœ URL ä¸Šæ²¡æœ‰è¿™ä¸¤ä¸ªä¿¡æ¯ï¼Œé‚£ä¹ˆå°±é»˜è®¤æ˜¯ç¬¬ä¸€é¡µ</p> 
<h3><a id="122__1360"></a>12.2 å‰ç«¯</h3> 
<p>é¦–å…ˆå®šä¹‰ä¸¤ä¸ªå…¨å±€å˜é‡ï¼Œ<code>pageIndex</code> å’Œ <code>pageSize</code> ï¼Œç„¶åå®šä¹‰ä¸€ä¸ªæ–¹æ³•<code>init</code>åœ¨é¡µé¢åŠ è½½çš„æ—¶å€™å®Œæˆä»¥ä¸‹å·¥ä½œï¼š<br> â… . ä» URL ä¸Šè·å–å‚æ•°å¹¶ä¸º <code>pageIndex</code> å’Œ <code>pageSize</code> èµ‹å€¼ï¼ˆåˆ«å¿˜äº†æ‹·è´ è·å–URLä¸­å‚æ•° çš„æ–¹æ³•ï¼‰<br> â…¡. å‘é€è¯·æ±‚ç»™åç«¯ï¼Œçº¦å®šè·¯ç”±æ˜¯<code>/article/all</code>ï¼Œæ¥æ”¶åˆ°æ•°æ®åå±•ç¤ºç»™ç”¨æˆ·</p> 
<p>æ¥æ”¶åˆ°æ•°æ®åï¼Œæ¯ä¸€ç¯‡æ–‡ç« éƒ½æ˜¯â‘  <code>id="blogs</code>çš„ div çš„å­å…ƒç´ ï¼Œå¹¶ä¸”æŒ‰ç…§â‘¡çš„æ ¼å¼æ¥ä¸ºç»„ç»‡æ¯ä¸€ä¸ªæ–‡ç« ï¼Œå°†ç»„ç»‡å¥½çš„æ¯ä¸€ç¯‡æ–‡ç« åŠ åˆ°â‘ è¿™ä¸ªå¤§ div ä¸­<br> <img src="https://images2.imgbox.com/4e/b3/VZcqHJuc_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">å¹¶ä¸”è¿™é‡Œæ˜¯å±•ç¤ºæ‰€æœ‰çš„æ–‡ç« ï¼Œå±•ç¤ºçš„éƒ¨åˆ†ä»è¦æ˜¯æ‘˜è¦ï¼Œå–æ–‡ç« çš„å‰ 100 ä¸ªå­—ç¬¦<br> js ä»£ç å¦‚ä¸‹</p> 
<pre><code class="prism language-js">        <span class="token keyword">var</span> pageIndex<span class="token punctuation">;</span>   <span class="token comment">// å½“å‰é¡µé¢çš„ç´¢å¼•, ç¬¬å‡ é¡µ</span>
        <span class="token keyword">var</span> pageSize<span class="token punctuation">;</span>    <span class="token comment">// å½“å‰é¡µé¢æœ€å¤šå¯ä»¥æ˜¾ç¤ºå¤šå°‘ç¯‡æ–‡ç« </span>

        <span class="token comment">// æ¯æ¬¡è¿›å…¥è¿™ä¸ªé¡µé¢éƒ½è¦åŠ è½½å½“å‰é¡µé¢çš„æ•ˆæœ</span>
        <span class="token comment">// è·å–å½“å‰é¡µé¢çš„ pageIndex å’Œ pageSize , ä¼ é€’ç»™å‰ç«¯, å¹¶æ¸²æŸ“</span>
        <span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> temp <span class="token operator">=</span> <span class="token function">getURLParam</span><span class="token punctuation">(</span><span class="token string">"pageIndex"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>temp <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> temp <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// "ç¬¬å‡ é¡µ"ä¸ºæœ‰æ•ˆå€¼</span>
                pageIndex <span class="token operator">=</span> temp<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>                        <span class="token comment">// å¦‚æœæ²¡æœ‰é¡µæ•°, é‚£ä¹ˆé»˜è®¤ä¸ºé¦–é¡µ</span>
                pageIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// é»˜è®¤ä¸ºç¬¬ä¸€é¡µ</span>
            <span class="token punctuation">}</span>


            temp <span class="token operator">=</span> <span class="token function">getURLParam</span><span class="token punctuation">(</span><span class="token string">"pageSize"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>temp <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> temp <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// "æœ€å¤šæ˜¾ç¤ºå¤šå°‘ç‰‡æ–‡ç« ä¸ºæœ‰æ•ˆå€¼"</span>
                pageSize <span class="token operator">=</span> temp<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>                        <span class="token comment">// å¦‚æœæ²¡æœ‰å‚æ•°, é‚£ä¹ˆé»˜è®¤ä¸€é¡µæ˜¾ç¤º 2 ç¯‡æ–‡ç« </span>
                pageSize <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">"/article/all"</span><span class="token punctuation">,</span>         
                <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">"GET"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                    <span class="token string-property property">"pageIndex"</span><span class="token operator">:</span>pageIndex<span class="token punctuation">,</span>
                    <span class="token string-property property">"pageSize"</span><span class="token operator">:</span>pageSize
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// è¿”å›çš„æ•°æ®æ˜¯æœ‰æ•ˆå€¼</span>
                        <span class="token comment">// å¯¹ id ä¸º blogs çš„æ ‡ç­¾è¿›è¡Œæ‹¼æ¥</span>
                        <span class="token keyword">var</span> finalResult <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token keyword">var</span> cur <span class="token operator">=</span> result<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// å½“å‰æ–‡ç« </span>
                            finalResult <span class="token operator">+=</span> <span class="token string">'&lt;div class="blog"&gt;'</span><span class="token punctuation">;</span>
                            finalResult <span class="token operator">+=</span> <span class="token string">'&lt;div class="title"&gt;'</span> <span class="token operator">+</span> cur<span class="token punctuation">.</span>title <span class="token operator">+</span><span class="token string">'&lt;/div&gt;'</span><span class="token punctuation">;</span>
                            finalResult <span class="token operator">+=</span> <span class="token string">'&lt;div class="date"&gt;'</span> <span class="token operator">+</span> cur<span class="token punctuation">.</span>createtime <span class="token operator">+</span><span class="token string">'&lt;/div&gt;'</span><span class="token punctuation">;</span>
                            finalResult <span class="token operator">+=</span> <span class="token string">'&lt;div style="margin-top: 10px; text-align: center;"&gt;è®¿é—®é‡: '</span> <span class="token operator">+</span> cur<span class="token punctuation">.</span>rcount <span class="token operator">+</span> <span class="token string">'&lt;/div&gt;'</span><span class="token punctuation">;</span>
                            finalResult <span class="token operator">+=</span> <span class="token string">'&lt;div class="desc"&gt;'</span> <span class="token operator">+</span> <span class="token function">getBeginning</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            finalResult <span class="token operator">+=</span> <span class="token string">'&lt;/div&gt;'</span><span class="token punctuation">;</span>
                            finalResult <span class="token operator">+=</span> <span class="token string">'&lt;a href="blog_content.html?id='</span><span class="token operator">+</span> cur<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">'" class="detail"&gt;æŸ¥çœ‹å…¨æ–‡ &amp;gt;&amp;gt;&lt;/a&gt;'</span><span class="token punctuation">;</span>
                            finalResult <span class="token operator">+=</span> <span class="token string">'&lt;/div&gt;'</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#blogs"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>finalResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// åç«¯è¿”å›ç©ºï¼Œè¯´æ˜å‚æ•°æœ‰è¯¯</span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"å‚æ•°æœ‰è¯¯ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token comment">// è·³è½¬è‡³é¦–é¡µ</span>
                        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"blog_list.html"</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="123__1426"></a>12.3 åç«¯</h3> 
<p>è€Œåç«¯æ€ä¹ˆæ˜¾ç¤ºæ‰€éœ€è¦çš„éƒ¨åˆ†ï¼Ÿ<br> å¯ä»¥ä½¿ç”¨ <code>limit...offset...</code>è¯­å¥ï¼Œä»â€¦å¼€å§‹è¿”å›â€¦æ¡æ•°æ®ï¼ˆoffset è¡¨ç¤ºè¦è·³è¿‡çš„æ•°é‡ï¼‰ï¼Œè¿”å› <code>pageSize</code>æ¡æ•°æ®ï¼Œè¿™ä¸ªå¾ˆæ˜æ˜¾ï¼Œä¸å¤šè¯´ã€‚è€Œä»å“ªé‡Œå¼€å§‹ï¼Œè¿™ä¸ªæ˜¯æœ‰è§„å¾‹çš„ï¼Œå‡è®¾ pageSize = 5ï¼Œé‚£ä¹ˆè¦æ˜¾ç¤ºç¬¬3é¡µçš„æ•°æ®ï¼Œæ˜¾ç„¶å°±æ˜¯è·³è¿‡å‰ä¸¤é¡µçš„æ–‡ç« æ•°ï¼ˆ2 * pageSizeï¼‰ï¼Œæ¥ç€æ˜¾ç¤º 5 æ¡æ•°æ®</p> 
<p>â­æ‰€ä»¥è§„å¾‹å°±æ˜¯ <code>limit pageSize offset (pageIndex - 1) * pageSize</code></p> 
<p>ä½†æ˜¯åœ¨ MyBatis ä¸­ä¸èƒ½ç›´æ¥è¿™ä¹ˆå†™ï¼Œéœ€è¦å°†è®¡ç®—ç»“æœä¼ è¿›å…¥ã€‚å¹¶ä¸”è¿˜æœ‰ä¸ªç»†èŠ‚ï¼Œåªèƒ½æ˜¾ç¤ºå·²å‘è¡¨çš„æ–‡ç« ï¼ˆstate = 1ï¼‰</p> 
<p>ArticleMapper.xml ä¸­ï¼š<br> <img src="https://images2.imgbox.com/c2/0e/sKhmw6rq_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">åç«¯ä»£ç ï¼š</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/all"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Article</span><span class="token punctuation">&gt;</span></span> <span class="token function">getPage</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> pageIndex<span class="token punctuation">,</span> <span class="token class-name">Integer</span> pageSize<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>pageSize <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> pageIndex <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> pageIndex <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> pageSize <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// æäº¤è®¡ç®— offset</span>
        <span class="token keyword">int</span> offset <span class="token operator">=</span> <span class="token punctuation">(</span>pageIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> pageSize<span class="token punctuation">;</span>
        <span class="token keyword">return</span> articleService<span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>pageSize<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="124__1451"></a>12.4 å®ç°å‰©ä¸‹å››ä¸ªæŒ‰é’®</h3> 
<p>é¦–å…ˆå…ˆä¸ºè¿™å››ä¸ªæŒ‰é’®ï¼Œæ·»åŠ èƒ½å¤Ÿè§¦å‘ js æ–¹æ³•çš„åŠŸèƒ½<br> <img src="https://images2.imgbox.com/c6/76/ySSpGsbA_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> è¿™å››ä¸ªæŒ‰é’®å®ç°èµ·æ¥ä¹Ÿä¸éš¾ï¼š</p> 
<p>â­â… . é¦–é¡µ<br> è¿™ä¸ªå®ç°èµ·æ¥æœ€ç®€å•ï¼Œæ²¡å•¥å¥½è¯´çš„</p> 
<pre><code class="prism language-js">    <span class="token comment">// é¦–é¡µ</span>
    <span class="token keyword">function</span> <span class="token function">firstPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"blog_list.html?pageIndex=1&amp;pageSize="</span> <span class="token operator">+</span> pageSize<span class="token punctuation">;</span>  <span class="token comment">// é»˜è®¤è·³åˆ°ç¬¬ä¸€é¡µ</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>â­â…¡. ä¸Šä¸€é¡µ<br> è¿™ä¸ªä¹Ÿç®€å•ï¼Œç‰¹æ®Šåˆ¤æ–­ä»¥ä¸‹æ˜¯ä¸æ˜¯ç¬¬ä¸€é¡µï¼Œå¦‚æœæ˜¯ï¼Œé‚£å°±åˆ·æ–°ä¸€ä¸‹</p> 
<pre><code class="prism language-js">    <span class="token comment">// ä¸Šä¸€é¡µ</span>
    <span class="token keyword">function</span> <span class="token function">pageUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>pageIndex <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"blog_list.html?pageSize="</span> <span class="token operator">+</span> pageSize<span class="token punctuation">;</span> <span class="token comment">// ç›¸å½“äºåˆ·æ–°ä¸€æ¬¡</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        pageIndex <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>pageIndex<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> 
        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"blog_list.html?pageIndex="</span> <span class="token operator">+</span> pageIndex <span class="token operator">+</span> <span class="token string">"&amp;pageSize="</span> <span class="token operator">+</span> pageSize<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>â­â…¢. ä¸‹ä¸€é¡µ<br> å®ç°è¿™ä¸ªåŠŸèƒ½å°±éœ€è¦æˆ‘ä»¬çŸ¥é“æœ€åä¸€é¡µçš„é¡µç æ˜¯å¤šå°‘ï¼Œå‘åç«¯å‘é€è¯·æ±‚ï¼Œç„¶ååç«¯ç›´æ¥å°†è®¡ç®—ç»“æœè¿”å›ï¼Œå‰ç«¯ä½¿ç”¨ä¸€ä¸ªå…¨å±€å˜é‡<code>finalIndex</code>æ¥æ”¶ï¼Œå¹¶ä¸”ä¹Ÿåœ¨é¡µé¢åŠ è½½çš„æ—¶å€™å°±æ„é€ å¥½ï¼ˆçº¦å®šè·¯ç”±<code>/article/final</code>ï¼‰ã€‚æ‰€ä»¥ç›´æ¥æ”¾åœ¨ä¸Šè¿°çš„<code>init()</code>æ–¹æ³•ä¹‹åå°±å¯ä»¥äº†ï¼Œåœ¨<code>init()</code>æ„é€ å¥½é¡µé¢çš„æ—¶å€™è·å– <code>finalIndex</code></p> 
<pre><code class="prism language-java">        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è·å–æœ€åä¸€é¡µçš„é¡µç </span>
        function <span class="token function">getFinalIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                url<span class="token operator">:</span><span class="token string">"/article/final"</span><span class="token punctuation">,</span>
                type<span class="token operator">:</span><span class="token string">"GET"</span><span class="token punctuation">,</span>
                data<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token string">"pageSize"</span><span class="token operator">:</span>pageSize
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                success<span class="token operator">:</span> <span class="token function">function</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    	<span class="token comment">// èµ‹å€¼ æœ€åä¸€é¡µçš„ é¡µç </span>
                        finalIndex <span class="token operator">=</span> result<span class="token punctuation">.</span>data<span class="token punctuation">;</span> 
                        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">getFinalIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>åç«¯è¦è®¡ç®—è¿™ä¸ªå€¼ä¹Ÿéå¸¸ç®€å•ï¼Œåªéœ€è¦ç»Ÿè®¡ä¸€ä¸‹æ‰€æœ‰å·²å‘è¡¨æ–‡ç« çš„ä¸ªæ•°ï¼Œç„¶åé™¤ä»¥ <code>pageSize</code>ï¼Œå‘ä¸Šå–æ•´å³å¯ã€‚</p> 
<p>ğŸ“å‘ä¸Šå–æ•´å¯ä»¥ä½¿ç”¨<code>Math.ceil(double)</code> ï¼Œä½†æ˜¯ä¸æ¨èï¼Œå¯ä»¥ä¼šæœ‰ç²¾åº¦é—®é¢˜ï¼Œå­˜åœ¨æ½œåœ¨éšæ‚£ï¼Œå¯ä»¥ç»“åˆæ•°å­¦æ€æƒ³ï¼Œä½¿ç”¨<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ( 
        
       
         a 
        
       
         âˆ’ 
        
       
         1 
        
       
         ) 
        
       
         / 
        
       
         b 
        
       
         + 
        
       
         1 
        
       
      
        (a - 1)/b + 1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>ï¼ˆåˆ†æ¯æ˜¯ bï¼Œä¸æ˜¯ b + 1ï¼‰</p> 
<p>ä»£ç å¦‚ä¸‹</p> 
<pre><code class="prism language-java">    <span class="token comment">// è·å–æœ€åä¸€é¡µçš„é¡µç </span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/final"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getFinalPage</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> pageSize<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>pageSize <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> pageSize <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">Integer</span> total <span class="token operator">=</span> articleService<span class="token punctuation">.</span><span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–æ–‡ç« æ€»ä¸ªæ•°</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token punctuation">(</span>total <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> pageSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>æœ‰äº†æœ€åä¸€é¡µçš„é¡µç åï¼Œè¿™å°±å¥½å®ç°äº†ï¼Œç‰¹æ®Šåˆ¤æ–­ç°åœ¨æ˜¯ä¸æ˜¯æœ€åä¸€é¡µ</p> 
<pre><code class="prism language-js">    <span class="token keyword">function</span> <span class="token function">pageDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>pageIndex <span class="token operator">==</span> finalIndex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// å¦‚æœå·²ç»æ˜¯æœ€åä¸€é¡µäº†</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"å·²ç»æ˜¯æœ€åä¸€é¡µäº†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        pageIndex <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>pageIndex<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// ä¸‹ä¸€é¡µ</span>
        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"blog_list.html?pageIndex="</span> <span class="token operator">+</span> pageIndex <span class="token operator">+</span> <span class="token string">"&amp;pageSize="</span> <span class="token operator">+</span> pageSize<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>â­â…£. æœ«é¡µ<br> ç›´æ¥è·³æœ€åä¸€é¡µ</p> 
<pre><code class="prism language-js">    <span class="token comment">// æœ€åä¸€é¡µ</span>
    <span class="token keyword">function</span> <span class="token function">lastPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"blog_list.html?pageIndex="</span> <span class="token operator">+</span> finalIndex <span class="token operator">+</span> <span class="token string">"&amp;pageSize="</span> <span class="token operator">+</span> pageSize<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>å¹¶ä¸”åšå®¢ä¸»é¡µï¼Œä»¥åŠç”³è¯·è·å–æœ€åä¸€é¡µçš„è¯·æ±‚éƒ½æ˜¯éç™»å½•çŠ¶æ€ä¸‹ä¹Ÿèƒ½å®Œæˆçš„ï¼Œæ‰€ä»¥æ‹¦æˆªå™¨éœ€è¦ä¸ºè¿™ä¸¤ä¸ªæ¥å£æ”¾è¡Œï¼š</p> 
<pre><code class="prism language-java">            <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/article/all"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/article/final"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="13__1553"></a>13. å¯†ç åŠ ç›åŠ å¯†</h2> 
<p>ç”¨æˆ·æ³¨å†Œçš„æ—¶å€™ï¼Œå°†ç”¨æˆ·åå’Œå¯†ç å­˜å…¥æ•°æ®åº“çš„æ—¶å€™æ˜¯é‡‡ç”¨æ˜æ–‡å­˜å‚¨çš„ï¼Œè¿™å°±ä¼´éšç€å®‰å…¨éšæ‚£ï¼Œåæœä¸å¿…å¤šè¯´</p> 
<p>ä½¿ç”¨ä¼ ç»Ÿçš„ MD5 åŠ å¯†ï¼Œè™½ç„¶åŠ å¯†ä¹‹åæ˜¯<strong>ä¸å¯é€†çš„</strong>ï¼Œä½†æ˜¯è¿˜æœ‰ä¸ªç¼ºé™·ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²å›ºå®šä¼šè¢«è½¬åŒ–æˆä¸€ä¸ª <strong>32 ä½</strong>çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±å­˜åœ¨æš´åŠ›ç ´è§£çš„å¯èƒ½</p> 
<p>ä½†æ˜¯ä¸å¯å¦å®šçš„æ˜¯ï¼ŒMD5æ˜¯ä¸€ä¸ªä¸é”™çš„å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠ ç›ç®—æ³•æ­é… MD5 è¿›è¡ŒåŠ å¯†ï¼Œå…·ä½“ç‚¹ï¼Œç”Ÿæˆä¸€ä¸ªéšæœºä¸é‡å¤çš„ç›å€¼ï¼ˆsaltï¼‰å’ŒçœŸæ­£çš„å¯†ç è¿›è¡Œæ‹¼æ¥ï¼Œå†å¯¹è¿™ä¸ªç»“æœä½¿ç”¨ MD5 åŠ å¯†ï¼Œç„¶åå°†è¿™ä¸ªå€¼å­˜å…¥æ•°æ®åº“ä¸­ï¼Œå³ä¾¿æ•°æ®åº“è¢«ç›—ä¹Ÿä¼šå› ä¸ºç›å€¼çš„å¹²æ‰°ä»è€Œä¿æŠ¤å¯†ç </p> 
<p>â­ç”¨ä»£ç è¡¨ç¤ºæ¯”è¾ƒå¥½ç†è§£ï¼š <code>MD5(salt + password)</code>ï¼ˆä¸ºäº†æ–¹ä¾¿é™ˆè¿°ï¼Œ<font color="red">è®°è¿™ä¸ªç»“æœä¸º P</font>ï¼Œå®ƒæ˜¯é•¿åº¦32ä½çš„å­—ç¬¦ä¸²ï¼‰</p> 
<p>ä½†æ˜¯ä¸Šè¿°æ–¹æ³•è¿˜æœ‰ç‚¹é—®é¢˜ï¼Œå¦‚æœåªæ˜¯å°†<code>MD5(salt + password)</code>å­˜å…¥æ•°æ®åº“çš„è¯ï¼Œç”¨æˆ·ç™»å½•çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ— æ³•éªŒè¯å¯†ç æ˜¯å¦æ­£ç¡®ï¼Œå› ä¸ºåŠ å¯†åä¸å¯é€†ï¼Œç›å€¼ä¹Ÿæ— æ³•è·å–ã€‚æ‰€ä»¥ P è¿˜ä¸èƒ½æ˜¯æœ€ç»ˆçš„å¯†ç ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ç›å€¼æ‰èƒ½éªŒè¯ç™»å½•ï¼Œâ­æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ï¼šã€Œä»¥å†…éƒ¨æŸç§çº¦å®šå¥½çš„æ ¼å¼ã€æ¥å°†ç›å€¼å’Œ P è¿›è¡Œæ‹¼æ¥ï¼Œæ¥ä½œä¸º æœ€ç»ˆå­˜å…¥æ•°æ®åº“ä¸­çš„ç»“æœã€‚</p> 
<p>ä¾‹å¦‚ï¼šä¸ºäº†æ–¹ä¾¿æè¿°ï¼Œæˆ‘ä»¬ç§° æœ€ç»ˆå­˜å…¥æ•°æ®åº“ä¸­çš„å¯†ç ä¸ºï¼šFinal<br> å‡è®¾æˆ‘ä»¬ç”Ÿæˆçš„ç›å€¼ä¹Ÿæ˜¯ 32 ä½çš„ï¼Œâ­é‚£ä¹ˆå¯ä»¥çº¦å®šï¼šFinal = ç›å€¼ + Pï¼Œä¹Ÿå°±æ˜¯å‰é¢ 32 ä½æ˜¯ç›å€¼ï¼Œåé¢ 32 ä½æ˜¯ P</p> 
<p>è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯å¯ä»¥éªŒè¯ç”¨æˆ·ç™»å½•ï¼šå¯ä»¥æŒ‰ç…§è¿™ä¸ªè§„åˆ™è·å–åˆ° ç›å€¼ï¼Œç„¶åå°† ç›å€¼å’Œã€Œå¾…éªŒè¯çš„å¯†ç ã€è¿›è¡Œæ‹¼æ¥å MD5 åŠ å¯†ï¼ˆä¹Ÿå°±æ˜¯<code>MD5(salt + toProvePassword)</code>ï¼‰ï¼Œç„¶åæ‹¿ç€è¿™ä¸ªç»“æœå’Œ Final çš„å 32 ä½ï¼ˆå³ Pï¼‰è¿›è¡Œæ¯”è¾ƒå³å¯ã€‚ï¼ˆåŒæ ·çš„å­—ç¬¦ä¸²ï¼ŒMD5åŠ å¯†åçš„ç»“æœå®Œå…¨ä¸€è‡´ï¼Œæ‰€ä»¥é€šè¿‡åŒæ ·çš„ç›å€¼åŠ å¯†åçš„ç»“æœå¦‚æœä¸€æ ·ï¼Œä¹Ÿå°±éªŒè¯é€šè¿‡äº†ï¼‰</p> 
<p>ğŸ“ä½†æ˜¯å¦‚æœåˆ«äººçŸ¥é“äº†è§„å¾‹ï¼Œä¹Ÿå°±å¯ä»¥è·å–ç›å€¼ï¼Œå¯è¿™æ ·å¯†ç ç ´è§£çš„æˆæœ¬ä¹Ÿæ˜¯å¾ˆå¤§çš„<br> å‡è®¾åäººè·å¾—äº†ç›å€¼ï¼ŒçŸ¥é“äº†è§„åˆ™ï¼Œéœ€è¦ä» <code>MD5(salt + password)</code>ä¸­æ¥è·å–å¯†ç ï¼Œå°±éœ€è¦æ ¹æ®è¿™ä¸ªç›å€¼æ¥å•ç‹¬ç”Ÿæˆä¸€ä¸ªå½©è™¹è¡¨è¿›è¡Œç ´è§£ï¼Œå¹¶ä¸”åªèƒ½ç ´è§£ä¸€ä¸ªå¯†ç ï¼Œä¸‹ä¸€ä¸ªå¯†ç åˆè¦é‡æ–°ç”Ÿæˆå½©è™¹è¡¨ï¼Œè€Œå½©è™¹è¡¨çš„ç”Ÿæˆæ˜¯ä¸€ä¸ªè´¹æ—¶åˆè´¹åŠ›çš„äº‹ï¼Œæœ‰å¤šè´¹åŠ›ï¼Œå¯ä»¥å‚è€ƒ<a href="https://blog.csdn.net/dingxie1963/article/details/101259690?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167617873716800188533461%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=167617873716800188533461&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-3-101259690-null-null.142%5Ev73%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev1%5Econtrol&amp;utm_term=%E5%BD%A9%E8%99%B9%E8%A1%A8%20%E7%94%9F%E6%88%90&amp;spm=1018.2226.3001.4187">è¿™ç¯‡åšå®¢</a></p> 
<h3><a id="131__1572"></a>13.1 åŠ ç›åŠ å¯†</h3> 
<p>æœ‰äº†æ€è·¯ï¼Œå®ç°å°±å¯ä»¥æ‹¿æäº†<br> é¦–å…ˆï¼Œç›å€¼çš„è·å–å¯ä»¥ç”¨è¿‡<code> String salt = UUID.randomUUID().toString();</code>æ¥éšæœºè·å–ä¸€ä¸ªç›å€¼å­—ç¬¦ä¸²ï¼Œå¦‚ä¸‹<br> <img src="https://images2.imgbox.com/87/4f/1SomWCFK_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">ä½†æ˜¯è¿™ä¸ªç›å€¼æœ‰ä¸€ç‚¹ç‰¹å¾ï¼Œå°±æ˜¯ <code>'-'</code> è¿™ä¸ª å­—ç¬¦ï¼Œæ‰€ä»¥å¯ä»¥ã€Œå»æ‰è¿™ä¸ªç‰¹å¾ã€ï¼Œé€šè¿‡<code>replace("-", "")</code>ã€‚<br> è¿™æ ·å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªåˆšå¥½é•¿åº¦æ˜¯ 32 çš„æ²¡æœ‰è§„å¾‹çš„ç›å€¼ï¼Œç„¶å<code>salt + md5(salt + password)</code>ä½œä¸ºæœ€ç»ˆå¯†ç å­˜å…¥æ•°æ®åº“ï¼ˆé•¿åº¦ 64ï¼‰ã€‚</p> 
<p>MD5 åŠ å¯†çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹<br> <img src="https://images2.imgbox.com/c4/37/JkqAHuZD_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> ä»£ç å¦‚ä¸‹</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Security</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// å¯¹æ•°æ®çš„åŠ å¯†</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// æ•°æ®æ— æ•ˆ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å¾—åˆ°ç›å€¼çš„å­—ç¬¦ä¸², å¹¶ä¸”å°†å…¶ æ ¼å¼ è¿›è¡Œæ¶ˆé™¤, æœ€ç»ˆ salt.length = 32</span>
        <span class="token class-name">String</span> salt <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// salt + password è¿›è¡ŒåŠ å¯†å å°±å¯ä»¥å¾—åˆ° ã€Œä¸´æ—¶çš„æœ€ç»ˆå¯†ç ã€</span>
        <span class="token comment">// ä½†æ˜¯ä¸ºäº†éªŒè¯, æˆ‘ä»¬éœ€è¦çŸ¥é“ç›å€¼, äºæ˜¯å°†ç›å€¼ å’Œ ä¸Šè€… æŒ‰ç…§æŸç§è§„åˆ™è¿›è¡Œæ‹¼æ¥,</span>
        <span class="token class-name">String</span> finalPassword <span class="token operator">=</span> salt <span class="token operator">+</span> <span class="token class-name">DigestUtils</span><span class="token punctuation">.</span><span class="token function">md5DigestAsHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>salt <span class="token operator">+</span> password<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> finalPassword<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="132__1602"></a>13.2 éªŒè¯</h3> 
<p>ç”¨æˆ·å°†å¯†ç ä¼ å…¥ï¼Œæˆ‘ä»¬è·å–è¯¥ç”¨æˆ·å¯†ç å¯¹åº”çš„å¯†æ–‡ï¼Œç„¶åé€šè¿‡è‡ªå®šä¹‰çš„è§„åˆ™ï¼ˆæ­¤å¤„æ˜¯å‰32ä½æ˜¯ç›å€¼ï¼‰è·å–å¯†æ–‡ä¸­çš„ç›å€¼ï¼Œç„¶åæŒ‰åŒæ ·çš„åŠ å¯†è§„åˆ™å°†ã€Œsalt + å¾…éªŒè¯å¯†ç ã€è¿›è¡Œ md5 åŠ å¯†ï¼Œåˆ¤æ–­å’Œå¯†æ–‡ä¸­å 32 ä½æ˜¯å¦ä¸€è‡´å³å¯éªŒè¯ï¼Œä»£ç å¦‚ä¸‹</p> 
<pre><code class="prism language-java">    <span class="token comment">/**
     * éªŒè¯ å¯†ç  æ˜¯å¦æ­£ç¡®
     * @param toProvePassword ç­‰å¾…éªŒè¯çš„å¯†ç 
     * @param finalPassword æ•°æ®åº“ä¸­çš„å¯†ç ï¼ˆå¯†æ–‡ï¼‰
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">prove</span><span class="token punctuation">(</span><span class="token class-name">String</span> toProvePassword<span class="token punctuation">,</span> <span class="token class-name">String</span> finalPassword<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>toProvePassword<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>finalPassword<span class="token punctuation">)</span>
                <span class="token operator">||</span> finalPassword<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// è·å–ç›å€¼</span>
        <span class="token class-name">String</span> salt <span class="token operator">=</span> finalPassword<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æŒ‰ç…§åŒæ ·çš„è§„å¾‹</span>
        toProvePassword <span class="token operator">=</span> salt <span class="token operator">+</span> <span class="token class-name">DigestUtils</span><span class="token punctuation">.</span><span class="token function">md5DigestAsHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>salt <span class="token operator">+</span> toProvePassword<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> toProvePassword<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>finalPassword<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å›æ˜¯å¦ä¸€è‡´</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="133__1624"></a>13.3 æ›´æ–°</h3> 
<p>ç„¶åæŠŠæ³¨å†Œçš„é€»è¾‘å’Œç™»å½•çš„é€»è¾‘æ›´æ–°ä¸€ä¸‹ï¼š</p> 
<p>æ³¨å†Œé€»è¾‘æ›´æ–°ï¼š</p> 
<pre><code class="prism language-java">        <span class="token comment">// æ–°å¢ï¼ˆæ³¨å†Œï¼‰ä¸€ä¸ªç”¨æˆ·</span>
        <span class="token class-name">String</span> finalPassword <span class="token operator">=</span> <span class="token class-name">Security</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> finalPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>ç™»å½•é€»è¾‘æ›´æ–°ï¼š</p> 
<pre><code class="prism language-java">        <span class="token comment">// è·å–è¯¥ç”¨æˆ·åœ¨æ•°æ®åº“ä¸­çš„ä¿¡æ¯</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">selectByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// è·å–æ•°æ®åº“ä¸­çš„å¯†æ–‡</span>
        <span class="token class-name">String</span> finalPassword <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> isCorrect <span class="token operator">=</span> <span class="token class-name">Security</span><span class="token punctuation">.</span><span class="token function">prove</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> finalPassword<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// password æ˜¯ç”¨æˆ·è¾“å…¥çš„å¯†ç </span>
</code></pre> 
<h2><a id="14_Session__1647"></a>14. Session æŒä¹…åŒ–</h2> 
<p>ç›®å‰ä¼šè¯æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œé‡å¯æœåŠ¡å™¨æˆ–è€…æœåŠ¡å™¨æ–­ç”µä¹‹åä¼šè¯å°±æ— äº†ï¼Œä¸ºäº†æé«˜ç”¨æˆ·çš„ä½“éªŒï¼Œå¯ä»¥å°† Session è¿›è¡ŒæŒä¹…åŒ–å­˜å‚¨ï¼Œå­˜äº MySQL ä¹Ÿè¡Œï¼Œä½†æ˜¯ä¸å¦‚å­˜åœ¨ Redis ä¸­ã€‚</p> 
<p>æ³¨æ„ï¼šè¿™é‡Œæ¶‰åŠåˆ°äº†äº‘æœåŠ¡ä¸Š Redis çš„å®‰è£…ä»¥åŠè¿œç¨‹è¿æ¥çš„é—®é¢˜ï¼Œéœ€è¦è‡ªè¡Œé…ç½® Redis ä»¥åŠå¼€æ”¾ç«¯å£ã€‚</p> 
<p>ä¼šè¯æ˜¯ä¸€ä¸ªå¾ˆå¸¸ç”¨çš„åŠŸèƒ½ï¼Œæ‰€ä»¥åœ¨ SpringBoot é¡¹ç›®ä¸­ï¼Œåªè¦æ­£ç¡®å¯¼å…¥ä¾èµ–å’Œé…ç½® Redis äº†ï¼Œå…¶ä»–ä»£ç åŸºæœ¬æ²¡å˜ï¼Œåªéœ€è¦åŠ ä¸€ä¸ªå°æ”¹åŠ¨ï¼Œåœ¨å­˜ Session çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨æŒä¹…åŒ–åˆ° Redis ä¸­</p> 
<p>é¦–å…ˆè¿™ä¸ªç©æ„æ˜¯è‚¯å®šè¦å¯¼å…¥çš„<br> <img src="https://images2.imgbox.com/30/3b/tyVEbDKV_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> ç„¶åæœ‰ä¸¤ä¸ªä¾èµ–ä¸èƒ½å°‘ï¼ˆä¸»è¦æ˜¯çœ‹ç¬¬äºŒä¸ªä¾èµ–æœ‰æ²¡æœ‰å°‘ï¼‰ï¼š</p> 
<pre><code class="prism language-xml">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.session<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-session-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>æœ€åå°±æ˜¯é…ç½® è¿œç¨‹è¿æ¥äº‘æœåŠ¡å™¨ä¸Šçš„ Redis ç›¸å…³ä¿¡æ¯ï¼Œä»£ç å¦‚ä¸‹ï¼ŒğŸ“å¹¶ä¸”æ˜¯ yml æ ¼å¼çš„é…ç½®æ–‡ä»¶</p> 
<pre><code class="prism language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span>3306/name<span class="token punctuation">?</span>characterEncoding=utf8
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver

  <span class="token comment"># é…ç½® Redis å¡«å†™è‡ªå·±ç›¸å…³çš„ä¿¡æ¯ --</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> IP
    <span class="token key atrule">post</span><span class="token punctuation">:</span> ç«¯å£
    <span class="token key atrule">password</span><span class="token punctuation">:</span> å¯†ç 
  <span class="token key atrule">session</span><span class="token punctuation">:</span>
    <span class="token key atrule">store-type</span><span class="token punctuation">:</span> redis
    <span class="token key atrule">redis</span><span class="token punctuation">:</span>
      <span class="token key atrule">flush-mode</span><span class="token punctuation">:</span> on_save
      <span class="token key atrule">namespace</span><span class="token punctuation">:</span> spring<span class="token punctuation">:</span>session

<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">servlet</span><span class="token punctuation">:</span>
    <span class="token key atrule">session</span><span class="token punctuation">:</span>
      <span class="token key atrule">timeout</span><span class="token punctuation">:</span> <span class="token number">1800</span>
  <span class="token comment"># é…ç½® Redis --</span>
</code></pre> 
<p>ç”±äºæ˜¯å°†ç”¨æˆ·æ•°æ®å­˜å…¥åˆ° Redisï¼Œæ¶‰åŠåˆ°äº†å¯¹è±¡çš„ç½‘ç»œä¼ è¾“ï¼Œæ‰€ä»¥éœ€è¦å¯¹è±¡éœ€è¦å®ç°åºåˆ—åŒ–æ¥å£</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// java.io åŒ…ä¸­çš„åºåˆ—åŒ–æ¥å£</span>
</code></pre> 
<p>è‡³æ­¤å°±å®Œæˆäº† Session æŒä¹…åŒ–ï¼Œå¦‚ä¸‹ï¼Œåœ¨ç™»å½•ä¸€æ¬¡åï¼Œé‡å¯æœåŠ¡å™¨ï¼Œè¿˜æ˜¯å­˜åœ¨ç›¸å…³çš„ä¼šè¯ï¼š<br> <img src="https://images2.imgbox.com/94/99/VS5WIikc_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="15__1704"></a>15. å®ç°å®šæ—¶å‘å¸ƒåŠŸèƒ½</h2> 
<p>è¿™ä¸ªåŠŸèƒ½å®ç°èµ·æ¥æ¯”è¾ƒå¤æ‚</p> 
<h3><a id="151__1706"></a>15.1 é€»è¾‘</h3> 
<p>åœ¨é¡¹ç›®å¯åŠ¨çš„åŒæ—¶å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸ªçº¿ç¨‹ä¸“é—¨è´Ÿè´£æ‰«ææ˜¯å¦å­˜åœ¨å¯ä»¥å‘å¸ƒçš„æ–‡ç« </p> 
<p>â… . åˆ›å»ºä¸€ä¸ªå­˜å‚¨å®šæ—¶æ–‡ç« çš„æ•°æ®åº“è¡¨æ ¼ï¼Œå¹¶ä¸”é¢„æœŸï¼šè¯¥è¡¨ä¸­çš„æ–‡ç« ç†è®ºä¸Šåº”è¯¥éƒ½æ˜¯è¿˜æ²¡æœ‰å‘å¸ƒçš„ï¼Œå¹¶ä¸”å‘å¸ƒåçš„æ–‡ç« ï¼Œå°±éœ€è¦ä»è¿™ä¸ªè¡¨ä¸­åˆ é™¤ã€‚ä½†æ˜¯ä¸ºäº†æ•°æ®å®‰å…¨æ€§å’Œæ•ˆç‡ç€æƒ³ï¼Œä½¿ç”¨ä¼ªåˆ é™¤çš„æ–¹å¼ï¼šå…¶ä¸­å®šä¹‰ä¸€ä¸ªå­—æ®µ<code>isdel</code>ï¼Œ0 è¡¨ç¤ºæ²¡åˆ é™¤ï¼Œ1 è¡¨ç¤ºå·²ç»åˆ é™¤<br> â…¡. è¿™ä¸ªçº¿ç¨‹åœ¨ä¸€å¼€å§‹ï¼Œå°±æ‰«æè¿™ä¸ªè¡¨æ ¼ä¸­æ‰€æœ‰è¿˜æ²¡æœ‰å‘å¸ƒçš„æ–‡ç« ï¼ˆid = 0ï¼‰ï¼Œå¹¶ä¸”å­˜å…¥å †ä¸­ï¼ˆè¿™ä¸ªæ­¥éª¤åªæœ‰åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™æ‰§è¡Œä¸€æ¬¡ï¼‰<br> â…¢. å †æ˜¯ä¸€ä¸ªå°æ ¹å †ï¼ŒæŒ‰ç…§æ–‡ç« çš„å‘å¸ƒæ—¶é—´çš„ [ æ—¶é—´æˆ³ ] è¿›è¡Œæ’åº<br> â…£. æ¯éš”ä¸€æ®µæ—¶é—´ï¼Œå°±å¯¹è¿™ä¸ªå †è¿›è¡Œæ‰«æï¼Œå¦‚æœå †é¡¶å…ƒç´ çš„æ—¶é—´æˆ³æ¯”å½“å‰æ—¶é—´æˆ³è¦å¤§ï¼Œé‚£å°±è¿˜ä¸éœ€è¦å‘å¸ƒï¼›å¦‚æœå †é¡¶å…ƒç´ çš„æ—¶é—´æˆ³æ¯”å½“å‰æ—¶é—´æˆ³å°ï¼Œé‚£å°±å‘å¸ƒè¯¥æ–‡ç« ï¼Œç„¶åå°†å®šæ—¶ä»»åŠ¡è¡¨ä¸­çš„æ–‡ç« åˆ é™¤ï¼ˆä¼ªåˆ é™¤ï¼‰<br> â…¤. åç«¯æä¾›ä¸€ä¸ªæ¥å£ï¼Œæ¥ä¸ºæœåŠ¡å™¨è¿è¡Œè¿‡ç¨‹ä¸­æä¾›æ·»åŠ å®šæ—¶ä»»åŠ¡çš„æœåŠ¡<br> â…¥. è€Œåç»­æœåŠ¡å™¨è¿è¡Œè¿‡ç¨‹ä¸­æ‰€åŠ å…¥çš„å®šæ—¶ä»»åŠ¡ï¼Œä¸ä»…è¦å†™å…¥åˆ°å®šæ—¶ä»»åŠ¡è¡¨ä¸­ï¼Œè¿˜è¦å†åŠ å…¥åˆ°å†…å­˜ä¸­çš„å †å³å¯</p> 
<h3><a id="152__1715"></a>15.2 å»ºè¡¨</h3> 
<pre><code class="prism language-java">drop table <span class="token keyword">if</span> exists scheduledtasks<span class="token punctuation">;</span>
create table <span class="token function">scheduledtasks</span><span class="token punctuation">(</span>
    id <span class="token keyword">int</span> primary key auto_increment<span class="token punctuation">,</span>
    title <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> not <span class="token keyword">null</span><span class="token punctuation">,</span>
    content text not <span class="token keyword">null</span><span class="token punctuation">,</span>
    publishtime datetime <span class="token keyword">default</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    uid <span class="token keyword">int</span> not <span class="token keyword">null</span><span class="token punctuation">,</span>
    isdel <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span> 
<span class="token punctuation">)</span><span class="token keyword">default</span> charset 'utf8mb4'<span class="token punctuation">;</span>
</code></pre> 
<p>æœ‰äº†è¿™ä¸ªè¡¨ï¼Œè¿˜éœ€è¦å†åˆ›å»ºä¸€ä¸ªç›¸åº”çš„ Java å®ä½“ç±»</p> 
<pre><code class="prism language-java"><span class="token comment">// å®šæ—¶æ–‡ç«  å®ä½“ç±»</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScheduledTask</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> uid<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> publishtime<span class="token punctuation">;</span>  <span class="token comment">// æ–‡ç« å®šæ—¶å‘è¡¨æ—¶é—´</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> isdel<span class="token punctuation">;</span>           <span class="token comment">// è¡¨ç¤ºæ˜¯å¦è¢«åˆ é™¤ï¼Œå±æ€§åå’Œæ•°æ®åº“å­—æ®µåä¿æŒä¸€è‡´</span>

    <span class="token keyword">public</span> <span class="token class-name">ScheduledTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">ScheduledTask</span><span class="token punctuation">(</span><span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">String</span> content<span class="token punctuation">,</span> <span class="token keyword">int</span> uid<span class="token punctuation">,</span> <span class="token class-name">String</span> publishtime<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> content<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>uid <span class="token operator">=</span> uid<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>publishtime <span class="token operator">=</span> publishtime<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="153__1752"></a>15.3 åç«¯å®ç°</h3> 
<h4><a id="1531__1753"></a>15.3.1 æ—¶é—´æˆ³é—®é¢˜</h4> 
<p>é¦–å…ˆçº¦å®šä¸€ä¸ªå‘å¸ƒæ—¶é—´çš„æ ¼å¼ï¼šyyyy-MM-dd HH:mm:ss</p> 
<p>ç„¶åéœ€è¦å°†è¿™ä¸ªæ ¼å¼çš„æ•°æ®è½¬åŒ–æˆæ—¶é—´æˆ³ï¼Œåœ¨ Java ä¸­çš„å®ç°æ–¹å¼å¦‚ä¸‹ï¼ˆå‚è€ƒåšå®¢<a href="https://blog.csdn.net/qq_44712984/article/details/124450120?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167592840116782429781356%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=167592840116782429781356&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-2-124450120-null-null.142%5Ev73%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev1%5Econtrol&amp;utm_term=Java%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E6%88%B3%E3%80%81&amp;spm=1018.2226.3001.4187">Java æ—¥æœŸå’Œæ—¶é—´æˆ³äº’è½¬</a>ï¼‰</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tool</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Long</span> <span class="token function">dateToStamp</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ParseException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> res<span class="token punctuation">;</span>
        <span class="token class-name">SimpleDateFormat</span> simpleDateFormat <span class="token operator">=</span>   <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span>  <span class="token string">"yyyy-MM-dd HH:mm:ss"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Date</span> date <span class="token operator">=</span> simpleDateFormat<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> ts <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ts<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="1532__1769"></a>15.3.2 æ„é€ æ–¹æ³•ä¸å°æ ¹å †</h4> 
<p>åˆšåˆšåœ¨å®ç°é€»è¾‘è¯´åˆ°åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£è¿™ä¸ªæ—¶æœºå¯ä»¥æ˜¯ï¼šä¸€ä¸ªç±»çš„æ„é€ æ–¹æ³•ä¸­</p> 
<p>åˆ›å»ºä¸€ä¸ªç±»<code>ScheduledTaskController</code>ï¼Œè¿™ä¸ªç±»è´Ÿè´£å®šæ—¶å‘å¸ƒæ–‡ç« çš„ä¸šåŠ¡ã€‚å¹¶ä¸”åŠ ä¸Š<code>@RestController</code> æ³¨è§£ï¼Œè®© Spring å¯åŠ¨çš„æ—¶å€™ä¹ŸåŠ è½½è¿™ä¸ªç±»ï¼Œç„¶ååœ¨æ„é€ æ–¹æ³•ä¸­å¯åŠ¨çº¿ç¨‹å³å¯ã€‚</p> 
<p>åœ¨è¿™ä¸ªçº¿ç¨‹ä¸­ï¼Œéœ€è¦å¯¹ [ åˆ°è¾¾æŒ‡å®šæ—¶é—´ç‚¹ ] çš„æ–‡ç« è¿›è¡Œå‘å¸ƒ å’Œ [ ä¼ªåˆ é™¤ ] å®šæ—¶æ–‡ç« ï¼Œæ‰€ä»¥åœ¨æ„é€ æ–¹æ³•ä¸­éœ€è¦ <code>articleService</code> å’Œ <code>scheduledTaskService</code> è¿™ä¸¤ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ç”±äºæ³¨å…¥æ—¶æœºçš„é—®é¢˜ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡éœ€è¦ä½¿ç”¨æ„é€ æ–¹æ³•æ³¨å…¥ï¼Œä¸å»ºè®®ä½¿ç”¨å±æ€§æ³¨å…¥</p> 
<p>å°æ ¹å †æŒ‰ç…§æ—¶é—´æˆ³è¿›è¡Œæ„é€ ï¼Œæ„é€ æ–¹æ³•å‰éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">ScheduledTaskController</span><span class="token punctuation">(</span><span class="token class-name">ScheduledTaskService</span> scheduledTaskService<span class="token punctuation">,</span> <span class="token class-name">ArticleService</span> articleService<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// æ³¨å…¥</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scheduledTaskService <span class="token operator">=</span> scheduledTaskService<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>articleService <span class="token operator">=</span> articleService<span class="token punctuation">;</span> 
        <span class="token comment">// åˆ›å»ºä¸€ä¸ª å°æ ¹å †</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>heap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ScheduledTask</span> x<span class="token punctuation">,</span> <span class="token class-name">ScheduledTask</span> y<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>  
                <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token class-name">Tool</span><span class="token punctuation">.</span><span class="token function">dateToStamp</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">getPublishtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token class-name">Tool</span><span class="token punctuation">.</span><span class="token function">dateToStamp</span><span class="token punctuation">(</span>y<span class="token punctuation">.</span><span class="token function">getPublishtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="1533__1793"></a>15.3.3 å¯åŠ¨çº¿ç¨‹</h4> 
<p>çº¿ç¨‹å¯åŠ¨åï¼Œå…ˆå°†æ‰€æœ‰è¿˜æ²¡å‘å¸ƒçš„æ–‡ç« è½½å…¥åˆ°å†…å­˜ä¸­ï¼ˆè¿™ä¸ªè¡Œä¸ºåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼‰ï¼Œç„¶åå¼€å§‹è¿›å…¥æ­»å¾ªç¯ï¼Œæ¯ä¸€æ¬¡å¾ªç¯éƒ½è¦åˆ¤æ–­æ˜¯å¦æœ‰å¯ä»¥å‘å¸ƒçš„ä»»åŠ¡ï¼Œç„¶åç¡çœ ä¸€æ®µæ—¶é—´ï¼ˆè¿™é‡Œè®¾å®šä¸º 30 sä¸€è½®ï¼‰</p> 
<p>â­è¿˜éœ€è¦æ³¨æ„ï¼Œè¿™ä¸ªçº¿ç¨‹ä¼šæŒç»­åˆ¤æ–­å®šæ—¶ä»»åŠ¡çš„å‘å¸ƒï¼Œæ‰€ä»¥ä¼šæŒç»­æ‰«æå †çš„çŠ¶æ€ï¼Œå¹¶ä¸”å¯èƒ½å°†å †ä¸­çš„å…ƒç´ å¼¹å‡ºã€‚è€Œå®ç°é€»è¾‘å¤„è¯´åˆ°ï¼šè¿˜éœ€è¦ä¸ºå‰ç«¯æä¾›ä¸€ä¸ªæ¥å£æä¾›åç»­çš„å®šæ—¶æ–‡ç« å‘å¸ƒæœåŠ¡ï¼Œè¦å¾€ å®šæ—¶ä»»åŠ¡è¡¨ ä¸­ä»¥åŠ å †ä¸­æ·»åŠ å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯å¯èƒ½å­˜åœ¨ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œ heapï¼Œè¿™å°±æ¶‰åŠåˆ°äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦åœ¨åˆé€‚çš„åœ°æ–¹åŠ é”ï¼Œé”å¯¹è±¡åœ¨å¸¸é‡æ± ä¸­åˆ›å»ºä¸€ä¸ª Object å¯¹è±¡å°±è¡Œ</p> 
<p>ç´§æ¥ä¸Šè¿°ä»£ç ï¼Œåç»­å¯åŠ¨çº¿ç¨‹çš„ä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-java">
        <span class="token comment">// å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token annotation punctuation">@SneakyThrows</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// åˆå§‹åŒ– å°æ ¹å †</span>
                <span class="token comment">// è¯»å–å‡ºæ‰€æœ‰çš„ æœªå‘è¡¨æ–‡ç« ï¼Œå¹¶è½½å…¥</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ScheduledTask</span><span class="token punctuation">&gt;</span></span> scheduledTasks <span class="token operator">=</span> scheduledTaskService<span class="token punctuation">.</span><span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ScheduledTask</span> task <span class="token operator">:</span> scheduledTasks<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    heap<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// ç„¶åå¼€å§‹å¾ªç¯åˆ¤æ–­æ˜¯å¦æœ‰ç¬¦åˆæ¡ä»¶çš„</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// è·å–å½“å‰æ—¶é—´æˆ³</span>
                    <span class="token keyword">long</span> curMills <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>heap<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token class-name">ScheduledTask</span> task <span class="token punctuation">;</span>
                        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span>scheduledLock<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            task <span class="token operator">=</span> heap<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>

                        <span class="token comment">// è·å–å †é¡¶ä»»åŠ¡çš„ æ—¶é—´æˆ³</span>
                        <span class="token keyword">long</span> taskMills <span class="token operator">=</span> <span class="token class-name">Tool</span><span class="token punctuation">.</span><span class="token function">dateToStamp</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span><span class="token function">getPublishtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>curMills <span class="token operator">&lt;</span> taskMills<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// è¿˜æ—©ï¼Œä¸èƒ½å‘</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// å¯ä»¥å‘</span>
                            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span>scheduledLock<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                                heap<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¼¹å‡ºè¿™ä¸ªä»»åŠ¡</span>
                            <span class="token punctuation">}</span>
                            <span class="token comment">// å°†è¿™ä¸ªæ–‡ç« å‘è¡¨å‡ºå»ï¼Œç„¶åä½¿ç”¨ä¼ªåˆ é™¤çš„æ–¹å¼ åˆ é™¤ å®šæ—¶ä»»åŠ¡è¡¨ ä¸­çš„è®°å½•</span>
                            articleService<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span><span class="token function">getUid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> task<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸå‘å¸ƒæ–‡ç« "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token comment">// ä¼ªåˆ é™¤</span>
                            scheduledTaskService<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¼ªåˆ é™¤æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// ç¡çœ  30 ç§’</span>
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¿›å…¥ç¡çœ "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="1534__1848"></a>15.3.4 è¿è¡Œè¿‡ç¨‹ä¸­æ·»åŠ å®šæ—¶å‘å¸ƒçš„æ–‡ç« </h4> 
<p>çº¦å®šä¸€ä¸ªè·¯ç”±<code>/schedule/add</code> ï¼Œå‰ç«¯éœ€è¦å‘é€æŒ‡å®šæ ¼å¼çš„æ—¶é—´æ—¥æœŸ yyyy-MM-dd HH:mm:ssï¼Œç„¶åæ„é€ æˆä¸€ä¸ª <code>ScheduledTask</code> å¯¹è±¡ï¼ŒåŠ å…¥æ•°æ®åº“ä¸­ï¼ŒåŠ å…¥å†…å­˜å †ä¸­ã€‚</p> 
<p>è¿™é‡Œè¿˜æœ‰ä¸ªç»†èŠ‚ï¼šåœ¨æ—¶é—´åˆ°äº†ä¹‹åå‘å¸ƒçš„æ–‡ç« ï¼Œéœ€è¦åœ¨ å®šæ—¶æ–‡ç« è¡¨ ä¸­è¿›è¡Œä¼ªåˆ é™¤ï¼Œè€Œä¼ªåˆ é™¤éœ€è¦çŸ¥é“æ–‡ç« çš„ idã€‚å› æ­¤è¿™é‡ŒåŠ å…¥åˆ°å†…å­˜å †ä¸­ä¹‹å‰ï¼Œå°±éœ€è¦ä¸º <code>ScheduledTask</code> å¯¹è±¡æå‰è®¾å®šå¥½ idã€‚</p> 
<p>è¿™é‡Œå¯ä»¥åœ¨æ’å…¥åˆ°å®šæ—¶ä»»åŠ¡è¡¨çš„æ—¶å€™è®¾ç½®è‡ªå¢ä¸»é”®çš„è·å–ï¼Œå¯ä»¥å®ç°åœ¨æ’å…¥è¡¨ä¸­ä¹‹åï¼Œè¿™ä¸ªå¯¹è±¡çš„ ID å°±ä¼šè¢«è‡ªåŠ¨èµ‹å€¼ã€‚xml æ–‡ä»¶ä¸­çš„æ’å…¥ä»£ç ä»¥åŠ Controller ä»£ç å¦‚ä¸‹</p> 
<p><img src="https://images2.imgbox.com/37/2c/LRZQEbfT_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<pre><code class="prism language-java">    <span class="token comment">// å¾€æ•°æ®åº“ä¸­æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼Œç„¶åå†å¾€å†…å­˜ä¸­çš„å †æ·»åŠ å…ƒç´ </span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/add"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">String</span> content<span class="token punctuation">,</span> <span class="token class-name">String</span> publishTime<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token class-name">SessionUtil</span><span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// æ„é€ ä¸€ä¸ªå®šæ—¶ä»»åŠ¡</span>
        <span class="token class-name">ScheduledTask</span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ScheduledTask</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> content<span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> publishTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å…ˆå­˜å…¥æ•°æ®åº“ä¸­, åŒæ—¶ä¼šè®¾ç½® è‡ªå¢ä¸»é”®</span>
        scheduledTaskService<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ç„¶åå†å­˜å…¥å †ä¸­</span>
        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span>scheduledLock<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>heap<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸæ·»åŠ ä¸€ä¸ªä»»åŠ¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="1535__1879"></a>15.3.5 å‰ç«¯éƒ¨åˆ†</h4> 
<p>ç„¶ååç«¯ä»£ç å°±å®Œæˆäº†ï¼Œç„¶åæ˜¯å‰ç«¯ä»£ç <br> <img src="https://images2.imgbox.com/43/c5/loKxHkoN_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å½“ç‚¹å‡»è¿™ä¸ªæŒ‰é’®çš„æ—¶å€™ï¼Œè§¦å‘ schedule æ–¹æ³•ï¼Œ ç„¶åé€šè¿‡ä»¥ä¸‹æ–¹æ³•è§¦å‘ä¸€ä¸ªå¼¹çª—ï¼Œç„¶åè®©ç”¨æˆ·è¾“å…¥æ—¶é—´</p> 
<pre><code class="prism language-js">    <span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token function">prompt</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥æ—¥æœŸ"</span><span class="token punctuation">,</span> <span class="token string">"è¯·æŒ‰æŒ‡å®šæ ¼å¼å¡«å†™æ—¥æœŸ yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>å¹¶ä¸”è¦éªŒè¯ä¸€ä¸‹æ˜¯ä¸æ˜¯æŒ‡å®šæ ¼å¼çš„æ—¥æœŸï¼Œå¯ä»¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åˆ¤æ–­</p> 
<pre><code class="prism language-js">        <span class="token comment">// éªŒè¯ä¸€ä¸‹æ ¼å¼æ˜¯å¦æ­£ç¡®</span>
        <span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^((\d{2}(([02468][048])|([13579][26]))[\-\/\s]?((((0?[13578])|(1[02]))[\-\/\s]?((0?[1-9])|([1-2][0-9])|(3[01])))|(((0?[469])|(11))[\-\/\s]?((0?[1-9])|([1-2][0-9])|(30)))|(0?2[\-\/\s]?((0?[1-9])|([1-2][0-9])))))|(\d{2}(([02468][1235679])|([13579][01345789]))[\-\/\s]?((((0?[13578])|(1[02]))[\-\/\s]?((0?[1-9])|([1-2][0-9])|(3[01])))|(((0?[469])|(11))[\-\/\s]?((0?[1-9])|([1-2][0-9])|(30)))|(0?2[\-\/\s]?((0?[1-9])|(1[0-9])|(2[0-8]))))))(\s((([0-1][0-9])|(2?[0-3]))\:([0-5]?[0-9])((\s)|(\:([0-5]?[0-9])))))?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
        <span class="token comment">// éªŒè¯æ˜¯å¦æ˜¯æŒ‡å®šæ ¼å¼çš„æ—¥æœŸ</span>
        <span class="token keyword">var</span> flg <span class="token operator">=</span> reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ—¥å¿—ä¸å¤åˆè§„èŒƒ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>flg <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ—¥æœŸæ ¼å¼æœ‰è¯¯ï¼Œè¯·é‡æ–°å¡«å†™"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p>æœ‰äº†è¿™ä¸ªæ ¼å¼çš„æ—¥æœŸä¹‹åï¼Œå°±å¯ä»¥å°†è¿™ä¸ªæ—¶é—´ä½œä¸ºå‚æ•°æ„é€ å‡º Date å¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡çš„ <code>getTime()</code>è·å–æ—¶é—´æˆ³ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ <code>toLocaleString()</code> æ¥è·å– yyyy/MM/dd HH:mm:ss çš„æ—¥æœŸã€‚è¿™ä¸ªæ ¼å¼çš„æ—¥æœŸå†é€šè¿‡å­—ç¬¦ä¸²æ›¿æ¢ï¼Œå°† / æ›¿æ¢æˆ - å°±è¡Œäº†</p> 
<p>è¿™é‡Œå¯ä»¥è¦æ±‚ç”¨æˆ·çš„æ–‡ç« è‡³å°‘åœ¨å½“å‰æ—¶é—´ + 5 åˆ†é’Ÿåå‘è¡¨ï¼Œè¯¦ç»†è§å‰ç«¯ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-js">  <span class="token comment">// å®šæ—¶å‘å¸ƒåŠŸèƒ½</span>
    <span class="token keyword">function</span> <span class="token function">schedule</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// éªŒè¯æ•°æ®çš„æœ‰æ•ˆæ€§</span>
        <span class="token keyword">var</span> title <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">"#title"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> content <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>title<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> title<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ ‡é¢˜ä¸èƒ½ä¸ºç©º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>content <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> content<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ–‡ç« å†…å®¹ä¸èƒ½å°‘äº100å­—"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment">// å¼€å§‹å®šæ—¶å‘å¸ƒçš„æµç¨‹</span>
        <span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token function">prompt</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥æ‚¨çš„åå­—"</span><span class="token punctuation">,</span> <span class="token string">"è¯·æŒ‰æŒ‡å®šæ ¼å¼å¡«å†™æ—¥æœŸ yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// éªŒè¯ä¸€ä¸‹æ ¼å¼æ˜¯å¦æ­£ç¡®</span>
        <span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^((\d{2}(([02468][048])|([13579][26]))[\-\/\s]?((((0?[13578])|(1[02]))[\-\/\s]?((0?[1-9])|([1-2][0-9])|(3[01])))|(((0?[469])|(11))[\-\/\s]?((0?[1-9])|([1-2][0-9])|(30)))|(0?2[\-\/\s]?((0?[1-9])|([1-2][0-9])))))|(\d{2}(([02468][1235679])|([13579][01345789]))[\-\/\s]?((((0?[13578])|(1[02]))[\-\/\s]?((0?[1-9])|([1-2][0-9])|(3[01])))|(((0?[469])|(11))[\-\/\s]?((0?[1-9])|([1-2][0-9])|(30)))|(0?2[\-\/\s]?((0?[1-9])|(1[0-9])|(2[0-8]))))))(\s((([0-1][0-9])|(2?[0-3]))\:([0-5]?[0-9])((\s)|(\:([0-5]?[0-9])))))?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
        <span class="token comment">// éªŒè¯æ˜¯å¦æ˜¯æŒ‡å®šæ ¼å¼çš„æ—¥æœŸ</span>
        <span class="token keyword">var</span> flg <span class="token operator">=</span> reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ—¥å¿—ä¸å¤åˆè§„èŒƒ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>flg <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æ—¥æœŸæ ¼å¼æœ‰è¯¯ï¼Œè¯·é‡æ–°å¡«å†™"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">var</span> curTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åŠ ä¸Š 4 åˆ†é’Ÿï¼Œåçš„ dateTime </span>
        curTime<span class="token punctuation">.</span><span class="token function">setMinutes</span><span class="token punctuation">(</span>curTime<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token comment">// å‘å¸ƒæ—¶é—´ çš„ DateTime</span>
        <span class="token keyword">var</span> publishTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¯¥ else è¯­å¥ç”¨äºæµ‹è¯•, æäº¤æˆåŠŸï¼Œé‚£ä¹ˆå±•ç¤ºä¸€ä¸‹æ—¶é—´</span>
        <span class="token comment">// å…·ä½“çš„ ç›®æ ‡ å‘é€æ—¥æœŸ+æ—¶é—´</span>
        <span class="token keyword">var</span> tar <span class="token operator">=</span> publishTime<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tar <span class="token operator">=</span> tar<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æ›¿æ¢æˆæŒ‡å®šæ ¼å¼</span>
        tar <span class="token operator">=</span> tar<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tar<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è·å–ä¸¤ä¸ªæ—¶é—´æ®µçš„æ—¶é—´æˆ³</span>
        <span class="token keyword">var</span> curMills <span class="token operator">=</span> curTime<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> publishMills <span class="token operator">=</span> publishTime<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>curMills <span class="token operator">&gt;=</span> publishMills<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"å‘å¸ƒæ—¶é—´è‡³å°‘åœ¨ 5 åˆ†é’Ÿåå‘å¸ƒ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        
        <span class="token comment">// å¦åˆ™æˆåŠŸå‘å¸ƒ</span>
        jQuery<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">"/schedule/add"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">"POST"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string-property property">"title"</span><span class="token operator">:</span>title<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string-property property">"content"</span><span class="token operator">:</span>content<span class="token punctuation">,</span>
                <span class="token string-property property">"publishTime"</span><span class="token operator">:</span>tar
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"å®šæ—¶å‘å¸ƒæˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"myblog_list.html"</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
</code></pre> 
<p>è¿™ä¸ªå®šæ—¶å‘å¸ƒåŠŸèƒ½å°±å®Œæˆäº†ï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯ä½¿ç”¨ å † æ¥è¿›è¡Œç»´æŠ¤ã€‚ä½†æ˜¯å®é™…ä¸Šå †è¿™éƒ¨åˆ†ä»£ç å¯ä»¥ä½¿ç”¨ Java å†…ç½®çš„å®šæ—¶å™¨ Timer æ¥å®Œæˆï¼Œæ€è·¯æ˜¯ç±»ä¼¼çš„ï¼Œä»£ç é‡ä¼šå°‘ç‚¹ã€‚æƒ³å­¦ä¹  Timer çš„ä½¿ç”¨ï¼Œå¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« <a href="https://blog.csdn.net/mfmfmfo/article/details/126499966?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167647128016800188590494%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=167647128016800188590494&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-2-126499966-null-null.142%5Ev73%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev1%5Econtrol&amp;utm_term=java%E5%AE%9A%E6%97%B6%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8%28timer%29&amp;spm=1018.2226.3001.4187">Timer</a></p> 
<h2><a id="16__1974"></a>16. å…¨ä»£ç </h2> 
<p><a href="https://gitee.com/enthusiastic-citizens6/project/tree/master/blogSystemSSM-show/src" rel="nofollow">å®Œç»“</a></p> 
<p>ä»¥ä¸Šä»£ç æ˜¯å½“å‰åšå®¢å¯¹åº”çš„ä»£ç ï¼Œä»£ç ä¸ä½œæ”¹å˜ï¼Œè€Œåç»­æˆ‘ä¼šæ‹“å±•å…¶ä»–åŠŸèƒ½ï¼Œä¾‹å¦‚å¤´åƒä¸Šä¼ ï¼ŒéªŒè¯ç ç­‰åŠŸèƒ½ï¼Œä¼šåŒæ­¥æ›´æ–°äº<a href="https://gitee.com/enthusiastic-citizens6/project/tree/master/blogSystem" rel="nofollow">æ­¤é“¾æ¥</a>ï¼Œæœ‰æ—¶é—´çš„è¯ä¼šåŒæ­¥åšå®¢ã€‚</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0cff36ed44efc3a194c179da714e21f2/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">centosé…ç½®å¼€æœºè‡ªå¯åŠ¨jaråŒ…</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/de5550eaba9563f9dae77422655d9652/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">uniapp ã€ å¾®ä¿¡å°ç¨‹åº text å­—æ¯ æ•°å­—ä¸æ¢è¡Œ</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ITå­¦ä¹ è€…åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>