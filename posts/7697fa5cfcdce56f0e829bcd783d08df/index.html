<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>零配置，零麻烦：MapStruct 的轻松对象映射之旅 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="零配置，零麻烦：MapStruct 的轻松对象映射之旅" />
<meta property="og:description" content="欢迎来到我的博客，代码的世界里，每一行都是一个故事 零配置，零麻烦：MapStruct 的轻松对象映射之旅 前言MapStruct是什么快速上手：基础映射高级映射技巧1. 针对复杂类型的映射：2. 自定义映射逻辑： MapStruct 的进阶用法1. 构造函数映射：2. 嵌套映射：3. 集合映射： 伪出错结语： 前言 你是否曾为繁琐的对象映射代码而感到头疼？MapStruct 登场了！它不仅是 Java 开发者的得力助手，更是一个能够消除样板代码的魔法师。在这篇博客中，我们将一同踏上 MapStruct 的奇妙之旅，解锁它的神奇技能，让你的代码更为简洁、高效。
MapStruct是什么 MapStruct 是一个用于 Java 编程语言的对象映射框架，它的主要目标是简化 Java bean 类型之间的映射过程。在软件开发中，经常需要将一个对象的数据映射到另一个对象，而 MapStruct 通过注解处理器的方式，根据开发者提供的映射规则自动生成映射代码，从而减少手动编写重复、繁琐的映射代码的工作。
MapStruct 的定位是提供一种高性能、可扩展、易用的对象映射解决方案。相比其他对象映射框架，MapStruct 有以下优势：
性能优越： 由于 MapStruct 生成的映射代码是静态的，在编译期间就已经生成，因此它的性能通常比运行时反射的映射框架更高效。
可读性和维护性： MapStruct 生成的映射代码相对清晰简洁，易于阅读和维护。生成的代码包含了开发者定义的映射规则，也支持自定义转换逻辑。
类型安全： MapStruct 在编译期间就能够检测到潜在的映射错误，提供了类型安全性，减少了在运行时可能发生的错误。
灵活性： 支持自定义转换器，开发者可以通过注解指定特定的映射规则，也可以手动编写转换器以满足特定需求。
总体而言，MapStruct 是一款强大的对象映射框架，适用于各种 Java 项目，尤其在需要处理大量对象映射的场景下，能够提高开发效率并保证映射代码的质量。
快速上手：基础映射 快速上手 MapStruct 的基础映射需要完成一些简单的步骤。以下是一个基本的示例，演示如何创建一个简单的映射。
假设有两个类 Source 和 Target，它们具有相似的字段，我们希望将一个对象映射到另一个对象。
引入 MapStruct 依赖：
在项目的 pom.xml 文件中，添加 MapStruct 的依赖：
&lt;dependencies&gt; &lt;!-- 其他依赖 --&gt; &lt;dependency&gt; &lt;groupId&gt;org." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/7697fa5cfcdce56f0e829bcd783d08df/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T13:46:30+08:00" />
<meta property="article:modified_time" content="2024-01-05T13:46:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">零配置，零麻烦：MapStruct 的轻松对象映射之旅</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><font color="red" size="5"></font></p> 
<center> 
 <font color="BA55D3" size="5"><strong>欢迎来到我的博客，代码的世界里，每一行都是一个故事</strong></font> 
</center> 
<br> 
<a href="https://todoitbo.fun" rel="nofollow"><br> <img src="https://images2.imgbox.com/84/87/UywdmIkk_o.gif" alt="在这里插入图片描述"><br> </a> 
<p></p> 
<p></p> 
<div class="toc"> 
 <h4>零配置，零麻烦：MapStruct 的轻松对象映射之旅</h4> 
 <ul><li><ul><li><a href="#_7" rel="nofollow">前言</a></li><li><a href="#MapStruct_11" rel="nofollow">MapStruct是什么</a></li><li><a href="#_27" rel="nofollow">快速上手：基础映射</a></li><li><a href="#_134" rel="nofollow">高级映射技巧</a></li><li><ul><li><a href="#1__138" rel="nofollow">1. 针对复杂类型的映射：</a></li><li><a href="#2__185" rel="nofollow">2. 自定义映射逻辑：</a></li></ul> 
   </li><li><a href="#MapStruct__223" rel="nofollow">MapStruct 的进阶用法</a></li><li><ul><li><a href="#1__227" rel="nofollow">1. 构造函数映射：</a></li><li><a href="#2__280" rel="nofollow">2. 嵌套映射：</a></li><li><a href="#3__338" rel="nofollow">3. 集合映射：</a></li></ul> 
   </li><li><a href="#_396" rel="nofollow">伪出错</a></li><li><ul><li><a href="#_416" rel="nofollow">结语：</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_7"></a>前言</h3> 
<p>你是否曾为繁琐的对象映射代码而感到头疼？MapStruct 登场了！它不仅是 Java 开发者的得力助手，更是一个能够消除样板代码的魔法师。在这篇博客中，我们将一同踏上 MapStruct 的奇妙之旅，解锁它的神奇技能，让你的代码更为简洁、高效。</p> 
<h3><a id="MapStruct_11"></a>MapStruct是什么</h3> 
<p>MapStruct 是一个用于 Java 编程语言的对象映射框架，它的主要目标是简化 Java bean 类型之间的映射过程。在软件开发中，经常需要将一个对象的数据映射到另一个对象，而 MapStruct 通过注解处理器的方式，根据开发者提供的映射规则自动生成映射代码，从而减少手动编写重复、繁琐的映射代码的工作。</p> 
<p>MapStruct 的定位是提供一种高性能、可扩展、易用的对象映射解决方案。相比其他对象映射框架，MapStruct 有以下优势：</p> 
<ol><li> <p><strong>性能优越：</strong> 由于 MapStruct 生成的映射代码是静态的，在编译期间就已经生成，因此它的性能通常比运行时反射的映射框架更高效。</p> </li><li> <p><strong>可读性和维护性：</strong> MapStruct 生成的映射代码相对清晰简洁，易于阅读和维护。生成的代码包含了开发者定义的映射规则，也支持自定义转换逻辑。</p> </li><li> <p><strong>类型安全：</strong> MapStruct 在编译期间就能够检测到潜在的映射错误，提供了类型安全性，减少了在运行时可能发生的错误。</p> </li><li> <p><strong>灵活性：</strong> 支持自定义转换器，开发者可以通过注解指定特定的映射规则，也可以手动编写转换器以满足特定需求。</p> </li></ol> 
<p>总体而言，MapStruct 是一款强大的对象映射框架，适用于各种 Java 项目，尤其在需要处理大量对象映射的场景下，能够提高开发效率并保证映射代码的质量。</p> 
<h3><a id="_27"></a>快速上手：基础映射</h3> 
<p>快速上手 MapStruct 的基础映射需要完成一些简单的步骤。以下是一个基本的示例，演示如何创建一个简单的映射。</p> 
<p>假设有两个类 <code>Source</code> 和 <code>Target</code>，它们具有相似的字段，我们希望将一个对象映射到另一个对象。</p> 
<ol><li> <p><strong>引入 MapStruct 依赖：</strong></p> <p>在项目的 <code>pom.xml</code> 文件中，添加 MapStruct 的依赖：</p> <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 其他依赖 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mapstruct<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mapstruct<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.4.2.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- 查看最新版本 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p><strong>配置 Maven 插件：</strong></p> <p>在 <code>pom.xml</code> 中，添加 MapStruct 的 Maven 插件配置：</p> <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-compiler-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- 适配你的 Java 版本 --&gt;</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- 适配你的 Java 版本 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mapstruct<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mapstruct-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.4.2.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- 查看最新版本 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">&gt;</span></span>compile<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sourceDirectory</span><span class="token punctuation">&gt;</span></span>src/main/java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sourceDirectory</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>targetDirectory</span><span class="token punctuation">&gt;</span></span>target/generated-sources/mapstruct<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>targetDirectory</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p><strong>创建源和目标类：</strong></p> <pre><code class="prism language-java"><span class="token comment">// Source 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Source</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>
</code></pre> <pre><code class="prism language-java"><span class="token comment">// Target 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Target</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p><strong>创建映射接口：</strong></p> <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span></span><span class="token class-name">Mapping</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">SourceTargetMapper</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>source <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>source <span class="token operator">=</span> <span class="token string">"age"</span><span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token string">"age"</span><span class="token punctuation">)</span>
    <span class="token class-name">Target</span> <span class="token function">sourceToTarget</span><span class="token punctuation">(</span><span class="token class-name">Source</span> source<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <p>在上述代码中，<code>@Mapper</code> 注解表示这是一个 MapStruct 映射接口。<code>@Mapping</code> 注解用于指定源对象和目标对象字段的映射关系。</p> </li><li> <p><strong>生成映射代码：</strong></p> <p>在 Maven 项目中，运行以下 Maven 命令：</p> <pre><code class="prism language-bash">mvn clean <span class="token function">install</span>
</code></pre> <p>这将触发 MapStruct 的注解处理器生成映射代码。</p> </li></ol> 
<p>以上就是一个简单的 MapStruct 映射示例。请注意，这只是一个入门级的例子，MapStruct 还支持更复杂的映射，包括集合映射、嵌套映射等。通过适当的注解和配置，你可以灵活地定义映射规则，以满足项目的需求。</p> 
<h3><a id="_134"></a>高级映射技巧</h3> 
<p>在 MapStruct 中，你可以使用高级映射技巧来处理复杂类型的映射，并定义自定义映射逻辑。以下是一些示例：</p> 
<h4><a id="1__138"></a>1. 针对复杂类型的映射：</h4> 
<p>假设有一个包含复杂类型的类 <code>Person</code>，其中包含了 <code>Address</code> 类型的地址信息。我们希望将 <code>Person</code> 类型映射到 <code>PersonDTO</code> 类型。</p> 
<pre><code class="prism language-java"><span class="token comment">// Person 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Address</span> address<span class="token punctuation">;</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>

<span class="token comment">// Address 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Address</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> city<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> street<span class="token punctuation">;</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>

<span class="token comment">// PersonDTO 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PersonDTO</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> city<span class="token punctuation">;</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>然后，创建映射接口并定义映射规则：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span></span><span class="token class-name">Mapping</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PersonMapper</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>source <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>source <span class="token operator">=</span> <span class="token string">"address.city"</span><span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token string">"city"</span><span class="token punctuation">)</span>
    <span class="token class-name">PersonDTO</span> <span class="token function">personToPersonDTO</span><span class="token punctuation">(</span><span class="token class-name">Person</span> person<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在上述代码中，通过使用点号 <code>.</code> 来表示嵌套属性的映射关系，你可以轻松地处理复杂类型的映射。</p> 
<h4><a id="2__185"></a>2. 自定义映射逻辑：</h4> 
<p>有时候，你可能需要自定义映射逻辑以满足特定的需求。例如，如果需要将 <code>Date</code> 类型转换成字符串类型，可以使用自定义的转换器。</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span></span><span class="token class-name">Mapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span>factory<span class="token punctuation">.</span></span><span class="token class-name">Mappers</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">SimpleDateFormat</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CustomMapper</span> <span class="token punctuation">{<!-- --></span>

    <span class="token class-name">CustomMapper</span> <span class="token constant">INSTANCE</span> <span class="token operator">=</span> <span class="token class-name">Mappers</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">CustomMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>source <span class="token operator">=</span> <span class="token string">"date"</span><span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token string">"formattedDate"</span><span class="token punctuation">,</span> qualifiedByName <span class="token operator">=</span> <span class="token string">"dateFormat"</span><span class="token punctuation">)</span>
    <span class="token class-name">Target</span> <span class="token function">customMapping</span><span class="token punctuation">(</span><span class="token class-name">Source</span> source<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> <span class="token function">dateFormat</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Date</span> date<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">class</span> <span class="token class-name">Target</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> formattedDate<span class="token punctuation">;</span>

        <span class="token comment">// Getter and setter</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">class</span> <span class="token class-name">Source</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">private</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Date</span> date<span class="token punctuation">;</span>

        <span class="token comment">// Getter and setter</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在上述例子中，通过在映射接口中定义名为 <code>dateFormat</code> 的方法，并在 <code>@Mapping</code> 注解中使用 <code>qualifiedByName</code> 属性，实现了对 <code>Date</code> 类型的自定义转换。</p> 
<p>这些是一些高级映射技巧的简单示例。MapStruct 提供了丰富的注解和配置选项，可以满足各种映射需求。根据项目的具体情况，你可以进一步探索 MapStruct 的文档以了解更多高级用法。</p> 
<h3><a id="MapStruct__223"></a>MapStruct 的进阶用法</h3> 
<p>MapStruct 提供了一些进阶用法，包括构造函数映射、嵌套映射和集合映射。下面分别介绍这些进阶用法：</p> 
<h4><a id="1__227"></a>1. 构造函数映射：</h4> 
<p>在某些情况下，你可能希望使用构造函数进行映射。MapStruct 允许你在映射接口中使用构造函数映射，这样可以更加灵活地处理对象创建过程。</p> 
<p>假设有一个类 <code>Person</code>，它有一个包含多个参数的构造函数，我们希望将其映射到 <code>PersonDTO</code> 类型。</p> 
<pre><code class="prism language-java"><span class="token comment">// Person 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>

    <span class="token comment">// 构造函数</span>
    <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>

<span class="token comment">// PersonDTO 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PersonDTO</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>

    <span class="token comment">// 构造函数</span>
    <span class="token keyword">public</span> <span class="token class-name">PersonDTO</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>然后，在映射接口中使用构造函数映射：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span></span><span class="token class-name">Mapping</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PersonMapper</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>target <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">,</span> source <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>target <span class="token operator">=</span> <span class="token string">"age"</span><span class="token punctuation">,</span> source <span class="token operator">=</span> <span class="token string">"age"</span><span class="token punctuation">)</span>
    <span class="token class-name">PersonDTO</span> <span class="token function">personToPersonDTO</span><span class="token punctuation">(</span><span class="token class-name">Person</span> person<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>MapStruct 会自动识别构造函数映射的关系，并生成相应的映射代码。</p> 
<h4><a id="2__280"></a>2. 嵌套映射：</h4> 
<p>MapStruct 支持嵌套映射，允许你在对象之间建立更复杂的映射关系。假设有一个嵌套的类结构，如 <code>Order</code> 包含 <code>Customer</code>，我们希望将 <code>Order</code> 映射到 <code>OrderDTO</code>，同时也映射 <code>Customer</code> 到 <code>CustomerDTO</code>。</p> 
<pre><code class="prism language-java"><span class="token comment">// Order 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Order</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> orderId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Customer</span> customer<span class="token punctuation">;</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>

<span class="token comment">// Customer 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Customer</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> address<span class="token punctuation">;</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>

<span class="token comment">// OrderDTO 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderDTO</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> orderId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">CustomerDTO</span> customer<span class="token punctuation">;</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>

<span class="token comment">// CustomerDTO 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomerDTO</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> address<span class="token punctuation">;</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在映射接口中进行嵌套映射：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span></span><span class="token class-name">Mapping</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OrderMapper</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>source <span class="token operator">=</span> <span class="token string">"customer"</span><span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token string">"customer"</span><span class="token punctuation">)</span>
    <span class="token class-name">OrderDTO</span> <span class="token function">orderToOrderDTO</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>source <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>source <span class="token operator">=</span> <span class="token string">"address"</span><span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token string">"address"</span><span class="token punctuation">)</span>
    <span class="token class-name">CustomerDTO</span> <span class="token function">customerToCustomerDTO</span><span class="token punctuation">(</span><span class="token class-name">Customer</span> customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>MapStruct 会根据映射接口中的定义自动生成嵌套映射代码。</p> 
<h4><a id="3__338"></a>3. 集合映射：</h4> 
<p>MapStruct 也支持集合的映射。假设有一个类 <code>Library</code> 包含了多个书籍 <code>Book</code>，我们希望将 <code>Library</code> 映射到 <code>LibraryDTO</code>，同时也映射其中的书籍列表。</p> 
<pre><code class="prism language-java"><span class="token comment">// Book 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> author<span class="token punctuation">;</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>

<span class="token comment">// Library 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Library</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Book</span><span class="token punctuation">&gt;</span></span> books<span class="token punctuation">;</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>

<span class="token comment">// LibraryDTO 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LibraryDTO</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BookDTO</span><span class="token punctuation">&gt;</span></span> books<span class="token punctuation">;</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>

<span class="token comment">// BookDTO 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BookDTO</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> author<span class="token punctuation">;</span>

    <span class="token comment">// Getters and setters</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在映射接口中进行集合映射：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mapstruct<span class="token punctuation">.</span></span><span class="token class-name">Mapping</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">LibraryMapper</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>source <span class="token operator">=</span> <span class="token string">"books"</span><span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token string">"books"</span><span class="token punctuation">)</span>
    <span class="token class-name">LibraryDTO</span> <span class="token function">libraryToLibraryDTO</span><span class="token punctuation">(</span><span class="token class-name">Library</span> library<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>source <span class="token operator">=</span> <span class="token string">"title"</span><span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token string">"title"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>source <span class="token operator">=</span> <span class="token string">"author"</span><span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token string">"author"</span><span class="token punctuation">)</span>
    <span class="token class-name">BookDTO</span> <span class="token function">bookToBookDTO</span><span class="token punctuation">(</span><span class="token class-name">Book</span> book<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>MapStruct 会根据映射接口中的定义自动生成集合映射代码。</p> 
<p>这些是 MapStruct 的一些进阶用法，它们能够帮助你更灵活地处理复杂的映射场景。根据项目需求，你可以结合这些技巧，定制符合你业务逻辑的映射规则。</p> 
<h3><a id="_396"></a>伪出错</h3> 
<p>1、报错<code> java.lang.ClassNotFoundException: Cannot find implementation for fun.todoitbo.botally.convert.TbBillConvert</code></p> 
<pre><code class="prism language-tex">这里要观察你的@Mapper注解，你可能错把mybatis中的@Mapper当成宝了
</code></pre> 
<p>2、映射返回的结果都是null</p> 
<pre><code class="prism language-tex">出现上面的情况，要观察，是否存在目标类上没有set，get方法
</code></pre> 
<p>3、我修改了源类或者目标类但是他没有生效</p> 
<pre><code class="prism language-tex">这里你需要clear一下，重新启动，因为它的实现方法只生成一次
</code></pre> 
<h4><a id="_416"></a>结语：</h4> 
<p>通过本文的深度探索，相信你将对 MapStruct 有了全新的认识，并能够在你的项目中充分发挥它的威力。让我们一同掌握这门“魔法”，让代码变得更加清爽、优雅！</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1d81c0cd60486eacc3d72a25af8c8b4d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">什么是DNS解析？DNS解析的详细过程是什么样的？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/21f590c12f68af3af98fd4364a105a25/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python项目分享 基于Django的商品销售系统</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>