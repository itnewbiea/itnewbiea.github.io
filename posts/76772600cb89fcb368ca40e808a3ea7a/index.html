<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MFC的文件操作——获取指定文件夹下面所有文件（夹）路径和删除指定文件夹下面所有文件 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MFC的文件操作——获取指定文件夹下面所有文件（夹）路径和删除指定文件夹下面所有文件" />
<meta property="og:description" content="目录
1.获取指定文件夹下面所有文件路径
2.删除指定文件夹下面所有文件
3.MFC的CString 字符串操作
4.MFC的 Int类型 与 Htuple类型数据之间转换
5.上述提及的函数应用
6.MFC与Halcon联合编程，获取halcon异常
7.MFC获取指定路径下的文件夹路径
①、文件夹路径获取方式
②、打开文件——文件路径获取方式
1.获取指定文件夹下面所有文件路径 //读取文件夹下的所有文件路径 void getFiles(CString path, vector&lt;CString&gt;&amp; files) { CFileFind find; BOOL IsFind = find.FindFile(path &#43; _T(&#34;/*.*&#34;)); while (IsFind) { IsFind = find.FindNextFile(); if (find.IsDots()) { continue; } else { CString filename = _T(&#34;&#34;); CString fullname = _T(&#34;&#34;); filename = find.GetFileName(); fullname = path &#43; filename; files.push_back(fullname); } } } 2.删除指定文件夹下面所有文件 //删除指定文件夹下面所有文件 void CDirectory::DeleteDirectory(const CString &amp;strPath) { CFileFind tempFind; TCHAR sTempFileFind[MAX_PATH] = { 0 }; wsprintf(sTempFileFind, _T(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/76772600cb89fcb368ca40e808a3ea7a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-02T18:55:37+08:00" />
<meta property="article:modified_time" content="2023-08-02T18:55:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MFC的文件操作——获取指定文件夹下面所有文件（夹）路径和删除指定文件夹下面所有文件</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="1.%E8%8E%B7%E5%8F%96%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E9%9D%A2%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84-toc" style="margin-left:40px;"><a href="#1.%E8%8E%B7%E5%8F%96%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E9%9D%A2%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84" rel="nofollow">1.获取指定文件夹下面所有文件路径</a></p> 
<p id="%C2%A02.%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E9%9D%A2%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6-toc" style="margin-left:40px;"><a href="#%C2%A02.%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E9%9D%A2%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6" rel="nofollow"> 2.删除指定文件夹下面所有文件</a></p> 
<p id="3.MFC%E7%9A%84CString%20%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C-toc" style="margin-left:40px;"><a href="#3.MFC%E7%9A%84CString%20%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C" rel="nofollow">3.MFC的CString 字符串操作</a></p> 
<p id="4.MFC%E7%9A%84%20Int%E7%B1%BB%E5%9E%8B%20%E4%B8%8E%20Htuple%E7%B1%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E4%B9%8B%E9%97%B4%E8%BD%AC%E6%8D%A2-toc" style="margin-left:40px;"><a href="#4.MFC%E7%9A%84%20Int%E7%B1%BB%E5%9E%8B%20%E4%B8%8E%20Htuple%E7%B1%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E4%B9%8B%E9%97%B4%E8%BD%AC%E6%8D%A2" rel="nofollow">4.MFC的 Int类型 与 Htuple类型数据之间转换</a></p> 
<p id="%C2%A05.%E4%B8%8A%E8%BF%B0%E6%8F%90%E5%8F%8A%E7%9A%84%E5%87%BD%E6%95%B0%E5%BA%94%E7%94%A8-toc" style="margin-left:40px;"><a href="#%C2%A05.%E4%B8%8A%E8%BF%B0%E6%8F%90%E5%8F%8A%E7%9A%84%E5%87%BD%E6%95%B0%E5%BA%94%E7%94%A8" rel="nofollow"> 5.上述提及的函数应用</a></p> 
<p id="6.MFC%E4%B8%8EHalcon%E8%81%94%E5%90%88%E7%BC%96%E7%A8%8B%EF%BC%8C%E8%8E%B7%E5%8F%96halcon%E5%BC%82%E5%B8%B8-toc" style="margin-left:40px;"><a href="#6.MFC%E4%B8%8EHalcon%E8%81%94%E5%90%88%E7%BC%96%E7%A8%8B%EF%BC%8C%E8%8E%B7%E5%8F%96halcon%E5%BC%82%E5%B8%B8" rel="nofollow">6.MFC与Halcon联合编程，获取halcon异常</a></p> 
<p id="7.MFC%E8%8E%B7%E5%8F%96%E6%8C%87%E5%AE%9A%E8%B7%AF%E5%BE%84%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B9%E8%B7%AF%E5%BE%84-toc" style="margin-left:40px;"><a href="#7.MFC%E8%8E%B7%E5%8F%96%E6%8C%87%E5%AE%9A%E8%B7%AF%E5%BE%84%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B9%E8%B7%AF%E5%BE%84" rel="nofollow">7.MFC获取指定路径下的文件夹路径</a></p> 
<p id="%E2%91%A0%E3%80%81%E6%96%87%E4%BB%B6%E5%A4%B9%E8%B7%AF%E5%BE%84%E8%8E%B7%E5%8F%96%E6%96%B9%E5%BC%8F-toc" style="margin-left:0px;">          <a href="#%E2%91%A0%E3%80%81%E6%96%87%E4%BB%B6%E5%A4%B9%E8%B7%AF%E5%BE%84%E8%8E%B7%E5%8F%96%E6%96%B9%E5%BC%8F" rel="nofollow">①、文件夹路径获取方式</a></p> 
<p id="%E2%91%A1%E3%80%81%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E2%80%94%E2%80%94%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E8%8E%B7%E5%8F%96%E6%96%B9%E5%BC%8F-toc" style="margin-left:40px;"><a href="#%E2%91%A1%E3%80%81%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E2%80%94%E2%80%94%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E8%8E%B7%E5%8F%96%E6%96%B9%E5%BC%8F" rel="nofollow">②、打开文件——文件路径获取方式</a></p> 
<hr id="hr-toc"> 
<p id="6.MFC%E4%B8%8EHalcon%E8%81%94%E5%90%88%E7%BC%96%E7%A8%8B%EF%BC%8C%E8%8E%B7%E5%8F%96halcon%E5%BC%82%E5%B8%B8-toc" style="margin-left:80px;"></p> 
<h3 id="1.%E8%8E%B7%E5%8F%96%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E9%9D%A2%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84">1.获取指定文件夹下面所有文件路径</h3> 
<pre><code class="language-cpp">//读取文件夹下的所有文件路径
void getFiles(CString path, vector&lt;CString&gt;&amp; files)
{
	CFileFind find;
	BOOL IsFind = find.FindFile(path + _T("/*.*"));
	while (IsFind)
	{
		IsFind = find.FindNextFile();
		if (find.IsDots())
		{
			continue;
		}
		else
		{
			CString filename = _T("");
			CString fullname = _T("");
			filename = find.GetFileName();
			fullname = path + filename;
			files.push_back(fullname);
		}
	}
}</code></pre> 
<h3 id="%C2%A02.%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E9%9D%A2%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6"> 2.删除指定文件夹下面所有文件</h3> 
<pre><code class="language-cpp">//删除指定文件夹下面所有文件
void CDirectory::DeleteDirectory(const CString &amp;strPath)

{

	CFileFind tempFind;

	TCHAR sTempFileFind[MAX_PATH] = { 0 };

	wsprintf(sTempFileFind, _T("%s\\*.*"), strPath);

	BOOL IsFinded = tempFind.FindFile(sTempFileFind);

	while (IsFinded) 

	{ 

		IsFinded = tempFind.FindNextFile(); 



		if (!tempFind.IsDots()) 

		{ 

			TCHAR sFoundFileName[200] = { 0 }; 

			_tcscpy(sFoundFileName, tempFind.GetFileName().GetBuffer(200)); 



			if (tempFind.IsDirectory()) 

			{ 

				TCHAR sTempDir[200] = { 0 }; 

				wsprintf(sTempDir, _T("%s\\%s"),strPath, sFoundFileName); 

				DeleteDirectory(sTempDir); 

			} 

			else 

			{ 

				TCHAR sTempFileName[200] = { 0 }; 

				wsprintf(sTempFileName, _T("%s\\%s"), strPath, sFoundFileName); 

				DeleteFile(sTempFileName); 

			} 

		} 

	} 


	tempFind.Close(); 

//若不想删除当前文件夹，则注释掉下面一句
	if(!RemoveDirectory(strPath))

		return false;


	return true;

}</code></pre> 
<h3 id="3.MFC%E7%9A%84CString%20%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C">3.MFC的CString 字符串操作</h3> 
<pre><code class="language-cpp">CString strModelpath, strMax, strMin;
strModelpath.Format(("./printcheck_model/model-%d.shm"), hv_i[0].I());
strMax.Format(("./printcheck_model/ModelMax-%d.bmp"), hv_i[0].I());
strMin.Format(("./printcheck_model/ModelMin-%d.bmp"), hv_i[0].I());</code></pre> 
<h3 id="4.MFC%E7%9A%84%20Int%E7%B1%BB%E5%9E%8B%20%E4%B8%8E%20Htuple%E7%B1%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E4%B9%8B%E9%97%B4%E8%BD%AC%E6%8D%A2">4.MFC的 Int类型 与 Htuple类型数据之间转换</h3> 
<pre><code class="language-cpp">int k = (hv_Int[hv_Index]).I();
CString sr = Files[(hv_Int[hv_Index]).I()];
ReadImage(&amp;ho_Image, HTuple(Files[(hv_Int[hv_Index]).I()]));</code></pre> 
<h3 id="%C2%A05.%E4%B8%8A%E8%BF%B0%E6%8F%90%E5%8F%8A%E7%9A%84%E5%87%BD%E6%95%B0%E5%BA%94%E7%94%A8"> 5.上述提及的函数应用</h3> 
<pre><code class="language-cpp">vector&lt;CString&gt; Files;
getFiles("D:/Desktop/文字缺损检测/产品0(√)/文字部分好品/", Files);
DeleteDirectory("./printcheck_model");</code></pre> 
<h3 id="6.MFC%E4%B8%8EHalcon%E8%81%94%E5%90%88%E7%BC%96%E7%A8%8B%EF%BC%8C%E8%8E%B7%E5%8F%96halcon%E5%BC%82%E5%B8%B8">6.MFC与Halcon联合编程，获取halcon异常</h3> 
<pre><code class="language-cpp">try
{
	ReadShapeModel(strModelpath.GetBuffer(), &amp;hv_ModelID);

}
	catch (const HException&amp; H)
{
	HString str = H.ErrorText();
	string a = string(str.ToLocal8bit());
}</code></pre> 
<h3></h3> 
<h3 id="7.MFC%E8%8E%B7%E5%8F%96%E6%8C%87%E5%AE%9A%E8%B7%AF%E5%BE%84%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B9%E8%B7%AF%E5%BE%84">7.MFC获取指定路径下的文件夹路径</h3> 
<p> <strong>文件夹路径</strong>和<strong>文件路径</strong>是不一样的，前者可以仅选中某个文件夹，从而获得该文件夹的路径，但后者必须要打开某个指定的文件，如.jpg图像，这样才能获得文件路径。所以使用哪个程序，视你的需求而定。</p> 
<h2 id="%E2%91%A0%E3%80%81%E6%96%87%E4%BB%B6%E5%A4%B9%E8%B7%AF%E5%BE%84%E8%8E%B7%E5%8F%96%E6%96%B9%E5%BC%8F">①、文件夹路径获取方式</h2> 
<pre><code class="language-cpp">CString m_strFileOut = _T("");  //初始化适应Unicode
 TCHAR szSelected[MAX_PATH];//用来存放文件夹路径  
 BROWSEINFO bi;  
 LPITEMIDLIST pidl;  
 bi.hwndOwner = this-&gt;m_hWnd;  
 bi.pidlRoot = NULL;  
 bi.pszDisplayName = szSelected;  
 bi.lpszTitle = _T("选择输出文件路径");  
 bi.ulFlags = BIF_RETURNONLYFSDIRS;  
 bi.lpfn = NULL;  
 bi.lParam = NULL;  
 bi.iImage = NULL;  
 if((pidl = SHBrowseForFolder(&amp;bi)) != NULL)  
 {  
  if(SUCCEEDED(SHGetPathFromIDList(pidl, szSelected))) //得到文件夹的全路径，不要的话，只得本文件夹名  
  {  
   m_strFileOut = szSelected;  	//获得文件夹的全路径
  }  
 }  </code></pre> 
<h3 id="%E2%91%A1%E3%80%81%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E2%80%94%E2%80%94%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E8%8E%B7%E5%8F%96%E6%96%B9%E5%BC%8F">②、打开文件——文件路径获取方式</h3> 
<pre><code class="language-cpp">                CString filePath;
				CFileDialog dlg(TRUE, _T("*.bmp"), "", OFN_FILEMUSTEXIST | OFN_PATHMUSTEXIST | OFN_HIDEREADONLY, "image files (*.bmp; *.jpg) |*.bmp;*.jpg|All Files (*.*)|*.*||", NULL);
				char title[] = { "Open model-Image" };
				dlg.m_ofn.lpstrTitle = title;
				if (dlg.DoModal() == IDOK)
				{
					filePath = dlg.GetPathName();//获取当前的路径
					m_sModel_b.modelimg_path = filePath;
					//读入图像
					//手动选择1张图像创建形状模板
					ReadImage(&amp;ho_Image, HTuple(m_sModel_b.modelimg_path));
					DispObj(ho_Image, m_lWindowHandle);
					AfxMessageBox("模板参考图像读取完成！");
				}</code></pre> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2565ee6800177e7ce923c152f3dd5d84/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Opengl安装（win10&#43;vs2019） 找了一个非常靠谱的，按照步骤安装完没有任何问题，给原作者点赞</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f0373a8dce6ff5920475a25eb8910349/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【LSTM分类】基于注意力机制的卷积神经网络结合长短记忆神经网络CNN-LSTM-attention实现数据分类附matlab代码</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>