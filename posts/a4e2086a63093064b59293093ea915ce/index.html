<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>一步一步学Silverlight 2系列（19）：如何在Silverlight中与HTML DOM交互（上） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="一步一步学Silverlight 2系列（19）：如何在Silverlight中与HTML DOM交互（上）" />
<meta property="og:description" content="版权声明：原创作品，允许转载，转载时请务必以超链接形式标明文章 原始出处 、作者信息和本声明。否则将追究法律责任。 http://terrylee.blog.51cto.com/342737/67258 概述 Silverlight 2 Beta 1版本发布了，无论从Runtime还是Tools都给我们带来了很多的惊喜，如支持框架语言Visual Basic, Visual C#, IronRuby, Ironpython，对JSON、Web Service、WCF以及Sockets的支持等一系列新的特性。《一步一步学Silverlight 2系列》文章将从Silverlight 2基础知识、数据与通信、自定义控件、动画、图形图像等几个方面带您快速进入Silverlight 2开发。 Silverlight中内置了对于HTML、客户端脚本等的支持，本文为如何在Silverlight 2与HTML DOM进行交互第一部分，访问和修改DOM元素。 访问DOM元素 我们先来看一个简单的示例，如何访问HTML DOM。最终完成的效果如下，我们将在界面放置两个div，分别为div1和div2，下面绿色的区域为Silverlight部分，在第一个文本框中输入div的id并点击显示，将在下面显示出对应div上的文本信息。 首先我们需要对测试页做一下修改，因为默认的Silverlight插件所占的高度是100%，修改为200px。 &lt;div style=&#34;height:200px&#34;&gt; &lt;asp:Silverlight ID=&#34;Xaml1&#34; runat=&#34;server&#34; Source=&#34;~/ClientBin/TerryLee.SilverlightAccessingHtmlDom1.xap&#34; Version=&#34;2.0&#34; Width=&#34;100%&#34; Height=&#34;200px&#34; /&gt; &lt;/div&gt; 同时放置两个div： &lt;div id=&#34;div1&#34;&gt;这里是第一个div，id为div1&lt;/div&gt; &lt;div id=&#34;div2&#34;&gt;这里是第二个div，id为div2&lt;/div&gt; 为了看起来明显起见，给它们定义简单的样式： #div1 { background:#FCE2BC; border:solid 1px #FF9900; width:500px; height:50px; margin-bottom:20px; } #div2 { background:#BCC8FC; border:solid 1px #4769F9; width:500px; height:50px; margin-bottom:20px; } 实现Silverlight的界面布局，使用Canvas，给它的背景定义为浅绿色，XAML如下： &lt;Canvas Background=&#34;#D5FCDF&#34;&gt; &lt;TextBlock Text=&#34;Silverlight Accessing the HTML DOM&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/a4e2086a63093064b59293093ea915ce/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-07-02T23:28:22+08:00" />
<meta property="article:modified_time" content="2019-07-02T23:28:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">一步一步学Silverlight 2系列（19）：如何在Silverlight中与HTML DOM交互（上）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <table id="content" style="table-layout:fixed;width:650px;" cellspacing="10" cellpadding="0" width="650" border="0"><tbody><tr><td> 
     <div class="copy"> 
      <strong>版权声明：</strong>原创作品，允许转载，转载时请务必以超链接形式标明文章 
      <a style="text-decoration:underline;" href="http://terrylee.blog.51cto.com/342737/67258" rel="nofollow"><font color="#000000">原始出处</font></a> 、作者信息和本声明。否则将追究法律责任。 
      <a href="http://terrylee.blog.51cto.com/342737/67258" rel="nofollow"><font color="#000000">http://terrylee.blog.51cto.com/342737/67258</font></a> 
     </div> </td></tr><tr><td> 
     <div style="font-size:10pt;"> 
      <h3>概述</h3> 
      <div>
        Silverlight 2 Beta 1版本发布了，无论从Runtime还是Tools都给我们带来了很多的惊喜，如支持框架语言Visual Basic, Visual C#, IronRuby, Ironpython，对JSON、Web Service、WCF以及Sockets的支持等一系列新的特性。《一步一步学Silverlight 2系列》文章将从Silverlight 2基础知识、数据与通信、自定义控件、动画、图形图像等几个方面带您快速进入Silverlight 2开发。 
      </div> 
      <div>
        Silverlight中内置了对于HTML、客户端脚本等的支持，本文为如何在Silverlight 2与HTML DOM进行交互第一部分，访问和修改DOM元素。 
      </div> 
      <h3>访问DOM元素</h3> 
      <div>
        我们先来看一个简单的示例，如何访问HTML DOM。最终完成的效果如下，我们将在界面放置两个div，分别为div1和div2，下面绿色的区域为Silverlight部分，在第一个文本框中输入div的id并点击显示，将在下面显示出对应div上的文本信息。 
      </div> 
      <div>
          
      </div> 
      <div>
        首先我们需要对测试页做一下修改，因为默认的Silverlight插件所占的高度是100%，修改为200px。 
      </div> 
      <pre class="code"><span style="color:#0000FF;">&lt;</span><span style="color:#a31515;">div  </span><span style="color:#FF0000;">style</span><span style="color:#0000FF;">="</span><span style="color:#FF0000;">height</span>:<span style="color:#0000FF;">200px"&gt;
            &lt;</span><span style="color:#a31515;">asp</span><span style="color:#0000FF;">:</span><span style="color:#a31515;">Silverlight </span><span style="color:#FF0000;">ID</span><span style="color:#0000FF;">="Xaml1" </span><span style="color:#FF0000;">runat</span><span style="color:#0000FF;">="server"
            </span><span style="color:#FF0000;">Source</span><span style="color:#0000FF;">="~/ClientBin/TerryLee.SilverlightAccessingHtmlDom1.xap"
            </span><span style="color:#FF0000;">Version</span><span style="color:#0000FF;">="2.0" </span><span style="color:#FF0000;">Width</span><span style="color:#0000FF;">="100%" </span><span style="color:#FF0000;">Height</span><span style="color:#0000FF;">="200px" /&gt;
            &lt;/</span><span style="color:#a31515;">div</span><span style="color:#0000FF;">&gt;</span></pre> 
      <a href="http://11011.net/software/vspaste" rel="nofollow"></a> 
      <a href="http://11011.net/software/vspaste" rel="nofollow"></a> 
      <div>
        同时放置两个div： 
      </div> 
      <pre class="code"><span style="color:#0000FF;">&lt;</span><span style="color:#a31515;">div </span><span style="color:#FF0000;">id</span><span style="color:#0000FF;">="div1"&gt;</span>这里是第一个div，id为div1<span style="color:#0000FF;">&lt;/</span><span style="color:#a31515;">div</span><span style="color:#0000FF;">&gt;
            &lt;</span><span style="color:#a31515;">div </span><span style="color:#FF0000;">id</span><span style="color:#0000FF;">="div2"&gt;</span>这里是第二个div，id为div2<span style="color:#0000FF;">&lt;/</span><span style="color:#a31515;">div</span><span style="color:#0000FF;">&gt;</span></pre> 
      <div>
        为了看起来明显起见，给它们定义简单的样式： 
      </div> 
      <pre class="code"><span style="color:#a31515;">#div1
            </span>{
            <span style="color:#FF0000;">background</span>:<span style="color:#0000FF;">#FCE2BC</span>;
            <span style="color:#FF0000;">border</span>:<span style="color:#0000FF;">solid 1px #FF9900</span>;
            <span style="color:#FF0000;">width</span>:<span style="color:#0000FF;">500px</span>;
            <span style="color:#FF0000;">height</span>:<span style="color:#0000FF;">50px</span>;
            <span style="color:#FF0000;">margin-bottom</span>:<span style="color:#0000FF;">20px</span>;
            }
            <span style="color:#a31515;">#div2
            </span>{
            <span style="color:#FF0000;">background</span>:<span style="color:#0000FF;">#BCC8FC</span>;
            <span style="color:#FF0000;">border</span>:<span style="color:#0000FF;">solid 1px #4769F9</span>;
            <span style="color:#FF0000;">width</span>:<span style="color:#0000FF;">500px</span>;
            <span style="color:#FF0000;">height</span>:<span style="color:#0000FF;">50px</span>;
            <span style="color:#FF0000;">margin-bottom</span>:<span style="color:#0000FF;">20px</span>;
            }</pre> 
      <div>
        实现Silverlight的界面布局，使用Canvas，给它的背景定义为浅绿色，XAML如下： 
      </div> 
      <pre class="code"><span style="color:#0000FF;">&lt;</span><span style="color:#a31515;">Canvas </span><span style="color:#FF0000;">Background</span><span style="color:#0000FF;">="#D5FCDF"&gt;
            &lt;</span><span style="color:#a31515;">TextBlock </span><span style="color:#FF0000;">Text</span><span style="color:#0000FF;">="Silverlight Accessing the HTML DOM" </span><span style="color:#FF0000;">Foreground</span><span style="color:#0000FF;">="Red"
            </span><span style="color:#FF0000;">Canvas.Top</span><span style="color:#0000FF;">="10" </span><span style="color:#FF0000;">Canvas.Left</span><span style="color:#0000FF;">="30" </span><span style="color:#FF0000;">FontSize</span><span style="color:#0000FF;">="18"&gt;
            &lt;/</span><span style="color:#a31515;">TextBlock</span><span style="color:#0000FF;">&gt;
            &lt;</span><span style="color:#a31515;">WatermarkedTextBox </span><span style="color:#FF0000;">x</span><span style="color:#0000FF;">:</span><span style="color:#FF0000;">Name</span><span style="color:#0000FF;">="input" </span><span style="color:#FF0000;">Watermark</span><span style="color:#0000FF;">="请在这里输入"
            </span><span style="color:#FF0000;">Height</span><span style="color:#0000FF;">="40" </span><span style="color:#FF0000;">Width</span><span style="color:#0000FF;">="300"
            </span><span style="color:#FF0000;">Canvas.Left</span><span style="color:#0000FF;">="30" </span><span style="color:#FF0000;">Canvas.Top</span><span style="color:#0000FF;">="50"&gt;
            &lt;/</span><span style="color:#a31515;">WatermarkedTextBox</span><span style="color:#0000FF;">&gt;
            &lt;</span><span style="color:#a31515;">WatermarkedTextBox </span><span style="color:#FF0000;">x</span><span style="color:#0000FF;">:</span><span style="color:#FF0000;">Name</span><span style="color:#0000FF;">="result" </span><span style="color:#FF0000;">Watermark</span><span style="color:#0000FF;">="这里显示结果"
            </span><span style="color:#FF0000;">Height</span><span style="color:#0000FF;">="40" </span><span style="color:#FF0000;">Width</span><span style="color:#0000FF;">="300"
            </span><span style="color:#FF0000;">Canvas.Left</span><span style="color:#0000FF;">="30" </span><span style="color:#FF0000;">Canvas.Top</span><span style="color:#0000FF;">="100"&gt;
            &lt;/</span><span style="color:#a31515;">WatermarkedTextBox</span><span style="color:#0000FF;">&gt;
            &lt;</span><span style="color:#a31515;">Button </span><span style="color:#FF0000;">x</span><span style="color:#0000FF;">:</span><span style="color:#FF0000;">Name</span><span style="color:#0000FF;">="displayButton" </span><span style="color:#FF0000;">Background</span><span style="color:#0000FF;">="Red"
            </span><span style="color:#FF0000;">Height</span><span style="color:#0000FF;">="40" </span><span style="color:#FF0000;">Width</span><span style="color:#0000FF;">="100" </span><span style="color:#FF0000;">Content</span><span style="color:#0000FF;">="显 示"
            </span><span style="color:#FF0000;">Canvas.Top</span><span style="color:#0000FF;">="50" </span><span style="color:#FF0000;">Canvas.Left</span><span style="color:#0000FF;">="350"
            </span><span style="color:#FF0000;">Click</span><span style="color:#0000FF;">="displayButton_Click"&gt;
            &lt;/</span><span style="color:#a31515;">Button</span><span style="color:#0000FF;">&gt;
            &lt;/</span><span style="color:#a31515;">Canvas</span><span style="color:#0000FF;">&gt;</span></pre> 
      <a href="http://11011.net/software/vspaste" rel="nofollow"></a> 
      <div>
        实现对HTML DOM的访问。Silverlight 2在命名空间System.Windows.Browser下内置了很多对于HTML DOM访问和操作的支持，我们最常用的一个对象是HtmlElement，通过HtmlPage静态类可以获取到当前页面的文档模型，最后再调用GetElementsByTagName或者GetElementById方法。 
      </div> 
      <pre class="code"><span style="color:#2b91af;">HtmlElement </span>element = <span style="color:#2b91af;">HtmlPage</span>.Document.GetElementById(<span style="color:#0000FF;">this</span>.input.Text);</pre> 
      <div> 
       <a href="http://11011.net/software/vspaste" rel="nofollow"></a>这样我们就获取到了一个DOM元素，再使用它的GetAttribute可以获取到相关属性： 
      </div> 
      <pre class="code"><span style="color:#0000FF;">this</span>.result.Text = element.GetAttribute(<span style="color:#a31515;">"innerText"</span>);</pre> 
      <a href="http://11011.net/software/vspaste" rel="nofollow"></a>完整的代码如下： 
      <pre class="code"><span style="color:#0000FF;">private void </span>displayButton_Click(<span style="color:#0000FF;">object </span>sender, <span style="color:#2b91af;">RoutedEventArgs </span>e)
            {
            <span style="color:#2b91af;">HtmlElement </span>element = <span style="color:#2b91af;">HtmlPage</span>.Document.GetElementById(<span style="color:#0000FF;">this</span>.input.Text);
            <span style="color:#0000FF;">this</span>.result.Text = element.GetAttribute(<span style="color:#a31515;">"innerText"</span>);
            }</pre> 
      <div>
        运行后我们在第一个文本框中输入div1： 
      </div> 
      <div>
          
      </div> 
      <div>
        单击显示后，将在第二个文本框中显示出div1的文本内容： 
      </div> 
      <div>
          
      </div> 
      <h3>操作DOM元素</h3> 
      <div>
        通过上面的示例我们已经知道了如何去访问HTML DOM，现在再看一下对HTML DOM进行操作，如我们如何改变DOM的内容等，还是使用上面的示例，稍作一下修改，在第一个文本框中输入DOM的id，在第二个文本框中输入要修改的内容。 
      </div> 
      <div>
          
      </div> 
      <div>
        其实这里非常简单，只要对代码做一下小的改动，使用SetAttribute方法就可以了，第一个参数指定属性名，第二个参数指定属性值。如： 
      </div> 
      <pre class="code"><span style="color:#0000FF;">private void </span>displayButton_Click(<span style="color:#0000FF;">object </span>sender, <span style="color:#2b91af;">RoutedEventArgs </span>e)
            {
            <span style="color:#2b91af;">HtmlElement </span>element = <span style="color:#2b91af;">HtmlPage</span>.Document.GetElementById(<span style="color:#0000FF;">this</span>.input.Text);
            element.SetAttribute(<span style="color:#a31515;">"innerText"</span>,<span style="color:#0000FF;">this</span>.result.Text);
            }</pre> 
      <a href="http://11011.net/software/vspaste" rel="nofollow"></a>运行后，输入div2和一些内容，单击确定： 
      <div>
          
      </div> 
      <h3>修改DOM元素样式</h3> 
      <div>
        除了上面提到的GetAttribute和SetAttribute这一组方法之外，HtmlElement还提供了一组GetStyleAttribute和SetStyleAttribute方法，用于获取和设置DOM的样式，如： 
      </div> 
      <pre class="code"><span style="color:#0000FF;">private void </span>displayButton_Click(<span style="color:#0000FF;">object </span>sender, <span style="color:#2b91af;">RoutedEventArgs </span>e)
            {
            <span style="color:#2b91af;">HtmlElement </span>element = <span style="color:#2b91af;">HtmlPage</span>.Document.GetElementById(<span style="color:#0000FF;">this</span>.input.Text);
            element.SetStyleAttribute(<span style="color:#a31515;">"width"</span>,<span style="color:#0000FF;">this</span>.result.Text);
            element.SetStyleAttribute(<span style="color:#a31515;">"height"</span>, <span style="color:#0000FF;">this</span>.result.Text);
            }</pre> 
      <div> 
       <a href="http://11011.net/software/vspaste" rel="nofollow"></a>运行后，输入div1和100，效果如下： 
      </div> 
      <div> 
       <a href="https://images.cnblogs.com/cnblogs_com/Terrylee/WindowsLiveWriter/Silverlight219_13D57/TerryLee_Silverlight2_0088_2.png" rel="nofollow"></a>  
      </div> 
      <h3>结束语</h3> 
      <div>
        本文介绍了如何在Silverlight 中访问DOM以及修改DOM的属性等，下一篇我将介绍如何改变DOM的结构，如添加和移除DOM元素以及为DOM元素注册事件等。 
      </div> 
      <p>本文出自 “<a href="http://terrylee.blog.51cto.com/" rel="nofollow"><font color="#000000">TerryLee技术专栏</font></a>” 博客，请务必保留此出处<a href="http://terrylee.blog.51cto.com/342737/67258" rel="nofollow"><font color="#000000">http://terrylee.blog.51cto.com/342737/67258</font></a></p> 
      <a class="hidden" href="http://terrylee.blog.51cto.com/342737/67258" rel="nofollow"><font color="#000000">本文出自 51CTO.COM技术博客</font></a> 
     </div> </td></tr></tbody></table> 
</div> 
<p>转载于:https://www.cnblogs.com/hdjjun/archive/2008/12/24/1361473.html</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/34b8aa383c481c77841c7568d06a1dde/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Windows To Ghost系统封装之必备软件集 - 好压</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/190929b5d6e98788d7b6593752b2c0a8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android的Broadcast应用说明一例</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>