<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux 进程(八) 进程的退出码 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux 进程(八) 进程的退出码" />
<meta property="og:description" content="main 函数的返回值叫做进程的退出码。当进程成功退出的时候，我们一般用0来表示。进程失败的时候一般用非零来表示。我们使用不同的数字来表示进程退出时不同的失败原因。
我们查看系统的有多少退出码以及其含义时需要用到strerror() 他的头文件和用法如下。
通过一下代码来查看系统有多少退出码
#include&lt;stdio.h&gt; #include&lt;unistd.h&gt; #include&lt;errno.h&gt; #include&lt;string.h&gt; int main() { int i = 0; for(i;i&lt;200;i&#43;&#43;) { printf(&#34;%d:,%s\n&#34;,i,strerror(i)); } return 0; } 我们可以看到系统大概有134个退出码，每个退出码都有其自己的含义。由于太长只列举出来前几个。
echo $? 查看最近一个进程的退出状态，查看到的是0 表示的就是成功。
同时我们还可以自己设置进程退出码以及它的含义。
enum{ success=0, open_err, malloc_err }; const char* errorTodesc(int code) { switch(code) { case success: return &#34;sucesss&#34;; case open_err: return &#34;open_fail&#34;; case malloc_err: return &#34;malloc_fail&#34;; dafault: return &#34;unknow error&#34;; } } int main() { int code = malloc_err; printf(&#34;%s\n&#34;,errorTodesc(code)); return malloc_err; } 除了进程退出，还有函数退出。 main函数退出表示进程结束，而函数退出仅仅表示函数调用完毕。函数也是有返回值的。调用函数一般我们通常想看到两种结果，第一函数执行结果 成功，或者失败。第二函数的执行情况，如打开一个文件，如果成功会返回一个文件指针，如果失败就会返回NULL。如：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/61b65124ba5c0ed2cb44c1ab453a8f13/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-04T21:36:07+08:00" />
<meta property="article:modified_time" content="2024-01-04T21:36:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux 进程(八) 进程的退出码</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>        main 函数的返回值叫做进程的退出码。当进程成功退出的时候，我们一般用0来表示。进程失败的时候一般用非零来表示。我们使用不同的数字来表示进程退出时不同的失败原因。</p> 
<p>        我们查看系统的有多少退出码以及其含义时需要用到strerror()  他的头文件和用法如下。</p> 
<p><img alt="" height="546" src="https://images2.imgbox.com/aa/1b/HL0zlPeW_o.png" width="1200"></p> 
<p>        通过一下代码来查看系统有多少退出码</p> 
<pre><code>#include&lt;stdio.h&gt;
#include&lt;unistd.h&gt;
#include&lt;errno.h&gt;
#include&lt;string.h&gt;
int main()
{


  int i = 0;
  for(i;i&lt;200;i++)
  {
    printf("%d:,%s\n",i,strerror(i));

  }
  return 0;
}
</code></pre> 
<p>        我们可以看到系统大概有134个退出码，每个退出码都有其自己的含义。由于太长只列举出来前几个。</p> 
<p class="img-center"><img alt="" height="350" src="https://images2.imgbox.com/fb/96/UKrsJXwM_o.png" width="285"></p> 
<p>         echo $?  查看最近一个进程的退出状态，查看到的是0 表示的就是成功。</p> 
<p class="img-center"><img alt="" height="64" src="https://images2.imgbox.com/23/39/bjW95OmD_o.png" width="588"></p> 
<p>        同时我们还可以自己设置进程退出码以及它的含义。</p> 
<pre><code>enum{
  success=0,
  open_err,
  malloc_err
};

const char* errorTodesc(int code)
{
  switch(code)
  {
    case success:
      return "sucesss";
    case open_err:
      return "open_fail";
    case malloc_err:
      return "malloc_fail";
    dafault:
      return "unknow error";

  }

}

int main()
{
  int code = malloc_err;
  printf("%s\n",errorTodesc(code));
  return malloc_err;
}
</code></pre> 
<p>       除了进程退出，还有函数退出。 main函数退出表示进程结束，而函数退出仅仅表示函数调用完毕。函数也是有返回值的。调用函数一般我们通常想看到两种结果，第一函数执行结果 成功，或者失败。第二函数的执行情况，如打开一个文件，如果成功会返回一个文件指针，如果失败就会返回NULL。如：</p> 
<p><img alt="" height="195" src="https://images2.imgbox.com/b8/16/EwqlvKEO_o.png" width="1200"></p> 
<p>        打印出错误码，并且打印出错误原因。 </p> 
<p class="img-center"><img alt="" height="67" src="https://images2.imgbox.com/78/10/5iMFcpHH_o.png" width="640"></p> 
<p>        通过以上我们列举的情况可以说明进程退出有三种情况</p> 
<p>        1.程序执行完，结果是正确的。</p> 
<p>        2.程序执行完，结果是错误的。</p> 
<p>        3.程序<strong>没</strong>执行完，程序就出现错误，结果无意义！！！</p> 
<p>        综上所述，只有当程序执行完的时候，结果才有意义。</p> 
<p>        进程出现退出是进程收到了异常的信号，每个信号都有不同的编号，每个编号都有自己的异常原因。</p> 
<p>        我们可以通过kill -l 查看有哪些信号：</p> 
<p><img alt="" height="441" src="https://images2.imgbox.com/13/13/FFfLsHwH_o.png" width="1200"></p> 
<p>        我们这次主要了解 8 号 和 11号信号，8号信号相当与代码除0 ，而十一号信号相当于对野指针进行解引用。</p> 
<p><strong>exit：</strong></p> 
<p><strong>       </strong> exit是终止进程 其中status：是进程退出时候的退出码。</p> 
<p><img alt="" height="235" src="https://images2.imgbox.com/28/bf/Lhqm17KK_o.png" width="874"></p> 
<p>        代码演示：</p> 
<p>       该进程只跑1秒就退出。<img alt="" height="430" src="https://images2.imgbox.com/a2/9e/ary4yQVT_o.png" width="1003"></p> 
<p class="img-center"><img alt="" height="64" src="https://images2.imgbox.com/fe/85/NYeWzJy3_o.png" width="579"></p> 
<p>        并且退出码显示为3。</p> 
<p>        同时，如果在while循环中调用一个函数，并且调用exit() 那么进程也会同样退出的。如下：</p> 
<p class="img-center"><img alt="" height="350" src="https://images2.imgbox.com/56/bb/16aVG61v_o.png" width="453"></p> 
<p>        <img alt="" height="67" src="https://images2.imgbox.com/a8/0a/D8ns6E8e_o.png" width="633"></p> 
<p>        说明exit 是终止整个进程，在任意地方调用都是终止进程。</p> 
<p><strong>_exit 与 exit</strong></p> 
<p><img alt="" class="right" height="99" src="https://images2.imgbox.com/f5/c2/owVvaPSm_o.png" width="300">        <img alt="" class="left" height="110" src="https://images2.imgbox.com/5f/27/teaOweCS_o.png" width="300"></p> 
<p>        他们两个的功能是一模一样的，exit是c语言给我们提供的接口，而_exit是linux系统给我们提供的接口，那么二者有什么区别呢？</p> 
<p>        看代码：</p> 
<p class="img-center"><img alt="" height="150" src="https://images2.imgbox.com/84/f8/ZpfByC9H_o.png" width="422"></p> 
<p><img alt="" height="73" src="https://images2.imgbox.com/3b/ae/gPCNnZtN_o.png" width="1038"></p> 
<p>        程序停止了3秒然后hello linux ，hello gm 才被打印到屏幕上。</p> 
<p class="img-center"><img alt="" height="150" src="https://images2.imgbox.com/a2/c0/lWX4CG8y_o.png" width="448"></p> 
<p><img alt="" height="70" src="https://images2.imgbox.com/40/5c/GNTjjZq5_o.png" width="667"></p> 
<p>        _exit 并没有把hello linux ，hello gm 打印到屏幕上，</p> 
<p><strong>        这是因为_exit 没有刷新缓冲去，而exit刷新了缓冲区，这也是他们的区别。</strong></p> 
<p></p> 
<p><strong>那么exit 和_exit 是什么关系呢。</strong></p> 
<p>        exit 和 _exit 都是终止进程的，在整个系统中只有操作系统能够有权限来终止进程。</p> 
<p>        而_exit是系统调用接口，exit是c语言提供的库函数，库函数是不能终止进程的，只有操作系统提供的系统调用才能够终止进程，那么他们的关系就比较明确了。</p> 
<p>        就是exit在底层封装了_exit ，同时exit 中又添加了刷新缓冲区的功能。</p> 
<p>        为什么语言层面要进行封装呢？</p> 
<p>        第一：<strong>提高了语言的跨平台性。window系统，和Linux系统给我们提供的退出进程的接口肯定是不一样的(比如：函数名，函数参数，函数返回值)。所以Linux下的退出进程函数，在Windo ws下注定是跑不了的，造成代码的可移植性较差。所以c语言把系统调用接口在底层进行封装，在上层直接给一个exit函数。在Linux下使用Linux系统的调用接口给exit，在windows下使用windo ws的系统调用接口给exit，这样做在底层屏蔽了系统之间的差异，提高了可移植性、跨平台性。比如Java的虚拟机，python的命令行解释器，c/c++的库，都是为了解决跨平台而提出的解决方案。他们都会提供exit的功能，底层也封装了不同系统的系统调用接口。</strong></p> 
<p>        第二：提高代码的可读性，降低程序员使用的门槛。</p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6411cc4910860660fc23ba1e3d4ac9a4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">算法基础之区间覆盖</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/45b8c98185541025f6b5ba023dd006c6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">力扣第一百道题，记录一下——x 的平方根</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>