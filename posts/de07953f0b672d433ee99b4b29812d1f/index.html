<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>VS2010 下C#调用与整合python函数 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="VS2010 下C#调用与整合python函数" />
<meta property="og:description" content="1.下载IronPython2.7(http://ironpython.codeplex.com/)
2.安装IronPython2.7
3.VS2010创建Console程式，参考引用C:/Program Files/IronPython 2.7/IronPython*.dll,Microsoft.*.dll
如：
4.Console代码如下
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using IronPython.Hosting;
using IronPython.Compiler;
using IronPython.Modules;
using IronPython.Runtime;
using Microsoft.Scripting;
using Microsoft.Scripting.Hosting;
namespace PythonConsole
{
class Program
{
static void Main(string[] args)
{
var engine = Python.CreateEngine();
var scope = engine.CreateScope();
//注意要有空格 否则会导致缩进对不上位置 即expected an indented block 错误
var py = &#34;def adder(arg1,arg2):\n&#34;&#43;&#34; return arg1 &#43; arg2 \n&#34;&#43;&#34;\n&#34;&#43;&#34;def hello(arg1):\n&#34;&#43;&#34; return &#39;hello&#39;&#43;arg1 \n&#34;&#43;&#34;\n&#34;&#43;&#34;class MyClass(object):\n&#34;&#43;&#34; def __init__(self,value):\n&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/de07953f0b672d433ee99b4b29812d1f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-05-31T18:13:21+08:00" />
<meta property="article:modified_time" content="2012-05-31T18:13:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">VS2010 下C#调用与整合python函数</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="article_title" style="margin:5px 0px; font-family:'Microsoft YaHei'; font-size:20px; line-height:30px; text-align:left"> 
</div> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left"> 1.下载IronPython2.7(<a href="http://ironpython.codeplex.com/" rel="nofollow" style="color:rgb(255,153,0); text-decoration:none">http://ironpython.codeplex.com/</a>)</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left"> 2.安装IronPython2.7</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left"> 3.VS2010创建Console程式，参考引用C:/Program Files/IronPython 2.7/IronPython*.dll,Microsoft.*.dll</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left"> 如：</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left"> <img src="" alt=""></p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left"> 4.Console代码如下</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left"> using System;<br> using System.Collections.Generic;<br> using System.Linq;<br> using System.Text;<br> <br> <br> using IronPython.Hosting;<br> using IronPython.Compiler;<br> using IronPython.Modules;<br> using IronPython.Runtime;<br> using Microsoft.Scripting;<br> using Microsoft.Scripting.Hosting;<br> namespace PythonConsole<br> {<!-- --><br>     class Program<br>     {<!-- --><br>         static void Main(string[] args)<br>         {<!-- --><br>             var engine = Python.CreateEngine();<br>             var scope = engine.CreateScope();<br>             //注意要有空格 否则会导致缩进对不上位置 即expected an indented block 错误<br>             var py = "def adder(arg1,arg2):\n"+"   return arg1 + arg2 \n"+"\n"+"def hello(arg1):\n"+"   return 'hello'+arg1 \n"+"\n"+"class MyClass(object):\n"+"  def __init__(self,value):\n"+"    self.value=value\n"; //__init__ 是两个下划线<br> <br> <br>             var code = engine.CreateScriptSourceFromString(py,SourceCodeKind.Statements);<br>             code.Execute(scope);<br>             var adder = scope.GetVariable&lt;Func&lt;object ,object,object &gt;&gt;("adder");<br>             var hello = scope.GetVariable&lt;Func&lt;object,object&gt;&gt;("hello");<br> <br> <br>             var myClass=scope.GetVariable&lt;Func&lt;object,object&gt;&gt;("MyClass");<br>             var myInstance = myClass("IronPython");<br> <br> <br>             Console.WriteLine(adder(1,2));<br>             Console.WriteLine(hello("Mark"));<br> <br> <br>             Console.WriteLine(engine.Operations.GetMember(myInstance,"value"));<br> <br> <br>             engine.CreateScriptSourceFromString("print 'Hello Python'").Execute();<br>             Console.WriteLine();<br>             engine.Execute("print 'Hello World'"); //严格要求 没有空格的地方不要加空格<br> <br> <br>             Dictionary&lt;string, object&gt; options = new Dictionary&lt;string, object&gt;();<br>             options["Debug"] = true;<br> <br> <br>             ScriptRuntime pyRuntime = Python.CreateRuntime(options);<br>             dynamic scriptScope = pyRuntime.UseFile("TestPython.py");<br>             Console.WriteLine(scriptScope.getYear());<br>             Console.ReadLine();<br> <br> <br>         }<br>     }<br> }<br> </p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left"> <br> </p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left"> 结果：</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left"> <img src="" alt=""></p> 
<div id="article_content" class="article_content" style="margin:20px 0px 0px; font-family:Arial; font-size:14px; line-height:26px; text-align:left"> 
 <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px"> </p> 
 <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px"> 而关键文件<span style="font-family:Arial; font-size:14px; line-height:26px; text-align:left">TestPython.py</span>必须要放在项目/bin/debug目录下</p> 
 <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px"> <a href="http://hi.csdn.net/attachment/201011/14/0_1289756955dIDz.gif" rel="nofollow" style="color:rgb(34,0,0); text-decoration:none"><img title="image" src="https://images2.imgbox.com/7f/ad/IBxASSIc_o.gif" border="0" alt="image" width="338" height="252" style="border:0px none; display:inline"></a></p> 
 <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px"> <br> </p> 
 <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px"> <span style="font-family:Arial; font-size:14px; line-height:26px; text-align:left">TestPython.py内容如下：</span><br> </p> 
 <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px"> def getYear():<br>    return 2012;<br> </p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1861082777c95e2c3fc3767688996a5c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">复习struts2之配置action范围国际化资源文件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/239a708a4b6f57b452d8e42da2cd8734/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python 与IronPython 简介与资源</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>