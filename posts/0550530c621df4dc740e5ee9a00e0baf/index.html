<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ORA-01722：无效数字ORA-06512：在“数据库名.包名”,line196 ORA-06512:在 line3 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ORA-01722：无效数字ORA-06512：在“数据库名.包名”,line196 ORA-06512:在 line3" />
<meta property="og:description" content="2019-04-11 Aurora 框架开发--租房信息管理系统踩坑
ORA-01722：无效数字ORA-06512：在“HEC3DEV.TRAIN_HRMS_CHECK_IN_PKG”,line196 ORA-06512:在 line3 问题所在：数据库存的字段类型为date类型，但是自己存储过程声明的变量为varchar2类型
数据类型不匹配。（第七行代码）变量声明改为date之后又报错为，本为number类型参数，但是接收到的数
据类型为date（第四十一行代码），应为在计算时间天数的时候使用了to_char()函数，将字段变量转为了
char类型
代码示例：
错误代码
--退房过程记录 procedure update_check_out(p_check_in_id number, p_contract_info_id number, p_check_in_date number, p_person_info_id number, p_house_info_id number, p_check_out_time varchar2,--错误变量类型 p_check_out_by number, p_last_updated_by number, --最后更新人 p_last_update_date date --最后更新时间 ) is v_residue_bed varchar2(30); v_check_in_time_from date; begin --更新人员状态 update train_hrms_person_info set person_status = &#39;ALREADY_CHECKOUT&#39;, last_updated_by = p_last_updated_by, last_update_date = sysdate where person_info_id = p_house_info_id; --更新房屋床位 select residue_bed into v_residue_bed from train_hrms_house_info where house_info_id = p_house_info_id; update train_hrms_house_info set residue_bed = v_residue_bed &#43; 1, last_updated_by = p_last_updated_by, last_update_date = sysdate where house_info_id = p_house_info_id; --更新入住过程 更新入住天数，和退房日期 select check_in_time_from into v_check_in_time_from from train_hrms_check_in_process where check_in_id = p_check_in_id; update train_hrms_check_in_process set check_in_date = (p_check_out_time - to_char(v_check_in_time_from)),--错误变量类型 check_out_time = p_check_out_time, check_out_by = p_check_out_by, last_updated_by = p_last_updated_by, last_update_date = sysdate where check_in_id = p_check_in_id; 正确代码" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/0550530c621df4dc740e5ee9a00e0baf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-04-11T17:13:14+08:00" />
<meta property="article:modified_time" content="2019-04-11T17:13:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ORA-01722：无效数字ORA-06512：在“数据库名.包名”,line196 ORA-06512:在 line3</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>2019-04-11 Aurora 框架开发--租房信息管理系统踩坑</p> 
<h3>ORA-01722：无效数字ORA-06512：在“HEC3DEV.TRAIN_HRMS_CHECK_IN_PKG”,line196 ORA-06512:在 line3</h3> 
<p> </p> 
<p><img alt="ORA-01722-踩坑" class="has" height="180" src="https://images2.imgbox.com/a2/52/5SiFV7qe_o.png" width="404"></p> 
<p>问题所在：数据库存的字段类型为<strong>date类型</strong>，但是自己存储过程声明的变量为<strong>varchar2</strong>类型</p> 
<p><strong>数据类型不匹配。</strong>（第七行代码）变量声明改为<strong>date</strong>之后又报错为，本为<strong>number类型参数</strong>，但是接收到的数</p> 
<p>据类型为<strong>date</strong>（第四十一行代码），应为在计算时间天数的时候使用了to_char()函数，将字段变量转为了</p> 
<p><strong>char类型</strong></p> 
<p> </p> 
<p>代码示例：</p> 
<p>错误代码</p> 
<pre class="has"><code class="language-sql">--退房过程记录
  procedure update_check_out(p_check_in_id      number,
                             p_contract_info_id number,
                             p_check_in_date    number,
                             p_person_info_id   number,
                             p_house_info_id    number,
			     p_check_out_time   varchar2,--错误变量类型
                             p_check_out_by     number,
                             p_last_updated_by  number, --最后更新人
                             p_last_update_date date --最后更新时间
                             ) is
    v_residue_bed        varchar2(30);
    v_check_in_time_from date;
  begin
    --更新人员状态
    update train_hrms_person_info
       set person_status    = 'ALREADY_CHECKOUT',
           last_updated_by  = p_last_updated_by,
           last_update_date = sysdate
     where person_info_id = p_house_info_id;
  
    --更新房屋床位
    select residue_bed
      into v_residue_bed
      from train_hrms_house_info
     where house_info_id = p_house_info_id;
  
    update train_hrms_house_info
       set residue_bed      = v_residue_bed + 1,
           last_updated_by  = p_last_updated_by,
           last_update_date = sysdate
     where house_info_id = p_house_info_id;
  
    --更新入住过程  更新入住天数，和退房日期
    select check_in_time_from
      into v_check_in_time_from
      from train_hrms_check_in_process
     where check_in_id = p_check_in_id;
    update train_hrms_check_in_process
       set check_in_date   =
	    (p_check_out_time - to_char(v_check_in_time_from)),--错误变量类型
           check_out_time   = p_check_out_time,
           check_out_by     = p_check_out_by,
           last_updated_by  = p_last_updated_by,
           last_update_date = sysdate
     where check_in_id = p_check_in_id;
</code></pre> 
<p> </p> 
<p>正确代码</p> 
<pre class="has"><code class="language-sql">--退房过程记录
  procedure update_check_out(p_check_in_id      number,
                             p_contract_info_id number,
                             p_check_in_date    number,
                             p_person_info_id   number,
                             p_house_info_id    number,
                             p_check_out_time   date,--正确代码
                             p_check_out_by     number,
                             p_last_updated_by  number, --最后更新人
                             p_last_update_date date --最后更新时间
                             ) is
    v_residue_bed        varchar2(30);
    v_check_in_time_from date;
  begin
    --更新人员状态
    update train_hrms_person_info
       set person_status    = 'ALREADY_CHECKOUT',
           last_updated_by  = p_last_updated_by,
           last_update_date = sysdate
     where person_info_id = p_house_info_id;
  
    --更新房屋床位
    select residue_bed
      into v_residue_bed
      from train_hrms_house_info
     where house_info_id = p_house_info_id;
  
    update train_hrms_house_info
       set residue_bed      = v_residue_bed + 1,
           last_updated_by  = p_last_updated_by,
           last_update_date = sysdate
     where house_info_id = p_house_info_id;
  
    --更新入住过程  更新入住天数，和退房日期
    select check_in_time_from
      into v_check_in_time_from
      from train_hrms_check_in_process
     where check_in_id = p_check_in_id;
    update train_hrms_check_in_process
       set check_in_date   =
           (p_check_out_time - v_check_in_time_from),--正确代码
           check_out_time   = p_check_out_time,
           check_out_by     = p_check_out_by,
           last_updated_by  = p_last_updated_by,
           last_update_date = sysdate
     where check_in_id = p_check_in_id;
</code></pre> 
<p> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b5cb66a07c79cb2ecbb72765a17b272b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">LLVM语言参考手册</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/293e9feb60e4740acc4fb92e1cd572bc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C#-Dapper查询mysql数据库可空的tinyint(1)报错：Error parsing column 11 (IsConvent=1 - SByte)指定类型转换无效</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>