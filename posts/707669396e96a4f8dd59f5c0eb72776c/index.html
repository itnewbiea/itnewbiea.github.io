<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>WEB-PUT练习 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="WEB-PUT练习" />
<meta property="og:description" content="HTTP协议中的PUT方法是将指定资源的内容替换为请求中所包含的新内容。PUT方法可以用于上传或更新文件，也可以用于创建新的资源。当PUT方法可用时，客户端可以将文件上传到Web服务器并将其存储为已命名的文件或文件夹。但在某些情况下，PUT方法可能会导致服务器安全漏洞，例如，PUT请求可能会导致服务器存储敏感信息或恶意代码。因此，在一些安全标准中，PUT方法被视为不安全的，很多Web服务器默认情况下是禁用PUT方法的。
[GDOUCTF 2023]EZ WEB 访问页面没事东西，源码提示就在眼前，看到了/src,访问是个py文件
import flask app = flask.Flask(__name__) @app.route(&#39;/&#39;, methods=[&#39;GET&#39;]) def index(): return flask.send_file(&#39;index.html&#39;) @app.route(&#39;/src&#39;, methods=[&#39;GET&#39;]) def source(): return flask.send_file(&#39;app.py&#39;) @app.route(&#39;/super-secret-route-nobody-will-guess&#39;, methods=[&#39;PUT&#39;]) def flag(): return open(&#39;flag&#39;).read() 这里我访问chat，我太菜了
这是一个使用 Flask 框架编写的 Python 代码，它创建了一个 Web 应用程序，并定义了三个路由：
&#34;/&#34; 路由：使用 GET 方法返回 &#34;index.html&#34; 文件。&#34;/src&#34; 路由：使用 GET 方法返回 &#34;app.py&#34; 文件。&#34;/super-secret-route-nobody-will-guess&#34; 路由：使用 PUT 方法打开名为 &#34;flag&#34; 的文件并将其中的内容返回给客户端。 可以看出，第三个路由是一个秘密路由，只有当请求方法为 PUT 并且路径为 &#34;/super-secret-route-nobody-will-guess&#34; 时才能访问。它会打开名为 &#34;flag&#34; 的文件并将其中的内容返回给客户端。这可能是一个漏洞，因为未对该路由进行身份验证或授权检查，攻击者可以通过篡改 HTTP 请求来绕过安全控制，获取敏感信息或执行恶意操作。
PUT请求？用bp抓包，改一下请求方式，然后改文件路径在发包，就返回falg了
[NSSRound#1 Basic]basic_check Dir没扫出来有用的东西
Nikto扫描扫描出PUT提交
这和上一题也是put提交，那么用bp抓一下，上传个shell?
上传成功
找到NSSCTF{0f3453aa-6199-442e-bb08-04d3cd2a2515}" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/707669396e96a4f8dd59f5c0eb72776c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-25T15:56:01+08:00" />
<meta property="article:modified_time" content="2023-04-25T15:56:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">WEB-PUT练习</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0px;text-align:left;"><span style="color:#000000;">HTTP</span><span style="color:#000000;">协议中的</span><span style="color:#000000;">PUT</span><span style="color:#000000;">方法是将指定资源的内容替换为请求中所包含的新内容。</span><span style="color:#000000;">PUT</span><span style="color:#000000;">方法可以用于上传或更新文件，也可以用于创建新的资源。当</span><span style="color:#000000;">PUT</span><span style="color:#000000;">方法可用时，客户端可以将文件上传到</span><span style="color:#000000;">Web</span><span style="color:#000000;">服务器并将其存储为已命名的文件或文件夹。但在某些情况下，</span><span style="color:#000000;">PUT</span><span style="color:#000000;">方法可能会导致服务器安全漏洞，例如，</span><span style="color:#000000;">PUT</span><span style="color:#000000;">请求可能会导致服务器存储敏感信息或恶意代码。因此，在一些安全标准中，</span><span style="color:#000000;">PUT</span><span style="color:#000000;">方法被视为不安全的，很多</span><span style="color:#000000;">Web</span><span style="color:#000000;">服务器默认情况下是禁用</span><span style="color:#000000;">PUT</span><span style="color:#000000;">方法的。</span></p> 
<h2 style="margin-left:0px;text-align:left;"><span style="color:#0d0016;"><strong>[GDOUCTF 2023]EZ WEB</strong></span></h2> 
<p style="margin-left:0;text-align:justify;">访问页面没事东西，源码提示就在眼前，看到了/src,访问是个py文件</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="552" src="https://images2.imgbox.com/8c/b9/6RZuUgIo_o.png" width="1200"></p> 
<pre><code>import flask
app = flask.Flask(__name__)
@app.route('/', methods=['GET'])
def index():
  return flask.send_file('index.html')
@app.route('/src', methods=['GET'])
def source():
  return flask.send_file('app.py')
@app.route('/super-secret-route-nobody-will-guess', methods=['PUT'])
def flag():
  return open('flag').read()</code></pre> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="485" src="https://images2.imgbox.com/3f/ff/JlX1sFVQ_o.png" width="786"></p> 
<div></div> 
<p style="margin-left:0;text-align:justify;">这里我访问chat，我太菜了</p> 
<div> 
 <p style="margin-left:0cm;"><span style="color:#0d0016;">这是一个使用 Flask 框架编写的 Python 代码，它创建了一个 Web 应用程序，并定义了三个路由：</span></p> 
</div> 
<div style="margin-left:18pt;"> 
 <ol><li><span style="color:#0d0016;">"/" 路由：使用 GET 方法返回 "index.html" 文件。</span></li><li><span style="color:#0d0016;">"/src" 路由：使用 GET 方法返回 "<a href="http://app.py/" rel="nofollow" title="app.py">app.py</a>" 文件。</span></li><li><span style="color:#0d0016;">"/super-secret-route-nobody-will-guess" 路由：使用 PUT 方法打开名为 "flag" 的文件并将其中的内容返回给客户端。</span></li></ol> 
</div> 
<div> 
 <p style="margin-left:0;"><span style="color:#0d0016;">可以看出，第三个路由是一个秘密路由，只有当请求方法为 PUT 并且路径为 "/super-secret-route-nobody-will-guess" 时才能访问。它会打开名为 "flag" 的文件并将其中的内容返回给客户端。这可能是一个漏洞，因为未对该路由进行身份验证或授权检查，攻击者可以通过篡改 HTTP 请求来绕过安全控制，获取敏感信息或执行恶意操作。</span></p> 
</div> 
<p style="margin-left:0;text-align:justify;">PUT请求？用bp抓包，改一下请求方式，然后改文件路径在发包，就返回falg了</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="599" src="https://images2.imgbox.com/f5/b3/JaN9bZQq_o.png" width="1200"></p> 
<h2 style="margin-left:0px;text-align:justify;"><span style="color:#0d0016;"><strong>[NSSRound#1 Basic]basic_check</strong></span></h2> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="283" src="https://images2.imgbox.com/f7/07/3d8l6SH5_o.png" width="1126"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#000000;">Dir</span></strong><strong><span style="color:#000000;">没扫出来有用的东西</span></strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="640" src="https://images2.imgbox.com/33/08/dfXKQ0QI_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#000000;">Nikto</span></strong><strong><span style="color:#000000;">扫描扫描出PUT提交</span></strong></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="97" src="https://images2.imgbox.com/90/0e/vdkLGuAH_o.png" width="865"><strong><span style="color:#000000;">这和上一题也是put提交，那么用bp抓一下，上传个shell?</span></strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="827" src="https://images2.imgbox.com/2c/ee/R0mOxgCe_o.png" width="1200"><strong><span style="color:#000000;">上传成功</span></strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="791" src="https://images2.imgbox.com/76/4c/YLrWCT31_o.png" width="1165"></p> 
<p style="margin-left:0;text-align:justify;"><strong><span style="color:#000000;">找到NSSCTF{0f3453aa-6199-442e-bb08-04d3cd2a2515}</span></strong></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="131" src="https://images2.imgbox.com/18/26/JM9G4ICJ_o.png" width="690"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/666ea06b3545e64a11964ef4785d7f9c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ORA-12704字符集不匹配 问题解决</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f3ca713cf654e519944ffef746b57434/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Reactor第八篇】WebFlux 服务编排</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>