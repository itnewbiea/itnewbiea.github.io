<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>jmeter实现接口AES加密解密 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="jmeter实现接口AES加密解密" />
<meta property="og:description" content="项目背景：
1.接口请求参数需加密，不是单个参数加密，而是多个参数整串加密。
2.接口返回的数据也是加密过的，不是整个返回结果加密，而是部分数据加密。
需求：
为方便测试，需要实现在发起请求时自动加密，得到返回结果后自动解密。
需准备的资源：
开发的加密解密方法以及密钥，可以是Java文件也可以是jar包（本次主要记录java文件的实现方式）
使用到的元件：
beanshell preprocessor用于加密请求参数
beanshell postprocessor用于解密返回结果
user parameters用于存放jmeter变量
csv data set config用于存放测试数据
debug sampler用于查看变量值
实现步骤：
1.在线程组下新建一个http请求，新建user parameters，添加变量body存放需要加密的请求参数
2.新建一个beanshell preprocessor写入加密方法后（如果是jar包直接引入即可），添加如下代码
System.out.println(&#34;**加密**&#34;);//打印 String password=&#34;1234567812345678&#34;;//加密密钥 System.out.println(&#34;Get my originaldata: &#34; &#43; vars.get(&#34;body&#34;));//打印查看数据，body为需要加密的串 String encode=AESUtil.encrypt(vars.get(&#34;body&#34;),password);//使用加密密钥对body加密赋给encode vars.put(&#34;body&#34;,encode);//将加密过的参数放入jmeter变量body中 3.添加 beanshell postprocessor，输入解密方法（或引入jar包），并添加如下代码，使用如下代码需要引入fastjson的jar包，将下载的fastjson-1.2.58.jar放入jmeter的lib目录下
import com.alibaba.fastjson.JSONObject; import com.alibaba.fastjson.JSON;	System.out.println(&#34;**解密**&#34;);//打印 String password=&#34;1234567812345678&#34;;//解密密钥 String response_data = prev.getResponseDataAsString();//获取接口返回结果 JSONObject obj = JSON.parseObject(response_data);//将返回结果转换为json对象 String body = obj.getString(&#34;body&#34;);//提取要解密的参数body String decryptbody=AESUtil.decrypt(body,password);//使用解密密钥对body进行解密 obj.put(&#34;body&#34;,JSON.parseObject(decryptbody));//将解密后的body转为json对象赋给变量body prev.setResponseData(obj.toJSONString(),&#34;UTF-8&#34;);//设置返回结果 4.添加csv data set config，将body中需要参数化的数据参数化
如{&#34;data&#34;:{&#34;version&#34;:&#34;200&#34;,&#34;account&#34;:&#34;${account}&#34;,&#34;password&#34;:&#34;${password}&#34;}}
5.添加View Results Tree查看结果，可以看到请求参数已加密，返回结果已解密" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8c7bcf7adf2f83b031f7817d54847f51/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-05-10T18:11:26+08:00" />
<meta property="article:modified_time" content="2019-05-10T18:11:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">jmeter实现接口AES加密解密</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>项目背景：</strong><br> 1.接口请求参数需加密，不是单个参数加密，而是多个参数整串加密。<br> 2.接口返回的数据也是加密过的，不是整个返回结果加密，而是部分数据加密。</p> 
<p><strong>需求：</strong><br> 为方便测试，需要实现在发起请求时自动加密，得到返回结果后自动解密。</p> 
<p><strong>需准备的资源：</strong><br> 开发的加密解密方法以及密钥，可以是Java文件也可以是jar包（本次主要记录java文件的实现方式）</p> 
<p><strong>使用到的元件：</strong><br> beanshell preprocessor用于加密请求参数<br> beanshell postprocessor用于解密返回结果<br> user parameters用于存放jmeter变量<br> csv data set config用于存放测试数据<br> debug sampler用于查看变量值</p> 
<p><strong>实现步骤：</strong><br> 1.在线程组下新建一个http请求，新建user parameters，添加变量body存放需要加密的请求参数</p> 
<p><img alt="" class="has" height="231" src="https://images2.imgbox.com/29/06/PJ4xDLJ8_o.png" width="804"></p> 
<p>2.新建一个beanshell preprocessor写入加密方法后（如果是jar包直接引入即可），添加如下代码</p> 
<pre class="has"><code class="language-java">System.out.println("**加密**");//打印
String password="1234567812345678";//加密密钥
System.out.println("Get my originaldata: " + vars.get("body"));//打印查看数据，body为需要加密的串
String encode=AESUtil.encrypt(vars.get("body"),password);//使用加密密钥对body加密赋给encode
vars.put("body",encode);//将加密过的参数放入jmeter变量body中</code></pre> 
<p><img alt="" class="has" height="300" src="https://images2.imgbox.com/f1/68/LmdWo0Gm_o.png" width="998"></p> 
<p>3.添加 beanshell postprocessor，输入解密方法（或引入jar包），并添加如下代码，使用如下代码需要引入fastjson的jar包，将下载的fastjson-1.2.58.jar放入jmeter的lib目录下</p> 
<pre class="has"><code class="language-java">        import com.alibaba.fastjson.JSONObject;
        import com.alibaba.fastjson.JSON;	
        System.out.println("**解密**");//打印
	String password="1234567812345678";//解密密钥
	String response_data = prev.getResponseDataAsString();//获取接口返回结果
	JSONObject obj = JSON.parseObject(response_data);//将返回结果转换为json对象
	String body = obj.getString("body");//提取要解密的参数body
	String decryptbody=AESUtil.decrypt(body,password);//使用解密密钥对body进行解密
	obj.put("body",JSON.parseObject(decryptbody));//将解密后的body转为json对象赋给变量body
	prev.setResponseData(obj.toJSONString(),"UTF-8");//设置返回结果</code></pre> 
<p><img alt="" class="has" height="396" src="https://images2.imgbox.com/19/82/BJxnSDTX_o.png" width="850"></p> 
<p>4.添加csv data set config，将body中需要参数化的数据参数化<br> 如{"data":{"version":"200","account":"${account}","password":"${password}"}}</p> 
<p><img alt="" class="has" height="274" src="https://images2.imgbox.com/50/c7/7yRYuQmW_o.png" width="941"></p> 
<p>5.添加View Results Tree查看结果，可以看到请求参数已加密，返回结果已解密</p> 
<p><img alt="" class="has" height="289" src="https://images2.imgbox.com/2e/be/jEVJy6SQ_o.png" width="991"></p> 
<p> <img alt="" class="has" height="296" src="https://images2.imgbox.com/f2/8f/BFjII46A_o.png" width="829"></p> 
<p>参考资料：<a href="https://www.jianshu.com/p/597f127f38d9" rel="nofollow">https://www.jianshu.com/p/597f127f38d9</a> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0bc1b2e9f2fca806529c5b239efe91a8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">String字符串截取方式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cae4e00f984f65fd531764d778041f0c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">编码问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>