<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>STM32  用定时器产生1Mhz 脉冲， - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="STM32  用定时器产生1Mhz 脉冲，" />
<meta property="og:description" content="STM32 用定时器产生1Mhz 脉冲，PWM宽度可调，四路输出
源码：记得要加入文件 gpio rcc tim 等c文件 #include &#34;stm32f10x_conf.h&#34;
void GPIO_CFG(void); void RCC_CFG(void); void TIM_CFG(void); void NVIC_Configuration(void); int main (void) { RCC_CFG(); NVIC_Configuration(); GPIO_CFG(); TIM_CFG(); TIM_Cmd(TIM3,ENABLE); TIM_CtrlPWMOutputs(TIM3,ENABLE); //while(1); } void RCC_CFG(void) { SystemInit(); RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA|RCC_APB2Periph_GPIOB,ENABLE); RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM3,ENABLE); } void GPIO_CFG(void) { GPIO_InitTypeDef GPIO_InitStructure; GPIO_InitStructure.GPIO_Pin=GPIO_Pin_6|GPIO_Pin_7; GPIO_InitStructure.GPIO_Speed=GPIO_Speed_50MHz; GPIO_InitStructure.GPIO_Mode=GPIO_Mode_AF_PP; GPIO_Init(GPIOA,&amp;GPIO_InitStructure); GPIO_InitStructure.GPIO_Pin=GPIO_Pin_0|GPIO_Pin_1; GPIO_InitStructure.GPIO_Speed=GPIO_Speed_50MHz; GPIO_InitStructure.GPIO_Mode=GPIO_Mode_AF_PP; GPIO_Init(GPIOB,&amp;GPIO_InitStructure); } void TIM_CFG(void) { TIM_TimeBaseInitTypeDef TIM_TimeBaseStructure; TIM_OCInitTypeDef TIM_OCInitStructure; // TIM_Period 计数值，比如 TIM_Period=17 分频参数 TIM_Prescaler=3 （0为不分频），APB1 时钟是72Mhz，
//在本参数情况下， 72Mhz/（17&#43;1）/（3&#43;1）= 1Mhz" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e0439e4424980298e35250387a693df4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-10-04T10:55:30+08:00" />
<meta property="article:modified_time" content="2014-10-04T10:55:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">STM32  用定时器产生1Mhz 脉冲，</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><br> </p> 
<p>STM32  用定时器产生1Mhz 脉冲，PWM宽度可调，四路输出<br> </p> 
<p><br> </p> 
<p>源码：记得要加入文件 gpio  rcc  tim 等c文件 </p> 
<p>#include "stm32f10x_conf.h"</p> void GPIO_CFG(void); 
<br> void RCC_CFG(void); 
<br> void TIM_CFG(void); 
<br> void NVIC_Configuration(void); 
<br> 
<br> 
<br> int main (void) 
<br> { 
<br>    
<br>  RCC_CFG(); 
<br>  NVIC_Configuration(); 
<br>  GPIO_CFG(); 
<br>  TIM_CFG();   
<br>  TIM_Cmd(TIM3,ENABLE); 
<br>  TIM_CtrlPWMOutputs(TIM3,ENABLE); 
<br>   //while(1);  
<br> }  
<br> void RCC_CFG(void) 
<br>  { 
<br>     SystemInit(); 
<br>     RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA|RCC_APB2Periph_GPIOB,ENABLE); 
<br>     RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM3,ENABLE); 
<br>  } 
<br>   
<br> void GPIO_CFG(void) 
<br>   { 
<br>     GPIO_InitTypeDef GPIO_InitStructure; 
<br>   
<br>     GPIO_InitStructure.GPIO_Pin=GPIO_Pin_6|GPIO_Pin_7; 
<br>     GPIO_InitStructure.GPIO_Speed=GPIO_Speed_50MHz; 
<br>     GPIO_InitStructure.GPIO_Mode=GPIO_Mode_AF_PP; 
<br>     GPIO_Init(GPIOA,&amp;GPIO_InitStructure); 
<br>        
<br>     GPIO_InitStructure.GPIO_Pin=GPIO_Pin_0|GPIO_Pin_1; 
<br>     GPIO_InitStructure.GPIO_Speed=GPIO_Speed_50MHz; 
<br>     GPIO_InitStructure.GPIO_Mode=GPIO_Mode_AF_PP; 
<br>     GPIO_Init(GPIOB,&amp;GPIO_InitStructure); 
<br>  } 
<br> void TIM_CFG(void) 
<br>  { 
<br>     TIM_TimeBaseInitTypeDef TIM_TimeBaseStructure; 
<br>     TIM_OCInitTypeDef TIM_OCInitStructure; 
<br>      
<br> 
<p>    // TIM_Period 计数值，比如  TIM_Period=17   分频参数 TIM_Prescaler=3 （0为不分频），APB1 时钟是72Mhz，</p> 
<p>    //在本参数情况下， 72Mhz/（17+1）/（3+1）= 1Mhz</p> 
<p>    // 理论最大频率是 72/(1+1)/1=36Mhz     TIM_Period=1     TIM_Prescaler=0 ,产生的方波可能是三角形的，用模拟示波器才能看出来，数字逻辑分析仪看不错，</p> 
<p>    // 5Mhz以内的方波应该没问题，如果要产生高频率的方波，感觉应该用SPI的数据时钟来实现</p>       
<br>     TIM_TimeBaseStructure.TIM_Period=17;    //  TIM_Period=70;    TIM_Prescaler=0;    输出1Mhz时钟 
<br>     TIM_TimeBaseStructure.TIM_Prescaler=3; 
<br>     TIM_TimeBaseStructure.TIM_ClockDivision=0x00; 
<br>     TIM_TimeBaseStructure.TIM_CounterMode=TIM_CounterMode_Up; 
<br>     TIM_TimeBaseStructure.TIM_RepetitionCounter=0x00; 
<br>     TIM_TimeBaseInit(TIM3,&amp;TIM_TimeBaseStructure); 
<br>    
<br>     TIM_OCInitStructure.TIM_OCMode=TIM_OCMode_PWM1; 
<br>     TIM_OCInitStructure.TIM_OCPolarity=TIM_OCPolarity_High; 
<br>     TIM_OCInitStructure.TIM_OutputState=TIM_OutputState_Enable;      
<br>       
<br>     // TIM_Pulse的值不可大于TIM_Period 
<br>     TIM_OCInitStructure.TIM_Pulse=60;      //PA.6 
<br>     TIM_OC1Init(TIM3,&amp;TIM_OCInitStructure);     
<br>   
<br>    
<br>     TIM_OCInitStructure.TIM_Pulse=35;   //PA.7 
<br>     TIM_OC2Init(TIM3,&amp;TIM_OCInitStructure);    
<br>     
<br>     TIM_OCInitStructure.TIM_Pulse=18;   //PB.0 
<br>     TIM_OC3Init(TIM3,&amp;TIM_OCInitStructure);  
<br>    
<br>     TIM_OCInitStructure.TIM_Pulse=9;   //PB.1 
<br>     TIM_OC4Init(TIM3,&amp;TIM_OCInitStructure);       
<br> 
<br> 
<br> 
<br> 
<br>  } 
<br>   
<br>   
<span style="white-space:pre"></span>//配置中断向量表。决定将程序下载到RAM中还是FLASH中。 
<br> void NVIC_Configuration(void) 
<br> { 
<br> 
<span style="white-space:pre"></span>#ifdef  VECT_TAB_RAM   
<br> 
<span style="white-space:pre"></span>/* Set the Vector Table base location at 0x20000000 */  
<br> 
<span style="white-space:pre"></span>NVIC_SetVectorTable(NVIC_VectTab_RAM, 0x0);  
<br> 
<span style="white-space:pre"></span>#else  /* VECT_TAB_FLASH  */ 
<br> 
<span style="white-space:pre"></span>/* Set the Vector Table base location at 0x08000000 */  
<br> 
<span style="white-space:pre"></span>NVIC_SetVectorTable(NVIC_VectTab_FLASH, 0x0);    
<br> 
<span style="white-space:pre"></span>#endif 
<br> } 
<br> 
<br> 
<br>  
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8c6a194339b457bdc063289c70cb06c7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android：AppWidget之桌面小电筒</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5afdbdd0bc20808ebb13ea4cb50a8470/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C语言中库函数自带的排序函数qsort</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>