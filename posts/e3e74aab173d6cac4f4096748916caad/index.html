<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>手把手教你SAM(segment anything)官方代码本地调用 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="手把手教你SAM(segment anything)官方代码本地调用" />
<meta property="og:description" content="更新一下如何下载官方本地github代码并在本地进行调用，更新的比较晚，截止发布前已经有28.1k的star了。接下来教大家如何分割一切！
首先我们可以下载SAM在官方的代码链接：https://github.com/facebookresearch/segment-anything
下载好之后需要配置一下SAM需要的环境，用pycharm打开配置虚拟环境，基本上还是比较基础的库的，下载安装好即可，如何有不会安装的可以评论或者csdn里面搜一下看看
pip install git&#43;https://github.com/facebookresearch/segment-anything.git 主要给大家介绍讲解一下如何在本地批量用SAM模型进行分割，如果光在demo上一张一张upload效率实在太慢，也不知道在自己数据集上效果如何，可以批量生成然后看看。
首先，我们需要下载官方给的权重pth下载链接，我下的是VIT-H的链接，大家可以直接点该下载链接进行下载，其他权重文件可以在给的readme.md上的链接下载。如果需要国内下载的话也可以评论留言我可以上传到百度网盘大家进行下载。
下载好权重文件之后，我们就开始配置并调用SAM，主要的文件其实就在amg.py上面进行配置运行即可，其他文件大家有兴趣的可以仔细阅读一下了解了解。
我们下好相应的权重文件后，记得在amg.py的文件里也配置好相应的配置文件，下面我把我在本地运行成功的配置数据和相应结果放在下面，大家可以参考一下。
主要我们就需要一个input文件，放入我们需要分割的文件路径，最好是jpg,png格式的，可以看官方支持什么格式，还有一个output文件路径，放入我们结果生成的文件。model-type就是刚才说的权重文件的类型，我下的是vit-h所以选的是这个，大家下的什么类型填什么类型即可。checkpoint就是权重文件路径，刚才下载的文件，把路径放进去即可。
parser.add_argument( &#34;--input&#34;, type=str, required=False, default=r&#39;D:\DATA\AllData\QAdata\JPEGImages&#39;, help=&#34;Path to either a single input image or folder of images.&#34;, ) parser.add_argument( &#34;--output&#34;, type=str, required=False, default=r&#39;D:\DATA\AllData\QAdata\JPEGImages\result&#39;, help=( &#34;Path to the directory where masks will be output. Output will be either a folder &#34; &#34;of PNGs per image or a single json with COCO-style masks.&#34; ), ) parser.add_argument( &#34;--model-type&#34;, type=str, required=False, default=&#39;vit_h&#39;, help=&#34;The type of model to load, in [&#39;default&#39;, &#39;vit_h&#39;, &#39;vit_l&#39;, &#39;vit_b&#39;]&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e3e74aab173d6cac4f4096748916caad/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-19T15:06:00+08:00" />
<meta property="article:modified_time" content="2023-04-19T15:06:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">手把手教你SAM(segment anything)官方代码本地调用</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>更新一下如何下载官方本地github代码并在本地进行调用，更新的比较晚，截止发布前已经有28.1k的star了。接下来教大家如何分割一切！</p> 
<p> </p> 
<p class="img-center"><img alt="" height="108" src="https://images2.imgbox.com/23/75/qscdRfKU_o.png" width="666"></p> 
<p>首先我们可以下载SAM在官方的代码链接：<a class="link-info" href="https://github.com/facebookresearch/segment-anything" title="https://github.com/facebookresearch/segment-anything">https://github.com/facebookresearch/segment-anything</a></p> 
<p></p> 
<p>下载好之后需要配置一下SAM需要的环境，用pycharm打开配置虚拟环境，基本上还是比较基础的库的，下载安装好即可，如何有不会安装的可以评论或者csdn里面搜一下看看</p> 
<pre><code class="language-python">pip install git+https://github.com/facebookresearch/segment-anything.git</code></pre> 
<p>主要给大家介绍讲解一下如何在本地批量用SAM模型进行分割，如果光在demo上一张一张upload效率实在太慢，也不知道在自己数据集上效果如何，可以批量生成然后看看。</p> 
<p>首先，我们需要下载官方给的权重pth下载链接，我下的是VIT-H的链接，大家可以直接点<a class="link-info" href="https://dl.fbaipublicfiles.com/segment_anything/sam_vit_h_4b8939.pth" rel="nofollow" title="该下载链接">该下载链接</a>进行下载，其他权重文件可以在给的readme.md上的链接下载。如果需要国内下载的话也可以评论留言我可以上传到百度网盘大家进行下载。</p> 
<p>下载好权重文件之后，我们就开始配置并调用SAM，主要的文件其实就在amg.py上面进行配置运行即可，其他文件大家有兴趣的可以仔细阅读一下了解了解。</p> 
<p>我们下好相应的权重文件后，记得在amg.py的文件里也配置好相应的配置文件，下面我把我在本地运行成功的配置数据和相应结果放在下面，大家可以参考一下。</p> 
<p>主要我们就需要一个input文件，放入我们需要分割的文件路径，最好是jpg,png格式的，可以看官方支持什么格式，还有一个output文件路径，放入我们结果生成的文件。model-type就是刚才说的权重文件的类型，我下的是vit-h所以选的是这个，大家下的什么类型填什么类型即可。checkpoint就是权重文件路径，刚才下载的文件，把路径放进去即可。</p> 
<pre><code class="language-python">
parser.add_argument(
    "--input",
    type=str,
    required=False,
    default=r'D:\DATA\AllData\QAdata\JPEGImages',
    help="Path to either a single input image or folder of images.",
)

parser.add_argument(
    "--output",
    type=str,
    required=False,
    default=r'D:\DATA\AllData\QAdata\JPEGImages\result',
    help=(
        "Path to the directory where masks will be output. Output will be either a folder "
        "of PNGs per image or a single json with COCO-style masks."
    ),
)

parser.add_argument(
    "--model-type",
    type=str,
    required=False,
    default='vit_h',
    help="The type of model to load, in ['default', 'vit_h', 'vit_l', 'vit_b']",
)

parser.add_argument(
    "--checkpoint",
    type=str,
    required=False,
    default=r'D:\PROJECT\SAM\segment-anything-main\sam_vit_h_4b8939.pth',
    help="The path to the SAM checkpoint to use for mask generation.",
)</code></pre> 
<p>需要提醒一下的是，官方给的readme.md文件上是下图用命令行运行的，在命令行内必须输入default值，但是可以在文件上把required改成False就不用强制输入了，像上图代码所示。</p> 
<pre><code class="language-python">python scripts/export_onnx_model.py --checkpoint &lt;path/to/checkpoint&gt; --model-type &lt;model_type&gt; --output &lt;path/to/output&gt;</code></pre> 
<p>配置好之后直接运行amg.py代码即可批量进行分割，很简单是不是！运行成功之后会用一个done！的提示，大家现在可以去分割一切了！</p> 
<p class="img-center"><img alt="" height="228" src="https://images2.imgbox.com/5e/6a/YuD3GBOs_o.png" width="460"></p> 
<p> 如果需要进一步了解代码，大家可以打断点看看如何实现分割的，目前官方代码还在更新阶段，具体模型实现结构等还没开源，相当于一个黑盒，大家只能调用，后续如果需要的话也会更新不同功能下的SAM，这个相当于demo中的分割everything。大家有什么不会的可以在底下评论留言，看到我就会回复，喜欢了关注一下点个赞收藏都可以~</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/aa509be81a27c6b7e9fbb8d939140eec/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">机器学习数据集哪家强？Sklearn预制的这16个数据集不容错过~</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2a30452a32656a55030e1eaa23d3170c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">10.网桥是什么？网桥和路由器及交换机的区别？以太网和令牌环网，nat，查公网ip等</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>