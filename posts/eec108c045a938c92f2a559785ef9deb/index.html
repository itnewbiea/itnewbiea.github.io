<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>oracle 游标(cursor)＆＆记录集(record) - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="oracle 游标(cursor)＆＆记录集(record)" />
<meta property="og:description" content="1.定义游标 cursor cursor_name is select_statement;
2.打开游标 执行对应的SELECT语句并将SELECT语句的结果暂时存放到结果集中.
open cursor_name;
3.提取数据 打开游标后,SELECT语句的结果被临时存放到游标结果集中,使用FETCH语句只能提取一行数据
通过使用FETCH..BULK COLLECT INTO语句每次可以提取多行数据
例子：
游标的使用步骤：
1.声明一个游标
2.打开游标 open 游标名（参数1，参数2..）;
3.使用循环遍历游标，从游标中取值。fetch 游标名 into 变量名，循环的退出条件是 游标名%notfound;
4.关闭游标 close 游标名；
cursor 游标名(游标输入参数) is select语句 -- 游标参数可以有多个 -------------------------------------- 游标中使用fetch..into语句:只能处理一行数据,除非用循环语句 -------------------------------------- --匿名块 declare --游标的定义 CURSOR emp_cur IS select empno,ename,job from scott.emp; emp_row emp_cur%rowtype;--定一个和游标一样类型的集合 BEGIN --打开游标 OPEN emp_cur; LOOP --提取游标中的数据到emp_row FETCH emp_cur into emp_row; EXIT WHEN emp_cur%notfound; dbms_output.put_line(emp_row.empno||&#39;,&#39;||emp_row.ename); END LOOP; --关闭游标 CLOSE emp_cur; END; ---- 或者 --- --匿名块 方法2 declare --游标的定义 CURSOR emp_cur IS select empno,ename,job from scott." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/eec108c045a938c92f2a559785ef9deb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-27T15:04:56+08:00" />
<meta property="article:modified_time" content="2023-07-27T15:04:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">oracle 游标(cursor)＆＆记录集(record)</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>1.定义游标</h4> 
<p>cursor cursor_name is select_statement;</p> 
<p><a name="_lab2_0_1"></a></p> 
<h4>2.打开游标</h4> 
<p>执行对应的SELECT语句并将SELECT语句的结果暂时存放到结果集中.</p> 
<p>open cursor_name;</p> 
<p><a name="_lab2_0_2"></a></p> 
<h4>3.提取数据</h4> 
<p>打开游标后,SELECT语句的结果被临时存放到游标结果集中,使用FETCH语句只能提取一行数据</p> 
<p>通过使用FETCH..BULK COLLECT INTO语句每次可以提取多行数据</p> 
<p><span style="color:#fe2c24;"><strong>例子：</strong></span></p> 
<p>　游标的使用步骤：</p> 
<p>　　　　　　1.声明一个游标</p> 
<p>　　　　　　2.打开游标 open 游标名（参数1，参数2..）;</p> 
<p>　　　　　　3.使用循环遍历游标，从游标中取值。fetch 游标名 into 变量名，循环的退出条件是 游标名%notfound;</p> 
<p>　　　　　　4.关闭游标 close 游标名；</p> 
<pre><code class="language-sql">cursor 游标名(游标输入参数)
is select语句
-- 游标参数可以有多个
--------------------------------------
游标中使用fetch..into语句:只能处理一行数据,除非用循环语句
--------------------------------------
--匿名块
declare
 --游标的定义
  CURSOR emp_cur IS
  select empno,ename,job from scott.emp;
 emp_row emp_cur%rowtype;--定一个和游标一样类型的集合
 BEGIN
  --打开游标
  OPEN emp_cur;
  LOOP
  --提取游标中的数据到emp_row
   FETCH emp_cur into emp_row;
   EXIT WHEN emp_cur%notfound;
   dbms_output.put_line(emp_row.empno||','||emp_row.ename);
  END LOOP;
  --关闭游标
  CLOSE emp_cur;
 END;
----
或者
--- 
--匿名块 方法2
declare
 --游标的定义
  CURSOR emp_cur IS
  select empno,ename,job from scott.emp;
 emp_row emp_cur%rowtype;--定一个和游标一样类型的集合
 BEGIN
  --打开游标
  OPEN emp_cur;
    FETCH emp_cur into emp_row;--预先Fetch一次
   while emp_cur%found LOOP
   dbms_output.put_line(emp_row.empno||','||emp_row.ename);
   FETCH emp_cur into emp_row;
  END LOOP;
  --关闭游标
  CLOSE emp_cur;
 END;
 --------</code></pre> 
<p>2.<strong>使用for循环遍历游标</strong></p> 
<p></p> 
<p>使用for循环遍历游标的好处：1.不用声明额外的变量，2.不用打开和关闭游标，3.写法简单。</p> 
<p>(使用FOR循环时,ORACLE会隐含的打开游标,提取游标数据并关闭游标。每循环一次提取一次数据，在提取了所有数据后,自动退出循环并隐含的关闭游标。)</p> 
<pre><code class="language-sql">--匿名块
declare
 --游标的定义
  CURSOR emp_cur IS
  select empno,ename,job from scott.emp;
 emp_row emp_cur%rowtype;--定一个和游标一样类型的集合
 BEGIN
  FOR row in emp_cur LOOP
   dbms_output.put_line(row.empno||','||row.ename);
  end loop
 END;</code></pre> 
<p>3.<strong>通过bulk collect减少loop处理的开销</strong></p> 
<pre><code class="language-sql">--匿名块
declare
 --游标的定义
  CURSOR emp_cur IS
  select empno,ename,job from scott.emp;
 type ename_table_type is table of emp_cur%rowtype ;
    ename_table ename_table_type;
 BEGIN
  --打开游标
  OPEN emp_cur;
  LOOP
  --提取游标中的数据到emp_row
   FETCH emp_cur bulk coollect into ename_table;
    for x in 1..ename_table.count loop
   dbms_output.put_line(ename_table(x).empno||','||ename_table(x).ename);
  END LOOP;
  --关闭游标
  CLOSE emp_cur;
 END;</code></pre> 
<p>记录（RECORD）</p> 
<p><strong>一，什么是记录（Record）？</strong><br>  由单行多列的标量构成的复合结构。可以看做是一种用户自定义数据类型。组成类似于多维数组。<br> 将一个或多个标量封装成一个对象进行操作。是一种临时复合对象类型。<br>  <br>  记录可以直接赋值。RECORD1 :=RECORD2；<br>  记录不可以整体比较.<br>  记录不可以整体判断为空。<br>  <br><strong>二，%ROWTYPE和记录（Record）？</strong><br>  请区别%ROWTYPE和记录（Record）类型。%ROWTYPE可以说是Record的升级简化版。<br>  区别在与前者结构为表结构，后者为自定义结构。二者在使用上没有很大区别。前者方便，后者灵活。在实际中根据情况来具体决定使用。<br>  Record + PL/SQL表可以进行数据的多行多列存储。</p> 
<pre><code class="language-sql">DECLARE
  Type MyRecType Is  Record
  (
   RENO  EMPA.EMPNO%Type,
   RENAME   VARCHAR2(10),
   RJOB   EMPA.JOB%Type
  );
  EmpRec MyRecType; 
 Begin
  Select   EMPNO, ENAME, JOB  InTo  EmpRec  From scott.emp Where empa.EMPNO = '7369';
  DBMS_OUTPUT.PUT_LINE(EmpRec.RENO||'  '||EmpRec.RENAME||'  '||EmpRec.RJOB);
  
  EmpRec.RENO  := 1321;
  EmpRec.RENAME := 'eaves';
  EmpRec.RJOB  := 'programer';

  DBMS_OUTPUT.PUT_LINE(EmpRec.RENO||'  '||EmpRec.RENAME||'  '||EmpRec.RJOB);
 End;</code></pre> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e8065fd0ec5769f71a4bd2f119079d59/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">开源预训练框架 MMPRETRAIN官方文档（概览、环境安装与验证、基础用户指南）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/77b31ac12eae3a84231bd3719ebc183c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">在 Vue3 中实现飘逸的元素拖拽</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>