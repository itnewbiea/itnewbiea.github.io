<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>antd vue form表单校验总结 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="antd vue form表单校验总结" />
<meta property="og:description" content="三种校验方式 使用提交按钮 案例常用，参考案例：表单的基本使用 &lt;a-button type=&#34;primary&#34; html-type=&#34;submit&#34;&gt;Submit&lt;/a-button&gt; 使用formRef 较为常用，参考案例：自定义校验规则&lt;a-form ref=&#34;formRef&#34; :model=&#34;modal.formQuery&#34;&gt; import type { FormInstance } from &#39;ant-design-vue&#39; const formRef = ref&lt;FormInstance&gt;() const testForm = () =&gt; { formRef.value ?.validate([&#39;word&#39;]) // 不加参数，会校验全部规则 .then((res) =&gt; { console.log(&#39;通过&#39;, res) }) .catch((err) =&gt; { console.log(&#39;失败&#39;, err) }) } // 子组件初始化示例 const init = () =&gt; { formRef.value?.resetFields() // 初始化重置表单 } defineExpose({ getLogisticsTemplateHandle }) // 导出该子组件方法 // 父组件监听方法 &lt;Child ref=&#34;childInitRef&#34; @init=&#34;childInit&#34; /&gt; import { nextTick } from &#39;vue&#39; type childTemplate = { init: () =&gt; void } const childInitRef = ref&lt;childTemplate&gt;() // 绑定子组件的ref const childInit = () =&gt; { nextTick(() =&gt; { if (childInitRef." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/cc9f7731f3ae07a380c8f4927dd0bcdd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-20T10:49:39+08:00" />
<meta property="article:modified_time" content="2023-09-20T10:49:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">antd vue form表单校验总结</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>三种校验方式</h3> 
<h4><a id="_1"></a>使用<code>提交按钮</code></h4> 
<ul><li>案例常用，参考案例：<a href="https://www.antdv.com/components/form-cn#components-form-demo-basic" rel="nofollow">表单的基本使用</a><pre><code class="prism language-ts">  <span class="token operator">&lt;</span>a<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> html<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">"submit"</span><span class="token operator">&gt;</span>Submit<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>button<span class="token operator">&gt;</span>
</code></pre> </li></ul> 
<h4><a id="formRef_6"></a>使用<code>formRef</code></h4> 
<ul><li>较为常用，参考案例：<a href="https://www.antdv.com/components/form-cn#components-form-demo-custom-validation" rel="nofollow">自定义校验规则</a><pre><code class="prism language-ts"><span class="token operator">&lt;</span>a<span class="token operator">-</span>form ref<span class="token operator">=</span><span class="token string">"formRef"</span> <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">"modal.formQuery"</span><span class="token operator">&gt;</span>

<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{<!-- --></span> FormInstance <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ant-design-vue'</span>

<span class="token keyword">const</span> formRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>FormInstance<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">testForm</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  formRef<span class="token punctuation">.</span>value
    <span class="token operator">?.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'word'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">// 不加参数，会校验全部规则</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'通过'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'失败'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 子组件初始化示例</span>
<span class="token keyword">const</span> <span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  formRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">resetFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 初始化重置表单</span>
<span class="token punctuation">}</span>
<span class="token function">defineExpose</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> getLogisticsTemplateHandle <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 导出该子组件方法</span>

<span class="token comment">// 父组件监听方法</span>
<span class="token operator">&lt;</span>Child ref<span class="token operator">=</span><span class="token string">"childInitRef"</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">init</span></span><span class="token operator">=</span><span class="token string">"childInit"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> nextTick <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
 
<span class="token keyword">type</span> <span class="token class-name">childTemplate</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> childInitRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>childTemplate<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 绑定子组件的ref</span>
<span class="token keyword">const</span> <span class="token function-variable function">childInit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>childInitRef<span class="token punctuation">.</span>value<span class="token punctuation">)</span> childInitRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 直接调用子组件的init初始化方法</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> </li></ul> 
<h4><a id="useForm_46"></a>使用<code>useForm</code></h4> 
<ul><li>可参考案例：<a href="https://www.antdv.com/components/form-cn#components-form-demo-useForm-basic" rel="nofollow">useForm 基本表单</a>、<a href="https://www.antdv.com/components/form-cn#useForm-v2-2" rel="nofollow">useForm的API</a></li></ul> 
<pre><code class="prism language-ts"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>a<span class="token operator">-</span>form <span class="token operator">:</span>label<span class="token operator">-</span>col<span class="token operator">=</span><span class="token string">"labelCol"</span> <span class="token operator">:</span>wrapper<span class="token operator">-</span>col<span class="token operator">=</span><span class="token string">"wrapperCol"</span><span class="token operator">&gt;</span>
    <span class="token comment">// 使用 v-bind="validateInfos.type" 绑定需要校验的数据</span>
    <span class="token operator">&lt;</span>a<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">"Activity name"</span> v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">"validateInfos.name"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>a<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">"modelRef.name"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>a<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">"Activity zone"</span> v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">"validateInfos.region"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>a<span class="token operator">-</span>select v<span class="token operator">-</span>model<span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">"modelRef.region"</span> placeholder<span class="token operator">=</span><span class="token string">"please select your zone"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>a<span class="token operator">-</span>select<span class="token operator">-</span>option value<span class="token operator">=</span><span class="token string">"shanghai"</span><span class="token operator">&gt;</span>Zone one<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>select<span class="token operator">-</span>option<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>a<span class="token operator">-</span>select<span class="token operator">-</span>option value<span class="token operator">=</span><span class="token string">"beijing"</span><span class="token operator">&gt;</span>Zone two<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>select<span class="token operator">-</span>option<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>select<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>a<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">"Activity type"</span> v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">"validateInfos.type"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>a<span class="token operator">-</span>checkbox<span class="token operator">-</span>group v<span class="token operator">-</span>model<span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">"modelRef.type"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>a<span class="token operator">-</span>checkbox value<span class="token operator">=</span><span class="token string">"1"</span> name<span class="token operator">=</span><span class="token string">"type"</span><span class="token operator">&gt;</span>Online<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>checkbox<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>a<span class="token operator">-</span>checkbox value<span class="token operator">=</span><span class="token string">"2"</span> name<span class="token operator">=</span><span class="token string">"type"</span><span class="token operator">&gt;</span>Promotion<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>checkbox<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>a<span class="token operator">-</span>checkbox value<span class="token operator">=</span><span class="token string">"3"</span> name<span class="token operator">=</span><span class="token string">"type"</span><span class="token operator">&gt;</span>Offline<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>checkbox<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>checkbox<span class="token operator">-</span>group<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>a<span class="token operator">-</span>form<span class="token operator">-</span>item <span class="token operator">:</span>wrapper<span class="token operator">-</span>col<span class="token operator">=</span><span class="token string">"{ span: 14, offset: 4 }"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>a<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token punctuation">.</span>prevent<span class="token operator">=</span><span class="token string">"onSubmit"</span><span class="token operator">&gt;</span>Create<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>a<span class="token operator">-</span>button style<span class="token operator">=</span><span class="token string">"margin-left: 10px"</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">"resetFields"</span><span class="token operator">&gt;</span>Reset<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>form<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> defineComponent<span class="token punctuation">,</span> reactive<span class="token punctuation">,</span> toRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> Form <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ant-design-vue'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> useForm <span class="token operator">=</span> Form<span class="token punctuation">.</span>useForm<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> modelRef <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      name<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
      region<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
      type<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> rulesRef <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      name<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
          required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          message<span class="token operator">:</span> <span class="token string">'Please input name'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      region<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
          required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          message<span class="token operator">:</span> <span class="token string">'Please select region'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      type<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
          required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          message<span class="token operator">:</span> <span class="token string">'Please select type'</span><span class="token punctuation">,</span>
          type<span class="token operator">:</span> <span class="token string">'array'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 引入需要的方法，validateInfos绑定校验数据、validate规则验证、resetFields重置表单</span>
    <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> resetFields<span class="token punctuation">,</span> validate<span class="token punctuation">,</span> validateInfos <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useForm</span><span class="token punctuation">(</span>modelRef<span class="token punctuation">,</span> rulesRef<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function-variable function">onValidate</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">onSubmit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 直接使用引入的`validate`进行校验</span>
      <span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">toRaw</span><span class="token punctuation">(</span>modelRef<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>err <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      labelCol<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> span<span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      wrapperCol<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> span<span class="token operator">:</span> <span class="token number">14</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      validateInfos<span class="token punctuation">,</span>
      resetFields<span class="token punctuation">,</span>
      modelRef<span class="token punctuation">,</span>
      onSubmit<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="rules_133"></a>两种<code>rules</code>定义方式</h3> 
<h4><a id="formitem_134"></a>定义在<code>form-item</code></h4> 
<ul><li>通常搭配<code>提交按钮</code>、<code>校验通过</code>或<code>校验失败</code>等方法使用<pre><code class="prism language-ts"><span class="token operator">&lt;</span>a<span class="token operator">-</span>form<span class="token operator">-</span>item
  label<span class="token operator">=</span><span class="token string">"Username"</span>
  name<span class="token operator">=</span><span class="token string">"username"</span>
  <span class="token operator">:</span>rules<span class="token operator">=</span><span class="token string">"[{ required: true, message: 'Please input your username!' }]"</span>
<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>a<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">"formState.username"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
</code></pre> </li></ul> 
<h4><a id="form_145"></a>定义在<code>form</code></h4> 
<ul><li>使用频率较高，便于统一管理校验规则<pre><code class="prism language-ts"><span class="token operator">&lt;</span>a<span class="token operator">-</span>form
ref<span class="token operator">=</span><span class="token string">"formRef"</span>
name<span class="token operator">=</span><span class="token string">"custom-validation"</span>
<span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">"formState"</span>
<span class="token operator">:</span>rules<span class="token operator">=</span><span class="token string">"rules"</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">finish</span></span><span class="token operator">=</span><span class="token string">"handleFinish"</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">validate</span></span><span class="token operator">=</span><span class="token string">"handleValidate"</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">finishFailed</span></span><span class="token operator">=</span><span class="token string">"handleFinishFailed"</span>
<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>form<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{<!-- --></span> Rule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ant-design-vue/es/form'</span>

<span class="token comment">// 统一定义一个`rules`</span>
<span class="token keyword">const</span> rules<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> Rule<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  pass<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> validator<span class="token operator">:</span> validatePass<span class="token punctuation">,</span> trigger<span class="token operator">:</span> <span class="token string">'change'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  checkPass<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> validator<span class="token operator">:</span> validatePass2<span class="token punctuation">,</span> trigger<span class="token operator">:</span> <span class="token string">'change'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> validator<span class="token operator">:</span> checkAge<span class="token punctuation">,</span> trigger<span class="token operator">:</span> <span class="token string">'change'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">// 提取`validator`规则，独立定义`pass`</span>
 <span class="token keyword">const</span> <span class="token function-variable function">validatePass</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>_rule<span class="token operator">:</span> Rule<span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'Please input the password'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// eslint会报错</span>
    <span class="token keyword">return</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Please input the password'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 加个new Error()</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>formState<span class="token punctuation">.</span>checkPass <span class="token operator">!==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      formRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">validateFields</span><span class="token punctuation">(</span><span class="token string">'checkPass'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li></ul> 
<h3><a id="_179"></a>表单校验方法</h3> 
<ul><li>1、使用<code>formRef</code>，详情请参考<a href="https://www.antdv.com/components/form-cn#%E6%96%B9%E6%B3%95" rel="nofollow">Form的方法API</a><pre><code class="prism language-ts"><span class="token operator">&lt;</span>a<span class="token operator">-</span>form ref<span class="token operator">=</span><span class="token string">"formRef"</span> <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">"formState"</span><span class="token operator">&gt;</span> <span class="token comment">// 1 form上绑定ref</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> FormInstance <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ant-design-vue'</span>  <span class="token comment">// 2 引入ts类型</span>
<span class="token keyword">const</span> formRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>FormInstance<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 3 定义变量</span>

formRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 4 使用校验</span>
</code></pre> </li><li>2、使用 <code>useForm</code>，详情请参考<a href="https://www.antdv.com/components/form-cn#useForm-v2-2" rel="nofollow">useForm的参数说明</a></li><li>常用方法，详情可参考各自的API 
  <ul><li><code>validate</code>、<code>validateFields </code>触发表单验证</li><li><code>resetFields </code>重置整个表单</li><li><code>clearValidate</code>移除表单校验效果</li></ul> </li></ul> 
<h3><a id="_194"></a>其他补充</h3> 
<h4><a id="_195"></a>隐藏必填红星</h4> 
<ul><li>不希望展示必填红星时，可以添加<code>hide-required-mark</code>，<a href="https://www.antdv.com/components/form-cn#API" rel="nofollow">参考 Form-API</a></li></ul> 
<pre><code class="prism language-js">  <span class="token operator">&lt;</span>a<span class="token operator">-</span>form
    <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">"formModel"</span>
     <span class="token operator">:</span>rules<span class="token operator">=</span><span class="token string">"formRules"</span>
     hide<span class="token operator">-</span>required<span class="token operator">-</span>mark  <span class="token comment">// 新增该属性</span>
   <span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="_205"></a>表单规则不生效</h4> 
<p>如果你确认校验规则写的没有问题，但该条规则就是不生效。请检查下你表单项绑定的值是否一致，步骤：</p> 
<ul><li>1 先确认你form表单 绑定的数据对象</li><li>2 确认表单输入框绑定的值，是否是form数据源中的数据</li><li>3 确认name是该条表单项中输入框所绑定的值，名称需要一致哦</li></ul> 
<pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>a<span class="token operator">-</span>form
    <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">"formState"</span>  <span class="token comment">// 1 先确认你form表单 绑定的数据对象</span>
  <span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>a<span class="token operator">-</span>form<span class="token operator">-</span>item
      label<span class="token operator">=</span><span class="token string">"Username"</span>
      name<span class="token operator">=</span><span class="token string">"username"</span>  <span class="token comment">// 3 确认name是该条表单项中输入框所绑定的值，名称需要一致哦</span>
      <span class="token operator">:</span>rules<span class="token operator">=</span><span class="token string">"[{ required: true, message: 'Please input your username!' }]"</span>
    <span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>a<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">"formState.username"</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token comment">// 2 确认表单输入框绑定的值，是否是form数据源中的数据</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">-</span>form<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6fe258f5625b5c7c732f0f1be03cf9fc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Apollo 配置中心详细教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a4ac82ecd9adad4c7f3115417b615582/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">element-ui 中 Cascader 级联选择器同时获取value值和label值</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>