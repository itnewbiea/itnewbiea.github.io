<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>数据可视化——ucharts的使用(自定义修改文字，颜色，自适应屏幕宽度) - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="数据可视化——ucharts的使用(自定义修改文字，颜色，自适应屏幕宽度)" />
<meta property="og:description" content="目录
1.引入 uCharts插件
2.使用组件
1.html 2.css
3.js 4.处理渲染显示宽高问题
3.修改默认渲染数据的内容
1.修改柱状图上面渲染的内容
2.修改点击展示的内容
1.修改展示内容
2.自定义展示内容
4.自定义颜色
5.修改其他设置查看官方文档
官网地址：uCharts官网 - 秋云uCharts跨平台图表库
uCharts是一款基于canvas API开发的适用于所有前端应用的图表库，开发者编写一套代码，可运行到 Web、iOS、Android（基于 uni-app / taro ）、以及各种小程序（微信/支付宝/百度/头条/飞书/QQ/快手/钉钉/淘宝/京东/360）、快应用等更多支持 canvas API 的平台。
我以微信小程序为例进行展示
1.引入 uCharts插件 https://gitee.com/uCharts/uCharts
到gitee上面下载文件到本地然后在里面找到u-charts.js这个文件放到自己项目里面(放哪里都可以)
在需要用到图表的js页面里面引入这个文件 引入的路径根据自己的位置来
import uCharts from &#34;../../utils/u-charts&#34; 2.使用组件 1.html &lt;canvas canvas-id=&#34;column&#34; id=&#34;column&#34; class=&#34;charts&#34; bindtouchend=&#34;tap&#34; /&gt; 2.css // 图表 .charts { display: flex; justify-content: center; align-items: center; width: 100%; min-height: 550rpx; margin-top: 20rpx; } 3.js // 1.定义回款柱状图数据 getData() { //模拟服务器返回数据，如果数据格式和标准格式不同，需自行按下面的格式拼接 // let res = { // 柱状图分类名 // categories: [&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/09610508c747f10d965d50a582901348/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-28T17:12:49+08:00" />
<meta property="article:modified_time" content="2023-12-28T17:12:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">数据可视化——ucharts的使用(自定义修改文字，颜色，自适应屏幕宽度)</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="1.%E5%BC%95%E5%85%A5%C2%A0uCharts%E6%8F%92%E4%BB%B6-toc" style="margin-left:40px;"><a href="#1.%E5%BC%95%E5%85%A5%C2%A0uCharts%E6%8F%92%E4%BB%B6" rel="nofollow">1.引入 uCharts插件</a></p> 
<p id="2.%E4%BD%BF%E7%94%A8%E7%BB%84%E4%BB%B6-toc" style="margin-left:40px;"><a href="#2.%E4%BD%BF%E7%94%A8%E7%BB%84%E4%BB%B6" rel="nofollow">2.使用组件</a></p> 
<p id="1.html%C2%A0-toc" style="margin-left:80px;"><a href="#1.html%C2%A0" rel="nofollow">1.html </a></p> 
<p id="2.css-toc" style="margin-left:80px;"><a href="#2.css" rel="nofollow">2.css</a></p> 
<p id="3.js%C2%A0-toc" style="margin-left:80px;"><a href="#3.js%C2%A0" rel="nofollow">3.js </a></p> 
<p id="4.%E5%A4%84%E7%90%86%E6%B8%B2%E6%9F%93%E6%98%BE%E7%A4%BA%E5%AE%BD%E9%AB%98%E9%97%AE%E9%A2%98-toc" style="margin-left:80px;"><a href="#4.%E5%A4%84%E7%90%86%E6%B8%B2%E6%9F%93%E6%98%BE%E7%A4%BA%E5%AE%BD%E9%AB%98%E9%97%AE%E9%A2%98" rel="nofollow">4.处理渲染显示宽高问题</a></p> 
<p id="3.%E4%BF%AE%E6%94%B9%E9%BB%98%E8%AE%A4%E6%B8%B2%E6%9F%93%E6%95%B0%E6%8D%AE%E7%9A%84%E5%86%85%E5%AE%B9-toc" style="margin-left:40px;"><a href="#3.%E4%BF%AE%E6%94%B9%E9%BB%98%E8%AE%A4%E6%B8%B2%E6%9F%93%E6%95%B0%E6%8D%AE%E7%9A%84%E5%86%85%E5%AE%B9" rel="nofollow">3.修改默认渲染数据的内容</a></p> 
<p id="%C2%A01.%E4%BF%AE%E6%94%B9%E6%9F%B1%E7%8A%B6%E5%9B%BE%E4%B8%8A%E9%9D%A2%E6%B8%B2%E6%9F%93%E7%9A%84%E5%86%85%E5%AE%B9-toc" style="margin-left:80px;"><a href="#%C2%A01.%E4%BF%AE%E6%94%B9%E6%9F%B1%E7%8A%B6%E5%9B%BE%E4%B8%8A%E9%9D%A2%E6%B8%B2%E6%9F%93%E7%9A%84%E5%86%85%E5%AE%B9" rel="nofollow"> 1.修改柱状图上面渲染的内容</a></p> 
<p id="2.%E4%BF%AE%E6%94%B9%E7%82%B9%E5%87%BB%E5%B1%95%E7%A4%BA%E7%9A%84%E5%86%85%E5%AE%B9-toc" style="margin-left:80px;"><a href="#2.%E4%BF%AE%E6%94%B9%E7%82%B9%E5%87%BB%E5%B1%95%E7%A4%BA%E7%9A%84%E5%86%85%E5%AE%B9" rel="nofollow">2.修改点击展示的内容</a></p> 
<p id="%C2%A01.%E4%BF%AE%E6%94%B9%E5%B1%95%E7%A4%BA%E5%86%85%E5%AE%B9-toc" style="margin-left:120px;"><a href="#%C2%A01.%E4%BF%AE%E6%94%B9%E5%B1%95%E7%A4%BA%E5%86%85%E5%AE%B9" rel="nofollow"> 1.修改展示内容</a></p> 
<p id="2.%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%95%E7%A4%BA%E5%86%85%E5%AE%B9-toc" style="margin-left:120px;"><a href="#2.%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%95%E7%A4%BA%E5%86%85%E5%AE%B9" rel="nofollow">2.自定义展示内容</a></p> 
<p id="4.%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A2%9C%E8%89%B2-toc" style="margin-left:40px;"><a href="#4.%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A2%9C%E8%89%B2" rel="nofollow">4.自定义颜色</a></p> 
<p id="5.%E4%BF%AE%E6%94%B9%E5%85%B6%E4%BB%96%E8%AE%BE%E7%BD%AE%E6%9F%A5%E7%9C%8B%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3-toc" style="margin-left:40px;"><a href="#5.%E4%BF%AE%E6%94%B9%E5%85%B6%E4%BB%96%E8%AE%BE%E7%BD%AE%E6%9F%A5%E7%9C%8B%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3" rel="nofollow">5.修改其他设置查看官方文档</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p> <a href="https://www.ucharts.cn/v2/#/demo/index" rel="nofollow" title="官网地址：uCharts官网 - 秋云uCharts跨平台图表库">官网地址：uCharts官网 - 秋云uCharts跨平台图表库</a></p> 
<blockquote> 
 <p><strong><code>uCharts</code>是一款基于<code>canvas API</code>开发的适用于所有前端应用的图表库，开发者编写一套代码，可运行到 Web、iOS、Android（基于 uni-app / taro ）、以及各种小程序（微信/支付宝/百度/头条/飞书/QQ/快手/钉钉/淘宝/京东/360）、快应用等更多支持 canvas API 的平台。</strong></p> 
</blockquote> 
<p><img alt="" height="931" src="https://images2.imgbox.com/14/65/oMv9WFOT_o.png" width="1200"></p> 
<p>我以微信小程序为例进行展示</p> 
<h3 id="1.%E5%BC%95%E5%85%A5%C2%A0uCharts%E6%8F%92%E4%BB%B6"><strong>1.引入 <code>uCharts插件</code></strong></h3> 
<p><a href="https://gitee.com/uCharts/uCharts" rel="nofollow" title="https://gitee.com/uCharts/uCharts">https://gitee.com/uCharts/uCharts</a></p> 
<p><strong>到gitee上面下载文件到本地然后在里面找到u-charts.js这个文件放到自己项目里面(放哪里都可以)</strong></p> 
<p><img alt="" height="180" src="https://images2.imgbox.com/ca/88/U6wBxbpP_o.png" width="827"></p> 
<p> <img alt="" height="106" src="https://images2.imgbox.com/1b/23/FlzBsSHB_o.png" width="191"></p> 
<p>在需要用到图表的js页面里面引入这个文件 </p> 
<p>引入的路径根据自己的位置来</p> 
<pre><code class="language-javascript">import uCharts from "../../utils/u-charts"</code></pre> 
<h3 id="2.%E4%BD%BF%E7%94%A8%E7%BB%84%E4%BB%B6">2.使用组件</h3> 
<h4 id="1.html%C2%A0">1.html </h4> 
<pre><code class="language-html">&lt;canvas canvas-id="column" id="column" class="charts" bindtouchend="tap" /&gt;</code></pre> 
<h4 id="2.css">2.css</h4> 
<pre><code class="language-css">// 图表
.charts {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  min-height: 550rpx;
  margin-top: 20rpx;
}</code></pre> 
<h4 id="3.js%C2%A0">3.js </h4> 
<pre><code class="language-javascript">  // 1.定义回款柱状图数据
    getData() {
    //模拟服务器返回数据，如果数据格式和标准格式不同，需自行按下面的格式拼接
    // let res = {
    // 柱状图分类名
    //   categories: ["计算1部", "计算2部", "超算部门"],
    // 柱状图内容，一个对象就是一条柱，里面的name就是这个柱子的名字，data是柱子的数据，只能是数字
    //   series: [{
    //       name: "总回款",
    //       data: [100,200,300]
    //     },
    //     {
    //       name: "已回款",
    //       data:  [100,200,300]
    //     },
    //     {
    //       name: "待回款",
    //       data:  [100,200,300]
    //     }
    //   ]
    // };

    // 提取数据修改成规定的数据格式
    let title = [] // 部门名称
    let sum = [] // 总回款
    let already = [] // 已回款
    let stay = [] // 待回款
    // 循环数据提取到对应数组中
    this.data.moneylist &amp;&amp; this.data.moneylist.forEach(item =&gt; {
      title.push(item.title)
      sum.push(item.money)
      already.push(item.return_money)
      stay.push(item.get_money)
    })
    let res = {
    // 这些数据都是数组形式可以直接赋值
      categories: title,
      series: [{
          name: "总回款",
          data: sum
        },
        {
          name: "已回款",
          data: already
        },
        {
          name: "待回款",
          data: stay
        }
      ]
    };
    // 调用生成柱状图方法，生成柱状图 这里的column是html页面上面绑定的canvas-id的值可自定义
    this.setcolumn('column', res);
  },


  // 生成柱状图
  setcolumn(id, data) {
    const ctx = wx.createCanvasContext(id, this);
    uChartsInstance[id] = new uCharts({
      type: "column", //展示方式  柱状图
      context: ctx, //指定给页面上对应id的标签上生成
      width: 400, //生成的宽度 单位为px不可更改
      height: 300, //生成的高度 单位为px不可更改
      categories: data.categories, //生成图形下面的数据说明，就是上面定义的res里面的categories数据
      series: data.series, //生成的图形数据，就是上面定义的res里面的series数据
      animation: true, //是否加载生成动画
      background: "#FFFFFF", //背景颜色
      padding: [30, 0, 0, 0], //边距
      fontSize: 10, //字体大小
      animation:true,//是否加生成过渡效果
      xAxis: {
        disabled: false, //是否不显示x轴线 包括名称
        disableGrid: true //是否不加中间分割线，
      },
      yAxis: {
        disabled: false, //是否不显示y轴线刻度
        disableGrid: false, //是否不显示刻度分割线
        data: [{
          min: 0 //数据开始显示的最小值
        }]
      },
      extra: {
        column: {
          type: "group",
          width: 30, //每条柱子的宽度
          activeBgColor: "#000000", //选中背景颜色
          activeBgOpacity: 0.1, //选中背景透明度
          labelPosition: "", //设置柱子上面的数值位置
        }
      }
    });
  },
  // 点击柱状图展示对应数据
  tap(e) {
    uChartsInstance[e.target.id].touchLegend(e);
    uChartsInstance[e.target.id].showToolTip(e);
  },</code></pre> 
<h4 id="4.%E5%A4%84%E7%90%86%E6%B8%B2%E6%9F%93%E6%98%BE%E7%A4%BA%E5%AE%BD%E9%AB%98%E9%97%AE%E9%A2%98">4.处理渲染显示宽高问题</h4> 
<p><img alt="" height="261" src="https://images2.imgbox.com/0d/d0/BOh2gv2T_o.png" width="1200"></p> 
<p><img alt="" height="46" src="https://images2.imgbox.com/63/bf/PfnmqIGg_o.png" width="402"></p> 
<blockquote> 
 <p><strong> 原因：因为手机尺寸不同，需要兼容不同手机屏幕，需要根据手机尺寸计算不同的大小，主要是宽度<span style="color:#ff9900;">在生成柱状图的时候赋值，因为这个属性不能直接设置100%这种自适应的值 </span></strong></p> 
</blockquote> 
<p><strong>获取手机尺寸，生成自适应宽高 </strong></p> 
<pre><code class="language-javascript">Page({
  data: {
    // 柱状图的宽高
    cWidth: 0,
    cHeight: 270,
    },
  onShow() {
    // 获取屏幕宽度设置自适应
    let w = wx.getSystemInfoSync().windowWidth
    let h = wx.getSystemInfoSync().windowHeight
    // console.log("w", w, "h", h);
    this.setData({
      cWidth: w * 0.87,
      })
    }
})</code></pre> 
<p><strong> 在生成柱状图里面赋值给宽高使用</strong></p> 
<pre><code class="language-javascript">width: this.data.cWidth, //自适应宽度
height: this.data.cHeight, //自适应高度</code></pre> 
<h3 id="3.%E4%BF%AE%E6%94%B9%E9%BB%98%E8%AE%A4%E6%B8%B2%E6%9F%93%E6%95%B0%E6%8D%AE%E7%9A%84%E5%86%85%E5%AE%B9">3.修改默认渲染数据的内容</h3> 
<p><img alt="" height="272" src="https://images2.imgbox.com/0b/c6/u3k7xtMm_o.png" width="338"></p> 
<p><img alt="" height="279" src="https://images2.imgbox.com/1a/84/udOennVn_o.png" width="342"></p> 
<h4 id="%C2%A01.%E4%BF%AE%E6%94%B9%E6%9F%B1%E7%8A%B6%E5%9B%BE%E4%B8%8A%E9%9D%A2%E6%B8%B2%E6%9F%93%E7%9A%84%E5%86%85%E5%AE%B9"> 1.修改柱状图上面渲染的内容</h4> 
<blockquote> 
 <p>直接渲染数据不能渲染非数字的内容，使用formatter自定义内容</p> 
</blockquote> 
<pre><code class="language-javascript">let res = {
      categories: title,
      series: [{
          name: "目标",
          data: sum,
        },
        {
          name: "已完成",
          data: already,
          // 使用formatter 循环already定义的值val就是原本展示的值，i就是对应下标
          formatter: function (val, i) { //修改顶部展示内容
            // 这里使用已完成除以目标计算出完成率进行展示，为什么不直接渲染完成率呢，因为哪里不能渲染非数字类型，因为有百分号，所以要在这里使用自定义的方式进行修改
           return val + '|' + (val / sum[i]).toFixed(2) * 100 + '%'
          }
        },
      ],</code></pre> 
<h4 id="2.%E4%BF%AE%E6%94%B9%E7%82%B9%E5%87%BB%E5%B1%95%E7%A4%BA%E7%9A%84%E5%86%85%E5%AE%B9">2.修改点击展示的内容</h4> 
<blockquote> 
 <p>默认情况下，点击展示的是柱状图的柱子名称和数据 </p> 
</blockquote> 
<h5 id="%C2%A01.%E4%BF%AE%E6%94%B9%E5%B1%95%E7%A4%BA%E5%86%85%E5%AE%B9"> 1.修改展示内容</h5> 
<blockquote> 
 <p>只能改变有的数据，只有两个柱子就最多只能展示二条</p> 
</blockquote> 
<pre><code class="language-javascript">    // 修改点击柱状图展示的数据
    tap2(e) {
    let num = 0 + "%"
    uChartsInstance[e.target.id].touchLegend(e);
    uChartsInstance[e.target.id].showToolTip(e, {
      formatter: function (item, category, index, opts) {
        // console.log("1", item);
        // console.log("2", category);
        // console.log("3", index);
        // console.log("4", opts);
        // 这里以展示完成率为需求
        // 判断目标是否为0 为0表示没有设置，有就算出完成率
        if (opts.series[0].data[index] != 0) {
          num = (opts.series[1].data[index] / opts.series[0].data[index]) * 100 
        } else {
          num = "未设置目标"
        }
        // 修改已完成为完成率展示
        if (item.name == "已完成") {
          return "完成率" + '：' + num.toFixed() + '%'
        }
      },
    });
  },</code></pre> 
<p><img alt="" height="277" src="https://images2.imgbox.com/6c/76/SbXRFT9d_o.png" width="346"></p> 
<p><img alt="" height="276" src="https://images2.imgbox.com/d5/15/3boWFf48_o.png" width="338"></p> 
<h5 id="2.%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%95%E7%A4%BA%E5%86%85%E5%AE%B9">2.自定义展示内容</h5> 
<blockquote> 
 <p>自定义，没有修改限制，上面图片展示三个数据就是自定义的</p> 
</blockquote> 
<pre><code class="language-javascript">    // 修改点击柱状图展示的数据
    tap2(e) {
    // 定义自定义展示内容，这里设置显示三个
    let arr = [{
        text: "",// 内容
        color: "#1890FF",// 字体颜色
      },
      {
        text: "",
        color: "#91CB74"
      },
      {
        text: "",
        color: "#fac858"
      }
    ]
    let i = 0
    let num = ""
    uChartsInstance[e.target.id].touchLegend(e);
    uChartsInstance[e.target.id].showToolTip(e, {
      formatter: function (item, category, index, opts) {
        // console.log("1", item);
        // console.log("2", category);
        // console.log("3", index);
        // console.log("4", opts);
        // 这里以展示完成率为需求
        // 判断目标是否为0 为0表示没有设置，有就算出完成率
        if (opts.series[0].data[index] != 0) {
          num = (opts.series[1].data[index] / opts.series[0].data[index]) * 100 
        } else {
          num = "未设置目标"
        }
          arr[2].text = "完成率" + '：' + num.toFixed() + '%'
          arr[i].text = item.name + '：' + opts.series[i].data[index]
          i++
          return item.name + '：' + item.data
      },
      textList: arr, //添加自定义显示内容
    });
  },</code></pre> 
<p> <img alt="" height="279" src="https://images2.imgbox.com/c7/a3/MOlJG6ya_o.png" width="342"></p> 
<h3 id="4.%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A2%9C%E8%89%B2">4.自定义颜色</h3> 
<p>图1：设置二端颜色进行渐变                                  图二：只设置一个颜色，自动由深到浅渐变</p> 
<p><img alt="" height="286" src="https://images2.imgbox.com/be/33/yMjlBJ8z_o.png" width="339"><img alt="" height="278" src="https://images2.imgbox.com/65/16/V8ZIxvH6_o.png" width="340"></p> 
<pre><code class="language-javascript">        series: [{
          name: "目标",
          data: sum,
          color: "#6453f1", //修改柱子颜色
        },
        {
          name: "完成率",
          data: already,
          color: "#efe66c", //修改柱子颜色
        },
      ],</code></pre> 
<p><strong> 在生成柱状图的extra属性里面设置颜色渐变 <span style="color:#ff9900;">linearType: "custom" </span>//开启渐变</strong></p> 
<pre><code class="language-javascript">     extra: {
        column: {
          type: "group",
          width: 30, //条柱宽度
          seriesGap: 0, //条柱间距
          activeBgColor: "#000000", //选中背景颜色
          activeBgOpacity: 0.05, //选中背景透明度
          labelPosition: "", //设置柱子上面的数值位置
          linearType: "custom", //开启渐变
          // 如果开启渐变不设置customColor属性就是由上面设置颜色的值由深变浅，第二个图就是
          customColor: ["#288bf7", "#87d370"], //这里设置渐变颜色的上面部分，渐变颜色的底部颜色在series里面设置
          colorStop: "0" //渐变比例
        }
      },</code></pre> 
<h3 id="5.%E4%BF%AE%E6%94%B9%E5%85%B6%E4%BB%96%E8%AE%BE%E7%BD%AE%E6%9F%A5%E7%9C%8B%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3">5.修改其他设置查看官方文档</h3> 
<p> <a href="https://www.ucharts.cn/v2/#/document/index" rel="nofollow" title="uCharts官网 - 秋云uCharts跨平台图表库">uCharts官网 - 秋云uCharts跨平台图表库</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9b1e2b552655064256c879afc3e19589/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Apache DolphinScheduler 3.1.9 版本发布：提升系统的稳定性和性能</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/09fb3f79d3871cbd5e9e7e87f87cb850/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">svg学习</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>