<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue&#43;WangEditor编辑器配置上传图片 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue&#43;WangEditor编辑器配置上传图片" />
<meta property="og:description" content="记录. 起因这段在维护老项目过程中，客户反馈说前台页面查看项目动态时加载太慢需要 2-3秒才能加载出页面。后来我去排查是发现之前富文本编辑器上传图片时把 图片转base64发送给了后端…结果你懂.
这种情况一张图片还好图片多了就导致信息量太大，5mb大小文件存到数据库里…这查询能不慢么
下面代码
this.editor = new E(this.$refs.editorElem); this.editor.customConfig.menus = [ // 菜单配置 &#34;head&#34;, // 标题 &#34;bold&#34;, // 粗体 &#34;fontSize&#34;, // 字号 &#34;fontName&#34;, // 字体 &#34;italic&#34;, // 斜体 &#34;underline&#34;, // 下划线 &#34;strikeThrough&#34;, // 删除线 &#34;foreColor&#34;, // 文字颜色 &#34;backColor&#34;, // 背景颜色 &#34;link&#34;, // 插入链接 &#34;list&#34;, // 列表 &#34;justify&#34;, // 对齐方式 &#39;image&#39;, // 插入图片 &#34;table&#34;, // 表格 &#34;undo&#34;, // 撤销 &#34;redo&#34;, // 重复 ]; this.editor.customConfig = this.editor.customConfig ? this.editor.customConfig : this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e28318cba7dd83dd8cdf70fe316c01fd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-23T17:18:04+08:00" />
<meta property="article:modified_time" content="2023-02-23T17:18:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue&#43;WangEditor编辑器配置上传图片</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>记录.</h3> 
<blockquote> 
 <p>起因这段在维护老项目过程中，客户反馈说前台页面查看项目动态时加载太慢需要 2-3秒才能加载出页面。后来我去排查是发现之前富文本编辑器上传图片时把 图片转base64发送给了后端…结果你懂.</p> 
</blockquote> 
<blockquote> 
 <p>这种情况一张图片还好图片多了就导致信息量太大，5mb大小文件存到数据库里…这查询能不慢么</p> 
</blockquote> 
<p>下面代码</p> 
<pre><code>    this.editor = new E(this.$refs.editorElem);
   
    this.editor.customConfig.menus = [
      // 菜单配置
      "head", // 标题
      "bold", // 粗体
      "fontSize", // 字号
      "fontName", // 字体
      "italic", // 斜体
      "underline", // 下划线
      "strikeThrough", // 删除线
      "foreColor", // 文字颜色
      "backColor", // 背景颜色
      "link", // 插入链接
      "list", // 列表
      "justify", // 对齐方式
      'image', // 插入图片
      "table", // 表格
      "undo", // 撤销
      "redo", // 重复
    ];


    this.editor.customConfig = this.editor.customConfig ? this.editor.customConfig : this.editor.config
    // this.editor.customConfig.uploadImgShowBase64 = true // base 64 存储图片
    // 配置上传图片功能
    this.editor.customConfig.uploadImgServer = http.baseURL + 'you/upload' //填写后台服务器地址
    this.editor.customConfig.uploadFileName = 'file' // 后端接受上传文件的参数名
    this.editor.customConfig.uploadImgMaxSize = 3 * 1024 * 1024 // 限制上传图片的大小为3MB
    this.editor.customConfig.uploadImgMaxLength = 6 // 限制一次最多上传 6 张图片
    this.editor.customConfig.uploadImgTimeout = 4 * 60 * 1000 // 设置超时时间
    this.editor.customConfig.uploadImgParams = {
      file_type: 'img'
    }
    this.editor.customConfig.uploadImgHeaders = {
      Authorization: getToken // 如果需要添加请求头，可以在这里配置
    }
    this.editor.customConfig.uploadImgHooks = {
      customInsert: function (insertImg, result, editor) {
        if (result.code === 0) {
          insertImg(result.data.requestUrl) // 插入图片到编辑器中
        } else {
          console.error('上传图片失败')
        }
      }
    }
    this.editor.customConfig.zIndex = 100;
    this.editor.customConfig.pasteFilterStyle = false;
    this.editor.create(); // 创建富文本实例

</code></pre> 
<p>后端Java部分</p> 
<pre><code>@PostMapping("/upload")
public Result upload(@RequestParam("file") MultipartFile file) {
  try {
    // 保存文件到本地或者云存储等操作
    // ...
    String url = "http://yourdomain.com/images/" + fileName; // 获取上传后的图片地址
    return Result.success(url);
  } catch (IOException e) {
    e.printStackTrace();
    return Result.fail("上传失败");
  }
}


</code></pre> 
<p>感谢chatgpt提供思路帮助~</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/66515b250e640634cd4f8490dc3558aa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">对象数组根据某个key来进行排序</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bd52d72f1f01aeaae6433ec926c9a630/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">通过AI算法预测彩票</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>