<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>数据库多表查询 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="数据库多表查询" />
<meta property="og:description" content="在SM数据库中进行以下操作：
1.查询选修了数据库的学生的学号；
select sno from sc,course where course.cname=&#39;数据库&#39; and course.cno=sc.cno 2.查询数据库成绩不及格的学生名单（输出学号、姓名、成绩）；
select student.sno,sname,score from sc,course,student where course.cname=&#39;数据库&#39; and course.cno=sc.cno and sc.score&lt;60 and sc.sno=student.sno 这里我漏了course.cno=sc.cno导致了错误，课程号没有连接导致输出全部不及格的信息
3.使用内连接查询每个学生及其选修课程情况；
select * from sc inner join student on student.sno=sc.sno 可以看到sc与student内连接，student每一行都与sc连接，他们的共有属性是sno，所以根据sno来匹配
4.使用左连接查询查询每个学生及其选修课程情况；
select * from sc left join student on student.sno=sc.sno 5.使用右连接查询查询每个学生及其选修课程情况；
select * from student right outer join sc on student.sno=sc.sno 不可以向上面一样直接改right，sc right join student
这样sc做主表
6.在表Teacher中，查询职工张三的上级领导信息；
select * from teacher t1 where t1.tno =( select t2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/2bebdbcc51b926743fb70486d6a329f5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-18T12:59:17+08:00" />
<meta property="article:modified_time" content="2023-08-18T12:59:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">数据库多表查询</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>在SM数据库中进行以下操作：</strong></p> 
<p><strong>1.查询选修了数据库的学生的学号；</strong></p> 
<pre><code class="prism language-bash"><span class="token keyword">select</span> sno 
from sc,course 
where <span class="token assign-left variable">course.cname</span><span class="token operator">=</span><span class="token string">'数据库'</span> and <span class="token assign-left variable">course.cno</span><span class="token operator">=</span>sc.cno
</code></pre> 
<p><strong>2.查询数据库成绩不及格的学生名单（输出学号、姓名、成绩）；</strong></p> 
<pre><code class="prism language-c">select student<span class="token punctuation">.</span>sno<span class="token punctuation">,</span>sname<span class="token punctuation">,</span>score 
from sc<span class="token punctuation">,</span>course<span class="token punctuation">,</span>student
where course<span class="token punctuation">.</span>cname<span class="token operator">=</span><span class="token char">'数据库'</span> and course<span class="token punctuation">.</span>cno<span class="token operator">=</span>sc<span class="token punctuation">.</span>cno and sc<span class="token punctuation">.</span>score<span class="token operator">&lt;</span><span class="token number">60</span> and sc<span class="token punctuation">.</span>sno<span class="token operator">=</span>student<span class="token punctuation">.</span>sno
</code></pre> 
<p>这里我漏了course.cno=sc.cno导致了错误，课程号没有连接导致输出全部不及格的信息</p> 
<p><strong>3.使用内连接查询每个学生及其选修课程情况；</strong></p> 
<pre><code class="prism language-bash"><span class="token keyword">select</span> * 
from sc inner <span class="token function">join</span> student 
on <span class="token assign-left variable">student.sno</span><span class="token operator">=</span>sc.sno
</code></pre> 
<p><img src="https://images2.imgbox.com/0f/56/oLUdVJ4Y_o.png" alt="在这里插入图片描述"><br> 可以看到sc与student内连接，student每一行都与sc连接，他们的共有属性是sno，所以根据sno来匹配</p> 
<p><strong>4.使用左连接查询查询每个学生及其选修课程情况；</strong></p> 
<pre><code class="prism language-bash"><span class="token keyword">select</span> * 
from sc left <span class="token function">join</span> student 
on <span class="token assign-left variable">student.sno</span><span class="token operator">=</span>sc.sno
</code></pre> 
<p><strong>5.使用右连接查询查询每个学生及其选修课程情况；</strong></p> 
<pre><code class="prism language-bash"><span class="token keyword">select</span> * 
from student right outer <span class="token function">join</span> sc 
on <span class="token assign-left variable">student.sno</span><span class="token operator">=</span>sc.sno
</code></pre> 
<p>不可以向上面一样直接改right，sc right join student<br> 这样sc做主表</p> 
<p><strong>6.在表Teacher中，查询职工张三的上级领导信息；</strong></p> 
<pre><code class="prism language-bash"><span class="token keyword">select</span> * from teacher t1 where t1.tno <span class="token operator">=</span><span class="token punctuation">(</span> <span class="token keyword">select</span> t2.mgr from teacher t2 where <span class="token assign-left variable">tname</span><span class="token operator">=</span><span class="token string">'张三'</span><span class="token punctuation">)</span>
</code></pre> 
<p>可以用=也可以用in，因为子查询只有一个值就可以用in</p> 
<p><strong>7.使用IN查询修读课程名为数据库的所有学生的学号和姓名；</strong></p> 
<pre><code class="prism language-bash"><span class="token keyword">select</span> student.sno,student.sname 
		from student 
		where student.sno in<span class="token punctuation">(</span>select sc.sno 
									from sc 
									where sc.cno in<span class="token punctuation">(</span>select course.cno 
														from course 
														where <span class="token assign-left variable">course.cname</span><span class="token operator">=</span><span class="token string">'数据库'</span><span class="token punctuation">))</span>
</code></pre> 
<p>最内层从course表查询数据库的cno，再从sc表查询选修了数据库的sno，再从student 表查询sname，sno</p> 
<p>不使用in查询，使用连接查询也可以<br> select student.sno,sname from student,sc,course where sc.sno=student.sno and course.cno=sc.cno and cname=‘数据库’</p> 
<p><strong>8.使用EXISTS查询所有选修了001号课程的学生的姓名；</strong></p> 
<pre><code class="prism language-c">select sname 
		from student 
		where <span class="token function">EXISTS</span><span class="token punctuation">(</span>select <span class="token operator">*</span> 
							from sc 
							where student<span class="token punctuation">.</span>sno<span class="token operator">=</span>sc<span class="token punctuation">.</span>sno and sc<span class="token punctuation">.</span>cno<span class="token operator">=</span><span class="token char">'001'</span><span class="token punctuation">)</span>
</code></pre> 
<p>student表每一行都与sc表匹配观察是否有满足student.sno=sc.sno and sc.cno=‘001’</p> 
<blockquote> 
 <p>形象一点来说就是有一类student的人，他找到sc这类人，student有sno等属性但是每个人的属性值不一样，每一个student人与sc作对接，每次询问你跟我的sno是不是一样的，并且当前这个sc人的cno属性是001的，如果都满足就返回student人的sname属性值</p> 
</blockquote> 
<p><strong>9.使用NOT EXISTS查询未选修了001号课程的学生的姓名；</strong></p> 
<pre><code class="prism language-c">select sname 
	from student 
	where not <span class="token function">EXISTS</span><span class="token punctuation">(</span>select <span class="token operator">*</span> 
							from sc 
							where student<span class="token punctuation">.</span>sno<span class="token operator">=</span>sc<span class="token punctuation">.</span>sno and sc<span class="token punctuation">.</span>cno<span class="token operator">=</span><span class="token char">'001'</span><span class="token punctuation">)</span>
</code></pre> 
<p>内部有选择001课程的则返回false，没选择001课程 的返回true。<br> not exists通常用在题目出现否定词的情况，比如未选择。。。</p> 
<p><strong>10.使用NOT EXISTS查询选修了课程学分为４的全部课程的学生的姓名；</strong><br> <img src="https://images2.imgbox.com/68/88/w0F7LOLs_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>思路：一个学生如果他至少有一门四学分课程没有选修，那么他在课程表里就会存在与选课表的非交集,我们姑且称之为“未选所有四学分课程学生名单子集”，它由内层的not<br> exists选出。这个内层父子关联存在子查询选出课程表里与选课表的非交集，最内层选课表sc的课程号cno、学号sno分别与第二层父表course课程的cno、最外层父表studen学生表的sno进行对等连接，不存在对等的记录即为非交集，从而筛选出“未选四学分所有课程学生名单子集”。</p> 
</blockquote> 
<p><strong>11.统计教职工的总人数、最高工资、最少工资、平均工资；</strong></p> 
<pre><code class="prism language-bash"><span class="token keyword">select</span> count<span class="token punctuation">(</span>*<span class="token punctuation">)</span> as 总人数,MAX<span class="token punctuation">(</span>sal<span class="token punctuation">)</span> as 最大工资,min<span class="token punctuation">(</span>sal<span class="token punctuation">)</span> as 最少工资,avg<span class="token punctuation">(</span>sal<span class="token punctuation">)</span> as 平均工资 
from Teacher
</code></pre> 
<p><strong>12.查询选修两门课程以上的学生学号；</strong></p> 
<pre><code class="prism language-bash"><span class="token keyword">select</span> distinct s1.sno 
from sc s1,sc s2 
where <span class="token assign-left variable">s1.sno</span><span class="token operator">=</span>s2.sno and s1.cno<span class="token operator">!=</span>s2.cno 
</code></pre> 
<p>思路：在sc表查询两次，s1.sno=s2.sno and s1.cno!=s2.cno,在每个学生对于选课不同就说明选修了两门课以上<br> 记得去重因为每个学生选了大于2门课的记录，不去重就会输出多个sno。</p> 
<pre><code class="prism language-bash"><span class="token keyword">select</span> sno 
from sc group by sno having count<span class="token punctuation">(</span>*<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span>
</code></pre> 
<p>先对sc表的sno进行分组，分组结果如果大于1说明选课数大于2</p> 
<p><strong>13.查询选修了三门课程的学生学号；</strong></p> 
<pre><code class="prism language-c">select sno 
from sc group by sno having <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span>
</code></pre> 
<p><strong>14.使用分组查询选修了所有课程的学生学号、姓名。</strong><br> <img src="https://images2.imgbox.com/05/30/4CXP00fa_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>思路：在SC表中某个学生选修的课程数等于Course表中课程总数，首先查出course表一共有多少门课select count(*)<br> from course，根据Sno分组，统计每个学生选修了几门课程。如果等于Course表课程的总数，就是我们要找的Sno</p> 
</blockquote> 
<p><strong>15.在选修课001中，使用ALL查询比学号00001和学号00004的成绩都低的学生学号；</strong><br> <img src="https://images2.imgbox.com/a9/2e/djL8OW9T_o.png" alt="在这里插入图片描述"><br> 常见误区：<img src="https://images2.imgbox.com/c0/22/8pxqSeCr_o.png" alt="在这里插入图片描述"><br> 这里经常会写成and，因为根据题意查询比学号00001和学号00004的成绩都低，但是一个人成绩不能同时低于两个数字，所以用or</p> 
<p><strong>16.在选修课001中，使用ANY查询比学号00001或学号00004的成绩低的学生学号；</strong><br> <img src="https://images2.imgbox.com/60/91/hbwZ8Juc_o.png" alt="在这里插入图片描述"></p> 
<p><strong>17.在选修课001中，查询比平均成绩低的学生的学号；</strong><br> <img src="https://images2.imgbox.com/28/31/IFElOMzf_o.png" alt="在这里插入图片描述"></p> 
<p><strong>18.给出所有课程（不包括001这门课程）都及格的学生的平均成绩，按平均成绩降序排序；</strong></p> 
<p>19.找出SC表中score值最小的行，不能使用min函数；<br> 20.找出SC表中score值最小的行，允许使用min函数；<br> 21.找出SC表中score值重复的行；<br> 22.把SC表的第5行记录选出来。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/95c61094c33091c01f84f96b8a684047/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Python】notepad&#43;&#43;实现python代码运行</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d3036117d3559f92998d709e7697d102/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java程序，插入new Date（）时间，入mysql库后，时间比当前系统时间少了14个小时</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>