<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>『HDU 5895』Mathematician QSC - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="『HDU 5895』Mathematician QSC" />
<meta property="og:description" content="题目链接:http://acm.hdu.edu.cn/showproblem.php?pid=5895
转载链接:http://blog.csdn.net/viscu/article/details/52595126
知识点链接:http://blog.csdn.net/acdreamers/article/details/8236942
题意:就是求一个公式 个人感想:
今天补补我没看过的题,我一拿到题,然后拆分一下,我想,不就矩阵快速幂吗,对于每个 f[i]^2 求一个快速幂,然后我看了一下n*y,这个数据&lt;=10^12次方,就算用nlogn求完指数也会超时,…然后我就想不出来了,我考虑过,能不能用矩阵把g【n】一起求出来,然后想了会实在没头绪,- -之后无奈下看了下转载写的题解,… 我曹,这样构造矩阵也可以…,我服…我做这种类型构造有点少啊…所以也没什么感觉,
然后我就觉得这样很简单啊,xjb搞搞就行了… 可是我突然发现…不行啊 应该可以取模才对啊,否则指数无限大啊。。。
我再查了一下取模公式 只有**（a^b）%p ==((a%p)^p)%p**;
但是没用啊。。。。
再百度一下 指数循环节,题解也提到过,看看ACdreamer写的… 没什么解释,就摆了一条公式, 窝尼玛,真牛,我感觉我得去刷刷矩阵幂和 ACdream给的指数循环了… 那里有好多题目…
真的久不做矩阵,我还犯了个错误,原来矩阵是不能交换律的…(⊙o⊙)哦！！！！！，然后测了很久才发现错误…
分析:矩阵快速幂&#43;循环节.
代码:
/* Author:GavinjouElephant * Title: * Number: * main meanning： * * * */ #include &lt;iostream&gt; using namespace std; #include &lt;cstdio&gt; #include &lt;cmath&gt; #include &lt;cstring&gt; #include &lt;algorithm&gt; #include &lt;sstream&gt; #include &lt;cctype&gt; #include &lt;vector&gt; #include &lt;set&gt; #include &lt;cstdlib&gt; #include &lt;map&gt; #include &lt;queue&gt; //#include&lt;initializer_list&gt; //#include &lt;windows.h&gt; //#include &lt;fstream&gt; //#include &lt;conio." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e414300e89d60f8420d9878314c740c8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-09-23T15:41:20+08:00" />
<meta property="article:modified_time" content="2016-09-23T15:41:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">『HDU 5895』Mathematician QSC</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>题目链接:<a href="http://acm.hdu.edu.cn/showproblem.php?pid=5895" rel="nofollow">http://acm.hdu.edu.cn/showproblem.php?pid=5895</a><br> 转载链接:<a href="http://blog.csdn.net/viscu/article/details/52595126">http://blog.csdn.net/viscu/article/details/52595126</a><br> 知识点链接:<a href="http://blog.csdn.net/acdreamers/article/details/8236942">http://blog.csdn.net/acdreamers/article/details/8236942</a></p> 
<p>题意:就是求一个公式 <img src="https://images2.imgbox.com/f2/ed/ZGERYlY8_o.jpg" alt="这里写图片描述"></p> 
<p>个人感想:<br> 今天补补我没看过的题,我一拿到题,然后拆分一下,我想,不就<strong>矩阵快速幂</strong>吗,对于每个 <strong>f[i]^2 求一个快速幂</strong>,然后我看了一下<strong>n*y,这个数据&lt;=10^12次方</strong>,就算用nlogn求完指数也会超时,…然后我就想不出来了,我考虑过,能不能用矩阵把<strong>g【n】一起求出来</strong>,然后想了会实在没头绪,- -之后无奈下看了下<strong>转载写的题解</strong>,… 我曹,这样构造矩阵也可以…,我服…我做这种类型构造有点少啊…所以也没什么感觉,<br> 然后我就觉得这样很简单啊,xjb搞搞就行了… 可是我突然发现…不行啊 应该可以取模才对啊,否则<strong>指数无限大啊</strong>。。。<br> 我再查了一下取模公式 只有**（a^b）%p ==((a%p)^p)%p**;<br> 但是没用啊。。。。<br> 再百度一下 <strong>指数循环节,题解也提到过</strong>,看看ACdreamer写的… 没什么解释,就摆了一条公式, 窝尼玛,真牛,我感觉我得去刷刷<strong>矩阵幂和 ACdream给的指数循环</strong>了… 那里有好多题目…</p> 
<p>真的久不做矩阵,我还犯了个错误,原来矩阵是不能交换律的…(⊙o⊙)哦！！！！！，然后测了很久才发现错误…</p> 
<p>分析:矩阵快速幂+循环节.</p> 
<p>代码:</p> 
<pre><code>/* Author:GavinjouElephant
 * Title:
 * Number:
 * main meanning：
 *
 *
 *
 */


#include &lt;iostream&gt;
using namespace std;
#include &lt;cstdio&gt;
#include &lt;cmath&gt;
#include &lt;cstring&gt;
#include &lt;algorithm&gt;
#include &lt;sstream&gt;
#include &lt;cctype&gt;
#include &lt;vector&gt;
#include &lt;set&gt;
#include &lt;cstdlib&gt;
#include &lt;map&gt;
#include &lt;queue&gt;
//#include&lt;initializer_list&gt;
//#include &lt;windows.h&gt;
//#include &lt;fstream&gt;
//#include &lt;conio.h&gt;
#define MaxN 0x7fffffff
#define MinN -0x7fffffff
#define lson 2*k
#define rson 2*k+1
typedef long long ll;
const int INF=0x3f3f3f3f;
const int maxn=1e5+10;
int Scan()//读入整数外挂.
{
    int res = 0, ch, flag = 0;

    if((ch = getchar()) == '-')             //判断正负
        flag = 1;

    else if(ch &gt;= '0' &amp;&amp; ch &lt;= '9')           //得到完整的数
        res = ch - '0';
    while((ch = getchar()) &gt;= '0' &amp;&amp; ch &lt;= '9' )
        res = res * 10 + ch - '0';
    return flag ? -res : res;
}
 void Out(int a)    //输出外挂
 {
     if(a&gt;9)
         Out(a/10);
     putchar(a%10+'0');
 }
 int T;
 ll n,y,x,s;
 typedef vector&lt;ll&gt; vec;
 typedef vector&lt;vec&gt; mat;
 int M;
 mat mul(mat &amp;A,mat &amp;B)
 {
     mat C(A.size(),vec(B[0].size()));
     for(int i=0;i&lt;A.size();i++)
     {
         for(int k=0;k&lt;B.size();k++)
         {
             for(int j=0;j&lt;B[0].size();j++)
             {
                 C[i][j]=(C[i][j]+A[i][k]*B[k][j])%M;
             }
         }
     }
     return C;
 }

ll pow(mat A,ll n)
 {
     if(n&lt;=1) return n;

     n-=1;
     mat B(A.size(),vec(A.size()));
     for(int i=0;i&lt;A.size();i++)
     {
         B[i][i]=1;
     }
     while(n&gt;0)
     {
         if(n&amp;1)B=mul(B,A);
         A=mul(A,A);
         n&gt;&gt;=1;
     }

//     for(int i=0;i&lt;B.size();i++)
//     {
//         for(int j=0;j&lt;B[0].size();j++)
//         {
//             cout&lt;&lt;B[i][j]&lt;&lt;" ";
//         }
//         cout&lt;&lt;endl;
//     }
//     cout&lt;&lt;"---&gt;B"&lt;&lt;endl;

     mat D(4,vec(4));
     D[0][0]=1;
     D[3][0]=1;
//
//     for(int i=0;i&lt;D.size();i++)
//     {
//         for(int j=0;j&lt;D.size();j++)
//         {
//             cout&lt;&lt;D[i][j]&lt;&lt;" ";
//         }
//         cout&lt;&lt;endl;
//     }
//     cout&lt;&lt;endl;

     D=mul(B,D);


//     for(int i=0;i&lt;D.size();i++)
//     {
//         for(int j=0;j&lt;D.size();j++)
//         {
//             cout&lt;&lt;D[i][j]&lt;&lt;" ";
//         }
//         cout&lt;&lt;endl;
//     }
//     cout&lt;&lt;endl;

     return D[3][0]%M;
 }

 ll ouler(ll x)
 {
     ll res=x;
     for(int i=2;i*i&lt;=x;i++)
     {
         if(x%i==0)
         {
             res=res/i*(i-1);
             while(x%i==0) x/=i;
         }
     }
     if(x&gt;1) res=res/x*(x-1);

     return res;
 }
 ll qmod(ll a,ll n,ll mod)
 {
     ll res=1;
     while(n)
     {
        if(n&amp;1)res=(res*a)%mod;
        a=(a*a)%mod;
        n&gt;&gt;=1;
     }
     return res%mod;
 }
 void solve()
 {
     mat A(4,vec(4));
     A[0][0]=4;A[0][1]=4;A[0][2]=1;A[0][3]=0;
     A[1][0]=2;A[1][1]=1;A[1][2]=0;A[1][3]=0;
     A[2][0]=1;A[2][1]=0;A[2][2]=0;A[2][3]=0;
     A[3][0]=4;A[3][1]=4;A[3][2]=1;A[3][3]=1;

     ll zhi=pow(A,n*y)%M+M;


     printf("%I64d\n",qmod(x,zhi,s+1));

 }


int main()
{
#ifndef ONLINE_JUDGE
    freopen("coco.txt","r",stdin);
    freopen("lala.txt","w",stdout);
#endif
    scanf("%d",&amp;T);
    while(T--)
    {
        scanf("%I64d%I64d%I64d%I64d",&amp;n,&amp;y,&amp;x,&amp;s);
        M=ouler(s+1);

        solve();

    }

    return 0;
}

</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/68dc90ec2413a8849f16a79a1a40852c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linq表达式和Lambda表达式用法对比</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/20c950c68e8c23f6576bde51431c803d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">阅读感悟_之分享一些自己的学习历程和学习方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>