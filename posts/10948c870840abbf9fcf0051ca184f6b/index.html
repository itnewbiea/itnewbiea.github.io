<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>数据分析编程检验——车流量统计（不能使用pandas和numpy） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="数据分析编程检验——车流量统计（不能使用pandas和numpy）" />
<meta property="og:description" content="目录
一、要求展示
二、获取内容
1、从文本中取内容
​ 2、对文本中的内容处理
三、需求计算
1、按车辆编号对数据进行分组，统计采样时间间隔
①分组
②计算
四、源码
一、要求展示 二、获取内容 1、从文本中取内容 写一个程序时，可以边写边查看，这样可以避免代码写多了之后出现BUG时不容易解决，因为可能是因为之前的代码导致后面的问题
当文本的数据很多时，如果每次都读取全部的数据则会花很多的时间，所以可以拷贝一段数据在一个测试的文档中，测试文档实现之后再用全部的数据能节省很多时间
查看结果知道所有的数据存储在一个列表中，接下来的操作就是遍历列表了，将数据取出来
contents = open(&#34;./附件一/test.txt&#34;).readlines() print(contents) 2、对文本中的内容处理 通过查看获取的文本的内容可知，列表中的每个元素最后都是带有\n的，输出时也就是一整行的空格，此时就需要将空格给去掉了，需要用到strip
strip的作用就是消除前后的空格，返回的是字符串，然后再将字符串用空格切割，将想要的数据分离出来
因为取的数据正好是第一个和最后一个，所以不需要去数在第几个
for content in contents: record_arry = content.strip().split(&#34; &#34;) print(record_arry[0],record_arry[-1]) 三、需求计算 1、按车辆编号对数据进行分组，统计采样时间间隔 ①分组 python代码的分组需要做的操作就是将数据用字典的形式存储起来，也就是一个键对应着多个值
当键在字典中的时候，需要的是添加到键的列表中，不在的时候就是创建键值对
此处有一个技巧或者说难点，就是如何在存在的时候将数据加到列表的值中，关键点在于创建键值对的时候就将值的类型设置成列表类型的，需要加时就直接调用列表的append方法即可，如果不设置的话，也就是值的格式为字符串类型，此时要想再加就困难了
key_str = record_arry[0] time_str = record_arry[-1] if key_str in result: result[key_str].append(time_str) else: result[key_str] = [time_str]#关键在于将此处的类型设置为列表 print(result,end=&#39;\n&#39;) ②计算 因为得到的时间是字符串类型的，做差求时间间隔是按照10进制的方式进行的，但是真正的时间是按照60进制进行的，所以需要转换为时间类型的
datetime.strptime()可以将字符串转换成为时间类型的函数，需要导入datetime包
此时存到列表中的值是一个datetime类型，但是在计算以及print时输出的是时间
key_str = record_arry[0] time_str = record_arry[-1] if key_str in result: result[key_str]." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/10948c870840abbf9fcf0051ca184f6b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-26T13:15:58+08:00" />
<meta property="article:modified_time" content="2022-07-26T13:15:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">数据分析编程检验——车流量统计（不能使用pandas和numpy）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<p id="%E4%B8%80%E3%80%81%E8%A6%81%E6%B1%82%E5%B1%95%E7%A4%BA-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E8%A6%81%E6%B1%82%E5%B1%95%E7%A4%BA" rel="nofollow">一、要求展示</a></p> 
<p id="%E4%BA%8C%E3%80%81%E8%8E%B7%E5%8F%96%E5%86%85%E5%AE%B9-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E8%8E%B7%E5%8F%96%E5%86%85%E5%AE%B9" rel="nofollow">二、获取内容</a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201%E3%80%81%E4%BB%8E%E6%96%87%E6%9C%AC%E4%B8%AD%E5%8F%96%E5%86%85%E5%AE%B9-toc" style="margin-left:40px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201%E3%80%81%E4%BB%8E%E6%96%87%E6%9C%AC%E4%B8%AD%E5%8F%96%E5%86%85%E5%AE%B9" rel="nofollow">        1、从文本中取内容</a></p> 
<p id="%E2%80%8B%E7%BC%96%E8%BE%91%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A02%E3%80%81%E5%AF%B9%E6%96%87%E6%9C%AC%E4%B8%AD%E7%9A%84%E5%86%85%E5%AE%B9%E5%A4%84%E7%90%86-toc" style="margin-left:40px;"><a href="#%E2%80%8B%E7%BC%96%E8%BE%91%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A02%E3%80%81%E5%AF%B9%E6%96%87%E6%9C%AC%E4%B8%AD%E7%9A%84%E5%86%85%E5%AE%B9%E5%A4%84%E7%90%86" rel="nofollow">​</a><a href="#%E2%80%8B%E7%BC%96%E8%BE%91%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A02%E3%80%81%E5%AF%B9%E6%96%87%E6%9C%AC%E4%B8%AD%E7%9A%84%E5%86%85%E5%AE%B9%E5%A4%84%E7%90%86" rel="nofollow">        </a><a href="#%E2%80%8B%E7%BC%96%E8%BE%91%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A02%E3%80%81%E5%AF%B9%E6%96%87%E6%9C%AC%E4%B8%AD%E7%9A%84%E5%86%85%E5%AE%B9%E5%A4%84%E7%90%86" rel="nofollow"> 2、对文本中的内容处理</a></p> 
<p id="%C2%A0%E4%B8%89%E3%80%81%E9%9C%80%E6%B1%82%E8%AE%A1%E7%AE%97-toc" style="margin-left:0px;"><a href="#%C2%A0%E4%B8%89%E3%80%81%E9%9C%80%E6%B1%82%E8%AE%A1%E7%AE%97" rel="nofollow"> 三、需求计算</a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201%E3%80%81%E6%8C%89%E8%BD%A6%E8%BE%86%E7%BC%96%E5%8F%B7%E5%AF%B9%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E5%88%86%E7%BB%84%EF%BC%8C%E7%BB%9F%E8%AE%A1%E9%87%87%E6%A0%B7%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%94-toc" style="margin-left:40px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201%E3%80%81%E6%8C%89%E8%BD%A6%E8%BE%86%E7%BC%96%E5%8F%B7%E5%AF%B9%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E5%88%86%E7%BB%84%EF%BC%8C%E7%BB%9F%E8%AE%A1%E9%87%87%E6%A0%B7%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%94" rel="nofollow">        1、按车辆编号对数据进行分组，统计采样时间间隔</a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%E2%91%A0%E5%88%86%E7%BB%84-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%E2%91%A0%E5%88%86%E7%BB%84" rel="nofollow">                ①分组</a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%E2%91%A1%E8%AE%A1%E7%AE%97-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%E2%91%A1%E8%AE%A1%E7%AE%97" rel="nofollow">                 ②计算</a></p> 
<p id="%E5%9B%9B%E3%80%81%E6%BA%90%E7%A0%81-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81%E6%BA%90%E7%A0%81" rel="nofollow">四、源码</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E4%B8%80%E3%80%81%E8%A6%81%E6%B1%82%E5%B1%95%E7%A4%BA">一、要求展示</h2> 
<p>        <img alt="" height="892" src="https://images2.imgbox.com/6d/89/d0huvmoF_o.png" width="1200"></p> 
<p></p> 
<h2 id="%E4%BA%8C%E3%80%81%E8%8E%B7%E5%8F%96%E5%86%85%E5%AE%B9">二、获取内容</h2> 
<h3 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201%E3%80%81%E4%BB%8E%E6%96%87%E6%9C%AC%E4%B8%AD%E5%8F%96%E5%86%85%E5%AE%B9">        1、从文本中取内容</h3> 
<blockquote> 
 <p>        写一个程序时，可以边写边查看，这样可以避免代码写多了之后出现BUG时不容易解决，因为可能是因为之前的代码导致后面的问题</p> 
 <p>        </p> 
 <p>        当文本的数据很多时，如果每次都读取全部的数据则会花很多的时间，所以可以拷贝一段数据在一个测试的文档中，测试文档实现之后再用全部的数据能节省很多时间</p> 
 <p>        查看结果知道所有的数据存储在一个列表中，接下来的操作就是遍历列表了，将数据取出来</p> 
</blockquote> 
<pre><code>contents = open("./附件一/test.txt").readlines()
print(contents)
</code></pre> 
<h3 id="%E2%80%8B%E7%BC%96%E8%BE%91%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A02%E3%80%81%E5%AF%B9%E6%96%87%E6%9C%AC%E4%B8%AD%E7%9A%84%E5%86%85%E5%AE%B9%E5%A4%84%E7%90%86"><img alt="" height="52" src="https://images2.imgbox.com/48/85/oIyw2w7E_o.png" width="1200">         2、对文本中的内容处理</h3> 
<blockquote> 
 <p>        通过查看获取的文本的内容可知，列表中的每个元素最后都是带有\n的，输出时也就是一整行的空格，此时就需要将空格给去掉了，需要用到strip<br>         strip的作用就是消除前后的空格，返回的是字符串，然后再将字符串用空格切割，将想要的数据分离出来<br>         因为取的数据正好是第一个和最后一个，所以不需要去数在第几个</p> 
</blockquote> 
<pre><code>for content in contents:
    record_arry = content.strip().split(" ")
    print(record_arry[0],record_arry[-1])

</code></pre> 
<p><img alt="" height="441" src="https://images2.imgbox.com/1f/d7/rD91j6If_o.png" width="447"></p> 
<h2 id="%C2%A0%E4%B8%89%E3%80%81%E9%9C%80%E6%B1%82%E8%AE%A1%E7%AE%97"> 三、需求计算</h2> 
<h3 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201%E3%80%81%E6%8C%89%E8%BD%A6%E8%BE%86%E7%BC%96%E5%8F%B7%E5%AF%B9%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E5%88%86%E7%BB%84%EF%BC%8C%E7%BB%9F%E8%AE%A1%E9%87%87%E6%A0%B7%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%94">        1、按车辆编号对数据进行分组，统计采样时间间隔</h3> 
<h4 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%E2%91%A0%E5%88%86%E7%BB%84">                ①分组</h4> 
<blockquote> 
 <p>        python代码的分组需要做的操作就是将数据用字典的形式存储起来，也就是一个键对应着多个值</p> 
 <p>        当键在字典中的时候，需要的是添加到键的列表中，不在的时候就是创建键值对</p> 
 <p>        此处有一个技巧或者说难点，就是如何在存在的时候将数据加到列表的值中，关键点在于创建键值对的时候就将值的类型设置成列表类型的，需要加时就直接调用列表的append方法即可，如果不设置的话，也就是值的格式为字符串类型，此时要想再加就困难了</p> 
</blockquote> 
<pre><code> key_str = record_arry[0]
    time_str = record_arry[-1]
    if key_str in result:
        result[key_str].append(time_str)

    else:
        result[key_str] = [time_str]#关键在于将此处的类型设置为列表

print(result,end='\n')</code></pre> 
<p><img alt="" height="72" src="https://images2.imgbox.com/72/8c/EvU1IM2f_o.png" width="1200"></p> 
<h4 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%E2%91%A1%E8%AE%A1%E7%AE%97">                 ②计算</h4> 
<blockquote> 
 <p>        因为得到的时间是字符串类型的，做差求时间间隔是按照10进制的方式进行的，但是真正的时间是按照60进制进行的，所以需要转换为时间类型的</p> 
 <p>        datetime.strptime()可以将字符串转换成为时间类型的函数，需要导入datetime包</p> 
 <p>        此时存到列表中的值是一个datetime类型，但是在计算以及print时输出的是时间</p> 
</blockquote> 
<pre><code>key_str = record_arry[0]
    time_str = record_arry[-1]
    if key_str in result:
        result[key_str].append(datetime.strptime(time_str,'%Y%m%d%H%M%S'))
        # print(datetime.strptime(time_str,'%Y%m%d%H%M%S'))

    else:
        result[key_str] = [datetime.strptime(time_str,'%Y%m%d%H%M%S')]
        # print(datetime.strptime(time_str, '%Y%m%d%H%M%S'))
print(result)</code></pre> 
<p><img alt="" height="91" src="https://images2.imgbox.com/ce/dd/FZSJKPTK_o.png" width="1200"></p> 
<blockquote> 
 <p>         将其转换为时间类型之后就可以对其进行排序了，排序之后再做差就能得到结果</p> 
 <p>        因为涉及几个数据的计算，所以可以将其封装到一个函数中，然后一些返回</p> 
 <p>        题目要求的是对时间间隔进行统计，也就是在之前的基础上去再计算</p> 
</blockquote> 
<pre><code>def computer_gap(sort_list:list):
    """
    对统计指标进行计算
    :param sort_list:
    :return:
    """
    gap_arry = []#收集gap的值
    row_sorted = sorted(sort_list)#排序
    #得到时间间隔
    for idx in range(1,len(row_sorted)):
        gap = (row_sorted[idx] - row_sorted[idx-1]).seconds
        if gap&lt;300:
            gap_arry.append(gap)
    a = len(gap_arry)#返回的是间隔数量
    #返回的是间隔的中位数
    if a%2 != 0:
        b = gap_arry[int(a/2)]
    else:
        b = gap_arry[int(a/2)] + gap_arry[int(a/2)-1]
    #返回的是间隔的平均数
    c = sum(gap_arry)/a
    return a,b,c
</code></pre> 
<h2 id="%E5%9B%9B%E3%80%81%E6%BA%90%E7%A0%81">四、源码</h2> 
<pre><code># -*- coding: utf-8 -*-
from datetime import datetime

def computer_gap(sort_list:list):
    """
    对统计指标进行计算
    :param sort_list:
    :return:
    """
    gap_arry = []#收集gap的值
    row_sorted = sorted(sort_list)#排序
    #得到时间间隔
    for idx in range(1,len(row_sorted)):
        gap = (row_sorted[idx] - row_sorted[idx-1]).seconds
        if gap&lt;300:
            gap_arry.append(gap)
    a = len(gap_arry)#返回的是间隔数量
    #返回的是间隔的中位数
    if a%2 != 0:
        b = gap_arry[int(a/2)]
    else:
        b = gap_arry[int(a/2)] + gap_arry[int(a/2)-1]
    #返回的是间隔的平均数
    c = sum(gap_arry)/a
    return a,b,c


contents = open("./附件一/test.txt").readlines()
# print(contents)
result = {}
for content in contents:
    record_arry = content.strip().split(" ")
    # print(record_arry[0],record_arry[-1])
    key_str = record_arry[0]
    time_str = record_arry[-1]
    if key_str in result:
        # 如果存在将数据加入分组
        result[key_str].append(datetime.strptime(time_str,'%Y%m%d%H%M%S'))
        # print(datetime.strptime(time_str,'%Y%m%d%H%M%S'))

    else:
        # 如果不存在，创建分组，并初始化第一个元素
        result[key_str] = [datetime.strptime(time_str,'%Y%m%d%H%M%S')]
        # print(datetime.strptime(time_str, '%Y%m%d%H%M%S'))

result_gap = {}
with open("result.txt","a+") as fp:
    for key_str in result:
        car_arry = result[key_str]
        if len(car_arry) &gt; 1:
            a,b,c = computer_gap(car_arry)
            fp.write(key_str + '\t' + str(a) + '\t' + str(b) + '\t' + str(c) + '\n')

</code></pre> 
<p></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/85/38/Vr58xCEf_o.png"> </p> 
<p> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f6e0c73143d89095679542e0c6343141/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python 求极值</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/51c3dee7763c08ac97ce2d8af4cbf427/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">龙迅HDMI2.0/1.4 开关具有一个符合 HDMI2.0/1.4 规范</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>