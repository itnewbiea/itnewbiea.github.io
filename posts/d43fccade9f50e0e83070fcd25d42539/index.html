<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>局域网基于linux麒麟v10搭建mysql - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="局域网基于linux麒麟v10搭建mysql" />
<meta property="og:description" content="因为是局域网 缺失很多工具，要先安装yum源 自行百度吧。
curl -o yum.sh http://169.254.169.253:10080/KylinOS/yum.sh
sh yum.sh
yum clean all
yum makecache
1、执行安装依赖
sudo yum install -y wget vim gcc gcc-c&#43;&#43; make cmake ncurses ncurses-devel bison openssl openssl-devel boost-devel libtirpc libtirpc-devel
或
yum install gcc gcc-c&#43;&#43; cmake ncurses-devel bison openssl-devel rpcgen
后续安装
安装前的环境准备工作和说明
1.系统版本
MySQL：mysql-boost-5.7.36.tar.gz
mysql下载路径：/opt/tools
mysql安装路径：/app/mysql
2.说明
源码编译安装 一、清理删除旧版本安装包残留
1.查找mysql相关安装
[root@localhost ~]# rpm -qa | grep -i mysql
[root@localhost ~]# yum list installed | grep mysql // 第二种方式yum，用这个方式" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/d43fccade9f50e0e83070fcd25d42539/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-21T13:42:29+08:00" />
<meta property="article:modified_time" content="2023-08-21T13:42:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">局域网基于linux麒麟v10搭建mysql</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>因为是局域网 缺失很多工具，要先安装yum源 自行百度吧。</p> 
<p>curl -o yum.sh http://169.254.169.253:10080/KylinOS/yum.sh</p> 
<p>sh yum.sh<br> yum clean all<br> yum makecache</p> 
<p>1、执行安装依赖</p> 
<p>sudo yum install -y wget vim gcc gcc-c++ make cmake ncurses ncurses-devel bison openssl openssl-devel boost-devel libtirpc libtirpc-devel</p> 
<p>或</p> 
<p>yum install gcc gcc-c++ cmake ncurses-devel bison openssl-devel rpcgen<br>  </p> 
<p>后续安装</p> 
<p>安装前的环境准备工作和说明<br> 1.系统版本<br> MySQL：mysql-boost-5.7.36.tar.gz</p> 
<p>mysql下载路径：/opt/tools</p> 
<p>mysql安装路径：/app/mysql</p> 
<p><br> 2.说明</p> 
<p>源码编译安装    </p> 
<p>一、清理删除旧版本安装包残留<br> 1.查找mysql相关安装<br> [root@localhost ~]# rpm -qa | grep -i mysql<br> [root@localhost ~]# yum list installed | grep mysql   // 第二种方式yum，用这个方式<br><br> 若查询到mysql，则卸载</p> 
<p>[root@localhost ~]# rpm –e {包名}，如：</p> 
<p>[root@localhost ~]# rpm -e mysql-community-common-xxxx-1.el7.x86_64<br><br> # 如果使用上面命令删除时，提示有依赖的其它文件，则用如下命令只删除mysql套件</p> 
<p>[root@localhost ~]# rpm -e --nodeps {包名}</p> 
<p>[root@localhost ~]# rpm -e --nodeps 强制接卸（--nodeps 不检查依赖关系；--force 强制安装）</p> 
<p>[root@localhost ~]# rpm删除时如果有依赖关系，可以用yum remove + 包名来删除</p> 
<p>2.查看系统Mariadb<br> [root@localhost ~]# rpm -qa | grep -i mariadb<br> [root@localhost ~]# yum list installed | grep mariadb  // 第二种方式yum，用这个方式<br><br> 若查询到mariadb，则卸载</p> 
<p>[root@localhost ~]# rpm -e --nodeps {mariadb包名}，如：</p> 
<p>[root@localhost ~]# rpm -e --nodeps mariadb-libs-xxxxx-1.el7.x86_64<br>  </p> 
<p><br> 3.查找老版本mysql相关的安装目录命令<br> [root@localhost ~]# find / -name mysql<br><br> 若查找到相关目录使用命令：rm –rf {目录名}，如：</p> 
<p>[root@localhost ~]# rm -rf /etc/selinux/targeted/active/modules/100/mysql<br> [root@localhost ~]# rm -rf /usr/lib64/mysql<br><br> 删除卸载完之后再检查确认下</p> 
<p>[root@localhost ~]# find / -name mysql<br> [root@localhost ~]# rpm -qa | grep -i mysql<br> [root@localhost ~]# rpm -qa | grep -i mariadb<br><br> 如没有查到，则卸载删除完成</p> 
<p>4.确认清理安装环境<br> [root@localhost ~]# yum erase mariadb mariadb-server mariadb-libs mariadb-devel -y<br> [root@localhost ~]# userdel -r mysql<br> [root@localhost ~]# rm -rf /etc/my*<br> [root@localhost ~]# rm -rf /var/lib/mysql<br>  </p> 
<p></p> 
<p>下载和解压源码包<br> 1.源码包相关说明：<br> mysql官方下载地址：​ ​https://downloads.mysql.com/archives/community/​​​</p> 
<p>如下图，我们要源码编译安装</p> 
<p>选择mysql-5.7.36.tar.gz或者mysql-boost-5.7.36.tar.gz（这个MySQL源码包里包含了boost）</p> 
<p>如果选择mysql-5.7.36.tar.gz这个源码包，就必须要下载一个boost库包boost_1_59_0.tar（否则预编译时会通不过报错）。</p> 
<p>mysql-5.7.36.tar.gz官方下载地址：</p> 
<p>​ ​https://downloads.mysql.com/archives/get/p/23/file/mysql-5.7.36.tar.gz​​​</p> 
<p>boost第三方下载地址：</p> 
<p>​ ​http://www.sourceforge.net/projects/boost/files/boost/1.59.0/boost_1_59_0.tar.gz​​​</p> 
<p>mysql-boost-5.7.36.tar.gz官方下载地址：</p> 
<p>​ ​https://downloads.mysql.com/archives/get/p/23/file/mysql-boost-5.7.36.tar.gz​​</p> 
<p>注：在Linux下wget国内速度下载可能较慢，可从第三方镜像市场下载</p> 
<p>mysql-5.7.36.tar.gz：</p> 
<p>​ ​http://mirrors.163.com/mysql/Downloads/MySQL-5.7/mysql-5.7.36.tar.gz​​​</p> 
<p>boost_1_59_0.tar.gz：</p> 
<p>​ ​http://mirrors.linuxeye.com/oneinstack/src/boost_1_59_0.tar.gz​​​（LinuxEye开源镜像）</p> 
<p>mysql-boost-5.7.36.tar.gz：</p> 
<p>​ ​http://mirrors.163.com/mysql/Downloads/MySQL-5.7/mysql-boost-5.7.36.tar.gz​​</p> 
<p>2.下载mysql源码包<br> ①.在Linux下创建一个源码包下载目录：</p> 
<p>[root@localhost ~]# mkdir /opt/tools  #创建目录<br> [root@localhost ~]# cd /opt/tools/ <br> [root@localhost ~]# mkdir data<br> [root@localhost ~]# mkdir tmp<br> [root@localhost tools]# ls            #查看目录下文件<br> [root@localhost tools]# pwd           #查看该目录路径<br> /opt/tools<br> [root@localhost tools]#<br><br> ②.在该目录路径下直接下载源码包：</p> 
<p>[root@localhost tools]# wget http://mirrors.163.com/mysql/Downloads/MySQL-5.7/mysql-boost-5.7.36.tar.gz<br><br> #鉴于boost在Linux中用wget不太好下载或者下载较慢，本次安装直接选择mysql-boost-5.7.36.tar.gz这个源码包比较方便，不用再下载单独的boost库包。</p> 
<p>#我这里直接从网易镜像下载，等下载完成后，在tools目录下查看到源码包已下载好。</p> 
<p>[root@localhost tools]# ls  <br> mysql-boost-5.7.36.tar.gz<br> [root@localhost tools]#<br>  </p> 
<p>-------------从本地上传源码包到Linux-------------</p> 
<p>解压mysql源码包<br> [root@localhost ~]# mkdir /opt/tools   #进入前目录，如果已在当前目录，可忽略<br> [root@localhost ~]# tar -zxvf mysql-boost-5.7.36.tar.gz   #解压源码包<br> [root@localhost ~]# mkdir /opt/tools/data    #解压源码包<br> [root@localhost ~]# mkdir /opt/tools/tmp   #解压源码包<br> [root@localhost tools]# ls   #查看到已解压好<br> mysql-5.7.36  mysql-boost-5.7.36.tar.gz<br> [root@localhost tools]# cd mysql-5.7.36/   #进入到已解压的源码包目录<br> [root@localhost mysql-5.7.36]# ls   #可已查到该目录下有个boost目录<br><br> boost的路径：</p> 
<p>/opt/tools/mysql-5.7.36/boost （先记下这个路径，等下后面预编译用到）</p> 
<p>四、源码编译安装<br> 1.预编译（设置编译参数）<br> #注意是在解压好的源码包mysql-5.7.36这个路径下执行。</p> 
<p>[root@localhost mysql-5.7.36]# cmake . -DCMAKE_INSTALL_PREFIX=/app/mysql \<br> -DMYSQL_DATADIR=/app/mysql/data \<br> -DMYSQL_UNIX_ADDR=/app/mysql/tmp/mysql.sock \<br> -DDOWNLOAD_BOOST=1 \<br> -DWITH_BOOST=/usr/local/src/boost \<br> -DDEFAULT_CHARSET=utf8 \<br> -DDEFAULT_COLLATION=utf8_general_ci \<br> -DWITH_EXTRA_CHARSETS=all \<br> -DWITH_INNOBASE_STORAGE_ENGINE=1 \<br> -DWITH_FEDERATED_STORAGE_ENGINE=1 \<br> -DWITH_BLACKHOLE_STORAGE_ENGINE=1 \<br> -DWITHOUT_EXAMPLE_STORAGE_ENGINE=1 \<br> -DWITH_ZLIB=bundled \<br> -DWITH_SSL=system \<br> -DENABLED_LOCAL_INFILE=1 \<br> -DWITH_EMBEDDED_SERVER=1 \<br> -DENABLE_DOWNLOADS=1 \<br> -DWITH_DEBUG=0<br><br> #以上是要设置的一些参数，比如mysql的安装目录，boost的路径等。</p> 
<p>#根据个人需要设置安装路径，以及boost的路径。</p> 
<p>等执行完成之后，看到如下内容，表示执行成功。</p> 
<p>-- Configuring done<br> -- Generating done<br> -- Build files have been written to: /opt/tools/mysql-5.7.36<br> [root@localhost mysql-5.7.36]#<br><br> #如果 CMake 失败，为了防止使用旧的目标文件或配置信息，请运行以下命令，然后重新运行 CMake ：</p> 
<p>[root@localhost mysql-5.7.36]# make clean<br> [root@localhost mysql-5.7.36]# rm CMakeCache.txt<br>  </p> 
<p><br> 2.编译安装<br> [root@localhost mysql-5.7.36]# make &amp;&amp; make install<br><br> #等待时间有点长，要看Linux的硬件配置和网络情况，一直要等到执行完成。</p> 
<p>#可以使用echo $?看返回值是否为0，为0则表示正确</p> 
<p>[root@localhost mysql-5.7.36]# echo $?<br> 0<br> [root@localhost mysql-5.7.36]#<br><br> #再查看/app/mysql/目录，如果该目录下有内容，则表示mysql-5.7.36源代码包采用cmake方式安装成功了。</p> 
<p>[root@localhost ~]# cd /app/mysql/<br> [root@localhost mysql]# ls<br> bin  docs  include  lib  LICENSE  man  mysql-test  README  README-test  share  support-files<br> [root@localhost mysql]#<br>  </p> 
<p><br> 五、创建mysql用户<br> [root@localhost ~]# groupadd mysql   # 添加组myql<br> [root@localhost ~]# useradd -r -g mysql -s /sbin/nologin -M mysql    # 添加用户mysql到mysql组中<br> [root@localhost ~]# id mysql   # 查看mysql id<br><br> 如下：</p> 
<p>[root@localhost mysql]# cd<br> [root@localhost ~]# id mysql<br> id: mysql: no such user<br> [root@localhost ~]# groupadd mysql<br> [root@localhost ~]# useradd -r -g mysql -s /sbin/nologin -M mysql  <br> [root@localhost ~]# id mysql  <br> uid=998(mysql) gid=1000(mysql) 组=1000(mysql)<br> [root@localhost ~]#<br>  </p> 
<p><br> 六、创建安装目录和文件<br> [root@localhost ~]# mkdir -p /app/mysql  #安装目录在编译时已自动生成，可不用再创建。<br> [root@localhost ~]# mkdir -p /app/mysql/tmp<br> [root@localhost ~]# mkdir -p /app/mysql/log<br> [root@localhost ~]# touch /app/mysql/log/mysql.log   #创建日志文件，否则后面初始化时会报错。<br><br> #创建的tmp和log以及mysql.log根据自己需要设置，这里是配合下面的my.cnf用到。</p> 
<p><br> 七、修改目录权限<br> [root@localhost ~]# chown -R mysql:mysql /app/mysql<br> [root@localhost ~]# chown mysql.mysql /app/mysql/tmp<br> [root@localhost ~]# chown mysql.mysql /app/mysql/log/mysql.log<br>  </p> 
<p><br> 八、创建和配置my.cnf文件和环境变量<br> 1.my.cnf配置文件<br> [root@localhost ~]# vim /etc/my.cnf   #编辑my.cnf文件<br><br> [mysqld]<br> # 安装目录<br> basedir=/app/mysql<br> # 存放数据的目录<br> datadir=/app/mysql/data<br> # 指定端口号<br> port=3306<br> #timestamp 参数开启，否则初始化时会报错<br> explicit_defaults_for_timestamp=1<br> # 指定Socket文件存放路径<br> socket=/app/mysql/tmp/mysql.sock<br> # 指定默认的字符集编码<br> character-set-server=utf8<br> # MySQL错误日志路径<br> log-error=/app/mysql/log/mysql.log<br> # 指定MySQL pid文件路径<br> pid-file=/app/mysql/mysql.pid<br> [mysql]<br> socket=/app/mysql/tmp/mysql.sock<br> [client]<br> socket=/app/mysql/tmp/mysql.sock<br><br> #进入vim编辑器后，按 i 键，把上面内容复制粘贴好，然后按Esc键，再输入：":wq"保存退出（双引号里面的内容，不包括双引号哦）</p> 
<p>2.配置环境变量<br> 两种方式，看个人喜好选择一种即可。</p> 
<p>①.方式1</p> 
<p>[root@localhost ~]# vim /etc/profile.d/mysql.sh   #vim编辑mysql.sh文件<br><br> export PATH=$PATH:/app/mysql/bin<br><br> #复制以上加入环境变量，vim编辑器操作见上面说明.</p> 
<p>source /etc/profile.d/mysql.sh   #重新加载<br> echo $PATH   #查看环境变量<br>  </p> 
<p><br> ②.方式2</p> 
<p>echo "export PATH=/app/mysql/bin/:$PATH" &gt;&gt; /etc/profile  #直接写入环境变量<br> source /etc/profile   #重新加载<br> echo $PATH   #查看环境变量<br>  </p> 
<p><br> 九、初始化数据库和启动服务<br> 1.初始化数据库<br> #执行myql的安装目录下的bin目录文件，而不是下载解压的目录，为了不搞混淆，我这直接写死了bin下的完整路径。</p> 
<p>二选一：执行一条即可</p> 
<p>#--initialize  #生成随机的初始root密码</p> 
<p>[root@localhost ~]# /app/mysql/bin/mysqld --initialize-insecure --user=mysql --basedir=/app/mysql/ --datadir=/app/mysql/data</p> 
<p>#--initialize-insecure  #不会生成root密码，登录连接后，使用ALTER USER语句分配新的root密码。<br> [root@localhost ~]# /app/mysql/bin/mysqld --initialize --user=mysql --basedir=/app/mysql/ --datadir=/app/mysql/data</p> 
<p></p> 
<p>#这里直接选择不生成密码，等到后面登录到mysql再直接分配。</p> 
<p>2.配置启动脚本，并启动服务​<br> [root@localhost ~]# cp /app/mysql/support-files/mysql.server /etc/init.d/mysqld   #mysql启动关闭添加到 /etc/init.d/mysqld<br> [root@localhost ~]# systemctl daemon-reload   #重新加载<br> [root@localhost ~]# systemctl start mysqld   #启动mysql<br> [root@localhost ~]# systemctl stop mysqld   #关闭mysql<br> [root@localhost ~]# service mysqld status   #查看mysql运行状态</p> 
<p>[root@localhost ~]# service mysqld status<br> ERROR! MySQL is not running<br> #若关闭后查看mysql没有运行</p> 
<p>[root@localhost ~]# service mysqld status<br> SUCCESS! MySQL running (41629)<br> #若启动后查看mysql正常运行<br><br> 十、登录mysq修改分配密码和查看数据库<br> 1.首次登录<br> [root@localhost ~]# mysql -uroot -p<br> Enter password:  <br> Welcome to the MySQL monitor.  Commands end with ; or \g.<br> Your MySQL connection id is 2<br> Server version: 5.7.36 Source distribution<br> Copyright (c) 2000, 2021, Oracle and/or its affiliates.<br> Oracle is a registered trademark of Oracle Corporation and/or its<br> affiliates. Other names may be trademarks of their respective<br> owners.<br> Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.<br> mysql&gt;<br><br> #由于初始化时没有生成密码，首次登录要求输入密码时，直接回车后就登录到mysql了。</p> 
<p>#在这里可以看到mysql相关的信息，比如版本，还有mysql的一些辅助信息。</p> 
<p>2.修改密码<br> mysql&gt; alter user root@localhost identified by '123456';<br><br> mysql&gt; exit #退出后再重新用刚设置的密码就可以登录mysql了。</p> 
<p>[root@localhost ~]# mysql -uroot -p<br> Enter password:<br>  </p> 
<p><br> 3.查看数据库<br> mysql&gt; show databases;<br><br><br> 至此，mysql已安装完成。</p> 
<p>附加：配置远程登录授权<br> [root@localhost ~]# firewall-cmd --permanent --add-port=3306/tcp   #开放3306端口<br> [root@localhost ~]# firewall-cmd --reload   #重启防火墙<br> [root@localhost ~]# firewall-cmd --list-all   #查看防火墙<br> [root@localhost ~]# mysql -uroot -p   #登录到mysql<br> Enter password: <br> mysql&gt; GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '123456' WITH GRANT OPTION;   #远程连接授权<br> mysql&gt; flush privileges;   #刷新授权<br> mysql&gt; exit;   #退出mysql<br><br> 完成以上后，连接工具Navicat 测试远程登录正常。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6766f9157f09841a4c558fadd86687de/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue&#43;vite&#43;electron项目打包成Mac，Windows安装包</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cdaa36c3ff7f573f357d93d9ff804e2c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vite&#43; vue3项目添加electron，并electron打包教程，以及electron代码热重载页面</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>