<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>android tombstone log分析 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="android tombstone log分析" />
<meta property="og:description" content="今天和大家一起聊聊android 中出现的 Tombstone问题，近期在定制pad 上分析设备概率性重启，导出bugreport日志后，除了看到anr log外，同级目录下还看到了tombstones
并且对比以往日志，发现都生产了大量tombstone...,于是决定一探究竟，或许问题和它有关呢 tombstone概念
tombstone一般是由Dalvik错误、状态监视调试器、C层代码以及libc的一些问题导致的。
当系统发生tombstone的时候，kernel首先会上报一个严重的警告信号(signal),上层接收到之后，进程的调试工具会把进程中当时的调用栈现场保存起来，并在系统创建了data/tombstones目录后把异常时的进程信息写在此目录里面，开发者需要通过调用栈来分析整个调用流程来找出出问题的点。
分析tombstone原因
下面是我遇到的tombstone情况
pid与tid 相同，问题出在主线程
pid与tid 不同，问题出在子线程
signal 信号量分析
信号机制是进程之间相互传递消息的一种方法，常见的型号种类如下：
问题总结
以上两种情况是我遇到的，pid 和tid相同的情况，根据日志分析和对比前后复现问题的tombstone，发现均为三方应用或内部应用在某种场景下诱发Native Crash 可以根据进程号跟踪到相应位置，（真正找到问题根源可能麻烦些，大体是这个路子）；
pid 和tid不同的情况，分析起来有点无从下手，但是前前后后对比日志，发现这种情况进程均为系统服务进程pid: 467, tid: 806, name: HwBinder:467_3 &gt;&gt;&gt;/vendor/bin/hw/android.hardware.audio.service.mediatek &lt;&lt;&lt;
只能根据signal 来找到比较完整的调用栈以及调用底层编码逻辑...
就简单写到这里了，欢迎大家交流补充，如有不对，敬请纠正!
参考链接
Android Tombstone crash定位分析
https://cloud.tencent.com/developer/article/1969660
Android开发太难了，Native Crash的一切！
android跨进程通信——signal https://www.jianshu.com/p/73c33648ffc8
signal 6 (SIGABRT) log分析
https://blog.csdn.net/weixin_29172201/article/details/117613032" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/a13972014d86bb018314a8b16e4c1180/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-07T18:10:08+08:00" />
<meta property="article:modified_time" content="2023-02-07T18:10:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">android tombstone log分析</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>今天和大家一起聊聊android 中出现的 Tombstone问题，近期在定制pad 上分析设备概率性重启，导出bugreport日志后，除了看到anr log外，同级目录下还看到了tombstones</p> 
<p><img alt="" height="150" src="https://images2.imgbox.com/d2/a7/SiNxMv08_o.png" width="688"></p> 
<p><img alt="" height="267" src="https://images2.imgbox.com/34/2e/DQKBHwuq_o.png" width="686"><br> 并且对比以往日志，发现都生产了大量tombstone...,于是决定一探究竟，或许问题和它有关呢 </p> 
<p><strong>tombstone概念</strong><br> tombstone一般是由Dalvik错误、状态监视调试器、C层代码以及libc的一些问题导致的。<br> 当系统发生tombstone的时候，kernel首先会上报一个严重的警告信号(signal),上层接收到之后，进程的调试工具会把进程中当时的调用栈现场保存起来，并在系统创建了data/tombstones目录后把异常时的进程信息写在此目录里面，开发者需要通过调用栈来分析整个调用流程来找出出问题的点。</p> 
<p><strong>分析tombstone原因</strong><br> 下面是我遇到的tombstone情况</p> 
<blockquote> 
 <p>pid与tid 相同，问题出在主线程</p> 
</blockquote> 
<p><img alt="" height="443" src="https://images2.imgbox.com/e0/3e/5rhJHNQp_o.png" width="911"></p> 
<blockquote> 
 <p>pid与tid 不同，问题出在子线程</p> 
</blockquote> 
<p><img alt="" height="434" src="https://images2.imgbox.com/9e/9c/iTdxtZHM_o.png" width="1167"></p> 
<p><strong> signal 信号量分析</strong></p> 
<p>信号机制是进程之间相互传递消息的一种方法，常见的型号种类如下：</p> 
<p><img alt="" height="252" src="https://images2.imgbox.com/c3/13/tb2uAJQQ_o.png" width="743"><br>  </p> 
<p><strong>问题总结</strong><br> 以上两种情况是我遇到的，pid 和tid相同的情况，根据日志分析和对比前后复现问题的tombstone，发现均为三方应用或内部应用在某种场景下诱发Native Crash <br> 可以根据进程号跟踪到相应位置，（真正找到问题根源可能麻烦些，大体是这个路子）；<br> pid 和tid不同的情况，分析起来有点无从下手，但是前前后后对比日志，发现这种情况进程均为系统服务进程pid: 467, tid: 806, name: HwBinder:467_3  &gt;&gt;&gt;/vendor/bin/hw/android.hardware.audio.service.mediatek &lt;&lt;&lt;<br> 只能根据signal 来找到比较完整的调用栈以及调用底层编码逻辑...</p> 
<p><img alt="" height="574" src="https://images2.imgbox.com/43/1a/DGi4wOJT_o.png" width="735">就简单写到这里了，欢迎大家交流补充，如有不对，敬请纠正!</p> 
<p></p> 
<p><strong>参考链接</strong><br> Android Tombstone crash定位分析<br> https://cloud.tencent.com/developer/article/1969660</p> 
<p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMTI4MTkwNQ==&amp;mid=2650845043&amp;idx=1&amp;sn=7d37bb7d0b2862b8ee6c9f69fafdd91a&amp;chksm=80b77bedb7c0f2fbe2962325dfb7db779448316460c0068e56cb1905377f91a96f30ce67072d&amp;scene=27" rel="nofollow" title="Android开发太难了，Native Crash的一切！">Android开发太难了，Native Crash的一切！</a></p> 
<p>android跨进程通信——signal <br> https://www.jianshu.com/p/73c33648ffc8<br> signal 6 (SIGABRT) log分析<br> https://blog.csdn.net/weixin_29172201/article/details/117613032</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d421cb496a944504fe3fcb65fa2f8550/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python学习之去除字符串中的空格（6种方法）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/789de822da80d97d13bb8f18713bf530/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux中的休眠函数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>