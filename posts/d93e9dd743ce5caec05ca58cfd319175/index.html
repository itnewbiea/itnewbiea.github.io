<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>航芯ACM32G103开发板评测 02-GPIO输入输出 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="航芯ACM32G103开发板评测 02-GPIO输入输出" />
<meta property="og:description" content="航芯ACM32G103开发板评测 02-GPIO输入输出 航芯ACM32G103开发板评测 GPIO输入输出应用
软硬件平台
ACM32G103 Board开发板
MDK-ARM Keil
GPIO输出典型应用——点灯
GPIO输入典型应用——按键
GPIO 功能概述 GPIO 是通用输入/输出（General Purpose I/O）的简称，主要用于工业现场需要用到数字量输入/输出的场合，例如：
输出功能：继电器、 LED、蜂鸣器等的控制输入功能：传感器状态、高低电平等信息的读取复用功能：片内外设的对外接口时序模拟：模拟 SPI、I2C 和 UART 等常用接口的时序 GPIO 功能特性 多种工作模式：每个 GPIO 引脚可以独立配置为输出（推挽或开漏）、输入、外设复用功能或模拟模式。每个 GPIO 引脚可以独立配置为上拉、下拉或浮空。灵活的复用模式：复用功能（AF）的备用引脚，极大提高了端口利用的灵活性。GPIO引脚通过配置相关的寄存器可以用作复用功能输入/输出引脚。
GPIO具体细节见航芯ACM32G103_用户手册V1.3 P393 查看acm32官方库函数文件，查看api函数
/* Exported functions --------------------------------------------------------*/ void GPIO_Init(GPIO_TypeDef *GPIOx, GPIO_InitTypeDef *GPIO_Init); void GPIO_DeInit(GPIO_TypeDef *GPIOx, uint32_t GPIO_Pin); void GPIO_StructInit(GPIO_InitTypeDef* GPIO_InitStruct); GPIO_PinState GPIO_ReadPin(GPIO_TypeDef *GPIOx, uint16_t GPIO_Pin); uint16_t GPIO_ReadInputData(GPIO_TypeDef* GPIOx); GPIO_PinState GPIO_ReadOutputDataBit(GPIO_TypeDef* GPIOx, uint16_t GPIO_Pin); uint16_t GPIO_ReadOutputData(GPIO_TypeDef* GPIOx); void GPIO_SetBits(GPIO_TypeDef* GPIOx, uint16_t GPIO_Pin); void GPIO_ResetBits(GPIO_TypeDef* GPIOx, uint16_t GPIO_Pin); void GPIO_WriteBit(GPIO_TypeDef *GPIOx, uint32_t GPIO_Pin, GPIO_PinState PinState); void GPIO_Write(GPIO_TypeDef *GPIOx, uint16_t PortVal); void GPIO_ToggleBits(GPIO_TypeDef *GPIOx, uint16_t GPIO_Pin); void GPIO_PinLockConfig(GPIO_TypeDef *GPIOx, uint32_t GPIO_Pin); GPIO输出 LED点灯 在航芯ACM32G103开发板中，一共有3个led，但是只有一个user_led可以去控制，其中，pow_led com_led作为提示作用。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/d93e9dd743ce5caec05ca58cfd319175/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-02T14:28:07+08:00" />
<meta property="article:modified_time" content="2024-01-02T14:28:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">航芯ACM32G103开发板评测 02-GPIO输入输出</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="ACM32G103_02GPIO_0"></a>航芯ACM32G103开发板评测 02-GPIO输入输出</h4> 
<p>航芯ACM32G103开发板评测 GPIO输入输出应用</p> 
<ol><li> <p>软硬件平台<br> ACM32G103 Board开发板<br> MDK-ARM Keil<br> <img src="https://images2.imgbox.com/b2/28/kPV9p0bc_o.png" alt="在这里插入图片描述"></p> </li><li> <p>GPIO输出典型应用——点灯</p> </li><li> <p>GPIO输入典型应用——按键</p> </li></ol> 
<h4><a id="GPIO__9"></a>GPIO 功能概述</h4> 
<p>GPIO 是通用输入/输出（General Purpose I/O）的简称，主要用于工业现场需要用到数字量输入/输出的场合，例如：</p> 
<ul><li><strong>输出功能</strong>：继电器、 LED、蜂鸣器等的控制</li><li><strong>输入功能</strong>：传感器状态、高低电平等信息的读取</li><li><strong>复用功能</strong>：片内外设的对外接口</li><li><strong>时序模拟</strong>：模拟 SPI、I2C 和 UART 等常用接口的时序</li></ul> 
<h4><a id="GPIO__18"></a>GPIO 功能特性</h4> 
<ul><li>多种工作模式：每个 GPIO 引脚可以独立配置为输出（推挽或开漏）、输入、外设复用功能或模拟模式。每个 GPIO 引脚可以独立配置为上拉、下拉或浮空。</li><li>灵活的复用模式：复用功能（AF）的备用引脚，极大提高了端口利用的灵活性。GPIO引脚通过配置相关的寄存器可以用作复用功能输入/输出引脚。<br> <img src="https://images2.imgbox.com/08/e3/kvADQym2_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/75/ff/0N8myK2E_o.jpg" alt="在这里插入图片描述"></li></ul> 
<h6><a id="GPIOACM32G103_V13_P393_24"></a>GPIO具体细节见航芯ACM32G103_用户手册V1.3 P393</h6> 
<p>查看acm32官方库函数文件，查看api函数</p> 
<pre><code class="prism language-c"><span class="token comment">/* Exported functions --------------------------------------------------------*/</span>
<span class="token keyword">void</span> <span class="token function">GPIO_Init</span><span class="token punctuation">(</span>GPIO_TypeDef <span class="token operator">*</span>GPIOx<span class="token punctuation">,</span> GPIO_InitTypeDef <span class="token operator">*</span>GPIO_Init<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">GPIO_DeInit</span><span class="token punctuation">(</span>GPIO_TypeDef <span class="token operator">*</span>GPIOx<span class="token punctuation">,</span> <span class="token class-name">uint32_t</span> GPIO_Pin<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">GPIO_StructInit</span><span class="token punctuation">(</span>GPIO_InitTypeDef<span class="token operator">*</span> GPIO_InitStruct<span class="token punctuation">)</span><span class="token punctuation">;</span>
GPIO_PinState <span class="token function">GPIO_ReadPin</span><span class="token punctuation">(</span>GPIO_TypeDef <span class="token operator">*</span>GPIOx<span class="token punctuation">,</span> <span class="token class-name">uint16_t</span> GPIO_Pin<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">uint16_t</span> <span class="token function">GPIO_ReadInputData</span><span class="token punctuation">(</span>GPIO_TypeDef<span class="token operator">*</span> GPIOx<span class="token punctuation">)</span><span class="token punctuation">;</span>
GPIO_PinState <span class="token function">GPIO_ReadOutputDataBit</span><span class="token punctuation">(</span>GPIO_TypeDef<span class="token operator">*</span> GPIOx<span class="token punctuation">,</span> <span class="token class-name">uint16_t</span> GPIO_Pin<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">uint16_t</span> <span class="token function">GPIO_ReadOutputData</span><span class="token punctuation">(</span>GPIO_TypeDef<span class="token operator">*</span> GPIOx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">GPIO_SetBits</span><span class="token punctuation">(</span>GPIO_TypeDef<span class="token operator">*</span> GPIOx<span class="token punctuation">,</span> <span class="token class-name">uint16_t</span> GPIO_Pin<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">GPIO_ResetBits</span><span class="token punctuation">(</span>GPIO_TypeDef<span class="token operator">*</span> GPIOx<span class="token punctuation">,</span> <span class="token class-name">uint16_t</span> GPIO_Pin<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">GPIO_WriteBit</span><span class="token punctuation">(</span>GPIO_TypeDef <span class="token operator">*</span>GPIOx<span class="token punctuation">,</span> <span class="token class-name">uint32_t</span> GPIO_Pin<span class="token punctuation">,</span> GPIO_PinState PinState<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">GPIO_Write</span><span class="token punctuation">(</span>GPIO_TypeDef <span class="token operator">*</span>GPIOx<span class="token punctuation">,</span> <span class="token class-name">uint16_t</span> PortVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">GPIO_ToggleBits</span><span class="token punctuation">(</span>GPIO_TypeDef <span class="token operator">*</span>GPIOx<span class="token punctuation">,</span> <span class="token class-name">uint16_t</span> GPIO_Pin<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">GPIO_PinLockConfig</span><span class="token punctuation">(</span>GPIO_TypeDef <span class="token operator">*</span>GPIOx<span class="token punctuation">,</span> <span class="token class-name">uint32_t</span> GPIO_Pin<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b6/4b/VuU8MC5l_o.jpg" alt="在这里插入图片描述"></p> 
<h4><a id="GPIO_LED_47"></a>GPIO输出 LED点灯</h4> 
<p>在航芯ACM32G103开发板中，一共有3个led，但是只有一个user_led可以去控制，其中，pow_led com_led作为提示作用。<br> 接下来就是gpio端口初始化的函数简单分析。</p> 
<p><img src="https://images2.imgbox.com/8d/d6/wGcaThdu_o.jpg" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BSP_LED_GPIO</span>            <span class="token expression">GPIOF</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BSP_LED_PIN</span>             <span class="token expression">GPIO_PIN_3</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BSP_LED_MODE</span>            <span class="token expression">GPIO_MODE_OUTPUT_PP</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BSP_LED_PULL</span>            <span class="token expression">GPIO_PULLUP</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BSP_LED_DRIVE</span>           <span class="token expression">GPIO_DRIVE_LEVEL3</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BSP_LED_ALTERNATE</span>       <span class="token expression">GPIO_FUNCTION_0</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">BSP_LED_CLK_ENABLE</span><span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token function">__RCC_GPIOF_CLK_ENABLE</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span>

<span class="token keyword">void</span> <span class="token function">BSP_LED_Init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    GPIO_InitTypeDef  GPIO_InitStruct<span class="token punctuation">;</span>

    <span class="token comment">/* Enable the GPIO_LED Clock */</span>
    <span class="token function">BSP_LED_CLK_ENABLE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    GPIO_InitStruct<span class="token punctuation">.</span>Pin       <span class="token operator">=</span> BSP_LED_PIN<span class="token punctuation">;</span>
    GPIO_InitStruct<span class="token punctuation">.</span>Mode      <span class="token operator">=</span> BSP_LED_MODE<span class="token punctuation">;</span>
    GPIO_InitStruct<span class="token punctuation">.</span>Pull      <span class="token operator">=</span> BSP_LED_PULL<span class="token punctuation">;</span>
    GPIO_InitStruct<span class="token punctuation">.</span>Drive     <span class="token operator">=</span> BSP_LED_DRIVE<span class="token punctuation">;</span>
    GPIO_InitStruct<span class="token punctuation">.</span>Alternate <span class="token operator">=</span> BSP_LED_ALTERNATE<span class="token punctuation">;</span>

    <span class="token function">GPIO_Init</span><span class="token punctuation">(</span>BSP_LED_GPIO<span class="token punctuation">,</span> <span class="token operator">&amp;</span>GPIO_InitStruct<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">GPIO_WriteBit</span><span class="token punctuation">(</span>BSP_LED_GPIO<span class="token punctuation">,</span> BSP_LED_PIN<span class="token punctuation">,</span> GPIO_PIN_SET<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>ACM32G103的gpio端口初始化，与stm32等其他mcu基本上没有太大的区别。唯一的区别是GPIO_InitStruct结构体里一些成员有不同。</p> 
<pre><code class="prism language-c"><span class="token comment">//stm32f103 hal</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token class-name">uint32_t</span> Pin<span class="token punctuation">;</span>       <span class="token comment">/*!&lt; Specifies the GPIO pins to be configured.
                           This parameter can be any value of @ref GPIO_pins_define */</span>
  <span class="token class-name">uint32_t</span> Mode<span class="token punctuation">;</span>      <span class="token comment">/*!&lt; Specifies the operating mode for the selected pins.
                           This parameter can be a value of @ref GPIO_mode_define */</span>
  <span class="token class-name">uint32_t</span> Pull<span class="token punctuation">;</span>      <span class="token comment">/*!&lt; Specifies the Pull-up or Pull-Down activation for the selected pins.
                          This parameter can be a value of @ref GPIO_pull_define */</span>
  <span class="token class-name">uint32_t</span> Speed<span class="token punctuation">;</span>     <span class="token comment">/*!&lt; Specifies the speed for the selected pins.
                           This parameter can be a value of @ref GPIO_speed_define */</span>
<span class="token punctuation">}</span> GPIO_InitTypeDef<span class="token punctuation">;</span>

<span class="token comment">//stm32f103 std</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token class-name">uint16_t</span> GPIO_Pin<span class="token punctuation">;</span>             <span class="token comment">/*!&lt; Specifies the GPIO pins to be configured.
                                      This parameter can be any value of @ref GPIO_pins_define */</span>
  GPIOSpeed_TypeDef GPIO_Speed<span class="token punctuation">;</span>  <span class="token comment">/*!&lt; Specifies the speed for the selected pins.
                                      This parameter can be a value of @ref GPIOSpeed_TypeDef */</span>
  GPIOMode_TypeDef GPIO_Mode<span class="token punctuation">;</span>    <span class="token comment">/*!&lt; Specifies the operating mode for the selected pins.
                                      This parameter can be a value of @ref GPIOMode_TypeDef */</span>
<span class="token punctuation">}</span>GPIO_InitTypeDef<span class="token punctuation">;</span>

<span class="token comment">//acm32g103 spl</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">uint32_t</span>    Pin<span class="token punctuation">;</span>               <span class="token comment">/*!&lt; Specifies the GPIO pins to be configured.
                                        This parameter can be any value of @ref GPIO_pins */</span>
    <span class="token class-name">uint32_t</span>    Mode<span class="token punctuation">;</span>              <span class="token comment">/*!&lt; Specifies the operating mode for the selected pins.
                                         This parameter can be a value of @ref GPIO_mode */</span>
    <span class="token class-name">uint32_t</span>    Pull<span class="token punctuation">;</span>              <span class="token comment">/*!&lt; Specifies the Pull-up or Pull-Down activation for the selected pins.
                                         This parameter can be a value of @ref GPIO_pull */</span>
    <span class="token class-name">uint32_t</span>    Drive<span class="token punctuation">;</span>             <span class="token comment">/*!&lt; Specifies the Output drive capability for the selected pins.
                                         This parameter can be a value of @ref GPIO_drive */</span>
    <span class="token class-name">uint32_t</span>    Alternate<span class="token punctuation">;</span>         <span class="token comment">/*!&lt; Peripheral to be connected to the selected pins
                                         This parameter can be a value of @ref GPIOEx_function_selection */</span>
<span class="token punctuation">}</span> GPIO_InitTypeDef<span class="token punctuation">;</span>

</code></pre> 
<p>其中主要的区别是acm32中有一个<strong>指定选定引脚的输出驱动能力Drive</strong>成员，GPIOx 的 PIN驱动能力5V 耐压 IO 的驱动能力配置：</p> 
<pre><code class="prism language-c"><span class="token comment">/** @defgroup GPIO_drive
  * @brief GPIO Output drive capability
  * @{
  */</span>
<span class="token comment">/*!&lt; Output drive capability up to 2mA, please refer to the product datasheet */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">GPIO_DRIVE_LEVEL0</span>                      <span class="token expression"><span class="token punctuation">(</span><span class="token number">0x00000000U</span><span class="token punctuation">)</span>   </span></span>
<span class="token comment">/*!&lt; Output drive capability up to 4mA, please refer to the product datasheet */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">GPIO_DRIVE_LEVEL1</span>                      <span class="token expression"><span class="token punctuation">(</span><span class="token number">0x00000001U</span><span class="token punctuation">)</span>   </span></span>
 <span class="token comment">/*!&lt; Output drive capability up to 6mA, please refer to the product datasheet */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">GPIO_DRIVE_LEVEL2</span>                      <span class="token expression"><span class="token punctuation">(</span><span class="token number">0x00000002U</span><span class="token punctuation">)</span>  </span></span>
<span class="token comment">/*!&lt; Output drive capability up to 8mA, please refer to the product datasheet */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">GPIO_DRIVE_LEVEL3</span>                      <span class="token expression"><span class="token punctuation">(</span><span class="token number">0x00000003U</span><span class="token punctuation">)</span>   </span></span>
<span class="token comment">/*!&lt; Output drive capability up to 10mA,please refer to the product datasheet */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">GPIO_DRIVE_LEVEL4</span>                      <span class="token expression"><span class="token punctuation">(</span><span class="token number">0x00000004U</span><span class="token punctuation">)</span>   </span></span>
<span class="token comment">/*!&lt; Output drive capability up to 12mA,please refer to the product datasheet */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">GPIO_DRIVE_LEVEL5</span>                      <span class="token expression"><span class="token punctuation">(</span><span class="token number">0x00000005U</span><span class="token punctuation">)</span>   </span></span>
<span class="token comment">/*!&lt; Output drive capability up to 14mA,please refer to the product datasheet */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">GPIO_DRIVE_LEVEL6</span>                      <span class="token expression"><span class="token punctuation">(</span><span class="token number">0x00000006U</span><span class="token punctuation">)</span>  </span></span>
 <span class="token comment">/*!&lt; Output drive capability up to 16mA,please refer to the product datasheet */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">GPIO_DRIVE_LEVEL7</span>                      <span class="token expression"><span class="token punctuation">(</span><span class="token number">0x00000007U</span><span class="token punctuation">)</span>  </span></span>
</code></pre> 
<p>GPIO控制函数</p> 
<pre><code class="prism language-c"><span class="token comment">//设置或清除选定的数据端口位。</span>
<span class="token keyword">void</span> <span class="token function">GPIO_WriteBit</span><span class="token punctuation">(</span>GPIO_TypeDef <span class="token operator">*</span>GPIOx<span class="token punctuation">,</span> <span class="token class-name">uint32_t</span> GPIO_Pin<span class="token punctuation">,</span> GPIO_PinState PinState<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">/* Check the parameters */</span>
    <span class="token function">assert_param</span><span class="token punctuation">(</span><span class="token function">IS_GPIO_ALL_PERIPH</span><span class="token punctuation">(</span>GPIOx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assert_param</span><span class="token punctuation">(</span><span class="token function">IS_GPIO_ALL_PIN</span><span class="token punctuation">(</span>GPIOx<span class="token punctuation">,</span> GPIO_Pin<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assert_param</span><span class="token punctuation">(</span><span class="token function">IS_GPIO_PIN_STATE</span><span class="token punctuation">(</span>PinState<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>GPIO_PIN_RESET <span class="token operator">==</span> PinState<span class="token punctuation">)</span>
        GPIOx<span class="token operator">-&gt;</span>BSC <span class="token operator">=</span> GPIO_Pin <span class="token operator">&lt;&lt;</span> <span class="token number">16U</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        GPIOx<span class="token operator">-&gt;</span>BSC <span class="token operator">=</span> GPIO_Pin<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-c"><span class="token comment">/******************************************************************************
*@brief : LED on
*@param : none
*@return: none
******************************************************************************/</span>
<span class="token keyword">void</span> <span class="token function">BSP_LED_On</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">GPIO_WriteBit</span><span class="token punctuation">(</span>BSP_LED_GPIO<span class="token punctuation">,</span> BSP_LED_PIN<span class="token punctuation">,</span> GPIO_PIN_RESET<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/******************************************************************************
*@brief : LED off
*@param : none
*@return: none
******************************************************************************/</span>
<span class="token keyword">void</span> <span class="token function">BSP_LED_Off</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">GPIO_WriteBit</span><span class="token punctuation">(</span>BSP_LED_GPIO<span class="token punctuation">,</span> BSP_LED_PIN<span class="token punctuation">,</span> GPIO_PIN_SET<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/******************************************************************************
*@brief : LED toggle
*@param : none
*@return: none
******************************************************************************/</span>
<span class="token keyword">void</span> <span class="token function">BSP_LED_Toggle</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">GPIO_ToggleBits</span><span class="token punctuation">(</span>BSP_LED_GPIO<span class="token punctuation">,</span> BSP_LED_PIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>led_example测试函数</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">bsp_led_example</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">printfS</span><span class="token punctuation">(</span><span class="token string">"bsp_led_example led_flashing \r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">BSP_LED_On</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printfS</span><span class="token punctuation">(</span><span class="token string">"bsp_led_example led_on \r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">DelayMs</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">BSP_LED_Off</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printfS</span><span class="token punctuation">(</span><span class="token string">"bsp_led_example led_off \r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">DelayMs</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d0/6c/e0WF5QXu_o.jpg" alt="在这里插入图片描述"></p> 
<h4><a id="GPIO__220"></a>GPIO输入 按键控制</h4> 
<p>在航芯ACM32G103开发板中，一共有2个按键，但是只有一个user_key可以去控制，其中一个是rst复位按键。</p> 
<p>按键机械触点断开、闭合时，由于触点的弹性作用，按键开关不会马上稳定接通或一下子断开， 使用按键时会产生图 按键抖动说明图中的带波纹信号，需要用软件消抖处理滤波，不方便输入检测。</p> 
<p><img src="https://images2.imgbox.com/75/1d/SXpfYEFe_o.jpg" alt="在这里插入图片描述"></p> 
<p>本实验板连接的按键带硬件消抖功能， 见图 按键原理图 ，它利用电容充放电的延时，消除了波纹，从而简化软件的处理，软件只需要直接检测引脚的电平即可。</p> 
<p>接下来就是按键key端口初始化的函数简单分析。</p> 
<p>BSP_PB_Init初始化配置过程中，基本上就是GPIO端口初始化，和中断配置初始化。</p> 
<p><img src="https://images2.imgbox.com/bb/b6/MZWWA8Tu_o.jpg" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token comment">/******************************************************************************
*@brief : PB init
*@param : none
*@return: none
******************************************************************************/</span>
<span class="token keyword">void</span> <span class="token function">BSP_PB_Init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    GPIO_InitTypeDef GPIO_InitStruct<span class="token punctuation">;</span>
    EXTI_InitTypeDef EXTI_InitStruct<span class="token punctuation">;</span>

    <span class="token function">BSP_PB_CLK_ENABLE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    GPIO_InitStruct<span class="token punctuation">.</span>Pin       <span class="token operator">=</span> BSP_PB_PIN<span class="token punctuation">;</span>
    GPIO_InitStruct<span class="token punctuation">.</span>Mode      <span class="token operator">=</span> BSP_PB_MODE<span class="token punctuation">;</span>
    GPIO_InitStruct<span class="token punctuation">.</span>Pull      <span class="token operator">=</span> BSP_PB_PULL<span class="token punctuation">;</span>
    GPIO_InitStruct<span class="token punctuation">.</span>Drive     <span class="token operator">=</span> BSP_PB_DRIVE<span class="token punctuation">;</span>
    GPIO_InitStruct<span class="token punctuation">.</span>Alternate <span class="token operator">=</span> BSP_PB_ALTERNATE<span class="token punctuation">;</span>

    <span class="token function">GPIO_Init</span><span class="token punctuation">(</span>BSP_PB_GPIO<span class="token punctuation">,</span> <span class="token operator">&amp;</span>GPIO_InitStruct<span class="token punctuation">)</span><span class="token punctuation">;</span>

    EXTI_InitStruct<span class="token punctuation">.</span>GPIOx     <span class="token operator">=</span> BSP_PB_GPIO<span class="token punctuation">;</span>
    EXTI_InitStruct<span class="token punctuation">.</span>Line      <span class="token operator">=</span> BSP_PB_PIN<span class="token punctuation">;</span>
    EXTI_InitStruct<span class="token punctuation">.</span>Mode      <span class="token operator">=</span> EXTI_MODE_IT<span class="token punctuation">;</span>
    EXTI_InitStruct<span class="token punctuation">.</span>Trigger   <span class="token operator">=</span> EXTI_TRIGGER_FALLING<span class="token punctuation">;</span>
    EXTI_InitStruct<span class="token punctuation">.</span>Cmd       <span class="token operator">=</span> ENABLE<span class="token punctuation">;</span>
    
    <span class="token function">EXTI_Init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>EXTI_InitStruct<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
	<span class="token function">EXTI_ClearITPendingBit</span><span class="token punctuation">(</span>BSP_PB_PIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">NVIC_ClearPendingIRQ</span><span class="token punctuation">(</span>BSP_PB_IRQ<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">NVIC_SetPriority</span><span class="token punctuation">(</span>BSP_PB_IRQ<span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">NVIC_EnableIRQ</span><span class="token punctuation">(</span>BSP_PB_IRQ<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/******************************************************************************
*@brief : get PB state
*@param : none
*@return: none
******************************************************************************/</span>
<span class="token class-name">uint32_t</span> <span class="token function">BSP_PB_GetState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">GPIO_ReadPin</span><span class="token punctuation">(</span>BSP_PB_GPIO<span class="token punctuation">,</span> BSP_PB_PIN<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">APP_Test</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">uint32_t</span> state<span class="token punctuation">;</span>
    
	<span class="token function">printfS</span><span class="token punctuation">(</span><span class="token string">"SPL GPIO Demo\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printfS</span><span class="token punctuation">(</span><span class="token string">"LED flashing frequency: 1Hz.\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printfS</span><span class="token punctuation">(</span><span class="token string">"The user presses the key to stop flashing, press the key again, and flash again.\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    g_press <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    
    state <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>g_press <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">DelayMs</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            g_press <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                state <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                state <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">BSP_LED_Toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">printfS</span><span class="token punctuation">(</span><span class="token string">"BSP_LED_Toggle \r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">BSP_LED_Off</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
		<span class="token function">DelayMs</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">EXTI15_10_IRQHandler</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>EXTI<span class="token operator">-&gt;</span>PDR <span class="token operator">&amp;</span> BSP_PB_PIN<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        EXTI<span class="token operator">-&gt;</span>PDR <span class="token operator">=</span> BSP_PB_PIN<span class="token punctuation">;</span>
        <span class="token function">PB_IRQHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>上面的方法是利用按键中断去判断的，下面使用MultiButton开源框架，进行按键检测。</p> 
<h5><a id="MultiButton_336"></a>MultiButton按键检测</h5> 
<p>MultiButton开源框架仓库 https://github.com/0x1abin/MultiButton</p> 
<p>参考博客https://blog.csdn.net/qq_36075612/article/details/115901032</p> 
<p>MultiButton | 一个小巧简单易用的事件驱动型按键驱动模块 https://zhuanlan.zhihu.com/p/128961191</p> 
<p>本次使用的是博客中的版本，仓库版本的代码可能与下面代码不一样，应该是更新了代码和api。</p> 
<h4><a id="_346"></a>使用方法</h4> 
<p>1.先申请一个按键结构。</p> 
<p>2.初始化按键对象，绑定按键的GPIO电平读取接口<strong>read_button_pin()</strong> ，后一个参数设置有效触发电平。</p> 
<p>3.注册按键事件。</p> 
<p>4.启动按键。</p> 
<p>5.设置一个5ms间隔的定时器循环调用后台处理函数。</p> 
<pre><code class="prism language-c"><span class="token comment">//按键状态读取接口</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> btn0_id <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Button</span> button0<span class="token punctuation">;</span>

<span class="token class-name">uint8_t</span>  <span class="token function">read_button0_GPIO</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">GPIO_ReadPin</span><span class="token punctuation">(</span>BSP_PB_GPIO<span class="token punctuation">,</span> BSP_PB_PIN<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">button_callback</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>button<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">uint32_t</span> btn_event_val<span class="token punctuation">;</span> 
    
    btn_event_val <span class="token operator">=</span> <span class="token function">get_button_event</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Button</span> <span class="token operator">*</span><span class="token punctuation">)</span>button<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    
    <span class="token keyword">switch</span><span class="token punctuation">(</span>btn_event_val<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">case</span> PRESS_DOWN<span class="token operator">:</span>
          <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"---&gt; key1 press down! &lt;---\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token keyword">break</span><span class="token punctuation">;</span> 
 
      <span class="token keyword">case</span> PRESS_UP<span class="token operator">:</span> 
          <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"***&gt; key1 press up! &lt;***\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span> 
 
      <span class="token keyword">case</span> PRESS_REPEAT<span class="token operator">:</span> 
          <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"---&gt; key1 press repeat! &lt;---\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span> 
 
      <span class="token keyword">case</span> SINGLE_CLICK<span class="token operator">:</span> 
          <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"---&gt; key1 single click! &lt;---\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span> 
 
      <span class="token keyword">case</span> DOUBLE_CLICK<span class="token operator">:</span> 
          <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"***&gt; key1 double click! &lt;***\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span> 
 
      <span class="token keyword">case</span> LONG_PRESS_START<span class="token operator">:</span> 
          <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"---&gt; key1 long press start! &lt;---\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span> 
 
      <span class="token keyword">case</span> LONG_PRESS_HOLD<span class="token operator">:</span> 
          <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"***&gt; key1 long press hold! &lt;***\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="_407"></a>特性</h5> 
<p>MultiButton 使用C语言实现，基于面向对象方式设计思路，每个按键对象单独用一份数据结构管理：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">struct</span> <span class="token class-name">Button</span> <span class="token punctuation">{<!-- --></span>

	<span class="token keyword">uint16_t</span> ticks<span class="token punctuation">;</span>
	<span class="token keyword">uint8_t</span>  repeat<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">;</span>
	<span class="token keyword">uint8_t</span>  event <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">;</span>
	<span class="token keyword">uint8_t</span>  state <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">;</span>
	<span class="token keyword">uint8_t</span>  debounce_cnt <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">;</span>
	<span class="token keyword">uint8_t</span>  active_level <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">uint8_t</span>  button_level <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">uint8_t</span>  <span class="token punctuation">(</span><span class="token operator">*</span>hal_button_Level<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	BtnCallback  cb<span class="token punctuation">[</span>number_of_event<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">struct</span> <span class="token class-name">Button</span><span class="token operator">*</span> next<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>这样每个按键使用单向链表相连，依次进入 button_handler(struct Button* handle) 状态机处理，所以每个按键的状态彼此独立。</p> 
<h5><a id="_429"></a>按键事件</h5> 
<table><thead><tr><th align="left">事件</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">PRESS_DOWN</td><td align="left">按键按下，每次按下都触发</td></tr><tr><td align="left">PRESS_UP</td><td align="left">按键弹起，每次松开都触发</td></tr><tr><td align="left">PRESS_REPEAT</td><td align="left">重复按下触发，变量repeat计数连击次数</td></tr><tr><td align="left">SINGLE_CLICK</td><td align="left">单击按键事件</td></tr><tr><td align="left">DOUBLE_CLICK</td><td align="left">双击按键事件</td></tr><tr><td align="left">LONG_PRESS_START</td><td align="left">达到长按时间阈值时触发一次</td></tr><tr><td align="left">LONG_PRESS_HOLD</td><td align="left">长按期间一直触发</td></tr></tbody></table> 
<pre><code class="prism language-c"><span class="token comment">/******************************************************************************
*@brief : main program
*@param : none
*@return: none
******************************************************************************/</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
   
    <span class="token function">board_hardware_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printfS</span><span class="token punctuation">(</span><span class="token string">"board_hardware_init [ok] \r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//Timer_Update_Test();</span>
    
    
   <span class="token comment">//初始化按键对象</span>
    <span class="token function">button_init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>button0<span class="token punctuation">,</span> read_button0_GPIO<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">button_attach</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>button0<span class="token punctuation">,</span> PRESS_DOWN<span class="token punctuation">,</span>       button_callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">button_attach</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>button0<span class="token punctuation">,</span> PRESS_UP<span class="token punctuation">,</span>         button_callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">button_attach</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>button0<span class="token punctuation">,</span> PRESS_REPEAT<span class="token punctuation">,</span>     button_callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">button_attach</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>button0<span class="token punctuation">,</span> SINGLE_CLICK<span class="token punctuation">,</span>     button_callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">button_attach</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>button0<span class="token punctuation">,</span> DOUBLE_CLICK<span class="token punctuation">,</span>     button_callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">button_attach</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>button0<span class="token punctuation">,</span> LONG_PRESS_START<span class="token punctuation">,</span> button_callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">button_attach</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>button0<span class="token punctuation">,</span> LONG_PRESS_HOLD<span class="token punctuation">,</span>  button_callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//启动按键</span>
   <span class="token function">button_start</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>button0<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//bsp_led_example();</span>
        <span class="token function">button_ticks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">DelayMs</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0b/e9/SbRyTprs_o.jpg" alt="在这里插入图片描述"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7844fc180f8e1f2e12cf4e75379b6222/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">航芯ACM32G103开发板评测 01-开箱及环境搭建流程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7b31d1776c7c87c5b6ccdf15cfbd70a2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">航芯ACM32G103开发板评测 03 RT-Thread Nano移植 线程管理测试</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>