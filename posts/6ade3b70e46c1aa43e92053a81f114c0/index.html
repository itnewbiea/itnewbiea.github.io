<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>一些SQLite不支持的SQL语法，解决办法 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="一些SQLite不支持的SQL语法，解决办法" />
<meta property="og:description" content="1 TOP
这是一个大家经常问到的问题，例如在SQLSERVER中可以使用如下语句来取得记录集中的前十条记录：
SELECT TOP 10 * FROM [index] ORDER BY indexid DESC;
但是这条SQL语句在SQLite中是无法执行的，应该改为：
SELECT * FROM [index] ORDER BY indexid DESC limit 0,10;
其中limit 0,10表示从第0条记录开始，往后一共读取10条
2 创建视图（Create View）
SQLite在创建多表视图的时候有一个BUG，问题如下：
CREATE VIEW watch_single AS SELECT DISTINCTwatch_item.[watchid],watch_item.[itemid] FROM watch_item;
上面这条SQL语句执行后会显示成功，但是实际上除了
SELECT COUNT(*) FROM [watch_single ] WHERE watch_ single.watchid = 1;
能执行之外是无法执行其他任何语句的。其原因在于建立视图的时候指定了字段所在的表名，而SQLite并不能正确地识别它。所以上面的创建语句要改为：
CREATE VIEW watch_single AS SELECT DISTINCT [watchid],[itemid] FROM watch_item;
但是随之而来的问题是如果是多表的视图，且表间有重名字段的时候该怎么办？
3 COUNT（DISTINCT column）
SQLite在执行如下语句的时候会报错：
SELECT COUNT(DISTINCT watchid) FROM [watch_item] WHERE watch_item." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/6ade3b70e46c1aa43e92053a81f114c0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2009-04-16T10:45:00+08:00" />
<meta property="article:modified_time" content="2009-04-16T10:45:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">一些SQLite不支持的SQL语法，解决办法</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <p>1 TOP<br>这是一个大家经常问到的问题，例如在SQLSERVER中可以使用如下语句来取得记录集中的前十条记录：<br>SELECT TOP 10 * FROM [index] ORDER BY indexid DESC;<br>但是这条SQL语句在SQLite中是无法执行的，应该改为：<br>SELECT * FROM [index] ORDER BY indexid DESC limit 0,10;<br>其中limit 0,10表示从第0条记录开始，往后一共读取10条</p> 
 <p>2 创建视图（Create View）<br>SQLite在创建多表视图的时候有一个BUG，问题如下：<br>CREATE VIEW watch_single AS SELECT DISTINCTwatch_item.[watchid],watch_item.[itemid] FROM watch_item;<br>上面这条SQL语句执行后会显示成功，但是实际上除了<br>SELECT COUNT(*) FROM [watch_single ] WHERE watch_ single.watchid = 1;<br>能执行之外是无法执行其他任何语句的。其原因在于建立视图的时候指定了字段所在的表名，而SQLite并不能正确地识别它。所以上面的创建语句要改为：<br>CREATE VIEW watch_single AS SELECT DISTINCT [watchid],[itemid] FROM watch_item;<br>但是随之而来的问题是如果是多表的视图，且表间有重名字段的时候该怎么办？</p> 
 <p>3 COUNT（DISTINCT column）<br>SQLite在执行如下语句的时候会报错：<br>SELECT COUNT(DISTINCT watchid) FROM [watch_item] WHERE watch_item.watchid = 1;<br>其原因是SQLite的所有内置函数都不支持DISTINCT限定，所以如果要统计不重复的记录数的时候会出现一些麻烦。比较可行的做法是先建立一个不重复的记录表的视图，然后再对该视图进行计数。</p> 
 <p>4 外连接<br>虽然SQLite官方已经声称LEFT OUTER JOIN 已经实现，但还没有 RIGHT OUTER JOIN 和 FULL OUTER JOIN。但是实际测试表明似乎并不能够正常的工作。以下三条语句在执行的时候均会报错：<br>SELECT tags.[tagid] FROM [tags],[tag_rss] WHERE tags.[tagid] = tag_rss.[tagid](*);<br>SELECT tags.[tagid] FROM [tags],[tag_rss] WHERE LEFT OUTER JOIN tag_rss.[tagid] = tags.[tagid];<br>SELECT tags.[tagid] FROM [tags],[tag_rss] WHERE LEFT JOIN tag_rss.[tagid] = tags.[tagid];<br>此外经过测试用+号代替*号也是不可行的。</p> 
 <p> </p> 
 <p>收集SQLite与Sql Server的语法差异</p> 
 <p><br>1.返回最后插入的标识值 <br>返回最后插入的标识值sql server用@@IDENTITY <br>sqlite用标量函数LAST_INSERT_ROWID() <br>返回通过当前的 SQLConnection 插入到数据库的最后一行的行标识符（生成的主键）。此值与 SQLConnection.lastInsertRowID 属性返回的值相同。 </p> 
 <p>2.top n <br>在sql server中返回前2行可以这样： <br>select top 2 * from aa <br>order by ids desc </p> 
 <p>sqlite中用LIMIT，语句如下： <br>select * from aa <br>order by ids desc <br>LIMIT 2 </p> 
 <p>3.GETDATE ( ) <br>在sql server中GETDATE ( )返回当前系统日期和时间 <br>sqlite中没有 </p> 
 <p>4.EXISTS语句 <br>sql server中判断插入（不存在ids=5的就插入） <br>IF NOT EXISTS (select * from aa where ids=5) <br>BEGIN <br>insert into aa(nickname) <br>select 't' <br>END <br>在sqlite中可以这样 <br>insert into aa(nickname) <br>select 't' <br>where not exists(select * from aa where ids=5) </p> 
 <p>5.嵌套事务 <br>sqlite仅允许单个活动的事务 </p> 
 <p>6.RIGHT 和 FULL OUTER JOIN <br>sqlite不支持 RIGHT OUTER JOIN 或 FULL OUTER JOIN </p> 
 <p>7.可更新的视图<br>sqlite视图是只读的。不能对视图执行 DELETE、INSERT 或 UPDATE 语句，sql server是可以对视图 DELETE、INSERT 或 UPDATE</p> 
</div> 
<p>转载于:https://www.cnblogs.com/Benjaguar/archive/2009/04/16/1437025.html</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/467f133debf31fec9efb230cedfd4460/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java生成UUID通用唯一识别码 (Universally Unique Identifier)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6153d1b69404ae60fa04b59510cad04c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C# WinForm中将Form显示在Panel中(C#)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>