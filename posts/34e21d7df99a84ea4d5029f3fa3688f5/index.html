<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>从零开始手把手教利用electorn&#43;vue搭建一套客户端开发环境 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="从零开始手把手教利用electorn&#43;vue搭建一套客户端开发环境" />
<meta property="og:description" content="利用 electron 开发桌面应用时，首先会遇到这么一个问题：网上很多的electron&#43;vue开发框架太繁琐复杂，同时技术栈都比较老旧，有时候升级某个包报一堆的错误，这些错误又涉及到桌面软件开发的知识，这对于前端开发者来说无疑是噩梦。
因此，搭建一套属于自己的 electron&#43;vue 开发框架显得格外重要，好处是我可以随意扩展和配置。
本文将从零开始利用 elelctron 和 webpack&#43;vue3 教你如何搭建一套桌面开发环境。
开发环境组成 我们知道，利用 electron 开发客户端，页面全部都是用 html&#43;css&#43;js 编写，这为前端开发者开发客户端提供了可能。同时，随着 web 技术的飞速发展，在开发效率和页面效果展示方面是其他技术所不能比拟的，这也是为什么 electron 越来越火的原因。
对于今天的前端开发来说，一般使用 vue/react 框架来开发 web 页面，因此，整个开发环境架构如下图所示：
它包括两个部分：electron 和 web页面 electron：左边的 electron 可以理解为一个浏览器，本质上它是由 chromium 和 nodejs构成。choromium 提供了 UI 界面的展示， nodejs 提供操作本地电脑的能力。
web页面： 右边是用 @vue/cli 脚手架搭建的 vue 开发环境，用来创建客户端页面。
中间通过 electron 提供的接口 window.loadURL 去加载 web 页面，这样 electron 就能显示页面。
下面，我们将分别搭建这两部分。
创建web 页面 1. 安装`vue`官方脚手架
npm install -g @vue/cli
2. 利用脚手架创建项目
vue create electron-vue-demo" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/34e21d7df99a84ea4d5029f3fa3688f5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-17T15:02:05+08:00" />
<meta property="article:modified_time" content="2023-04-17T15:02:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">从零开始手把手教利用electorn&#43;vue搭建一套客户端开发环境</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/4c/c3/GMgfcyTi_o.png"></p> 
<p></p> 
<p>        利用 electron 开发桌面应用时，首先会遇到这么一个问题：<strong>网上很多的electron+vue开发框架太繁琐复杂，同时技术栈都比较老旧，有时候升级某个包报一堆的错误，这些错误又涉及到桌面软件开发的知识，这对于前端开发者来说无疑是噩梦</strong>。</p> 
<p>        因此，搭建一套属于自己的 electron+vue 开发框架显得格外重要，好处是我可以随意扩展和配置。</p> 
<p>        本文将从零开始利用 elelctron 和 webpack+vue3 教你如何搭建一套桌面开发环境。</p> 
<p></p> 
<h3><strong><span style="color:#fe2c24;">      开发环境组成</span></strong></h3> 
<p>        我们知道，利用 electron 开发客户端，页面全部都是用 html+css+js 编写，这为前端开发者开发客户端提供了可能。同时，随着 web 技术的飞速发展，在开发效率和页面效果展示方面是其他技术所不能比拟的，这也是为什么 electron 越来越火的原因。</p> 
<p>        对于今天的前端开发来说，一般使用 vue/react 框架来开发 web 页面，因此，整个开发环境架构如下图所示：</p> 
<p style="text-align:center;">        <img alt="" src="https://images2.imgbox.com/2b/7f/VvPiuVRv_o.jpg"></p> 
<p></p> 
<p>        它包括两个部分：<strong>electron 和 web页面</strong> </p> 
<p>        <span style="color:#fe2c24;"><strong>electron</strong></span>：左边的 electron 可以理解为一个浏览器，本质上它是由 chromium 和 nodejs构成。choromium 提供了 UI 界面的展示， nodejs 提供操作本地电脑的能力。</p> 
<p>        <strong><span style="color:#fe2c24;">web页面</span></strong>： 右边是用 @vue/cli 脚手架搭建的 vue 开发环境，用来创建客户端页面。</p> 
<p>        中间通过 electron 提供的接口 window.loadURL 去加载 web 页面，这样 electron 就能显示页面。</p> 
<p>        下面，我们将分别搭建这两部分。</p> 
<p></p> 
<h3>   <strong> <span style="color:#fe2c24;">创建web 页面</span></strong></h3> 
<p><strong>        1.  安装`vue`官方脚手架</strong></p> 
<blockquote> 
 <p>npm install -g @vue/cli</p> 
</blockquote> 
<p>        <strong>2.  利用脚手架创建项目</strong></p> 
<blockquote> 
 <p>vue create electron-vue-demo</p> 
</blockquote> 
<p>        你会被提示选取一个 preset。你可以选默认的包含了基本的 Babel + ESLint 设置的 preset，也可以选 <strong>手动选择特性</strong> 来选取需要的特性。这里我们选择默认的就可以了。</p> 
<p>        <strong>3. 执行 npm run serve 启动界面</strong></p> 
<p>        这样，我们就创建好了 web 页面的结构，这非常简单，跟我们开发 web 项目是一样一样的。下面将在该工程下安装`electron`，及做相关的配置。</p> 
<p></p> 
<h3>      <span style="color:#fe2c24;"><strong>创建 electron </strong></span></h3> 
<p>        <strong>1.  electron 镜像设置</strong></p> 
<p>        因为electron放在国外的服务器上，国内环境访问很慢而导致下载失败，因此需要配置镜像。找到 npm 的配置文件 .npmrc ，加入如下代码到配置文件中：</p> 
<blockquote> 
 <p>electron_mirror=https://npmmirror.com/mirrors/electron/</p> 
</blockquote> 
<p>        如果你不想设置.npmrc，可以在安装的时候直接指定镜像源，如下：</p> 
<blockquote> 
 <p>ELECTRON_MIRROR=https://npmmirror.com/mirrors/electron/ npm install electron --save-dev</p> 
</blockquote> 
<p>        <strong>2. 安装 electron</strong></p> 
<blockquote> 
 <p>npm install electron --save-dev</p> 
</blockquote> 
<p>       <strong> 3. 新建主进程文件main.js</strong><br>  </p> 
<pre><code>const { app, BrowserWindow } = require('electron')

app.whenReady().then(() =&gt; {
    // 创建一个窗口来展示web页面
    createWindow()
    
    app.on('activate', () =&gt; {
        if (BrowserWindow.getAllWindows().length === 0) createWindow()
    })
})

app.on('window-all-closed', () =&gt; {
  if (process.platform !== 'darwin') app.quit()
})

// 相关代码electron官网有详细的介绍
const createWindow = () =&gt; {
  const config = {
    webPreferences: {
      nodeIntegration: true,
      contextIsolation: false,
    }
  }
  mainWindow = new BrowserWindow({
    width: 1000,
    height: 600,
    ...config
  })
  mainWindow.loadURL('http://localhost:8080/')
} </code></pre> 
<p>       <strong> 4.  配置package.json</strong></p> 
<p>        首先修改 main 字段，其路径为我们上面创建的 main.js 文件路径</p> 
<blockquote> 
 <p>{<!-- --><br>   "main": "main.js"<br> }</p> 
</blockquote> 
<p>        然后在 scripts 中新增加一个命令：</p> 
<blockquote> 
 <p>"scripts": {<!-- --><br>   "ele": "electron ."<br> }</p> 
</blockquote> 
<p>        <strong>5.  启动命令npm run ele</strong></p> 
<p>        这样我们的 web 页面就展示在 electron 提供了客户端了。</p> 
<p>        【注意】：你需要新开一个命令行启动 electron。第一个命令行用于启动 web页面，第二个命令行用于启动 electron 。</p> 
<p></p> 
<h3><span style="color:#fe2c24;"><strong>       完善开发环境</strong></span></h3> 
<p>        上面提到需要开启两个命令行才能启动我们的客户端，并且你要先启动 web 页面，然后才能启动 electron，这样就非常繁琐，开发起来非常不爽。下面我们将解决这个问题。</p> 
<p>        我们知道 npm 提供了一个 &amp;&amp; 符号，它用来连接两条命令，因此我们可以这么改造：</p> 
<pre><code>改造前：

```js
"scripts": {
  "serve": "vue-cli-service serve",
  "ele": "electron ."
}
```

改造后：
```js
"scripts": {
  "serve": "vue-cli-service serve",
  "ele": "electron .",
  "dev": "npm run serve &amp;&amp; npm run ele"
}
```</code></pre> 
<p>        当你执行 npm run dev 时，会首先打开一个白屏，等待一会后刷新才会出现内容。这是为什么呢？</p> 
<p>        因为，这两个命令的执行是同时启动的，而 npm run serve 的启动需要一定的时间，当 npm run ele 打开客户端时，页面根本就没有生成，所以是白屏。</p> 
<p>        还有一个问题是，&amp;&amp; 这个符号不是跨平台的，在 window 系统是不好使的。</p> 
<p><span style="color:#fe2c24;"><strong>        问题一: 如何跨平台的同时运行两个命令？</strong></span></p> 
<p>        这个问题我们可以利用一个 npm 包来解决： concurrently 。首先安装`concurrently`，关于它的使用请查看`npm`网站。</p> 
<blockquote> 
 <p>npm i concurrently --save-dev</p> 
</blockquote> 
<p>        因此，现在 scripts 就变为:</p> 
<pre><code>"scripts": {
  "serve": "vue-cli-service serve",
  "ele": "electron .",
  "dev": "concurrently \"npm run ele\" \"npm run serve\""
}</code></pre> 
<p><br>         现在，我们只需要执行 npm run dev 就可以同时跑两个命令了。</p> 
<p>        <span style="color:#fe2c24;"><strong>问题二: 如何解决白屏？</strong></span></p> 
<p>        这个问题的本质是等 npm run serve 启动完成后才去启动 npm run ele 。这个我们也可以通过一个 npm 包来完成： wait-on。首先安装`wait-on`：</p> 
<blockquote> 
 <p>npm i wait-on --save-dev</p> 
</blockquote> 
<p>        然后改造 scripts ：</p> 
<p><br>  </p> 
<pre><code>"scripts": {
  "serve": "vue-cli-service serve",
  "ele": "electron .",
  "dev": "concurrently \"wait-on http://localhost:8080/ &amp;&amp; npm run ele\" \"npm run serve\""
}</code></pre> 
<p>        <strong>wait-on http://localhost:8080/ &amp;&amp; npm run ele</strong>  这段代码的意思是等待http://localhost:8080/启动完成后，再启动 npm run ele ，这样白屏问题就得到解决了。</p> 
<p>        通过上面的两个问题我们发现，npm 上有很多小工具是非常实用的，这些小工具是可以运用在你的项目中的。</p> 
<h3>      <strong><span style="color:#fe2c24;">总结</span></strong></h3> 
<p>        本文通过创建 web 页面和创建 electron 两部分搭建了一个完整的 electron+vue 的桌面端开发环境。</p> 
<p>        通过两个 npm 的小工具 concurrently 和 wait-on 解决多开启多个命令行运行和白屏的问题，这让开发更加简单快捷。</p> 
<p><br>  </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bf0df6613bf6e8d9b14e29c0c9ce2183/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux下创建用户</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bdf61d38ab5d1ff6197c2e8cdc106f3f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Slide-Transformer: Hierarchical Vision Transformer with Local Self-Attention论文阅读笔记</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>