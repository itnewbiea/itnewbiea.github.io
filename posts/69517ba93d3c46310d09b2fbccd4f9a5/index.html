<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python项目分享 基于Django的智慧校园考试系统 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python项目分享 基于Django的智慧校园考试系统" />
<meta property="og:description" content="0 前言 Hi，大家好，今天给大家介绍一个python管理系统，大家可以用于自己的课设或毕设！
今天要分享的是：毕业设计 基于Django的智慧校园考试系统
项目分享：
https://gitee.com/sinonfin/system-sharing
1 设计说明 在虚拟环境下输入命令“python manage.py runserver”启动项目，然后，访问“http://127.0.0.1:8000”进入网站首页，如图1所示。
注册用户
鼠标悬浮至顶部导航中的“登录”按钮时，单击“密码”登录，弹出登录框，如图2所示。如果没有账号，需要点击登录框中的“注册”按钮进行注册，如图3所示。
在注册页面中，需要填写真实可用的邮箱，注册成功后，需要进行邮箱验证，如图4所示。单击“发送邮件”按钮，提示发送信息，如图5所示。
查看邮箱，如图6所示。
由于我们在本地测试，不能直接单击邮箱验证链接，可以手动赋值链接，然后在链接地址前添加“http://127.0.0.1:8000”, 即完成的链接地址为：“http://127.0.0.1:8000/auth/email_notify?email=2237800782@qq.com&amp;sign=53ec094a-4acf-11e9-8b5b-b0d59d3cadab”。然后使用浏览器访问该地址即可完成验证并自动登录，如图7所示。
注册完用户后，即可参与答题，如选择热门比赛。点击一个比赛，即可进入该比赛信息页，如图8所示。
单击“开始挑战”按钮开始答题，如图9所示。单击“查看排行榜”按钮，即可查看排行榜。
在答题页面，单击“后退”按钮，返回上一题；单击“前进”按钮，进入下一题；单击“交卷”按钮，显示答题成绩，如图10所示。
注册机构
机构用户可以参与出题，用户需要先注册结构才能成为机构用户。单击顶部导航中的“成为机构”按钮，进入注册机构页面，如图11所示。在该页面中，邮箱填写用户注册网站时邮箱。
注册完成后，单击导航栏顶部的“快速出题”按钮，进入出题页面。如图12所示。
在快速出题页面，需要先来录制题库，然后再配置比赛。单击“开始录制”按钮，如图13所示。创建题库时，需要先下载题库模块，然后根据模板提示，创建自己的Excel题库。然后填写题库名称，选择题库类型，上传Excel文件，最后单击“开始录制”按钮，上传题库。
上传完题库以后，开始配置比赛。在快速出题页面，单击“配置比赛”超链接，进入配置比赛页面。配置比赛时，选择题库，填写配置信息。如果需要答题用户在比赛前填写用户信息，则需要勾选“开启录入信息功能”，然后勾选下面的字段，如图14所示。配置完成后，页面跳转到答题页，单击“开始挑战”按钮，弹出一个填写答题用户信息的表单，该表单中的字段就是在配置信息中设定的内容，如图15所示。
后台管理员
后台管理员可以通过账号密码登录后台，输入网址“http://127.0.0.1:8000/admin/”，输入如下账号密码即可登录。
账号：mr
密码：mrsoft
登录成功后进入后台主页，如图16所示。在后台主页，管理员可以根据对应菜单执行相应的管理工作。
部分相关源码
# -*- coding: utf-8 -*- import datetime from django.conf import settings from django.contrib.auth import login, logout from django.contrib.auth.models import User from django.db import transaction from django.shortcuts import redirect, render, reverse from account.models import Profile from utils.errors import VeriCodeError, VerifyFailed, PasswordResetFailed, UserNotFound, VeriCodeTimeOut from utils." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/69517ba93d3c46310d09b2fbccd4f9a5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-06T15:03:42+08:00" />
<meta property="article:modified_time" content="2024-01-06T15:03:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python项目分享 基于Django的智慧校园考试系统</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<h2><a id="0__2"></a>0 前言</h2> 
<p>Hi，大家好，今天给大家介绍一个python管理系统，大家可以用于自己的课设或毕设！</p> 
<p><strong>今天要分享的是：毕业设计 基于Django的智慧校园考试系统</strong></p> 
<p><strong>项目分享：</strong></p> 
<p><a href="https://gitee.com/sinonfin/system-sharing" rel="nofollow">https://gitee.com/sinonfin/system-sharing</a></p> 
<h2><a id="1__13"></a>1 设计说明</h2> 
<p>在虚拟环境下输入命令“python manage.py runserver”启动项目，然后，访问“http://127.0.0.1:8000”进入网站首页，如图1所示。</p> 
<p><img src="https://images2.imgbox.com/d3/85/Xu3cDvKH_o.png" alt="在这里插入图片描述"><br> <strong>注册用户</strong></p> 
<p>鼠标悬浮至顶部导航中的“登录”按钮时，单击“密码”登录，弹出登录框，如图2所示。如果没有账号，需要点击登录框中的“注册”按钮进行注册，如图3所示。</p> 
<p><img src="https://images2.imgbox.com/38/4e/5lKyw5cp_o.png" alt="在这里插入图片描述"></p> 
<p>在注册页面中，需要填写真实可用的邮箱，注册成功后，需要进行邮箱验证，如图4所示。单击“发送邮件”按钮，提示发送信息，如图5所示。</p> 
<p><img src="https://images2.imgbox.com/a8/8d/vXaaLsWj_o.png" alt="在这里插入图片描述"></p> 
<p>查看邮箱，如图6所示。</p> 
<p><img src="https://images2.imgbox.com/6c/12/uzJvQDjx_o.png" alt="在这里插入图片描述"></p> 
<p>由于我们在本地测试，不能直接单击邮箱验证链接，可以手动赋值链接，然后在链接地址前添加“http://127.0.0.1:8000”, 即完成的链接地址为：“http://127.0.0.1:8000/auth/email_notify?email=2237800782@qq.com&amp;sign=53ec094a-4acf-11e9-8b5b-b0d59d3cadab”。然后使用浏览器访问该地址即可完成验证并自动登录，如图7所示。</p> 
<p><img src="https://images2.imgbox.com/79/c0/KuD48aLz_o.png" alt="在这里插入图片描述"></p> 
<p>注册完用户后，即可参与答题，如选择热门比赛。点击一个比赛，即可进入该比赛信息页，如图8所示。<br> <img src="https://images2.imgbox.com/00/bf/fMnA0OvN_o.png" alt="在这里插入图片描述">单击“开始挑战”按钮开始答题，如图9所示。单击“查看排行榜”按钮，即可查看排行榜。</p> 
<p><img src="https://images2.imgbox.com/b5/1a/C1KeLJ08_o.png" alt="在这里插入图片描述"><br> 在答题页面，单击“后退”按钮，返回上一题；单击“前进”按钮，进入下一题；单击“交卷”按钮，显示答题成绩，如图10所示。</p> 
<p><img src="https://images2.imgbox.com/9b/2c/tbWkcHLe_o.png" alt="在这里插入图片描述"></p> 
<p><strong>注册机构</strong></p> 
<p>机构用户可以参与出题，用户需要先注册结构才能成为机构用户。单击顶部导航中的“成为机构”按钮，进入注册机构页面，如图11所示。在该页面中，邮箱填写用户注册网站时邮箱。</p> 
<p><img src="https://images2.imgbox.com/01/35/BuzGSrPq_o.png" alt="在这里插入图片描述"><br> 注册完成后，单击导航栏顶部的“快速出题”按钮，进入出题页面。如图12所示。</p> 
<p><img src="https://images2.imgbox.com/89/fc/WtrrYL8Q_o.png" alt="在这里插入图片描述"><br> 在快速出题页面，需要先来录制题库，然后再配置比赛。单击“开始录制”按钮，如图13所示。创建题库时，需要先下载题库模块，然后根据模板提示，创建自己的Excel题库。然后填写题库名称，选择题库类型，上传Excel文件，最后单击“开始录制”按钮，上传题库。</p> 
<p><img src="https://images2.imgbox.com/09/83/TeYs6ObN_o.png" alt="在这里插入图片描述"></p> 
<p>上传完题库以后，开始配置比赛。在快速出题页面，单击“配置比赛”超链接，进入配置比赛页面。配置比赛时，选择题库，填写配置信息。如果需要答题用户在比赛前填写用户信息，则需要勾选“开启录入信息功能”，然后勾选下面的字段，如图14所示。配置完成后，页面跳转到答题页，单击“开始挑战”按钮，弹出一个填写答题用户信息的表单，该表单中的字段就是在配置信息中设定的内容，如图15所示。</p> 
<p><img src="https://images2.imgbox.com/14/f3/gR8ESjj1_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/0e/02/z7C1MNvs_o.png" alt="在这里插入图片描述"></p> 
<p><strong>后台管理员</strong></p> 
<p>后台管理员可以通过账号密码登录后台，输入网址“http://127.0.0.1:8000/admin/”，输入如下账号密码即可登录。<br> 账号：mr<br> 密码：mrsoft<br> 登录成功后进入后台主页，如图16所示。在后台主页，管理员可以根据对应菜单执行相应的管理工作。</p> 
<p><img src="https://images2.imgbox.com/b1/26/mX4Fc8Ly_o.png" alt="在这里插入图片描述"></p> 
<p><strong>部分相关源码</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>

<span class="token keyword">import</span> datetime

<span class="token keyword">from</span> django<span class="token punctuation">.</span>conf <span class="token keyword">import</span> settings
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth <span class="token keyword">import</span> login<span class="token punctuation">,</span> logout
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>models <span class="token keyword">import</span> User
<span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> transaction
<span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> redirect<span class="token punctuation">,</span> render<span class="token punctuation">,</span> reverse

<span class="token keyword">from</span> account<span class="token punctuation">.</span>models <span class="token keyword">import</span> Profile
<span class="token keyword">from</span> utils<span class="token punctuation">.</span>errors <span class="token keyword">import</span> VeriCodeError<span class="token punctuation">,</span> VerifyFailed<span class="token punctuation">,</span> PasswordResetFailed<span class="token punctuation">,</span> UserNotFound<span class="token punctuation">,</span> VeriCodeTimeOut
<span class="token keyword">from</span> utils<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>rprofile <span class="token keyword">import</span> get_signcode<span class="token punctuation">,</span> get_passwd


<span class="token keyword">def</span> <span class="token function">web_index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    首页渲染视图
    :param request:请求对象
    :return: 渲染视图并返回: user_info：用户信息;upgrade_info: 用户会员信息;has_login: 是否已登录;kinds: 比赛数据
    """</span>

    uid <span class="token operator">=</span> request<span class="token punctuation">.</span>session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>

    <span class="token keyword">try</span><span class="token punctuation">:</span>
        profile <span class="token operator">=</span> Profile<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>uid<span class="token operator">=</span>uid<span class="token punctuation">)</span>
    <span class="token keyword">except</span> Profile<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
        profile <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'web/index.html'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'user_info'</span><span class="token punctuation">:</span> profile <span class="token keyword">and</span> profile<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
        <span class="token string">'upgrade_info'</span><span class="token punctuation">:</span> profile <span class="token keyword">and</span> profile<span class="token punctuation">.</span>upgrade_data<span class="token punctuation">,</span>
        <span class="token string">'has_login'</span><span class="token punctuation">:</span> <span class="token builtin">bool</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">web_login</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    登录页面渲染视图
    :param request: 请求对象
    :return: 渲染视图并返回: login_info: 用户登录所需配置信息;has_login:是否已经登录;user_info:用户信息;upgrade_info: 用户会员信息
    """</span>

    uid <span class="token operator">=</span> request<span class="token punctuation">.</span>session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> uid<span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            profile <span class="token operator">=</span> Profile<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>uid<span class="token operator">=</span>uid<span class="token punctuation">)</span>
        <span class="token keyword">except</span> Profile<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
            profile <span class="token operator">=</span> <span class="token boolean">None</span>

        <span class="token keyword">if</span> profile<span class="token punctuation">:</span>
            <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'web/index.html'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string">'user_info'</span><span class="token punctuation">:</span> profile <span class="token keyword">and</span> profile<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
                <span class="token string">'upgrade_info'</span><span class="token punctuation">:</span> profile <span class="token keyword">and</span> profile<span class="token punctuation">.</span>upgrade_data<span class="token punctuation">,</span>
                <span class="token string">'has_login'</span><span class="token punctuation">:</span> <span class="token builtin">bool</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">del</span> request<span class="token punctuation">.</span>session<span class="token punctuation">[</span><span class="token string">'uid'</span><span class="token punctuation">]</span>
            <span class="token keyword">except</span> KeyError<span class="token punctuation">:</span>
                <span class="token keyword">pass</span>

    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'web/login.html'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'login_info'</span><span class="token punctuation">:</span> settings<span class="token punctuation">.</span>WXWEB_LOGIN_PARAMS <span class="token keyword">or</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">'has_login'</span><span class="token punctuation">:</span> <span class="token boolean">False</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">web_logout</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    用户注销视图
    :param request: 请求对象
    :return: 重定向首页
    """</span>

    logout<span class="token punctuation">(</span>request<span class="token punctuation">)</span>

    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">del</span> request<span class="token punctuation">.</span>session<span class="token punctuation">[</span><span class="token string">'uid'</span><span class="token punctuation">]</span>
    <span class="token keyword">except</span> KeyError<span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>reverse<span class="token punctuation">(</span><span class="token string">'web_index'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">signup_redirect</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""

    :param request: 请求对象
    :return:emai邮箱地址，sign注册验证码
    """</span>

    email <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
    sign <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'sign'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'web/sign_email.html'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'email'</span><span class="token punctuation">:</span> email<span class="token punctuation">,</span>
        <span class="token string">'sign'</span><span class="token punctuation">:</span> sign
    <span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@transaction<span class="token punctuation">.</span>atomic</span>
<span class="token keyword">def</span> <span class="token function">email_notify</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    email <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>  <span class="token comment"># 获取要验证的邮箱</span>
    sign <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'sign'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>  <span class="token comment"># 获取校验码</span>
    signcode <span class="token operator">=</span> get_signcode<span class="token punctuation">(</span>sign<span class="token punctuation">)</span>  <span class="token comment"># 在redis校验邮箱</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> signcode<span class="token punctuation">:</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'err.html'</span><span class="token punctuation">,</span> VeriCodeTimeOut<span class="token punctuation">)</span>  <span class="token comment"># 校验失败返回错误视图</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token punctuation">(</span>email <span class="token operator">==</span> signcode<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'err.html'</span><span class="token punctuation">,</span> VeriCodeError<span class="token punctuation">)</span>  <span class="token comment"># 校验失败返回错误视图</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        user <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>email<span class="token punctuation">)</span>  <span class="token comment"># 获取用户</span>
    <span class="token keyword">except</span> User<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
        user <span class="token operator">=</span> <span class="token boolean">None</span>
    <span class="token keyword">if</span> user <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>  <span class="token comment"># 激活用户</span>
        user<span class="token punctuation">.</span>is_active <span class="token operator">=</span> <span class="token boolean">True</span>
        user<span class="token punctuation">.</span>is_staff <span class="token operator">=</span> <span class="token boolean">True</span>
        user<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        login<span class="token punctuation">(</span>request<span class="token punctuation">,</span> user<span class="token punctuation">)</span>  <span class="token comment"># 登录用户</span>
        profile<span class="token punctuation">,</span> created <span class="token operator">=</span> Profile<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>select_for_update<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_or_create<span class="token punctuation">(</span>  <span class="token comment"># 配置用户信息</span>
            name<span class="token operator">=</span>user<span class="token punctuation">.</span>username<span class="token punctuation">,</span>
            email<span class="token operator">=</span>user<span class="token punctuation">.</span>email<span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        profile<span class="token punctuation">.</span>user_src <span class="token operator">=</span> Profile<span class="token punctuation">.</span>NORMAL_USER  <span class="token comment"># 配置用户为普通登录用户</span>
        profile<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

        request<span class="token punctuation">.</span>session<span class="token punctuation">[</span><span class="token string">'uid'</span><span class="token punctuation">]</span> <span class="token operator">=</span> profile<span class="token punctuation">.</span>uid  <span class="token comment"># 配置session</span>
        request<span class="token punctuation">.</span>session<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span> <span class="token operator">=</span> profile<span class="token punctuation">.</span>name
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'web/index.html'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment"># 渲染视图，并返回已登录信息</span>
            <span class="token string">'user_info'</span><span class="token punctuation">:</span> profile<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
            <span class="token string">'has_login'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
            <span class="token string">'msg'</span><span class="token punctuation">:</span> <span class="token string">"激活成功"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'err.html'</span><span class="token punctuation">,</span> VerifyFailed<span class="token punctuation">)</span>  <span class="token comment"># 校验失败返回错误视图</span>

<span class="token decorator annotation punctuation">@transaction<span class="token punctuation">.</span>atomic</span>
<span class="token keyword">def</span> <span class="token function">reset_notify</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    email <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
    sign <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'sign'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
    is_biz <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'is_biz'</span><span class="token punctuation">)</span>

    password <span class="token operator">=</span> get_passwd<span class="token punctuation">(</span>sign<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token keyword">not</span> password<span class="token punctuation">:</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'err.html'</span><span class="token punctuation">,</span> PasswordResetFailed<span class="token punctuation">)</span>

    <span class="token keyword">try</span><span class="token punctuation">:</span>
        u <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>email<span class="token operator">=</span>email<span class="token punctuation">)</span>
    <span class="token keyword">except</span> User<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'err.html'</span><span class="token punctuation">,</span> UserNotFound<span class="token punctuation">)</span>

    <span class="token keyword">if</span> is_biz <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>
        u<span class="token punctuation">.</span>is_staff <span class="token operator">=</span> <span class="token boolean">True</span>
        u<span class="token punctuation">.</span>is_active <span class="token operator">=</span> <span class="token boolean">True</span>
    u<span class="token punctuation">.</span>set_password<span class="token punctuation">(</span>password<span class="token punctuation">)</span>
    u<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'web/index.html'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'has_login'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span>
        <span class="token string">'msg'</span><span class="token punctuation">:</span> <span class="token string">'密码修改成功!'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">error</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'err.html'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">"errtitle"</span><span class="token punctuation">:</span> <span class="token string">"页面发生错误"</span><span class="token punctuation">,</span> <span class="token string">"errmsg"</span><span class="token punctuation">:</span> <span class="token string">"页面发生未知错误，请联系管理员解决~"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> 
<h2><a id="_249"></a>项目分享</h2> 
<p><strong>项目分享：完整源码 + 环境配置文档 + 设计使用手册</strong></p> 
<p><a href="https://gitee.com/sinonfin/system-sharing" rel="nofollow">https://gitee.com/sinonfin/system-sharing</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/124784822ca8a2f783cdb73b6a6c569f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">一文读懂「AI Agent」智能体</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1a44a5026bbda42fdd82193ba0ccd8c6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">自动驾驶感知-预测-决策-规划-控制学习（3）：感知方向文献阅读笔记</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>