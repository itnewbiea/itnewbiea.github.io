<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>å¤§æ•°æ®æ¯•è®¾ - æ·±åº¦å­¦ä¹ æ¤ç‰©è¯†åˆ«ç³»ç»Ÿï¼ˆpython OpenCVï¼‰ - ITå­¦ä¹ è€…åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="å¤§æ•°æ®æ¯•è®¾ - æ·±åº¦å­¦ä¹ æ¤ç‰©è¯†åˆ«ç³»ç»Ÿï¼ˆpython OpenCVï¼‰" />
<meta property="og:description" content="æ–‡ç« ç›®å½• 0 å‰è¨€2 ç›¸å…³æŠ€æœ¯2.1 VGG-Netæ¨¡å‹2.2 VGG-Netåœ¨æ¤ç‰©è¯†åˆ«çš„ä¼˜åŠ¿(1) å·ç§¯æ ¸ï¼Œæ± åŒ–æ ¸å¤§å°å›ºå®š(2) ç‰¹å¾æå–æ›´å…¨é¢(3) ç½‘ç»œè®­ç»ƒè¯¯å·®æ”¶æ•›é€Ÿåº¦è¾ƒå¿« 3 VGG-Netçš„æ­å»º3.1 Tornadoç®€ä»‹(1) ä¼˜åŠ¿(2) å…³é”®ä»£ç  4 Inception V3 ç¥ç»ç½‘ç»œ4.1 ç½‘ç»œç»“æ„ 5 å¼€å§‹è®­ç»ƒ5.1 æ•°æ®é›†5.2 å…³é”®ä»£ç 5.3 æ¨¡å‹é¢„æµ‹ 6 æ•ˆæœå±•ç¤º6.1 ä¸»é¡µé¢å±•ç¤º6.2 å›¾ç‰‡é¢„æµ‹6.3 ä¸‰ç»´æ¨¡å‹å¯è§†åŒ– 7 æœ€å 0 å‰è¨€ ğŸ”¥ Hiï¼Œå¤§å®¶å¥½ï¼Œè¿™é‡Œæ˜¯ä¸¹æˆå­¦é•¿çš„æ¯•è®¾ç³»åˆ—æ–‡ç« ï¼
ğŸ”¥ å¯¹æ¯•è®¾æœ‰ä»»ä½•ç–‘é—®éƒ½å¯ä»¥é—®å­¦é•¿å“¦!
è¿™ä¸¤å¹´å¼€å§‹ï¼Œå„ä¸ªå­¦æ ¡å¯¹æ¯•è®¾çš„è¦æ±‚è¶Šæ¥è¶Šé«˜ï¼Œéš¾åº¦ä¹Ÿè¶Šæ¥è¶Šå¤§â€¦ æ¯•ä¸šè®¾è®¡è€—è´¹æ—¶é—´ï¼Œè€—è´¹ç²¾åŠ›ï¼Œç”šè‡³æœ‰äº›é¢˜ç›®å³ä½¿æ˜¯ä¸“ä¸šçš„è€å¸ˆæˆ–è€…ç¡•å£«ç”Ÿä¹Ÿéœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œæ‰€ä»¥ä¸€æ—¦å‘ç°é—®é¢˜ï¼Œä¸€å®šè¦æå‰å‡†å¤‡ï¼Œé¿å…åˆ°åé¢æªæ‰‹ä¸åŠï¼Œè‰è‰äº†äº‹ã€‚
ä¸ºäº†å¤§å®¶èƒ½å¤Ÿé¡ºåˆ©ä»¥åŠæœ€å°‘çš„ç²¾åŠ›é€šè¿‡æ¯•è®¾ï¼Œå­¦é•¿åˆ†äº«ä¼˜è´¨æ¯•ä¸šè®¾è®¡é¡¹ç›®ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ–°é¡¹ç›®æ˜¯
ğŸš© åŸºäºæ·±åº¦å­¦ä¹ çš„æ¤ç‰©è¯†åˆ«ç®—æ³•ç ”ç©¶ä¸å®ç°
ğŸ¥‡å­¦é•¿è¿™é‡Œç»™ä¸€ä¸ªé¢˜ç›®ç»¼åˆè¯„åˆ†(æ¯é¡¹æ»¡åˆ†5åˆ†)
éš¾åº¦ç³»æ•°ï¼š4åˆ†å·¥ä½œé‡ï¼š4åˆ†åˆ›æ–°ç‚¹ï¼š3åˆ† ğŸ§¿ é€‰é¢˜æŒ‡å¯¼, é¡¹ç›®åˆ†äº«ï¼š
https://gitee.com/yaa-dc/BJH/blob/master/gg/cc/README.md
2 ç›¸å…³æŠ€æœ¯ 2.1 VGG-Netæ¨¡å‹ Google DeepMindå…¬å¸ç ”ç©¶å‘˜ä¸ç‰›æ´¥å¤§å­¦è®¡ç®—æœºè§†è§‰ç»„åœ¨2014å¹´å…±åŒç ”å‘å‡ºäº†ä¸€ç§å…¨æ–°çš„å·ç§¯ç¥ç»ç½‘ç»œâ€“VGG-Netã€‚åœ¨åŒå¹´ä¸¾åŠçš„ILSVRCæ¯”èµ›ä¸­ï¼Œè¯¥ç½‘ç»œç»“æ„æ¨¡å‹åœ¨åˆ†ç±»é¡¹ç›®ä¸­å–å¾—äº†ååˆ†å‡ºè‰²çš„æˆç»©ï¼Œç”±äºå…¶ç®€æ´æ€§å’Œå®ç”¨æ€§ï¼Œä½¿å¾—å…¶åœ¨å½“æ—¶è¿…é€Ÿï¼Œé£å¿«åœ°æˆä¸ºäº†æœ€å—æ¬¢è¿çš„å·ç§¯ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚VGG-Netå·ç§¯ç¥ç»ç½‘ç»œåœ¨è¿‘å¹´æ¥è¡ç”Ÿå‡ºäº†A-Eä¸ƒç§ä¸åŒçš„å±‚æ¬¡ç»“æ„ï¼Œæœ¬æ¬¡ç ”ç©¶ä½¿ç”¨å…¶ä¸­çš„Dç»“æ„ï¼Œä¹Ÿå°±æ˜¯VGG-16Netç»“æ„ï¼Œè¯¥ç»“æ„ä¸­åŒ…å«äº†13ä¸ªå·ç§¯å±‚ï¼Œ5ä¸ªæ± åŒ–å±‚å’Œ3ä¸ªå…¨è¿æ¥å±‚ã€‚é’ˆå¯¹æ‰€æœ‰çš„å·ç§¯å±‚ï¼Œä½¿ç”¨ç›¸åŒçš„5x5å¤§å°çš„å·ç§¯æ ¸ï¼Œé’ˆå¯¹æ‰€æœ‰çš„æ± åŒ–å±‚ï¼Œä½¿ç”¨ç›¸åŒçš„3x3å¤§å°çš„æ± åŒ–æ ¸ã€‚VGG-Netç»“æ„å¦‚å›¾æ‰€ç¤ºã€‚
2.2 VGG-Netåœ¨æ¤ç‰©è¯†åˆ«çš„ä¼˜åŠ¿ åœ¨é’ˆå¯¹æ¤ç‰©è¯†åˆ«é—®é¢˜ä¸Šï¼ŒVGG-Netæœ‰ç€ä¸€äº›ç›¸è¾ƒäºå…¶ä»–ç¥ç»ç½‘ç»œçš„ä¼˜åŠ¿ï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç‚¹ï¼š
(1) å·ç§¯æ ¸ï¼Œæ± åŒ–æ ¸å¤§å°å›ºå®š ç½‘ç»œä¸­æ‰€æœ‰çš„å·ç§¯æ ¸å¤§å°å›ºå®šä¸º3x3,æ‰€æœ‰çš„æ± åŒ–æ ¸å¤§å°å›ºå®šä¸º5x5ã€‚è¿™æ ·åœ¨è¿›è¡Œå·ç§¯å’Œæ± åŒ–æ“ä½œçš„æ—¶å€™ï¼Œä»æ•°æ®ä¸­æå–åˆ°çš„ç‰¹å¾æ›´åŠ æ˜æ˜¾ï¼ŒåŒæ—¶åœ¨å±‚ä¸å±‚çš„è¿æ¥æ—¶ï¼Œä¿¡æ¯çš„ä¸¢å¤±ä¼šæ›´å°‘ï¼Œæ›´åŠ æ–¹ä¾¿åç»­å¯¹äºé‡è¦ç‰¹å¾çš„æå–å’Œå¤„ç†ã€‚
(2) ç‰¹å¾æå–æ›´å…¨é¢ VGG-Netç½‘ç»œæ¨¡å‹ä¸­åŒ…å«äº†13ä¸ªå·ç§¯å±‚ã€‚å·ç§¯å±‚æ•°ç›®è¶Šå¤šï¼Œå¯¹äºç‰¹å¾çš„æå–æ›´åŠ çš„å…¨é¢ã€‚ç”±äºéœ€è¦å¯¹äºæ¤ç‰©çš„å§¿æ€ã€é¢œè‰²ç­‰è¿›è¡Œåˆ¤å®šï¼Œæ¤ç‰©çš„ç‰¹å¾è¾ƒå¤šï¼Œéœ€è¦åœ¨æå–æ—¶æ›´åŠ çš„å…¨é¢ï¼Œç»†è‡´ï¼Œæ‰æœ‰å¯èƒ½å¾—åˆ°ä¸€ä¸ªæ›´åŠ å‡†ç¡®çš„åˆ¤å®šã€‚VGG-Netç¬¦åˆæ¡ä»¶ã€‚
(3) ç½‘ç»œè®­ç»ƒè¯¯å·®æ”¶æ•›é€Ÿåº¦è¾ƒå¿« VGG-Netç½‘ç»œåœ¨è®­ç»ƒæ—¶æ”¶æ•›é€Ÿåº¦ç›¸å¯¹è¾ƒå¿«ï¼Œèƒ½å¤Ÿè¾ƒå¿«åœ°å¾—åˆ°é¢„æœŸçš„ç»“æœã€‚å…·æœ‰è¿™ä¸€ç‰¹ç‚¹çš„åŸå› æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ç½‘ç»œä¸­æ¯ä¸€ä¸ªå·ç§¯å±‚å’Œæ± åŒ–å±‚ä¸­çš„å·ç§¯æ ¸å¤§å°ä¸æ± åŒ–æ ¸å¤§å°å›ºå®šï¼Œå¦ä¸€ä¸ªå°±æ˜¯å¯¹äºå„ä¸ªéšè—å±‚çš„å‚æ•°åˆå§‹åŒ–æ–¹æ³•ä½¿ç”¨ä¸“é—¨é’ˆå¯¹ReLUæ¿€æ´»å‡½æ•°çš„Kaimingæ­£æ€åˆå§‹åŒ–æ–¹æ³•ã€‚
3 VGG-Netçš„æ­å»º æœ¬æ¬¡ç ”ç©¶åŸºäºPytorchæ·±åº¦å­¦ä¹ æ¡†æ¶è¿›è¡Œç½‘ç»œçš„æ­å»ºï¼Œåˆ©ç”¨æ¨¡å—åŒ–çš„è®¾è®¡æ€æƒ³ï¼Œæ„å»ºä¸€ä¸ªç±»ï¼Œæ¥å¯¹äºæ•´ä¸ªçš„ç½‘ç»œè¿›è¡Œç»“æ„ä¸Šçš„å°è£…ã€‚è¿™æ ·æ­å»ºçš„å¥½å¤„æ˜¯å¯ä»¥éšè—å®ç°çš„å†…éƒ¨ç»†èŠ‚ï¼Œæé«˜ä»£ç çš„å®‰å…¨æ€§ï¼Œå¢å¼ºä»£ç çš„å¤ç”¨æ•ˆç‡ï¼Œå¹¶ä¸”å¯¹äºä¸€äº›æ–¹æ³•ï¼Œé€šè¿‡åœ¨å†…éƒ¨é›†æˆï¼Œå¯ä»¥æ–¹ä¾¿ä¹‹åå¯¹äºå…¶ä¸­æ–¹æ³•çš„è°ƒç”¨ï¼Œæå‡ä»£ç çš„ç®€æ´æ€§ã€‚ åœ¨ç½‘ç»œæ­å»ºå®Œæˆåï¼Œå°†æ•°æ®é›†ä¼ å…¥ç½‘ç»œä¸­è¿›è¡Œè®­ç»ƒï¼Œç»è¿‡ä¸€æ®µæ—¶é—´åå³å¯å¾—åˆ°æ¤ç‰©è¯†åˆ«çš„åˆ†ç±»è¯†åˆ«ç»“æœã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c9719f5284f4ce5377d3ffaaeb3730c7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-22T10:27:01+08:00" />
<meta property="article:modified_time" content="2022-11-22T10:27:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ITå­¦ä¹ è€…åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ITå­¦ä¹ è€…åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">å¤§æ•°æ®æ¯•è®¾ - æ·±åº¦å­¦ä¹ æ¤ç‰©è¯†åˆ«ç³»ç»Ÿï¼ˆpython OpenCVï¼‰</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><a href="#0__4" rel="nofollow">0 å‰è¨€</a></li><li><a href="#2__38" rel="nofollow">2 ç›¸å…³æŠ€æœ¯</a></li><li><ul><li><a href="#21_VGGNet_40" rel="nofollow">2.1 VGG-Netæ¨¡å‹</a></li><li><a href="#22_VGGNet_47" rel="nofollow">2.2 VGG-Netåœ¨æ¤ç‰©è¯†åˆ«çš„ä¼˜åŠ¿</a></li><li><ul><li><a href="#1__51" rel="nofollow">(1) å·ç§¯æ ¸ï¼Œæ± åŒ–æ ¸å¤§å°å›ºå®š</a></li><li><a href="#2__55" rel="nofollow">(2) ç‰¹å¾æå–æ›´å…¨é¢</a></li><li><a href="#3__62" rel="nofollow">(3) ç½‘ç»œè®­ç»ƒè¯¯å·®æ”¶æ•›é€Ÿåº¦è¾ƒå¿«</a></li></ul> 
  </li></ul> 
  </li><li><a href="#3_VGGNet_70" rel="nofollow">3 VGG-Netçš„æ­å»º</a></li><li><ul><li><a href="#31_Tornado_75" rel="nofollow">3.1 Tornadoç®€ä»‹</a></li><li><ul><li><a href="#1__79" rel="nofollow">(1) ä¼˜åŠ¿</a></li><li><a href="#2___87" rel="nofollow">(2) å…³é”®ä»£ç </a></li></ul> 
  </li></ul> 
  </li><li><a href="#4_Inception_V3__148" rel="nofollow">4 Inception V3 ç¥ç»ç½‘ç»œ</a></li><li><ul><li><a href="#41__152" rel="nofollow">4.1 ç½‘ç»œç»“æ„</a></li></ul> 
  </li><li><a href="#5__176" rel="nofollow">5 å¼€å§‹è®­ç»ƒ</a></li><li><ul><li><a href="#51__178" rel="nofollow">5.1 æ•°æ®é›†</a></li><li><a href="#52__185" rel="nofollow">5.2 å…³é”®ä»£ç </a></li><li><a href="#53__244" rel="nofollow">5.3 æ¨¡å‹é¢„æµ‹</a></li></ul> 
  </li><li><a href="#6__273" rel="nofollow">6 æ•ˆæœå±•ç¤º</a></li><li><ul><li><a href="#61__275" rel="nofollow">6.1 ä¸»é¡µé¢å±•ç¤º</a></li><li><a href="#62__279" rel="nofollow">6.2 å›¾ç‰‡é¢„æµ‹</a></li><li><a href="#63__284" rel="nofollow">6.3 ä¸‰ç»´æ¨¡å‹å¯è§†åŒ–</a></li></ul> 
  </li><li><a href="#7__300" rel="nofollow">7 æœ€å</a></li></ul> 
</div> 
<p></p> 
<hr size='1"' color="#000000"> 
<h2><a id="0__4"></a>0 å‰è¨€</h2> 
<p>ğŸ”¥ Hiï¼Œå¤§å®¶å¥½ï¼Œè¿™é‡Œæ˜¯ä¸¹æˆå­¦é•¿çš„æ¯•è®¾ç³»åˆ—æ–‡ç« ï¼</p> 
<p>ğŸ”¥ å¯¹æ¯•è®¾æœ‰ä»»ä½•ç–‘é—®éƒ½å¯ä»¥é—®å­¦é•¿å“¦!</p> 
<p>è¿™ä¸¤å¹´å¼€å§‹ï¼Œå„ä¸ªå­¦æ ¡å¯¹æ¯•è®¾çš„è¦æ±‚è¶Šæ¥è¶Šé«˜ï¼Œéš¾åº¦ä¹Ÿè¶Šæ¥è¶Šå¤§â€¦ æ¯•ä¸šè®¾è®¡è€—è´¹æ—¶é—´ï¼Œè€—è´¹ç²¾åŠ›ï¼Œç”šè‡³æœ‰äº›é¢˜ç›®å³ä½¿æ˜¯ä¸“ä¸šçš„è€å¸ˆæˆ–è€…ç¡•å£«ç”Ÿä¹Ÿéœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œæ‰€ä»¥ä¸€æ—¦å‘ç°é—®é¢˜ï¼Œä¸€å®šè¦æå‰å‡†å¤‡ï¼Œé¿å…åˆ°åé¢æªæ‰‹ä¸åŠï¼Œè‰è‰äº†äº‹ã€‚</p> 
<p>ä¸ºäº†å¤§å®¶èƒ½å¤Ÿé¡ºåˆ©ä»¥åŠæœ€å°‘çš„ç²¾åŠ›é€šè¿‡æ¯•è®¾ï¼Œå­¦é•¿åˆ†äº«ä¼˜è´¨æ¯•ä¸šè®¾è®¡é¡¹ç›®ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ–°é¡¹ç›®æ˜¯</p> 
<p>ğŸš© <strong>åŸºäºæ·±åº¦å­¦ä¹ çš„æ¤ç‰©è¯†åˆ«ç®—æ³•ç ”ç©¶ä¸å®ç°</strong></p> 
<p>ğŸ¥‡å­¦é•¿è¿™é‡Œç»™ä¸€ä¸ªé¢˜ç›®ç»¼åˆè¯„åˆ†(æ¯é¡¹æ»¡åˆ†5åˆ†)</p> 
<ul><li>éš¾åº¦ç³»æ•°ï¼š4åˆ†</li><li>å·¥ä½œé‡ï¼š4åˆ†</li><li>åˆ›æ–°ç‚¹ï¼š3åˆ†</li></ul> 
<p>ğŸ§¿ <strong>é€‰é¢˜æŒ‡å¯¼, é¡¹ç›®åˆ†äº«ï¼š</strong></p> 
<p><a href="https://gitee.com/yaa-dc/BJH/blob/master/gg/cc/README.md" rel="nofollow">https://gitee.com/yaa-dc/BJH/blob/master/gg/cc/README.md</a></p> 
<p><img src="https://images2.imgbox.com/4c/b8/EXXoC4hH_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<br> 
<hr size='1"' color="#000000"> 
<h2><a id="2__38"></a>2 ç›¸å…³æŠ€æœ¯</h2> 
<h3><a id="21_VGGNet_40"></a>2.1 VGG-Netæ¨¡å‹</h3> 
<p>Google DeepMindå…¬å¸ç ”ç©¶å‘˜ä¸ç‰›æ´¥å¤§å­¦è®¡ç®—æœºè§†è§‰ç»„åœ¨2014å¹´å…±åŒç ”å‘å‡ºäº†ä¸€ç§å…¨æ–°çš„å·ç§¯ç¥ç»ç½‘ç»œâ€“VGG-Netã€‚åœ¨åŒå¹´ä¸¾åŠçš„ILSVRCæ¯”èµ›ä¸­ï¼Œè¯¥ç½‘ç»œç»“æ„æ¨¡å‹åœ¨åˆ†ç±»é¡¹ç›®ä¸­å–å¾—äº†ååˆ†å‡ºè‰²çš„æˆç»©ï¼Œç”±äºå…¶ç®€æ´æ€§å’Œå®ç”¨æ€§ï¼Œä½¿å¾—å…¶åœ¨å½“æ—¶è¿…é€Ÿï¼Œé£å¿«åœ°æˆä¸ºäº†æœ€å—æ¬¢è¿çš„å·ç§¯ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚VGG-Netå·ç§¯ç¥ç»ç½‘ç»œåœ¨è¿‘å¹´æ¥è¡ç”Ÿå‡ºäº†A-Eä¸ƒç§ä¸åŒçš„å±‚æ¬¡ç»“æ„ï¼Œæœ¬æ¬¡ç ”ç©¶ä½¿ç”¨å…¶ä¸­çš„Dç»“æ„ï¼Œä¹Ÿå°±æ˜¯VGG-16Netç»“æ„ï¼Œè¯¥ç»“æ„ä¸­åŒ…å«äº†13ä¸ªå·ç§¯å±‚ï¼Œ5ä¸ªæ± åŒ–å±‚å’Œ3ä¸ªå…¨è¿æ¥å±‚ã€‚é’ˆå¯¹æ‰€æœ‰çš„å·ç§¯å±‚ï¼Œä½¿ç”¨ç›¸åŒçš„5x5å¤§å°çš„å·ç§¯æ ¸ï¼Œé’ˆå¯¹æ‰€æœ‰çš„æ± åŒ–å±‚ï¼Œä½¿ç”¨ç›¸åŒçš„3x3å¤§å°çš„æ± åŒ–æ ¸ã€‚VGG-Netç»“æ„å¦‚å›¾æ‰€ç¤ºã€‚</p> 
<p><img src="https://images2.imgbox.com/24/84/MQd1YGkb_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="22_VGGNet_47"></a>2.2 VGG-Netåœ¨æ¤ç‰©è¯†åˆ«çš„ä¼˜åŠ¿</h3> 
<p>åœ¨é’ˆå¯¹æ¤ç‰©è¯†åˆ«é—®é¢˜ä¸Šï¼ŒVGG-Netæœ‰ç€ä¸€äº›ç›¸è¾ƒäºå…¶ä»–ç¥ç»ç½‘ç»œçš„ä¼˜åŠ¿ï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç‚¹ï¼š</p> 
<h4><a id="1__51"></a>(1) å·ç§¯æ ¸ï¼Œæ± åŒ–æ ¸å¤§å°å›ºå®š</h4> 
<p>ç½‘ç»œä¸­æ‰€æœ‰çš„å·ç§¯æ ¸å¤§å°å›ºå®šä¸º3x3,æ‰€æœ‰çš„æ± åŒ–æ ¸å¤§å°å›ºå®šä¸º5x5ã€‚è¿™æ ·åœ¨è¿›è¡Œå·ç§¯å’Œæ± åŒ–æ“ä½œçš„æ—¶å€™ï¼Œä»æ•°æ®ä¸­æå–åˆ°çš„ç‰¹å¾æ›´åŠ æ˜æ˜¾ï¼ŒåŒæ—¶åœ¨å±‚ä¸å±‚çš„è¿æ¥æ—¶ï¼Œä¿¡æ¯çš„ä¸¢å¤±ä¼šæ›´å°‘ï¼Œæ›´åŠ æ–¹ä¾¿åç»­å¯¹äºé‡è¦ç‰¹å¾çš„æå–å’Œå¤„ç†ã€‚</p> 
<h4><a id="2__55"></a>(2) ç‰¹å¾æå–æ›´å…¨é¢</h4> 
<p>VGG-Netç½‘ç»œæ¨¡å‹ä¸­åŒ…å«äº†13ä¸ªå·ç§¯å±‚ã€‚å·ç§¯å±‚æ•°ç›®è¶Šå¤šï¼Œå¯¹äºç‰¹å¾çš„æå–æ›´åŠ çš„å…¨é¢ã€‚ç”±äºéœ€è¦å¯¹äºæ¤ç‰©çš„å§¿æ€ã€é¢œè‰²ç­‰è¿›è¡Œåˆ¤å®šï¼Œæ¤ç‰©çš„ç‰¹å¾è¾ƒå¤šï¼Œéœ€è¦åœ¨æå–æ—¶æ›´åŠ çš„å…¨é¢ï¼Œç»†è‡´ï¼Œæ‰æœ‰å¯èƒ½å¾—åˆ°ä¸€ä¸ªæ›´åŠ å‡†ç¡®çš„åˆ¤å®šã€‚VGG-Netç¬¦åˆæ¡ä»¶ã€‚</p> 
<p><img src="https://images2.imgbox.com/2b/90/8k0m3mzf_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h4><a id="3__62"></a>(3) ç½‘ç»œè®­ç»ƒè¯¯å·®æ”¶æ•›é€Ÿåº¦è¾ƒå¿«</h4> 
<p>VGG-Netç½‘ç»œåœ¨è®­ç»ƒæ—¶æ”¶æ•›é€Ÿåº¦ç›¸å¯¹è¾ƒå¿«ï¼Œèƒ½å¤Ÿè¾ƒå¿«åœ°å¾—åˆ°é¢„æœŸçš„ç»“æœã€‚å…·æœ‰è¿™ä¸€ç‰¹ç‚¹çš„åŸå› æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ç½‘ç»œä¸­æ¯ä¸€ä¸ªå·ç§¯å±‚å’Œæ± åŒ–å±‚ä¸­çš„å·ç§¯æ ¸å¤§å°ä¸æ± åŒ–æ ¸å¤§å°å›ºå®šï¼Œå¦ä¸€ä¸ªå°±æ˜¯å¯¹äºå„ä¸ªéšè—å±‚çš„å‚æ•°åˆå§‹åŒ–æ–¹æ³•ä½¿ç”¨ä¸“é—¨é’ˆå¯¹ReLUæ¿€æ´»å‡½æ•°çš„Kaimingæ­£æ€åˆå§‹åŒ–æ–¹æ³•ã€‚</p> 
<br> 
<h2><a id="3_VGGNet_70"></a>3 VGG-Netçš„æ­å»º</h2> 
<p>æœ¬æ¬¡ç ”ç©¶åŸºäºPytorchæ·±åº¦å­¦ä¹ æ¡†æ¶è¿›è¡Œç½‘ç»œçš„æ­å»ºï¼Œåˆ©ç”¨æ¨¡å—åŒ–çš„è®¾è®¡æ€æƒ³ï¼Œæ„å»ºä¸€ä¸ªç±»ï¼Œæ¥å¯¹äºæ•´ä¸ªçš„ç½‘ç»œè¿›è¡Œç»“æ„ä¸Šçš„å°è£…ã€‚è¿™æ ·æ­å»ºçš„å¥½å¤„æ˜¯å¯ä»¥éšè—å®ç°çš„å†…éƒ¨ç»†èŠ‚ï¼Œæé«˜ä»£ç çš„å®‰å…¨æ€§ï¼Œå¢å¼ºä»£ç çš„å¤ç”¨æ•ˆç‡ï¼Œå¹¶ä¸”å¯¹äºä¸€äº›æ–¹æ³•ï¼Œé€šè¿‡åœ¨å†…éƒ¨é›†æˆï¼Œå¯ä»¥æ–¹ä¾¿ä¹‹åå¯¹äºå…¶ä¸­æ–¹æ³•çš„è°ƒç”¨ï¼Œæå‡ä»£ç çš„ç®€æ´æ€§ã€‚ åœ¨ç½‘ç»œæ­å»ºå®Œæˆåï¼Œå°†æ•°æ®é›†ä¼ å…¥ç½‘ç»œä¸­è¿›è¡Œè®­ç»ƒï¼Œç»è¿‡ä¸€æ®µæ—¶é—´åå³å¯å¾—åˆ°æ¤ç‰©è¯†åˆ«çš„åˆ†ç±»è¯†åˆ«ç»“æœã€‚</p> 
<h3><a id="31_Tornado_75"></a>3.1 Tornadoç®€ä»‹</h3> 
<p>Tornadoå…¨ç§°Tornado Web Serverï¼Œæ˜¯ä¸€ä¸ªç”¨Pythonè¯­è¨€å†™æˆçš„WebæœåŠ¡å™¨å…¼Webåº”ç”¨æ¡†æ¶ï¼Œç”±FriendFeedå…¬å¸åœ¨è‡ªå·±çš„ç½‘ç«™FriendFeedä¸­ä½¿ç”¨ï¼Œè¢«Facebookæ”¶è´­ä»¥åæ¡†æ¶åœ¨2009å¹´9æœˆä»¥å¼€æºè½¯ä»¶å½¢å¼å¼€æ”¾ç»™å¤§ä¼—ã€‚</p> 
<h4><a id="1__79"></a>(1) ä¼˜åŠ¿</h4> 
<ul><li>è½»é‡çº§webæ¡†æ¶</li><li>å¼‚æ­¥éé˜»å¡IOå¤„ç†æ–¹å¼</li><li>å‡ºè‰²çš„æŠ—è´Ÿè½½èƒ½åŠ›</li><li>ä¼˜å¼‚çš„å¤„ç†æ€§èƒ½ï¼Œä¸ä¾èµ–å¤šè¿›ç¨‹/å¤šçº¿ç¨‹ï¼Œä¸€å®šç¨‹åº¦ä¸Šè§£å†³C10Ké—®é¢˜</li><li>WSGIå…¨æ ˆæ›¿ä»£äº§å“ï¼Œæ¨èåŒæ—¶ä½¿ç”¨å…¶webæ¡†æ¶å’ŒHTTPæœåŠ¡å™¨</li></ul> 
<h4><a id="2___87"></a>(2) å…³é”®ä»£ç </h4> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">MainHandler</span><span class="token punctuation">(</span>tornado<span class="token punctuation">.</span>web<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">"index.html"</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        keras<span class="token punctuation">.</span>backend<span class="token punctuation">.</span>clear_session<span class="token punctuation">(</span><span class="token punctuation">)</span>
        img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>BytesIO<span class="token punctuation">(</span>self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">'image'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'body'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        img <span class="token operator">=</span> img
        b_img <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        size <span class="token operator">=</span> img<span class="token punctuation">.</span>size
        <span class="token keyword">if</span> size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            rate <span class="token operator">=</span> <span class="token number">224</span> <span class="token operator">/</span> size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            new_size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> rate<span class="token punctuation">)</span><span class="token punctuation">)</span>
            img <span class="token operator">=</span> img<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>new_size<span class="token punctuation">,</span> Image<span class="token punctuation">.</span>ANTIALIAS
                             <span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">"RGB"</span><span class="token punctuation">)</span>
            b_img<span class="token punctuation">.</span>paste<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">224</span> <span class="token operator">-</span> new_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">else</span><span class="token punctuation">:</span>
            rate <span class="token operator">=</span> <span class="token number">224</span> <span class="token operator">/</span> size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            new_size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> rate<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">)</span>
            img <span class="token operator">=</span> img<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>new_size<span class="token punctuation">,</span> Image<span class="token punctuation">.</span>ANTIALIAS
                             <span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">"RGB"</span><span class="token punctuation">)</span>
            b_img<span class="token punctuation">.</span>paste<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">224</span> <span class="token operator">-</span> new_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> self<span class="token punctuation">.</span>get_argument<span class="token punctuation">(</span><span class="token string">"method"</span><span class="token punctuation">,</span> <span class="token string">"mymodel"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"VGG16"</span><span class="token punctuation">:</span>
            Model <span class="token operator">=</span> load_model<span class="token punctuation">(</span><span class="token string">"VGG16.h5"</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            Model <span class="token operator">=</span> load_model<span class="token punctuation">(</span><span class="token string">"InceptionV3.h5"</span><span class="token punctuation">)</span>

        data <span class="token operator">=</span> orc_img<span class="token punctuation">(</span>Model<span class="token punctuation">,</span>b_img<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>write<span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>
            <span class="token punctuation">{<!-- --></span><span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"data"</span><span class="token punctuation">:</span> data
             <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token keyword">def</span> <span class="token function">make_app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    template_path <span class="token operator">=</span> <span class="token string">"templates/"</span>
    static_path <span class="token operator">=</span> <span class="token string">"./static/"</span>

    <span class="token keyword">return</span> tornado<span class="token punctuation">.</span>web<span class="token punctuation">.</span>Application<span class="token punctuation">(</span><span class="token punctuation">[</span>

        <span class="token punctuation">(</span><span class="token string">r"/"</span><span class="token punctuation">,</span> MainHandler<span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token punctuation">]</span><span class="token punctuation">,</span> template_path<span class="token operator">=</span>template_path<span class="token punctuation">,</span> static_path<span class="token operator">=</span>static_path<span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">run_server</span><span class="token punctuation">(</span>port<span class="token operator">=</span><span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    tornado<span class="token punctuation">.</span>options<span class="token punctuation">.</span>parse_command_line<span class="token punctuation">(</span><span class="token punctuation">)</span>
    app <span class="token operator">=</span> make_app<span class="token punctuation">(</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span>listen<span class="token punctuation">(</span>port<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\næœåŠ¡å·²å¯åŠ¨ è¯·æ‰“å¼€ http://127.0.0.1:8000 "</span><span class="token punctuation">)</span>
    tornado<span class="token punctuation">.</span>ioloop<span class="token punctuation">.</span>IOLoop<span class="token punctuation">.</span>current<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<br> 
<h2><a id="4_Inception_V3__148"></a>4 Inception V3 ç¥ç»ç½‘ç»œ</h2> 
<p>GoogLeNetå¯¹ç½‘ç»œä¸­çš„ä¼ ç»Ÿå·ç§¯å±‚è¿›è¡Œäº†ä¿®æ”¹ï¼Œæå‡ºäº†è¢«ç§°ä¸º Inception çš„ç»“æ„ï¼Œç”¨äºå¢åŠ ç½‘ç»œæ·±åº¦å’Œå®½åº¦ï¼Œæé«˜æ·±åº¦ç¥ç»ç½‘ç»œæ€§èƒ½ã€‚ä»Inception V1åˆ°Inception V4æœ‰4ä¸ªæ›´æ–°ç‰ˆæœ¬ï¼Œæ¯ä¸€ç‰ˆçš„ç½‘ç»œåœ¨åŸæ¥çš„åŸºç¡€ä¸Šè¿›è¡Œæ”¹è¿›ï¼Œæé«˜ç½‘ç»œæ€§èƒ½ã€‚</p> 
<h3><a id="41__152"></a>4.1 ç½‘ç»œç»“æ„</h3> 
<p><img src="https://images2.imgbox.com/d1/ed/yw7wl8mp_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>inceptionç»“æ„çš„ä½œç”¨ï¼ˆinceptionçš„ç»“æ„å’Œä½œç”¨ï¼‰</strong></p> 
<p>ä½œç”¨ï¼šä»£æ›¿äººå·¥ç¡®å®šå·ç§¯å±‚ä¸­è¿‡æ»¤å™¨çš„ç±»å‹æˆ–è€…ç¡®å®šæ˜¯å¦éœ€è¦åˆ›å»ºå·ç§¯å±‚æˆ–è€…æ± åŒ–å±‚ã€‚å³ï¼šä¸éœ€è¦äººä¸ºå†³å®šä½¿ç”¨ä»€ä¹ˆè¿‡æ»¤å™¨ï¼Œæ˜¯å¦éœ€è¦åˆ›å»ºæ± åŒ–å±‚ï¼Œç”±ç½‘ç»œè‡ªå·±å­¦ä¹ å†³å®šè¿™äº›å‚æ•°ï¼Œå¯ä»¥ç»™ç½‘ç»œæ·»åŠ æ‰€æœ‰å¯èƒ½å€¼ï¼Œå°†è¾“å…¥è¿æ¥èµ·æ¥ï¼Œç½‘ç»œè‡ªå·±å­¦ä¹ éœ€è¦å®ƒéœ€è¦ä»€ä¹ˆæ ·çš„å‚æ•°ã€‚</p> 
<p><strong>inceptionä¸»è¦æ€æƒ³</strong></p> 
<p>ç”¨å¯†é›†æˆåˆ†æ¥è¿‘ä¼¼æœ€ä¼˜çš„å±€éƒ¨ç¨€ç–è§£ï¼ˆå¦‚ä¸Šå›¾ï¼‰</p> 
<ul><li>é‡‡ç”¨ä¸åŒå¤§å°çš„å·ç§¯æ ¸æ„å‘³ç€æœ‰ä¸åŒå¤§å°çš„æ„Ÿå—é‡ï¼Œæœ€åçš„æ‹¼æ¥æ„å‘³ç€ä¸åŒå°ºåº¦ç‰¹å¾çš„èåˆã€‚</li><li>ä¹‹æ‰€ä»¥å·ç§¯æ ¸å¤§å°é‡‡ç”¨1x1ã€3x3å’Œ5x5ï¼Œä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿å¯¹é½ã€‚è®¾å®šå·ç§¯æ­¥é•¿stride=1ä¹‹åï¼Œåªè¦åˆ†åˆ«è®¾å®špadding = 0ã€1ã€2ï¼Œé‡‡ç”¨sameå·ç§¯å¯ä»¥å¾—åˆ°ç›¸åŒç»´åº¦çš„ç‰¹å¾ï¼Œç„¶åè¿™äº›ç‰¹å¾ç›´æ¥æ‹¼æ¥åœ¨ä¸€èµ·ã€‚</li><li>å¾ˆå¤šåœ°æ–¹éƒ½è¡¨æ˜poolingæŒºæœ‰æ•ˆï¼Œæ‰€ä»¥Inceptioné‡Œé¢ä¹ŸåµŒå…¥äº†poolingã€‚</li><li>ç½‘ç»œè¶Šåˆ°åé¢ç‰¹å¾è¶ŠæŠ½è±¡ï¼Œä¸”æ¯ä¸ªç‰¹å¾æ¶‰åŠçš„æ„Ÿå—é‡ä¹Ÿæ›´å¤§ï¼Œéšç€å±‚æ•°çš„å¢åŠ ï¼Œ3x3å’Œ5x5å·ç§¯çš„æ¯”ä¾‹ä¹Ÿè¦å¢åŠ ã€‚</li><li>æœ€ç»ˆç‰ˆinceptionï¼ŒåŠ å…¥äº†1x1 convæ¥é™ä½feature mapåšåº¦ã€‚</li></ul> 
<br> 
<h2><a id="5__176"></a>5 å¼€å§‹è®­ç»ƒ</h2> 
<h3><a id="51__178"></a>5.1 æ•°æ®é›†</h3> 
<p>è®­ç»ƒå›¾åƒæŒ‰ç…§å¦‚ä¸‹æ–¹å¼è¿›è¡Œåˆ†ç±»ï¼Œå…±åˆ†ä¸º9æ–‡ä»¶å¤¹ã€‚</p> 
<p><img src="https://images2.imgbox.com/24/36/GQH4Dby8_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="52__185"></a>5.2 å…³é”®ä»£ç </h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> keras<span class="token punctuation">.</span>utils <span class="token keyword">import</span> Sequence
<span class="token keyword">import</span> math


<span class="token keyword">class</span> <span class="token class-name">SequenceData</span><span class="token punctuation">(</span>Sequence<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> batch_size<span class="token punctuation">,</span> target_size<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># åˆå§‹åŒ–æ‰€éœ€çš„å‚æ•°</span>

        self<span class="token punctuation">.</span>batch_size <span class="token operator">=</span> batch_size
        self<span class="token punctuation">.</span>target_size <span class="token operator">=</span> target_size
        self<span class="token punctuation">.</span>x_filenames <span class="token operator">=</span> data

    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># è®©ä»£ç çŸ¥é“è¿™ä¸ªåºåˆ—çš„é•¿åº¦</span>
        num_imgs <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>x_filenames<span class="token punctuation">)</span>
        <span class="token keyword">return</span> math<span class="token punctuation">.</span>ceil<span class="token punctuation">(</span>num_imgs <span class="token operator">/</span> self<span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># è¿­ä»£å™¨éƒ¨åˆ†</span>
        batch_x <span class="token operator">=</span> self<span class="token punctuation">.</span>x_filenames<span class="token punctuation">[</span>idx <span class="token operator">*</span> self<span class="token punctuation">.</span>batch_size<span class="token punctuation">:</span> <span class="token punctuation">(</span>idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>batch_size<span class="token punctuation">]</span>
        imgs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> x <span class="token keyword">in</span> batch_x<span class="token punctuation">:</span>
            img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
            b_img <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>target_size<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            size <span class="token operator">=</span> img<span class="token punctuation">.</span>size
            <span class="token keyword">if</span> size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                rate <span class="token operator">=</span> self<span class="token punctuation">.</span>target_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">/</span> size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                new_size <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>target_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> rate<span class="token punctuation">)</span><span class="token punctuation">)</span>
                img <span class="token operator">=</span> img<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>new_size<span class="token punctuation">,</span> Image<span class="token punctuation">.</span>ANTIALIAS<span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">"RGB"</span><span class="token punctuation">)</span>
                b_img<span class="token punctuation">.</span>paste<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>target_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> new_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token keyword">else</span><span class="token punctuation">:</span>
                rate <span class="token operator">=</span> self<span class="token punctuation">.</span>target_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">/</span> size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
                new_size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> rate<span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>target_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                img <span class="token operator">=</span> img<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>new_size<span class="token punctuation">,</span> Image<span class="token punctuation">.</span>ANTIALIAS<span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">"RGB"</span><span class="token punctuation">)</span>
                b_img<span class="token punctuation">.</span>paste<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>target_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> new_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

            img <span class="token operator">=</span> b_img
            <span class="token keyword">if</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.1</span><span class="token punctuation">:</span>
                img <span class="token operator">=</span> img<span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">"RGB"</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.2</span><span class="token punctuation">:</span>
                img <span class="token operator">=</span> img<span class="token punctuation">.</span>rotate<span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># éšæœºæ—‹è½¬ä¸€å®šè§’åº¦</span>
            <span class="token keyword">if</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.2</span><span class="token punctuation">:</span>
                img <span class="token operator">=</span> img<span class="token punctuation">.</span>rotate<span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">340</span><span class="token punctuation">,</span> <span class="token number">360</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># éš æ—‹è½¬ä¸€å®šè§’åº¦</span>
            imgs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>img<span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">"RGB"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        x_arrays <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>i<span class="token punctuation">)</span>  <span class="token keyword">for</span> i <span class="token keyword">in</span> imgs<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>
            <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255</span>  <span class="token comment"># è¯»å–ä¸€æ‰¹å›¾ç‰‡</span>

        batch_y <span class="token operator">=</span> to_categorical<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>labels<span class="token punctuation">.</span>index<span class="token punctuation">(</span>x<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> batch_x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>labels<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> x_arrays<span class="token punctuation">,</span> batch_y

</code></pre> 
<h3><a id="53__244"></a>5.3 æ¨¡å‹é¢„æµ‹</h3> 
<p>åˆ©ç”¨æˆ‘ä»¬è®­ç»ƒå¥½çš„<strong>vgg16.h5</strong>æ¨¡å‹è¿›è¡Œé¢„æµ‹ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">orc_img</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span>image<span class="token punctuation">)</span><span class="token punctuation">:</span>
    img <span class="token operator">=</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    img <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">-</span> img<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    predict <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
    index <span class="token operator">=</span> predict<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"CNNé¢„æµ‹"</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span>

    target <span class="token operator">=</span> target_name<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
    index2 <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>predict<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
    target2 <span class="token operator">=</span> target_name<span class="token punctuation">[</span>index2<span class="token punctuation">]</span>
    index3 <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>predict<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span>
    target3 <span class="token operator">=</span> target_name<span class="token punctuation">[</span>index3<span class="token punctuation">]</span>

    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token string">"target"</span><span class="token punctuation">:</span> target<span class="token punctuation">,</span>
            <span class="token string">"predict"</span><span class="token punctuation">:</span> <span class="token string">"%.2f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>predict<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

            <span class="token string">"target2"</span><span class="token punctuation">:</span> target2<span class="token punctuation">,</span>
            <span class="token string">"predict2"</span><span class="token punctuation">:</span> <span class="token string">"%.2f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>predict<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>index2<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

            <span class="token punctuation">}</span>
</code></pre> 
<br> 
<h2><a id="6__273"></a>6 æ•ˆæœå±•ç¤º</h2> 
<h3><a id="61__275"></a>6.1 ä¸»é¡µé¢å±•ç¤º</h3> 
<p><img src="https://images2.imgbox.com/02/f1/ksxRTxwf_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="62__279"></a>6.2 å›¾ç‰‡é¢„æµ‹</h3> 
<p><img src="https://images2.imgbox.com/7b/ff/tPJOXifh_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="63__284"></a>6.3 ä¸‰ç»´æ¨¡å‹å¯è§†åŒ–</h3> 
<p>å­¦é•¿åœ¨webé¡µé¢ä¸Šåšäº†ä¸€ä¸ªä¸‰ç»´ç½‘ç»œç»“æ„å¯è§†åŒ–åŠŸèƒ½ï¼Œå¯ä»¥ç›´è§‚çš„çœ‹åˆ°ç½‘ç»œæ¨¡å‹ç»“æ„</p> 
<p><img src="https://images2.imgbox.com/d8/29/LExCH4gw_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/66/c5/Ilc1t4uK_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> <img src="https://images2.imgbox.com/4e/25/qVST8vV6_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<br> 
<h2><a id="7__300"></a>7 æœ€å</h2>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a3d035907429d64f7e6c9328fb347fdb/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">win10å®‰è£…é…ç½®nodejsç¯å¢ƒ</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/895356485018889034927e714dda2d10/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">pythonåˆ¤æ–­æ˜¯å¦æ˜¯å‘¨æœ«</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ITå­¦ä¹ è€…åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>