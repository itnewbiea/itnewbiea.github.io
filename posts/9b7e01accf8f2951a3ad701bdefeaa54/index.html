<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用HttpSession和过滤器实现一个简单的用户登录认证的功能 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用HttpSession和过滤器实现一个简单的用户登录认证的功能" />
<meta property="og:description" content="这篇文章分享一下怎么通过session结合过滤器来实现控制登录访问的功能，涉及的代码非常简单，通过session保存用户登录的信息，如果没有用户登录的话，会在过滤器中处理，重定向回登录页面。
创建一个springboot项目，添加springbooot-starter-web和lombok的依赖。创建对应的实体类、controller、service，并创建两个简单的html页面测试过滤器的效果。
一、登录功能实现 controller package cn.edu.sgu.www.login.controller; import cn.edu.sgu.www.login.entity.User; import cn.edu.sgu.www.login.service.UserService; import cn.edu.sgu.www.login.util.UserUtils; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RequestMethod; import org.springframework.web.bind.annotation.RestController; import java.io.IOException; /** * @author heyunlin * @version 1.0 */ @RestController @RequestMapping(path = &#34;/user&#34;, produces = &#34;application/json;charset=utf-8&#34;) public class UserController { private final UserService userService; @Autowired public UserController(UserService userService) { this.userService = userService; } @RequestMapping(value = &#34;/login&#34;, method = RequestMethod.POST) public void login(User user) throws IOException { userService.login(user); UserUtils.getResponse().sendRedirect(&#34;/index.html&#34;); } } service UserService" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/9b7e01accf8f2951a3ad701bdefeaa54/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T15:38:34+08:00" />
<meta property="article:modified_time" content="2024-01-05T15:38:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用HttpSession和过滤器实现一个简单的用户登录认证的功能</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>这篇文章分享一下怎么通过session结合过滤器来实现控制登录访问的功能，涉及的代码非常简单，通过session保存用户登录的信息，如果没有用户登录的话，会在过滤器中处理，重定向回登录页面。</p> 
<p>创建一个springboot项目，添加springbooot-starter-web和lombok的依赖。创建对应的实体类、controller、service，并创建两个简单的html页面测试过滤器的效果。</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/8f/94/IfZf4oIp_o.png" width="1200"></p> 
<p></p> 
<h2>一、登录功能实现</h2> 
<h3>controller</h3> 
<pre><code class="language-java">package cn.edu.sgu.www.login.controller;

import cn.edu.sgu.www.login.entity.User;
import cn.edu.sgu.www.login.service.UserService;
import cn.edu.sgu.www.login.util.UserUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RestController;

import java.io.IOException;

/**
 * @author heyunlin
 * @version 1.0
 */
@RestController
@RequestMapping(path = "/user", produces = "application/json;charset=utf-8")
public class UserController {

    private final UserService userService;

    @Autowired
    public UserController(UserService userService) {
        this.userService = userService;
    }

    @RequestMapping(value = "/login", method = RequestMethod.POST)
    public void login(User user) throws IOException {
        userService.login(user);

        UserUtils.getResponse().sendRedirect("/index.html");
    }

}</code></pre> 
<p></p> 
<h3>service</h3> 
<p>UserService</p> 
<pre><code class="language-java">package cn.edu.sgu.www.login.service;

import cn.edu.sgu.www.login.entity.User;

/**
 * @author heyunlin
 * @version 1.0
 */
public interface UserService {

    /**
     * 登录认证
     * @param user 用户输入的信息
     */
    void login(User user);
}</code></pre> 
<p>UserServiceImpl</p> 
<pre><code class="language-java">package cn.edu.sgu.www.login.service.impl;

import cn.edu.sgu.www.login.entity.User;
import cn.edu.sgu.www.login.service.UserService;
import cn.edu.sgu.www.login.util.UserUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

/**
 * @author heyunlin
 * @version 1.0
 */
@Service
public class UserServiceImpl implements UserService {

    private final UserUtils userUtils;

    @Autowired
    public UserServiceImpl(UserUtils userUtils) {
        this.userUtils = userUtils;
    }

    @Override
    public void login(User user) {
        String username = user.getUsername();
        String password = user.getPassword();

        if (username == null || "".equals(username)) {
            throw new RuntimeException("用户名不能为空~");
        } else if (password == null || "".equals(password)) {
            throw new RuntimeException("密码不能为空~");
        } else {
            if (username.equals("admin") &amp;&amp; password.equals("12345")) {
                userUtils.getSession().setAttribute("user", user);
            } else {
                throw new RuntimeException("用户名或密码错误！");
            }
        }
    }

}</code></pre> 
<p></p> 
<h2>二、过滤器实现资源访问控制</h2> 
<p>LoginFilter</p> 
<pre><code class="language-java">package cn.edu.sgu.www.login.filter;

import javax.servlet.*;
import javax.servlet.annotation.WebFilter;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.io.IOException;

/**
 * 登录过滤器
 * @author heyunlin
 * @version 1.0
 */
@WebFilter(filterName = "loginFilter", urlPatterns = {"/", "/html/*", "/index.html"})
public class LoginFilter implements Filter {

    @Override
    public void doFilter(ServletRequest req, ServletResponse resp, FilterChain filterChain) throws IOException, ServletException {
        HttpServletRequest request = (HttpServletRequest) req;
        HttpSession session = request.getSession();

        // 获取登录信息
        Object obj = session.getAttribute("user");

        if (obj == null) { // 未登录，重定向到登录页
            /*
             * 登录页面的地址
             */
            String loginPage = "/login.html";
            // 获取响应对象
            HttpServletResponse response = (HttpServletResponse) resp;

            response.sendRedirect(loginPage);
        } else { // 当前有用户登录，放行
            filterChain.doFilter(req, resp);
        }
    }

}</code></pre> 
<p>在任意配置类上使用@ServletComponentScan("cn.edu.sgu.www.login.filter")开启servlet的组件扫描~</p> 
<pre><code class="language-java">package cn.edu.sgu.www.login;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.web.servlet.ServletComponentScan;

@ServletComponentScan("cn.edu.sgu.www.login.filter")
@SpringBootApplication
public class FilterLoginApplication {

    public static void main(String[] args) {
        SpringApplication.run(FilterLoginApplication.class, args);
    }

}</code></pre> 
<p></p> 
<p>文章设计的代码已上传到git仓库，可按需获取~</p> 
<p><a class="link-info has-card" href="https://gitee.com/he-yunlin/filter-login.git" rel="nofollow" title="使用过滤器实现一个最简单的登录认证功能"><span class="link-card-box"><span class="link-title">使用过滤器实现一个最简单的登录认证功能</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/bf/2b/Ds5oKZ06_o.png" alt="icon-default.png?t=N7T8">https://gitee.com/he-yunlin/filter-login.git</span></span></a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4a1d2079d83ac9db265c6129fe6f56b8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">预测未来？Python中的时间序列分析模型ARIMA</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/32f8caee05589ded5b9c2d6d67f8ed03/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">最新自动化测试面试题总结（答案&#43;文档）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>