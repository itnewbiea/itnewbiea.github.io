<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SpringBoot实现文件记录日志，日志文件自动归档和压缩 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SpringBoot实现文件记录日志，日志文件自动归档和压缩" />
<meta property="og:description" content="😊 @ 作者： Eric
💖 @ 主页： https://blog.csdn.net/weixin_47316183?type=blog
🎉 @ 主题：SpringBoot实现文件记录日志，日志文件自动归档和压缩
⏱️ @ 创作时间： 2023年08月06日
文章目录 1、什么是Logback2、SpringBoot实现文件记录日志，日志文件自动归档和压缩2.1、配置2.2、日志记录到文件中2.3、日志文件自动归档和压缩 总结 1、什么是Logback Logback是一个Java日志框架，它是log4j的后继者，被广泛用于应用程序中记录日志。
Logger（日志记录器）：
Logger 是 Logback 中最重要的组件之一。它负责收集应用程序中的日志信息，并将其传递给适当的 Appender 进行处理。Logger 使用不同的日志级别来决定日志信息的输出方式。常见的日志级别有 DEBUG、INFO、WARN、ERROR 和 TRACE。
Appender（日志输出目的地）：Appender 决定日志信息的输出目的地。Logback 提供了不同类型的 Appender，比如 ConsoleAppender、FileAppender 和 SocketAppender 等。每个 Appender 可以配置不同的 Layout，用于定义日志信息的格式。 Logback 的日志输出原理可以简单分为以下步骤：
应用程序代码中使用 Logger 记录日志。Logger 根据日志级别决定是否将日志信息传递给 Appender。当 Logger需要输出日志时，它会将日志信息封装成一个 LogEvent 对象。LogEvent 对象传递给配置好的 Appender。Appender 将根据配置将日志信息输出到不同的目的地，比如控制台、文件、远程服务器等。在输出日志之前，Appender 还会使用配置好的 Layout 对日志信息进行格式化。最终，格式化后的日志信息被输出到指定的目的地，供开发者和系统管理员查看和分析。 2、SpringBoot实现文件记录日志，日志文件自动归档和压缩 2.1、配置 1、引入依赖
&lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;/dependency&gt; 2、在 resource 目录下 创建文件 logback-spring." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/0730e7651127c7e271157e23aa745482/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-06T10:42:50+08:00" />
<meta property="article:modified_time" content="2023-08-06T10:42:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SpringBoot实现文件记录日志，日志文件自动归档和压缩</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/88/49/5A645QIz_o.png" alt="在这里插入图片描述"><br> 😊 @ 作者： Eric<br> 💖 @ 主页： <a href="https://blog.csdn.net/weixin_47316183?type=blog">https://blog.csdn.net/weixin_47316183?type=blog</a><br> 🎉 @ 主题：<strong>SpringBoot实现文件记录日志，日志文件自动归档和压缩</strong><br> ⏱️ @ 创作时间： 2023年08月06日</p> 
<p><img src="https://images2.imgbox.com/7a/cf/pl4Hi1vl_o.png" alt="在这里插入图片描述"></p> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1Logback_19" rel="nofollow">1、什么是Logback</a></li><li><a href="#2SpringBoot_40" rel="nofollow">2、SpringBoot实现文件记录日志，日志文件自动归档和压缩</a></li><li><ul><li><a href="#21_41" rel="nofollow">2.1、配置</a></li><li><a href="#22_227" rel="nofollow">2.2、日志记录到文件中</a></li><li><a href="#23_240" rel="nofollow">2.3、日志文件自动归档和压缩</a></li></ul> 
  </li><li><a href="#_256" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="1Logback_19"></a>1、什么是Logback</h2> 
<p><strong><code>Logback</code>是一个Java日志框架，它是<code>log4j</code>的后继者，被广泛用于应用程序中记录日志。</strong></p> 
<p>Logger（日志记录器）：</p> 
<ul><li><code>Logger</code> 是 Logback 中最重要的组件之一。它负责收集应用程序中的日志信息，并将其传递给适当的 Appender 进行处理。Logger 使用不同的日志级别来决定日志信息的输出方式。常见的日志级别有 <code>DEBUG、INFO、WARN、ERROR 和 TRACE</code>。<br> Appender（日志输出目的地）：</li><li><code>Appender</code> 决定日志信息的输出目的地。Logback 提供了不同类型的 Appender，比如 ConsoleAppender、FileAppender 和 SocketAppender 等。每个 Appender 可以配置不同的 Layout，用于定义日志信息的格式。</li></ul> 
<p><strong>Logback 的日志输出原理可以简单分为以下步骤：</strong></p> 
<ul><li>应用程序代码中使用 Logger 记录日志。Logger 根据日志级别决定是否将日志信息传递给 Appender。</li><li>当 Logger需要输出日志时，它会将日志信息封装成一个 LogEvent 对象。</li><li>LogEvent 对象传递给配置好的 Appender。Appender 将根据配置将日志信息输出到不同的目的地，比如控制台、文件、远程服务器等。</li><li>在输出日志之前，Appender 还会使用配置好的 Layout 对日志信息进行格式化。</li><li>最终，格式化后的日志信息被输出到指定的目的地，供开发者和系统管理员查看和分析。</li></ul> 
<br> 
<br> 
<h2><a id="2SpringBoot_40"></a>2、SpringBoot实现文件记录日志，日志文件自动归档和压缩</h2> 
<h3><a id="21_41"></a>2.1、配置</h3> 
<p>1、引入依赖</p> 
<pre><code class="prism language-bash"><span class="token operator">&lt;</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>groupId<span class="token operator">&gt;</span>org.projectlombok<span class="token operator">&lt;</span>/groupId<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>artifactId<span class="token operator">&gt;</span>lombok<span class="token operator">&lt;</span>/artifactId<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/dependency<span class="token operator">&gt;</span>
</code></pre> 
<p>2、在 <code>resource</code> 目录下 创建文件 <code>logback-spring.xml</code> 内容如下</p> 
<pre><code class="prism language-bash"><span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.0"</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">"UTF-8"</span>?<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>configuration <span class="token assign-left variable">scan</span><span class="token operator">=</span><span class="token string">"true"</span> <span class="token assign-left variable">scanPeriod</span><span class="token operator">=</span><span class="token string">"10 seconds"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span>--0. 日志格式和颜色渲染 --<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span>-- 彩色日志依赖的渲染类 --<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>conversionRule <span class="token assign-left variable">conversionWord</span><span class="token operator">=</span><span class="token string">"clr"</span> <span class="token assign-left variable">converterClass</span><span class="token operator">=</span><span class="token string">"org.springframework.boot.logging.logback.ColorConverter"</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>conversionRule <span class="token assign-left variable">conversionWord</span><span class="token operator">=</span><span class="token string">"wex"</span> <span class="token assign-left variable">converterClass</span><span class="token operator">=</span><span class="token string">"org.springframework.boot.logging.logback.WhitespaceThrowableProxyConverter"</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>conversionRule <span class="token assign-left variable">conversionWord</span><span class="token operator">=</span><span class="token string">"wEx"</span> <span class="token assign-left variable">converterClass</span><span class="token operator">=</span><span class="token string">"org.springframework.boot.logging.logback.ExtendedWhitespaceThrowableProxyConverter"</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span>-- 彩色日志格式 --<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>property <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"log.path"</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">"./logs"</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>property <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"app.name"</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">"eric"</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>property <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"CONSOLE_LOG_PATTERN"</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${CONSOLE_LOG_PATTERN<span class="token operator">:-</span><span class="token operator">%</span>clr(<span class="token operator">%</span>d{yyyy-MM-dd HH<span class="token operator">:</span>mm<span class="token operator">:</span>ss.SSS}</span>){faint} %clr(<span class="token variable">${LOG_LEVEL_PATTERN<span class="token operator">:-</span><span class="token operator">%</span>5p}</span>) %clr(<span class="token variable">${PID<span class="token operator">:-</span> }</span>){magenta} %clr(---){faint} %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %m%n<span class="token variable">${LOG_EXCEPTION_CONVERSION_WORD<span class="token operator">:-</span><span class="token operator">%</span>wEx}</span>}"</span>/<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">!</span>--1. 输出到控制台--<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>appender <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"CONSOLE"</span> <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.core.ConsoleAppender"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span>--此日志appender是为开发使用，只配置最底级别，控制台输出的日志级别是大于或等于此级别的日志信息--<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>filter <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.classic.filter.ThresholdFilter"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>level<span class="token operator">&gt;</span>INFO<span class="token operator">&lt;</span>/level<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/filter<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>encoder<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Pattern<span class="token operator">&gt;</span><span class="token variable">${CONSOLE_LOG_PATTERN}</span><span class="token operator">&lt;</span>/Pattern<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span>-- 设置字符集 --<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>charset<span class="token operator">&gt;</span>UTF-<span class="token operator"><span class="token file-descriptor important">8</span>&lt;</span>/charset<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/encoder<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/appender<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">!</span>-- <span class="token number">2.2</span> level为 INFO 日志，时间滚动输出  --<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>appender <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"INFO_FILE"</span> <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.core.rolling.RollingFileAppender"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span>-- 正在记录的日志文档的路径及文档名 --<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>file<span class="token operator">&gt;</span><span class="token variable">${log.path}</span>/<span class="token variable">${app.name}</span>-info.log<span class="token operator">&lt;</span>/file<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span>--日志文档输出格式--<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>encoder<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>pattern<span class="token operator">&gt;</span>%d<span class="token punctuation">{<!-- --></span>yyyy-MM-dd HH:mm:ss.SSS<span class="token punctuation">}</span> <span class="token punctuation">[</span>%thread<span class="token punctuation">]</span> %-5level %logger<span class="token punctuation">{<!-- --></span><span class="token number">50</span><span class="token punctuation">}</span> - %msg%n<span class="token operator">&lt;</span>/pattern<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>charset<span class="token operator">&gt;</span>UTF-<span class="token operator"><span class="token file-descriptor important">8</span>&lt;</span>/charset<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/encoder<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span>-- 日志记录器的滚动策略，按日期，按大小记录 --<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>rollingPolicy <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span>-- 每天日志归档路径以及格式 --<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>fileNamePattern<span class="token operator">&gt;</span><span class="token variable">${log.path}</span>/<span class="token variable">${app.name}</span>/<span class="token variable">${app.name}</span>-info-%d<span class="token punctuation">{<!-- --></span>yyyy-MM-dd<span class="token punctuation">}</span>.%i.log.gz<span class="token operator">&lt;</span>/fileNamePattern<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>timeBasedFileNamingAndTriggeringPolicy <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>maxFileSize<span class="token operator">&gt;</span>10MB<span class="token operator">&lt;</span>/maxFileSize<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/timeBasedFileNamingAndTriggeringPolicy<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span>--日志文档保留天数--<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>maxHistory<span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator"><span class="token file-descriptor important">5</span>&lt;</span>/maxHistory<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/rollingPolicy<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span>-- 此日志文档只记录info级别的 --<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>filter <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.classic.filter.LevelFilter"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>level<span class="token operator">&gt;</span>INFO<span class="token operator">&lt;</span>/level<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>onMatch<span class="token operator">&gt;</span>ACCEPT<span class="token operator">&lt;</span>/onMatch<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>onMismatch<span class="token operator">&gt;</span>DENY<span class="token operator">&lt;</span>/onMismatch<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/filter<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/appender<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">!</span>-- <span class="token number">2.3</span> level为 WARN 日志，时间滚动输出  --<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>appender <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"WARN_FILE"</span> <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.core.rolling.RollingFileAppender"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span>-- 正在记录的日志文档的路径及文档名 --<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>file<span class="token operator">&gt;</span><span class="token variable">${log.path}</span>/<span class="token variable">${app.name}</span>-warn.log<span class="token operator">&lt;</span>/file<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span>--日志文档输出格式--<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>encoder<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>pattern<span class="token operator">&gt;</span>%d<span class="token punctuation">{<!-- --></span>yyyy-MM-dd HH:mm:ss.SSS<span class="token punctuation">}</span> <span class="token punctuation">[</span>%thread<span class="token punctuation">]</span> %-5level %logger<span class="token punctuation">{<!-- --></span><span class="token number">50</span><span class="token punctuation">}</span> - %msg%n<span class="token operator">&lt;</span>/pattern<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>charset<span class="token operator">&gt;</span>UTF-<span class="token operator"><span class="token file-descriptor important">8</span>&lt;</span>/charset<span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">!</span>-- 此处设置字符集 --<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/encoder<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span>-- 日志记录器的滚动策略，按日期，按大小记录 --<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>rollingPolicy <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>fileNamePattern<span class="token operator">&gt;</span><span class="token variable">${log.path}</span>/<span class="token variable">${app.name}</span>/<span class="token variable">${app.name}</span>-warn-%d<span class="token punctuation">{<!-- --></span>yyyy-MM-dd<span class="token punctuation">}</span>.%i.log.gz<span class="token operator">&lt;</span>/fileNamePattern<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>timeBasedFileNamingAndTriggeringPolicy <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>maxFileSize<span class="token operator">&gt;</span>10MB<span class="token operator">&lt;</span>/maxFileSize<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/timeBasedFileNamingAndTriggeringPolicy<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span>--日志文档保留天数--<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>maxHistory<span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator"><span class="token file-descriptor important">5</span>&lt;</span>/maxHistory<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/rollingPolicy<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span>-- 此日志文档只记录warn级别的 --<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>filter <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.classic.filter.LevelFilter"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>level<span class="token operator">&gt;</span>WARN<span class="token operator">&lt;</span>/level<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>onMatch<span class="token operator">&gt;</span>ACCEPT<span class="token operator">&lt;</span>/onMatch<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>onMismatch<span class="token operator">&gt;</span>DENY<span class="token operator">&lt;</span>/onMismatch<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/filter<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/appender<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">!</span>-- <span class="token number">2.4</span> level为 ERROR 日志，时间滚动输出  --<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>appender <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"ERROR_FILE"</span> <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.core.rolling.RollingFileAppender"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span>-- 正在记录的日志文档的路径及文档名 --<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>file<span class="token operator">&gt;</span><span class="token variable">${log.path}</span>/<span class="token variable">${app.name}</span>-error.log<span class="token operator">&lt;</span>/file<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span>--日志文档输出格式--<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>encoder<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>pattern<span class="token operator">&gt;</span>%d<span class="token punctuation">{<!-- --></span>yyyy-MM-dd HH:mm:ss.SSS<span class="token punctuation">}</span> <span class="token punctuation">[</span>%thread<span class="token punctuation">]</span> %-5level %logger<span class="token punctuation">{<!-- --></span><span class="token number">50</span><span class="token punctuation">}</span> - %msg%n<span class="token operator">&lt;</span>/pattern<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>charset<span class="token operator">&gt;</span>UTF-<span class="token operator"><span class="token file-descriptor important">8</span>&lt;</span>/charset<span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">!</span>-- 此处设置字符集 --<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/encoder<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span>-- 日志记录器的滚动策略，按日期，按大小记录 --<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>rollingPolicy <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>fileNamePattern<span class="token operator">&gt;</span><span class="token variable">${log.path}</span>/<span class="token variable">${app.name}</span>/<span class="token variable">${app.name}</span>-error-%d<span class="token punctuation">{<!-- --></span>yyyy-MM-dd<span class="token punctuation">}</span>.%i.log.gz<span class="token operator">&lt;</span>/fileNamePattern<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>timeBasedFileNamingAndTriggeringPolicy <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>maxFileSize<span class="token operator">&gt;</span>10MB<span class="token operator">&lt;</span>/maxFileSize<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/timeBasedFileNamingAndTriggeringPolicy<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span>--日志文档保留天数--<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>maxHistory<span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator"><span class="token file-descriptor important">5</span>&lt;</span>/maxHistory<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/rollingPolicy<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span>-- 此日志文档只记录ERROR级别的 --<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>filter <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"ch.qos.logback.classic.filter.LevelFilter"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>level<span class="token operator">&gt;</span>ERROR<span class="token operator">&lt;</span>/level<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>onMatch<span class="token operator">&gt;</span>ACCEPT<span class="token operator">&lt;</span>/onMatch<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>onMismatch<span class="token operator">&gt;</span>DENY<span class="token operator">&lt;</span>/onMismatch<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/filter<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/appender<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">!</span>--
    <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"org.springframework.web"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"WARN"</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"org.springframework.boot"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"WARN"</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"springfox.documentation.spring"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"WARN"</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"org.apache.shardingsphere"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"DEBUG"</span> /<span class="token operator">&gt;</span>
  --<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span>-- 开发、测试环境 --<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>springProfile <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"dev,sit,test,uat"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"org.springframework.web"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"INFO"</span>/<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"org.springframework.boot"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"INFO"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"springfox.documentation.spring"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"INFO"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"ShardingSphere-SQL"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"INFO"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"SQLStatement"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"INFO"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"com.alibaba.nacos.client.naming"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"WARN"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"org.apache.shardingsphere.core.route.SQLLogger"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"INFO"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"com.zkj.lawfirm.platform"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"INFO"</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/springProfile<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">!</span>-- 生产环境--<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>springProfile <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"prod"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"org.springframework.web"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"WARN"</span>/<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"org.springframework.boot"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"WARN"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"springfox.documentation.spring"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"WARN"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"org.apache.shardingsphere"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"WARN"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"ShardingSphere-SQL"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"WARN"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"com.alibaba.nacos.client.naming"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"WARN"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"org.apache.shardingsphere.core.route.SQLLogger"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"WARN"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"com.zkj.lawfirm.platform"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"INFO"</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/springProfile<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>root <span class="token assign-left variable">level</span><span class="token operator">=</span><span class="token string">"INFO"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>appender-ref <span class="token assign-left variable">ref</span><span class="token operator">=</span><span class="token string">"CONSOLE"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>appender-ref <span class="token assign-left variable">ref</span><span class="token operator">=</span><span class="token string">"INFO_FILE"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>appender-ref <span class="token assign-left variable">ref</span><span class="token operator">=</span><span class="token string">"WARN_FILE"</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>appender-ref <span class="token assign-left variable">ref</span><span class="token operator">=</span><span class="token string">"ERROR_FILE"</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/root<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>/configuration<span class="token operator">&gt;</span>

</code></pre> 
<p>3、编写一个控制器用来访问测试</p> 
<pre><code class="prism language-bash">package com.eric.springbootlog.demos.web<span class="token punctuation">;</span>

<span class="token function">import</span> lombok.extern.slf4j.Slf4j<span class="token punctuation">;</span>
<span class="token function">import</span> org.springframework.stereotype.Controller<span class="token punctuation">;</span>
<span class="token function">import</span> org.springframework.web.bind.annotation.RequestMapping<span class="token punctuation">;</span>
<span class="token function">import</span> org.springframework.web.bind.annotation.RequestParam<span class="token punctuation">;</span>
<span class="token function">import</span> org.springframework.web.bind.annotation.ResponseBody<span class="token punctuation">;</span>

@Controller
@Slf4j
public class BasicController <span class="token punctuation">{<!-- --></span>

    // http://127.0.0.1:8080/hello?name<span class="token operator">=</span>lisi
    @RequestMapping<span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">)</span>
    @ResponseBody
    public String hello<span class="token punctuation">(</span>@RequestParam<span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"name"</span>, defaultValue <span class="token operator">=</span> <span class="token string">"unknown user"</span><span class="token punctuation">)</span> String name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        log.info<span class="token punctuation">(</span><span class="token string">"我是一条 info 日志"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token builtin class-name">return</span> <span class="token string">"Hello "</span> + name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<br> 
<h3><a id="22_227"></a>2.2、日志记录到文件中</h3> 
<p>此时我们启动项目，发现项目根目录会自动生成一个 logs 目录，发现日志已经成功记录到文件中了</p> 
<p><img src="https://images2.imgbox.com/46/71/r9uyAACC_o.png" alt="在这里插入图片描述"></p> 
<p>此时我们再访问接口：http://127.0.0.1:8080/hello?name=lisi<br> 发现日志成功打印，并且成功记录到日志文件中</p> 
<p><img src="https://images2.imgbox.com/4d/74/zr9p1Dfx_o.png" alt="在这里插入图片描述"></p> 
<br> 
<h3><a id="23_240"></a>2.3、日志文件自动归档和压缩</h3> 
<p>因为我在配置文件中已经配置好了，此时我们再手动更换下电脑的时间，我这里修改到明天<br> <img src="https://images2.imgbox.com/a7/f6/Znv1CG8X_o.png" alt="在这里插入图片描述"></p> 
<p>此时我们再次访问接口：http://127.0.0.1:8080/hello?name=lisi</p> 
<p><img src="https://images2.imgbox.com/bd/47/fmsyh0AD_o.png" alt="在这里插入图片描述"><br> 发现昨天的日志成功自动归档，并且成为压缩文件了~</p> 
<hr> 
<h2><a id="_256"></a>总结</h2> 
<p>怎么样，是不是特别的方便和简单~</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/33b035bf490a803e185f8d431e6aba45/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">FFmepg视频解码</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/57ee33d451fc55c01f65a65d40114bc6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringBoot整合knife4j（快速入门超详细版）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>