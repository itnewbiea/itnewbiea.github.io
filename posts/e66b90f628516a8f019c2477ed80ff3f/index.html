<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>正则表达式,网上资料收集整理! - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="正则表达式,网上资料收集整理!" />
<meta property="og:description" content="一、正则表达式基础知识
我们先从简单的开始。假设你要搜索一个包含字符“cat”的字符串，搜索用的正则表达式就是“cat”。如果搜索对大小写不敏感，单词“catalog”、“Catherine”、“sophisticated”都可以匹配。也就是说：
1.1句点符号
假设你在玩英文拼字游戏，想要找出三个字母的单词，而且这些单词必须以“t”字母开头，以“n”字母结束。另外，假设有一本英文字典，你可以用正则表达式搜索它的全部内容。要构造出这个正则表达式，你可以使用一个通配符??句点符号“.”。这样，完整的表达式就是“t.n”，它匹配“tan”、“ten”、“tin”和“ton”，还匹配“t#n”、“tpn”甚至“tn”，还有其他许多无意义的组合。这是因为句点符号匹配所有字符，包括空格、Tab字符甚至换行符：
1.2方括号符号
为了解决句点符号匹配范围过于广泛这一问题，你可以在方括号（“[]”）里面指定看来有意义的字符。此时，只有方括号里面指定的字符才参与匹配。也就是说，正则表达式“t[aeio]n”只匹配“tan”、“Ten”、“tin”和“ton”。但“Toon”不匹配，因为在方括号之内你只能匹配单个字符：
1.4表示匹配次数的符号
表一显示了表示匹配次数的符号，这些符号用来确定紧靠该符号左边的符号出现的次数：
* 0次或者多次
&#43; 1次或者多次
? 0次或者1次
{n} 恰好n次
{n,m} 从n次到m次
假设我们要在文本文件中搜索美国的社会安全号码。这个号码的格式是999-99-9999。用来匹配它的正则表达式如图一所示。在正则表达式中，连字符（“-”）有着特殊的意义，它表示一个范围，比如从0到9。因此，匹配社会安全号码中的连字符号时，它的前面要加上一个转义字符“/”。
[0-9]{3}/-[0-9]{2}/-[0-9]{3}
假设进行搜索的时候，你希望连字符号可以出现，也可以不出现??即，999-99-9999和999999999都属于正确的格式。这时，你可以在连字符号后面加上“？”数量限定符号，如图二所示：
[0-9]{3}/-?[0-9]{2}/-?[0-9]{3}
下面我们再来看另外一个例子。美国汽车牌照的一种格式是四个数字加上二个字母。它的正则表达式前面是数字部分“[0-9]{ 4}”，再加上字母部分“[A-Z]{ 2}”。图三显示了完整的正则表达式。
[0-9]{4}[A-Z]{2}
图三：匹配典型的美国汽车牌照号码，如8836KV
1.5“否”符号
“^”符号称为“否”符号。如果用在方括号内，“^”表示不想要匹配的字符。例如，图四的正则表达式匹配所有单词，但以“X”字母开头的单词除外。
[^X][a-Z]&#43; 第一个字符不能是X,后继字符可以是a到Z之间任意字母
1.6圆括号和空白符号
假设要从格式为“June26,1951”的生日日期中提取出月份部分，用来匹配该日期的正则表达式可以如图五所示：
[a-Z]&#43;/s&#43;[0-9]{1,2},/s*[0-0]{4} 月份值第一组 &#43;后面有必需的空格(/s) 月份内的日期 到多两个数字 必要的逗号 可选的空格(/s*) 年份值4位数字
图五：匹配所有MothDD,YYYY格式的日期
新出现的“/s”符号是空白符号，匹配所有的空白字符，包括Tab字符。如果字符串正确匹配，接下来如何提取出月份部分呢？只需在月份周围加上一个圆括号创建一个组，然后用OROAPI（本文后面详细讨论）提取出它的值。修改后的正则表达式如图六所示：
([a-Z]&#43;)/s&#43;[0-9]{1,2},/s*[0-0]{4} 月份值第一组 &#43;后面有必需的空格(/s) 月份内的日期 到多两个数字 必要的逗号 可选的空格(/s*) 年份值4位数字
图六：匹配所有MonthDD,YYYY格式的日期，定义月份值为第一个组
1.7其它符号
为简便起见，你可以使用一些为常见正则表达式创建的快捷符号。如表二所示：
表二：常用符号
符号 等价的正则表达式
/d [0-9]
/D [^0-9]
/w [A-Z0-9]
/W [^A-Z0-9]
/s [/t/n/r/f]
/S [^/t/n/r/f]" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e66b90f628516a8f019c2477ed80ff3f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2006-02-14T13:34:00+08:00" />
<meta property="article:modified_time" content="2006-02-14T13:34:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">正则表达式,网上资料收集整理!</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>一、正则表达式基础知识<br>　　我们先从简单的开始。假设你要搜索一个包含字符“cat”的字符串，搜索用的正则表达式就是“cat”。如果搜索对大小写不敏感，单词“catalog”、“Catherine”、“sophisticated”都可以匹配。也就是说：</p> 
<p>　1.1句点符号<br>　　假设你在玩英文拼字游戏，想要找出三个字母的单词，而且这些单词必须以“t”字母开头，以“n”字母结束。另外，假设有一本英文字典，你可以用正则表达式搜索它的全部内容。要构造出这个正则表达式，你可以使用一个通配符??句点符号“.”。这样，完整的表达式就是“t.n”，它匹配“tan”、“ten”、“tin”和“ton”，还匹配“t#n”、“tpn”甚至“tn”，还有其他许多无意义的组合。这是因为句点符号匹配所有字符，包括空格、Tab字符甚至换行符：<br>  1.2方括号符号<br>　　为了解决句点符号匹配范围过于广泛这一问题，你可以在方括号（“[]”）里面指定看来有意义的字符。此时，只有方括号里面指定的字符才参与匹配。也就是说，正则表达式“t[aeio]n”只匹配“tan”、“Ten”、“tin”和“ton”。但“Toon”不匹配，因为在方括号之内你只能匹配单个字符：<br>  1.4表示匹配次数的符号<br>　　表一显示了表示匹配次数的符号，这些符号用来确定紧靠该符号左边的符号出现的次数：<br> * 0次或者多次<br> + 1次或者多次<br> ? 0次或者1次<br> {n} 恰好n次<br> {n,m} 从n次到m次</p> 
<p> 假设我们要在文本文件中搜索美国的社会安全号码。这个号码的格式是999-99-9999。用来匹配它的正则表达式如图一所示。在正则表达式中，连字符（“-”）有着特殊的意义，它表示一个范围，比如从0到9。因此，匹配社会安全号码中的连字符号时，它的前面要加上一个转义字符“/”。<br> [0-9]{3}/-[0-9]{2}/-[0-9]{3}<br> 假设进行搜索的时候，你希望连字符号可以出现，也可以不出现??即，999-99-9999和999999999都属于正确的格式。这时，你可以在连字符号后面加上“？”数量限定符号，如图二所示：<br> [0-9]{3}/-?[0-9]{2}/-?[0-9]{3}<br> 下面我们再来看另外一个例子。美国汽车牌照的一种格式是四个数字加上二个字母。它的正则表达式前面是数字部分“[0-9]{ 4}”，再加上字母部分“[A-Z]{ 2}”。图三显示了完整的正则表达式。<br> [0-9]{4}[A-Z]{2}<br> 图三：匹配典型的美国汽车牌照号码，如8836KV<br>　1.5“否”符号<br>　　“^”符号称为“否”符号。如果用在方括号内，“^”表示不想要匹配的字符。例如，图四的正则表达式匹配所有单词，但以“X”字母开头的单词除外。<br> [^X][a-Z]+ 第一个字符不能是X,后继字符可以是a到Z之间任意字母<br>  1.6圆括号和空白符号<br>　　假设要从格式为“June26,1951”的生日日期中提取出月份部分，用来匹配该日期的正则表达式可以如图五所示：<br> [a-Z]+/s+[0-9]{1,2},/s*[0-0]{4} 月份值第一组 +后面有必需的空格(/s)  月份内的日期 到多两个数字 必要的逗号 可选的空格(/s*) 年份值4位数字<br> 图五：匹配所有MothDD,YYYY格式的日期<br>　　 新出现的“/s”符号是空白符号，匹配所有的空白字符，包括Tab字符。如果字符串正确匹配，接下来如何提取出月份部分呢？只需在月份周围加上一个圆括号创建一个组，然后用OROAPI（本文后面详细讨论）提取出它的值。修改后的正则表达式如图六所示：<br> ([a-Z]+)/s+[0-9]{1,2},/s*[0-0]{4} 月份值第一组 +后面有必需的空格(/s)  月份内的日期 到多两个数字 必要的逗号 可选的空格(/s*) 年份值4位数字<br> 图六：匹配所有MonthDD,YYYY格式的日期，定义月份值为第一个组<br>  1.7其它符号<br> 为简便起见，你可以使用一些为常见正则表达式创建的快捷符号。如表二所示：<br>　　 表二：常用符号<br>  符号 等价的正则表达式<br>  /d [0-9]<br>  /D [^0-9]<br>  /w [A-Z0-9]<br>  /W [^A-Z0-9]<br>  /s [/t/n/r/f]<br>  /S [^/t/n/r/f]<br>　 例如，在前面社会安全号码的例子中，所有出现“[0-9]”的地方我们都可以使用“/d”。修改后的正则表达式如图七所示：<br> /d{3}/-/d{2}/-/d{4}</p> 
<p><br>正则表达式 regular expression <br>正则表达式 RegExp <br>模式 pattern <br>匹配 Match <br>.NET命名空间： System.Text.RegularExpression </p> 
<p> </p> 
<p> <br>补充： <br>^/d+$　　//匹配非负整数（正整数 + 0） <br>^[0-9]*[1-9][0-9]*$　　//匹配正整数 <br>^((-/d+)|(0+))$　　//匹配非正整数（负整数 + 0） <br>^-[0-9]*[1-9][0-9]*$　　//匹配负整数 <br>^-?/d+$　　　　//匹配整数 <br>^/d+(/./d+)?$　　//匹配非负浮点数（正浮点数 + 0） <br>^(([0-9]+/.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*/.[0-9]+)|([0-9]*[1-9][0-9]*))$　　//匹配正浮点数 <br>^((-/d+(/./d+)?)|(0+(/.0+)?))$　　//匹配非正浮点数（负浮点数 + 0） <br>^(-(([0-9]+/.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*/.[0-9]+)|([0-9]*[1-9][0-9]*)))$　　//匹配负浮点数 <br>^(-?/d+)(/./d+)?$　　//匹配浮点数 <br>^[A-Za-z]+$　　//匹配由26个英文字母组成的字符串 <br>^[A-Z]+$　　//匹配由26个英文字母的大写组成的字符串 <br>^[a-z]+$　　//匹配由26个英文字母的小写组成的字符串 <br>^[A-Za-z0-9]+$　　//匹配由数字和26个英文字母组成的字符串 <br>^/w+$　　//匹配由数字、26个英文字母或者下划线组成的字符串 <br>^[/w-]+(/.[/w-]+)*@[/w-]+(/.[/w-]+)+$　　　　//匹配email地址 <br>^[a-zA-z]+://匹配(/w+(-/w+)*)(/.(/w+(-/w+)*))*(/?/S*)?$　　//匹配url </p> 
<p> <br>利用正则表达式去除字串中重复的字符的算法程序： </p> 
<p>var s="abacabefgeeii" <br>var s1=s.replace(/(.).*/1/g,"$1") <br>var re=new RegExp("["+s1+"]","g") <br>var s2=s.replace(re,"") <br>alert(s1+s2) //结果为：abcefgi <br>=============================== <br>如果var s = "abacabefggeeii" <br>结果就不对了，结果为：abeicfgg <br>正则表达式的能力有限 </p> 
<p> <br>1.确认有效电子邮件格式 <br>下面的代码示例使用静态 Regex.IsMatch 方法验证一个字符串是否为有效电子邮件格式。如果字符串包含一个有效的电子邮件地址，则 IsValidEmail 方法返回 true，否则返回 false，但不采取其他任何操作。您可以使用 IsValidEmail，在应用程序将地址存储在数据库中或显示在 ASP.NET 页中之前，筛选出包含无效字符的电子邮件地址。 </p> 
<p>[Visual Basic] <br>Function IsValidEmail(strIn As String) As Boolean <br>' Return true if strIn is in valid e-mail format. <br>Return Regex.IsMatch(strIn, ("^([/w-/.]+)@((/[[0-9]{1,3}/.[0-9]{1,3}/.[0-9]{1,3}/.)|(([/w-]+/.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(/]?)$") <br>End Function <br>[C#] <br>bool IsValidEmail(string strIn) <br>{ <br>// Return true if strIn is in valid e-mail format. <br>return Regex.IsMatch(strIn, @"^([/w-/.]+)@((/[[0-9]{1,3}/.[0-9]{1,3}/.[0-9]{1,3}/.)|(([/w-]+/.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(/]?)$"); <br>} </p> 
<p><br>2.清理输入字符串 <br>下面的代码示例使用静态 Regex.Replace 方法从字符串中抽出无效字符。您可以使用这里定义的 CleanInput 方法，清除掉在接受用户输入的窗体的文本字段中输入的可能有害的字符。CleanInput 在清除掉除 @、-（连字符）和 .（句点）以外的所有非字母数字字符后返回一个字符串。 </p> 
<p>[Visual Basic] <br>Function CleanInput(strIn As String) As String <br>' Replace invalid characters with empty strings. <br>Return Regex.Replace(strIn, "[^/w/.@-]", "") <br>End Function <br>[C#] <br>String CleanInput(string strIn) <br>{ <br>// Replace invalid characters with empty strings. <br>return Regex.Replace(strIn, @"[^/w/.@-]", ""); <br>} </p> 
<p><br>3.更改日期格式 <br>以下代码示例使用 Regex.Replace 方法来用 dd-mm-yy 的日期形式代替 mm/dd/yy 的日期形式。 </p> 
<p>[Visual Basic] <br>Function MDYToDMY(input As String) As String <br>Return Regex.Replace(input, _ <br>"/b(?&lt;month&gt;/d{1,2})/(?&lt;day&gt;/d{1,2})/(?&lt;year&gt;/d{2,4})/b", _ <br>"${day}-${month}-${year}") <br>End Function <br>[C#] <br>String MDYToDMY(String input) <br>{ <br>return Regex.Replace(input, <br>"<a rel="nofollow">//b(?&lt;month&gt;//d{1,2})/(?&lt;day&gt;//d{1,2})/(?&lt;year&gt;//d{2,4})//b</a>", <br>"${day}-${month}-${year}"); <br>} <br>Regex 替换模式 <br>本示例说明如何在 Regex.Replace 的替换模式中使用命名的反向引用。其中，替换表达式 ${day} 插入由 (?&lt;day&gt;...) 组捕获的子字符串。 </p> 
<p>有几种静态函数使您可以在使用正则表达式操作时无需创建显式正则表达式对象，而 Regex.Replace 函数正是其中之一。如果您不想保留编译的正则表达式，这将给您带来方便 </p> 
<p><br>4.提取 URL 信息 <br>以下代码示例使用 Match.Result 来从 URL 提取协议和端口号。例如，“http://www.contoso.com:8080/letters/readme.html”将返回“http:8080”。 </p> 
<p>[Visual Basic] <br>Function Extension(url As String) As String <br>Dim r As New Regex("^(?&lt;proto&gt;/w+)://[^/]+?(?&lt;port&gt;:/d+)?/", _ <br>RegexOptions.Compiled) <br>Return r.Match(url).Result("${proto}${port}") <br>End Function <br>[C#] <br>String Extension(String url) <br>{ <br>Regex r = new Regex(@"^(?&lt;proto&gt;/w+)://[^/]+?(?&lt;port&gt;:/d+)?/", <br>RegexOptions.Compiled); <br>return r.Match(url).Result("${proto}${port}"); <br>} </p> 
<p> </p> 
<p>/*------------------------ <br>功能：替换任何空白字符 <br>-------------------------*/ <br>function TrimString (strVal) <br>{ <br>strTmp = strVal + ""; <br>if (strTmp.length == 0) <br>return (strTmp); <br>reVal = /^/s*/; <br>strTmp = strTmp.replace (reVal, ''); <br>reVal = //s*$/; <br>return (strTmp.replace (reVal, '')); <br>} </p> 
<p>/*------------------------ <br>功能：检测是否是有效数字 <br>-------------------------*/ <br>function Check_Num( num ) <br>{ <br>num = ( TrimString( num ) ); <br>if (num.length == 0) <br>return (false); <br>return ( Number( num ) ); <br>} </p> 
<p>/*------------------------ <br>功能：检测是否是有效日期 <br>-------------------------*/ <br>function Check_Date (strDate) <br>{ <br>strDate = (TrimString (strDate)); <br>if (strDate.length == 0) <br>return (false); <br>reVal = /^([1-2]/d{3})[//|/-](0?[1-9]|10|11|12)[//|/-]([1-2]?[0-9]|0[1-9]|30|31)$/; <br>return (reVal.test (strDate)); <br>} </p> 
<p>/*------------------------ <br>功能：检测是否是有效Email <br>-------------------------*/ <br>function Check_Email (strEmail) <br>{ <br>strEmail = (TrimString (strEmail)); <br>if (strEmail.length == 0) <br>return (false); </p> 
<p>reVal = /^[/-!#/$%&amp;'/*/+///.//0-9=/?A-Z/^_`a-z{|}~]+@[/-!#/$%&amp;'/*/+///.//0-9=/?A-Z/^_`a-z{|}~]+(/.[/-!#/$%&amp;'/*/+///.//0-9=/?A-Z/^_`a-z{|}~]+)+$/; <br>return (reVal.test (strEmail)); <br>} </p> 
<p>/*------------------------ <br>功能：检测是否是有效时间 <br>-------------------------*/ <br>function Check_Time (strTime) <br>{ <br>strTime = (TrimString (strTime)); <br>if (strTime.length == 0) <br>return (false); </p> 
<p>reVal = /^(([0-9]|[01][0-9]|2[0-3])(:([0-9]|[0-5][0-9])){0,2}|(0?[0-9]|1[0-1])(:([0-9]|[0-5][0-9])){0,2}/s?[aApP][mM])?$/; <br>return (reVal.test (strTime)); <br>} </p> 
<p>/*------------------------ <br>功能：检测是否是有效日期特定格式 <br>-------------------------*/ <br>function Check_Date_1 (strDate) <br>{ <br>strDate = (TrimString (strDate)); <br>if (strDate.length == 0) <br>return (false); <br>reVal = /^([1-2]/d{3})[//](0?[1-9]|10|11|12)[//]([1-2]?[0-9]|0[1-9]|30|31)$/; <br>return (reVal.test (strDate)); <br>} </p> 
<p>/*------------------------ <br>功能：检测是否是有效日期特定格式 <br>-------------------------*/ <br>function Check_Date_2 (strDate) <br>{ <br>strDate = (TrimString (strDate)); <br>if (strDate.length == 0) <br>return (false); <br>reVal = /^([1-2]/d{3})[/-](0[1-9]|10|11|12)[/-]([1-2][0-9]|0[1-9]|30|31)$/; <br>return (reVal.test (strDate)); <br>} </p> 
<p>/*-------------------------------------- <br>功能：换行定行 <br>---------------------------------------*/ <br>function enter( form, temp ) <br>{ <br>if ( window.event.keyCode == 13 ) <br>{ <br>eval( form + temp + ".focus()" ); <br>eval( form + temp + ".select()" ); <br>} <br>else <br>return (false); <br>} </p> 
<p>/*-------------------------------------- <br>功能：检查字符串长度 <br>---------------------------------------*/ <br>function ByteString (strVal) <br>{ <br>nLen = 0; </p> 
<p>for (i = 0; i &lt; strVal.length; i ++) <br>{ <br>if (strVal.charCodeAt (i) &gt; 255) <br>nLen += 2; <br>else <br>nLen ++; <br>}; <br>return (nLen); <br>} </p> 
<p>/*-------------------------------------- <br>功能：按要求截取字符串长度 <br>---------------------------------------*/ <br>function SubString(strVal,nStrLen) <br>{ <br>nLen = 0; <br>nTemp = 0; <br>for (i = 0; i &lt; strVal.length; i ++) <br>{ <br>if (strVal.charCodeAt (i) &gt; 255) <br>nLen += 2; <br>else <br>nLen ++; <br>if(nLen &lt;= nStrLen) <br>nTemp = i; <br>else <br>break; <br>}; <br>return(strVal.substr(0,nTemp+1)); <br>} </p> 
<p>/*------------------------ <br>功能：检测密码，密码只能由英文字母、数字、减号、下划线、$、#、*、(和)构成，且首位必须是英文字母 <br>-------------------------*/ <br>function Check_Pass( strPass ) <br>{ <br>strPass = ( TrimString( strPass ) ); <br>if (strPass.length == 0) <br>return (false); <br>reVal = /^[a-zA-Z]{1}[a-zA-Z0-9-_$#*()]{0,29}$/; <br>return ( reVal.test (strPass) ); <br>} </p> 
<p>这是所有的,不过是PHP的,你自己转换一下吧~~ </p> 
<p> </p> 
<p># re: 正则表达式 2005-02-28 00:59 yongsheng <br>^(((19)|(20))/d{2})(((((-|/)0?)|0)[1-9])|((-|/)?1[0-2]))((((((-|/)0?)|0)[1-9])|((-|/)?[1-2][0-9]))|((-|/)?3[0-1]))$ </p> 
<p><br>2004-1-1格式 </p> 
<p># re: 正则表达式 2005-03-07 14:33 yongsheng <br>一、验证类 <br>1、数字验证内 <br>1.1 整数 <br>1.2 大于0的整数 （用于传来的ID的验证) <br>1.3 负整数的验证 <br>1.4 整数不能大于iMax <br>1.5 整数不能小于iMin <br>2、时间类 <br>2.1 短时间，形如 (13:04:06) <br>2.2 短日期，形如 (2003-12-05) <br>2.3 长时间，形如 (2003-12-05 13:04:06) <br>2.4 只有年和月。形如(2003-05,或者2003-5) <br>2.5 只有小时和分钟,形如(12:03) <br>3、表单类 <br>3.1 所有的表单的值都不能为空 <br>3.2 多行文本框的值不能为空。 <br>3.3 多行文本框的值不能超过sMaxStrleng <br>3.4 多行文本框的值不能少于sMixStrleng <br>3.5 判断单选框是否选择。 <br>3.6 判断复选框是否选择. <br>3.7 复选框的全选，多选，全不选，反选 <br>3.8 文件上传过程中判断文件类型 <br>4、字符类 <br>4.1 判断字符全部由a-Z或者是A-Z的字字母组成 <br>4.2 判断字符由字母和数字组成。 <br>4.3 判断字符由字母和数字，下划线,点号组成.且开头的只能是下划线和字母 <br>4.4 字符串替换函数.Replace(); <br>5、浏览器类 <br>5.1 判断浏览器的类型 <br>5.2 判断ie的版本 <br>5.3 判断客户端的分辨率 </p> 
<p>6、结合类 <br>6.1 email的判断。 <br>6.2 手机号码的验证 <br>6.3 身份证的验证 </p> 
<p><br>二、功能类 </p> 
<p>1、时间与相关控件类 <br>1.1 日历 <br>1.2 时间控件 <br>1.3 万年历 <br>1.4 显示动态显示时钟效果（文本，如OA中时间） <br>1.5 显示动态显示时钟效果 (图像，像手表) <br>2、表单类 <br>2.1 自动生成表单 <br>2.2 动态添加，修改，删除下拉框中的元素 <br>2.3 可以输入内容的下拉框 <br>2.4 多行文本框中只能输入iMax文字。如果多输入了，自动减少到iMax个文字（多用于短信发送) </p> 
<p>3、打印类 <br>3.1 打印控件 <br>4、事件类 <br>4.1 屏蔽右键 <br>4.2 屏蔽所有功能键 <br>4.3 --&gt; 和&lt;-- F5 F11,F9,F1 <br>4.4 屏蔽组合键ctrl+N <br>5、网页设计类 <br>5.1 连续滚动的文字，图片（注意是连续的，两段文字和图片中没有空白出现） <br>5.2 html编辑控件类 <br>5.3 颜色选取框控件 <br>5.4 下拉菜单 <br>5.5 两层或多层次的下拉菜单 <br>5.6 仿IE菜单的按钮。（效果如rongshuxa.com的导航栏目) <br>5.7 状态栏，title栏的动态效果（例子很多，可以研究一下） <br>5.8 双击后，网页自动滚屏 <br>6、树型结构。 <br>6.1 asp+SQL版 <br>6.2 asp+xml+sql版 <br>6.3 java+sql或者java+sql+xml <br>7、无边框效果的制作 <br>8、连动下拉框技术 <br>9、文本排序 </p> 
<p><br>一、验证类 <br>1、数字验证内 <br>1.1 整数 <br>/^(-|/+)?/d+$/.test(str) <br>1.2 大于0的整数 （用于传来的ID的验证) <br>/^/d+$/.test(str) <br>1.3 负整数的验证 <br>/^-/d+$/.test(str) <br>2、时间类 <br>2.1 短时间，形如 (13:04:06) <br>function isTime(str) <br>{ <br>var a = str.match(/^(/d{1,2})(:)?(/d{1,2})/2(/d{1,2})$/); <br>if (a == null) {alert('输入的参数不是时间格式'); return false;} <br>if (a[1]&gt;24 || a[3]&gt;60 || a[4]&gt;60) <br>{ <br>alert("时间格式不对"); <br>return false <br>} <br>return true; <br>} <br>2.2 短日期，形如 (2003-12-05) <br>function strDateTime(str) <br>{ <br>var r = str.match(/^(/d{1,4})(-|//)(/d{1,2})/2(/d{1,2})$/); <br>if(r==null)return false; <br>var d= new Date(r[1], r[3]-1, r[4]); <br>return (d.getFullYear()==r[1]&amp;&amp;(d.getMonth()+1)==r[3]&amp;&amp;d.getDate()==r[4]); <br>} <br>2.3 长时间，形如 (2003-12-05 13:04:06) <br>function strDateTime(str) <br>{ <br>var reg = /^(/d{1,4})(-|//)(/d{1,2})/2(/d{1,2}) (/d{1,2}):(/d{1,2}):(/d{1,2})$/; <br>var r = str.match(reg); <br>if(r==null)return false; <br>var d= new Date(r[1], r[3]-1,r[4],r[5],r[6],r[7]); <br>return (d.getFullYear()==r[1]&amp;&amp;(d.getMonth()+1)==r[3]&amp;&amp;d.getDate()==r[4]&amp;&amp;d.getHours()==r[5]&amp;&amp;d.getMinutes()==r[6]&amp;&amp;d.getSeconds()==r[7]); <br>} <br>2.4 只有年和月。形如(2003-05,或者2003-5) <br>2.5 只有小时和分钟,形如(12:03) <br>3、表单类 <br>3.1 所有的表单的值都不能为空 <br>&lt;input οnblur="if(this.value.replace(/^/s+|/s+$/g,'')=='')alert('不能为空!')"&gt; <br>3.2 多行文本框的值不能为空。 <br>3.3 多行文本框的值不能超过sMaxStrleng <br>3.4 多行文本框的值不能少于sMixStrleng <br>3.5 判断单选框是否选择。 <br>3.6 判断复选框是否选择. <br>3.7 复选框的全选，多选，全不选，反选 <br>3.8 文件上传过程中判断文件类型 <br>4、字符类 <br>4.1 判断字符全部由a-Z或者是A-Z的字字母组成 <br>&lt;input οnblur="if(/[^a-zA-Z]/g.test(this.value))alert('有错')"&gt; <br>4.2 判断字符由字母和数字组成。 <br>&lt;input οnblur="if(/[^0-9a-zA-Z]/g.test(this.value))alert('有错')"&gt; <br>4.3 判断字符由字母和数字，下划线,点号组成.且开头的只能是下划线和字母 <br>/^([a-zA-z_]{1})([/w]*)$/g.test(str) <br>4.4 字符串替换函数.Replace(); <br>5、浏览器类 <br>5.1 判断浏览器的类型 <br>window.navigator.appName <br>5.2 判断ie的版本 <br>window.navigator.appVersion <br>5.3 判断客户端的分辨率 <br>window.screen.height; window.screen.width; </p> 
<p>6、结合类 <br>6.1 email的判断。 <br>function ismail(mail) <br>{ <br>return(new RegExp(/^/w+((-/w+)|(/./w+))*/@[A-Za-z0-9]+((/.|-)[A-Za-z0-9]+)*/.[A-Za-z0-9]+$/).test(mail)); <br>} <br>6.2 手机号码的验证 <br>6.3 身份证的验证 <br>function isIdCardNo(num) <br>{ <br>if (isNaN(num)) {alert("输入的不是数字！"); return false;} <br>var len = num.length, re; <br>if (len == 15) <br>re = new RegExp(/^(/d{6})()?(/d{2})(/d{2})(/d{2})(/d{3})$/); <br>else if (len == 18) <br>re = new RegExp(/^(/d{6})()?(/d{4})(/d{2})(/d{2})(/d{3})(/d)$/); <br>else {alert("输入的数字位数不对！"); return false;} <br>var a = num.match(re); <br>if (a != null) <br>{ <br>if (len==15) <br>{ <br>var D = new Date("19"+a[3]+"/"+a[4]+"/"+a[5]); <br>var B = D.getYear()==a[3]&amp;&amp;(D.getMonth()+1)==a[4]&amp;&amp;D.getDate()==a[5]; <br>} <br>else <br>{ <br>var D = new Date(a[3]+"/"+a[4]+"/"+a[5]); <br>var B = D.getFullYear()==a[3]&amp;&amp;(D.getMonth()+1)==a[4]&amp;&amp;D.getDate()==a[5]; <br>} <br>if (!B) {alert("输入的身份证号 "+ a[0] +" 里出生日期不对！"); return false;} <br>} <br>return true; <br>} </p> 
<p>3.7 复选框的全选，多选，全不选，反选 <br>&lt;form name=hrong&gt; <br>&lt;input type=checkbox name=All οnclick="checkAll('mm')"&gt;全选&lt;br/&gt; <br>&lt;input type=checkbox name=mm οnclick="checkItem('All')"&gt;&lt;br/&gt; <br>&lt;input type=checkbox name=mm οnclick="checkItem('All')"&gt;&lt;br/&gt; <br>&lt;input type=checkbox name=mm οnclick="checkItem('All')"&gt;&lt;br/&gt; <br>&lt;input type=checkbox name=mm οnclick="checkItem('All')"&gt;&lt;br/&gt; <br>&lt;input type=checkbox name=mm οnclick="checkItem('All')"&gt;&lt;br/&gt;&lt;br/&gt; </p> 
<p><br>&lt;input type=checkbox name=All2 οnclick="checkAll('mm2')"&gt;全选&lt;br/&gt; <br>&lt;input type=checkbox name=mm2 οnclick="checkItem('All2')"&gt;&lt;br/&gt; <br>&lt;input type=checkbox name=mm2 οnclick="checkItem('All2')"&gt;&lt;br/&gt; <br>&lt;input type=checkbox name=mm2 οnclick="checkItem('All2')"&gt;&lt;br/&gt; <br>&lt;input type=checkbox name=mm2 οnclick="checkItem('All2')"&gt;&lt;br/&gt; <br>&lt;input type=checkbox name=mm2 οnclick="checkItem('All2')"&gt;&lt;br/&gt; </p> 
<p>&lt;/form&gt; </p> 
<p>&lt;SCRIPT LANGUAGE="JavaScript"&gt; <br>function checkAll(str) <br>{ <br>var a = document.getElementsByName(str); <br>var n = a.length; <br>for (var i=0; i&lt;n; i++) <br>a[i].checked = window.event.srcElement.checked; <br>} <br>function checkItem(str) <br>{ <br>var e = window.event.srcElement; <br>var all = eval("document.hrong."+ str); <br>if (e.checked) <br>{ <br>var a = document.getElementsByName(e.name); <br>all.checked = true; <br>for (var i=0; i&lt;a.length; i++) <br>{ <br>if (!a[i].checked){ all.checked = false; break;} <br>} <br>} <br>else all.checked = false; <br>} <br>&lt;/SCRIPT&gt; </p> 
<p>3.8 文件上传过程中判断文件类型 <br>&lt;input type=file οnchange="alert(this.value.match(/^(.*)(/.)(.{1,8})$/)[3])"&gt; </p> 
<p>画图: <br>&lt;OBJECT <br>id=S <br>style="LEFT: 0px; WIDTH: 392px; TOP: 0px; HEIGHT: 240px" <br>height=240 <br>width=392 <br>classid="clsid:369303C2-D7AC-11D0-89D5-00A0C90833E6"&gt; <br>&lt;/OBJECT&gt; <br>&lt;SCRIPT&gt; <br>S.DrawingSurface.ArcDegrees(0,0,0,30,50,60); <br>S.DrawingSurface.ArcRadians(30,0,0,30,50,60); <br>S.DrawingSurface.Line(10,10,100,100); <br>&lt;/SCRIPT&gt; </p> 
<p>写注册表： <br>&lt;SCRIPT&gt; <br>var WshShell = WScript.CreateObject("WScript.Shell"); <br>WshShell.RegWrite ("HKCU//Software//ACME//FortuneTeller//", 1, "REG_BINARY"); <br>WshShell.RegWrite ("HKCU//Software//ACME//FortuneTeller//MindReader", "Goocher!", "REG_SZ"); <br>var bKey = WshShell.RegRead ("HKCU//Software//ACME//FortuneTeller//"); <br>WScript.Echo (WshShell.RegRead ("HKCU//Software//ACME//FortuneTeller//MindReader")); <br>WshShell.RegDelete ("HKCU//Software//ACME//FortuneTeller//MindReader"); <br>WshShell.RegDelete ("HKCU//Software//ACME//FortuneTeller//"); <br>WshShell.RegDelete ("HKCU//Software//ACME//"); <br>&lt;/SCRIPT&gt; </p> 
<p>TABLAE相关(客户端动态增加行列） <br>&lt;HTML&gt; <br>&lt;SCRIPT LANGUAGE="JScript"&gt; <br>function numberCells() { <br>var count=0; <br>for (i=0; i &lt; document.all.mytable.rows.length; i++) { <br>for (j=0; j &lt; document.all.mytable.rows(i).cells.length; j++) { <br>document.all.mytable.rows(i).cells(j).innerText = count; <br>count++; <br>} <br>} <br>} <br>&lt;/SCRIPT&gt; <br>&lt;BODY οnlοad="numberCells()"&gt; <br>&lt;TABLE id=mytable border=1&gt; <br>&lt;TR&gt;&lt;TH&gt;&amp;nbsp;&lt;/TH&gt;&lt;TH&gt;&amp;nbsp;&lt;/TH&gt;&lt;TH&gt;&amp;nbsp;&lt;/TH&gt;&lt;TH&gt;&amp;nbsp;&lt;/TH&gt;&lt;/TR&gt; <br>&lt;TR&gt;&lt;TD&gt;&amp;nbsp;&lt;/TD&gt;&lt;TD&gt;&amp;nbsp;&lt;/TD&gt;&lt;TD&gt;&amp;nbsp;&lt;/TD&gt;&lt;TD&gt;&amp;nbsp;&lt;/TD&gt;&lt;/TR&gt; <br>&lt;TR&gt;&lt;TD&gt;&amp;nbsp;&lt;/TD&gt;&lt;TD&gt;&amp;nbsp;&lt;/TD&gt;&lt;TD&gt;&amp;nbsp;&lt;/TD&gt;&lt;TD&gt;&amp;nbsp;&lt;/TD&gt;&lt;/TR&gt; <br>&lt;/TABLE&gt; <br>&lt;/BODY&gt; <br>&lt;/HTML&gt; </p> 
<p>１．身份证严格验证： </p> 
<p>&lt;script&gt; <br>var aCity={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"} </p> 
<p>function cidInfo(sId){ <br>var iSum=0 <br>var info="" <br>if(!/^/d{17}(/d|x)$/i.test(sId))return false; <br>sId=sId.replace(/x$/i,"a"); <br>if(aCity[parseInt(sId.substr(0,2))]==null)return "Error:非法地区"; <br>sBirthday=sId.substr(6,4)+"-"+Number(sId.substr(10,2))+"-"+Number(sId.substr(12,2)); <br>var d=new Date(sBirthday.replace(/-/g,"/")) <br>if(sBirthday!=(d.getFullYear()+"-"+ (d.getMonth()+1) + "-" + d.getDate()))return "Error:非法生日"; <br>for(var i = 17;i&gt;=0;i --) iSum += (Math.pow(2,i) % 11) * parseInt(sId.charAt(17 - i),11) <br>if(iSum%11!=1)return "Error:非法证号"; <br>return aCity[parseInt(sId.substr(0,2))]+","+sBirthday+","+(sId.substr(16,1)%2?"男":"女") <br>} </p> 
<p>document.write(cidInfo("380524198002300016"),"&lt;br/&gt;"); <br>document.write(cidInfo("340524198002300019"),"&lt;br/&gt;") <br>document.write(cidInfo("340524197711111111"),"&lt;br/&gt;") <br>document.write(cidInfo("34052419800101001x"),"&lt;br/&gt;"); <br>&lt;/script&gt; </p> 
<p>２．验证ＩＰ地址 <br>&lt;SCRIPT LANGUAGE="JavaScript"&gt; <br>function isip(s){ <br>var check=function(v){try{return (v&lt;=255 &amp;&amp; v&gt;=0)}catch(x){return false}}; <br>var re=s.split(".") <br>return (re.length==4)?(check(re[0]) &amp;&amp; check(re[1]) &amp;&amp; check(re[2]) &amp;&amp; check(re[3])):false <br>} </p> 
<p>var s="202.197.78.129"; <br>alert(isip(s)) <br>&lt;/SCRIPT&gt; </p> 
<p> </p> 
<p>３．加sp1后还能用的无边框窗口！！ <br>&lt;HTML XMLNS:IE&gt; <br>&lt;meta http-equiv="Content-Type" content="text/html; charset=gb2312"&gt; <br>&lt;IE:Download ID="include" STYLE="behavior:url(#default#download)" /&gt; <br>&lt;title&gt;Chromeless Window&lt;/title&gt; </p> 
<p>&lt;SCRIPT LANGUAGE="JScript"&gt; <br>/*--- Special Thanks For andot ---*/ </p> 
<p>/* <br>This following code are designed and writen by Windy_sk &lt;<a href="mailto:seasonx@163.net" rel="nofollow">seasonx@163.net</a>&gt; <br>You can use it freely, but u must held all the copyright items! <br>*/ </p> 
<p>/*--- Thanks For andot Again ---*/ </p> 
<p>var CW_width = 400; <br>var CW_height = 300; <br>var CW_top = 100; <br>var CW_left = 100; <br>var CW_url = "/"; <br>var New_CW = window.createPopup(); <br>var CW_Body = New_CW.document.body; <br>var content = ""; <br>var CSStext = "margin:1px;color:black; border:2px outset;border-style:expression(οnmοuseοut=οnmοuseup=function(){this.style.borderStyle='outset'}, οnmοusedοwn=function(){if(event.button!=2)this.style.borderStyle='inset'});background-color:buttonface;width:16px;height:14px;font-size:12px;line-height:11px;cursor:Default;"; </p> 
<p>//Build Window <br>include.startDownload(CW_url, function(source){content=source}); </p> 
<p>function insert_content(){ <br>var temp = ""; <br>CW_Body.style.overflow = "hidden"; <br>CW_Body.style.backgroundColor = "white"; <br>CW_Body.style.border = "solid black 1px"; <br>content = content.replace(/&lt;a ([^&gt;]*)&gt;/g,"&lt;a οnclick='parent.open(this.href);return false' $1&gt;"); <br>temp += "&lt;table width=100% height=100% cellpadding=0 cellspacing=0 border=0&gt;"; <br>temp += "&lt;tr style=';font-size:12px;background:#0099CC;height:20;cursor:default' οndblclick=/"Max.innerText=Max.innerText=='1'?'2':'1';parent.if_max=!parent.if_max;parent.show_CW();/" οnmοuseup='parent.drag_up(event)' οnmοusemοve='parent.drag_move(event)' οnmοusedοwn='parent.drag_down(event)' onselectstart='return false' οncοntextmenu='return false'&gt;"; <br>temp += "&lt;td style='color:#ffffff;padding-left:5px'&gt;Chromeless Window For IE6 SP1&lt;/td&gt;"; <br>temp += "&lt;td style='color:#ffffff;padding-right:5px;' align=right&gt;"; <br>temp += "&lt;span id=Help οnclick=/"alert('Chromeless Window For IE6 SP1 - Ver 1.0//n//nCode By Windy_sk//n//nSpecial Thanks For andot')/" style=/""+CSStext+"font-family:System;padding-right:2px;/"&gt;?&lt;/span&gt;"; <br>temp += "&lt;span id=Min οnclick='parent.New_CW.hide();parent.blur()' style=/""+CSStext+"font-family:Webdings;/" title='Minimum'&gt;0&lt;/span&gt;"; <br>temp += "&lt;span id=Max οnclick=/"this.innerText=this.innerText=='1'?'2':'1';parent.if_max=!parent.if_max;parent.show_CW();/" style=/""+CSStext+"font-family:Webdings;/" title='Maximum'&gt;1&lt;/span&gt;"; <br>temp += "&lt;span id=Close οnclick='parent.opener=null;parent.close()' style=/""+CSStext+"font-family:System;padding-right:2px;/" title='Close'&gt;x&lt;/span&gt;"; <br>temp += "&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan=2&gt;"; <br>temp += "&lt;div id=include style='overflow:scroll;overflow-x:hidden;overflow-y:auto; HEIGHT: 100%; width:"+CW_width+"'&gt;"; <br>temp += content; <br>temp += "&lt;/div&gt;"; <br>temp += "&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;"; <br>CW_Body.innerHTML = temp; <br>} </p> 
<p>setTimeout("insert_content()",1000); </p> 
<p>var if_max = true; <br>function show_CW(){ <br>window.moveTo(10000, 10000); <br>if(if_max){ <br>New_CW.show(CW_top, CW_left, CW_width, CW_height); <br>if(typeof(New_CW.document.all.include)!="undefined"){ <br>New_CW.document.all.include.style.width = CW_width; <br>New_CW.document.all.Max.innerText = "1"; <br>} </p> 
<p>}else{ <br>New_CW.show(0, 0, screen.width, screen.height); <br>New_CW.document.all.include.style.width = screen.width; <br>} <br>} </p> 
<p>window.onfocus = show_CW; <br>window.onresize = show_CW; </p> 
<p>// Move Window <br>var drag_x,drag_y,draging=false </p> 
<p>function drag_move(e){ <br>if (draging){ <br>New_CW.show(e.screenX-drag_x, e.screenY-drag_y, CW_width, CW_height); <br>return false; <br>} <br>} </p> 
<p>function drag_down(e){ <br>if(e.button==2)return; <br>if(New_CW.document.body.offsetWidth==screen.width &amp;&amp; New_CW.document.body.offsetHeight==screen.height)return; <br>drag_x=e.clientX; <br>drag_y=e.clientY; <br>draging=true; <br>e.srcElement.setCapture(); <br>} </p> 
<p>function drag_up(e){ <br>draging=false; <br>e.srcElement.releaseCapture(); <br>if(New_CW.document.body.offsetWidth==screen.width &amp;&amp; New_CW.document.body.offsetHeight==screen.height) return; <br>CW_top = e.screenX-drag_x; <br>CW_left = e.screenY-drag_y; <br>} </p> 
<p>&lt;/SCRIPT&gt; <br>&lt;/HTML&gt; </p> 
<p>电话号码的验证 </p> 
<p>要求： <br>　　(1)电话号码由数字、"("、")"和"-"构成 <br>　　(2)电话号码为3到8位 <br>　　(3)如果电话号码中包含有区号，那么区号为三位或四位 <br>　　(4)区号用"("、")"或"-"和其他部分隔开 <br>　　(5)移动电话号码为11或12位，如果为12位,那么第一位为0 <br>　　(6)11位移动电话号码的第一位和第二位为"13" <br>　　(7)12位移动电话号码的第二位和第三位为"13" <br>　　根据这几条规则，可以与出以下正则表达式： <br>　　(^[0-9]{3,4}/-[0-9]{3,8}$)|(^[0-9]{3,8}$)|(^/([0-9]{3,4}/)[0-9]{3,8}$)|(^0{0,1}13[0-9]{9}$) </p> 
<p><br>&lt;script language="javascript"&gt; <br>function PhoneCheck(s) { <br>var str=s; <br>var reg=/(^[0-9]{3,4}/-[0-9]{3,8}$)|(^[0-9]{3,8}$)|(^/([0-9]{3,4}/)[0-9]{3,8}$)|(^0{0,1}13[0-9]{9}$)/ <br>alert(reg.test(str)); <br>} <br>&lt;/script&gt; <br>&lt;input type=text name="iphone"&gt; <br>&lt;input type=button οnclick="PhoneCheck(document.all.iphone.value)" value="Check"&gt; </p> 
<p>具有在输入非数字字符不回显的效果，即对非数字字符的输入不作反应。 <br>function numbersonly(field,event){ <br>var key,keychar; <br>if(window.event){ <br>key = window.event.keyCode; <br>} <br>else if (event){ <br>key = event.which; <br>} <br>else{ <br>return true <br>} <br>keychar = String.fromCharCode(key); <br>if((key == null)||(key == 0)||(key == 8)||(key == 9)||(key == 13)||(key == 27)){ <br>return true; <br>} <br>else if(("0123456789.").indexOf(keychar)&gt;-1){ <br>window.status = ""; <br>return true; <br>} <br>else { <br>window.status = "Field excepts numbers only"; <br>return false; <br>} <br>} </p> 
<p>验证ip </p> 
<p>str=document.RegExpDemo.txtIP.value; <br>if(/^(/d{1,3})/.(/d{1,3})/.(/d{1,3})/.(/d{1,3})$/.test(str)==false) <br>{ <br>window.alert('错误的IP地址格式'); <br>document.RegExpDemo.txtIP.select(); <br>document.RegExpDemo.txtIP.focus(); <br>return; <br>} <br>if(RegExp.$1&lt;1 || RegExp.$1&gt;254||RegExp.$2&lt;0||RegExp.$2&gt;254||RegExp.$3&lt;0||RegExp.$3&gt;254||RegExp.$4&lt;1||RegExp.$4&gt;254) <br>{ <br>window.alert('错误的IP地址'); <br>document.RegExpDemo.txtIP.select(); <br>document.RegExpDemo.txtIP.focus(); <br>return; <br>} <br>//剔除 如 010.020.020.03 前面 的0 <br>var str=str.replace(/0(/d)/g,"$1"); <br>str=str.replace(/0(/d)/g,"$1"); <br>window.alert(str); </p> 
<p><br>//一下是取数据的类 <br>//Obj参数指定数据的来源(限定Table),默认第一行为字段名称行 <br>//GetTableData类提供MoveNext方法,参数是表的行向上或向下移动的位数,正数向下移动,负数向上. <br>//GetFieldData方法获得指定的列名的数据 <br>//Sort_desc方法对指定的列按降序排列 <br>//Sort_asc方法对指定的列按升序排列 <br>//GetData方法返回字段值为特定值的数据数组,提供数据,可以在外部进行其他处理 <br>//Delete方法删除当前记录,数组减少一行 <br>//初始化,Obj:table的名字,Leftlen:左面多余数据长度,Rightlen:右面多余数据长度, <br>function GetTableData(Obj,LeftLen,RightLen){ <br>var MyObj=document.all(Obj); <br>var iRow=MyObj.rows.length; <br>var iLen=MyObj.rows[0].cells.length; <br>var i,j; </p> 
<p>TableData=new Array(); <br>for (i=0;i&lt; iRow;i++){ <br>TableData[i]=new Array(); <br>for (j=0;j&lt;iLen;j++){ <br>TableStr=MyObj.rows(i).cells(j).innerText; <br>TableStr=TableStr.substring(LeftLen, TableStr.length-RightLen).Trim(); <br>TableStr=TableStr.replace(/ /gi,"").replace(//r/n/ig,""); <br>TableData[i][j]=TableStr; <br>} <br>} </p> 
<p>this.TableData=TableData; <br>this.cols=this.TableData[0].length; <br>this.rows=this.TableData.length; <br>this.rowindex=0; <br>} </p> 
<p><br>function movenext(Step){ <br>if (this.rowindex&gt;=this.rows){ <br>return <br>} </p> 
<p>if (Step=="" || typeof(Step)=="undefined") { <br>if (this.rowindex&lt;this.rows-1) <br>this.rowindex++; <br>return; </p> 
<p>} <br>else{ <br>if (this.rowindex + Step&lt;=this.rows-1 &amp;&amp; this.rowindex + Step&gt;=0 ){ <br>this.rowindex=this.rowindex + Step; <br>} <br>else <br>{ <br>if (this.rowindex + Step&lt;0){ <br>this.rowindex= 0; <br>return; <br>} <br>if (this.rowindex + Step&gt;this.rows-1){ <br>this.rowindex= this.rows-1; <br>return; <br>} <br>} <br>} <br>} </p> 
<p><br>function getfielddata(Field){ <br>var colindex=-1; <br>var i=0; <br>if (typeof(Field) == "number"){ <br>colindex=Field; <br>} <br>else <br>{ <br>for (i=0;i&lt;this.cols &amp;&amp; this.rowindex&lt;this.rows ;i++){ <br>if (this.TableData[0][i]==Field){ <br>colindex=i; <br>break; <br>} <br>} <br>} <br>if (colindex!=-1) { <br>return this.TableData[this.rowindex][colindex]; <br>} </p> 
<p>} </p> 
<p> </p> 
<p>function sort_desc(){//降序 <br>var colindex=-1; <br>var highindex=-1; <br>desc_array=new Array(); <br>var i,j; <br>for (n=0; n&lt;arguments.length; n++){ <br>Field=arguments[arguments.length-1-n]; <br>for (i=0;i&lt;this.cols;i++){ <br>if (this.TableData[0][i]==Field){ <br>colindex=i; <br>break; <br>} <br>} <br>if ( colindex==-1 ) <br>return; <br>else <br>{ <br>desc_array[0]=this.TableData[0]; <br>for(i=1;i&lt;this.rows;i++){ <br>desc_array[i]=this.TableData[1]; <br>highindex=1; <br>for(j=1;j&lt;this.TableData.length;j++){ <br>if (desc_array[i][colindex]&lt;this.TableData[j][colindex]){ <br>desc_array[i]=this.TableData[j]; <br>highindex=j; <br>} </p> 
<p>} <br>if (highindex!=-1) <br>this.TableData=this.TableData.slice(0,highindex).concat(this.TableData.slice(highindex+1,this.TableData.length)); <br>} <br>} </p> 
<p><br>this.TableData=desc_array; <br>} <br>return; <br>} </p> 
<p> </p> 
<p>function sort_asc(){//升序 <br>var colindex=-1; <br>var highindex=-1; <br>var i,j; <br>for (n=0; n&lt;arguments.length; n++){ <br>asc_array=new Array(); <br>Field=arguments[arguments.length-1-n]; <br>for (i=0;i&lt;this.cols;i++){ <br>if (this.TableData[0][i]==Field){ <br>colindex=i; <br>break; <br>} <br>} <br>if ( colindex==-1 ) <br>return; <br>else <br>{ <br>asc_array[0]=this.TableData[0]; <br>for(i=1;i&lt;this.rows;i++){ <br>asc_array[i]=this.TableData[1]; <br>highindex=1; <br>for(j=1;j&lt;this.TableData.length;j++){//找出最小的列值 <br>if (asc_array[i][colindex]&gt;this.TableData[j][colindex]){ <br>asc_array[i]=this.TableData[j]; <br>highindex=j; </p> 
<p>} </p> 
<p>} <br>if (highindex!=-1) <br>this.TableData=this.TableData.slice(0,highindex).concat(this.TableData.slice(highindex+1,this.TableData.length)); </p> 
<p>} <br>} </p> 
<p><br>this.TableData=asc_array; <br>} <br>return; <br>} </p> 
<p> </p> 
<p>function getData(Field,FieldValue){ <br>var colindex=-1; <br>var i,j; </p> 
<p>GetData=new Array(); <br>if (typeof(Field)=="undefined" || typeof(FieldValue)=="undefined" ){ <br>return this.TableData; <br>} </p> 
<p>for(j=0;j&lt;this.cols;j++){ <br>if (this.TableData[0][j]==Field){ <br>colindex=j; <br>} <br>} <br>if (colindex!=-1){ </p> 
<p>for(i=1;i&lt;this.rows;i++){ <br>if (this.TableData[i][colindex]==FieldValue){ <br>GetData[i]=new Array(); <br>GetData[i]=this.TableData[i]; <br>} <br>} <br>} <br>return GetData; <br>} <br>function DeletE(){ <br>this.TableData=this.TableData.slice(0,this.rowindex).concat(this.TableData.slice(this.rowindex+1,this.TableData.length)); <br>this.rows=this.TableData.length; <br>return; <br>} <br>function updateField(Field,FieldValue){ <br>var colindex=-1; <br>var i=0; <br>if (typeof(Field) == "number"){ <br>colindex=Field; <br>} <br>else <br>{ <br>for (i=0;i&lt;this.cols &amp;&amp; this.rowindex&lt;this.rows ;i++){ <br>if (this.TableData[0][i]==Field){ <br>colindex=i; <br>break; <br>} <br>} <br>} <br>if (colindex!=-1) { <br>this.TableData[this.rowindex][colindex]=FieldValue; <br>} </p> 
<p><br>} <br>function movefirst(){ <br>this.rowindex=0; <br>} <br>function movelast(){ <br>this.rowindex=this.rows-1; <br>} <br>function String.prototype.Trim() {return this.replace(/(^/s*)|(/s*$)/g,"");} <br>GetTableData.prototype.MoveNext = movenext; <br>GetTableData.prototype.GetFieldData = getfielddata; <br>GetTableData.prototype.Sort_asc = sort_asc; <br>GetTableData.prototype.Sort_desc = sort_desc; <br>GetTableData.prototype.GetData = getData; <br>GetTableData.prototype.Delete = DeletE; <br>GetTableData.prototype.UpdateField = updateField; <br>GetTableData.prototype.MoveFirst = movefirst; </p> 
<p>具体的例子：<a href="http://202.119.73.208/NetEAn/com/test/jsprint.htm" rel="nofollow">http://202.119.73.208/NetEAn/com/test/jsprint.htm</a> </p> 
<p>在每个文本框的onblur事件中调用校验代码,并且每个文本框中onKeyDown事件中写一个enter转tab函数 </p> 
<p>//回车键换为tab <br>function enterToTab() <br>{ <br>if(event.srcElement.type != 'button' &amp;&amp; event.srcElement.type != 'textarea' <br>&amp;&amp; event.keyCode == 13) <br>{ <br>event.keyCode = 9; <br>} <br>} </p> 
<p> </p> 
<p>You may find it interesting to take a look at some helpful info about&lt;A HREF="<a href="http://www.2002sogwipo.com/pacific-poker.html%22&gt;%22&gt;http://www.2002sogwipo.com/pacific-poker.html" rel="nofollow">http://www.2002sogwipo.com/pacific-poker.html"&gt;"&gt;http://www.2002sogwipo.com/pacific-poker.html</a>"&gt; pacific poker contact &lt;/A&gt;  pacific poker contact  <a href="http://www.2002sogwipo.com/pacific-poker.html" rel="nofollow">http://www.2002sogwipo.com/pacific-poker.html</a> &lt;A HREF="<a href="http://www.2002sogwipo.com/pacific-poker.html%22&gt;%22&gt;http://www.2002sogwipo.com/pacific-poker.html%22&gt;http://www.2002sogwipo.com/pacific-poker.html&lt;/A" rel="nofollow">http://www.2002sogwipo.com/pacific-poker.html"&gt;"&gt;http://www.2002sogwipo.com/pacific-poker.html"&gt;http://www.2002sogwipo.com/pacific-poker.html&lt;/A</a>&gt; &lt;br/&gt;... Thanks!!!  </p> 
<p>身份证简单验证 <br>正则表达式为： (/d{17}|/d{14})(/d|x|X|y|Y) </p> 
<p><br>身份证简单验证 （18位，15位，尾数为x, y） <br>System.Text.RegularExpressions.Regex rg = new System.Text.RegularExpressions.Regex(@"(^/d{17}|^/d{14})(/d|x|X|y|Y)$"); <br>System.Text.RegularExpressions.Match mc = rg.Match(TextBox1.Text);  <br>if(!mc.Success)  <br>{  <br>Response.Write ("&lt;script&gt;window.alert('身份证 填写不正确！');&lt;/script&gt;"); <br>} </p> 
<p> </p> 
<p><br></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e43ce2751a3892daaec6b7b261d688d8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[转]视频捕捉全教程(vc&#43;vfw)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d2a9f6c8c286919873f2ab29aaad28aa/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java中调用c(c&#43;&#43;)写的dll文件的实现及步骤</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>