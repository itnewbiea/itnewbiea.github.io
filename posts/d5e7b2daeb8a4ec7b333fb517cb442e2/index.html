<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Jsoup解析html某片段的问题 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Jsoup解析html某片段的问题" />
<meta property="og:description" content="案例问题分析解决办法 案例 在使用jsoup解析html中的某部分片段时，有时候会遇到解析不出字段。下面以案例进行讲解。
&lt;tr&gt; &lt;td class=&#39;center&#39;&gt; &lt;font class=&#39;blue&#39;&gt; 北京 &lt;/font&gt; &lt;/td&gt; &lt;td&gt; 36175 &lt;/td&gt; &lt;td&gt; 2.03 &lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td class=&#39;center&#39;&gt; &lt;font class=&#39;blue&#39;&gt; 盐城 &lt;/font&gt; &lt;/td&gt; &lt;td&gt; 5466 &lt;/td&gt; &lt;td&gt; -0.26 &lt;/td&gt; &lt;/tr&gt; 这是一段html中的字段，我在解析该字段时，无法获得其中的信息。如下是解析代码。
//html为带解析的片段 Document document=Jsoup.parse(html); Elements elements=document.select(&#34;tr&#34;); for (Element ele:elements) { String city=ele.select(&#34;td[class=center]&#34;).text(); int price=Integer.parseInt(ele.select(&#34;td&#34;).get(1).text()); double rose=Float.parseFloat(ele.select(&#34;td&#34;).get(2).text())*0.01; System.out.println(city); } 运行程序发现根本没办法获取内容。
问题分析 原来在解析html片段时，Jsoup自动将其补全为html。由于上面的形式是表格里面的一部分内容，所有需要补全。但Jsoup只会添加 信息，而且有可能会把一些信息删除。 如下，为上面html片段，补充的后果。这对解析没有什么帮助。
&lt;html&gt; &lt;head&gt;&lt;/head&gt; &lt;body&gt; &lt;font class=&#34;blue&#34;&gt;北京&lt;/font&gt;361752.03 &lt;font class=&#34;blue&#34;&gt;盐城&lt;/font&gt;5466-0.26 &lt;/body&gt; &lt;/html&gt; 解决办法 将表格对应的标签补齐。
String cc=&#34;&lt;html&gt; &lt;body&gt; &lt;table&gt; &lt;tbody&gt;&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/d5e7b2daeb8a4ec7b333fb517cb442e2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-12-10T10:38:32+08:00" />
<meta property="article:modified_time" content="2016-12-10T10:38:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Jsoup解析html某片段的问题</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <div class="toc"> 
  <ul><li><a href="#%E6%A1%88%E4%BE%8B" rel="nofollow">案例</a></li><li><a href="#%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90" rel="nofollow">问题分析</a></li><li><a href="#%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95" rel="nofollow">解决办法</a></li></ul> 
 </div> 
</div> 
<p></p> 
<h2 id="案例">案例</h2> 
<p>在使用jsoup解析html中的某部分片段时，有时候会遇到解析不出字段。下面以案例进行讲解。</p> 
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">td</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">'center'</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">font</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">'blue'</span>&gt;</span>
            北京
        <span class="hljs-tag">&lt;/<span class="hljs-title">font</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">td</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">td</span>&gt;</span>
        36175
    <span class="hljs-tag">&lt;/<span class="hljs-title">td</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">td</span>&gt;</span>
        2.03
    <span class="hljs-tag">&lt;/<span class="hljs-title">td</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">tr</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">td</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">'center'</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">font</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">'blue'</span>&gt;</span>
            盐城
        <span class="hljs-tag">&lt;/<span class="hljs-title">font</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">td</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">td</span>&gt;</span>
        5466
    <span class="hljs-tag">&lt;/<span class="hljs-title">td</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">td</span>&gt;</span>
        -0.26
    <span class="hljs-tag">&lt;/<span class="hljs-title">td</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">tr</span>&gt;</span></code></pre> 
<p>这是一段html中的字段，我在解析该字段时，无法获得其中的信息。如下是解析代码。</p> 
<pre class="prettyprint"><code class=" hljs avrasm">        //html为带解析的片段
        Document document=Jsoup<span class="hljs-preprocessor">.parse</span>(html)<span class="hljs-comment">;</span>
        Elements elements=document<span class="hljs-preprocessor">.select</span>(<span class="hljs-string">"tr"</span>)<span class="hljs-comment">;</span>
        for (Element ele:elements) {
            String city=ele<span class="hljs-preprocessor">.select</span>(<span class="hljs-string">"td[class=center]"</span>)<span class="hljs-preprocessor">.text</span>()<span class="hljs-comment">;</span>
            int price=Integer<span class="hljs-preprocessor">.parseInt</span>(ele<span class="hljs-preprocessor">.select</span>(<span class="hljs-string">"td"</span>)<span class="hljs-preprocessor">.get</span>(<span class="hljs-number">1</span>)<span class="hljs-preprocessor">.text</span>())<span class="hljs-comment">;</span>
            double rose=Float<span class="hljs-preprocessor">.parseFloat</span>(ele<span class="hljs-preprocessor">.select</span>(<span class="hljs-string">"td"</span>)<span class="hljs-preprocessor">.get</span>(<span class="hljs-number">2</span>)<span class="hljs-preprocessor">.text</span>())*<span class="hljs-number">0.01</span><span class="hljs-comment">;</span>
            System<span class="hljs-preprocessor">.out</span><span class="hljs-preprocessor">.println</span>(city)<span class="hljs-comment">;</span>
        }</code></pre> 
<p>运行程序发现根本没办法获取内容。</p> 
<h2 id="问题分析">问题分析</h2> 
<p>原来在解析html片段时，Jsoup自动将其补全为html。由于上面的形式是表格里面的一部分内容，所有需要补全。但Jsoup只会添加 信息，而且有可能会把一些信息删除。 <br> 如下，为上面html片段，补充的后果。这对解析没有什么帮助。</p> 
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">font</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"blue"</span>&gt;</span>北京<span class="hljs-tag">&lt;/<span class="hljs-title">font</span>&gt;</span>361752.03
  <span class="hljs-tag">&lt;<span class="hljs-title">font</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"blue"</span>&gt;</span>盐城<span class="hljs-tag">&lt;/<span class="hljs-title">font</span>&gt;</span>5466-0.26
 <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span></code></pre> 
<h2 id="解决办法">解决办法</h2> 
<p><strong>将表格对应的标签补齐。</strong></p> 
<pre class="prettyprint"><code class=" hljs avrasm">String cc=<span class="hljs-string">"&lt;html&gt;  &lt;body&gt; &lt;table&gt; &lt;tbody&gt;"</span>+html<span class="hljs-preprocessor">.replace</span>(<span class="hljs-string">"{\"data\":\""</span>, <span class="hljs-string">""</span>)<span class="hljs-preprocessor">.replace</span>(<span class="hljs-string">"\"}"</span>, <span class="hljs-string">""</span>)+<span class="hljs-string">"&lt;/tbody&gt; &lt;/table&gt; &lt;/body&gt; &lt;/html&gt;"</span><span class="hljs-comment">;</span>
        Document document=Jsoup<span class="hljs-preprocessor">.parse</span>(cc)<span class="hljs-comment">;</span>
        Elements elements=document<span class="hljs-preprocessor">.select</span>(<span class="hljs-string">"tr"</span>)<span class="hljs-comment">;</span>
        System<span class="hljs-preprocessor">.out</span><span class="hljs-preprocessor">.println</span>(document)<span class="hljs-comment">;</span>
        for (Element ele:elements) {
            String city=ele<span class="hljs-preprocessor">.select</span>(<span class="hljs-string">"td[class=center]"</span>)<span class="hljs-preprocessor">.text</span>()<span class="hljs-comment">;</span>
            int price=Integer<span class="hljs-preprocessor">.parseInt</span>(ele<span class="hljs-preprocessor">.select</span>(<span class="hljs-string">"td"</span>)<span class="hljs-preprocessor">.get</span>(<span class="hljs-number">1</span>)<span class="hljs-preprocessor">.text</span>())<span class="hljs-comment">;</span>
            double rose=Float<span class="hljs-preprocessor">.parseFloat</span>(ele<span class="hljs-preprocessor">.select</span>(<span class="hljs-string">"td"</span>)<span class="hljs-preprocessor">.get</span>(<span class="hljs-number">2</span>)<span class="hljs-preprocessor">.text</span>())*<span class="hljs-number">0.01</span><span class="hljs-comment">;</span>
            System<span class="hljs-preprocessor">.out</span><span class="hljs-preprocessor">.println</span>(city)<span class="hljs-comment">;</span>
        }</code></pre> 
<p>这就没问题，成功解决。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3f988ad17ecfb25ce8098d8e781f90cc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[python] argparse — 命令行选项、参数和子命令的解析器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b65586ecd598638c7d6297631ed22689/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">使用J-Link烧写一U-boot的烧写&#43;裸板程序烧写（JZ2440-S3C2440）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>