<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>面试官：如何用Excel进行预测分析？这操作绝了！ - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="面试官：如何用Excel进行预测分析？这操作绝了！" />
<meta property="og:description" content="【面试题】
一个社交APP, 它的新增用户次日留存、7日留存、30日留存分别是52%、25%、14%。
请模拟出来，每天如果日新增6万用户，那么第30天，它的日活数会达到多少？请使用Excel进行分析。
【分析思路】
第1日(次日)留存用户数=第1日新增用户数*次日留存率
第2日活跃用户数=第2日新增用户数&#43;第1日留存用户数
第3日活跃用户数=第3日新增用户数&#43;第2日留存用户数（第2日新增用户数*第2日留存率）&#43;第1日留存用户数
...
第30日活跃用户数=第30日新增用户数&#43;第29日留存用户数&#43;第28日留存用户数&#43;...&#43;第1日留存用户数
也就是，
第30日活跃用户数=1-29日每天的留存用户数（第1日留存用户数&#43;第2日留存用户数&#43;...&#43;第29日留存用户数）&#43;第30日新增用户数
现在只需要计算出1-29日每天的留存用户数就可以了，而第N日的留存用户数=第N日新增用户数（6万）*第N日留存率。所以现在的问题是需要知道每天的留存率是多少。
那么，问题就来了。题目只有3个留存率（新增用户次日留存、7日留存、30日留存分别是52%、25%、14%）。
如何根据已有的几个留存率去预测剩下那些天的留存率呢？
很简单，用excel 1分钟就能搞定。
1.用现有的数据做散点图
2.对散点图添加趋势线
趋势线有以下几种类型，应该添加哪一类型的趋势线呢？
一般来说，正常的留存曲线是一开始快速下降，然后开始缓慢下降，最后逐步平稳的曲线。
所以，留存曲线的形状会类似于下图：初始在震荡期快速下降；选择期开始缓慢下降；过了选择期就是平稳期，留存率会进入一个相对稳定的阶段。
这种留存曲线的形状和乘幂函数十分接近，所以，在这里我们用乘幂函数来对留存曲线进行拟合。同时勾选“显示公式”和“显示R平方值”。最终得到了如下曲线，函数公式为y = 0.5227x^-0.385，R² = 0.9997，可以看到拟合后的幂函数的形状和上图的留存曲线的形状几乎一样。
拓展：
你肯定想知道这个趋势线的可靠性有多大？
这就涉及到趋势线的 R 平方值。R 平方值是介于 0 和 1 之间的数值。当趋势线的 R 平方值为 1 或者接近 1 时，趋势线最可靠。如案例演示中，R的平方值达到了0.9997，因此可以说这条趋势线可靠性非常大。
要获得最精确的预测，为数据选择最合适的趋势线非常重要。
那么，什么情况下选用什么样的趋势线呢？
指数：指数趋势线适用于速度增加越来越快的数据。
线性：线性趋势线是适用于简单线性数据集合的最佳拟合直线。如果数据点的构成的趋势接近于一条直线，则数据应该接近于线性。线性趋势线通常表示事件以恒定的比率增加或减少。
对数：如果数据一开始的增加或减小的速度很快，但又迅速趋于平稳，那么对数趋势线则是最佳的拟合曲线。
多项式:多项式趋势线是数据波动较大时使用的曲线。
乘幂：乘幂趋势线是一种适用于以特定速度增加的曲线。但是如果数据中有零或负数，则无法创建乘幂趋势线。
移动平均：移动平均趋势线用于平滑处理数据中的微小波动，从而更加清晰地显示了数据的变化的趋势。（在股票、基金、汇率等技术分析中常用）
3.计算第n天留存率
拟合出留存曲线后， 我们就可以根据拟合的函数公式（y = 0.5227x^-0.385）去计算次日到30日的留存率。
也就是把x=1,x=2…x=30,分别代入函数公式，这里可以借助Excel的power幂函数，求出结果。如下图，可以看到按照模型函数公式计算出来的留存率，即模型留存率与给定的留存率几乎完全一致（黄色的行）。
4.计算30天后日活数
通过上面的步骤，我们已经得到了每天的留存率。接下来我们就可以计算第30天的日活用户数有多少。
第1日(次日)留存用户数=第1日新增用户数*次日留存率
第2日活跃用户数=第2日新增用户数&#43;第1日留存用户数
第3日活跃用户数=第3日新增用户数&#43;第2日留存用户数（第2日新增用户数*第2日留存率）&#43;第1日留存用户数
...
第30日活跃用户数=第30日新增用户数&#43;第29日留存用户数&#43;第28日留存用户数&#43;...&#43;第1日留存用户数
也就是，
第30日活跃用户数=1-29日每天的留存用户数（第1日留存用户数&#43;第2日留存用户数&#43;...&#43;第29日留存用户数）&#43;第30日新增用户数
（1）在下图Excel步骤1的地方是题目的设定，每天固定新增用户数为6万
在下图步骤2的地方算出1-29日每天的留存用户数，也就是第N日新增用户数（6万）*第N日留存率（F列对应的留存率）。
（3）下图步骤3将这一列的值求和，就是第30日活跃用户数=1日-29日每天的留存用户数&#43;第30日新增用户数。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/9919f4cd9da6480f6ebf5887de016fff/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-04T20:00:05+08:00" />
<meta property="article:modified_time" content="2023-01-04T20:00:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">面试官：如何用Excel进行预测分析？这操作绝了！</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p style="text-align:left;"><strong><img height="370" title="点击查看图片来源" src="https://images2.imgbox.com/11/38/ds3jUPcg_o.jpg" alt="144d794ca63c7d05f81aabcd7d40c929.jpeg"></strong></p> 
 <p style="text-align:left;"><strong>【面试题】</strong><br></p> 
 <p style="text-align:left;">一个社交APP, 它的新增用户次日留存、7日留存、30日留存分别是52%、25%、14%。</p> 
 <p style="text-align:left;">请模拟出来，<strong>每天如果日新增6万用户</strong>，那么第30天，它的日活数会达到多少？请使用Excel进行分析。</p> 
 <p style="text-align:left;"><strong>【分析思路】</strong></p> 
 <p>第1日(次日)留存用户数=第1日新增用户数*次日留存率</p> 
 <p>第2日活跃用户数=第2日新增用户数+第1日留存用户数<br></p> 
 <p>第3日活跃用户数=第3日新增用户数+第2日留存用户数（第2日新增用户数*第2日留存率）+第1日留存用户数</p> 
 <p>...</p> 
 <p>第30日活跃用户数=<strong>第30日新增用户数</strong>+第29日留存用户数+第28日留存用户数+...+第1日留存用户数</p> 
 <p>也就是，</p> 
 <p>第30日活跃用户数=<strong>1-29日每天的留存用户数</strong>（第1日留存用户数+第2日留存用户数+...+第29日留存用户数）+<strong>第30日新增用户数</strong></p> 
 <p>现在只需要计算出1-29日每天的留存用户数就可以了，而第N日的留存用户数=第N日新增用户数（6万）*第N日留存率。所以现在的问题是需要知道每天的留存率是多少。</p> 
 <p>那么，问题就来了。题目只有3个留存率（新增用户次日留存、7日留存、30日留存分别是52%、25%、14%）。</p> 
 <p><strong>如何根据已有的几个留存率去预测剩下那些天的留存率呢？</strong></p> 
 <p>很简单，用excel 1分钟就能搞定。</p> 
 <p><strong>1.用现有的数据做散点图</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/ca/84/v7Vxv0hE_o.png" alt="f766305c1dd920393bc1a3905e7d276f.png"></p> 
 <p><strong>2.对散点图添加趋势线</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/f9/65/tfdmI82f_o.png" alt="cd3ecd7c3251eb379e2855867f59a87b.png"></p> 
 <p>趋势线有以下几种类型，应该添加哪一类型的趋势线呢？</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/5f/6f/MisJYX9q_o.png" alt="bc7e5af105996eba591c39a29d4b7d0e.png"></p> 
 <p>一般来说，正常的留存曲线是一开始快速下降，然后开始缓慢下降，最后逐步平稳的曲线。</p> 
 <p>所以，留存曲线的形状会类似于下图：初始在震荡期快速下降；选择期开始缓慢下降；过了选择期就是平稳期，留存率会进入一个相对稳定的阶段。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/80/f5/3vDcUAxM_o.png" alt="90d2fa6e7e83af7111bb0fac3b14886f.png"></p> 
 <p>这种留存曲线的形状和乘幂函数十分接近，所以，在这里我们用<strong>乘</strong><strong>幂函数</strong>来对留存曲线进行拟合。同时勾选<strong>“显示公式”和“显示R平方值”</strong>。最终得到了如下曲线，函数公式为y = 0.5227x^-0.385，R² = 0.9997，可以看到拟合后的幂函数的形状和上图的留存曲线的形状几乎一样。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/26/1a/GngrPiOv_o.png" alt="36c35dcc311e9f7a9ea7c30eba0ed5d2.png"></p> 
 <p><strong>拓展：</strong><br></p> 
 <p>你肯定想知道这个趋势线的可靠性有多大？</p> 
 <p>这就涉及到趋势线的 R 平方值。R 平方值是介于 0 和 1 之间的数值。<strong>当趋势线的 R 平方值为 1 或者接近 1 时，趋势线最可靠。</strong>如案例演示中，R的平方值达到了0.9997，因此可以说这条趋势线可靠性非常大。</p> 
 <p>要获得最精确的预测，为数据选择最合适的趋势线非常重要。</p> 
 <p>那么，什么情况下选用什么样的趋势线呢？</p> 
 <p><strong>指数：</strong>指数趋势线适用于速度增加越来越快的数据。</p> 
 <p><strong>线性：</strong>线性趋势线是适用于简单线性数据集合的最佳拟合直线。如果数据点的构成的趋势接近于一条直线，则数据应该接近于线性。线性趋势线通常表示事件以恒定的比率增加或减少。</p> 
 <p><strong>对数：</strong>如果数据一开始的增加或减小的速度很快，但又迅速趋于平稳，那么对数趋势线则是最佳的拟合曲线。</p> 
 <p><strong>多项式:</strong>多项式趋势线是数据波动较大时使用的曲线。</p> 
 <p><strong>乘幂：</strong>乘幂趋势线是一种适用于以特定速度增加的曲线。但是如果数据中有零或负数，则无法创建乘幂趋势线。</p> 
 <p><strong>移动平均：</strong>移动平均趋势线用于平滑处理数据中的微小波动，从而更加清晰地显示了数据的变化的趋势。（在股票、基金、汇率等技术分析中常用）</p> 
 <p><strong>3.计算第n天留存率</strong></p> 
 <p>拟合出留存曲线后， 我们就可以根据拟合的函数公式（y = 0.5227x^-0.385）去计算次日到30日的留存率。</p> 
 <p>也就是把x=1,x=2…x=30,分别代入函数公式，这里可以借助Excel的<strong>power幂函数</strong>，求出结果。如下图，可以看到按照模型函数公式计算出来的留存率，即模型留存率与给定的留存率几乎完全一致（黄色的行）。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/c9/67/ClhLxMy6_o.png" alt="7ee15a520a03a89d4ac5fa852564feaa.png"></p> 
 <p><strong>4.计算30天后日活数</strong></p> 
 <p>通过上面的步骤，我们已经得到了每天的留存率。接下来我们就可以计算第30天的日活用户数有多少。</p> 
 <p>第1日(次日)留存用户数=第1日新增用户数*次日留存率</p> 
 <p>第2日活跃用户数=第2日新增用户数+第1日留存用户数<br></p> 
 <p>第3日活跃用户数=第3日新增用户数+第2日留存用户数（第2日新增用户数*第2日留存率）+第1日留存用户数</p> 
 <p>...</p> 
 <p>第30日活跃用户数=<strong>第30日新增用户数</strong>+第29日留存用户数+第28日留存用户数+...+第1日留存用户数</p> 
 <p>也就是，</p> 
 <p>第30日活跃用户数=<strong>1-29日每天的留存用户数</strong>（第1日留存用户数+第2日留存用户数+...+第29日留存用户数）+<strong>第30日新增用户数</strong></p> 
 <p>（1）在下图Excel步骤1的地方是题目的设定，每天固定新增用户数为6万<br></p> 
 <p>在下图步骤2的地方算出<strong>1-29日每天的留存用户数</strong>，也就是第N日新增用户数（6万）*第N日留存率（F列对应的留存率）。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/a0/73/nKzGtRu8_o.png" alt="e807215626f23e5accace3ada584b0f4.png"></p> 
 <p>（3）下图步骤3将这一列的值求和，就是第30日活跃用户数=<strong>1日-29日每天的留存用户数</strong>+<strong>第30日新增用户数</strong>。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/c6/0b/STfsgFyM_o.png" alt="c5c3e55447f444b32ee33bb06711375d.png"></p> 
 <p><strong>5.总结</strong></p> 
 <p>Excel里进行预测分析的2种办法：</p> 
 <p>1）时间序列数据如何预测？用预测工作表</p> 
 <p>2）其他数据如何预测？先画散点图，然后添加趋势线和公式</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/fd/eb/sfcQ4xJC_o.png" alt="b48935e80b7bf770f864d03e3a9f6e22.png"></p> 
 <p style="text-align:left;">快来学职场晋级技巧：如何做出老板喜欢的图表！点击看视频教学：‍‍‍‍‍‍‍‍‍‍‍‍</p> 
 <p><img src="https://images2.imgbox.com/3e/c6/cqAr1Bn1_o.jpg" alt="0f2a459c3bb2546560b03c04507b9888.jpeg"><strong> ⬇️点击「阅读原文」</strong></p> 
 <p><strong> 免费报名 数据分析训练营</strong></p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/167e8a873c99407cb5f5de21d8dfead5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux服务器常见运维性能测试（1）综合跑分unixbench、superbench</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/22157dc3c7f42134571e11419ec6fa9a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">优化改进YOLOv5算法之添加SE、CBAM、CA模块(超详细)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>