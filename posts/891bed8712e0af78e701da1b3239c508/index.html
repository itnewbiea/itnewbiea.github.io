<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>阿白数模笔记之协方差矩阵与相关矩阵 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="阿白数模笔记之协方差矩阵与相关矩阵" />
<meta property="og:description" content="目录
前言
一、方差
二、协方差矩阵
①协方差
②自协方差矩阵
互协方差矩阵​编辑
③互协方差矩阵
Ⅰ、数学定义
Ⅱ、MATLAB运算
三、相关矩阵
①person相关系数
②自相关矩阵
③互相关矩阵
Ⅰ、数学定义
Ⅱ、matlab运算
前言 作为数模小白，前天在学习FA算法时看到协方差直接啥也不会，在查阅多方资料后，才算是有所了解，本文介绍数学上协方差矩阵和相关矩阵的定义以及在MATLAB中的运算。
一、方差 这是百度百科所给的定义
n=input(&#39;请输入矩阵的行数：&#39;); a=rand(n,1); b=mean(a); s1=0; for i=1:n s1=s1&#43;(a(i)-b)^2; end s1=s1/(n-1)%方差 s=s1^0.5%标准差 s2=cov(a)%方差 s3=var(a)%方差 二、协方差矩阵 ①协方差 该图来自如何直观地理解「协方差矩阵」？
a=[1,2,3,4]; a1=a-mean(a); b=[5,6,7,8]; b1=b-mean(b); c=a1*b1&#39;/(size(a,1)-1);%即为a,b的协方差 ②自协方差矩阵 该图来自如何直观地理解「协方差矩阵」？
互协方差矩阵 a= [5 0 3 7; 1 -5 7 3; 4 9 8 10;1 0 9 8]; b=a-mean(a); n=size(a); cx=zeros(n); for i=1:n(2)%遍历每一列 for j=1:n(2)%遍历每一列 cx(i,j)=b(:,i)&#39;*b(:,j)/(n(1)-1); end end c=cov(a);%matlab中有cov,此处用来检验运算是否正确 &gt;&gt; cx-c ans = 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/891bed8712e0af78e701da1b3239c508/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-21T11:31:22+08:00" />
<meta property="article:modified_time" content="2023-02-21T11:31:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">阿白数模笔记之协方差矩阵与相关矩阵</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">前言</a></p> 
<p id="%E4%B8%80%E3%80%81%E6%96%B9%E5%B7%AE-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E6%96%B9%E5%B7%AE" rel="nofollow">一、方差</a></p> 
<p id="%E4%BA%8C%E3%80%81%E5%8D%8F%E6%96%B9%E5%B7%AE-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E5%8D%8F%E6%96%B9%E5%B7%AE" rel="nofollow">二、协方差矩阵</a></p> 
<p id="%E2%91%A0%E5%8D%8F%E6%96%B9%E5%B7%AE-toc" style="margin-left:40px;"><a href="#%E2%91%A0%E5%8D%8F%E6%96%B9%E5%B7%AE" rel="nofollow">①协方差</a></p> 
<p id="%E2%91%A0%E8%87%AA%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5-toc" style="margin-left:40px;"><a href="#%E2%91%A0%E8%87%AA%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5" rel="nofollow">②自协方差矩阵</a></p> 
<p id="%E4%BA%92%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5%E2%80%8B%E7%BC%96%E8%BE%91-toc" style="margin-left:40px;"><a href="#%E4%BA%92%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5%E2%80%8B%E7%BC%96%E8%BE%91" rel="nofollow">互协方差矩阵​编辑</a></p> 
<p id="%E2%91%A1%E4%BA%92%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5-toc" style="margin-left:40px;"><a href="#%E2%91%A1%E4%BA%92%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5" rel="nofollow">③互协方差矩阵</a></p> 
<p id="%E2%85%A0%E3%80%81%E6%95%B0%E5%AD%A6%E5%AE%9A%E4%B9%89-toc" style="margin-left:80px;"><a href="#%E2%85%A0%E3%80%81%E6%95%B0%E5%AD%A6%E5%AE%9A%E4%B9%89" rel="nofollow">Ⅰ、数学定义</a></p> 
<p id="%E2%85%A1%E3%80%81MATLAB%E8%BF%90%E7%AE%97-toc" style="margin-left:80px;"><a href="#%E2%85%A1%E3%80%81MATLAB%E8%BF%90%E7%AE%97" rel="nofollow">Ⅱ、MATLAB运算</a></p> 
<p id="%E5%9B%9B%E3%80%81%E7%9B%B8%E5%85%B3%E7%9F%A9%E9%98%B5-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81%E7%9B%B8%E5%85%B3%E7%9F%A9%E9%98%B5" rel="nofollow">三、相关矩阵</a></p> 
<p id="%E2%91%A0person%E7%9B%B8%E5%85%B3%E7%B3%BB%E6%95%B0-toc" style="margin-left:40px;"><a href="#%E2%91%A0person%E7%9B%B8%E5%85%B3%E7%B3%BB%E6%95%B0" rel="nofollow">①person相关系数</a></p> 
<p id="%E2%91%A1%E8%87%AA%E7%9B%B8%E5%85%B3%E7%9F%A9%E9%98%B5-toc" style="margin-left:40px;"><a href="#%E2%91%A1%E8%87%AA%E7%9B%B8%E5%85%B3%E7%9F%A9%E9%98%B5" rel="nofollow">②自相关矩阵</a></p> 
<p id="%E2%91%A2%E4%BA%92%E7%9B%B8%E5%85%B3%E7%9F%A9%E9%98%B5-toc" style="margin-left:40px;"><a href="#%E2%91%A2%E4%BA%92%E7%9B%B8%E5%85%B3%E7%9F%A9%E9%98%B5" rel="nofollow">③互相关矩阵</a></p> 
<p id="%E2%85%A0%E3%80%81%E6%95%B0%E5%AD%A6%E5%AE%9A%E4%B9%89-toc" style="margin-left:80px;"><a href="#%E2%85%A0%E3%80%81%E6%95%B0%E5%AD%A6%E5%AE%9A%E4%B9%89" rel="nofollow">Ⅰ、数学定义</a></p> 
<p id="%E2%85%A1%E3%80%81matlab%E8%BF%90%E7%AE%97-toc" style="margin-left:80px;"><a href="#%E2%85%A1%E3%80%81matlab%E8%BF%90%E7%AE%97" rel="nofollow">Ⅱ、matlab运算</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E5%89%8D%E8%A8%80">前言</h2> 
<p>        作为数模小白，前天在学习FA算法时看到协方差直接啥也不会，在查阅多方资料后，才算是有所了解，本文介绍数学上协方差矩阵和相关矩阵的定义以及在MATLAB中的运算。</p> 
<h2 id="%E4%B8%80%E3%80%81%E6%96%B9%E5%B7%AE">一、方差</h2> 
<p>        这是百度百科所给的定义</p> 
<h2 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" src="https://images2.imgbox.com/dd/2b/q40P3j5t_o.png"></h2> 
<pre><code class="language-Matlab">n=input('请输入矩阵的行数：');
a=rand(n,1);
b=mean(a);
s1=0;
for i=1:n
    s1=s1+(a(i)-b)^2;
end
s1=s1/(n-1)%方差
s=s1^0.5%标准差
s2=cov(a)%方差
s3=var(a)%方差</code></pre> 
<h2 id="%E4%BA%8C%E3%80%81%E5%8D%8F%E6%96%B9%E5%B7%AE">二、协方差矩阵</h2> 
<h3 id="%E2%91%A0%E5%8D%8F%E6%96%B9%E5%B7%AE">①协方差</h3> 
<p>         该图来自<a class="link-info" href="https://zhuanlan.zhihu.com/p/37609917" rel="nofollow" title="如何直观地理解「协方差矩阵」？">如何直观地理解「协方差矩阵」？</a></p> 
<p><img alt="" height="223" src="https://images2.imgbox.com/4c/f5/bX0oRV9a_o.png" width="786"></p> 
<pre><code class="language-Matlab">a=[1,2,3,4];
a1=a-mean(a);
b=[5,6,7,8];
b1=b-mean(b);
c=a1*b1'/(size(a,1)-1);%即为a,b的协方差</code></pre> 
<h3 id="%E2%91%A0%E8%87%AA%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5">②自协方差矩阵</h3> 
<p>        该图来自<a class="link-info" href="https://zhuanlan.zhihu.com/p/37609917" rel="nofollow" title="如何直观地理解「协方差矩阵」？">如何直观地理解「协方差矩阵」？</a></p> 
<h3 id="%E4%BA%92%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5%E2%80%8B%E7%BC%96%E8%BE%91" style="text-align:center;">互协方差矩阵<img alt="" src="https://images2.imgbox.com/7a/81/L8v73tsn_o.png"></h3> 
<p></p> 
<pre><code class="language-Matlab">a= [5 0 3 7; 1 -5 7 3; 4 9 8 10;1 0 9 8];
b=a-mean(a);
n=size(a);
cx=zeros(n);
for i=1:n(2)%遍历每一列
    for j=1:n(2)%遍历每一列
        cx(i,j)=b(:,i)'*b(:,j)/(n(1)-1);
    end
end
c=cov(a);%matlab中有cov,此处用来检验运算是否正确
&gt;&gt; cx-c

ans =

   1.0e-14 *

         0         0    0.0444         0
         0   -0.7105         0         0
    0.0444         0         0         0
         0         0         0    0.1776
</code></pre> 
<h3 id="%E2%91%A1%E4%BA%92%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5">③互协方差矩阵</h3> 
<h4 id="%E2%85%A0%E3%80%81%E6%95%B0%E5%AD%A6%E5%AE%9A%E4%B9%89">Ⅰ、数学定义</h4> 
<p>        该图来自<a class="link-info" href="https://blog.csdn.net/RSstudent/article/details/104414046" title="（自）协方差矩阵与互协方差矩阵简介">（自）协方差矩阵与互协方差矩阵简介</a></p> 
<p><img alt="" src="https://images2.imgbox.com/7d/a2/H6uq2vMy_o.png"></p> 
<p> x，y应为同型矩阵。这是根据数学定义计算出的cov(x,y)</p> 
<pre><code class="language-Matlab">x=rand(5,6);
[m,n]=size(x);
y=rand(5,6);
c=zeros(n);
for i=1:n
    for j=1:n
        c(i,j)=x(:,i)'*y(:,j)/(n-1);
    end
end
&gt;&gt; c

c =

    0.1880    0.1877    0.1157    0.1654    0.1283    0.2000
    0.2199    0.2038    0.1970    0.3117    0.1446    0.3019
    0.2576    0.3327    0.2605    0.2840    0.2559    0.3710
    0.2513    0.2942    0.1550    0.2387    0.1472    0.2588
    0.2119    0.2406    0.1538    0.2424    0.1280    0.2493
    0.2305    0.2244    0.1704    0.2219    0.1873    0.2841</code></pre> 
<h4 id="%E2%85%A1%E3%80%81MATLAB%E8%BF%90%E7%AE%97">Ⅱ、MATLAB运算</h4> 
<p>        但在MATLAB中，cov(A,B)的含义与数学中的并不相同</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/20/59/FKhHeTQS_o.png"></p> 
<p> ①的意思是，传入的A,B都是列向量或行向量，此图来自<a class="link-info" href="" rel="nofollow" title="matlab协方差cov计算代码">matlab协方差cov计算代码</a></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/4b/a1/Ud7Vql9n_o.png"></p> 
<p> </p> 
<pre><code class="language-Matlab">a=[1 2 3 0];
b=[5,6,7,9];
cab=cov(a,b);
c=zeros(2);
c(1,1)=cov(a);
c(2,2)=cov(b);
a=a-mean(a);
b=b-mean(b);
c(1,2)=a*b'/(4-1);
c(2,1)=c(1,2);
&gt;&gt; c

c =

    1.6667   -0.8333
   -0.8333    2.9167

&gt;&gt; cab

cab =

    1.6667   -0.8333
   -0.8333    2.9167</code></pre> 
<p>②的意思是，A,B中元素总数相等（不要求同型），cov(A,B)=cov(A(:),B(:));</p> 
<pre><code class="language-Matlab">x=rand(2,3);
y=rand(3,2);
c1=cov(x,y)%按照数学公式应返回3×3协方差矩阵，但在matlab中会返回2×2矩阵
c2=cov(x(:),y(:))
c1 =

    0.0571   -0.0009
   -0.0009    0.0440


c2 =

    0.0571   -0.0009
   -0.0009    0.0440</code></pre> 
<h2 id="%E5%9B%9B%E3%80%81%E7%9B%B8%E5%85%B3%E7%9F%A9%E9%98%B5">三、相关矩阵</h2> 
<h3 id="%E2%91%A0person%E7%9B%B8%E5%85%B3%E7%B3%BB%E6%95%B0">①person相关系数</h3> 
<p>        这是百度百科所给的定义：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/0c/83/lUx97qYk_o.png"></p> 
<p style="text-align:center;"> <img alt="" src="https://images2.imgbox.com/7d/b4/Sn2FisqQ_o.png"></p> 
<p> 绝对值越接近1,线性相关性越强</p> 
<pre><code class="language-Matlab">x=rand(5,1);
y=rand(5,1);
r1=(x-mean(x))'*(y-mean(y))/(5-1)/(var(x)*var(y))^0.5
r2=corr(x,y)%返回两个等长矩阵的相关系数
r1 =

    0.3655


r2 =

    0.3655</code></pre> 
<h3 id="%E2%91%A1%E8%87%AA%E7%9B%B8%E5%85%B3%E7%9F%A9%E9%98%B5">②自相关矩阵</h3> 
<p>        相关矩阵也叫相关系数矩阵，是由矩阵各列间的相关系数构成的。也就是说，自相关矩阵第i行第j列的元素是原矩阵第i列和第j列的相关系数</p> 
<pre><code class="language-Matlab">a=rand(3,4);
[m,n]=size(a);
c1=zeros(n);
for i=1:n
    for j=1:n
        c1(i,j)=corr(a(:,i),a(:,j));
        %c1(i,j)是原矩阵i列j列的相关系数
    end
end
c1
c2=corrcoef(a)%返回a1的自相关矩阵
c1 =%对角元都为1

    1.0000    0.6911   -0.0058   -0.9390
    0.6911    1.0000    0.7187   -0.8975
   -0.0058    0.7187    1.0000   -0.3385
   -0.9390   -0.8975   -0.3385    1.0000


c2 =

    1.0000    0.6911   -0.0058   -0.9390
    0.6911    1.0000    0.7187   -0.8975
   -0.0058    0.7187    1.0000   -0.3385
   -0.9390   -0.8975   -0.3385    1.0000</code></pre> 
<h3 id="%E2%91%A2%E4%BA%92%E7%9B%B8%E5%85%B3%E7%9F%A9%E9%98%B5">③互相关矩阵</h3> 
<h4>Ⅰ、数学定义</h4> 
<p>        对同型矩阵x,y（m×n）。R(x,y)表示x,y的互相关矩阵（n×n）,rij=r(xi,yj)，即x第i列与y第j列的相关系数</p> 
<pre><code class="language-Matlab">a=rand(3,4);
b=rand(size(a));
[m,n]=size(a);
r1=zeros(n);
for i =1:n
    for j=1:n
        r1(i,j)=corr(a(:,i),b(:,j));
    end
end</code></pre> 
<h4 id="%E2%85%A1%E3%80%81matlab%E8%BF%90%E7%AE%97">Ⅱ、matlab运算</h4> 
<p>        和上面说讲的MATLAB运算互协方差矩阵相似，corrcoef(a,b)=corrcoef(a(:),b(:))</p> 
<pre><code class="language-Matlab">a=rand(3,4);
b=rand(size(a));
r=corr(a(:),b(:))
r2=corrcoef(a,b)
r3=corrcoef(a(:),b(:))
r =

   -0.1293


r2 =%(1,2),(2,1)是a(:),b(:)的相关系数

    1.0000   -0.1293
   -0.1293    1.0000


r3 =

    1.0000   -0.1293
   -0.1293    1.0000
</code></pre> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5a689afaa82f6200bebd6c3025cb2dd1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">CSDN上传付费资源竟然需要LV4才可以，目前只有LV2，综合贡献分一直为0，本文持续更新</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8bba99fe158c7f0702d0a64a367371e6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【华为云-开发者专属集市】使用ECS搭建WordPress博客平台</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>