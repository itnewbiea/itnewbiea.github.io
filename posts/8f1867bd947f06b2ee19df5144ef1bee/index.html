<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【C&#43;&#43;开发】Qt&#43;Tesseract实现文字识别的各种坑（已解决） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【C&#43;&#43;开发】Qt&#43;Tesseract实现文字识别的各种坑（已解决）" />
<meta property="og:description" content="文章目录 Tesseract库下载Qt版本选择安装步骤 VS2017安装MSVC调试器安装构建套件的导入文字识别功能的检测 最近在给之前Qt医疗管理系统项目添加一个文字识别功能，但是在其中遇到非常多坑，花费了我比较多的时间（查阅了很多文章），这篇文章主要用来整理这些坑（非常详细）。
Qt版本：Qt5.13
VS版本：VS2017
编译器（构建套件）：Desktop Qt 5.13.0 MSVC2017 64bit
以上环境都必须保持一致，否则可能会出现意想不到的错误。
Tesseract库下载 我这里选择比较简单的获取库的方法，就是下载已经通过源码编译好的库，当然也可以在GitHub上找到Tesseract的开源项目下载源码自己编译。为什么不选择后者呢？容易出错！如果你是刚接触的小白，本人强烈推荐前者；如果你是大佬，那当我没说哈哈哈~
这个库我已经放到主页的资源下，需要的自取。下载之后解压缩看到以下3个文件夹就说明下载成功。
Qt版本选择 这里我Qt的版本选择的是Qt5.13，大家尽量保持一样，避免出现不必要的错误。
这是之前在官网下载的，但是最近去看好像没有这个版本可以下载了，如果在官网中没有找到这个版本可以通过下面微信名片添加我，找我发安装包。
安装步骤 （1）打开安装包，点击Next。
（2）登录自己的Qt账号，Next。（没有Qt账号的话注册一个即可）
（3）这里最好修改路径，放到D盘，毕竟Qt还是比较大的。然后Next。
（4）勾选以下选项，Next。
（5）Next后开始安装。
VS2017安装 实测VS2019和VS2022都运行不起来，只有VS2017，大家尽量选择VS2017安装，保持版本一致。最近在VS官网上好像也没有看到VS2017的安装包，有需要的可以到我的主页下的资源中选择下载。
（1）点击打开社区版的安装包。
（2）按照下面操作进行勾选。
（3）这里最好修改路径到D盘，毕竟VS也是比较大的。
至此，Tesseract、Qt以及VS2017都已经准备好了。
MSVC调试器安装 虽然我们在安装Qt的时候，有选择MSVC版本，但是这里只会显示MinGW（也就是windows模拟器版本），这时候我们就需要安装一个MSVC调试器。
可以在我的主页资源中找到这个工具下载。
（1）解压后点击安装包，这里路径可以修改成D盘，Next。
（2）选择No，Next。
（3）只需要勾选这个，Install。
构建套件的导入 （1）安装完之后，打开Qt就可以发现MSVC版本的编译器就会自动加载进去。
（2）此时只需要在构建套件中按照红色框中的选，Apply，OK即可。
这样，就成功地将各种环境配置好了。
文字识别功能的检测 （1）新建一个工程，在.pro文件中添加这四个语句，&#43;=后的路径是刚才下载Tesseract库存放的路径，按照我写的这个定位即可。
INCLUDEPATH &#43;= D:\QtProject\tesseracte_lib\tesseract_x64-windows\include\tesseract LIBS&#43;= D:\QtProject\tesseracte_lib\tesseract_x64-windows\lib\tesseract41.lib INCLUDEPATH &#43;= D:\QtProject\tesseracte_lib\leptonica_x64-windows\include\leptonica LIBS&#43;= D:\QtProject\tesseracte_lib\leptonica_x64-windows\lib\leptonica-1.78.0.lib （2）导入头文件（最重要的是最下面的两个&lt;tesseract/baseapi.h&gt; 和&lt;tesseract/strngs.h&gt;）。使用刚才下载的路径导入即可。
#include &lt;QDebug&gt; #include &lt;QFileDialog&gt; #include &lt;QTextCodec&gt; #include &lt;iostream&gt; #include &lt;memory&gt; #include &lt;allheaders.h&gt; #include &lt;D:/QtProject/tesseracte_lib/tesseract_x64-windows/include/tesseract/baseapi.h&gt; // tesseract提供的关于C&#43;&#43;的接口 #include &lt;D:/QtProject/tesseracte_lib/tesseract_x64-windows/include/tesseract/strngs." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8f1867bd947f06b2ee19df5144ef1bee/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-04T16:28:53+08:00" />
<meta property="article:modified_time" content="2023-06-04T16:28:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【C&#43;&#43;开发】Qt&#43;Tesseract实现文字识别的各种坑（已解决）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#Tesseract_8" rel="nofollow">Tesseract库下载</a></li><li><a href="#Qt_16" rel="nofollow">Qt版本选择</a></li><li><ul><li><a href="#_21" rel="nofollow">安装步骤</a></li></ul> 
  </li><li><a href="#VS2017_34" rel="nofollow">VS2017安装</a></li><li><a href="#MSVC_48" rel="nofollow">MSVC调试器安装</a></li><li><a href="#_60" rel="nofollow">构建套件的导入</a></li><li><a href="#_68" rel="nofollow">文字识别功能的检测</a></li></ul> 
</div> 
<p></p> 
<blockquote> 
 <p>        最近在给之前Qt医疗管理系统项目添加一个文字识别功能，但是在其中遇到非常多坑，花费了我比较多的时间（查阅了很多文章），这篇文章主要用来整理这些坑（非常详细）。</p> 
</blockquote> 
<p>Qt版本：Qt5.13<br> VS版本：VS2017<br> 编译器（构建套件）：Desktop Qt 5.13.0 MSVC2017 64bit<br> 以上环境都必须保持一致，否则可能会出现意想不到的错误。</p> 
<h2><a id="Tesseract_8"></a>Tesseract库下载</h2> 
<p>        我这里选择比较简单的获取库的方法，就是下载已经通过源码编译好的库，当然也可以在GitHub上找到Tesseract的开源项目下载源码自己编译。为什么不选择后者呢？容易出错！如果你是刚接触的小白，本人强烈推荐前者；如果你是大佬，那当我没说哈哈哈~</p> 
<p><img src="https://images2.imgbox.com/54/93/PpTTGaNK_o.png" alt="在这里插入图片描述"><br>         这个库我已经放到主页的资源下，需要的自取。下载之后解压缩看到以下3个文件夹就说明下载成功。</p> 
<p><img src="https://images2.imgbox.com/16/cf/ZxD0ERab_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Qt_16"></a>Qt版本选择</h2> 
<p>        这里我Qt的版本选择的是Qt5.13，大家尽量保持一样，避免出现不必要的错误。<br> <img src="https://images2.imgbox.com/50/93/TIY6ms0b_o.png" alt="在这里插入图片描述"><br>         这是之前在官网下载的，但是最近去看好像没有这个版本可以下载了，如果在官网中没有找到这个版本可以通过下面微信名片添加我，找我发安装包。</p> 
<h3><a id="_21"></a>安装步骤</h3> 
<p>（1）打开安装包，点击Next。<br> <img src="https://images2.imgbox.com/01/8d/xuR61LTA_o.png" alt="在这里插入图片描述"><br> （2）登录自己的Qt账号，Next。（没有Qt账号的话注册一个即可）<br> <img src="https://images2.imgbox.com/12/99/lZoYqSMJ_o.png" alt="在这里插入图片描述"><br> （3）这里最好修改路径，放到D盘，毕竟Qt还是比较大的。然后Next。<br> <img src="https://images2.imgbox.com/25/0a/jF0YYRVg_o.png" alt="在这里插入图片描述"><br> （4）勾选以下选项，Next。<br> <img src="https://images2.imgbox.com/65/c4/tPU3B5zx_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/50/8a/SWJDpVnF_o.png" alt="在这里插入图片描述"><br> （5）Next后开始安装。<br> <img src="https://images2.imgbox.com/b3/f5/V9g78oy5_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="VS2017_34"></a>VS2017安装</h2> 
<p>        实测VS2019和VS2022都运行不起来，只有VS2017，大家尽量选择VS2017安装，保持版本一致。最近在VS官网上好像也没有看到VS2017的安装包，有需要的可以到我的主页下的资源中选择下载。<br> <img src="https://images2.imgbox.com/f6/d4/ax7J3Yzb_o.png" alt="在这里插入图片描述"><br> （1）点击打开社区版的安装包。<br> <img src="https://images2.imgbox.com/fd/0a/a2WU5xZo_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/56/f3/nrqDeH6D_o.png" alt="在这里插入图片描述"><br> （2）按照下面操作进行勾选。<br> <img src="https://images2.imgbox.com/e9/79/9rN8kik0_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f7/d8/SrIMEMym_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/61/d8/1k9Re7cZ_o.png" alt="在这里插入图片描述"><br> （3）这里最好修改路径到D盘，毕竟VS也是比较大的。<br> <img src="https://images2.imgbox.com/92/8a/dqnk4aI9_o.png" alt="在这里插入图片描述"><br>         至此，Tesseract、Qt以及VS2017都已经准备好了。</p> 
<h2><a id="MSVC_48"></a>MSVC调试器安装</h2> 
<p><img src="https://images2.imgbox.com/5f/3a/7tMk7Vdc_o.png" alt="在这里插入图片描述"><br>         虽然我们在安装Qt的时候，有选择MSVC版本，但是这里只会显示MinGW（也就是windows模拟器版本），这时候我们就需要安装一个MSVC调试器。<br> <img src="https://images2.imgbox.com/f3/42/tz9iOZMN_o.png" alt="在这里插入图片描述"><br>         可以在我的主页资源中找到这个工具下载。<br> （1）解压后点击安装包，这里路径可以修改成D盘，Next。<br> <img src="https://images2.imgbox.com/6e/62/5yXd3ioE_o.png" alt="在这里插入图片描述"><br> （2）选择No，Next。<br> <img src="https://images2.imgbox.com/e2/02/wPeBOmaz_o.png" alt="在这里插入图片描述"><br> （3）只需要勾选这个，Install。<br> <img src="https://images2.imgbox.com/5b/d7/Hs3ZGChA_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_60"></a>构建套件的导入</h2> 
<p>（1）安装完之后，打开Qt就可以发现MSVC版本的编译器就会自动加载进去。<br> <img src="https://images2.imgbox.com/ca/fc/XyKDuc5U_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/61/51/1Q65TKRO_o.png" alt="在这里插入图片描述"><br> （2）此时只需要在构建套件中按照红色框中的选，Apply，OK即可。<br> <img src="https://images2.imgbox.com/ed/48/ed3dYq1T_o.png" alt="在这里插入图片描述"><br>         这样，就成功地将各种环境配置好了。</p> 
<h2><a id="_68"></a>文字识别功能的检测</h2> 
<p>（1）新建一个工程，在.pro文件中添加这四个语句，+=后的路径是刚才下载Tesseract库存放的路径，按照我写的这个定位即可。<br> <img src="https://images2.imgbox.com/7c/ac/xAIJcA6a_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp">INCLUDEPATH <span class="token operator">+=</span> D<span class="token operator">:</span>\QtProject\tesseracte_lib\tesseract_x64<span class="token operator">-</span>windows\include\tesseract
LIBS<span class="token operator">+=</span> D<span class="token operator">:</span>\QtProject\tesseracte_lib\tesseract_x64<span class="token operator">-</span>windows\lib\tesseract41<span class="token punctuation">.</span>lib

INCLUDEPATH <span class="token operator">+=</span> D<span class="token operator">:</span>\QtProject\tesseracte_lib\leptonica_x64<span class="token operator">-</span>windows\include\leptonica
LIBS<span class="token operator">+=</span> D<span class="token operator">:</span>\QtProject\tesseracte_lib\leptonica_x64<span class="token operator">-</span>windows\lib\leptonica<span class="token operator">-</span><span class="token number">1.78</span><span class="token punctuation">.</span><span class="token number">0.l</span>ib
</code></pre> 
<p>（2）导入头文件（最重要的是最下面的两个<code>&lt;tesseract/baseapi.h&gt; </code>和<code>&lt;tesseract/strngs.h&gt;</code>）。使用刚才下载的路径导入即可。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QDebug&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QFileDialog&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QTextCodec&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;allheaders.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;D:/QtProject/tesseracte_lib/tesseract_x64-windows/include/tesseract/baseapi.h&gt;</span>      <span class="token comment">// tesseract提供的关于C++的接口</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;D:/QtProject/tesseracte_lib/tesseract_x64-windows/include/tesseract/strngs.h&gt;</span></span>
</code></pre> 
<p>（3）代码编写。简单实现一下文字识别功能，看看效果。</p> 
<pre><code class="prism language-cpp">    <span class="token comment">// Basic example</span>
      <span class="token keyword">char</span> <span class="token operator">*</span>outText<span class="token punctuation">;</span>

      tesseract<span class="token double-colon punctuation">::</span>TessBaseAPI <span class="token operator">*</span>api <span class="token operator">=</span> <span class="token keyword">new</span> tesseract<span class="token double-colon punctuation">::</span><span class="token function">TessBaseAPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// Initialize tesseract-ocr with English, without specifying tessdata path</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>api<span class="token operator">-&gt;</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token string">"D:/QtProject/tesseracte_lib/tessdata"</span><span class="token punctuation">,</span> <span class="token string">"chi_sim"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">{<!-- --></span>
          <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"Could not initialize tesseract.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      QString filename <span class="token operator">=</span> <span class="token class-name">QFileDialog</span><span class="token double-colon punctuation">::</span><span class="token function">getOpenFileName</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token function">tr</span><span class="token punctuation">(</span><span class="token string">"文件上传"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      QTextCodec <span class="token operator">*</span>code <span class="token operator">=</span> <span class="token class-name">QTextCodec</span><span class="token double-colon punctuation">::</span><span class="token function">codecForName</span><span class="token punctuation">(</span><span class="token string">"GB2312"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      std<span class="token double-colon punctuation">::</span>string str <span class="token operator">=</span> code<span class="token operator">-&gt;</span><span class="token function">fromUnicode</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//      std::string str = path.toStdString();</span>
      <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> ch <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// Open input image with leptonica library</span>
      Pix <span class="token operator">*</span>image <span class="token operator">=</span> <span class="token function">pixRead</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//absolute path of file</span>
      api<span class="token operator">-&gt;</span><span class="token function">SetImage</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// Get OCR result</span>
      outText <span class="token operator">=</span> api<span class="token operator">-&gt;</span><span class="token function">GetUTF8Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      ui<span class="token operator">-&gt;</span>textEdit<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>outText<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// Destroy used object and release memory</span>
      api<span class="token operator">-&gt;</span><span class="token function">End</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">delete</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> outText<span class="token punctuation">;</span>
      <span class="token function">pixDestroy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>image<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>（4）要记得将图一路径下的全部文件复制到可执行程序.exe（图二）的同级目录下。<br> <img src="https://images2.imgbox.com/35/76/TbF8Pp8U_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/15/7c/nHcjGGQd_o.png" alt="在这里插入图片描述"></p> 
<p>（5）运行。需要注意：这里必须使用release来运行。<br> <img src="https://images2.imgbox.com/e2/d1/xSiKxzAf_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/25/74/PO0J8TK4_o.png" alt="在这里插入图片描述"><br>         这里看到，识别的效果还是挺好的！<br>         按照这套流程安装操作下来（版本一致），很大概率都是没问题的（测试了几台机子了），如果还出现问题的话，可以私信或者在下方名片添加我讨论，也可以在评论区交流讨论。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3034793624ef85202b1002a33a737dc2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">利用HttpClient调用其他服务的接口，以及解决使用HttpClient中文乱码问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9818b907f1d86bf42b59ef71b80b165a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关于大模型的一些问答（持续更新）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>