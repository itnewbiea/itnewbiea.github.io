<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#获取网页内容的三种方式 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#获取网页内容的三种方式" />
<meta property="og:description" content="转载http://www.cnblogs.com/ceachy/articles/CSharp_Retrive_Page_Document.html 搜索网络，发现C#通常有三种方法获取网页内容，使用WebClient、WebBrowser或者HttpWebRequest/HttpWebResponse。。。
方法一：使用WebClient （引用自：http://fbljava.blog.163.com/blog/static/265211742008712105145244/）
static void Main(string[] args)
{
try {
WebClient MyWebClient = new WebClient();
MyWebClient.Credentials = CredentialCache.DefaultCredentials;//获取或设置用于向Internet资源的请求进行身份验证的网络凭据
Byte[] pageData = MyWebClient.DownloadData(“http://www.163.com”); //从指定网站下载数据
string pageHtml = Encoding.Default.GetString(pageData); //如果获取网站页面采用的是GB2312，则使用这句 //string pageHtml = Encoding.UTF8.GetString(pageData); //如果获取网站页面采用的是UTF-8，则使用这句
Console.WriteLine(pageHtml);//在控制台输入获取的内容
using (StreamWriter sw = new StreamWriter(&#34;c:\\test\\ouput.html&#34;))//将获取的内容写入文本
{
sw.Write(pageHtml);
}
Console.ReadLine(); //让控制台暂停,否则一闪而过了 }
catch(WebException webEx) {
Console.WriteLine(webEx.Message.ToString());
}
}
方法二：使用WebBrowser （引用自：http://topic.csdn.net/u/20091225/14/4ea221cd-4c1e-4931-a6db-1fd4ee7398ef.html）
WebBrowser web = new WebBrowser(); web.Navigate(&#34;http://www.xjflcp.com/ssc/&#34;); web.DocumentCompleted &#43;= new WebBrowserDocumentCompletedEventHandler(web_DocumentCompleted); void web_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e) { WebBrowser web = (WebBrowser)sender; HtmlElementCollection ElementCollection = web." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/695535c02842243a48b4c5540a5c0cc6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-11-21T09:57:34+08:00" />
<meta property="article:modified_time" content="2012-11-21T09:57:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#获取网页内容的三种方式</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 class="postTitle" style="margin:0px 0px 15px; padding:0px 0px 0px 5px; font-size:16px; float:left; line-height:1.5em; width:1324px; clear:both; color:rgb(70,70,70); font-family:verdana,'ms song',Arial,Helvetica,sans-serif; text-align:left; background-color:rgb(250,247,239)"> 转载<a href="http://www.cnblogs.com/ceachy/articles/CSharp_Retrive_Page_Document.html" rel="nofollow">http://www.cnblogs.com/ceachy/articles/CSharp_Retrive_Page_Document.html</a></h2> 
<div class="clear" style="margin:0px; padding:0px; clear:both; color:rgb(70,70,70); font-family:verdana,'ms song',Arial,Helvetica,sans-serif; font-size:16px; text-align:left; background-color:rgb(250,247,239)"> 
</div> 
<div class="postBody" style="margin:0px; padding:5px 2px 5px 5px; line-height:1.5; color:rgb(57,57,57); border-bottom-width:1px; border-bottom-style:solid; border-bottom-color:black; font-size:16px; font-family:verdana,'ms song',Arial,Helvetica,sans-serif; text-align:left; background-color:rgb(250,247,239)"> 
 <div id="cnblogs_post_body" style="margin:0px; padding:0px; word-break:normal!important"> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">搜索网络，发现C#通常有三种方法获取网页内容，使用WebClient、WebBrowser或者HttpWebRequest/HttpWebResponse。。。</p> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">方法一：使用WebClient （引用自：<a title="http://fbljava.blog.163.com/blog/static/265211742008712105145244/" href="http://fbljava.blog.163.com/blog/static/265211742008712105145244/" rel="nofollow" style="margin:0px; padding:0px; color:rgb(100,102,179)">http://fbljava.blog.163.com/blog/static/265211742008712105145244/</a>）</p> 
  <blockquote style="margin:10px 0px 10px 25px; padding:10px 60px 5px; border:2px solid rgb(239,239,239); color:rgb(51,51,51); min-height:35px; line-height:1.6em"> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">static void Main(string[] args)</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">{<!-- --></p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">    try {<!-- --></p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">        WebClient MyWebClient = new WebClient();</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">        <br style="margin:0px; padding:0px">         MyWebClient.Credentials = CredentialCache.DefaultCredentials;//获取或设置用于向Internet资源的请求进行身份验证的网络凭据</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">        Byte[] pageData = MyWebClient.DownloadData(“<a href="http://www.163.xn--com%29%3B-nc0e/" rel="nofollow" style="margin:0px; padding:0px; color:rgb(100,102,179)">http://www.163.com”);</a> //从指定网站下载数据</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">        string pageHtml = Encoding.Default.GetString(pageData);  //如果获取网站页面采用的是GB2312，则使用这句            </p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">        //string pageHtml = Encoding.UTF8.GetString(pageData); //如果获取网站页面采用的是UTF-8，则使用这句</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">        Console.WriteLine(pageHtml);//在控制台输入获取的内容</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">        using (StreamWriter sw = new StreamWriter("c:\\test\\ouput.html"))//将获取的内容写入文本</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">        {<!-- --></p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">            sw.Write(pageHtml);</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">        }</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">        Console.ReadLine(); //让控制台暂停,否则一闪而过了             </p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">    }</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">    catch(WebException webEx) {<!-- --></p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">        Console.WriteLine(webEx.Message.ToString());</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">    }</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">}</p> 
  </blockquote> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">方法二：使用WebBrowser （引用自：<a title="http://topic.csdn.net/u/20091225/14/4ea221cd-4c1e-4931-a6db-1fd4ee7398ef.html" href="http://topic.csdn.net/u/20091225/14/4ea221cd-4c1e-4931-a6db-1fd4ee7398ef.html" rel="nofollow" style="margin:0px; padding:0px; color:rgb(100,102,179)">http://topic.csdn.net/u/20091225/14/4ea221cd-4c1e-4931-a6db-1fd4ee7398ef.html</a>）</p> 
  <blockquote style="margin:10px 0px 10px 25px; padding:10px 60px 5px; border:2px solid rgb(239,239,239); color:rgb(51,51,51); min-height:35px; line-height:1.6em"> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">WebBrowser web = new WebBrowser(); <br style="margin:0px; padding:0px"> web.Navigate("http://www.xjflcp.com/ssc/"); <br style="margin:0px; padding:0px"> web.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(web_DocumentCompleted); <br style="margin:0px; padding:0px"> void web_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e) <br style="margin:0px; padding:0px">         { <br style="margin:0px; padding:0px">             WebBrowser web = (WebBrowser)sender; <br style="margin:0px; padding:0px">             HtmlElementCollection ElementCollection = web.Document.GetElementsByTagName("Table"); <br style="margin:0px; padding:0px">             foreach (HtmlElement item in ElementCollection) <br style="margin:0px; padding:0px">             { <br style="margin:0px; padding:0px">                  File.AppendAllText("Kaijiang_xj.txt", item.InnerText); <br style="margin:0px; padding:0px">             } <br style="margin:0px; padding:0px">         }</p> 
  </blockquote> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">方法三：使用HttpWebRequest/HttpWebResponse （引用自：<a title="http://hi.baidu.com/onlyafar/blog/item/7ac4c6bf92d4810019d81f98.html" href="http://hi.baidu.com/onlyafar/blog/item/7ac4c6bf92d4810019d81f98.html" rel="nofollow" style="margin:0px; padding:0px; color:rgb(100,102,179)">http://hi.baidu.com/onlyafar/blog/item/7ac4c6bf92d4810019d81f98.html</a>）</p> 
  <blockquote style="margin:10px 0px 10px 25px; padding:10px 60px 5px; border:2px solid rgb(239,239,239); color:rgb(51,51,51); min-height:35px; line-height:1.6em"> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">HttpWebRequest httpReq; <br style="margin:0px; padding:0px"> HttpWebResponse httpResp; <br style="margin:0px; padding:0px"> <br style="margin:0px; padding:0px"> string strBuff = ""; <br style="margin:0px; padding:0px"> char[] cbuffer = new char[256]; <br style="margin:0px; padding:0px"> int byteRead = 0; <br style="margin:0px; padding:0px"> <br style="margin:0px; padding:0px"> string filename = @"c:\log.txt"; <br style="margin:0px; padding:0px"> ///定义写入流操作 <br style="margin:0px; padding:0px"> public void WriteStream() <br style="margin:0px; padding:0px"> { <br style="margin:0px; padding:0px"> Uri httpURL = new Uri(txtURL.Text);</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">///HttpWebRequest类继承于WebRequest，并没有自己的构造函数，需通过WebRequest的Creat方法 建立，并进行强制的类型转换 <br style="margin:0px; padding:0px">       httpReq = (HttpWebRequest)WebRequest.Create(httpURL); <br style="margin:0px; padding:0px"> ///通过HttpWebRequest的GetResponse()方法建立HttpWebResponse,强制类型转换</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">   httpResp = (HttpWebResponse) httpReq.GetResponse(); <br style="margin:0px; padding:0px"> ///GetResponseStream()方法获取HTTP响应的数据流,并尝试取得URL中所指定的网页内容</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">     ///若成功取得网页的内容，则以System.IO.Stream形式返回，若失败则产生ProtoclViolationException错 误。在此正确的做法应将以下的代码放到一个try块中处理。这里简单处理 <br style="margin:0px; padding:0px"> Stream respStream = httpResp.GetResponseStream();</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">///返回的内容是Stream形式的，所以可以利用StreamReader类获取GetResponseStream的内容，并以</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">StreamReader类的Read方法依次读取网页源程序代码每一行的内容，直至行尾（读取的编码格式：UTF8） <br style="margin:0px; padding:0px"> StreamReader respStreamReader = new StreamReader(respStream,Encoding.UTF8);</p> 
   <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">byteRead = respStreamReader.Read(cbuffer,0,256); <br style="margin:0px; padding:0px"> <br style="margin:0px; padding:0px"> while (byteRead != 0) <br style="margin:0px; padding:0px"> { <br style="margin:0px; padding:0px"> string strResp = new string(cbuffer,0,byteRead); <br style="margin:0px; padding:0px">                   strBuff = strBuff + strResp; <br style="margin:0px; padding:0px">                   byteRead = respStreamReader.Read(cbuffer,0,256); <br style="margin:0px; padding:0px"> } <br style="margin:0px; padding:0px"> <br style="margin:0px; padding:0px"> respStream.Close(); <br style="margin:0px; padding:0px"> txtHTML.Text = strBuff; <br style="margin:0px; padding:0px"> }</p> 
  </blockquote> 
 </div> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/014d17c164a6f7491865cb47def653c0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ajax返回值传给js全局变量</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fa631120beb1dceae65bb475cfc6a02e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python学习笔记之三</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>