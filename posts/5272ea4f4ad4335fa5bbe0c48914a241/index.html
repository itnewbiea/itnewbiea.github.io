<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>æ·±åº¦å­¦ä¹ 100ä¾‹-å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆLSTMï¼‰å®ç°è‚¡ç¥¨é¢„æµ‹ | ç¬¬10å¤© - ITå­¦ä¹ è€…åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="æ·±åº¦å­¦ä¹ 100ä¾‹-å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆLSTMï¼‰å®ç°è‚¡ç¥¨é¢„æµ‹ | ç¬¬10å¤©" />
<meta property="og:description" content="ğŸ”— è¿è¡Œç¯å¢ƒï¼špython3ğŸš© ä½œè€…ï¼šKåŒå­¦å•ŠğŸ¥‡ ç²¾é€‰ä¸“æ ï¼šã€Šæ·±åº¦å­¦ä¹ 100ä¾‹ã€‹ğŸ”¥ é€‰è‡ªä¸“æ ï¼šã€Šæ–°æ‰‹å…¥é—¨æ·±åº¦å­¦ä¹ ã€‹ğŸ“š æ¨èä¸“æ ï¼šã€ŠMatplotlibæ•™ç¨‹ã€‹ğŸ§¿ ä¼˜ç§€ä¸“æ ï¼šã€ŠPythonå…¥é—¨100é¢˜ã€‹ æ–‡ç« ç›®å½• ä¸€ã€å‰è¨€äºŒã€LSTMçš„æ˜¯ä»€ä¹ˆä¸‰ã€å‡†å¤‡å·¥ä½œ1.è®¾ç½®GPU2.è®¾ç½®ç›¸å…³å‚æ•°3.åŠ è½½æ•°æ® å››ã€æ•°æ®é¢„å¤„ç†1.å½’ä¸€åŒ–2.æ—¶é—´æˆ³å‡½æ•° äº”ã€æ„å»ºæ¨¡å‹å…­ã€æ¿€æ´»æ¨¡å‹ä¸ƒã€è®­ç»ƒæ¨¡å‹å…«ã€ç»“æœå¯è§†åŒ–1.ç»˜åˆ¶losså›¾2.é¢„æµ‹3.è¯„ä¼° ä¸€ã€å‰è¨€ ä»Šå¤©æ˜¯ç¬¬10å¤©ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨LSTMå®Œæˆè‚¡ç¥¨å¼€ç›˜ä»·æ ¼çš„é¢„æµ‹ï¼Œæœ€åçš„R2å¯è¾¾åˆ°0.74ï¼Œç›¸å¯¹ä¼ ç»Ÿçš„RNNçš„0.72æé«˜äº†ä¸¤ä¸ªç™¾åˆ†ç‚¹ã€‚
æˆ‘çš„ç¯å¢ƒï¼š
è¯­è¨€ç¯å¢ƒï¼šPython3.6.5ç¼–è¯‘å™¨ï¼šjupyter notebookæ·±åº¦å­¦ä¹ ç¯å¢ƒï¼šTensorFlow2.4.1 æ¥è‡ªä¸“æ ï¼šã€æ·±åº¦å­¦ä¹ 100ä¾‹ã€‘
å¾€æœŸç²¾å½©å†…å®¹ï¼š
æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆLeNet-5ï¼‰æ·±åº¦å­¦ä¹ é‡Œçš„â€œHello Wordâ€ | ç¬¬22å¤©æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰å®ç°mnistæ‰‹å†™æ•°å­—è¯†åˆ« | ç¬¬1å¤©æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰æœè£…å›¾åƒåˆ†ç±» | ç¬¬3å¤©æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰èŠ±æœµè¯†åˆ« | ç¬¬4å¤©æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰å¤©æ°”è¯†åˆ« | ç¬¬5å¤©æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆVGG-16ï¼‰è¯†åˆ«æµ·è´¼ç‹è‰å¸½ä¸€ä¼™ | ç¬¬6å¤©æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆResNet-50ï¼‰é¸Ÿç±»è¯†åˆ« | ç¬¬8å¤©æ·±åº¦å­¦ä¹ 100ä¾‹-å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰è‚¡ç¥¨é¢„æµ‹ | ç¬¬9å¤© å¦‚æœä½ è¿˜æ˜¯ä¸€åå°ç™½ï¼Œå¯ä»¥çœ‹çœ‹æˆ‘è¿™ä¸ªä¸“é—¨ä¸ºä½ å†™çš„ä¸“æ ï¼šã€Šå°ç™½å…¥é—¨æ·±åº¦å­¦ä¹ ã€‹ï¼Œå¸®åŠ©é›¶åŸºç¡€çš„ä½ å…¥é—¨æ·±åº¦å­¦ä¹ ã€‚
äºŒã€LSTMçš„æ˜¯ä»€ä¹ˆ ç¥ç»ç½‘ç»œç¨‹åºçš„åŸºæœ¬æµç¨‹
ä¸€å¥è¯ä»‹ç»LSTMï¼Œå®ƒæ˜¯RNNçš„è¿›é˜¶ç‰ˆï¼Œå¦‚æœè¯´RNNçš„æœ€å¤§é™åº¦æ˜¯ç†è§£ä¸€å¥è¯ï¼Œé‚£ä¹ˆLSTMçš„æœ€å¤§é™åº¦åˆ™æ˜¯ç†è§£ä¸€æ®µè¯ï¼Œè¯¦ç»†ä»‹ç»å¦‚ä¸‹ï¼š
LSTMï¼Œå…¨ç§°ä¸ºé•¿çŸ­æœŸè®°å¿†ç½‘ç»œ(Long Short Term Memory networks)ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„RNNï¼Œèƒ½å¤Ÿå­¦ä¹ åˆ°é•¿æœŸä¾èµ–å…³ç³»ã€‚LSTMç”±Hochreiter &amp; Schmidhuber (1997)æå‡ºï¼Œè®¸å¤šç ”ç©¶è€…è¿›è¡Œäº†ä¸€ç³»åˆ—çš„å·¥ä½œå¯¹å…¶æ”¹è¿›å¹¶ä½¿ä¹‹å‘æ‰¬å…‰å¤§ã€‚LSTMåœ¨è®¸å¤šé—®é¢˜ä¸Šæ•ˆæœéå¸¸å¥½ï¼Œç°åœ¨è¢«å¹¿æ³›ä½¿ç”¨ã€‚
æ‰€æœ‰çš„å¾ªç¯ç¥ç»ç½‘ç»œéƒ½æœ‰ç€é‡å¤çš„ç¥ç»ç½‘ç»œæ¨¡å—å½¢æˆé“¾çš„å½¢å¼ã€‚åœ¨æ™®é€šçš„RNNä¸­ï¼Œé‡å¤æ¨¡å—ç»“æ„éå¸¸ç®€å•ï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š
LSTMé¿å…äº†é•¿æœŸä¾èµ–çš„é—®é¢˜ã€‚å¯ä»¥è®°ä½é•¿æœŸä¿¡æ¯ï¼LSTMå†…éƒ¨æœ‰è¾ƒä¸ºå¤æ‚çš„ç»“æ„ã€‚èƒ½é€šè¿‡é—¨æ§çŠ¶æ€æ¥é€‰æ‹©è°ƒæ•´ä¼ è¾“çš„ä¿¡æ¯ï¼Œè®°ä½éœ€è¦é•¿æ—¶é—´è®°å¿†çš„ä¿¡æ¯ï¼Œå¿˜è®°ä¸é‡è¦çš„ä¿¡æ¯ï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š
ä¸‰ã€å‡†å¤‡å·¥ä½œ 1.è®¾ç½®GPU å¦‚æœä½¿ç”¨çš„æ˜¯CPUå¯ä»¥æ³¨é‡Šæ‰è¿™éƒ¨åˆ†çš„ä»£ç ã€‚
import tensorflow as tf gpus = tf.config.list_physical_devices(&#34;GPU&#34;) if gpus: tf.config.experimental.set_memory_growth(gpus[0], True) #è®¾ç½®GPUæ˜¾å­˜ç”¨é‡æŒ‰éœ€ä½¿ç”¨ tf.config.set_visible_devices([gpus[0]],&#34;GPU&#34;) 2.è®¾ç½®ç›¸å…³å‚æ•° import pandas as pd import tensorflow as tf import numpy as np import matplotlib." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/5272ea4f4ad4335fa5bbe0c48914a241/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-11T15:38:18+08:00" />
<meta property="article:modified_time" content="2022-09-11T15:38:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ITå­¦ä¹ è€…åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ITå­¦ä¹ è€…åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">æ·±åº¦å­¦ä¹ 100ä¾‹-å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆLSTMï¼‰å®ç°è‚¡ç¥¨é¢„æµ‹ | ç¬¬10å¤©</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <ul><li>ğŸ”— è¿è¡Œç¯å¢ƒï¼špython3</li><li>ğŸš© ä½œè€…ï¼š<a href="https://mtyjkh.blog.csdn.net/" rel="nofollow">KåŒå­¦å•Š</a></li><li>ğŸ¥‡ ç²¾é€‰ä¸“æ ï¼š<a href="https://blog.csdn.net/qq_38251616/category_11068756.html"><strong>ã€Šæ·±åº¦å­¦ä¹ 100ä¾‹ã€‹</strong></a></li><li>ğŸ”¥ é€‰è‡ªä¸“æ ï¼š<a href="https://blog.csdn.net/qq_38251616/category_11188161.html"><strong>ã€Šæ–°æ‰‹å…¥é—¨æ·±åº¦å­¦ä¹ ã€‹</strong></a></li><li>ğŸ“š æ¨èä¸“æ ï¼š<a href="https://blog.csdn.net/qq_38251616/category_11351625.html"><strong>ã€ŠMatplotlibæ•™ç¨‹ã€‹</strong></a></li><li>ğŸ§¿ ä¼˜ç§€ä¸“æ ï¼š<a href="https://blog.csdn.net/qq_38251616/category_11350302.html"><strong>ã€ŠPythonå…¥é—¨100é¢˜ã€‹</strong></a></li></ul> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><a href="#_11" rel="nofollow">ä¸€ã€å‰è¨€</a></li><li><a href="#LSTM_39" rel="nofollow">äºŒã€LSTMçš„æ˜¯ä»€ä¹ˆ</a></li><li><a href="#_58" rel="nofollow">ä¸‰ã€å‡†å¤‡å·¥ä½œ</a></li><li><ul><li><a href="#1GPU_60" rel="nofollow">1.è®¾ç½®GPU</a></li><li><a href="#2_75" rel="nofollow">2.è®¾ç½®ç›¸å…³å‚æ•°</a></li><li><a href="#3_110" rel="nofollow">3.åŠ è½½æ•°æ®</a></li></ul> 
  </li><li><a href="#_285" rel="nofollow">å››ã€æ•°æ®é¢„å¤„ç†</a></li><li><ul><li><a href="#1_287" rel="nofollow">1.å½’ä¸€åŒ–</a></li><li><a href="#2_297" rel="nofollow">2.æ—¶é—´æˆ³å‡½æ•°</a></li></ul> 
  </li><li><a href="#_323" rel="nofollow">äº”ã€æ„å»ºæ¨¡å‹</a></li><li><a href="#_366" rel="nofollow">å…­ã€æ¿€æ´»æ¨¡å‹</a></li><li><a href="#_375" rel="nofollow">ä¸ƒã€è®­ç»ƒæ¨¡å‹</a></li><li><a href="#_443" rel="nofollow">å…«ã€ç»“æœå¯è§†åŒ–</a></li><li><ul><li><a href="#1loss_445" rel="nofollow">1.ç»˜åˆ¶losså›¾</a></li><li><a href="#2_456" rel="nofollow">2.é¢„æµ‹</a></li><li><a href="#3_473" rel="nofollow">3.è¯„ä¼°</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_11"></a>ä¸€ã€å‰è¨€</h2> 
<p>ä»Šå¤©æ˜¯ç¬¬10å¤©ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨LSTMå®Œæˆè‚¡ç¥¨å¼€ç›˜ä»·æ ¼çš„é¢„æµ‹ï¼Œæœ€åçš„R2å¯è¾¾åˆ°<code>0.74</code>ï¼Œç›¸å¯¹ä¼ ç»Ÿçš„RNNçš„<code>0.72</code>æé«˜äº†ä¸¤ä¸ªç™¾åˆ†ç‚¹ã€‚</p> 
<p>æˆ‘çš„ç¯å¢ƒï¼š</p> 
<ul><li>è¯­è¨€ç¯å¢ƒï¼šPython3.6.5</li><li>ç¼–è¯‘å™¨ï¼šjupyter notebook</li><li>æ·±åº¦å­¦ä¹ ç¯å¢ƒï¼šTensorFlow2.4.1</li></ul> 
<p><strong>æ¥è‡ªä¸“æ ï¼š</strong><a href="https://blog.csdn.net/qq_38251616/category_11068756.html"><strong>ã€æ·±åº¦å­¦ä¹ 100ä¾‹ã€‘</strong></a></p> 
<p>å¾€æœŸç²¾å½©å†…å®¹ï¼š</p> 
<ul><li><a href="https://mtyjkh.blog.csdn.net/article/details/119700804" rel="nofollow"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆLeNet-5ï¼‰æ·±åº¦å­¦ä¹ é‡Œçš„â€œHello Wordâ€ | ç¬¬22å¤©</strong></a></li><li><a href="https://mtyjkh.blog.csdn.net/article/details/116920825" rel="nofollow"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰å®ç°mnistæ‰‹å†™æ•°å­—è¯†åˆ« | ç¬¬1å¤©</strong></a></li><li><a href="https://mtyjkh.blog.csdn.net/article/details/116992196" rel="nofollow"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰æœè£…å›¾åƒåˆ†ç±» | ç¬¬3å¤©</strong></a></li><li><a href="https://mtyjkh.blog.csdn.net/article/details/117079919" rel="nofollow"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰èŠ±æœµè¯†åˆ« | ç¬¬4å¤©</strong></a></li><li><a href="https://mtyjkh.blog.csdn.net/article/details/117186183" rel="nofollow"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰å¤©æ°”è¯†åˆ« | ç¬¬5å¤©</strong></a></li><li><a href="https://blog.csdn.net/qq_38251616/article/details/117331631"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆVGG-16ï¼‰è¯†åˆ«æµ·è´¼ç‹è‰å¸½ä¸€ä¼™ | ç¬¬6å¤©</strong></a></li><li><a href="https://mtyjkh.blog.csdn.net/article/details/117587326" rel="nofollow"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆResNet-50ï¼‰é¸Ÿç±»è¯†åˆ« | ç¬¬8å¤©</strong></a></li><li><a href="https://mtyjkh.blog.csdn.net/article/details/117752046" rel="nofollow"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰è‚¡ç¥¨é¢„æµ‹ | ç¬¬9å¤©</strong></a></li></ul> 
<p>å¦‚æœä½ è¿˜æ˜¯ä¸€åå°ç™½ï¼Œå¯ä»¥çœ‹çœ‹æˆ‘è¿™ä¸ªä¸“é—¨ä¸ºä½ å†™çš„ä¸“æ ï¼š<a href="https://blog.csdn.net/qq_38251616/category_11188161.html">ã€Šå°ç™½å…¥é—¨æ·±åº¦å­¦ä¹ ã€‹</a>ï¼Œå¸®åŠ©é›¶åŸºç¡€çš„ä½ å…¥é—¨æ·±åº¦å­¦ä¹ ã€‚</p> 
<h2><a id="LSTM_39"></a>äºŒã€LSTMçš„æ˜¯ä»€ä¹ˆ</h2> 
<p><strong>ç¥ç»ç½‘ç»œç¨‹åºçš„åŸºæœ¬æµç¨‹</strong><br> <img src="https://images2.imgbox.com/9d/cf/8KxO6O20_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ä¸€å¥è¯ä»‹ç»LSTMï¼Œ<strong>å®ƒæ˜¯RNNçš„è¿›é˜¶ç‰ˆï¼Œå¦‚æœè¯´RNNçš„æœ€å¤§é™åº¦æ˜¯ç†è§£ä¸€å¥è¯ï¼Œé‚£ä¹ˆLSTMçš„æœ€å¤§é™åº¦åˆ™æ˜¯ç†è§£ä¸€æ®µè¯</strong>ï¼Œè¯¦ç»†ä»‹ç»å¦‚ä¸‹ï¼š</p> 
<p>LSTMï¼Œå…¨ç§°ä¸ºé•¿çŸ­æœŸè®°å¿†ç½‘ç»œ(Long Short Term Memory networks)ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„RNNï¼Œèƒ½å¤Ÿå­¦ä¹ åˆ°é•¿æœŸä¾èµ–å…³ç³»ã€‚LSTMç”±Hochreiter &amp; Schmidhuber (1997)æå‡ºï¼Œè®¸å¤šç ”ç©¶è€…è¿›è¡Œäº†ä¸€ç³»åˆ—çš„å·¥ä½œå¯¹å…¶æ”¹è¿›å¹¶ä½¿ä¹‹å‘æ‰¬å…‰å¤§ã€‚LSTMåœ¨è®¸å¤šé—®é¢˜ä¸Šæ•ˆæœéå¸¸å¥½ï¼Œç°åœ¨è¢«å¹¿æ³›ä½¿ç”¨ã€‚</p> 
<p>æ‰€æœ‰çš„å¾ªç¯ç¥ç»ç½‘ç»œéƒ½æœ‰ç€é‡å¤çš„ç¥ç»ç½‘ç»œæ¨¡å—å½¢æˆé“¾çš„å½¢å¼ã€‚åœ¨æ™®é€šçš„RNNä¸­ï¼Œé‡å¤æ¨¡å—ç»“æ„éå¸¸ç®€å•ï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š</p> 
<p><img src="https://images2.imgbox.com/74/f0/mxuiJD3U_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>LSTMé¿å…äº†é•¿æœŸä¾èµ–çš„é—®é¢˜ã€‚å¯ä»¥è®°ä½é•¿æœŸä¿¡æ¯ï¼LSTMå†…éƒ¨æœ‰è¾ƒä¸ºå¤æ‚çš„ç»“æ„ã€‚èƒ½é€šè¿‡é—¨æ§çŠ¶æ€æ¥é€‰æ‹©è°ƒæ•´ä¼ è¾“çš„ä¿¡æ¯ï¼Œ<strong>è®°ä½éœ€è¦é•¿æ—¶é—´è®°å¿†çš„ä¿¡æ¯ï¼Œå¿˜è®°ä¸é‡è¦çš„ä¿¡æ¯</strong>ï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š</p> 
<p><img src="https://images2.imgbox.com/e4/bf/OOMnQuqw_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="_58"></a>ä¸‰ã€å‡†å¤‡å·¥ä½œ</h2> 
<h3><a id="1GPU_60"></a>1.è®¾ç½®GPU</h3> 
<p>å¦‚æœä½¿ç”¨çš„æ˜¯CPUå¯ä»¥æ³¨é‡Šæ‰è¿™éƒ¨åˆ†çš„ä»£ç ã€‚</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf

gpus <span class="token operator">=</span> tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>list_physical_devices<span class="token punctuation">(</span><span class="token string">"GPU"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> gpus<span class="token punctuation">:</span>
    tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>set_memory_growth<span class="token punctuation">(</span>gpus<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment">#è®¾ç½®GPUæ˜¾å­˜ç”¨é‡æŒ‰éœ€ä½¿ç”¨</span>
    tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>set_visible_devices<span class="token punctuation">(</span><span class="token punctuation">[</span>gpus<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"GPU"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2_75"></a>2.è®¾ç½®ç›¸å…³å‚æ•°</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas            <span class="token keyword">as</span> pd
<span class="token keyword">import</span> tensorflow        <span class="token keyword">as</span> tf  
<span class="token keyword">import</span> numpy             <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment"># æ”¯æŒä¸­æ–‡</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>  <span class="token comment"># ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·</span>

<span class="token keyword">from</span> numpy                 <span class="token keyword">import</span> array
<span class="token keyword">from</span> sklearn               <span class="token keyword">import</span> metrics
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> MinMaxScaler
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>models          <span class="token keyword">import</span> Sequential
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>layers          <span class="token keyword">import</span> Dense<span class="token punctuation">,</span>LSTM<span class="token punctuation">,</span>Bidirectional


<span class="token comment"># ç¡®ä¿ç»“æœå°½å¯èƒ½é‡ç°</span>
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>random          <span class="token keyword">import</span> seed
seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
tf<span class="token punctuation">.</span>random<span class="token punctuation">.</span>set_seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># è®¾ç½®ç›¸å…³å‚æ•°</span>
n_timestamp  <span class="token operator">=</span> <span class="token number">40</span>    <span class="token comment"># æ—¶é—´æˆ³</span>
n_epochs     <span class="token operator">=</span> <span class="token number">20</span>    <span class="token comment"># è®­ç»ƒè½®æ•°</span>
<span class="token comment"># ====================================</span>
<span class="token comment">#      é€‰æ‹©æ¨¡å‹ï¼š</span>
<span class="token comment">#            1: å•å±‚ LSTM</span>
<span class="token comment">#            2: å¤šå±‚ LSTM</span>
<span class="token comment">#            3: åŒå‘ LSTM</span>
<span class="token comment"># ====================================</span>
model_type <span class="token operator">=</span> <span class="token number">1</span>
</code></pre> 
<h3><a id="3_110"></a>3.åŠ è½½æ•°æ®</h3> 
<pre><code class="prism language-python">data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./datasets/SH600519.csv'</span><span class="token punctuation">)</span>  <span class="token comment"># è¯»å–è‚¡ç¥¨æ–‡ä»¶</span>

data
</code></pre> 
<div> 
</div> 
<table border="1" class="dataframe"><thead><tr><th></th><th>Unnamed: 0</th><th>date</th><th>open</th><th>close</th><th>high</th><th>low</th><th>volume</th><th>code</th></tr></thead><tbody><tr><th>0</th><td>74</td><td>2010-04-26</td><td>88.702</td><td>87.381</td><td>89.072</td><td>87.362</td><td>107036.13</td><td>600519</td></tr><tr><th>1</th><td>75</td><td>2010-04-27</td><td>87.355</td><td>84.841</td><td>87.355</td><td>84.681</td><td>58234.48</td><td>600519</td></tr><tr><th>2</th><td>76</td><td>2010-04-28</td><td>84.235</td><td>84.318</td><td>85.128</td><td>83.597</td><td>26287.43</td><td>600519</td></tr><tr><th>3</th><td>77</td><td>2010-04-29</td><td>84.592</td><td>85.671</td><td>86.315</td><td>84.592</td><td>34501.20</td><td>600519</td></tr><tr><th>4</th><td>78</td><td>2010-04-30</td><td>83.871</td><td>82.340</td><td>83.871</td><td>81.523</td><td>85566.70</td><td>600519</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>2421</th><td>2495</td><td>2020-04-20</td><td>1221.000</td><td>1227.300</td><td>1231.500</td><td>1216.800</td><td>24239.00</td><td>600519</td></tr><tr><th>2422</th><td>2496</td><td>2020-04-21</td><td>1221.020</td><td>1200.000</td><td>1223.990</td><td>1193.000</td><td>29224.00</td><td>600519</td></tr><tr><th>2423</th><td>2497</td><td>2020-04-22</td><td>1206.000</td><td>1244.500</td><td>1249.500</td><td>1202.220</td><td>44035.00</td><td>600519</td></tr><tr><th>2424</th><td>2498</td><td>2020-04-23</td><td>1250.000</td><td>1252.260</td><td>1265.680</td><td>1247.770</td><td>26899.00</td><td>600519</td></tr><tr><th>2425</th><td>2499</td><td>2020-04-24</td><td>1248.000</td><td>1250.560</td><td>1259.890</td><td>1235.180</td><td>19122.00</td><td>600519</td></tr></tbody></table> 
<p>2426 rows Ã— 8 columns</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
å‰(2426-300=2126)å¤©çš„å¼€ç›˜ä»·ä½œä¸ºè®­ç»ƒé›†,å300å¤©çš„å¼€ç›˜ä»·ä½œä¸ºæµ‹è¯•é›†
"""</span>
training_set <span class="token operator">=</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2426</span> <span class="token operator">-</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values  
test_set     <span class="token operator">=</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">2426</span> <span class="token operator">-</span> <span class="token number">300</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
</code></pre> 
<h2><a id="_285"></a>å››ã€æ•°æ®é¢„å¤„ç†</h2> 
<h3><a id="1_287"></a>1.å½’ä¸€åŒ–</h3> 
<pre><code class="prism language-python"><span class="token comment">#å°†æ•°æ®å½’ä¸€åŒ–ï¼ŒèŒƒå›´æ˜¯0åˆ°1</span>
sc  <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span>feature_range<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
training_set_scaled <span class="token operator">=</span> sc<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>training_set<span class="token punctuation">)</span>
testing_set_scaled  <span class="token operator">=</span> sc<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>test_set<span class="token punctuation">)</span> 
</code></pre> 
<h3><a id="2_297"></a>2.æ—¶é—´æˆ³å‡½æ•°</h3> 
<pre><code class="prism language-python"><span class="token comment"># å–å‰ n_timestamp å¤©çš„æ•°æ®ä¸º Xï¼›n_timestamp+1å¤©æ•°æ®ä¸º Yã€‚</span>
<span class="token keyword">def</span> <span class="token function">data_split</span><span class="token punctuation">(</span>sequence<span class="token punctuation">,</span> n_timestamp<span class="token punctuation">)</span><span class="token punctuation">:</span>
    X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sequence<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        end_ix <span class="token operator">=</span> i <span class="token operator">+</span> n_timestamp
        
        <span class="token keyword">if</span> end_ix <span class="token operator">&gt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sequence<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
            
        seq_x<span class="token punctuation">,</span> seq_y <span class="token operator">=</span> sequence<span class="token punctuation">[</span>i<span class="token punctuation">:</span>end_ix<span class="token punctuation">]</span><span class="token punctuation">,</span> sequence<span class="token punctuation">[</span>end_ix<span class="token punctuation">]</span>
        X<span class="token punctuation">.</span>append<span class="token punctuation">(</span>seq_x<span class="token punctuation">)</span>
        y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>seq_y<span class="token punctuation">)</span>
    <span class="token keyword">return</span> array<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span> array<span class="token punctuation">(</span>y<span class="token punctuation">)</span>

X_train<span class="token punctuation">,</span> y_train <span class="token operator">=</span> data_split<span class="token punctuation">(</span>training_set_scaled<span class="token punctuation">,</span> n_timestamp<span class="token punctuation">)</span>
X_train          <span class="token operator">=</span> X_train<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>X_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

X_test<span class="token punctuation">,</span> y_test   <span class="token operator">=</span> data_split<span class="token punctuation">(</span>testing_set_scaled<span class="token punctuation">,</span> n_timestamp<span class="token punctuation">)</span>
X_test           <span class="token operator">=</span> X_test<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>X_test<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X_test<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_323"></a>äº”ã€æ„å»ºæ¨¡å‹</h2> 
<pre><code class="prism language-python"><span class="token comment"># å»ºæ„ LSTMæ¨¡å‹</span>
<span class="token keyword">if</span> model_type <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
    <span class="token comment"># å•å±‚ LSTM</span>
    model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
    model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>LSTM<span class="token punctuation">(</span>units<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span>
                   input_shape<span class="token operator">=</span><span class="token punctuation">(</span>X_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>units<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> model_type <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
    <span class="token comment"># å¤šå±‚ LSTM</span>
    model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
    model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>LSTM<span class="token punctuation">(</span>units<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> return_sequences<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                   input_shape<span class="token operator">=</span><span class="token punctuation">(</span>X_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>LSTM<span class="token punctuation">(</span>units<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> model_type <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>
    <span class="token comment"># åŒå‘ LSTM</span>
    model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
    model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Bidirectional<span class="token punctuation">(</span>LSTM<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            input_shape<span class="token operator">=</span><span class="token punctuation">(</span>X_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># è¾“å‡ºæ¨¡å‹ç»“æ„</span>
</code></pre> 
<pre><code>WARNING:tensorflow:Layer lstm will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm (LSTM)                  (None, 50)                10400     
_________________________________________________________________
dense (Dense)                (None, 1)                 51        
=================================================================
Total params: 10,451
Trainable params: 10,451
Non-trainable params: 0
_________________________________________________________________
</code></pre> 
<h2><a id="_366"></a>å…­ã€æ¿€æ´»æ¨¡å‹</h2> 
<pre><code class="prism language-python"><span class="token comment"># è¯¥åº”ç”¨åªè§‚æµ‹lossæ•°å€¼ï¼Œä¸è§‚æµ‹å‡†ç¡®ç‡ï¼Œæ‰€ä»¥åˆ å»metricsé€‰é¡¹ï¼Œä¸€ä¼šåœ¨æ¯ä¸ªepochè¿­ä»£æ˜¾ç¤ºæ—¶åªæ˜¾ç¤ºlosså€¼</span>
model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>optimizers<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span><span class="token operator">**</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              loss<span class="token operator">=</span><span class="token string">'mean_squared_error'</span><span class="token punctuation">)</span>  <span class="token comment"># æŸå¤±å‡½æ•°ç”¨å‡æ–¹è¯¯å·®</span>
</code></pre> 
<h2><a id="_375"></a>ä¸ƒã€è®­ç»ƒæ¨¡å‹</h2> 
<pre><code class="prism language-python">history <span class="token operator">=</span> model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> 
                    batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> 
                    epochs<span class="token operator">=</span>n_epochs<span class="token punctuation">,</span> 
                    validation_data<span class="token operator">=</span><span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">,</span> 
                    validation_freq<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>                  <span class="token comment">#æµ‹è¯•çš„epoché—´éš”æ•°</span>

model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>Epoch 1/20
33/33 [==============================] - 5s 107ms/step - loss: 0.1049 - val_loss: 0.0569
Epoch 2/20
33/33 [==============================] - 3s 86ms/step - loss: 0.0074 - val_loss: 1.1616
Epoch 3/20
33/33 [==============================] - 3s 83ms/step - loss: 0.0012 - val_loss: 0.1408
Epoch 4/20
33/33 [==============================] - 3s 78ms/step - loss: 5.8758e-04 - val_loss: 0.0421
Epoch 5/20
33/33 [==============================] - 3s 84ms/step - loss: 5.3411e-04 - val_loss: 0.0159
Epoch 6/20
33/33 [==============================] - 3s 81ms/step - loss: 3.9690e-04 - val_loss: 0.0034
Epoch 7/20
33/33 [==============================] - 3s 84ms/step - loss: 4.3521e-04 - val_loss: 0.0032
Epoch 8/20
33/33 [==============================] - 3s 85ms/step - loss: 3.8233e-04 - val_loss: 0.0059
Epoch 9/20
33/33 [==============================] - 3s 81ms/step - loss: 3.6539e-04 - val_loss: 0.0082
Epoch 10/20
33/33 [==============================] - 3s 81ms/step - loss: 3.1790e-04 - val_loss: 0.0141
Epoch 11/20
33/33 [==============================] - 3s 82ms/step - loss: 3.5332e-04 - val_loss: 0.0166
Epoch 12/20
33/33 [==============================] - 3s 86ms/step - loss: 3.2684e-04 - val_loss: 0.0155
Epoch 13/20
33/33 [==============================] - 3s 80ms/step - loss: 2.6495e-04 - val_loss: 0.0149
Epoch 14/20
33/33 [==============================] - 3s 84ms/step - loss: 3.1398e-04 - val_loss: 0.0172
Epoch 15/20
33/33 [==============================] - 3s 80ms/step - loss: 3.4533e-04 - val_loss: 0.0077
Epoch 16/20
33/33 [==============================] - 3s 81ms/step - loss: 2.9621e-04 - val_loss: 0.0082
Epoch 17/20
33/33 [==============================] - 3s 83ms/step - loss: 2.2228e-04 - val_loss: 0.0092
Epoch 18/20
33/33 [==============================] - 3s 86ms/step - loss: 2.4517e-04 - val_loss: 0.0093
Epoch 19/20
33/33 [==============================] - 3s 86ms/step - loss: 2.7179e-04 - val_loss: 0.0053
Epoch 20/20
33/33 [==============================] - 3s 82ms/step - loss: 2.5923e-04 - val_loss: 0.0054
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm (LSTM)                  (None, 50)                10400     
_________________________________________________________________
dense (Dense)                (None, 1)                 51        
=================================================================
Total params: 10,451
Trainable params: 10,451
Non-trainable params: 0
_________________________________________________________________
</code></pre> 
<h2><a id="_443"></a>å…«ã€ç»“æœå¯è§†åŒ–</h2> 
<h3><a id="1loss_445"></a>1.ç»˜åˆ¶losså›¾</h3> 
<pre><code class="prism language-python3">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'loss'</span><span class="token punctuation">]</span>    <span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Training Loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'val_loss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Validation Loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Training and Validation Loss by KåŒå­¦å•Š'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a2/41/vy2VTMxT_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="2_456"></a>2.é¢„æµ‹</h3> 
<pre><code class="prism language-python">predicted_stock_price <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>                        <span class="token comment"># æµ‹è¯•é›†è¾“å…¥æ¨¡å‹è¿›è¡Œé¢„æµ‹</span>
predicted_stock_price <span class="token operator">=</span> sc<span class="token punctuation">.</span>inverse_transform<span class="token punctuation">(</span>predicted_stock_price<span class="token punctuation">)</span>  <span class="token comment"># å¯¹é¢„æµ‹æ•°æ®è¿˜åŸ---ä»ï¼ˆ0ï¼Œ1ï¼‰åå½’ä¸€åŒ–åˆ°åŸå§‹èŒƒå›´</span>
real_stock_price      <span class="token operator">=</span> sc<span class="token punctuation">.</span>inverse_transform<span class="token punctuation">(</span>y_test<span class="token punctuation">)</span><span class="token comment"># å¯¹çœŸå®æ•°æ®è¿˜åŸ---ä»ï¼ˆ0ï¼Œ1ï¼‰åå½’ä¸€åŒ–åˆ°åŸå§‹èŒƒå›´</span>

<span class="token comment"># ç”»å‡ºçœŸå®æ•°æ®å’Œé¢„æµ‹æ•°æ®çš„å¯¹æ¯”æ›²çº¿</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>real_stock_price<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Stock Price'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>predicted_stock_price<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Predicted Stock Price'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Stock Price Prediction by KåŒå­¦å•Š'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Time'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Stock Price'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a3/94/BUGMeWkM_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="3_473"></a>3.è¯„ä¼°</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
MSE  ï¼šå‡æ–¹è¯¯å·®    -----&gt;  é¢„æµ‹å€¼å‡çœŸå®å€¼æ±‚å¹³æ–¹åæ±‚å‡å€¼
RMSE ï¼šå‡æ–¹æ ¹è¯¯å·®  -----&gt;  å¯¹å‡æ–¹è¯¯å·®å¼€æ–¹
MAE  ï¼šå¹³å‡ç»å¯¹è¯¯å·®-----&gt;  é¢„æµ‹å€¼å‡çœŸå®å€¼æ±‚ç»å¯¹å€¼åæ±‚å‡å€¼
R2   ï¼šå†³å®šç³»æ•°ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºåæ˜ æ¨¡å‹æ‹Ÿåˆä¼˜åº¦çš„é‡è¦çš„ç»Ÿè®¡é‡

è¯¦ç»†ä»‹ç»å¯ä»¥å‚è€ƒæ–‡ç« ï¼šhttps://blog.csdn.net/qq_38251616/article/details/107997435
"""</span>
MSE   <span class="token operator">=</span> metrics<span class="token punctuation">.</span>mean_squared_error<span class="token punctuation">(</span>predicted_stock_price<span class="token punctuation">,</span> real_stock_price<span class="token punctuation">)</span>
RMSE  <span class="token operator">=</span> metrics<span class="token punctuation">.</span>mean_squared_error<span class="token punctuation">(</span>predicted_stock_price<span class="token punctuation">,</span> real_stock_price<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">0.5</span>
MAE   <span class="token operator">=</span> metrics<span class="token punctuation">.</span>mean_absolute_error<span class="token punctuation">(</span>predicted_stock_price<span class="token punctuation">,</span> real_stock_price<span class="token punctuation">)</span>
R2    <span class="token operator">=</span> metrics<span class="token punctuation">.</span>r2_score<span class="token punctuation">(</span>predicted_stock_price<span class="token punctuation">,</span> real_stock_price<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å‡æ–¹è¯¯å·®: %.5f'</span> <span class="token operator">%</span> MSE<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å‡æ–¹æ ¹è¯¯å·®: %.5f'</span> <span class="token operator">%</span> RMSE<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å¹³å‡ç»å¯¹è¯¯å·®: %.5f'</span> <span class="token operator">%</span> MAE<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'R2: %.5f'</span> <span class="token operator">%</span> R2<span class="token punctuation">)</span>
</code></pre> 
<pre><code>å‡æ–¹è¯¯å·®: 2688.75170
å‡æ–¹æ ¹è¯¯å·®: 51.85317
å¹³å‡ç»å¯¹è¯¯å·®: 44.97829
R2: 0.74036
</code></pre> 
<p>æ‹Ÿåˆåº¦é™¤äº†æ›´æ¢æ¨¡å‹å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡è°ƒæ•´å‚æ•°æ¥æé«˜ï¼Œè¿™é‡Œä¸»è¦æ˜¯ä»‹ç»LSTMï¼Œå°±ä¸å¯¹è°ƒå‚åšè¯¦ç»†ä»‹ç»äº†ã€‚</p> 
<p>å¾€æœŸç²¾å½©å†…å®¹ï¼š</p> 
<ul><li><a href="https://mtyjkh.blog.csdn.net/article/details/116920825" rel="nofollow"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰å®ç°mnistæ‰‹å†™æ•°å­—è¯†åˆ« | ç¬¬1å¤©</strong></a></li><li><a href="https://mtyjkh.blog.csdn.net/article/details/116992196" rel="nofollow"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰æœè£…å›¾åƒåˆ†ç±» | ç¬¬3å¤©</strong></a></li><li><a href="https://mtyjkh.blog.csdn.net/article/details/117079919" rel="nofollow"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰èŠ±æœµè¯†åˆ« | ç¬¬4å¤©</strong></a></li><li><a href="https://mtyjkh.blog.csdn.net/article/details/117186183" rel="nofollow"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰å¤©æ°”è¯†åˆ« | ç¬¬5å¤©</strong></a></li><li><a href="https://blog.csdn.net/qq_38251616/article/details/117331631"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆVGG-16ï¼‰è¯†åˆ«æµ·è´¼ç‹è‰å¸½ä¸€ä¼™ | ç¬¬6å¤©</strong></a></li><li><a href="https://mtyjkh.blog.csdn.net/article/details/117587326" rel="nofollow"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å·ç§¯ç¥ç»ç½‘ç»œï¼ˆResNet-50ï¼‰é¸Ÿç±»è¯†åˆ« | ç¬¬8å¤©</strong></a></li><li><a href="https://mtyjkh.blog.csdn.net/article/details/117752046" rel="nofollow"><strong>æ·±åº¦å­¦ä¹ 100ä¾‹-å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰è‚¡ç¥¨é¢„æµ‹ | ç¬¬9å¤©</strong></a></li></ul> 
<p><strong>æ¥è‡ªä¸“æ ï¼š</strong><a href="https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&amp;__biz=MzUyNDgyNDkyMQ==&amp;scene=1&amp;album_id=1902502231082352640&amp;count=3#wechat_redirect" rel="nofollow"><strong>ã€Šæ·±åº¦å­¦ä¹ 100ä¾‹ã€‹</strong></a></p> 
<p>å¦‚æœè§‰å¾—æœ¬æ–‡å¯¹ä½ æœ‰å¸®åŠ©è®°å¾— <strong>ç‚¹ä¸ªå…³æ³¨ï¼Œç»™ä¸ªèµï¼ŒåŠ ä¸ªæ”¶è—</strong></p> 
<hr> 
<p>æœ€åå†é€å¤§å®¶ä¸€æœ¬ï¼Œ<strong>å¸®åŠ©å¤§å®¶æ‹¿åˆ° BAT ç­‰ä¸€çº¿å¤§å‚ offer çš„æ•°æ®ç»“æ„åˆ·é¢˜ç¬”è®°</strong>ï¼Œæ˜¯è°·æ­Œå’Œé˜¿é‡Œçš„å¤§ä½¬å†™çš„ï¼Œå¯¹äºç®—æ³•è–„å¼±æˆ–è€…éœ€è¦æé«˜çš„åŒå­¦éƒ½ååˆ†å—ç”¨ï¼ˆæå–ç ï¼š9go2 ï¼‰ï¼š</p> 
<p><a href="https://pan.baidu.com/s/1Ng0CIXc_eiXoBhaiHwZ8xQ" rel="nofollow">è°·æ­Œå’Œé˜¿é‡Œå¤§ä½¬çš„Leetcodeåˆ·é¢˜ç¬”è®°</a></p> 
<p>ä»¥åŠæˆ‘æ•´ç†çš„<strong>7K+æœ¬å¼€æºç”µå­ä¹¦</strong>ï¼Œæ€»æœ‰ä¸€æœ¬å¯ä»¥å¸®åˆ°ä½  ğŸ’–ï¼ˆæå–ç ï¼š4eg0ï¼‰</p> 
<p><a href="https://pan.baidu.com/s/1Uaw7Pd-Y21fVbrzzO3kLVA" rel="nofollow">7K+æœ¬å¼€æºç”µå­ä¹¦</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/92593c5d00c526acc89c1ad3bbb2e316/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">golangå®¹æ˜“å¯¼è‡´å†…å­˜æ³„æ¼çš„å‡ ç§æƒ…å†µ</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9737eb706805732481ff19255928da81/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">æ•°æ®åº“è¡¨è®¾è®¡ä¼˜åŒ–-ä¸»é”®å­—æ®µ</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ITå­¦ä¹ è€…åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>