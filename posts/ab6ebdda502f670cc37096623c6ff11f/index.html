<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C# EPPlus按照Excel模板导出Excel文件 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C# EPPlus按照Excel模板导出Excel文件" />
<meta property="og:description" content="甲方给的Excel模板如下：
我们导出的Excel内容如下：
代码中有详细的注释，如下：
/// &lt;summary&gt; /// 导出按钮点击事件 /// &lt;/summary&gt; /// &lt;param name=&#34;sender&#34;&gt;&lt;/param&gt; /// &lt;param name=&#34;e&#34;&gt;&lt;/param&gt; private void btnExport_Click(object sender, EventArgs e) { ExcelPackage.LicenseContext = LicenseContext.NonCommercial; // 声明EPPlus许可 SaveFileDialog saveFileDialog = new SaveFileDialog(); saveFileDialog.Filter = &#34;*.xlsx|*.xlsx&#34;; saveFileDialog.Title = &#34;导出文件&#34;; saveFileDialog.InitialDirectory = &#34;D:\\&#34;; saveFileDialog.FileName = $&#34;ECU检测记录-{DateTime.Now.ToString(&#34;yyyyMMddHHmmss&#34;)}.xlsx&#34;; DialogResult dialogResult = saveFileDialog.ShowDialog(); if (dialogResult == DialogResult.OK &amp;&amp; !saveFileDialog.FileName.Equals(&#34;&#34;)) { var fileInfo = new FileInfo(saveFileDialog.FileName); using (var pck = new ExcelPackage(fileInfo)) // 打开Excel文件 { string sheetName = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/ab6ebdda502f670cc37096623c6ff11f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-10T18:12:10+08:00" />
<meta property="article:modified_time" content="2022-06-10T18:12:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C# EPPlus按照Excel模板导出Excel文件</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>甲方给的Excel模板如下：<br> <img src="https://images2.imgbox.com/24/9f/DeRtTs4R_o.png" alt="在这里插入图片描述"><br> 我们导出的Excel内容如下：<br> <img src="https://images2.imgbox.com/9d/02/GegfA2YT_o.png" alt="在这里插入图片描述"></p> 
<p>代码中有详细的注释，如下：</p> 
<pre><code class="prism language-csharp"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 导出按钮点击事件</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name="sender"&gt;&lt;/param&gt;</span>
<span class="token comment">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnExport_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	ExcelPackage<span class="token punctuation">.</span>LicenseContext <span class="token operator">=</span> LicenseContext<span class="token punctuation">.</span>NonCommercial<span class="token punctuation">;</span> <span class="token comment">// 声明EPPlus许可</span>
	<span class="token class-name">SaveFileDialog</span> saveFileDialog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SaveFileDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	saveFileDialog<span class="token punctuation">.</span>Filter <span class="token operator">=</span> <span class="token string">"*.xlsx|*.xlsx"</span><span class="token punctuation">;</span>
	saveFileDialog<span class="token punctuation">.</span>Title <span class="token operator">=</span> <span class="token string">"导出文件"</span><span class="token punctuation">;</span>
	saveFileDialog<span class="token punctuation">.</span>InitialDirectory <span class="token operator">=</span> <span class="token string">"D:\\"</span><span class="token punctuation">;</span>
	saveFileDialog<span class="token punctuation">.</span>FileName <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"ECU检测记录-</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">"yyyyMMddHHmmss"</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">.xlsx"</span></span><span class="token punctuation">;</span>
	<span class="token class-name">DialogResult</span> dialogResult <span class="token operator">=</span> saveFileDialog<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>dialogResult <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>OK <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>saveFileDialog<span class="token punctuation">.</span>FileName<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token class-name"><span class="token keyword">var</span></span> fileInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileInfo</span><span class="token punctuation">(</span>saveFileDialog<span class="token punctuation">.</span>FileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> pck <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ExcelPackage</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 打开Excel文件</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token class-name"><span class="token keyword">string</span></span> sheetName <span class="token operator">=</span> <span class="token string">"sheet1"</span><span class="token punctuation">;</span>
			<span class="token class-name">ExcelWorksheet</span> ws <span class="token operator">=</span> pck<span class="token punctuation">.</span>Workbook<span class="token punctuation">.</span>Worksheets<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span>
            <span class="token comment">// 设置表头区域单元格边框、字体加粗以及文字居中显示</span>
			<span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> range <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"A1:J2"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">// Address "A1:J2"</span>
			<span class="token punctuation">{<!-- --></span>
				range<span class="token punctuation">.</span>Style<span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Bold <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
				range<span class="token punctuation">.</span>Style<span class="token punctuation">.</span>Fill<span class="token punctuation">.</span>PatternType <span class="token operator">=</span> ExcelFillStyle<span class="token punctuation">.</span>Solid<span class="token punctuation">;</span>
				<span class="token comment">//range.Style.Fill.BackgroundColor.SetColor(Color.DarkBlue);</span>
				<span class="token comment">//range.Style.Font.Color.SetColor(Color.White);</span>
				range<span class="token punctuation">.</span>Style<span class="token punctuation">.</span>Border<span class="token punctuation">.</span>Left<span class="token punctuation">.</span>Style <span class="token operator">=</span> ExcelBorderStyle<span class="token punctuation">.</span>Thin<span class="token punctuation">;</span>
				range<span class="token punctuation">.</span>Style<span class="token punctuation">.</span>Border<span class="token punctuation">.</span>Right<span class="token punctuation">.</span>Style <span class="token operator">=</span> ExcelBorderStyle<span class="token punctuation">.</span>Thin<span class="token punctuation">;</span>
				range<span class="token punctuation">.</span>Style<span class="token punctuation">.</span>Border<span class="token punctuation">.</span>Top<span class="token punctuation">.</span>Style <span class="token operator">=</span> ExcelBorderStyle<span class="token punctuation">.</span>Thin<span class="token punctuation">;</span>
				range<span class="token punctuation">.</span>Style<span class="token punctuation">.</span>Border<span class="token punctuation">.</span>Bottom<span class="token punctuation">.</span>Style <span class="token operator">=</span> ExcelBorderStyle<span class="token punctuation">.</span>Thin<span class="token punctuation">;</span>
				range<span class="token punctuation">.</span>Style<span class="token punctuation">.</span>VerticalAlignment <span class="token operator">=</span> ExcelVerticalAlignment<span class="token punctuation">.</span>Center<span class="token punctuation">;</span>
				range<span class="token punctuation">.</span>Style<span class="token punctuation">.</span>HorizontalAlignment <span class="token operator">=</span> ExcelHorizontalAlignment<span class="token punctuation">.</span>Center<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">// 添加表头</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"A1:A2"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Merge <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 合并A1:A2的单元格</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"A1"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"序列号"</span><span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"B1:B2"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Merge <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 合并B1:B2的单元格</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"B1"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"检测次数"</span><span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"C1:C2"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Merge <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"C1"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"车型库"</span><span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"D1:D2"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Merge <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"D1"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"检测时间"</span><span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"E1:E2"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Merge <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"E1"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"检测人员"</span><span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"F1:J1"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Merge <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"F1"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"检测结果"</span><span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"F2"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"CAN1"</span><span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"G2"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"CAN2"</span><span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"H2"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"PP1S"</span><span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"I2"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"RS422"</span><span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"J2"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">"总评"</span><span class="token punctuation">;</span>
			<span class="token comment">// 从List集合中加载数据</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token string">"A3"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">LoadFromCollection</span><span class="token punctuation">(</span>ecu13TestRecordSummList<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> <span class="token keyword">new</span>
			<span class="token punctuation">{<!-- --></span>
				序列号 <span class="token operator">=</span> x<span class="token punctuation">.</span>number<span class="token punctuation">,</span>
				检测次数 <span class="token operator">=</span> x<span class="token punctuation">.</span>testtimes<span class="token punctuation">,</span>
				车型库 <span class="token operator">=</span> x<span class="token punctuation">.</span>cartypelib<span class="token punctuation">,</span>
				检测时间 <span class="token operator">=</span> x<span class="token punctuation">.</span>testendtime<span class="token punctuation">,</span>
				检测人员 <span class="token operator">=</span> x<span class="token punctuation">.</span>testuser<span class="token punctuation">,</span>
				CAN1 <span class="token operator">=</span> x<span class="token punctuation">.</span>can1<span class="token punctuation">,</span>
				CAN2 <span class="token operator">=</span> x<span class="token punctuation">.</span>can2<span class="token punctuation">,</span>
				PP1S <span class="token operator">=</span> x<span class="token punctuation">.</span>pp1s<span class="token punctuation">,</span>
				RS422 <span class="token operator">=</span> x<span class="token punctuation">.</span>rs422<span class="token punctuation">,</span>
				总评 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>evl <span class="token operator">==</span> <span class="token string">"T"</span> <span class="token operator">||</span> x<span class="token punctuation">.</span>evl <span class="token operator">==</span> <span class="token string">"合格"</span><span class="token punctuation">)</span> <span class="token punctuation">?</span> <span class="token string">"合格"</span> <span class="token punctuation">:</span> <span class="token string">"不合格"</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>x<span class="token operator">=&gt;</span>x<span class="token punctuation">.</span>检测时间<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// 设置数据区域单元格边框</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">$"A3:J</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">ws<span class="token punctuation">.</span>Dimension<span class="token punctuation">.</span>End<span class="token punctuation">.</span>Row</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>Style<span class="token punctuation">.</span>Fill<span class="token punctuation">.</span>PatternType <span class="token operator">=</span> ExcelFillStyle<span class="token punctuation">.</span>Solid<span class="token punctuation">;</span> <span class="token comment">// 格式化单元格边框</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">$"A3:J</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">ws<span class="token punctuation">.</span>Dimension<span class="token punctuation">.</span>End<span class="token punctuation">.</span>Row</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>Style<span class="token punctuation">.</span>Border<span class="token punctuation">.</span>Left<span class="token punctuation">.</span>Style <span class="token operator">=</span> ExcelBorderStyle<span class="token punctuation">.</span>Thin<span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">$"A3:J</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">ws<span class="token punctuation">.</span>Dimension<span class="token punctuation">.</span>End<span class="token punctuation">.</span>Row</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>Style<span class="token punctuation">.</span>Border<span class="token punctuation">.</span>Right<span class="token punctuation">.</span>Style <span class="token operator">=</span> ExcelBorderStyle<span class="token punctuation">.</span>Thin<span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">$"A3:J</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">ws<span class="token punctuation">.</span>Dimension<span class="token punctuation">.</span>End<span class="token punctuation">.</span>Row</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>Style<span class="token punctuation">.</span>Border<span class="token punctuation">.</span>Top<span class="token punctuation">.</span>Style <span class="token operator">=</span> ExcelBorderStyle<span class="token punctuation">.</span>Thin<span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">$"A3:J</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">ws<span class="token punctuation">.</span>Dimension<span class="token punctuation">.</span>End<span class="token punctuation">.</span>Row</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>Style<span class="token punctuation">.</span>Border<span class="token punctuation">.</span>Bottom<span class="token punctuation">.</span>Style <span class="token operator">=</span> ExcelBorderStyle<span class="token punctuation">.</span>Thin<span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">$"A3:J</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">ws<span class="token punctuation">.</span>Dimension<span class="token punctuation">.</span>End<span class="token punctuation">.</span>Row</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>Style<span class="token punctuation">.</span>VerticalAlignment <span class="token operator">=</span> ExcelVerticalAlignment<span class="token punctuation">.</span>Center<span class="token punctuation">;</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">$"A3:J</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">ws<span class="token punctuation">.</span>Dimension<span class="token punctuation">.</span>End<span class="token punctuation">.</span>Row</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>Style<span class="token punctuation">.</span>HorizontalAlignment <span class="token operator">=</span> ExcelHorizontalAlignment<span class="token punctuation">.</span>Center<span class="token punctuation">;</span>
			<span class="token comment">// 格式化工作区J列总评的单元格背景颜色</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> ws<span class="token punctuation">.</span>Dimension<span class="token punctuation">.</span>End<span class="token punctuation">.</span>Row<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">$"J</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">i</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"合格"</span><span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">$"J</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">i</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>Style<span class="token punctuation">.</span>Fill<span class="token punctuation">.</span>BackgroundColor<span class="token punctuation">.</span><span class="token function">SetColor</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Green<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置单元格背景颜色</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span>
				<span class="token punctuation">{<!-- --></span>
					ws<span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">$"J</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">i</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>Style<span class="token punctuation">.</span>Fill<span class="token punctuation">.</span>BackgroundColor<span class="token punctuation">.</span><span class="token function">SetColor</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Red<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			ws<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span><span class="token function">AutoFitColumns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 自适应列宽</span>
			pck<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 保存Excel文件</span>
		<span class="token punctuation">}</span>
		<span class="token class-name">DialogResult</span> openResult <span class="token operator">=</span> MessageBoxEx<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"文件</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">fileInfo<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string">已保存，是否打开？"</span></span><span class="token punctuation">,</span> <span class="token string">"询问"</span><span class="token punctuation">,</span> MessageBoxButtonsEx<span class="token punctuation">.</span>YesNo<span class="token punctuation">,</span> MessageBoxIconEx<span class="token punctuation">.</span>Question<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>openResult <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>Yes<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>Process<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token string">"explorer.exe"</span><span class="token punctuation">,</span> fileInfo<span class="token punctuation">.</span>FullName<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c75458fa9bde46248eeb0ed856609dcb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">论文汇报--SIGIR2022--基于用户价格偏好及兴趣偏好的会话推荐</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c040bfc437f24799cbd0401feffdd37e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringBoot启动过程：SpringApplication及SpringApplicationBuilder</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>