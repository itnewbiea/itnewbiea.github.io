<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>医院一号难求？Python抢号报警器帮小姐姐抢号！ - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="医院一号难求？Python抢号报警器帮小姐姐抢号！" />
<meta property="og:description" content="1. 场景
最近有一位小姐姐向我抱怨，说她家宝宝最近要打预防针，受疫情影响，市区定点的社康医院太少，导致预约号基本靠抢，根本是一号难求
每次预约都要一直守在手机旁，不停地刷新页面去抢号，太耽误功夫了，问我有没有办法帮到她？
我分析了一下，功能入口是在微信服务号内部，如果使用 自动化 去抢号，效率会很低，抢号成功率会大减。
因此，我决定花 10 分钟，用 Python 写一段爬虫！
2. 实现步骤 首先，我们在手机端配置手动代理，打开 Charles 或 FD，打开手机的放号界面，进行一次抓包操作
分析界面发出的请求及响应数据，右键复制 cURL 到剪切板
然后，使用下面这个网址将 cURL 转为一段完整的 Python 请求代码，包含：请求头、Cookies 等
https://curl.trillworks.com/
接着，将代码复制到 Pycharm 中，根据第一步抓包获取的数据结构，遍历数据，找出有余号、并且最近的社康医院
result = json.loads(response.text) ym_datas = result.get(&#39;data&#39;).get(&#39;list&#39;) foo = False # 遍历每一个社康 for ym_item in ym_datas: # 地址 address = ym_item.get(&#39;outpAddress&#39;) # 社康名字 ym_name = ym_item.get(&#39;outpName&#39;) # 状态，是否有号 status = ym_item.get(&#39;status&#39;) if status == &#39;1&#39; and ym_name in choices: foo = True break else: pass 最后，一旦发现有指定的社康医院有号放出，立马发出一个 警告语音提醒" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/b98e79605d70c00b9f8e1f65b8de2f1c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-04-08T13:33:13+08:00" />
<meta property="article:modified_time" content="2020-04-08T13:33:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">医院一号难求？Python抢号报警器帮小姐姐抢号！</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>1. 场景</p> 
<p>最近有一位小姐姐向我抱怨，说她家宝宝最近要打预防针，受疫情影响，市区定点的社康医院太少，导致预约号基本靠抢，根本是一号难求</p> 
<p>每次预约都要一直守在手机旁，不停地刷新页面去抢号，太耽误功夫了，问我有没有办法帮到她？</p> 
<p>我分析了一下，功能入口是在微信服务号内部，如果使用 自动化 去抢号，效率会很低，抢号成功率会大减。</p> 
<p>因此，我决定花 10 分钟，用 Python 写一段爬虫！</p> 
<h3>2. 实现步骤</h3> 
<p>首先，我们在<strong>手机端配置手动代理</strong>，打开 Charles 或 FD，打开手机的放号界面，进行一次抓包操作</p> 
<p><img alt="" src="https://images2.imgbox.com/64/e6/jSxgC7Lp_o.png"></p> 
<p>分析界面发出的请求及响应数据，右键复制 cURL 到剪切板</p> 
<p><img alt="" src="https://images2.imgbox.com/75/dd/lCSIevyk_o.png"></p> 
<p>然后，使用下面这个网址将 cURL 转为一段完整的 Python 请求代码，包含：请求头、Cookies 等</p> 
<p><u>https://curl.trillworks.com/</u></p> 
<p><img alt="" src="https://images2.imgbox.com/ea/69/TjftXpa6_o.png"></p> 
<p>接着，将代码复制到 Pycharm 中，根据第一步抓包获取的数据结构，遍历数据，找出有余号、并且最近的社康医院</p> 
<pre>result = json.loads(response.text)

ym_datas = result.get('data').get('list')

foo = False

# 遍历每一个社康
for ym_item in ym_datas:
    # 地址
    address = ym_item.get('outpAddress')
    # 社康名字
    ym_name = ym_item.get('outpName')

    # 状态，是否有号
    status = ym_item.get('status')

    if status == '1' and ym_name in choices:
        foo = True
        break
    else:
        pass</pre> 
<p>最后，一旦发现有指定的社康医院有号放出，立马发出一个 警告语音提醒</p> 
<pre># 发出预警（Mac）
def raise_alarm(voice):
    """
    发出警报（Mac）
    :param voice:
    :return:
    """
    os.system('say %s' % voice)


# 发出预警（PC）
def raise_alarm(voice):
    """
    发出警报（PC）
    :param voice:
    :return:
    """
    import winsound
    winsound.Beep(500, 1000)</pre> 
<h3>3. 最后</h3> 
<p>上面我们只做了一个余票查询的爬虫，大家根据教程可扩展成：先查询后抢票的功能。</p> 
<p>关于抢票功能就暂不演示，大家自行扩展，相信这样完全可以帮助小姐姐解决抢号难的问题。</p> 
<p><strong>这里就不贴代码了，加群：850591259领取三百本电子书~</strong></p> 
<p> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/04964462dc53cac536af5f4e1e7a3253/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ES6 Module与CommonJS模块有何区别？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4857addd94585323c999196c900ad363/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">tree结构递归添加属性</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>