<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Openlayers 投影与坐标转换 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Openlayers 投影与坐标转换" />
<meta property="og:description" content="Openlayers 投影与坐标转换 在初始化map实例时，如果不在view中用projection参数指定投影坐标系，则将会使用默认的空间参考EPSG:3857(Web 墨卡托投影)。后续叠加的图层，都会将数据进行投影转换，确保map在同一个空间参考内。
EPSG(European Petroleum Survey Group，欧洲石油调查组织)负责维护并发布坐标参照系统的数据集参数，以及坐标转换描述。它将已有的椭球体，投影坐标系等及其不同组合都对应着不同的ID号，这个号在EPSG中被称为EPSG code，它代表特定的椭球体、单位、地理坐标系或投影坐标系等信息。
Openlayers中的指定空间参考可以直接使用EPSG code指定，如EPSG:4326，因为ol.proj.Projection已经帮我们定义好EPSG:4326和EPSG:3857这两个空间参考的参数，同时也为这两个空间参考定义了一些别名，如EPSG:3857的EPSG:102100、EPSG:102113、EPSG:900913这些曾用名，也有用于识别GML要素的http://www.opengis.net/gml/srs/epsg.xml#3857和urn:ogc:def:crs:EPSG:6.18:3:3857。
空间参考的别名可以使用proj4js的defs()方法添加：
proj4.defs(&#39;urn:x-ogc:def:crs:EPSG:4326&#39;, proj4.defs(&#39;EPSG:4326&#39;)); ol对于其他空间参考，可以使用proj4js进行自定义。defs()方法定义，register()方法进行注册。
proj4js是一个JavaScript库，是一个强大的通用坐标转换引擎，可以同时进行大规模地图投影和高精密度的坐标转换。
proj4.defs( &#39;EPSG:21781&#39;, &#39;&#43;proj=somerc &#43;lat_0=46.95240555555556 &#43;lon_0=7.439583333333333 &#43;k_0=1 &#39; &#43; &#39;&#43;x_0=600000 &#43;y_0=200000 &#43;ellps=bessel &#39; &#43; &#39;&#43;towgs84=660.077,13.551,369.344,2.484,1.783,2.939,5.66 &#43;units=m &#43;no_defs&#39; ); register(proj4); 自定义的投影必须是在https://epsg.io/可以找到的才有效。
常用参数列表：
参数描述&#43;proj投影名称，安装proj后可以使用proj - l命令查看支持的投影名称&#43;lat_0维度起点&#43;lon_0中央经线&#43;x_0东（伪）偏移量&#43;y_0北（伪）偏移量&#43;ellps椭球体名称,使用proj -le 命令查看支持哪些椭球体&#43;units水平单位，meters（米）。使用proj -lu命令查看PROJ支持的单位&#43;lat_ts有效纬度范围&#43;a椭球体长半轴长度&#43;b椭球体短半轴长度&#43;k比例系数（比例因子），旧版本，不赞成使用&#43;k_0比例系数（比例因子）&#43;vunits垂直单位&#43;datum基准面名称，使用proj -ld命令查看支持的基准面&#43;towgs843参数或7参数基面转换&#43;to_meter将水平单位转换为米计算输出转换参数，如：1英尺=&#43;no_defs不要使用proj库中的缺省定义文件。 下面使用OSM地图作为示例图层，定义CGCS2000的空间参考。
&lt;!doctype html&gt; &lt;html&gt; &lt;head&gt; &lt;link rel=&#34;stylesheet&#34; href=&#34;css/ol.css&#34; type=&#34;text/css&#34;&gt; &lt;style&gt; .map { height: 85vh; width: 100%; } &lt;/style&gt; &lt;script src=&#34;lib/ol.js&#34;&gt;&lt;/script&gt; &lt;!--引入proj4.js--&gt; &lt;script src=&#34;lib/proj4.js&#34;&gt;&lt;/script&gt; &lt;title&gt;OpenLayers example&lt;/title&gt; &lt;meta charset=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/a61387d76ebd39fbdf2be3820ab5e215/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-25T14:45:50+08:00" />
<meta property="article:modified_time" content="2020-12-25T14:45:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Openlayers 投影与坐标转换</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="Openlayers__0"></a>Openlayers 投影与坐标转换</h3> 
<p>在初始化<code>map</code>实例时，如果不在<code>view</code>中用<code>projection</code>参数指定投影坐标系，则将会使用默认的空间参考<code>EPSG:3857</code>(Web 墨卡托投影)。后续叠加的图层，都会将数据进行投影转换，确保<code>map</code>在同一个空间参考内。</p> 
<blockquote> 
 <p><code>EPSG</code>(European Petroleum Survey Group，欧洲石油调查组织)负责维护并发布坐标参照系统的数据集参数，以及坐标转换描述。它将已有的椭球体，投影坐标系等及其不同组合都对应着不同的ID号，这个号在<code>EPSG</code>中被称为<code>EPSG code</code>，它代表特定的椭球体、单位、地理坐标系或投影坐标系等信息。</p> 
</blockquote> 
<p><code>Openlayers</code>中的指定空间参考可以直接使用<code>EPSG code</code>指定，如<code>EPSG:4326</code>，因为<code>ol.proj.Projection</code>已经帮我们定义好<code>EPSG:4326</code>和<code>EPSG:3857</code>这两个空间参考的参数，同时也为这两个空间参考定义了一些别名，如<code>EPSG:3857</code>的<code>EPSG:102100</code>、<code>EPSG:102113</code>、<code>EPSG:900913</code>这些曾用名，也有用于识别<code>GML</code>要素的<code>http://www.opengis.net/gml/srs/epsg.xml#3857</code>和<code>urn:ogc:def:crs:EPSG:6.18:3:3857</code>。</p> 
<p>空间参考的别名可以使用<code>proj4js</code>的<code>defs()</code>方法添加：</p> 
<pre><code class="prism language-javascript">proj4<span class="token punctuation">.</span><span class="token function">defs</span><span class="token punctuation">(</span><span class="token string">'urn:x-ogc:def:crs:EPSG:4326'</span><span class="token punctuation">,</span> proj4<span class="token punctuation">.</span><span class="token function">defs</span><span class="token punctuation">(</span><span class="token string">'EPSG:4326'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><code>ol</code>对于其他空间参考，可以使用<code>proj4js</code>进行自定义。<code>defs()</code>方法定义，<code>register()</code>方法进行注册。</p> 
<blockquote> 
 <p><code>proj4js</code>是一个JavaScript库，是一个强大的通用坐标转换引擎，可以同时进行大规模地图投影和高精密度的坐标转换。</p> 
</blockquote> 
<pre><code class="prism language-javascript">proj4<span class="token punctuation">.</span><span class="token function">defs</span><span class="token punctuation">(</span>
  <span class="token string">'EPSG:21781'</span><span class="token punctuation">,</span>
  <span class="token string">'+proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +k_0=1 '</span> <span class="token operator">+</span>
    <span class="token string">'+x_0=600000 +y_0=200000 +ellps=bessel '</span> <span class="token operator">+</span>
    <span class="token string">'+towgs84=660.077,13.551,369.344,2.484,1.783,2.939,5.66 +units=m +no_defs'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">register</span><span class="token punctuation">(</span>proj4<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>自定义的投影必须是在<a href="https://epsg.io/" rel="nofollow">https://epsg.io/</a>可以找到的才有效。<br> <img src="https://images2.imgbox.com/cb/3d/e4Qk3DTo_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/be/ce/0mKZLmLY_o.png" alt="在这里插入图片描述"><br> 常用参数列表：</p> 
<table><thead><tr><th align="left">参数</th><th>描述</th></tr></thead><tbody><tr><td align="left">+proj</td><td>投影名称，安装<code>proj</code>后可以使用<code>proj - l</code>命令查看支持的投影名称</td></tr><tr><td align="left">+lat_0</td><td>维度起点</td></tr><tr><td align="left">+lon_0</td><td>中央经线</td></tr><tr><td align="left">+x_0</td><td>东（伪）偏移量</td></tr><tr><td align="left">+y_0</td><td>北（伪）偏移量</td></tr><tr><td align="left">+ellps</td><td>椭球体名称,使用<code>proj -le</code> 命令查看支持哪些椭球体</td></tr><tr><td align="left">+units</td><td>水平单位，meters（米）。使用<code>proj -lu</code>命令查看<code>PROJ</code>支持的单位</td></tr><tr><td align="left">+lat_ts</td><td>有效纬度范围</td></tr><tr><td align="left">+a</td><td>椭球体长半轴长度</td></tr><tr><td align="left">+b</td><td>椭球体短半轴长度</td></tr><tr><td align="left">+k</td><td>比例系数（比例因子），旧版本，不赞成使用</td></tr><tr><td align="left">+k_0</td><td>比例系数（比例因子）</td></tr><tr><td align="left">+vunits</td><td>垂直单位</td></tr><tr><td align="left">+datum</td><td>基准面名称，使用<code>proj -ld</code>命令查看支持的基准面</td></tr><tr><td align="left">+towgs84</td><td>3参数或7参数基面转换</td></tr><tr><td align="left">+to_meter</td><td>将水平单位转换为米计算输出转换参数，如：1英尺=</td></tr><tr><td align="left">+no_defs</td><td>不要使用<code>proj</code>库中的缺省定义文件。</td></tr></tbody></table> 
<p>下面使用<code>OSM</code>地图作为示例图层，定义<code>CGCS2000</code>的空间参考。</p> 
<pre><code class="prism language-html"><span class="token doctype">&lt;!doctype html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>css/ol.css<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
        <span class="token selector">.map</span> <span class="token punctuation">{<!-- --></span>
            <span class="token property">height</span><span class="token punctuation">:</span> 85vh<span class="token punctuation">;</span>
            <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lib/ol.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--引入proj4.js--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lib/proj4.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>OpenLayers example<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Projection CGCS2000(EPSG:4490)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>map<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>map<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> shenzhen <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">113.958334</span><span class="token punctuation">,</span> <span class="token number">22.535640</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token comment">//使用proj4.defs()定义投影</span>
    proj4<span class="token punctuation">.</span><span class="token function">defs</span><span class="token punctuation">(</span><span class="token string">"EPSG:4490"</span><span class="token punctuation">,</span> <span class="token string">"+proj=longlat +ellps=GRS80 +no_defs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//使proj4中定义的投影在OpenLayers中可用。</span>
    ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span>proj4<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>proj4<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//创建"EPSG:4490"的Projection实例，Openlayers将可以从Peoj4js中获取转换函数。</span>
    <span class="token keyword">var</span> cgcs2000 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span>Projection</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        code<span class="token punctuation">:</span> <span class="token string">"EPSG:4490"</span><span class="token punctuation">,</span><span class="token comment">//EPSG code</span>
        extent<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        worldExtent<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        units<span class="token punctuation">:</span><span class="token string">"degrees"</span><span class="token comment">//Projection units: `'degrees'`, `'ft'`, `'m'`, `'pixels'`, `'tile-pixels'` or `'us-ft'.</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span><span class="token function">addProjection</span><span class="token punctuation">(</span>cgcs2000<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        target<span class="token punctuation">:</span> <span class="token string">"map"</span><span class="token punctuation">,</span>
        layers<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>Tile</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                source<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>source<span class="token punctuation">.</span>OSM</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        view<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>View</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            center<span class="token punctuation">:</span>ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span><span class="token function">fromLonLat</span><span class="token punctuation">(</span>shenzhen<span class="token punctuation">,</span>cgcs2000<span class="token punctuation">)</span><span class="token punctuation">,</span>
            zoom<span class="token punctuation">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
            projection<span class="token punctuation">:</span> cgcs2000
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>可以将瓦片图层<code>SOM</code>当做底图，再往上叠加图层。<br> 对于矢量数据可以使用<code>ol.proj</code>命名空间下的方法，在客户端进行坐标转换，如：</p> 
<pre><code class="prism language-javascript"><span class="token comment">//将坐标coordinate从“EPSG:3857”转换到“EPSG:4490”</span>
ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">12686109.88955285</span><span class="token punctuation">,</span><span class="token number">2572810.705991532</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"EPSG:3857"</span><span class="token punctuation">,</span><span class="token string">"EPSG:4490"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//添加坐标转换函数</span>
ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span><span class="token function">addCoordinateTransforms</span><span class="token punctuation">(</span><span class="token string">"EPSG:3857"</span><span class="token punctuation">,</span><span class="token string">"EPSG:4490"</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span>coordinate<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token function">proj4</span><span class="token punctuation">(</span><span class="token string">"EPSG:3857"</span><span class="token punctuation">,</span><span class="token string">"EPSG:4490"</span><span class="token punctuation">,</span>coordinate<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span>coordinate<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token function">proj4</span><span class="token punctuation">(</span><span class="token string">"EPSG:4490"</span><span class="token punctuation">,</span><span class="token string">"EPSG:3857"</span><span class="token punctuation">,</span>coordinate<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//将经纬度的coordinate转换到目标空间参考下的坐标，默认是EPSG:3857</span>
ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span><span class="token function">fromLonLat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">113.958334</span><span class="token punctuation">,</span> <span class="token number">22.535640</span><span class="token punctuation">]</span><span class="token punctuation">,</span>cgcs2000<span class="token punctuation">)</span>

<span class="token comment">//将coordinate转换成经纬度</span>
ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span><span class="token function">toLonLat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">12686109.88955285</span><span class="token punctuation">,</span><span class="token number">2572810.705991532</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>上述是对单个coordinate的转换，对于几何要素Geometry及其子类（点、线、面等）可以使用<code>ol.geom.Geometry</code>中的<code>transform()</code>方法转换几何对象中的每组坐标。像<code>GeoJSON</code>、<code>KML</code>、<code>gpx</code>类型的文件可以选择在解析器解析完成得到要素集合后，对每个要素进行转化。</p> 
<p>示例：</p> 
<pre><code class="prism language-html"><span class="token doctype">&lt;!doctype html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>css/ol.css<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
        <span class="token selector">.map</span> <span class="token punctuation">{<!-- --></span>
            <span class="token property">height</span><span class="token punctuation">:</span> 85vh<span class="token punctuation">;</span>
            <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lib/ol.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--引入proj4.js--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lib/proj4.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>OpenLayers example<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Projection CGCS2000(EPSG:4490)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>map<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>map<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
    <span class="token keyword">var</span> shenzhen <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">113.958334</span><span class="token punctuation">,</span> <span class="token number">22.535640</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token comment">//使用proj4.defs()定义投影</span>
    proj4<span class="token punctuation">.</span><span class="token function">defs</span><span class="token punctuation">(</span><span class="token string">"EPSG:4490"</span><span class="token punctuation">,</span> <span class="token string">"+proj=longlat +ellps=GRS80 +no_defs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//使proj4中定义的投影在OpenLayers中可用。</span>
    ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span>proj4<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>proj4<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//创建"EPSG:4490"的Projection实例，Openlayers将可以从Peoj4js中获取转换函数。</span>
    <span class="token keyword">var</span> cgcs2000 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span>Projection</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        code<span class="token punctuation">:</span> <span class="token string">"EPSG:4490"</span><span class="token punctuation">,</span><span class="token comment">//EPSG code</span>
        extent<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        worldExtent<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        units<span class="token punctuation">:</span><span class="token string">"degrees"</span><span class="token comment">//Projection units: `'degrees'`, `'ft'`, `'m'`, `'pixels'`, `'tile-pixels'` or `'us-ft'.</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        target<span class="token punctuation">:</span> <span class="token string">"map"</span><span class="token punctuation">,</span>
        layers<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>Tile</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                source<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>source<span class="token punctuation">.</span>OSM</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        view<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>View</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            center<span class="token punctuation">:</span>ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span><span class="token function">fromLonLat</span><span class="token punctuation">(</span>shenzhen<span class="token punctuation">,</span>cgcs2000<span class="token punctuation">)</span><span class="token punctuation">,</span>
            zoom<span class="token punctuation">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
            projection<span class="token punctuation">:</span> cgcs2000
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">var</span> geojson <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>source<span class="token punctuation">.</span>Vector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"data/geojson/test.json"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> features <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>format<span class="token punctuation">.</span>GeoJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFeatures</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>features<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            features<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token string">"EPSG:3857"</span><span class="token punctuation">,</span><span class="token string">"EPSG:4490"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        geojson<span class="token punctuation">.</span><span class="token function">addFeatures</span><span class="token punctuation">(</span>features<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">var</span> testLayer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>Vector</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        source<span class="token punctuation">:</span> geojson
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>testLayer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>效果：<br> <img src="https://images2.imgbox.com/77/04/79rZS7n5_o.png" alt="在这里插入图片描述"><br> <code>test.json</code>数据文件：</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"FeatureCollection"</span><span class="token punctuation">,</span>
  <span class="token string">"crs"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"name"</span><span class="token punctuation">,</span>
    <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"urn:ogc:def:crs:EPSG:3857"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"features"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span>
      <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Feature"</span><span class="token punctuation">,</span>
      <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">"geometry"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Point"</span><span class="token punctuation">,</span>
        <span class="token string">"coordinates"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token number">12686109.88955285</span><span class="token punctuation">,</span>
          <span class="token number">2572810.705991532</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span>
      <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Feature"</span><span class="token punctuation">,</span>
      <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">"geometry"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Point"</span><span class="token punctuation">,</span>
        <span class="token string">"coordinates"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token number">12683644.795390654</span><span class="token punctuation">,</span>
          <span class="token number">2568835.9805207034</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span>
      <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Feature"</span><span class="token punctuation">,</span>
      <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">"geometry"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"LineString"</span><span class="token punctuation">,</span>
        <span class="token string">"coordinates"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">[</span>
            <span class="token number">12673134.704001442</span><span class="token punctuation">,</span>
            <span class="token number">2577473.364716928</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>
            <span class="token number">12671453.089379169</span><span class="token punctuation">,</span>
            <span class="token number">2571625.932053112</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>
            <span class="token number">12689186.479941329</span><span class="token punctuation">,</span>
            <span class="token number">2580358.8625346934</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>
            <span class="token number">12677606.270156125</span><span class="token punctuation">,</span>
            <span class="token number">2580435.2995629786</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>对于服务类型的数据，像<code>WFS</code>、<code>WMS</code>服务可以在请求中使用<code>srsname</code>或<code>CRS</code>参数指定返回要素的空间参考，将坐标转换的工作在服务端完成。</p> 
<p>示例：</p> 
<pre><code class="prism language-html"><span class="token doctype">&lt;!doctype html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>css/ol.css<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
      <span class="token selector">.map</span> <span class="token punctuation">{<!-- --></span>
        <span class="token property">height</span><span class="token punctuation">:</span> 85vh<span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lib/ol.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lib/proj4.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>OpenLayers example<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Projection：加载GeoServer的WFS服务<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>map<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>map<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
        <span class="token comment">//使用proj4.defs()定义投影</span>
        proj4<span class="token punctuation">.</span><span class="token function">defs</span><span class="token punctuation">(</span><span class="token string">"EPSG:4490"</span><span class="token punctuation">,</span> <span class="token string">"+proj=longlat +ellps=GRS80 +no_defs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//使proj4中定义的投影在OpenLayers中可用。</span>
        ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span>proj4<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>proj4<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//创建"EPSG:4490"的Projection实例，Openlayers将可以从Peoj4js中获取转换函数。</span>
        <span class="token keyword">var</span> cgcs2000 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span>Projection</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            code<span class="token punctuation">:</span> <span class="token string">"EPSG:4490"</span><span class="token punctuation">,</span><span class="token comment">//EPSG code</span>
            extent<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            worldExtent<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            units<span class="token punctuation">:</span><span class="token string">"degrees"</span><span class="token comment">//Projection units: `'degrees'`, `'ft'`, `'m'`, `'pixels'`, `'tile-pixels'` or `'us-ft'.</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        <span class="token keyword">var</span> nyc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">73.92722</span><span class="token punctuation">,</span><span class="token number">40.774221</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            layers<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>Tile</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    source<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>source<span class="token punctuation">.</span>OSM</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>Vector</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    source<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>source<span class="token punctuation">.</span>Vector</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                        format<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>format<span class="token punctuation">.</span>GeoJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        url<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>extent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token comment">//直接返回WFS的GetFeature接口访问地址，设置outputFormat为json格式和format中的解析器一致</span>
                            <span class="token comment">//使用srsname指定返回要素的空间参考：srsname=EPSG:4490</span>
                            <span class="token keyword">return</span> <span class="token string">'http://localhost:8080/geoserver/wfs?service=WFS&amp;'</span> <span class="token operator">+</span>
                                <span class="token string">'version=1.1.0&amp;request=GetFeature&amp;typename=tiger:tiger_roads&amp;'</span> <span class="token operator">+</span>
                                <span class="token string">'outputFormat=application/json&amp;srsname=EPSG:4490&amp;'</span> <span class="token operator">+</span>
                                <span class="token string">'bbox='</span> <span class="token operator">+</span> extent<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">',EPSG:4490'</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token comment">/*
                        * 加载策略，可选值：
                        *   all，一次性加载所有的要素；
                        *   bbox，加载地图当前视图范围内的要素；
                        *   tile，基于瓦片格网加载要素
                        */</span>
                        strategy<span class="token punctuation">:</span> ol<span class="token punctuation">.</span>loadingstrategy<span class="token punctuation">.</span>bbox
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                vecLayer
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            target<span class="token punctuation">:</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'map'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            view<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>View</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                center<span class="token punctuation">:</span> nyc<span class="token punctuation">,</span>
                maxZoom<span class="token punctuation">:</span> <span class="token number">19</span><span class="token punctuation">,</span>
                zoom<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
                projection<span class="token punctuation">:</span> cgcs2000
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c9/42/PEuFGIgt_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    layers<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>Tile</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            source<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>source<span class="token punctuation">.</span>OSM</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>Tile</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            source<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>source<span class="token punctuation">.</span>TileWMS</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                url<span class="token punctuation">:</span> <span class="token string">'http://localhost:8080/geoserver/tiger/ows'</span><span class="token punctuation">,</span>
                params<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">//WIDTH, HEIGHT, BBOX and CRS (SRS for WMS version &lt; 1.3.0) 将被动态设置.</span>
                    <span class="token string">'LAYERS'</span><span class="token punctuation">:</span> <span class="token string">'tiger:tiger_roads'</span><span class="token punctuation">,</span>
                    <span class="token string">'TILED'</span><span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token string">'VERSION'</span><span class="token punctuation">:</span><span class="token string">'1.1.0'</span><span class="token punctuation">,</span>
                    <span class="token string">'TRANSPARENT'</span><span class="token punctuation">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//</span>
                    <span class="token string">'CRS'</span><span class="token punctuation">:</span><span class="token string">"EPSG:4490"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token comment">//远程WMS服务器的类型</span>
                serverType<span class="token punctuation">:</span> <span class="token string">'geoserver'</span><span class="token punctuation">,</span>
                <span class="token comment">// 用于渲染的不透明度过渡的持续时间。要禁用不透明过渡，设置transition为: 0</span>
                transition<span class="token punctuation">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    target<span class="token punctuation">:</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'map'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    view<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>View</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        center<span class="token punctuation">:</span> nyc<span class="token punctuation">,</span>
        maxZoom<span class="token punctuation">:</span> <span class="token number">19</span><span class="token punctuation">,</span>
        zoom<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
        projection<span class="token punctuation">:</span> cgcs2000
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/72/dd/GFoYGZDY_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_373"></a>参考文章</h4> 
<p>[1] <a href="https://github.com/proj4js/proj4js">proj4js</a> <code>https://github.com/proj4js/proj4js</code></p> 
<p>[2] <a href="https://www.cnblogs.com/eshinex/p/10301739.html" rel="nofollow">PROJ.4学习–坐标转换</a> <code>https://www.cnblogs.com/eshinex/p/10301739.html</code></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5a4edec364ad08b4688bfeb7f73d1e0d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">springboot中使用RSA加密实现密码信息的密文传输</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/625cbb48b430be4100fe5916ba38e38f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">UWB测距数据处理java源码</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>