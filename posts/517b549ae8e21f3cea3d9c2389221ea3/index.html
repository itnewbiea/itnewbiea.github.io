<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Django 8 通用视图基础 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Django 8 通用视图基础" />
<meta property="og:description" content="1. 什么是通用视图 1. 在terminal 输入 django-admin startapp the_12回车
2. tutorial\settings.py 注册 INSTALLED_APPS = [ &#39;django.contrib.admin&#39;, &#39;django.contrib.auth&#39;, &#39;django.contrib.contenttypes&#39;, &#39;django.contrib.sessions&#39;, &#39;django.contrib.messages&#39;, &#39;django.contrib.staticfiles&#39;, &#34;the_3&#34;, &#34;the_5&#34;, &#34;the_6&#34;, &#34;the_7&#34;, &#34;the_8&#34;, &#34;the_9&#34;, &#34;the_10&#34;, &#34;the_12&#34;, ] 3. tutorial\urls.py
urlpatterns = [ path(&#39;admin/&#39;, admin.site.urls), path(&#39;the_3/&#39;, include(&#39;the_3.urls&#39;)), path(&#39;the_4/&#39;, include(&#39;the_4.urls&#39;)), path(&#39;the_5/&#39;, include(&#39;the_5.urls&#39;)), path(&#39;the_7/&#39;, include(&#39;the_7.urls&#39;)), path(&#39;the_10/&#39;, include(&#39;the_10.urls&#39;)), path(&#39;the_12/&#39;, include(&#39;the_12.urls&#39;)), ] 4. the_12\views.py
from django.http import JsonResponse from django.shortcuts import render from django.views import View # Create your views here. class Chello(View): def get(self,request): return JsonResponse({&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/517b549ae8e21f3cea3d9c2389221ea3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-04T12:45:11+08:00" />
<meta property="article:modified_time" content="2024-01-04T12:45:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Django 8 通用视图基础</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>1. 什么是通用视图 </h2> 
<p>1. 在terminal 输入 django-admin startapp the_12回车</p> 
<p>2. tutorial\settings.py 注册 </p> 
<pre><code class="language-python">INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    "the_3",
    "the_5",
    "the_6",
    "the_7",
    "the_8",
    "the_9",
    "the_10",
    "the_12",
]</code></pre> 
<p>3.  tutorial\urls.py</p> 
<pre><code class="language-python">urlpatterns = [
    path('admin/', admin.site.urls),
    path('the_3/', include('the_3.urls')),
    path('the_4/', include('the_4.urls')),
    path('the_5/', include('the_5.urls')),
    path('the_7/', include('the_7.urls')),
    path('the_10/', include('the_10.urls')),
    path('the_12/', include('the_12.urls')),
]</code></pre> 
<p>4. the_12\views.py</p> 
<pre><code class="language-python">from django.http import JsonResponse
from django.shortcuts import render
from django.views import View

# Create your views here.

class Chello(View):
    def get(self,request):
        return JsonResponse({"python": '这是一个get方法'})

    def post(self,request):
        return JsonResponse({"python": '这是一个post方法'})</code></pre> 
<p>5. the_12\urls.py </p> 
<pre><code class="language-python">from django.urls import path
from .views import Chello

urlpatterns = [
    path('index/', Chello.as_view()),
]</code></pre> 
<p>6. 运行tutorial, 点击<a href="http://127.0.0.1:8000/" rel="nofollow" title="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a>，地址栏 <a href="http://127.0.0.1:8000/the_12/index/" rel="nofollow" title="127.0.0.1:8000/the_12/index/">127.0.0.1:8000/the_12/index/</a> 刷新 </p> 
<p><img alt="" height="139" src="https://images2.imgbox.com/e4/30/N0nJf4U0_o.png" width="475"> </p> 
<p>7. 回到the_12\urls.py, 看as_view的源码（ctrl + 点鼠标左键）</p> 
<h2>2.使用通用视图的tips</h2> 
<ul><li>提供了什么功能</li><li>数据从哪里来</li><li>提供了哪些模板变量</li><li>渲染的模板页</li></ul> 
<h2>3.ListView 的使用 </h2> 
<ul><li>如何自定义获取到的列表对象的名字</li><li>如何确定渲染的模板名字</li><li>如何分页展示</li></ul> 
<p>1. the_12\models.py </p> 
<pre><code class="language-python">from django.db import models

# Create your models here.

class SomeThing(models.Model):
    msg = models.CharField(max_length=200)
    is_delete = models.BooleanField()</code></pre> 
<p>2. 迁移， terminal 输入 python .\manage.py makemigrations回车</p> 
<blockquote> 
 <p>Migrations for 'the_12':<br>   the_12\migrations\0001_initial.py<br>     - Create model SomeThing</p> 
</blockquote> 
<p>3. terminal 输入 python .\manage.py migrate回车 </p> 
<blockquote> 
 <p>Operations to perform:<br>   Apply all migrations: admin, auth, contenttypes, sessions, the_10, the_12, the_6, the_8, the_9<br> Running migrations:<br>   Applying the_12.0001_initial... OK</p> 
</blockquote> 
<p>4. the_12\admin.py </p> 
<pre><code class="language-python">from django.contrib import admin
from the_12.models import SomeThing

# Register your models here.

admin.site.register(SomeThing)</code></pre> 
<p>5. <a href="http://127.0.0.1:8000/admin" rel="nofollow" title="浏览器 http://127.0.0.1:8000/admin">浏览器 http://127.0.0.1:8000/admin</a>在SomeThing添加5条数据 </p> 
<p><img alt="" height="348" src="https://images2.imgbox.com/aa/2e/Vkgo7wzG_o.png" width="435"></p> 
<p>6. the_12\views.py 添加以下代码</p> 
<pre><code class="language-python">class MyListView(ListView):
    pass</code></pre> 
<p>7. the_12\urls.py </p> 
<pre><code class="language-python">from django.urls import path
from .views import Chello,MyListView

urlpatterns = [
    path('index/', Chello.as_view()),
    # path 的第二个参数应该是一个函数，as_view就是把Chello这个类变成函数
    path('mylist/', MyListView.as_view()),
]</code></pre> 
<p>8. 浏览器 <a href="http://127.0.0.1:8000/the_12/mylist/" rel="nofollow" title="ImproperlyConfigured at /the_12/mylist/">ImproperlyConfigured at /the_12/mylist/</a></p> 
<p><img alt="" height="209" src="https://images2.imgbox.com/41/d9/XkdIcQQt_o.png" width="1200"></p> 
<p>9. the_12\views.py </p> 
<pre><code class="language-python">from django.http import JsonResponse
from django.shortcuts import render
from django.views import View
from django.views.generic import ListView
from .models import SomeThing

# Create your views here.

class Chello(View):
    def get(self,request):
        return JsonResponse({"python": '这是一个get方法'})

    def post(self,request):
        return JsonResponse({"python": '这是一个post方法'})

class MyListView(ListView):
    model = SomeThing</code></pre> 
<p>10. 刷新网页 </p> 
<p><img alt="" height="162" src="https://images2.imgbox.com/e1/58/z4Pfb4Lt_o.png" width="1046"></p> 
<p>11. 在templates创建the_12文件夹，再在新创建的the_12文件夹内创建一个something_list。html</p> 
<p><img alt="" height="217" src="https://images2.imgbox.com/9f/d9/wfUIRfgB_o.png" width="316"></p> 
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;这是something_list的页面&lt;/h1&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre> 
<p>12. 刷新网页 </p> 
<p><img alt="" height="127" src="https://images2.imgbox.com/58/e0/pYMHrrer_o.png" width="466"></p> 
<p>13. templates\the_12\something_list.html </p> 
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;这是something_list的页面&lt;/h1&gt;
    &lt;ul&gt;
        {% for i in object_list %}
        &lt;li&gt;{<!-- -->{ i.msg }}&lt;/li&gt;
        {% endfor %}
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre> 
<p>14. 刷新网页 </p> 
<p><img alt="" height="265" src="https://images2.imgbox.com/3a/7d/iKWZXCEF_o.png" width="527"></p> 
<p>15. 总结 </p> 
<pre>"""
提供了什么功能
    以列表的形式展示数据的功能
数据从哪里来
    数据从数据库中查询得来的
    model
    queryset
    get_queryset
提供了哪些模板变量
    object_list
    自定义 : context_object_name
    something_list
渲染的模板页
    默认
    模型名的小写_list.html
    自定义:template_name
"""</pre> 
<p>the_12\views.py </p> 
<pre><code class="language-python">from django.http import JsonResponse
from django.shortcuts import render
from django.views import View
from django.views.generic import ListView
from .models import SomeThing

# Create your views here.

class Chello(View):
    def get(self,request):
        return JsonResponse({"python": '这是一个get方法'})

    def post(self,request):
        return JsonResponse({"python": '这是一个post方法'})

class MyListView(ListView):
    # model = SomeThing
    # queryset = SomeThing.objects.all()
    def get_queryset(self):
        queryset = SomeThing.objects.filter(is_delete=0)
        return queryset

    context_object_name = 'panda'
    template_name = 'the_12/huahua.html'</code></pre> 
<p>templates\the_12\something_list.html </p> 
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;这是something_list的页面&lt;/h1&gt;
    &lt;ul&gt;
        {% for i in object_list %}
        &lt;li&gt;{<!-- -->{ i.msg }}&lt;/li&gt;
        {% endfor %}
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre> 
<p>templates\the_12\huahua.html </p> 
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;这是huahua的页面&lt;/h1&gt;
    &lt;ul&gt;
        {% for i in object_list %}
        &lt;li&gt;{<!-- -->{ i.msg }}&lt;/li&gt;
        {% endfor %}
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre> 
<p>16. 分页操作 ， the_12\views.py</p> 
<pre>class MyListView(ListView):
    paginate_by = 2</pre> 
<p>templates\the_12\huahua.html </p> 
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;这是huahua的页面&lt;/h1&gt;
    &lt;ul&gt;
        {% for i in object_list %}
        &lt;li&gt;{<!-- -->{ i.msg }}&lt;/li&gt;
        {% endfor %}
    &lt;/ul&gt;
    {% for page in paginator %}
        &lt;a href=""&gt;{<!-- -->{ page.number }}&lt;/a&gt;
    {% endfor %}
&lt;/body&gt;
&lt;/html&gt;</code></pre> 
<p>刷新网页 </p> 
<p><img alt="" height="225" src="https://images2.imgbox.com/0f/d9/N6WokyT6_o.png" width="446"></p> 
<p>17. the_12\urls.py, 做以下更改 </p> 
<pre>path('mylist/', MyListView.as_view(),name='something')</pre> 
<p>18. templates\the_12\huahua.html </p> 
<pre><code class="language-html">{% for page in paginator %}
        &lt;a href="{% url 'something' %}"&gt;{<!-- -->{ page.number }}&lt;/a&gt;
    {% endfor %}</code></pre> 
<p><img alt="" height="211" src="https://images2.imgbox.com/58/5b/EDxJshnR_o.png" width="457"></p> 
<p>相当于 templates\the_12\huahua.html</p> 
<pre>{% for page in paginator %}
    &lt;a href="{% url 'something' %}?page={<!-- -->{ page.number }}"&gt;{<!-- -->{ page.number }}&lt;/a&gt;
{% endfor %}</pre> 
<p><img alt="" height="232" src="https://images2.imgbox.com/51/2f/gO3ikE8O_o.png" width="494"></p> 
<p>19. 源码分析 </p> 
<pre>class MyListView(ListView):</pre> 
<pre>class ListView(MultipleObjectTemplateResponseMixin, BaseListView):</pre> 
<pre>class MultipleObjectTemplateResponseMixin(TemplateResponseMixin):</pre> 
<p>        the_12/something_list.html</p> 
<p>        自定义了模板名，供程序使用</p> 
<pre>class TemplateResponseMixin:  </pre> 
<p>        主要的作用是找到模板的名字，然后渲染上下文数据</p> 
<pre>class BaseListView(MultipleObjectMixin, View):</pre> 
<p>        重写了get方法</p> 
<pre>class MultipleObjectMixin(ContextMixin):    </pre> 
<pre>        queryset = None
        model = None
        paginate_by = None
        paginate_orphans = 0
        context_object_name = None
</pre> 
<h2>4.常见通用视图可自定义属性</h2>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d06c5a8513aed4e491e7f39e3d02bde6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">介绍一个Python模块，绘制超级惊艳的可视化动图</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e5809721a152b044dd97496ba12b647d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【设计模式】观察者模式</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>