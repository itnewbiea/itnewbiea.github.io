<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于CNN-Lstm负荷预测（Python代码实现） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于CNN-Lstm负荷预测（Python代码实现）" />
<meta property="og:description" content="👨‍🎓个人主页：研学社的博客 💥💥💞💞欢迎来到本博客❤️❤️💥💥
🏆博主优势：🌞🌞🌞博客内容尽量做到思维缜密，逻辑清晰，为了方便读者。
⛳️座右铭：行百里者，半于九十。
📋📋📋本文目录如下：🎁🎁🎁
目录
💥1 概述
📚2 运行结果
🎉3 参考文献
🌈4 python代码、数据
💥1 概述 利用cnn-Lstm提取深层特征，concatenate进行特征融合，进入attention机制，最终输出负荷数值
input.py为读取原始数据，输入的数据为校园综合能源系统数据
attention_model.py输入冷、热、电负荷，提取深层特征，加入attention机制，观察结果，模型流程图保存在attention_model.png
multi_attention_model.py分别利用cnn-Lstm提取冷、热、电负荷深层特征，concatenate进行特征融合，进入attention机制，最终输出负荷数值，模型流程图保存在multi_attention_model.png，bar_1.png为权重柱状图。
📚2 运行结果 部分代码：
# # 单独训练电负荷模型，提取电负荷深层特征 # model, middle = elec_model() # model = load_model(&#34;./elec.h5&#34;) # model.summary() # middle = load_model(&#34;./elec_feature.h5&#34;) # elec_feature = middle.predict(X_test[0, :, 0].reshape((1, 24, 1))) # print(&#34;------------------------&#34;) # print(&#34;elec_feature.shape: &#34;, elec_feature.shape) # (712, 24, 48) # print(elec_feature) # # # weight_Dense_1 = model.get_layer(&#39;elec_feature&#39;).get_weights() # # weight_Dense_1 = np." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/fe8dd3f5783ed23eae3e5f3a936a2778/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-01T10:31:43+08:00" />
<meta property="article:modified_time" content="2023-01-01T10:31:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于CNN-Lstm负荷预测（Python代码实现）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p> 👨‍🎓<strong>个人主页：<strong><a href="https://blog.csdn.net/weixin_46039719?type=blog" title="研学社的博客">研学社的博客</a></strong> </strong></p> 
 <p></p> 
</blockquote> 
<blockquote> 
 <p>💥💥💞💞<strong>欢迎来到本博客</strong>❤️❤️💥💥</p> 
 <p></p> 
 <p></p> 
 <p><strong><strong>🏆博主优势：</strong>🌞🌞🌞</strong><span style="color:#a2e043;">博客内容尽量做到思维缜密，逻辑清晰，为了方便读者。</span></p> 
 <p></p> 
 <p></p> 
 <p>⛳️<strong>座右铭：</strong><span style="color:#956fe7;">行百里者，半于九十。</span></p> 
 <p></p> 
 <p>📋📋📋<u><strong>本文目录如下：</strong></u>🎁🎁🎁</p> 
 <p id="main-toc"><strong>目录</strong></p> 
 <p id="%F0%9F%92%A51%20%E6%A6%82%E8%BF%B0-toc" style="margin-left:40px;"><a href="#%F0%9F%92%A51%20%E6%A6%82%E8%BF%B0" rel="nofollow">💥1 概述</a></p> 
 <p id="%F0%9F%93%9A2%20%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C-toc" style="margin-left:40px;"><a href="#%F0%9F%93%9A2%20%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C" rel="nofollow">📚2 运行结果</a></p> 
 <p id="%F0%9F%8E%893%C2%A0%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE-toc" style="margin-left:40px;"><a href="#%F0%9F%8E%893%C2%A0%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE" rel="nofollow">🎉3 参考文献</a></p> 
 <p id="%F0%9F%8C%884%20python%E4%BB%A3%E7%A0%81%E3%80%81%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#%F0%9F%8C%884%20python%E4%BB%A3%E7%A0%81%E3%80%81%E6%95%B0%E6%8D%AE" rel="nofollow">🌈4 python代码、数据</a></p> 
 <hr id="hr-toc"> 
 <p></p> 
 <p><img alt="" src="https://images2.imgbox.com/9d/33/oUgUZuUw_o.gif"></p> 
</blockquote> 
<h3 id="%F0%9F%92%A51%20%E6%A6%82%E8%BF%B0"><strong>💥1 概述</strong></h3> 
<p>利用cnn-Lstm提取深层特征，concatenate进行特征融合，进入attention机制，最终输出负荷数值</p> 
<p>input.py为读取原始数据，输入的数据为校园综合能源系统数据</p> 
<p>attention_model.py输入冷、热、电负荷，提取深层特征，加入attention机制，观察结果，模型流程图保存在attention_model.png</p> 
<p>multi_attention_model.py分别利用cnn-Lstm提取冷、热、电负荷深层特征，concatenate进行特征融合，进入attention机制，最终输出负荷数值，模型流程图保存在multi_attention_model.png，bar_1.png为权重柱状图。</p> 
<p>                     <img alt="" src="https://images2.imgbox.com/8e/94/UW9AWy00_o.png"></p> 
<h3 id="%F0%9F%93%9A2%20%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><strong>📚</strong><strong>2 运行结果</strong></h3> 
<p><img alt="" src="https://images2.imgbox.com/35/61/1Sl9P4wn_o.png"></p> 
<p><img alt="" src="https://images2.imgbox.com/70/4b/aLMKFpHh_o.png">                              <img alt="" src="https://images2.imgbox.com/f1/b0/p7Wxo5RJ_o.png"> </p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/7c/16/SuFjQOw0_o.png"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/c8/b0/uPADJsk4_o.png"> <img alt="" src="https://images2.imgbox.com/28/01/gT6PGN6C_o.png"></p> 
<p> 部分代码：</p> 
<pre># # 单独训练电负荷模型，提取电负荷深层特征
# model, middle = elec_model()
# model = load_model("./elec.h5")
# model.summary()
# middle = load_model("./elec_feature.h5")
# elec_feature = middle.predict(X_test[0, :, 0].reshape((1, 24, 1)))
# print("------------------------")
# print("elec_feature.shape: ", elec_feature.shape)  # (712, 24, 48)
# print(elec_feature)
#
# # weight_Dense_1 = model.get_layer('elec_feature').get_weights()
# # weight_Dense_1 = np.array(weight_Dense_1)
# # print("weight_Dense_1[0].shape: ", weight_Dense_1[0].shape)
# # print("weight_Dense_1: ", weight_Dense_1)
# # # print("bias_Dense_1: ", bias_Dense_1)


def cool_model():
    time_steps = 24
    input_dim = 1
    lstm_units = 48
    epoch = 200
    batch_size = 48

    input_tensor = Input(shape=(time_steps, input_dim), name='cool_input')
    cnn_out = Conv1D(filters=64, kernel_size=1, activation='relu', name="cool_cnn")(input_tensor)
    hidden_1 = Dropout(0.3, name='cool_dropout1')(cnn_out)
    lstm_out = CuDNNLSTM(lstm_units, return_sequences=True, name='cool_feature')(hidden_1)
    hidden_2 = Dropout(0.3, name='cool_dropout2')(lstm_out)
    hidden_3 = Flatten(name='cool_flatten')(hidden_2)
    output = Dense(1, activation='sigmoid', name='cool_dense')(hidden_3)

    model = Model(input_tensor, output)
    model.summary()

    model.compile(loss='mae', optimizer='adam')
    # plot_model(model, to_file='model.png')
    model.fit(X_train[:, :, 1].reshape((2920, 24, 1)), y_train[:, 1], epochs=epoch, batch_size=batch_size, shuffle=False)

    middle = Model(input_tensor, model.get_layer('cool_feature').output)

    model.save("./cool.h5")
    middle.save("./cool_feature.h5")
    return model, middle
</pre> 
<h3 id="%F0%9F%8E%893%C2%A0%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><strong><strong>🎉3</strong></strong><strong><strong> 参考文献</strong></strong></h3> 
<blockquote> 
 <p>部分理论来源于网络，如有侵权请联系删除。</p> 
</blockquote> 
<p></p> 
<h3 id="%F0%9F%8C%884%20python%E4%BB%A3%E7%A0%81%E3%80%81%E6%95%B0%E6%8D%AE"><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzk0MDMzNzYwOA==&amp;action=getalbum&amp;album_id=2591810113208958977#wechat_redirect" rel="nofollow" title="🌈">🌈</a><strong><strong>4 python代码、数据</strong></strong></h3>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d1361069c214b87ffd01c35e146ad4ca/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">FCN网络详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e79808447805f5c19dc52d4e32b066cf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">搭建Mybatis核心配置文件和mapper接口和映射文件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>