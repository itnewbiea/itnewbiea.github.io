<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>spring boot 多数据源配置（多种数据库） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="spring boot 多数据源配置（多种数据库）" />
<meta property="og:description" content="最近一段时间在使用spring boot开发项目，其中有一个项目用到了多数据源的配置，网上的资料还是不太多，走了好多才找到一个合适的，把自己写的分享一下，做个笔记，以后也许有用，第一次写博客，不好勿喷！！
首先介绍下我的业务场景，此项目用到了两种数据库，一个是mysql，另一个是sqlserver，
首先第一步需要在application.yml中将多数据源的配置信息进行配置，
mysql数据源：
spring:
datasource:
driverClassName: com.mysql.jdbc.Driver
url: jdbc:mysql://192.168.28.230:3306/****?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true
username: ****
password: ****
sqlserver数据源配置 custom:
datasource:
names: ds1
ds1:
driverClassName: com.microsoft.sqlserver.jdbc.SQLServerDriver
url: jdbc:sqlserver://ip:1433;databaseName=数据库名称
username: ****
password: ****
第二步编写数据源的配置和加载类：
SQLserver数据源 @Configuration
@MapperScan(basePackages = RdsDataSourceConfig.PACKAGE, sqlSessionFactoryRef = &#34;rdsSessionFactory&#34;)
public class RdsDataSourceConfig {
static final String PACKAGE = &#34;com.jyall.ehr.kaoqin&#34;; //本项目中用的是mybatis，此路径为扫描的mapper的包结构
@Value(&#34;${custom.datasource.ds1.url}&#34;) //第一步中配置文件中的数据库配置信息
private String dbUrl;
@Value(&#34;${custom.datasource.ds1.username}&#34;)//同理为配置文件中信息
private String dbUser;
@Value(&#34;${custom.datasource.ds1.password}&#34;)//同理为配置文件信息
private String dbPassword;
@Bean(name = &#34;rdsDatasource&#34;)
public DataSource rdsDataSource() {" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8d6dbf450057b804da57d5ed77e260bf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-06-14T17:29:00+08:00" />
<meta property="article:modified_time" content="2016-06-14T17:29:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">spring boot 多数据源配置（多种数据库）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <p>最近一段时间在使用spring boot开发项目，其中有一个项目用到了多数据源的配置，网上的资料还是不太多，走了好多才找到一个合适的，把自己写的分享一下，做个笔记，以后也许有用，第一次写博客，不好勿喷！！</p> 
 <p>首先介绍下我的业务场景，此项目用到了两种数据库，一个是mysql，另一个是sqlserver，</p> 
 <p>首先第一步需要在application.yml中将多数据源的配置信息进行配置，</p> 
 <p>mysql数据源：</p> 
 <pre>spring:<br>  datasource:<br>    driverClassName: com.mysql.jdbc.Driver<br>    url: jdbc:mysql://192.168.28.230:3306/****?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true<br>    username: ****<br>    password: ****<br><br>sqlserver数据源配置</pre> 
 <pre>custom:<br>  datasource:<br>    names: ds1<br>    ds1:<br>      driverClassName: com.microsoft.sqlserver.jdbc.SQLServerDriver<br>      url: jdbc:sqlserver://ip:1433;databaseName=数据库名称<br>      username: ****<br>      password: ****<br><br>第二步编写数据源的配置和加载类：<br>SQLserver数据源</pre> 
 <pre>@Configuration<br>@MapperScan(basePackages = RdsDataSourceConfig.PACKAGE, sqlSessionFactoryRef = "rdsSessionFactory")<br>public class RdsDataSourceConfig {<!-- --><br>    static final String PACKAGE = "com.jyall.ehr.kaoqin";   <span style="color:#ff0000;">//本项目中用的是mybatis，此路径为扫描的mapper的包结构</span><br>    @Value("${custom.datasource.ds1.url}") <span style="color:#ff0000;">//第一步中配置文件中的数据库配置信息</span><br>    private String dbUrl;<br>    @Value("${custom.datasource.ds1.username}")<span style="color:#ff0000;">//同理为配置文件中信息</span><br>    private String dbUser;<br>    @Value("${custom.datasource.ds1.password}")<span style="color:#ff0000;">//同理为配置文件信息</span><br>    private String dbPassword;<br><br>    @Bean(name = "rdsDatasource")<br>    public DataSource rdsDataSource() {<!-- --><br>        DataSource dataSource = new DataSource();<br>        dataSource.setDriverClassName("com.microsoft.sqlserver.jdbc.SQLServerDriver");<br>        dataSource.setUrl(dbUrl);<br>        dataSource.setUsername(dbUser);<br>        dataSource.setPassword(dbPassword);<br>        return dataSource;<br>    }<br><br>    @Bean(name = "rdsTransactionManager")<br>    public DataSourceTransactionManager rdsTransactionManager(@Qualifier("rdsDatasource") DataSource adsDataSource) {<!-- --><br>        return new DataSourceTransactionManager(rdsDataSource());<br>    }<br><br>    @Bean(name = "rdsSessionFactory") <br>    public SqlSessionFactory adsSqlSessionFactory(@Qualifier("rdsDatasource") DataSource adsDataSource) throws Exception {<!-- --><br>        final SqlSessionFactoryBean sessionFactory = new SqlSessionFactoryBean();<br>        sessionFactory.setDataSource(adsDataSource);<br>        return sessionFactory.getObject();<br>    }<br>}<br><br>mysql数据源</pre> 
 <pre>@Configuration<br>@MapperScan(basePackages = AdsDataSourceConfig.PACKAGE, sqlSessionFactoryRef = "adsSqlSessionFactory")<br>public class AdsDataSourceConfig {<!-- --><br>    static final String PACKAGE = "com.jyall.ehr.mapper";  <span style="color:#ff0000;">//扫描的mapper包结构</span><br><br>    @Value("${spring.datasource.url}") <span style="color:#ff0000;">//配置文件中的配置</span><br>    private String dbUrl;<br>    @Value("${spring.datasource.username}") <span style="color:#ff0000;">//配置文件中的配置</span><br>    private String dbUser;<br>    @Value("${spring.datasource.password}") <span style="color:#ff0000;">//配置文件中的配置</span><br>    private String dbPassword;<br><br>    @Bean(name = "adsDataSource")<br>    @Primary   <span style="color:#ff0000;">//此注解表示在默认的数据源配置，即在默认配置时用到的数据源配置</span><br>    public DataSource adsDataSource() {<!-- --><br>        DataSource dataSource = new DataSource();<br>        dataSource.setDriverClassName("com.mysql.jdbc.Driver");<br>        dataSource.setUrl(dbUrl);<br>        dataSource.setUsername(dbUser);<br>        dataSource.setPassword(dbPassword);<br>        return dataSource;<br>    }<br><br>    @Bean(name = "adsTransactionManager")<br>    @Primary<br>    public DataSourceTransactionManager adsTransactionManager(@Qualifier("adsDataSource") DataSource adsDataSource) {<!-- --><br>        return new DataSourceTransactionManager(adsDataSource);<br>    }<br><br>    @Bean(name = "adsSqlSessionFactory")<br>    @Primary<br>    public SqlSessionFactory adsSqlSessionFactory(@Qualifier("adsDataSource") DataSource adsDataSource) throws Exception {<!-- --><br>        final SqlSessionFactoryBean sessionFactory = new SqlSessionFactoryBean();<br>        sessionFactory.setDataSource(adsDataSource);<br>        return sessionFactory.getObject();<br>    }<br>}</pre> 
 <pre>至此多数据源的配置都已经完成，其他配置跟但数据源的配置时一样的，不在赘述。。。<br><br></pre> 
</div> 
<p>转载于:https://www.cnblogs.com/lenglengll/p/5584791.html</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/151b26f93fa2ae8fe70aaf6f798bfe77/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">jexus处理静态文件（处理后缀）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/09396d6dc21c7a268d77a3d284c549bb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">chapter1 Java初体验</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>