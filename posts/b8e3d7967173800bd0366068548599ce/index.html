<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python的cryptography库介绍 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python的cryptography库介绍" />
<meta property="og:description" content="Python的cryptography是密码库，源码地址为：https://github.com/pyca/cryptography，最新发布版本为41.0.7,license为Apache 2.0/BSD 3，它支持在Windows、Linux、macOS上使用。如果通过源码编译，需要依赖OpenSSL。Python版本需要为3.7&#43;.
通过pip安装,执行：
pip install cryptography 以下是对称加密AES测试code:
关于OpenSSL AES GCM的介绍可以参考：https://blog.csdn.net/fengbingchun/article/details/106113185
import os from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes def aes_gcm_encrypt(plain_text, key, iv, aad): # Construct an AES-GCM Cipher object with the given key and iv encryptor = Cipher(algorithms.AES(key), modes.GCM(iv),).encryptor() # associated_data will be authenticated but not encrypted, it must also be passed in on decryption encryptor.authenticate_additional_data(aad) # Encrypt the plaintext and get the associated ciphertext. GCM does not require padding cipher_text = encryptor." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/b8e3d7967173800bd0366068548599ce/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-07T10:44:17+08:00" />
<meta property="article:modified_time" content="2024-01-07T10:44:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python的cryptography库介绍</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>      Python的<strong>cryptography是密码库</strong>，源码地址为：https://github.com/pyca/cryptography，最新发布版本为41.0.7,license为Apache 2.0/BSD 3，它支持在Windows、Linux、macOS上使用。如果通过源码编译，需要<strong>依赖OpenSSL</strong>。Python版本需要为3.7+.</p> 
<p>      通过pip安装,执行：</p> 
<pre><code class="language-bash">pip install cryptography</code></pre> 
<p>      以下是对称加密AES测试code:</p> 
<p>      关于OpenSSL AES GCM的介绍可以参考：<a class="link-info" href="https://blog.csdn.net/fengbingchun/article/details/106113185" title="https://blog.csdn.net/fengbingchun/article/details/106113185">https://blog.csdn.net/fengbingchun/article/details/106113185</a></p> 
<pre><code class="language-python">import os
from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes

def aes_gcm_encrypt(plain_text, key, iv, aad):
    # Construct an AES-GCM Cipher object with the given key and iv
    encryptor = Cipher(algorithms.AES(key), modes.GCM(iv),).encryptor()

    # associated_data will be authenticated but not encrypted, it must also be passed in on decryption
    encryptor.authenticate_additional_data(aad)

    # Encrypt the plaintext and get the associated ciphertext. GCM does not require padding
    cipher_text = encryptor.update(plain_text) + encryptor.finalize()

    return (cipher_text, encryptor.tag)

def aes_gcm_decrypt(cipher_test, key, iv, aad, tag):
    # Construct a Cipher object, with the key, iv, and additionally the GCM tag used for authenticating the message
    decryptor = Cipher(algorithms.AES(key), modes.GCM(iv, tag),).decryptor()

    # We put associated_data back in or the tag will fail to verify when we finalize the decryptor
    decryptor.authenticate_additional_data(aad)

    # Decryption gets us the authenticated plaintext. If the tag does not match an InvalidTag exception will be raised
    return decryptor.update(cipher_test) + decryptor.finalize()

if __name__ == "__main__":
    # reference: https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/
    plain_test = b"https://github.com/fengbingchun"
    key = os.urandom(32) # bytes, secret key: either 128, 192, or 256 bits long
    iv = os.urandom(12) # bytes, initialisation vector
    aad = os.urandom(16) # authenticated encryption with additional data
    print("key: {}\niv: {}\naad: {}\n".format(key, iv, aad))

    cipher_text, tag = aes_gcm_encrypt(plain_test, key, iv, aad)
    print("cipher text: {}\ntag: {}\n".format(cipher_text, tag))

    plain_test2 = aes_gcm_decrypt(cipher_text, key, iv, aad, tag)
    print("before encryption, plaintext:{}\nafter  decryption, plaintext:{}".format(plain_test, plain_test2))

    if plain_test != plain_test2:
        print("Error: the decrypted content does not match the original plaintext")
        raise

    print("test finish")</code></pre> 
<p>      执行结果如下图所示：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/f3/ae/uYlCAdlR_o.png"></p> 
<p>      以下是非对称加密RSA测试code:<br>       关于OpenSSL RSA的介绍可以参考：<a class="link-info" href="https://blog.csdn.net/fengbingchun/article/details/43638013" title="https://blog.csdn.net/fengbingchun/article/details/43638013">https://blog.csdn.net/fengbingchun/article/details/43638013</a></p> 
<p>      通过openssl执行文件生成rsa公钥-私钥对文件rsa_private.pem，密钥对长度为3072，执行如下命令：</p> 
<pre><code class="language-bash">openssl.exe genrsa -out rsa_private.pem 3072</code></pre> 
<pre><code class="language-python">from cryptography.hazmat.primitives.asymmetric import rsa, padding
from cryptography.hazmat.primitives import serialization, hashes

def rsa_public_key_encrypt(plain_text, public_key):
    return public_key.encrypt(
        plain_text,
        padding.OAEP(
            mgf=padding.MGF1(algorithm=hashes.SHA256()),
            algorithm=hashes.SHA256(),
            label=None
        )
    )

def rsa_private_key_decrypt(cipher_test, private_key):
    return private_key.decrypt(
        cipher_test,
        padding.OAEP(
            mgf=padding.MGF1(algorithm=hashes.SHA256()),
            algorithm=hashes.SHA256(),
            label=None
        )
    )

if __name__ == "__main__":
    # reference: https://cryptography.io/en/latest/hazmat/primitives/asymmetric/rsa/
    plain_test = b"https://blog.csdn.net/fengbingchun/"

    with open("test_data/rsa_private.pem", "rb") as key_file:
        private_key = serialization.load_pem_private_key(key_file.read(), password=None,)

    pem = private_key.private_bytes(
        encoding=serialization.Encoding.PEM,
        format=serialization.PrivateFormat.TraditionalOpenSSL,
        encryption_algorithm=serialization.NoEncryption()
    )
    #print("private key: {}\n".format(pem.splitlines()))

    public_key = private_key.public_key()
    pem = public_key.public_bytes(
        encoding=serialization.Encoding.PEM,
        format=serialization.PublicFormat.SubjectPublicKeyInfo
    )
    #print("public key: {}\n".format(pem.splitlines()))

    cipher_text = rsa_public_key_encrypt(plain_test, public_key)
    print("cipher text:{}\n".format(cipher_text))

    plain_test2 = rsa_private_key_decrypt(cipher_text, private_key)
    print("before encryption, plaintext:{}\nafter  decryption, plaintext:{}".format(plain_test, plain_test2))

    if plain_test != plain_test2:
        print("Error: the decrypted content does not match the original plaintext")
        raise

    print("test finish")</code></pre> 
<p>      执行结果如下图所示：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/16/7c/RJcVE64x_o.png"></p> 
<p>      <strong>GitHub</strong>：<a class="link-info" href="https://github.com/fengbingchun/Python_Test" title="https://github.com/fengbingchun/Python_Test">https://github.com/fengbingchun/Python_Test</a></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6da19b4bacb801a93b55e64a0b13f23b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Adobe Photoshop 快捷键</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/23d62e16d87fc9ab7b35f6300767161e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">图神经网络｜5.消息传递的计算方法 6.多层GNN的作用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>