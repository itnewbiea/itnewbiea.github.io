<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java 实现pdf转换成图片 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java 实现pdf转换成图片" />
<meta property="og:description" content="参考1：java实现pdf转换成图片 来源：java 实现pdf转换成图片_ZZ的博客-CSDN博客_java pdf 转图片
1.maven添加jar
&lt;!-- https://mvnrepository.com/artifact/org.apache.pdfbox/fontbox --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt; &lt;artifactId&gt;fontbox&lt;/artifactId&gt; &lt;version&gt;2.0.9&lt;/version&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.apache.pdfbox/pdfbox --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt; &lt;artifactId&gt;pdfbox&lt;/artifactId&gt; &lt;version&gt;2.0.9&lt;/version&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/commons-logging/commons-logging --&gt; &lt;dependency&gt; &lt;groupId&gt;commons-logging&lt;/groupId&gt; &lt;artifactId&gt;commons-logging&lt;/artifactId&gt; &lt;version&gt;1.2&lt;/version&gt; &lt;/dependency&gt; 2.实现代码
/** * 转换全部的pdf * @param fileAddress 文件地址 * @param filename PDF文件名 * @param type 图片类型 */ public static void pdf2png(String fileAddress,String filename,String type) { // 将pdf装图片 并且自定义图片得格式大小 File file = new File(fileAddress&#43;&#34;\\&#34;&#43;filename&#43;&#34;.pdf&#34;); try { PDDocument doc = PDDocument.load(file); PDFRenderer renderer = new PDFRenderer(doc); int pageCount = doc." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/2c2935b776cd8e7ec707be5213ac1cb3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-23T22:18:06+08:00" />
<meta property="article:modified_time" content="2021-11-23T22:18:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java 实现pdf转换成图片</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>参考1：java实现pdf转换成图片</h2> 
<p>来源：<a href="https://blog.csdn.net/z991876960/article/details/82345057" title="java 实现pdf转换成图片_ZZ的博客-CSDN博客_java pdf 转图片">java 实现pdf转换成图片_ZZ的博客-CSDN博客_java pdf 转图片</a></p> 
<p>1.maven添加jar</p> 
<pre><code class="language-XML">&lt;!-- https://mvnrepository.com/artifact/org.apache.pdfbox/fontbox --&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt;
			&lt;artifactId&gt;fontbox&lt;/artifactId&gt;
			&lt;version&gt;2.0.9&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;!-- https://mvnrepository.com/artifact/org.apache.pdfbox/pdfbox --&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt;
			&lt;artifactId&gt;pdfbox&lt;/artifactId&gt;
			&lt;version&gt;2.0.9&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;!-- https://mvnrepository.com/artifact/commons-logging/commons-logging --&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;commons-logging&lt;/groupId&gt;
			&lt;artifactId&gt;commons-logging&lt;/artifactId&gt;
			&lt;version&gt;1.2&lt;/version&gt;
		&lt;/dependency&gt;</code></pre> 
<p> 2.实现代码</p> 
<pre><code class="language-java"> /**
     * 转换全部的pdf
     * @param fileAddress 文件地址
     * @param filename PDF文件名
     * @param type 图片类型
     */
    public static void pdf2png(String fileAddress,String filename,String type) {
        // 将pdf装图片 并且自定义图片得格式大小
        File file = new File(fileAddress+"\\"+filename+".pdf");
        try {
            PDDocument doc = PDDocument.load(file);
            PDFRenderer renderer = new PDFRenderer(doc);
            int pageCount = doc.getNumberOfPages();
            for (int i = 0; i &lt; pageCount; i++) {
                BufferedImage image = renderer.renderImageWithDPI(i, 144); // Windows native DPI
                // BufferedImage srcImage = resize(image, 240, 240);//产生缩略图
                ImageIO.write(image, type, new File(fileAddress+"\\"+filename+"_"+(i+1)+"."+type));
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
 
 
/**
     *自由确定起始页和终止页
     * @param fileAddress 文件地址
     * @param filename pdf文件名
     * @param indexOfStart 开始页  开始转换的页码，从0开始
     * @param indexOfEnd 结束页  停止转换的页码，-1为全部
     * @param type 图片类型
     */
    public static void pdf2png(String fileAddress,String filename,int indexOfStart,int indexOfEnd,String type) {
        // 将pdf装图片 并且自定义图片得格式大小
        File file = new File(fileAddress+"\\"+filename+".pdf");
        try {
            PDDocument doc = PDDocument.load(file);
            PDFRenderer renderer = new PDFRenderer(doc);
            int pageCount = doc.getNumberOfPages();
            for (int i = indexOfStart; i &lt; indexOfEnd; i++) {
                BufferedImage image = renderer.renderImageWithDPI(i, 144); // Windows native DPI
                // BufferedImage srcImage = resize(image, 240, 240);//产生缩略图
                ImageIO.write(image, type, new File(fileAddress+"\\"+filename+"_"+(i+1)+"."+type));
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }</code></pre> 
<h2>参考2：java中pdf转图片的方法</h2> 
<p>来源：<a href="https://www.cnblogs.com/pcheng/p/5704470.html" rel="nofollow" title="JAVA中pdf转图片的方法 - PC君 - 博客园">JAVA中pdf转图片的方法 - PC君 - 博客园</a></p> 
<p>JAVA中实现pdf转图片可以通过第三方提供的架包，这里介绍几种常用的，可以根据自身需求选择使用。</p> 
<p>一、icepdf。有收费版和开源版，几种方法里最推荐的。转换的效果比较好，能识别我手头文件中的中文，就是转换后可能字体的关系部分字间距有点宽。因为，字体支持是要收费的，所以转换的图片会带有官方的水印。去水印的方法可以查看另一篇文章：<strong><a href="http://www.cnblogs.com/pcheng/p/5711660.html" rel="nofollow" title="icepdf去水印方法">icepdf去水印方法</a></strong></p> 
<p>1、下载icepdf的架包，并导入项目中，这里用到4个，如下：</p> 
<p><img alt="" src="https://images2.imgbox.com/25/dc/6DM3DsnB_o.png"></p> 
<p></p> 
<p></p> 
<p></p> 
<p>2、附上代码例子：</p> 
<p></p> 
<pre><code class="language-java">String filePath = "c:/test.pdf";
　　Document document = new Document();
　　document.setFile(filePath);
　　float scale = 2.5f;//缩放比例
　　float rotation = 0f;//旋转角度

　　for (int i = 0; i &lt; document.getNumberOfPages(); i++) {
　　　　BufferedImage image = (BufferedImage)
　　　　document.getPageImage(i, GraphicsRenderingHints.SCREEN, org.icepdf.core.pobjects.Page.BOUNDARY_CROPBOX, rotation, scale);
　　　　RenderedImage rendImage = image;
　　　　try {
    　　　　File file = new File("c:/iecPDF_" + i + ".png");
    　　　　ImageIO.write(rendImage, "png", file);
　　 　　} catch (IOException e) {
    　　　　e.printStackTrace();
　　　　}
    　　image.flush();
　　}
　　document.dispose();</code></pre> 
<p>例子中是pdf转png格式的，也可以将12、13行改成jpg，转出jpg格式的，但是从转换效果来看png的清晰度会相对较高。有个小技巧是12行改成jpg，但13行使用png，也就是转换成jpg格式但有png清晰度的图片。</p> 
<p></p> 
<p>二、pdfbox。转换效果还可以，能识别我手中文件大部分内容，有部分内容无法识别。</p> 
<p>1、下载pdfbox的架包，并导入项目，这里用到2个，如下：</p> 
<p><img alt="" src="https://images2.imgbox.com/90/a3/KkdNK4R3_o.png"></p> 
<p></p> 
<p></p> 
<p>2、附上代码例子：</p> 
<pre><code class="language-java">File file = new File("c:\\test.pdf");
　　try {
　　　　PDDocument doc = PDDocument.load(file);
　　　　PDFRenderer renderer = new PDFRenderer(doc);
　　　　 int pageCount = doc.getNumberOfPages();
　　　　for(int i=0;i&lt;pageCount;i++){
　　　　　　BufferedImage image = renderer.renderImageWithDPI(i, 296);
//          BufferedImage image = renderer.renderImage(i, 2.5f);
　　　　　　ImageIO.write(image, "PNG", new File("C:\\pdfbox_image.png"));
　　　　}
　　} catch (IOException e) {
　　　　e.printStackTrace();
　　}</code></pre> 
<p>例子中rederImageWithDPI的第二个参数为dpi分辨率单位，可根据需求调节大小，代码第八行提供了架包里另一种转图片的方法，第二个参数为缩放比。</p> 
<p></p> 
<p>三、jpedal。效果不太理想，貌似对中文支持不太好，下面的lgpl版本是开源版。</p> 
<p> 1、下载jpedal的架包，并导入项目中，如下：</p> 
<p><img alt="" src="https://images2.imgbox.com/6f/5d/SN1YNQoE_o.png"></p> 
<p></p> 
<p>2、附上代码例子：</p> 
<p></p> 
<pre><code class="language-java">PdfDecoder decode_pdf = new PdfDecoder(true);
　　try {
　　　　decode_pdf.openPdfFile("c:\\test.pdf"); //file
//　　　decode_pdf.openPdfFile("C:/jpedalPDF.pdf", "password"); //encrypted file
//      decode_pdf.openPdfArray(bytes); //bytes is byte[] array with PDF
//      decode_pdf.openPdfFileFromURL("http://www.mysite.com/jpedalPDF.pdf",false);
//      decode_pdf.openPdfFileFromInputStream(in, false);

　　　　int start = 1, end = decode_pdf.getPageCount();
　　　　for(int i = start; i &lt; end+1; i++){
　　　　　　BufferedImage img=decode_pdf.getPageAsImage(i);
　　　　　　try {
　　　　　　　　ImageIO.write(img, "png", new File("C:\\jpedal_image.png"));
　　　　　　} catch (IOException e) {
　　　　　　　　e.printStackTrace();
　　　　　　}
　　　　}
　　　　decode_pdf.closePdfFile();
　　} catch (PdfException e) {
　　　　e.printStackTrace();
　　}</code></pre> 
<h2>参考3：Java中PDF的转换(图片)与展示</h2> 
<p>来源：<a href="https://www.jianshu.com/p/5eb8d26d10d0" rel="nofollow" title="Java中PDF的转换(图片)与展示 - 简书 (jianshu.com)">Java中PDF的转换(图片)与展示 - 简书 (jianshu.com)</a></p> 
<h2>解决的问题</h2> 
<p>有些时候我们需要在项目中展示PDF，但是直接在浏览器中加入PDF展示的插件，存在兼容性问题，某些浏览器显示效果不理想，所以我们可以将PDF转为图片，然后已图片的方式展示，效果很好。</p> 
<p>那么怎么将PDF转为图片呢？有两种方式：</p> 
<table><thead><tr><th>产品</th><th>特点</th></tr></thead><tbody><tr><td>Apache 的 PDF box</td><td>免费；速度稍慢一点，但可以接受</td></tr><tr><td>E-iceblue 的 Spire.PDF for Java</td><td>转换效果很好；速度快；功能强大，支持转多种格式；收费</td></tr></tbody></table> 
<blockquote> 
 <p>Spire.PDF for Java 的转换效果很好，但是如果不购买，转换过后会添加一些水印文字</p> 
</blockquote> 
<p>参考链接：<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.cnblogs.com%2FYesi%2Fp%2F11233238.html" rel="nofollow" title="https://www.cnblogs.com/Yesi/p/11233238.html">https://www.cnblogs.com/Yesi/p/11233238.html</a></p> 
<h2>PDF Box的使用</h2> 
<pre><code class="language-XML">&lt;dependency&gt;
    &lt;groupId&gt;net.sf.cssbox&lt;/groupId&gt;
    &lt;artifactId&gt;pdf2dom&lt;/artifactId&gt;
    &lt;version&gt;1.7&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt;
    &lt;artifactId&gt;pdfbox&lt;/artifactId&gt;
    &lt;version&gt;2.0.12&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt;
    &lt;artifactId&gt;pdfbox-tools&lt;/artifactId&gt;
    &lt;version&gt;2.0.12&lt;/version&gt;
&lt;/dependency&gt;</code></pre> 
<h3>多页PDF生成多张图片</h3> 
<p>新建一个 PdfUtil 工具类</p> 
<pre><code class="language-java">public class PdfUtil {

    private static final org.slf4j.Logger log = org.slf4j.LoggerFactory.getLogger(PdfUtil.class);

    /***
     * PDF文件转PNG图片，全部页数
     *
     * @param pdfFilePath pdf完整路径
     * @param dpi dpi越大转换后越清晰，相对转换速度越慢
     */
    public static void pdf2Image(String pdfFilePath, int dpi) {
        File file = new File(pdfFilePath);
        PDDocument pdDocument;
        try {
            String imgPdfPath = file.getParent();
            int dot = file.getName().lastIndexOf('.');
            // 获取图片文件名
            String imagePdfName = file.getName().substring(0, dot);

            pdDocument = PDDocument.load(file);
            PDFRenderer renderer = new PDFRenderer(pdDocument);
            /* dpi越大转换后越清晰，相对转换速度越慢 */
            PdfReader reader = new PdfReader(pdfFilePath);
            int pages = reader.getNumberOfPages();
            StringBuffer imgFilePath;
            for (int i = 0; i &lt; pages; i++) {
                String imgFilePathPrefix = imgPdfPath + File.separator + imagePdfName;
                imgFilePath = new StringBuffer();
                imgFilePath.append(imgFilePathPrefix);
                imgFilePath.append("_");
                imgFilePath.append((i + 1));
                imgFilePath.append(".png");
                File dstFile = new File(imgFilePath.toString());
                BufferedImage image = renderer.renderImageWithDPI(i, dpi);
                ImageIO.write(image, "png", dstFile);
            }
            log.info("PDF文档转PNG图片成功！");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    
}</code></pre> 
<h3>多页PDF组合成一张图片</h3> 
<pre><code class="language-java">public class PdfUtil {

    public static final int DEFAULT_DPI = 150;

    /**
     * pdf转图片
     * 多页PDF会每页转换为一张图片，下面会有多页组合成一页的方法
     *
     * @param pdfFile pdf文件路径
     * @param outPath 图片输出路径
     * @param dpi 相当于图片的分辨率，值越大越清晰，但是转换时间变长
     */
    public static void pdf2multiImage(String pdfFile, String outPath, int dpi) {
        if (ObjectUtil.isEmpty(dpi)) {
            // 如果没有设置DPI，默认设置为150
            dpi = DEFAULT_DPI;
        }
        try (PDDocument pdf = PDDocument.load(new FileInputStream(pdfFile))) {
            int actSize = pdf.getNumberOfPages();
            List&lt;BufferedImage&gt; picList = Lists.newArrayList();
            for (int i = 0; i &lt; actSize; i++) {
                BufferedImage image = new PDFRenderer(pdf).renderImageWithDPI(i, dpi, ImageType.RGB);
                picList.add(image);
            }
            // 组合图片
            ImageUtil.yPic(picList, outPath);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}</code></pre> 
<p>新建 ImageUtil 类</p> 
<pre><code class="language-java">public class ImageUtil {

    private static final org.slf4j.Logger log = org.slf4j.LoggerFactory.getLogger(ImageUtil.class);

    /**
     * 将宽度相同的图片，竖向追加在一起 ##注意：宽度必须相同
     *
     * @param picList 文件流数组
     * @param outPath 输出路径
     */
    public static void yPic(List&lt;BufferedImage&gt; picList, String outPath) {// 纵向处理图片
        if (picList == null || picList.size() &lt;= 0) {
            log.info("图片数组为空!");
            return;
        }
        try {
            // 总高度
            int height = 0,
                    // 总宽度
                    width = 0,
                    // 临时的高度 , 或保存偏移高度
                    offsetHeight = 0,
                    // 临时的高度，主要保存每个高度
                    tmpHeight = 0,
                    // 图片的数量
                    picNum = picList.size();
            // 保存每个文件的高度
            int[] heightArray = new int[picNum];
            // 保存图片流
            BufferedImage buffer = null;
            // 保存所有的图片的RGB
            List&lt;int[]&gt; imgRgb = new ArrayList&lt;int[]&gt;();
            // 保存一张图片中的RGB数据
            int[] tmpImgRgb;
            for (int i = 0; i &lt; picNum; i++) {
                buffer = picList.get(i);
                // 图片高度
                heightArray[i] = offsetHeight = buffer.getHeight();
                if (i == 0) {
                    // 图片宽度
                    width = buffer.getWidth();
                }
                // 获取总高度
                height += offsetHeight;
                // 从图片中读取RGB
                tmpImgRgb = new int[width * offsetHeight];
                tmpImgRgb = buffer.getRGB(0, 0, width, offsetHeight, tmpImgRgb, 0, width);
                imgRgb.add(tmpImgRgb);
            }
            // 设置偏移高度为0
            offsetHeight = 0;
            // 生成新图片
            BufferedImage imageResult = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);
            for (int i = 0; i &lt; picNum; i++) {
                tmpHeight = heightArray[i];
                if (i != 0) {
                    // 计算偏移高度
                    offsetHeight += tmpHeight;
                }
                // 写入流中
                imageResult.setRGB(0, offsetHeight, width, tmpHeight, imgRgb.get(i), 0, width);
            }
            File outFile = new File(outPath);
            // 写图片
            ImageIO.write(imageResult, "png", outFile);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    
}</code></pre> 
<h2>参考4：使用Java将PDF文件转成图片</h2> 
<p>来源：<a href="http://itindex.net/detail/56207-java-pdf-%E6%96%87%E4%BB%B6" rel="nofollow" title="使用Java将PDF文件转成图片 | IT瘾 (itindex.net)">使用Java将PDF文件转成图片 | IT瘾 (itindex.net)</a></p> 
<pre><code class="language-java">import java.awt.Image;
import java.awt.Rectangle;
import java.awt.image.BufferedImage;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.RandomAccessFile;
import java.nio.ByteBuffer;
import java.nio.channels.FileChannel;
import javax.swing.SwingUtilities;
import com.sun.image.codec.jpeg.JPEGCodec;
import com.sun.image.codec.jpeg.JPEGImageEncoder;
import com.sun.pdfview.PDFFile;
import com.sun.pdfview.PDFPage;

/**
 * Created by David on 2016/11/15.
 */
public class Pdf2Pic {

    public static void setup() throws IOException {
        // load a pdf from a byte buffer
        File file = new File("/Users/David/Downloads/testoss.pdf");
        RandomAccessFile raf = new RandomAccessFile(file, "r");
        FileChannel channel = raf.getChannel();
        ByteBuffer buf = channel.map(FileChannel.MapMode.READ_ONLY, 0, channel
                .size());
        PDFFile pdffile = new PDFFile(buf);

        System.out.println("页数： " + pdffile.getNumPages());

        String getPdfFilePath = System.getProperty("user.dir")+File.separator+"pdfPicFile";

        //目录不存在，则创建目录
        File p=new File(getPdfFilePath);
        if(!p.exists()){
            p.mkdir();
        }

        System.out.println("getPdfFilePath is  :"+getPdfFilePath);

        for (int i = 1; i &lt;= pdffile.getNumPages(); i++) {
            // draw the first page to an image
            PDFPage page = pdffile.getPage(i);

            // get the width and height for the doc at the default zoom
            Rectangle rect = new Rectangle(0, 0, (int) page.getBBox()
                    .getWidth(), (int) page.getBBox().getHeight());

            // generate the image
            Image img = page.getImage(rect.width, rect.height, // width &amp;
                    // height
                    rect, // clip rect
                    null, // null for the ImageObserver
                    true, // fill background with white
                    true // block until drawing is done
            );

            BufferedImage tag = new BufferedImage(rect.width, rect.height,
                    BufferedImage.TYPE_INT_RGB);
            tag.getGraphics().drawImage(img, 0, 0, rect.width, rect.height,
                    null);



            FileOutputStream out = new FileOutputStream( getPdfFilePath+File.separator + i + ".jpg"); // 输出到文件流
                    System.out.println("成功保存图片到 ：  " +getPdfFilePath+File.separator + i + ".jpg");

            JPEGImageEncoder encoder = JPEGCodec.createJPEGEncoder(out);
            encoder.encode(tag); // JPEG编码

            out.close();
        }

        // show the image in a frame
        // JFrame frame = new JFrame("PDF Test");
        // frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        // frame.add(new JLabel(new ImageIcon(img)));
        // frame.pack();
        // frame.setVisible(true);
    }

    public static void main(final String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                try {
                    Pdf2Pic.setup();
                } catch (IOException ex) {
                    ex.printStackTrace();
                }
            }
        });
    }

}</code></pre> 
<pre><code class="language-XML">pom.xml依赖配置（将附件中的该jar包上传到nexus内部仓库）：

&lt;dependency&gt;
	&lt;groupId&gt;com.sun.pdfview&lt;/groupId&gt;
	&lt;artifactId&gt;pdfrenderer&lt;/artifactId&gt;
	&lt;version&gt;0.9.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre> 
<ul><li>本文附件下载:</li><li><a href="http://dl.iteye.com/topics/download/307055db-6d8f-379f-98f6-1c76b0d02da9" rel="nofollow" title="PDFRenderer-0.9.0.jar">PDFRenderer-0.9.0.jar</a> (2 MB)</li></ul> 
<h2>参考5：Java 将PDF 转为Word、图片、SVG、XPS、Html、PDF/A</h2> 
<p>来源：<a href="https://cloud.tencent.com/developer/article/1639902?from=14588" rel="nofollow" title="Java 将PDF 转为Word、图片、SVG、XPS、Html、PDF/A - 云+社区 - 腾讯云 (tencent.com)">Java 将PDF 转为Word、图片、SVG、XPS、Html、PDF/A - 云+社区 - 腾讯云 (tencent.com)</a></p> 
<p>本文将介绍通过Java编程来实现PDF文档转换的方法。包括：</p> 
<ol><li>PDF转为Word</li><li>PDF转为图片</li><li>PDF转为Html</li><li>PDF转为SVG 4.1 将PDF每一页转为单个的SVG 4.2 将一个包含多页的PDF文档转为一个SVG</li><li>PDF转为XPS</li><li>PDF转为PDF/A</li></ol> 
<p>使用工具：Free Spire.PDF for Java（免费版）</p> 
<p>Jar文件获取及导入：</p> 
<p>方法1：通过官网下载<a href="https://www.e-iceblue.cn/Downloads/Free-Spire-PDF-JAVA.html" rel="nofollow" title="下载jar包">下载jar包</a>。下载后，解压文件，并将lib文件夹下的Spire.Pdf.jar文件导入Java程序。</p> 
<p>方法2：可通过maven仓库安装导入。参考<a href="https://www.e-iceblue.cn/licensing/install-spirepdf-for-java-from-maven-repository.html" rel="nofollow" title="导入方法">导入方法</a></p> 
<h3 id="PDF-%E8%BD%ACWord">PDF 转Word</h3> 
<pre><code class="language-java">PdfDocument pdf = new PdfDocument("test.pdf");
pdf.saveToFile("ToWord.docx",FileFormat.DOCX);</code></pre> 
<h3 id="PDF%E8%BD%AC%E5%9B%BE%E7%89%87">PDF转图片</h3> 
<p>支持的图片格式包括Jpeg, Jpg, Png, Bmp, Tiff, Gif, EMF等。这里以保存为Png格式为例。</p> 
<pre><code class="language-java">import com.spire.pdf.*;

import javax.imageio.ImageIO;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;

public class PDFtoimage {
    public static void main(String[] args) throws IOException {

PdfDocument pdf = new PdfDocument("test.pdf");
BufferedImage image;
for(int i = 0; i&lt; pdf.getPages().getCount();i++){
    image = pdf.saveAsImage(i);
    File file = new File( String.format("ToImage-img-%d.png", i));
    ImageIO.write(image, "PNG", file);
}
pdf.close();
    }
}</code></pre> 
<h3 id="PDF%E8%BD%ACHtml">PDF转Html</h3> 
<pre><code class="language-java">PdfDocument pdf = new PdfDocument("test.pdf");
pdf.saveToFile("ToHTML.html", FileFormat.HTML);</code></pre> 
<h3 id="PDF%E8%BD%ACSVG">PDF转SVG</h3> 
<pre><code class="language-java">//转为单个svg
PdfDocument pdf = new PdfDocument("test.pdf");
pdf.saveToFile("ToSVG.svg", FileFormat.SVG);
//多页pdf转为一个svg
PdfDocument pdf = new PdfDocument("sampe.pdf");
pdf.getConvertOptions().setOutputToOneSvg(true);
pdf.saveToFile("ToOneSvg.svg",FileFormat.SVG);</code></pre> 
<h3 id="PDF-%E8%BD%ACXPS">PDF 转XPS</h3> 
<pre><code class="language-java">PdfDocument pdf = new PdfDocument("test.pdf");
pdf.saveToFile("ToXPS.xps", FileFormat.XPS);</code></pre> 
<h3 id="PDF%E8%BD%ACPDF/A">PDF转PDF/A</h3> 
<pre><code class="language-java">import com.spire.pdf.*;
import com.spire.pdf.graphics.PdfMargins;
import java.awt.geom.Dimension2D;

public class PDFtoPDFA {
    public static void main(String[]args){
        //加载测试文档
        PdfDocument pdf = new PdfDocument();
        pdf.loadFromFile("test.pdf");

        //转换为Pdf_A_1_B格式
        PdfNewDocument newDoc = new PdfNewDocument();
        newDoc.setConformance(PdfConformanceLevel.Pdf_A_1_B);
        PdfPageBase page;
        for ( int i=0;i&lt; pdf.getPages().getCount();i++) {
            page = pdf.getPages().get(i);
            Dimension2D size = page.getSize();
            PdfPageBase p = newDoc.getPages().add(size, new PdfMargins(0));
            page.createTemplate().draw(p, 0, 0);
        }

        //保存结果文件
        newDoc.save("ToPDFA.pdf");
        newDoc.close();

    }
}</code></pre> 
<h2>参考6：java实现pdf转图片</h2> 
<p>来源：<a href="https://www.cnblogs.com/pengsn/p/14355058.html?ivk_sa=1024320u" rel="nofollow" title="java实现pdf转换图片 - pengsn - 博客园 (cnblogs.com)">java实现pdf转换图片 - pengsn - 博客园 (cnblogs.com)</a></p> 
<p><strong>一、需求</strong></p> 
<p>   将PDF文档类转换成图片形式。    <br><strong>二、实现方式</strong></p> 
<p>    2.1 pdfbox     </p> 
<pre><code class="language-java">PDDocument doc = null;
        try {
            doc = PDDocument.load(sourceFile);
            PDFRenderer renderer = new PDFRenderer(doc);
            int pageCount = doc.getNumberOfPages();
            for (int i = 0; i &lt; pageCount; i++) {
                BufferedImage image = renderer.renderImageWithDPI(i, DPI); // 162.8
                ImageIO.write(image, ConvertImageConst.JPG, new File(filepathNoSuffix + File.separator + i + ConvertImageConst.SUFFIX_JPG));
            }
            log.info("jpg_ok. space-time: {}, pageSize={} ", (System.currentTimeMillis() - startTime), pageCount);
            return pageCount;
        } catch (IOException e) {
            log.error("pdfDocumentRender IOException {} ", e);
        } catch (Error e) {
            log.error("pdfDocumentRender Error {} ", e);
        } finally {
            try {
                if (doc != null) {
                    doc.close();
                }
            } catch (IOException e) {
                log.error("pdfDocumentRender finally IOError ", e.getMessage());
            }
            lock.unlock();
        }</code></pre> 
<p> 2.2 ghostscript </p> 
<pre><code>gswin64 -dSAFER -dBATCH -dNOPAUSE -r300 -dTextAlphaBits=4 -dGraphicsAlphaBits=4 -sDEVICE=jpeg -sOutputFile=test%03d.jpg  0002.pdf

    命令：

     gswin64 主程序

     -params:

     -sDEVICE=jpeg                 // jpeg格式

     -sOutputFile=test%03d.jpg // 输出的图片名称 %03d 三位数字 %d 一位数字

      0002.pdf  //待转换的pdf文件</code></pre> 
<p><strong>三、比较</strong></p> 
<table align="left"><tbody><tr><td><strong>实现方式</strong></td><td><strong>优点　　</strong></td><td><strong>缺点</strong></td></tr><tr><td>pdfbox</td><td>maven引入既可开发</td><td>转换速度慢，且可能内存溢出 </td></tr><tr><td>ghostscript</td><td>转换速度快</td><td>依赖ghostscript插件</td></tr></tbody></table> 
<h2>参考7：java实现pdf转图片</h2> 
<p>来源：<a href="https://blog.csdn.net/qq_40378034/article/details/107126657" title="Java实现PDF转图片_hxt的博客-CSDN博客_java pdf转图片">Java实现PDF转图片_hxt的博客-CSDN博客_java pdf转图片</a></p> 
<p>pdfbox转换后清晰度相对来说是比较高的</p> 
<p><strong>引入依赖</strong>：</p> 
<pre><code class="language-XML">		&lt;dependency&gt;
			&lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt;
			&lt;artifactId&gt;pdfbox&lt;/artifactId&gt;
			&lt;version&gt;2.0.20&lt;/version&gt;
		&lt;/dependency&gt;</code></pre> 
<p><strong>工具类</strong>：</p> 
<pre><code class="language-java">public class PdfToImageUtil {
    /**
     * dpi越大转换后越清晰，相对转换速度越慢
     */
    private static final Integer DPI = 100;

    /**
     * 转换后的图片类型
     */
    private static final String IMG_TYPE = "png";

    /**
     * PDF转图片
     *
     * @param fileContent PDF文件的二进制流
     * @return 图片文件的二进制流
     */
    public static List&lt;byte[]&gt; pdfToImage(byte[] fileContent) throws IOException {
        List&lt;byte[]&gt; result = new ArrayList&lt;&gt;();
        try (PDDocument document = PDDocument.load(fileContent)) {
            PDFRenderer renderer = new PDFRenderer(document);
            for (int i = 0; i &lt; document.getNumberOfPages(); ++i) {
                BufferedImage bufferedImage = renderer.renderImageWithDPI(i, DPI);
                ByteArrayOutputStream out = new ByteArrayOutputStream();
                ImageIO.write(bufferedImage, IMG_TYPE, out);
                result.add(out.toByteArray());
            }
        }
        return result;
    }
}
</code></pre> 
<h2>参考8：java pdf转图片</h2> 
<p>来源：<a href="https://www.cnblogs.com/haciont/p/10592692.html" rel="nofollow" title="Java PDF转图片 - haxnt - 博客园 (cnblogs.com)">Java PDF转图片 - haxnt - 博客园 (cnblogs.com)</a></p> 
<p></p> 
<pre><code class="language-XML">&lt;dependency&gt;
            &lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt;
            &lt;artifactId&gt;pdfbox&lt;/artifactId&gt;
            &lt;version&gt;2.0.4&lt;/version&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.lowagie&lt;/groupId&gt;
            &lt;artifactId&gt;itext&lt;/artifactId&gt;
            &lt;version&gt;2.1.7&lt;/version&gt;
        &lt;/dependency&gt;</code></pre> 
<pre><code class="language-java">import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;

import javax.imageio.ImageIO;

import org.apache.pdfbox.pdmodel.PDDocument;
import org.apache.pdfbox.rendering.PDFRenderer;

import com.lowagie.text.pdf.PdfReader;
public class test1 {

    public static void main(String[] args) {
            pdf2Image("D:/1.pdf", "D:/pdf", 130);
        }

        /***
         * PDF文件转PNG图片，全部页数
         *
         * @param PdfFilePath pdf完整路径
         * @param imgFilePath 图片存放的文件夹
         * @param dpi dpi越大转换后越清晰，相对转换速度越慢
         * @return
         */
        public static void pdf2Image(String PdfFilePath, String dstImgFolder, int dpi) {
            File file = new File(PdfFilePath);
            PDDocument pdDocument;
            try {
                String imgPDFPath = file.getParent();
                int dot = file.getName().lastIndexOf('.');
                String imagePDFName = file.getName().substring(0, dot); // 获取图片文件名
                String imgFolderPath = null;
                if (dstImgFolder.equals("")) {
                    imgFolderPath = imgPDFPath + File.separator + imagePDFName;// 获取图片存放的文件夹路径
                } else {
                    imgFolderPath = dstImgFolder + File.separator + imagePDFName;
                }

                if (createDirectory(imgFolderPath)) {

                    pdDocument = PDDocument.load(file);
                    PDFRenderer renderer = new PDFRenderer(pdDocument);
                /* dpi越大转换后越清晰，相对转换速度越慢 */
                    PdfReader reader = new PdfReader(PdfFilePath);
                    int pages = reader.getNumberOfPages();
                    StringBuffer imgFilePath = null;
                    for (int i = 0; i &lt; pages; i++) {
                        String imgFilePathPrefix = imgFolderPath + File.separator + imagePDFName;
                        imgFilePath = new StringBuffer();
                        imgFilePath.append(imgFilePathPrefix);
                        imgFilePath.append("_");
                        imgFilePath.append(String.valueOf(i + 1));
                        imgFilePath.append(".png");
                        File dstFile = new File(imgFilePath.toString());
                        BufferedImage image = renderer.renderImageWithDPI(i, dpi);
                        ImageIO.write(image, "png", dstFile);
                    }
                    System.out.println("PDF文档转PNG图片成功！");

                } else {
                    System.out.println("PDF文档转PNG图片失败：" + "创建" + imgFolderPath + "失败");
                }

            } catch (IOException e) {
                e.printStackTrace();
            }
        }

        private static boolean createDirectory(String folder) {
            File dir = new File(folder);
            if (dir.exists()) {
                return true;
            } else {
                return dir.mkdirs();
            }
        }


}</code></pre> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/960f747fd1aaec04f57e66b49ec536c1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">关于js变量声明的几种方式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/68a316029dd5aa03ffbd0bc5bc3c6155/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">（转载）shell命令 DIR=“$( cd “$( dirname “${BASH_SOURCE[0]}“ )“ &amp;&amp; pwd )“详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>