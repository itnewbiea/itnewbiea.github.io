<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Numpy_æˆ¿ä»·é¢„æµ‹ - ITå­¦ä¹ è€…åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Numpy_æˆ¿ä»·é¢„æµ‹" />
<meta property="og:description" content="æœ¬æ–‡é‡‡ç”¨ä»…é‡‡ç”¨numpyè¿›è¡Œæˆ¿ä»·é¢„æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œæ³¢å£«é¡¿æˆ¿ä»·é¢„æµ‹é—®é¢˜ä½œä¸ºæœºå™¨å­¦ä¹ é¢†åŸŸçš„â€œhello worldâ€ã€‚æœ¬æ–‡æœ‰åˆ©äºè¯»è€…æ›´å¥½åœ°ç†è§£å¹¶å…¥é—¨ï¼Œä¸ºä»¥åæ›´æ·±ç¨‹åº¦çš„å­¦ä¹ æ‰“ä¸‹è‰¯å¥½çš„åŸºç¡€ã€‚
ç›®å½•
å‰è¨€
ä¸€ï¼Œæ•°æ®å¤„ç†ï¼š
è¯»å…¥æ•°æ®é›†ï¼š
æ•°æ®ç»´åº¦è½¬æ¢ï¼š
æ•°æ®å½’ä¸€åŒ–å¤„ç†ï¼š
ä»£ç å°è£…æˆç±»ï¼š
äºŒï¼Œæ¨¡å‹è®¾è®¡
çº¿æ€§å›å½’ï¼šÂ å‰å‘ä¼ æ’­ï¼š
æŸå¤±å‡½æ•°ï¼š
è®¡ç®—æ¢¯åº¦ï¼š
åå‘ä¼ æ’­ï¼š
å°è£…å‡½æ•°ï¼š
æ€»ç»“ï¼š
å‰è¨€ æ³¢å£«é¡¿æˆ¿ä»·æ•°æ®é›†æºäºç¾å›½æŸç»æµå­¦æ‚å¿—ä¸Šï¼Œåˆ†æç ”ç©¶æ³¢å£«é¡¿ æˆ¿ä»·çš„æ•°æ®é›†ã€‚è¯¥æ•°æ®é›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½æ˜¯å¯¹æ³¢å£«é¡¿å‘¨è¾¹æˆ–è€…åŸé•‡ çš„æˆ¿ä»·æƒ…å†µçš„æ¦‚è¿°ï¼Œç»Ÿè®¡çš„æ˜¯æˆ¿ä»·çš„ä¸­ä½æ•°å’Œ 13 ä¸ªæŒ‡æ ‡ï¼Œè¯•å›¾èƒ½å¤Ÿ åˆ†æå‡ºè¿™äº›æŒ‡æ ‡å’Œæˆ¿ä»·ä¹‹é—´çš„å…³ç³»ã€‚æœ¬æ–‡ä¸»è¦ä»¥æ•°æ®é¢„å¤„ç†ï¼ŒæŸå¤±å‡½æ•°ï¼Œæ¢¯åº¦è®¡ç®—ï¼Œåå‘ä¼ æ’­æ›´æ–°å‚æ•°å±•å¼€ï¼Œå…·ä½“ä»‹ç»è¿™å‡ ä¸ªæ­¥éª¤åœ¨ä»£ç ä¸­çš„ä½“ç°ã€‚
ä¸€ï¼Œæ•°æ®å¤„ç†ï¼š è¯»å…¥æ•°æ®é›†ï¼š æœ¬æ–‡é‡‡ç”¨housing.dataæ•°æ®é›†ã€‚æ•°æ®é›†çš„æ ¼å¼å¦‚å›¾æ‰€ç¤ºï¼Œè¯¥æ•°æ®é›†å…±æœ‰506ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬åŒ…å«13ä¸ªç‰¹å¾å€¼å’Œ1ä¸ªä¸ä¹‹å¯¹åº”çš„æ ‡ç­¾ã€‚å¦‚å›¾æ‰€ç¤ºï¼š
è¯¥æ•°æ®é›†å…±æœ‰506è¡Œ14åˆ—çš„æ•°æ®ï¼Œæ¯ä¸€è¡Œæ•°æ®ä»£è¡¨ä¸€ä¸ªæ ·æœ¬ï¼ˆæ¯ä¸ªæ ·æœ¬é‡ŒåŒ…å«14çš„æ•°æ®ï¼‰ï¼Œå‰13åˆ—åˆ†åˆ«å¯¹åº”13ä¸ªç‰¹å¾å€¼ï¼Œæœ€åä¸€åˆ—ä¸ºå„ä¸ªæ ·æœ¬å€¼å¯¹åº”çš„æ ‡ç­¾ï¼Œå³æˆ¿ä»·ï¼Œæ‰€æœ‰æ•°æ®å‡å·²ç©ºæ ¼åˆ†å¼€ã€‚
datafile = &#39;housing.data&#39; data = np.fromfile(datafile, sep=&#39; &#39;) å…¶ä¸­&#39;housing.data&#39;ä¸ºè·¯å¾„åï¼Œæˆ‘çš„ç›´æ¥æ”¾åœ¨äº†æœ¬æ–‡ä»¶å¤¹ä¸‹ã€‚å¹¶èµ‹å€¼ç»™datafile np.fromfileè¡¨ç¤ºè¯»å–è¯¥è·¯å¾„ä¸‹çš„æ–‡ä»¶ï¼Œsep = &#39;&#39;è¡¨ç¤ºä»¥ç©ºæ ¼åˆ†éš”ã€‚æ­¤æ—¶dataä¸ºä¸€ä¸ª1è¡Œ7084åˆ—çš„å‘é‡ã€‚ æ•°æ®ç»´åº¦è½¬æ¢ï¼š ç”±äºè¯»å…¥çš„åŸå§‹æ•°æ®æ˜¯1ç»´çš„ã€‚å› æ­¤éœ€è¦æˆ‘ä»¬å°†æ•°æ®çš„å½¢çŠ¶è¿›è¡Œå˜æ¢ï¼Œå½¢æˆä¸€ä¸ª2ç»´çš„çŸ©é˜µï¼Œæ¯è¡Œä¸ºä¸€ä¸ªæ•°æ®æ ·æœ¬ï¼ˆ14ä¸ªå€¼ï¼‰ï¼Œæ¯ä¸ªæ•°æ®æ ·æœ¬åŒ…å«13ä¸ªç‰¹å¾å€¼ï¼ˆå½±å“æˆ¿ä»·çš„ç‰¹å¾ï¼‰å’Œä¸€ä¸ªå¯¹åº”çš„æ ‡ç­¾ï¼ˆè¯¥ç±»å‹æˆ¿å±‹çš„å‡ä»·ï¼‰ã€‚
# è¯»å…¥ä¹‹åçš„æ•°æ®è¢«è½¬åŒ–æˆ1ç»´arrayï¼Œå…¶ä¸­arrayçš„ç¬¬0-13é¡¹æ˜¯ç¬¬ä¸€æ¡æ•°æ®ï¼Œç¬¬14-27é¡¹æ˜¯ç¬¬äºŒæ¡æ•°æ®ï¼Œä»¥æ­¤ç±»æ¨.... # è¿™é‡Œå¯¹åŸå§‹æ•°æ®åšreshapeï¼Œå˜æˆN x 14çš„å½¢å¼ feature_names = [ &#39;CRIM&#39;, &#39;ZN&#39;, &#39;INDUS&#39;, &#39;CHAS&#39;, &#39;NOX&#39;, &#39;RM&#39;, &#39;AGE&#39;,&#39;DIS&#39;, &#39;RAD&#39;, &#39;TAX&#39;, &#39;PTRATIO&#39;, &#39;B&#39;, &#39;LSTAT&#39;, &#39;MEDV&#39; ] feature_num = len(feature_names) data = data." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/84ab660883ee1866b7ced19c483ecf4e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-03T00:38:27+08:00" />
<meta property="article:modified_time" content="2021-08-03T00:38:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ITå­¦ä¹ è€…åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ITå­¦ä¹ è€…åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Numpy_æˆ¿ä»·é¢„æµ‹</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>Â  Â  Â  Â  æœ¬æ–‡é‡‡ç”¨ä»…é‡‡ç”¨numpyè¿›è¡Œæˆ¿ä»·é¢„æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œæ³¢å£«é¡¿æˆ¿ä»·é¢„æµ‹é—®é¢˜ä½œä¸ºæœºå™¨å­¦ä¹ é¢†åŸŸçš„â€œhello worldâ€ã€‚æœ¬æ–‡æœ‰åˆ©äºè¯»è€…æ›´å¥½åœ°ç†è§£å¹¶å…¥é—¨ï¼Œä¸ºä»¥åæ›´æ·±ç¨‹åº¦çš„å­¦ä¹ æ‰“ä¸‹è‰¯å¥½çš„åŸºç¡€ã€‚</p> 
<hr> 
<p></p> 
<p id="main-toc"><strong>ç›®å½•</strong></p> 
<p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">å‰è¨€</a></p> 
<p id="%E4%B8%80%EF%BC%8C%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86-toc" style="margin-left:40px;"><a href="#%E4%B8%80%EF%BC%8C%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86" rel="nofollow">ä¸€ï¼Œæ•°æ®å¤„ç†ï¼š</a></p> 
<p id="%E8%AF%BB%E5%85%A5%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E8%AF%BB%E5%85%A5%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9A" rel="nofollow">è¯»å…¥æ•°æ®é›†ï¼š</a></p> 
<p id="%E6%95%B0%E6%8D%AE%E7%BB%B4%E5%BA%A6%E8%BD%AC%E6%8D%A2%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E6%95%B0%E6%8D%AE%E7%BB%B4%E5%BA%A6%E8%BD%AC%E6%8D%A2%EF%BC%9A" rel="nofollow">æ•°æ®ç»´åº¦è½¬æ¢ï¼š</a></p> 
<p id="%E6%95%B0%E6%8D%AE%E5%BD%92%E4%B8%80%E5%8C%96%E5%A4%84%E7%90%86%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E6%95%B0%E6%8D%AE%E5%BD%92%E4%B8%80%E5%8C%96%E5%A4%84%E7%90%86%EF%BC%9A" rel="nofollow">æ•°æ®å½’ä¸€åŒ–å¤„ç†ï¼š</a></p> 
<p id="%E4%BB%A3%E7%A0%81%E5%B0%81%E8%A3%85%E6%88%90%E7%B1%BB%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E4%BB%A3%E7%A0%81%E5%B0%81%E8%A3%85%E6%88%90%E7%B1%BB%EF%BC%9A" rel="nofollow">ä»£ç å°è£…æˆç±»ï¼š</a></p> 
<p id="%C2%A0%E4%BA%8C%EF%BC%8C%E6%A8%A1%E5%9E%8B%E8%AE%BE%E8%AE%A1-toc" style="margin-left:40px;"><a href="#%C2%A0%E4%BA%8C%EF%BC%8C%E6%A8%A1%E5%9E%8B%E8%AE%BE%E8%AE%A1" rel="nofollow">Â äºŒï¼Œæ¨¡å‹è®¾è®¡</a></p> 
<p id="%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%EF%BC%9A%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0-toc" style="margin-left:80px;"><a href="#%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%EF%BC%9A%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0" rel="nofollow">çº¿æ€§å›å½’ï¼šÂ  Â  Â  Â </a></p> 
<p id="%E5%89%8D%E5%90%91%E4%BC%A0%E6%92%AD%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E5%89%8D%E5%90%91%E4%BC%A0%E6%92%AD%EF%BC%9A" rel="nofollow">å‰å‘ä¼ æ’­ï¼š</a></p> 
<p id="%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0%EF%BC%9A" rel="nofollow">æŸå¤±å‡½æ•°ï¼š</a></p> 
<p id="%E8%AE%A1%E7%AE%97%E6%A2%AF%E5%BA%A6%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E8%AE%A1%E7%AE%97%E6%A2%AF%E5%BA%A6%EF%BC%9A" rel="nofollow">è®¡ç®—æ¢¯åº¦ï¼š</a></p> 
<p id="%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%EF%BC%9A" rel="nofollow">åå‘ä¼ æ’­ï¼š</a></p> 
<p id="%E5%B0%81%E8%A3%85%E5%87%BD%E6%95%B0%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E5%B0%81%E8%A3%85%E5%87%BD%E6%95%B0%EF%BC%9A" rel="nofollow">å°è£…å‡½æ•°ï¼š</a></p> 
<p id="%E6%80%BB%E7%BB%93-toc" style="margin-left:0px;"><a href="#%E6%80%BB%E7%BB%93" rel="nofollow">æ€»ç»“ï¼š</a></p> 
<hr id="hr-toc"> 
<hr> 
<h2 id="%E5%89%8D%E8%A8%80"><a id="_10"></a>å‰è¨€</h2> 
<p>Â  Â  Â  Â æ³¢å£«é¡¿æˆ¿ä»·æ•°æ®é›†æºäºç¾å›½æŸç»æµå­¦æ‚å¿—ä¸Šï¼Œåˆ†æç ”ç©¶æ³¢å£«é¡¿ æˆ¿ä»·çš„æ•°æ®é›†ã€‚è¯¥æ•°æ®é›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½æ˜¯å¯¹æ³¢å£«é¡¿å‘¨è¾¹æˆ–è€…åŸé•‡ çš„æˆ¿ä»·æƒ…å†µçš„æ¦‚è¿°ï¼Œç»Ÿè®¡çš„æ˜¯æˆ¿ä»·çš„ä¸­ä½æ•°å’Œ 13 ä¸ªæŒ‡æ ‡ï¼Œè¯•å›¾èƒ½å¤Ÿ åˆ†æå‡ºè¿™äº›æŒ‡æ ‡å’Œæˆ¿ä»·ä¹‹é—´çš„å…³ç³»ã€‚æœ¬æ–‡ä¸»è¦ä»¥æ•°æ®é¢„å¤„ç†ï¼ŒæŸå¤±å‡½æ•°ï¼Œæ¢¯åº¦è®¡ç®—ï¼Œåå‘ä¼ æ’­æ›´æ–°å‚æ•°å±•å¼€ï¼Œå…·ä½“ä»‹ç»è¿™å‡ ä¸ªæ­¥éª¤åœ¨ä»£ç ä¸­çš„ä½“ç°ã€‚</p> 
<hr> 
<h3 id="%E4%B8%80%EF%BC%8C%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86">ä¸€ï¼Œæ•°æ®å¤„ç†ï¼š</h3> 
<h4 id="%E8%AF%BB%E5%85%A5%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9A">è¯»å…¥æ•°æ®é›†ï¼š</h4> 
<p>æœ¬æ–‡é‡‡ç”¨<strong>housing.data</strong>æ•°æ®é›†ã€‚æ•°æ®é›†çš„æ ¼å¼å¦‚å›¾æ‰€ç¤ºï¼Œè¯¥æ•°æ®é›†å…±æœ‰<strong>506ä¸ªæ ·æœ¬</strong>ï¼Œæ¯ä¸ªæ ·æœ¬åŒ…å«<strong>13ä¸ªç‰¹å¾å€¼å’Œ1ä¸ªä¸ä¹‹å¯¹åº”çš„æ ‡ç­¾ã€‚</strong>å¦‚å›¾æ‰€ç¤ºï¼š</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/82/56/kECYjWIW_o.png"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/f5/4d/bXJNKzJh_o.png"></p> 
<p>Â  Â  Â  Â <strong> è¯¥æ•°æ®é›†å…±æœ‰506è¡Œ14åˆ—çš„æ•°æ®ï¼Œæ¯ä¸€è¡Œæ•°æ®ä»£è¡¨ä¸€ä¸ªæ ·æœ¬ï¼ˆæ¯ä¸ªæ ·æœ¬é‡ŒåŒ…å«14çš„æ•°æ®ï¼‰ï¼Œå‰13åˆ—åˆ†åˆ«å¯¹åº”13ä¸ªç‰¹å¾å€¼ï¼Œæœ€åä¸€åˆ—ä¸ºå„ä¸ªæ ·æœ¬å€¼å¯¹åº”çš„æ ‡ç­¾ï¼Œå³æˆ¿ä»·ï¼Œæ‰€æœ‰æ•°æ®å‡å·²ç©ºæ ¼åˆ†å¼€ã€‚</strong></p> 
<pre><code class="language-python">    datafile = 'housing.data'
    data = np.fromfile(datafile, sep=' ')</code></pre> 
<pre><code class="language-html hljs">å…¶ä¸­'housing.data'ä¸ºè·¯å¾„åï¼Œæˆ‘çš„ç›´æ¥æ”¾åœ¨äº†æœ¬æ–‡ä»¶å¤¹ä¸‹ã€‚å¹¶èµ‹å€¼ç»™datafile 
np.fromfileè¡¨ç¤ºè¯»å–è¯¥è·¯å¾„ä¸‹çš„æ–‡ä»¶ï¼Œsep = ''è¡¨ç¤ºä»¥ç©ºæ ¼åˆ†éš”ã€‚æ­¤æ—¶dataä¸ºä¸€ä¸ª1è¡Œ7084åˆ—çš„å‘é‡ã€‚</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ef/bb/FfdvWAWH_o.png"></p> 
<h4 id="%E6%95%B0%E6%8D%AE%E7%BB%B4%E5%BA%A6%E8%BD%AC%E6%8D%A2%EF%BC%9A">æ•°æ®ç»´åº¦è½¬æ¢ï¼š</h4> 
<p>ç”±äºè¯»å…¥çš„åŸå§‹æ•°æ®æ˜¯1ç»´çš„ã€‚å› æ­¤éœ€è¦æˆ‘ä»¬å°†æ•°æ®çš„å½¢çŠ¶è¿›è¡Œå˜æ¢ï¼Œå½¢æˆä¸€ä¸ª2ç»´çš„çŸ©é˜µï¼Œæ¯è¡Œä¸ºä¸€ä¸ªæ•°æ®æ ·æœ¬ï¼ˆ14ä¸ªå€¼ï¼‰ï¼Œæ¯ä¸ªæ•°æ®æ ·æœ¬åŒ…å«13ä¸ªç‰¹å¾å€¼ï¼ˆå½±å“æˆ¿ä»·çš„ç‰¹å¾ï¼‰å’Œä¸€ä¸ªå¯¹åº”çš„æ ‡ç­¾ï¼ˆè¯¥ç±»å‹æˆ¿å±‹çš„å‡ä»·ï¼‰ã€‚</p> 
<pre><code class="language-python"># è¯»å…¥ä¹‹åçš„æ•°æ®è¢«è½¬åŒ–æˆ1ç»´arrayï¼Œå…¶ä¸­arrayçš„ç¬¬0-13é¡¹æ˜¯ç¬¬ä¸€æ¡æ•°æ®ï¼Œç¬¬14-27é¡¹æ˜¯ç¬¬äºŒæ¡æ•°æ®ï¼Œä»¥æ­¤ç±»æ¨.... 
# è¿™é‡Œå¯¹åŸå§‹æ•°æ®åšreshapeï¼Œå˜æˆN x 14çš„å½¢å¼
feature_names = [ 'CRIM', 'ZN', 'INDUS', 'CHAS', 'NOX', 'RM', 'AGE','DIS', 
                 'RAD', 'TAX', 'PTRATIO', 'B', 'LSTAT', 'MEDV' ]
feature_num = len(feature_names)
data = data.reshape([data.shape[0] // feature_num, feature_num])</code></pre> 
<p>feature_namesä¸ºä¸€ä¸ªåˆ—è¡¨ï¼Œå†…æœ‰14ä¸ªå€¼ï¼Œå‰13ä¸ªå…ƒç´ ä»£è¡¨å¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œæœ€åä¸€ä¸ªå…ƒç´ ä¸ºæ ‡ç­¾ã€‚æ¯ä¸ªç‰¹å¾å‘é‡çš„å«ä¹‰å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> 
<p><img alt="" height="865" src="https://images2.imgbox.com/93/db/Kj0ZgUeC_o.png" width="578"></p> 
<p>Â feature_number = len(feature_names),ç”¨lenå‡½æ•°æ±‚å‡ºç‰¹å¾å€¼çš„æ•°é‡å¹¶èµ‹å€¼ç»™feature_numberï¼Œä¸º14ï¼ˆåŒ…å«æ ‡ç­¾ï¼‰ï¼Œdata.shapeè¡¨ç¤ºæ±‚dataçš„ç»´åº¦ä¸º<strong>ä¸€ç»´ï¼ˆ7084ï¼Œï¼‰</strong>ï¼Œ<strong>data.shape[0]å³ä¸º7084ï¼Œæ‰€ä»¥data.shape[0]å¯¹feature_numberï¼ˆ14ï¼‰å–ä½™ï¼Œå¾—åˆ°506ï¼›æ‰€ä»¥dataçš„ç»´åº¦ä¸º[506,14]</strong>ã€‚dataä¸º506è¡Œï¼Œ14åˆ—çš„äºŒç»´çŸ©é˜µã€‚</p> 
<p>åŒºåˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œé€šå¸¸å–æ€»æ ·æœ¬æ•°çš„80%ä½œä¸ºè®­ç»ƒé›†ï¼Œå‰©ä½™çš„20%ä½œä¸ºæµ‹è¯•é›†ã€‚</p> 
<p>ä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code class="language-python">ratio = 0.8
offset = int(data.shape[0] * ratio)
training_data = data[:offset]
test_data = data[offset:]</code></pre> 
<p>Â  Â  Â  Â  å¯¹dataè¿›è¡Œåˆ‡ç‰‡å¤„ç†ï¼Œoffsetä¸ºæ•´å½¢å˜é‡ï¼Œä»£è¡¨506*0.8ã€‚data[:offset]æ˜¯æŒ‡å¯¹äºŒç»´çŸ©é˜µçš„ç¬¬ä¸€ç»´è¿›è¡Œåˆ‡ç‰‡å¤„ç†ï¼Œç¬¬äºŒç»´ä¸å˜ã€‚å¾—åˆ°çš„training_dataå’Œtest_dataåˆ†åˆ«ä¸º404è¡Œ14åˆ—çš„çŸ©é˜µå’Œ102è¡Œ14åˆ—çš„çŸ©é˜µã€‚</p> 
<h4 id="%E6%95%B0%E6%8D%AE%E5%BD%92%E4%B8%80%E5%8C%96%E5%A4%84%E7%90%86%EF%BC%9A">æ•°æ®å½’ä¸€åŒ–å¤„ç†ï¼š</h4> 
<p>å¯¹æ¯ä¸ªç‰¹å¾è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œä½¿å¾—æ¯ä¸ªç‰¹å¾çš„å–å€¼ç¼©æ”¾åˆ°0~1ä¹‹é—´ã€‚</p> 
<p>è¿™æ ·åšæœ‰ä¸¤ä¸ªå¥½å¤„ï¼š</p> 
<p><strong>ä¸€æ˜¯æ¨¡å‹è®­ç»ƒæ›´é«˜æ•ˆï¼›</strong></p> 
<p><strong>äºŒæ˜¯ç‰¹å¾å‰çš„æƒé‡å¤§å°å¯ä»¥ä»£è¡¨è¯¥å˜é‡å¯¹é¢„æµ‹ç»“æœçš„è´¡çŒ®åº¦ï¼ˆå› ä¸ºæ¯ä¸ªç‰¹å¾å€¼æœ¬èº«çš„èŒƒå›´ç›¸åŒï¼‰</strong></p> 
<p><strong>ä»£ç å¦‚ä¸‹ï¼š</strong></p> 
<pre><code class="language-python"># è®¡ç®—trainæ•°æ®é›†çš„æœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼Œå¹³å‡å€¼
maximums, minimums, avgs = \
                     training_data.max(axis=0), \
                     training_data.min(axis=0), \
     training_data.sum(axis=0) / training_data.shape[0]
# å¯¹æ•°æ®è¿›è¡Œå½’ä¸€åŒ–å¤„ç†
for i in range(feature_num):
    #print(maximums[i], minimums[i], avgs[i])
    data[:, i] = (data[:, i] - minimums[i]) / (maximums[i] - minimums[i])
</code></pre> 
<p></p> 
<p>Â  Â  Â  Â é¦–å…ˆæ±‚å‡ºæ¯ä¸€ä¸ªç‰¹å¾å€¼çš„æœ€å¤§å€¼ï¼Œæœ€å°å€¼å’Œå¹³å‡å€¼å¹¶åˆ†åˆ«èµ‹å€¼ç»™maximums, minimums, avgsã€‚å³å¯¹æ‰€æœ‰çš„åˆ—åˆ†åˆ«æ±‚å‡ºæ¯åˆ—çš„æœ€å¤§å€¼ï¼Œæœ€å°å€¼å’Œå¹³å‡å€¼ã€‚.max()å‡½æ•°å¯ä»¥æ±‚å‡ºæœ€å¤§å€¼ï¼Œä½†ç”±äºtraining_dataæ˜¯ä¸€ä¸ª404è¡Œ14åˆ—çš„çŸ©é˜µï¼Œè€Œæˆ‘ä»¬åˆ†åˆ«æ±‚å‡ºæ¯ä¸€åˆ—çš„æœ€å¤§å€¼ï¼Œæœ€å°å€¼å’Œå¹³å‡å€¼ã€‚æ‰€ä»¥è¦æŒ‡å®šç»´åº¦ä¸º0ï¼Œå³å¯¹åˆ—æ±‚ã€‚Â (axis=0)ï¼Œè‹¥ä¸æŒ‡å®šï¼Œåˆ™å¯¹æ‰€æœ‰æ•°æ®æ±‚æœ€å¤§å€¼ã€‚.min()å‡½æ•°åŒç†ã€‚Â training_data.sum(axis=0ï¼‰è¡¨ç¤ºå¯¹æ¯ä¸€åˆ—æ±‚å’Œæœ€åå¾—åˆ°ä¸€ä¸ª1è¡Œ14åˆ—çš„çŸ©é˜µï¼Œæ¯ä¸€ä¸ªæ•°æ®ä¸ºå¯¹åº”æ¯ä¸€åˆ—æ‰€æœ‰è¡Œæ•°ä¹‹å’Œã€‚training_data.shapeè¡¨ç¤º[404,14]ï¼Œå…¶ä¸­0è¡¨ç¤ºç¬¬ä¸€ä¸ªå…ƒç´ ã€‚training_data.shape[0]è¡¨ç¤º404ï¼ŒäºŒè€…ä¹‹æ¯”è‡ªç„¶ä¸ºå¹³å‡æ•°ã€‚</p> 
<p>Â Â Â Â Â Â Â Â ä¹‹åçš„forå¾ªç¯è¡¨ç¤ºä¾æ¬¡éå†æ¯ä¸€åˆ—ï¼Œç”±äºdataæ˜¯506è¡Œï¼Œ14åˆ—çš„çŸ©é˜µï¼Œæ‰€ä»¥å¾ªç¯é‡Œé¢ç”¨åˆ°åˆ‡ç‰‡æ“ä½œdata[:, i] = (data[:, i] - minimums[i]) / (maximums[i] - minimums[i])ã€‚å…¶ä¸­data[:, i] è¡¨ç¤º506è¡Œï¼Œç¬¬iåˆ—çš„çŸ©é˜µï¼Œminimums[i]è¡¨ç¤ºç¬¬iåˆ—çš„æœ€å°å€¼ï¼Œmaximums[i]è¡¨ç¤ºç¬¬iåˆ—çš„æœ€å¤§å€¼ã€‚ç»è¿‡æ­¤å¤„ç†åï¼Œä¾¿å¯ä½¿æ‰€æœ‰æ•°æ®å‡åœ¨0-1ä¹‹é—´ã€‚</p> 
<h4 id="%E4%BB%A3%E7%A0%81%E5%B0%81%E8%A3%85%E6%88%90%E7%B1%BB%EF%BC%9A">ä»£ç å°è£…æˆç±»ï¼š</h4> 
<pre><code class="language-python">import numpy as np
def load_data():
    # ä»æ–‡ä»¶å¯¼å…¥æ•°æ®
    datafile = 'housing.data'
    data = np.fromfile(datafile, sep=' ')

    # æ¯æ¡æ•°æ®åŒ…æ‹¬14é¡¹ï¼Œå…¶ä¸­å‰é¢13é¡¹æ˜¯å½±å“å› ç´ ï¼Œç¬¬14é¡¹æ˜¯ç›¸åº”çš„æˆ¿å±‹ä»·æ ¼ä¸­ä½æ•°
    feature_names = [ 'CRIM', 'ZN', 'INDUS', 'CHAS', 'NOX', 'RM', 'AGE', \
                      'DIS', 'RAD', 'TAX', 'PTRATIO', 'B', 'LSTAT', 'MEDV' ]
    feature_num = len(feature_names)

    # å°†åŸå§‹æ•°æ®è¿›è¡ŒReshapeï¼Œå˜æˆ[N, 14]è¿™æ ·çš„å½¢çŠ¶
    data = data.reshape([data.shape[0] // feature_num, feature_num])

    # å°†åŸæ•°æ®é›†æ‹†åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†
    # è¿™é‡Œä½¿ç”¨80%çš„æ•°æ®åšè®­ç»ƒï¼Œ20%çš„æ•°æ®åšæµ‹è¯•
    # æµ‹è¯•é›†å’Œè®­ç»ƒé›†å¿…é¡»æ˜¯æ²¡æœ‰äº¤é›†çš„
    ratio = 0.8
    offset = int(data.shape[0] * ratio)
    training_data = data[:offset]

    # è®¡ç®—è®­ç»ƒé›†çš„æœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼Œå¹³å‡å€¼
    maximums, minimums, avgs = training_data.max(axis=0), training_data.min(axis=0), \
                                 training_data.sum(axis=0) / training_data.shape[0]

    # å¯¹æ•°æ®è¿›è¡Œå½’ä¸€åŒ–å¤„ç†
    for i in range(feature_num):
        #print(maximums[i], minimums[i], avgs[i])
        data[:, i] = (data[:, i] - minimums[i]) / (maximums[i] - minimums[i])

    # è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„åˆ’åˆ†æ¯”ä¾‹
    training_data = data[:offset]
    test_data = data[offset:]
    return training_data, test_data
</code></pre> 
<p>æ­¤æ“ä½œä»…ä¸ºè®­ç»ƒæ—¶ç›´è§‚æœ‰æ•ˆï¼Œä¸å°è£…æˆç±»ä¹Ÿæ²¡æœ‰å…³ç³»ã€‚ä½†å°è£…æˆç±»æ›´ç®€å•æ¸…æ™°ï¼Œæˆ‘è¿™æ˜¯ç›´æ¥å†™åœ¨Tensor_3.pyæ–‡ä»¶é‡Œã€‚</p> 
<p><img alt="" height="658" src="https://images2.imgbox.com/bb/b3/6u4e9xjX_o.png" width="820"></p> 
<p>Tensor_1ä¸ºä¸»ç¨‹åºï¼Œä½¿ç”¨æ—¶ç›´æ¥ä»Tensor_3ä¸­è°ƒç”¨load_dataç±»å³å¯ã€‚å¦‚å›¾æ‰€ç¤ºï¼š</p> 
<p><img alt="" height="646" src="https://images2.imgbox.com/cf/3e/BSsil8Sa_o.png" width="720"></p> 
<h3 id="%C2%A0%E4%BA%8C%EF%BC%8C%E6%A8%A1%E5%9E%8B%E8%AE%BE%E8%AE%A1">Â äºŒï¼Œæ¨¡å‹è®¾è®¡</h3> 
<h4 id="%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%EF%BC%9A%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0">çº¿æ€§å›å½’ï¼šÂ  Â  Â  Â </h4> 
<p>Â Â Â Â Â Â Â Â Â æ¨¡å‹è®¾è®¡æ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹å…³é”®è¦ç´ ä¹‹ä¸€ï¼Œä¹Ÿç§°ä¸ºç½‘ç»œç»“æ„è®¾è®¡ï¼Œç›¸å½“äºæ¨¡å‹çš„å‡è®¾ç©ºé—´ï¼Œå³å®ç°æ¨¡å‹â€œå‰å‘è®¡ç®—â€ï¼ˆä»è¾“å…¥åˆ°è¾“å‡ºï¼‰çš„è¿‡ç¨‹ã€‚æœ¬æ–‡åªè®¨è®ºçº¿æ€§å›å½’ï¼Œçº¿æ€§å›å½’æ˜¯åˆ©ç”¨æ•°ç†ç»Ÿè®¡ä¸­å›å½’åˆ†æï¼Œæ¥ç¡®å®šä¸¤ç§æˆ–ä¸¤ç§ä»¥ä¸Š å˜é‡é—´ç›¸äº’ä¾èµ–çš„å®šé‡å…³ç³»çš„ä¸€ç§ç»Ÿè®¡åˆ†ææ–¹æ³•ã€‚å®ƒå¯¹ä¸€ä¸ªæˆ–å¤šä¸ªè‡ª å˜é‡ä¸å› å˜é‡ä¹‹é—´çš„å…³ç³»è¿›è¡Œå»ºæ¨¡ï¼Œå¾—å‡ºçš„å‡½æ•°æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªç§°ä¸ºå› å½’ç³»æ•°çš„æ¨¡å‹å‚æ•°çš„çº¿æ€§ç»„åˆã€‚ç”¨ä¸€ä¸ªæ–¹ç¨‹å¼æ¥è¡¨ç¤ºå¦‚ä¸‹ï¼š ğ‘¦ = ğœ”ğ‘–ğ‘¥ğ‘– + ğ‘ ğ‘– = 0,1, â€¦</p> 
<p>Â Â Â Â Â Â Â Â çº¿æ€§å›å½’è¦è§£å†³çš„é—®é¢˜ä¾¿æ˜¯å¾—å‡ºæœ€ä½³çš„æ‹Ÿåˆçº¿ï¼Œå»ºç«‹è‡ªå˜é‡ä¸ å› å˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œè·å¾—è¯¥æ¡æœ€ä½³æ‹Ÿåˆçº¿å¯ä»¥é€šè¿‡ä½¿ç”¨æœ€å°äºŒä¹˜æ³•æ¥ è§£å†³ã€‚å¯¹äºè§‚æµ‹æ•°æ®ï¼Œå®ƒé€šè¿‡æœ€å°åŒ–æ¯ä¸€ä¸ªæ•°æ®ç‚¹åˆ°çº¿çš„å‚ç›´åå·®å¹³ æ–¹å’Œæ¥è®¡ç®—æœ€ä½³æ‹Ÿåˆçº¿ã€‚çº¿æ€§å›å½’çš„ç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼š ğ‘šğ‘–ğ‘› ğœ” â€–ğ‘‹ğœ” âˆ’ ğ‘¦â€– 2</p> 
<h4 id="%E5%89%8D%E5%90%91%E4%BC%A0%E6%92%AD%EF%BC%9A">å‰å‘ä¼ æ’­ï¼š</h4> 
<p>Â Â Â Â Â Â Â Â å°†ä¸Šè¿°è®¡ç®—é¢„æµ‹è¾“å‡ºçš„è¿‡ç¨‹ä»¥â€œç±»å’Œå¯¹è±¡â€çš„æ–¹å¼æ¥æè¿°ï¼Œç±»æˆå‘˜å˜é‡æœ‰å‚æ•°wå’Œbã€‚é€šè¿‡å†™ä¸€ä¸ª<code>forward</code>å‡½æ•°ï¼ˆä»£è¡¨â€œå‰å‘è®¡ç®—â€ï¼‰å®Œæˆä¸Šè¿°ä»ç‰¹å¾å’Œå‚æ•°åˆ°è¾“å‡ºé¢„æµ‹å€¼çš„è®¡ç®—è¿‡ç¨‹ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p> 
<pre><code class="language-python">class Network(object):
    def __init__(self, num_of_weights):
        # éšæœºäº§ç”Ÿwçš„åˆå§‹å€¼
        # ä¸ºäº†ä¿æŒç¨‹åºæ¯æ¬¡è¿è¡Œç»“æœçš„ä¸€è‡´æ€§ï¼Œ
        # æ­¤å¤„è®¾ç½®å›ºå®šçš„éšæœºæ•°ç§å­
        np.random.seed(0)
        self.w = np.random.randn(num_of_weights, 1)
        self.b = 0.
        
    def forward(self, x):
        z = np.dot(x, self.w) + self.b
        return z</code></pre> 
<p>Â é¦–å…ˆå®šä¹‰ä¸€ä¸ªNetworkç±»ï¼Œæˆ‘ä»¬è®­ç»ƒæ‰€ç”¨çš„æ–¹æ³•éƒ½ä¼šé›†æˆåœ¨è¿™ä¸ªç±»é‡Œã€‚</p> 
<p>åˆå§‹åŒ–num_of_weightsæƒé‡çš„æ•°é‡ï¼Œå³ä¸ºç‰¹å¾å€¼çš„æ•°é‡ï¼Œè¿™é‡Œæ˜¯13ï¼Œå› ä¸ºæˆ‘ä»¬çš„æ•°æ®æœ‰14åˆ—ï¼Œæœ€åä¸€åˆ—æ˜¯æ ‡ç­¾ä¸éœ€è¦æœ‰æƒé‡wï¼Œç„¶åéšæœºåˆå§‹åŒ–è¿™äº›wï¼Œnp.random.seed(0)è¿™é‡Œé‡‡ç”¨éšæœºæ•°ç§å­0</p> 
<p>numpy.random.randn(d0,d1,â€¦,dn)ã€‚randnå‡½æ•°è¿”å›ä¸€ä¸ªæˆ–ä¸€ç»„æ ·æœ¬ï¼Œå…·æœ‰æ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚dnè¡¨æ ¼æ¯ä¸ªç»´åº¦ï¼Œè¿”å›å€¼ä¸ºæŒ‡å®šç»´åº¦çš„arrayï¼Œåˆå§‹åŒ–bä¸º0ã€‚</p> 
<p>forwordæ–¹æ³•ä¸­ï¼Œnp.dotï¼ˆï¼‰è¡¨ç¤ºçŸ©é˜µç›¸ä¹˜ã€‚xä¸ºä»»æ„è¡Œ13åˆ—çš„çŸ©é˜µï¼Œself.wä¸º13è¡Œ1åˆ—çš„çŸ©é˜µã€‚åŠ ä¸Šæƒé‡bï¼Œæœ€åè¾“å‡ºzä¸ºä»»æ„è¡Œ1åˆ—çš„çŸ©é˜µï¼Œå®ç°å‰å‘ä¼ æ’­ã€‚</p> 
<h4 id="%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0%EF%BC%9A">æŸå¤±å‡½æ•°ï¼š</h4> 
<p>Â Â Â Â Â Â Â Â æ¨¡å‹è®¾è®¡å®Œæˆåï¼Œéœ€è¦é€šè¿‡è®­ç»ƒé…ç½®å¯»æ‰¾æ¨¡å‹çš„æœ€ä¼˜å€¼ï¼Œå³é€šè¿‡æŸå¤±å‡½æ•°æ¥è¡¡é‡æ¨¡å‹çš„å¥½åã€‚è®­ç»ƒé…ç½®ä¹Ÿæ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹å…³é”®è¦ç´ ä¹‹ä¸€ã€‚é€šè¿‡æ¨¡å‹è®¡ç®—x1x_1x1â€‹è¡¨ç¤ºçš„å½±å“å› ç´ æ‰€å¯¹åº”çš„æˆ¿ä»·åº”è¯¥æ˜¯zzz, ä½†å®é™…æ•°æ®å‘Šè¯‰æˆ‘ä»¬æˆ¿ä»·æ˜¯yyyã€‚è¿™æ—¶æˆ‘ä»¬éœ€è¦æœ‰æŸç§æŒ‡æ ‡æ¥è¡¡é‡é¢„æµ‹å€¼zè·ŸçœŸå®å€¼yä¹‹é—´çš„å·®è·ã€‚å¯¹äºå›å½’é—®é¢˜ï¼Œæœ€å¸¸é‡‡ç”¨çš„è¡¡é‡æ–¹æ³•æ˜¯ä½¿ç”¨å‡æ–¹è¯¯å·®ä½œä¸ºè¯„ä»·æ¨¡å‹å¥½åçš„æŒ‡æ ‡ï¼Œå…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š</p> 
<p>Loss=(yâˆ’z)2Loss = (y - z)^2Loss=(yâˆ’z)2</p> 
<p>ä¸Šå¼ä¸­çš„LossLossLossï¼ˆç®€è®°ä¸º:Â Lï¼‰é€šå¸¸ä¹Ÿè¢«ç§°ä½œæŸå¤±å‡½æ•°ï¼Œå®ƒæ˜¯è¡¡é‡æ¨¡å‹å¥½åçš„æŒ‡æ ‡ã€‚<strong>æŸå¤±å‡½æ•°çš„å®šä¹‰å¹¶ä¸å”¯ä¸€</strong>ã€‚</p> 
<p>å¯¹ä¸€ä¸ªæ ·æœ¬è®¡ç®—æŸå¤±å‡½æ•°å€¼çš„å®ç°å¦‚ä¸‹ï¼š</p> 
<pre><code class="language-python">    def loss(self, z, y):
        error = z - y
        cost = error * error
        cost = np.mean(cost)
        return cost</code></pre> 
<p>zä¸ºå‰å‘ä¼ æ’­æ±‚å‡ºçš„æƒé‡ï¼Œä¸ºä»»æ„è¡Œ1åˆ—çš„çŸ©é˜µï¼Œä¸ºæ¨¡å‹çš„é¢„æµ‹å€¼ï¼Œç”±äºè¿˜æ²¡æœ‰è¿›è¡Œåå‘ä¼ æ’­æ›´æ–°å‚æ•°ï¼Œwæœ€å¼€å§‹çš„èµ‹å€¼çš„ä»»æ„çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡å¾—åˆ°çš„zå€¼å°±æ˜¯è’™çš„ã€‚ç›¸åº”çš„å®é™…å€¼yä¹Ÿä¸ºä»»æ„è¡Œ1åˆ—çš„çŸ©é˜µã€‚error = z - yï¼Œå°†é¢„æµ‹å€¼çŸ©é˜µzä¸å®é™…å€¼çŸ©é˜µyåšå·®ï¼Œæ‰€å¾—åˆ°çš„å€¼èµ‹ç»™errorã€‚æ­¤æ—¶çš„errorå¯èƒ½ä¸ºæ­£ï¼Œä¹Ÿå¯èƒ½ä¸ºè´Ÿæ•°ã€‚è€Œcostä¸ºerrorçš„å¹³æ–¹ï¼Œ<strong>å¯¹åº”æ•°æ®ç›¸ä¹˜ï¼Œå¹¶éçŸ©é˜µçš„ä¹˜æ³•</strong>ï¼Œå¿…å®šä¸ºæ­£æ•°ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šè¯´ï¼ŒæŸå¤±å€¼costè¶Šå°‘ï¼Œæ¨¡å‹çš„è´¨é‡è¶Šé«˜ï¼Œé¢„æµ‹æ•ˆæœè¶Šå¥½ã€‚np.mean()ä¸ºæ±‚å¹³å‡å€¼å‡½æ•°ï¼Œå¯¹ä»»æ„è¡Œ1åˆ—costå†…çš„å…ƒç´ æ±‚å‡å€¼ï¼Œå¹¶èµ‹å€¼ç»™costï¼Œæœ€åè¿”å›costã€‚</p> 
<h4 id="%E8%AE%A1%E7%AE%97%E6%A2%AF%E5%BA%A6%EF%BC%9A">è®¡ç®—æ¢¯åº¦ï¼š</h4> 
<p>Â  Â  Â  Â  æ‰€è°“æ¢¯åº¦ï¼Œç®€å•æ¥è¯´å°±æ˜¯å¯¹åº”å˜é‡çš„å¯¼æ•°ã€‚æ ¹æ®ä¸Šé¢çš„ç»“è®ºï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æŸå¤±å‡½æ•°losså…³äºzï¼Œyçš„å‡½æ•°ã€‚è€Œzæ˜¯wå’Œbå‡½æ•°ï¼Œæˆ‘ä»¬çš„æœ€ç»ˆç›®çš„æ˜¯æ±‚å‡ºå°½å¯èƒ½ç²¾ç¡®çš„wå’Œbï¼Œä»è€Œä½¿å¾—é¢„æµ‹å€¼zæ— é™é€¼è¿‘äºyï¼Œä½¿losså°½å¯èƒ½åœ°å‡å°‘ã€‚</p> 
<p>Â  Â  Â  Â  ç”±é«˜ç­‰æ•°å­¦çš„çŸ¥è¯†æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå‡½æ•°æ²¿æ¢¯åº¦æ–¹å‘ä¸Šå‡æœ€å¿«ã€‚å¯¹åº”çš„ï¼Œå‡½æ•°æ²¿æ¢¯åº¦åæ–¹å‘ä¸‹é™çš„æœ€å¿«ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦æ±‚å‡ºæ¢¯åº¦å–åå°±å¯ä»¥ä½¿lossä¸‹é™æœ€å¿«ï¼Œå³lossåˆ†åˆ«å¯¹wå’Œbæ±‚åå¯¼ã€‚</p> 
<p>Â Â Â Â Â Â Â <strong>Â ä»¥ä¸‹ä¸ºè¯¦ç»†çš„æ•°å­¦æ¨å¯¼éƒ¨åˆ†ï¼Œæ•°å­¦åŸºç¡€ç›¸å¯¹è¾ƒå¥½çš„è¯»è€…å¯ä»¥ä»”ç»†ç ”è¯»ã€‚æ•°å­¦åŸºç¡€ç›¸å¯¹è¾ƒå¼±çš„è¯»è€…å¯ä»¥ç›´æ¥è·³åˆ°æ¬¢ä¹çš„ä»£ç ç¯èŠ‚ã€‚</strong></p> 
<p><img alt="" height="747" src="https://images2.imgbox.com/cb/91/64rSXGFe_o.png" width="731"></p> 
<p>ä»£ç å®ç°å¦‚ä¸‹ï¼š</p> 
<pre><code class="language-python">    def gradient(self, x, y):
        z = self.forward(x)
        gradient_w = (z-y)*x
        gradient_w = np.mean(gradient_w, axis=0)
        gradient_w = gradient_w[:, np.newaxis]
        gradient_b = (z - y)
        gradient_b = np.mean(gradient_b)
        
        return gradient_w, gradient_b</code></pre> 
<p>Â gradientæ–¹æ³•å³ä¸ºæ±‚æ¢¯åº¦çš„æ–¹æ³•ï¼Œxä¸ºä»»æ„è¡Œ13åˆ—çš„çŸ©é˜µï¼Œä»£è¡¨ä»»æ„ç»„æ ·æœ¬å€¼ï¼Œæ¯ä¸€åˆ—ä»£è¡¨å¯¹åº”çš„ç‰¹å¾å€¼ï¼Œyä¸ºä»»æ„è¡Œ1åˆ—çš„çŸ©é˜µï¼Œä»£è¡¨ä»»æ„è¡Œæ ·æœ¬çš„å®é™…å€¼ã€‚gradient_w = (z-y)*xï¼Œå…¶ä¸­ (z-y)*xä¸ºlosså¯¹wæ±‚åå¯¼ï¼Œgradient_wè¡¨ç¤ºlosså¯¹wçš„æ¢¯åº¦ï¼Œä¸ºä»»æ„è¡Œ13åˆ—ã€‚è¿™æ˜¯ä»»æ„è¡Œæ ·æœ¬å€¼æ±‚å‡ºçš„åå¯¼ï¼Œç”¨np.meanæ–¹æ³•æ±‚ä»»æ„ç»„çš„å‡å€¼axis=0è¡¨ç¤ºå¯¹è¡Œæ±‚å¹³å‡å€¼ï¼Œæ­¤æ—¶gradient_wä¸º1ç»´å‘é‡ï¼Œé•¿åº¦ä¸º13</p> 
<p>ä¸ç¬¦åˆæ¨¡å‹è¾“å…¥è¦æ±‚ï¼Œå› æ­¤è¦å•ç‹¬åŠ 1ä¸ªç»´åº¦ï¼Œgradient_w = gradient_w[:, np.newaxis]è¡¨ç¤ºæ•°æ®ä¸å˜ï¼Œå•ç‹¬åŠ ä¸€ä¸ªç»´åº¦ã€‚</p> 
<p>gradient_båŒç†ã€‚</p> 
<h4 id="%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%EF%BC%9A">åå‘ä¼ æ’­ï¼š</h4> 
<p>Â Â Â Â Â Â Â Â <strong>åå‘ä¼ æ’­æ›´æ–°å‚æ•°ï¼Œä½¿ä¹‹å‰çš„è¢«éšæœºåˆå§‹åŒ–çš„wå’Œbå‘æ›´å‡†ç¡®çš„æƒé‡é è¿‘</strong>ã€‚</p> 
<p>æˆ‘ä»¬ä¹‹å‰è¯´è¿‡å‡½æ•°æ²¿æ¢¯åº¦çš„åæ–¹å‘ä¸‹é™æœ€å¿«ï¼Œè€Œæ¢¯åº¦å°±æ˜¯å‡½æ•°å¯¹å˜é‡çš„åå¯¼æ•°ï¼Œæˆ‘ä»¬æ—¢ç„¶å·²ç»æ±‚å¾—å¯¹åº”å˜é‡çš„åå¯¼æ•°ï¼Œå‡½æ•°çš„æ¢¯åº¦è‡ªç„¶å·²ç»å¾—åˆ°ã€‚ä¸ºä½¿losså‡½æ•°ä¸‹é™çš„å¾ˆå¿«ï¼Œè¿›è€Œä½¿æ¨¡å‹æ›´ç²¾ç¡®ï¼Œæˆ‘ä»¬éœ€è¦æ›´æ–°è¿™äº›â€œä¸å¤ªé è°±â€çš„wå’Œbã€‚</p> 
<p>ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p> 
<pre><code class="language-python">    def update(self, gradient_w, gradient_b, eta = 0.01):
        self.w = self.w - eta * gradient_w
        self.b = self.b - eta * gradient_b</code></pre> 
<p>etaè¡¨ç¤ºå­¦ä¹ ç‡è®¾ç½®ä¸º0.01ï¼Œä¹Ÿå«æ­¥é•¿ã€‚ç®€å•æ¥è¯´ï¼Œåå¯¼æ•°çš„æ–¹å‘åªæ˜¯ä¸€ä¸ªæ­£ç¡®çš„æ–¹å‘ï¼Œä½†æ¯æ¬¡è¦å‘ç€è¿™ä¸ªæ–¹å‘è¿ˆå‡ºå¤šå¤§çš„æ­¥å­ï¼Œç”±å­¦ä¹ ç‡å†³å®šã€‚</p> 
<p><strong>å­¦ä¹ ç‡è®¾ç½®è¿‡å¤§ï¼Œå¯èƒ½ä¼šé”™è¿‡æ­£ç¡®å€¼ã€‚</strong></p> 
<p><strong>å­¦ä¹ ç‡è®¾ç½®è¿‡å°ï¼Œå‚æ•°æ›´æ–°å¾ˆæ…¢ã€‚Â </strong></p> 
<h4 id="%E5%B0%81%E8%A3%85%E5%87%BD%E6%95%B0%EF%BC%9A"><strong>å°è£…å‡½æ•°ï¼š</strong></h4> 
<p>Â Â Â Â Â Â Â Â ç›®å‰ï¼Œæˆ‘ä»¬å·²ç»å†™å¥½äº†è®­ç»ƒéœ€è¦çš„æ‰€æœ‰æ–¹æ³•ã€‚é€šå¸¸æˆ‘ä»¬ä¼šæŠŠè¿™äº›æ–¹æ³•è¿åŒè®­ç»ƒè¿‡ç¨‹ä¸€èµ·å°è£…åˆ°ä¸€ä¸ªç±»é‡Œï¼Œåˆ©äºæ“ä½œã€‚</p> 
<p>ä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code class="language-python">    def train(self, training_data, num_epochs, batch_size=10, eta=0.01):
        n = len(training_data)
        losses = []
        for epoch_id in range(num_epochs):
            # åœ¨æ¯è½®è¿­ä»£å¼€å§‹ä¹‹å‰ï¼Œå°†è®­ç»ƒæ•°æ®çš„é¡ºåºéšæœºæ‰“ä¹±
            # ç„¶åå†æŒ‰æ¯æ¬¡å–batch_sizeæ¡æ•°æ®çš„æ–¹å¼å–å‡º
            np.random.shuffle(training_data)
            # å°†è®­ç»ƒæ•°æ®è¿›è¡Œæ‹†åˆ†ï¼Œæ¯ä¸ªmini_batchåŒ…å«batch_sizeæ¡çš„æ•°æ®
            mini_batches = [training_data[k:k + batch_size] for k in range(0, n, batch_size)]
            for iter_id, mini_batch in enumerate(mini_batches):
                # print(self.w.shape)
                # print(self.b)
                x = mini_batch[:, :-1]
                y = mini_batch[:, -1:]
                a = self.forward(x)
                loss = self.loss(a, y)
                gradient_w, gradient_b = self.gradient(x, y)
                self.update(gradient_w, gradient_b, eta)
                losses.append(loss)
                print('Epoch {:3d} / iter {:3d}, loss = {:.4f}'.
                      format(epoch_id, iter_id, loss))

        return losses</code></pre> 
<p>Epochè¡¨ç¤ºä¸€è½®è¿­ä»£ï¼Œä¸€è½®è¿­ä»£è¡¨ç¤ºæ‰€æœ‰çš„æ ·æœ¬å‡è¢«ä½¿ç”¨è¿‡ä¸€è½®ã€‚</p> 
<p>epoch_idè¡¨ç¤ºç¬¬å‡ è½®è¿­ä»£ã€‚</p> 
<p>num_epochsè¡¨ç¤ºè¿­ä»£çš„è½®æ•°ã€‚</p> 
<p>mini_batcheè¡¨ç¤ºä¸€ä¸ªbatchæ‰€åŒ…å«çš„æœ€å°æ ·æœ¬æ•°ã€‚</p> 
<p>batch_sizeè¡¨ç¤ºä¸€ä¸ªbatchæ‰€åŒ…å«æ ·æœ¬æ•°æ®çš„å¤§å°ã€‚</p> 
<p>mini_batchesè¡¨ç¤ºbatchçš„æ•°é‡</p> 
<p>xè¡¨ç¤ºæ¯ä¸ªmini_batchçš„ç‰¹å¾å€¼</p> 
<p>yè¡¨ç¤ºæ¯ä¸ªmini_batchçš„æ ‡ç­¾</p> 
<p>np.random.shuffle(training_data)è¡¨ç¤ºå°†training_dataä¹±åºï¼Œè¿›æ”¹å˜è¡Œçš„ä½ç½®ï¼Œæ ·æœ¬æ•°æ®ä¸å‘ç”Ÿæ”¹å˜ã€‚</p> 
<p>mini_batches = [training_data[k:k + batch_size] for k in range(0, n, batch_size)]</p> 
<p>å…¶ä¸­mini_batchesä¸ºä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨é‡Œçš„æ¯ä¸€ä¸ªå…ƒç´ å‡ä¸ºï¼Œbatch_sizeè¡Œ14åˆ—çš„çŸ©é˜µã€‚</p> 
<p>å¤–å±‚å¾ªç¯è¡¨ç¤ºè¿­ä»£çš„è½®æ•°ã€‚</p> 
<p>å†…å±‚å¾ªç¯è¡¨ç¤ºæ¯æ¬¡å–‚å…¥ç½‘ç»œbatch_sizeè¡Œ14åˆ—çš„çŸ©é˜µï¼Œç›´åˆ°ä¸€ä¸ªepochç»“æŸã€‚å³æ‰€æœ‰æ•°æ®å‡è¢«ä½¿ç”¨ä¸€æ¬¡ã€‚</p> 
<p><strong>å…³äºä¸ºä»€ä¹ˆä¸åªä½¿ç”¨ä¸€æ¬¡æ•°æ®ï¼š</strong></p> 
<p><strong>Â  Â  Â  Â  ç®€å•æ¥è¯´ï¼Œå°±åƒæˆ‘ä»¬äººç±»å­¦ä¹ ä¸€æ ·ï¼Œæˆ‘ä»¬å¯¹åå­¦çš„çŸ¥è¯†è®°å¿†ç¨‹åº¦ç›¸æ¯”è¾ƒäºä¹‹å‰å­¦è¿‡çš„çŸ¥è¯†è®°å¾—æ›´æ¸…æ™°ä¸€äº›ã€‚åœ¨æˆ¿ä»·é¢„æµ‹é—®é¢˜ä¸Šï¼Œåå‡ºç°çš„æ•°æ®ä¼šå¯¹æ¨¡å‹äº§ç”Ÿæƒé‡è¾ƒå¤§çš„å½±å“ã€‚ä¸ºäº†æ¶ˆé™¤è¿™ä¸€å½±å“ï¼Œé€šå¸¸ä¼šå¯¹è®­ç»ƒé›†è¿›è¡Œå¯¹æ¬¡epochï¼Œåœ¨æ­¤ä¹‹å‰éƒ½è¦ç”¨shuffleè¿›è¡Œä¹±åºã€‚</strong></p> 
<h2 id="%E6%80%BB%E7%BB%93">æ€»ç»“ï¼š</h2> 
<p>æ‰€æœ‰ä»£ç å¦‚å›¾æ‰€ç¤ºï¼š</p> 
<p>Tensor_3.py:</p> 
<pre><code class="language-python">import numpy as np
def load_data():
    # ä»æ–‡ä»¶å¯¼å…¥æ•°æ®
    datafile = 'housing.data'
    data = np.fromfile(datafile, sep=' ')

    # æ¯æ¡æ•°æ®åŒ…æ‹¬14é¡¹ï¼Œå…¶ä¸­å‰é¢13é¡¹æ˜¯å½±å“å› ç´ ï¼Œç¬¬14é¡¹æ˜¯ç›¸åº”çš„æˆ¿å±‹ä»·æ ¼ä¸­ä½æ•°
    feature_names = [ 'CRIM', 'ZN', 'INDUS', 'CHAS', 'NOX', 'RM', 'AGE', \
                      'DIS', 'RAD', 'TAX', 'PTRATIO', 'B', 'LSTAT', 'MEDV' ]
    feature_num = len(feature_names)

    # å°†åŸå§‹æ•°æ®è¿›è¡ŒReshapeï¼Œå˜æˆ[N, 14]è¿™æ ·çš„å½¢çŠ¶
    data = data.reshape([data.shape[0] // feature_num, feature_num])

    # å°†åŸæ•°æ®é›†æ‹†åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†
    # è¿™é‡Œä½¿ç”¨80%çš„æ•°æ®åšè®­ç»ƒï¼Œ20%çš„æ•°æ®åšæµ‹è¯•
    # æµ‹è¯•é›†å’Œè®­ç»ƒé›†å¿…é¡»æ˜¯æ²¡æœ‰äº¤é›†çš„
    ratio = 0.8
    offset = int(data.shape[0] * ratio)
    training_data = data[:offset]

    # è®¡ç®—è®­ç»ƒé›†çš„æœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼Œå¹³å‡å€¼
    maximums, minimums, avgs = training_data.max(axis=0), training_data.min(axis=0), \
                                 training_data.sum(axis=0) / training_data.shape[0]

    # å¯¹æ•°æ®è¿›è¡Œå½’ä¸€åŒ–å¤„ç†
    for i in range(feature_num):
        #print(maximums[i], minimums[i], avgs[i])
        data[:, i] = (data[:, i] - minimums[i]) / (maximums[i] - minimums[i])

    # è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„åˆ’åˆ†æ¯”ä¾‹
    training_data = data[:offset]
    test_data = data[offset:]
    return training_data, test_data
</code></pre> 
<p>Tensor_1.py:</p> 
<pre><code class="language-python">from Tensor_3 import load_data
import numpy as np
import matplotlib.pyplot as plt

class Network(object):
    def __init__(self, num_of_weights):
        # éšæœºäº§ç”Ÿwçš„åˆå§‹å€¼
        # ä¸ºäº†ä¿æŒç¨‹åºæ¯æ¬¡è¿è¡Œç»“æœçš„ä¸€è‡´æ€§ï¼Œæ­¤å¤„è®¾ç½®å›ºå®šçš„éšæœºæ•°ç§å­
        np.random.seed(0)
        self.w = np.random.randn(num_of_weights, 1)
        self.b = 0.

    def forward(self, x):
        z = np.dot(x, self.w) + self.b
        return z

    def loss(self, z, y):
        error = z - y
        cost = error * error
        cost = np.mean(cost)
        return cost

    def gradient(self, x, y):
        z = self.forward(x)
        gradient_w = (z - y) * x
        gradient_w = np.mean(gradient_w, axis=0)
        gradient_w = gradient_w[:, np.newaxis]
        gradient_b = (z - y)
        gradient_b = np.mean(gradient_b)

        return gradient_w, gradient_b

    def update(self, gradient_w, gradient_b, eta=0.01):
        self.w = self.w - eta * gradient_w
        self.b = self.b - eta * gradient_b

    def train(self, training_data, num_epochs, batch_size=10, eta=0.01):
        n = len(training_data)
        losses = []
        for epoch_id in range(num_epochs):
            # åœ¨æ¯è½®è¿­ä»£å¼€å§‹ä¹‹å‰ï¼Œå°†è®­ç»ƒæ•°æ®çš„é¡ºåºéšæœºæ‰“ä¹±
            # ç„¶åå†æŒ‰æ¯æ¬¡å–batch_sizeæ¡æ•°æ®çš„æ–¹å¼å–å‡º
            np.random.shuffle(training_data)
            # å°†è®­ç»ƒæ•°æ®è¿›è¡Œæ‹†åˆ†ï¼Œæ¯ä¸ªmini_batchåŒ…å«batch_sizeæ¡çš„æ•°æ®
            mini_batches = [training_data[k:k + batch_size] for k in range(0, n, batch_size)]
            for iter_id, mini_batch in enumerate(mini_batches):
                # print(self.w.shape)
                # print(self.b)
                x = mini_batch[:, :-1]
                y = mini_batch[:, -1:]
                a = self.forward(x)
                loss = self.loss(a, y)
                gradient_w, gradient_b = self.gradient(x, y)
                self.update(gradient_w, gradient_b, eta)
                losses.append(loss)
                print('Epoch {:3d} / iter {:3d}, loss = {:.4f}'.
                      format(epoch_id, iter_id, loss))

        return losses

train_data, test_data = load_data()
# åˆ›å»ºç½‘ç»œ

net = Network(13)
# å¯åŠ¨è®­ç»ƒ
losses = net.train(train_data, num_epochs=50, batch_size=100, eta=0.1)

# ç”»å‡ºæŸå¤±å‡½æ•°çš„å˜åŒ–è¶‹åŠ¿
plot_x = np.arange(len(losses))
plot_y = np.array(losses)
plt.plot(plot_x, plot_y)
plt.show()
</code></pre> 
<p>é€šè¿‡ç»“æœæˆ‘ä»¬å¯ä»¥çœ‹åˆ°lossåœ¨é€æ¸å‡å°‘ã€‚</p> 
<p><img alt="" height="412" src="https://images2.imgbox.com/59/e0/ZIniFelT_o.png" width="567"></p> 
<p><img alt="" height="600" src="https://images2.imgbox.com/d7/bf/VKfA1DBm_o.png" width="335"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d748737db7f5f38c0f636ca9cf65f8b2/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">æ¸…åå¤§å­¦æ–‡ä»¶æœåŠ¡å™¨,æ¸…åå¤§å­¦äº‘å­˜å‚¨Corsairåº”ç”¨å®è·µ</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/15d0e93d57656c22f535d3345bcec61e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">æœåŠ¡å™¨uå•æ ¸æ€§èƒ½æ’è¡Œ,CPUå•æ ¸æ€§èƒ½å¤©æ¢¯å›¾2021 2021å¹´æœ€æ–°CPUå•æ ¸æ€§èƒ½æ’è¡Œå¤©æ¢¯å›¾...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ITå­¦ä¹ è€…åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>