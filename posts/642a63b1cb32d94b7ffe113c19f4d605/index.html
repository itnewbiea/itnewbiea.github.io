<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java实现（如：WORD、EXCEL、PPT、ZIP 等）文件在线预览功能 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java实现（如：WORD、EXCEL、PPT、ZIP 等）文件在线预览功能" />
<meta property="og:description" content="一：背景 用户在查看文章详情的时候，文章除了正文外还附带有各类型附件（如：word,excel,ppt,zip等），当用户想要查看附件时，需要先下载到本地再打开，这样很不方便，于是用户希望能够有在线预览附件的功能。
二：方案（参考：https://blog.csdn.net/xinghui_liu/article/details/125641300） 日常开发中常见的文件格式有pdf，word，Excel，PPT，Html，txt，图片等。pdf，Html，txt，图片这种实现在线预览非常简单，有一些前端的插件可以满足要求。word，Excel，PPT如果要实现在线预览，就非常的困难。word，Excel，PPT实现在线预览常用的方式就是先转换成pdf，然后在进行预览。下面我就介绍常用的几种方案
方法一、kkfileview 文件在线预览
kkfileview支持文件格式多，而且不用开发。不过需要单独部署一个文件预览的服务，而且服务
器也需要安装openoffice。
方法二、officetohtml纯前端的方式
officetohtml纯前端的方式可以不用安装任何插件及服务，但是目前只支持文件地址的方式预览
，如果是文件流的话无法使用。
方法三、JODConverter
JODConverter 依赖于openoffice，需要在服务器单独安装openoffice。
方法四、Aspose
Aspose使用的是破解版的，如果商用使用需要考虑版权问题。
综上所述，考虑到方法四有版权问题所以我首先排除了选四，一，二，三都需要安装openoffice，又由于方法一支持的文件类型更多而且无需开发，所以最终我选择了方法一，接下来我就单讲方法一的整个实现过程。
三：kkfileview 文件在线预览具体实现 1. windows环境部署运行
1.1 环境要求
1. Java: 1.8&#43;
2. OpenOffice或LiberOffice(Windows下已内置）无需考虑此条
1.2 下载 kkFileView-4.0.0.zip（Windows版）
下载链接：kkFileView 发行版 - Gitee.com
或从我的资源里拿
1.3 解压 kkFileView-4.0.0.zip ，然后进入到kkFileView-4.0.0/bin/ 目录下，双击 startup.bat 即可启动该应用。浏览器能正常访问：http://localhost:8012 即可表示启动正常。
1.4 项目接入使用
如果你的项目需要接入文件预览项目，达到对docx,excel,ppt,jpg等文件的预览效果，那么通过在你的前端项目中加入下面的代码即可成功实现。
var url = &#39;http://127.0.0.1:8080/file/test.txt&#39;; //要预览文件的访问地址
window.open(&#39;http://127.0.0.1:8012/onlinePreview?url=&#39;&#43;encodeURIComponent
(Base64.encode(url)));
黄色背景部分为运行的kkFileView的地址
Base64 一定要用，否则文件打不开
完毕！ 2. linux环境部署运行
2.1 环境要求
1. Java: 1.8&#43;
2. OpenOffice或LiberOffice(CentOS或Ubuntu下, 联网了会自动下载安装，MacOS下需要
自行安装)，由于我是CentOS系统且是内网，无法自动下载，于是我选择了手动下载安装包并离线安装LiberOffice。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/642a63b1cb32d94b7ffe113c19f4d605/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-26T13:19:54+08:00" />
<meta property="article:modified_time" content="2022-10-26T13:19:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java实现（如：WORD、EXCEL、PPT、ZIP 等）文件在线预览功能</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4><strong>一：背景</strong></h4> 
<p>用户在查看文章详情的时候，文章除了正文外还附带有各类型附件（如：word,excel,ppt,zip等），当用户想要查看附件时，需要先下载到本地再打开，这样很不方便，于是用户希望能够有在线预览附件的功能。</p> 
<h4><strong>二：方案（参考：</strong><a href="https://blog.csdn.net/xinghui_liu/article/details/125641300" title="https://blog.csdn.net/xinghui_liu/article/details/125641300">https://blog.csdn.net/xinghui_liu/article/details/125641300</a><strong>）</strong></h4> 
<p>日常开发中常见的文件格式有pdf，word，Excel，PPT，Html，txt，图片等。pdf，Html，txt，图片这种实现在线预览非常简单，有一些前端的插件可以满足要求。word，Excel，PPT如果要实现在线预览，就非常的困难。word，Excel，PPT实现在线预览常用的方式就是先转换成pdf，然后在进行预览。下面我就介绍常用的几种方案<br><strong>方法一、kkfileview 文件在线预览</strong></p> 
<p>kkfileview支持文件格式多，而且不用开发。不过需要单独部署一个文件预览的服务，而且服务<br> 器也需要安装openoffice。</p> 
<p><strong>方法二、officetohtml纯前端的方式</strong></p> 
<p>officetohtml纯前端的方式可以不用安装任何插件及服务，但是目前只支持文件地址的方式预览<br> ，如果是文件流的话无法使用。</p> 
<p><strong>方法三、JODConverter</strong></p> 
<p>JODConverter 依赖于openoffice，需要在服务器单独安装openoffice。</p> 
<p><strong>方法四、Aspose</strong></p> 
<p>Aspose使用的是破解版的，如果商用使用需要考虑版权问题。</p> 
<p>综上所述，考虑到方法四有版权问题所以我首先排除了选四，一，二，三都需要安装openoffice，又由于方法一支持的文件类型更多而且无需开发，所以最终我选择了方法一，接下来我就单讲方法一的整个实现过程。</p> 
<h4>三：<strong>kkfileview 文件在线预览具体实现</strong></h4> 
<p><strong>1. windows环境部署运行</strong></p> 
<p>1.1 环境要求</p> 
<p>1.  Java: 1.8+<br> 2.  OpenOffice或LiberOffice(Windows下已内置）无需考虑此条</p> 
<p>1.2 下载<a href="https://gitee.com/link?target=https%3A%2F%2Fkkfileview.keking.cn%2FkkFileView-4.0.0.zip" rel="nofollow" title=" kkFileView-4.0.0.zip"> kkFileView-4.0.0.zip</a>（Windows版）</p> 
<p>下载链接：<a href="https://gitee.com/kekingcn/file-online-preview/releases" rel="nofollow" title="kkFileView 发行版 - Gitee.com">kkFileView 发行版 - Gitee.com</a></p> 
<p>或从我的资源里拿</p> 
<p>1.3  解压 kkFileView-4.0.0.zip ，然后进入到kkFileView-4.0.0/bin/ 目录下，双击 startup.bat 即可启动该应用。浏览器能正常访问：http://localhost:8012  即可表示启动正常。</p> 
<p>1.4  项目接入使用</p> 
<p>如果你的项目需要接入文件预览项目，达到对docx,excel,ppt,jpg等文件的预览效果，那么通过在你的前端项目中加入下面的代码即可成功实现。</p> 
<p>var <span style="color:#fe2c24;">url</span> = 'http://127.0.0.1:8080/file/test.txt'; //要预览文件的访问地址<br> window.open(<span style="background-color:#ffd900;">'http://127.0.0.1:8012/onlinePreview?url='</span>+encodeURIComponent<br> (<span style="background-color:#ffd900;">Base64</span>.encode(<span style="color:#fe2c24;">url</span>)));</p> 
<p><span style="background-color:#ffd900;">黄色背景部分为运行的kkFileView的地址</span></p> 
<p><span style="background-color:#ffd900;">Base64 一定要用，否则文件打不开</span></p> 
<h4>完毕！</h4> 
<p><strong>2. linux环境部署运行</strong></p> 
<p> 2.1 环境要求</p> 
<p>1.  Java: 1.8+</p> 
<p>2. OpenOffice或LiberOffice(CentOS或Ubuntu下, 联网了会自动下载安装，MacOS下需要<br> 自行安装)，<span style="background-color:#ffd900;">由于我是CentOS系统且是内网，无法自动下载，于是我选择了手动下载安装包并离线安装LiberOffice。</span></p> 
<p>2.2 下载 LibreOffice_7.1.4_Linux_x86-64_rpm.tar.gz(Linux版)</p> 
<p>下载链接： <a href="https://www.libreoffice.org/download/download-libreoffice/" rel="nofollow" title="Download LibreOffice | LibreOffice - Free Office Suite - Based on OpenOffice - Compatible with Microsoft">Download LibreOffice | LibreOffice - Free Office Suite - Based on OpenOffice - Compatible with Microsoft</a></p> 
<p>将LibreOffice_7.1.4_Linux_x86-64_rpm.tar.gz上传到服务器后解压，进入到LibreOffice_7.1.4_Linux_x86-64_rpm/RPMS/目录下，进行LibreOffice的安装：</p> 
<p>&gt;    <span style="background-color:#ffd900;">cd /LibreOffice_7.1.4_Linux_x86-64_rpm/RPMS/</span></p> 
<p>&gt;    <span style="background-color:#ffd900;">yum localinstall *.rpm</span></p> 
<p>安装完成后会出现/opt/libreOffice7.1目录。</p> 
<p>备注：如果想要卸载libreOffice，则：</p> 
<p>    1.查看安装的（会显示安装了的列表）：rpm -qa|grep libreoffice </p> 
<p>    2.卸载（根据列表显示的）：yum remove libreoffice7.1-ure-7.1.4.2-2.x86_64</p> 
<p>    3. yum remove 剩余列表显示的</p> 
<p>    4.删除 /opt/ 目录下的libreOffice7.1 文件夹即可完成卸载。</p> 
<p>2.3 下载 <a href="https://gitee.com/link?target=https%3A%2F%2Fkkfileview.keking.cn%2FkkFileView-4.0.0.tar.gz" rel="nofollow" title="kkFileView-4.0.0.tar.gz">kkFileView-4.0.0.tar.gz</a> (Linux或MacOS版)</p> 
<p>下载链接：<a href="https://gitee.com/kekingcn/file-online-preview/releases" rel="nofollow" title="kkFileView 发行版 - Gitee.com">kkFileView 发行版 - Gitee.com</a></p> 
<p>或从我附件里拿</p> 
<p>2.4 上传 kkFileView-4.0.0.tar.gz 包到服务器后解压</p> 
<p>&gt;  <span style="background-color:#ffd900;">tar -zxvf kkFileView-4.0.0.tar.gz</span></p> 
<p>2.5 进入解压后的文件夹目录  /kkFileView-4.0.0/bin/ ,启动 kkFileView 应用</p> 
<p>&gt;  sh startup.sh</p> 
<p>2.6 启动后可以去 /kkFileView-4.0.0/log/kkFileView.log查看日志，如果日志报如下错误，可以先将</p> 
<p>kkFileView进程 kill掉，然后 kill 掉报错信息里的 2001端口的pid和2002端口的pid，然后再次重启即可</p> 
<p>报错信息：Caused by:.....Error creating bean with name 'officePluginManager': Invocation of init method failed:....failed to start and connect</p> 
<p>Caused by:org.artofsolving.jodconverter.office.OfficeException:failed to start and connect</p> 
<p>Caused by:....office.OfficeException:could not establish connection</p> 
<p>Caused by:.....a process with acceptString 'socket,host=127.0.0.1,port=2001' is already running;<span style="color:#0d0016;"><span style="background-color:#ffd900;">pid 299361</span></span></p> 
<p><img alt="" height="666" src="https://images2.imgbox.com/0d/17/CAhrbS63_o.png" width="1182"></p> 
<p> 2.7 浏览器能正常访问：http://服务器ip:8012 表明kkFileView应用运行正常，接下来参照上面的项目接入使用即可。</p> 
<h4>完毕！</h4> 
<h4><strong><span style="color:#0d0016;"><span style="background-color:#fbd4d0;">非root用户安装 LiberOffice+kkfileview：</span></span></strong></h4> 
<p><a href="https://blog.csdn.net/m0_37951794/article/details/127517357" title="kkFileView文件在线预览-（非root用户安装）_你要控几你几己的博客-CSDN博客">kkFileView文件在线预览-（非root用户安装）_你要控几你几己的博客-CSDN博客</a></p> 
<p><strong>如有其它疑问微信咨询：shx0928</strong></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b226d27528ba2ec6202228e561076536/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">cdn引入ElementPlus table显示不正常解决办法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ac537e75c949b90bf092c7e920c628e5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">element-UI el-table表格树形在指定列展开显示</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>