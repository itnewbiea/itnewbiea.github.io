<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>NodeMCU学习（二）--NodeMCU介绍及使用（一） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="NodeMCU学习（二）--NodeMCU介绍及使用（一）" />
<meta property="og:description" content="原文：NodeMCU（ESP8266）开发笔记
1.NodeMCU简介 NodeMCU 是一款开源的物联网开发平台，其固件和开发板均开源，自带 WIFI 模块。基于该平台，用几行简单的 Lua 脚本就能开发物联网应用。
其主要特点如下：
像 Arduino 一样操作硬件 IO 提供硬件的高级接口，可以将应用开发者从繁复的硬件配置、寄存器操作中解放出来。用交互式 Lua 脚本，像 Arduino 一样编写硬件代码！
用 Nodejs 类似语法写网络应用 事件驱动型 API 极大的方便了用户进行网络应用开发，使用类似 Nodejs 的方式编写网络代码，并运行于 5mm*5mm 大小的 MCU 之上，加快您的物联网开发进度。
超低成本的 WIFI 模块 用于快速原型的开发板，集成了售价低于 10 人民币 WIFI 芯片 ESP8266，为您提供性价比最高的物联网应用开发平台。
基于乐鑫 ESP8266 的 NodeMCU 开发板，具有 GPIO、PWM、I2C、1-Wire、ADC 等功能，结合 NodeMCU 固件为您的原型开发提供最快速的途径。
其硬件详细配置如下：
核心模组为 ESP8266MCU 为 Xtensa L106RAM 50KFlash 512KD1~D10：10 GPIO, 每个都能配置为 PWM, I2C, 1-wire 有两种串口配置
CP2102 USB 串口，即插即用（官方驱动支持 Windows, OS X，Linux 以及 VMware）CH340 USB 串口，国内用的较多，需要安装ch340驱动。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8747103d1c9310c6108e11a84a15e919/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-25T16:59:13+08:00" />
<meta property="article:modified_time" content="2021-01-25T16:59:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">NodeMCU学习（二）--NodeMCU介绍及使用（一）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>原文：<a href="https://blog.csdn.net/Little_Body/article/details/78033973?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161156443916780271582134%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=161156443916780271582134&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-78033973.first_rank_v2_pc_rank_v29&amp;utm_term=nodemcu%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B&amp;spm=1018.2226.3001.4187">NodeMCU（ESP8266）开发笔记</a></p> 
<h3 id="1nodemcu简介">1.NodeMCU简介</h3> 
<p>NodeMCU 是一款开源的物联网开发平台，其固件和开发板均开源，自带 WIFI 模块。基于该平台，用几行简单的 Lua 脚本就能开发物联网应用。</p> 
<p>其主要特点如下：</p> 
<ul><li> <p>像 Arduino 一样操作硬件 IO 提供硬件的高级接口，可以将应用开发者从繁复的硬件配置、寄存器操作中解放出来。用交互式 Lua 脚本，像 Arduino 一样编写硬件代码！</p> </li><li> <p>用 Nodejs 类似语法写网络应用 事件驱动型 API 极大的方便了用户进行网络应用开发，使用类似 Nodejs 的方式编写网络代码，并运行于 5mm*5mm 大小的 MCU 之上，加快您的物联网开发进度。</p> </li><li> <p>超低成本的 WIFI 模块 用于快速原型的开发板，集成了售价低于 10 人民币 WIFI 芯片 ESP8266，为您提供性价比最高的物联网应用开发平台。</p> </li></ul> 
<p>基于乐鑫 ESP8266 的 NodeMCU 开发板，具有 GPIO、PWM、I2C、1-Wire、ADC 等功能，结合 NodeMCU 固件为您的原型开发提供最快速的途径。</p> 
<p>其硬件详细配置如下：</p> 
<ul><li>核心模组为 ESP8266</li><li>MCU 为 Xtensa L106</li><li>RAM 50K</li><li>Flash 512K</li><li>D1~D10：10 GPIO, 每个都能配置为 PWM, I2C, 1-wire</li></ul> 
<p>有两种串口配置</p> 
<ul><li>CP2102 USB 串口，即插即用（官方驱动支持 Windows, OS X，Linux 以及 VMware）</li><li>CH340 USB 串口，国内用的较多，需要安装ch340驱动。<br> 注：VMware中，安装Ubuntu系统，只需在主机中安装驱动即可。然后将设备连接到VMware中。虚拟机-&gt;可移动设备，可以看到ch340设备，点击连接即可。</li></ul> 
<p><strong>CP2102版本</strong><br><img alt="这里写图片描述" src="https://images2.imgbox.com/90/94/W0bdtDIZ_o.jpg"></p> 
<p><strong>CH340版本</strong><br><img alt="这里写图片描述" src="https://images2.imgbox.com/40/79/gjsyzmmp_o.jpg"></p> 
<h3 id="2开发环境"><a name="t1"></a>2.开发环境</h3> 
<p>NodeMCU 目前支持的开发主机系统类型涵盖 Windows，Linux 和 Mac OS X，也支持通过 VMware 虚拟机搭建的 Linux 环境。</p> 
<p>需要提到的是，如果用虚拟机的话，请优先用 VMware 而不是 VirtualBox。虽然用 VirtualBox 也能够通过串口虚拟化 进行 Lua 开发，但是由于 VirtualBox 无法虚拟 uhci 的 cp210x，所以 VirtualBox 中的 Linux 上就无法直接烧录固件，会很不方便。</p> 
<p>下面是我们推荐的优选开发环境：<br> 纯 Linux（首推 ubuntu）<br> 在 Mac OS X 上安装 VMware，在 VMware 中运行 Linux（首推 Lubuntu）<br> 在 Windows 上安装 VMware，在 VMware 中运行 Linux（首推 Lubuntu）<br> 本文主要介绍上述三种，实际上核心还是 Linux 开发环境，后面两个只要额外安装 VMware 并在主机上也安装上 USB 串口驱动即可。</p> 
<p>如果大家手头没有 Linux 环境，那么建议通过 VMware 来安装 Linux，这样更安全可靠，避免搞坏原来的系统。</p> 
<p>VMware 可以从官方下载，安装好以后再从 Ubuntu 官方下载 Lubuntu 14.04 ISO，之后启动 VMware 来安装 Lubuntu。安装时先创建/Add 一个 Lubuntu（Create a custom virtual machine -&gt; Linux -&gt; Ubuntu 64bit），之后通过设置/Settings 选择 Startup Disk 从 CD/DVD 启动安装，选择刚下载的 ISO，安装成功后，再通过 Startup Disk 选回从 Hard Disk(SCSI) 启动即可。</p> 
<p>至于纯 Windows 或者纯 Mac OS X 环境，都不推荐，因为在 Linux 下，一条命令就可以安装所需的大部分工具，而在 Windows 和 Mac OS X 会浪费掉大量的时间去不同地方找不同工具，然后再花费更多倍的时间去解决各类软件编译和安装问题，事倍功半。而且 OS X 对于基本的开发环境，往往还存在收费服务，实在是不友好，珍惜生命，远离它们！</p> 
<p>但是如果真地厚爱它们，大家还是可以通过参考后续资料，尤其是 Noduino/Noduino SDK 相关部分，很详细地介绍到了 Windows 和 Mac OS X 的开发环境，另外，参考资料中的其他软件或者工具基本都有提供 README.md 对各自的安装做了说明，请予以参考。</p> 
<h3 id="3操作步骤"><a name="t2"></a>3.操作步骤</h3> 
<h4 id="以windows-和-vmware下ubuntu环境为例ch340版本"><a name="t3"></a>以Windows 和 VMware下Ubuntu环境为例（CH340版本）：</h4> 
<hr> 
<h4 id="windows环境下nodemcu开发"><a name="t4"></a>Windows环境下NodeMCU开发</h4> 
<p>需要用到的工具：</p> 
<ul><li>sciTe –lua开发环境，用于lua学习。具体参考：<a href="http://www.runoob.com/lua/lua-environment.html" rel="nofollow">http://www.runoob.com/lua/lua-environment.html</a><br> 注：在安装过程中，如果连接服务器失败。可以自行下载所需的库，然后重新进行安装。</li><li>CH340驱动</li><li>ESP8266Flasher – 烧录ESP固件</li><li>ESPlorer – 类似于串口调试助手，用于和NodeMCU进行交互，也可以上传lua脚本<br> 注：需要java环境，需要安装JDK。</li><li>Fans_ESP8266_SDK_Make.exe – 编译ESP固件 具体参考：<a href="http://blog.csdn.net/u013636122/article/details/50630235">http://blog.csdn.net/u013636122/article/details/50630235</a></li></ul> 
<p>（1）安装CH340驱动</p> 
<p>下载CH340驱动，安装之后。<br> 右击 我的电脑-&gt;管理-&gt;设备管理器-&gt;端口（COM和LPT） 可以看到ch340驱动以及串口号。</p> 
<p>（2）获取固件</p> 
<p>有三种方式可以得到固件：</p> 
<ol><li> <p>NodeMCU提供了在线云编译，选择好需要的模块，填写邮箱地址，很快会发到邮箱中。参考：<a href="https://nodemcu-build.com/" rel="nofollow">https://nodemcu-build.com/</a>（推荐）</p> </li><li> <p>下载别人编译好的固件包。</p> </li><li> <p>自行编译，得到固件包。</p> </li></ol> 
<p>（3）固件烧录</p> 
<p>设置好串口号<br> 点击Config-&gt;点击小齿轮按钮，设置好得到的固件路径<br> 点击Flash<br><img alt="这里写图片描述" src="https://images2.imgbox.com/5a/88/G4DJZgbd_o.png"><br><img alt="这里写图片描述" src="https://images2.imgbox.com/30/a7/pbYM1El6_o.png"></p> 
<p><img alt="这里写图片描述" src="https://images2.imgbox.com/3b/3c/kLZE3ma1_o.png"></p> 
<p>（4）开始使用</p> 
<ol><li> <p>打开ESPlorer.jar，会看到如下界面：<br><img alt="这里写图片描述" src="https://images2.imgbox.com/38/f4/6c5KRT7p_o.png"><br> 注：ESPlorer需要安装JDK环境</p> </li><li> <p>点击刷新按钮，选择串口号，点击open，会显示正在连接。如果好长时间连接不上，可以按一下NodeMCU上的reset按钮。会显示出固件信息，点击Chip ID，会返回ID信息，说明交互正常。</p> </li><li> <p>右边区域是交互页面,会显示交互信息<br> 左下有一行输入框，可以输入需要执行的命令，也可以在下拉菜单中选择，点击send发送。<br> 命令参考：<br><a href="https://github.com/nodemcu/nodemcu-firmware/wiki/nodemcu_api_cn">https://github.com/nodemcu/nodemcu-firmware/wiki/nodemcu_api_cn</a><br> 如：</p> <pre><code>&gt;print（“Hello，NodeMCU”）  
&gt;Hello,NodeMCU  
</code></pre> 
  <ul><li>1</li><li>2</li></ul></li></ol> 
<p><img alt="这里写图片描述" src="https://images2.imgbox.com/87/b6/xqGqeVcu_o.png"><br> 4. 左边区域是lua脚本编写区域。</p> 
<p>编写好lua脚本，点击Send to ESP，可以看到右边区域开始上传代码，结束之后。代码开始执行，右边区域显示交互信息。<br> 点击 Upload ，将代码上传到NodeMCU， 命令行输入dofile(“filename.lua”),开始执行filename.lua。<br> 注：如果在Send 或者 Upload 失败，可以按reset之后，多次尝试。<br><img alt="这里写图片描述" src="https://images2.imgbox.com/5c/78/jbjSq0QB_o.png"><br> 注：Save to ESP、Send to ESP、Run、Upload四种有些区别，可以自己去发现，本人没有深究。</p> 
<hr> 
<h4 id="vmare下ubuntu环境开发"><a name="t5"></a>Vmare下Ubuntu环境开发</h4> 
<p>注： 本人使用的版本</p> 
<ul><li>VMware workstations 12 pro</li><li>Ubuntu 14.0 Desktop</li></ul> 
<p>需要用到的工具：</p> 
<ul><li>minicom – 串口调试工具</li><li>luatool – 上传lua代码</li><li>esptool – 烧录esp固件</li><li>lua开发环境，用于lua学习（非必须） 注：学习教程：<a href="http://www.runoob.com/lua/lua-environment.html" rel="nofollow">http://www.runoob.com/lua/lua-environment.html</a></li></ul> 
<h4 id="1下载安装ch340驱动"><a name="t6"></a>（1）下载安装ch340驱动</h4> 
<p>需要主机安装驱动，然后VMware中点击 虚拟机-&gt;可移动设备 可以看到ch340设备，点击连接。</p> 
<pre><code>dmesg  命令查看已经安装的ch340驱动  
ls -l /dev/ttyUSB0   查看驱动安装的时间等  
</code></pre> 
<h4 id="2安装minicom"><a name="t7"></a>（2）安装minicom</h4> 
<p>minicom为linux下串口通信工具，用做NodeMcu调试</p> 
<pre><code>$ sudo apt-get install minicom    -- 下载安装minicom  
$ sudo minicom -D /dev/ttyUSB0    -- 使用-D可以指定串口设备  
</code></pre> 
<p>进入minicom之后，可以通过crtl-A进入设置模式，然后按 A - Z 键进入不同的设置界面。<br> 常用的按键：<br> Q ：退出minicom<br> L ：保存串口日志<br> Z ：获得帮助<br> P ：设置串口</p> 
<h4 id="3-下载并烧录esp固件"><a name="t8"></a>（3） 下载并烧录esp固件</h4> 
<p>NodeMCU提供了在线云编译，选择好需要的模块，填写邮箱，很快会发到邮箱中，链接：<a href="https://nodemcu-build.com/" rel="nofollow">https://nodemcu-build.com/</a><br> 也可以自己进行编译，在<a href="https://github.com/nodemcu/nodemcu-firmware/releases/">https://github.com/nodemcu/nodemcu-firmware/releases/</a>下载源代码。<br> 也可以使用</p> 
<pre><code>$ wget -c https://github.com/nodemcu/nodemcu-firmware/``releases/download/0.9.6-dev_20150704/nodemcu_float_0.9.6-dev_20150704.bin  
</code></pre> 
<p>下载别人编译好的固件<br> 接着咱们把烧录工具 esptool.py 下载下来。同时安装其他必要工具。</p> 
<pre><code>$ sudo apt-get install git python python-serial python-setuptools  
$ git clone https://github.com/themadinventor/esptool.git  
$ cd esptool  
$ python setup.py install  
</code></pre> 
<p>接着通过 esptool.py 烧录固件：</p> 
<pre><code>$ sudo esptool.py --port /dev/ttyUSB0 write_flash -fm dio -fs 32m -ff 40m 0x00000 nodemcu_float_0.9.6-dev_20150704.bin  
</code></pre> 
<p>烧录完以后按下 RST 重启进入新固件。<br> sptool.py 烧写时默认的通信波特率为 115200，为了加速烧写速度，可以通过 –baud 921600 设置为 921600。<br> 开机之后可以通过<br> file.format() 格式化文件系统</p> 
<h4 id="4-下载并安装luatool"><a name="t9"></a>（4） 下载并安装luatool</h4> 
<p>测试过两个工具都可以用来上传 Lua 程序，分别是：<br> luatool.py：可用于命令行传送 Lua 脚本，无须复杂的图形化工具支持，同时支持通过串口和 Telnet 上传<br> nodemcu.py：除了不支持通过 Telnet 上传外，基本功能同 luatool，只是操作方式稍有差异<br> 下载上述工具：</p> 
<pre><code>$ git clone https://github.com/4refr0nt/luatool.git  
$ git clone https://github.com/md5crypt/nodemcu.py.git  
</code></pre> 
<p>两个都可以进行文件传输，第二个还可以作为串口终端，两个都依赖 pySerial，第二个还需要安装 clipboard：</p> 
<pre><code>$ easy_install clipboard    
</code></pre> 
<h4 id="5开始使用"><a name="t10"></a>（5）开始使用</h4> 
<pre><code>$ minicom -D /dev/ttyUSB0  --进入串口助手  
  file.format()    --格式化文件系统  
  print（“Hello，NodeMCU”） --打印字符串   
  gpio.mode(0, gpio.OUTPUT)  --设置0脚为输出模式  
  gpio.write(0, gpio.LOW)    --0脚置低  
  gpio.write(0, gpio.HIGH)   --0脚置高  
  node.restart()  --重启NodeMCU  
</code></pre> 
<p>以上是通过串口操作执行每条命令，可以通过luatool批量上传，将脚本提前写好进行批量上传。<br> 在上传前，写好一个lua脚本</p> 
<pre><code>$ vi test.lua    
  print('Hello, NodeMCU 1.0')  
  gpio.mode(4, gpio.OUTPUT)  
  gpio.write(4, gpio.LOW)  
</code></pre> 
<p>通过luatool上传</p> 
<pre><code>$ cd /luatool
$ sudo ./luatool.py -p /dev/ttyUSB0 -b 9600 -f test.lua -r  
</code></pre> 
<p>上传完成之后，</p> 
<pre><code>$sudo minicom -D  /dev/ttyUSB0  --进入minicom  
dofile("test.lua")  --执行test脚本   
</code></pre> 
<p>-p 指定上传设备<br> -b 设置波特率<br> -f 指定脚本路径<br> -r 上传完重启<br> -h 获得帮助</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/37ede18b98aa95d4f9c943e515690615/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python绘制热力图</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4c9af7b99fc8795934adfec7d74ee92c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">stm32不同io口组合新的端口_STM32学习之旅~~~~~~~~~蜂鸣器实例</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>