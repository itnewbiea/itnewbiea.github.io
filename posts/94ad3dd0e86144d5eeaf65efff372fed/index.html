<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>2812的C语言中的.reset段的含义以及其在存储器中的定位 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="2812的C语言中的.reset段的含义以及其在存储器中的定位" />
<meta property="og:description" content="问题如下：
疑问一：仿真调试下载程序或把程序已烧写至FLASH后脱机上电运行程序时，程序是不是必须要执行“从0X3F FFC0处复位→执行0X3F FC00地址处的初始化引导函数(Initboot) →根据GPIO选择引导模式→确定用户程序入口地址→从入口处开始执行用户程序”这一系列过程吗？对于用C语言编程时，通常在复位地址向量处（对于F240而言，复位地址在0X0000地址处？），常需要放置指令：“B _c_int0”来规定初始化入口地址，意即C语言函数“_c_int0”完成的功能就是初始化引导函数(Initboot)的功能吗？但对F2812来说，复位向量地址为0X3F FFC0，处于ROM区，是一次性编程ROM，怎么把_c_int0这个入口地址放在0X3F FFC0处呢？
疑问二：由于引导模式由GPIO引脚状态决定，那对于一个已经设计好的DSP最小系统，引脚状态在硬件上已经固定好了，意即是不是此时只能局限于一种引导模式了？不能同时进行仿真调试和烧写至FLASH内进行硬件调试吗？(因为仿真调试时，用户程序入口地址一般在SARAMH0处，烧写至FLASH内进行允许时，用户程序入口地址在FLASH处。)
解答如下：
1：上电运行时根据MP/MC引脚的状态决定是从片外的3fffc0处读取复位向量或者时从片内的rom的3fffc0处读取复位向量。MC方式下从片内读取，MP方式下从片外读取。
2：一般我们用的是MC方式，即从片内读取复位向量，在片内的rom 3fffc0处有一个地址为3ffc00。
3：复位后处理器从3fffc0处读取3ffc00这个地址，所以程序从3ffc00处开始执行
4：3ffc00处开始的就是initboot过程吧，根据IO管教的状态判断该进入那一种引导方式
5：在SCITXA{即GPIOF4脚}引脚为高电平时就是flash boot方式，此时置PC=3F7FF6
6：在片内flash的3F7FF6和3F7FF7处有一个跳转指令，该跳转指令就是LB _c_int00
7：执行这个跳转指令后程序就开始运行c_int00这个函数了
8：这个函数就是建立一个c程序的运行环境，等建立完c运行环境后c_int00调用main函数
9：main函数开始就是我们自己编写的应用程序了。
以上是2812上电（复位）后运行过程的描述
如果你选择了MP方式，那么3fffc0处的复位向量可以自己设置，因为此时处理器从片外的ZONE7区的ram中读取复位向量的，当然初始化引导过程也可以自己编写。
lhfnjj 2005-12-6 14:29
在第5步中，为选择片内FLASH，则使SCITXA为高电平。如果SCITXA还用作串口通讯，那怎么办？
haomaru 2005-12-7 08:13
SCITXA引脚有内部上拉，所以只要没有强制下拉的话，DSP检测的都是高电平。
对于通讯不影响。
SCITXA不用在外部上拉。不能直接接到高电平上。
我自己理解的是，即 ： .reset段表示跳转到_c_int00处的一个程序段 首先： .reset段区别于处于复位向量3fffc0（即复位指针，即DSP复位时PC所装的地址，在这个地址中存放了初始化BOOT的程序地址3ffc00，其事先已固化在bootrom的程序）
即系统复位以后首先跳转到复位向量3fffc0处，然后从此处跳转到初始化intboot （3ffc00）处，执行完初始化BOOT.并根据GPIOF口选择启动模式，例如选择从FLASH启动，则退出初始化BOOT程序时，程序则会跳到0x3F7FF6处执行，此处距0x3F7FF8（密码设置区）只有两个字的距离，故在此也就只能放一个跳转指令，即跳转到C语言程序入口，即_c_int00处，个人认为当CMD文件将.reset段配置到0x3F7FF6时，起到的作用就是：即在0x3F7FF6处使程序跳转到_c_int00处。
MEMORY
{
PAGE 0 : 。。。
BEGIN : origin = 0x3F7FF6, length = 0x000002 。。。 PAGE 1 : 。。。 } SECTIONS
{
.reset : &gt; BEGIN PAGE = 0 }" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/94ad3dd0e86144d5eeaf65efff372fed/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-02-03T00:11:35+08:00" />
<meta property="article:modified_time" content="2012-02-03T00:11:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2812的C语言中的.reset段的含义以及其在存储器中的定位</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> 问题如下：</p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> <span style="color:rgb(51,51,51)">疑问一：仿真调试下载程序或把程序已烧写至FLASH后脱机上电运行程序时，程序是不是必须要执行“从0X3F FFC0处复位→执行0X3F FC00地址处的初始化引导函数(Initboot) →根据GPIO选择引导模式→确定用户程序入口地址→从入口处开始执行用户程序”这一系列过程吗？对于用C语言编程时，通常在复位地址向量处（对于F240而言，复位地址在0X0000地址处？），常需要放置指令：“B  _c_int0”来规定初始化入口地址，意即C语言函数“_c_int0”完成的功能就是初始化引导函数(Initboot)的功能吗？但对F2812来说，复位向量地址为0X3F FFC0，处于ROM区，是一次性编程ROM，怎么把_c_int0这个入口地址放在0X3F FFC0处呢？<br> 疑问二：</span><strong><span style="color:#cc0000">由于引导模式由GPIO引脚状态决定，那对于一个已经设计好的DSP最小系统，引脚状态在硬件上已经固定好了，意即是不是此时只能局限于一种引导模式了？不能同时进行仿真调试和烧写至FLASH内进行硬件调试吗？</span><span style="color:#00cccc">(因为仿真调试时，用户程序入口地址一般在SARAMH0处，烧写至FLASH内进行允许时，用户程序入口地址在FLASH处。)</span></strong></p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> 解答如下：</p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> 1：上电运行时根据MP/MC引脚的状态决定是从片外的3fffc0处读取复位向量或者时从片内的rom的3fffc0处读取复位向量。MC方式下从片内读取，MP方式下从片外读取。<br> 2：一般我们用的是MC方式，即从片内读取复位向量，在片内的rom 3fffc0处有一个地址为3ffc00。<br> 3：复位后处理器从3fffc0处读取3ffc00这个地址，所以程序从3ffc00处开始执行<br> 4：3ffc00处开始的就是initboot过程吧，根据IO管教的状态判断该进入那一种引导方式<br> 5：在SCITXA{即GPIOF4脚}引脚为高电平时就是flash boot方式，此时置PC=3F7FF6<br> 6：在片内flash的3F7FF6和3F7FF7处有一个跳转指令，该跳转指令就是LB _c_int00<br> 7：执行这个跳转指令后程序就开始运行c_int00这个函数了<br> 8：这个函数就是建立一个c程序的运行环境，等建立完c运行环境后c_int00调用main函数<br> 9：main函数开始就是我们自己编写的应用程序了。<br> <br> 以上是2812上电（复位）后运行过程的描述<br> <br> 如果你选择了MP方式，那么3fffc0处的复位向量可以自己设置，因为此时处理器从片外的ZONE7区的ram中读取复位向量的，当然初始化引导过程也可以自己编写。</p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> <strong><span style="color:rgb(0,255,255)"><cite style="font-style:inherit; font-weight:inherit">lhfnjj</cite> 2005-12-6 14:29</span></strong></p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> 在第5步中，为选择片内FLASH，则使SCITXA为高电平。如果SCITXA还用作串口通讯，那怎么办？</p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> </p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> <strong><span style="color:rgb(255,0,0)"><cite style="font-style:inherit; font-weight:inherit">haomaru</cite> 2005-12-7 08:13</span></strong></p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> SCITXA引脚有内部上拉，所以只要没有强制下拉的话，DSP检测的都是高电平。<br> 对于通讯不影响。</p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> SCITXA不用在外部上拉。不能直接接到高电平上。<br> <br> <br> </p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> </p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px">  </p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> <strong><span style="color:rgb(255,0,0)">我自己理解的是，<span style="font-size:18pt; color:rgb(0,0,255)">即 ： </span></span><span style="font-size:18pt; color:rgb(0,0,255)">.reset段表示跳转到_c_int00处的一个程序段</span> <br> <span style="color:rgb(255,0,0)">首先：    .reset段区别于处于复位向量3fffc0（即复位指针，即DSP复位时PC所装的地址，在这个地址中存放了初始化BOOT的程序地址3ffc00，其事先已固化在bootrom的程序）</span></strong></p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> <strong><span style="color:rgb(255,0,0)">即系统复位以后首先跳转到复位向量3fffc0处，然后从此处跳转到初始化intboot （3ffc00）处，执行完初始化BOOT.并根据GPIOF口选择启动模式，例如选择从FLASH启动，则退出初始化BOOT程序时，程序则会跳到0x3F7FF6处执行，此处距0x3F7FF8（密码设置区）只有两个字的距离，故在此也就只能放一个跳转指令，即跳转到C语言程序入口，即_c_int00处，个人认为当CMD文件将.reset段配置到0x3F7FF6时，起到的作用就是：即在0x3F7FF6处使程序跳转到_c_int00处。</span></strong></p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> MEMORY<br> {<!-- --><br> PAGE 0 : </p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px">       。。。<br>       <strong><span style="color:rgb(255,0,0)">BEGIN       : origin = 0x3F7FF6, length = 0x000002    </span></strong></p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px">      。。。     <br> PAGE 1 : <br>     。。。 </p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> } <br> SECTIONS<br> {<!-- --><br>     <strong><span style="color:rgb(255,0,0)"> .reset              : &gt; BEGIN       PAGE = 0</span></strong> <br>   }</p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px">  </p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> 同理当仿真模式时，初始化BOOT时完成时，程序会跳到H0RAM起始地址0x3F8000处，则此时按如下方式配置CMD文件：<strong><span style="color:rgb(255,0,0)">即把跳转到_c_int00处的程序段.reset配置到0x3F8000</span></strong>。</p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> MEMORY<br> {<!-- --><br> PAGE 0 : <br>    <strong><span style="color:rgb(255,0,0)">PRAMH0     : origin = 0x3f8000, length = 0x001000      </span></strong></p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> 。。。</p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> }</p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> SECTIONS<br> {<!-- --><br>    /* Allocate program areas: */<br>    <strong><span style="color:rgb(255,0,0)">.reset           : &gt; PRAMH0,      PAGE = 0</span></strong></p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px">      。。。</p> 
<p style="margin-top:0px; margin-bottom:0.8em; padding-top:0px; padding-bottom:0px; line-height:1.4em; color:rgb(51,51,51); font-family:Tahoma,Verdana,STHeiTi,simsun,sans-serif; font-size:14px"> }</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6d4b7d47e91693d24083d23c48f663c1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Ext.core包与Ext详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ab9cb092f7f37fda0dd40fb79c081523/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">算法的博客</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>