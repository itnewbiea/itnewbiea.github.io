<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>数据解析 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="数据解析" />
<meta property="og:description" content="文章目录 数据解析分类数据解析原理正则匹配爬取糗事百科图片 bs4环境安装对象的实例化数据解析的方法和属性爬取三国演义所有标题和内容 xpath环境安装对象的实例化xpath表达式爬取58同城北京二手房名称爬取4k网站图片爬取全国城市名 数据解析分类 正则bs4xpath（***） 数据解析原理 解析的局部文本内容都会在标签之间或者标签对应属性中进行存储进行指定标签定位标签或标签对应属性中存储的数据值进行提取 正则匹配 先学习正则表达式
import re // \w 匹配数字、字母、下划线 print(re.findall(&#39;\w&#39;,&#39;abc123_*()-=&#39;)) # findall是从左到右匹配字符串 // [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;_&#39;] // \W 匹配非数字字母下划线 print(re.findall(&#39;\W&#39;,&#39;aAbc123_*()-=&#39;)) //[&#39;*&#39;, &#39;(&#39;, &#39;)&#39;, &#39;-&#39;, &#39;=&#39;] // \s 匹配任意空白字符，等价于\t\n\r\f print(re.findall(&#39;\s&#39;,&#39;aAb\tc\r123_*()-= &#39;)) //[&#39;\t&#39;, &#39;\r&#39;, &#39; &#39;] // \S 匹配任意非空字符 print(re.findall(&#39;\S&#39;,&#39;aAb\tc\r123_*()-= &#39;)) //[&#39;a&#39;, &#39;A&#39;, &#39;b&#39;, &#39;c&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;_&#39;, &#39;*&#39;, &#39;(&#39;, &#39;)&#39;, &#39;-&#39;, &#39;=&#39;] // \d 匹配任意数字，等价于[0-9] print(re.findall(&#39;\d&#39;,&#39;aAb\tc\r123_*()-= &#39;)) //[&#39;1&#39;, &#39;2&#39;, &#39;3&#39;] // \D 匹配任意非数字 print(re." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c71a9cc03e4ee9e077e456c27d609870/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-27T14:39:58+08:00" />
<meta property="article:modified_time" content="2021-02-27T14:39:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">数据解析</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">数据解析分类</a></li><li><a href="#_7" rel="nofollow">数据解析原理</a></li><li><a href="#_13" rel="nofollow">正则匹配</a></li><li><ul><li><a href="#_91" rel="nofollow">爬取糗事百科图片</a></li></ul> 
   </li><li><a href="#bs4_221" rel="nofollow">bs4</a></li><li><ul><li><a href="#_227" rel="nofollow">环境安装</a></li><li><a href="#_233" rel="nofollow">对象的实例化</a></li><li><a href="#_252" rel="nofollow">数据解析的方法和属性</a></li><li><a href="#_272" rel="nofollow">爬取三国演义所有标题和内容</a></li></ul> 
   </li><li><a href="#xpath_307" rel="nofollow">xpath</a></li><li><ul><li><a href="#_314" rel="nofollow">环境安装</a></li><li><a href="#_319" rel="nofollow">对象的实例化</a></li><li><a href="#xpath_331" rel="nofollow">xpath表达式</a></li><li><a href="#58_359" rel="nofollow">爬取58同城北京二手房名称</a></li><li><a href="#4k_422" rel="nofollow">爬取4k网站图片</a></li><li><a href="#_509" rel="nofollow">爬取全国城市名</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>数据解析分类</h3> 
<ul><li>正则</li><li>bs4</li><li>xpath（***）</li></ul> 
<h3><a id="_7"></a>数据解析原理</h3> 
<ul><li>解析的局部文本内容都会在标签之间或者标签对应属性中进行存储</li><li>进行指定标签定位</li><li>标签或标签对应属性中存储的数据值进行提取</li></ul> 
<h3><a id="_13"></a>正则匹配</h3> 
<p>先学习正则表达式</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> re

<span class="token operator">//</span> \w  匹配数字、字母、下划线
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'\w'</span><span class="token punctuation">,</span><span class="token string">'abc123_*()-='</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># findall是从左到右匹配字符串</span>
<span class="token operator">//</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">]</span>

<span class="token operator">//</span> \W 匹配非数字字母下划线
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'\W'</span><span class="token punctuation">,</span><span class="token string">'aAbc123_*()-='</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span><span class="token punctuation">[</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">,</span> <span class="token string">'='</span><span class="token punctuation">]</span>

<span class="token operator">//</span> \s 匹配任意空白字符，等价于\t\n\r\f
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'\s'</span><span class="token punctuation">,</span><span class="token string">'aAb\tc\r123_*()-= '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span><span class="token punctuation">[</span><span class="token string">'\t'</span><span class="token punctuation">,</span> <span class="token string">'\r'</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">]</span>

<span class="token operator">//</span> \S 匹配任意非空字符
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'\S'</span><span class="token punctuation">,</span><span class="token string">'aAb\tc\r123_*()-= '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">,</span> <span class="token string">'='</span><span class="token punctuation">]</span>

<span class="token operator">//</span> \d 匹配任意数字，等价于<span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'\d'</span><span class="token punctuation">,</span><span class="token string">'aAb\tc\r123_*()-= '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span><span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">]</span>

<span class="token operator">//</span> \D 匹配任意非数字
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'\D'</span><span class="token punctuation">,</span><span class="token string">'aAb\tc\r123_*()-= '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'\t'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'\r'</span><span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">,</span> <span class="token string">'='</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">]</span>

<span class="token operator">//</span> \A 只匹配字符串的开头
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'\Ashyshy'</span><span class="token punctuation">,</span><span class="token string">'shyshyis is 20'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span><span class="token punctuation">[</span><span class="token string">'shyshy'</span><span class="token punctuation">]</span>

<span class="token operator">//</span> \Z 只匹配字符串的结尾
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'20\Z'</span><span class="token punctuation">,</span><span class="token string">'shyshyis is 20'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span><span class="token punctuation">[</span><span class="token string">'20'</span><span class="token punctuation">]</span>

<span class="token operator">//</span> <span class="token operator">^</span> 匹配字符串的开头
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'^shyshy'</span><span class="token punctuation">,</span><span class="token string">'shyshyis is 20'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span><span class="token punctuation">[</span><span class="token string">'shyshy'</span><span class="token punctuation">]</span>

<span class="token operator">//</span> $ 匹配字符串的结尾
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'20$'</span><span class="token punctuation">,</span><span class="token string">'shyshyis is 20'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span><span class="token punctuation">[</span><span class="token string">'20'</span><span class="token punctuation">]</span>

<span class="token operator">//</span> <span class="token punctuation">.</span> 匹配除\n外的任意字符，指定re<span class="token punctuation">.</span>DOTALL才能匹配换行符
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'a.b'</span><span class="token punctuation">,</span><span class="token string">'a b ab acb a\nb acccb'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span><span class="token punctuation">[</span><span class="token string">'a b'</span><span class="token punctuation">,</span> <span class="token string">'acb'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'a.b'</span><span class="token punctuation">,</span><span class="token string">'a b ab acb a\nb acccb'</span><span class="token punctuation">,</span>re<span class="token punctuation">.</span>DOTALL<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span><span class="token punctuation">[</span><span class="token string">'a b'</span><span class="token punctuation">,</span> <span class="token string">'acb'</span><span class="token punctuation">,</span> <span class="token string">'a\nb'</span><span class="token punctuation">]</span>

<span class="token operator">//</span> <span class="token operator">*</span> 左侧字符重复<span class="token number">0</span>次或无数次
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'ab*'</span><span class="token punctuation">,</span><span class="token string">'ab abb abbbbbbb ab aa'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span> <span class="token punctuation">[</span><span class="token string">'ab'</span><span class="token punctuation">,</span> <span class="token string">'abb'</span><span class="token punctuation">,</span> <span class="token string">'abbbbbbb'</span><span class="token punctuation">,</span> <span class="token string">'ab'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">]</span>

<span class="token operator">//</span> <span class="token operator">+</span> 左侧字符重复<span class="token number">1</span>次或无数次
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'ab+'</span><span class="token punctuation">,</span><span class="token string">'ab abb abbbbbbb ab aa bbbbbbbbb'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span> <span class="token punctuation">[</span><span class="token string">'ab'</span><span class="token punctuation">,</span> <span class="token string">'abb'</span><span class="token punctuation">,</span> <span class="token string">'abbbbbbb'</span><span class="token punctuation">,</span> <span class="token string">'ab'</span><span class="token punctuation">]</span>

<span class="token operator">//</span> ? 匹配左侧字符<span class="token number">0</span>次或<span class="token number">1</span>次
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'ab?'</span><span class="token punctuation">,</span><span class="token string">'ab abb abbbbbbb ab aa bbbbbbbbb'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span> <span class="token punctuation">[</span><span class="token string">'ab'</span><span class="token punctuation">,</span> <span class="token string">'ab'</span><span class="token punctuation">,</span> <span class="token string">'ab'</span><span class="token punctuation">,</span> <span class="token string">'ab'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">]</span>

<span class="token operator">//</span> <span class="token punctuation">{<!-- --></span>m<span class="token punctuation">,</span>n<span class="token punctuation">}</span> 匹配左侧字符m到n次，<span class="token punctuation">{<!-- --></span>n<span class="token punctuation">}</span> 代表只出现n次
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'ab{2,5}'</span><span class="token punctuation">,</span><span class="token string">'ab abb abbbbbbb ab aa bbbbbbbbb'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span> <span class="token punctuation">[</span><span class="token string">'abb'</span><span class="token punctuation">,</span> <span class="token string">'abbbbb'</span><span class="token punctuation">]</span>

<span class="token operator">//</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> 匹配字符<span class="token number">1</span>次
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'a[0-9]b'</span><span class="token punctuation">,</span><span class="token string">'a1b a22b acb'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span> <span class="token punctuation">[</span><span class="token string">'a1b'</span><span class="token punctuation">]</span>

<span class="token operator">//</span> <span class="token punctuation">[</span><span class="token operator">^</span><span class="token punctuation">]</span> 对匹配的内容取反
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'a[^0-9]b'</span><span class="token punctuation">,</span><span class="token string">'a1b a22b acb'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">//</span> <span class="token punctuation">[</span><span class="token string">'acb'</span><span class="token punctuation">]</span>

<span class="token operator">//</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> 是为了提取匹配字符串的，表达式中有几个<span class="token punctuation">(</span><span class="token punctuation">)</span>就有几个相应的匹配字符串
</code></pre> 
<h4><a id="_91"></a>爬取糗事百科图片</h4> 
<p>首先是爬取单个图片</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> <span class="token string">'https://pic.qiushibaike.com/system/pictures/12401/124017243/medium/CAN7KLR2PPDXJ932.jpg'</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span><span class="token string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.75 Safari/537.36'</span>
    <span class="token punctuation">}</span>
    <span class="token comment"># content返回文件的二进制数据</span>
    <span class="token comment"># text (字符串) content (二进制数据) json(对象)</span>
    img_data <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>content
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./1.jpg'</span><span class="token punctuation">,</span><span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>
        fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>img_data<span class="token punctuation">)</span>
</code></pre> 
<p>注意url是图片的地址，和之前的爬取文本不同，这里因为爬取的是图片，所有获取数据时不说<code>text</code>，而是能返回文件二进制数据的<code>content</code>，在写入时，注意是<code>wb</code>而并非<code>w</code>，下面是他们的区别：</p> 
<blockquote> 
 <p>w 打开一个文件只用于写入。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。<br> wb 以二进制格式打开一个文件只用于写入。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。</p> 
</blockquote> 
<p>接下来是爬取这一页的所有图片，首先，可以在源码中看到图片的地址，主要是被以下标签包裹</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>thumb<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/article/124104208<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>//pic.qiushibaike.com/system/pictures/12410/124104208/medium/JIIR7Y6T2PDU8P0V.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>糗事#124104208<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>illustration<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>auto<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>想要得到中间的地址，需要用正则匹配</p> 
<pre><code class="prism language-python">ex <span class="token operator">=</span> <span class="token string">'&lt;div class="thumb"&gt;.*?&lt;img src="(.*?)" alt.*?&lt;/div&gt;'</span>
</code></pre> 
<p>这里面，<code>.*?</code>表示非贪婪匹配，满足条件的情况只匹配一次，<code>()</code>用于提取匹配字符串的。</p> 
<p>匹配完了后，因为这个网址中没有协议头，需要拼接一个<code>https:</code>上去，这个可以用列表遍历来实现；因为图片数量比较多，可以用os模块去执行系统命令<code>os.mkdir('./qiutupic')</code>，创建一个目录，然后将图片保存到里面。</p> 
<p>最后，还剩下图片名的问题，可以看到，html标签中是有图片名的，我们可以用字符串切割，来得到图片名，这里可以用<code>split()</code>函数来实现。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> re
<span class="token keyword">import</span> os

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">'./qiutupic'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">'./qiutupic'</span><span class="token punctuation">)</span>
    url <span class="token operator">=</span> <span class="token string">'https://www.qiushibaike.com/imgrank/'</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.75 Safari/537.36'</span>
    <span class="token punctuation">}</span>
    <span class="token comment"># 使用通用爬虫对url对应的一整张页面爬取</span>
    page_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>text
    <span class="token comment"># 使用聚焦爬虫对页面中所有糗图进行提取</span>
    <span class="token triple-quoted-string string">"""
    &lt;div class="thumb"&gt;
    &lt;a href="/article/124104208" target="_blank"&gt;
    &lt;img src="//pic.qiushibaike.com/system/pictures/12410/124104208/medium/JIIR7Y6T2PDU8P0V.jpg" alt="糗事#124104208" class="illustration" width="100%" height="auto"&gt;
    &lt;/a&gt;
    &lt;/div&gt;
    """</span>
    ex <span class="token operator">=</span> <span class="token string">'&lt;div class="thumb"&gt;.*?&lt;img src="(.*?)" alt.*?&lt;/div&gt;'</span>
    img_src_list <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>ex<span class="token punctuation">,</span> page_text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>img_src_list<span class="token punctuation">)</span>
    <span class="token keyword">for</span> src <span class="token keyword">in</span> img_src_list<span class="token punctuation">:</span>
        <span class="token comment"># 拼接出一个完整的url</span>
        src <span class="token operator">=</span> <span class="token string">'https:'</span> <span class="token operator">+</span> src
        img_data <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>src<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>content
        <span class="token comment"># 生成图片名称</span>
        img_name <span class="token operator">=</span> src<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">//</span>将url以<span class="token operator">/</span>切割开后，查找倒数第一个（<span class="token operator">-</span><span class="token number">1</span>）
        <span class="token comment"># 拼接图片路径</span>
        imgpath <span class="token operator">=</span> <span class="token string">'./qiutupic/'</span> <span class="token operator">+</span> img_name
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>imgpath<span class="token punctuation">,</span><span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>
            fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>img_data<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>img_name <span class="token operator">+</span> <span class="token string">'success'</span><span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>str.split(str="", num=string.count(str)).<br> str – 分隔符，默认为所有的空字符，包括空格、换行(\n)、制表符(\t)等。<br> num – 分割次数。默认为 -1, 即分隔所有。</p> 
</blockquote> 
<p>最后，实现对每个分页的爬取，</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> re
<span class="token keyword">import</span> os

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.75 Safari/537.36'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">'./wholeqiutupic'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">'./wholeqiutupic'</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置通用url模板</span>
    url <span class="token operator">=</span> <span class="token string">'https://www.qiushibaike.com/imgrank/page/%d'</span>
    <span class="token keyword">for</span> pagenum <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 对应页码的url</span>
        new_url <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span>url<span class="token operator">%</span>pagenum<span class="token punctuation">)</span>

        <span class="token comment"># 使用通用爬虫对url对应的一整张页面爬取</span>
        page_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>new_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>text
        <span class="token comment"># 使用聚焦爬虫对页面中所有糗图进行提取</span>
        <span class="token triple-quoted-string string">"""
        &lt;div class="thumb"&gt;
        &lt;a href="/article/124104208" target="_blank"&gt;
        &lt;img src="//pic.qiushibaike.com/system/pictures/12410/124104208/medium/JIIR7Y6T2PDU8P0V.jpg" alt="糗事#124104208" class="illustration" width="100%" height="auto"&gt;
        &lt;/a&gt;
        &lt;/div&gt;
        """</span>
        ex <span class="token operator">=</span> <span class="token string">'&lt;div class="thumb"&gt;.*?&lt;img src="(.*?)" alt.*?&lt;/div&gt;'</span>
        img_src_list <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>ex<span class="token punctuation">,</span> page_text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>img_src_list<span class="token punctuation">)</span>
        <span class="token keyword">for</span> src <span class="token keyword">in</span> img_src_list<span class="token punctuation">:</span>
            <span class="token comment"># 拼接出一个完整的url</span>
            src <span class="token operator">=</span> <span class="token string">'https:'</span> <span class="token operator">+</span> src
            img_data <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>src<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>content
            <span class="token comment"># 生成图片名称</span>
            img_name <span class="token operator">=</span> src<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            <span class="token comment"># 拼接图片路径</span>
            imgpath <span class="token operator">=</span> <span class="token string">'./wholeqiutupic/'</span> <span class="token operator">+</span> img_name
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>imgpath<span class="token punctuation">,</span><span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>
                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>img_data<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>img_name <span class="token operator">+</span> <span class="token string">'success'</span><span class="token punctuation">)</span>
</code></pre> 
<p>因为每次换页，不同的是url中最后的数字，所以可以采用for循环的方式，依次遍历，并格式化字符串，将页数填充到url中，这样就可以实现对不同页数的爬取。</p> 
<h3><a id="bs4_221"></a>bs4</h3> 
<p>bs4数据解析的原理：</p> 
<ol><li>实例化一个BeautifulSoup对象，并将页面源码数据加载到该对象中</li><li>通过调用BeautifulSoup对象中相关属性或方法进行标签定位和数据提取</li></ol> 
<h4><a id="_227"></a>环境安装</h4> 
<pre><code class="prism language-bash">pip <span class="token function">install</span> bs4
pip <span class="token function">install</span> lxml
</code></pre> 
<h4><a id="_233"></a>对象的实例化</h4> 
<ul><li>将本地的html文档中的数据加载到该对象中</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># 将本地html文档的数据加载到对象中</span>
    fp <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./baidu.html'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token string">'lxml'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>soup<span class="token punctuation">)</span>
</code></pre> 
<ul><li>将互联网上获取的源码加载到该对象中</li></ul> 
<pre><code class="prism language-python">page_text <span class="token operator">=</span> response<span class="token punctuation">.</span>text
soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>page_text<span class="token punctuation">,</span><span class="token string">'lxml'</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_252"></a>数据解析的方法和属性</h4> 
<ul><li>soup.tagName：返回的是html中第一次出现的tagName标签内容</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>soup<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">"""
输出内容：&lt;a class="toindex" href="/"&gt;百度首页&lt;/a&gt;
"""</span>
</code></pre> 
<ul><li><code>soup.find('tagName')</code>：作用等同于soup.tagName</li><li><code>soup.find('div',class_='s-isindex-wrap')</code>：查找div标签中class为s-isindex-wrap的内容</li><li><code>soup.find_all('tagName')</code>：以列表方式返回符合要求的所有标签</li><li><code>soup.select('某种选择器（id、class、标签选择器）'）</code>：返回的是一个列表</li><li><code>soup.select('.tang &gt; ul &gt;li &gt;a')</code>：<code>&gt;</code>表示的是一个层级</li><li><code>soup.select('.tang &gt; ul a')</code>：空格表示的是多个层级</li><li><code>soup.tagName.text/string/get_text()</code>：获取标签间文本数据，<code>text/get_text()</code>能获取标签中所有的文本内容，<code>string</code>只可以获取该标签下的直系文本内容</li><li><code>soup.a['href']</code>：获取标签中属性值</li></ul> 
<h4><a id="_272"></a>爬取三国演义所有标题和内容</h4> 
<p>想要爬取所有标题和内容，先信息搜集<br> <img src="https://images2.imgbox.com/2c/d3/5TdKpcXx_o.png" alt="在这里插入图片描述"><br> 文章标题是存在这里的，前面a标签里的是标题对应章节的链接，可以用前面的bs4数据解析爬取到。先爬取所有li标签，然后用遍历的方法，得到每个li标签里章节对应的内容。</p> 
<pre><code class="prism language-python"><span class="token comment"># 需求：爬取三国演义所有章节和内容</span>
<span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># 对首页页面数据进行爬取</span>
    url <span class="token operator">=</span> <span class="token string">'https://www.shicimingju.com/book/sanguoyanyi.html'</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) '</span>
                      <span class="token string">'Chrome/86.0.4240.75 Safari/537.36'</span>
    <span class="token punctuation">}</span>
    page_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ISO-8859-1'</span><span class="token punctuation">)</span>
    <span class="token comment"># 在首页中解析出标题和url</span>
    <span class="token comment"># 1.实例化beautifulsoup对象</span>
    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>page_text<span class="token punctuation">,</span> <span class="token string">'lxml'</span><span class="token punctuation">)</span>
    <span class="token comment"># 解析章节标题和详情页url</span>
    li_list <span class="token operator">=</span> soup<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">'.book-mulu &gt; ul &gt; li'</span><span class="token punctuation">)</span>
    fp <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./sanguoyanyi.txt'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>
        title <span class="token operator">=</span> li<span class="token punctuation">.</span>a<span class="token punctuation">.</span>string
        detail_url <span class="token operator">=</span> <span class="token string">'http://www.shicimingju.com'</span> <span class="token operator">+</span> li<span class="token punctuation">.</span>a<span class="token punctuation">[</span><span class="token string">'href'</span><span class="token punctuation">]</span>
        <span class="token comment"># 对详情页发请求，得到文章内容</span>
        detail_page_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>detail_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'ISO-8859-1'</span><span class="token punctuation">)</span>
        <span class="token comment"># 解析出详情页内容</span>
        detail_soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>detail_page_text<span class="token punctuation">,</span> <span class="token string">'lxml'</span><span class="token punctuation">)</span>
        div_tag <span class="token operator">=</span> detail_soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'chapter_content'</span><span class="token punctuation">)</span>
        content <span class="token operator">=</span> div_tag<span class="token punctuation">.</span>text
        fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>title<span class="token operator">+</span><span class="token string">':'</span><span class="token operator">+</span>content<span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span><span class="token string">'爬取成功'</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="xpath_307"></a>xpath</h3> 
<p>最常用且最便捷高效的一种解析方式<br> 原理：</p> 
<ol><li>实例化一个etree对象，且需要将被解析的页面源码数据加载到该对象中</li><li>调用etree对象中的xpath方法结合xpath表达式实现标签的定位和内容的捕获</li></ol> 
<h4><a id="_314"></a>环境安装</h4> 
<pre><code class="prism language-bash">pip <span class="token function">install</span> lxml
</code></pre> 
<h4><a id="_319"></a>对象的实例化</h4> 
<ol><li>将本地的html文档中的源码数据加载到etree对象中</li></ol> 
<pre><code class="prism language-python">etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>filepath<span class="token punctuation">)</span>
</code></pre> 
<ol start="2"><li>将互联网上获取的源码数据加载到etree对象中</li></ol> 
<pre><code class="prism language-python">etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span><span class="token string">'page_text'</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="xpath_331"></a>xpath表达式</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># 1.实例化好一个etree对象，且将被解析的源码加载到该对象中</span>
    parser <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTMLParser<span class="token punctuation">(</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">'./sougou.html'</span><span class="token punctuation">,</span> parser<span class="token operator">=</span>parser<span class="token punctuation">)</span> <span class="token comment"># 注意和视频里的不同，否则会报错</span>
    r <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'/html/head/meta'</span><span class="token punctuation">)</span>
    r <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//script[@type="text/javascript"]'</span><span class="token punctuation">)</span>
    r <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="top-nav"]/ul/li[3]'</span><span class="token punctuation">)</span>
    r <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="top-nav"]/ul/li[3]/a/text()'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">"""
输出结果：
[&lt;Element meta at 0x22136e7e4c0&gt;, &lt;Element meta at 0x22136e7e500&gt;, &lt;Element meta at 0x22136e7e540&gt;, &lt;Element meta at 0x22136e7e580&gt;, &lt;Element meta at 0x22136e7e5c0&gt;]
[&lt;Element script at 0x1f7d478f4c0&gt;]
[&lt;Element li at 0x2211a1af3c0&gt;]
['知乎']
"""</span>
</code></pre> 
<p><code>/</code>表示的是从根节点开始定位，表示的是一个层级。<br> <code>//</code>表示的是多个层级，也可以表示从任意位置开始定位<br> 属性定位：<code>//script[@type="text/javascript"]</code>—&gt;<code>tag[@attrName="attrValue"</code><br> 索引定位：<code>//div[@class="top-nav"]/ul/li[3]</code> 索引从1开始<br> 取文本：<code>/text()</code>获取直系标签中文本内容，<code>//text()</code>获取非直系标签</p> 
<h4><a id="58_359"></a>爬取58同城北京二手房名称</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># 爬取页面数据</span>
    url <span class="token operator">=</span> <span class="token string">'https://bj.58.com/ershoufang/'</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 '</span>
                      <span class="token string">'(KHTML, like Gecko) Chrome/86.0.4240.75 Safari/537.36'</span>
    <span class="token punctuation">}</span>
    page_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>text

    <span class="token comment"># 数据解析</span>
    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page_text<span class="token punctuation">)</span>
    div_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="property-content-title"]'</span><span class="token punctuation">)</span>
    fp <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./ershoufang.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> div <span class="token keyword">in</span> div_list<span class="token punctuation">:</span>
        title <span class="token operator">=</span> div<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./h3/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>title<span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5e/3b/AORbHJ4J_o.png" alt="在这里插入图片描述"><br> 信息搜集发现每个标题都是在这个div标签内的，只需要定位到该<code>div</code>标签，然后定位到<code>h3</code>标签，就能获取里面的文本。</p> 
<p>研（我）究（是）了（个）一（Fe）下（f）午（w），终于想到能把房子名称和价格一一对应的方法，每一步的解释都在代码中的注释里</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># 爬取页面数据</span>
    url <span class="token operator">=</span> <span class="token string">'https://bj.58.com/ershoufang/'</span>
    title_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 用于存储房子名称</span>
    title_price <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">#用于存储房子价格</span>
    flat_information <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span> <span class="token comment">#用于存储上面两列表合并后的数据</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 '</span>
                      <span class="token string">'(KHTML, like Gecko) Chrome/86.0.4240.75 Safari/537.36'</span>
    <span class="token punctuation">}</span>
    page_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>text

    <span class="token comment"># 数据解析</span>
    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page_text<span class="token punctuation">)</span>
    div_name_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="property-content-title"]'</span><span class="token punctuation">)</span>
    div_price_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="property-price"]'</span><span class="token punctuation">)</span>

    fp <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./ershoufang.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token comment"># 创建文本文档，用于保存房子信息</span>
    <span class="token keyword">for</span> div1 <span class="token keyword">in</span> div_name_list<span class="token punctuation">:</span>
        title <span class="token operator">=</span> div1<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./h3/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 定位到房子名称相应的位置</span>
        title_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>title<span class="token punctuation">)</span> <span class="token comment"># 往列表中添加房子名称</span>

    <span class="token keyword">for</span> div2 <span class="token keyword">in</span> div_price_list<span class="token punctuation">:</span>
        price <span class="token operator">=</span> div2<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./p/span[@class="property-price-total-num"]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 定位到房子价格数字相应的位置</span>
        unit <span class="token operator">=</span> div2<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./p/span[@class="property-price-total-text"]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 定位到房子价格单位相应的位置</span>
        title_price<span class="token punctuation">.</span>append<span class="token punctuation">(</span>price <span class="token operator">+</span> unit<span class="token punctuation">)</span> <span class="token comment"># 往列表中添加房子价格</span>
        
    flat_information <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>title_list<span class="token punctuation">,</span> title_price<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#将房子名称和房子价格两个列表合并为一个字典</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> flat_information<span class="token punctuation">:</span>
        fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'%s : %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>k<span class="token punctuation">,</span>flat_information<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span> <span class="token comment">#遍历字典，用格式化字符串将房子名称和价格一一对应输出</span>
</code></pre> 
<h4><a id="4k_422"></a>爬取4k网站图片</h4> 
<p>网站url：<a href="https://pic.netbian.com/4kmeinv/" rel="nofollow">https://pic.netbian.com/4kmeinv/</a><br> 先进行信息搜集，<br> <img src="https://images2.imgbox.com/3c/9a/9jgGi4nC_o.png" alt="在这里插入图片描述"><br> 可以看到，图片的地址和名称都在<code>//div[@class="slist"]/ul/li/a</code>中，而每一个<code>li</code>标签对应着一张图片，那么就可以先将<code>li</code>标签存储在列表中，然后用<code>for</code>循环遍历的方法，逐一访问和爬取。</p> 
<p>直接上代码，解释都在注释中。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> os

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">'./love'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">'./love'</span><span class="token punctuation">)</span>
    url <span class="token operator">=</span> <span class="token string">'https://pic.netbian.com/4kmeinv/'</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 '</span>
                      <span class="token string">'(KHTML, like Gecko) Chrome/86.0.4240.75 Safari/537.36'</span>
    <span class="token punctuation">}</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    <span class="token comment"># 手动设置相应数据的编码方式</span>
    <span class="token comment"># response.encoding = 'gbk'</span>
    page_text <span class="token operator">=</span> response<span class="token punctuation">.</span>text

    <span class="token comment"># 数据解析：src属性值 alt属性值</span>
    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page_text<span class="token punctuation">)</span>
    li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="slist"]/ul/li'</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>
        img_src <span class="token operator">=</span> <span class="token string">'http://pic.netbian.com'</span> <span class="token operator">+</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./a/img/@src'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        img_name <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./a/img/@alt'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'.jpg'</span>
        <span class="token comment"># 处理乱码的常规操作</span>
        img_name <span class="token operator">=</span> img_name<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'iso-8859-1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'gbk'</span><span class="token punctuation">)</span>
        <span class="token comment"># print(img_name,img_src)</span>
        <span class="token comment"># 获取网址对应图片数据</span>
        img_data <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>img_src<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>content
        img_path <span class="token operator">=</span> <span class="token string">'./love/'</span> <span class="token operator">+</span> img_name
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>img_path<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>
            fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>img_data<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>img_name <span class="token operator">+</span> <span class="token string">'finish'</span><span class="token punctuation">)</span>
</code></pre> 
<p>以上的代码，实现了对一页图片的爬取，这个网站一共有172页的图片，如果想要爬取全部呢？可以用函数来实现。注意到每一页的url区别，都是<code>index_数字.html</code>，那么可以采用格式化字符串的方法，将所有页面的url存储到一个列表中，再将爬取一页的代码用函数封装，实现对每一页的爬取。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> os


<span class="token keyword">def</span> <span class="token function">getpic</span><span class="token punctuation">(</span>the_url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>the_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    <span class="token comment"># 手动设置相应数据的编码方式</span>
    <span class="token comment"># response.encoding = 'gbk'</span>
    page_text <span class="token operator">=</span> response<span class="token punctuation">.</span>text
    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page_text<span class="token punctuation">)</span>
    li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="slist"]/ul/li'</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>
        img_src <span class="token operator">=</span> <span class="token string">'http://pic.netbian.com'</span> <span class="token operator">+</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./a/img/@src'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        img_name <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./a/img/@alt'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'.jpg'</span>
        <span class="token comment"># 处理乱码的常规操作</span>
        img_name <span class="token operator">=</span> img_name<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'iso-8859-1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'gbk'</span><span class="token punctuation">)</span>
        <span class="token comment"># print(img_name,img_src)</span>
        <span class="token comment"># 获取网址对应图片数据</span>
        img_data <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>img_src<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>content
        img_path <span class="token operator">=</span> <span class="token string">'./love/'</span> <span class="token operator">+</span> img_name
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>img_path<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>
            fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>img_data<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>img_name <span class="token operator">+</span> <span class="token string">'finish'</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">'./love'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">'./love'</span><span class="token punctuation">)</span>
    url <span class="token operator">=</span> <span class="token string">'https://pic.netbian.com/4kmeinv/'</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 '</span>
                      <span class="token string">'(KHTML, like Gecko) Chrome/86.0.4240.75 Safari/537.36'</span>
    <span class="token punctuation">}</span>
    all_url <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">172</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        each_url <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">'index_%d.html'</span> <span class="token operator">%</span> i<span class="token punctuation">)</span>
        all_url<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each_url<span class="token punctuation">)</span>
    <span class="token keyword">for</span> one_url <span class="token keyword">in</span> all_url<span class="token punctuation">:</span>
        getpic<span class="token punctuation">(</span>one_url<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_509"></a>爬取全国城市名</h4> 
<p>网站url：<a href="https://www.aqistudy.cn/historydata/" rel="nofollow">https://www.aqistudy.cn/historydata/</a><br> 先进行信息搜集，可以看到网站中城市分为热门城市和其他城市，这两个种类里城市名所在的标签也是不同的，热门城市的名称所在标签为<code>div[@class="bottom"]/ul/li/a</code>，其他城市的名称所在的标签为<code>div[@class="bottom"]/ul/div[2]/li/a</code><br> <img src="https://images2.imgbox.com/1b/3c/BYD3kqcJ_o.png" alt="热门城市"><br> <img src="https://images2.imgbox.com/00/67/CGO9nUI7_o.png" alt="其他城市"><br> 直接上代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> <span class="token string">'https://www.aqistudy.cn/historydata/'</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 '</span>
                      <span class="token string">'(KHTML, like Gecko) Chrome/86.0.4240.75 Safari/537.36'</span>
    <span class="token punctuation">}</span>
    page_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>text

    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page_text<span class="token punctuation">)</span>
    hot_li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="bottom"]/ul/li'</span><span class="token punctuation">)</span>
    <span class="token comment"># print(hot_li_list)</span>
    all_city_name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># 解析到热门城市名称</span>
    <span class="token keyword">for</span> li <span class="token keyword">in</span> hot_li_list<span class="token punctuation">:</span>
        hot_city_name <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        all_city_name<span class="token punctuation">.</span>append<span class="token punctuation">(</span>hot_city_name<span class="token punctuation">)</span>
    <span class="token comment"># 解析到其他城市名称</span>
    other_li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="bottom"]/ul/div[2]/li'</span><span class="token punctuation">)</span>
    <span class="token comment"># print(other_li_list)</span>
    <span class="token keyword">for</span> li <span class="token keyword">in</span> other_li_list<span class="token punctuation">:</span>
        other_city_name <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        all_city_name<span class="token punctuation">.</span>append<span class="token punctuation">(</span>other_city_name<span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span>all_city_name<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>all_city_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>上面的程序是将热门城市及其他城市分开爬取的，想要将他们合并在一起，可以使用到<code>|</code>运算符：<code>//div[@class="bottom"]/ul/li/a | //div[@class="bottom"]/ul/div[2]/li/a</code></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> <span class="token string">'https://www.aqistudy.cn/historydata/'</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 '</span>
                      <span class="token string">'(KHTML, like Gecko) Chrome/86.0.4240.75 Safari/537.36'</span>
    <span class="token punctuation">}</span>
    page_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>text
    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page_text<span class="token punctuation">)</span>
    a_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="bottom"]/ul/li/a | //div[@class="bottom"]/ul/div[2]/li/a'</span><span class="token punctuation">)</span>
    all_city_name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> a <span class="token keyword">in</span> a_list<span class="token punctuation">:</span>
        one_city_name <span class="token operator">=</span> a<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        all_city_name<span class="token punctuation">.</span>append<span class="token punctuation">(</span>one_city_name<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>all_city_name<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>all_city_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4e84a442e72ebfae292ae1764a04952d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">海康工业相机功能模块-IO输入输出控制</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c6991e238b552b4a56c28eeaaff52abf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mysql5.6 远程导入_mysql开启远程连接方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>