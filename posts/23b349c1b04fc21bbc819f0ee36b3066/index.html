<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>VRRP协议是什么？详解它的工作原理 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="VRRP协议是什么？详解它的工作原理" />
<meta property="og:description" content="作者：Insist--
个人主页：insist--个人主页
作者会持续更新网络知识和python基础知识，期待你的关注
前言
本文将讲解VRRP是什么，以及它的工作原理，优点以及基本概念。
目录
一、VRRP协议是什么？
二、VRRP协议的工作原理
1、在抢占方式下
2、在非抢占方式下
三、VRRP的优点
1、简化网络管理
2、适应性强
3、网络开销小
四、VRRP基本概念
1、虚拟路由器
2、Master路由器
3、Backup路由器
4、Priority
5、vrid
6、虚拟IP地址
7、IP地址拥有者
8、虚拟MAC地址
一、VRRP协议是什么？ VRRP（虚拟路由器冗余协议）是一种实现路由器冗余的协议，通常被用于保证网络的高可用性。当出现主路由器故障时，备用路由器会自动接管主路由器的工作，从而确保网络仍能够顺畅工作。
VRRP协议主要用于解决单点故障问题，即当网络中的某台路由器发生故障时，其他路由器可以自动接管该路由器的功能，从而保证网络的连通性。VRRP协议通过将多个路由器配置为一个组，其中一台路由器被选举为虚拟路由器，其他路由器则作为备份路由器，同时监控虚拟路由器的状态。当虚拟路由器发生故障时，备份路由器会自动接管其功能，从而保证网络的连通性。
二、VRRP协议的工作原理 路由器开启VRRP功能后，会根据优先级确定自己在备份组中的角色。优先级高的路由器成为主用路由器，优先级低的成为备用路由器。主用路由器定期发送VRRP通告报文，通知备份组内的其他路由器自己工作正常；备用路由器则启动定时器等待通告报文的到来。
VRRP在不同的主用抢占方式下，主用角色的替换方式不同:
1、在抢占方式下 当备用路由器收到VRRP通告报文后，会将自己的优先级与通告报文中的优先级进行比较。如果大于通告报文中的优先级，则成为主用路由器否则将保持备用状态。
2、在非抢占方式下 只要主用路由器没有出现故障，备份组中的路由器始终保持主用或备用状态，备份组中的路由器即使随后被配置了更高的优先级也不会成为主用路由器。
如果备用路由器的定时器超时后仍未收到主用路由器发送来的VRRP通告报文，则认为主用路由器已经无法正常工作，此时备用路由器会认为自己是主用路由器，并对外发送VRRP通告报文。备份组内的路由器根据优先级选举出主用路由器，承担报文的转发功能。
三、VRRP的优点 1、简化网络管理 在具有多播或广播能力的局域网（如以太网）中，借助VRRP能在某台设备出现故障时仍然提供高可靠的缺省链路，有效避免单一链路发生故障后网络中断的问题，而无需修改动态路由协议、路由发现协议等配置信息，也无需修改主机的默认网关配置。
2、适应性强 VRRP报文封装在IP报文中，支持各种上层协议。
3、网络开销小 VRRP只定义了一种报文，那就是VRRP通告报文，并且只有处于Master状态的路由器可以发送VRRP报文。
四、VRRP基本概念 1、虚拟路由器 由一个Master设备和多个Backup设备组成，被当作一个共享局域网内主机的缺省网关。如RouterA和RouterB共同组成了一个虚拟路由器。
2、Master路由器 承担转发报文任务的VRRP设备，如RouterA。
3、Backup路由器 一组没有承担转发任务的VRRP设备，当Master设备出现故障时，它们将通过竞选成为新的Master设备，如RouterB。
4、Priority 设备在备份组中的优先级，取值范围是0~255。
0表示设备停止参与VRRP备份组，用来使备份设备尽快成为Master设备，而不必等到计时器超时
255则保留给IP地址拥有者，无法手工配置；设备缺省优先级值是100。
5、vrid 虚拟路由器的标识，如图中RouterA和RouterB组成的虚拟路由器的vrid为1，需手工指定，范围1-255。
6、虚拟IP地址 虚拟路由器的IP地址，一个虚拟路由器可以有一个或多个IP地址，由用户配置。如RouterA和RouterB组成的虚拟路由器的虚拟IP地址为10.1.1.254/24。
7、IP地址拥有者 如果一个VRRP设备将真实的接口IP地址配置为虚拟路由器IP地址，则该设备被称为IP地址拥有者。如果IP地址拥有者是可用的，则它将一直成为Master。
8、虚拟MAC地址 虚拟路由器根据vrid生成的MAC地址。一个虚拟路由器拥有一个虚拟MAC地址。当虚拟路由器回应ARP请求时，使用虚拟MAC地址，而不是接口的真实MAC地址。如RouterA和RouterB组成的虚拟路由器的vrid为1，因此这个VRRP备份组的MAC地址为00-00-5E-00-01-01。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/23b349c1b04fc21bbc819f0ee36b3066/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-28T22:59:38+08:00" />
<meta property="article:modified_time" content="2023-06-28T22:59:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">VRRP协议是什么？详解它的工作原理</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p><strong>作者：</strong>Insist--</p> 
 <p><strong>个人主页：</strong><a href="https://blog.csdn.net/m0_73995538?" title="insist--个人主页">insist--个人主页</a></p> 
 <p>作者会持续更新网络知识和<a href="https://so.csdn.net/so/search?q=python%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86&amp;spm=1001.2101.3001.7020" title="python基础知识">python基础知识</a>，期待你的关注</p> 
</blockquote> 
<p>前言</p> 
<p>本文将讲解VRRP是什么，以及它的工作原理，优点以及基本概念。</p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81VRRP%E5%8D%8F%E8%AE%AE%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81VRRP%E5%8D%8F%E8%AE%AE%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F" rel="nofollow">一、VRRP协议是什么？</a></p> 
<p id="%E4%BA%8C%E3%80%81VRRP%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81VRRP%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86" rel="nofollow">二、VRRP协议的工作原理</a></p> 
<p id="1%E3%80%81%E5%9C%A8%E6%8A%A2%E5%8D%A0%E6%96%B9%E5%BC%8F%E4%B8%8B-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E5%9C%A8%E6%8A%A2%E5%8D%A0%E6%96%B9%E5%BC%8F%E4%B8%8B" rel="nofollow">1、在抢占方式下</a></p> 
<p id="2%E3%80%81%E5%9C%A8%E9%9D%9E%E6%8A%A2%E5%8D%A0%E6%96%B9%E5%BC%8F%E4%B8%8B-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E5%9C%A8%E9%9D%9E%E6%8A%A2%E5%8D%A0%E6%96%B9%E5%BC%8F%E4%B8%8B" rel="nofollow">2、在非抢占方式下</a></p> 
<p id="%E4%B8%89%E3%80%81VRRP%E7%9A%84%E4%BC%98%E7%82%B9-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81VRRP%E7%9A%84%E4%BC%98%E7%82%B9" rel="nofollow">三、VRRP的优点</a></p> 
<p id="1%E3%80%81%E7%AE%80%E5%8C%96%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E7%AE%80%E5%8C%96%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86" rel="nofollow">1、简化网络管理</a></p> 
<p id="2%E3%80%81%E9%80%82%E5%BA%94%E6%80%A7%E5%BC%BA-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E9%80%82%E5%BA%94%E6%80%A7%E5%BC%BA" rel="nofollow">2、适应性强</a></p> 
<p id="3%E3%80%81%E7%BD%91%E7%BB%9C%E5%BC%80%E9%94%80%E5%B0%8F-toc" style="margin-left:40px;"><a href="#3%E3%80%81%E7%BD%91%E7%BB%9C%E5%BC%80%E9%94%80%E5%B0%8F" rel="nofollow">3、网络开销小</a></p> 
<p id="%E5%9B%9B%E3%80%81VRRP%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81VRRP%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5" rel="nofollow">四、VRRP基本概念</a></p> 
<p id="1%E3%80%81%E8%99%9A%E6%8B%9F%E8%B7%AF%E7%94%B1%E5%99%A8-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E8%99%9A%E6%8B%9F%E8%B7%AF%E7%94%B1%E5%99%A8" rel="nofollow">1、虚拟路由器</a></p> 
<p id="2%E3%80%81Master%E8%B7%AF%E7%94%B1%E5%99%A8-toc" style="margin-left:40px;"><a href="#2%E3%80%81Master%E8%B7%AF%E7%94%B1%E5%99%A8" rel="nofollow">2、Master路由器</a></p> 
<p id="3%E3%80%81Backup%E8%B7%AF%E7%94%B1%E5%99%A8-toc" style="margin-left:40px;"><a href="#3%E3%80%81Backup%E8%B7%AF%E7%94%B1%E5%99%A8" rel="nofollow">3、Backup路由器</a></p> 
<p id="4%E3%80%81Priority-toc" style="margin-left:40px;"><a href="#4%E3%80%81Priority" rel="nofollow">4、Priority</a></p> 
<p id="5%E3%80%81vrid-toc" style="margin-left:40px;"><a href="#5%E3%80%81vrid" rel="nofollow">5、vrid</a></p> 
<p id="6%E3%80%81%E8%99%9A%E6%8B%9FIP%E5%9C%B0%E5%9D%80-toc" style="margin-left:40px;"><a href="#6%E3%80%81%E8%99%9A%E6%8B%9FIP%E5%9C%B0%E5%9D%80" rel="nofollow">6、虚拟IP地址</a></p> 
<p id="7%E3%80%81IP%E5%9C%B0%E5%9D%80%E6%8B%A5%E6%9C%89%E8%80%85-toc" style="margin-left:40px;"><a href="#7%E3%80%81IP%E5%9C%B0%E5%9D%80%E6%8B%A5%E6%9C%89%E8%80%85" rel="nofollow">7、IP地址拥有者</a></p> 
<p id="8%E3%80%81%E8%99%9A%E6%8B%9FMAC%E5%9C%B0%E5%9D%80-toc" style="margin-left:40px;"><a href="#8%E3%80%81%E8%99%9A%E6%8B%9FMAC%E5%9C%B0%E5%9D%80" rel="nofollow">8、虚拟MAC地址</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E4%B8%80%E3%80%81VRRP%E5%8D%8F%E8%AE%AE%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F">一、VRRP协议是什么？</h2> 
<p style="text-align:center;"><img alt="2c2fe1f7ac1f4e87a56cd0d60d72aa15.JPG" src="https://images2.imgbox.com/df/60/BizWtNls_o.jpg"></p> 
<p>VRRP（虚拟路由器冗余协议）<strong>是一种实现路由器冗余的协议</strong>，通常被用于<strong>保证网络的高可用性</strong>。当出现主路由器故障时，备用路由器会自动接管主路由器的工作，从而确保网络仍能够顺畅工作。</p> 
<p>VRRP协议主要用于解决<strong>单点故障问题</strong>，即当网络中的某台路由器发生故障时，其他路由器可以自动接管该路由器的功能，从而保证网络的连通性。VRRP协议通过将<strong>多个路由器配置为一个组，</strong>其中一台路由器被选举为虚拟路由器，其他路由器则作为备份路由器，同时监控虚拟路由器的状态。当虚拟路由器发生故障时，备份路由器会自动接管其功能，从而保证网络的连通性。</p> 
<h2 id="%E4%BA%8C%E3%80%81VRRP%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86">二、VRRP协议的工作原理</h2> 
<p>路由器开启VRRP功能后，会<strong>根据优先级确定自己在备份组中的角色</strong>。<em>优先级高的路由器成为主用路由器，优先级低的成为备用路由器</em>。主用路由器定期发送VRRP通告报文，通知备份组内的其他路由器自己工作正常；备用路由器则启动定时器等待通告报文的到来。</p> 
<p>VRRP在不同的主用抢占方式下，主用角色的替换方式不同:</p> 
<h3 id="1%E3%80%81%E5%9C%A8%E6%8A%A2%E5%8D%A0%E6%96%B9%E5%BC%8F%E4%B8%8B">1、在抢占方式下</h3> 
<p>当备用路由器收到VRRP通告报文后，<strong>会将自己的优先级与通告报文中的优先级进行比较。</strong>如果大于通告报文中的优先级，则成为主用路由器否则将保持备用状态。</p> 
<h3 id="2%E3%80%81%E5%9C%A8%E9%9D%9E%E6%8A%A2%E5%8D%A0%E6%96%B9%E5%BC%8F%E4%B8%8B">2、在非抢占方式下</h3> 
<p>只要主用路由器没有出现故障，<strong>备份组中的路由器始终保持主用或备用状态，</strong>备份组中的路由器即使随后被配置了更高的优先级也不会成为主用路由器。</p> 
<p>如果备用路由器的定时器超时后仍未收到主用路由器发送来的VRRP通告报文，则认为主用路由器已经无法正常工作，此时备用路由器会认为自己是主用路由器，并对外发送VRRP通告报文。<strong>备份组内的路由器根据优先级选举出主用路由器，承担报文的转发功能。</strong></p> 
<h2 id="%E4%B8%89%E3%80%81VRRP%E7%9A%84%E4%BC%98%E7%82%B9">三、VRRP的优点</h2> 
<p style="text-align:center;"><img alt="afeb685cd3f6490bb90c4518df2cf141.jpg" src="https://images2.imgbox.com/c9/ca/e9diRjQW_o.jpg"></p> 
<h3 id="1%E3%80%81%E7%AE%80%E5%8C%96%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86">1、简化网络管理</h3> 
<p>在具有多播或广播能力的局域网（如以太网）中，借助VRRP能在某台设备出现故障时仍然提供高可靠的缺省链路，<strong>有效避免单一链路发生故障后网络中断的问题</strong>，而无需修改动态路由协议、路由发现协议等配置信息，也无需修改主机的默认网关配置。</p> 
<h3 id="2%E3%80%81%E9%80%82%E5%BA%94%E6%80%A7%E5%BC%BA">2、适应性强</h3> 
<p>VRRP报文封装在IP报文中，支持各种上层协议。</p> 
<h3 id="3%E3%80%81%E7%BD%91%E7%BB%9C%E5%BC%80%E9%94%80%E5%B0%8F">3、网络开销小</h3> 
<p>VRRP只定义了一种报文，那就是VRRP通告报文，并且只有处于Master状态的路由器可以发送VRRP报文。</p> 
<h2 id="%E5%9B%9B%E3%80%81VRRP%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5">四、VRRP基本概念</h2> 
<h3 id="1%E3%80%81%E8%99%9A%E6%8B%9F%E8%B7%AF%E7%94%B1%E5%99%A8">1、虚拟路由器</h3> 
<p>由一个Master设备和多个Backup设备组成，<strong>被当作一个共享局域网内主机的缺省网关</strong>。如RouterA和RouterB共同组成了一个虚拟路由器。</p> 
<h3 id="2%E3%80%81Master%E8%B7%AF%E7%94%B1%E5%99%A8">2、Master路由器</h3> 
<p>承担转发报文任务的VRRP设备，如RouterA。</p> 
<h3 id="3%E3%80%81Backup%E8%B7%AF%E7%94%B1%E5%99%A8">3、Backup路由器</h3> 
<p>一组没有承担转发任务的VRRP设备，<strong>当Master设备出现故障时，它们将通过竞选成为新的Master设备，</strong>如RouterB。</p> 
<h3 id="4%E3%80%81Priority">4、Priority</h3> 
<p>设备在备份组中的优先级，<strong>取值范围是0~255。</strong></p> 
<p>0表示<strong>设备停止参与VRRP备份组，</strong>用来使备份设备尽快成为Master设备，而不必等到计时器超时</p> 
<p>255则<strong>保留给IP地址拥有者</strong>，无法手工配置；设备缺省优先级值是100。</p> 
<h3 id="5%E3%80%81vrid">5、vrid</h3> 
<p><strong>虚拟路由器的标识</strong>，如图中RouterA和RouterB组成的虚拟路由器的vrid为1，需手工指定，<strong>范围1-255。</strong></p> 
<h3 id="6%E3%80%81%E8%99%9A%E6%8B%9FIP%E5%9C%B0%E5%9D%80">6、虚拟IP地址</h3> 
<p><strong>虚拟路由器的IP地址</strong>，一个虚拟路由器可以有一个或多个IP地址，由用户配置。如RouterA和RouterB组成的虚拟路由器的虚拟IP地址为10.1.1.254/24。</p> 
<h3 id="7%E3%80%81IP%E5%9C%B0%E5%9D%80%E6%8B%A5%E6%9C%89%E8%80%85">7、IP地址拥有者</h3> 
<p>如果一个VRRP设备将真实的接口IP地址配置为<strong>虚拟路由器IP地址</strong>，则该设备被称为IP地址拥有者。如果IP地址拥有者是可用的，则它将一直成为Master。</p> 
<h3 id="8%E3%80%81%E8%99%9A%E6%8B%9FMAC%E5%9C%B0%E5%9D%80">8、虚拟MAC地址</h3> 
<p>虚拟路由器根据vrid生成的MAC地址。一个虚拟路由器拥有一个虚拟MAC地址。<strong>当虚拟路由器回应ARP请求时，使用虚拟MAC地址，而不是接口的真实MAC地址</strong>。如RouterA和RouterB组成的虚拟路由器的vrid为1，因此这个VRRP备份组的MAC地址为00-00-5E-00-01-01。</p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/932e945dab41065934bb89116feb0e42/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数据中台架构</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/75e3036431a6964e4b98aa95e4cb11eb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C&#43;&#43;】stack、queue和priority_queue的使用及模拟实现（包括deque、仿函数、反向迭代器）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>