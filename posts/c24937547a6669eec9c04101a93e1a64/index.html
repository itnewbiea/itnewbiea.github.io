<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQL实现 模糊查询 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SQL实现 模糊查询" />
<meta property="og:description" content="一般模糊查询语句如下：
SELECT 字段 FROM 表 WHERE 某字段 Like 条件
其中关于条件，SQL提供了四种匹配模式：
1，% ：表示任意0个或多个字符。可匹配任意类型和长度的字符，有些情况下若是中文，请使用两个百分号（%%）表示。
比如 SELECT * FROM [user] WHERE u_name LIKE &#39;%三%&#39;
将会把u_name为“张三”，“张猫三”、“三脚猫”，“唐三藏”等等有“三”的记录全找出来。
另外，如果需要找出u_name中既有“三”又有“猫”的记录，请使用and条件
SELECT * FROM [user] WHERE u_name LIKE &#39;%三%&#39; AND u_name LIKE &#39;%猫%&#39;
若使用 SELECT * FROM [user] WHERE u_name LIKE &#39;%三%猫%&#39;
虽然能搜索出“三脚猫”，但不能搜索出符合条件的“张猫三”。
2，_ ： 表示任意单个字符。匹配单个任意字符，它常用来限制表达式的字符长度语句：
比如 SELECT * FROM [user] WHERE u_name LIKE &#39;三&#39;
只找出“唐三藏”这样u_name为三个字且中间一个字是“三”的；
再比如 SELECT * FROM [user] WHERE u_name LIKE &#39;三__&#39;;
只找出“三脚猫”这样name为三个字且第一个字是“三”的；
3，[ ] ：表示括号内所列字符中的一个（类似正则表达式）。指定一个字符、字符串或范围，要求所匹配对象为它们中的任一个。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c24937547a6669eec9c04101a93e1a64/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-06-14T10:33:39+08:00" />
<meta property="article:modified_time" content="2019-06-14T10:33:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQL实现 模糊查询</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <div id="main"> 
 <div id="mainContent"> 
  <div class="forFlow"> 
  </div> 
 </div> 
</div> 
 
<div id="topics"> 
 <p>一般模糊查询语句如下：</p> 
 <p>SELECT 字段 FROM 表 WHERE 某字段 Like 条件</p> 
 <p>其中关于条件，SQL提供了四种匹配模式：</p> 
 <p>1，% ：表示任意0个或多个字符。可匹配任意类型和长度的字符，有些情况下若是中文，请使用两个百分号（%%）表示。</p> 
 <p>比如 SELECT * FROM [user] WHERE u_name LIKE '%三%'</p> 
 <p>将会把u_name为“张三”，“张猫三”、“三脚猫”，“唐三藏”等等有“三”的记录全找出来。</p> 
 <p>另外，如果需要找出u_name中既有“三”又有“猫”的记录，请使用and条件<br> SELECT * FROM [user] WHERE u_name LIKE '%三%' AND u_name LIKE '%猫%'</p> 
 <p>若使用 SELECT * FROM [user] WHERE u_name LIKE '%三%猫%'<br> 虽然能搜索出“三脚猫”，但不能搜索出符合条件的“张猫三”。</p> 
 <p>2，_ ： 表示任意单个字符。匹配单个任意字符，它常用来限制表达式的字符长度语句：</p> 
 <p>比如 SELECT * FROM [user] WHERE u_name LIKE '<em>三</em>'<br> 只找出“唐三藏”这样u_name为三个字且中间一个字是“三”的；</p> 
 <p>再比如 SELECT * FROM [user] WHERE u_name LIKE '三__';<br> 只找出“三脚猫”这样name为三个字且第一个字是“三”的；</p> 
 <p>3，[ ] ：表示括号内所列字符中的一个（类似正则表达式）。指定一个字符、字符串或范围，要求所匹配对象为它们中的任一个。</p> 
 <p>比如 SELECT * FROM [user] WHERE u_name LIKE '[张李王]三'<br> 将找出“张三”、“李三”、“王三”（而不是“张李王三”）；</p> 
 <p>如 [ ] 内有一系列字符（01234、abcde之类的）则可略写为“0-4”、“a-e”<br> SELECT * FROM [user] WHERE u_name LIKE '老[1-9]'<br> 将找出“老1”、“老2”、……、“老9”；</p> 
 <p>4，[^ ] ：表示不在括号所列之内的单个字符。其取值和 [] 相同，但它要求所匹配对象为指定字符以外的任一个字符。</p> 
 <p>比如 SELECT * FROM [user] WHERE u_name LIKE '[^张李王]三'<br> 将找出不姓“张”、“李”、“王”的“赵三”、“孙三”等；</p> 
 <p>SELECT * FROM [user] WHERE u_name LIKE '老[^1-4]';<br> 将排除“老1”到“老4”，寻找“老5”、“老6”、……</p> 
 <p>5，查询内容包含通配符时</p> 
 <p>由于通配符的缘故，导致我们查询特殊字符“%”、“_”、“[”的语句无法正常实现，而把特殊字符用“[ ]”括起便可正常查询。据此我们写出以下函数：</p> 
 <p>function sqlencode(str)<br> str=replace(str,"[","[[]") '此句一定要在最前<br> str=replace(str,"_","[_]")<br> str=replace(str,"%","[%]")<br> sqlencode=str<br> end function</p> 
 <p>在查询前将待查字符串先经该函数处理即可，并且在网页上连接数据库用到这类的查询语句时侯要注意：</p> 
 <p>如Select * FROM user Where name LIKE '老[^1-4]';上面 《'》老[^1-4]《'》是要有单引号的，别忘了，我经常忘！</p> 
 <p>access</p> 
 <p>在近日的写Web程序时用到了Access的模糊查询,在Acces里写代码怎么也找不到记录,后来才起来原来Acess和SqlServer的模糊查询是有特别的<br> 条件:查找表A 的Name字段中包括 "B" 的记当<br> 在Access里的代码:</p> 
 <p>1 Select * from a where name like '<em>b</em>'Sql Server查询分析器的代码<br> Select * from a where name like '%b%'这时你会发现Access里可以找到相关的记录,但把'<em>'必成'%'就找不到了,原因是Access的模糊查询是'?','</em>'<br> 和Sql server不一样<br> 以上只是在数据库中的代码,如果要写在程序里可就不能用.'<em>'了,还是要用'%'<br> 程序:<br> strSql="select </em> from a where name like '%b%'"所以如果有朋友和我一样喜欢先在数据库中代码测试,那可就要注意了!!</p> 
 <hr> 
 <p>SQL模糊查询，使用like比较关键字，加上SQL里的通配符，请参考以下：<br> 1、LIKE'Mc%' 将搜索以字母 Mc 开头的所有字符串（如 McBadden）。<br> 2、LIKE'%inger' 将搜索以字母 inger 结尾的所有字符串（如 Ringer、Stringer）。<br> 3、LIKE'%en%' 将搜索在任何位置包含字母 en 的所有字符串（如 Bennet、Green、McBadden）。<br> 4、LIKE'_heryl' 将搜索以字母 heryl 结尾的所有六个字母的名称（如 Cheryl、Sheryl）。<br> 5、LIKE'[CK]ars[eo]n' 将搜索下列字符串：Carsen、Karsen、Carson 和 Karson（如 Carson）。<br> 6、LIKE'[M-Z]inger' 将搜索以字符串 inger 结尾、以从 M 到 Z 的任何单个字母开头的所有名称（如 Ringer）。<br> 7、LIKE'M[^c]%' 将搜索以字母 M 开头，并且第二个字母不是 c 的所有名称（如MacFeather）。<br> -------------------------------------------------<br> 下 面这句查询字符串是我以前写的，根据变量 zipcode_key 在邮政编码表 zipcode 中查询对应的数据，这句是判断变量 zipcode_key 为非数字时的查询语句，用 % 来匹配任意长度的字符串，从表中地址、市、省三列中查询包含关键字的所有数据项，并按省、市、地址排序。这个例子比较简单，只要你理解了方法就可以写出更 复杂的查询语句。</p> 
 <p>sql = "select * from zipcode where (address like'%" &amp; zipcode_key &amp; "%') or (city like'%" &amp; zipcode_key &amp; "%') or (province like'%" &amp; zipcode_key &amp; "%') order by province,city,address<br> 存储过程中使用模糊查询的例子：<br> SELECT * FROM Questions where QTitle like ' % [ '+ @KeyWord +' ] % ' and IsFinish = @IsFinsih<br> 语句中成对的方括号 是书写格式的关键。</p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/82f0c7ab27c311a5c0388e771e384c28/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">centos7 VM 关闭防火墙</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/913128375dea4a39922ba9072233401c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Mongodb日志切割</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>