<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>网络安全—IPSec安全策略 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="网络安全—IPSec安全策略" />
<meta property="og:description" content="文章目录 网络拓扑添加策略ESP添加筛选器添加筛选器的操作另一台主机设置 AH 使用Windows Server 2003系统
网络拓扑 client1
IP = 192.168.17.105client2
IP = 192.168.17.106 只要保证两个主机在同一网段接口，即互相ping通即可完成策略的实现
下面的所有通讯都只是互相ping地址观察数据包是否实现了安全策略。
添加策略 ESP 添加筛选器 点击本地安全策略
双击安全服务器
添加
点击下一步来到这里，依旧是默认第一个，然后点击下一步
下一步
点击添加IP筛选器
写好名称和描述方便辨认（然后点击添加）
下一步即可
由于上面说过我使用client2来ping另一部，所以我这里目的IP地址就是对方的105
下一步，选择ICMP，因为我们是通过ping的方式进行传输数据包。
完成
点击确定
选中我们添加好的新的IP筛选
添加筛选器的操作 依旧选择添加新的筛选器操作
继续下一步，写上名称和描述信息方便辨认
下一步
选择完整性和加密，加密的就是ESP协议，AH是仅保证完整性
一直下一步完成即可，然后勾选上我刚刚添加的筛选器操作即可下一步
这里选择共享密码，设置一个双方都知道的密码，也就是说我们待会设置另一个主机的时候，来到这里的密码要设置一样的
记得将其他默认勾选的都去掉，只剩下我们自己的就行，点击应用即可
然后指派安全服务器策略
另一台主机设置 一样的设置，一定要一样，名称和描述可以不同，还有密码一定要设置一样的。不同的就是写目的IP地址是不同的。
另一台主机设置完成后，回到client主机，打开抓包软件，然后ping通client1，发现全是ESP协议包，分析可知道ESP协议号是50，完美！
AH 添加过程同理
下面将会介绍一些不同的细节，在ESP部分也讲过。
选择仅数据完整性，因为AH不提供加密服务
完成后，双方仅仅指派AH协议的筛选器
排错：假设你没有ping通，那么很可能就是你没有选AH的仅仅保证完整性而是选择了加密。
选择你刚刚添加的AH，点击编辑选项
选择筛选器操作，然后选择你的AH操作，然后编辑
点击AH然后编辑
为了保险起见，我们自己定义AH，取消ESP，记住现在是选择了MD5算法，待会另一台设置的时候也是要这样设置回来MD5，然后其他就没问题了，直接指派即可。
如果还错误就是密码不一样，来到身份验证，然后选择编辑即可
全部搞定后记得选择AH，然后应用，最后指派任务。 成功ping通，找到数据包的协议号为51，就是AH协议号，完美！" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/23af31ab3529aeebfbbf44b5f597b30a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-03T13:28:19+08:00" />
<meta property="article:modified_time" content="2024-01-03T13:28:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">网络安全—IPSec安全策略</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">网络拓扑</a></li><li><a href="#_13" rel="nofollow">添加策略</a></li><li><ul><li><a href="#ESP_14" rel="nofollow">ESP</a></li><li><ul><li><a href="#_15" rel="nofollow">添加筛选器</a></li><li><a href="#_52" rel="nofollow">添加筛选器的操作</a></li><li><a href="#_71" rel="nofollow">另一台主机设置</a></li></ul> 
   </li><li><a href="#AH_80" rel="nofollow">AH</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<blockquote> 
 <p>使用Windows Server 2003系统</p> 
</blockquote> 
<h2><a id="_2"></a>网络拓扑</h2> 
<ul><li>client1<br> IP = 192.168.17.105</li><li>client2<br> IP = 192.168.17.106</li></ul> 
<blockquote> 
 <p><mark>只要保证两个主机在同一网段接口，即互相ping通即可完成策略的实现</mark></p> 
</blockquote> 
<hr> 
<p>下面的所有通讯都只是互相ping地址观察数据包是否实现了安全策略。</p> 
<hr> 
<h2><a id="_13"></a>添加策略</h2> 
<h3><a id="ESP_14"></a>ESP</h3> 
<h4><a id="_15"></a>添加筛选器</h4> 
<ul><li> <p>点击本地安全策略<br> <img src="https://images2.imgbox.com/27/09/jeSkmb5g_o.png" alt="在这里插入图片描述"></p> </li><li> <p>双击安全服务器<br> <img src="https://images2.imgbox.com/8c/01/AFSodoxh_o.png" alt="在这里插入图片描述"></p> </li><li> <p>添加<br> <img src="https://images2.imgbox.com/74/59/dYOuCIK8_o.png" alt="在这里插入图片描述"></p> </li><li> <p>点击下一步来到这里，依旧是默认第一个，然后点击下一步<br> <img src="https://images2.imgbox.com/3f/36/hh6jDWfG_o.png" alt="在这里插入图片描述"></p> </li><li> <p>下一步<br> <img src="https://images2.imgbox.com/ca/22/4YOQbqUt_o.png" alt="在这里插入图片描述"></p> </li><li> <p>点击添加IP筛选器<br> <img src="https://images2.imgbox.com/dc/d8/gkR1ZnnV_o.png" alt="在这里插入图片描述"></p> </li><li> <p>写好名称和描述方便辨认（然后点击添加）</p> </li></ul> 
<p><img src="https://images2.imgbox.com/a9/70/EgocTB5S_o.png" alt="在这里插入图片描述"></p> 
<ul><li> <p>下一步即可<br> <img src="https://images2.imgbox.com/e0/40/lDjVa42D_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/9e/76/XHZJQ2pw_o.png" alt="在这里插入图片描述"></p> </li><li> <p>由于上面说过我使用client2来ping另一部，所以我这里目的IP地址就是对方的105<br> <img src="https://images2.imgbox.com/e9/0f/MCcUEfMm_o.png" alt="在这里插入图片描述"></p> </li><li> <p>下一步，选择ICMP，因为我们是通过ping的方式进行传输数据包。<br> <img src="https://images2.imgbox.com/95/49/6dBoJ7D1_o.png" alt="在这里插入图片描述"><br> 完成<br> <img src="https://images2.imgbox.com/d0/0e/UCmNzTK1_o.png" alt="在这里插入图片描述"></p> </li><li> <p>点击确定<br> <img src="https://images2.imgbox.com/c7/f2/TdMuOFH4_o.png" alt="在这里插入图片描述"></p> </li><li> <p>选中我们添加好的新的IP筛选<br> <img src="https://images2.imgbox.com/30/2a/403UxV4O_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h4><a id="_52"></a>添加筛选器的操作</h4> 
<ul><li> <p>依旧选择添加新的筛选器操作<br> <img src="https://images2.imgbox.com/4b/53/YY75yPHW_o.png" alt="在这里插入图片描述"><br> 继续下一步，写上名称和描述信息方便辨认<br> <img src="https://images2.imgbox.com/1f/51/g3NRWpnC_o.png" alt="在这里插入图片描述"></p> </li><li> <p>下一步<br> <img src="https://images2.imgbox.com/da/fb/R143FkBL_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/45/b8/bwI9QAup_o.png" alt="在这里插入图片描述"></p> </li><li> <p>选择完整性和加密，加密的就是ESP协议，AH是仅保证完整性<br> <img src="https://images2.imgbox.com/ce/50/WpVQ1rbt_o.png" alt="在这里插入图片描述"></p> </li><li> <p>一直下一步完成即可，然后勾选上我刚刚添加的筛选器操作即可下一步<br> <img src="https://images2.imgbox.com/f6/b9/4axtQPM4_o.png" alt="在这里插入图片描述"></p> </li><li> <p>这里选择共享密码，设置一个双方都知道的密码，也就是说我们待会设置另一个主机的时候，来到这里的密码要设置一样的<br> <img src="https://images2.imgbox.com/c8/34/NtCn47Nd_o.png" alt="在这里插入图片描述"></p> </li><li> <p>记得将其他默认勾选的都去掉，只剩下我们自己的就行，点击应用即可<br> <img src="https://images2.imgbox.com/1e/87/vP4BMQzY_o.png" alt="在这里插入图片描述"></p> </li><li> <p>然后指派安全服务器策略<br> <img src="https://images2.imgbox.com/7c/f6/davuHhKr_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h4><a id="_71"></a>另一台主机设置</h4> 
<p>一样的设置，一定要一样，名称和描述可以不同，还有密码一定要设置一样的。<mark><strong>不同的就是写目的IP地址是不同的。</strong></mark></p> 
<hr> 
<p>另一台主机设置完成后，回到client主机，打开抓包软件，然后ping通client1，发现全是ESP协议包，分析可知道ESP协议号是50，完美！</p> 
<p><img src="https://images2.imgbox.com/86/48/t968x4ix_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="AH_80"></a>AH</h3> 
<p>添加过程同理<br> 下面将会介绍一些不同的细节，在ESP部分也讲过。<br> 选择仅数据完整性，因为AH不提供加密服务</p> 
<p><img src="https://images2.imgbox.com/24/4f/9IpAEKkj_o.png" alt="在这里插入图片描述"><br> 完成后，双方仅仅指派AH协议的筛选器<br> <img src="https://images2.imgbox.com/ed/f5/gQzTN7TE_o.png" alt="在这里插入图片描述"></p> 
<ul><li> <p>排错：假设你没有ping通，那么很可能就是你没有选AH的仅仅保证完整性而是选择了加密。</p> 
  <ul><li>选择你刚刚添加的AH，点击编辑选项<br> <img src="https://images2.imgbox.com/32/b1/gnYPFvZu_o.png" alt="在这里插入图片描述"></li><li>选择筛选器操作，然后选择你的AH操作，然后编辑<br> <img src="https://images2.imgbox.com/bb/9d/7u1fhTHc_o.png" alt="在这里插入图片描述"></li><li>点击AH然后编辑<br> <img src="https://images2.imgbox.com/a3/d1/oWyLCIV9_o.png" alt="在这里插入图片描述"></li><li>为了保险起见，我们自己定义AH，取消ESP，记住现在是选择了MD5算法，待会另一台设置的时候也是要这样设置回来MD5，然后其他就没问题了，直接指派即可。<br> <img src="https://images2.imgbox.com/3b/90/x2JMMfhU_o.png" alt="在这里插入图片描述"></li></ul> </li><li> <p>如果还错误就是密码不一样，来到身份验证，然后选择编辑即可<br> <img src="https://images2.imgbox.com/95/9f/jPzQSplO_o.png" alt="在这里插入图片描述"></p> 
  <ul><li>全部搞定后记得选择AH，然后应用，最后指派任务。</li></ul> </li><li> <p>成功ping通，找到数据包的协议号为51，就是AH协议号，完美！<img src="https://images2.imgbox.com/2d/f5/mh2epl6i_o.png" alt="在这里插入图片描述"></p> </li></ul>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6d2500b21f7b8bd3abc6b180d32dfa8e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">全解析阿里云Alibaba Cloud Linux镜像操作系统</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/137ec7e14dfb275d4c1cc62938c62514/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">计算机专业 最新 毕业设计 选题推荐 毕设指导</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>