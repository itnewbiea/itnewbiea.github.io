<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>win10、win7 脚本导证书到系统中 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="win10、win7 脚本导证书到系统中" />
<meta property="og:description" content="--------------------------------------------------------------------------------------------------------
可用的bat，仅测试了win10和win 7
@echo off
rem 注意：：：需要管理员权限，否则运行失败！！ rem 作用：将mongoose的根证书ca.crt导入当前计算机 rem 导入时windows会弹出警告框（ 缺点），提示用户是否信任该根证书，需要管理员权限 rem certmgr.exe /c /add C:\ca.crt /s root win10 ok，win 7没有 certmgr.exe rem 导入证书到可信任证书颁发者,C:\ca.crt 证书路径需根据实际情况更改 certutil -addstore root C:\ca.crt pause exit
-------------------------------------------------------------------------------------------------------------------
certmgr.exe 简介！
证书管理器工具管理证书、证书信任列表 (CTL) 和证书吊销列表 (CRL)。 certmgr [/add | /del | /put] [options] [/s[/r registryLocation]] [sourceStorename] [/s[/r registryLocation]] [destinationStorename] 参数 -------------------------------------------------------------------------------- 参数 说明 sourceStorename StoreFile 类型或系统存储区类型的输入证书存储区。 destinationStorename 输出证书存储区或文件。 选项 说明 /add 将证书、CTL 和 CRL 添加到证书存储区中。 /all 当与 /add 一起使用时添加所有项。当与 /del 一起使用时删除所有项。不带 /add 或 /delete 选项使用时显示所有项。/all 选项不能与 /put 一起使用。 /c 当与 /add 一起使用时添加证书。当与 /del 一起使用时删除证书。当与 /put 一起使用时保存证书。不带 /add、/delete 或 /put 选项使用时显示证书。 /CRL 添加或删除 CRL。不带 /add、/delete 或 /put 选项使用时显示 CRL。 /CTL 添加或删除 CTL。不带 /add、/delete 或 /put 选项使用时显示 CTL。 /delete 从指定的证书存储区中删除证书、CTL 和 CRL。 /e encodingType 指定证书编码类型。 /f dwFlags 指定存储区打开标志。这是传递到 CertOpenStore 的 dwFlags 参数。默认值为 CERT_SYSTEM_STORE_CURRENT_USER。仅当使用 /y 选项时才考虑此选项。 /h[elp] 显示该工具的命令语法和选项。 /n commonName String 指定要添加、删除或保存的证书的公共名。此选项只能用于证书，不能用于 CTL 或 CRL。 /put 将证书存储区中的 X." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/b6156d2feb5cd449777472b1914a5111/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-06-28T17:37:28+08:00" />
<meta property="article:modified_time" content="2018-06-28T17:37:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">win10、win7 脚本导证书到系统中</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>--------------------------------------------------------------------------------------------------------</p> 
<p>可用的bat，仅测试了<span style="color:#009900;">win10和win 7</span></p> 
<p>@echo off</p> 
<br>rem 注意：：：需要管理员权限，否则运行失败！！ 
<br>rem 作用：将mongoose的根证书ca.crt导入当前计算机 
<br> 
<br>rem 导入时windows会弹出警告框（ 
<span style="color:#cc0000;">缺点</span>），提示用户是否信任该根证书，需要管理员权限 
<br>rem 
<span style="color:#009900;">certmgr.exe /c /add C:\ca.crt /s root</span> 
 win10 ok，win 7没有 
 certmgr.exe 
<br> 
<br>rem 导入证书到可信任证书颁发者,C:\ca.crt 证书路径需根据实际情况更改 
<br> 
<span style="color:#009900;">certutil -addstore root C:\ca.crt</span> 
<br> 
<br>pause 
<br> 
<p>exit</p> 
<p>-------------------------------------------------------------------------------------------------------------------</p> 
<p></p> 
<p><span style="font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);"><span style="font-size:18px;color:#cc0000;">certmgr.exe 简介！</span><br></span></p> 
<p><span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">证书管理器工具管理证书、证书信任列表 (CTL) 和证书吊销列表 (CRL)。 </span></p> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">certmgr [/add | /del | /put] [options]</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">[/s[/r registryLocation]] [sourceStorename]</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">[/s[/r registryLocation]] [destinationStorename]</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">参数</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">--------------------------------------------------------------------------------</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">参数                 说明  </span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">sourceStorename      StoreFile 类型或系统存储区类型的输入证书存储区。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">destinationStorename 输出证书存储区或文件。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">选项                 说明 </span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/add                 将证书、CTL 和 CRL 添加到证书存储区中。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/all                 当与 /add 一起使用时添加所有项。当与 /del 一起使用时删除所有项。不带 /add 或 /delete 选项使用时显示所有项。/all 选项不能与 /put 一起使用。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/c                   当与 /add 一起使用时添加证书。当与 /del 一起使用时删除证书。当与 /put 一起使用时保存证书。不带 /add、/delete 或 /put 选项使用时显示证书。 </span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/CRL                 添加或删除 CRL。不带 /add、/delete 或 /put 选项使用时显示 CRL。 </span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/CTL                 添加或删除 CTL。不带 /add、/delete 或 /put 选项使用时显示 CTL。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/delete              从指定的证书存储区中删除证书、CTL 和 CRL。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/e encodingType      指定证书编码类型。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/f dwFlags           指定存储区打开标志。这是传递到 CertOpenStore 的 dwFlags 参数。默认值为 CERT_SYSTEM_STORE_CURRENT_USER。仅当使用 /y 选项时才考虑此选项。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/h[elp]              显示该工具的命令语法和选项。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/n commonName String 指定要添加、删除或保存的证书的公共名。此选项只能用于证书，不能用于 CTL 或 CRL。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/put                 将证书存储区中的 X.509 证书、CTL 或 CRL 保存到文件。该文件将以 X.509 格式保存。/7 选项可与 /put 选项一起使用以 PKCS #7 格式保存文件。/put 选项后面必须有 /c、/CTL 或 /CRL。/all 选项不能与 /put 一起使用。 </span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/r registry location 标识系统存储区的注册表位置。仅当指定 /s 选项时才考虑此选项。Registry location 必须是下列值之一：</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">                     currentUser 指示证书存储区在 HKEY_CURRENT_USER 键下。此为默认值。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">                     localMachine 指示证书存储区在 HKEY_LOCAL_MACHINE 键下。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/s                   指示证书存储区是系统存储区。如果不指定此选项，则该存储区为 StoreFile。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/sha1 sha1Hash       指定要添加、删除或保存的证书、CTL 或 CRL 的 SHA1 哈希。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/v                   指定详细模式；显示有关证书、CTL 和 CRL 的详细信息。此选项不能与 /add、/delete 或 /put 选项一起使用。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/y storeProviderType 指定存储区提供程序类型。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/7                   将目标存储区保存为 PKCS#7 对象。 </span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">/?                   显示该工具的命令语法和选项。</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">备注</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">--------------------------------------------------------------------------------</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">Certmgr.exe 执行下列基本功能： </span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">将证书、CTL 和 CRL 显示到控制台。 </span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">将证书、CTL 和 CRL 添加到证书存储区中。 </span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">从证书存储区中删除证书、CTL 和 CRL。 </span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">将证书存储区中的 X.509 证书、CTL 或 CRL 保存到文件。 </span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">Certmgr.exe 使用两类证书存储区：StoreFile 和系统存储区。 不必指定证书存储区的类型；Certmgr.exe 能够识别存储区类型并执行适当的操作。 </span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">未指定任何选项运行 Certmgr.exe 启动 certmgr.msc 的管理单元，其中有一个 GUI，使用证书管理任务，也可从命令行的帮助。 该 GUI 提供一个导入向导，此向导将证书、CTL 和 CRL 从磁盘复制到证书存储区中。 </span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">有关证书的更多信息，请参见 Microsoft Platform SDK 文档中的“About CryptoAPI”部分。 </span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">示例</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">--------------------------------------------------------------------------------</span> 
<br style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;"> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">下列命令显示一个名为 my 且包含详细输出的默认系统存储区。</span> 
<span style="font-size:14px;color:rgb(70,70,70);font-family:simsun;line-height:21px;background-color:rgb(188,211,229);"></span> 
<span style="color:rgb(51,51,51);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(255,255,255);"></span> 
<div style="width:586px;border:1px solid rgb(204,204,204);background-color:rgb(249,249,249);color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;font-size:12px;"> 
 <div> 
  <ol style="list-style:none;border:0px;"><li style="border:0px;line-height:1.8em;font-family:Monaco, Consolas, serif;">certmgr /v /s my</li></ol> 
 </div> 
 <span style="margin-left:43px;color:rgb(102,102,102);">复制代码</span> 
</div> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">下面的命令将名为 myFile.ext 的文件中的所有证书添加到一个名为 newFile.ext 的新文件中。</span> 
<span style="font-size:14px;color:rgb(70,70,70);font-family:simsun;line-height:21px;background-color:rgb(188,211,229);"></span> 
<span style="color:rgb(51,51,51);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(255,255,255);"></span> 
<div style="width:586px;border:1px solid rgb(204,204,204);background-color:rgb(249,249,249);color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;font-size:12px;"> 
 <div> 
  <ol style="list-style:none;border:0px;"><li style="border:0px;line-height:1.8em;font-family:Monaco, Consolas, serif;">certmgr /add /all /c myFile.ext newFile.ext</li></ol> 
 </div> 
 <span style="margin-left:43px;color:rgb(102,102,102);">复制代码</span> 
</div> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">下面的命令将一个名为 文件中添加证书 testcert.cer以将 my系统存储区。</span> 
<span style="font-size:14px;color:rgb(70,70,70);font-family:simsun;line-height:21px;background-color:rgb(188,211,229);"></span> 
<span style="color:rgb(51,51,51);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(255,255,255);"></span> 
<div style="width:586px;border:1px solid rgb(204,204,204);background-color:rgb(249,249,249);color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;font-size:12px;"> 
 <div> 
  <ol style="list-style:none;border:0px;"><li style="border:0px;line-height:1.8em;font-family:Monaco, Consolas, serif;">certmgr /add /c testcert.cer /s my</li></ol> 
 </div> 
 <span style="margin-left:43px;color:rgb(102,102,102);">复制代码</span> 
</div> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">下面的命令将证书添加在一个文件中名为 TrustedCert.cer到 根证书存储区。</span> 
<span style="font-size:14px;color:rgb(70,70,70);font-family:simsun;line-height:21px;background-color:rgb(188,211,229);"></span> 
<span style="color:rgb(51,51,51);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(255,255,255);"></span> 
<div style="width:586px;border:1px solid rgb(204,204,204);background-color:rgb(249,249,249);color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;font-size:12px;"> 
 <div> 
  <ol style="list-style:none;border:0px;"><li style="border:0px;line-height:1.8em;font-family:Monaco, Consolas, serif;">certmgr /c /add TrustedCert.cer /s root</li></ol> 
 </div> 
 <span style="margin-left:43px;color:rgb(102,102,102);">复制代码</span> 
</div> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">下面的命令将证书保存使用通用名称 myCert中将 my系统存储到文件中名为 newCert.cer</span> 
<span style="font-size:14px;color:rgb(70,70,70);font-family:simsun;line-height:21px;background-color:rgb(188,211,229);"></span> 
<span style="color:rgb(51,51,51);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(255,255,255);"></span> 
<div style="width:586px;border:1px solid rgb(204,204,204);background-color:rgb(249,249,249);color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;font-size:12px;"> 
 <div> 
  <ol style="list-style:none;border:0px;"><li style="border:0px;line-height:1.8em;font-family:Monaco, Consolas, serif;">certmgr /add /c /n myCert /s my newCert.cer</li></ol> 
 </div> 
 <span style="margin-left:43px;color:rgb(102,102,102);">复制代码</span> 
</div> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">下面的命令删除 my 系统存储区中的所有 CTL，并将结果存储区保存到一个名为 newStore.str 的文件中。</span> 
<span style="font-size:14px;color:rgb(70,70,70);font-family:simsun;line-height:21px;background-color:rgb(188,211,229);"></span> 
<span style="color:rgb(51,51,51);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(255,255,255);"></span> 
<div style="width:586px;border:1px solid rgb(204,204,204);background-color:rgb(249,249,249);color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;font-size:12px;"> 
 <div> 
  <ol style="list-style:none;border:0px;"><li style="border:0px;line-height:1.8em;font-family:Monaco, Consolas, serif;">certmgr /del /all /ctl /s my newStore.str</li></ol> 
 </div> 
 <span style="margin-left:43px;color:rgb(102,102,102);">复制代码</span> 
</div> 
<span style="color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;background-color:rgb(249,249,249);font-size:12px;">下面的命令将证书保存在 my文件中存储系统 newFile 系统将提示您输入证书编号从 my放 newFile</span> 
<span style="font-size:14px;color:rgb(70,70,70);font-family:simsun;line-height:21px;background-color:rgb(188,211,229);"></span> 
<span style="color:rgb(51,51,51);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(255,255,255);"></span> 
<div style="width:586px;border:1px solid rgb(204,204,204);background-color:rgb(249,249,249);color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;font-size:12px;"> 
 <div> 
  <ol style="list-style:none;border:0px;"><li style="border:0px;line-height:1.8em;font-family:Monaco, Consolas, serif;">certmgr /put /c /s my newFile</li></ol> 
 </div> 
 <span style="margin-left:43px;color:rgb(102,102,102);">复制代码</span> 
</div> 
<div style="width:586px;border:1px solid rgb(204,204,204);background-color:rgb(249,249,249);color:rgb(68,68,68);font-family:Verdana, Helvetica, Arial, sans-serif;font-size:12px;"> 
 <span style="margin-left:43px;color:rgb(102,102,102);"><br></span> 
</div> 
<p></p> 
<p>----------------------------------------------------------------------------------------------------------------------------</p> 
<p></p> 
<p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';background-color:rgb(255,255,255);"><span style="color:rgb(153,0,0);font-family:verdana, Arial, helvetica, 'sans-seriff';background-color:rgb(255,255,255);"><span style="font-size:18px;">certutil 简介</span></span><br></p> 
<p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:12px;background-color:rgb(255,255,255);">这测试环境是Win7,如果你是WinXP还得看别的操作。具体请参照:</p> 
<p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:12px;background-color:rgb(255,255,255);">如何将第三方证书颁发机构 (CA) 的证书导入 Enterprise NTAuth 存储</p> 
<p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:12px;background-color:rgb(255,255,255);"><a href="http://support.microsoft.com/kb/295663" rel="nofollow" style="color:rgb(111,188,76);">http://support.microsoft.com/kb/295663</a></p> 
<p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:12px;background-color:rgb(255,255,255);">方法 2：使用 Certutil.exe 导入证书</p> 
<p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:12px;background-color:rgb(255,255,255);">Certutil.exe 是一个用于管理 Windows CA 的命令行实用程序。在 Windows Server 2003 中，您可以使用 Certutil.exe 将证书发布到 Active Directory。Certutil.exe 与 Windows Server 2003 一起安装。它作为 Microsoft Windows Server 2003 管理工具包的一部分提供。要下载该工具包，请访问以下 Microsoft 网站：</p> 
<p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:12px;background-color:rgb(255,255,255);"><a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=c16ae515-c8f4-47ef-a1e4-a8dcbacff8e3&amp;amp;DisplayLang=en" rel="nofollow" style="color:rgb(111,188,76);">http://www.microsoft.com/downloads/details.aspx?FamilyID=c16ae515-c8f4-47ef-a1e4-a8dcbacff8e3&amp;amp;DisplayLang=en</a> (<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=c16ae515-c8f4-47ef-a1e4-a8dcbacff8e3&amp;DisplayLang=en" rel="nofollow" style="color:rgb(111,188,76);">http://www.microsoft.com/downloads/details.aspx?FamilyID=c16ae515-c8f4-47ef-a1e4-a8dcbacff8e3&amp;DisplayLang=en</a>) 要将 CA 证书导入 Enterprise NTAuth 存储，请按照以下步骤操作：</p> 
<p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:12px;background-color:rgb(255,255,255);">1将 CA 的证书导出到 .cer 文件。支持以下文件格式：</p> 
<p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:12px;background-color:rgb(255,255,255);">?DER 编码二进制 X.509 (.cer)</p> 
<p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:12px;background-color:rgb(255,255,255);">?Base64 编码 X.509 (.cer)</p> 
<p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:12px;background-color:rgb(255,255,255);">2.在命令提示符下键入下面的命令，然后按 Enter：</p> 
<p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:12px;background-color:rgb(255,255,255);">certutil -dspublish -f filename NTAuthCA</p> 
<p style="font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:12px;background-color:rgb(255,255,255);"><span style="color:#4b4b4b;">把证书加到 Trusted root 里去。</span><br><span style="color:#990000;">certutil -addstore root certroot.cer    （可用，且不会有警告框！）</span></p> 
<br>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/aaeb20c5bb93f51e862de6e38b7e3b51/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java调用cmd 命令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/281a889289885397355bc0c531733097/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">获取request里面所有的Parameter所有的请求参数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>