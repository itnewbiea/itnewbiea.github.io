<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>QT5.14 实现ModbusTCP客户端 Demo - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="QT5.14 实现ModbusTCP客户端 Demo" />
<meta property="og:description" content="本文在QT5.14平台，基于QModbusClientTcp类，实现了客户端对单个寄存器的读写，用ModbusSlave做服务器做测试。
1.界面
(1)更改读按钮的名称为bt_Read
(2)更改写按钮的名称为bt_Write
2.修改pro文件的第三行
greaterThan(QT_MAJOR_VERSION, 4): QT &#43;= widgets serialbus 3.修改mainWindow.h
#ifndef MAINWINDOW_H
#define MAINWINDOW_H
#include &lt;QMainWindow&gt;
#include &lt;QModbusTcpClient&gt;
QT_BEGIN_NAMESPACE
namespace Ui { class MainWindow; }
QT_END_NAMESPACE
class MainWindow : public QMainWindow
{
Q_OBJECT
public:
MainWindow(QWidget *parent = nullptr);
~MainWindow();
private slots:
void on_bt_Read_clicked();
void on_bt_Write_clicked();
void ReplyData();
private:
Ui::MainWindow *ui;
QModbusTcpClient *client;
};
#endif // MAINWINDOW_H
4.修改mainWindow.c
#include &#34;mainwindow.h&#34;
#include &#34;ui_mainwindow.h&#34;
MainWindow::MainWindow(QWidget *parent)
: QMainWindow(parent)
, ui(new Ui::MainWindow)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e285fe49d01940780dae4249b333844d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T14:55:32+08:00" />
<meta property="article:modified_time" content="2024-01-05T14:55:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">QT5.14 实现ModbusTCP客户端 Demo</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>本文在QT5.14平台，基于QModbusClientTcp类，实现了客户端对单个寄存器的读写，用ModbusSlave做服务器做测试。</p> 
<p><strong>1.界面</strong></p> 
<p><img alt="" height="153" src="https://images2.imgbox.com/d7/e2/Bv5rnvpZ_o.png" width="335"></p> 
<p><br> (1)更改读按钮的名称为bt_Read<br> (2)更改写按钮的名称为bt_Write</p> 
<p>2.修改pro文件的第三行<br> greaterThan(QT_MAJOR_VERSION, 4): QT += widgets  <span style="color:#4da8ee;"><strong>serialbus</strong></span> </p> 
<p>3.修改mainWindow.h<br> #ifndef MAINWINDOW_H<br> #define MAINWINDOW_H</p> 
<p>#include &lt;QMainWindow&gt;<br><span style="color:#4da8ee;"><strong>#include &lt;QModbusTcpClient&gt;</strong></span></p> 
<p>QT_BEGIN_NAMESPACE<br> namespace Ui { class MainWindow; }<br> QT_END_NAMESPACE</p> 
<p>class MainWindow : public QMainWindow<br> {<!-- --><br>     Q_OBJECT</p> 
<p>public:<br>     MainWindow(QWidget *parent = nullptr);<br>     ~MainWindow();</p> 
<p><br> private slots:<br>    <span style="color:#4da8ee;"><strong> void on_bt_Read_clicked();<br>     void on_bt_Write_clicked();<br>     void ReplyData();</strong></span></p> 
<p>private:<br>     Ui::MainWindow *ui;<br>    <span style="color:#4da8ee;"><strong> QModbusTcpClient *client;</strong></span><br> };<br> #endif // MAINWINDOW_H</p> 
<p><strong>4.修改mainWindow.c</strong><br> #include "mainwindow.h"<br> #include "ui_mainwindow.h"</p> 
<p>MainWindow::MainWindow(QWidget *parent)<br>     : QMainWindow(parent)<br>     , ui(new Ui::MainWindow)<br> {<!-- --><br>     ui-&gt;setupUi(this);<br>     this-&gt;<span style="color:#4da8ee;"><strong>setWindowTitle</strong></span>("ModbusTCPClient");<br>     client=new <span style="color:#4da8ee;"><strong>QModbusTcpClient</strong></span>(this);<br>     client-&gt;setConnectionParameter(QModbusDevice::<span style="color:#4da8ee;"><strong>NetworkAddressParameter</strong></span>,"127.0.0.1");<br>     client-&gt;setConnectionParameter(QModbusDevice::<span style="color:#4da8ee;"><strong>NetworkPortParameter</strong></span>,502);<br>     client-&gt;<span style="color:#4da8ee;"><strong>connectDevice</strong></span>();</p> 
<p>}</p> 
<p>MainWindow::~MainWindow()<br> {<!-- --><br>     if(client-&gt;state()==QModbusTcpClient::<span style="color:#4da8ee;"><strong>ConnectedState</strong></span>)<br>     {<!-- --><br>         client-&gt;<span style="color:#4da8ee;"><strong>disconnectDevice</strong></span>();<br>     }<br>     delete ui;<br> }</p> 
<p>void MainWindow::<span style="color:#4da8ee;"><strong>on_bt_Read_clicked()</strong></span><br> {<!-- --><br>     QModbusDataUnit unit(QModbusDataUnit::HoldingRegisters,500,1);<br>     unit.setValue(0,ui-&gt;textEdit-&gt;toPlainText().toInt());<br>     QModbusReply *reply=client-&gt;sendReadRequest(unit,1);<br>     if(reply)<br>     {<!-- --><br>         if(!reply-&gt;isFinished())<br>         {<!-- --><br>             connect(reply,&amp;QModbusReply::finished,this,&amp;MainWindow::ReplyData);<br>             return;<br>         }<br>     }<br>     reply-&gt;deleteLater();<br> }</p> 
<p>void MainWindow::<span style="color:#4da8ee;"><strong>on_bt_Write_clicked()</strong></span><br> {<!-- --><br>     QModbusDataUnit unit(QModbusDataUnit::HoldingRegisters,500,1);<br>     unit.setValue(0,ui-&gt;textEdit-&gt;toPlainText().toInt());<br>     QModbusReply *reply=client-&gt;sendWriteRequest(unit,1);<br>     if(reply)<br>     {<!-- --><br>         reply-&gt;deleteLater();<br>     }</p> 
<p>}<br>  void MainWindow::<span style="color:#4da8ee;"><strong>ReplyData()</strong></span><br>  {<!-- --><br>       QModbusReply *reply=(QModbusReply *)(sender());<br>        QModbusDataUnit unit=reply-&gt;result();<br>        reply-&gt;deleteLater();<br>        if(unit.valueCount()&gt;0)<br>        {<!-- --><br>            ui-&gt;textEdit-&gt;setText(QString::number(unit.value(0)));<br>        }<br>  }<br>  </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/23316c88c76d9ebc4a1234696a2f7cd9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">新手学编程必会的100个代码_初学编程100个代码</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/86ffa2efd4d5da9abaf6c7b1c3c5b51f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux中进入目录命令是什么?</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>