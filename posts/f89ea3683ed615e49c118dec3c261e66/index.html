<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>APP、PC客户端抓包、小程序\公众号 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="APP、PC客户端抓包、小程序\公众号" />
<meta property="og:description" content="APP、小程序、公众号抓包 一、APP抓包（一）BurpSuite抓取手机HTTP数据包1、配置代理IP与端口2、测试 （二）BurpSuite抓取手机HTTPS数据包1、安装证书2、测试 （三）抓不到包？1、原因2、解决思路3、解决过程 二、抓取PC端第三方软件数据包流程演示：1、安装证书2、搭建配置Proxifier3、测试 三、BurpSuite抓取微信小程序/公众号数据包流程演示：1、安装证书2、Proxifier搭建3、测试 一、APP抓包 （一）BurpSuite抓取手机HTTP数据包 思路：本地主机作为手机的代理服务器，手机APP发送的数据包会直接发给代理服务器，再由代理服务器进行转发。
准备工作：手机与本地主机连上同一wifi
1、配置代理IP与端口 查看主机IP
可以在主机使用win&#43;R调出运行框，输入命令cmd进入命令提示符界面，输入ipconfig查看IP：
查看手机IP是否正常配置
测试连通性
在手机上设置代理：
在BurpSuite设置拦截经过本地主机的数据包：
打开BurpSuite依次点击：Proxy - Options - Add 添加一个监听IP与端口（端口和IP与手机端添加的代理一致）
设置好了后，在“Proxy - Intercept 下开启“Intercept is on”就可以对安卓APP的网络数据进行抓包了
2、测试 手机端随便打开一个app，就会发现数据已经抓到，可以在HTTP history查看
（二）BurpSuite抓取手机HTTPS数据包 抓取HTTPS包需要导入Burp的证书。特别注意：一个Burp对应一个证书，就是用哪个Burp抓包就导出哪个的证书，并将该证书在手机上安装。
1、安装证书 有两种方法导出证书：
一是直接在BurpSuite导出证书，二是手机端直接访问代理服务器的IP加端口
方法一：
依次点击 Proxy - Options 选中代理项，点击import\export CA
选择第一个，然后点击Next
选择保存CA证书的路径，注意文件后缀命名为.cer，因为手机只能安装.cer的证书类型，默认的der格式是不能被识别安装的。
方法二：
手机访问代理服务器192.168.1.5:8888，点击CA Certificate 进行证书的下载
在手机端下载完证书后，依次点击 设置 - 安全 - 从SD卡安装
找到证书下载的位置点击进行安装
安装完成后可以在 设置 - 安全 - 信任的凭据 看到。
2、测试 随便打开一个APP或者用HTTPS协议访问任意网站
成功抓取到数据包
（三）抓不到包？ 参考文档 https://www." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/f89ea3683ed615e49c118dec3c261e66/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-31T09:28:04+08:00" />
<meta property="article:modified_time" content="2023-03-31T09:28:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">APP、PC客户端抓包、小程序\公众号</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>APP、小程序、公众号抓包</h4> 
 <ul><li><a href="#APP_1" rel="nofollow">一、APP抓包</a></li><li><ul><li><a href="#BurpSuiteHTTP_3" rel="nofollow">（一）BurpSuite抓取手机HTTP数据包</a></li><li><ul><li><a href="#1IP_9" rel="nofollow">1、配置代理IP与端口</a></li><li><a href="#2_25" rel="nofollow">2、测试</a></li></ul> 
   </li><li><a href="#BurpSuiteHTTPS_41" rel="nofollow">（二）BurpSuite抓取手机HTTPS数据包</a></li><li><ul><li><a href="#1_43" rel="nofollow">1、安装证书</a></li><li><a href="#2_66" rel="nofollow">2、测试</a></li></ul> 
   </li><li><a href="#_78" rel="nofollow">（三）抓不到包？</a></li><li><ul><li><a href="#1_81" rel="nofollow">1、原因</a></li><li><a href="#2_88" rel="nofollow">2、解决思路</a></li><li><a href="#3_94" rel="nofollow">3、解决过程</a></li></ul> 
  </li></ul> 
  </li><li><a href="#PC_130" rel="nofollow">二、抓取PC端第三方软件数据包</a></li><li><ul><li><a href="#_141" rel="nofollow">流程演示：</a></li><li><ul><li><a href="#1_142" rel="nofollow">1、安装证书</a></li><li><a href="#2Proxifier_147" rel="nofollow">2、搭建配置Proxifier</a></li><li><a href="#3_198" rel="nofollow">3、测试</a></li></ul> 
  </li></ul> 
  </li><li><a href="#BurpSuite_205" rel="nofollow">三、BurpSuite抓取微信小程序/公众号数据包</a></li><li><ul><li><a href="#_213" rel="nofollow">流程演示：</a></li><li><ul><li><a href="#1_215" rel="nofollow">1、安装证书</a></li><li><a href="#2Proxifier_225" rel="nofollow">2、Proxifier搭建</a></li><li><a href="#3_260" rel="nofollow">3、测试</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="APP_1"></a>一、APP抓包</h2> 
<h3><a id="BurpSuiteHTTP_3"></a>（一）BurpSuite抓取手机HTTP数据包</h3> 
<p>思路：本地主机作为手机的代理服务器，手机APP发送的数据包会直接发给代理服务器，再由代理服务器进行转发。</p> 
<p>准备工作：手机与本地主机连上同一wifi</p> 
<h4><a id="1IP_9"></a>1、配置代理IP与端口</h4> 
<p>查看主机IP<br> 可以在主机使用win+R调出运行框，输入命令cmd进入命令提示符界面，输入ipconfig查看IP：<br> <img src="https://images2.imgbox.com/f4/9e/ufNXh3Lf_o.png" alt="在这里插入图片描述"><br> 查看手机IP是否正常配置<br> <img src="https://images2.imgbox.com/7b/1f/fqnQ5klj_o.png" alt="在这里插入图片描述"><br> 测试连通性<br> <img src="https://images2.imgbox.com/d7/a1/MwA3ZyLm_o.png" alt="在这里插入图片描述"><br> 在手机上设置代理：<br> <img src="https://images2.imgbox.com/d3/3a/6Mx1QlkA_o.png" alt="在这里插入图片描述"><br> 在BurpSuite设置拦截经过本地主机的数据包：<br> 打开BurpSuite依次点击：Proxy - Options - Add 添加一个监听IP与端口（端口和IP与手机端添加的代理一致）<br> <img src="https://images2.imgbox.com/69/90/KxpPC9rq_o.png" alt="在这里插入图片描述"><br> 设置好了后，在“Proxy - Intercept 下开启“Intercept is on”就可以对安卓APP的网络数据进行抓包了<br> <img src="https://images2.imgbox.com/c2/48/GJZPTG10_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_25"></a>2、测试</h4> 
<p>手机端随便打开一个app，就会发现数据已经抓到，可以在HTTP history查看<br> <img src="https://images2.imgbox.com/8b/7b/BsNGB6Pw_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/20/12/k68vCUg1_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="BurpSuiteHTTPS_41"></a>（二）BurpSuite抓取手机HTTPS数据包</h3> 
<p>抓取HTTPS包需要导入Burp的证书。特别注意：一个Burp对应一个证书，就是用哪个Burp抓包就导出哪个的证书，并将该证书在手机上安装。</p> 
<h4><a id="1_43"></a>1、安装证书</h4> 
<p>有两种方法导出证书：<br> 一是直接在BurpSuite导出证书，二是手机端直接访问代理服务器的IP加端口<br> 方法一：<br> 依次点击 Proxy - Options 选中代理项，点击import\export CA<br> <img src="https://images2.imgbox.com/db/2a/kRTx2MAE_o.png" alt="在这里插入图片描述"><br> 选择第一个，然后点击Next<br> <img src="https://images2.imgbox.com/62/fa/kmxqjtca_o.png" alt="在这里插入图片描述"><br> 选择保存CA证书的路径，注意文件后缀命名为.cer，因为手机只能安装.cer的证书类型，默认的der格式是不能被识别安装的。<br> <img src="https://images2.imgbox.com/63/d6/gTaTawsE_o.png" alt="在这里插入图片描述"><br> 方法二：<br> 手机访问代理服务器192.168.1.5:8888，点击CA Certificate 进行证书的下载<br> <img src="https://images2.imgbox.com/c6/7a/6HQ9YuPD_o.png" alt="在这里插入图片描述"><br> 在手机端下载完证书后，依次点击 设置 - 安全 - 从SD卡安装<br> <img src="https://images2.imgbox.com/93/6b/pYoWNfIK_o.png" alt="在这里插入图片描述"><br> 找到证书下载的位置点击进行安装<br> <img src="https://images2.imgbox.com/0f/54/fpcRerVZ_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/66/dd/qn3iR2PF_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8c/59/nQr0aTPh_o.png" alt="在这里插入图片描述"><br> 安装完成后可以在 设置 - 安全 - 信任的凭据 看到。<br> <img src="https://images2.imgbox.com/9d/81/iz1ui2pE_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_66"></a>2、测试</h4> 
<p>随便打开一个APP或者用HTTPS协议访问任意网站<br> <img src="https://images2.imgbox.com/70/a6/GKZ2vJVS_o.png" alt="在这里插入图片描述"></p> 
<p>成功抓取到数据包</p> 
<h3><a id="_78"></a>（三）抓不到包？</h3> 
<p><a href="https://www.cnblogs.com/NoId/p/16500110.html" rel="nofollow">参考文档 https://www.cnblogs.com/NoId/p/16500110.html</a></p> 
<h4><a id="1_81"></a>1、原因</h4> 
<blockquote> 
 <p>一般情况下手机在安装了BurpSuite的伪证书后，是可以抓大部分APP数据包的，但APP在安卓7.0或更高的系统下，无法抓取数据包，原因是从安卓7.0开始应用只会信任系统预装的CA证书，而不会信任用户安装的CA证书。</p> 
</blockquote> 
<blockquote> 
 <p>这种的情况下，一个解决方法就是使用低于7.0版本的安卓系统进行抓包，另一个就是把使用的伪证书安装到系统证书目录中，伪装成系统证书。</p> 
</blockquote> 
<p>下面演示将使用的伪证书安装到系统证书目录中的方法和过程。此方法也适用于抓取微信小程序的数据包。</p> 
<h4><a id="2_88"></a>2、解决思路</h4> 
<blockquote> 
 <p>1 使用openssl将der证书转为pem证书，生成pem证书的hash，生成要使用的证书。</p> 
 <p>2 使用adb调试功能，将证书放到系统证书目录中。</p> 
</blockquote> 
<h4><a id="3_94"></a>3、解决过程</h4> 
<p>在安卓7.0或者更高的系统下，如果是只把burp证书装到了用户证书中，APP打开后无法正常使用<br> <img src="https://images2.imgbox.com/3a/ce/kSjoWOmV_o.png" alt="在这里插入图片描述"><br> 如下，APP加载不出来<br> <img src="https://images2.imgbox.com/5e/0a/iboXviAv_o.png" alt="在这里插入图片描述"></p> 
<p>在手机端导出证书（方法和前面一样）<br> 打开kali终端，依次执行以下命令：<br> 将导出的证书转pem证书:</p> 
<blockquote> 
 <p>penssl x509 -inform der -in burp.der -out burp.pem</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/00/6b/27jKf7jy_o.png" alt="在这里插入图片描述"><br> 生成pem证书的hash：</p> 
<blockquote> 
 <p>openssl x509 -inform PEM -subject_hash_old -in burp.pem</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/fb/70/TyTaffjk_o.png" alt="在这里插入图片描述"></p> 
<p>重命名/复制证书： (将证书文件重命名为“Hash值.0”，如下)</p> 
<blockquote> 
 <p>cp burp.pem 9a5ba575.0</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/80/18/0gyeEbrq_o.png" alt="在这里插入图片描述"></p> 
<p>之后将证书文件导出，然后上传到手机端的 /system/security/cacerts/ 目录下<br> <img src="https://images2.imgbox.com/42/6f/LBhccj2E_o.png" alt="在这里插入图片描述"></p> 
<p>赋权：长按文件点击属性，下滑，点击权限，给证书文件644权限<br> <img src="https://images2.imgbox.com/17/e6/f6J2vzPE_o.png" alt="在这里插入图片描述"></p> 
<p>这样就可以正常抓包，正常使用APP内的内容<br> <img src="https://images2.imgbox.com/4c/94/b2MNVpgv_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="PC_130"></a>二、抓取PC端第三方软件数据包</h2> 
<p>PC客户端的第三方软件一般不支持代理，除了个别会在软件内设置有代理功能，如百度网盘<br> <img src="https://images2.imgbox.com/17/23/McPYjRLC_o.png" alt="在这里插入图片描述"><br> 所以要使用<strong>Proxifier</strong>工具，用于解决代理问题。<br> 关于Proxifier</p> 
<blockquote> 
 <p>Proxifier是一款功能非常强大的socks5客户端，可以让不支持通过代理服务器工作的网络程序能通过HTTPS或SOCKS代理或代理链。<br> 由于一般的C/S客户端不能设置代理，所以我们FIddler检测不到数据，我们可以通过Proxifer来实现把所有的请求抓发给Fiddler，这样我们就可以在Fiddler分析客户端请求。</p> 
</blockquote> 
<p>思路：<br> 使用proxifier添加一台代理服务器，这里是本地主机作为代理服务器，数据包会先经过本地主机，然后使用BurpSuite监听或拦截经过主机的数据。</p> 
<h3><a id="_141"></a>流程演示：</h3> 
<h4><a id="1_142"></a>1、安装证书</h4> 
<p>首先跟前面手机APP抓包一样，导出证书到本地主机，将导出的证书在本地主机进行安装。<br> <img src="https://images2.imgbox.com/4b/8c/pVIyC7Tj_o.png" alt="在这里插入图片描述"><br> 一路点击下一步到结束，将证书成功安装。</p> 
<h4><a id="2Proxifier_147"></a>2、搭建配置Proxifier</h4> 
<p>①为proxifier添加代理服务器</p> 
<p>打开proxifier，点击 配置文件 - 配置代理服务器<br> <img src="https://images2.imgbox.com/65/22/aqqFX0xy_o.png" alt="在这里插入图片描述"></p> 
<p>添加代理服务器<br> <img src="https://images2.imgbox.com/1c/08/O1UDvVFO_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8e/0a/GMraRoK5_o.png" alt="在这里插入图片描述"></p> 
<p>②打开任务管理器，选择客户端进程，找到所在程序目录<br> <img src="https://images2.imgbox.com/16/46/N5g6P2HS_o.png" alt="在这里插入图片描述"></p> 
<p>复制该程序的路径<br> <img src="https://images2.imgbox.com/86/05/PLiVmHBC_o.png" alt="在这里插入图片描述"></p> 
<p>③配置代理规则<br> 点击 选择配置文件 - 配置代理规则<br> <img src="https://images2.imgbox.com/86/67/kzE9b7ys_o.png" alt="在这里插入图片描述"></p> 
<p>将默认规则勾选为Direct，然后点击添加<br> <img src="https://images2.imgbox.com/f4/8f/Ip8IHE34_o.png" alt="在这里插入图片描述"><br> Direct表示数据包直接通过，也可以设置代理，走代理服务器<br> <img src="https://images2.imgbox.com/a7/be/EyYUPzNW_o.png" alt="在这里插入图片描述"></p> 
<p>点击浏览，找到复制的路径所在的目录，选择程序<br> <img src="https://images2.imgbox.com/7e/7b/64bgJGcb_o.png" alt="在这里插入图片描述"></p> 
<p>最后选择代理拦截<br> <img src="https://images2.imgbox.com/14/80/CzNBmD1q_o.png" alt="在这里插入图片描述"></p> 
<p>④启动代理支持<br> 依次点击 高级 - HTTP代理服务器<br> <img src="https://images2.imgbox.com/4f/5d/Z8xADorO_o.png" alt="在这里插入图片描述"></p> 
<p>勾选 启用HTTP代理服务器支持 功能<br> <img src="https://images2.imgbox.com/78/ab/Znwiw2iK_o.png" alt="在这里插入图片描述"></p> 
<p>重新勾选BurpSuite代理选项，就可以抓包了</p> 
<h4><a id="3_198"></a>3、测试</h4> 
<p>随便点击播放音乐<br> <img src="https://images2.imgbox.com/1e/24/5R2qQSP3_o.png" alt="在这里插入图片描述"></p> 
<p>成功抓包<br> <img src="https://images2.imgbox.com/c2/79/HwOKX3mB_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="BurpSuite_205"></a>三、BurpSuite抓取微信小程序/公众号数据包</h2> 
<p><a href="https://blog.csdn.net/weixin_45031612/article/details/127416319">参考文档：https://blog.csdn.net/weixin_45031612/article/details/12741631</a></p> 
<p>抓取微信小程序/公众号的包需要抓取指定程序的包，可以在PC端登录微信，这样方便些，在PC端操作就要使用Proxifier工具，用于解决代理问题。</p> 
<p>下面以小程序抓包作为示例</p> 
<h3><a id="_213"></a>流程演示：</h3> 
<h4><a id="1_215"></a>1、安装证书</h4> 
<p>首先跟前面手机APP抓包一样，导出证书到本地主机，因为这次是微信小程序抓包，可以直接在本地主机登录微信进行抓包。<br> 将导出的证书在本地主机进行安装<br> <img src="https://images2.imgbox.com/5f/23/bJUEEqqa_o.png" alt="在这里插入图片描述"></p> 
<p>一路点击下一步到结束，将证书成功安装。</p> 
<h4><a id="2Proxifier_225"></a>2、Proxifier搭建</h4> 
<p>①添加代理服务器<br> 打开proxifier，点击 配置文件 - 配置代理服务器</p> 
<p><img src="https://images2.imgbox.com/18/a7/LkM2iDiN_o.png" alt="在这里插入图片描述"></p> 
<p>添加代理服务器<br> <img src="https://images2.imgbox.com/08/11/jbR0NgWy_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e3/d8/8ECK6fqw_o.png" alt="在这里插入图片描述"></p> 
<p>②配置代理规则<br> 点击 选择配置文件 - 配置代理规则<br> <img src="https://images2.imgbox.com/6b/75/tmFImmTx_o.png" alt="在这里插入图片描述"></p> 
<p>将默认规则勾选为Direct<br> <img src="https://images2.imgbox.com/66/e0/YIvaij3a_o.png" alt="在这里插入图片描述"><br> 默认规则勾选为Direct是为了不影响除测试程序外的其它程序的正常上网。</p> 
<p>③打开任务管理器，选择小程序进程，找到所在程序目录<br> <img src="https://images2.imgbox.com/45/e5/0SLIvia8_o.png" alt="在这里插入图片描述"></p> 
<p>复制路径打开Proxifier添加代理规则，将微信的应用添加上，设置走刚刚添加的代理服务器<br> <img src="https://images2.imgbox.com/e8/01/wt5nH8jo_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a2/4f/uxWs2ct7_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3_260"></a>3、测试</h4> 
<p>打开任意一个小程序，成功抓取到数据包<br> <img src="https://images2.imgbox.com/0c/54/R4QnVBoi_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c765c7c467cac86a323bd05d7de02223/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【C】文件操作(fopen等函数)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/53ac3d399ab7cb9564a5f2ef4e19cbac/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Ubuntu 18.04 安装docker【亲测可用】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>