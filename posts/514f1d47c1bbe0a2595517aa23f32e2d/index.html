<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CMAKE---- 控制编译 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CMAKE---- 控制编译" />
<meta property="og:description" content="1.Introduction 根据CMKAE官网的介绍，主要是用来管理编译和单元测试。我们第一部分总结CMAKE如何进行管理编译的。
C M a k e i s a n o p e n − s o u r c e , c r o s s − p l a t f o r m f a m i l y o f t o o l s d e s i g n e d t o b u i l d , t e s t a n d p a c k a g e s o f t w a r e ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/514f1d47c1bbe0a2595517aa23f32e2d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-06T16:34:39+08:00" />
<meta property="article:modified_time" content="2023-03-06T16:34:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CMAKE---- 控制编译</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1Introduction_0"></a>1.Introduction</h2> 
<p>根据CMKAE官网的介绍，主要是用来管理编译和单元测试。我们第一部分总结CMAKE如何进行管理编译的。</p> 
<blockquote> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           C 
          
         
           M 
          
         
           a 
          
         
           k 
          
         
           e 
           
         
           i 
          
         
           s 
           
         
           a 
          
         
           n 
           
         
           o 
          
         
           p 
          
         
           e 
          
         
           n 
          
         
           − 
          
         
           s 
          
         
           o 
          
         
           u 
          
         
           r 
          
         
           c 
          
         
           e 
          
         
           , 
          
         
           c 
          
         
           r 
          
         
           o 
          
         
           s 
          
         
           s 
          
         
           − 
          
         
           p 
          
         
           l 
          
         
           a 
          
         
           t 
          
         
           f 
          
         
           o 
          
         
           r 
          
         
           m 
           
         
           f 
          
         
           a 
          
         
           m 
          
         
           i 
          
         
           l 
          
         
           y 
           
         
           o 
          
         
           f 
           
         
           t 
          
         
           o 
          
         
           o 
          
         
           l 
          
         
           s 
           
         
           d 
          
         
           e 
          
         
           s 
          
         
           i 
          
         
           g 
          
         
           n 
          
         
           e 
          
         
           d 
           
         
           t 
          
         
           o 
           
         
           b 
          
         
           u 
          
         
           i 
          
         
           l 
          
         
           d 
          
         
           , 
           
         
           t 
          
         
           e 
          
         
           s 
          
         
           t 
           
         
           a 
          
         
           n 
          
         
           d 
           
         
           p 
          
         
           a 
          
         
           c 
          
         
           k 
          
         
           a 
          
         
           g 
          
         
           e 
           
         
           s 
          
         
           o 
          
         
           f 
          
         
           t 
          
         
           w 
          
         
           a 
          
         
           r 
          
         
           e 
          
         
           . 
          
         
        
       
         \color {red}CMake \, is \, an \, open-source, cross-platform \, family \, of \, tools \, designed \, to \, build, \, test \, and \, package \, software. 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.109em; color: red;">CM</span><span class="mord mathnormal" style="margin-right: 0.0315em; color: red;">ak</span><span class="mord mathnormal" style="color: red;">e</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">i</span><span class="mord mathnormal" style="color: red;">s</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">an</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">o</span><span class="mord mathnormal" style="color: red;">p</span><span class="mord mathnormal" style="color: red;">e</span><span class="mord mathnormal" style="color: red;">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin" style="color: red;">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="color: red;">so</span><span class="mord mathnormal" style="color: red;">u</span><span class="mord mathnormal" style="color: red;">rce</span><span class="mpunct" style="color: red;">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">cross</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin" style="color: red;">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em; color: red;">pl</span><span class="mord mathnormal" style="color: red;">a</span><span class="mord mathnormal" style="color: red;">t</span><span class="mord mathnormal" style="margin-right: 0.1076em; color: red;">f</span><span class="mord mathnormal" style="margin-right: 0.0278em; color: red;">or</span><span class="mord mathnormal" style="color: red;">m</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em; color: red;">f</span><span class="mord mathnormal" style="color: red;">ami</span><span class="mord mathnormal" style="margin-right: 0.0197em; color: red;">l</span><span class="mord mathnormal" style="margin-right: 0.0359em; color: red;">y</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">o</span><span class="mord mathnormal" style="margin-right: 0.1076em; color: red;">f</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">t</span><span class="mord mathnormal" style="color: red;">oo</span><span class="mord mathnormal" style="margin-right: 0.0197em; color: red;">l</span><span class="mord mathnormal" style="color: red;">s</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">d</span><span class="mord mathnormal" style="color: red;">es</span><span class="mord mathnormal" style="color: red;">i</span><span class="mord mathnormal" style="margin-right: 0.0359em; color: red;">g</span><span class="mord mathnormal" style="color: red;">n</span><span class="mord mathnormal" style="color: red;">e</span><span class="mord mathnormal" style="color: red;">d</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">t</span><span class="mord mathnormal" style="color: red;">o</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">b</span><span class="mord mathnormal" style="color: red;">u</span><span class="mord mathnormal" style="color: red;">i</span><span class="mord mathnormal" style="margin-right: 0.0197em; color: red;">l</span><span class="mord mathnormal" style="color: red;">d</span><span class="mpunct" style="color: red;">,</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">t</span><span class="mord mathnormal" style="color: red;">es</span><span class="mord mathnormal" style="color: red;">t</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">an</span><span class="mord mathnormal" style="color: red;">d</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">p</span><span class="mord mathnormal" style="color: red;">a</span><span class="mord mathnormal" style="color: red;">c</span><span class="mord mathnormal" style="color: red;">ka</span><span class="mord mathnormal" style="margin-right: 0.0359em; color: red;">g</span><span class="mord mathnormal" style="color: red;">e</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">so</span><span class="mord mathnormal" style="margin-right: 0.1076em; color: red;">f</span><span class="mord mathnormal" style="margin-right: 0.0269em; color: red;">tw</span><span class="mord mathnormal" style="color: red;">a</span><span class="mord mathnormal" style="color: red;">re</span><span class="mord" style="color: red;">.</span></span></span></span></span> CMake is used to control the software compilation process using simple platform and compiler independent configuration files, and generate native makefiles and workspaces that can be used in the compiler environment of your choice.</p> 
</blockquote> 
<p>备注：如果没有实战过CMAKE的，建议先从实战这一节看，然后再从头开始看。</p> 
<h2><a id="2Background_5"></a>2.Background</h2> 
<p>既然是编译需要知道编译的过程，分为预编译-&gt;编译-&gt;链接。<br> 根据<a href="https://www.toptal.com/c-plus-plus/c-plus-plus-understanding-compilation" rel="nofollow">这篇文章</a>[1]</p> 
<blockquote> 
 <ol><li>在预编译过程时，将source files加载到translation 工具中，head files 根据sources files的需求加载，可能会被加载很多次。</li><li>在编译过程时，每个source files 生成机器语言.o文件</li><li>最后将这些.o文件进行链接，生成可执行文件或者库文件。</li></ol> 
</blockquote> 
<p>分析一下CMAKE的主要数据结构<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          p 
         
        
          r 
         
        
          o 
         
        
          j 
         
        
          e 
         
        
          c 
         
        
          t 
         
        
          : 
         
        
       
      
        \color {red}project: 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="color: red;">p</span><span class="mord mathnormal" style="color: red;">ro</span><span class="mord mathnormal" style="margin-right: 0.0572em; color: red;">j</span><span class="mord mathnormal" style="color: red;">ec</span><span class="mord mathnormal" style="color: red;">t</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: red;">:</span></span></span></span></span> <strong>管理一堆可执行文件和库文件，一个大的project下面可以有很多小的project。</strong><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          t 
         
        
          a 
         
        
          r 
         
        
          g 
         
        
          e 
         
        
          t 
         
        
          : 
         
        
       
      
        \color {red}target: 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="color: red;">t</span><span class="mord mathnormal" style="color: red;">a</span><span class="mord mathnormal" style="margin-right: 0.0278em; color: red;">r</span><span class="mord mathnormal" style="margin-right: 0.0359em; color: red;">g</span><span class="mord mathnormal" style="color: red;">e</span><span class="mord mathnormal" style="color: red;">t</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: red;">:</span></span></span></span></span> <strong>自然就是最后生成的可执行文件或者库文件了。</strong><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          s 
         
        
          o 
         
        
          u 
         
        
          r 
         
        
          c 
         
        
          e 
         
        
          s 
         
        
          : 
         
        
       
      
        \color {red}sources: 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="color: red;">so</span><span class="mord mathnormal" style="color: red;">u</span><span class="mord mathnormal" style="color: red;">rces</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: red;">:</span></span></span></span></span><strong>自然是生成这个target所需要的源文件，也就是各种.c,.cxx。</strong><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          d 
         
        
          i 
         
        
          r 
         
        
          e 
         
        
          c 
         
        
          t 
         
        
          o 
         
        
          r 
         
        
          i 
         
        
          e 
         
        
          s 
         
        
          : 
         
        
       
      
        \color {red}directories: 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="color: red;">d</span><span class="mord mathnormal" style="color: red;">i</span><span class="mord mathnormal" style="color: red;">rec</span><span class="mord mathnormal" style="color: red;">t</span><span class="mord mathnormal" style="margin-right: 0.0278em; color: red;">or</span><span class="mord mathnormal" style="color: red;">i</span><span class="mord mathnormal" style="color: red;">es</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: red;">:</span></span></span></span></span> <strong>链接的时候需要寻找对应的文件：所以.so, .a, .h这些文件的地址非常重要。</strong></p> 
<h2><a id="3CMAKE_18"></a>3.探究CMAKE</h2> 
<p>根据background这章，我们知道，<strong>生成一个target其实很简单啊，只要说清楚target需要哪些source file，需要哪些链接库，最后再把链接库和头文件的地址跟target说一下，不就ok了吗？</strong> 那么为什么一个项目的CMAKE有时候搞的这么复杂啊。</p> 
<h3><a id="31CMAKE_20"></a>3.1最基础的CMAKE项目</h3> 
<p>如果是一个最简单的项目，我们确实可以按照上面说的</p> 
<pre><code class="prism language-bash">cmake_minimum_required<span class="token punctuation">(</span>VERSION <span class="token number">3.13</span><span class="token punctuation">)</span>   <span class="token comment">#CMKAE版本设定</span>

project<span class="token punctuation">(</span>Tutorial VERSION <span class="token number">1.0</span><span class="token punctuation">)</span>    <span class="token comment"># 新建了一个项目</span>

add_executable<span class="token punctuation">(</span>Tutorial main.cxx <span class="token punctuation">)</span>  <span class="token comment"># 生成可执行文件</span>
target_link_libraries<span class="token punctuation">(</span>Tutorial lcm<span class="token punctuation">)</span>  <span class="token comment">#添加链接库</span>
target_link_directories<span class="token punctuation">(</span>Tutorial <span class="token string">"/usr/local/lib/"</span><span class="token punctuation">)</span>  <span class="token comment">#添加链接地址</span>
target_include_directories<span class="token punctuation">(</span>Tutorial PRIVATE        <span class="token comment">#添加include地址</span>
    <span class="token string">"/usr/local/include/lcm/"</span><span class="token punctuation">)</span>
</code></pre> 
<p><mark>注意事项：安装在标准位置的库，因为库已经在gcc的默认搜索位置，不需要再重复声明了</mark><br> 默认的link_directories，包括了标准库的安装位置和当前项目下生成的库位置<br> 默认的include_directories,包括gcc的默认搜索位置和CMAKE_CURRENT_SOURCE_DIR</p> 
<blockquote> 
 <p>/usr/lib/gcc/x86_64-redhat-linux/4.8.2/…/…/…/…/include/c++/4.8.2<br> /usr/lib/gcc/x86_64-redhat-linux/4.8.2/…/…/…/…/include/c++/4.8.2/x86_64-redhat-linux<br> /usr/lib/gcc/x86_64-redhat-linux/4.8.2/…/…/…/…/include/c++/4.8.2/backward<br> /usr/lib/gcc/x86_64-redhat-linux/4.8.2/include<br> /usr/local/include<br> /usr/include</p> 
</blockquote> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          分析这么写 
         
        
          c 
         
        
          m 
         
        
          a 
         
        
          k 
         
        
          e 
         
        
          繁琐的地方在哪里？ 
         
        
       
      
        \color {red} 分析这么写cmake繁琐的地方在哪里？ 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord cjk_fallback" style="color: red;">分析这么写</span><span class="mord mathnormal" style="color: red;">c</span><span class="mord mathnormal" style="margin-right: 0.0315em; color: red;">mak</span><span class="mord mathnormal" style="color: red;">e</span><span class="mord cjk_fallback" style="color: red;">繁琐的地方在哪里？</span></span></span></span></span><br> <strong>sources file 太多了。</strong><br> <strong>include_directories也很麻烦，尤其是source files太多，依赖的header file也很多的情况下</strong></p> 
<h3><a id="32__46"></a>3.2 应用场景</h3> 
<ul><li>调用第三方库<br> 先include_directories 和 link_directories 标记出所使用的库文件和相应头文件的位置。然后target_link_libraries</li></ul> 
<h3><a id="33_cmake_51"></a>3.3 使用cmake时的一些简化技巧</h3> 
<h3><a id="1source_files_52"></a>改进1：source files用库文件表示</h3> 
<p>使用动态链接库，将一些source file 模块化，并且可以让项目重用<br> 因为库也是一个target，所以和生成可执行文件没有任何区别。<br> <mark>项目就产生了层级关系，用一个CMakeLIsts.txt没办法完成了</mark><br> 需要在顶层cmakelists中对应add_directories，这样在project_binary_dir里面才会出现子文件夹，对应source 部分的子文件夹下的CMakeLists.txt才能编译。<strong>如果某一些文件夹和他的子目录都不需要编译生成target,那就不需要添加CMakeLists.txt</strong></p> 
<h3><a id="2source_files__57"></a>改进2：source files 化整为零</h3> 
<p>方法1：用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          t 
         
        
          a 
         
        
          r 
         
        
          g 
         
        
          e 
         
         
         
           t 
          
         
           s 
          
         
        
          o 
         
        
          u 
         
        
          r 
         
        
          c 
         
        
          e 
         
        
          s 
         
        
       
      
        \color {red}target_sources 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="color: red;">t</span><span class="mord mathnormal" style="color: red;">a</span><span class="mord mathnormal" style="margin-right: 0.0278em; color: red;">r</span><span class="mord mathnormal" style="margin-right: 0.0359em; color: red;">g</span><span class="mord mathnormal" style="color: red;">e</span><span class="mord" style="color: red;"><span class="mord mathnormal" style="color: red;">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: red;"><span class="mord mathnormal mtight" style="color: red;">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal" style="color: red;">o</span><span class="mord mathnormal" style="color: red;">u</span><span class="mord mathnormal" style="color: red;">rces</span></span></span></span></span>:将sources file分成多个子文件夹，在每个子文件夹中用target_sources进行添加，这样在顶层时，不需要一下子添加那么多sources file；<br> 方法2：使用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          F 
         
        
          I 
         
        
          L 
         
        
          E 
         
        
          ( 
         
        
          G 
         
        
          L 
         
        
          O 
         
        
          B 
          
        
          s 
         
        
          o 
         
        
          u 
         
        
          r 
         
        
          c 
         
        
          e 
         
        
          s 
         
        
          d 
         
        
          i 
         
        
          r 
         
        
          ) 
         
        
       
      
        \color {red}FILE(GLOB \, sources dir) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em; color: red;">F</span><span class="mord mathnormal" style="margin-right: 0.0785em; color: red;">I</span><span class="mord mathnormal" style="color: red;">L</span><span class="mord mathnormal" style="margin-right: 0.0576em; color: red;">E</span><span class="mopen" style="color: red;">(</span><span class="mord mathnormal" style="color: red;">G</span><span class="mord mathnormal" style="color: red;">L</span><span class="mord mathnormal" style="margin-right: 0.0502em; color: red;">OB</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">so</span><span class="mord mathnormal" style="color: red;">u</span><span class="mord mathnormal" style="color: red;">rces</span><span class="mord mathnormal" style="color: red;">d</span><span class="mord mathnormal" style="color: red;">i</span><span class="mord mathnormal" style="margin-right: 0.0278em; color: red;">r</span><span class="mclose" style="color: red;">)</span></span></span></span></span> 或者是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          f 
         
        
          i 
         
        
          l 
         
        
          e 
         
        
          ( 
         
        
          G 
         
        
          L 
         
        
          O 
         
        
          B 
          
        
          R 
         
        
          E 
         
        
          C 
         
        
          U 
         
        
          R 
         
        
          S 
         
        
          E 
          
        
          s 
         
        
          o 
         
        
          u 
         
        
          r 
         
        
          c 
         
        
          e 
         
        
          s 
          
        
          d 
         
        
          i 
         
        
          r 
         
        
          ) 
         
        
       
      
        \color {red} file(GLOB \, RECURSE \, sources \, dir) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em; color: red;">f</span><span class="mord mathnormal" style="color: red;">i</span><span class="mord mathnormal" style="margin-right: 0.0197em; color: red;">l</span><span class="mord mathnormal" style="color: red;">e</span><span class="mopen" style="color: red;">(</span><span class="mord mathnormal" style="color: red;">G</span><span class="mord mathnormal" style="color: red;">L</span><span class="mord mathnormal" style="margin-right: 0.0502em; color: red;">OB</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em; color: red;">REC</span><span class="mord mathnormal" style="margin-right: 0.109em; color: red;">U</span><span class="mord mathnormal" style="margin-right: 0.0576em; color: red;">RSE</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">so</span><span class="mord mathnormal" style="color: red;">u</span><span class="mord mathnormal" style="color: red;">rces</span><span class="mspace" style="color: red; margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">d</span><span class="mord mathnormal" style="color: red;">i</span><span class="mord mathnormal" style="margin-right: 0.0278em; color: red;">r</span><span class="mclose" style="color: red;">)</span></span></span></span></span> 如果真的是sources files多到头皮发麻，实在是不想一个个写，用这种方法。</p> 
<h3><a id="3include_directoriesusage_requirements_60"></a>改进3：include_directories用usage requirements</h3> 
<p>header files经常被重复使用，这里cmake借鉴了面向对象的思想，通过target_include_directories()添加PUBLIC, PRIVATE 或者INTERFACE在target之间进行共享</p> 
<h3><a id="4find__62"></a>改进4：用find_</h3> 
<p>有时候一些文件不知道放在什么地方了，尤其是在编译中生成的文件。<br> find_file, find_library_, find_path, find_program, 以及find_package</p> 
<h2><a id="_66"></a>高级功能</h2> 
<p>1.因为cmake可以做一些测试，可以定义一些函数，如果其他的CMAKE需要调用这些函数，就需要INCLUDE（头文件）<br> 2.条件编译：option，if endif， 可以用list数据结构<br> 3.export功能<br> 这方面目前连接的较少，后续再逐渐添加.<br> 4.设置g++11和gnu++11：<br> 错误提示：</p> 
<blockquote> 
 <p>#error This file requires compiler and library support for the ISO C++ 2011 standard. This support must be enabled with the -std=c++11 or -std=gnu++11 compiler options.</p> 
</blockquote> 
<p>解决办法:在cmake中添加，<a href="https://blog.csdn.net/heroacool/article/details/50906151">参考[2]</a></p> 
<pre><code class="prism language-bash">include<span class="token punctuation">(</span>CheckCXXCompilerFlag<span class="token punctuation">)</span>
CHECK_CXX_COMPILER_FLAG<span class="token punctuation">(</span><span class="token string">"-std=c++11"</span> COMPILER_SUPPORTS_CXX11<span class="token punctuation">)</span>
CHECK_CXX_COMPILER_FLAG<span class="token punctuation">(</span><span class="token string">"-std=c++0x"</span> COMPILER_SUPPORTS_CXX0X<span class="token punctuation">)</span>
if<span class="token punctuation">(</span>COMPILER_SUPPORTS_CXX11<span class="token punctuation">)</span>
    set<span class="token punctuation">(</span>CMAKE_CXX_FLAGS <span class="token string">"<span class="token variable">${CMAKE_CXX_FLAGS}</span> -std=c++11"</span><span class="token punctuation">)</span>
elseif<span class="token punctuation">(</span>COMPILER_SUPPORTS_CXX0X<span class="token punctuation">)</span>
    set<span class="token punctuation">(</span>CMAKE_CXX_FLAGS <span class="token string">"<span class="token variable">${CMAKE_CXX_FLAGS}</span> -std=c++0x"</span><span class="token punctuation">)</span>
else<span class="token punctuation">(</span><span class="token punctuation">)</span>
        message<span class="token punctuation">(</span>STATUS <span class="token string">"The compiler <span class="token variable">${CMAKE_CXX_COMPILER}</span> has no C++11 support. Please use a different C++ compiler."</span><span class="token punctuation">)</span>
endif<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>5.设置config.cmake文件<br> 通过ubuntu apt install 的库，往往没有库对应的libconfig.cmake文件。</p> 
<pre><code class="prism language-CMakeLists.xtx">list(APPEND CMAKE_FIND_ROOT_PATH ${CMAKE_SOURCE_DIR})
find_package(NLOPT REQUIRED)
</code></pre> 
<p>文件的命名NLOPTConfig.cmake</p> 
<h2><a id="References_96"></a>References</h2> 
<p>[1] https://www.toptal.com/c-plus-plus/c-plus-plus-understanding-compilation<br> [2] https://blog.csdn.net/heroacool/article/details/50906151</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3f86da9f4eae66b5b3700197988b8704/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[Vue3] Wangeditor富文本实现将粘贴中包含的图片自动上传后台,并替换src</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0782b03c87e6135998e476aa7330639d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">22款常用微信小程序UI框架推荐！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>