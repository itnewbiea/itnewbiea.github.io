<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C&#43;&#43;——你所不知的 const &#43; &amp; - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C&#43;&#43;——你所不知的 const &#43; &amp;" />
<meta property="og:description" content="在我原先写过的《c&#43;&#43;——左值、右值、左值引用、右值引用》中有谈到引用。
简单来说，引用是参数的别名，不用额外开辟空间，节省开销。
举个例子：左值引用。
int _x = 0; int &amp;tmp = _x; 在C语言中，左值最初指的是可出现在赋值语句左边的实体，但这是引入关键字const之前的情况。
现在，常规变量和const变量都可视为左值，无非一个可修改，一个不可修改。
特殊点在于如下demo：
不同的是const &#43; &amp;可接收左值 和 右值。
int _x = 0; int &amp;tmp1 = _x; int &amp;tmp2 = 0; //错误 const int &amp;rvalue1 = _x; const int &amp;rvalue2 = 0; const &#43; &amp;的用处：
使用const可以避免无意中修改数据的编程错误使用const使函数能够处理const和非const实参，否则将只能接受非const数据使用const引用使函数能够正确生成并使用临时变量。 一、为何要返回引用
举个例子：
T &amp; test1(T &amp;x) { return x; } T test2(T &amp;x) { return x; } void main() { T x, x1, x2; x1 = test1(x); x2 = test2(x); } test1函数 和 test2函数区别在于 一个 ”&amp;”引用符号。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/0aefacdbaf213f22a2311ab0584c33d9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-12-10T11:04:54+08:00" />
<meta property="article:modified_time" content="2019-12-10T11:04:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C&#43;&#43;——你所不知的 const &#43; &amp;</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在我原先写过的《<a href="https://blog.csdn.net/u012198575/article/details/83142419">c++——左值、右值、左值引用、右值引用</a>》中有谈到引用。</p> 
<p>简单来说，引用是参数的别名，不用额外开辟空间，节省开销。</p> 
<p>举个例子：左值引用。</p> 
<pre class="has"><code class="language-cpp">int _x = 0;
int &amp;tmp = _x;</code></pre> 
<p>在C语言中，左值最初指的是可出现在赋值语句左边的实体，但这是引入关键字const之前的情况。</p> 
<p>现在，常规变量和const变量都可视为左值，无非一个可修改，一个不可修改。</p> 
<p>特殊点在于如下demo：</p> 
<p>不同的是const + &amp;可接收左值 和 右值。</p> 
<pre class="has"><code class="language-cpp">int _x = 0;
int &amp;tmp1 = _x;
int &amp;tmp2 = 0;    //错误
const int &amp;rvalue1 = _x;
const int &amp;rvalue2 = 0;
</code></pre> 
<p>const + &amp;的用处：</p> 
<ul><li>使用const可以避免无意中修改数据的编程错误</li><li>使用const使函数能够处理const和非const实参，否则将只能接受非const数据</li><li>使用const引用使函数能够正确生成并使用临时变量。</li></ul> 
<p>一、为何要返回引用</p> 
<p>举个例子：</p> 
<pre class="has"><code class="language-cpp">T &amp; test1(T &amp;x)
{
	return x;
}

T test2(T &amp;x)
{
	return x;

}</code></pre> 
<p> </p> 
<pre class="has"><code class="language-cpp">void main()
{
    T x, x1, x2;
    x1 = test1(x);
    x2 = test2(x);
}</code></pre> 
<p>test1函数 和 test2函数区别在于 一个 ”&amp;”引用符号。</p> 
<p>结果是：</p> 
<p>test1 和 test2都执行了赋值运算符函数</p> 
<p>而test2多执行了拷贝构造函数</p> 
<p>原因在于，在返回的时候,需要构造一个临时对象tmp（隐式的），将x的内容赋给tmp</p> 
<p>等价于T tmp(x)</p> 
<p>可见带有引用的返回节省了开销。</p> 
<p>二、返回引用需要注意的问题</p> 
<p>切记引用返回的值需要是形参的值，不要返回局部的值，否则局部变量返回出去，会调用析构函数，再下次调用的时候出现奔溃。</p> 
<p>三、为何将const用于引用返回类型</p> 
<p>首先看个demo ，operator[]返回值加上引用&amp;返回的是m_data[i]的数值，作为左值可以修改。</p> 
<p>但是如果加上 const 修饰， 导致 b[1] = 100 不可用。</p> 
<pre class="has"><code class="language-cpp">class B
{
public:
	B() { for_each(m_data, m_data + 10, [](int &amp;_data) {_data = 0; }); }
	int &amp; operator[](int i) { return m_data[i]; }
	void print() { for_each(m_data, m_data + 10, [](int _data) {cout &lt;&lt; _data &lt;&lt; endl; }); }
private:
	int m_data[10];
};

void main()
{
    B b;
    b.print();
    b[1] = 100;
    b.print();
    system("pause");
}</code></pre> 
<p>也就意味着加上const 修饰 返回的是右值不可修改。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/53a42b644094f5285d722b0a9eda0149/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">案例干货！如何构建物流行业的数据分析模型？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9a58b48c07720cee961ee8f0ca7e3fc9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">js监听多个input type=radio的按钮</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>