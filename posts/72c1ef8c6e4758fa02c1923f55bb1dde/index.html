<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于OpenCV4.1.0实现静态图片人脸检测 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于OpenCV4.1.0实现静态图片人脸检测" />
<meta property="og:description" content="摘要：今天花了一天的时间完成了静态图片中的人脸检测，这是对计算机视觉的第一次直观体验，颇有成就感。这篇文章详细的解释了源程序每一行语句的作用，主要还是理清自己大脑的思路。话不多说，直接开撸！ 源代码 注：本文所用开发环境为VS2019 Community &#43; OpenCV4.1.0，需提前配置好环境，如需帮助，请关注公众号【极客熊猫】，看我的第一篇推文。
//FaceRec.cpp #include&lt;opencv2/opencv.hpp&gt; //#include&lt;opencv2/objdetect/objdetect.hpp&gt; //#include&lt;opencv2/highgui/highgui.hpp&gt; //#include&lt;opencv2/imgproc/imgproc.hpp&gt; #include &lt;opencv2\imgproc\types_c.h&gt; using namespace std; using namespace cv; CascadeClassifier faceCascade; //人脸检测的类 int main() { faceCascade.load(&#34;D:/openCV/opencv/sources/data/haarcascades/haarcascade_frontalface_alt2.xml&#34;); //加载分类器，注意文件路径 Mat img = imread(&#34;3ming.jpg&#34;); //图片放在与FaceRec.cpp同级目录中 Mat imgGray; vector&lt;Rect&gt; faces; if (img.empty()) { return 1; } if (img.channels() == 3) { cvtColor(img, imgGray, CV_RGB2GRAY); } else { imgGray = img; } faceCascade.detectMultiScale(imgGray, faces, 1.2, 6, 0, Size(0, 0)); //检测人脸 if (faces.size() &gt; 0) { for (int i = 0; i &lt; faces." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/72c1ef8c6e4758fa02c1923f55bb1dde/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-07-30T16:57:01+08:00" />
<meta property="article:modified_time" content="2019-07-30T16:57:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于OpenCV4.1.0实现静态图片人脸检测</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>摘要：今天花了一天的时间完成了静态图片中的人脸检测，这是对计算机视觉的第一次直观体验，颇有成就感。这篇文章详细的解释了源程序每一行语句的作用，主要还是理清自己大脑的思路。话不多说，直接开撸！ 
 </p> 
<h2><a id="_2"></a>源代码</h2> 
<blockquote> 
 <p>注：本文所用开发环境为VS2019 Community + OpenCV4.1.0，需提前配置好环境，如需帮助，请关注公众号【极客熊猫】，看我的第一篇推文。</p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token comment">//FaceRec.cpp</span>

<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;opencv2/opencv.hpp&gt;</span></span>
<span class="token comment">//#include&lt;opencv2/objdetect/objdetect.hpp&gt;</span>
<span class="token comment">//#include&lt;opencv2/highgui/highgui.hpp&gt;</span>
<span class="token comment">//#include&lt;opencv2/imgproc/imgproc.hpp&gt;</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;opencv2\imgproc\types_c.h&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> cv<span class="token punctuation">;</span>

CascadeClassifier faceCascade<span class="token punctuation">;</span>                  <span class="token comment">//人脸检测的类</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>     faceCascade<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">"D:/openCV/opencv/sources/data/haarcascades/haarcascade_frontalface_alt2.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//加载分类器，注意文件路径</span>

	Mat img <span class="token operator">=</span> <span class="token function">imread</span><span class="token punctuation">(</span><span class="token string">"3ming.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//图片放在与FaceRec.cpp同级目录中</span>
	Mat imgGray<span class="token punctuation">;</span>
	vector<span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span> faces<span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>img<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>img<span class="token punctuation">.</span><span class="token function">channels</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">cvtColor</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> imgGray<span class="token punctuation">,</span> CV_RGB2GRAY<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		imgGray <span class="token operator">=</span> img<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	faceCascade<span class="token punctuation">.</span><span class="token function">detectMultiScale</span><span class="token punctuation">(</span>imgGray<span class="token punctuation">,</span> faces<span class="token punctuation">,</span> <span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">Size</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//检测人脸</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>faces<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> faces<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">rectangle</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token function">Point</span><span class="token punctuation">(</span>faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Point</span><span class="token punctuation">(</span>faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">+</span> faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>width<span class="token punctuation">,</span> faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">+</span> faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token function">Scalar</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//框出人脸位置</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token function">imshow</span><span class="token punctuation">(</span><span class="token string">"FacesOf3ming"</span><span class="token punctuation">,</span> img<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">waitKey</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>注：本例用的明家三兄弟的照片。最好找正脸的照片，放在FaceRec.cpp同级目下即可，代码中的图片名换成自己的。</p> 
</blockquote> 
<h2><a id="_61"></a>代码详细解析</h2> 
<h3><a id="_63"></a>头文件部分</h3> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;opencv2/opencv.hpp&gt;</span></span>
<span class="token comment">//#include&lt;opencv2/objdetect/objdetect.hpp&gt;</span>
<span class="token comment">//#include&lt;opencv2/highgui/highgui.hpp&gt;</span>
<span class="token comment">//#include&lt;opencv2/imgproc/imgproc.hpp&gt;</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;opencv2\imgproc\types_c.h&gt;</span></span>
</code></pre> 
<p>找到OpenCV的安装目录，打开<code>D:\openCV\opencv\sources\include\opencv2</code>，会看到<code>opencv.hpp</code>文件，我们用记事本打开它，可以发现里边包含了很多OpenCV的头文件，我们注释掉的三个头文件也包含于内。所以我们可以用<code>#include&lt;opencv2/opencv.hpp&gt;</code>一句代替下边注释掉的三行头文件，有效简化代码。而最后的<code>#include &lt;opencv2\imgproc\types_c.h&gt;</code>位于<code>D:\openCV\opencv\build\include\opencv2\imgproc</code>内，不包含在<code>opencv.hpp</code>之内，所以这句<code>#include &lt;opencv2\imgproc\types_c.h&gt;</code>要加上。那么为什么用到了这些头文件呢？</p> 
<blockquote> 
 <p>1.把<code>#include &lt;opencv2\imgproc\types_c.h&gt;</code>注释掉后，会提示<strong>未定义标识符"CV_RGB2GRAY"</strong>，估计该标志符位于<code>&lt;opencv2\imgproc\types_c.h&gt;</code>这个头文件。</p> 
 <p>2.跟1同样的方法，<code>cvtColor()</code>函数和<code>Rectangl()</code>函数应该位于<code>&lt;opencv2/imgproc/imgproc.hpp&gt;</code>。</p> 
 <p>3.同上，<code>imread()</code>，<code>imshow()</code>，<code>waitkey()</code>位于<code>&lt;opencv2/highgui/highgui.hpp&gt;</code>。</p> 
 <p>4.同上，<code>CascadeClassifier</code>类应该位于<code>&lt;opencv2/objdetect/objdetect.hpp&gt;</code>。</p> 
</blockquote> 
<h3><a id="_83"></a>命名空间部分</h3> 
<pre><code class="prism language-cpp"><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> cv<span class="token punctuation">;</span>
</code></pre> 
<p><code>using namespace std;</code>不用多说，C++标准程序库的所有标识符都被声明在<code>std</code>命名空间内，经常用到的<code>cin</code>、<code>cout</code>、<code>endl</code>等标识符皆如此，所以基本上所有的C++程序都有这句指令。而本段函数中的<code>vector</code>标识符就属于<code>std</code>命名空间，故有此指令。</p> 
<p>对于<code>using namespace cv;</code>，<a href="https://docs.opencv.org/4.1.0/d1/dfb/intro.html" rel="nofollow">OpenCV官方文档</a>如是说：All the OpenCV classes and functions are placed into the <code>cv</code> namespace. Therefore, to access this functionality from your code, use the <code>cv::</code> specifier or <code>using namespace cv;</code> directive. (翻译：所有的OpenCV类和函数都放在<code>cv</code>命名空间中。因此，要从代码中访问此功能，请使用说明<code>cv::</code>符或<code>using namespace cv;</code>指令)，故有此指令。</p> 
<h3><a id="CascadeClassifier_94"></a>级联分类器类CascadeClassifier</h3> 
<pre><code class="prism language-cpp">CascadeClassifier faceCascade<span class="token punctuation">;</span>  <span class="token comment">//定义一个CascadeClassifier类的对象faceCascade</span>
</code></pre> 
<p>CascadeClassifier：Cascade classifier class for object detection（用于目标检测的级联分类器类）。也就是说，CascadeClassifier是一个<strong>类</strong>。那么什么是<strong>级联分类器类</strong>呢？</p> 
<blockquote> 
 <p><strong>理解级联分类器</strong></p> 
 <p>分类器： 判别某个事物是否属于某种分类的器件。它有两种结果：<strong>是</strong>、<strong>否</strong> 。<br> 级联分类器： 可以理解为将N个单类的分类器串联起来。如果一个事物能属于这一系列串联起来的的所有分类器，则最终结果就为<strong>是</strong>，若有一项不符，则判定为<strong>否</strong>。</p> 
 <p>比如人脸，它有很多属性，我们将每个属性做一成个分类器，如果一个模型符合了我们定义的人脸的所有属性，则我们人为这个模型就是一个人脸。那么这些属性是指什么呢？ 比如人脸需要有两条眉毛，两只眼睛，一个鼻子，一张嘴，一个大概U形状的下巴或者是轮廓等等。</p> 
 <p>（引用自arvik的博文<a href="https://blog.csdn.net/u012819339/article/details/82493699">opencv类简单分析： CascadeClassifier</a>）</p> 
</blockquote> 
<h3><a id="_111"></a>主函数部分</h3> 
<pre><code class="prism language-cpp">faceCascade<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">"D:/openCV/opencv/sources/data/haarcascades/haarcascade_frontalface_alt2.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//加载分类器，注意文件路径</span>

Mat img <span class="token operator">=</span> <span class="token function">imread</span><span class="token punctuation">(</span><span class="token string">"3ming.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//图片放在与FaceRec.cpp同级目录中</span>
Mat imgGray<span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span> faces<span class="token punctuation">;</span>
</code></pre> 
<ul><li> <p><code>faceCascade.load("D:/openCV/opencv/sources/data/haarcascades/haarcascade_frontalface_alt2.xml");</code></p> <p>调用对象<code>faceCascade</code>的<code>load()</code>函数，其参数为<code>.xml</code>文件的绝对路径。</p> <p><code>load()</code>函数的作用是通过load一个xml文件来初始化对象<code>faceCascade</code>。<code>.xml</code>是一些分类器的格式，我们这里用到的<code>haarcascade_frontalface_alt2.xml</code>是OpenCV内置的已经训练好的诸多分类器中的一个，它的作用是<strong>Haar特征</strong>人脸检测。</p> 
  <blockquote> 
   <p>.xml的路径要写正确，严格按照上面的格式。电脑上复制路径是右斜杠’\’，但在程序里要用左斜杠’/’。</p> 
  </blockquote> </li><li> <p><code>Mat img = imread("3ming.jpg");</code></p> <p>定义一个<code>Mat</code>类的对象<code>img</code>，并用<code>imread()</code>函数加载指定文件<code>3ming.jpg</code>赋值给对象<code>img</code>。</p> <p><code>Mat</code>是一个<strong>类</strong>：OpenCV库C++实现的核心类。</p> <p><code>Mat</code> 类由两个数据部分组成：矩阵头（包含矩阵尺寸，存储方法，存储地址等信息）和一个指向存储所有像素值的矩阵（根据所选存储方法的不同矩阵可以是不同的维数）的指针。</p> <p><code>Mat</code> 类首先要知道的是不必再手动（1）为其开辟空间（2）在不需要时立即将空间释放。即<strong>自动内存管理。</strong></p> <p><code>imread()</code>函数的功能是载入一张图片，参数为图片的路径。</p> </li><li> <p><code>Mat imgGray;</code></p> <p>定义一个<code>Mat</code>类的对象<code>imgGray</code>。</p> </li><li> <p><code>vector&lt;Rect&gt; faces;</code></p> <p>用<code>vector</code>定义一个元素类型为<code>Rect</code>类的动态数组<code>faces</code>。</p> <p><code>vector</code>是C++标准库提供的被封装的动态数组，它不是一个类，而是一个<strong>类模板</strong>。用<code>vector</code>定义的数组对象的所有元素都会被初始化。如果数组元素为基本类型，则以初始化；<strong>如果数组元素为类类型，则调用默认构造函数初始化</strong>。此处，数组元素为<strong>Rect类</strong>类型，故将调用Rect类的默认构造函数初始化数组。</p> <p><strong>Rect类</strong>，矩形类。它有四个公共属性，<code>Rect(int_x,int_y,int_width,int_height)</code>，(x,y)为左上角顶点的坐标，width为宽度，height为高度。</p> </li></ul> 
<pre><code class="prism language-c++">if (img.empty())   {return 1;}
</code></pre> 
<p>调用<code>Mat</code>类对象<code>img</code>的成员函数<code>empty()</code>来检查<code>3ming.jpg</code>是否载入成功，如成功，则返回1。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>img<span class="token punctuation">.</span><span class="token function">channels</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>  <span class="token punctuation">{<!-- --></span><span class="token function">cvtColor</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> imgGray<span class="token punctuation">,</span> CV_RGB2GRAY<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token keyword">else</span>  <span class="token punctuation">{<!-- --></span>imgGray <span class="token operator">=</span> img<span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre> 
<p>调用<code>Mat</code>类对象<code>img</code>的成员函数<code>channels()</code>,其会返回矩阵通道的数量。如果矩阵通道数量为3，则调用<code>cvtColor()</code>函数，将输入的<code>img</code>从转换为<code>imgGray</code>输出，转换模式为<code>CV_RGB2GRAY</code>，即将3通道的彩色影像转换为灰度图输出；如果矩阵通道不为3，则直接将<code>img</code>赋给<code>imgGray</code>。</p> 
<p><code>cvtColor()</code>函数：Opencv里的颜色空间转换函数，可以实现RGB颜色向HSV,HSI等颜色空间的转换，也可以转换为灰度图。第一个参数为输入，第二个参数为输出，第三个参数为转换模式。那么为什么将RGB图像转为灰度图呢？</p> 
<blockquote> 
 <p>1.三通道转为单通道后，运算量大大减少。</p> 
 <p>2.自然界中，颜色本身非常容易受到光照的影响，RGB变化很大，反而梯度信息能提供更本质的信息。</p> 
 <p>3.Opencv的很多函数只支持单通道。</p> 
</blockquote> 
<pre><code class="prism language-cpp">	faceCascade<span class="token punctuation">.</span><span class="token function">detectMultiScale</span><span class="token punctuation">(</span>imgGray<span class="token punctuation">,</span> faces<span class="token punctuation">,</span> <span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">Size</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>调用<code>CascadeClassifier</code>类对象<code>faceCascade</code>的成员函数<code>detectMultiScale()</code>，对输入的灰度图<code>imgGray</code>进行检测，将检测到的人脸的矩形框向量组存入<code>faces</code>，尺度参数为<strong>1.2</strong>，每一个目标至少要被检测到<strong>6</strong>次才算是人脸，flag为<strong>0</strong>，最小可能的对象大小为<strong>Size(0,0)</strong>，小于该值的对象将被忽略。</p> 
<p><code>detectMultiScale()</code>函数：在输入的图片中检测不同大小的目标，检测到的目标作为矩形列表返回。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>faces<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> faces<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			<span class="token function">rectangle</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token function">Point</span><span class="token punctuation">(</span>faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Point</span><span class="token punctuation">(</span>faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">+</span> faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>width<span class="token punctuation">,</span> faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">+</span> faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token function">Scalar</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//框出人脸位置</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>调用数组元素为Rect类类型的动态数组<code>faces</code>的成员函数<code>size()</code>，如果<code>face.size()</code>大于0，即矩阵数组不为空，也就是说检测到目标了，则执行for循环，将检测到的目标框起来。</p> 
<blockquote> 
 <p><code>rectangle()</code>函数：绘制简单、指定粗细或带填充的矩形。</p> 
 <p><code>Rectangle( CvArr* img, CvPoint pt1, CvPoint pt2, CvScalar color, int thickness=1, int line_type=8, int shift=0 );</code></p> 
 <p>1.第一个参数为img，也就是指定在哪个图上画框，对于本例则为<code>img</code>。</p> 
 <p>2.第二个参数为矩形的左上角顶点的坐标，对应本例为<code>Point(faces[i].x, faces[i].y)</code>。</p> 
 <p>3.第三个参数为矩形对角线上的另一个顶点，对应本例为<code>Point(faces[i].x + faces[i].width, faces[i].y + faces[i].height)</code>。</p> 
 <p>4.第四个参数为线条颜色，Scalar(B,G,R)有三个参数，分别对应Blue、Green、Red，本例将框设置为红色，即Scalar(0,0,255)。</p> 
 <p>5.第五个参数为线条粗细，数越大线条越粗，本例设置为4。</p> 
 <p>6.第六个参数似乎是线条类型。有待考证。</p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token string">"FacesOf3ming"</span><span class="token punctuation">,</span> img<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">waitKey</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre> 
<p>执行完循环，检测到的目标已全部框出，调用<code>imshow()</code>函数，将框完人脸的图片<code>img</code>显示出来。</p> 
<p><code>imshow()</code>函数有两个参数，第一个是显示图片窗口的名称，第二个是储存图像数据的对象。</p> 
<p><code>waitkey(0)</code>函数在显示图像时具有延时的作用,单位为毫秒。若参数为0，则图像不会自动关闭，会无限等待下去直到有按键按下。</p> 
<p>程序运行结束，<code>return 0</code>。</p> 
<h2><a id="_223"></a>程序运行结果</h2> 
<p>可以看到，明家三兄弟的脸已经被红框框起来了。静态图片中人脸检测成功实现。</p> 
<p><img src="https://images2.imgbox.com/43/ec/eA3DOClm_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_229"></a>总结</h2> 
<blockquote> 
 <p>本来想写很多，却又写不出了。就希望自己能学到想学的知识，氧氧能快快乐乐的吧。</p> 
</blockquote>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/46555835af32e708bb19ce89c041f284/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">c&#43;&#43; 线程间通信方式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cdaad498aa0b6824bc79c771529f5ddf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">eslint-disable-next-line</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>