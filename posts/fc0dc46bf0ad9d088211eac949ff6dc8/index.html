<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Prometheus(一)介绍和部署 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Prometheus(一)介绍和部署" />
<meta property="og:description" content="这里写自定义目录标题 一、概述1 介绍2 特征3 什么是指标4 组件 二、 架构适用场景不适用的场景 三 部署1 二进制方式1.1 下载 [点击官方下载链接](https://prometheus.io/download/)1.2 解压到指定目录1.3 启动命令和启动参数1.3.1 启动命令1.3.2 启动参数 1.4 为程序配置 systemd ，实现开机自启 2 docker 容器方式3 配置文件3.1 示例配置文件3.2 配置文件详解热加载配置文件命令 四 页面功能菜单介绍 一、概述 1 介绍 Prometheus是一个开源系统监控和警报工具包，最初在SoundCloud上构建。自2012年成立以来，许多公司和组织都采用了Prometheus，该项目拥有非常活跃的开发人员和用户社区。它现在是一个独立的开源项目，独立于任何公司进行维护。为了强调这一点，并澄清项目的治理结构，Prometheus于2016年加入了云原生计算基金会，成为继Kubernetes之后的第二个托管项目。
Prometheus将其指标收集并存储为时间序列数据，即指标信息与记录它的时间戳一起存储，以及称为标签的可选键值对。
2 特征 普罗米修斯的主要特点是：
具有由指标名称和键/值对标识的时间序列数据的多维数据模型PromQL，一种灵活的查询语言，可利用这种维度不依赖分布式存储;单个服务器节点是自治的时序收集通过 HTTP 上的拉取模型进行通过中间网关支持推送时间序列通过服务发现或静态配置发现目标多种模式的绘图和仪表板支持 3 什么是指标 通俗地说，指标是用于测量的数字。时间序列意味着随时间记录的变化。用户想要测量的内容因应用程序而异。对于Web服务器，它可能是请求时间，对于数据库，它可能是活动连接数或活动查询数等。
指标在理解应用程序以某种方式工作的原因方面起着重要作用。假设您正在运行一个 Web 应用程序，并发现该应用程序运行缓慢。您将需要一些信息来了解您的应用程序发生了什么。例如，当请求数较高时，应用程序可能会变慢。如果您有请求计数指标，则可以发现原因并增加服务器数量以处理负载。
4 组件 普罗米修斯生态系统由多个组件组成，其中许多组件是可选的：
Prometheus server 主要组件，用于抓取和存储时间序列数据client libraries， 用于检测应用程序代码Push gateway 支持短期作业的推送Exporters，用于监控特殊服务，如HAProxy，StatsD，Graphite等服务。alertmanager 用于处理警报各种支持工具
大多数Prometheus组件都是用Go编写的，这使得它们易于构建和部署为静态二进制文件。 二、 架构 Prometheus server 直接从监控任务进程中拉取监控指标，也可以通过其他程序或脚本，将监控数据推送 Pushgateway,之后 Prometheus server 再从 Pushgateway 中拉取指标。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/fc0dc46bf0ad9d088211eac949ff6dc8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-03T10:29:23+08:00" />
<meta property="article:modified_time" content="2023-08-03T10:29:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Prometheus(一)介绍和部署</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>这里写自定义目录标题</h4> 
 <ul><li><a href="#_1" rel="nofollow">一、概述</a></li><li><ul><li><a href="#1__2" rel="nofollow">1 介绍</a></li><li><a href="#2__7" rel="nofollow">2 特征</a></li><li><a href="#3__18" rel="nofollow">3 什么是指标</a></li><li><a href="#4__23" rel="nofollow">4 组件</a></li></ul> 
  </li><li><a href="#__35" rel="nofollow">二、 架构</a></li><li><ul><li><a href="#_40" rel="nofollow">适用场景</a></li><li><a href="#_46" rel="nofollow">不适用的场景</a></li></ul> 
  </li><li><a href="#__49" rel="nofollow">三 部署</a></li><li><ul><li><a href="#1__52" rel="nofollow">1 二进制方式</a></li><li><ul><li><a href="#11__httpsprometheusiodownload_53" rel="nofollow">1.1 下载 [点击官方下载链接](https://prometheus.io/download/)</a></li><li><a href="#12__56" rel="nofollow">1.2 解压到指定目录</a></li><li><a href="#13__72" rel="nofollow">1.3 启动命令和启动参数</a></li><li><ul><li><a href="#131__73" rel="nofollow">1.3.1 启动命令</a></li><li><a href="#132__81" rel="nofollow">1.3.2 启动参数</a></li></ul> 
    </li><li><a href="#14__systemd__120" rel="nofollow">1.4 为程序配置 systemd ，实现开机自启</a></li></ul> 
   </li><li><a href="#2_docker__150" rel="nofollow">2 docker 容器方式</a></li><li><a href="#3__271" rel="nofollow">3 配置文件</a></li><li><ul><li><a href="#31__275" rel="nofollow">3.1 示例配置文件</a></li><li><a href="#32__293" rel="nofollow">3.2 配置文件详解</a></li><li><a href="#_318" rel="nofollow">热加载配置文件命令</a></li></ul> 
  </li></ul> 
  </li><li><a href="#__326" rel="nofollow">四 页面功能菜单介绍</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>一、概述</h2> 
<h3><a id="1__2"></a>1 介绍</h3> 
<p>Prometheus是一个开源系统监控和警报工具包，最初在SoundCloud上构建。自2012年成立以来，许多公司和组织都采用了Prometheus，该项目拥有非常活跃的开发人员和用户社区。它现在是一个独立的开源项目，独立于任何公司进行维护。为了强调这一点，并澄清项目的治理结构，Prometheus于2016年加入了云原生计算基金会，成为继Kubernetes之后的第二个托管项目。</p> 
<p>Prometheus将其指标收集并存储为时间序列数据，即指标信息与记录它的时间戳一起存储，以及称为标签的可选键值对。</p> 
<h3><a id="2__7"></a>2 特征</h3> 
<p>普罗米修斯的主要特点是：</p> 
<ul><li>具有由指标名称和键/值对标识的时间序列数据的多维数据模型</li><li>PromQL，一种灵活的查询语言，可利用这种维度</li><li>不依赖分布式存储;单个服务器节点是自治的</li><li>时序收集通过 HTTP 上的拉取模型进行</li><li>通过中间网关支持推送时间序列</li><li>通过服务发现或静态配置发现目标</li><li>多种模式的绘图和仪表板支持</li></ul> 
<h3><a id="3__18"></a>3 什么是指标</h3> 
<p>通俗地说，指标是用于测量的数字。时间序列意味着随时间记录的变化。用户想要测量的内容因应用程序而异。对于Web服务器，它可能是请求时间，对于数据库，它可能是活动连接数或活动查询数等。</p> 
<p>指标在理解应用程序以某种方式工作的原因方面起着重要作用。假设您正在运行一个 Web 应用程序，并发现该应用程序运行缓慢。您将需要一些信息来了解您的应用程序发生了什么。例如，当请求数较高时，应用程序可能会变慢。如果您有请求计数指标，则可以发现原因并增加服务器数量以处理负载。</p> 
<h3><a id="4__23"></a>4 组件</h3> 
<p>普罗米修斯生态系统由多个组件组成，其中许多组件是可选的：</p> 
<ul><li>Prometheus server 主要组件，用于抓取和存储时间序列数据</li><li>client libraries， 用于检测应用程序代码</li><li>Push gateway 支持短期作业的推送</li><li>Exporters，用于监控特殊服务，如HAProxy，StatsD，Graphite等服务。</li><li>alertmanager 用于处理警报</li><li>各种支持工具<br> 大多数Prometheus组件都是用Go编写的，这使得它们易于构建和部署为静态二进制文件。</li></ul> 
<h2><a id="__35"></a>二、 架构</h2> 
<p><img src="https://images2.imgbox.com/9d/25/8FAuw3eU_o.png" alt="在这里插入图片描述"><br> Prometheus server 直接从监控任务进程中拉取监控指标，也可以通过其他程序或脚本，将监控数据推送 Pushgateway,之后 Prometheus server 再从 Pushgateway 中拉取指标。<br> Prometheus server 将所有抓取的样本存储在本地，并对此数据运行规则，以聚合和记录现有数据中的新时间序列或生成警报。Grafana 或其他 API 使用者可用于可视化收集的数据。</p> 
<h3><a id="_40"></a>适用场景</h3> 
<p>1 普罗米修斯非常适合记录任何纯数字时间序列。<br> 2 既适合以机器为中心的监视，也适合监视高度动态的面向服务的体系结构。<br> 3 在微服务世界中，它对多维数据收集和查询的支持是一个特别的优势。<br> 4 每个Prometheus服务器都是独立的，不依赖于网络存储或其他远程服务。</p> 
<h3><a id="_46"></a>不适用的场景</h3> 
<p>如果您需要100%的准确性，例如按请求计费，Prometheus不是一个好的选择，因为收集的数据可能不够详细和完整。</p> 
<h2><a id="__49"></a>三 部署</h2> 
<h3><a id="1__52"></a>1 二进制方式</h3> 
<h4><a id="11__httpsprometheusiodownload_53"></a>1.1 下载 <a href="https://prometheus.io/download/" rel="nofollow">点击官方下载链接</a></h4> 
<p><img src="https://images2.imgbox.com/c3/a0/bdWMiSQy_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="12__56"></a>1.2 解压到指定目录</h4> 
<p>将下载好的二级制包，解压到指定的部署目录。<br> <strong>注意：</strong></p> 
<blockquote> 
 <p>Prometheus 收集的监控数据是保存在自己独有的数据库中的，这个数据库的数据目录默认是 <code>/data</code>,可以使用启动参数 <code>--storage.tsdb.path=&lt;/path/to/data&gt;</code> 指定,最后一级的目录可以自动创建。<br> 因此需要注意 data 目录的磁盘容量。</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token function">curl</span> <span class="token parameter variable">-o</span> proemtheus.tar.gz
  <span class="token parameter variable">-L</span> https://github.com/prometheus/prometheus/releases/download/v2.45.0/prometheus-2.45.0.linux-amd64.tar.gz

<span class="token function">tar</span> <span class="token parameter variable">-xf</span> proemtheus.tar.gz  <span class="token parameter variable">-C</span> /apps/monitor

<span class="token function">mv</span> /apps/monitor/prometheus-2.45.0.linux-amd64/ /apps/monitor/prometheus-2.45.0

</code></pre> 
<h4><a id="13__72"></a>1.3 启动命令和启动参数</h4> 
<h5><a id="131__73"></a>1.3.1 启动命令</h5> 
<p>启动程序的文件在解压后的目录中，名称 <code>prometheus </code></p> 
<p>使用启动程序文件加上启动参数就可以启动 prometheus。</p> 
<pre><code class="prism language-bash">prometheus  <span class="token punctuation">[</span>启动参数<span class="token punctuation">]</span>
</code></pre> 
<h5><a id="132__81"></a>1.3.2 启动参数</h5> 
<p>使用如下命令可以获取到所有的启动参数</p> 
<pre><code class="prism language-bash">prometheus <span class="token parameter variable">--help</span>
</code></pre> 
<p>如下是常有的部分启动参数</p> 
<pre><code>--config.file=/etc/prometheus/prometheus.yml
指定配置文件

--storage.tsdb.path=&lt;/path/to/data
指定数据保存的目录

--web.enable-lifecycle
热加载配置文件

--web.read-timeout=5m
请求连接持续等待时长

--web.max-connections=512 
最大并发连接数

--storage.tsdb.retention=15d
采集的监控数据保留在内存或者磁盘中的最长时间
15-30天为宜

--storage.tsdb.path="/data"
存储数据的路径

--query.timeout=2m
单次查询等待时长，超时中断本次查询

--query.max-concurrency=20
接受的最大并发查询数
</code></pre> 
<h4><a id="14__systemd__120"></a>1.4 为程序配置 systemd ，实现开机自启</h4> 
<p><code>/etc/systemd/system/prometheuse.service</code></p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Prometheus 监控服务
<span class="token assign-left variable">After</span><span class="token operator">=</span>network-online.target remote-fs.target nss-lookup.target
<span class="token assign-left variable">Wants</span><span class="token operator">=</span>network-online.target

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token comment">#EnvironmentFile=-/etc/default/prometheus</span>
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/apps/monitor/prometheus-2.45.0/prometheus <span class="token parameter variable">--storage.tsdb.path</span><span class="token operator">=</span>/apps/monitor/prometheus-2.45.0/data --web.enable-lifecycle --web.read-timeout<span class="token operator">=</span>5m <span class="token parameter variable">--storage.tsdb.retention</span><span class="token operator">=</span>30d --web.max-connections<span class="token operator">=</span><span class="token number">512</span> <span class="token parameter variable">--query.timeout</span><span class="token operator">=</span>2m --query.max-concurrency<span class="token operator">=</span><span class="token number">20</span> <span class="token parameter variable">--web.console.libraries</span><span class="token operator">=</span>/usr/share/prometheus/console_libraries <span class="token parameter variable">--web.console.templates</span><span class="token operator">=</span>/usr/share/prometheus/consoles <span class="token parameter variable">--config.file</span><span class="token operator">=</span>/apps/monitor/prometheus-2.45.0/prometheus.yml
<span class="token assign-left variable">KillSignal</span><span class="token operator">=</span>SIGQUIT

<span class="token assign-left variable">Restart</span><span class="token operator">=</span>always

<span class="token assign-left variable">RestartPreventExitStatus</span><span class="token operator">=</span><span class="token number">1</span> <span class="token number">6</span> SIGABRT

<span class="token assign-left variable">TimeoutStopSec</span><span class="token operator">=</span><span class="token number">5</span>
<span class="token assign-left variable">KillMode</span><span class="token operator">=</span>process
<span class="token assign-left variable">PrivateTmp</span><span class="token operator">=</span>true
<span class="token assign-left variable">LimitNOFILE</span><span class="token operator">=</span><span class="token number">1048576</span>
<span class="token assign-left variable">LimitNPROC</span><span class="token operator">=</span><span class="token number">1048576</span>

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
</code></pre> 
<h3><a id="2_docker__150"></a>2 docker 容器方式</h3> 
<p><strong>镜像名称:</strong></p> 
<ul><li>prom/prometheus # 官方镜像 <a href="https://hub.docker.com/r/prom/prometheus/tags" rel="nofollow">docer hub 地址</a></li><li>bitnami/prometheus:2.36.2 # 第三方镜像</li></ul> 
<p>建议使用 docker-compose 方式部署</p> 
<p><strong>目录结构</strong></p> 
<p>prometheus<br> ├── compose.yml<br> ├── config<br> │ └── prometheus.yml<br> └── data</p> 
<p><code>compose.yml</code></p> 
<pre><code class="prism language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.9'</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token comment"># 添加 普罗米修斯服务</span>
  <span class="token key atrule">prometheus</span><span class="token punctuation">:</span>
    <span class="token comment"># Docker Hub 镜像</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> prom/prometheus<span class="token punctuation">:</span>v2.36.2
    <span class="token comment"># 容器内部 hostname</span>
    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> prometheus
    <span class="token comment"># 容器支持自启动</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token comment"># 容器与宿主机 端口映射</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">'9090:9090'</span>
    <span class="token comment"># 将宿主机中的config文件夹，挂载到容器中/config文件夹</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">'./config/prometheus.yml:/etc/prometheus/prometheus.yml'</span>
      <span class="token punctuation">-</span> <span class="token string">'./data:/prometheus/data'</span> <span class="token comment"># data 目录属主需要是 65534</span>
    <span class="token comment"># 指定容器中的配置文件</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span>
      <span class="token comment"># 支持热更新</span>
      <span class="token punctuation">-</span> <span class="token string">'--web.enable-lifecycle'</span>
      <span class="token punctuation">-</span> <span class="token string">"--web.read-timeout=5m"</span>
      <span class="token punctuation">-</span> <span class="token string">"--storage.tsdb.retention=30d"</span>
      <span class="token punctuation">-</span> <span class="token string">"--web.max-connections=512"</span>
      <span class="token punctuation">-</span> <span class="token string">"--query.timeout=2m"</span>
      <span class="token punctuation">-</span> <span class="token string">"--query.max-concurrency=20"</span>
      <span class="token punctuation">-</span> <span class="token string">"--web.console.libraries=/usr/share/prometheus/console_libraries"</span>
      <span class="token punctuation">-</span> <span class="token string">"--web.console.templates=/usr/share/prometheus/consoles"</span>
      <span class="token punctuation">-</span> <span class="token string">"--config.file=/etc/prometheus/prometheus.yml"</span>

  <span class="token key atrule">grafana</span><span class="token punctuation">:</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
       <span class="token key atrule">GF_INSTALL_PLUGINS</span><span class="token punctuation">:</span> <span class="token string">"grafana-clock-panel,grafana-simple-json-datasource"</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> grafana/grafana<span class="token punctuation">-</span>enterprise<span class="token punctuation">:</span>8.5.5
    <span class="token comment"># 容器支持自启动</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token comment"># 容器与宿主机 端口映射</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> <span class="token string">'3030:3000'</span>
    <span class="token key atrule">user</span><span class="token punctuation">:</span> <span class="token string">"104"</span>
    <span class="token comment"># 默认密码: admin/admin</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token function">chown</span> <span class="token number">65534.65534</span> data
</code></pre> 
<p><code>prometheus.yml</code></p> 
<pre><code class="prism language-yaml"><span class="token comment"># my global config</span>
<span class="token key atrule">global</span><span class="token punctuation">:</span>
  <span class="token key atrule">scrape_interval</span><span class="token punctuation">:</span> 5s <span class="token comment"># Set the scrape interval to every 15 seconds. Default is every 1 minute.</span>
  <span class="token key atrule">evaluation_interval</span><span class="token punctuation">:</span> 5s <span class="token comment"># Evaluate rules every 15 seconds. The default is every 1 minute.</span>
  <span class="token comment"># scrape_timeout is set to the global default (10s).</span>

<span class="token comment"># Alertmanager configuration</span>
<span class="token key atrule">alerting</span><span class="token punctuation">:</span>
  <span class="token key atrule">alertmanagers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span>
          <span class="token comment"># - alertmanager:9093</span>

<span class="token comment"># Load rules once and periodically evaluate them according to the global 'evaluation_interval'.</span>
<span class="token key atrule">rule_files</span><span class="token punctuation">:</span>
  <span class="token comment">#- "/usr/local/prometheus/prometheus.rules.yml"</span>
  <span class="token punctuation">-</span> <span class="token string">"prometheus.rules.yml"</span>
  <span class="token comment"># - "first_rules.yml"</span>
  <span class="token comment"># - "second_rules.yml"</span>

<span class="token comment"># A scrape configuration containing exactly one endpoint to scrape:</span>
<span class="token comment"># Here it's Prometheus itself.</span>
<span class="token key atrule">scrape_configs</span><span class="token punctuation">:</span>
  <span class="token comment"># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</span>
  <span class="token punctuation">-</span> <span class="token key atrule">job_name</span><span class="token punctuation">:</span> <span class="token string">"prometheus"</span>

    <span class="token comment"># metrics_path defaults to '/metrics'</span>
    <span class="token comment"># scheme defaults to 'http'.</span>

    <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token string">"localhost:9090"</span>

  <span class="token punctuation">-</span> <span class="token key atrule">job_name</span><span class="token punctuation">:</span> <span class="token string">"beijing"</span>
    <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token string">"10.10.10.101:9111"</span>
        <span class="token key atrule">labels</span><span class="token punctuation">:</span>
          <span class="token key atrule">group</span><span class="token punctuation">:</span> <span class="token string">'beijing'</span>

  <span class="token punctuation">-</span> <span class="token key atrule">job_name</span><span class="token punctuation">:</span> <span class="token string">"nanjing"</span>
    <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">labels</span><span class="token punctuation">:</span>
          <span class="token key atrule">group</span><span class="token punctuation">:</span> <span class="token string">'k8s-630'</span>
        <span class="token key atrule">targets</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token string">'192.168.0.10:9111'</span>

</code></pre> 
<p>第一次启动</p> 
<pre><code class="prism language-bash"><span class="token function">docker-compose</span>  up <span class="token parameter variable">-d</span> 
</code></pre> 
<h3><a id="3__271"></a>3 配置文件</h3> 
<p>普罗米修斯的配置是YAML。</p> 
<h4><a id="31__275"></a>3.1 示例配置文件</h4> 
<p>二级制方式下载的压缩包中附带了一个名 <code>prometheus.yml</code> 的示例配置。</p> 
<p><img src="https://images2.imgbox.com/e7/f2/aDryHiPL_o.png" alt="在这里插入图片描述"></p> 
<p>配置文件中有三个配置块:</p> 
<ul><li>global 全局配置<br> <code>scrape_interval</code> 控制普罗米修斯抓取目标的频率。您可以为单个目标覆盖此内容。<code>15s</code> 表示 15 秒 刷新 1 次。<br> <code>evaluation_interval</code> 该选项控制普罗米修斯评估规则的频率。普罗米修斯使用规则来创建新的时间序列并生成警报。</li><li>rule_files 加载规则文件的路径，目前没有规则文件,规则用于触发告警。</li><li>scrape_configs 指定一组目标和参数，描述如何抓取它们。<br> <code>job_name</code> 可以按照不同的环境或者其他信息对被监控的主机进行分组。<br> <code>static_configs</code> 表示此配置信息下的被监控的主机是通过配置静态的配置文件获取的。<br> <code>targets</code> 具体被监控的主机IP,或者可以别解析的主机名和端口，其值应该是一个列表。<br> <code>"localhost:9090"</code> 普罗米修斯可以监控自身，可以使用 <code>curl http://localhost:9090/metrics</code> 来获取当前服务器的状态和性能。</li></ul> 
<h4><a id="32__293"></a>3.2 配置文件详解</h4> 
<p>通用占位符定义如下：</p> 
<ul><li><code>&lt;boolean&gt;</code>：一个可以取值或truefalse</li><li><code>&lt;duration&gt;</code>：与正则表达式匹配的持续时间，例如 <code>((([0-9]+)y)?(([0-9]+)w)?(([0-9]+)d)?(([0-9]+)h)?(([0-9]+)m)?(([0-9]+)s)?(([0-9]+)ms)?|0), e.g. 1d, 1h30m, 5m, 10s</code></li><li><code>&lt;filename&gt;</code>：当前工作目录中的有效路径</li><li><code>&lt;float&gt;</code>：浮点数</li><li><code>&lt;host&gt;</code>：由主机名或 IP 后跟可选端口号的有效字符串</li><li><code>&lt;int&gt;</code>：整数值</li><li><code>&lt;labelname&gt;</code>：与正则表达式匹配的字符串<code>[a-zA-Z_][a-zA-Z0-9_]*</code></li><li><code>&lt;labelvalue&gt;</code>：一串 unicode 字符</li><li><code>&lt;path&gt;</code>：有效的网址路径</li><li><code>&lt;scheme&gt;</code>：可以取值或httphttps</li><li><code>&lt;secret&gt;</code>：作为机密的常规字符串，如密码</li><li><code>&lt;string&gt;</code>：常规字符串</li><li><code>&lt;size&gt;</code>：以字节为单位的大小，例如 512MB。需要一个单位。支持的单位：B、KB、MB、GB、TB、PB、EB。512MB</li><li><code>&lt;tmpl_string&gt;</code>：在使用前经过模板扩展的字符串</li></ul> 
<p><a href="https://github.com/prometheus/prometheus/blob/release-2.36/config/testdata/conf.good.yml">可以在这里找到示例文件</a></p> 
<p>关于配置文件的更多信息，参考： https://prometheus.io/docs/prometheus/latest/configuration/configuration/</p> 
<h4><a id="_318"></a>热加载配置文件命令</h4> 
<p>没有验证出效果</p> 
<pre><code class="prism language-shell">cu rl <span class="token parameter variable">-X</span> POST http://localhost:9090/-/reload
</code></pre> 
<h2><a id="__326"></a>四 页面功能菜单介绍</h2> 
<p>启动后，可以在浏览器中输入如下地址访问 普罗米修斯</p> 
<p><code>http://普罗米修斯服务器ip:9090</code><br> <img src="https://images2.imgbox.com/4d/01/qn0jt5Cm_o.png" alt="在这里插入图片描述"><br> <code>Alerts</code> 中包含的告警信息</p> 
<p><img src="https://images2.imgbox.com/78/63/xnxhzbm5_o.png" alt="在这里插入图片描述"></p> 
<p><code>Graph</code> 中可以根据查询表达式返回的结果，呈现出具体的图表信息<br> <img src="https://images2.imgbox.com/c6/30/nCfVvAk4_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/22/a7/G0c61qPI_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/cd/52/XGr5G84G_o.png" alt="在这里插入图片描述"></p> 
<p><code>Status</code> 各种状态<br> <img src="https://images2.imgbox.com/a3/25/8HT8Mbpu_o.png" alt="在这里插入图片描述"></p> 
<p><code>Classic UI</code> 不同的页面 UI 风格</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/275a463417abf7f1e7e9dbf2a6b3e635/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【刷题打卡记录】力扣17. 电话号码的字母组合</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/038c459c2959dbf13c9cbde537186846/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">爆肝整理，Postman接口测试-参数关联实战（详细步骤）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>