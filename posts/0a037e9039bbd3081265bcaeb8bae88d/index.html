<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python风控建模实战（分类器模型&#43;回归模型） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python风控建模实战（分类器模型&#43;回归模型）" />
<meta property="og:description" content="在全球数字经济时代，有一种金融优势，那就是基于消费者大数据的纯信用！
我们不妨称之为数据信用，它是一种面向未来的财产权，它是数字货币背后核心的抵押资产，它决定了数字货币时代信用创造的方向、速度和规模。一句话，谁掌握了数据信用，谁就控制了数字货币的发行权！数据信用判断依靠的就是金融风控模型。
数据信用判断依靠的就是金融风控模型。更准确的说谁能掌握风控模型知识，谁就掌握了数字货币的发行权！
欢迎各位同学学习：
欢迎各位同学学习python风控建模实战lendingClub，链接地址为https://edu.csdn.net/course/detail/30742
之前博主录制《python信用模型建模（附代码）》课程是针对逻辑回归模型模型；《python风控建模实战lendingClub》此课程是针对集成树模型，包括catboost，lightgbm，xgboost。两个课程算法原理是不同的。
此课程catboost集成树算法有诸多优点，自动化处理缺失数据，自动化调参，无需变量卡方分箱。学员学完后不再为数据预处理，调参，变量分箱而烦恼。此教程建立模型性能卓越，最高性能ks:0.5869,AUC:0.87135，远超互联网上其它建模人员性能。
（lendingclub分类器模型数据下载地址）
（移动杯消费金融回归模型百万奖金挑战赛数据下载地址）
课程目录
章节1 python编程环境搭建
课时1风控建模语言，python，R，SAS优劣对比
课时2Anaconda快速入门指南
课时3Anaconda下载安装
课时4canopy下载和安装
课时5Anaconda Navigator导航器05:38
课时6python第三方包安装(pip和conda install)
课时7Python非官方扩展包下载地址
课时8Anaconda安装不同版本python
课时9为什么使用jupyter notebook及如何安装
课时10如何用jupyter notebook打开指定文件夹内容？
课时11jupyter基本文本编辑操作
课时12jupyter生成在线PPT汇报文档
课时13jupyter notebook用matplotlib不显示图片解决方案
章节2 python编程基础
课时14Python文件基本操作
课时15python官网
课时16变量_表达式_运算符_值
课时17字符串string
课时18列表list
课时19程序的基本构架（条件，循环）
课时20数据类型_函数_面向对象编程
课时21python2和3区别
课时22编程技巧和学习方法
章节3 python机器学习基础知识
课时23UCI机器学习数据库介绍
课时24机器学习书籍推荐
课时25如何选择算法
课时26sklearn机器学习算法速查表
课时27python数据科学常用的库
课时28python数据科学入门介绍（选修）
章节4 lendingClub业务介绍（P2P鼻祖）
课时29lendingClub业务简介
课时30lendingclub债务危机及深层次时代背景
课时31lendingClub官网数据下载(或本集参考资料下载)
章节5catboost基础介绍
课时32catboost基础知识讲解-比xgboost更优算法登场
课时33catboost官网介绍
章节6 lengding Club实战_catboost分类器模型
课时34数据清洗和首次变量筛选
课时35catboost第三方包下载和安装
课时36import导入建模的包
课时37读取数据和描述性统计
课时38train，test训练和测试数据划分
课时39fit训练模型
课时40模型验证概述
课时41树模型需要相关性检验吗？
课时42交叉验证cross validation" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/0a037e9039bbd3081265bcaeb8bae88d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-03T11:50:24+08:00" />
<meta property="article:modified_time" content="2021-02-03T11:50:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python风控建模实战（分类器模型&#43;回归模型）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在全球数字经济时代，有一种金融优势，那就是基于消费者大数据的纯信用！</p> 
<p><img alt="" src="https://images2.imgbox.com/c3/66/qpCeu3qa_o.png"></p> 
<p><br> 我们不妨称之为数据信用，它是一种面向未来的财产权，它是数字货币背后核心的抵押资产，它决定了数字货币时代信用创造的方向、速度和规模。一句话，谁掌握了数据信用，谁就控制了数字货币的发行权！数据信用判断依靠的就是金融风控模型。</p> 
<p>数据信用判断依靠的就是金融风控模型。更准确的说谁能掌握风控模型知识，谁就掌握了数字货币的发行权！</p> 
<p>欢迎各位同学学习：</p> 
<p>欢迎各位同学学习<a href="https://edu.csdn.net/course/detail/30742">python风控建模实战lendingClub，链接地址为https://edu.csdn.net/course/detail/30742</a></p> 
<p><img alt="" height="387" src="https://images2.imgbox.com/56/51/QEHuJsHp_o.png" width="382"></p> 
<p> </p> 
<p><img alt="" height="766" src="https://images2.imgbox.com/87/36/XzTEQqdb_o.png" width="1200"></p> 
<p> </p> 
<p> <strong><img alt="" height="747" src="https://images2.imgbox.com/9e/e7/UldJNHPX_o.png" width="1200"></strong></p> 
<p> </p> 
<p>之前博主录制《python信用模型建模（附代码）》课程是针对逻辑回归模型模型；《python风控建模实战lendingClub》此课程是针对集成树模型，包括catboost，lightgbm，xgboost。两个课程算法原理是不同的。</p> 
<p>此课程catboost集成树算法有诸多优点，自动化处理缺失数据，自动化调参，无需变量卡方分箱。学员学完后不再为数据预处理，调参，变量分箱而烦恼。此教程建立<strong>模型性能卓越，最高性能ks:0.5869,AUC:0.87135，远超互联网上其它建模人员性能。</strong></p> 
<p><strong><img alt="" height="765" src="https://images2.imgbox.com/c2/8b/hVJKm7lz_o.png" width="1200"></strong></p> 
<p> </p> 
<p><img alt="" height="759" src="https://images2.imgbox.com/0d/a5/0fp70rmZ_o.png" width="1200"></p> 
<p>（lendingclub分类器模型数据下载地址）</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/3a/c5/nVw0cBnI_o.png" width="1200"></p> 
<p>（移动杯消费金融回归模型百万奖金挑战赛数据下载地址）</p> 
<p><img alt="" height="750" src="https://images2.imgbox.com/10/6d/fLZL1yAq_o.png" width="1200"></p> 
<p><img alt="" height="739" src="https://images2.imgbox.com/ee/5f/XjEFPcCE_o.png" width="1200"></p> 
<p> </p> 
<p><img alt="" height="753" src="https://images2.imgbox.com/62/d5/M5N4gQme_o.png" width="1200"></p> 
<p><strong> </strong></p> 
<p> <img alt="" height="740" src="https://images2.imgbox.com/ef/5a/HNSnbeSF_o.png" width="1200"></p> 
<p> </p> 
<p><strong><img alt="" height="751" src="https://images2.imgbox.com/32/e4/St0nXvDZ_o.png" width="1200"></strong></p> 
<p> </p> 
<p><strong><img alt="" height="727" src="https://images2.imgbox.com/2e/d9/EZpSnEol_o.png" width="1200"></strong></p> 
<p> </p> 
<p><strong>课程目录</strong></p> 
<p>章节1 python编程环境搭建<br> 课时1风控建模语言，python，R，SAS优劣对比<br> 课时2Anaconda快速入门指南<br> 课时3Anaconda下载安装<br> 课时4canopy下载和安装<br> 课时5Anaconda Navigator导航器05:38<br> 课时6python第三方包安装(pip和conda install)<br> 课时7Python非官方扩展包下载地址<br> 课时8Anaconda安装不同版本python<br> 课时9为什么使用jupyter notebook及如何安装<br> 课时10如何用jupyter notebook打开指定文件夹内容？<br> 课时11jupyter基本文本编辑操作<br> 课时12jupyter生成在线PPT汇报文档<br> 课时13jupyter notebook用matplotlib不显示图片解决方案</p> 
<p>章节2 python编程基础<br> 课时14Python文件基本操作<br> 课时15python官网<br> 课时16变量_表达式_运算符_值<br> 课时17字符串string<br> 课时18列表list<br> 课时19程序的基本构架（条件，循环）<br> 课时20数据类型_函数_面向对象编程<br> 课时21python2和3区别<br> 课时22编程技巧和学习方法</p> 
<p>章节3 python机器学习基础知识<br> 课时23UCI机器学习数据库介绍<br> 课时24机器学习书籍推荐<br> 课时25如何选择算法<br> 课时26sklearn机器学习算法速查表<br> 课时27python数据科学常用的库<br> 课时28python数据科学入门介绍（选修）</p> 
<p>章节4 lendingClub业务介绍（P2P鼻祖）<br> 课时29lendingClub业务简介<br> 课时30lendingclub债务危机及深层次时代背景<br> 课时31lendingClub官网数据下载(或本集参考资料下载)</p> 
<p>章节5catboost基础介绍<br> 课时32catboost基础知识讲解-比xgboost更优算法登场<br> 课时33catboost官网介绍</p> 
<p>章节6 lengding Club实战_catboost分类器模型<br> 课时34数据清洗和首次变量筛选<br> 课时35catboost第三方包下载和安装<br> 课时36import导入建模的包<br> 课时37读取数据和描述性统计<br> 课时38train，test训练和测试数据划分<br> 课时39fit训练模型<br> 课时40模型验证概述<br> 课时41树模型需要相关性检验吗？<br> 课时42交叉验证cross validation<br> 课时43混淆矩阵理论概述，accuracy，sensitivity，precision，F1分数<br> 课时44混淆矩阵python脚本实现<br> 课时45计算模型ks(Kolmogorov-Smirnoff)<br> 课时46catboost1_建模脚本连贯讲解<br> 课时47catboost2_第二次变量筛选<br> 课时48catboost3_分类变量cat_features使用</p> 
<p>章节7KS（Kolmogorov–Smirnov）模型区分能力指标<br> 课时49KS简介<br> 课时50step1获取模型分<br> 课时51step2_计算ks_方法1<br> 课时52step3_计算ks_方法2<br> 课时53step4_计算ks_excel推理<br> 课时54step5_绘制KS图<br> 课时55step6_KS评估函数<br> 课时56step7_KS脚本汇总_分治算法<br> 课时57step8_KS缺陷</p> 
<p>章节8AUC（Area Under Curve）模型区分能力指标</p> 
<p>课时58 ROC基本含义<br> 课时58excel绘制ROC曲<br> 课时59python计算AUC很简单<br> 课时60python轻松绘制ROC曲线<br> 课时61AUC评估函数_AUC多大才算好？<br> 课时62Gini基尼系数基本概念和AUC关系</p> 
<p>章节9pickle保存模型<br> 课时63pickle保存和导入模型包_避免重复训练模型时间</p> 
<p>章节10PSI模型稳定性评估指标（上）<br> 课时64拿破仑和希特勒征服欧洲为何失败？数学PSI指标揭露历史真相<br> 课时65excel手把手教你推导PSI的计算公式<br> 课时66PSI计算公式奥义<br> 课时67PSI的python脚本讲解</p> 
<p>章节11PSI模型稳定性评估指标（下）<br> 课时68step1.筛选lendingClub2018年Q3和Q4数据<br> 课时69step2_计算train，test，oot模型分<br> 课时70step3.计算Q3和Q4模型分PSI</p> 
<p>章节12模型维度与边际效应<br> 课时71边际效应基本概念<br> 课时72模型维度与边际效应,变量越多越好吗？<br> 课时73降维实操，结果让人吃惊！<br> 课时74模型变量数量越多，区分能力（ks）越高吗？</p> 
<p>章节13catboost分类变量处理<br> 课时75 One-hot encoding热编码<br> 课时76 cat_features分类变量处理（数值型）1<br> 课时77 cat_features分类变量处理（字符串类型）<br> 课时78 不同分类变量处理方法的结果对比</p> 
<p>章节14catboost调参<br> 课时79GridSearchCV网格调参简述<br> 课时80iterations树的颗树<br> 课时81eval_metric评估参数（logloss_AUC_Accuracy_F1_Recall）<br> 课时82learning_rate学习率<br> 课时83树深度depth（max_depth）<br> 课时84 l2_leaf_reg正则系数L2调参</p> 
<p>章节15多算法比较<br> 课时85xgboost分类器模型<br> 课时86lightgbm分类器建模<br> 课时87逻辑回归分类器和多算法比较结果</p> 
<p>章节16消费者信用评分实战_回归模型<br> 课时88机器学习回归竞赛_一百万奖金挑战<br> 课时89线性回归基础知识（最小二乘法OLS）<br> 课时90梯度下降法gradient descent<br> 课时91误差error_偏差bias_方差variance<br> 课时92shrinkage特征缩减技术_正则化<br> 课时93ridge岭回归_lasso回归_elasticNetwork弹性网络<br> 课时94sklearn_ridge岭回归脚本<br> 课时95逻辑回归_regression脚本<br> 课时96支持向量回归SVR脚本<br> 课时97随机森林randomForest回归脚本<br> 课时98xgboost regression回归脚本<br> 课时99catboost regressor回归脚本<br> 课时100lightgbm基础知识讲解<br> 课时101lightgbm regressor回归脚本<br> 课时102sequencial线性模型回归预测脚本</p> 
<p> </p> 
<p> <img alt="" src="https://images2.imgbox.com/db/1a/AF0ZnqSJ_o.png"></p> 
<p><strong> 为什么需要风控模型？</strong></p> 
<p><strong>风控模型目的将银行风险最小化并将利润最大化。贷款有风险，如果用户借钱不还或故意骗贷，银行就会有损失。风控模型作用就是识别这些借钱不还用户，然后过滤掉这些坏用户。这样银行放款对象基本是优质客户，可以从中赚取利息，从而达到利润最大化，风险最小化。</strong></p> 
<p>为了从银行的角度将损失降到最低，银行需要制定决策规则，确定谁批准贷款，谁不批准。 在决定贷款申请之前，贷款经理会考虑申请人的人口统计和社会经济概况。</p> 
<p> </p> 
<p><strong>风控历史</strong></p> 
<p>世界上最早的银行出现在意大利。 最早的银行是意大利1407年在威尼斯成立的银行。当然类似于银行的机构可能存更早存在。只要有银行，就会有风险控制和管理，即风控。早期风控包括对借贷人资质审核和账户核实。</p> 
<p><img alt="" src="https://images2.imgbox.com/00/59/0ijLS6Jj_o.png"></p> 
<p>随着金融业发展，贷款流程逐渐完善，包括下图流程</p> 
<p><img alt="" src="https://images2.imgbox.com/e8/12/rxMtVBeq_o.png"></p> 
<p>2000-2008后，全球逐步进入大数据时代，随着用户数据整合，诞生央行征信，公安人脸数据，芝麻信用分，同盾分，聚信立蜜罐分，百度黑中介分等参考数据。银行，消费金融公司，小额贷公司可以利用大数据建模，利用机器智能决策代替绝大部分人工审核，缩短信贷流程，减少贷款风险，实现利润最大化。</p> 
<p><img alt="" src="https://images2.imgbox.com/e0/7f/0dDGpVNW_o.png"></p> 
<p>现代大数据时代的风控部门主要分为贷前，贷中和贷后管理三个板块。</p> 
<p><img alt="" src="https://images2.imgbox.com/19/79/Lx3HgeQc_o.png"></p> 
<p><strong>信用逾期高发时代</strong></p> 
<p>随着我国居民消费心理发生改变和各大商家诱导性消费，不少朋友越来越依赖超前消费了。我国14亿人口，消费群体庞大，各类产品也有着很大的市场，于是现在的消费信贷市场成了很多银行或者其他机构发力的方向。根据央行公布的数据来看，商业银行发行的信用卡数量继续扩张，但在“滥发”信用卡的背后，逾期坏账不断增加也成了银行头疼问题。</p> 
<p>信用卡逾期半年以上坏账突破900亿</p> 
<p>近日，央行公布了三季度支付体系的运行报告，从央行公布的数据来看，我国商业银行发行的信用卡数量、授信总额以及坏账总额均在保持增长。</p> 
<p>数据显示，截至今年三季度末，我国商业银行发行的信用卡（包括借贷合一卡）的数量达到了7.66亿张，环比增加1.29%。总授信额度达到了18.59万亿元，环比增加3.80%。</p> 
<p>下卡量在增加，加上授信总额在不断增长，说明银行依旧非常重视信用卡市场，但同时这也给银行带来了不小的麻烦。因为截至今年三季度末，信用卡逾期半年以上的坏账来到了906.63亿元，环比大涨6.13%。</p> 
<p>信用卡下卡数量不断增加，说明在初审阶段银行并没有管理的太严格，因此坏账增加是客观会存在的问题。但作为专业的金融机构，银行显然是不会坐视坏账继续涨下去，不然就会影响到银行的正常经营，也会引起监管层的注意。</p> 
<p>所以在这种情况下面，商业银行会对已经下卡的客户进行管理，一般是在消费场景以及防范套现上面下功夫。所以为了你不被银行二次风控，从而对你的信用卡封卡降额，一些不合规的刷卡消费最好还是别碰。</p> 
<p>银行风控负责人改如何应对持续上升信用卡坏账？作者认为识别坏客户（骗贷和还款能力不足人群）是关键。只有银行精准识别了坏客户，才能显著降低逾期和坏账率。</p> 
<p><img alt="基于LendingClub数据的python风控建模（附脚本和10万多真实信贷数据）" src="https://images2.imgbox.com/32/2a/RnPJLdK0_o.png"><br> 之前银行是当铺思想，把钱借给有偿还能力的人。这些人群算是优质客群。更糟糕的是但随着量化宽松，财政货币刺激，M2激增，银行，消费金融公司，小额贷公司纷纷把市场目标扩大到次级客户，即偿还能力不足或没有工作的人，这些人还钱风险很高，因此借钱利息也很高。</p> 
<p>国内黑产，灰产已经形成庞大产业链条。根据之前同盾公司统计，黑产团队至少上千个，多大为3人左右小团队，100人以上大团队也有几十上百个。这些黑产团队天天测试各大现金贷平台漏洞，可谓专业产品经理。下图是生产虚假号码的手机卡，来自东南亚，国内可用，可最大程度规避国内安全监控，专门为线上平台现金贷诈骗用户准备。如果没有风控能力，就不要玩现金贷这行了。放款犹如肉包打狗有去无回。</p> 
<p><img alt="基于LendingClub数据的python风控建模（附脚本和10万多真实信贷数据）" src="https://images2.imgbox.com/7a/c6/ceBXUKUy_o.png"><br> 举个身边熟悉例子，作者在之前某宝关键词搜索中，可以发现黑产和灰产身影。</p> 
<p>关键词：</p> 
<p>注册机，短信服务，短信接收，短信验证，app下单，智能终端代接m<br><img alt="基于LendingClub数据的python风控建模（附脚本和10万多真实信贷数据）" src="https://images2.imgbox.com/be/f7/35JiDEsr_o.png"><br><img alt="基于LendingClub数据的python风控建模（附脚本和10万多真实信贷数据）" height="725" src="https://images2.imgbox.com/7c/f5/BYu2euaV_o.png" width="1080"><br><img alt="基于LendingClub数据的python风控建模（附脚本和10万多真实信贷数据）" src="https://images2.imgbox.com/c0/29/3PO7fYF8_o.png"></p> 
<p><strong>黑产市场风起云涌，</strong><strong>银行风控负责人改如何应对持续上升信用卡坏账？作者认为识别坏客户（骗贷和还款能力不足人群）是关键。只有银行精准识别了坏客户，才能显著降低逾期和坏账率。如何<strong>精准识别坏客户，改课程会手把手教你大家Python信用模型模型，精准捕捉坏客户，此乃风控守护神。</strong></strong></p> 
<p>金融风控审批模型可以成为贷款人和借款人计算借款人偿债能力的绝佳工具。对于贷方而言，模型可以帮助他们评估借款人的风险，识别是否是骗贷用户或还款能力不足用户，并帮公司维持健康的投资组合 - 这最终将影响整个经济。</p> 
<p>模型就像一个黑箱，当用户申请贷款时，模型会根据用户信息，例如年龄，工作，职位，还款记录，借贷次数等维度自动计算客户坏客户概率。业务线如果用模型计算出某用户坏客户概率较高，例如0.8，就会拒绝改客户贷款申请。</p> 
<p><strong>因此风控模型就像信贷守护神，保护公司资产，免受黑产吞噬。模型模型自动化评分，1秒之内决定客户是否通过，贷前人员工作轻松多了！这样，大数据时代下的风控模型就此诞生。</strong></p> 
<p><img alt="" src="https://images2.imgbox.com/db/3c/84WQLAzw_o.png"></p> 
<p>（模型模型自动批量识别坏客户）</p> 
<p><img alt="" height="513" src="https://images2.imgbox.com/af/5e/alIGPFAC_o.png" width="937"></p> 
<p><img alt="" height="519" src="https://images2.imgbox.com/3b/da/uWzZUQTf_o.png" width="886"></p> 
<p><img alt="" height="750" src="https://images2.imgbox.com/0c/d3/bZNdXVl6_o.png" width="1200"></p> 
<p>第78课，模型训练截图</p> 
<p><img alt="" height="393" src="https://images2.imgbox.com/82/f6/KoCxUbTV_o.png" width="897"></p> 
<p><strong>模型最高性能，ks:0.5869,AUC:0.87135，远超互联网上其它建模人员性能。</strong></p> 
<p><img alt="" height="383" src="https://images2.imgbox.com/52/2b/DGAYg8kK_o.png" width="907"></p> 
<p> 模型降维测试</p> 
<p><img alt="" height="920" src="https://images2.imgbox.com/30/05/k46JXIfF_o.png" width="1200"></p> 
<p>模型调参测试</p> 
<p><img alt="" height="553" src="https://images2.imgbox.com/b0/53/t2eBbH3i_o.png" width="1200"></p> 
<p>接下来，我们展示一下部分python脚本建模和数据分析代码</p> 
<p>在课程中，我将研究Lending Club贷款数据，该数据不平衡，大且具有具有不同数据类型的多个功能。 为了进行建模，我将所有违约贷款作为目标变量，并试图预测贷款是否会违约。</p> 
<p>导入数据<br> 首先，导入必要的库</p> 
<pre><code>import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
sns.set_style('whitegrid')
import warnings
import gc
warnings.simplefilter(action='ignore', category=FutureWarning)
warnings.simplefilter(action='ignore', category=DeprecationWarning)
%matplotlib inline</code></pre> 
<p> 导入数据</p> 
<pre><code>start_df = pd.read_csv('../input/loan.csv', low_memory=False)</code></pre> 
<p> 处理数据的副本，这样我就不必为了节省内存而再次重新读取整个数据集。</p> 
<pre><code>df = start_df.copy(deep=True)
df.head()</code></pre> 
<p> </p> 
<table border="1"><thead><tr><th><br> id</th><th>member_id</th><th>loan_amnt</th><th>funded_amnt</th><th>funded_amnt_inv</th><th>term</th><th>int_rate</th><th>installment</th><th>grade</th><th>sub_grade</th><th>...</th><th>total_bal_il</th><th>il_util</th><th>open_rv_12m</th><th>open_rv_24m</th><th>max_bal_bc</th><th>all_util</th><th>total_rev_hi_lim</th><th>inq_fi</th><th>total_cu_tl</th><th>inq_last_12m</th></tr></thead><tbody><tr><th>0</th><td>1077501</td><td>1296599</td><td>5000.0</td><td>5000.0</td><td>4975.0</td><td>36 months</td><td>10.65</td><td>162.87</td><td>B</td><td>B2</td><td>...</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>1</th><td>1077430</td><td>1314167</td><td>2500.0</td><td>2500.0</td><td>2500.0</td><td>60 months</td><td>15.27</td><td>59.83</td><td>C</td><td>C4</td><td>...</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>2</th><td>1077175</td><td>1313524</td><td>2400.0</td><td>2400.0</td><td>2400.0</td><td>36 months</td><td>15.96</td><td>84.33</td><td>C</td><td>C5</td><td>...</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>3</th><td>1076863</td><td>1277178</td><td>10000.0</td><td>10000.0</td><td>10000.0</td><td>36 months</td><td>13.49</td><td>339.31</td><td>C</td><td>C1</td><td>...</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><th>4</th><td>1075358</td><td>1311748</td><td>3000.0</td><td>3000.0</td><td>3000.0</td><td>60 months</td><td>12.69</td><td>67.79</td><td>B</td><td>B5</td><td>...</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr></tbody></table> 
<p>检查数据维度</p> 
<p> <img alt="" src="https://images2.imgbox.com/39/8a/nNDdwrdu_o.png"></p> 
<p> </p> 
<p> 因此，我们得到很多变量。 知道这些变量的含义可以在以后的建模和数据分析中提供很多帮助。</p> 
<p>了解数据<br> 首先，让我们检查数据集中各个列字段的描述。</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> </td><td> <p><code>df_description </code><code>=</code> <code>pd.read_excel(</code><code>'../input/LCDataDictionary.xlsx'</code><code>).dropna()</code></p> <p><code>df_description.style.set_properties(subset</code><code>=</code><code>[</code><code>'Description'</code><code>], </code><code>*</code><code>*</code><code>{<!-- --></code><code>'width'</code><code>: </code><code>'1000px'</code><code>})</code></p> </td></tr></tbody></table> 
<p> </p> 
<table id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002"><thead><tr><th>LoanStatNew</th><th>Description</th></tr></thead><tbody><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row0">0</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row0_col0">addr_state</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row0_col1">The state provided by the borrower in the loan application</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row1">1</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row1_col0">annual_inc</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row1_col1">The self-reported annual income provided by the borrower during registration.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row2">2</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row2_col0">annual_inc_joint</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row2_col1">The combined self-reported annual income provided by the co-borrowers during registration</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row3">3</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row3_col0">application_type</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row3_col1">Indicates whether the loan is an individual application or a joint application with two co-borrowers</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row4">4</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row4_col0">collection_recovery_fee</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row4_col1">post charge off collection fee</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row5">5</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row5_col0">collections_12_mths_ex_med</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row5_col1">Number of collections in 12 months excluding medical collections</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row6">6</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row6_col0">delinq_2yrs</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row6_col1">The number of 30+ days past-due incidences of delinquency in the borrower's credit file for the past 2 years</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row7">7</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row7_col0">desc</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row7_col1">Loan description provided by the borrower</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row8">8</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row8_col0">dti</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row8_col1">A ratio calculated using the borrower’s total monthly debt payments on the total debt obligations, excluding mortgage and the requested LC loan, divided by the borrower’s self-reported monthly income.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row9">9</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row9_col0">dti_joint</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row9_col1">A ratio calculated using the co-borrowers' total monthly payments on the total debt obligations, excluding mortgages and the requested LC loan, divided by the co-borrowers' combined self-reported monthly income</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row10">10</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row10_col0">earliest_cr_line</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row10_col1">The month the borrower's earliest reported credit line was opened</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row11">11</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row11_col0">emp_length</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row11_col1">Employment length in years. Possible values are between 0 and 10 where 0 means less than one year and 10 means ten or more years.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row12">12</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row12_col0">emp_title</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row12_col1">The job title supplied by the Borrower when applying for the loan.*</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row13">13</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row13_col0">fico_range_high</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row13_col1">The upper boundary range the borrower’s FICO at loan origination belongs to.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row14">14</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row14_col0">fico_range_low</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row14_col1">The lower boundary range the borrower’s FICO at loan origination belongs to.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row15">15</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row15_col0">funded_amnt</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row15_col1">The total amount committed to that loan at that point in time.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row16">16</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row16_col0">funded_amnt_inv</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row16_col1">The total amount committed by investors for that loan at that point in time.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row17">17</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row17_col0">grade</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row17_col1">LC assigned loan grade</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row18">18</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row18_col0">home_ownership</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row18_col1">The home ownership status provided by the borrower during registration. Our values are: RENT, OWN, MORTGAGE, OTHER.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row19">19</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row19_col0">id</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row19_col1">A unique LC assigned ID for the loan listing.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row20">20</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row20_col0">initial_list_status</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row20_col1">The initial listing status of the loan. Possible values are – W, F</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row21">21</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row21_col0">inq_last_6mths</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row21_col1">The number of inquiries in past 6 months (excluding auto and mortgage inquiries)</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row22">22</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row22_col0">installment</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row22_col1">The monthly payment owed by the borrower if the loan originates.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row23">23</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row23_col0">int_rate</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row23_col1">Interest Rate on the loan</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row24">24</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row24_col0">is_inc_v</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row24_col1">Indicates if income was verified by LC, not verified, or if the income source was verified</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row25">25</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row25_col0">issue_d</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row25_col1">The month which the loan was funded</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row26">26</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row26_col0">last_credit_pull_d</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row26_col1">The most recent month LC pulled credit for this loan</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row27">27</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row27_col0">last_fico_range_high</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row27_col1">The upper boundary range the borrower’s last FICO pulled belongs to.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row28">28</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row28_col0">last_fico_range_low</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row28_col1">The lower boundary range the borrower’s last FICO pulled belongs to.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row29">29</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row29_col0">last_pymnt_amnt</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row29_col1">Last total payment amount received</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row30">30</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row30_col0">last_pymnt_d</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row30_col1">Last month payment was received</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row31">31</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row31_col0">loan_amnt</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row31_col1">The listed amount of the loan applied for by the borrower. If at some point in time, the credit department reduces the loan amount, then it will be reflected in this value.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row32">32</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row32_col0">loan_status</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row32_col1">Current status of the loan</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row33">33</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row33_col0">member_id</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row33_col1">A unique LC assigned Id for the borrower member.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row34">34</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row34_col0">mths_since_last_delinq</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row34_col1">The number of months since the borrower's last delinquency.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row35">35</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row35_col0">mths_since_last_major_derog</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row35_col1">Months since most recent 90-day or worse rating</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row36">36</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row36_col0">mths_since_last_record</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row36_col1">The number of months since the last public record.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row37">37</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row37_col0">next_pymnt_d</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row37_col1">Next scheduled payment date</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row38">38</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row38_col0">open_acc</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row38_col1">The number of open credit lines in the borrower's credit file.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row39">39</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row39_col0">out_prncp</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row39_col1">Remaining outstanding principal for total amount funded</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row40">40</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row40_col0">out_prncp_inv</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row40_col1">Remaining outstanding principal for portion of total amount funded by investors</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row41">41</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row41_col0">policy_code</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row41_col1">publicly available policy_code=1 new products not publicly available policy_code=2</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row42">42</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row42_col0">pub_rec</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row42_col1">Number of derogatory public records</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row43">43</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row43_col0">purpose</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row43_col1">A category provided by the borrower for the loan request.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row44">44</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row44_col0">pymnt_plan</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row44_col1">Indicates if a payment plan has been put in place for the loan</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row45">45</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row45_col0">recoveries</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row45_col1">post charge off gross recovery</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row46">46</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row46_col0">revol_bal</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row46_col1">Total credit revolving balance</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row47">47</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row47_col0">revol_util</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row47_col1">Revolving line utilization rate, or the amount of credit the borrower is using relative to all available revolving credit.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row48">48</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row48_col0">sub_grade</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row48_col1">LC assigned loan subgrade</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row49">49</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row49_col0">term</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row49_col1">The number of payments on the loan. Values are in months and can be either 36 or 60.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row50">50</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row50_col0">title</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row50_col1">The loan title provided by the borrower</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row51">51</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row51_col0">total_acc</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row51_col1">The total number of credit lines currently in the borrower's credit file</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row52">52</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row52_col0">total_pymnt</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row52_col1">Payments received to date for total amount funded</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row53">53</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row53_col0">total_pymnt_inv</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row53_col1">Payments received to date for portion of total amount funded by investors</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row54">54</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row54_col0">total_rec_int</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row54_col1">Interest received to date</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row55">55</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row55_col0">total_rec_late_fee</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row55_col1">Late fees received to date</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row56">56</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row56_col0">total_rec_prncp</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row56_col1">Principal received to date</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row57">57</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row57_col0">url</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row57_col1">URL for the LC page with listing data.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row58">58</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row58_col0">verified_status_joint</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row58_col1">Indicates if the co-borrowers' joint income was verified by LC, not verified, or if the income source was verified</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row59">59</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row59_col0">zip_code</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row59_col1">The first 3 numbers of the zip code provided by the borrower in the loan application.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row60">60</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row60_col0">open_acc_6m</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row60_col1">Number of open trades in last 6 months</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row61">61</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row61_col0">open_il_6m</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row61_col1">Number of currently active installment trades</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row62">62</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row62_col0">open_il_12m</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row62_col1">Number of installment accounts opened in past 12 months</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row63">63</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row63_col0">open_il_24m</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row63_col1">Number of installment accounts opened in past 24 months</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row64">64</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row64_col0">mths_since_rcnt_il</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row64_col1">Months since most recent installment accounts opened</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row65">65</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row65_col0">total_bal_il</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row65_col1">Total current balance of all installment accounts</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row66">66</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row66_col0">il_util</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row66_col1">Ratio of total current balance to high credit/credit limit on all install acct</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row67">67</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row67_col0">open_rv_12m</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row67_col1">Number of revolving trades opened in past 12 months</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row68">68</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row68_col0">open_rv_24m</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row68_col1">Number of revolving trades opened in past 24 months</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row69">69</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row69_col0">max_bal_bc</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row69_col1">Maximum current balance owed on all revolving accounts</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row70">70</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row70_col0">all_util</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row70_col1">Balance to credit limit on all trades</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row71">71</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row71_col0">total_rev_hi_lim  </td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row71_col1">Total revolving high credit/credit limit</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row72">72</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row72_col0">inq_fi</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row72_col1">Number of personal finance inquiries</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row73">73</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row73_col0">total_cu_tl</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row73_col1">Number of finance trades</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row74">74</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row74_col0">inq_last_12m</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row74_col1">Number of credit inquiries in past 12 months</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row75">75</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row75_col0">acc_now_delinq</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row75_col1">The number of accounts on which the borrower is now delinquent.</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row76">76</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row76_col0">tot_coll_amt</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row76_col1">Total collection amounts ever owed</td></tr><tr><th id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002level0_row77">77</th><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row77_col0">tot_cur_bal</td><td id="T_0730f5ba_a2a4_11e8_8bcd_0242ac130002row77_col1">Total current balance of all accounts</td></tr></tbody></table> 
<p>通过查看列说明，我们可以做的一件好事是找到具有重要性的列，同时找到因缺少信息而多余的列。<br><br> 让我们还查看缺失值的数量和百分比，</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> </td><td> <p><code>def</code> <code>null_values(df):</code></p> <p><code>        </code><code>mis_val </code><code>=</code> <code>df.isnull().</code><code>sum</code><code>()</code></p> <p><code>        </code><code>mis_val_percent </code><code>=</code> <code>100</code> <code>*</code> <code>df.isnull().</code><code>sum</code><code>() </code><code>/</code> <code>len</code><code>(df)</code></p> <p><code>        </code><code>mis_val_table </code><code>=</code> <code>pd.concat([mis_val, mis_val_percent], axis</code><code>=</code><code>1</code><code>)</code></p> <p><code>        </code><code>mis_val_table_ren_columns </code><code>=</code> <code>mis_val_table.rename(</code></p> <p><code>        </code><code>columns </code><code>=</code> <code>{<!-- --></code><code>0</code> <code>: </code><code>'Missing Values'</code><code>, </code><code>1</code> <code>: </code><code>'% of Total Values'</code><code>})</code></p> <p><code>        </code><code>mis_val_table_ren_columns </code><code>=</code> <code>mis_val_table_ren_columns[</code></p> <p><code>            </code><code>mis_val_table_ren_columns.iloc[:,</code><code>1</code><code>] !</code><code>=</code> <code>0</code><code>].sort_values(</code></p> <p><code>        </code><code>'% of Total Values'</code><code>, ascending</code><code>=</code><code>False</code><code>).</code><code>round</code><code>(</code><code>1</code><code>)</code></p> <p><code>        </code><code>print</code> <code>(</code><code>"Dataframe has "</code> <code>+</code> <code>str</code><code>(df.shape[</code><code>1</code><code>]) </code><code>+</code> <code>" columns.\n"</code>     </p> <p><code>            </code><code>"There are "</code> <code>+</code> <code>str</code><code>(mis_val_table_ren_columns.shape[</code><code>0</code><code>]) </code><code>+</code></p> <p><code>              </code><code>" columns that have missing values."</code><code>)</code></p> <p><code>        </code><code>return</code> <code>mis_val_table_ren_columns</code></p> </td></tr></tbody></table> 
<p> </p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> </td><td> <p><code># Missing values statistics</code></p> <p><code>miss_values </code><code>=</code> <code>null_values(df)</code></p> <p><code>miss_values.head(</code><code>20</code><code>)</code></p> </td></tr></tbody></table> 
<p> <img alt="" src="https://images2.imgbox.com/1b/2f/VfOQpi0y_o.png"></p> 
<p>许多列中丢失数据的百分比远远超出了我们的工作范围。 因此，稍后我们必须删除数据量少于总数据量一定百分比的列。<br><br> 我们还要检查的另一件事是，与其他贷款相比，有多少贷款处于违约贷款状态。 在此类数据集中进行预测的常见现象是，新贷款是否会违约。 我将使用违约状态的贷款作为目标变量。</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> </td><td> <p><code>target_list </code><code>=</code> <code>[</code><code>1</code> <code>if</code> <code>i</code><code>=</code><code>=</code><code>'Default'</code> <code>else</code> <code>0</code> <code>for</code> <code>i </code><code>in</code> <code>df[</code><code>'loan_status'</code><code>]]</code></p> <p> </p> <p><code>df[</code><code>'TARGET'</code><code>] </code><code>=</code> <code>target_list</code></p> <p><code>df[</code><code>'TARGET'</code><code>].value_counts()</code></p> </td></tr></tbody></table> 
<p> <img alt="" src="https://images2.imgbox.com/43/4d/tmTaQHt4_o.png"></p> 
<p> 很明显，这是不平衡数据问题的一种情况，其中阶级的价值远远小于另一个。 有用于解决此类问题的基于成本函数的方法和基于抽样的方法，我们稍后将使用它们，以便我们的模型在尝试预测贷款是否会违约时不会表现出高偏差。</p> 
<p> </p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>df.drop(</code><code>'loan_status'</code><code>,axis</code><code>=</code><code>1</code><code>,inplace</code><code>=</code><code>True</code><code>)</code></p> </td></tr></tbody></table> 
<p> 然后，查看我们正在使用的数据类型的分布</p> 
<p><img alt="" src="https://images2.imgbox.com/8d/14/Zdmij9V0_o.png"></p> 
<p> 因此，我们有很多具有对象数据类型的列，这将在建模时造成问题。<br> 让我们看看具有“对象”数据类型的列包含多少分类数据：</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>df.select_dtypes(</code><code>'object'</code><code>).</code><code>apply</code><code>(pd.Series.nunique, axis </code><code>=</code> <code>0</code><code>)</code></p> </td></tr></tbody></table> 
<p> <img alt="" src="https://images2.imgbox.com/2e/a0/YG6HXWL8_o.png"></p> 
<p> 我们希望对仅包含2个分类数据的列进行标签编码，并对超过2个分类数据的一键编码列进行标签编码。 另外，应删除诸如emp_title，url，desc等之类的列，因为它们所包含的任何类别都没有大量唯一数据。 同样，可以对一键编码的列执行主成分分析，以降低特征尺寸。<br><br> 异常值检测<br> 让我们检查数据中是否存在异常。 通常在处理时间（例如工作年限）的列中发现可能的数据异常。 让我们快速通过它们。</p> 
<p> </p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>df[</code><code>'emp_length'</code><code>].head(</code><code>3</code><code>)</code></p> </td></tr></tbody></table> 
<p> <img alt="" src="https://images2.imgbox.com/0a/62/Vglj0Ytb_o.png"></p> 
<p> 我将用0填充空值，前提是借款人没有工作很多年才能记录其数据。 另外，我将使用正则表达式从所有数据中提取年数。</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> </td><td> <p><code>df[</code><code>'emp_length'</code><code>].fillna(value</code><code>=</code><code>0</code><code>,inplace</code><code>=</code><code>True</code><code>)</code></p> <p> </p> <p><code>df[</code><code>'emp_length'</code><code>].replace(to_replace</code><code>=</code><code>'[^0-9]+'</code><code>, value</code><code>=</code><code>'', inplace</code><code>=</code><code>True</code><code>, regex</code><code>=</code><code>True</code><code>)</code></p> <p> </p> <p><code>df[</code><code>'emp_length'</code><code>].value_counts().sort_values().plot(kind</code><code>=</code><code>'barh'</code><code>,figsize</code><code>=</code><code>(</code><code>18</code><code>,</code><code>8</code><code>))</code></p> <p><code>plt.title(</code><code>'Number of loans distributed by Employment Years'</code><code>,fontsize</code><code>=</code><code>20</code><code>)</code></p> <p><code>plt.xlabel(</code><code>'Number of loans'</code><code>,fontsize</code><code>=</code><code>15</code><code>)</code></p> <p><code>plt.ylabel(</code><code>'Years worked'</code><code>,fontsize</code><code>=</code><code>15</code><code>);</code></p> </td></tr></tbody></table> 
<p> </p> 
<p> <img alt="" src="https://images2.imgbox.com/43/22/F7WuRRhX_o.png"></p> 
<p> 该变量看起来不错。 此外，可以看出，工作了10年或以上的人更有可能借贷。</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> </td><td> <p><code>fig </code><code>=</code> <code>plt.figure(figsize</code><code>=</code><code>(</code><code>12</code><code>,</code><code>6</code><code>))</code></p> <p><code>sns.violinplot(x</code><code>=</code><code>"TARGET"</code><code>,y</code><code>=</code><code>"loan_amnt"</code><code>,data</code><code>=</code><code>df, hue</code><code>=</code><code>"pymnt_plan"</code><code>, split</code><code>=</code><code>True</code><code>)</code></p> <p><code>plt.title(</code><code>"Payment plan - Loan Amount"</code><code>, fontsize</code><code>=</code><code>20</code><code>)</code></p> <p><code>plt.xlabel(</code><code>"TARGET"</code><code>, fontsize</code><code>=</code><code>15</code><code>)</code></p> <p><code>plt.ylabel(</code><code>"Loan Amount"</code><code>, fontsize</code><code>=</code><code>15</code><code>);</code></p> </td></tr></tbody></table> 
<p> <img alt="" src="https://images2.imgbox.com/6d/ab/rccx2eAt_o.png"></p> 
<p> 很正常，违约贷款没有偿还付款计划<br><br> 探索性数据分析<br> 让我删除所有丢失数据超过70％的列，因为它们对建模和探索无济于事。</p> 
<p> 建模<br> 现在，对于建模，我将使用两种集成方法并进行比较。<br><br> i）Bootstrap Aggregrating or Bagging<br><br> ii）Boosting<br><br><br> 1）Bagging - Random Forest<br> 集成决策树算法<br><br> 通过套袋方法进行培训（重复抽样替换）<br><br> 装袋：样品中的样品<br> RF：来自预测变量的样本。 m = sqrt（p）用于分类，m = p / 3用于回归问题。<br> 利用不相关的树</p> 
<p> </p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> </td><td> <p><code>from</code> <code>sklearn.ensemble </code><code>import</code> <code>RandomForestClassifier</code></p> <p><code>from</code> <code>sklearn.model_selection </code><code>import</code> <code>cross_val_score, cross_val_predict</code></p> <p><code>from</code> <code>sklearn.metrics </code><code>import</code> <code>accuracy_score, classification_report, confusion_matrix</code></p> </td></tr></tbody></table> 
<p> </p> 
<p> 创建分类器，</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> <p>14</p> <p>15</p> <p>16</p> </td><td> <p><code>#python风控建模实战lendingClub：https://ke.qq.com/course/3063950?tuin=dcbf0baedef print_score(clf, X_train, y_train, X_test, y_test, train=True):</code></p> <p><code>    </code><code>if</code> <code>train:</code></p> <p><code>        </code><code>print</code><code>(</code><code>"Train Result:\n"</code><code>)</code></p> <p><code>        </code><code>print</code><code>(</code><code>"accuracy score: {0:.4f}\n"</code><code>.</code><code>format</code><code>(accuracy_score(y_train, clf.predict(X_train))))</code></p> <p><code>        </code><code>print</code><code>(</code><code>"Classification Report: \n {}\n"</code><code>.</code><code>format</code><code>(classification_report(y_train, clf.predict(X_train))))</code></p> <p><code>        </code><code>print</code><code>(</code><code>"Confusion Matrix: \n {}\n"</code><code>.</code><code>format</code><code>(confusion_matrix(y_train, clf.predict(X_train))))</code></p> <p> </p> <p><code>        </code><code>res </code><code>=</code> <code>cross_val_score(clf, X_train, y_train, cv</code><code>=</code><code>10</code><code>, scoring</code><code>=</code><code>'accuracy'</code><code>)</code></p> <p><code>        </code><code>print</code><code>(</code><code>"Average Accuracy: \t {0:.4f}"</code><code>.</code><code>format</code><code>(np.mean(res)))</code></p> <p><code>        </code><code>print</code><code>(</code><code>"Accuracy SD: \t\t {0:.4f}"</code><code>.</code><code>format</code><code>(np.std(res)))</code></p> <p><code>        </code> </p> <p><code>    </code><code>elif</code> <code>train</code><code>=</code><code>=</code><code>False</code><code>:</code></p> <p><code>        </code><code>print</code><code>(</code><code>"Test Result:\n"</code><code>)       </code></p> <p><code>        </code><code>print</code><code>(</code><code>"accuracy score: {0:.4f}\n"</code><code>.</code><code>format</code><code>(accuracy_score(y_test, clf.predict(X_test))))</code></p> <p><code>        </code><code>print</code><code>(</code><code>"Classification Report: \n {}\n"</code><code>.</code><code>format</code><code>(classification_report(y_test, clf.predict(X_test))))</code></p> <p><code>        </code><code>print</code><code>(</code><code>"Confusion Matrix: \n {}\n"</code><code>.</code><code>format</code><code>(confusion_matrix(y_test, clf.predict(X_test))))  </code></p> </td></tr></tbody></table> 
<p> 划分训练数据和测试数据</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>from</code> <code>sklearn.model_selection </code><code>import</code> <code>train_test_split</code></p> </td></tr></tbody></table> 
<p> </p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>X_train, X_test, y_train, y_test </code><code>=</code> <code>train_test_split(df.drop(</code><code>'TARGET'</code><code>,axis</code><code>=</code><code>1</code><code>),df[</code><code>'TARGET'</code><code>],test_size</code><code>=</code><code>0.15</code><code>,random_state</code><code>=</code><code>101</code><code>)</code></p> </td></tr></tbody></table> 
<p> 释放内存</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> </td><td> <p><code>del</code> <code>start_df</code></p> <p><code>gc.collect()</code></p> </td></tr></tbody></table> 
<p> 通过去除均值并缩放到单位方差来标准化特征</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>from</code> <code>sklearn.preprocessing </code><code>import</code> <code>StandardScaler</code></p> </td></tr></tbody></table> 
<pre>sc = StandardScaler()
X_train = sc.fit_transform(X_train)
X_test=sc.transform(X_test)</pre> 
<p>对训练集进行过采样</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>from</code> <code>imblearn.over_sampling </code><code>import</code> <code>SMOTE</code></p> </td></tr></tbody></table> 
<p> 现在，我将尝试不同的模型以获得最佳的预测分数。<br><br> 使用Logistic回归创建准确性和召回率的基准，</p> 
<p><img alt="" src="https://images2.imgbox.com/ad/37/Es9AcKVU_o.png"></p> 
<p> </p> 
<p> 准确率和召回得分对基线来说是令人满意的。 但是，精度似乎很差。<br><br> 对于我们来说，过度拟合将是一个巨大的问题。 因此，我使用的是随机森林，因为它可以通过随机选择要素来减少过拟合。</p> 
<p> <img alt="" src="https://images2.imgbox.com/0d/e9/RQ2GgLXx_o.png"></p> 
<p> 我们的验证集精度很高，但是召回率却很低。 使用此模型不是一个好主意，因为我们的大多数违约贷款将被错误分类。<br><br> 2）boosting：<br> 训练弱分类器<br> 通过加权将它们添加到最终的强分类器中。 按精度加权（通常）<br> 添加后，数据将重新加权<br> 错误分类的样本会增加体重<br> Algo被迫从错误分类的样本中学习更多<br> 为了提高效率，我将使用LightGBM分类器（评估指标为AUC）以及Kfold交叉验证。</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> </td><td> <p><code>from</code> <code>sklearn.metrics </code><code>import</code> <code>roc_auc_score, roc_curve</code></p> <p><code>from</code> <code>sklearn.model_selection </code><code>import</code> <code>KFold, StratifiedKFold</code></p> <p><code>from</code> <code>lightgbm </code><code>import</code> <code>LGBMClassifier</code></p> </td></tr></tbody></table> 
<p> 结合使用LightGBM和Kfold交叉验证的功能</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> <p>14</p> <p>15</p> <p>16</p> <p>17</p> <p>18</p> <p>19</p> <p>20</p> <p>21</p> <p>22</p> <p>23</p> <p>24</p> <p>25</p> <p>26</p> <p>27</p> <p>28</p> <p>29</p> <p>30</p> <p>31</p> <p>32</p> <p>33</p> <p>34</p> <p>35</p> <p>36</p> <p>37</p> <p>38</p> <p>39</p> <p>40</p> <p>41</p> <p>42</p> <p>43</p> <p>44</p> <p>45</p> <p>46</p> <p>47</p> <p>48</p> <p>49</p> <p>50</p> <p>51</p> <p>52</p> <p>53</p> </td><td> <p><code>#python风控建模实战lendingClub：https://ke.qq.com/course/3063950?tuin=dcbf0baedef kfold_lightgbm(train_df, num_folds, stratified = False):</code></p> <p><code>    </code><code>print</code><code>(</code><code>"Starting LightGBM. Train shape: {}"</code><code>.</code><code>format</code><code>(train_df.shape))</code></p> <p><code>    </code> </p> <p><code>    </code><code># Cross validation model</code></p> <p><code>    </code><code>if</code> <code>stratified:</code></p> <p><code>        </code><code>folds </code><code>=</code> <code>StratifiedKFold(n_splits</code><code>=</code> <code>num_folds, shuffle</code><code>=</code><code>True</code><code>, random_state</code><code>=</code><code>47</code><code>)</code></p> <p><code>    </code><code>else</code><code>:</code></p> <p><code>        </code><code>folds </code><code>=</code> <code>KFold(n_splits</code><code>=</code> <code>num_folds, shuffle</code><code>=</code><code>True</code><code>, random_state</code><code>=</code><code>47</code><code>)</code></p> <p> </p> <p><code>    </code><code>oof_preds </code><code>=</code> <code>np.zeros(train_df.shape[</code><code>0</code><code>])</code></p> <p> </p> <p><code>    </code><code>feature_importance_df </code><code>=</code> <code>pd.DataFrame()</code></p> <p><code>    </code><code>feats </code><code>=</code> <code>[f </code><code>for</code> <code>f </code><code>in</code> <code>train_df.columns </code><code>if</code> <code>f </code><code>not</code> <code>in</code> <code>[</code><code>'TARGET'</code><code>]]</code></p> <p><code>    </code> </p> <p><code>    </code><code># Splitting the training set into folds for Cross Validation</code></p> <p><code>    </code><code>for</code> <code>n_fold, (train_idx, valid_idx) </code><code>in</code> <code>enumerate</code><code>(folds.split(train_df[feats], train_df[</code><code>'TARGET'</code><code>])):</code></p> <p><code>        </code><code>train_x, train_y </code><code>=</code> <code>train_df[feats].iloc[train_idx], train_df[</code><code>'TARGET'</code><code>].iloc[train_idx]</code></p> <p><code>        </code><code>valid_x, valid_y </code><code>=</code> <code>train_df[feats].iloc[valid_idx], train_df[</code><code>'TARGET'</code><code>].iloc[valid_idx]</code></p> <p> </p> <p><code>        </code><code># LightGBM parameters found by Bayesian optimization</code></p> <p><code>        </code><code>clf </code><code>=</code> <code>LGBMClassifier(</code></p> <p><code>            </code><code>nthread</code><code>=</code><code>4</code><code>,</code></p> <p><code>            </code><code>n_estimators</code><code>=</code><code>10000</code><code>,</code></p> <p><code>            </code><code>learning_rate</code><code>=</code><code>0.02</code><code>,</code></p> <p><code>            </code><code>num_leaves</code><code>=</code><code>32</code><code>,</code></p> <p><code>            </code><code>colsample_bytree</code><code>=</code><code>0.9497036</code><code>,</code></p> <p><code>            </code><code>subsample</code><code>=</code><code>0.8715623</code><code>,</code></p> <p><code>            </code><code>max_depth</code><code>=</code><code>8</code><code>,</code></p> <p><code>            </code><code>reg_alpha</code><code>=</code><code>0.04</code><code>,</code></p> <p><code>            </code><code>reg_lambda</code><code>=</code><code>0.073</code><code>,</code></p> <p><code>            </code><code>min_split_gain</code><code>=</code><code>0.0222415</code><code>,</code></p> <p><code>            </code><code>min_child_weight</code><code>=</code><code>40</code><code>,</code></p> <p><code>            </code><code>silent</code><code>=</code><code>-</code><code>1</code><code>,</code></p> <p><code>            </code><code>verbose</code><code>=</code><code>-</code><code>1</code><code>,</code></p> <p><code>            </code><code>)</code></p> <p> </p> <p><code>        </code><code># Fitting the model and evaluating by AUC</code></p> <p><code>        </code><code>clf.fit(train_x, train_y, eval_set</code><code>=</code><code>[(train_x, train_y), (valid_x, valid_y)],</code></p> <p><code>            </code><code>eval_metric</code><code>=</code> <code>'auc'</code><code>, verbose</code><code>=</code> <code>1000</code><code>, early_stopping_rounds</code><code>=</code> <code>200</code><code>)</code></p> <p><code>        </code><code>print_score(clf, train_x, train_y, valid_x, valid_y, train</code><code>=</code><code>False</code><code>)</code></p> <p><code>        </code><code># Dataframe holding the different features and their importance</code></p> <p><code>        </code><code>fold_importance_df </code><code>=</code> <code>pd.DataFrame()</code></p> <p><code>        </code><code>fold_importance_df[</code><code>"feature"</code><code>] </code><code>=</code> <code>feats</code></p> <p><code>        </code><code>fold_importance_df[</code><code>"importance"</code><code>] </code><code>=</code> <code>clf.feature_importances_</code></p> <p><code>        </code><code>fold_importance_df[</code><code>"fold"</code><code>] </code><code>=</code> <code>n_fold </code><code>+</code> <code>1</code></p> <p><code>        </code><code>feature_importance_df </code><code>=</code> <code>pd.concat([feature_importance_df, fold_importance_df], axis</code><code>=</code><code>0</code><code>)</code></p> <p><code>        </code> </p> <p><code>        </code><code># Freeing up memory</code></p> <p><code>        </code><code>del</code> <code>clf, train_x, train_y, valid_x, valid_y</code></p> <p><code>        </code><code>gc.collect()</code></p> <p> </p> <p><code>    </code><code>display_importances(feature_importance_df)</code></p> <p><code>    </code><code>return</code> <code>feature_importance_df</code></p> </td></tr></tbody></table> 
<p> 用于显示变量重要性</p> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> </td><td> <p><code>def</code> <code>display_importances(feature_importance_df_):</code></p> <p><code>    </code><code>cols </code><code>=</code> <code>feature_importance_df_[[</code><code>"feature"</code><code>, </code><code>"importance"</code><code>]].groupby(</code><code>"feature"</code><code>).mean().sort_values(by</code><code>=</code><code>"importance"</code><code>, ascending</code><code>=</code><code>False</code><code>)[:</code><code>40</code><code>].index</code></p> <p><code>    </code><code>best_features </code><code>=</code> <code>feature_importance_df_.loc[feature_importance_df_.feature.isin(cols)]</code></p> <p><code>    </code><code>plt.figure(figsize</code><code>=</code><code>(</code><code>15</code><code>, </code><code>12</code><code>))</code></p> <p><code>    </code><code>sns.barplot(x</code><code>=</code><code>"importance"</code><code>, y</code><code>=</code><code>"feature"</code><code>, data</code><code>=</code><code>best_features.sort_values(by</code><code>=</code><code>"importance"</code><code>, ascending</code><code>=</code><code>False</code><code>))</code></p> <p><code>    </code><code>plt.title(</code><code>'LightGBM Features (avg over folds)'</code><code>)</code></p> <p><code>    </code><code>plt.tight_layout()</code></p> <p><code>    </code><code>plt.savefig(</code><code>'lgbm_importances.png'</code><code>)</code></p> </td></tr></tbody></table> 
<pre>feat_importance = kfold_lightgbm(df, num_folds= 3, stratified= False)</pre> 
<p> <img alt="" src="https://images2.imgbox.com/d1/dd/uQ7Dkioc_o.png"></p> 
<p><img alt="" src="https://images2.imgbox.com/f8/d8/3kTRxy0q_o.png"></p> 
<p><img alt="" src="https://images2.imgbox.com/c7/52/lj9jTMgM_o.png"></p> 
<p><img alt="" src="https://images2.imgbox.com/de/b8/EbPkJUaC_o.png"></p> 
<p><img alt="" src="https://images2.imgbox.com/34/6a/9J0uJcCO_o.png"></p> 
<p>如我们所见，LightGBM在获得高精度和高召回率方面做得非常出色。 因此，就我们评估的3个模型而言，该模型是最好的。<br> 为了进一步增强模型，可以进行特征工程。 还可以通过将不同的贷款状态放在一起来使用诸如“好贷款”和“坏贷款”之类的更广泛的术语，以获得更均衡的类别计数，而不是违约/非违约。</p> 
<p> 此课程采用catboost对称树算法比LightGBM更不容易过度拟合。</p> 
<p>欢迎各位学员报名系列课，学习更多金融建模知识</p> 
<p><strong>python金融风控模型模型和数据分析微专业课</strong><br><a href="https://edu.csdn.net/combo/detail/1927">https://edu.csdn.net/combo/detail/1927</a></p> 
<p> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b67794e082667e564a0d8a768649a399/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python 文本框位置_python：TKinter获取Text文本框的输入内容</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c6deb462884469d19f35497c86835286/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mysql_query(&#34;set names &#39;utf8&#39;);_mysql_query(&#39;set names utf8&#39;);和header(&#39;Content-type:text/html; chars...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>