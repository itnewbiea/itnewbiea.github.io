<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>react-native的各种坑 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="react-native的各种坑" />
<meta property="og:description" content="一，Could not resolve all files for configuration &#39;:app:releaseCompileClasspath react-native版本：0.57.1
这个问题原本不是rn版本的问题，原因是0.57.1将Android SDK的版本更新到27了。
先来看下错误日志： &gt; Task :app:preReleaseBuild FAILED
FAILURE: Build failed with an exception.
* What went wrong:
Could not resolve all files for configuration &#39;:app:releaseCompileClasspath&#39;.
&gt; Could not find support-vector-drawable.aar (com.android.support:support-vector-drawable:27.1.1).
Searched in the following locations:
https://jcenter.bintray.com/com/android/support/support-vector-drawable/27.1.1/support-vector-drawable-27.1.1.aar
&gt; Could not find livedata-core.aar (android.arch.lifecycle:livedata-core:1.1.0).
Searched in the following locations:
https://jcenter.bintray.com/android/arch/lifecycle/livedata-core/1.1.0/livedata-core-1.1.0.aar
&gt; Could not find viewmodel.aar (android.arch.lifecycle:viewmodel:1.1.0).
Searched in the following locations:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/a5d541636d3cf70e23be4fadc4505160/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-11-06T11:40:02+08:00" />
<meta property="article:modified_time" content="2019-11-06T11:40:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">react-native的各种坑</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <h4><strong>一，Could not resolve all files for configuration ':app:releaseCompileClasspath</strong></h4> 
</blockquote> 
<p>react-native版本：0.57.1</p> 
<p>这个问题原本不是rn版本的问题，原因是0.57.1将Android SDK的版本更新到27了。</p> 
<p>先来看下错误日志： <br> &gt; Task :app:preReleaseBuild FAILED<br>  <br> FAILURE: Build failed with an exception.<br>  <br> * What went wrong:<br> Could not resolve all files for configuration ':app:releaseCompileClasspath'.<br> &gt; Could not find support-vector-drawable.aar (com.android.support:support-vector-drawable:27.1.1).<br>   Searched in the following locations:<br>       https://jcenter.bintray.com/com/android/support/support-vector-drawable/27.1.1/support-vector-drawable-27.1.1.aar<br> &gt; Could not find livedata-core.aar (android.arch.lifecycle:livedata-core:1.1.0).<br>   Searched in the following locations:<br>       https://jcenter.bintray.com/android/arch/lifecycle/livedata-core/1.1.0/livedata-core-1.1.0.aar<br> &gt; Could not find viewmodel.aar (android.arch.lifecycle:viewmodel:1.1.0).<br>   Searched in the following locations:<br>       https://jcenter.bintray.com/android/arch/lifecycle/viewmodel/1.1.0/viewmodel-1.1.0.aar<br> &gt; Could not find runtime.aar (android.arch.core:runtime:1.1.0).<br>   Searched in the following locations:<br>       https://jcenter.bintray.com/android/arch/core/runtime/1.1.0/runtime-1.1.0.aar<br>  <br> * Try:<br> Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.<br>  <br> * Get more help at https://help.gradle.org<br>  <br> Deprecated Gradle features were used in this build, making it incompatible with Gradle 5.0.<br> Use '--warning-mode all' to show the individual deprecation warnings.<br> See https://docs.gradle.org/4.10.1/userguide/command_line_interface.html#sec:command_line_warnings<br>  <br> BUILD FAILED in 14s<br> 11 actionable tasks: 1 executed, 10 up-to-date<br> 这个是只有打包apk时才会出现的错误，需要注意两个地方来确定你的错误和我遇到的是同一类错误：</p> 
<p>1.":app:releaseCompileClasspath"；</p> 
<p>2."com.android.support:support-vector-drawable:27.1.1"。</p> 
<p>解决方案： <br> 1.修改android/build.gradle中google()方法的位置，见下方代码注释；</p> 
<p>2.如果还不行，就升级gradle版本到4.10.1（我使用的版本，不确定别的版本是否可用）。</p> 
<p>// Top-level build file where you can add configuration options common to all sub-projects/modules.<br>  <br> buildscript {<!-- --><br>     ext {<!-- --><br>         buildToolsVersion = "27.0.3"<br>         minSdkVersion = 16<br>         compileSdkVersion = 27<br>         targetSdkVersion = 26<br>         supportLibVersion = "27.1.1"<br>     }<br>     repositories {<!-- --><br>         google()<br>         jcenter()<br>         maven {<!-- --><br>             url 'https://maven.google.com/'<br>             name 'Google'<br>         }<br>     }<br>     dependencies {<!-- --><br>         classpath 'com.android.tools.build:gradle:3.1.4'<br>  <br>         // NOTE: Do not place your application dependencies here; they belong<br>         // in the individual module build.gradle files<br>     }<br> }<br>  <br> allprojects {<!-- --><br>     repositories {<!-- --><br>         google() // new<br>         mavenLocal()<br>         jcenter()<br>         maven {url "https://jitpack.io"}<br>         maven {<!-- --><br>             // All of React Native (JS, Obj-C sources, Android binaries) is installed from npm<br>             url "$rootDir/../node_modules/react-native/android"<br>         }<br>         maven {url "https://maven.google.com"}<br>         // google() // old<br>     }<br> }<br>  <br>  <br> task wrapper(type: Wrapper) {<!-- --><br>     gradleVersion = '4.10.1'<br>     distributionUrl = distributionUrl.replace("bin", "all")<br> }</p> 
<p> </p> 
<blockquote> 
 <h4><br><strong> 二，常见错误 Could not install the app on the device</strong></h4> 
</blockquote> 
<p> </p> 
<p>1.新clone的项目，运行之后报这个错误</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/17/40/XKGzk09V_o.png"></p> 
<p>解决办法：</p> 
<p>在项目根目录下执行以下命令：</p> 
<p>命令：chmod 755 android/gradlew</p> 
<p> </p> 
<blockquote> 
 <h2>三，Could not resolve all files for configuration ':classpath'.问题解决</h2> 
</blockquote> 
<p>今天，使用Android Studio 3.0.1 打开下载的工程项目，build project时结果报错，如下：</p> 
<p>Error:A problem occurred configuring root project 'apptest'.<br> &gt; Could not resolve all files for configuration ':classpath'.<br>    &gt; Could not resolve com.android.tools.build:gradle:3.0.0.<br>      Required by:<br>          project :<br>       &gt; Could not resolve com.android.tools.build:gradle:3.0.0.<br>          &gt; Could not get resource 'https://dl.google.com/dl/android/maven2/com/android/tools/build/gradle/3.0.0/gradle-3.0.0.pom'.<br>             &gt; Could not GET 'https://dl.google.com/dl/android/maven2/com/android/tools/build/gradle/3.0.0/gradle-3.0.0.pom'.<br>                &gt; sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException:unable to find valid certification path to requested target</p> 
<p>解决办法为将com.android.tools.build:gradle的版本号和Android studio的版本号一致。</p> 
<p><em><strong>注意：如何查看android studio版本：菜单栏 &gt; Help &gt; About  即可查看</strong></em></p> 
<h2>四，react-native run-android Build failed报错(:app:processDebugManifest FAILED)</h2> 
<blockquote> 
 <p>命令行输入react-native run-android 的时候build失败，如下所示：</p> 
</blockquote> 
<pre class="has"><code> :app:processDebugManifest FAILED

FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':app:processDebugManifest'.
&gt; Manifest merger failed : Attribute application@allowBackup value=(false) from AndroidManifest.xml:12:7-34
        is also present at [AwesomeProject:react-native-splash-screen:unspecified] AndroidManifest.xml:12:9-35 value=(true).
        Suggestion: add 'tools:replace="android:allowBackup"' to &lt;application&gt; element at AndroidManifest.xml:8:5-25:19 to override.

* Try:
Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output.

BUILD FAILED
</code></pre> 
<h4>解决办法：</h4> 
<p>一、方法一</p> 
<p>仔细看上面报错日志可以看到给的建议，“【Suggestion: add 'tools:replace="android:allowBackup"' to &lt;application&gt; element at AndroidManifest.xml:8:5-25:19 to override.】”</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/b9/d0/7PwYxsM7_o.png"></p> 
<p><br> 打开上图所示路径下的AndroidMainfest.xml文件，在manifest的属性中添加“ xmlns:tools="<a href="https://link.jianshu.com?t=http%3A%2F%2Fschemas.android.com%2Ftools" rel="nofollow">http://schemas.android.com/tools</a>"”，如下所示：</p> 
<ul><li>添加前</li></ul> 
<pre class="has"><code>&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.awesomeproject"&gt;
</code></pre> 
<ul><li>添加后：</li></ul> 
<pre class="has"><code>&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    package="com.awesomeproject"&gt;
</code></pre> 
<p>然后在&lt;application&gt;&lt;/application&gt;上添加“tools:replace="android:allowBackup"”，如下所示：</p> 
<ul><li>添加前：</li></ul> 
<pre class="has"><code>&lt;application
      android:name=".MainApplication"
      android:label="@string/app_name"
      android:icon="@mipmap/ic_launcher"
      android:allowBackup="false"
      android:theme="@style/AppTheme"&gt;其他代码&lt;/application&gt;
</code></pre> 
<ul><li>添加后：</li></ul> 
<pre class="has"><code>&lt;application
      android:name=".MainApplication"
      android:label="@string/app_name"
      android:icon="@mipmap/ic_launcher"
      android:allowBackup="false"
      tools:replace="android:allowBackup"
      android:theme="@style/AppTheme"&gt;其他代码&lt;/application&gt;
</code></pre> 
<p>二、方法二</p> 
<p>同样是在AndroidMainfest.xml中修改，只需要修改&lt;application&gt;&lt;/application&gt;中的“android:allowBackup="false"”为“android:allowBackup="true"”就好</p> 
<ul><li>修改前：</li></ul> 
<pre class="has"><code>&lt;application
      android:name=".MainApplication"
      android:label="@string/app_name"
      android:icon="@mipmap/ic_launcher"
      android:allowBackup="false"
      android:theme="@style/AppTheme"&gt;其他代码&lt;/application&gt;
</code></pre> 
<ul><li>修改后：</li></ul> 
<pre class="has"><code>&lt;application
      android:name=".MainApplication"
      android:label="@string/app_name"
      android:icon="@mipmap/ic_launcher"
      android:allowBackup="true"
      android:theme="@style/AppTheme"&gt;其他代码&lt;/application&gt;
</code></pre> 
<blockquote> 
 <h4>五，使用React-native link的背景</h4> 
</blockquote> 
<p>并不是所有的 APP 都需要使用全部的原生功能，包含支持全部特性的代码会增大应用的体积。但我们仍然希望能让你简单地根据自己的需求添加需要的特性。<br> 在这种思想下，我们把许多特性都发布成为互不相关的静态库。<br> 大部分的库只需要拖进两个文件就可以使用了，偶尔你还需要几步额外的工作，但不会再有更多的事情要做了。<br> 我们随着 React Native 发布的所有库都在仓库中的Libraries文件夹下。其中有一些是纯 Javascript 代码，你只需要去import它们就可以使用了。另外有一些库基于一些原生代码实现，你必须把这些文件添加到你的应用，否则应用会在你使用这些库的时候产生报错。</p> 
<p>2.具体使用React-native link的步骤：<br> （1）.下载某个库到本地</p> 
<p>npm install ******<br> 1<br> （2）.链接某个库到项目中</p> 
<p>react-native link *****<br> 1<br> （3）.到此就成功的链接到ios和android项目中了</p> 
<blockquote> 
 <h4><br><strong>六sdk.dir sdk路径配置</strong></h4> 
</blockquote> 
<p><strong>problem occurred configuring project ':app'.<br> SDK location not found. Define location with sdk.dir in the local.properties file or with an ANDROID_HOME environment</strong><br><img alt="在这里插入图片描述" class="has" src="https://images2.imgbox.com/99/38/UobljjyP_o.png"></p> 
<blockquote> 
 <h4><strong>七，开发项目中的问题</strong></h4> 
</blockquote> 
<p> </p> 
<p><strong>绝对定位元素被键盘顶起</strong></p> 
<p><strong>打开android工程，在AndroidManifest.xml中配置如下：<br>  android:windowSoftInputMode=“stateAlwaysHidden|adjustPan”<br> 1<br> StatusBar 主题污染<br> componentDidMount() {<!-- --><br>     this._navListener = this.props.navigation.addListener('didFocus', () =&gt; {<!-- --><br>       StatusBar.setBarStyle('dark-content');<br>     });<br>   }<br>   componentWillUnmount() {<!-- --><br>     this._navListener.remove();<br>   }<br><br> React Native Text截断<br> 显示数字加粗后最后一位无法显示问题，添加<br> fontFamily: 'System'<br> 使用Button进行路由跳转时报错</strong></p> 
<p><strong>这个错误一般只在开启Debug JS Remotely时出现，可以通过使用TouchableOpacity包裹或替换解决</strong></p> 
<p><strong>to be continue</strong></p> 
<blockquote> 
 <h4>八，AndroidStudio SSL peer shut down incorrectly 问题</h4> 
</blockquote> 
<p>AndroidStudio 编译时出现如下问题 <code>SSL peer shut down incorrectly</code> 或者某些jar包下载不下来，一般是因为墙的原因导致的。这时候我们就需要配置镜像来解决这个问题。（为了提高jar包的下载速度也可以配置）配置的方法就是在根build.gradle中添加镜像仓库，一般我们选择阿里的 <code>http://maven.aliyun.com/nexus/content/groups/public/</code>完整的如下所示</p> 
<pre class="has"><code>buildscript {

    repositories {
        google()
        maven { url 'http://maven.aliyun.com/nexus/content/groups/public/' }
        jcenter()
    }
    dependencies {
        classpath 'com.android.tools.build:gradle:3.2.1'
    }
}

allprojects {
    repositories {
        google()
        maven { url 'http://maven.aliyun.com/nexus/content/groups/public/' }
        jcenter()
    }
}

task clean(type: Delete) {
    delete rootProject.buildDir
}
</code></pre> 
<h3><em>这里需要注意要将jcenter放到最后一个，因为他就是那个下载慢，或者报错的罪魁祸首</em></h3> 
<p><br>  </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e39c0651def50d165a21c7181ac945c0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Git下载（下载失败解决方式）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/17bd766c994f792371be289dc05e7ec4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">为什么要报考系统架构设计师考试</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>