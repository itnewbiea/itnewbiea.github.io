<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Pandas教程（三）—— 数据清洗与准备 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Pandas教程（三）—— 数据清洗与准备" />
<meta property="og:description" content="1.处理缺失值 1.1 数据删除函数 作用：删除Dataframe某行或某列的数据 语法：df.drop（ labels = [ ] ）
drop函数的几个参数：
labels =：接收一个列表，内含删除行 / 列的索引编号或索引名
axis =：删除的轴向 0代表删除行；1代表删除列
inplace =：是否改变原数组 默认False 即生成一个新数组
1.2 缺失值的查看 方法 描述
df.isnull（）返回一个布尔数组，是缺失值就显示Truedf.notnull（）返回一个布尔数组，是缺失值就显示False 1.3 过滤缺失值 作用：删除缺失值所在的行 / 列
语法：df.dropna（ axis=0, how=&#39;any&#39;, thresh=None, subset=None, inplace=False ）
dropna函数的几个参数：
axis =：0代表删除包含缺失值的行；1代表删除包含缺失值的列
how=：“any”代表删除有缺失值的行 / 列 ； “all”代表删除所有值均缺失的行 / 列
thresh=：行 / 列中若达不到thresh个非缺失值，就删除
subset=：输入一个含索引名称的list，代表对这些列的空值进行删除
1.4 填充缺失值 作用：将缺失值补全为指定的值
语法：df.fillna（value, method=None, axis=None, inplace=False, limit=None）
fillna函数的几个参数：
value：填充的值，也可输入一个字典（用于为不同的列设置不同的填充值）
method：填充方法 “ffill”用前面的值填充 “bfill”用后面的值填充
axis：修改填充的轴
limt：最大填充数
2. 数据转换方法 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/897a0e6472db9a9aa0a3287da274199d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-27T21:11:24+08:00" />
<meta property="article:modified_time" content="2023-12-27T21:11:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Pandas教程（三）—— 数据清洗与准备</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>1.处理缺失值</h2> 
<h4></h4> 
<h4> 1.1 数据删除函数</h4> 
<p>    作用：删除Dataframe某行或某列的数据 </p> 
<p>    语法：<strong><span style="background-color:#f9eda6;">df.drop（ labels = [ ] ）</span></strong></p> 
<blockquote> 
 <p><strong>drop函数的几个参数：</strong></p> 
 <p></p> 
 <p>         labels =：接收一个列表，内含删除行 / 列的索引编号或索引名</p> 
 <p>         axis =：删除的轴向   0代表删除行；1代表删除列</p> 
 <p>        <span style="background-color:#c7e6ea;"> <strong>inplace =：是否改变原数组    默认False 即生成一个新数组</strong></span></p> 
</blockquote> 
<p></p> 
<h4> 1.2 缺失值的查看</h4> 
<table border="2" cellpadding="1" cellspacing="1" style="width:500px;"><thead><tr><th>方法</th><th> <p>描述</p> </th></tr></thead><tbody><tr><td>df.isnull（）</td><td>返回一个布尔数组，是缺失值就显示True</td></tr><tr><td>df.notnull（）</td><td>返回一个布尔数组，是缺失值就显示False</td></tr></tbody></table> 
<p></p> 
<p></p> 
<h4> 1.3 过滤缺失值 </h4> 
<p>     作用：删除缺失值所在的行 / 列</p> 
<p>     语法：<strong><span style="background-color:#f9eda6;">df.dropna（ axis=0, how='any', thresh=None, subset=None, inplace=False ）</span></strong></p> 
<blockquote> 
 <p></p> 
 <p><strong>dropna函数的几个参数：</strong></p> 
 <p></p> 
 <p>         axis =：0代表删除包含缺失值的行；1代表删除包含缺失值的列</p> 
 <p>         how=：“any”代表删除有缺失值的行 / 列 ； “all”代表删除所有值均缺失的行 / 列</p> 
 <p>         thresh=：行 / 列中若达不到thresh个非缺失值，就删除</p> 
 <p>       <strong><span style="background-color:#c7e6ea;">  subset=</span></strong><span style="background-color:#c7e6ea;">：输入一个含索引名称的list，代表对这些列的空值进行删除</span></p> 
</blockquote> 
<p></p> 
<p></p> 
<h4> 1.4 填充缺失值</h4> 
<p>     作用：将缺失值补全为指定的值</p> 
<p>     语法：<strong><span style="background-color:#f9eda6;">df.fillna（value, method=None, axis=None, inplace=False, limit=None）</span></strong></p> 
<blockquote> 
 <p></p> 
 <p><strong>fillna函数的几个参数：</strong></p> 
 <p></p> 
 <p>         value：填充的值，也可输入一个字典（用于为不同的列设置不同的填充值）</p> 
 <p>         method：填充方法   “ffill”用前面的值填充    “bfill”用后面的值填充</p> 
 <p>         axis：修改填充的轴</p> 
 <p>         limt：最大填充数</p> 
</blockquote> 
<p></p> 
<p></p> 
<p></p> 
<h2>2. 数据转换方法</h2> 
<h4></h4> 
<h4> 2.1 删除和提取重复值</h4> 
<p><strong>   2.1.1 查看元素个数</strong></p> 
<ul><li> 语法：<strong><span style="background-color:#f9eda6;">df [ 列名 ] . value_counts()</span></strong></li><li><span style="background-color:#c7e6ea;"> 与count（）函数的区别：前者是返回各个元素的个数，后者时返回该列中所有元素的总数</span></li></ul> 
<h4></h4> 
<h4></h4> 
<p><strong>   2.1.2 删除重复值</strong></p> 
<ul><li> 语法：<strong><span style="background-color:#f9eda6;"> df.drop_duplicates(subset=None, keep='first', inplace=False)</span></strong></li></ul> 
<blockquote> 
 <p><strong>参数说明</strong></p> 
 <p>        subset：输入一个list，用来要操作的列，默认是所有列</p> 
 <p>       <span style="color:#494949;"><span style="background-color:#c7e6ea;"> keep：指定处理重复值的方法</span>      </span></p> 
 <p><span style="color:#494949;">                   “first” 指保留第一次出现的值      “last” 指保留最后一次出现的值</span></p> 
 <p><span style="color:#494949;">                   “False” 不保留重复值，全部删除</span></p> 
</blockquote> 
<p></p> 
<p><strong>   2.1.3 提取重复值</strong></p> 
<ul><li> 语法：<span style="background-color:#f9eda6;">df [ df.duplicated(subset=None, keep='first') ] </span></li><li> 原理：相当于运用了索引切片的操作，中括号内的函数用来判断是否为重复值 </li></ul> 
<p></p> 
<p>   </p> 
<p></p> 
<h4 style="background-color:transparent;"> 2.2 数据替换</h4> 
<p><strong>   2.2.1 元素替换</strong></p> 
<ul><li>语法：<strong><span style="background-color:#f9eda6;">df.replace（被替换的元素，替换元素）</span></strong></li><li>注意： 1）如果要一次替换多个不同的值，可以利用列表或者字典</li><li>            2）如果想仅对某列替换，先利用df [ ] 切片即可</li></ul> 
<p></p> 
<p><strong>   2.2.2 字符串替换 </strong></p> 
<ul><li> 语法：<strong><span style="background-color:#f9eda6;">df.str.replace（被替换的字符串，替换字符串）</span></strong></li><li> 区别：它是对字符串进行按元素替代的，<strong>可以对字符串切片后进行替换操作</strong></li></ul> 
<p>        例如：“山东省” 一&gt; “山西省”，该方法就可直接替换“东” 一&gt;“西”，这对于操作长数据非常方便</p> 
<p></p> 
<p></p> 
<h4 style="background-color:transparent;"> 2.3 离散化和分箱 </h4> 
<p>        连续值经常需要离散化，或者分离成“箱子”进行处理。即：分组</p> 
<p>   <strong>2.3.1 指定分界点分箱</strong></p> 
<ul><li> 语法：<span style="color:#0d0016;"><strong><span style="background-color:#f9eda6;">pd.cut  (</span></strong></span><span style="color:#ed7976;"><strong><span style="background-color:#f9eda6;">x, bins</span></strong></span><span style="color:#0d0016;"><strong><span style="background-color:#f9eda6;">, right=True, labels=None, precision=3, include_lowest=False)</span></strong></span></li></ul> 
<blockquote> 
 <p>参数说明：</p> 
 <p>        <strong>  </strong></p> 
 <p><strong>          x：    待切割的一维数组或列表对象</strong></p> 
 <p>         <strong> bins：   切割箱 </strong>     若输入一个整数，则定义了x宽度范围内的等宽面元数量；</p> 
 <p>                                        若输入一个序列，则代表分界点</p> 
 <p>          right：   是否为左开右闭区间</p> 
 <p>          <span style="background-color:#c7e6ea;">labels：   自定义箱子名称 </span>    传入数组或列表（与箱子等长）</p> 
 <p>          precision：  箱子精度            保留几位小数</p> 
 <p style="margin-left:0;">          include_lowest：第一个区间的左端点是否包含            </p> 
 <p>       </p> 
</blockquote> 
<p> </p> 
<p></p> 
<p><strong>   2.3.2 等宽（频）分箱</strong></p> 
<ul><li> 作用：保证每个箱子的样本数一样</li><li> 语法：<span style="color:#0d0016;"><strong><span style="background-color:#f9eda6;">pandas.qcut  ( x, q, labels=None, precision=3 )</span></strong></span></li></ul> 
<blockquote> 
 <p>参数说明：</p> 
 <p><strong>          q：整数（分成几份）</strong>  或  <strong> 分位数（0~1）组成的数组（分割点）</strong></p> 
</blockquote> 
<p></p> 
<p><strong>   2.3.3 补充说明</strong> </p> 
<p>     1）以上两个函数会返回一个Categorical对象，会显示每个元素对应的箱名</p> 
<p>     2）对于返回的Categorical对象，可以结合数学统计函数去做数据统计</p> 
<pre><code class="language-python">import pandas as pd
year = [1992,1985,1937,2005,2015,1999] #数据
box = [1930,1960,1990,2020]    #箱子
box_name=["初期","中期","后期"]  #定义箱子名

result1 = pd.cut(year,box,labels=box_name)  #按指定的箱分割，并指定箱名
print(result1)
print("-"*30)
print(result1.describe()) #做数据统计
print("-"*30)

result2 = pd.qcut(year,3) #分成三段
print(result2)</code></pre> 
<p> </p> 
<p></p> 
<h4 style="background-color:transparent;"> 2.4 其他数据转化操作</h4> 
<table border="2" cellpadding="1" cellspacing="1" style="width:600px;"><thead><tr><th style="width:160px;">操作</th><th style="width:167px;">方法</th><th style="width:271px;">参数</th></tr></thead><tbody><tr><td style="width:160px;">实现one hot encode</td><td style="width:167px;">get_dummies(data)</td><td style="width:271px;"> <p>columns：需要转换的列</p> <p>prefix：转换后列名的前缀</p> </td></tr><tr><td style="width:160px;">随机抽取子集</td><td style="width:167px;">df.sample（n=）</td><td style="width:271px;"> <p></p> <p>replace：取出后是否放回（默认不放回)</p> <p>n：抽取的样本数（列数目）</p> <p></p> </td></tr><tr><td style="width:160px;">重命名轴索引</td><td style="width:167px;">df.rename（index= ，    columns=）</td><td style="width:271px;">可以输入字典{ 旧索引名：新索引名  }</td></tr></tbody></table> 
<p> </p> 
<ul><li>one hot encode（独热编码）：   将离散型特征的每一种取值都看成一种状态 </li></ul> 
<figure class="image"> 
 <img alt="" src="https://images2.imgbox.com/27/e1/T3wHgDQn_o.png"> 
 <figcaption>
   正常 
 </figcaption> 
</figure> 
<figure class="image right"> 
 <img alt="" height="146" src="https://images2.imgbox.com/af/8d/eknsfllV_o.png" width="406"> 
 <figcaption>
   one hot encode 
 </figcaption> 
</figure> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<h2 style="background-color:transparent;">3.字符串操作</h2> 
<h4> 3.1 字符串常用方法</h4> 
<p class="img-center"><img alt="" height="277" src="https://images2.imgbox.com/52/35/Y1uJN2e0_o.jpg" width="610"></p> 
<div class="img-center"> 
 <figure class="image"> 
  <img alt="" height="250" src="https://images2.imgbox.com/05/50/1jpU8UG8_o.jpg" width="831"> 
  <figcaption>
    python常用字符串方法 
  </figcaption> 
 </figure> 
</div> 
<p> </p> 
<pre><code class="language-python">import pandas as pd
str = "a / b/   wow"
new = str.split("/")
print(new)    # 按符号拆分字符串   ['a ', ' b', '   wow']

piece = [x.strip() for x in new]
print(piece)  # 与strip搭配使用 ，去除空格   ['a', 'b', 'wow']

jia = "--".join(piece)
print(jia)    # 将字符串用符号拼接起来   a--b--wow

print(jia.index("-")) # 返回“-”第一次出现的位置  1</code></pre> 
<p></p> 
<p></p> 
<h4> 3.2 正则表达式</h4> 
<p>        正则表达式是一组由字母和符号组成的特殊文本，用于<span style="background-color:#f9eda6;">在文本中灵活的查找我们想要的格式的字符串</span>，例如在一封邮件中提取所有的电话，在一篇文章中提取所有的地址</p> 
<p> </p> 
<p><strong>   3.2.1 正则表达式的常用函数</strong></p> 
<p>          要使用正则表达式函数，首先要导入re模块：<strong><span style="background-color:#f9eda6;">import re</span></strong></p> 
<table border="2" cellpadding="1" cellspacing="1" style="width:600px;"><thead><tr><th style="width:216px;background-color:rgb(170,170,170);">函数</th><th style="width:382px;background-color:rgb(170,170,170);">描述</th></tr></thead><tbody><tr><td style="width:216px;">re.compile（）</td><td style="width:382px;">编译正则表达式，用其他函数再调用正则表达式，就不用重复编译了，提高效率</td></tr><tr><td style="width:216px;"><span style="background-color:#c7e6ea;">re.spilt（“分隔符”，data）</span></td><td style="width:382px;">通过指定的分隔符将字符串拆分</td></tr><tr><td style="width:216px;"> <p><strong><span style="background-color:#c7e6ea;">re.findall（正则表达式，data）</span></strong></p> </td><td style="width:382px;"> <p style="margin-left:0;">匹配出字符串中所有符合正则表达式的值，并且以列表的形式返回</p> </td></tr><tr><td style="width:216px;">re.sub（old，new）</td><td style="width:382px;"> <p style="margin-left:0;">替换字符串</p> <p style="margin-left:0;">比replace好处：可以在 "[ ]" 内输入多个符号，同时被取代 </p> </td></tr><tr><td style="width:216px;"> <p>re.search（正则表达式，data）</p> </td><td style="width:382px;">返回文本中第一个匹配项</td></tr><tr><td style="width:216px;">re.match（正则表达式，data）</td><td style="width:382px;">仅从字符串起始位置开始匹配，若满足要求则返回</td></tr></tbody></table> 
<p> </p> 
<p> </p> 
<p><strong>   3.2.2 正则表达式基础语法</strong></p> 
<p><img alt="" src="https://images2.imgbox.com/08/34/lzLiNrSG_o.png"></p> 
<p style="text-align:center;"><img alt="" height="363" src="https://images2.imgbox.com/3e/1c/1jww2uaj_o.png" width="674"> </p> 
<p> </p> 
<ul><li>贪婪与非贪婪</li></ul> 
<p style="margin-left:0;"><strong><span style="color:#fa0000;">       1）贪婪：</span></strong><strong>'[a-zA-Z]{3,5}'</strong>    一&gt;  要求找连续的3~5个字母</p> 
<blockquote> 
 <p style="margin-left:0;"><strong>    </strong>              先找三个连续的字母，最多找到5个连续的字母后停止；在3个以后且5个以内发</p> 
 <p style="margin-left:0;">           现了不是字母的也停止。然后接着找下一个</p> 
</blockquote> 
<p style="margin-left:0;"><strong>       2）非贪婪：</strong> <strong>'[a-zA-Z]{3}'</strong>     一&gt;   找连续的3个字母，找到3个就停止，接着下一个</p> 
<p style="margin-left:0;"></p> 
<pre><code class="language-python"># 提取字符串a中所有的数字
import re
a = '孙悟空7猪八戒6沙和尚3唐僧6白龙马'
r = re.findall('[0-9]',a)
print(r)                   # 返回结果：['7', '6', '3', '6']


# 找到字符串中间字母不是d或e的单词
a = 'xyz,xcz,xfz,xdz,xaz,xez'
r = re.findall('x[^de]z',a)
print(r)                   # 返回：['xyz', 'xcz', 'xfz', 'xaz']      


# 提取特殊字符、空格、\n、\t等
import re
a = 'Excel 12345Word\n23456_PPT12lr'
r = re.findall('\W',a)
print(r)       </code></pre> 
<p> </p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6f80bf9631a6100b73c67f6431ac253c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">fpga xvc 调试实现，支持多端口同时调试多颗FPGA芯片</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/70bd0d84443a9ed40f3131322db0804c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">深度学习 | DRNN、BRNN、LSTM、GRU</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>