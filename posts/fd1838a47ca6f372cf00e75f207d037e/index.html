<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>HDU-5895 Mathematician QSC - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="HDU-5895 Mathematician QSC" />
<meta property="og:description" content="题目大意：
已知f[0] = 0, f[1] = 1, f[i] = f[i-1] * 2 &#43; f[i-2]，且g[n] = g[n-1] &#43; f[n] * f[n]，现在给出n，y，x，s，问你x^(g[n*y]) mod (s &#43; 1)的值为多少。
解题思路：
首先可以得到的是g[n] = f[n] * f[n&#43;1] / 2
证明方式就是xjb打表加上猜加上数学归纳法，别问我怎么猜到的我是用了这个网站http://oeis.org/
因此g[n]可以很轻松的得到了。那么现在的问题就是a^b mod p的值应该怎么求
这里提供一份关于求解这个值的非常详细的博客：传送门
代码：
#include &lt;cstdio&gt; #include &lt;cstring&gt; #include &lt;algorithm&gt; using namespace std; typedef long long LL; typedef pair&lt;LL, LL&gt; pi; LL euler(LL n) { LL ans = n; for (LL i = 2; i * i &lt;= n; &#43;&#43;i) { if (n % i == 0) { ans -= ans / i; while (n % i == 0) n /= i; } } if (n &gt; 1) ans -= ans / n; return ans; } LL fastMul(LL a, LL b, LL mod) { LL ans = 1; while (b) { if (b &amp; 1) ans = (ans * a) % mod; b &gt;&gt;= 1; a = (a * a) % mod; } return ans; } pi fastMatrix(LL n, LL mod) { LL t11, t12, t21, t22; LL bas[4] = {2, 1, 1, 0}; LL ans[4] = {1, 0, 0, 1}; while (n) { if (n &amp; 1) { t11 = ((ans[0] * bas[0]) % mod &#43; (ans[1] * bas[2]) % mod) % mod; t12 = ((ans[0] * bas[1]) % mod &#43; (ans[1] * bas[3]) % mod) % mod; t21 = ((ans[2] * bas[0]) % mod &#43; (ans[3] * bas[2]) % mod) % mod; t22 = ((ans[2] * bas[1]) % mod &#43; (ans[3] * bas[3]) % mod) % mod; ans[0] = t11; ans[1] = t12; ans[2] = t21; ans[3] = t22; } n &gt;&gt;= 1; t11 = ((bas[0] * bas[0]) % mod &#43; (bas[1] * bas[2]) % mod) % mod; t12 = ((bas[0] * bas[1]) % mod &#43; (bas[1] * bas[3]) % mod) % mod; t21 = ((bas[2] * bas[0]) % mod &#43; (bas[3] * bas[2]) % mod) % mod; t22 = ((bas[2] * bas[1]) % mod &#43; (bas[3] * bas[3]) % mod) % mod; bas[0] = t11; bas[1] = t12; bas[2] = t21; bas[3] = t22; } return make_pair(ans[0], ans[2]); } LL solve(LL n, LL y, LL x, LL s) { LL eul = euler(s &#43; 1); pi tmp = fastMatrix(n * y, eul * 2); LL N = ((tmp." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/fd1838a47ca6f372cf00e75f207d037e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-09-20T20:38:52+08:00" />
<meta property="article:modified_time" content="2016-09-20T20:38:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">HDU-5895 Mathematician QSC</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="font-family:Microsoft YaHei; font-size:18px"><strong>题目大意：</strong></span></p> 
<p><span style="font-family:Microsoft YaHei; font-size:18px">已知f[0] = 0, f[1] = 1, f[i] = f[i-1] * 2 + f[i-2]，且g[n] = g[n-1] + f[n] * f[n]，现在给出n，y，x，s，问你x^(g[n*y]) mod (s + 1)的值为多少。</span></p> 
<p><span style="font-family:Microsoft YaHei; font-size:18px"><strong>解题思路：</strong></span></p> 
<p><span style="font-family:Microsoft YaHei; font-size:18px">首先可以得到的是g[n] = f[n] * f[n+1] / 2</span></p> 
<p><span style="font-family:Microsoft YaHei; font-size:18px">证明方式就是xjb打表加上猜加上数学归纳法，别问我怎么猜到的我是用了这个网站http://oeis.org/</span></p> 
<p><span style="font-family:Microsoft YaHei; font-size:18px">因此g[n]可以很轻松的得到了。那么现在的问题就是a^b mod p的值应该怎么求</span></p> 
<p><span style="font-family:Microsoft YaHei; font-size:18px">这里提供一份关于求解这个值的非常详细的博客：<a target="_blank" href="http://blog.csdn.net/u010793761/article/details/44727467" rel="noopener noreferrer">传送门</a></span></p> 
<p><span style="font-family:Microsoft YaHei; font-size:18px"><strong>代码：</strong></span></p> 
<p></p> 
<pre><code class="language-cpp">#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;algorithm&gt;
using namespace std;

typedef long long LL;
typedef pair&lt;LL, LL&gt; pi;

LL euler(LL n) {
	LL ans = n;
	for (LL i = 2; i * i &lt;= n; ++i) {
		if (n % i == 0) {
			ans -= ans / i;
			while (n % i == 0)
				n /= i;
		}
	}
	if (n &gt; 1) ans -= ans / n;
	return ans;
}
LL fastMul(LL a, LL b, LL mod) {
	LL ans = 1;
	while (b) {
		if (b &amp; 1) ans = (ans * a) % mod;
		b &gt;&gt;= 1;
		a = (a * a) % mod;
	}
	return ans;
}
pi fastMatrix(LL n, LL mod) {
	LL t11, t12, t21, t22;
	LL bas[4] = {2, 1, 1, 0};
	LL ans[4] = {1, 0, 0, 1};
	
	while (n) {
		if (n &amp; 1) {
			t11 = ((ans[0] * bas[0]) % mod + (ans[1] * bas[2]) % mod) % mod;
			t12 = ((ans[0] * bas[1]) % mod + (ans[1] * bas[3]) % mod) % mod;
			t21 = ((ans[2] * bas[0]) % mod + (ans[3] * bas[2]) % mod) % mod;
			t22 = ((ans[2] * bas[1]) % mod + (ans[3] * bas[3]) % mod) % mod;

			ans[0] = t11; ans[1] = t12; ans[2] = t21; ans[3] = t22;
		}

		n &gt;&gt;= 1;
		t11 = ((bas[0] * bas[0]) % mod + (bas[1] * bas[2]) % mod) % mod;
		t12 = ((bas[0] * bas[1]) % mod + (bas[1] * bas[3]) % mod) % mod;
		t21 = ((bas[2] * bas[0]) % mod + (bas[3] * bas[2]) % mod) % mod;
		t22 = ((bas[2] * bas[1]) % mod + (bas[3] * bas[3]) % mod) % mod;

		bas[0] = t11; bas[1] = t12; bas[2] = t21; bas[3] = t22;
	}
	return make_pair(ans[0], ans[2]);
}
LL solve(LL n, LL y, LL x, LL s) {
	LL eul = euler(s + 1);
	pi tmp = fastMatrix(n * y, eul * 2);
	LL N = ((tmp.first * tmp.second) % (eul * 2)) / 2 + eul;
	return fastMul(x, N, s + 1);
}
int main() {
	LL n, y, x, s, t;
	scanf("%lld", &amp;t);
	while (t--) {
		scanf("%lld%lld%lld%lld", &amp;n, &amp;y, &amp;x, &amp;s);
		printf("%lld\n", solve(n, y, x, s));
	}
	return 0;
}</code></pre> 
<br> 
<br> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8608f76beeb830d5cdd9f99da71b5ebb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Spark编程技巧</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1151a85cf5d372c2bba7816bbfb2a2fb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ReadLock和WriteLock(读写锁)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>