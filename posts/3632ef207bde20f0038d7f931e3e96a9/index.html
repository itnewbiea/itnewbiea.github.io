<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>org.apache.commons.collections.map.LRUMap 在cache中的使用 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="org.apache.commons.collections.map.LRUMap 在cache中的使用" />
<meta property="og:description" content="2019独角兽企业重金招聘Python工程师标准&gt;&gt;&gt; LRUMap对于构建缓存或者连接池之类的技术经常用到，common-collections框架给了现成的实现，大家在不需要修改的情况下，直接用，好用且稳定。
一个cache的简单例子：
import org.apache.commons.collections.map.LRUMap; import java.util.Collections; public class SampleCache { private static SampleCache instance = null;
private Map&lt;Long, Integer&gt; cache = null;
private static int maxLength = 100000;
private SampleCache () {
init();
}
public static SampleCache getInstance() {
if (instance == null) {
instance = new SampleCache ();
}
return instance;
}
private void init() {
LRUMap map = new LRUMap(maxLength);
this.cache = Collections.synchronizedMap(map);
}
}
=======解析LRUMap=======" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/3632ef207bde20f0038d7f931e3e96a9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-08-15T14:33:00+08:00" />
<meta property="article:modified_time" content="2016-08-15T14:33:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">org.apache.commons.collections.map.LRUMap 在cache中的使用</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="content" id="articleContent"> 
 <div class="ad-wrap"> 
  <p><a style="color:#A00;font-weight:bold;" href="https://my.oschina.net/u/2663968/blog/3061697" rel="nofollow">2019独角兽企业重金招聘Python工程师标准&gt;&gt;&gt; </a> <img src="https://images2.imgbox.com/96/bd/zNyt7XhJ_o.png" alt="hot3.png"></p> 
 </div> 
 <p>LRUMap对于构建缓存或者连接池之类的技术经常用到，common-collections框架给了现成的实现，大家在不需要修改的情况下，直接用，好用且稳定。</p> 
 <p>一个cache的简单例子：</p> 
 <p>import org.apache.commons.collections.map.LRUMap;  </p> 
 <p>import java.util.Collections;    </p> 
 <p>public class SampleCache {  </p> 
 <p>private static SampleCache instance = null;</p> 
 <p>private Map&lt;Long, Integer&gt; cache = null;</p> 
 <p>private static int maxLength = 100000;</p> 
 <p>private SampleCache () {<!-- --><br>         init();<br>     }</p> 
 <p>public static SampleCache getInstance() {<!-- --><br>         if (instance == null) {<!-- --><br>             instance = new SampleCache ();<br>         }<br>         return instance;<br>     }</p> 
 <p>private void init() {<!-- --><br><strong>        LRUMap map = new LRUMap(maxLength);<br>         this.cache = Collections.synchronizedMap(map);</strong><br>     }</p> 
 <p>}</p> 
 <p>=======解析LRUMap=======</p> 
 <p>参考http://blog.csdn.net/statckoverflow/article/details/18908647 ， 下面例子直接copy自参考文章</p> 
 <p>LRUMap 的一个简单使用示例：</p> 
 <ol><li>public static void main(String[] args) {  </li><li>    LRUMap lruMap = new LRUMap(2);  </li><li>    lruMap.put("a1", "1");  </li><li>    lruMap.put("a2", "2");  </li><li>    lruMap.get("a1");//mark as recentused  </li><li>    lruMap.put("a3", "3");  </li><li>    System.out.println(lruMap);  </li><li>}  </li></ol> 
 <p> </p> 
 <p>上面的示例，当增加”a3”值时，会淘汰最近最少使用的”a2”, 最后输出的结果为：</p> 
 <p>{a1=1,a3=3} </p> 
 <p>LRUMap的使用说明如下：</p> 
 <p>LRUMap的初始化时需要指定最大集合元素个数，新增的元素个数大于允许的最大集合个数时，则会执行LRU淘汰算法。 所有的元素在LRUMap中会根据最近使用情况进行排序。<strong>最近使用的会放在元素的最前面</strong>(LRUMap是通过<strong>链表</strong>来存储元素内容). <strong>所以LRUMap进行淘汰时只需要删除链表最后一个即可</strong>（即header.after所指的元素对象）</p> 
 <p>那么那些操作会影响元素的使用情况：</p> 
 <p>1.put 当新增加一个集合元素对象，则表示该对象是最近被访问的</p> 
 <p>2. get 操作会把当前访问的元素对象作为最近被访问的，会被移到链接表头</p> 
 <p> </p> 
 <p>注：当执行containsKey和containsValue操作时，不会影响元素的访问情况。</p> 
 <p><strong>LRUMap也是非线程安全。在多线程下使用可通过Collections.synchronizedMap(Map)操</strong></p> 
 <p><strong>作来保证线程安全。</strong></p> 
 <p> </p> 
 <div class="ad-wrap"> 
  <div id="blog-title-ad"> 
   <ins class="adsbygoogle"></ins> 
  </div> 
 </div> 
</div> 
<p>转载于:https://my.oschina.net/fayebrooke/blog/732828</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9ba8ada7b65e8c6ff39c89a6eaa1c868/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java将二进制流转Base64字符串并在页面显示（附Base64转二进制流）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9766f9f809b0806034b382d5786281ed/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android解析JSON数据几种方式对比</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>