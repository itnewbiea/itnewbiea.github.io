<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CentOS 5.6Final下FTP安装及配置 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CentOS 5.6Final下FTP安装及配置" />
<meta property="og:description" content="My Scripts:
[root@localhost ~]# useradd -u 100 -g ftp -d /tmp/upload/ -c &#34;Upload user&#34; -m -s /sbin/nologin vendor [root@localhost ~]# service vsftpd restart [root@localhost vsftpd]# setsebool -P ftpd_disable_trans 1
[root@localhost vsftpd]# service vsftpd restart
一、FTP的安装
1、检测是否安装了FTP :[root@localhost ~]# rpm -q vsftpd
如果安装了会显示版本信息:
[root@localhost ~]# vsftpd-2.0.5-16.el5_5.1
否则显示:[root@localhost ~]# package vsftpd is not installed
2、如果没安装FTP，运行yum install vsftpd命令
具体的细节如下：(如果无法更新，你先配置能访问互联网，我有文档叫 CentOS 在 VMware下，如何联网到Internet的解决办法 可以解决无法上网的问题)
[root@localhost ~]# yum install vsftpd
3、完成ftp安装后，将 /etc/vsftpd/user_list文件和/etc/vsftpd/ftpusers文件中的root这一行注释掉
# root" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/eb5e9c880c83b7cad9efd27f26b75ff1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2011-06-25T20:32:00+08:00" />
<meta property="article:modified_time" content="2011-06-25T20:32:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CentOS 5.6Final下FTP安装及配置</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="color: #ff0000; font-size: 16px;">My Scripts:</span></p> 
<p><span style="color: #ff0000; font-size: 16px;"><span class="Apple-style-span" style="line-height: 28px;">[root@localhost ~]# useradd -u 100 -g ftp -d /tmp/upload/ -c "Upload user" -m -s /sbin/nologin vendor</span></span> </p> 
<p><span style="color: #ff0000; font-size: 16px;"><span class="Apple-style-span" style="line-height: 28px;">[root@localhost ~]# service vsftpd restart</span></span><span style="color: #ff0000; font-size: 16px;"><span class="Apple-style-span" style="line-height: 28px;"><span style="color: #ff0000; font-size: 16px;"> </span></span></span> </p> 
<p><span class="Apple-style-span" style="line-height: 28px;"></span></p> 
<p>[root@localhost vsftpd]# setsebool -P ftpd_disable_trans 1</p> 
<p>[root@localhost vsftpd]# service vsftpd restart</p> 
<p> </p> 
<p><span style="color: #ff0000; font-size: 16px;"><br></span></p> 
<p><span style="color: #ff0000; font-size: 16px;">一、FTP的安装</span></p> 
<p><span style="font-size: 16px;">1、检测是否安装了FTP :[root@localhost ~]# rpm -q vsftpd</span></p> 
<p><span style="font-size: 16px;">如果安装了会显示版本信息:</span></p> 
<p><span style="font-size: 16px;">[root@localhost ~]# vsftpd-2.0.5-16.el5_5.1</span></p> 
<p><span style="font-size: 16px;">　　否则显示:[root@localhost ~]# package vsftpd is not installed</span></p> 
<p><span style="font-size: 16px;">2、如果没安装FTP，运行yum install vsftpd命令</span></p> 
<p><span style="font-size: 16px;">　　具体的细节如下：(如果无法更新，你先配置能访问互联网，我有文档叫 CentOS 在 VMware下，如何联网到Internet的解决办法 可以解决无法上网的问题)</span></p> 
<p><span style="font-size: 16px;">　　[root@localhost ~]# yum install vsftpd</span></p> 
<p><span style="font-size: 16px;">3、完成ftp安装后，将 /etc/vsftpd/user_list文件和/etc/vsftpd/ftpusers文件中的root这一行注释掉</span></p> 
<p><span style="font-size: 16px;">　　# root</span></p> 
<p><span style="font-size: 16px;">4、执行以下命令</span></p> 
<p><span style="font-size: 16px;">　　# setsebool -P ftpd_disable_trans=1</span></p> 
<p><span style="font-size: 16px;">　　修改/etc/vsftpd/vsftpd.conf,在最后一行处添加local_root=/</span></p> 
<p><span style="font-size: 16px;">5、重启ftp进程 #service vsftpd restart</span></p> 
<p><span style="font-size: 16px;">注：每次修改过ftp相关的配置文件，都需要重启ftp进程来生效。</span></p> 
<p><span style="font-size: 16px;">　　ftp服务器就可以使用了。</span></p> 
<p><span style="color: #ff0000; font-size: 16px;">二、vsftpd的配置文件说明：</span></p> 
<p><span style="font-size: 16px;">　　vsftpd.ftpusers：位于/etc目录下。它指定了哪些用户账户不能访问FTP服务器，例如root等。</span></p> 
<p><span style="font-size: 16px;">　　vsftpd.user_list：位于/etc目录下。该文件里的用户账户在默认情况下也不能访问FTP服务器，仅当vsftpd .conf配置文件里启用userlist_enable=NO选项时才允许访问。</span></p> 
<p><span style="font-size: 16px;">　　vsftpd.conf：位于/etc/vsftpd目录下。来自定义用户登录控制、用户权限控制、超时设置、服务器功能选项、服务器性能选项、服务器响应消息等FTP服务器的配置。</span></p> 
<p><span style="font-size: 16px;">　　(1)用户登录控制</span></p> 
<p><span style="font-size: 16px;">　　<span style="color: #005916; font-size: 16px;">anonymous_enable=YES</span><span style="color: #005916; font-size: 16px;">，允许匿名用户登录</span></span></p> 
<p><span style="font-size: 16px;">　　<span style="color: #005916; font-size: 16px;">no_anon_password=YES，匿名用户登录时不需要输入密码</span></span></p> 
<p><span style="font-size: 16px;">　　<span style="color: #005916; font-size: 16px;">local_enable=YES，允许本地用户登录</span></span></p> 
<p><span style="font-size: 16px;">　　deny_email_enable=YES，可以创建一个文件保存某些匿名电子邮件的黑名单，以防止这些人使用Dos攻击。</span></p> 
<p><span style="font-size: 16px;">banned_email_file=/etc/vsftpd.banned_emails，当启用deny_email_enable功能时，所需的电子邮件黑名单保存路径(默认为/etc/vsftpd.banned_emails)。</span></p> 
<p><span style="font-size: 16px;">　　(2)用户权限控制</span></p> 
<p><span style="font-size: 16px;">　　<span style="color: #005916; font-size: 16px;">write_enable=YES，开启全局上传权限</span></span></p> 
<p><span style="font-size: 16px;">　　<span style="color: #005916; font-size: 16px;">local_umask=022</span><span style="color: #005916; font-size: 16px;">，本地用户的上传文件的umask设为022(系统默认是077，一般都可以改为022)</span></span></p> 
<p><span style="font-size: 16px;">　　anon_upload_enable=YES，允许匿名用户具有上传权限，很明显，必须启用write_enable=YES，才可以使用此项。同时我们还必须建立一个允许ftp用户可以读写的目录(前面说过，ftp是匿名用户的映射用户账号)。</span></p> 
<p><span style="font-size: 16px;">　　anon_mkdir_write_enable=YES，允许匿名用户有创建目录的权利。</span></p> 
<p><span style="font-size: 16px;">　　chown_uploads=YES，启用此项，匿名上传文件的属主用户将改为别的用户账户，注意，这里建议不要指定root账号为匿名上传文件的属主用户！</span></p> 
<p><span style="font-size: 16px;">　　chown_username=whoever，当启用chown_uploads=YES时，所指定的属主用户账号，此处的whoever自然要用合适的用户账号来代替。</span></p> 
<p><span style="font-size: 16px;">　　chroot_list_enable=YES，可以用一个列表限定哪些本地用户只能在自己目录下活动，如果chroot_local_user=YES，那么这个列表里指定的用户是不受限制的。</span></p> 
<p><span style="font-size: 16px;">chroot_list_file=/etc/vsftpd.chroot_list，如果chroot_local_user=YES，则指定该列表(chroot_local_user)的保存路径(默认是/etc/vsftpd.chroot_list)。</span></p> 
<p><span style="font-size: 16px;">　　nopriv_user=ftpsecure，指定一个安全用户账号，让FTP服务器用作完全隔离和没有特权的独立用户。这是vsftpd系统推荐选项。</span></p> 
<p><span style="font-size: 16px;">　　async_abor_enable=YES，强烈建议不要启用该选项，否则将可能导致出错！</span></p> 
<p><span style="font-size: 16px;">　　<span style="color: #005916; font-size: 16px;">ascii_upload_enable=YES；ascii_download_enable=YES，默认情况下服务器会假装接受ASCⅡ模式请求但实际上是忽略这样的请求，启用上述的两个选项可以让服务器真正实现ASCⅡ模式的传输</span></span></p> 
<p><span style="font-size: 16px;">　　<span style="color: #005916; font-size: 16px;">注意：启用ascii_download_enable选项会让恶意远程用户们在ASCⅡ模式下用“SIZE/big/file”这样的指令大量消耗FTP服务器的I/O资源。</span></span></p> 
<p><span style="color: #005916; font-size: 16px;">　　这些ASCⅡ模式的设置选项分成上传和下载两个，这样我们就可以允许ASCⅡ模式的上传(可以防止上传脚本等恶意文件而导致崩溃)，而不会遭受拒绝服务攻击的危险</span></p> 
<p><span style="font-size: 16px;">　　(3)用户连接和超时选项</span></p> 
<p><span style="font-size: 16px;">　　<span style="color: #005916; font-size: 16px;">idle_session_timeout=600，可以设定默认的空闲超时时间，用户超过这段时间不动作将被服务器踢出</span></span></p> 
<p><span style="font-size: 16px;">　　<span style="color: #005916; font-size: 16px;">data_connection_timeout=120，设定默认的数据连接超时时间</span></span></p> 
<p><span style="font-size: 16px;">　　(4)服务器日志和欢迎信息</span></p> 
<p><span style="font-size: 16px;">　　dirmessage_enable=YES，允许为目录配置显示信息，显示每个目录下面的message_file文件的内容。</span></p> 
<p><span style="font-size: 16px;">　　ftpd_banner=Welcome to blah FTP service，可以自定义FTP用户登录到服务器所看到的欢迎信息。</span></p> 
<p><span style="font-size: 16px;">　　xferlog_enable=YES，启用记录上传/下载活动日志功能。</span></p> 
<p><span style="font-size: 16px;">　　xferlog_file=/var/log/vsftpd.log，可以自定义日志文件的保存路径和文件名，默认是/var/log/vsftpd.log。</span></p> 
<p><span style="font-size: 16px;">　　anonymous_enable=YES 允许匿名登录local_enable=YES 允许本地用户登录</span></p> 
<p><span style="font-size: 16px;">　　write_enable=YES 开放本地用户写权限</span></p> 
<p><span style="font-size: 16px;">　　local_umask=022 设置本地用户生成文件的掩码为022</span></p> 
<p><span style="font-size: 16px;">　　#anon_upload_enable=YES 此项设置允许匿名用户上传文件</span></p> 
<p><span style="font-size: 16px;">　　#anon_mkdir_write_enable=YES 开启匿名用户的写和创建目录的权限</span></p> 
<p><span style="font-size: 16px;">　　dirmessage_enable=YES 当切换到目录时，显示该目录下的.message隐藏文件的内容</span></p> 
<p><span style="font-size: 16px;">　　xferlog_enable=YES 激活上传和下载日志</span></p> 
<p><span style="font-size: 16px;">　　connect_from_port_20=YES 启用FTP数据端口的连接请求</span></p> 
<p><span style="font-size: 16px;">　　#chown_uploads=YES 是否具有上传权限. 用户由chown_username参数指定。</span></p> 
<p><span style="font-size: 16px;">　　#chown_username=whoever 指定拥有上传文件权限的用户。此参数与chown_uploads联用。</span></p> 
<p><span style="font-size: 16px;">　　#xferlog_file=/var/log/vsftpd.log</span></p> 
<p><span style="font-size: 16px;">　　xferlog_std_format=YES 使用标准的ftpd xferlog日志格式</span></p> 
<p><span style="font-size: 16px;">　　#idle_session_timeout=600 此设置将在用户会话空闲10分钟后被中断</span></p> 
<p><span style="font-size: 16px;">　　#data_connection_timeout=120 将在数据连接空闲2分钟后被中断</span></p> 
<p><span style="font-size: 16px;">　　#ascii_upload_enable=YES 启用上传的ASCII传输方式</span></p> 
<p><span style="font-size: 16px;">　　#ascii_download_enable=YES 启用下载的ASCII传输方式</span></p> 
<p><span style="font-size: 16px;">　　#ftpd_banner=Welcome to blah FTP service 设置用户连接服务器后显示消息</span></p> 
<p><span style="font-size: 16px;">　　#deny_email_enable=NO 此参数默认值为NO。当值为YES时，拒绝使用banned_email_file参数指定文件中所列出的e-mail地址用户登录。</span></p> 
<p><span style="font-size: 16px;">　　#banned_email_file=/etc/vsftpd.banned_emails 指定包含拒绝的e-mail地址的文件.</span></p> 
<p><span style="font-size: 16px;">　　#chroot_list_enable=YES 设置本地用户登录后不能切换到自家目录以外的别的目录</span></p> 
<p><span style="font-size: 16px;">　　#chroot_list_file=/etc/vsftpd.chroot_list</span></p> 
<p><span style="font-size: 16px;">　　#ls_recurse_enable=YES</span></p> 
<p><span style="font-size: 16px;">　　pam_service_name=vsftpd 设置PAM认证服务的配置文件名称，该文件存放在/etc/pam.d/</span></p> 
<p><span style="font-size: 16px;">　　userlist_enable=YES 此项配置/etc/vsftpd.user_list中指定的用户也不能访问服务器，若添加userlist_deny=No,则仅仅/etc/vsftpd.user_list文件中的用户可以访问，其他用户都不可以访问服务器。如过userlist_enable=NO,userlist_deny=YES,则指定使文件/etc/vsftpd.user_list中指定的用户不可以访问服务器，其他本地用户可以访问服务器。</span><br><span style="font-size: 16px;">　　listen=YES 指明VSFTPD以独立运行方式启动</span></p> 
<p><span style="font-size: 16px;">　　tcp_wrappers=YES 在VSFTPD中使用TCP_Wrappers远程访问控制机制，默认值为YES</span></p> 
<p><span style="color: #ff0000; font-size: 16px;">三、举例建立一个名为test的账户并进行配置</span></p> 
<p><span style="font-size: 16px;">根据实际情况对FTP进行配置后，下面举例介绍建立一个FTP账户并进行简单的配置：</span></p> 
<p><span style="font-size: 16px;">1、创建一个账号为test的账户：</span></p> 
<p><span style="font-size: 16px;">#mkdir /tmp/test //首先创建好目录</span></p> 
<p><span style="font-size: 16px;">#adduser -d /tmp/test -g ftp -s /sbin/nologin test //-s /sbin/nologin是让其不能登陆系统，-d 是指定用户目录为/opt/srsman ，即该账户只能登陆ftp，却不能用做登陆系统用。</span></p> 
<p><span style="font-size: 16px;">#passwd test</span></p> 
<p><span style="font-size: 16px;">Changing password for user beinan.//接下来会出现让你设置新的密码</span></p> 
<p><span style="font-size: 16px;">New password:</span></p> 
<p><span style="font-size: 16px;">Retype new password:</span><br><span style="font-size: 16px;">passwd: all authentication tokens updated successfully</span></p> 
<p><span style="font-size: 16px;">创建账户成功！</span></p> 
<p><span style="font-size: 16px;">2、限制用户目录，不得改变目录到上级</span></p> 
<p><span style="font-size: 16px;">修改/etc/vsftpd/vsftpd.conf</span><br><span style="font-size: 16px;">将这两行</span><br><span style="font-size: 16px;">#chroot_list_enable=YES</span><br><span style="font-size: 16px;">#chroot_list_file=/etc/vsftpd.chroot_list</span><br><span style="font-size: 16px;">注释去掉</span><br><span style="font-size: 16px;">chroot_list_enable=YES</span><br><span style="font-size: 16px;">chroot_list_file=/etc/vsftpd/chroot_list</span></p> 
<p><span style="font-size: 16px;">新增一个文件: /etc/vsftpd/chroot_list</span><br><span style="font-size: 16px;">内容写需要限制的用户名：</span><br><span style="font-size: 16px;">test</span></p> 
<p><span style="font-size: 16px;">重新启动vsftpd</span></p> 
<p><span style="font-size: 16px;"># service vsftpd restart</span></p> 
<p><span style="font-size: 16px;">3、最后为了防止服务器由于断电、重启等现象发生，导致ftp进程在开机后未启动，将其添加到开机启动文件中：</span></p> 
<p><span style="font-size: 16px;">(1)找到/etc/rc.local文件</span></p> 
<p><span style="font-size: 16px;">(2)打开该文件，在最后一行添加：service vsftpd start</span></p> 
<p><span style="font-size: 16px;">(3)保存，退出</span></p> 
<p><span style="font-size: 16px;">4、通过在“我的电脑”中输入ftp：//192.168.179.30(填该ftp服务器ip地址)进入ftp服务器，输入设置好的账户登陆即可。</span></p> 
<p></p> 
<p> </p> 
<p>[root@localhost vsftpd]# setsebool -P ftpd_disable_trans 1</p> 
<p>[root@localhost vsftpd]# service vsftpd restart</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0869bb69f95f85f941eaca07252870a1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux/UNIX系统下单网卡配置多IP方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/350191ec686450182b1fe57b2b4f49f0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">CentOS5.6 安装JDK</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>