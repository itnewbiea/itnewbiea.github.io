<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQL查询重复数据和清除重复数据 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SQL查询重复数据和清除重复数据" />
<meta property="og:description" content="选择重复，消除重复和选择出序列 有例表：emp emp_no name age 001 Tom 17 002 Sun 14 003 Tom 15 004 Tom 16 要求： 列出所有名字重复的人的记录 ( 1 )最直观的思路：要知道所有名字有重复人资料，首先必须知道哪个名字重复了： select name from emp group by name having count ( * ) &gt; 1 所有名字重复人的记录是: select * from emp where name in ( select name from emp group by name having count ( * ) &gt; 1 ) ( 2 )稍微再聪明一点，就会想到，如果对每个名字都和原表进行比较，大于2个人名字与这条记录相同的就是合格的 ，就有 select * from emp where ( select count ( * ) from emp e where e." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/a4c5e8c54cfcadc117f8b1003fb5de07/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2008-05-20T11:03:00+08:00" />
<meta property="article:modified_time" content="2008-05-20T11:03:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQL查询重复数据和清除重复数据</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="BORDER-RIGHT: windowtext 0.5pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 0.5pt solid; PADDING-LEFT: 5.4pt; BACKGROUND: #e6e6e6; PADDING-BOTTOM: 4px; BORDER-LEFT: windowtext 0.5pt solid; WIDTH: 95%; WORD-BREAK: break-all; PADDING-TOP: 4px; BORDER-BOTTOM: windowtext 0.5pt solid"> 
 <div> 
  <img alt="" align="top" src="https://images2.imgbox.com/ff/8f/jNTaod0Q_o.gif"> 
  <span style="COLOR: #000000">选择重复，消除重复和选择出序列 <br><img alt="" align="top" src="https://images2.imgbox.com/a5/dd/ockFX4CH_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/b3/a0/iGj1cxfG_o.gif">有例表：emp <br><img alt="" align="top" src="https://images2.imgbox.com/eb/ef/BkumYSuk_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/b4/fd/QEIvS1ir_o.gif">emp_no   name    age     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">001</span> 
  <span style="COLOR: #000000">           Tom      </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">17</span> 
  <span style="COLOR: #000000">     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">002</span> 
  <span style="COLOR: #000000">           Sun       </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">14</span> 
  <span style="COLOR: #000000">     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">003</span> 
  <span style="COLOR: #000000">           Tom      </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">15</span> 
  <span style="COLOR: #000000">     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">004</span> 
  <span style="COLOR: #000000">           Tom      </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">16</span> 
  <span style="COLOR: #000000"> <br><img alt="" align="top" src="https://images2.imgbox.com/29/58/dqdYHr8G_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/b9/38/0oc4O27V_o.gif">要求： <br><img alt="" align="top" src="https://images2.imgbox.com/00/cb/4XZyGyxt_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/a5/6a/qsl3sTAk_o.gif">列出所有名字重复的人的记录 <br><img alt="" align="top" src="https://images2.imgbox.com/4f/89/DywWVZ5n_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/1e/ca/Pg0TDY4O_o.gif">(</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000">)最直观的思路：要知道所有名字有重复人资料，首先必须知道哪个名字重复了： <br><img alt="" align="top" src="https://images2.imgbox.com/34/19/uuwcxfVy_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/9a/eb/O54R57de_o.gif"></span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   name   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp       </span> 
  <span style="COLOR: #0000ff">group</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">by</span> 
  <span style="COLOR: #000000">   name     </span> 
  <span style="COLOR: #0000ff">having</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #ff00ff">count</span> 
  <span style="COLOR: #000000">(</span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">)</span> 
  <span style="COLOR: #808080">&gt;</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000"> <br><img alt="" align="top" src="https://images2.imgbox.com/a7/71/vpEClXeG_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/84/1f/20Lk4NzF_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/bc/56/w2IhLAwE_o.gif"> 所有名字重复人的记录是: <br><img alt="" align="top" src="https://images2.imgbox.com/7b/df/CI91l2XJ_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/80/d3/x4erMiwQ_o.gif"></span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="COLOR: #0000ff">where</span> 
  <span style="COLOR: #000000"> name   </span> 
  <span style="COLOR: #808080">in</span> 
  <span style="COLOR: #000000">   (</span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   name   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp </span> 
  <span style="COLOR: #0000ff">group</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">by</span> 
  <span style="COLOR: #000000">   name </span> 
  <span style="COLOR: #0000ff">having</span> 
  <span style="COLOR: #000000"> </span> 
  <span style="COLOR: #ff00ff">count</span> 
  <span style="COLOR: #000000">(</span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">)</span> 
  <span style="COLOR: #808080">&gt;</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000">) <br><img alt="" align="top" src="https://images2.imgbox.com/a0/cb/btP340ym_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/36/52/XhBGQ53h_o.gif">(</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">2</span> 
  <span style="COLOR: #000000">)稍微再聪明一点，就会想到，如果对每个名字都和原表进行比较，大于2个人名字与这条记录相同的就是合格的 ，就有 <br><img alt="" align="top" src="https://images2.imgbox.com/1d/b3/aEooAo4H_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/92/ab/yEnWls3I_o.gif"></span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp   </span> 
  <span style="COLOR: #0000ff">where</span> 
  <span style="COLOR: #000000">   (</span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #ff00ff">count</span> 
  <span style="COLOR: #000000">(</span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">)   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp   e    </span> 
  <span style="COLOR: #0000ff">where</span> 
  <span style="COLOR: #000000">   e.name</span> 
  <span style="COLOR: #808080">=</span> 
  <span style="COLOR: #000000">emp.name)   </span> 
  <span style="COLOR: #808080">&gt;</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000"> <br><img alt="" align="top" src="https://images2.imgbox.com/6c/34/TmHy1yFc_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/79/b7/PRFvW685_o.gif"></span> 
  <span style="COLOR: #008080">--</span> 
  <span style="COLOR: #008080">注意一下这个&gt;1，想下如果是 =1，如果是 =2 如果是&gt;2 如果 e 是另外一张表 而且是=0那结果 就更好玩了:) </span> 
  <span style="COLOR: #008080"><br><img alt="" align="top" src="https://images2.imgbox.com/20/cc/lzNqPBCk_o.gif"></span> 
  <span style="COLOR: #000000"><br><img alt="" align="top" src="https://images2.imgbox.com/47/62/FkagpJWE_o.gif">这个过程是 在判断工号为001的 人 的时候先取得 001的 名字（emp.name） 然后和原表的名字进行比较 e.name <br><img alt="" align="top" src="https://images2.imgbox.com/f3/7b/4Ry54mfH_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/33/9a/mWHfQ993_o.gif">注意e是emp的一个别名。 <br><img alt="" align="top" src="https://images2.imgbox.com/0c/1a/gK9BRk9U_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/b8/96/85LUEcGc_o.gif">再稍微想得多一点，就会想到，如果有另外一个名字相同的人工号不与她他相同那么这条记录符合要求： <br><img alt="" align="top" src="https://images2.imgbox.com/8a/c5/T3hBlyy2_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/41/4e/l3jtfcIX_o.gif"></span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="COLOR: #0000ff">where</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #808080">exists</span> 
  <span style="COLOR: #000000">     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">                  (</span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp   e    </span> 
  <span style="COLOR: #0000ff">where</span> 
  <span style="COLOR: #000000">   e.name</span> 
  <span style="COLOR: #808080">=</span> 
  <span style="COLOR: #000000">emp.name   </span> 
  <span style="COLOR: #808080">and</span> 
  <span style="COLOR: #000000">   e.emp_no</span> 
  <span style="COLOR: #808080">&lt;&gt;</span> 
  <span style="COLOR: #000000">emp.emp_no) <br><img alt="" align="top" src="https://images2.imgbox.com/2f/af/slFkuYSQ_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/bf/7a/BsxjPZh7_o.gif"> 此思路的join写法： <br><img alt="" align="top" src="https://images2.imgbox.com/84/a0/m3zNaPPA_o.gif"><br><img id="_966_1128_Open_Image" style="DISPLAY: inline" alt="" align="top" src="https://images2.imgbox.com/d2/6e/O2YmxGcN_o.gif"><img id="_966_1128_Closed_Image" style="DISPLAY: none" alt="" align="top" src="https://images2.imgbox.com/65/f1/0gpYX4Ma_o.gif"></span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   emp.</span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">       </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp,emp e</span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">        where emp.name</span> 
  <span style="COLOR: #808080">=</span> 
  <span style="COLOR: #000000">e.name </span> 
  <span style="COLOR: #808080">and</span> 
  <span style="COLOR: #000000"> emp.emp_no</span> 
  <span style="COLOR: #808080">&lt;&gt;</span> 
  <span style="COLOR: #000000">e.emp_no</span> 
  <span id="_966_1128_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span> 
 </div> 
 <div> 
  <span style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"></span> 
  <span id="_966_1128_Open_Text" style="DISPLAY: inline"><span style="COLOR: #008080">/*</span><span style="COLOR: #008080">     这个语句较规范的   join   写法是     </span></span> 
 </div> 
 <div> 
  <span style="DISPLAY: inline"><span style="COLOR: #008080">select emp.* from   emp   inner join emp   e     on emp.name=e.name and emp.emp_no&lt;&gt;e.emp_no     </span></span> 
 </div> 
 <div> 
  <span style="DISPLAY: inline"><span style="COLOR: #008080">但个人比较倾向于前一种写法，关键是更清晰     </span><span style="COLOR: #008080">*/</span></span> 
  <span style="COLOR: #000000">     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">b、有例表：</span> 
  <span style="COLOR: #000000">emp     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">name     </span> 
  <span style="COLOR: #000000">age     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">Tom       </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">16</span> 
  <span style="COLOR: #000000">     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">Sun        </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">14</span> 
  <span style="COLOR: #000000">     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">Tom       </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">16</span> 
  <span style="COLOR: #000000">     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">Tom       </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">16</span> 
  <span style="COLOR: #000000"> <br><img alt="" align="top" src="https://images2.imgbox.com/ee/37/Nm6FlWBF_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/d5/01/QJh7n0xy_o.gif"></span> 
  <span style="COLOR: #008080">--</span> 
  <span style="COLOR: #008080">--------------------------------------------------清除重复----------------------------------------------------</span> 
  <span style="COLOR: #008080"><br><img alt="" align="top" src="https://images2.imgbox.com/13/de/eikBrMBu_o.gif"></span> 
  <span style="COLOR: #000000">过滤掉所有多余的重复记录 <br><img alt="" align="top" src="https://images2.imgbox.com/62/1e/E43rdwxa_o.gif">(</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000">)我们知道distinct、</span> 
  <span style="COLOR: #0000ff">group</span> 
  <span style="COLOR: #000000"> </span> 
  <span style="COLOR: #0000ff">by</span> 
  <span style="COLOR: #000000"> 可以过滤重复，于是就有最直观的 <br><img alt="" align="top" src="https://images2.imgbox.com/63/59/xzHxeUuq_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/ad/4c/Ek4KF2Lw_o.gif"></span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">distinct</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp     或     </span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   name,age   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp   </span> 
  <span style="COLOR: #0000ff">group</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">by</span> 
  <span style="COLOR: #000000">   name,age <br><img alt="" align="top" src="https://images2.imgbox.com/53/59/URqj5k7m_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/fe/8f/WheZMnOi_o.gif">获得需要的数据，如果可以使用临时表就有解法： <br><img alt="" align="top" src="https://images2.imgbox.com/1d/3c/55G7T8EK_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/cb/3d/atJU7Ep6_o.gif"></span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">distinct</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">into</span> 
  <span style="COLOR: #000000">   #tmp </span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp   </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="COLOR: #0000ff">delete</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp   </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="COLOR: #0000ff">insert</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">into</span> 
  <span style="COLOR: #000000">   emp   </span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   #tmp <br><img alt="" align="top" src="https://images2.imgbox.com/e6/cc/zppNM7fL_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/5e/b2/FgbCg4iq_o.gif">(</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">2</span> 
  <span style="COLOR: #000000">)但是如果不可以使用临时表，那该怎么办？ <br><img alt="" align="top" src="https://images2.imgbox.com/1c/9f/HOsCkruQ_o.gif">我们观察到我们没办法区分数据（物理位置不一样，对 SQL Server来说没有任何区别），思路自然是想办法把数据区分出来了，既然现在的所有的列都没办法区分数据，唯一的办法就是再加个列让它区分出来，加什么列好？最佳选择是identity列： <br><img alt="" align="top" src="https://images2.imgbox.com/ae/ee/AaJZGM3f_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/cd/27/mRNAlmgq_o.gif"></span> 
  <span style="COLOR: #0000ff">alter</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">table</span> 
  <span style="COLOR: #000000">   emp   </span> 
  <span style="COLOR: #0000ff">add</span> 
  <span style="COLOR: #000000">   chk   </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #000000">int</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #ff00ff">identity</span> 
  <span style="COLOR: #000000">(</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000">,</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000">) <br><img alt="" align="top" src="https://images2.imgbox.com/33/bf/ilS7RJCt_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/d5/88/Mel5BaQz_o.gif"> 表示例： <br><img alt="" align="top" src="https://images2.imgbox.com/58/94/UGyYnhUV_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/02/2c/5seVIu2D_o.gif">name   age   chk     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    Tom     </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">16</span> 
  <span style="COLOR: #000000">     </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000">     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    Sun      </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">14</span> 
  <span style="COLOR: #000000">     </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">2</span> 
  <span style="COLOR: #000000">     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    Tom     </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">16</span> 
  <span style="COLOR: #000000">     </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">3</span> 
  <span style="COLOR: #000000">     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    Tom     </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">16</span> 
  <span style="COLOR: #000000">     </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">4</span> 
  <span style="COLOR: #000000"> <br><img alt="" align="top" src="https://images2.imgbox.com/07/12/N8EKapN5_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/b5/ce/5AXSSPHv_o.gif">重复记录可以表示为： <br><img alt="" align="top" src="https://images2.imgbox.com/33/7c/lxhWFnEZ_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/54/bc/VSkHvM8y_o.gif"></span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp </span> 
  <span style="COLOR: #0000ff">where</span> 
  <span style="COLOR: #000000"> (</span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #ff00ff">count</span> 
  <span style="COLOR: #000000">(</span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">)   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp   e   </span> 
  <span style="COLOR: #0000ff">where</span> 
  <span style="COLOR: #000000">   e.name</span> 
  <span style="COLOR: #808080">=</span> 
  <span style="COLOR: #000000">emp.name)</span> 
  <span style="COLOR: #808080">&gt;</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000"> <br><img alt="" align="top" src="https://images2.imgbox.com/7a/30/KiS46PeH_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/c5/33/I1w2YFG7_o.gif"> 要删除的是： <br><img alt="" align="top" src="https://images2.imgbox.com/01/0a/vHk8Lzaz_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/c6/a9/Gf4Z72TN_o.gif"></span> 
  <span style="COLOR: #0000ff">delete</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="COLOR: #0000ff">where</span> 
  <span style="COLOR: #000000"> (</span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #ff00ff">count</span> 
  <span style="COLOR: #000000">(</span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">)   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp   e     </span> 
  <span style="COLOR: #0000ff">where</span> 
  <span style="COLOR: #000000">   e.name</span> 
  <span style="COLOR: #808080">=</span> 
  <span style="COLOR: #000000">emp.name   </span> 
  <span style="COLOR: #808080">and</span> 
  <span style="COLOR: #000000">   e.chk</span> 
  <span style="COLOR: #808080">&gt;=</span> 
  <span style="COLOR: #000000">emp.chk)</span> 
  <span style="COLOR: #808080">&gt;</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000"> <br><img alt="" align="top" src="https://images2.imgbox.com/95/b4/TkUCiAUM_o.gif"><img alt="" align="top" src="https://images2.imgbox.com/3e/7f/FllqA7Yh_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/79/b1/9Mhrmlgr_o.gif">再把添加的列删掉，出现结果。 <br><img alt="" align="top" src="https://images2.imgbox.com/8f/48/iN6MePWi_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/08/b8/WLBZTG2H_o.gif"></span> 
  <span style="COLOR: #0000ff">alter</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">table</span> 
  <span style="COLOR: #000000">   emp   </span> 
  <span style="COLOR: #0000ff">drop</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">column</span> 
  <span style="COLOR: #000000">   chk <br><img alt="" align="top" src="https://images2.imgbox.com/15/00/k0IJcW98_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/eb/fd/ioDCIrd0_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/c9/16/0jAoxbYw_o.gif">(</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">3</span> 
  <span style="COLOR: #000000">)另一个思路： <br><img alt="" align="top" src="https://images2.imgbox.com/c7/2a/pSqU7jZp_o.gif">视图 <br><img alt="" align="top" src="https://images2.imgbox.com/91/4b/Pnr9pCtT_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/56/91/Y4CXS4BZ_o.gif"></span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #ff00ff">min</span> 
  <span style="COLOR: #000000">(chk) </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp </span> 
  <span style="COLOR: #0000ff">group</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">by</span> 
  <span style="COLOR: #000000">   name </span> 
  <span style="COLOR: #0000ff">having</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #ff00ff">count</span> 
  <span style="COLOR: #000000">(</span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">)   </span> 
  <span style="COLOR: #808080">&gt;</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000"> <br><img alt="" align="top" src="https://images2.imgbox.com/f1/6d/JuPDwBpE_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/aa/2c/SAlXJ8BN_o.gif"> 获得有重复的记录chk最小的值,于是可以 <br><img alt="" align="top" src="https://images2.imgbox.com/40/02/TLTKJkzx_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/cf/fd/fUN07OdR_o.gif"></span> 
  <span style="COLOR: #0000ff">delete</span> 
  <span style="COLOR: #000000"> </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp </span> 
  <span style="COLOR: #0000ff">where</span> 
  <span style="COLOR: #000000"> chk   </span> 
  <span style="COLOR: #808080">not</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #808080">in</span> 
  <span style="COLOR: #000000"> (</span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000"> </span> 
  <span style="COLOR: #ff00ff">min</span> 
  <span style="COLOR: #000000">(chk) </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp </span> 
  <span style="COLOR: #0000ff">group</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">by</span> 
  <span style="COLOR: #000000">   name) <br><img alt="" align="top" src="https://images2.imgbox.com/d8/1b/o8AiX6mA_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/31/c7/uYNcvBHV_o.gif">写成join的形式也可以: <br><img alt="" align="top" src="https://images2.imgbox.com/88/a2/Y7hJYQ9Y_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/a9/9b/iERA7eK8_o.gif">(</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000">)有例表：emp <br><img alt="" align="top" src="https://images2.imgbox.com/fa/09/iVykzngr_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/9f/76/1Gr5pUsH_o.gif">emp_no    name    age     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">001</span> 
  <span style="COLOR: #000000">            Tom      </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">17</span> 
  <span style="COLOR: #000000">     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">002</span> 
  <span style="COLOR: #000000">            Sun       </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">14</span> 
  <span style="COLOR: #000000">     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">003</span> 
  <span style="COLOR: #000000">            Tom      </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">15</span> 
  <span style="COLOR: #000000">     </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">004</span> 
  <span style="COLOR: #000000">            Tom      </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">16</span> 
  <span style="COLOR: #000000"> <br><img alt="" align="top" src="https://images2.imgbox.com/28/fe/EmOMDX9a_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/57/bb/g7O1wxqi_o.gif"> ◆要求生成序列号 <br><img alt="" align="top" src="https://images2.imgbox.com/1a/7e/GDtZR0qs_o.gif">(</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000">)最简单的方法，根据b问题的解法： <br><img alt="" align="top" src="https://images2.imgbox.com/56/d6/l19gMF79_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/76/f2/yJK2bxm6_o.gif"></span> 
  <span style="COLOR: #0000ff">alter</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">table</span> 
  <span style="COLOR: #000000">   emp   </span> 
  <span style="COLOR: #0000ff">add</span> 
  <span style="COLOR: #000000">   chk   </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #000000">int</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #ff00ff">identity</span> 
  <span style="COLOR: #000000">(</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000">,</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000">)   或   </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">,</span> 
  <span style="COLOR: #ff00ff">identity</span> 
  <span style="COLOR: #000000">(</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #000000">int</span> 
  <span style="COLOR: #000000">,</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000">,</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000">)   chk   </span> 
  <span style="COLOR: #0000ff">into</span> 
  <span style="COLOR: #000000">   #tmp   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp <br><img alt="" align="top" src="https://images2.imgbox.com/3d/81/EOqNGUN6_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/69/84/nva4qYwF_o.gif"> ◆如果需要控制顺序怎么办？ <br><img alt="" align="top" src="https://images2.imgbox.com/40/86/oa50SMKz_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/3a/8c/mMTXumfG_o.gif"></span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">top</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">100000</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">,</span> 
  <span style="COLOR: #ff00ff">identity</span> 
  <span style="COLOR: #000000">(</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #000000">int</span> 
  <span style="COLOR: #000000">,</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000">,</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">1</span> 
  <span style="COLOR: #000000">)   chk   </span> 
  <span style="COLOR: #0000ff">into</span> 
  <span style="COLOR: #000000">   #tmp   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp   </span> 
  <span style="COLOR: #0000ff">order</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">by</span> 
  <span style="COLOR: #000000">   age <br><img alt="" align="top" src="https://images2.imgbox.com/75/1a/lzu3RWN5_o.gif"><br><img alt="" align="top" src="https://images2.imgbox.com/45/ec/IzsfnUFT_o.gif"> (</span> 
  <span style="FONT-WEIGHT: bold; COLOR: #800000">2</span> 
  <span style="COLOR: #000000">) 假如不可以更改表结构，怎么办？ <br><img alt="" align="top" src="https://images2.imgbox.com/e4/be/DH0O0JCQ_o.gif">如果不可以唯一区分每条记录是没有办法的，在可以唯一区分每条记录的时候,可以使用a 中的count的思路解决这个问题 <br><img alt="" align="top" src="https://images2.imgbox.com/aa/71/i1Lmr8gW_o.gif"> <br><img alt="" align="top" src="https://images2.imgbox.com/41/16/8oeNsMkA_o.gif"></span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   emp.</span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">,(</span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #ff00ff">count</span> 
  <span style="COLOR: #000000">(</span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">)   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp   e   </span> 
  <span style="COLOR: #0000ff">where</span> 
  <span style="COLOR: #000000">   e.emp_no</span> 
  <span style="COLOR: #808080">&lt;=</span> 
  <span style="COLOR: #000000">emp.emp_no)   </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp   </span> 
 </div> 
 <div> 
  <span style="COLOR: #000000">    </span> 
  <span style="COLOR: #0000ff">order</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #0000ff">by</span> 
  <span style="COLOR: #000000">   (</span> 
  <span style="COLOR: #0000ff">select</span> 
  <span style="COLOR: #000000">   </span> 
  <span style="COLOR: #ff00ff">count</span> 
  <span style="COLOR: #000000">(</span> 
  <span style="COLOR: #808080">*</span> 
  <span style="COLOR: #000000">)   </span> 
  <span style="COLOR: #0000ff">from</span> 
  <span style="COLOR: #000000">   emp   e   </span> 
  <span style="COLOR: #0000ff">where</span> 
  <span style="COLOR: #000000">   e.emp_no</span> 
  <span style="COLOR: #808080">&lt;=</span> 
  <span style="COLOR: #000000">emp.emp_no) <br><img alt="" align="top" src="https://images2.imgbox.com/e5/de/pj9MPsEn_o.gif"></span> 
 </div> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0887fb904cf787e33e311b74fb95c6eb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">lsof命令常见参数说明</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0e149a48c6015759ec4f0d098bbbcea0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java调用C语言DLL文件方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>