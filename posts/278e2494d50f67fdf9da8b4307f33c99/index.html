<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Pandas学习——物流行业数据分析 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Pandas学习——物流行业数据分析" />
<meta property="og:description" content="——————————————学习资料和数据来源于B站-Python-学习库——————————
一.待分析问题 货品的配送服务有没有问题——交货情况分析有没有具有销售潜力的区域——货品销售情况分析货品质量问题——货品用户反馈情况分析 二.初识数据-清洗数据 data=pd.read_csv(&#34;data_wuliu.csv&#34;,encoding=&#39;gb2312&#39;) print(data.info()) print(data.describe()) 运行结果表明，需要的操作：
1.删除空行
2.数据格式（时间→datetime；销售金额→规整且统一格式、可计算）
3.删除重复值
4.异常值（销售额！=0的行）
清洗数据
#数据清洗 data=data.dropna(axis=0,how=&#39;any&#39;)#存在空，则删除该行 data=data.drop_duplicates(keep=&#39;first&#39;)#删除重复值，保留第一个 data=data.drop(columns=[&#39;订单行&#39;],axis=1)#删除无用列 data=data[data[&#34;销售金额&#34;]!=0]#保留销售金额不为0的数据 data[&#39;sale_time&#39;]=pd.to_datetime(data[&#39;销售时间&#39;])#将销售时间格式转换成datetime格式 data[&#39;月份&#39;]=data[&#39;sale_time&#39;].apply(lambda x:x.month)#对销售时间做映射，提取其中的月份信息，写入“月份”列 #对销售金额进行规整：对于 def amounts_deal(x): if x.find(&#39;万元&#39;)!=-1:#说明销售金额中存在万元，转换成以元为单位的浮点型 amounts=float(x[:x.find(&#39;万元&#39;)].replace(&#39;,&#39;,&#39;&#39;))*10000 else: amounts=float(x[:x.find(&#39;元&#39;)].replace(&#39;,&#39;,&#39;&#39;)) return amounts #调用函数-处理销售金额 data[&#39;销售金额&#39;]=data[&#39;销售金额&#39;].map(amounts_deal) #重新更新索引 data=data.reset_index(drop=True) 三.数据分析及可视化 &#34;&#34;&#34;1.货品的配送服务有没有问题——交货情况分析&#34;&#34;&#34; data[&#39;货品交货状况&#39;]=data[&#39;货品交货状况&#39;].str.strip()#货品交货状况改成字符串的格式，并去除前后空格 #a.时间维度看货品交货状态 data1=data.groupby(by=[&#39;月份&#39;,&#39;货品交货状况&#39;]).size().unstack() data1[&#39;按时交货率&#39;] = data1[&#39;按时交货&#39;]/(data1[&#39;按时交货&#39;]&#43;data1[&#39;晚交货&#39;]) data1[&#39;按时交货率&#39;].plot(kind=&#39;line&#39;) plt.xlabel(&#39;月份&#39;) plt.ylabel(&#39;按时交货率&#39;) plt.title(&#39;月份-按时交货率分析&#39;) #b.货品维度 data2=data.groupby(by=[&#39;货品&#39;,&#39;货品交货状况&#39;]).size().unstack() data2[&#39;按时交货率&#39;] = data2[&#39;按时交货&#39;]/(data2[&#39;按时交货&#39;]&#43;data2[&#39;晚交货&#39;]) data2[&#39;按时交货率&#39;].plot(kind=&#39;line&#39;) plt.xlabel(&#39;货品&#39;) plt.ylabel(&#39;按时交货率&#39;) plt.title(&#39;货品-按时交货率分析&#39;) #c.销售区域维度 data3=data.groupby(by=[&#39;销售区域&#39;,&#39;货品交货状况&#39;]).size().unstack() data3[&#39;按时交货率&#39;] = data3[&#39;按时交货&#39;]/(data3[&#39;按时交货&#39;]&#43;data3[&#39;晚交货&#39;]) data3[&#39;按时交货率&#39;].plot(kind=&#39;line&#39;) plt.xlabel(&#39;销售区域&#39;) plt.ylabel(&#39;按时交货率&#39;) plt.title(&#39;销售区域-按时交货率分析&#39;) #d 货品和销售区域维度 data[&#39;货品交货状况&#39;]=data[&#39;货品交货状况&#39;].str.strip() data2=data.groupby([&#39;货品&#39;,&#39;销售区域&#39;,&#39;货品交货状况&#39;]).size().unstack() data2[&#39;按时交货率&#39;]=data2[&#39;按时交货&#39;]/(data2[&#39;按时交货&#39;]&#43;data2[&#39;晚交货&#39;]) 结果：不同维度下交货率" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/278e2494d50f67fdf9da8b4307f33c99/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-14T20:05:54+08:00" />
<meta property="article:modified_time" content="2023-11-14T20:05:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Pandas学习——物流行业数据分析</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>——————————————学习资料和数据来源于B站-Python-学习库——————————</p> 
<h2>一.待分析问题</h2> 
<ol><li>货品的配送服务有没有问题——交货情况分析</li><li>有没有具有销售潜力的区域——货品销售情况分析</li><li>货品质量问题——货品用户反馈情况分析</li></ol> 
<h2>二.初识数据-清洗数据</h2> 
<blockquote> 
 <pre><code>data=pd.read_csv("data_wuliu.csv",encoding='gb2312')
print(data.info())
print(data.describe())</code></pre> 
 <p>运行结果表明，需要的操作：</p> 
 <p>1.删除空行</p> 
 <p>2.数据格式（时间→datetime；销售金额→规整且统一格式、可计算）</p> 
 <p>3.删除重复值</p> 
 <p>4.异常值（销售额！=0的行）</p> 
</blockquote> 
<p>清洗数据</p> 
<pre><code>#数据清洗
data=data.dropna(axis=0,how='any')#存在空，则删除该行
data=data.drop_duplicates(keep='first')#删除重复值，保留第一个
data=data.drop(columns=['订单行'],axis=1)#删除无用列
data=data[data["销售金额"]!=0]#保留销售金额不为0的数据
data['sale_time']=pd.to_datetime(data['销售时间'])#将销售时间格式转换成datetime格式
data['月份']=data['sale_time'].apply(lambda x:x.month)#对销售时间做映射，提取其中的月份信息，写入“月份”列


#对销售金额进行规整：对于
def amounts_deal(x):
    if x.find('万元')!=-1:#说明销售金额中存在万元，转换成以元为单位的浮点型
        amounts=float(x[:x.find('万元')].replace(',',''))*10000
    else:
        amounts=float(x[:x.find('元')].replace(',',''))
    return amounts
#调用函数-处理销售金额
data['销售金额']=data['销售金额'].map(amounts_deal)

#重新更新索引
data=data.reset_index(drop=True)</code></pre> 
<h2>三.数据分析及可视化</h2> 
<hr> 
<blockquote> 
 <pre><code>"""1.货品的配送服务有没有问题——交货情况分析"""
data['货品交货状况']=data['货品交货状况'].str.strip()#货品交货状况改成字符串的格式，并去除前后空格
#a.时间维度看货品交货状态
data1=data.groupby(by=['月份','货品交货状况']).size().unstack()
data1['按时交货率'] = data1['按时交货']/(data1['按时交货']+data1['晚交货'])
data1['按时交货率'].plot(kind='line')
plt.xlabel('月份')
plt.ylabel('按时交货率')
plt.title('月份-按时交货率分析')

#b.货品维度
data2=data.groupby(by=['货品','货品交货状况']).size().unstack()
data2['按时交货率'] = data2['按时交货']/(data2['按时交货']+data2['晚交货'])
data2['按时交货率'].plot(kind='line')
plt.xlabel('货品')
plt.ylabel('按时交货率')
plt.title('货品-按时交货率分析')

#c.销售区域维度
data3=data.groupby(by=['销售区域','货品交货状况']).size().unstack()
data3['按时交货率'] = data3['按时交货']/(data3['按时交货']+data3['晚交货'])
data3['按时交货率'].plot(kind='line')
plt.xlabel('销售区域')
plt.ylabel('按时交货率')
plt.title('销售区域-按时交货率分析')

#d 货品和销售区域维度
data['货品交货状况']=data['货品交货状况'].str.strip()
data2=data.groupby(['货品','销售区域','货品交货状况']).size().unstack()
data2['按时交货率']=data2['按时交货']/(data2['按时交货']+data2['晚交货'])
</code></pre> 
 <hr> 
 <p>结果：不同维度下交货率<img alt="" src="https://images2.imgbox.com/40/de/a5HD5PND_o.png"></p> 
 <p></p> 
 <p>从月份上来看， 11月份按时交货率最低，第四季度的按时交货率普遍低于第三季度；</p> 
 <p>从货品上来看，货品4的按时交货率极低，急需该货品的更多数据进行分析和提出改善意见；</p> 
 <p>从销售区域上看，西北地区的按时交货率极低，需要针对该区域的物流信息做出分析和调整</p> 
 <p>从货品和销售区域多维分析，货品2在马来西亚的按时交货率极低，货品1和货品2在西北的交货率也很低；</p> 
</blockquote> 
<blockquote> 
 <p></p> 
 <pre><code>"""2.有没有具有销售潜力的区域——货品销售情况分析"""
#a.时间-货品销售数量（判断哪里可以增加宣传力度）
data4=data.groupby(by=['月份','货品'])['数量'].sum().unstack()#分组后对不同货品数量进行求和，进而分析
data4.plot(kind='line')
plt.xlabel('月份')
plt.ylabel('货品售出数量')
plt.title('月份-货品售出数量')
plt.show()

#b.时间-货品销售数量（判断什么时间可以增加宣传力度）
data5=data.groupby(by=['销售区域','货品'])['数量'].sum().unstack()#分组后对不同货品数量进行求和
print(data5)</code></pre> 
 <hr> 
 <p>结果：货品销售维度分析</p> 
 <p><img alt="" src="https://images2.imgbox.com/20/94/Sz0xWgtK_o.png"></p> 
 <p></p> 
 <p> 从月份上来看，货品2在十月和十二月销量猛增猜测可能的原因有三：</p> 
 <p>1.加大了营销力度</p> 
 <p>2.开辟了新市场——验证货品2在马来西亚和华东地区销量随时间的变化，发现，十月份和十二月份，马来西亚的货品2销售并没有提高，说明十月、十一月销量的增大和开辟新市场可能无关，可能是增大了在华东地区的营销力度</p> 
 <pre><code>#单独分析货品2在华东和马来西亚的销量随时间变化的关系
data1=data[data['货品']=='货品2']
data2=data1.groupby(by=['月份','销售区域'])['数量'].sum().unstack()
print(data2)
data2.plot(kind='line')
plt.title('货品2在马来亚和华东地区销量随时间的变化关系')
plt.show()</code></pre> 
 <p style="text-align:center;"><img alt="" class="left" height="209" src="https://images2.imgbox.com/85/15/r8hjI5G6_o.png" width="278"></p> 
 <p></p> 
 <p>3.十月份是货品2需求量较高的时期，但考虑到十一月销量猛然下降，可能不是自然原因导致，该猜测力降低。</p> 
 <p>为验证猜测，分析不同月份和地区下，货品2在不同销售区域的销量</p> 
 <p></p> 
 <hr> 
 <p>分析不同区域下不同货品的销量结果</p> 
 <table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><td>销售区域</td><td>货品1</td><td>货品2</td><td>货品3</td><td>货品4</td><td>货品5</td><td>货品6</td></tr><tr><td>华东</td><td>NaN</td><td><span style="background-color:#ffd900;">53812.0</span></td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><td>华北</td><td>2827.0</td><td>NaN</td><td>9073.5</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><td>华南</td><td>579.0</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><td>泰国</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>5733.0</td><td>NaN</td></tr><tr><td>西北</td><td>11.0</td><td>NaN</td><td>NaN</td><td>5229.0</td><td>NaN</td><td>NaN</td></tr><tr><td>马来西亚</td><td>NaN</td><td><span style="background-color:#ffd900;">1510.0</span></td><td>NaN</td><td>NaN</td><td>NaN</td><td>8401.0</td></tr></tbody></table> 
 <p>可以看出，货品1具有三个销售区域，其中华北销量较好，华南销量较低，西北销量最低，需要加大影响力度；</p> 
 <p>货品2有两个销售区域，华东和马来西亚，其余都是只有一个销售力度</p> 
 <hr> 
 <pre><code>"""3.货品质量问题——看退货情况"""
#从货品和销售区域维度看
data['货品用户反馈']=data['货品用户反馈'].str.strip()
data5=data.groupby(['货品','销售区域'])['货品用户反馈'].value_counts().unstack()
data5['拒货率']=data5['拒货']/data5.sum(axis=1)
data5['返修率']=data5['返修']/data5.sum(axis=1)
data5['合格率']=data5['质量合格']/data5.sum(axis=1)
data5.sort_values(['合格率','返修率','拒货率'],ascending=False,inplace=True)
print(data5)</code></pre> 
 <p>结果：</p> 
 <table border="1"><thead><tr><th>货品用户反馈</th><th>拒货</th><th>质量合格</th><th>返修</th><th>拒货率</th><th>返修率</th><th>合格率</th></tr><tr><th>货品</th><th>销售区域</th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>货品3</th><th>华北</th><td>31.0</td><td>188.0</td><td>19.0</td><td>0.130252</td><td>0.079788</td><td>0.789219</td></tr><tr><th>货品6</th><th>马来西亚</th><td>56.0</td><td>246.0</td><td>14.0</td><td>0.177215</td><td>0.044279</td><td>0.777936</td></tr><tr><th>货品5</th><th>泰国</th><td>14.0</td><td>144.0</td><td>29.0</td><td>0.074866</td><td>0.155018</td><td>0.769108</td></tr><tr><th>货品2</th><th>华东</th><td>72.0</td><td>184.0</td><td>51.0</td><td>0.234528</td><td>0.165997</td><td>0.598568</td></tr><tr><th rowspan="3">货品1</th><th>华南</th><td>5.0</td><td>4.0</td><td>2.0</td><td>0.454545</td><td>0.174603</td><td>0.343963</td></tr><tr><th>西北</th><td>NaN</td><td>1.0</td><td>2.0</td><td>NaN</td><td>0.666667</td><td>0.272727</td></tr><tr><th>华北</th><td>NaN</td><td>3.0</td><td>12.0</td><td>NaN</td><td>0.800000</td><td>0.189873</td></tr><tr><th>货品4</th><th>西北</th><td>NaN</td><td>9.0</td><td>49.0</td><td>NaN</td><td>0.844828</td><td>0.152945</td></tr><tr><th>货品2</th><th>马来西亚</th><td>6.0</td><td>1.0</td><td>3.0</td><td>0.600000</td><td>0.283019</td><td>0.091886</td></tr></tbody></table> 
 <p>结果看来</p> 
 <p>货品3.6.5合格率均较高，返修率比较低，说明质量还可以</p> 
 <p>货品1.2.4合格率较低，返修率较高，质量存在一定的问题，需要改善</p> 
 <p>货品2在马拉西亚的拒货率最高，同时货品2在马来西亚的按时交货率较低，为0.100000。猜测：马来西亚人对送货的时效性要求较高，如果达不到，则往往考虑拒货。</p> 
 <p>考虑到货品2主要在华东地区销售量大，可以考虑增大在华东的投资，适当减小马来西亚的投入。</p> 
</blockquote> 
<h2>四.数据分析报告</h2> 
<p>综合数据分析报告</p> 
<p>数据来源于某企业销售的6种商品所对应的送货及用户反馈结果数据，分别在货品按时交货率、货品销量、货品质量上进行了分析</p> 
<p>1.按时交货率</p> 
<p>从月份上来看， 11月份按时交货率最低，第四季度的按时交货率普遍低于第三季度，说明<strong>货品运送情况可能与季节、温度有关</strong>；</p> 
<p>从货品上来看，货品4的按时交货率极低，<strong>急需该货品的更多数据进行分析</strong>，以指导得出按时交货率低的主要原因并提出改善意见；</p> 
<p>从销售区域上看，<strong>西北地区的按时交货率极低，需要针对该区域的物流信息做出分析和调整</strong>；</p> 
<p>2.货品销量</p> 
<p>六种货品除货品2外整体波动不大，货品2在十月和十二月销量猛增，该货品共有两个销售区域，分别为华东和马来西亚，对华东和马来西亚区域货品2的销量分析得，<strong>货品2在华东地区的销量较好</strong>，<strong>在马来西亚销量较低，需要做出措施，</strong>且在十月份，华东地区销量猛增，可能加大了营销力度。</p> 
<p>3.货品质量</p> 
<p>货品3.6.5合格率均较高，返修率比较低，说明质量还可以</p> 
<p>货品1.2.4合格率较低，返修率较高，质量存在一定的问题，需要改善</p> 
<p>货品2在马拉西亚的拒货率最高，同时，在货品2在马拉西亚的按时交货率也非常低。猜测：马来西亚人对送货的时效性要求较高，如果达不到，则往往考虑拒货。考虑到货品2主要在华东地区销售量大，可以考虑增大在华东的投资，适当减小马来西亚的投入。</p> 
<h2>五.知识点get√</h2> 
<ol><li>格式object→datetime</li><li>python中find（）函数</li><li>删除空/重复/列</li><li>apply() 函数，自由度较高，可以直接对 Series（带标签的一位数组） 或者 DataFrame （表格型的数据结构，既有行索引，也有列索引，可看做Series组成的字典）中元素进行逐元素遍历操作，方便且高效，具有类似于 Numpy 的特性。</li><li>unstack()：将DataFrame格式中行转换成列，便于清晰显示。</li></ol>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cf57d97e032328f5d72e0ca97bc4e5b1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">爬虫项目实战2.1 Selenium爬取Boss招聘信息</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d8788ead6d5ef970a40575674e6b1a08/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">STM32学习笔记(五) —— 按键翻转LED</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>