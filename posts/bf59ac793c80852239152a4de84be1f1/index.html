<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>android@adb连接电脑和android设备@安装和卸载@清除app数据 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="android@adb连接电脑和android设备@安装和卸载@清除app数据" />
<meta property="og:description" content="文章目录 refadb连接电脑和android设备android设备端设置和准备电脑端准备 android设备开发者选项设置推荐(可选)实例adb 安装app实例👺adb 卸载app实例 FAQ@可能出现的问题👺错误的进入adb shellmore than one device/emulator 第三方安装器查看应用版本清除app数据 参考adb文档 ref Android 调试桥 (adb) | Android 开发者 | Android Developers adb连接电脑和android设备 android设备端设置和准备 USB选项: 选择文件传输而不是仅充电(只会导致文件传输等功能无法生效) 典型错误:more than one device/emulator 打开开发者选项(developerOptions)启用USB调试(USB debugging) Switche to debugging mode when USB is connected 允许通过USB安装应用(apps)(Install via USB) 根据设备情况启用(比如MIUI) (可选)关闭授权过期功能(Disalble adb authorizatoin timeout) 电脑端准备 下载adb工具包,并将所在目录用命令行打开(推荐配置到系统环境变量,以便在任何目录下可以调用adb)将需要安装的包准备在已知目录(比如桌面)或者adb命令工具所在目录 前者使用绝对路径定位安装包位置:执行命令的格式为adb install xxx/xxx/appName.apk&gt;完成安装后者只需要知道安装包的名字即可执行安装:执行adb install &lt;appName.apk&gt;完成安装即可 android设备开发者选项设置推荐(可选) 如果您经常用手机连接电脑做通行/传输,那么建议将usb连接的默认选项设置为File Transfer(文件传输)设置方法: 较新android设备可以在设置搜索框中搜索默认或者直接在设置中按照打开路径:Additional settings/Developer options/Default Use configuration/File Transfer 实例 adb 安装app实例👺 检查设备链接情况
PS C:\Users\cxxu\Desktop\n11tp&gt; adb devices List of devices attached UO7PKFNF99IR9TV4 device 执行安装" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/bf59ac793c80852239152a4de84be1f1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-29T15:47:52+08:00" />
<meta property="article:modified_time" content="2023-11-29T15:47:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">android@adb连接电脑和android设备@安装和卸载@清除app数据</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#ref_2" rel="nofollow">ref</a></li><li><a href="#adbandroid_6" rel="nofollow">adb连接电脑和android设备</a></li><li><ul><li><a href="#android_8" rel="nofollow">android设备端设置和准备</a></li><li><a href="#_23" rel="nofollow">电脑端准备</a></li></ul> 
   </li><li><a href="#android_32" rel="nofollow">android设备开发者选项设置推荐(可选)</a></li><li><a href="#_41" rel="nofollow">实例</a></li><li><ul><li><a href="#adb_app_43" rel="nofollow">adb 安装app实例👺</a></li><li><a href="#adb_app_68" rel="nofollow">adb 卸载app实例</a></li></ul> 
   </li><li><a href="#FAQ_86" rel="nofollow">FAQ@可能出现的问题👺</a></li><li><ul><li><ul><li><a href="#adb_shell_90" rel="nofollow">错误的进入adb shell</a></li><li><a href="#more_than_one_deviceemulator_99" rel="nofollow">more than one device/emulator</a></li></ul> 
   </li></ul> 
   </li><li><a href="#_166" rel="nofollow">第三方安装器</a></li><li><a href="#_172" rel="nofollow">查看应用版本</a></li><li><ul><li><a href="#app_185" rel="nofollow">清除app数据</a></li></ul> 
   </li><li><a href="#adb_200" rel="nofollow">参考adb文档</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="ref_2"></a>ref</h3> 
<ul><li><a href="https://developer.android.com/studio/command-line/adb" rel="nofollow">Android 调试桥 (adb) | Android 开发者 | Android Developers</a></li></ul> 
<h3><a id="adbandroid_6"></a>adb连接电脑和android设备</h3> 
<h4><a id="android_8"></a>android设备端设置和准备</h4> 
<ul><li>USB选项: 
  <ul><li>选择<strong>文件传输</strong></li><li>而不是仅充电(只会导致文件传输等功能无法生效) 
    <ul><li>典型错误:<code>more than one device/emulator</code></li></ul> </li></ul> </li><li>打开<strong>开发者选项</strong>(developerOptions)</li><li>启用USB调试(USB debugging) 
  <ul><li>Switche to debugging mode when USB is connected</li></ul> </li><li>允许通过USB安装应用(apps)(Install via USB) 
  <ul><li>根据设备情况启用(比如MIUI)</li></ul> </li><li>(可选)关闭授权过期功能(Disalble adb authorizatoin timeout)</li></ul> 
<h4><a id="_23"></a>电脑端准备</h4> 
<ul><li>下载adb工具包,并将所在目录用命令行打开(推荐配置到系统环境变量,以便在任何目录下可以调用adb)</li><li>将需要安装的包准备在已知目录(比如桌面)或者adb命令工具所在目录 
  <ul><li>前者使用绝对路径定位安装包位置:执行命令的格式为<code>adb install xxx/xxx/appName.apk&gt;</code>完成安装</li><li>后者只需要知道安装包的名字即可执行安装:执行<code>adb install &lt;appName.apk&gt;</code>完成安装即可</li></ul> </li></ul> 
<h3><a id="android_32"></a>android设备开发者选项设置推荐(可选)</h3> 
<ul><li>如果您经常用手机连接电脑做通行/传输,那么建议将usb连接的默认选项设置为<code>File Transfer</code>(文件传输)</li><li>设置方法: 
  <ul><li>较新android设备可以在设置搜索框中搜索<code>默认</code></li><li>或者直接在设置中按照打开路径:<code>Additional settings/Developer options/Default Use configuration/File Transfer</code></li></ul> </li></ul> 
<h3><a id="_41"></a>实例</h3> 
<h4><a id="adb_app_43"></a>adb 安装app实例👺</h4> 
<ol><li> <p>检查设备链接情况</p> 
  <ul><li> <pre><code class="prism language-bash">PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>cxxu<span class="token punctuation">\</span>Desktop<span class="token punctuation">\</span>n11tp<span class="token operator">&gt;</span> adb devices
List of devices attached
UO7PKFNF99IR9TV4        device
</code></pre> </li></ul> </li><li> <p>执行安装</p> 
  <ul><li> <pre><code class="prism language-bash">PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>cxxu<span class="token punctuation">\</span>Desktop<span class="token operator">&gt;</span> adb <span class="token function">install</span> .<span class="token punctuation">\</span>magisk.apk
Performing Streamed Install
Success
</code></pre> </li><li> <p>看到<code>success</code>,说明安装成功</p> </li><li> <p>上述命令在2类情形下可以执行:</p> 
    <ul><li>安装包在桌面上,即<code>C:\Users\xxxx\Desktop&gt; </code></li><li>或者<code>adb</code>所在目录被配置环境变量<code>Path</code>中</li></ul> </li></ul> </li></ol> 
<h4><a id="adb_app_68"></a>adb 卸载app实例</h4> 
<ul><li> <p><code>adb uninstall &lt;packageName&gt;</code></p> </li><li> <p>例如:卸载酷安应用市场:</p> <pre><code class="prism language-bash\">PS C:\Users\cxxu\Downloads&gt; adb uninstall com.coolapk.market
Success
</code></pre> </li><li> <p>如果要降级安装某些应用,通常,就需要先卸载新版本,再安装老版本</p> 
  <ul><li>如果有root权限或其他高于一般的权限,可以直接强制降级app</li><li>比如核心破解这类修改系统默认行为的工具</li></ul> </li></ul> 
<h3><a id="FAQ_86"></a>FAQ@可能出现的问题👺</h3> 
<h5><a id="adb_shell_90"></a>错误的进入adb shell</h5> 
<ul><li> <pre><code class="prism language-bash">xaga:/sdcard $ <span class="token function">install</span> magisk.apk
install: Needs <span class="token number">2</span> arguments
</code></pre> 
  <ul><li>adb install 是adb可执行文件提供,而不是adb shell 提供的(toybox)</li></ul> </li></ul> 
<h5><a id="more_than_one_deviceemulator_99"></a>more than one device/emulator</h5> 
<ul><li> <pre><code>PS C:\Users\cxxu\Desktop\n11tp&gt; adb install .\magisk.apk
adb.exe: more than one device/emulator
</code></pre> 
  <ul><li> <p>初步排查:</p> 
    <ul><li> <p>使用<code>adb devices </code> -l检查当前列表</p> 
      <ul><li>这里加一个参数<code>-l</code>会列出设备更加详细的信息,推荐加上,可看到设备型号</li></ul> </li><li> <p>下面是adb 将设备识别为多模拟设备</p> 
      <ul><li> <p>这可能是根手机端选择的链接方式的选项有关!</p> </li><li> <p>从而导致虽然只连接了一台设备,却扫描出了2台设备(包括模拟设备,应该是您的选项<code>Use USB for </code>的选项更换之后导致的)</p> </li><li> <pre><code class="prism language-bash">PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>cxxu<span class="token operator">&gt;</span> adb devices
List of devices attached
UO7PKFNF99IR9TV4        device
emulator-5554   offline
</code></pre> </li></ul> </li><li> <p>如果向上面所讲的那样,发现了多台设备,那么考虑如下做法:</p> 
      <ul><li> <p>断开所有adb链接:<code>adb kill-server</code></p> 
        <ul><li> <p>然后重新检查设备列表</p> </li><li> <pre><code class="prism language-bash">PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>cxxu<span class="token operator">&gt;</span> adb kill-server

PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>cxxu<span class="token operator">&gt;</span> adb devices <span class="token parameter variable">-l</span>
* daemon not running<span class="token punctuation">;</span> starting now at tcp:5037
* daemon started successfully
List of devices attached
UO7PKFNF99IR9TV4       device product:xaga model:22041216C device:xaga transport_id:1
</code></pre> </li><li> <p>您也可以选择跳过<code>adb kill-server</code>,通过追加选项<code>-s</code>指定设备参数</p> </li><li> <p>这样就不会导致设备指代不明的错误</p> </li><li> <p>如果您链接了多个android设备(包括虚拟设备),</p> 
          <ul><li>考虑物理断开与其他设备</li><li>但是最优雅的方式,是指定具体设备进行通行/控制 
            <ul><li><code>adb -s xxx </code></li></ul> </li><li>这里的<code>xxx</code>代指的是设备序列号,例如上面的<code>UO7PKFNF99IR9TV4</code></li></ul> </li></ul> </li></ul> </li><li> <p>开发者选项相关开关为正确开启,也可能导致相应错误</p> </li></ul> </li></ul> </li></ul> 
<p>​</p> 
<ul><li> <pre><code class="prism language-bash">PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>cxxu<span class="token punctuation">\</span>Desktop<span class="token punctuation">\</span>n11tp<span class="token operator">&gt;</span> adb <span class="token function">install</span> .<span class="token punctuation">\</span>magisk.apk
Performing Streamed Install
adb: failed to <span class="token function">install</span> .<span class="token punctuation">\</span>magisk.apk: Failure <span class="token punctuation">[</span>INSTALL_FAILED_USER_RESTRICTED: Install canceled by user<span class="token punctuation">]</span>

</code></pre> </li></ul> 
<h3><a id="_166"></a>第三方安装器</h3> 
<ul><li>某些系统由于某些原因限制了安装第三方app</li><li>可以考虑使用第三方安装器:<a href="https://github.com/Xposed-Modules-Repo/com.yxer.compo.module">GitHub - Xposed-Modules-Repo/com.yxer.compo.module: R-安装组件-扩展</a> 
  <ul><li>这个软件以及类似软件可以在Coolapk(酷安)找到相关资源贴)</li></ul> </li></ul> 
<h3><a id="_172"></a>查看应用版本</h3> 
<ul><li> <p><code> dumpsys package &lt;com.example.packageName&gt;|grep versionName -i</code></p> </li><li> <p>例如,查看酷安的版本:</p> <pre><code class="prism language-bash">windows_x86_64:/$ dumpsys package com.coolapk.market<span class="token operator">|</span><span class="token function">grep</span> versionName <span class="token parameter variable">-i</span>
    <span class="token assign-left variable">versionName</span><span class="token operator">=</span><span class="token number">13.1</span>.3
</code></pre> </li></ul> 
<h4><a id="app_185"></a>清除app数据</h4> 
<ul><li> <p><code>adb shell clear &lt;appPackage&gt;</code></p> </li><li> <p>例如</p> 
  <ul><li> <pre><code class="prism language-bash">PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>cxxu<span class="token punctuation">\</span>Desktop<span class="token operator">&gt;</span> adb shell pm <span class="token function">clear</span> com.android.settings
Success
</code></pre> </li></ul> </li><li> <p>例如刷入的某些模块导致系统无法正常运行,(比如卡在锁屏界面),可以尝试清除受怀疑的模块或者禁用它</p> </li></ul> 
<h3><a id="adb_200"></a>参考adb文档</h3> 
<ul><li> <pre><code class="prism language-bash">PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>cxxu<span class="token operator">&gt;</span> adb
Android Debug Bridge version <span class="token number">1.0</span>.41
Version <span class="token number">33.0</span>.2-8557947
Installed as D:<span class="token punctuation">\</span>exes<span class="token punctuation">\</span>platform-tools<span class="token punctuation">\</span>adb.exe
<span class="token punctuation">..</span><span class="token punctuation">..</span>省略篇幅<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">(</span>跳过,直达主题:<span class="token punctuation">..</span>app intallation

app installation <span class="token punctuation">(</span>see also <span class="token variable"><span class="token variable">`</span>adb shell cmd package <span class="token builtin class-name">help</span><span class="token variable">`</span></span><span class="token punctuation">)</span>: 
 <span class="token function">install</span> <span class="token punctuation">[</span>-lrtsdg<span class="token punctuation">]</span> <span class="token punctuation">[</span>--instant<span class="token punctuation">]</span> PACKAGE
     push a single package to the device and <span class="token function">install</span> it
 install-multiple <span class="token punctuation">[</span>-lrtsdpg<span class="token punctuation">]</span> <span class="token punctuation">[</span>--instant<span class="token punctuation">]</span> PACKAGE<span class="token punctuation">..</span>.
     push multiple APKs to the device <span class="token keyword">for</span> a single package and <span class="token function">install</span> them
 install-multi-package <span class="token punctuation">[</span>-lrtsdpg<span class="token punctuation">]</span> <span class="token punctuation">[</span>--instant<span class="token punctuation">]</span> PACKAGE<span class="token punctuation">..</span>.
     push one or <span class="token function">more</span> packages to the device and <span class="token function">install</span> them atomically
     -r: replace existing application
     -t: allow <span class="token builtin class-name">test</span> packages
     -d: allow version code downgrade <span class="token punctuation">(</span>debuggable packages only<span class="token punctuation">)</span>
     -p: partial application <span class="token function">install</span> <span class="token punctuation">(</span>install-multiple only<span class="token punctuation">)</span>
     -g: grant all runtime permissions
     <span class="token parameter variable">--abi</span> ABI: override platform<span class="token string">'s default ABI
     --instant: cause the app to be installed as an ephemeral install app
     --no-streaming: always push APK to device and invoke Package Manager as separate steps
     --streaming: force streaming APK directly into Package Manager
     --fastdeploy: use fast deploy
     --no-fastdeploy: prevent use of fast deploy
     --force-agent: force update of deployment agent when using fast deploy
     --date-check-agent: update deployment agent when local version is newer and using fast deploy
     --version-check-agent: update deployment agent when local version has different version code and using fast deploy
     (See also `adb shell pm help` for more options.)
 uninstall [-k] PACKAGE
     remove this app package from the device
     '</span>-k': keep the data and cache directories

</code></pre> </li><li> <p>根据帮助文档</p> 
  <ul><li>app installation (see also <code>adb shell cmd package help</code>): 
    <ul><li><u>install</u> [-lrtsdg] [–instant] <u>PACKAGE</u><br> push a single package to the device and install it</li></ul> </li><li>可以发现,使用adb程序的子命令install来安装某个包到设备 
    <ul><li>具体通过<code>adb install</code>来调用,因为install package是adb可执行文件提供的命令接口</li><li>该包含了多个可选的选项和一个参数(安装包的路径)</li><li>也可以不使用任何选项,默认行为就是执行app包文件安装</li><li>吐槽一下原文档第一个子命令install没有换行的问题,容易漏看,可以结合grep来看文档</li></ul> </li></ul> </li></ul>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/48a81dec252c567f2b404ef4b256deec/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL8.0的中文OCP考题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e049883d7461f5273b393a8017179d81/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue3 setup写法页面引入个性化子组件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>