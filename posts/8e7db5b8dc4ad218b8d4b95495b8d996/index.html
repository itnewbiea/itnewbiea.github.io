<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>源码编译安装Apache - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="源码编译安装Apache" />
<meta property="og:description" content="目录
✨apache安装步骤
🍭挂载镜像
🍭解压并安装
🍭安装主程序
🍭优化链接及服务
🍭查看httpd模块
🍭查看mpm配置文件
🍭查看apache主页
🍭使用ab命令进行压力测试
🦐博客主页：大虾好吃吗的博客
🦐专栏地址：Linux从入门到精通
apache安装步骤 检查是否已经rpm安装httpd服务，已安装则卸载服务。 [root@localhost ~]# rpm -e `rpm -qa | grep httpd` --nodeps 开发工具安装 如果编译安装无法执行，可能是开发工具没有安装，执行下面命令即可安装。（如已安装则跳过即可）。
[root@localhost ~]# yum -y install make gcc gcc-c&#43;&#43; kernel-devel m4 ncurses-devel openssl-devel httpd安装 挂载镜像 查看虚拟机使用ISO镜像，设备状态勾选已连接和启动时连接后确定即可。
解压并安装 [root@localhost ~]# mkdir /sh [root@localhost ~]# cd /sh [root@localhost sh]# vim add.sh #!/bin/bash mount /dev/cdrom /media/ tar zxf /media/apr-1.5.2.tar.gz -C /usr/src cd /usr/src/apr-1.5.2 ./configure --prefix=/usr/local/apr &amp;&amp; make &amp;&amp; make install tar zxf /media/apr-util-1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8e7db5b8dc4ad218b8d4b95495b8d996/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-24T09:00:57+08:00" />
<meta property="article:modified_time" content="2023-10-24T09:00:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">源码编译安装Apache</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <h2 id="%E2%80%8B%E7%BC%96%E8%BE%91" style="text-align:center;"><img alt="" src="https://images2.imgbox.com/5c/60/QH6QkCFU_o.gif"></h2> 
</blockquote> 
<blockquote> 
 <p id="main-toc"><strong>目录</strong></p> 
 <p id="apache%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4-toc" style="margin-left:0px;"><a href="https://daxia.blog.csdn.net/article/details/131715371?spm=1001.2014.3001.5502#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2" rel="nofollow" title="✨">✨</a><a href="#apache%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4" rel="nofollow">apache安装步骤</a></p> 
 <p id="%E6%8C%82%E8%BD%BD%E9%95%9C%E5%83%8F-toc" style="margin-left:40px;"><a href="https://blog.csdn.net/qq_61116007/article/details/132303830?spm=1001.2014.3001.5501#%E6%A1%88%E4%BE%8B%E5%8D%81%E4%B8%80%EF%BC%9A%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E5%BA%93" title="🍭">🍭</a><a href="#%E6%8C%82%E8%BD%BD%E9%95%9C%E5%83%8F" rel="nofollow">挂载镜像</a></p> 
 <p id="%E8%A7%A3%E5%8E%8B%E5%B9%B6%E5%AE%89%E8%A3%85-toc" style="margin-left:40px;"><a href="https://blog.csdn.net/qq_61116007/article/details/132303830?spm=1001.2014.3001.5501#%E6%A1%88%E4%BE%8B%E5%8D%81%E4%B8%80%EF%BC%9A%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E5%BA%93" title="🍭">🍭</a><a href="#%E8%A7%A3%E5%8E%8B%E5%B9%B6%E5%AE%89%E8%A3%85" rel="nofollow">解压并安装</a></p> 
 <p id="%E5%AE%89%E8%A3%85%E4%B8%BB%E7%A8%8B%E5%BA%8F-toc" style="margin-left:40px;"><a href="https://blog.csdn.net/qq_61116007/article/details/132303830?spm=1001.2014.3001.5501#%E6%A1%88%E4%BE%8B%E5%8D%81%E4%B8%80%EF%BC%9A%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E5%BA%93" title="🍭">🍭</a><a href="#%E5%AE%89%E8%A3%85%E4%B8%BB%E7%A8%8B%E5%BA%8F" rel="nofollow">安装主程序</a></p> 
 <p id="%E4%BC%98%E5%8C%96%E9%93%BE%E6%8E%A5%E5%8F%8A%E6%9C%8D%E5%8A%A1-toc" style="margin-left:40px;"><a href="https://blog.csdn.net/qq_61116007/article/details/132303830?spm=1001.2014.3001.5501#%E6%A1%88%E4%BE%8B%E5%8D%81%E4%B8%80%EF%BC%9A%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E5%BA%93" title="🍭">🍭</a><a href="#%E4%BC%98%E5%8C%96%E9%93%BE%E6%8E%A5%E5%8F%8A%E6%9C%8D%E5%8A%A1" rel="nofollow">优化链接及服务</a></p> 
 <p id="%E6%9F%A5%E7%9C%8Bhttpd%E6%A8%A1%E5%9D%97-toc" style="margin-left:40px;"><a href="https://blog.csdn.net/qq_61116007/article/details/132303830?spm=1001.2014.3001.5501#%E6%A1%88%E4%BE%8B%E5%8D%81%E4%B8%80%EF%BC%9A%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E5%BA%93" title="🍭">🍭</a><a href="#%E6%9F%A5%E7%9C%8Bhttpd%E6%A8%A1%E5%9D%97" rel="nofollow">查看httpd模块</a></p> 
 <p id="%E6%9F%A5%E7%9C%8Bmpm%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-toc" style="margin-left:40px;"><a href="https://blog.csdn.net/qq_61116007/article/details/132303830?spm=1001.2014.3001.5501#%E6%A1%88%E4%BE%8B%E5%8D%81%E4%B8%80%EF%BC%9A%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E5%BA%93" title="🍭">🍭</a><a href="#%E6%9F%A5%E7%9C%8Bmpm%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" rel="nofollow">查看mpm配置文件</a></p> 
 <p id="%E6%9F%A5%E7%9C%8Bapache%E4%B8%BB%E9%A1%B5-toc" style="margin-left:40px;"><a href="https://blog.csdn.net/qq_61116007/article/details/132303830?spm=1001.2014.3001.5501#%E6%A1%88%E4%BE%8B%E5%8D%81%E4%B8%80%EF%BC%9A%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E5%BA%93" title="🍭">🍭</a><a href="#%E6%9F%A5%E7%9C%8Bapache%E4%B8%BB%E9%A1%B5" rel="nofollow">查看apache主页</a></p> 
 <p id="%E4%BD%BF%E7%94%A8ab%E5%91%BD%E4%BB%A4%E8%BF%9B%E8%A1%8C%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95-toc" style="margin-left:40px;"><a href="https://blog.csdn.net/qq_61116007/article/details/132303830?spm=1001.2014.3001.5501#%E6%A1%88%E4%BE%8B%E5%8D%81%E4%B8%80%EF%BC%9A%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E5%BA%93" title="🍭">🍭</a><a href="#%E4%BD%BF%E7%94%A8ab%E5%91%BD%E4%BB%A4%E8%BF%9B%E8%A1%8C%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95" rel="nofollow">使用ab命令进行压力测试</a></p> 
 <hr id="hr-toc"> 
 <p>   🦐博客主页：<a href="https://blog.csdn.net/qq_61116007?spm=1011.2415.3001.5343" title="大虾好吃吗的博客">大虾好吃吗的博客</a></p> 
 <p>   🦐专栏地址：<a href="https://blog.csdn.net/qq_61116007/category_12253732.html?spm=1001.2014.3001.5482" title="Linux从入门到精通">Linux从入门到精通</a></p> 
 <p> </p> 
</blockquote> 
<h2 id="apache%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4" style="text-align:justify;"><strong>apache安装步骤</strong></h2> 
<ul><li style="text-align:justify;">检查是否已经rpm安装httpd服务，已安装则卸载服务。</li></ul> 
<pre><code class="language-bash">[root@localhost ~]# rpm -e `rpm -qa | grep httpd` --nodeps</code></pre> 
<ul><li style="text-align:justify;">开发工具安装</li></ul> 
<p style="margin-left:.0001pt;text-align:justify;">        如果编译安装无法执行，可能是开发工具没有安装，执行下面命令即可安装。（如已安装则跳过即可）。</p> 
<pre><code class="language-bash">[root@localhost ~]# yum -y install make gcc gcc-c++ kernel-devel m4 ncurses-devel openssl-devel</code></pre> 
<ul><li style="text-align:justify;">httpd安装</li></ul> 
<p style="text-align:justify;"></p> 
<h3 id="%E6%8C%82%E8%BD%BD%E9%95%9C%E5%83%8F" style="text-align:justify;">挂载镜像</h3> 
<p style="margin-left:.0001pt;text-align:justify;">        查看虚拟机使用ISO镜像，设备状态勾选已连接和启动时连接后确定即可。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="773" src="https://images2.imgbox.com/5f/b5/1D9YIBk4_o.png" width="692"></p> 
<h3 id="%E8%A7%A3%E5%8E%8B%E5%B9%B6%E5%AE%89%E8%A3%85" style="text-align:justify;">解压并安装</h3> 
<pre><code class="language-bash"> [root@localhost ~]# mkdir /sh
 [root@localhost ~]#  cd /sh
 [root@localhost sh]# vim add.sh
#!/bin/bash
mount /dev/cdrom /media/
tar zxf /media/apr-1.5.2.tar.gz -C /usr/src
cd /usr/src/apr-1.5.2
./configure --prefix=/usr/local/apr &amp;&amp; make &amp;&amp; make install
tar zxf /media/apr-util-1.5.4.tar.gz -C /usr/src
cd /usr/src/apr-util-1.5.4
./configure --prefix=/usr/locl/apr-util --with-apr=/usr/local/apr &amp;&amp; make &amp;&amp; make install
yum -y install zlib-*
tar zxf /media/pcre-8.39.tar.gz -C /usr/src
cd /usr/src/pcre-8.39
./configure --prefix=/usr/local/pcre &amp;&amp; make &amp;&amp; make install
tar zxf /media/openssl-1.0.1u.tar.gz -C /usr/src
cd /usr/src/openssl-1.0.1u
./config -fPIC --prefix=/usr/local/openssl enable-shared &amp;&amp; make &amp;&amp; make install
保存退出脚本并执行脚本文件,等待脚本执行完成并确认成功。
[root@localhost sh]# sh add.sh</code></pre> 
<h3 id="%E5%AE%89%E8%A3%85%E4%B8%BB%E7%A8%8B%E5%BA%8F" style="text-align:justify;">安装主程序</h3> 
<p style="margin-left:.0001pt;text-align:justify;">        下面通过脚本来安装主程序。</p> 
<pre><code class="language-bash">[root@localhost sh]# vim httpd.sh
#!/bin/bash
tar zxf /media/httpd-2.4.25.tar.gz -C /usr/src
cd /usr/src/httpd-2.4.25
./configure --prefix=/usr/local/httpd --enable-so --enable-cgi --enable-cgid --enable-ssl --with-ssl=/usr/local/openssl --enable-rewrite --with-pcre=/usr/local/pcre --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util --enable-modules=most --enable-mods-shared=most --enable-mpms-shared=all --with-mpm=event --enable-proxy --enable-proxy-fcgi --enable-expires --enable-deflate &amp;&amp; make &amp;&amp; make install</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">        保存退出脚本并执行脚本文件,等待脚本执行完成并确认成功。</p> 
<h3 id="%E4%BC%98%E5%8C%96%E9%93%BE%E6%8E%A5%E5%8F%8A%E6%9C%8D%E5%8A%A1" style="text-align:justify;">优化链接及服务</h3> 
<pre><code class="language-bash">[root@localhost sh]# ln -s /usr/local/httpd/bin/* /usr/local/bin //链接优化
[root@localhost sh]# cp /usr/local/httpd/bin/apachectl /etc/init.d/httpd //添加服务
[root@localhost sh]# vim /etc/init.d/httpd
第二行添加下面两行命令
# chkconfig: 35 85 15     \\声明服务启动级别，开机启动顺序，关机关闭顺序
# description: apache 2.4.25 \\服务声明，简要信息
保存并退出


[root@localhost sh]# chkconfig --add httpd //添加到系统服务
[root@localhost sh]# chkconfig httpd on //设置开机自启
[root@localhost sh]# systemctl start httpd //开启服务</code></pre> 
<h3 id="%E6%9F%A5%E7%9C%8Bhttpd%E6%A8%A1%E5%9D%97" style="text-align:justify;">查看httpd模块</h3> 
<p style="margin-left:.0001pt;text-align:justify;">        安装后可以通过下面三行命令查看各项模块。</p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">httpd -V         #查看版本和已装模块</span></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">httpd -l           #只查看静态编译模块</span></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">httpd -M         #查看所有模块  </span></p> 
</blockquote> 
<h3 id="%E6%9F%A5%E7%9C%8Bmpm%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" style="text-align:justify;">查看mpm配置文件</h3> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:left;">vim /usr/local/httpd/conf/extra/httpd-mpm.conf</p> 
 <p style="margin-left:.0001pt;text-align:left;">&lt;IfModule mpm_event_module&gt;</p> 
 <p style="margin-left:.0001pt;text-align:left;">StartServers 3                                             #apache 启动时候默认开始的子进程数</p> 
 <p style="margin-left:.0001pt;text-align:left;">MinSpareThreads 75                                  #最小空闲数量的工作线程</p> 
 <p style="margin-left:.0001pt;text-align:left;">MaxSpareThreads 250                               #最大空闲数量的工作线程</p> 
 <p style="margin-left:.0001pt;text-align:left;">ThreadsPerChild 25                                    #每个子进程产生的线程数量</p> 
 <p style="margin-left:.0001pt;text-align:left;">MaxRequestWorkers 400                            #允许同时的最大接入请求数量</p> 
 <p style="margin-left:.0001pt;text-align:left;">MaxConnectionsPerChild 0                         #每个子进程可处理的请求数</p> 
 <p style="margin-left:.0001pt;text-align:left;">&lt;/IfModule&gt;</p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:left;">#企业推荐参数</p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:left;">&lt;IfModule mpm_worker_module&gt;</p> 
 <p style="margin-left:.0001pt;text-align:left;">StartServers          2                          #推荐设置：小=默认 中=3~5 大=5~10</p> 
 <p style="margin-left:.0001pt;text-align:left;">MaxClients          150                        #推荐设置：小=500 中=500~1500 大型=1500~3000</p> 
 <p style="margin-left:.0001pt;text-align:left;">MinSpareThreads      25                   #推荐设置：小=默认 中=50~100 大=100~200</p> 
 <p style="margin-left:.0001pt;text-align:left;">MaxSpareThreads      75                  #推荐设置：小=默认 中=80~160 大=200~400 ThreadsPerChild      25                     #推荐设置：小=默认 中=50~100 大型=100~200</p> 
 <p style="margin-left:.0001pt;text-align:left;">MaxRequestsPerChild   0                 #推荐设置：小=10000 中或大=10000~50000(此外，如果MaxClients/ThreadsPerChild大于16，还需额外设置ServerLimit参数，ServerLimit必须大于等于 MaxClients/ThreadsPerChild 的值。)</p> 
 <p style="margin-left:.0001pt;text-align:left;">&lt;/IfModule&gt;</p> 
</blockquote> 
<h3 id="%E6%9F%A5%E7%9C%8Bapache%E4%B8%BB%E9%A1%B5" style="text-align:left;">查看apache主页</h3> 
<p style="margin-left:.0001pt;text-align:left;">        通过访问http://192.168.1.2可以看到apache默认网站。</p> 
<p class="img-center"><img alt="" height="283" src="https://images2.imgbox.com/e0/21/EOiaNDi7_o.png" width="523"></p> 
<h3 id="%E4%BD%BF%E7%94%A8ab%E5%91%BD%E4%BB%A4%E8%BF%9B%E8%A1%8C%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95" style="text-align:justify;">使用ab命令进行压力测试</h3> 
<p style="margin-left:.0001pt;text-align:justify;">        通过上面命令已经启动httpd服务，通过ab工具测试httpd服务，如未安装通过下面命令安装ab命令工具（打开第二台服务器对第一台httpd服务器进行测试）。</p> 
<pre><code class="language-bash">[root@localhost ~]# yum -y install httpd-tools
安装完毕后执行下面命令对服务器进行200人并发访问，发出10000个请求。
[root@localhost ~]# ab -c 200 -n 10000 http://192.168.1.2/index.html
This is ApacheBench, Version 2.3 &lt;$Revision: 1430300 $&gt;
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking 192.168.1.2 (be patient)
Completed 1000 requests
Completed 2000 requests
Completed 3000 requests
Completed 4000 requests
Completed 5000 requests
Completed 6000 requests
Completed 7000 requests
Completed 8000 requests
Completed 9000 requests
Completed 10000 requests
Finished 10000 requests


Server Software:        Apache/2.4.25
Server Hostname:        192.168.1.2
Server Port:            80

Document Path:          /index.html
Document Length:        45 bytes

Concurrency Level:      200
Time taken for tests:   3.803 seconds
Complete requests:      10000
Failed requests:        0
Write errors:           0
Total transferred:      2890000 bytes
HTML transferred:       450000 bytes
Requests per second:    2629.29 [#/sec] (mean)
Time per request:       76.066 [ms] (mean)
Time per request:       0.380 [ms] (mean, across all concurrent requests)
Transfer rate:          742.06 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0   22 153.7      2    3008
Processing:     8   47  34.1     44     451
Waiting:        4   44  33.0     43     435
Total:         28   69 157.9     46    3057

Percentage of the requests served within a certain time (ms)
  50%     46
  66%     49
  75%     51
  80%     54
  90%     62
  95%     80
  98%    267
  99%   1048
 100%   3057 (longest request)</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">        通过以上操作就对httpd服务的配置完成了，关于其他配置敬请期待。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1c8240c39e125248f28c57a378790beb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">用nodejs爬虫台湾痞客邦相册</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fdb5948e73802232932b1ee0f78d1265/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">前端（二十一）——WebSocket：实现实时双向数据传输的Web通信协议</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>