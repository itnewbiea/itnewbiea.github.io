<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python办公自动化 – 操控远程桌面和文件版本控制 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python办公自动化 – 操控远程桌面和文件版本控制" />
<meta property="og:description" content="Python办公自动化 – 操控远程桌面和文件版本控制 以下是往期的文章目录，需要可以查看哦。
Python办公自动化 – Excel和Word的操作运用
Python办公自动化 – Python发送电子邮件和Outlook的集成
Python办公自动化 – 对PDF文档和PPT文档的处理
Python办公自动化 – 对Excel文档和数据库的操作运用、设置计划任务
Python办公自动化 – 对CSV文件运用和管理文件 / 文件夹
Python办公自动化 – 对数据进行分析和制作图表数据
Python办公自动化 – 对图片处理和文件的加密解密
Python办公自动化 – 语音识别和文本到语音的转换
Python办公自动化 – 日志分析和自动化FTP操作
Python办公自动化 – 进行网络监控和处理压缩文件
Python办公自动化 – 文件的比较合并和操作xml文件
Python办公自动化 – 定时邮件提醒和音视频文件处理
Python办公自动化 – 处理JSOM数据和操作SQL Server数据库
Python办公自动化 – 人脸识别和自动化测试
文章目录 Python办公自动化 – 操控远程桌面和文件版本控制前言一、使用Python进行远程桌面操作1、 安装 pyautogui 和 pyperclip 库2、编写Python脚本 二、Python如何进行文件的版本控制1、安装Git2、初始化仓库3、添加文件4、提交更改5、查看历史记录6、切换版本7、创建分⽀8、合并分支9、克隆远程仓库 总结 前言 Python办公自动化是利用Python编程语⾔来创建脚本和程序，以简化、加速和自动化日常办公任务和工作流程的过程。它基于Python的强大功能和丰富的第三方库，使得能够处理各种办公任务，如⽂档处理、数据分析、电子邮件管理、网络通信等等。
这里打个广告！！！优惠快递寄件可搜索 [寄小牛]，全国5折起。。。
一、使用Python进行远程桌面操作 使用Python进行远程桌面操作通常需要使用第三方库，以便与远程桌⾯协议进行通信。以下是使用pyautogui 和 pyperclip 库进行基本远程桌⾯操作（模拟⿏标和键盘输⼊）的示例。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/76b4ddb6a50dcbc148c602ca5131dab0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T10:18:16+08:00" />
<meta property="article:modified_time" content="2024-01-05T10:18:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python办公自动化 – 操控远程桌面和文件版本控制</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Python___1"></a>Python办公自动化 – 操控远程桌面和文件版本控制</h2> 
<p>以下是往期的文章目录，需要可以查看哦。<br> <a href="https://blog.csdn.net/u014740628/article/details/134977210">Python办公自动化 – Excel和Word的操作运用</a><br> <a href="https://blog.csdn.net/u014740628/article/details/135061728">Python办公自动化 – Python发送电子邮件和Outlook的集成</a><br> <a href="https://blog.csdn.net/u014740628/article/details/135080001">Python办公自动化 – 对PDF文档和PPT文档的处理</a><br> <a href="https://blog.csdn.net/u014740628/article/details/135084456">Python办公自动化 – 对Excel文档和数据库的操作运用、设置计划任务</a><br> <a href="https://blog.csdn.net/u014740628/article/details/135107875">Python办公自动化 – 对CSV文件运用和管理文件 / 文件夹</a><br> <a href="https://blog.csdn.net/u014740628/article/details/135122036">Python办公自动化 – 对数据进行分析和制作图表数据</a><br> <a href="https://blog.csdn.net/u014740628/article/details/135123317">Python办公自动化 – 对图片处理和文件的加密解密</a><br> <a href="https://blog.csdn.net/u014740628/article/details/135144265">Python办公自动化 – 语音识别和文本到语音的转换</a><br> <a href="https://blog.csdn.net/u014740628/article/details/135148841">Python办公自动化 – 日志分析和自动化FTP操作</a><br> <a href="https://blog.csdn.net/u014740628/article/details/135214333">Python办公自动化 – 进行网络监控和处理压缩文件</a><br> <a href="https://blog.csdn.net/u014740628/article/details/135235995">Python办公自动化 – 文件的比较合并和操作xml文件</a><br> <a href="https://blog.csdn.net/u014740628/article/details/135243613">Python办公自动化 – 定时邮件提醒和音视频文件处理</a><br> <a href="https://blog.csdn.net/u014740628/article/details/135377475">Python办公自动化 – 处理JSOM数据和操作SQL Server数据库</a><br> <a href="https://blog.csdn.net/u014740628/article/details/135380509">Python办公自动化 – 人脸识别和自动化测试</a></p> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#Python___1" rel="nofollow">Python办公自动化 – 操控远程桌面和文件版本控制</a></li><li><a href="#_24" rel="nofollow">前言</a></li><li><a href="#Python_35" rel="nofollow">一、使用Python进行远程桌面操作</a></li><li><ul><li><a href="#1__pyautogui__pyperclip__40" rel="nofollow">1、 安装 pyautogui 和 pyperclip 库</a></li><li><a href="#2Python_43" rel="nofollow">2、编写Python脚本</a></li></ul> 
  </li><li><a href="#Python_164" rel="nofollow">二、Python如何进行文件的版本控制</a></li><li><ul><li><a href="#1Git_166" rel="nofollow">1、安装Git</a></li><li><a href="#2_169" rel="nofollow">2、初始化仓库</a></li><li><a href="#3_177" rel="nofollow">3、添加文件</a></li><li><a href="#4_183" rel="nofollow">4、提交更改</a></li><li><a href="#5_189" rel="nofollow">5、查看历史记录</a></li><li><a href="#6_193" rel="nofollow">6、切换版本</a></li><li><a href="#7_198" rel="nofollow">7、创建分⽀</a></li><li><a href="#8_204" rel="nofollow">8、合并分支</a></li><li><a href="#9_209" rel="nofollow">9、克隆远程仓库</a></li></ul> 
  </li><li><a href="#_223" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_24"></a>前言</h2> 
<p>Python办公自动化是利用Python编程语⾔来创建脚本和程序，以简化、加速和自动化日常办公任务和工作流程的过程。它基于Python的强大功能和丰富的第三方库，使得能够处理各种办公任务，如⽂档处理、数据分析、电子邮件管理、网络通信等等。</p> 
<p><strong>这里打个广告！！！优惠快递寄件可搜索 [寄小牛]，全国5折起。。。</strong><br> <img src="https://images2.imgbox.com/93/3a/DXqqIkHB_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="Python_35"></a>一、使用Python进行远程桌面操作</h2> 
<p>使用Python进行远程桌面操作通常需要使用第三方库，以便与远程桌⾯协议进行通信。以下是使用pyautogui 和 pyperclip 库进行基本远程桌⾯操作（模拟⿏标和键盘输⼊）的示例。<br> 以下是⼀个简单的示例，用于模拟远程桌⾯操作，实际的远程桌面操作通常需要更复杂的方法和工具。</p> 
<h3><a id="1__pyautogui__pyperclip__40"></a>1、 安装 pyautogui 和 pyperclip 库</h3> 
<blockquote> 
 <p>pip install pyautogui pyperclip</p> 
</blockquote> 
<h3><a id="2Python_43"></a>2、编写Python脚本</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pyautogui
<span class="token keyword">import</span> time

<span class="token comment"># 模拟打开记事本</span>
pyautogui<span class="token punctuation">.</span>hotkey<span class="token punctuation">(</span><span class="token string">'win'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
pyautogui<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'notepad'</span><span class="token punctuation">)</span>
pyautogui<span class="token punctuation">.</span>press<span class="token punctuation">(</span><span class="token string">'enter'</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 输⼊⽂本</span>
text <span class="token operator">=</span> <span class="token string">"Hello, Remote Desktop!"</span>
pyperclip<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>text<span class="token punctuation">)</span>
pyautogui<span class="token punctuation">.</span>hotkey<span class="token punctuation">(</span><span class="token string">'ctrl'</span><span class="token punctuation">,</span> <span class="token string">'v'</span><span class="token punctuation">)</span>
</code></pre> 
<p>这个示例⾸先使用快捷键Win+R来打开运行对话框，然后输⼊"notepad"来运行记事本应用程序。接着，它模拟了Ctrl+V来粘贴之前复制到剪贴板的⽂本。<br> 请注意，这个示例只是⼀个演示，演示了如何使用 pyautogui 模拟鼠标和键盘输入。在实际的远程桌面操作中，可能需要更复杂的逻辑来与远程计算机进行通信，例如使用SSH、VNC、RDP等远程桌⾯协议。此外，远程桌面操作可能涉及屏幕截图、图像识别、窗⼝管理等更高级的操作。如果需要进行实际的远程桌面操作，建议考虑使用专门的远程桌面工具或库。</p> 
<p>以下两个简单示例可参考：</p> 
<p><strong>示例一：使用SSH协议进行远程桌面操作</strong></p> 
<p><strong>使用paramiko库进行SSH连接：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> paramiko  
  
ssh <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>SSHClient<span class="token punctuation">(</span><span class="token punctuation">)</span>  
ssh<span class="token punctuation">.</span>set_missing_host_key_policy<span class="token punctuation">(</span>paramiko<span class="token punctuation">.</span>AutoAddPolicy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
ssh<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'hostname'</span><span class="token punctuation">,</span> username<span class="token operator">=</span><span class="token string">'username'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'password'</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>进行屏幕截图：</strong><br> 首先，在远程计算机上安装并运行一个SSH屏幕截图工具（如scrot）。然后，可以通过SSH发送命令来触发截图操作。</p> 
<pre><code class="prism language-python">stdin<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr <span class="token operator">=</span> ssh<span class="token punctuation">.</span>exec_command<span class="token punctuation">(</span><span class="token string">'scrot screenshot.png'</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>进行图像识别：</strong><br> 将截图保存到本地后，可以使用OpenCV等图像处理库进行图像识别。例如，可以使用OpenCV的Haar Cascade分类器进行面部识别。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> cv2  
  
<span class="token comment"># 加载Haar Cascade分类器  </span>
face_cascade <span class="token operator">=</span> cv2<span class="token punctuation">.</span>CascadeClassifier<span class="token punctuation">(</span><span class="token string">'haarcascade_frontalface_default.xml'</span><span class="token punctuation">)</span>  
  
<span class="token comment"># 读取截图并转换为灰度图像  </span>
img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'screenshot.png'</span><span class="token punctuation">)</span>  
gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>  
  
<span class="token comment"># 检测面部  </span>
faces <span class="token operator">=</span> face_cascade<span class="token punctuation">.</span>detectMultiScale<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> <span class="token number">1.1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>  
<span class="token keyword">for</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>w<span class="token punctuation">,</span>h<span class="token punctuation">)</span> <span class="token keyword">in</span> faces<span class="token punctuation">:</span>  
    cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>w<span class="token punctuation">,</span>y<span class="token operator">+</span>h<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>  
    roi_gray <span class="token operator">=</span> gray<span class="token punctuation">[</span>y<span class="token punctuation">:</span>y<span class="token operator">+</span>h<span class="token punctuation">,</span> x<span class="token punctuation">:</span>x<span class="token operator">+</span>w<span class="token punctuation">]</span>  
    roi_color <span class="token operator">=</span> img<span class="token punctuation">[</span>y<span class="token punctuation">:</span>y<span class="token operator">+</span>h<span class="token punctuation">,</span> x<span class="token punctuation">:</span>x<span class="token operator">+</span>w<span class="token punctuation">]</span>
</code></pre> 
<p><strong>进行窗口管理：</strong><br> 可以使用pyautogui库进行窗口管理。例如，可以使用以下代码获取窗口列表、调整窗口大小等。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pyautogui  
<span class="token keyword">import</span> time  
  
<span class="token comment"># 获取窗口列表  </span>
windows <span class="token operator">=</span> pyautogui<span class="token punctuation">.</span>window_list<span class="token punctuation">(</span><span class="token punctuation">)</span>  
<span class="token keyword">for</span> window <span class="token keyword">in</span> windows<span class="token punctuation">:</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span>  
    <span class="token comment"># 窗口大小和位置调整等操作...</span>
</code></pre> 
<p><strong>关闭SSH连接：</strong></p> 
<pre><code class="prism language-python">ssh<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<hr> 
<hr> 
<hr> 
<p><strong>示例二：使用RDP协议进行远程桌面操作</strong></p> 
<p>使用第三方库如pywin32连接到远程桌面：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> win32com<span class="token punctuation">.</span>client  
  
rdp <span class="token operator">=</span> win32com<span class="token punctuation">.</span>client<span class="token punctuation">.</span>Dispatch<span class="token punctuation">(</span><span class="token string">"MsTscAx.TscAxNotSafeForScripting"</span><span class="token punctuation">)</span>  
rdp<span class="token punctuation">.</span>Connect<span class="token punctuation">(</span><span class="token string">"hostname"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>进行屏幕截图：</strong><br> 在远程桌面中，可以使用Windows API或第三方截图工具（如Snipping Tool）进行截图。然后，将截图保存到本地。</p> 
<p><strong>进行图像识别：</strong><br> 与示例一类似，可以使用OpenCV等图像处理库进行图像识别。可以将截图保存到本地后，使用这些库进行图像识别。</p> 
<p><strong>进行窗口管理：</strong><br> 在远程桌面中，可以使用Windows API或第三方窗口管理工具（如AutoIt）进行窗口管理。例如，可以使用以下代码获取窗口列表、调整窗口大小等。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> ctypes  
  
<span class="token comment"># 获取窗口列表  </span>
windows <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>windll<span class="token punctuation">.</span>user32<span class="token punctuation">.</span>EnumWindows<span class="token punctuation">(</span><span class="token keyword">lambda</span> hwnd<span class="token punctuation">,</span> param<span class="token punctuation">:</span> param<span class="token punctuation">.</span>append<span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">)</span>  
<span class="token keyword">for</span> window <span class="token keyword">in</span> windows<span class="token punctuation">:</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span>  
    <span class="token comment"># 窗口大小和位置调整等操作...</span>
</code></pre> 
<p><strong>关闭RDP连接：</strong><br> 断开与远程桌面的连接，释放资源。</p> 
<pre><code class="prism language-python">rdp<span class="token punctuation">.</span>Disconnect<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<hr> 
<hr> 
<hr> 
<h2><a id="Python_164"></a>二、Python如何进行文件的版本控制</h2> 
<p>Python中进行文件的版本控制通常使用版本控制系统（Version Control System，VCS）来管理代码和文件的不同版本。最常见的VCS包括Git和Mercurial。</p> 
<h3><a id="1Git_166"></a>1、安装Git</h3> 
<p>⾸先，需要安装Git。可以从Git官方网站（https://git-scm.com/）下载适用于操作系统的Git安装程序，并按照安装说明进形安装。</p> 
<h3><a id="2_169"></a>2、初始化仓库</h3> 
<p>在要进行版本控制的文件夹中，使用以下命令来初始化Git仓库：</p> 
<blockquote> 
 <p>git init<br> 这将在当前⽂件夹中创建⼀个 .git ⼦⽂件夹，⽤于存储Git的配置和版本历史。</p> 
</blockquote> 
<p>代码如下（示例）：</p> 
<h3><a id="3_177"></a>3、添加文件</h3> 
<p>使用以下命令将文件添加到Git仓库中：</p> 
<blockquote> 
 <p>git add filename<br> 可以使⽤ git add . 来添加所有⽂件。</p> 
</blockquote> 
<h3><a id="4_183"></a>4、提交更改</h3> 
<p>使用以下命令提交添加的文件和更改：</p> 
<blockquote> 
 <p>git commit -m “Commit message”<br> 将 “Commit message” 替换为有意义的提交消息，以描述的更改。</p> 
</blockquote> 
<h3><a id="5_189"></a>5、查看历史记录</h3> 
<p>可以使用以下命令查看提交的历史记录：</p> 
<blockquote> 
 <p>git log</p> 
</blockquote> 
<h3><a id="6_193"></a>6、切换版本</h3> 
<blockquote> 
 <p>git checkout commit_hash<br> 将 commit_hash 替换为要切换到的特定版本的哈希值。</p> 
</blockquote> 
<h3><a id="7_198"></a>7、创建分⽀</h3> 
<p>可以使用以下命令创建新的分支：</p> 
<blockquote> 
 <p>git branch branch_name</p> 
</blockquote> 
<h3><a id="8_204"></a>8、合并分支</h3> 
<p>将分支合并到主分支：</p> 
<blockquote> 
 <p>git checkout main # 切换到主分支<br> git merge branch_name # 合并分支</p> 
</blockquote> 
<h3><a id="9_209"></a>9、克隆远程仓库</h3> 
<p>如果要使用远程Git仓库进行协作，可以使用以下命令克隆远程仓库到本地：</p> 
<blockquote> 
 <p>git clone remote_repository_url<br> 将 remote_repository_url 替换为远程仓库的URL。</p> 
</blockquote> 
<p>以上只是Git的基本⽤法，Git还提供了许多其他功能，如分支管理、标签、远程仓库协作等。如果希望使用Git进行文件的版本控制，建议学习更多Git的高级功能和工作流程。如果使用其他VCS，如Mercurial，其基本原理和概念类似，但具体命令和操作可能有所不同。</p> 
<p>多学习可参考了解：<br> <a href="https://www.imooc.com/learn/1052" rel="nofollow">慕课网入门课程Git</a><br> <a href="https://git-scm.com/book/zh/v2" rel="nofollow">Git - Book</a></p> 
<hr> 
<h2><a id="_223"></a>总结</h2> 
<p>以上就是今天分享的内容，希望对看到的小伙伴有帮助，后续会持续更新完python办公自动化的文章分享，可以持续关注哦。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/16ad648e5c6f713c305d3a6fc963e50e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">乘号在键盘上怎么打？速来学习这4个方法！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8ef7417ae9ed61c26943f84111ddf0b5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Spark内核解析-部署模式解析8(六)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>