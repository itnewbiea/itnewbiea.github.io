<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Layui练习(读取mysql数据库表并导出为word) - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Layui练习(读取mysql数据库表并导出为word)" />
<meta property="og:description" content="Layui的练习(读取mysql数据库表并导出为word) 本Demo主要是为了练习layui的使用(Layui&#43;SSH)。
整体流程 页面首先将数据库的所有表名加载到下拉框中，由我们手动选择数据库表之后点击查询，然后将数据库表查询出来，利用分页查询，防止表中数据量过大造成浏览器卡死的情况，加载完成之后，依据是否需要进行导出，点击导出之后利用POI将数据库表导出到word文档中。
页面部分 html部分 &lt;hr align=center width=100% color=black size=&#34;1&#34; style=&#34;height: 3px;color: black&#34;&gt; &lt;form class=&#34;layui-form&#34; action=&#34;&#34;&gt; &lt;div class=&#34;layui-inline&#34;&gt; &lt;label class=&#34;layui-form-label&#34;&gt;选择数据表&lt;/label&gt; &lt;div class=&#34;layui-input-inline&#34;&gt; &lt;select id=&#34;select&#34; name=&#34;modules&#34; lay-filter=&#34;tablename&#34; lay-verify=&#34;&#34;&gt; &lt;/select&gt; &lt;/div&gt; &lt;/div&gt; &lt;button type=&#34;button&#34; id=&#34;query&#34; class=&#34;layui-btn layui-btn-normal&#34; style=&#34;width: 70px;height: 35px;margin-left: 10px&#34; onclick=&#34;xxx()&#34;&gt;查询&lt;/button&gt; &lt;button type=&#34;button&#34; class=&#34;layui-btn layui-btn-normal&#34; style=&#34;width: 70px;height: 35px;margin-left: 10px&#34; onclick=&#34;word()&#34;&gt;导出&lt;/button&gt; &lt;table id=&#34;tableinfo&#34; lay-filter=&#34;test&#34;&gt;&lt;/table&gt; js部分 预加载部分，声明Layui模块化，同时从后台获取数据库中的所有数据表
$(function () { layui.use([&#39;form&#39;,&#39;table&#39;],function () { form = layui.form; var table = layui.table; }); $." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8c6707fb7e3bb571813104fd798061f0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-07-11T10:55:12+08:00" />
<meta property="article:modified_time" content="2020-07-11T10:55:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Layui练习(读取mysql数据库表并导出为word)</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Layuimysqlword_2"></a>Layui的练习(读取mysql数据库表并导出为word)</h2> 
<p>本Demo主要是为了练习layui的使用(Layui+SSH)。</p> 
<blockquote> 
 <h3><a id="_6"></a>整体流程</h3> 
</blockquote> 
<p>页面首先将数据库的所有表名加载到下拉框中，由我们手动选择数据库表之后点击查询，然后将数据库表查询出来，利用分页查询，防止表中数据量过大造成浏览器卡死的情况，加载完成之后，依据是否需要进行导出，点击导出之后利用POI将数据库表导出到word文档中。</p> 
<blockquote> 
 <h3><a id="_10"></a>页面部分</h3> 
</blockquote> 
<h5><a id="html_12"></a>html部分</h5> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span>center</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span>100%</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span>black</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">height</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span> black</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-inline<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-label<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>选择数据表<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input-inline<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>select<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>modules<span class="token punctuation">"</span></span> <span class="token attr-name">lay-filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tablename<span class="token punctuation">"</span></span> <span class="token attr-name">lay-verify</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>query<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-btn layui-btn-normal<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> 70px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> 35px<span class="token punctuation">;</span><span class="token property">margin-left</span><span class="token punctuation">:</span> 10px</span><span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xxx()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>查询<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-btn layui-btn-normal<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> 70px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> 35px<span class="token punctuation">;</span><span class="token property">margin-left</span><span class="token punctuation">:</span> 10px</span><span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>word()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>导出<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tableinfo<span class="token punctuation">"</span></span> <span class="token attr-name">lay-filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>test<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="js_29"></a>js部分</h5> 
<p>预加载部分，声明Layui模块化，同时从后台获取数据库中的所有数据表</p> 
<pre><code class="prism language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        layui<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'form'</span><span class="token punctuation">,</span><span class="token string">'table'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            form <span class="token operator">=</span> layui<span class="token punctuation">.</span>form<span class="token punctuation">;</span>
            <span class="token keyword">var</span> table <span class="token operator">=</span> layui<span class="token punctuation">.</span>table<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                type<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
                url<span class="token punctuation">:</span> <span class="token string">'/tabledata/gettablename.do'</span><span class="token punctuation">,</span>
                <span class="token keyword">async</span><span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                dataType<span class="token punctuation">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>
                cache<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                success<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> htmls <span class="token operator">=</span> <span class="token string">'&lt;option value = ""&gt;选择数据表&lt;/option&gt;'</span><span class="token punctuation">;</span>
                    <span class="token comment">//动态给Layui下拉框赋值</span>
                    $<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#select'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Option</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 下拉菜单里添加元素</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>返回的json数据是一个json数组，数组内是表名，返回后用data接收</p> 
<h6><a id="_58"></a>后台代码</h6> 
<pre><code class="prism language-java"> <span class="token comment">//下拉框表名</span>
<span class="token annotation punctuation">@Action</span><span class="token punctuation">(</span><span class="token string">"gettablename"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">gettablename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    List<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> tablename <span class="token operator">=</span> tableservice<span class="token punctuation">.</span><span class="token function">tablename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">printJson</span><span class="token punctuation">(</span>JsonUtil<span class="token punctuation">.</span><span class="token function">ObjectToJson</span><span class="token punctuation">(</span>tablename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>Service层</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> List<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> <span class="token function">tablename</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        List<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> tableName <span class="token operator">=</span> mysqlUtil<span class="token punctuation">.</span><span class="token function">getTableName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> tableName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>获取数据库的所有表名</p> 
<pre><code class="prism language-java"><span class="token comment">//获取数据库连接</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{<!-- --></span>
    Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> connection<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-java">    <span class="token comment">//获取数据库下的所有的表名</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> List<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> <span class="token function">getTableName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        List<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> tableNames <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ResultSet resultSet <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            connection <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取数据库连接</span>
            DatabaseMetaData metaData <span class="token operator">=</span> <span class="token function">getmetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//参数输入为null代表不启用该种约束</span>
            resultSet <span class="token operator">=</span> metaData<span class="token punctuation">.</span><span class="token function">getTables</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token string">"TABLE"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                tableNames<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                resultSet<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">closeConnection</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> tableNames<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h5><a id="_117"></a>获取下拉框中选择的表名</h5> 
<pre><code class="prism language-javascript">  <span class="token keyword">function</span> <span class="token function">gettablename</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> tablename <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#select option:selected"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> tablename<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>select是下拉框标签的id</p> 
<h5><a id="Layui_128"></a>获取Layui表头的数据格式</h5> 
<p>接受从后台返回的动态表头，用来构成Layui数据表格部分的col表头部分</p> 
<pre><code class="prism language-javascript"> <span class="token comment">//接受后台传回的动态表头</span>
    <span class="token keyword">function</span> <span class="token function">col</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> tablename <span class="token operator">=</span> <span class="token function">gettablename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取下拉框中的表名</span>
        <span class="token keyword">var</span> first <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            type<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
            <span class="token keyword">async</span><span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">//注意是同步</span>
            url<span class="token punctuation">:</span> <span class="token string">'/tabledata/col.do?tablename='</span><span class="token operator">+</span>tablename<span class="token punctuation">,</span>
            success<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                first <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>type<span class="token punctuation">:</span> <span class="token string">'checkbox'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//开启数据表格的第一列的复选框</span>
                res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span>data<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">var</span> tempinfo <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>field<span class="token punctuation">:</span> key<span class="token punctuation">,</span>title<span class="token punctuation">:</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
                        res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>tempinfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> res<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>json数据格式，以某张表为例，都是表的列名{field：title}</p> 
<pre><code class="prism language-json"><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">"id"</span><span class="token punctuation">:</span><span class="token string">"id"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token punctuation">{<!-- --></span><span class="token string">"pid"</span><span class="token punctuation">:</span><span class="token string">"pid"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token punctuation">{<!-- --></span><span class="token string">"line_name"</span><span class="token punctuation">:</span><span class="token string">"line_name"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token punctuation">{<!-- --></span><span class="token string">"start_lng"</span><span class="token punctuation">:</span><span class="token string">"start_lng"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token punctuation">{<!-- --></span><span class="token string">"start_lag"</span><span class="token punctuation">:</span><span class="token string">"start_lag"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token punctuation">{<!-- --></span><span class="token string">"end_lng"</span><span class="token punctuation">:</span><span class="token string">"end_lng"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token punctuation">{<!-- --></span><span class="token string">"end_lag"</span><span class="token punctuation">:</span><span class="token string">"end_lag"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token punctuation">{<!-- --></span><span class="token string">"alarm_point"</span><span class="token punctuation">:</span><span class="token string">"alarm_point"</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre> 
<h6><a id="_170"></a>后台代码</h6> 
<pre><code class="prism language-java"><span class="token comment">//查询表格的表头列名</span>
<span class="token annotation punctuation">@Action</span><span class="token punctuation">(</span><span class="token string">"col"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">tablecol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{<!-- --></span>
    String tablename <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"tablename"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> tablecol <span class="token operator">=</span> tableservice<span class="token punctuation">.</span><span class="token function">tablecol</span><span class="token punctuation">(</span>tablename<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">printJson</span><span class="token punctuation">(</span>JsonUtil<span class="token punctuation">.</span><span class="token function">ObjectToJson</span><span class="token punctuation">(</span>tablecol<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>Service层</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> <span class="token function">tablecol</span><span class="token punctuation">(</span>String tablename<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{<!-- --></span>
    List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> list <span class="token operator">=</span> tabledao<span class="token punctuation">.</span><span class="token function">gettableColumns</span><span class="token punctuation">(</span>tablename<span class="token punctuation">)</span><span class="token punctuation">;</span>
    List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> colname <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        HashMap<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span> fieldtitlemap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fieldtitlemap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"columnname"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"columnname"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        colname<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fieldtitlemap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> colname<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>dao层</p> 
<pre><code class="prism language-java"><span class="token comment">//获取一张表的列名</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> <span class="token function">gettableColumns</span><span class="token punctuation">(</span>String tablename<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{<!-- --></span>
    String sql <span class="token operator">=</span> <span class="token string">"select COLUMN_NAME as columnname FROM information_schema.columns where table_name="</span><span class="token operator">+</span><span class="token string">"'"</span><span class="token operator">+</span>tablename<span class="token operator">+</span><span class="token string">"'"</span><span class="token punctuation">;</span>
    List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> list <span class="token operator">=</span> baseDao<span class="token punctuation">.</span><span class="token function">queryListJdbc</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行sql</span>
    <span class="token keyword">return</span> list<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="_210"></a>点击查询后渲染动态表格</h5> 
<p>使用layui数据表格和分页结合时：</p> 
<p>1.接受前台传输的page和limit数据(当前页、每页数据)</p> 
<p>2.sql查询时使用接受的page和limit进行分页查询</p> 
<p>3.将要查询表的行总数填入表格格式的count字段(可见Layui官网的数据表格部分的参数说明)</p> 
<pre><code class="prism language-javascript"> <span class="token comment">//查询渲染展示表格</span>
    <span class="token keyword">function</span> <span class="token function">xxx</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> tablename <span class="token operator">=</span> <span class="token function">gettablename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取下拉框中的表名</span>
        cols <span class="token operator">=</span> <span class="token function">col</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取格式部分的数据</span>
        $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            type<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
            dataType<span class="token punctuation">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
            <span class="token keyword">async</span><span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">//注意是同步</span>
            <span class="token comment">//page和limit应该是默认传输的，可能我的写法有问题，直接获取获取不到，所以我自定义了</span>
            url<span class="token punctuation">:</span> <span class="token string">'/tabledata/selectdata.do?tablename='</span><span class="token operator">+</span>tablename<span class="token operator">+</span><span class="token string">"&amp;page="</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span><span class="token string">"&amp;limit="</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">,</span>
            success<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> temp <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
                 <span class="token string">"code"</span><span class="token punctuation">:</span>data<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">//0</span>
                 <span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">""</span><span class="token punctuation">,</span>           <span class="token comment">//随便写</span>
                 <span class="token string">"count"</span><span class="token punctuation">:</span>data<span class="token punctuation">[</span><span class="token string">'count'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">//表格中数据的总数count(1)</span>
                 <span class="token string">"data"</span><span class="token punctuation">:</span>data<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token comment">//表格数据利用sql进行分页查询</span>
             <span class="token punctuation">}</span><span class="token punctuation">;</span>
                layui<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'table'</span><span class="token punctuation">,</span><span class="token string">'layer'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> table <span class="token operator">=</span> layui<span class="token punctuation">.</span>table<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> tableinfo <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                        elem<span class="token punctuation">:</span> <span class="token string">'#tableinfo'</span><span class="token punctuation">,</span>
                        id<span class="token punctuation">:</span> <span class="token string">'test'</span><span class="token punctuation">,</span>
                        url<span class="token punctuation">:</span> <span class="token string">'/tabledata/selectdata.do?tablename='</span><span class="token operator">+</span>tablename<span class="token punctuation">,</span>
                        limit<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
                        parseData<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//重新整理数据格式</span>
                            <span class="token keyword">return</span><span class="token punctuation">{<!-- --></span>
                                <span class="token string">"code"</span><span class="token punctuation">:</span> temp<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token string">"msg"</span><span class="token punctuation">:</span> temp<span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token string">"count"</span><span class="token punctuation">:</span>temp<span class="token punctuation">[</span><span class="token string">'count'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token string">"data"</span><span class="token punctuation">:</span>temp<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token comment">//让表格单元格的宽度自适应</span>
                        done<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>res<span class="token punctuation">,</span> curr<span class="token punctuation">,</span> count<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"table"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">"width"</span><span class="token punctuation">,</span> <span class="token string">"100%"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        data<span class="token punctuation">:</span> temp<span class="token punctuation">,</span>
                        cols<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                            cols<span class="token comment">//是一个全局变量var cols= col()</span>
                        <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token comment">//开启分页</span>
                        page<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h6><a id="_270"></a>后台代码</h6> 
<pre><code class="prism language-java"><span class="token comment">//查询表格数据和具体信息</span>
<span class="token annotation punctuation">@Action</span><span class="token punctuation">(</span><span class="token string">"selectdata"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{<!-- --></span>
    String tablename <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"tablename"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    String page <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"page"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    String limit <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"limit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Map<span class="token generics function"><span class="token punctuation">&lt;</span>Object<span class="token punctuation">,</span> Object<span class="token punctuation">&gt;</span></span> resultmap <span class="token operator">=</span> tableservice<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span>tablename<span class="token punctuation">,</span>page<span class="token punctuation">,</span>limit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">printJson</span><span class="token punctuation">(</span>JsonUtil<span class="token punctuation">.</span><span class="token function">ObjectToJson</span><span class="token punctuation">(</span>resultmap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>Service层</p> 
<pre><code class="prism language-java"><span class="token comment">//页面渲染表格时需要的数据</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>Object<span class="token punctuation">,</span> Object<span class="token punctuation">&gt;</span></span> <span class="token function">selectAll</span><span class="token punctuation">(</span>String tablename<span class="token punctuation">,</span>String page<span class="token punctuation">,</span>String limit<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{<!-- --></span>
    Map<span class="token generics function"><span class="token punctuation">&lt;</span>Object<span class="token punctuation">,</span> Object<span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> list1 <span class="token operator">=</span> tabledao<span class="token punctuation">.</span><span class="token function">gettableRow</span><span class="token punctuation">(</span>tablename<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//表的行数</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"count"</span><span class="token punctuation">,</span> list1<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"row"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    List list <span class="token operator">=</span> tabledao<span class="token punctuation">.</span><span class="token function">selectAllinfo</span><span class="token punctuation">(</span>tablename<span class="token punctuation">,</span>page<span class="token punctuation">,</span>limit<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//表的所有数据</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    List list2 <span class="token operator">=</span> tabledao<span class="token punctuation">.</span><span class="token function">gettableColumns</span><span class="token punctuation">(</span>tablename<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//表的列名集合</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"column"</span><span class="token punctuation">,</span> list2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    List list3 <span class="token operator">=</span> tabledao<span class="token punctuation">.</span><span class="token function">gettableColumnsnum</span><span class="token punctuation">(</span>tablename<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//表的列数</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"columnnum"</span><span class="token punctuation">,</span> list3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> map<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>获取表的行数</p> 
<pre><code class="prism language-java"><span class="token comment">//获取一张表的行数</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> List <span class="token function">gettableRow</span><span class="token punctuation">(</span>String tablename<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{<!-- --></span>
    String sql <span class="token operator">=</span> <span class="token string">"select count(1) as row from "</span><span class="token operator">+</span> tablename<span class="token punctuation">;</span>
    List list <span class="token operator">=</span> baseDao<span class="token punctuation">.</span><span class="token function">queryListJdbc</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> list<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>获取表的所有数据(sql进行分页查询，page为当前页，limit为每页的显示数量)</p> 
<pre><code class="prism language-java"> <span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> <span class="token function">selectAllinfo</span><span class="token punctuation">(</span>String tablename<span class="token punctuation">,</span>String page<span class="token punctuation">,</span>String limit<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{<!-- --></span>
    String sql <span class="token operator">=</span> <span class="token string">"select * from "</span><span class="token operator">+</span>tablename <span class="token operator">+</span> <span class="token string">" limit "</span><span class="token operator">+</span> <span class="token punctuation">(</span>Integer<span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span> <span class="token operator">-</span>                         <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>Integer<span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>limit<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">","</span> <span class="token operator">+</span> limit<span class="token punctuation">;</span>
    List list <span class="token operator">=</span> baseDao<span class="token punctuation">.</span><span class="token function">queryListJdbc</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> list<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>获取一张表的所有列名</p> 
<pre><code class="prism language-java"><span class="token comment">//获取一张表的列名</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> <span class="token function">gettableColumns</span><span class="token punctuation">(</span>String tablename<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{<!-- --></span>
    String sql <span class="token operator">=</span> <span class="token string">"select COLUMN_NAME as columnname FROM information_schema.columns where                   table_name="</span><span class="token operator">+</span><span class="token string">"'"</span><span class="token operator">+</span>tablename<span class="token operator">+</span><span class="token string">"'"</span><span class="token punctuation">;</span>
    List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> list <span class="token operator">=</span> baseDao<span class="token punctuation">.</span><span class="token function">queryListJdbc</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> list<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>获取一张表的列数</p> 
<pre><code class="prism language-java"><span class="token comment">//获取一张表的列数</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> <span class="token function">gettableColumnsnum</span><span class="token punctuation">(</span>String tablename<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{<!-- --></span>
    String sql <span class="token operator">=</span><span class="token string">"select count(COLUMN_NAME) as columnname FROM information_schema.columns                  where table_name="</span><span class="token operator">+</span><span class="token string">"'"</span><span class="token operator">+</span>tablename<span class="token operator">+</span><span class="token string">"'"</span><span class="token punctuation">;</span>
    List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> list <span class="token operator">=</span> baseDao<span class="token punctuation">.</span><span class="token function">queryListJdbc</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> list<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="word_352"></a>导出为word</h5> 
<pre><code class="prism language-javascript"> <span class="token keyword">function</span> <span class="token function">word</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> tablename <span class="token operator">=</span> <span class="token function">gettablename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取下拉框中的表名</span>
        res <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> rownum <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> columnname <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> columnnum <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
        $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            type<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
            url<span class="token punctuation">:</span> <span class="token string">'/tabledata/selectdata.do?tablename='</span><span class="token operator">+</span>tablename<span class="token punctuation">,</span>
            <span class="token keyword">async</span><span class="token punctuation">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
            success<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                res<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//表格数据内容</span>
                rownum<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'count'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//表格行数</span>
                columnname<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'column'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//表格的列名集合</span>
                columnnum<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'columnnum'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'columnname'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//列名数量</span>
                <span class="token keyword">debugger</span><span class="token punctuation">;</span>
                $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    type<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
                    url<span class="token punctuation">:</span> <span class="token string">'/word/toword.do'</span><span class="token punctuation">,</span>
                    <span class="token keyword">async</span><span class="token punctuation">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
                    data<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token string">"row"</span><span class="token punctuation">:</span> rownum<span class="token punctuation">,</span><span class="token comment">//行数</span>
                        <span class="token string">"column"</span><span class="token punctuation">:</span> columnnum<span class="token punctuation">,</span><span class="token comment">//列数</span>
                        <span class="token string">"tablename"</span><span class="token punctuation">:</span>tablename<span class="token punctuation">,</span><span class="token comment">//表名</span>
                        <span class="token string">"res"</span><span class="token punctuation">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//表格数据</span>
                        <span class="token string">"columnname"</span><span class="token punctuation">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>columnname<span class="token punctuation">)</span><span class="token comment">//列名集合</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    success<span class="token punctuation">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        layui<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'layer'</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//是否成功的窗口提示</span>
                            <span class="token keyword">var</span> layer <span class="token operator">=</span> layui<span class="token punctuation">.</span>layer<span class="token punctuation">;</span>
                            layer<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                                title<span class="token punctuation">:</span> <span class="token string">'数据导出'</span><span class="token punctuation">,</span>
                                content<span class="token punctuation">:</span> data<span class="token punctuation">,</span>
                            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h6><a id="_397"></a>后台代码</h6> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Action</span><span class="token punctuation">(</span><span class="token string">"toword"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">tabletoword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{<!-- --></span>
    String row <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"row"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//行数</span>
    String column <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"column"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//列数</span>
    String tablename <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"tablename"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//表名</span>
    String columnname <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"columnname"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//列名</span>

    Type type <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TypeToken</span><span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    String table <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Gson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>tablename<span class="token punctuation">,</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>

    Type type1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TypeToken</span><span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> columnnames <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Gson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>columnname<span class="token punctuation">,</span>type1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> datainfo <span class="token operator">=</span> serviceddata<span class="token punctuation">.</span><span class="token function">selectAllinfo</span><span class="token punctuation">(</span>tablename<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//表信息</span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        tabletoword<span class="token punctuation">.</span><span class="token function">writeword</span><span class="token punctuation">(</span>Integer<span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">,</span> Integer<span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span>datainfo<span class="token punctuation">,</span>columnnames<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">printJson</span><span class="token punctuation">(</span>JsonUtil<span class="token punctuation">.</span><span class="token function">ObjectToJson</span><span class="token punctuation">(</span><span class="token string">"导出成功"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">printJson</span><span class="token punctuation">(</span>JsonUtil<span class="token punctuation">.</span><span class="token function">ObjectToJson</span><span class="token punctuation">(</span><span class="token string">"导出失败"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>Service层</p> 
<pre><code class="prism language-java"><span class="token comment">//导出时的数据</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> <span class="token function">selectAllinfo</span><span class="token punctuation">(</span>String tablename<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{<!-- --></span>
    List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> list <span class="token operator">=</span> tabledao<span class="token punctuation">.</span><span class="token function">wordAllinfo</span><span class="token punctuation">(</span>tablename<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> list<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>Dao直接获取所有数据</p> 
<pre><code class="prism language-java"><span class="token comment">//获取一张表的所有数据(导出表格使用)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> List <span class="token function">wordAllinfo</span><span class="token punctuation">(</span>String tablename<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{<!-- --></span>
    String sql <span class="token operator">=</span> <span class="token string">"select * from "</span><span class="token operator">+</span>tablename<span class="token punctuation">;</span>
    List list <span class="token operator">=</span> baseDao<span class="token punctuation">.</span><span class="token function">queryListJdbc</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> list<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>利用POI绘制表格并导出到word文档</p> 
<pre><code class="prism language-java"><span class="token comment">/*
    * row：表格行数
    * column：表格列数
    * tablename：表名
    * data:表格所有数据
    * columnnames：表格列名集合
    *
    * */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">writeword</span><span class="token punctuation">(</span><span class="token keyword">int</span> row<span class="token punctuation">,</span> <span class="token keyword">int</span> column<span class="token punctuation">,</span> String tablename<span class="token punctuation">,</span> List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> data<span class="token punctuation">,</span>List<span class="token operator">&lt;</span>Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> columnnames<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{<!-- --></span>
    String docname <span class="token operator">=</span> tablename<span class="token operator">+</span><span class="token string">".docx"</span><span class="token punctuation">;</span>
    <span class="token comment">//新建一个文档</span>
    XWPFDocument doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XWPFDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    FileOutputStream OutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"文件路径"</span><span class="token operator">+</span>docname<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//创建一个表格</span>
    XWPFTable table <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span>row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>column<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//获取表格的第一行</span>
    XWPFTableRow row1 <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> row<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//按行遍历</span>
        <span class="token comment">//填充首行列名</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> column<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//按列遍历(表头)</span>
                row1<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>columnnames<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"columnname"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            XWPFTableRow row2 <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> m <span class="token operator">&lt;</span>column <span class="token punctuation">;</span> m<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//按列遍历(数据)</span>
                row2<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>columnnames<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"columnname"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    doc<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>OutputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
    OutputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2034ab6f931c721409a3846915d41dd9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue&#43;element-UI表格（Table）组件中鼠标（hover）悬停、悬浮时样式的修改</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bbeb3205796eeb9236757fb1ac52168a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">实战简历编写，打造硬核敲门砖</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>