<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【深度学习】将文本数据转换为张量的方法总结 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【深度学习】将文本数据转换为张量的方法总结" />
<meta property="og:description" content="目录
问题描述：
方法概括：
1.单词级的one-hot编码
2.字符级的one-hot编码
3.用keras实现单词级的one-hot编码
4.用散列技巧的单词级的one-hot1编码
参考：
问题描述： 深度学习模型不会接收原始文本作为输入，它只能处理数值张量。 文本向量化（vectorize）是指将文本转换为数值张量的过程。实现方法：①文本中的每个单词转换为一个向量.②文本中的每个字符转换为一个向量。
方法概括： 1.单词级的one-hot编码 代码展示
import numpy as np samples = [&#39;The cat sat on the mat.&#39;, &#39;The dog ate my homework.&#39;] #构建数据中被标记的索引 token_index = {} for sample in samples: #利用split方法进行分词 for word in sample.split(): if word not in token_index: # 为唯一单词指定唯一索引 token_index[word] = len(token_index) &#43; 1 max_length = 10 #结果保存在result中 results = np.zeros((len(samples), max_length, max(token_index.values()) &#43; 1)) for i, sample in enumerate(samples): for j, word in list(enumerate(sample." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/d5937fef2db04115adb641fff8ddf6ee/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-12T15:26:50+08:00" />
<meta property="article:modified_time" content="2022-02-12T15:26:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【深度学习】将文本数据转换为张量的方法总结</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0%EF%BC%9A-toc" style="margin-left:0px;"><a href="#%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0%EF%BC%9A" rel="nofollow">问题描述：</a></p> 
<p id="%E6%96%B9%E6%B3%95%E6%A6%82%E6%8B%AC%EF%BC%9A-toc" style="margin-left:0px;"><a href="#%E6%96%B9%E6%B3%95%E6%A6%82%E6%8B%AC%EF%BC%9A" rel="nofollow">方法概括：</a></p> 
<p id="1.%E5%8D%95%E8%AF%8D%E7%BA%A7%E7%9A%84one-hot%E7%BC%96%E7%A0%81-toc" style="margin-left:40px;"><a href="#1.%E5%8D%95%E8%AF%8D%E7%BA%A7%E7%9A%84one-hot%E7%BC%96%E7%A0%81" rel="nofollow">1.单词级的one-hot编码</a></p> 
<p id="2.%E5%AD%97%E7%AC%A6%E7%BA%A7%E7%9A%84one-hot%E7%BC%96%E7%A0%81-toc" style="margin-left:40px;"><a href="#2.%E5%AD%97%E7%AC%A6%E7%BA%A7%E7%9A%84one-hot%E7%BC%96%E7%A0%81" rel="nofollow">2.字符级的one-hot编码</a></p> 
<p id="3.%E7%94%A8keras%E5%AE%9E%E7%8E%B0%E5%8D%95%E8%AF%8D%E7%BA%A7%E7%9A%84one-hot%E7%BC%96%E7%A0%81-toc" style="margin-left:40px;"><a href="#3.%E7%94%A8keras%E5%AE%9E%E7%8E%B0%E5%8D%95%E8%AF%8D%E7%BA%A7%E7%9A%84one-hot%E7%BC%96%E7%A0%81" rel="nofollow">3.用keras实现单词级的one-hot编码</a></p> 
<p id="4.%E7%94%A8%E6%95%A3%E5%88%97%E6%8A%80%E5%B7%A7%E7%9A%84%E5%8D%95%E8%AF%8D%E7%BA%A7%E7%9A%84one-hot1%E7%BC%96%E7%A0%81-toc" style="margin-left:40px;"><a href="#4.%E7%94%A8%E6%95%A3%E5%88%97%E6%8A%80%E5%B7%A7%E7%9A%84%E5%8D%95%E8%AF%8D%E7%BA%A7%E7%9A%84one-hot1%E7%BC%96%E7%A0%81" rel="nofollow">4.用散列技巧的单词级的one-hot1编码</a></p> 
<p id="%E5%8F%82%E8%80%83%EF%BC%9A-toc" style="margin-left:0px;"><a href="#%E5%8F%82%E8%80%83%EF%BC%9A" rel="nofollow">参考：</a></p> 
<hr id="hr-toc"> 
<h2>问题描述：</h2> 
<p>        深度学习模型不会接收原始文本作为输入，它只能处理数值张量。 文本<strong>向量化</strong>（vectorize）是指将文本转换为数值张量的过程。实现方法：①文本中的每个单词转换为一个向量.②文本中的每个字符转换为一个向量。</p> 
<h2 id="%E6%96%B9%E6%B3%95%E6%A6%82%E6%8B%AC%EF%BC%9A">方法概括：</h2> 
<h3 id="1.%E5%8D%95%E8%AF%8D%E7%BA%A7%E7%9A%84one-hot%E7%BC%96%E7%A0%81">1.单词级的one-hot编码</h3> 
<p>代码展示</p> 
<pre><code class="language-python">import numpy as np

samples = ['The cat sat on the mat.', 'The dog ate my homework.']

#构建数据中被标记的索引
token_index = {}
for sample in samples:
    #利用split方法进行分词
    for word in sample.split():
        if word not in token_index:
            # 为唯一单词指定唯一索引
            token_index[word] = len(token_index) + 1


max_length = 10

#结果保存在result中
results = np.zeros((len(samples), max_length, max(token_index.values()) + 1))
for i, sample in enumerate(samples):
    for j, word in list(enumerate(sample.split()))[:max_length]:
        index = token_index.get(word)
        results[i, j, index] = 1.

print(results)</code></pre> 
<p>实现截图</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/f3/6b/annWDvgK_o.png"></p> 
<p> </p> 
<h3 id="2.%E5%AD%97%E7%AC%A6%E7%BA%A7%E7%9A%84one-hot%E7%BC%96%E7%A0%81">2.字符级的one-hot编码</h3> 
<p>代码展示</p> 
<pre><code class="language-python">import string

samples = ['The cat sat on the mat.', 'The dog ate my homework.']
#所有可以打印的ASCII字符
characters = string.printable
token_index = dict(zip(range(1,len(characters) +1),characters))

max_length = 50
results = np.zeros((len(samples),max_length,max(token_index.keys()) + 1))
for i ,sample in enumerate(samples):
    for j,character in enumerate(sample[:max_length]):
        index = token_index.get(character)
        results[i,j,index] =1.
print(results)</code></pre> 
<p>实现截图</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/88/5b/AC1zyAeU_o.png"></p> 
<p> </p> 
<h3 id="3.%E7%94%A8keras%E5%AE%9E%E7%8E%B0%E5%8D%95%E8%AF%8D%E7%BA%A7%E7%9A%84one-hot%E7%BC%96%E7%A0%81">3.用keras实现单词级的one-hot编码</h3> 
<p>代码展示</p> 
<pre><code class="language-python">from keras.preprocessing.text import Tokenizer

samples = ['The cat sat on the mat.', 'The dog ate my homework.']
#创建分词器，设置只考虑前1000最常见单词
tokenizer = Tokenizer(num_words=1000)
#构建单词索引
tokenizer.fit_on_texts(samples)

#将字符串转换为由，整数索引组成的列表
sequences = tokenizer.texts_to_sequences(samples)

one_hot_results = tokenizer.texts_to_matrix(samples,mode='binary')
word_index = tokenizer.word_index
print('found %s unique tokens'%len(word_index))</code></pre> 
<p>实现截图</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/5f/03/qeLZM5cE_o.png"></p> 
<p> </p> 
<h3 id="4.%E7%94%A8%E6%95%A3%E5%88%97%E6%8A%80%E5%B7%A7%E7%9A%84%E5%8D%95%E8%AF%8D%E7%BA%A7%E7%9A%84one-hot1%E7%BC%96%E7%A0%81">4.用散列技巧的单词级的one-hot1编码</h3> 
<p>代码展示</p> 
<pre><code class="language-python">samples = ['The cat sat on the mat.', 'The dog ate my homework.']

#将单词保存长度为1000的向量
dimensionality = 1000
max_length= 10

results = np.zeros((len(samples),max_length,dimensionality))
for i ,sample in enumerate(samples):
    for j, word in list(enumerate(sample.split()))[:max_length]:
    #for j,word in list(enumerate(samples.split()))[:max_length]:
        index = abs(hash(word)) % dimensionality
        results [i,j,index] =1.
print(results)</code></pre> 
<p>实现截图</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ff/4c/iJ4QjLiP_o.png"></p> 
<p> </p> 
<h2 id="%E5%8F%82%E8%80%83%EF%BC%9A">参考：</h2> 
<p>《Python深度学习》</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dd160aec5f3a8a8a695c69f602b7ee7f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Type-C保温杯取电方案</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/53782399da8a615a4aaed2bccb104599/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Web前端——CSS布局</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>