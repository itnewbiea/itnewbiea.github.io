<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>asp 接受post文件_Asp 代码审计项目实战 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="asp 接受post文件_Asp 代码审计项目实战" />
<meta property="og:description" content="任务背景：
需要得知周某某的今年采购的其中一个项目具体信息，目前已知该成员是xxx电网。负责丰满大坝的采购人员。
整体思路如下：
找到开发公司，得到源码，审计问题，得到shell，拿到服务器，得到域控(或者终端管理)。得到个人机。下载任务文件。
得知该电网公司电网相关网站是某公司出品，得到某公司对外宣传网站，并且得到该公司服务器权限，下载源码模板。
源码审计：
全局共计2个主要文件，分别是Funcon.asp，Startup.asp
后台验证项：
Function.asp
来源验证
注入验证：(目标服务器waf，遂放弃)
错误处理
XSS字符处理：
错误处理
直接输入admin/下文件名处理
目录生成：针对iis6以及iis7 php版本
Startup.asp配置文件：当不可以执行的时候，是否可以备份出数据库，以便下载。
关于新闻显示，全局incude head.asp
其中check_si.asp 主要为防止注入
Get注入
Post 注入 新版本中加入post注入过程中遇到服务器卡顿现象，也就是不清楚列名数，本地二分法测试如下：
在admin 目录下有个database.asp文件
目标测试：根据以上信息，构造referrer，构造参数，禁止js。产生出越权漏洞。
根据越权漏洞，继续看upload.asp文件，允许匿名上传图片文件。在根据越权漏洞备份出webshell文件
82：
得到webshell
对方没有开启远程桌面：
开启：
REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&#34; &#34;Server /v fDenyTSConnections /t REG_DWORD/d 00000000 /f
通过该服务器得到mssql 数据库。得到终端管理权限。
查看在线机器，查找目标人物。
推送payload 反弹。
确定是否为目标人物：采购员桌面截图
按照任务取得该人员的其中一个xls文件
任务完成。
任务完成。
文章来源：https://micropoor.blogspot.com/
你可能喜欢
满满的干货，代码审计资料整理免费分享！
代码审计入门总结
代码审计报告" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/dec3cec12ae13c39cb201c492dad1d96/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-29T12:10:28+08:00" />
<meta property="article:modified_time" content="2020-12-29T12:10:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">asp 接受post文件_Asp 代码审计项目实战</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="._5ce-wx-style" style="font-size:16px;"> 
 <div class="rich_media_content" id="js_content"> 
  <p><img src="https://images2.imgbox.com/6c/88/qAjZxkG7_o.gif" alt="e1c45667c622b651acf88204c5423cd7.gif"></p> 
  <p><strong>任务背景：</strong></p> 
  <p>需要得知周某某的今年采购的其中一个项目具体信息，目前已知该成员是xxx电网。负责丰满大坝的采购人员。</p> 
  <p><strong>整体思路如下：</strong></p> 
  <p>找到开发公司，得到源码，审计问题，得到shell，拿到服务器，得到域控(或者终端管理)。得到个人机。下载任务文件。</p> 
  <p>得知该电网公司电网相关网站是某公司出品，得到某公司对外宣传网站，并且得到该公司服务器权限，下载源码模板。</p> 
  <p><strong>源码审计：</strong></p> 
  <p>全局共计2个主要文件，分别是Funcon.asp，Startup.asp</p> 
  <p><strong>后台验证项：</strong></p> 
  <p>Function.asp</p> 
  <p>来源验证</p> 
  <p><img src="https://images2.imgbox.com/b7/38/xTPed7er_o.png" alt="b492560ad63b34769f602ee0a75d2155.png"></p> 
  <p>注入验证：(目标服务器waf，遂放弃)</p> 
  <p><img src="https://images2.imgbox.com/04/a4/GaxO5Fxn_o.png" alt="57d4293a792669ec699219218de4b13e.png"></p> 
  <p>错误处理</p> 
  <p><img src="https://images2.imgbox.com/44/00/i8nLb50n_o.png" alt="a710ca31d365cc64acdee30ad989c796.png"></p> 
  <p>XSS字符处理：</p> 
  <p>错误处理</p> 
  <p><img src="https://images2.imgbox.com/8f/ee/uEBtpizM_o.png" alt="4260db0baad84c1597a7310794f2e439.png"></p> 
  <p>直接输入admin/下文件名处理</p> 
  <p><img src="https://images2.imgbox.com/5e/0c/vFkBeTgq_o.png" alt="73db35bc9d064aa552954d99168a3bae.png"></p> 
  <p>目录生成：针对iis6以及iis7 php版本</p> 
  <p><img src="https://images2.imgbox.com/61/8a/iIPIZh8H_o.png" alt="3a1f4aa1cf50c6c86106e1fef5a9fec3.png"></p> 
  <p>Startup.asp配置文件：当不可以执行的时候，是否可以备份出数据库，以便下载。</p> 
  <p><img src="https://images2.imgbox.com/c0/db/p1lXcSZs_o.png" alt="2d7cc375d420badac204d70dd596119a.png"></p> 
  <p>关于新闻显示，全局incude head.asp</p> 
  <p><img src="https://images2.imgbox.com/97/21/DsR8gPsR_o.png" alt="16d66ccfba9df67b08b7bdf60b0897ac.png"></p> 
  <p>其中check_si.asp 主要为防止注入</p> 
  <p>Get注入</p> 
  <p><img src="https://images2.imgbox.com/99/d5/LE61EEpe_o.png" alt="dc50d9f8f29e6ddc1e1d2c93ec26ded3.png"></p> 
  <p>Post 注入  新版本中加入post注入过程中遇到服务器卡顿现象，也就是不清楚列名数，本地二分法测试如下：</p> 
  <p><img src="https://images2.imgbox.com/01/88/KU69rxuS_o.png" alt="35d1888fab7e44c7b243a3d1dd591887.png"></p> 
  <p><img src="https://images2.imgbox.com/18/67/JD7FaWRo_o.png" alt="05c7f2f60d795fbe24157369a03d9aa5.png"></p> 
  <p><img src="https://images2.imgbox.com/7a/f2/ULtr6gvU_o.png" alt="f7702940e49c9209907d369b6f6c2b78.png"></p> 
  <p><img src="https://images2.imgbox.com/c8/cc/jlembv7o_o.png" alt="03495f1234329113f2439203b9afd5cf.png"></p> 
  <p>在admin 目录下有个database.asp文件</p> 
  <p><img src="https://images2.imgbox.com/ba/32/Nf6baUab_o.png" alt="741dd612201db3772dcc39c0275b07d8.png"></p> 
  <p>目标测试：根据以上信息，构造referrer，构造参数，禁止js。产生出越权漏洞。</p> 
  <p><img src="https://images2.imgbox.com/88/d4/FS3IXuGX_o.png" alt="b526e58112d4731abe478e5f02d9e10e.png"></p> 
  <p><img src="https://images2.imgbox.com/62/aa/cpsI2ABJ_o.png" alt="c8347dd4397e33c29bc38d1f28b3cc05.png"></p> 
  <p>根据越权漏洞，继续看upload.asp文件，允许匿名上传图片文件。在根据越权漏洞备份出webshell文件</p> 
  <p><img src="https://images2.imgbox.com/7c/5c/eHeDvJkS_o.png" alt="50e88cca647b2db2e7974731b97a1d5e.png"></p> 
  <p><img src="https://images2.imgbox.com/25/75/S5ruT0OZ_o.png" alt="210feb95513a61000ee152d2cd2fa6eb.png"></p> 
  <p>82：</p> 
  <p><img src="https://images2.imgbox.com/c1/6c/t67IXtcf_o.png" alt="e380298211943a6ae6a003c3939a1163.png"></p> 
  <p><img src="https://images2.imgbox.com/43/df/W0nv5UEe_o.png" alt="9ca0cbb6bf262dd91dad949140a8a962.png"></p> 
  <p>得到webshell</p> 
  <p><img src="https://images2.imgbox.com/f7/2c/EoiniZds_o.png" alt="3b065503fa7223eff293eadddea98037.png"></p> 
  <p>对方没有开启远程桌面：</p> 
  <p>开启：</p> 
  <p>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /t REG_DWORD/d 00000000 /f</p> 
  <p>通过该服务器得到mssql 数据库。得到终端管理权限。</p> 
  <p><img src="https://images2.imgbox.com/c3/d5/cE9bMGQR_o.png" alt="5189f7603973f215a32a9a2222dc820e.png"></p> 
  <p><img src="https://images2.imgbox.com/6c/d0/OsaIZzEv_o.png" alt="7035ab8dd9c77ad6f9f2c0ced92b0354.png"></p> 
  <p>查看在线机器，查找目标人物。</p> 
  <p><img src="https://images2.imgbox.com/06/1e/WVVfz8LW_o.png" alt="6f2f7f20b0816d1967fec11d26e6b576.png"></p> 
  <p><img src="https://images2.imgbox.com/9b/ca/fDiyHYp3_o.png" alt="cf44427a47663cf5ce7a77f64c34bc39.png"></p> 
  <p>推送payload 反弹。</p> 
  <p><img src="https://images2.imgbox.com/43/91/T7hFeXhC_o.png" alt="ef23e802522c2aceea5b3e9bd351c9f0.png"></p> 
  <p><img src="https://images2.imgbox.com/e9/92/1vdRxkY1_o.png" alt="eccde0fb287fc68d5f327359a3f3f1d9.png"></p> 
  <p>确定是否为目标人物：采购员桌面截图</p> 
  <p><img src="https://images2.imgbox.com/1e/c0/ZCOEYN3T_o.png" alt="8bb608a4e89d52f4c7f6b50e9d8ed1b1.png"></p> 
  <p><img src="https://images2.imgbox.com/0f/e0/2oC6SqMU_o.png" alt="6c8b7b0933b9392e0dc107921d326fff.png"></p> 
  <p><img src="https://images2.imgbox.com/2f/cf/VmWsOwXj_o.png" alt="027d9c11f7a05c77f63ef85447546d0b.png"></p> 
  <p>按照任务取得该人员的其中一个xls文件</p> 
  <p><img src="https://images2.imgbox.com/e9/d5/yTGlR7Vn_o.png" alt="7a5bc91159c1310f14e14d286c58ed80.png"></p> 
  <p>任务完成。</p> 
  <p>任务完成。</p> 
  <p><img src="https://images2.imgbox.com/21/95/f4IcwdAz_o.png" alt="abb499182ab2f590915036bf75fc2f4d.png"></p> 
  <p>文章来源：https://micropoor.blogspot.com/</p> 
  <p><strong><img src="https://images2.imgbox.com/a2/7c/QjsHF5lF_o.png" alt="349dc6b6871c7546e69300c85d9e0845.png"></strong></p> 
   
  <p>你可能喜欢</p> 
  <p>满满的干货，代码审计资料整理免费分享！</p> 
  <p>代码审计入门总结</p> 
  <p>代码审计报告</p> 
  <p><img src="https://images2.imgbox.com/9b/36/fgoBVoak_o.png" alt="6d15d5425359b169ae209837e7ca6a12.png"></p> 
 </div> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/43bfaf3d9f42182696bea212d63d3ac9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">鸿合一体机触屏没反应怎么办_一体机屏幕触摸不准的原因以及解决方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ef9f33fcc0218533c443ca41a9e1b32e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">php连接oracle很慢是什么原因_帮你梳理—LAMP架构是什么？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>