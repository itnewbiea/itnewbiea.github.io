<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>网络技术之链路聚合 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="网络技术之链路聚合" />
<meta property="og:description" content="什么是链路聚合？
链路聚合即是将多条链路捆绑在一起，形成一条聚合链路，此聚合链路的带宽理论上是所有活动链路的带宽之和，同时避免单条链路中以后，网络故障。
链路聚合的作用？
增加带宽，提高可靠性
链路聚合包含两种模式？
手动负载均衡模式与LACP模式。
手动负载均衡模式：Eth-trunk的建立，成员接口的加入由管理人员手工加入，没有链路聚合控制协议的参与。这种模式下所有的链路都参与数据的转发，平均分摊流量，因此称为负载均衡模式。如果某一条活动链路故障，自动在剩余的所有活动链路中均分流量，当需要在两个直连的设备之间提供较大的传输带宽，而设备又不支持LACP协议时，可以使用手动负载分担模式。
LACP模式：LACP两端的设备相互发送LACP报文，协商聚合参数，两台设备确定活动接口与非活动接口。在LACP模式当中，需要手动创建一个Eth-trunk，并添加成员接口，LACP协商选举活动接口与非活动接口。LACP模式也成为M:N模式，M代表活动成员链路，用于数据转发；N代表冗余链路，用于数据备份；如果一条活动链路发生故障，该链路的数据自动被切换到一条优先级高的备份链路上，此时备份链路转为活动链路状态。
手工负载分担模式与LACP模式的区别在于：手工负载分担模式中，所有的链路都参与数据转发，而LACP模式中，某些链路处于备份状态
链路聚合的注意事项：
在一个聚合口中，聚合链路两端的成员端口参数必须一致，接口数量、传输速率、双工模式、流量控制模式。成员接口可以是二层接口或者三层接口。
使用二层端口配置手工负载均摊模式（每个厂家命令不一样，这里以华为模拟器做实验）
手工负载均衡模式配置：两台交换机配置一样
[Huawei]interface Eth-Trunk 1 #配置链路聚合
[Huawei-Eth-Trunk1]trunkport Ethernet 0/0/1 to 0/0/3 #配置聚合链路成员端口
[Huawei-Eth-Trunk1]port link-type trunk #配置链路聚合的类型为中继链路
[Huawei-Eth-Trunk1]port trunk allow-pass vlan all #允许所有vlan透传
此时down掉任何一个端口或者任何一条链路故障都不会引起故障。只有所有端口或者所有链路故障才会发生故障
LACP模式配置：两台交换机配置一样
[switch-a]interface Eth-Trunk 1 # 配置链路聚合
[switch-a-Eth-Trunk1]mode lacp # 配置链路聚合的模式为lacp
[switch-a-Eth-Trunk1]trunkport Ethernet 0/0/1 to 0/0/3 #配置成员端口
[switch-a-Eth-Trunk1]quit #退出
[switch-a]interface Eth-Trunk 1 #进入聚合链路接口视图
[switch-a-Eth-Trunk1]max active-linknumber 2 #设置最大活动链路为2
[Huawei-Eth-Trunk1]port link-type trunk #配置链路聚合的类型为中继链路
[Huawei-Eth-Trunk1]port trunk allow-pass vlan all #允许所有vlan透传" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/25377e1e236409c92261af7a14cc29f4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-05T15:30:04+08:00" />
<meta property="article:modified_time" content="2022-12-05T15:30:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">网络技术之链路聚合</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="text-align:center;"></h2> 
<p style="margin-left:.0001pt;text-align:justify;">什么是链路聚合？</p> 
<p style="margin-left:.0001pt;text-align:justify;">        链路聚合即是将多条链路捆绑在一起，形成一条聚合链路，此聚合链路的带宽理论上是所有活动链路的带宽之和，同时避免单条链路中以后，网络故障。</p> 
<p style="margin-left:.0001pt;text-align:justify;">链路聚合的作用？</p> 
<p style="margin-left:.0001pt;text-align:justify;">       增加带宽，提高可靠性</p> 
<p style="margin-left:.0001pt;text-align:justify;">链路聚合包含两种模式？</p> 
<p style="margin-left:.0001pt;text-align:justify;">       手动负载均衡模式与LACP模式。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="425" src="https://images2.imgbox.com/98/23/4mRJI9Vw_o.png" width="618"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;">手动负载均衡模式：Eth-trunk的建立，成员接口的加入由管理人员手工加入，没有链路聚合控制协议的参与。这种模式下所有的链路都参与数据的转发，平均分摊流量，因此称为负载均衡模式。如果某一条活动链路故障，自动在剩余的所有活动链路中均分流量，当需要在两个直连的设备之间提供较大的传输带宽，而设备又不支持LACP协议时，可以使用手动负载分担模式。</p> 
<p style="margin-left:.0001pt;text-align:justify;">LACP模式：LACP两端的设备相互发送LACP报文，协商聚合参数，两台设备确定活动接口与非活动接口。在LACP模式当中，需要手动创建一个Eth-trunk，并添加成员接口，LACP协商选举活动接口与非活动接口。LACP模式也成为M:N模式，M代表活动成员链路，用于数据转发；N代表冗余链路，用于数据备份；如果一条活动链路发生故障，该链路的数据自动被切换到一条优先级高的备份链路上，此时备份链路转为活动链路状态。</p> 
<p style="margin-left:.0001pt;text-align:justify;">手工负载分担模式与LACP模式的区别在于：手工负载分担模式中，所有的链路都参与数据转发，而LACP模式中，某些链路处于备份状态</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">链路聚合的注意事项：</p> 
<p style="margin-left:.0001pt;text-align:justify;">在一个聚合口中，聚合链路两端的成员端口参数必须一致，接口数量、传输速率、双工模式、流量控制模式。成员接口可以是二层接口或者三层接口。</p> 
<p style="margin-left:.0001pt;text-align:justify;">使用二层端口配置手工负载均摊模式（每个厂家命令不一样，这里以华为模拟器做实验）</p> 
<p><img alt="" height="215" src="https://images2.imgbox.com/8e/9a/KtkgD34q_o.png" width="495"></p> 
<p style="margin-left:.0001pt;text-align:justify;">手工负载均衡模式配置：两台交换机配置一样</p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[Huawei]interface  Eth-Trunk 1</span><span style="color:#000000;">   #配置链路聚合</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[Huawei-Eth-Trunk1]trunkport Ethernet 0/0/1 to 0/0/3</span><span style="color:#000000;">  #配置聚合链路成员端口</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[Huawei-Eth-Trunk1]port link-type  trunk</span><span style="color:#000000;">  #配置链路聚合的类型为中继链路</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[Huawei-Eth-Trunk1]port trunk allow-pass vlan  all</span><span style="color:#000000;">  #允许所有vlan透传</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="208" src="https://images2.imgbox.com/9d/6e/Xdc47IrU_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">此时down掉任何一个端口或者任何一条链路故障都不会引起故障。只有所有端口或者所有链路故障才会发生故障</p> 
<p><img alt="" height="210" src="https://images2.imgbox.com/6f/67/zntp6Y3L_o.png" width="590"></p> 
<p style="margin-left:.0001pt;text-align:justify;">LACP模式配置：两台交换机配置一样</p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[switch-a]interface Eth-Trunk 1</span><span style="color:#000000;">     # 配置链路聚合</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[switch-a-Eth-Trunk1]mode lacp</span> <span style="color:#000000;">     # 配置链路聚合的模式为lacp</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[switch-a-Eth-Trunk1]trunkport Ethernet 0/0/1 to 0/0/3</span><span style="color:#000000;">  #配置成员端口</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[switch-a-Eth-Trunk1]quit</span><span style="color:#000000;">      #退出</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[switch-a]interface  Eth-Trunk  1</span><span style="color:#000000;">  #进入聚合链路接口视图</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[switch-a-Eth-Trunk1]max active-linknumber  2</span><span style="color:#000000;"> #设置最大活动链路为2</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[Huawei-Eth-Trunk1]port link-type  trunk</span><span style="color:#000000;">  #配置链路聚合的类型为中继链路</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[Huawei-Eth-Trunk1]port trunk allow-pass vlan  all</span><span style="color:#000000;">  #允许所有vlan透传</span></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">此时查看聚合链路状态，1-2端口为selected，3端口为unselected，这是因为上面设置了活动最大链路数量为2 </span></p> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="327" src="https://images2.imgbox.com/aa/01/TIxdKFSt_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;">进入2端口并down掉，模拟链路故障，查看3端口此时状态为selected，实现了链路备份状态</p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[switch-a]interface  Ethernet 0/0/2</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">[switch-a-Ethernet0/0/2]shutdown </span></p> 
<p><img alt="" height="314" src="https://images2.imgbox.com/06/81/AdTga9Qn_o.png" width="693"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/76146df3e64183b4fff4843ef408fa1c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【第6章】pandas分块读取文件（nrows、chunksize）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7f585b27035787ceae7f4cfbd1c42312/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">鸢尾花数据种类预测、分析与处理、scikit-learn数据集使用、seaborn作图及数据集的划分</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>