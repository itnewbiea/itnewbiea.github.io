<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>weixin小程序和公众号抓包方法分享 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="weixin小程序和公众号抓包方法分享" />
<meta property="og:description" content="文章目录 前言一、工具准备及相关设置二、burp抓包演示三、扩展操作四、小结 前言 由于在工作中涉及了微信小程序的渗透测试，参考了一些文章，感觉代理的设置大都太麻烦，甚至还有人用模拟器或者手机登陆微信再抓内网IP的数据包，按照app渗透测试的思路来抓取本在电脑上就能直接运行的应用程序的数据包，实在是没必要。因此自己鼓捣了一种简单的抓包方法，直接用proxifier工具来抓指定进程的数据包，转发给burp就可以了。
一、工具准备及相关设置 我本人用的是proxifier汉化版，可以直接从百度去找，也可以点击下方链接下载：
https://pan.baidu.com/s/1Kf5IVDAgVmCgsXU9rRlJXw?pwd=fsuj
提取码：fsuj 工具下载好以后直接傻瓜式安装即可，然后双击运行，顺利的话会见到如下界面：
依次点击菜单栏中的配置文件-&gt;代理服务器-&gt;添加
填写内容如下，其中端口应与burp的监听端口一致：
这里协议注意选https，我们只要抓https协议相关的数据包（包含了http），而socks5包含了其他协议的内容，burp不能处理，因此这里不能选socks5。
接着在主界面点击配置文件-&gt;代理规则-&gt;添加，然后设置内容如下：
注：WeChatAppEx.exe和WechatBrowser.exe分别是微信小程序和公众号通用的进程。
之后将小程序前面的复选框打钩：
二、burp抓包演示 现在我分别找个公众号和小程序演示。例如最近比较火的羊了个羊小程序：
江南雨上公众号：
三、扩展操作 大型企业经常会规定禁止内外网互联，因此如果连了公司网线，再连自己的热点就属于典型的内外网互联，而如果连公司的wifi，则因为连接人数太多往往很卡。幸好我所在的公司提供了内网代理服务器，连接上以后就可以上网了。下面分享通过proxifier工具开启全局代理的方法：
按照如下图所示进行设置：
这里的IP应为内网中代理服务器的地址和端口，这里我们公司提供的是192.168.25.25:6666，你们可根据自己实际情况修改。注意添加用户名和密码，因为内网代理服务器一般需要验证用户身份。当然不添加的话，也可以，只是后面肯会有弹窗要求填写账户密码进行身份验证。
然后在代理规则中设置如下：
这样就可以把全局所有未额外设置代理的进程流量全部导入代理服务器了。可能有人会问，这个时候假设打开了谷歌浏览器，访问了一个站点，想要用burp抓它的数据包，该怎么办呢？这个时候要注意，不要在浏览器里设置代理，直接在proxifier工具的代理规则添加一条规则如下：
检查该规则是否已启用：
这样的话，小程序、公众号和谷歌浏览器的流量就会被导入到本地的127.0.0.1的8080端口，就可以使用burp去拦截数据包，而burp的出口走的是代理服务器的ip和端口，因此并不影响它们访问外网，这样就实现了在内网环境下设置全局代理和burp拦截数据包两不误了。
同样的方法可以拦截到各种指定进程的数据包，比如拦截御剑工具的数据包，看看它在爆破的时候都发了些什么请求：
四、小结 本文主要分享了使用proxifier工具进行代理设置拦截微信小程序和公众号数据包的方法，同时扩展了其他进程数据包的拦截方法，若是本文对读者学习相关的技术起到了一定的参考意义，望能给本文点个赞，谢谢！" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/b724a9830c8597942b35802a9b315fbb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-03T23:12:24+08:00" />
<meta property="article:modified_time" content="2022-12-03T23:12:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">weixin小程序和公众号抓包方法分享</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">前言</a></li><li><a href="#_5" rel="nofollow">一、工具准备及相关设置</a></li><li><a href="#burp_23" rel="nofollow">二、burp抓包演示</a></li><li><a href="#_29" rel="nofollow">三、扩展操作</a></li><li><a href="#_45" rel="nofollow">四、小结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_2"></a>前言</h2> 
<p>由于在工作中涉及了微信小程序的渗透测试，参考了一些文章，感觉代理的设置大都太麻烦，甚至还有人用模拟器或者手机登陆微信再抓内网IP的数据包，按照<code>app</code>渗透测试的思路来抓取本在电脑上就能直接运行的应用程序的数据包，实在是没必要。因此自己鼓捣了一种简单的抓包方法，直接用<code>proxifier</code>工具来抓指定进程的数据包，转发给<code>burp</code>就可以了。</p> 
<hr> 
<h2><a id="_5"></a>一、工具准备及相关设置</h2> 
<p>我本人用的是<code>proxifier</code>汉化版，可以直接从百度去找，也可以点击下方链接下载：<br> <a href="https://pan.baidu.com/s/1Kf5IVDAgVmCgsXU9rRlJXw?pwd=fsuj" rel="nofollow">https://pan.baidu.com/s/1Kf5IVDAgVmCgsXU9rRlJXw?pwd=fsuj</a><br> 提取码：<code>fsuj </code><br> 工具下载好以后直接傻瓜式安装即可，然后双击运行，顺利的话会见到如下界面：<br> <img src="https://images2.imgbox.com/d2/eb/f3su9GPW_o.png" alt="在这里插入图片描述"><br> 依次点击菜单栏中的<strong>配置文件</strong>-&gt;<strong>代理服务器</strong>-&gt;<strong>添加</strong><br> <img src="https://images2.imgbox.com/34/01/1ydR872e_o.png" alt="在这里插入图片描述"><br> 填写内容如下，其中端口应与burp的监听端口一致：<br> <img src="https://images2.imgbox.com/df/ea/1qILIsJl_o.png" alt="在这里插入图片描述" width="600" height="350"><br> 这里协议注意选<code>https</code>，我们只要抓<code>https</code>协议相关的数据包（包含了http），而<code>socks5</code>包含了其他协议的内容，<code>burp</code>不能处理，因此这里不能选<code>socks5</code>。<br> 接着在主界面点击<strong>配置文件</strong>-&gt;<strong>代理规则</strong>-&gt;<strong>添加</strong>，然后设置内容如下：<br> <img src="https://images2.imgbox.com/72/14/sdJPgMki_o.png" alt="在这里插入图片描述" width="600" height="350"></p> 
<p>注：<code>WeChatAppEx.exe</code>和<code>WechatBrowser.exe</code>分别是微信小程序和公众号通用的进程。<br> 之后将小程序前面的复选框打钩：<br> <img src="https://images2.imgbox.com/ce/7a/iojq2AMC_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="burp_23"></a>二、burp抓包演示</h2> 
<p>现在我分别找个公众号和小程序演示。例如最近比较火的<strong>羊了个羊</strong>小程序：<br> <img src="https://images2.imgbox.com/0b/3a/VYokl3Ho_o.png" alt="在这里插入图片描述"><br> <strong>江南雨上</strong>公众号：<br> <img src="https://images2.imgbox.com/1c/1b/e7jfVx1l_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="_29"></a>三、扩展操作</h2> 
<p>大型企业经常会规定禁止内外网互联，因此如果连了公司网线，再连自己的热点就属于典型的内外网互联，而如果连公司的wifi，则因为连接人数太多往往很卡。幸好我所在的公司提供了内网代理服务器，连接上以后就可以上网了。下面分享通过<code>proxifier</code>工具开启全局代理的方法：<br> 按照如下图所示进行设置：<br> <img src="https://images2.imgbox.com/80/18/dMNSmnob_o.png" alt="在这里插入图片描述"><br> 这里的IP应为内网中代理服务器的地址和端口，这里我们公司提供的是<code>192.168.25.25:6666</code>，你们可根据自己实际情况修改。注意添加用户名和密码，因为内网代理服务器一般需要验证用户身份。当然不添加的话，也可以，只是后面肯会有弹窗要求填写账户密码进行身份验证。<br> 然后在代理规则中设置如下：<br> <img src="https://images2.imgbox.com/41/c4/tqK6gRlT_o.png" alt="在这里插入图片描述"><br> 这样就可以把全局所有未额外设置代理的进程流量全部导入代理服务器了。可能有人会问，这个时候假设打开了谷歌浏览器，访问了一个站点，想要用<code>burp</code>抓它的数据包，该怎么办呢？这个时候要注意，不要在浏览器里设置代理，直接在<code>proxifier</code>工具的代理规则添加一条规则如下：<br> <img src="https://images2.imgbox.com/57/76/ixKos9AQ_o.png" alt="在这里插入图片描述"><br> 检查该规则是否已启用：<br> <img src="https://images2.imgbox.com/45/cb/hkSkg9SA_o.png" alt="在这里插入图片描述"><br> 这样的话，小程序、公众号和谷歌浏览器的流量就会被导入到本地的<code>127.0.0.1</code>的<code>8080</code>端口，就可以使用<code>burp</code>去拦截数据包，而<code>burp</code>的出口走的是代理服务器的<code>ip</code>和端口，因此并不影响它们访问外网，这样就实现了在内网环境下设置全局代理和<code>burp</code>拦截数据包两不误了。<br> 同样的方法可以拦截到各种指定进程的数据包，比如拦截<strong>御剑工具</strong>的数据包，看看它在爆破的时候都发了些什么请求：<br> <img src="https://images2.imgbox.com/0b/aa/vJgwbrc5_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a8/ee/X6hcNK9C_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="_45"></a>四、小结</h2> 
<p>本文主要分享了使用<code>proxifier</code>工具进行代理设置拦截微信小程序和公众号数据包的方法，同时扩展了其他进程数据包的拦截方法，若是本文对读者学习相关的技术起到了一定的参考意义，望能给本文点个赞，谢谢！</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/60c860faa3076bd929ff3363931ce01c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">小鼠与人类ID转换</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/92420bf246a0d66e3f708efbaf2e760b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Swin-Transformer详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>