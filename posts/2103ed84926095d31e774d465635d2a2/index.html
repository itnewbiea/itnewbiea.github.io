<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Vue&#43;Electron打包桌面应用(从零到一完整教程) - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Vue&#43;Electron打包桌面应用(从零到一完整教程)" />
<meta property="og:description" content="文章目录 一.使用vite&#43;vue3&#43;js方式一.构建桌面应用1.创建项目2. 安装依赖运行项目3.配置Electron4.修改配置文件1) vite.config.js2）main.js(项目根目录新增)3）preload.js(项目根目录下新增)4）package.json 5.打包vue项目6.运行electron 二.热更新开发环境1. 编辑main.js2. 同时开启vite和electron服务3.运行 三.打包操作实现1. 环境变量 2. 创建electron文件夹3. 编辑electron/main.js4. 编辑package.json5.打包 二.使用vite&#43;vue3&#43;Ts方式(某大佬已经搭建好了,只能Ts)三.使用vue-cli脚手架方式(支持vue2/3)1.Node版本要求2.通过vue-cli创建vue项目(2/3都可以)3.添加vue自带的electron-builder4.打包exe程序 一.使用vite&#43;vue3&#43;js方式 切记,整个项目的json文件不能有注释,及时没报错也不行,否则运行命令时还是有问题
一.构建桌面应用 1.创建项目 npm create vite@latest 或者 npm init vite@latest // 选择vue3&#43;js或者vue3&#43;ts 2. 安装依赖运行项目 // 进入项目安装依赖 npm install // 运行项目 npm run dev 3.配置Electron npm install electron //这里建议用镜像,不然太慢 4.修改配置文件 1) vite.config.js import { defineConfig } from &#39;vite&#39; import vue from &#39;@vitejs/plugin-vue&#39; // https://vitejs.dev/config/ export default defineConfig({ base: &#39;./&#39;,	// 新增,打包的dist文件的index.html引入资源css/js的路径,这里使用相对路径,预防找不到的问题 plugins: [vue()] }) 2）main." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/2103ed84926095d31e774d465635d2a2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-21T11:40:56+08:00" />
<meta property="article:modified_time" content="2023-12-21T11:40:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Vue&#43;Electron打包桌面应用(从零到一完整教程)</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#vitevue3js_1" rel="nofollow">一.使用vite+vue3+js方式</a></li><li><ul><li><a href="#_5" rel="nofollow">一.构建桌面应用</a></li><li><ul><li><a href="#1_6" rel="nofollow">1.创建项目</a></li><li><a href="#2__13" rel="nofollow">2. 安装依赖运行项目</a></li><li><a href="#3Electron_20" rel="nofollow">3.配置Electron</a></li><li><a href="#4_24" rel="nofollow">4.修改配置文件</a></li><li><ul><li><a href="#1_viteconfigjs_25" rel="nofollow">1) vite.config.js</a></li><li><a href="#2mainjs_36" rel="nofollow">2）main.js(项目根目录新增)</a></li><li><a href="#3preloadjs_85" rel="nofollow">3）preload.js(项目根目录下新增)</a></li><li><a href="#4packagejson_102" rel="nofollow">4）package.json</a></li></ul> 
    </li><li><a href="#5vue_126" rel="nofollow">5.打包vue项目</a></li><li><a href="#6electron_130" rel="nofollow">6.运行electron</a></li></ul> 
   </li><li><a href="#_138" rel="nofollow">二.热更新开发环境</a></li><li><ul><li><a href="#1_mainjs_139" rel="nofollow">1. 编辑main.js</a></li><li><a href="#2_viteelectron_189" rel="nofollow">2. 同时开启vite和electron服务</a></li><li><a href="#3_227" rel="nofollow">3.运行</a></li></ul> 
   </li><li><a href="#_236" rel="nofollow">三.打包操作</a></li><li><ul><li><a href="#_242" rel="nofollow">实现</a></li><li><ul><li><a href="#1__243" rel="nofollow">1. 环境变量</a></li></ul> 
    </li><li><a href="#2_electron_246" rel="nofollow">2. 创建electron文件夹</a></li><li><a href="#3_electronmainjs_248" rel="nofollow">3. 编辑electron/main.js</a></li><li><a href="#4_packagejson_305" rel="nofollow">4. 编辑package.json</a></li><li><a href="#5_422" rel="nofollow">5.打包</a></li></ul> 
  </li></ul> 
  </li><li><a href="#vitevue3TsTs_482" rel="nofollow">二.使用vite+vue3+Ts方式(某大佬已经搭建好了,只能Ts)</a></li><li><a href="#vueclivue23_498" rel="nofollow">三.使用vue-cli脚手架方式(支持vue2/3)</a></li><li><ul><li><a href="#1Node_499" rel="nofollow">1.Node版本要求</a></li><li><a href="#2vueclivue23_507" rel="nofollow">2.通过vue-cli创建vue项目(2/3都可以)</a></li><li><a href="#3vueelectronbuilder_514" rel="nofollow">3.添加vue自带的electron-builder</a></li><li><a href="#4exe_521" rel="nofollow">4.打包exe程序</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="vitevue3js_1"></a>一.使用vite+vue3+js方式</h2> 
<blockquote> 
 <p><strong>切记,整个项目的json文件不能有注释,及时没报错也不行,否则运行命令时还是有问题</strong></p> 
</blockquote> 
<h3><a id="_5"></a>一.构建桌面应用</h3> 
<h4><a id="1_6"></a>1.创建项目</h4> 
<pre><code class="prism language-js"> npm create vite@latest
 或者
 npm init vite@latest
 <span class="token comment">// 选择vue3+js或者vue3+ts</span>
</code></pre> 
<h4><a id="2__13"></a>2. 安装依赖运行项目</h4> 
<pre><code class="prism language-js"><span class="token comment">// 进入项目安装依赖</span>
npm install
<span class="token comment">// 运行项目</span>
npm run dev
</code></pre> 
<h4><a id="3Electron_20"></a>3.配置Electron</h4> 
<pre><code class="prism language-js">npm install electron  <span class="token comment">//这里建议用镜像,不然太慢</span>
</code></pre> 
<h4><a id="4_24"></a>4.修改配置文件</h4> 
<h5><a id="1_viteconfigjs_25"></a>1) vite.config.js</h5> 
<pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">'@vitejs/plugin-vue'</span>

<span class="token comment">// https://vitejs.dev/config/</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">'./'</span><span class="token punctuation">,</span>	<span class="token comment">// 新增,打包的dist文件的index.html引入资源css/js的路径,这里使用相对路径,预防找不到的问题</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="2mainjs_36"></a>2）main.js(项目根目录新增)</h5> 
<blockquote> 
 <p>此为electron运行的入口文件</p> 
</blockquote> 
<pre><code class="prism language-js"><span class="token comment">// main.js</span>

<span class="token comment">// 控制应用生命周期和创建原生浏览器窗口的模组</span>
<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> app<span class="token punctuation">,</span> BrowserWindow <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">createWindow</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建浏览器窗口</span>
  <span class="token keyword">const</span> mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span>
    <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
    <span class="token literal-property property">webPreferences</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">preload</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'preload.js'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// 加载 index.html</span>
  mainWindow<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span><span class="token string">'dist/index.html'</span><span class="token punctuation">)</span> <span class="token comment">// 此处跟electron官网路径不同，需要注意</span>

  <span class="token comment">// 打开开发工具</span>
  <span class="token comment">// mainWindow.webContents.openDevTools()</span>
<span class="token punctuation">}</span>

<span class="token comment">// 这段程序将会在 Electron 结束初始化</span>
<span class="token comment">// 和创建浏览器窗口的时候调用</span>
<span class="token comment">// 部分 API 在 ready 事件触发后才能使用。</span>
app<span class="token punctuation">.</span><span class="token function">whenReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'activate'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 通常在 macOS 上，当点击 dock 中的应用程序图标时，如果没有其他</span>
    <span class="token comment">// 打开的窗口，那么程序会重新创建一个窗口。</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>BrowserWindow<span class="token punctuation">.</span><span class="token function">getAllWindows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 除了 macOS 外，当所有窗口都被关闭的时候退出程序。 因此，通常对程序和它们在</span>
<span class="token comment">// 任务栏上的图标来说，应当保持活跃状态，直到用户使用 Cmd + Q 退出。</span>
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'window-all-closed'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>platform <span class="token operator">!==</span> <span class="token string">'darwin'</span><span class="token punctuation">)</span> app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 在这个文件中，你可以包含应用程序剩余的所有部分的代码，</span>
<span class="token comment">// 也可以拆分成几个文件，然后用 require 导入。</span>
</code></pre> 
<h5><a id="3preloadjs_85"></a>3）preload.js(项目根目录下新增)</h5> 
<pre><code class="prism language-js"><span class="token comment">// preload.js</span>

<span class="token comment">// 所有Node.js API都可以在预加载过程中使用。</span>
<span class="token comment">// 它拥有与Chrome扩展一样的沙盒。</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'DOMContentLoaded'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> <span class="token function-variable function">replaceText</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">selector<span class="token punctuation">,</span> text</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> element<span class="token punctuation">.</span>innerText <span class="token operator">=</span> text
  <span class="token punctuation">}</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> dependency <span class="token keyword">of</span> <span class="token punctuation">[</span><span class="token string">'chrome'</span><span class="token punctuation">,</span> <span class="token string">'node'</span><span class="token punctuation">,</span> <span class="token string">'electron'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">replaceText</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>dependency<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-version</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> process<span class="token punctuation">.</span>versions<span class="token punctuation">[</span>dependency<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="4packagejson_102"></a>4）package.json</h5> 
<pre><code class="prism language-js"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"sd"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"private"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"0.0.0"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"main"</span><span class="token operator">:</span> <span class="token string">"main.js"</span><span class="token punctuation">,</span>  <span class="token comment">// 新增</span>
  <span class="token comment">//"type": "module", 创建项目自带的这个要删除,否则会有问题</span>
  <span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"dev"</span><span class="token operator">:</span> <span class="token string">"vite"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"build"</span><span class="token operator">:</span> <span class="token string">"vite build"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"preview"</span><span class="token operator">:</span> <span class="token string">"vite preview"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"electron:serve"</span><span class="token operator">:</span> <span class="token string">"electron ."</span>  <span class="token comment">//新增 electron运行命令</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"electron"</span><span class="token operator">:</span> <span class="token string">"^27.0.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"vue"</span><span class="token operator">:</span> <span class="token string">"^3.3.4"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"@vitejs/plugin-vue"</span><span class="token operator">:</span> <span class="token string">"^4.2.3"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"vite"</span><span class="token operator">:</span> <span class="token string">"^4.4.5"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="5vue_126"></a>5.打包vue项目</h4> 
<pre><code class="prism language-js">npm run build
</code></pre> 
<h4><a id="6electron_130"></a>6.运行electron</h4> 
<pre><code class="prism language-js">yarn electron<span class="token operator">:</span>serve
或者
npm run electron<span class="token operator">:</span>serve
</code></pre> 
<blockquote> 
 <p>到这一步基本完成了,后面再新增一下热更新及打包的配置,可以接着往下看</p> 
</blockquote> 
<h3><a id="_138"></a>二.热更新开发环境</h3> 
<h4><a id="1_mainjs_139"></a>1. 编辑main.js</h4> 
<blockquote> 
 <p>将mainWindow.loadFile(‘dist/index.html’)更新为mainWindow.loadURL(“http://localhost:5173”)，更新后的文件如下所示：</p> 
</blockquote> 
<pre><code class="prism language-js"><span class="token comment">// main.js</span>

<span class="token comment">// 控制应用生命周期和创建原生浏览器窗口的模组</span>
<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> app<span class="token punctuation">,</span> BrowserWindow <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">createWindow</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建浏览器窗口</span>
  <span class="token keyword">const</span> mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span>
    <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
    <span class="token literal-property property">webPreferences</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">preload</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'preload.js'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// 加载 index.html</span>
  <span class="token comment">// mainWindow.loadFile('dist/index.html') 将该行改为下面这一行，加载url</span>
  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">"http://localhost:5173"</span><span class="token punctuation">)</span> <span class="token comment">//这里改成自己的项目启动端口</span>

  <span class="token comment">// 打开开发工具</span>
  <span class="token comment">// mainWindow.webContents.openDevTools()</span>
<span class="token punctuation">}</span>

<span class="token comment">// 这段程序将会在 Electron 结束初始化</span>
<span class="token comment">// 和创建浏览器窗口的时候调用</span>
<span class="token comment">// 部分 API 在 ready 事件触发后才能使用。</span>
app<span class="token punctuation">.</span><span class="token function">whenReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'activate'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 通常在 macOS 上，当点击 dock 中的应用程序图标时，如果没有其他</span>
    <span class="token comment">// 打开的窗口，那么程序会重新创建一个窗口。</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>BrowserWindow<span class="token punctuation">.</span><span class="token function">getAllWindows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 除了 macOS 外，当所有窗口都被关闭的时候退出程序。 因此，通常对程序和它们在</span>
<span class="token comment">// 任务栏上的图标来说，应当保持活跃状态，直到用户使用 Cmd + Q 退出。</span>
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'window-all-closed'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>platform <span class="token operator">!==</span> <span class="token string">'darwin'</span><span class="token punctuation">)</span> app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 在这个文件中，你可以包含应用程序剩余的所有部分的代码，</span>
<span class="token comment">// 也可以拆分成几个文件，然后用 require 导入。</span>
</code></pre> 
<h4><a id="2_viteelectron_189"></a>2. 同时开启vite和electron服务</h4> 
<p>为了使vite和electron正常运行，需要先运行vite，使得其开发服务器的url可以正常访问，然后再开启electron去加载url。</p> 
<p>此处需要安装两个库：</p> 
<ul><li>concurrently：阻塞运行多个命令，-k参数用来清除其它已经存在或者挂掉的进程</li><li>wait-on：等待资源，此处用来等待url可访问</li></ul> 
<p><strong>安装命令为</strong></p> 
<pre><code class="prism language-js">yarn add <span class="token operator">-</span><span class="token constant">D</span> concurrently wait<span class="token operator">-</span>on
或者
npm install <span class="token operator">-</span><span class="token constant">D</span> concurrently wait<span class="token operator">-</span>on
</code></pre> 
<p><strong>接着更新文件package.json，scripts新增两条命令：</strong></p> 
<pre><code class="prism language-js"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"sd"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"private"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"0.0.0"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"main"</span><span class="token operator">:</span> <span class="token string">"main.js"</span><span class="token punctuation">,</span>  
  <span class="token comment">//"type": "module", 创建项目自带的这个要删除,否则会有问题</span>
  <span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"dev"</span><span class="token operator">:</span> <span class="token string">"vite"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"build"</span><span class="token operator">:</span> <span class="token string">"vite build"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"preview"</span><span class="token operator">:</span> <span class="token string">"vite preview"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"electron"</span><span class="token operator">:</span> <span class="token string">"wait-on tcp:5173 &amp;&amp; electron ."</span><span class="token punctuation">,</span>  <span class="token comment">//新增更新1(这里改成自己的项目启动端口)</span>
    <span class="token string-property property">"electron:serve"</span><span class="token operator">:</span> <span class="token string">"concurrently -k \"npm run dev\" \"npm run electron\""</span> <span class="token comment">//新增更新2  </span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"electron"</span><span class="token operator">:</span> <span class="token string">"^27.0.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"vue"</span><span class="token operator">:</span> <span class="token string">"^3.3.4"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"@vitejs/plugin-vue"</span><span class="token operator">:</span> <span class="token string">"^4.2.3"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"vite"</span><span class="token operator">:</span> <span class="token string">"^4.4.5"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="3_227"></a>3.运行</h4> 
<p>现已添加两条命令：</p> 
<ul><li>yarn electron为等待tcp协议5173端口可访问，然后执行electron</li><li>yarn electron:serve为阻塞执行开发服务器运行和yarn electron命令</li></ul> 
<p>运行项目只要执行命令<code>yarn electron:serve</code>或者<code>npm run electron:serve</code>即可，当修改项目文件时，桌面应用也将自动更新。</p> 
<blockquote> 
 <p>到现在为止,热更新也已经完毕,最后一部分就是打包操作</p> 
</blockquote> 
<h3><a id="_236"></a>三.打包操作</h3> 
<blockquote> 
 <p>先说结论，重点还是在于mainWindow.loadURL()。<br> 打包后还是加载http://localhost:5173是无法运行的，因此，此处需要先用vite打包好，然后使用electron-builder加载vite打包后的文件进行打包。<br> 为了代码能够根据不同环境在运行时加载http://localhost:5173，在打包时加载文件，此处需要使用环境变量来切换生产和开发环境。</p> 
</blockquote> 
<h4><a id="_242"></a>实现</h4> 
<h5><a id="1__243"></a>1. 环境变量</h5> 
<blockquote> 
 <p>此处使用环境变量NODE_ENV来切换生产和开发环境，生产环境为NODE_ENV=production，开发环境为NODE_ENV=development，若有其它如release等环境可在此基础上拓展。</p> 
</blockquote> 
<h4><a id="2_electron_246"></a>2. 创建electron文件夹</h4> 
<blockquote> 
 <p>在项目根目录下创建文件夹electron，将main.js和preload.js文件移动进来.</p> 
</blockquote> 
<h4><a id="3_electronmainjs_248"></a>3. 编辑electron/main.js</h4> 
<p>该文件主要是需要根据环境变量切换electron加载的内容，修改内容如下：</p> 
<pre><code class="prism language-js"><span class="token comment">// main.js</span>

<span class="token comment">// 控制应用生命周期和创建原生浏览器窗口的模组</span>
<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> app<span class="token punctuation">,</span> BrowserWindow <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token constant">NODE_ENV</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span>  <span class="token comment">//新增</span>
<span class="token comment">// const NODE_ENV = 'development'  // 判断开发或生产模式(建议写成这种,开发模式就可以用,等即将打包了再把这个变量换成打包模式)</span>

<span class="token keyword">function</span> <span class="token function">createWindow</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建浏览器窗口</span>
  <span class="token keyword">const</span> mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span>
    <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
    <span class="token literal-property property">webPreferences</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">preload</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'preload.js'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// 加载 index.html</span>
  <span class="token comment">// mainWindow.loadFile('dist/index.html') // 此处跟electron官网路径不同，需要注意</span>
  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span>
    <span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'development'</span>
    <span class="token operator">?</span> <span class="token string">'http://localhost:5173'</span>
    <span class="token operator">:</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">file://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dist/index.html'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 新增</span>
  <span class="token comment">// 打开开发工具</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">"development"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    mainWindow<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">openDevTools</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token comment">// 新增</span>
<span class="token punctuation">}</span>

<span class="token comment">// 这段程序将会在 Electron 结束初始化</span>
<span class="token comment">// 和创建浏览器窗口的时候调用</span>
<span class="token comment">// 部分 API 在 ready 事件触发后才能使用。</span>
app<span class="token punctuation">.</span><span class="token function">whenReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'activate'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 通常在 macOS 上，当点击 dock 中的应用程序图标时，如果没有其他</span>
    <span class="token comment">// 打开的窗口，那么程序会重新创建一个窗口。</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>BrowserWindow<span class="token punctuation">.</span><span class="token function">getAllWindows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 除了 macOS 外，当所有窗口都被关闭的时候退出程序。 因此，通常对程序和它们在</span>
<span class="token comment">// 任务栏上的图标来说，应当保持活跃状态，直到用户使用 Cmd + Q 退出。</span>
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'window-all-closed'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>platform <span class="token operator">!==</span> <span class="token string">'darwin'</span><span class="token punctuation">)</span> app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 在这个文件中，你可以包含应用程序剩余的所有部分的代码，</span>
<span class="token comment">// 也可以拆分成几个文件，然后用 require 导入。</span>
</code></pre> 
<h4><a id="4_packagejson_305"></a>4. 编辑package.json</h4> 
<blockquote> 
 <p>首先修改main 属性，将main: main.js改为main: electron/main.js。<br> 接着，编辑build属性：</p> 
</blockquote> 
<pre><code class="prism language-js"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"sd"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"private"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"0.0.0"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"main"</span><span class="token operator">:</span> <span class="token string">"electron/main.js"</span><span class="token punctuation">,</span>  <span class="token comment">// 修改入口文件位置</span>
  <span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"dev"</span><span class="token operator">:</span> <span class="token string">"vite"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"build"</span><span class="token operator">:</span> <span class="token string">"vite build"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"preview"</span><span class="token operator">:</span> <span class="token string">"vite preview"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"electron"</span><span class="token operator">:</span> <span class="token string">"wait-on tcp:5173 &amp;&amp; electron ."</span><span class="token punctuation">,</span>
    <span class="token string-property property">"electron:serve"</span><span class="token operator">:</span> <span class="token string">"concurrently -k \"npm run dev\" \"npm run electron\""</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"build"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"appId"</span><span class="token operator">:</span> <span class="token string">"com.dweb.demo"</span><span class="token punctuation">,</span>  <span class="token comment">//包id com.dweb.项目名</span>
    <span class="token string-property property">"productName"</span><span class="token operator">:</span> <span class="token string">"ElectronApp"</span><span class="token punctuation">,</span> <span class="token comment">// 项目名</span>
    <span class="token string-property property">"copyright"</span><span class="token operator">:</span> <span class="token string">"Copyright © 2021 &lt;your-name&gt;"</span><span class="token punctuation">,</span> <span class="token comment">// 版权信息</span>
    <span class="token string-property property">"mac"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"category"</span><span class="token operator">:</span> <span class="token string">"public.app-category.utilities"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">"nsis"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"oneClick"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token string-property property">"allowToChangeInstallationDirectory"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">"files"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">"dist/**/*"</span><span class="token punctuation">,</span>
      <span class="token string">"electron/**/*"</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">"directories"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"buildResources"</span><span class="token operator">:</span> <span class="token string">"assets"</span><span class="token punctuation">,</span> <span class="token comment">//静态文件资源获取目录</span>
      <span class="token string-property property">"output"</span><span class="token operator">:</span> <span class="token string">"dist_electron"</span> <span class="token comment">// 打包位置,会新建到项目根目录</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"electron"</span><span class="token operator">:</span> <span class="token string">"^27.0.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"vue"</span><span class="token operator">:</span> <span class="token string">"^3.3.4"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"@vitejs/plugin-vue"</span><span class="token operator">:</span> <span class="token string">"^4.2.3"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"concurrently"</span><span class="token operator">:</span> <span class="token string">"^8.2.1"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"vite"</span><span class="token operator">:</span> <span class="token string">"^4.4.5"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"wait-on"</span><span class="token operator">:</span> <span class="token string">"^7.0.1"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>然后，更新scripts属性。<br> 此处需要先安装两个库：</p> 
<ul><li>cross-env: 该库让开发者只需要注重环境变量的设置，而无需担心平台设置</li><li>electron-builder: electron打包库</li></ul> 
<pre><code class="prism language-js">yarn add <span class="token operator">-</span><span class="token constant">D</span> cross<span class="token operator">-</span>env electron<span class="token operator">-</span>builder
或者
npm install <span class="token operator">-</span><span class="token constant">D</span> cross<span class="token operator">-</span>env electron<span class="token operator">-</span>builder
</code></pre> 
<p>更新后的scripts如下：</p> 
<pre><code class="prism language-js"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"dev"</span><span class="token operator">:</span> <span class="token string">"vite"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"build"</span><span class="token operator">:</span> <span class="token string">"vite build"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"serve"</span><span class="token operator">:</span> <span class="token string">"vite preview"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"electron"</span><span class="token operator">:</span> <span class="token string">"wait-on tcp:5173 &amp;&amp; cross-env NODE_ENV=development electron ."</span><span class="token punctuation">,</span> <span class="token comment">// 此处需要设置环境变量以保证开发时加载url</span>
  <span class="token string-property property">"electron:serve"</span><span class="token operator">:</span> <span class="token string">"concurrently -k \"npm run dev\" \"npm run electron\""</span><span class="token punctuation">,</span>
  <span class="token string-property property">"electron:build"</span><span class="token operator">:</span> <span class="token string">"vite build &amp;&amp; electron-builder"</span> <span class="token comment">// 新增打包命令</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>最后，更新后的package.json完整内容如下：</strong></p> 
<pre><code class="prism language-js"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"sd"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"private"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"0.0.0"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"main"</span><span class="token operator">:</span> <span class="token string">"electron/main.js"</span><span class="token punctuation">,</span>  <span class="token comment">// 修改入口文件位置</span>
  <span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"dev"</span><span class="token operator">:</span> <span class="token string">"vite"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"build"</span><span class="token operator">:</span> <span class="token string">"vite build"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"preview"</span><span class="token operator">:</span> <span class="token string">"vite preview"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"electron"</span><span class="token operator">:</span> <span class="token string">"wait-on tcp:5173 &amp;&amp; electron ."</span><span class="token punctuation">,</span>
    <span class="token string-property property">"electron:serve"</span><span class="token operator">:</span> <span class="token string">"concurrently -k \"npm run dev\" \"npm run electron\""</span><span class="token punctuation">,</span>
    <span class="token string-property property">"electron:build"</span><span class="token operator">:</span> <span class="token string">"vite build &amp;&amp; electron-builder"</span> <span class="token comment">// 新增打包命令</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"build"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"appId"</span><span class="token operator">:</span> <span class="token string">"com.dweb.demo"</span><span class="token punctuation">,</span>  <span class="token comment">//包id com.dweb.项目名</span>
    <span class="token string-property property">"productName"</span><span class="token operator">:</span> <span class="token string">"ElectronApp"</span><span class="token punctuation">,</span> <span class="token comment">// 项目名</span>
    <span class="token string-property property">"copyright"</span><span class="token operator">:</span> <span class="token string">"Copyright © 2021 &lt;your-name&gt;"</span><span class="token punctuation">,</span> <span class="token comment">// 版权信息</span>
    <span class="token string-property property">"mac"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"category"</span><span class="token operator">:</span> <span class="token string">"public.app-category.utilities"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">"nsis"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"oneClick"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token string-property property">"allowToChangeInstallationDirectory"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">"files"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">"dist/**/*"</span><span class="token punctuation">,</span>
      <span class="token string">"electron/**/*"</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">"directories"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"buildResources"</span><span class="token operator">:</span> <span class="token string">"assets"</span><span class="token punctuation">,</span> <span class="token comment">//静态文件资源获取目录</span>
      <span class="token string-property property">"output"</span><span class="token operator">:</span> <span class="token string">"dist_electron"</span> <span class="token comment">// 打包位置,会新建到项目根目录</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"electron"</span><span class="token operator">:</span> <span class="token string">"^27.0.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"vue"</span><span class="token operator">:</span> <span class="token string">"^3.3.4"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"@vitejs/plugin-vue"</span><span class="token operator">:</span> <span class="token string">"^4.2.3"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"concurrently"</span><span class="token operator">:</span> <span class="token string">"^8.2.1"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"vite"</span><span class="token operator">:</span> <span class="token string">"^4.4.5"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"wait-on"</span><span class="token operator">:</span> <span class="token string">"^7.0.1"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="5_422"></a>5.打包</h4> 
<pre><code class="prism language-js">yarn electron<span class="token operator">:</span>build
或者
npm run electron<span class="token operator">:</span>build
</code></pre> 
<p><strong>报错了:Package “electron” is only allowed in “devDependencies”. Please remove it from the “dependencies” section in your package.json.</strong><br> 这段意思就是说electron不允许在开发依赖,需要换到运行依赖里面,改完后package.json如下:</p> 
<pre><code class="prism language-js"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"sd"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"private"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"0.0.0"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"main"</span><span class="token operator">:</span> <span class="token string">"electron/main.js"</span><span class="token punctuation">,</span>  <span class="token comment">// 修改入口文件位置</span>
  <span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"dev"</span><span class="token operator">:</span> <span class="token string">"vite"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"build"</span><span class="token operator">:</span> <span class="token string">"vite build"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"preview"</span><span class="token operator">:</span> <span class="token string">"vite preview"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"electron"</span><span class="token operator">:</span> <span class="token string">"wait-on tcp:5173 &amp;&amp; electron ."</span><span class="token punctuation">,</span>
    <span class="token string-property property">"electron:serve"</span><span class="token operator">:</span> <span class="token string">"concurrently -k \"npm run dev\" \"npm run electron\""</span><span class="token punctuation">,</span>
    <span class="token string-property property">"electron:build"</span><span class="token operator">:</span> <span class="token string">"vite build &amp;&amp; electron-builder"</span> <span class="token comment">// 新增打包命令</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"build"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"appId"</span><span class="token operator">:</span> <span class="token string">"com.dweb.demo"</span><span class="token punctuation">,</span>  <span class="token comment">//包id com.dweb.项目名</span>
    <span class="token string-property property">"productName"</span><span class="token operator">:</span> <span class="token string">"ElectronApp"</span><span class="token punctuation">,</span> <span class="token comment">// 项目名</span>
    <span class="token string-property property">"copyright"</span><span class="token operator">:</span> <span class="token string">"Copyright © 2021 &lt;your-name&gt;"</span><span class="token punctuation">,</span> <span class="token comment">// 版权信息</span>
    <span class="token string-property property">"mac"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"category"</span><span class="token operator">:</span> <span class="token string">"public.app-category.utilities"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">"nsis"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"oneClick"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token string-property property">"allowToChangeInstallationDirectory"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">"files"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">"dist/**/*"</span><span class="token punctuation">,</span>
      <span class="token string">"electron/**/*"</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">"directories"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"buildResources"</span><span class="token operator">:</span> <span class="token string">"assets"</span><span class="token punctuation">,</span> <span class="token comment">//静态文件资源获取目录</span>
      <span class="token string-property property">"output"</span><span class="token operator">:</span> <span class="token string">"dist_electron"</span> <span class="token comment">// 打包位置,会新建到项目根目录</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 将开发依赖换到了运行依赖里面</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"@vitejs/plugin-vue"</span><span class="token operator">:</span> <span class="token string">"^4.2.3"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"concurrently"</span><span class="token operator">:</span> <span class="token string">"^8.2.1"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"vite"</span><span class="token operator">:</span> <span class="token string">"^4.4.5"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"wait-on"</span><span class="token operator">:</span> <span class="token string">"^7.0.1"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"electron"</span><span class="token operator">:</span> <span class="token string">"^27.0.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"vue"</span><span class="token operator">:</span> <span class="token string">"^3.3.4"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>打包完成之后，会多出两个文件夹<code>dist</code>和<code>dist_electron</code></strong></p> 
<p><strong>如果打包失败,或者一直卡着一个地方,是因为打包会产生依赖包,都是从github下载的,需要vpn,或者国内镜像可以解决,具体使用淘宝镜像方法可以看本博客最后,亲测有效</strong></p> 
<p><strong>至此,所有基本结束,上面这一堆<a href="https://zhuanlan.zhihu.com/p/421460116" rel="nofollow">参考了这个博主的文章,各位也可以看看</a></strong></p> 
<h2><a id="vitevue3TsTs_482"></a>二.使用vite+vue3+Ts方式(某大佬已经搭建好了,只能Ts)</h2> 
<blockquote> 
 <p>使用某大佬配置好的框架,只支持ts版本,没有选择项(vite+vue3+ts)<br> 方法很简单</p> 
 <ol><li>执行命令创建项目<br> npm create electron-vite<br> 首次进入会下载项目依赖,会询问是否下载,输入y即可<br> 然后输入项目名回车即可创建完毕</li><li>安装依赖<br> npm install</li><li>运行项目<br> npm run dev<br> 执行命令以后会在electron窗口运行</li><li>打包exe<br> npm run dev<br> (大佬已经集成了热部署,代码更新窗口也更新)</li></ol> 
</blockquote> 
<h2><a id="vueclivue23_498"></a>三.使用vue-cli脚手架方式(支持vue2/3)</h2> 
<h3><a id="1Node_499"></a>1.Node版本要求</h3> 
<blockquote> 
 <p>本人用的是<code>v16.20.2</code>,<br> 原本我用的是18版本结果打包一直有问题:报错：Error: error:0308010C:digital envelope routines::unsupported<br> 后来查了大量资料找到了原因:因为 node.js V17版本中最近发布的OpenSSL3.0, 而OpenSSL3.0对允许算法和密钥大小增加了严格的限制<br> 当然针对17版本以上也有办法解决,本人使用了最笨的方法就是降低版本到<code>v16.20.2</code>,大家可以看以下这篇博客尝试其他解决办法<br> <a href="https://blog.csdn.net/m0_65933139/article/details/130690790">快速解决Error: error:0308010C:digital envelope routines::unsupported的三种解决方案</a></p> 
</blockquote> 
<h3><a id="2vueclivue23_507"></a>2.通过vue-cli创建vue项目(2/3都可以)</h3> 
<blockquote> 
 <p>使用vue-cli脚手架创建,这个方法不支持vite</p> 
</blockquote> 
<pre><code class="prism language-js">vue create 项目名
</code></pre> 
<h3><a id="3vueelectronbuilder_514"></a>3.添加vue自带的electron-builder</h3> 
<blockquote> 
 <p>下面命令执行后会先执行vue脚手架再运行electron</p> 
</blockquote> 
<pre><code class="prism language-js">vue add electron<span class="token operator">-</span>builder
</code></pre> 
<h3><a id="4exe_521"></a>4.打包exe程序</h3> 
<pre><code class="prism language-js">npm run electron<span class="token operator">:</span>build
</code></pre> 
<p><strong>注意,打包过程会下载各种东西,网络较差容易下载失败,给大家推荐一个好用的方法</strong><br> <strong>在项目根目录下创建.npmrc文件,放入以下代码,这样下载的来源就是去淘宝镜像去下载,比较快</strong></p> 
<pre><code class="prism language-js"><span class="token constant">ELECTRON_MIRROR</span><span class="token operator">=</span>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>npm<span class="token punctuation">.</span>taobao<span class="token punctuation">.</span>org<span class="token operator">/</span>mirrors<span class="token operator">/</span>electron<span class="token operator">/</span>
<span class="token constant">ELECTRON_BUILDER_BINARIES_MIRROR</span><span class="token operator">=</span>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>npm<span class="token punctuation">.</span>taobao<span class="token punctuation">.</span>org<span class="token operator">/</span>mirrors<span class="token operator">/</span>electron<span class="token operator">-</span>builder<span class="token operator">-</span>binaries<span class="token operator">/</span>
</code></pre> 
<p><a href="https://www.azimiao.com/6208.html" rel="nofollow">以上的解决网络慢问题来源于此</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b3f698a02ad464d364ea438cb6218c3f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">关于“Python”的核心知识点整理大全33</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d71660625537bd7470bede2adbdbcad1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">2023年度数据分析项目，建议收藏(数据集)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>