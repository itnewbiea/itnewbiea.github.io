<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>å¤§æ•°æ®æ¯•è®¾åˆ†äº« opencv python æ·±åº¦å­¦ä¹ åƒåœ¾å›¾åƒåˆ†ç±»ç³»ç»Ÿ - ITå­¦ä¹ è€…åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="å¤§æ•°æ®æ¯•è®¾åˆ†äº« opencv python æ·±åº¦å­¦ä¹ åƒåœ¾å›¾åƒåˆ†ç±»ç³»ç»Ÿ" />
<meta property="og:description" content="æ–‡ç« ç›®å½• 0 å‰è¨€è¯¾é¢˜ç®€ä»‹ä¸€ã€è¯†åˆ«æ•ˆæœäºŒã€å®ç°1.æ•°æ®é›†2.å®ç°åŸç†å’Œæ–¹æ³•3.ç½‘ç»œç»“æ„ æœ€å 0 å‰è¨€ ğŸ”¥ è¿™ä¸¤å¹´å¼€å§‹æ¯•ä¸šè®¾è®¡å’Œæ¯•ä¸šç­”è¾©çš„è¦æ±‚å’Œéš¾åº¦ä¸æ–­æå‡ï¼Œä¼ ç»Ÿçš„æ¯•è®¾é¢˜ç›®ç¼ºå°‘åˆ›æ–°å’Œäº®ç‚¹ï¼Œå¾€å¾€è¾¾ä¸åˆ°æ¯•ä¸šç­”è¾©çš„è¦æ±‚ï¼Œè¿™ä¸¤å¹´ä¸æ–­æœ‰å­¦å¼Ÿå­¦å¦¹å‘Šè¯‰å­¦é•¿è‡ªå·±åšçš„é¡¹ç›®ç³»ç»Ÿè¾¾ä¸åˆ°è€å¸ˆçš„è¦æ±‚ã€‚
ä¸ºäº†å¤§å®¶èƒ½å¤Ÿé¡ºåˆ©ä»¥åŠæœ€å°‘çš„ç²¾åŠ›é€šè¿‡æ¯•è®¾ï¼Œå­¦é•¿åˆ†äº«ä¼˜è´¨æ¯•ä¸šè®¾è®¡é¡¹ç›®ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯
ğŸš© opencv python æ·±åº¦å­¦ä¹ åƒåœ¾åˆ†ç±»ç³»ç»Ÿ
ğŸ¥‡å­¦é•¿è¿™é‡Œç»™ä¸€ä¸ªé¢˜ç›®ç»¼åˆè¯„åˆ†(æ¯é¡¹æ»¡åˆ†5åˆ†)
éš¾åº¦ç³»æ•°ï¼š3åˆ†å·¥ä½œé‡ï¼š3åˆ†åˆ›æ–°ç‚¹ï¼š4åˆ† è¯¾é¢˜ç®€ä»‹ å¦‚ä»Šï¼Œåƒåœ¾åˆ†ç±»å·²æˆä¸ºç¤¾ä¼šçƒ­ç‚¹è¯é¢˜ã€‚å…¶å®åœ¨2019å¹´4æœˆ26æ—¥ï¼Œæˆ‘å›½ä½æˆ¿å’ŒåŸä¹¡å»ºè®¾éƒ¨ç­‰éƒ¨é—¨å°±å‘å¸ƒäº†ã€Šå…³äºåœ¨å…¨å›½åœ°çº§åŠä»¥ä¸ŠåŸå¸‚å…¨é¢å¼€å±•ç”Ÿæ´»åƒåœ¾åˆ†ç±»å·¥ä½œçš„é€šçŸ¥ã€‹ï¼Œå†³å®šè‡ª2019å¹´èµ·åœ¨å…¨å›½åœ°çº§åŠä»¥ä¸ŠåŸå¸‚å…¨é¢å¯åŠ¨ç”Ÿæ´»åƒåœ¾åˆ†ç±»å·¥ä½œã€‚åˆ°2020å¹´åº•ï¼Œ46ä¸ªé‡ç‚¹åŸå¸‚åŸºæœ¬å»ºæˆç”Ÿæ´»åƒåœ¾åˆ†ç±»å¤„ç†ç³»ç»Ÿã€‚
äººå·¥åƒåœ¾åˆ†ç±»æŠ•æ”¾æ˜¯åƒåœ¾å¤„ç†çš„ç¬¬ä¸€ç¯èŠ‚ï¼Œä½†èƒ½å¤Ÿå¤„ç†æµ·é‡åƒåœ¾çš„ç¯èŠ‚æ˜¯åƒåœ¾å¤„ç†å‚ã€‚ç„¶è€Œï¼Œç›®å‰å›½å†…çš„åƒåœ¾å¤„ç†å‚åŸºæœ¬éƒ½æ˜¯é‡‡ç”¨äººå·¥æµæ°´çº¿åˆ†æ‹£çš„æ–¹å¼è¿›è¡Œåƒåœ¾åˆ†æ‹£ï¼Œå­˜åœ¨å·¥ä½œç¯å¢ƒæ¶åŠ£ã€åŠ³åŠ¨å¼ºåº¦å¤§ã€åˆ†æ‹£æ•ˆç‡ä½ç­‰ç¼ºç‚¹ã€‚åœ¨æµ·é‡åƒåœ¾é¢å‰ï¼Œäººå·¥åˆ†æ‹£åªèƒ½åˆ†æ‹£å‡ºææœ‰é™çš„ä¸€éƒ¨åˆ†å¯å›æ”¶åƒåœ¾å’Œæœ‰å®³åƒåœ¾ï¼Œç»å¤§å¤šæ•°åƒåœ¾åªèƒ½è¿›è¡Œå¡«åŸ‹ï¼Œå¸¦æ¥äº†æå¤§çš„èµ„æºæµªè´¹å’Œç¯å¢ƒæ±¡æŸ“å±é™©ã€‚
éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯åœ¨è§†è§‰é¢†åŸŸçš„åº”ç”¨å’Œå‘å±•ï¼Œè®©æˆ‘ä»¬çœ‹åˆ°äº†åˆ©ç”¨AIæ¥è‡ªåŠ¨è¿›è¡Œåƒåœ¾åˆ†ç±»çš„å¯èƒ½ï¼Œé€šè¿‡æ‘„åƒå¤´æ‹æ‘„åƒåœ¾å›¾ç‰‡ï¼Œæ£€æµ‹å›¾ç‰‡ä¸­åƒåœ¾çš„ç±»åˆ«ï¼Œä»è€Œå¯ä»¥è®©æœºå™¨è‡ªåŠ¨è¿›è¡Œåƒåœ¾åˆ†æ‹£ï¼Œæå¤§åœ°æé«˜åƒåœ¾åˆ†æ‹£æ•ˆç‡ã€‚
åŸºäºæ·±åº¦å­¦ä¹ çš„åƒåœ¾åˆ†ç±»ç³»ç»Ÿï¼Œæ˜¯éå¸¸å¥½çš„æ¯•ä¸šè®¾è®¡è¯¾é¢˜
ä¸€ã€è¯†åˆ«æ•ˆæœ è€æ ·å­ï¼Œ åºŸè¯ä¸å¤šè¯´ï¼Œå…ˆå±•ç¤ºå›¾åƒåƒåœ¾åˆ†ç±»çš„è¯†åˆ«æ•ˆæœ
è®­ç»ƒæ¨¡å‹ç²¾åº¦ï¼š
å¯ä»¥çœ‹åˆ°ï¼Œåªè¿­ä»£äº†10è½®ç²¾åº¦è¾¾åˆ°87.50%ï¼Œè€Œä¸”æ²¡æœ‰å‡ºç°è¿‡æ‹Ÿåˆç°è±¡
æˆ‘æœ€é«˜è®­ç»ƒè¾¾åˆ°96%ï¼Œè¿­ä»£200è½®
è¯†åˆ«ç»“æœï¼š
å®é™…éªŒè¯æ­£ç¡®ç‡è¿˜æ˜¯å¾ˆé«˜çš„ã€‚
äºŒã€å®ç° 1.æ•°æ®é›† è¯¥æ•°æ®é›†åŒ…å«äº† 2507 ä¸ªç”Ÿæ´»åƒåœ¾å›¾ç‰‡ã€‚æ•°æ®é›†çš„åˆ›å»ºè€…å°†åƒåœ¾åˆ†ä¸ºäº† 6 ä¸ªç±»åˆ«ï¼Œåˆ†åˆ«æ˜¯ï¼š
å¦‚ä¸‹æ‰€ç¤ºï¼š
ä¸€å…±6ç±»åƒåœ¾ï¼Œ æ¯”å¦‚ç»ç’ƒç±»çš„å¦‚ä¸‹ï¼š
å¡‘æ–™ç±»çš„å¦‚ä¸‹ï¼š
å…¶ä»–çš„ä¸åˆ—ä¸¾äº†ã€‚
2.å®ç°åŸç†å’Œæ–¹æ³• ä½¿ç”¨æ·±åº¦æ®‹å·®ç½‘ç»œresnet50ä½œä¸ºåŸºçŸ³ï¼Œåœ¨åç»­æ·»åŠ éœ€è¦çš„å±‚ä»¥é€‚åº”ä¸åŒçš„åˆ†ç±»ä»»åŠ¡
æ¨¡å‹çš„è®­ç»ƒéœ€è¦ç”¨ç”Ÿæˆå™¨å°†æ•°æ®é›†å¾ªç¯å†™å…¥å†…å­˜ï¼ŒåŒæ—¶å›¾åƒå¢å¼ºä»¥æ³›åŒ–æ¨¡å‹
ä½¿ç”¨ä¸åŒ…å«ç½‘ç»œè¾“å‡ºéƒ¨åˆ†çš„resnet50æƒé‡æ–‡ä»¶è¿›è¡Œè¿ç§»å­¦ä¹ ï¼Œåªè®­ç»ƒæˆ‘ä»¬åœ¨5ä¸ªstageåå¢åŠ çš„å±‚
éœ€è¦çš„ç¬¬ä¸‰æ–¹åº“ä¸»è¦æœ‰tensorflow1.xï¼Œkerasï¼Œopencvï¼ŒPillowï¼Œscikit-learnï¼Œnumpy
å®‰è£…æ–¹å¼å¾ˆç®€å•ï¼Œæ‰“å¼€terminalï¼Œä¾‹å¦‚ï¼špip install numpy -i https://pypi.tuna.tsinghua.edu.cn/simple
æ•°æ®é›†ä¸æƒé‡æ–‡ä»¶æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥æ²¡æœ‰ä¸Šä¼ 
å¦‚æœç¯å¢ƒé…ç½®æ–¹é¢æœ‰é—®é¢˜æˆ–è€…éœ€è¦æ•°æ®é›†ä¸æ¨¡å‹æƒé‡æ–‡ä»¶ï¼Œå¯ä»¥åœ¨è¯„è®ºåŒºè¯´æ˜æ‚¨çš„é—®é¢˜ï¼Œæˆ‘å°†è¿œç¨‹å¸®åŠ©æ‚¨
3.ç½‘ç»œç»“æ„ è¿™é‡Œæˆ‘åªä½¿ç”¨äº†resnet50çš„5ä¸ªstageï¼Œåé¢çš„è¾“å‡ºéƒ¨åˆ†éœ€è¦æˆ‘ä»¬è‡ªå·±å®šåˆ¶ï¼Œç½‘ç»œçš„ç»“æ„å›¾å¦‚ä¸‹ï¼š
stage5åæˆ‘ä»¬çš„å®šåˆ¶ç½‘ç»œå¦‚ä¸‹ï¼š
&#34;&#34;&#34;å®šåˆ¶resnetåé¢çš„å±‚&#34;&#34;&#34; def custom(input_size,num_classes,pretrain): # å¼•å…¥åˆå§‹åŒ–resnet50æ¨¡å‹ base_model = ResNet50(weights=pretrain, include_top=False, pooling=None, input_shape=(input_size,input_size, 3), classes=num_classes) #ç”±äºæœ‰é¢„æƒé‡ï¼Œå‰éƒ¨åˆ†å†»ç»“ï¼Œåé¢è¿›è¡Œè¿ç§»å­¦ä¹  for layer in base_model." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/31f4a266621b256c14e7a874b314cdf8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T13:12:05+08:00" />
<meta property="article:modified_time" content="2024-01-05T13:12:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ITå­¦ä¹ è€…åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ITå­¦ä¹ è€…åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">å¤§æ•°æ®æ¯•è®¾åˆ†äº« opencv python æ·±åº¦å­¦ä¹ åƒåœ¾å›¾åƒåˆ†ç±»ç³»ç»Ÿ</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><a href="#0__4" rel="nofollow">0 å‰è¨€</a></li><li><a href="#_25" rel="nofollow">è¯¾é¢˜ç®€ä»‹</a></li><li><a href="#_41" rel="nofollow">ä¸€ã€è¯†åˆ«æ•ˆæœ</a></li><li><a href="#_60" rel="nofollow">äºŒã€å®ç°</a></li><li><ul><li><a href="#1_62" rel="nofollow">1.æ•°æ®é›†</a></li><li><a href="#2_77" rel="nofollow">2.å®ç°åŸç†å’Œæ–¹æ³•</a></li><li><a href="#3_88" rel="nofollow">3.ç½‘ç»œç»“æ„</a></li></ul> 
  </li><li><a href="#_164" rel="nofollow">æœ€å</a></li></ul> 
</div> 
<p></p> 
<hr color="#000000" size='1"'> 
<h2><a id="0__4"></a>0 å‰è¨€</h2> 
<p>ğŸ”¥ è¿™ä¸¤å¹´å¼€å§‹æ¯•ä¸šè®¾è®¡å’Œæ¯•ä¸šç­”è¾©çš„è¦æ±‚å’Œéš¾åº¦ä¸æ–­æå‡ï¼Œä¼ ç»Ÿçš„æ¯•è®¾é¢˜ç›®ç¼ºå°‘åˆ›æ–°å’Œäº®ç‚¹ï¼Œå¾€å¾€è¾¾ä¸åˆ°æ¯•ä¸šç­”è¾©çš„è¦æ±‚ï¼Œè¿™ä¸¤å¹´ä¸æ–­æœ‰å­¦å¼Ÿå­¦å¦¹å‘Šè¯‰å­¦é•¿è‡ªå·±åšçš„é¡¹ç›®ç³»ç»Ÿè¾¾ä¸åˆ°è€å¸ˆçš„è¦æ±‚ã€‚</p> 
<p>ä¸ºäº†å¤§å®¶èƒ½å¤Ÿé¡ºåˆ©ä»¥åŠæœ€å°‘çš„ç²¾åŠ›é€šè¿‡æ¯•è®¾ï¼Œå­¦é•¿åˆ†äº«ä¼˜è´¨æ¯•ä¸šè®¾è®¡é¡¹ç›®ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯</p> 
<p>ğŸš© <strong>opencv python æ·±åº¦å­¦ä¹ åƒåœ¾åˆ†ç±»ç³»ç»Ÿ</strong></p> 
<p>ğŸ¥‡å­¦é•¿è¿™é‡Œç»™ä¸€ä¸ªé¢˜ç›®ç»¼åˆè¯„åˆ†(æ¯é¡¹æ»¡åˆ†5åˆ†)</p> 
<ul><li>éš¾åº¦ç³»æ•°ï¼š3åˆ†</li><li>å·¥ä½œé‡ï¼š3åˆ†</li><li>åˆ›æ–°ç‚¹ï¼š4åˆ†</li></ul> 
<h2><a id="_25"></a>è¯¾é¢˜ç®€ä»‹</h2> 
<p><font color="#999AAA">å¦‚ä»Šï¼Œåƒåœ¾åˆ†ç±»å·²æˆä¸ºç¤¾ä¼šçƒ­ç‚¹è¯é¢˜ã€‚å…¶å®åœ¨2019å¹´4æœˆ26æ—¥ï¼Œæˆ‘å›½ä½æˆ¿å’ŒåŸä¹¡å»ºè®¾éƒ¨ç­‰éƒ¨é—¨å°±å‘å¸ƒäº†ã€Šå…³äºåœ¨å…¨å›½åœ°çº§åŠä»¥ä¸ŠåŸå¸‚å…¨é¢å¼€å±•ç”Ÿæ´»åƒåœ¾åˆ†ç±»å·¥ä½œçš„é€šçŸ¥ã€‹ï¼Œå†³å®šè‡ª2019å¹´èµ·åœ¨å…¨å›½åœ°çº§åŠä»¥ä¸ŠåŸå¸‚å…¨é¢å¯åŠ¨ç”Ÿæ´»åƒåœ¾åˆ†ç±»å·¥ä½œã€‚åˆ°2020å¹´åº•ï¼Œ46ä¸ªé‡ç‚¹åŸå¸‚åŸºæœ¬å»ºæˆç”Ÿæ´»åƒåœ¾åˆ†ç±»å¤„ç†ç³»ç»Ÿã€‚</font></p> 
<p><font color="#999AAA">äººå·¥åƒåœ¾åˆ†ç±»æŠ•æ”¾æ˜¯åƒåœ¾å¤„ç†çš„ç¬¬ä¸€ç¯èŠ‚ï¼Œä½†èƒ½å¤Ÿå¤„ç†æµ·é‡åƒåœ¾çš„ç¯èŠ‚æ˜¯åƒåœ¾å¤„ç†å‚ã€‚ç„¶è€Œï¼Œç›®å‰å›½å†…çš„åƒåœ¾å¤„ç†å‚åŸºæœ¬éƒ½æ˜¯é‡‡ç”¨äººå·¥æµæ°´çº¿åˆ†æ‹£çš„æ–¹å¼è¿›è¡Œåƒåœ¾åˆ†æ‹£ï¼Œå­˜åœ¨å·¥ä½œç¯å¢ƒæ¶åŠ£ã€åŠ³åŠ¨å¼ºåº¦å¤§ã€åˆ†æ‹£æ•ˆç‡ä½ç­‰ç¼ºç‚¹ã€‚åœ¨æµ·é‡åƒåœ¾é¢å‰ï¼Œäººå·¥åˆ†æ‹£åªèƒ½åˆ†æ‹£å‡ºææœ‰é™çš„ä¸€éƒ¨åˆ†å¯å›æ”¶åƒåœ¾å’Œæœ‰å®³åƒåœ¾ï¼Œç»å¤§å¤šæ•°åƒåœ¾åªèƒ½è¿›è¡Œå¡«åŸ‹ï¼Œå¸¦æ¥äº†æå¤§çš„èµ„æºæµªè´¹å’Œç¯å¢ƒæ±¡æŸ“å±é™©ã€‚</font></p> 
<p><font color="#999AAA">éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯åœ¨è§†è§‰é¢†åŸŸçš„åº”ç”¨å’Œå‘å±•ï¼Œè®©æˆ‘ä»¬çœ‹åˆ°äº†åˆ©ç”¨AIæ¥è‡ªåŠ¨è¿›è¡Œåƒåœ¾åˆ†ç±»çš„å¯èƒ½ï¼Œé€šè¿‡æ‘„åƒå¤´æ‹æ‘„åƒåœ¾å›¾ç‰‡ï¼Œæ£€æµ‹å›¾ç‰‡ä¸­åƒåœ¾çš„ç±»åˆ«ï¼Œä»è€Œå¯ä»¥è®©æœºå™¨è‡ªåŠ¨è¿›è¡Œåƒåœ¾åˆ†æ‹£ï¼Œæå¤§åœ°æé«˜åƒåœ¾åˆ†æ‹£æ•ˆç‡ã€‚</font></p> 
<p><font color="#999AAA">åŸºäºæ·±åº¦å­¦ä¹ çš„åƒåœ¾åˆ†ç±»ç³»ç»Ÿï¼Œæ˜¯éå¸¸å¥½çš„æ¯•ä¸šè®¾è®¡è¯¾é¢˜</font></p> 
<hr color="#000000" size='1"'> 
<h2><a id="_41"></a>ä¸€ã€è¯†åˆ«æ•ˆæœ</h2> 
<p><font color="#999AAA">è€æ ·å­ï¼Œ åºŸè¯ä¸å¤šè¯´ï¼Œå…ˆå±•ç¤ºå›¾åƒåƒåœ¾åˆ†ç±»çš„è¯†åˆ«æ•ˆæœ</font></p> 
<p>è®­ç»ƒæ¨¡å‹ç²¾åº¦ï¼š<br> <img src="https://images2.imgbox.com/d6/ef/7PPVloo8_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å¯ä»¥çœ‹åˆ°ï¼Œåªè¿­ä»£äº†10è½®ç²¾åº¦è¾¾åˆ°87.50%ï¼Œè€Œä¸”æ²¡æœ‰å‡ºç°è¿‡æ‹Ÿåˆç°è±¡</p> 
<p>æˆ‘æœ€é«˜è®­ç»ƒè¾¾åˆ°96%ï¼Œè¿­ä»£200è½®</p> 
<p>è¯†åˆ«ç»“æœï¼š<br> <img src="https://images2.imgbox.com/61/a8/xndvAD40_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å®é™…éªŒè¯æ­£ç¡®ç‡è¿˜æ˜¯å¾ˆé«˜çš„ã€‚</p> 
<h2><a id="_60"></a>äºŒã€å®ç°</h2> 
<h3><a id="1_62"></a>1.æ•°æ®é›†</h3> 
<p>è¯¥æ•°æ®é›†åŒ…å«äº† 2507 ä¸ªç”Ÿæ´»åƒåœ¾å›¾ç‰‡ã€‚æ•°æ®é›†çš„åˆ›å»ºè€…å°†åƒåœ¾åˆ†ä¸ºäº† 6 ä¸ªç±»åˆ«ï¼Œåˆ†åˆ«æ˜¯ï¼š<br> <img src="https://images2.imgbox.com/df/00/W4FUzpVZ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å¦‚ä¸‹æ‰€ç¤ºï¼š</p> 
<p><img src="https://images2.imgbox.com/63/8f/JqwkmzmG_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> ä¸€å…±6ç±»åƒåœ¾ï¼Œ æ¯”å¦‚ç»ç’ƒç±»çš„å¦‚ä¸‹ï¼š</p> 
<p><img src="https://images2.imgbox.com/b1/8a/o9QXgAjB_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å¡‘æ–™ç±»çš„å¦‚ä¸‹ï¼š</p> 
<p><img src="https://images2.imgbox.com/01/1c/fPrvD07P_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å…¶ä»–çš„ä¸åˆ—ä¸¾äº†ã€‚</p> 
<h3><a id="2_77"></a>2.å®ç°åŸç†å’Œæ–¹æ³•</h3> 
<p>ä½¿ç”¨æ·±åº¦æ®‹å·®ç½‘ç»œresnet50ä½œä¸ºåŸºçŸ³ï¼Œåœ¨åç»­æ·»åŠ éœ€è¦çš„å±‚ä»¥é€‚åº”ä¸åŒçš„åˆ†ç±»ä»»åŠ¡<br> æ¨¡å‹çš„è®­ç»ƒéœ€è¦ç”¨ç”Ÿæˆå™¨å°†æ•°æ®é›†å¾ªç¯å†™å…¥å†…å­˜ï¼ŒåŒæ—¶å›¾åƒå¢å¼ºä»¥æ³›åŒ–æ¨¡å‹<br> ä½¿ç”¨ä¸åŒ…å«ç½‘ç»œè¾“å‡ºéƒ¨åˆ†çš„resnet50æƒé‡æ–‡ä»¶è¿›è¡Œè¿ç§»å­¦ä¹ ï¼Œåªè®­ç»ƒæˆ‘ä»¬åœ¨5ä¸ªstageåå¢åŠ çš„å±‚</p> 
<p>éœ€è¦çš„ç¬¬ä¸‰æ–¹åº“ä¸»è¦æœ‰tensorflow1.xï¼Œkerasï¼Œopencvï¼ŒPillowï¼Œscikit-learnï¼Œnumpy<br> å®‰è£…æ–¹å¼å¾ˆç®€å•ï¼Œæ‰“å¼€terminalï¼Œä¾‹å¦‚ï¼špip install numpy -i https://pypi.tuna.tsinghua.edu.cn/simple<br> æ•°æ®é›†ä¸æƒé‡æ–‡ä»¶æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥æ²¡æœ‰ä¸Šä¼ <br> å¦‚æœç¯å¢ƒé…ç½®æ–¹é¢æœ‰é—®é¢˜æˆ–è€…éœ€è¦æ•°æ®é›†ä¸æ¨¡å‹æƒé‡æ–‡ä»¶ï¼Œå¯ä»¥åœ¨è¯„è®ºåŒºè¯´æ˜æ‚¨çš„é—®é¢˜ï¼Œæˆ‘å°†è¿œç¨‹å¸®åŠ©æ‚¨</p> 
<h3><a id="3_88"></a>3.ç½‘ç»œç»“æ„</h3> 
<p>è¿™é‡Œæˆ‘åªä½¿ç”¨äº†resnet50çš„5ä¸ªstageï¼Œåé¢çš„è¾“å‡ºéƒ¨åˆ†éœ€è¦æˆ‘ä»¬è‡ªå·±å®šåˆ¶ï¼Œç½‘ç»œçš„ç»“æ„å›¾å¦‚ä¸‹ï¼š<br> <img src="https://images2.imgbox.com/b6/e1/yg5UeI4A_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> stage5åæˆ‘ä»¬çš„å®šåˆ¶ç½‘ç»œå¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""å®šåˆ¶resnetåé¢çš„å±‚"""</span>
<span class="token keyword">def</span> <span class="token function">custom</span><span class="token punctuation">(</span>input_size<span class="token punctuation">,</span>num_classes<span class="token punctuation">,</span>pretrain<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># å¼•å…¥åˆå§‹åŒ–resnet50æ¨¡å‹</span>
    base_model <span class="token operator">=</span> ResNet50<span class="token punctuation">(</span>weights<span class="token operator">=</span>pretrain<span class="token punctuation">,</span>
                          include_top<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
                          pooling<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
                          input_shape<span class="token operator">=</span><span class="token punctuation">(</span>input_size<span class="token punctuation">,</span>input_size<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                          classes<span class="token operator">=</span>num_classes<span class="token punctuation">)</span>
    <span class="token comment">#ç”±äºæœ‰é¢„æƒé‡ï¼Œå‰éƒ¨åˆ†å†»ç»“ï¼Œåé¢è¿›è¡Œè¿ç§»å­¦ä¹ </span>
    <span class="token keyword">for</span> layer <span class="token keyword">in</span> base_model<span class="token punctuation">.</span>layers<span class="token punctuation">:</span>
        layer<span class="token punctuation">.</span>trainable <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token comment">#æ·»åŠ åé¢çš„å±‚</span>
    x <span class="token operator">=</span> base_model<span class="token punctuation">.</span>output
    x <span class="token operator">=</span> layers<span class="token punctuation">.</span>GlobalAveragePooling2D<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'avg_pool'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    x <span class="token operator">=</span> layers<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span>name<span class="token operator">=</span><span class="token string">'dropout1'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token comment">#regularizersæ­£åˆ™åŒ–å±‚ï¼Œæ­£åˆ™åŒ–å™¨å…è®¸åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­å¯¹å±‚çš„å‚æ•°æˆ–å±‚çš„æ¿€æ´»æƒ…å†µè¿›è¡Œæƒ©ç½š</span>
    <span class="token comment">#å¯¹æŸå¤±å‡½æ•°è¿›è¡Œæœ€å°åŒ–çš„åŒæ—¶ï¼Œä¹Ÿéœ€è¦è®©å¯¹å‚æ•°æ·»åŠ é™åˆ¶ï¼Œè¿™ä¸ªé™åˆ¶ä¹Ÿå°±æ˜¯æ­£åˆ™åŒ–æƒ©ç½šé¡¹ï¼Œä½¿ç”¨l2èŒƒæ•°</span>
    x <span class="token operator">=</span> layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">,</span>activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span>kernel_regularizer<span class="token operator">=</span> regularizers<span class="token punctuation">.</span>l2<span class="token punctuation">(</span><span class="token number">0.0001</span><span class="token punctuation">)</span><span class="token punctuation">,</span>name<span class="token operator">=</span><span class="token string">'fc2'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    x <span class="token operator">=</span> layers<span class="token punctuation">.</span>BatchNormalization<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'bn_fc_01'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    x <span class="token operator">=</span> layers<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span>name<span class="token operator">=</span><span class="token string">'dropout2'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token comment">#40ä¸ªåˆ†ç±»</span>
    x <span class="token operator">=</span> layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span>num_classes<span class="token punctuation">,</span>activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    model <span class="token operator">=</span> Model<span class="token punctuation">(</span>inputs<span class="token operator">=</span>base_model<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">,</span>outputs<span class="token operator">=</span>x<span class="token punctuation">)</span>
    <span class="token comment">#æ¨¡å‹ç¼–è¯‘</span>
    model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">"adam"</span><span class="token punctuation">,</span>loss <span class="token operator">=</span> <span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span>metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> model
</code></pre> 
<p>ç½‘ç»œçš„è®­ç»ƒæ˜¯è¿ç§»å­¦ä¹ è¿‡ç¨‹ï¼Œä½¿ç”¨å·²æœ‰çš„åˆå§‹resnet50æƒé‡ï¼ˆ5ä¸ªstageå·²ç»è®­ç»ƒè¿‡ï¼Œå·ç§¯å±‚å·²ç»èƒ½å¤Ÿæå–ç‰¹å¾ï¼‰ï¼Œæˆ‘ä»¬åªè®­ç»ƒåé¢çš„å…¨è¿æ¥å±‚éƒ¨åˆ†ï¼Œ4ä¸ªepochåå†å¯¹è¾ƒåé¢çš„å±‚è¿›è¡Œè®­ç»ƒå¾®è°ƒä¸€ä¸‹ï¼Œè·å¾—æ›´é«˜å‡†ç¡®ç‡ï¼Œè®­ç»ƒè¿‡ç¨‹å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">Net</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>img_size<span class="token punctuation">,</span>gar_num<span class="token punctuation">,</span>data_dir<span class="token punctuation">,</span>batch_size<span class="token punctuation">,</span>pretrain<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>img_size<span class="token operator">=</span>img_size
        self<span class="token punctuation">.</span>gar_num<span class="token operator">=</span>gar_num
        self<span class="token punctuation">.</span>data_dir<span class="token operator">=</span>data_dir
        self<span class="token punctuation">.</span>batch_size<span class="token operator">=</span>batch_size
        self<span class="token punctuation">.</span>pretrain<span class="token operator">=</span>pretrain

    <span class="token keyword">def</span> <span class="token function">build_train</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""è¿ç§»å­¦ä¹ """</span>
        model <span class="token operator">=</span> resnet<span class="token punctuation">.</span>custom<span class="token punctuation">(</span>self<span class="token punctuation">.</span>img_size<span class="token punctuation">,</span> self<span class="token punctuation">.</span>gar_num<span class="token punctuation">,</span> self<span class="token punctuation">.</span>pretrain<span class="token punctuation">)</span>
        model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>

        train_sequence<span class="token punctuation">,</span> validation_sequence <span class="token operator">=</span> genit<span class="token punctuation">.</span>gendata<span class="token punctuation">(</span>self<span class="token punctuation">.</span>data_dir<span class="token punctuation">,</span> self<span class="token punctuation">.</span>batch_size<span class="token punctuation">,</span> self<span class="token punctuation">.</span>gar_num<span class="token punctuation">,</span> self<span class="token punctuation">.</span>img_size<span class="token punctuation">)</span>

        epochs<span class="token operator">=</span><span class="token number">4</span>
        model<span class="token punctuation">.</span>fit_generator<span class="token punctuation">(</span>train_sequence<span class="token punctuation">,</span>steps_per_epoch<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>train_sequence<span class="token punctuation">)</span><span class="token punctuation">,</span>epochs<span class="token operator">=</span>epochs<span class="token punctuation">,</span>verbose<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>validation_data<span class="token operator">=</span>validation_sequence<span class="token punctuation">,</span>
                                     max_queue_size<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token comment">#å¾®è°ƒ,åœ¨å®é™…å·¥ç¨‹ä¸­ï¼Œæ¿€æ´»å‡½æ•°ä¹Ÿè¢«ç®—è¿›å±‚é‡Œï¼Œæ‰€ä»¥æ€»å…±181å±‚ï¼Œå¾®è°ƒæ˜¯ä¸ºäº†é‡æ–°è®­ç»ƒéƒ¨åˆ†å·ç§¯å±‚ï¼ŒåŒæ—¶è®­ç»ƒæœ€åçš„å…¨è¿æ¥å±‚</span>
        layers<span class="token operator">=</span><span class="token number">149</span>
        learning_rate<span class="token operator">=</span><span class="token number">1e-4</span>
        <span class="token keyword">for</span> layer <span class="token keyword">in</span> model<span class="token punctuation">.</span>layers<span class="token punctuation">[</span><span class="token punctuation">:</span>layers<span class="token punctuation">]</span><span class="token punctuation">:</span>
            layer<span class="token punctuation">.</span>trainable <span class="token operator">=</span> <span class="token boolean">False</span>
        <span class="token keyword">for</span> layer <span class="token keyword">in</span> model<span class="token punctuation">.</span>layers<span class="token punctuation">[</span>layers<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            layer<span class="token punctuation">.</span>trainable <span class="token operator">=</span> <span class="token boolean">True</span>
        Adam <span class="token operator">=</span>adam<span class="token punctuation">(</span>lr<span class="token operator">=</span>learning_rate<span class="token punctuation">,</span> decay<span class="token operator">=</span><span class="token number">0.0005</span><span class="token punctuation">)</span>
        model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span>Adam<span class="token punctuation">,</span> loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        model<span class="token punctuation">.</span>fit_generator<span class="token punctuation">(</span>train_sequence<span class="token punctuation">,</span>steps_per_epoch<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>train_sequence<span class="token punctuation">)</span><span class="token punctuation">,</span>epochs<span class="token operator">=</span>epochs <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>verbose<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
            callbacks<span class="token operator">=</span><span class="token punctuation">[</span>
                callbacks<span class="token punctuation">.</span>ModelCheckpoint<span class="token punctuation">(</span><span class="token string">'./models/garclass.h5'</span><span class="token punctuation">,</span>monitor<span class="token operator">=</span><span class="token string">'val_loss'</span><span class="token punctuation">,</span> save_best_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'min'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                callbacks<span class="token punctuation">.</span>ReduceLROnPlateau<span class="token punctuation">(</span>monitor<span class="token operator">=</span><span class="token string">'val_loss'</span><span class="token punctuation">,</span> factor<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span>patience<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'min'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                callbacks<span class="token punctuation">.</span>EarlyStopping<span class="token punctuation">(</span>monitor<span class="token operator">=</span><span class="token string">'val_loss'</span><span class="token punctuation">,</span> patience<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            validation_data<span class="token operator">=</span>validation_sequence<span class="token punctuation">,</span>max_queue_size<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'finish train,look for garclass.h5'</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_164"></a>æœ€å</h2>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2ceebca998e1bcedb65251a8ea054357/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">CentOS 7.6ä¸‹çš„HTTPéš§é“ä»£ç†é…ç½®è¯¦è§£</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a5dfb9f614206bf4734e0293e6fe4f6c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">ã€Šè½¯ä»¶é¡¹ç›®æ¥å£å®‰å…¨è®¾è®¡è§„èŒƒã€‹</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ITå­¦ä¹ è€…åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>