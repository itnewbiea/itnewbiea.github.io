<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python中文地址映射省市县行政区域及经纬度解析 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python中文地址映射省市县行政区域及经纬度解析" />
<meta property="og:description" content="面对这样的需求 从下面地址详情中提取其所在行政区域（省、市、县/区 ），切分为右边表格的形式。
地址详情映射后地址信息详细地址省市县/区详细地址平罗县御景安家25-1-102宁夏回族自治区石嘴山市平罗县御景安家25-1-102达州渠县渠江镇珠山村一组57号四川省达州市渠县渠江镇珠山村一组57号兴庆区在水一方C区5-3-101宁夏回族自治区银川市兴庆区在水一方C区5-3-101成都市武侯区佳灵路九峰家园2栋四川省成都市武侯区佳灵路九峰家园2栋大田县集美路21号福建省三明市大田县集美路21号邢台桥东区高开东汪镇西静庵村河北省邢台市桥东区高开东汪镇西静庵村 方法一 pip install cpca 原理是通过jieba工具先对详细地址做分词，再将结果分段对比行政地区域地址库，代码如下：
import cpca area_str = [&#34;平罗县御景安家25-1-102&#34;] df_str = cpca.transform(area_str ) df_str 结果展示：
省 市 区 地址宁夏回族自治区 石嘴山市 平罗县 御景安家25-1-102 经纬度解析 cpca.latlng 以字典的形式将全国的行政区域经纬度保存（如下图：）
我们直接从该字典中查询行政区域对应的经纬度即可（如下：）
cpca.latlng[&#39;北京市&#39;, &#39;北京市&#39;, &#39;西城区&#39;] 结果：(&#39;39.93428014370851&#39;, &#39;116.37319010401802&#39;) 另一种类似的方法也可以解析地址经纬度（如下：）
方法二 pip install chinese_province_city_area_mapper 原理与方法相似，但在使用过程要比方法一更上手，很多拼写不全的地址用方法二都可以映射正确的省市县。实验以下地址的时候使用方法一解析失败，使用方法二解析成功，如下：
from chinese_province_city_area_mapper.transformer import CPCATransformer Ca = CPCATransformer() Ca.transform([&#39;湖南省株洲县朱亭镇水口村跃进组12号&#39;, &#39;青海省海东地区乐都县高庙镇白崖子村42号&#39;, &#39;湖南省株洲县渌口镇凯裕名城B栋4单元301 &#39;]) 使用chinese_province_city_area_mapper解析结果：
使用cpca解析结果：
只有市级和市级以下的行政区域存在重名的情况，例如中国有很多城市的区叫“朝阳区” ,如果详细地址中没有别的地址描述的话系统是不知道应该映射到哪个“朝阳区”，所以我们需要为一些市区指定默认所属省。
有两种方式指定默认值：
# 方法一：直接通过 CPCATransformer 指定 cpca = CPCATransformer({&#34;朝阳区&#34;:&#34;北京市&#34;}) df = cpca.transform(location_str) # 方法二：通过内置模块 umap 调用默认地址字典 from chinese_province_city_area_mapper import myumap cpca = CPCATransformer(myumap." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/61e6cbb9c31158689fe499b711e765f1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-10-12T18:01:50+08:00" />
<meta property="article:modified_time" content="2019-10-12T18:01:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python中文地址映射省市县行政区域及经纬度解析</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 id="%E9%9D%A2%E5%AF%B9%E8%BF%99%E6%A0%B7%E7%9A%84%E9%9C%80%E6%B1%82">面对这样的需求</h3> 
<p>从下面地址详情中提取其所在行政区域（省、市、县/区 ），切分为右边表格的形式。</p> 
<table cellspacing="0"><tbody><tr><td style="text-align:center;vertical-align:middle;width:352pt;"><span style="color:#000000;">地址详情</span></td><td colspan="4" style="text-align:center;vertical-align:middle;width:382pt;"><span style="color:#000000;">映射后地址信息</span></td></tr><tr><td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">详细地址</span></td><td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">省</span></td><td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">市</span></td><td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">县/区</span></td><td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">详细地址</span></td></tr><tr><td style="text-align:center;vertical-align:bottom;"><span style="color:#000000;">平罗县御景安家25-1-102</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">宁夏回族自治区</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">石嘴山市</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">平罗县</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">御景安家25-1-102</span></td></tr><tr><td style="text-align:center;vertical-align:bottom;"><span style="color:#000000;">达州渠县渠江镇珠山村一组57号</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">四川省</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">达州市</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">渠县</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">渠江镇珠山村一组57号</span></td></tr><tr><td style="text-align:center;vertical-align:bottom;"><span style="color:#000000;">兴庆区在水一方C区5-3-101</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">宁夏回族自治区</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">银川市</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">兴庆区</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">在水一方C区5-3-101</span></td></tr><tr><td style="text-align:center;vertical-align:bottom;"><span style="color:#000000;">成都市武侯区佳灵路九峰家园2栋</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">四川省</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">成都市</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">武侯区</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">佳灵路九峰家园2栋</span></td></tr><tr><td style="text-align:center;vertical-align:bottom;"><span style="color:#000000;">大田县集美路21号</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">福建省</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">三明市</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">大田县</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">集美路21号</span></td></tr><tr><td style="text-align:center;vertical-align:bottom;"><span style="color:#000000;">邢台桥东区高开东汪镇西静庵村</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">河北省</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">邢台市</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">桥东区</span></td><td style="vertical-align:bottom;"><span style="color:#000000;">高开东汪镇西静庵村</span></td></tr></tbody></table> 
<p> </p> 
<h4 id="%E5%AF%BC%E5%85%A5%E6%A8%A1%E5%9D%97">方法一</h4> 
<pre class="has"><code class="language-python">pip install cpca</code></pre> 
<p>    原理是通过jieba工具先对详细地址做分词，再将结果分段对比行政地区域地址库，代码如下：</p> 
<pre class="has"><code class="language-python">import cpca
area_str = ["平罗县御景安家25-1-102"]
df_str = cpca.transform(area_str )
df_str
</code></pre> 
<p><strong>结果展示：</strong></p> 
<table cellspacing="0" style="width:537px;"><tbody><tr><td style="text-align:center;vertical-align:middle;width:138px;"><span style="color:#000000;">省</span></td><td style="text-align:center;vertical-align:middle;width:98px;"><span style="color:#000000;">   市</span></td><td style="text-align:center;vertical-align:middle;width:97px;"><span style="color:#000000;">     区</span></td><td style="text-align:center;vertical-align:middle;width:203px;"><span style="color:#000000;">  地址</span></td></tr><tr><td style="text-align:center;vertical-align:middle;width:138px;"><span style="color:#000000;">宁夏回族自治区  </span></td><td style="text-align:center;vertical-align:middle;width:98px;"><span style="color:#000000;">石嘴山市</span></td><td style="text-align:center;vertical-align:middle;width:97px;"><span style="color:#000000;">  平罗县 </span></td><td style="text-align:center;vertical-align:middle;width:203px;"><span style="color:#000000;">御景安家25-1-102</span></td></tr></tbody></table> 
<h4>经纬度解析</h4> 
<p>cpca.latlng 以字典的形式将全国的行政区域经纬度保存（如下图：）</p> 
<p>                   <img alt="" class="has" height="615" src="https://images2.imgbox.com/93/60/K4ROq17j_o.png" width="643"></p> 
<p>我们直接从该字典中查询行政区域对应的经纬度即可（如下：）</p> 
<pre class="has"><code class="language-python">cpca.latlng['北京市', '北京市', '西城区']

结果：('39.93428014370851', '116.37319010401802')</code></pre> 
<p>另一种类似的方法也可以解析地址经纬度（如下：）</p> 
<h4>方法二</h4> 
<pre class="has"><code class="language-python">pip install chinese_province_city_area_mapper</code></pre> 
<p> 原理与方法相似，但在使用过程要比方法一更上手，很多拼写不全的地址用方法二都可以映射正确的省市县。实验以下地址的时候使用方法一解析失败，使用方法二解析成功，如下：</p> 
<pre class="has"><code class="language-python">from chinese_province_city_area_mapper.transformer import CPCATransformer
Ca = CPCATransformer()
Ca.transform(['湖南省株洲县朱亭镇水口村跃进组12号',
              '青海省海东地区乐都县高庙镇白崖子村42号',
              '湖南省株洲县渌口镇凯裕名城B栋4单元301
'])</code></pre> 
<p>使用chinese_province_city_area_mapper解析结果：</p> 
<p>                                                      <img alt="" class="has" height="116" src="https://images2.imgbox.com/55/68/9Tw7kESY_o.png" width="170"></p> 
<p>使用cpca解析结果：</p> 
<p>                                     <img alt="" class="has" height="121" src="https://images2.imgbox.com/64/0e/wSjCjZqc_o.png" width="327"></p> 
<p> </p> 
<p>只有市级和市级以下的行政区域存在重名的情况，例如中国有很多城市的区叫“朝阳区” ,如果详细地址中没有别的地址描述的话系统是不知道应该映射到哪个“朝阳区”，所以我们需要为一些市区指定默认所属省。</p> 
<p>有两种方式指定默认值：</p> 
<pre class="has"><code class="language-python"># 方法一：直接通过 CPCATransformer 指定
cpca = CPCATransformer({"朝阳区":"北京市"})
df = cpca.transform(location_str)

# 方法二：通过内置模块 umap 调用默认地址字典
from chinese_province_city_area_mapper import myumap
cpca = CPCATransformer(myumap.umap)
df = cpca.transform(location_str)
</code></pre> 
<p>打印myumap.umap ,结果如下 ：</p> 
<pre class="has"><code class="language-python">{'南关区': '长春市', '南山区': '深圳市', '宝山区': '上海市', '市辖区': '东莞市', 
'普陀区': '上海市', '朝阳区': '北京市', '河东区': '天津市', '白云区': '广州市', 
'西湖区': '杭州市', '铁西区': '沈阳市'}</code></pre> 
<p> </p> 
<p>   对经纬度的解析结果大体相当，代码如下：</p> 
<pre class="has"><code class="language-python">from chinese_province_city_area_mapper.infrastructure import SuperMap
SuperMap.lat_lon_mapper.get("北京市,北京市,朝阳区")
结果：(39.92, 116.43)</code></pre> 
<p>   绘图功能，两行代码完成：</p> 
<pre class="has"><code># 绘制城市热力地图
from chinese_province_city_area_mapper import drawers
drawers.draw_locations(DF, "df.html")</code></pre> 
<p><img alt="" class="has" height="706" src="https://images2.imgbox.com/ac/7c/trSlKqwA_o.png" width="1173"></p> 
<p> </p> 
<p>chinese_province_city_area_mapper  模块还有其他功能模块，例如 SuperMap模块简要介绍如下：</p> 
<pre class="has"><code class="language-python">from chinese_province_city_area_mapper.infrastructure import SuperMap
#地区到市的映射数据库，是一个字典类型（key为区名，value为其所属的市名），注意其中包含重复的区名
SuperMap.area_city_mapper
#重复的区名列表，列表类型，如果区名在这个列表中，则area_city_mapper的映射是不准确的
SuperMap.rep_areas
#市到省的映射数据库，字典类型（key为市的名称，value为省的名称）
SuperMap.city_province_mapper
#全国省市区的经纬度数据库，字典类型（key为"省,市,区",value为(维度,经度)）
SuperMap.lat_lon_mapper
#获取北京市朝阳区的经纬度
SuperMap.lat_lon_mapper.get("北京市,北京市,朝阳区")</code></pre> 
<p> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8c9b3837f9354b98c767e743833b13cf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">使input文本框不可编辑的3种方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8749f824086e126236db6c959d86c420/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">提示“The connected J-Link is defective,Proper operation cannot be guaranteed.”解决办法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>