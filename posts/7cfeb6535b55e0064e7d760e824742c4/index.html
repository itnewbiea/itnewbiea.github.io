<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CentOS 7.6一键安装 nginx及生产跨域配置 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CentOS 7.6一键安装 nginx及生产跨域配置" />
<meta property="og:description" content="1.运行一键安装命令 yum install -y make cmake gcc gcc-c&#43;&#43; pcre pcre-devel zlib zlib-devel openssl openssl-devel &amp;&amp; wget http://nginx.org/download/nginx-1.12.2.tar.gz &amp;&amp; tar zxvf nginx-1.12.2.tar.gz &amp;&amp; cd nginx-1.12.2 &amp;&amp; ./configure --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-file-aio --with-http_realip_module &amp;&amp; make &amp;&amp; make install &amp;&amp; ln -s /usr/local/nginx/sbin/nginx /usr/bin/nginx
2.默认安装路径 /usr/local/nginx/sbin/nginx
3.启动 #启动 #1.直接启动 #进入nginx目录，执行启动命令 cd /usr/local/nginx/sbin ./nginx # 或者直接 /usr/local/nginx/sbin/nginx #2.指定配置文件方式启动 #进入nginx目录，执行启动命令 cd /usr/local/nginx/sbin ./nginx -c /usr/local/nginx/conf/nginx.conf #或者 /usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf 4.检查nginx配置文件 #进入nginx目录 cd /usr/local/nginx/sbin #检查配置文件是否有语法操作 ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/7cfeb6535b55e0064e7d760e824742c4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-08T19:07:41+08:00" />
<meta property="article:modified_time" content="2023-06-08T19:07:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CentOS 7.6一键安装 nginx及生产跨域配置</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1_0"></a>1.运行一键安装命令</h3> 
<p>yum install -y make cmake gcc gcc-c++ pcre pcre-devel zlib zlib-devel openssl openssl-devel &amp;&amp; wget http://nginx.org/download/nginx-1.12.2.tar.gz &amp;&amp; tar zxvf nginx-1.12.2.tar.gz &amp;&amp; cd nginx-1.12.2 &amp;&amp; ./configure --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-file-aio --with-http_realip_module &amp;&amp; make &amp;&amp; make install &amp;&amp; ln -s /usr/local/nginx/sbin/nginx /usr/bin/nginx</p> 
<h3><a id="2_4"></a>2.默认安装路径</h3> 
<p>/usr/local/nginx/sbin/nginx</p> 
<h3><a id="3_7"></a>3.启动</h3> 
<pre><code class="prism language-python"><span class="token comment">#启动</span>
<span class="token comment">#1.直接启动</span>
<span class="token comment">#进入nginx目录，执行启动命令</span>
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin
<span class="token punctuation">.</span><span class="token operator">/</span>nginx
<span class="token comment"># 或者直接</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin<span class="token operator">/</span>nginx
<span class="token comment">#2.指定配置文件方式启动</span>
<span class="token comment">#进入nginx目录，执行启动命令</span>
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin
<span class="token punctuation">.</span><span class="token operator">/</span>nginx <span class="token operator">-</span>c <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf
<span class="token comment">#或者</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin<span class="token operator">/</span>nginx <span class="token operator">-</span>c <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf

</code></pre> 
<h3><a id="4nginx_26"></a>4.检查nginx配置文件</h3> 
<pre><code class="prism language-python"><span class="token comment">#进入nginx目录</span>
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin
<span class="token comment">#检查配置文件是否有语法操作</span>
<span class="token punctuation">.</span><span class="token operator">/</span>nginx <span class="token operator">-</span>t
<span class="token comment"># 或者显示指定配置文件</span>
<span class="token punctuation">.</span><span class="token operator">/</span>nginx <span class="token operator">-</span>t <span class="token operator">-</span>c <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf

</code></pre> 
<h3><a id="5_38"></a>5.平滑的重启，修改配置后，重新加载配置</h3> 
<pre><code class="prism language-python"><span class="token comment">#进入nginx目录</span>
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin
<span class="token comment">#执行重载命令</span>
<span class="token punctuation">.</span><span class="token operator">/</span>nginx <span class="token operator">-</span>s <span class="token builtin">reload</span>

</code></pre> 
<h3><a id="6nginx_48"></a>6.关闭nginx</h3> 
<pre><code class="prism language-python"><span class="token comment">#进入nginx目录</span>
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin
<span class="token comment"># 快速停止nginx</span>
<span class="token punctuation">.</span><span class="token operator">/</span>nginx <span class="token operator">-</span>s stop
<span class="token comment"># 完整有序的停止nginx，这个命令会等待所有请求结束后再关闭nginx</span>
<span class="token punctuation">.</span><span class="token operator">/</span>nginx <span class="token operator">-</span>s quit

</code></pre> 
<h3><a id="7reopen_60"></a>7.reopen重新打开日志文件</h3> 
<pre><code class="prism language-python"><span class="token comment">#进入nginx目录</span>
cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin
<span class="token comment"># 重新打开日志文件</span>
<span class="token punctuation">.</span><span class="token operator">/</span>nginx <span class="token operator">-</span>s reopen

</code></pre> 
<h3><a id="8nginx_70"></a>8.其他命令重启、关闭nginx</h3> 
<pre><code class="prism language-python"><span class="token comment"># 查看进程号，下图  master的为主进程号</span>
ps <span class="token operator">-</span>ef <span class="token operator">|</span> grep nginx
<span class="token comment">#从容停止Nginx</span>
kill <span class="token operator">-</span>QUIT 主进程号
<span class="token comment">#快速停止Nginx</span>
kill <span class="token operator">-</span>TERM 主进程号
<span class="token comment">#强制停止Nginx</span>
pkill <span class="token operator">-</span><span class="token number">9</span> nginx
<span class="token comment">#平滑重启nginx：</span>
kill <span class="token operator">-</span>HUP 主进程号

</code></pre> 
<h3><a id="8_Nginx_86"></a>8. Nginx动静分离(静态资源和动态资源来自于不同的服务器)</h3> 
<p>后端服务器集群是动态数据的来源，nginx作为http服务器代理用来管理后端所需文件和静态资源，在nginx服务器中，准备好访问的静态资源可以通过域名url地址访问。<br> 添加server案例(以Linux系统为例)</p> 
<pre><code class="prism language-xml">       server{

              listen 80;

              server_name www.image.com;#这里填写域名即可绑定域名

              location /{

                     root /home/static; #关键字root配置项为静态资源的根目录

                     index default.html #没有找到指定静态资源时默认访问的静态资源

              }

        }

</code></pre> 
<p><strong>具体流转过程如下</strong>：请求地址http://www.image.com/xyy.png匹配server中的location后将静态资源名称tp.png衔接在root配置项后，拼接成资源在Nginx服务器上的绝对地址/home/static/tp.png根据地址拿到静态资源返回到浏览器页面给用户展示。</p> 
<p><strong>root配置项</strong>：可以是文件夹绝对路径，如Linux (root /home/static)、Windows(root C:/static)。也可以是文件夹相对路径root static(表示在nginx安装的根目录有一个文件夹叫做static)。</p> 
<p><strong>index配置项</strong>：表示当访问请求匹配到location中的root后，在没有找到指定静态资源时默认访问的静态资源地址。index也可以配置多个静态资源，例如：index default1.html default2.html。如果静态资源/home/static/default1.html不存在则接着验证/home/static/default2.html是否存在，存在则用/default2.html在该server中发起内部重定向去重新匹配location)</p> 
<h3><a id="9_115"></a>9.生产跨域配置</h3> 
<p>proxy_pass</p> 
<p>既是把请求代理到其他主机，其中 http://www.b.com/ 写法和 http://www.b.com写法的区别如下:</p> 
<p>不带/</p> 
<pre><code class="prism language-handlebars"><span class="token variable">location</span> <span class="token punctuation">/</span><span class="token variable">html</span><span class="token punctuation">/</span>
<span class="token punctuation">{<!-- --></span>
　　<span class="token variable">proxy_pass</span> <span class="token variable">http</span><span class="token punctuation">:</span> <span class="token punctuation">/</span><span class="token punctuation">/</span><span class="token variable">b</span><span class="token punctuation">.</span><span class="token variable">com</span><span class="token punctuation">:</span><span class="token number">8300</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre> 
<p>带/</p> 
<pre><code class="prism language-handlebars"><span class="token variable">location</span> <span class="token punctuation">/</span><span class="token variable">html</span><span class="token punctuation">/</span> 
<span class="token punctuation">{<!-- --></span> 
     <span class="token variable">proxy_pass</span> <span class="token variable">http</span><span class="token punctuation">:</span> <span class="token punctuation">/</span><span class="token punctuation">/</span><span class="token variable">b</span><span class="token punctuation">.</span><span class="token variable">com</span><span class="token punctuation">:</span><span class="token number">8300</span><span class="token block keyword">/;</span> 
<span class="token punctuation">}</span>
</code></pre> 
<p>上面两种配置，区别只在于proxy_pass转发的路径后是否带 “/”。</p> 
<p>针对情况1，如果访问url = http://server/html/test.jsp，则被nginx代理后，请求路径会便问http://proxy_pass/html/test.jsp，将test/ 作为根路径，请求test/路径下的资源。</p> 
<p>针对情况2，如果访问url = http://server/html/test.jsp，则被nginx代理后，请求路径会变为 http://proxy_pass/test.jsp，直接访问server的根资源。</p> 
<p>修改配置后重启nginx代理就成功了。</p> 
<h3><a id="vuecli_modehistory_146"></a>额外问题vue-cli 路由使用mode:"history"模式出错，请问是什么原因？</h3> 
<p>问题：nginx部署后使用项目history后对页面进行刷新后会显示nginx404页面<br> 解决:nginx 配置下添加以下代码</p> 
<pre><code>location / {
  try_files $uri $uri/ /index.html;
}
</code></pre> 
<p>参考链接：<a href="https://segmentfault.com/q/1010000013191212" rel="nofollow">参考链接</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/08a599b67bd56e3fdf2fb3008521eda2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Diverse Embedding Expansion Network and Low-Light Cross-Modality Benchmark for V-I Re-ID:如何有效利用生成嵌入？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a455871d0c97872c577f51f93e2017cf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">list列表删除元素的方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>