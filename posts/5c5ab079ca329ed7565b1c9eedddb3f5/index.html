<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python开发photoshop将图片导出为tiff - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python开发photoshop将图片导出为tiff" />
<meta property="og:description" content="python开发photoshop将图片导出为tiff # -*- coding:utf-8 -*- # @Time : 2022/5/7 15:50 # @Author : xuyongsai # @Email : 1815222521@qq.com # @File : PhotoShop.py # @Software: PyCharm # @Version : 1.0 import os import sys reload(sys) sys.setdefaultencoding(&#39;utf8&#39;) from comtypes.client import CreateObject class pdfConverter: def __init__(self): # word文档转化为pdf文档时使用的格式为17 # self.wdFormatPDF = 17 # self.wdToPDF = CreateObject(&#34;Word.Application&#34;) # ppt文档转化为pdf文档时使用的格式为32 # self.pptFormatPDF = 32 # self.pptToPDF = CreateObject(&#34;Powerpoint.Application&#34;) # self.pptToPDF.Visible = 1 # ppt文档转化为pdf文档时使用的格式为32 self." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/5c5ab079ca329ed7565b1c9eedddb3f5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-09T18:19:15+08:00" />
<meta property="article:modified_time" content="2022-05-09T18:19:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python开发photoshop将图片导出为tiff</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="pythonphotoshoptiff_0"></a>python开发photoshop将图片导出为tiff</h3> 
<pre><code class="prism language-python"><span class="token comment"># -*- coding:utf-8 -*-</span>
<span class="token comment"># @Time    : 2022/5/7 15:50</span>
<span class="token comment"># @Author  : xuyongsai</span>
<span class="token comment"># @Email   : 1815222521@qq.com</span>
<span class="token comment"># @File    : PhotoShop.py</span>
<span class="token comment"># @Software: PyCharm</span>
<span class="token comment"># @Version : 1.0</span>
<span class="token keyword">import</span> os
<span class="token keyword">import</span> sys
<span class="token builtin">reload</span><span class="token punctuation">(</span>sys<span class="token punctuation">)</span>
sys<span class="token punctuation">.</span>setdefaultencoding<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> comtypes<span class="token punctuation">.</span>client <span class="token keyword">import</span> CreateObject
<span class="token keyword">class</span> <span class="token class-name">pdfConverter</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># word文档转化为pdf文档时使用的格式为17</span>
        <span class="token comment"># self.wdFormatPDF = 17</span>
        <span class="token comment"># self.wdToPDF = CreateObject("Word.Application")</span>
        <span class="token comment"># ppt文档转化为pdf文档时使用的格式为32</span>
        <span class="token comment"># self.pptFormatPDF = 32</span>
        <span class="token comment"># self.pptToPDF = CreateObject("Powerpoint.Application")</span>
        <span class="token comment"># self.pptToPDF.Visible = 1</span>
        <span class="token comment"># ppt文档转化为pdf文档时使用的格式为32</span>

        self<span class="token punctuation">.</span>jpgToTiff <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">"Photoshop.Application"</span><span class="token punctuation">)</span>

    <span class="token comment"># def wd_to_pdf(self, folder):</span>
    <span class="token comment">#     # 获取指定目录下面的所有文件</span>
    <span class="token comment">#     files = os.listdir(folder)</span>
    <span class="token comment">#     # 获取word类型的文件放到一个列表里面</span>
    <span class="token comment">#     wdfiles = [f for f in files if f.endswith((".doc", ".docx"))]</span>
    <span class="token comment">#     for wdfile in wdfiles:</span>
    <span class="token comment">#         # 将word文件放到指定的路径下面</span>
    <span class="token comment">#         wdPath = os.path.join(folder, wdfile)</span>
    <span class="token comment">#         # 设置将要存放pdf文件的路径</span>
    <span class="token comment">#         pdfPath = wdPath</span>
    <span class="token comment">#         # 判断是否已经存在对应的pdf文件，如果不存在就加入到存放pdf的路径内</span>
    <span class="token comment">#         if pdfPath[-3:] != 'pdf':</span>
    <span class="token comment">#             pdfPath = pdfPath + ".pdf"</span>
    <span class="token comment">#         # 将word文档转化为pdf文件，先打开word所在路径文件，然后在处理后保存pdf文件，最后关闭</span>
    <span class="token comment">#         pdfCreate = self.wdToPDF.Documents.Open(wdPath)</span>
    <span class="token comment">#         pdfCreate.SaveAs(pdfPath, self.wdFormatPDF)</span>
    <span class="token comment">#         pdfCreate.Close()</span>
    <span class="token comment">#</span>
    <span class="token comment"># def ppt_to_pdf(self, folder):</span>
    <span class="token comment">#     files = os.listdir(folder)</span>
    <span class="token comment">#     pptfiles = [f for f in files if f.endswith((".ppt", ".pptx"))]</span>
    <span class="token comment">#     for pptfile in pptfiles:</span>
    <span class="token comment">#         pptPath = os.path.join(folder, pptfile)</span>
    <span class="token comment">#         pdfPath = pptPath</span>
    <span class="token comment">#         if pdfPath[-3:] != 'pdf':</span>
    <span class="token comment">#             pdfPath = pdfPath + ".pdf"</span>
    <span class="token comment">#         pdfCreate = self.pptToPDF.Presentations.Open(pptPath)</span>
    <span class="token comment">#         pdfCreate.SaveAs(pdfPath, self.pptFormatPDF)</span>
    <span class="token comment">#         pdfCreate.Close()</span>

    <span class="token keyword">def</span> <span class="token function">jpg_to_tiff</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> folder<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            listAllFile <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> root<span class="token punctuation">,</span> dirs<span class="token punctuation">,</span> files <span class="token keyword">in</span> os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span>folder<span class="token punctuation">,</span> topdown<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> name <span class="token keyword">in</span> files<span class="token punctuation">:</span>
                    <span class="token keyword">if</span> name<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">".jpg"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>
                        listAllFile<span class="token punctuation">.</span>append<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> pptfile <span class="token keyword">in</span> listAllFile<span class="token punctuation">:</span>
                pdfPath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>pptfile<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                <span class="token keyword">if</span> pdfPath<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'tiff'</span><span class="token punctuation">:</span>
                    pdfPath <span class="token operator">=</span> pdfPath <span class="token operator">+</span> <span class="token string">".tiff"</span>
                tiffSaveOptions <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">"Photoshop.TiffSaveOptions"</span><span class="token punctuation">)</span>
                pdfCreate <span class="token operator">=</span> self<span class="token punctuation">.</span>jpgToTiff<span class="token punctuation">.</span>Open<span class="token punctuation">(</span>pptfile<span class="token punctuation">)</span>
                pdfCreate<span class="token punctuation">.</span>SaveAs<span class="token punctuation">(</span>pdfPath<span class="token punctuation">,</span> tiffSaveOptions<span class="token punctuation">)</span>
                pdfCreate<span class="token punctuation">.</span>Close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"seccess"</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">addAllTiff</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> folderPath <span class="token punctuation">,</span> SavePath<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment">#合并图片的最大宽度作为合并文档的宽度</span>
            maxWidth <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token comment">#合并图片的高度和作为合并文档的高度</span>
            totalHeight <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token comment">#遍历文件夹下所有的文件</span>
            listAllFile <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> root<span class="token punctuation">,</span> dirs<span class="token punctuation">,</span> files <span class="token keyword">in</span> os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span>folderPath<span class="token punctuation">,</span> topdown<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> name <span class="token keyword">in</span> files<span class="token punctuation">:</span>
                    <span class="token keyword">if</span> name<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">".tif"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                       <span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>
                       listAllFile<span class="token punctuation">.</span>append<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> pptfile <span class="token keyword">in</span> listAllFile<span class="token punctuation">:</span>
                <span class="token comment">#filepath = os.path.join(folderPath, pptfile)</span>
                doc <span class="token operator">=</span> self<span class="token punctuation">.</span>jpgToTiff<span class="token punctuation">.</span>Open<span class="token punctuation">(</span>pptfile<span class="token punctuation">)</span>
                totalHeight <span class="token operator">+=</span> doc<span class="token punctuation">.</span>height
                <span class="token keyword">if</span> doc<span class="token punctuation">.</span>width <span class="token operator">&gt;</span> maxWidth<span class="token punctuation">:</span>
                    maxWidth <span class="token operator">=</span> doc<span class="token punctuation">.</span>width
                    doc<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">#创建一个新的文档保存合并之后的图片</span>
            newDoc <span class="token operator">=</span> self<span class="token punctuation">.</span>jpgToTiff<span class="token punctuation">.</span>documents<span class="token punctuation">.</span>add<span class="token punctuation">(</span>maxWidth<span class="token punctuation">,</span> totalHeight<span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token string">"mytiff"</span><span class="token punctuation">)</span>
            nextTop <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">for</span> pptfile <span class="token keyword">in</span> listAllFile<span class="token punctuation">:</span>
                doc1 <span class="token operator">=</span> self<span class="token punctuation">.</span>jpgToTiff<span class="token punctuation">.</span>Open<span class="token punctuation">(</span>pptfile<span class="token punctuation">)</span>
                <span class="token comment">#复制打开的图层</span>
                doc1<span class="token punctuation">.</span>activeLayer<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">#设置新建的文档作为激活文档</span>
                self<span class="token punctuation">.</span>jpgToTiff<span class="token punctuation">.</span>activeDocument <span class="token operator">=</span> newDoc
                <span class="token comment">#粘贴刚才拷贝的图层到激活的文档</span>
                self<span class="token punctuation">.</span>jpgToTiff<span class="token punctuation">.</span>activeDocument<span class="token punctuation">.</span>paste<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">#获取激活文档的图层边界</span>
                bounds <span class="token operator">=</span> self<span class="token punctuation">.</span>jpgToTiff<span class="token punctuation">.</span>activeDocument<span class="token punctuation">.</span>activeLayer<span class="token punctuation">.</span>bounds
                <span class="token keyword">if</span> <span class="token punctuation">(</span>nextTop <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>jpgToTiff<span class="token punctuation">.</span>activeDocument<span class="token punctuation">.</span>activeLayer<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token operator">-</span> bounds<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>jpgToTiff<span class="token punctuation">.</span>activeDocument<span class="token punctuation">.</span>activeLayer<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> nextTop <span class="token operator">-</span> bounds<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                nextTop <span class="token operator">+=</span> bounds<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> bounds<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
                doc1<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">#创建保存Tiff的属性对象</span>
            tiffSaveoptions <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">"Photoshop.TiffSaveOptions"</span><span class="token punctuation">)</span>
            newDoc<span class="token punctuation">.</span>SaveAs<span class="token punctuation">(</span>SavePath<span class="token punctuation">,</span> tiffSaveoptions<span class="token punctuation">)</span>
            <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"seccess"</span><span class="token punctuation">)</span>
            newDoc<span class="token punctuation">.</span>Close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">del</span> listAllFile
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    converter <span class="token operator">=</span> pdfConverter<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">#converter.jpg_to_tiff((r"C:\Users\Administrator\Desktop\ee").decode("utf-8"))</span>
    converter<span class="token punctuation">.</span>addAllTiff<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">r"C:\Users\Administrator\Desktop\ee"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">r"C:\Users\Administrator\Desktop\er\q.tif"</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/32c70c98d018e912d4d12ee15cee0aa5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Jenkins&#43;Jmeter&#43;Ant 生成接口测试报告并发送邮件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b34e2a6fde0623c574a8e89ff4f458a6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Javascript基础</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>