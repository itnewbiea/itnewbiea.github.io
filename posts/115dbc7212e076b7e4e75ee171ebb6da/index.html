<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>linux中的 IO端口映射和IO内存映射 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="linux中的 IO端口映射和IO内存映射" />
<meta property="og:description" content="CPU地址空间 （一）地址的概念 1）物理地址：CPU地址总线传来的地址，由硬件电路控制其具体含义。物理地址中很大一部分是留给内存条中的内存的，但也常被映射到其他存储器上 （如显存、BIOS等）。在程序指令中的虚拟地址经过段映射和页面映射后，就生成了物理地址，这个物理地址被放到CPU的地址线上。 物理地址空间，一部分给物理RAM（内存）用，一部分给总线用，这是由硬件设计来决定的，因此在32 bits地址线的x86处理器中，物理地址空间是2的32次方，即4GB，但物理RAM一般不能上到4GB，因为还有一部分要给总线用（总线上还挂着别的 许多设备）。在PC机中，一般是把低端物理地址给RAM用，高端物理地址给总线用。 2）总线地址：总线的地址线或在地址周期上产生的信号。外设使用的是总线地址，CPU使用的是物理地址。 物理地址与总线地址之间的关系由系统的设计决定的。在x86平台上，物理地址就是总线地址，这是因为它们共享相同的地址空间——这句话有点难理解，详见下 面的“独立编址”。在其他平台上，可能需要转换/映射。比如：CPU需要访问物理地址是0xfa000的单元，那么在x86平台上，会产生一个PCI总线 上对0xfa000地址的访问。因为物理地址和总线地址相同，所以凭眼睛看是不能确定这个地址是用在哪儿的，它或者在内存中，或者是某个卡上的存储单元， 甚至可能这个地址上没有对应的存储器。
（二）编址方式 1）外设都是通过读写设备上的寄存器来进行的，外设寄存器也称为“I/O端口”，而IO端口有两种编址方式：独立编址和统一编制。 统一编址：外设接口中的IO寄存器（即IO端口）与主存单元一样看待，每个端口占用一个存储单元的地址，将主存的一部分划出来用作IO地址空间，如，在 PDP-11中，把最高的4K主存作为IO设备寄存器地址。端口占用了存储器的地址空间，使存储量容量减小。 统一编址也称为“I/O内存”方式，外设寄存器位于“内存空间”（很多外设有自己的内存、缓冲区，外设的寄存器和内存统称“I/O空间”）。 如，Samsung的S3C2440，是32位ARM处理器，它的4GB地址空间被外设、RAM等瓜分： 0x8000 1000 LED 8*8点阵的地址 0x4800 0000 ~ 0x6000 0000 SFR（特殊暂存器）地址空间 0x3800 1002 键盘地址 0x3000 0000 ~ 0x3400 0000 SDRAM空间 0x2000 0020 ~ 0x2000 002e IDE 0x1900 0300 CS8900 独立编址（单独编址）：IO地址与存储地址分开独立编址，I/0端口地址不占用存储空间的地址范围，这样，在系统中就存在了另一种与存储地址无关的IO地 址，CPU也必须具有专用与输入输出操作的IO指令（IN、OUT等）和控制逻辑。独立编址下，地址总线上过来一个地址，设备不知道是给IO端口的、还是 给存储器的，于是处理器通过MEMR/MEMW和IOR/IOW两组控制信号来实现对I/O端口和存储器的不同寻址。如，intel 80x86就采用单独编址，CPU内存和I/O是一起编址的，就是说内存一部分的地址和I/O地址是重叠的。 独立编址也称为“I/O端口”方式，外设寄存器位于“I/O（地址）空间”。 对于x86架构来说，通过IN/OUT指令访问。PC架构一共有65536个8bit的I/O端口，组成64K个I/O地址空间，编号从 0~0xFFFF，有16位，80x86用低16位地址线A0-A15来寻址。连续两个8bit的端口可以组成一个16bit的端口，连续4个组成一个 32bit的端口。I/O地址空间和CPU的物理地址空间是两个不同的概念，例如I/O地址空间为64K，一个32bit的CPU物理地址空间是4G。 如，在Intel 8086&#43;Redhat9.0 下用“more /proc/ioports”可看到： 0000-001f : dma1 0020-003f : pic1 0040-005f : timer 0060-006f : keyboard 0070-007f : rtc 0080-008f : dma page reg 00a0-00bf : pic2 00c0-00df : dma2 00f0-00ff : fpu 0170-0177 : ide1 …… 不过Intel x86平台普通使用了名为内存映射（MMIO）的技术，该技术是PCI规范的一部分，IO设备端口被映射到内存空间，映射后，CPU访问IO端口就如同访 问内存一样。看Intel TA 719文档给出的x86/x64系统典型内存地址分配表： 系统资源 占用 ------------------------------------------------------------------------ BIOS 1M 本地APIC 4K 芯片组保留 2M IO APIC 4K PCI设备 256M PCI Express设备 256M PCI设备（可选） 256M 显示帧缓存 16M TSEG 1M" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/115dbc7212e076b7e4e75ee171ebb6da/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2013-09-08T19:56:22+08:00" />
<meta property="article:modified_time" content="2013-09-08T19:56:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">linux中的 IO端口映射和IO内存映射</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">CPU地址空间</span> 
<br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">（一）地址的概念</span> 
<br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> 
<br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">1）物理地址：CPU地址总线传来的地址，由硬件电路控制其具体含义。物理地址中很大一部分是留给内存条中的内存的，但也常被映射到其他存储器上 </span> 
<wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">（如显存、BIOS等）。在程序指令中的虚拟地址经过段映射和页面映射后，就生成了物理地址，这个物理地址被放到CPU的地址线上。</span> 
<br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span> 
<wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span> 
<wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span> 
<wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span> 
<wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span> 
<wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span> 
<wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span> 
<wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span> 
<wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">物理地址空间，一部分给物理RAM（内存）用，一部分给总线用，这是由硬件设计来决定的，因此在32 </span> 
<wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">bits地址线的x86处理器中，物理地址空间是2的32次方，即4GB，但物理RAM一般不能上到4GB，因为还有一部分要给总线用（总线上还挂着别的 </span> 
<wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">许多设备）。在PC机中，一般是把低端物理地址给RAM用，高端物理地址给总线用。</span> 
<br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span> 
<wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr> 
<br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> 
<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">2）总线地址：总线的地址线或在地址周期上产生的信号。外设使用的是总线地址，CPU使用的是物理地址。</span> 
<br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> 
<p><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">物理地址与总线地址之间的关系由系统的设计决定的。在x86平台上，物理地址就是总线地址，这是因为它们共享相同的地址空间——这句话有点难理解，详见下 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">面的“独立编址”。在其他平台上，可能需要转换/映射。比如：CPU需要访问物理地址是0xfa000的单元，那么在x86平台上，会产生一个PCI总线 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">上对0xfa000地址的访问。因为物理地址和总线地址相同，所以凭眼睛看是不能确定这个地址是用在哪儿的，它或者在内存中，或者是某个卡上的存储单元， </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">甚至可能这个地址上没有对应的存储器。</span></p> 
<p><br> </p> 
<p><span style="font-family:Arial; font-size:14.399999618530273px; line-height:26px"><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">（二）编址方式</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">1）</span><span style="font-family:Arial; font-size:14.399999618530273px; line-height:26px"><span style="color:#ff0000">外设都是通过读写设备上的寄存器来进行的，外设寄存器也称为“I/O端口”</span></span><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">，而IO端口有两种编址方式：独立编址和统一编制。</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">统一编址：外设接口中的IO寄存器（即IO端口）与主存单元一样看待，每个端口占用一个存储单元的地址，将主存的一部分划出来用作IO地址空间，如，在 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">PDP-11中，把最高的4K主存作为IO设备寄存器地址。端口占用了存储器的地址空间，使存储量容量减小。</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:#ff0000"><span style="font-family:Arial; font-size:14.399999618530273px; line-height:26px">统一编址也称为“</span><span style="font-family:Arial; font-size:14.399999618530273px; line-height:26px">I/O内存”</span><span style="font-family:Arial; font-size:14.399999618530273px; line-height:26px">方式，外设寄存器位于“内存空间”</span></span><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">（很多外设有自己的内存、缓冲区，外设的寄存器和内存统称“I/O空间”）。</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">如，Samsung的S3C2440，是32位ARM处理器，它的4GB地址空间被外设、RAM等瓜分：</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0x8000 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">1000 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">LED </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">8*8点阵的地址</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0x4800 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0000 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">~ </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0x6000 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0000 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">SFR（特殊暂存器）地址空间</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0x3800 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">1002 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">键盘地址</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0x3000 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0000 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">~ </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0x3400 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0000 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">SDRAM空间 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0x2000 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0020 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">~ </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0x2000 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">002e </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">IDE</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0x1900 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0300 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">CS8900</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">独立编址（单独编址）：IO地址与存储地址分开独立编址，I/0端口地址不占用存储空间的地址范围，这样，在系统中就存在了另一种与存储地址无关的IO地 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">址，CPU也必须具有专用与输入输出操作的IO指令（IN、OUT等）和控制逻辑。独立编址下，地址总线上过来一个地址，设备不知道是给IO端口的、还是 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">给存储器的，于是处理器通过MEMR/MEMW和IOR/IOW两组控制信号来实现对I/O端口和存储器的不同寻址。如，intel </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">80x86就采用单独编址，CPU内存和I/O是一起编址的，就是说内存一部分的地址和I/O地址是重叠的。</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="font-family:Arial; font-size:14.399999618530273px; line-height:26px"><span style="color:#ff0000">独立编址也称为“I/O端口”方式，外设寄存器位于“I/O（地址）空间”。</span></span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">对于x86架构来说，通过IN/OUT指令访问。PC架构一共有65536个8bit的I/O端口，组成64K个I/O地址空间，编号从 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0~0xFFFF，有16位，80x86用低16位地址线A0-A15来寻址。连续两个8bit的端口可以组成一个16bit的端口，连续4个组成一个 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">32bit的端口。I/O地址空间和CPU的物理地址空间是两个不同的概念，例如I/O地址空间为64K，一个32bit的CPU物理地址空间是4G。 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">如，在Intel </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">8086+Redhat9.0 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">下用“more </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">/proc/ioports”可看到：</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0000-001f </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">: </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">dma1</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0020-003f </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">: </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">pic1</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0040-005f </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">: </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">timer</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0060-006f </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">: </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">keyboard</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0070-007f </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">: </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">rtc</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0080-008f </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">: </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">dma </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">page </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">reg</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">00a0-00bf </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">: </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">pic2</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">00c0-00df </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">: </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">dma2</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">00f0-00ff </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">: </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">fpu</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">0170-0177 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">: </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">ide1</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">……</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">不过Intel </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">x86平台普通使用了名为内存映射（MMIO）的技术，该技术是PCI规范的一部分，IO设备端口被映射到内存空间，映射后，CPU访问IO端口就如同访 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">问内存一样。<span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">看Intel </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">TA </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">719文档给出的x86/x64系统典型内存地址分配表：</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">系统资源 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">占用</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">------------------------------------------------------------------------</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">BIOS </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">1M</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">本地APIC </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">4K</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">芯片组保留 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">2M</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">IO </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">APIC </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">4K</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">PCI设备 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">256M</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">PCI </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">Express设备 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">256M</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">PCI设备（可选） </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">256M</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">显示帧缓存 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">16M</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">TSEG </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">1M</span></span><br> </span></p> 
<p><span style="font-family:Arial; font-size:14.399999618530273px; line-height:26px"><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"><br> </span></span></span></p> 
<p><span style="font-family:Arial; font-size:14.399999618530273px; line-height:26px"><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">对于某一既定的系统，它要么是独立编址、要么是统一编址，具体采用哪一种则取决于CPU的体系结构。 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">如，PowerPC、m68k等采用统一编址，而X86等则采用独立编址，存在IO空间的概念。目前，大多数嵌入式微控制器如ARM、PowerPC等并 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">不提供I/O空间，仅有内存空间，可直接用地址、指针访问。但对于Linux内核而言，它可能用于不同的CPU，所以它必须都要考虑这两种方式，于是它采 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">用一种新的方法，将基于I/O映射方式的或内存映射方式的I/O端口通称为“I/O区域”（I/O </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">region），不论你采用哪种方式，都要先申请IO区域：request_resource()，结束时释放 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">它：release_resource()。</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">2）对外设的访问</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">1、访问I/O内存的流程是：request_mem_region() </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">-&gt; </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">ioremap() </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">-&gt; </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">ioread8()/iowrite8() </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">-&gt; </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">iounmap() </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">-&gt; </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">release_mem_region() </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">。</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">前面说过，IO内存是统一编址下的概念，对于统一编址，IO地址空间是物理主存的一部分，对于编程而言，我们只能操作虚拟内存，所以，访问的第一步就是要把设备所处的物理地址映射到虚拟地址，Linux2.6下用ioremap():</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">void </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">*ioremap(unsigned </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">long </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">offset, </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">unsigned </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">long </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">size);</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">然后，我们可以直接通过指针来访问这些地址，但是也可以用Linux内核的一组函数来读写：</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">ioread8(), </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">iowrite16(), </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">ioread8_rep(), </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">iowrite8_rep()......</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">2、访问I/O端口</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">访问IO端口有2种途径：I/O映射方式（I/O－mapped）、内存映射方式（Memory－mapped）。前一种途径不映射到内存空间，直接使用 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">intb()/outb()之类的函数来读写IO端口；后一种MMIO是先把IO端口映射到IO内存（“内存空间”），再使用访问IO内存的函数来访问 </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">IO端口。</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">void </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">ioport_map(unsigned </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">long </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">port, </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">unsigned </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">int </span><wbr style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></wbr><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">count);</span><br style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">通过这个函数，可以把port开始的count个连续的IO端口映射为一段“内存空间”，然后就可以在其返回的地址是像访问IO内存一样访问这些IO端口。</span><br> </span></span></span></p> 
<p><br> </p> 
<p><br> </p> 
<p><span style="font-family:Arial; font-size:14.399999618530273px; line-height:26px"><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"><span style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"></span></span></span></span></p> 
<div class="articalContent  " style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> 
 <span style="font-size:24px"><strong>Linux下的IO端口和IO内存</strong></span> 
</div> 
<div class="articalContent  " style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">
    
</div> 
<div class="articalContent  " style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px">
  CPU对外设端口物理地址的编址方式有两种：一种是IO映射方式，另一种是内存映射方式。  
 <br> 　Linux将基于IO映射方式的和内存映射方式的IO端口统称为IO区域（IO region）。 
</div> 
<div class="articalContent  " style="color:rgb(51,51,51); font-family:Arial; font-size:14.399999618530273px; line-height:26px"> 
 <p>　　IO region仍然是一种IO资源，因此它仍然可以用resource结构类型来描述。</p> 
 <p>　　Linux管理IO region：</p> 
 <p>　　1) request_region()</p> 
 <p>　　把一个给定区间的IO端口分配给一个IO设备。</p> 
 <p>　　2) check_region()</p> 
 <p>　　检查一个给定区间的IO端口是否空闲，或者其中一些是否已经分配给某个IO设备。</p> 
 <p>　　3) release_region()</p> 
 <p>　　释放以前分配给一个IO设备的给定区间的IO端口。</p> 
 <p>　　Linux中可以通过以下辅助函数来访问IO端口：</p> 
 <p>　　inb(),inw(),inl(),outb(),outw(),outl()</p> 
 <p>　　“b”“w”“l”分别代表8位，16位，32位。</p> 
 <p>　对IO内存资源的访问</p> 
 <p>　　1) request_mem_region()</p> 
 <p>　　请求分配指定的IO内存资源。</p> 
 <p>　　2) check_mem_region()</p> 
 <p>　　检查指定的IO内存资源是否已被占用。</p> 
 <p>　　3) release_mem_region()</p> 
 <p>　　释放指定的IO内存资源。</p> 
 <p>　　其中传给函数的start address参数是内存区的物理地址（以上函数参数表已省略）。</p> 
 <p>　　驱动开发人员可以将内存映射方式的IO端口和外设内存统一看作是IO内存资源。</p> 
 <p>　　ioremap()用来将IO资源的物理地址映射到内核虚地址空间（3GB - 4GB）中，参数addr是指向内核虚地址的指针。</p> 
 <p>　　Linux中可以通过以下辅助函数来访问IO内存资源：</p> 
 <p>　　readb(),readw(),readl(),writeb(),writew(),writel()。</p> 
 <p>　　Linux在kernel/resource.c文件中定义了全局变量ioport_resource和iomem_resource，来分别描述基于IO映射方式的整个IO端口空间和基于内存映射方式的IO内存资源空间（包括IO端口和外设内存）。</p> 
</div> 
<br> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/46d7c77432c607c4ae427ed3517af3ef/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">20130828可注册域名列表</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dafc3b143c13b469d9bd8c6c7c10b75c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">利用LoadRunner判断HTTP服务器的返…</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>