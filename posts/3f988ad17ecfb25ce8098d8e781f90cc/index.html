<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[python] argparse — 命令行选项、参数和子命令的解析器 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[python] argparse — 命令行选项、参数和子命令的解析器" />
<meta property="og:description" content="15.4. argparse — 命令行选项、参数和子命令的解析器 版本2.7 中新引入。
源代码： Lib/argparse.py
argparse模块使得编写用户友好的命令行接口非常容易。程序只需定义好它要求的参数，然后argparse将负责如何从sys.argv中解析出这些参数。argparse模块还会自动生成帮助和使用信息并且当用户赋给程序非法的参数时产生错误信息。
15.4.1. 示例 下面的Python程序代码接收一个整数序列并输出它们的和或者最大值：
import argparse parser = argparse.ArgumentParser(description=&#39;Process some integers.&#39;) parser.add_argument(&#39;integers&#39;, metavar=&#39;N&#39;, type=int, nargs=&#39;&#43;&#39;, help=&#39;an integer for the accumulator&#39;) parser.add_argument(&#39;--sum&#39;, dest=&#39;accumulate&#39;, action=&#39;store_const&#39;, const=sum, default=max, help=&#39;sum the integers (default: find the max)&#39;) args = parser.parse_args() print args.accumulate(args.integers) 假设上面的Python代码保存为一个叫做prog.py的文件，它可以在命令行上执行并提供有用的帮助信息：
$ python prog.py -h usage: prog.py [-h] [--sum] N [N ...] Process some integers. positional arguments: N an integer for the accumulator optional arguments: -h, --help show this help message and exit --sum sum the integers (default: find the max) 当以适当的参数运行时，它打印出命令行整数的和或者最大值：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/3f988ad17ecfb25ce8098d8e781f90cc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-12-10T10:04:00+08:00" />
<meta property="article:modified_time" content="2016-12-10T10:04:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[python] argparse — 命令行选项、参数和子命令的解析器</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <p> </p> 
 <h2><span id="313">15.4. <a class="reference internal" title="argparse: Command-line option and argument parsing library." href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#module-argparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a> — 命令行选项、参数和子命令的解析器</span></h2> 
 <p class="versionadded"><span id="1"><span class="versionmodified">版本2.7 中新引入。</span></span></p> 
 <p><span id="2"><strong>源代码：</strong> </span><span id="3"><a class="reference external" href="http://hg.python.org/cpython/file/2.7/Lib/argparse.py" rel="nofollow">Lib/argparse.py</a></span></p> 
 <p><span id="7"><a class="reference internal" title="argparse: Command-line option and argument parsing library." href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#module-argparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a>模块使得编写用户友好的命令行接口非常容易。</span><span id="8">程序只需定义好它要求的参数，然后<a class="reference internal" title="argparse: Command-line option and argument parsing library." href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#module-argparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a>将负责如何从<a class="reference internal" title="sys.argv" href="http://python.usyiyi.cn/documents/python_278/library/sys.html#sys.argv" rel="nofollow"><tt class="xref py py-data docutils literal"><span class="pre">sys.argv</span></tt></a>中解析出这些参数。</span><span id="9"><a class="reference internal" title="argparse: Command-line option and argument parsing library." href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#module-argparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a>模块还会自动生成帮助和使用信息并且当用户赋给程序非法的参数时产生错误信息。</span></p> 
 <p> </p> 
 <div id="example" class="section"> 
  <h3><span id="314">15.4.1. 示例</span></h3> 
  <p><span id="10">下面的Python程序代码接收一个整数序列并输出它们的和或者最大值：</span></p> 
  <div class="highlight-python"> 
   <div class="highlight"> 
    <pre><span class="kn">import <span class="nn">argparse

<span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">description<span class="o">=<span class="s">'Process some integers.'<span class="p">) <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'integers'<span class="p">, <span class="n">metavar<span class="o">=<span class="s">'N'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'+'<span class="p">, <span class="n">help<span class="o">=<span class="s">'an integer for the accumulator'<span class="p">) <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--sum'<span class="p">, <span class="n">dest<span class="o">=<span class="s">'accumulate'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_const'<span class="p">, <span class="n">const<span class="o">=<span class="nb">sum<span class="p">, <span class="n">default<span class="o">=<span class="nb">max<span class="p">, <span class="n">help<span class="o">=<span class="s">'sum the integers (default: find the max)'<span class="p">) <span class="n">args <span class="o">= <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">() <span class="k">print <span class="n">args<span class="o">.<span class="n">accumulate<span class="p">(<span class="n">args<span class="o">.<span class="n">integers<span class="p">) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
   </div> 
  </div> 
  <p><span id="11">假设上面的Python代码保存为一个叫做<tt class="docutils literal"><span class="pre">prog.py</span></tt>的文件，它可以在命令行上执行并提供有用的帮助信息：</span></p> 
  <div class="highlight-python"> 
   <pre>$ python prog.py -h
usage: prog.py [-h] [--sum] N [N ...]

Process some integers.

positional arguments:
 N           an integer for the accumulator

optional arguments:
 -h, --help  show this help message and exit
 --sum       sum the integers (default: find the max)</pre> 
  </div> 
  <p><span id="12">当以适当的参数运行时，它打印出命令行整数的和或者最大值：</span></p> 
  <div class="highlight-python"> 
   <pre>$ python prog.py 1 2 3 4
4

$ python prog.py 1 2 3 4 --sum
10</pre> 
  </div> 
  <p><span id="13">如果传进非法的参数，它将产生错误信息：</span></p> 
  <div class="highlight-python"> 
   <pre>$ python prog.py a b c
usage: prog.py [-h] [--sum] N [N ...]
prog.py: error: argument N: invalid int value: 'a'</pre> 
  </div> 
  <p><span id="14">下面的部分将带你步步深入这个示例。</span></p> 
 </div> 
 <p><a class="reference internal" title="argparse: Command-line option and argument parsing library." href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#module-argparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre"> </span></tt></a></p> 
 <p> </p> 
 <div id="creating-a-parser" class="section"> 
  <h4><span id="321">15.4.1.1. 创建一个解析器</span></h4> 
  <p><span id="15">使用<a class="reference internal" title="argparse: Command-line option and argument parsing library." href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#module-argparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a>的第一步是创建一个<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>对象：</span></p> 
  <div class="highlight-python"> 
   <div class="highlight"> 
    <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
    <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">description<span class="o">=<span class="s">'Process some integers.'<span class="p">) </span></span></span></span></span></span></span></span></span></span></span></pre> 
   </div> 
  </div> 
  <p><span id="16"><a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>对象会保存把命令行解析成Python数据类型所需要的所有信息。</span></p> 
 </div> 
 <p> </p> 
 <div class="section"> 
  <div id="adding-arguments" class="section"> 
   <h4><span id="322">15.4.1.2. 添加参数</span></h4> 
   <p><span id="17">通过调用<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a>方法向<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>添加程序的参数信息。</span><span id="18">通常情况下，这些信息告诉<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>如何接收命令行上的字符串并将它们转换成对象。</span><span id="19">这些信息被保存下来并在调用<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>时用到。</span><span id="20">例如：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'integers'<span class="p">, <span class="n">metavar<span class="o">=<span class="s">'N'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'+'<span class="p">, <span class="gp">... <span class="n">help<span class="o">=<span class="s">'an integer for the accumulator'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--sum'<span class="p">, <span class="n">dest<span class="o">=<span class="s">'accumulate'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_const'<span class="p">, <span class="gp">... <span class="n">const<span class="o">=<span class="nb">sum<span class="p">, <span class="n">default<span class="o">=<span class="nb">max<span class="p">, <span class="gp">... <span class="n">help<span class="o">=<span class="s">'sum the integers (default: find the max)'<span class="p">) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="21">接下来，调用<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>返回的对象将带有两个属性，<tt class="docutils literal"><span class="pre">integers</span></tt>和<tt class="docutils literal"><span class="pre">accumulate</span></tt>。</span><span id="22">属性<tt class="docutils literal"><span class="pre">integers</span></tt>将是一个包含一个或多个整数的列表，如果命令行上指定 <tt class="docutils literal"><span class="pre">--sum</span></tt>，那么属性<tt class="docutils literal"><span class="pre">accumulate</span></tt>将是<a class="reference internal" title="sum" href="http://python.usyiyi.cn/documents/python_278/library/functions.html#sum" rel="nofollow"><tt class="xref py py-func docutils literal"><span class="pre">sum()</span></tt></a>函数，如果没有指定，则是<a class="reference internal" title="max" href="http://python.usyiyi.cn/documents/python_278/library/functions.html#max" rel="nofollow"><tt class="xref py py-func docutils literal"><span class="pre">max()</span></tt></a>函数。</span></p> 
  </div> 
  <div id="parsing-arguments" class="section"> 
   <h4><span id="323">15.4.1.3. 解析参数</span></h4> 
   <p><span id="23"><a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>通过<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>方法解析参数。</span><span id="24">它将检查命令行，把每个参数转换成恰当的类型并采取恰当的动作。</span><span id="25">在大部分情况下，这意味着将从命令行中解析出来的属性建立一个简单的 <a class="reference internal" title="argparse.Namespace" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.Namespace" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">Namespace</span></tt></a>对象。</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--sum'<span class="p">, <span class="s">'7'<span class="p">, <span class="s">'-1'<span class="p">, <span class="s">'42'<span class="p">]) <span class="go">Namespace(accumulate=&lt;built-in function sum&gt;, integers=[7, -1, 42]) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="26">在脚本中，<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a> 调用一般不带参数，<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a> 将根据<a class="reference internal" title="sys.argv" href="http://python.usyiyi.cn/documents/python_278/library/sys.html#sys.argv" rel="nofollow"><tt class="xref py py-data docutils literal"><span class="pre">sys.argv</span></tt></a>自动确定命令行参数。</span></p> 
  </div> 
 </div> 
 <p> </p> 
 <div id="argumentparser-objects" class="section"> 
  <h3><span id="315">15.4.2. ArgumentParser 对象</span></h3> 
  <dl class="class"> 
    
    <span class="property">class <tt class="descclassname">argparse.</tt><tt class="descname">ArgumentParser</tt><big>(</big>prog=None, usage=None, description=None, epilog=None, parents=<span class="optional">[<span class="optional">],formatter_class=argparse.HelpFormatter, prefix_chars='-', fromfile_prefix_chars=None, argument_default=None,conflict_handler='error', add_help=True<big>)</big></span></span></span> 
    
   <dd> 
    <p><span id="27">创建一个新的<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>对象。</span><span id="28">所有的参数应该以关键字参数传递。</span><span id="29">下面有对每个参数各自详细的描述，但是简短地讲它们是：</span></p> 
    <ul class="simple"><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#prog" rel="nofollow">prog</a> - <span id="375">程序的名字（默认：<tt class="docutils literal"><span class="pre">sys.argv[0]</span></tt>）</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#usage" rel="nofollow">usage</a> - <span id="376">描述程序用法的字符串（默认：从解析器的参数生成）</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#description" rel="nofollow">description</a> - <span id="377">参数帮助信息之前的文本（默认：空）</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#epilog" rel="nofollow">epilog</a> - <span id="378">参数帮助信息之后的文本（默认：空）</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#parents" rel="nofollow">parents</a> - <span id="379"><a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow">ArgumentParser</a> 对象的一个列表，这些对象的参数应该包括进去</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#formatter-class" rel="nofollow">formatter_class</a> - <span id="381">定制化帮助信息的类</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#prefix-chars" rel="nofollow">prefix_chars</a> - <span id="382">可选参数的前缀字符集（默认：‘-‘）</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#fromfile-prefix-chars" rel="nofollow">fromfile_prefix_chars</a> - <span id="383">额外的参数应该读取的文件的前缀字符集（默认：<tt class="xref docutils literal"><span class="pre">None</span></tt>）</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argument-default" rel="nofollow">argument_default</a> - <span id="384">参数的全局默认值（默认：<tt class="xref docutils literal"><span class="pre">None</span></tt>）</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#conflict-handler" rel="nofollow">conflict_handler</a> - <span id="385">解决冲突的可选参数的策略（通常没有必要）</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#add-help" rel="nofollow">add_help</a> - <span id="386">给解析器添加-h/–help 选项（默认：<tt class="xref docutils literal"><span class="pre">True</span></tt>）</span></li></ul> 
   </dd> 
  </dl> 
  <p><span id="30">下面的小节描述这些参数如何使用。</span></p> 
  <div id="prog" class="section"> 
   <h4><span id="324">15.4.2.1. prog 参数</span></h4> 
   <p><span id="31">默认情况下，<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>对象使用<tt class="docutils literal"><span class="pre">sys.argv[0]</span></tt> 决定在帮助信息中如何显示程序的名字。</span><span id="32">这个默认值几乎总能满足需求，因为帮助信息（中的程序名称）会自动匹配命令行中调用的程序名称。</span><span id="33">例如，参考下面这段<tt class="docutils literal"><span class="pre">myprogram.py</span></tt>文件中的代码：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <pre><span class="kn">import <span class="nn">argparse
<span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">help<span class="o">=<span class="s">'foo help'<span class="p">) <span class="n">args <span class="o">= <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">() </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="34">该程序的帮助信息将显示<tt class="docutils literal"><span class="pre">myprogram.py</span></tt>作为程序的名字（无论程序是在哪里被调用的）：</span></p> 
   <div class="highlight-python"> 
    <pre>$ python myprogram.py --help
usage: myprogram.py [-h] [--foo FOO]

optional arguments:
 -h, --help  show this help message and exit
 --foo FOO   foo help
$ cd ..
$ python subdir\myprogram.py --help
usage: myprogram.py [-h] [--foo FOO]

optional arguments:
 -h, --help  show this help message and exit
 --foo FOO   foo help</pre> 
   </div> 
   <p><span id="35">如果要改变这个默认的行为，可以使用<tt class="docutils literal"><span class="pre">prog=</span></tt>参数给<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>提供另外一个值：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'myprogram'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: myprogram [-h] <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="36">注意，无论是来自<tt class="docutils literal"><span class="pre">sys.argv[0]</span></tt>还是来自<tt class="docutils literal"><span class="pre">prog=argument</span></tt>，在帮助信息中都可以使用<tt class="docutils literal"><span class="pre">%(prog)s</span></tt>格式符得到程序的名字。</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'myprogram'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">help<span class="o">=<span class="s">'foo of the <span class="si">%(prog)s<span class="s"> program'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: myprogram [-h] [--foo FOO] <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="go"> --foo FOO foo of the myprogram program </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
  <div id="usage" class="section"> 
   <h4><span id="325">15.4.2.2. usage 参数</span></h4> 
   <p><span id="37">默认情况下，<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>依据它包含的参数计算出帮助信息：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'?'<span class="p">, <span class="n">help<span class="o">=<span class="s">'foo help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'+'<span class="p">, <span class="n">help<span class="o">=<span class="s">'bar help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: PROG [-h] [--foo [FOO]] bar [bar ...] <span class="go">positional arguments: <span class="go"> bar bar help <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="go"> --foo [FOO] foo help </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="38">可以通过关键字参数<tt class="docutils literal"><span class="pre">usage=</span></tt>覆盖默认的信息：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">, <span class="n">usage<span class="o">=<span class="s">'<span class="si">%(prog)s<span class="s"> [options]'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'?'<span class="p">, <span class="n">help<span class="o">=<span class="s">'foo help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'+'<span class="p">, <span class="n">help<span class="o">=<span class="s">'bar help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: PROG [options] <span class="go">positional arguments: <span class="go"> bar bar help <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="go"> --foo [FOO] foo help </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="39">在你的帮助信息中，可以使用<tt class="docutils literal"><span class="pre">%(prog)s</span></tt>格式指示符替代程序的名字。</span></p> 
  </div> 
  <div id="description" class="section"> 
   <h4><span id="326">15.4.2.3. description 参数</span></h4> 
   <p><span id="40"><a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>构造器的大部分调用都将使用<tt class="docutils literal"><span class="pre">description=</span></tt>关键字参数。</span><span id="41">这个参数给出程序做什么以及如何工作的简短描述。</span><span id="42">在帮助信息中，该描述在命令行用法字符串和各个参数的帮助信息之间显示：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">description<span class="o">=<span class="s">'A foo that bars'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: argparse.py [-h] <span class="go">A foo that bars <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="43">默认情况下，该描述会换行以适应给定的空间。</span><span id="44">如果要改变这个行为，可以参见<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#formatter-class" rel="nofollow">formatter_class</a>参数。</span></p> 
  </div> 
  <div id="epilog" class="section"> 
   <h4><span id="327">15.4.2.4. epilog 参数</span></h4> 
   <p><span id="45">有些程序喜欢在参数的描述之后显示额外的关于程序的描述。</span><span id="46">这些文本可以使用<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>的<tt class="docutils literal"><span class="pre">epilog=</span></tt>参数指定：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">( <span class="gp">... <span class="n">description<span class="o">=<span class="s">'A foo that bars'<span class="p">, <span class="gp">... <span class="n">epilog<span class="o">=<span class="s">"And that's how you'd foo a bar"<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: argparse.py [-h] <span class="go">A foo that bars <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="go">And that's how you'd foo a bar </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="47">和<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#description" rel="nofollow">description</a>一样，<tt class="docutils literal"><span class="pre">epilog=</span></tt>文本默认会换行，但是可以通过<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>的<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#formatter-class" rel="nofollow">formatter_class</a>参数调整这个行为。</span></p> 
  </div> 
  <div id="parents" class="section"> 
   <h4><span id="328">15.4.2.5. parents 参数</span></h4> 
   <p><span id="48">有时候，几个解析器会共享一个共同的参数集。</span><span id="49">可以使用一个带有所有共享参数的解析器传递给<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>的<tt class="docutils literal"><span class="pre">parents=</span></tt>参数，而不用重复定义这些参数。</span><span id="50"><tt class="docutils literal"><span class="pre">parents=</span></tt>参数接受一个<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>对象的列表，然后收集它们当中所有的位置参数和可选参数，并将这些参数添加到正在构建的<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>对象：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parent_parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">add_help<span class="o">=<span class="bp">False<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parent_parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--parent'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">foo_parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">parents<span class="o">=<span class="p">[<span class="n">parent_parser<span class="p">]) <span class="gp">&gt;&gt;&gt; <span class="n">foo_parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'foo'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">foo_parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--parent'<span class="p">, <span class="s">'2'<span class="p">, <span class="s">'XXX'<span class="p">]) <span class="go">Namespace(foo='XXX', parent=2) <span class="gp">&gt;&gt;&gt; <span class="n">bar_parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">parents<span class="o">=<span class="p">[<span class="n">parent_parser<span class="p">]) <span class="gp">&gt;&gt;&gt; <span class="n">bar_parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--bar'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">bar_parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--bar'<span class="p">, <span class="s">'YYY'<span class="p">]) <span class="go">Namespace(bar='YYY', parent=None) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="51">注意大部分父解析器将指定<tt class="docutils literal"><span class="pre">add_help=False</span></tt>。</span><span id="52">否则，<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>将看到两个<tt class="docutils literal"><span class="pre">-h/--help</span></tt> 选项（一个在父解析器中，一个在子解析器中）并引发一个错误。</span></p> 
   <div class="admonition note"> 
    <p class="first admonition-title"><span id="53">注意</span></p>   
    <p class="last"><span id="54">在通过<tt class="docutils literal"><span class="pre">parents=</span></tt>传递父解析器之前，你必须完全初始化它们。</span><span id="55">如果在子解析器之后你改变了父解析器，这些改变不会反映在子解析器中。</span></p> 
   </div> 
  </div> 
  <div id="formatter-class" class="section"> 
   <h4><span id="329">15.4.2.6. formatter_class 参数</span></h4> 
   <p><span id="56"><a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>对象允许通过指定一个格式化类来定制帮助信息的格式。</span><span id="57">当前，有三个种这样的类：</span></p> 
   <dl class="class"> 
     
     <span class="property">class <tt class="descclassname">argparse.</tt><tt class="descname">RawDescriptionHelpFormatter</tt></span> 
     
     
     <span class="property">class <tt class="descclassname">argparse.</tt><tt class="descname">RawTextHelpFormatter</tt></span> 
     
     
     <span class="property">class <tt class="descclassname">argparse.</tt><tt class="descname">ArgumentDefaultsHelpFormatter</tt></span> 
     
    <dd></dd> 
   </dl> 
   <p><span id="58">前两个在文本信息如何显示上允许更多控制，最后一个会自动添加关于参数默认值的信息。</span></p> 
   <p><span id="59">默认情况下，<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>对象会对命令行帮助信息中的<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#description" rel="nofollow">description</a>和<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#epilog" rel="nofollow">epilog</a>文本进行换行：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">( <span class="gp">... <span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">, <span class="gp">... <span class="n">description<span class="o">=<span class="s">'''this description <span class="gp">... <span class="s"> was indented weird <span class="gp">... <span class="s"> but that is okay'''<span class="p">, <span class="gp">... <span class="n">epilog<span class="o">=<span class="s">''' <span class="gp">... <span class="s"> likewise for this epilog whose whitespace will <span class="gp">... <span class="s"> be cleaned up and whose words will be wrapped <span class="gp">... <span class="s"> across a couple lines'''<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: PROG [-h] <span class="go">this description was indented weird but that is okay <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="go">likewise for this epilog whose whitespace will be cleaned up and whose words <span class="go">will be wrapped across a couple lines </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="60">把<a class="reference internal" title="argparse.RawDescriptionHelpFormatter" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.RawDescriptionHelpFormatter" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">RawDescriptionHelpFormatter</span></tt></a> 传递给<tt class="docutils literal"><span class="pre">formatter_class=</span></tt> 表示<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#description" rel="nofollow">description</a> 和<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#epilog" rel="nofollow">epilog</a> 已经是正确的格式而不应该再折行：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">( <span class="gp">... <span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">, <span class="gp">... <span class="n">formatter_class<span class="o">=<span class="n">argparse<span class="o">.<span class="n">RawDescriptionHelpFormatter<span class="p">, <span class="gp">... <span class="n">description<span class="o">=<span class="n">textwrap<span class="o">.<span class="n">dedent<span class="p">(<span class="s">'''<span class="se">\ <span class="gp">... <span class="s"> Please do not mess up this text! <span class="gp">... <span class="s"> -------------------------------- <span class="gp">... <span class="s"> I have indented it <span class="gp">... <span class="s"> exactly the way <span class="gp">... <span class="s"> I want it <span class="gp">... <span class="s"> '''<span class="p">)) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: PROG [-h] <span class="go">Please do not mess up this text! <span class="go">-------------------------------- <span class="go"> I have indented it <span class="go"> exactly the way <span class="go"> I want it <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="61"><a class="reference internal" title="argparse.RawTextHelpFormatter" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.RawTextHelpFormatter" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">RawTextHelpFormatter</span></tt></a> 将保留所有帮助文本的空白，包括参数的描述。</span></p> 
   <p><span id="62">另外一个格式化类<a class="reference internal" title="argparse.ArgumentDefaultsHelpFormatter" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentDefaultsHelpFormatter" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentDefaultsHelpFormatter</span></tt></a>，将添加每个参数的默认值信息。</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">( <span class="gp">... <span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">, <span class="gp">... <span class="n">formatter_class<span class="o">=<span class="n">argparse<span class="o">.<span class="n">ArgumentDefaultsHelpFormatter<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">, <span class="n">default<span class="o">=<span class="mi">42<span class="p">, <span class="n">help<span class="o">=<span class="s">'FOO!'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'*'<span class="p">, <span class="n">default<span class="o">=<span class="p">[<span class="mi">1<span class="p">, <span class="mi">2<span class="p">, <span class="mi">3<span class="p">], <span class="n">help<span class="o">=<span class="s">'BAR!'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: PROG [-h] [--foo FOO] [bar [bar ...]] <span class="go">positional arguments: <span class="go"> bar BAR! (default: [1, 2, 3]) <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="go"> --foo FOO FOO! (default: 42) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
  <div id="prefix-chars" class="section"> 
   <h4><span id="330">15.4.2.7. prefix_chars 参数</span></h4> 
   <p><span id="63">大部分命令行选项使用<tt class="docutils literal"><span class="pre">-</span></tt>作为前缀，例如<tt class="docutils literal"><span class="pre">-f/--foo</span></tt>。</span><span id="64">需要指出不同的或者额外的前缀字符的解析器，例如类似<tt class="docutils literal"><span class="pre">+f</span></tt>或者<tt class="docutils literal"><span class="pre">/foo</span></tt>这样的选项，可以使用ArgumentParser构造器的<tt class="docutils literal"><span class="pre">prefix_chars=</span></tt>参数指定它们：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">, <span class="n">prefix_chars<span class="o">=<span class="s">'-+'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'+f'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'++bar'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'+f X ++bar Y'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bar='Y', f='X') </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="65"><tt class="docutils literal"><span class="pre">prefix_chars=</span></tt>参数默认为<tt class="docutils literal"><span class="pre">'-'</span></tt>。</span><span id="66">提供不包含<tt class="docutils literal"><span class="pre">-</span></tt>的字符集将导致不允许<tt class="docutils literal"><span class="pre">-f/--foo</span></tt>选项。</span></p> 
  </div> 
  <div id="fromfile-prefix-chars" class="section"> 
   <h4><span id="331">15.4.2.8. fromfile_prefix_chars 参数</span></h4> 
   <p><span id="67">有时候，例如处理一个特别长的参数列表的时候，把参数列表保存在文件中而不是在命令行中敲出来可能比较合理。</span><span id="68">如果给出<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>构造器的<tt class="docutils literal"><span class="pre">fromfile_prefix_chars=</span></tt>参数，那么以任意一个给定字符开始的参数将被当做文件，并且将被这些文件包含的参数替换。</span><span id="69">例如：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="k">with <span class="nb">open<span class="p">(<span class="s">'args.txt'<span class="p">, <span class="s">'w'<span class="p">) <span class="k">as <span class="n">fp<span class="p">: <span class="gp">... <span class="n">fp<span class="o">.<span class="n">write<span class="p">(<span class="s">'-f<span class="se">\n<span class="s">bar'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">fromfile_prefix_chars<span class="o">=<span class="s">'@'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-f'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'-f'<span class="p">, <span class="s">'foo'<span class="p">, <span class="s">'@args.txt'<span class="p">]) <span class="go">Namespace(f='bar') </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="70">从文件中读入的参数必须默认是每行一个参数（但另可参阅<a class="reference internal" title="argparse.ArgumentParser.convert_arg_line_to_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.convert_arg_line_to_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">convert_arg_line_to_args()</span></tt></a>）并且将被当做在命令行上原始文件所在的位置。</span><span id="71">所有在上面的例子中，表达式<tt class="docutils literal"><span class="pre">['-f', <span class="pre">'foo', <span class="pre">'@args.txt']</span></span></span></tt> 被认为等同于表达式<tt class="docutils literal"><span class="pre">['-f', <span class="pre">'foo', <span class="pre">'-f', <span class="pre">'bar']</span></span></span></span></tt>。</span></p> 
   <p><span id="72"><tt class="docutils literal"><span class="pre">fromfile_prefix_chars=</span></tt> 参数默认为<tt class="xref docutils literal"><span class="pre">None</span></tt>，意味着参数永远不会被当做文件。</span></p> 
  </div> 
  <div id="argument-default" class="section"> 
   <h4><span id="332">15.4.2.9. argument_default 参数</span></h4> 
   <p><span id="73">通常情况下，参数默认值的指定通过传递一个默认值给<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a>或者以一个指键-值对的集合调用<a class="reference internal" title="argparse.ArgumentParser.set_defaults" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.set_defaults" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">set_defaults()</span></tt></a>方法。</span><span id="74">然而有时候，指定一个解析器范围的参数默认值会比较有用。</span><span id="75">这可以通过传递<tt class="docutils literal"><span class="pre">argument_default=</span></tt>关键字参数给<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>完成。</span><span id="76">例如，为了全局地阻止<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a> 调用时不必要的属性创建，我们可以提供<tt class="docutils literal"><span class="pre">argument_default=SUPPRESS</span></tt>：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">argument_default<span class="o">=<span class="n">argparse<span class="o">.<span class="n">SUPPRESS<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'?'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--foo'<span class="p">, <span class="s">'1'<span class="p">, <span class="s">'BAR'<span class="p">]) <span class="go">Namespace(bar='BAR', foo='1') <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([]) <span class="go">Namespace() </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
  <div id="conflict-handler" class="section"> 
   <h4><span id="333">15.4.2.10. conflict_handler 参数</span></h4> 
   <p><span id="77"><a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>对象不允许同一个选项具有两个动作。</span><span id="78">默认情况下，如果试图创建一个已经使用的选项，<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>对象将抛出异常。</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-f'<span class="p">, <span class="s">'--foo'<span class="p">, <span class="n">help<span class="o">=<span class="s">'old foo help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">help<span class="o">=<span class="s">'new foo help'<span class="p">) <span class="gt">Traceback (most recent call last): <span class="c"> .. <span class="nc">ArgumentError: argument --foo: conflicting option string(s): <span class="n-Identifier">--foo </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="79">有时候（例如使用<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#parents" rel="nofollow">parents</a>的时候）简单地用相同的选项覆盖旧的参数是有用的。</span><span id="80">为了得到这样的行为，可以提供<tt class="docutils literal"><span class="pre">'resolve'</span></tt>值给<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>的<tt class="docutils literal"><span class="pre">conflict_handler=</span></tt>参数：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">, <span class="n">conflict_handler<span class="o">=<span class="s">'resolve'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-f'<span class="p">, <span class="s">'--foo'<span class="p">, <span class="n">help<span class="o">=<span class="s">'old foo help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">help<span class="o">=<span class="s">'new foo help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: PROG [-h] [-f FOO] [--foo FOO] <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="go"> -f FOO old foo help <span class="go"> --foo FOO new foo help </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="81">注意<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a> 对象只有在所有的选项字符串被覆盖时才删除某个动作。</span><span id="82">所以，在上面的例子中，旧的<tt class="docutils literal"><span class="pre">-f/--foo</span></tt>动作依然保留为<tt class="docutils literal"><span class="pre">-f</span></tt>的动作，因为只有<tt class="docutils literal"><span class="pre">--foo</span></tt>选项字符串被覆盖。</span></p> 
  </div> 
  <div id="add-help" class="section"> 
   <h4><span id="334">15.4.2.11. add_help 参数</span></h4> 
   <p><span id="83">默认情况下，ArgumentParser对象会添加一个选项简单地显示解析器的帮助信息。</span><span id="84">例如，考虑一个包含如下代码的名为<tt class="docutils literal"><span class="pre">myprogram.py</span></tt>的文件：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <pre><span class="kn">import <span class="nn">argparse
<span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">help<span class="o">=<span class="s">'foo help'<span class="p">) <span class="n">args <span class="o">= <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">() </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="85">如果在命令行中提供<tt class="docutils literal"><span class="pre">-h</span></tt>或者<tt class="docutils literal"><span class="pre">--help</span></tt>，ArgumentParser的帮助信息将打印出来：</span></p> 
   <div class="highlight-python"> 
    <pre>$ python myprogram.py --help
usage: myprogram.py [-h] [--foo FOO]

optional arguments:
 -h, --help  show this help message and exit
 --foo FOO   foo help</pre> 
   </div> 
   <p><span id="86">偶尔，禁止这个帮助选项也可能是有用的。</span><span id="87">这可以通过传递<tt class="xref docutils literal"><span class="pre">False</span></tt>给<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>的<tt class="docutils literal"><span class="pre">add_help=</span></tt>参数实现：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">, <span class="n">add_help<span class="o">=<span class="bp">False<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">help<span class="o">=<span class="s">'foo help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: PROG [--foo FOO] <span class="go">optional arguments: <span class="go"> --foo FOO foo help </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="88">该帮助选项通常是<tt class="docutils literal"><span class="pre">-h/--help</span></tt>。</span><span id="89">例外情况是指定了<tt class="docutils literal"><span class="pre">prefix_chars=</span></tt>而且不包括<tt class="docutils literal"><span class="pre">-</span></tt>，在这种情况下<tt class="docutils literal"><span class="pre">-h</span></tt>和<tt class="docutils literal"><span class="pre">--help</span></tt>不是合法的选项。</span><span id="90">在这种情况下，<tt class="docutils literal"><span class="pre">prefix_chars</span></tt>中的第一个字符将用于该帮助选项的前缀：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">, <span class="n">prefix_chars<span class="o">=<span class="s">'+/'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: PROG [+h] <span class="go">optional arguments: <span class="go"> +h, ++help show this help message and exit </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
 </div> 
 <p> </p> 
 <div id="the-add-argument-method" class="section"> 
  <h3><span id="316">15.4.3. add_argument() 方法</span></h3> 
  <dl class="method"> 
    
    <tt class="descclassname">ArgumentParser.</tt> 
    <tt class="descname">add_argument</tt> 
    <big>(</big>name or flags... 
    <span class="optional">[, action<span class="optional">]<span class="optional">[, nargs<span class="optional">]<span class="optional">[, const<span class="optional">]<span class="optional">[, default<span class="optional">]<span class="optional">[, type<span class="optional">]<span class="optional">[, choices<span class="optional">]<span class="optional">[, required<span class="optional">]<span class="optional">[, help<span class="optional">]<span class="optional">[, metavar<span class="optional">]<span class="optional">[, dest<span class="optional">]<big>)</big></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> 
    
   <dd> 
    <p><span id="91">定义应该如何解析一个命令行参数。</span><span id="92">下面每个参数有它们自己详细的描述，简单地讲它们是：</span></p> 
    <ul class="simple"><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#name-or-flags" rel="nofollow">name or flags</a> - <span id="387">选项字符串的名字或者列表，例如<tt class="docutils literal"><span class="pre">foo</span></tt> 或者<tt class="docutils literal"><span class="pre">-f, <span class="pre">--foo</span></span></tt>。</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#action" rel="nofollow">action</a> - <span id="388">在命令行遇到该参数时采取的基本动作类型。</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#nargs" rel="nofollow">nargs</a> - <span id="389">应该读取的命令行参数数目。</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#const" rel="nofollow">const</a> - <span id="390">某些<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#action" rel="nofollow">action</a>和<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#nargs" rel="nofollow">nargs</a>选项要求的常数值。</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#default" rel="nofollow">default</a> - <span id="393">如果命令行中没有出现该参数时的默认值。</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#type" rel="nofollow">type</a> - <span id="394">命令行参数应该被转换成的类型。</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#choices" rel="nofollow">choices</a> - <span id="395">参数可允许的值的一个容器。</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#required" rel="nofollow">required</a> - <span id="396">该命令行选项是否可以省略（只针对可选参数）。</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#help" rel="nofollow">help</a> - <span id="397">参数的简短描述。</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#metavar" rel="nofollow">metavar</a> - <span id="398">参数在帮助信息中的名字。</span></li><li><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#dest" rel="nofollow">dest</a> - <span id="399">给<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow">parse_args()</a>返回的对象要添加的属性名称。</span></li></ul> 
   </dd> 
  </dl> 
  <p><span id="93">下面的小节描述这些参数如何使用。</span></p> 
  <div id="name-or-flags" class="section"> 
   <h4><span id="335">15.4.3.1. name 或 flags 参数</span></h4> 
   <p><span id="94"><a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a> 方法必须知道期望的是可选参数，比如<tt class="docutils literal"><span class="pre">-f</span></tt> 或者<tt class="docutils literal"><span class="pre">--foo</span></tt>，还是位置参数，比如一个文件列表。</span><span id="95">传递给<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a> 的第一个参数因此必须是一个标记序列或者一个简单的参数名字。</span><span id="96">例如，一个可选的参数可以像这样创建：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-f'<span class="p">, <span class="s">'--foo'<span class="p">) </span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="97">而一个位置参数可以像这样创建：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">) </span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="98">当调用<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>时，可选的参数将以<tt class="docutils literal"><span class="pre">-</span></tt> 前缀标识，剩余的参数将被假定为位置参数：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-f'<span class="p">, <span class="s">'--foo'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'BAR'<span class="p">]) <span class="go">Namespace(bar='BAR', foo=None) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'BAR'<span class="p">, <span class="s">'--foo'<span class="p">, <span class="s">'FOO'<span class="p">]) <span class="go">Namespace(bar='BAR', foo='FOO') <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--foo'<span class="p">, <span class="s">'FOO'<span class="p">]) <span class="go">usage: PROG [-h] [-f FOO] bar <span class="go">PROG: error: too few arguments </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
  <div id="action" class="section"> 
   <h4><span id="336">15.4.3.2. action 参数</span></h4> 
   <p><span id="99"><a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a> 对象将命令行参数和动作关联起来。</span><span id="100">这些动作可以完成与命令行参数关联的任何事情，尽管大部分动作只是简单地给<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>返回的对象添加一个属性。</span><span id="101"><tt class="docutils literal"><span class="pre">action</span></tt> 关键字参数指出应该如何处理命令行参数。</span><span id="102">支持的动作有：</span></p> 
   <ul><li> <p class="first"><span id="103"><tt class="docutils literal"><span class="pre">'store'</span></tt> - 只是保存参数的值。</span><span id="104">这是默认的动作。</span><span id="105">例如：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'--foo 1'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo='1') </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> </li><li> <p class="first"><span id="106"><tt class="docutils literal"><span class="pre">'store_const'</span></tt> - 保存由<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#const" rel="nofollow">const</a>关键字参数指出的值。</span><span id="107">（注意<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#const" rel="nofollow">const</a>关键字参数默认是几乎没有帮助的<tt class="xref docutils literal"><span class="pre">None</span></tt>。）</span><span id="108"><tt class="docutils literal"><span class="pre">'store_const'</span></tt>动作最常用于指定某种标记的可选参数。</span><span id="109">例如：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_const'<span class="p">, <span class="n">const<span class="o">=<span class="mi">42<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'--foo'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo=42) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> </li><li> <p class="first"><span id="110"><tt class="docutils literal"><span class="pre">'store_true'</span></tt>和<tt class="docutils literal"><span class="pre">'store_false'</span></tt> - 它们是<tt class="docutils literal"><span class="pre">'store_const'</span></tt> 的特殊情形，分别用于保存值<tt class="xref docutils literal"><span class="pre">True</span></tt>和<tt class="xref docutils literal"><span class="pre">False</span></tt>。</span><span id="111">另外，它们分别会创建默认值False 和True。</span><span id="112">例如：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_true'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--bar'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_false'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--baz'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_false'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'--foo --bar'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bar=False, baz=True, foo=True) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> </li><li> <p class="first"><span id="113"><tt class="docutils literal"><span class="pre">'append'</span></tt> - 保存一个列表，并将每个参数值附加在列表的后面。</span><span id="114">这对于允许指定多次的选项很有帮助。</span><span id="115">示例用法：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">action<span class="o">=<span class="s">'append'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'--foo 1 --foo 2'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo=['1', '2']) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> </li><li> <p class="first"><span id="116"><tt class="docutils literal"><span class="pre">'append_const'</span></tt> - 保存一个列表，并将<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#const" rel="nofollow">const</a>关键字参数指出的值附加在列表的后面。</span><span id="117">（注意<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#const" rel="nofollow">const</a>关键字参数默认是<tt class="xref docutils literal"><span class="pre">None</span></tt>。）</span><span id="118"><tt class="docutils literal"><span class="pre">'append_const'</span></tt> 动作在多个参数需要保存常量到相同的列表时特别有用。</span><span id="119">例如：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--str'<span class="p">, <span class="n">dest<span class="o">=<span class="s">'types'<span class="p">, <span class="n">action<span class="o">=<span class="s">'append_const'<span class="p">, <span class="n">const<span class="o">=<span class="nb">str<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--int'<span class="p">, <span class="n">dest<span class="o">=<span class="s">'types'<span class="p">, <span class="n">action<span class="o">=<span class="s">'append_const'<span class="p">, <span class="n">const<span class="o">=<span class="nb">int<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'--str --int'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(types=[&lt;type 'str'&gt;, &lt;type 'int'&gt;]) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> </li><li> <p class="first"><span id="120"><tt class="docutils literal"><span class="pre">'count'</span></tt> - 计算关键字参数出现的次数。</span><span id="121">例如，这可用于增加详细的级别：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--verbose'<span class="p">, <span class="s">'-v'<span class="p">, <span class="n">action<span class="o">=<span class="s">'count'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'-vvv'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(verbose=3) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> </li><li> <p class="first"><span id="122"><tt class="docutils literal"><span class="pre">'help'</span></tt> - 打印当前解析器中所有选项的完整的帮助信息然后退出。</span><span id="123">默认情况下，help动作会自动添加到解析器中。</span><span id="124">参见<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>以得到如何生成输出信息。</span></p> </li><li> <p class="first"><span id="125"><tt class="docutils literal"><span class="pre">'version'</span></tt> - 它期待<tt class="docutils literal"><span class="pre">version=</span></tt>参数出现在<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a>调用中，在调用时打印出版本信息并退出：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="kn">import <span class="nn">argparse
<span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--version'<span class="p">, <span class="n">action<span class="o">=<span class="s">'version'<span class="p">, <span class="n">version<span class="o">=<span class="s">'<span class="si">%(prog)s<span class="s"> 2.0'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--version'<span class="p">]) <span class="go">PROG 2.0 </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> </li></ul> 
   <p><span id="126">你还可以通过传递一个实现了Action API的对象指定任意一个动作。</span><span id="127">实现该功能的最简单方法是扩展<tt class="xref py py-class docutils literal"><span class="pre">argparse.</span></tt>Action，并提供一个合适的<tt class="docutils literal"><span class="pre">__call__</span></tt>方法。</span><span id="129"><tt class="docutils literal"><span class="pre">__call__</span></tt>方法应该接受四个参数：</span></p> 
   <ul class="simple"><li><tt class="docutils literal"><span class="pre">parser</span></tt> - <span id="472">包含该动作的ArgumentParser对象。</span></li><li><tt class="docutils literal"><span class="pre">namespace</span></tt> - <span id="473"><a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow">parse_args()</a>返回的<a class="reference internal" title="argparse.Namespace" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.Namespace" rel="nofollow">Namespace</a>对象。大部分动作会给该对象添加一个属性。</span></li><li><tt class="docutils literal"><span class="pre">values</span></tt> - <span id="474">相关联的命令行参数于类型转换之后的值。（类型转换方式通过<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow">add_argument()</a>的<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#type" rel="nofollow">type</a>关键字参数指定。）</span></li><li><tt class="docutils literal"><span class="pre">option_string</span></tt> - <span id="475">调用该动作的选项字符串。<tt class="docutils literal"><span class="pre">option_string</span></tt>参数是可选的，如果动作关联的位置参数将不会出现。</span></li></ul> 
   <p><span id="130">自定义动作的例子：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="k">class <span class="nc">FooAction<span class="p">(<span class="n">argparse<span class="o">.<span class="n">Action<span class="p">): <span class="gp">... <span class="k">def <span class="nf">__call__<span class="p">(<span class="bp">self<span class="p">, <span class="n">parser<span class="p">, <span class="n">namespace<span class="p">, <span class="n">values<span class="p">, <span class="n">option_string<span class="o">=<span class="bp">None<span class="p">): <span class="gp">... <span class="k">print <span class="s">'<span class="si">%r<span class="s"> <span class="si">%r<span class="s"> <span class="si">%r<span class="s">' <span class="o">% <span class="p">(<span class="n">namespace<span class="p">, <span class="n">values<span class="p">, <span class="n">option_string<span class="p">) <span class="gp">... <span class="nb">setattr<span class="p">(<span class="n">namespace<span class="p">, <span class="bp">self<span class="o">.<span class="n">dest<span class="p">, <span class="n">values<span class="p">) <span class="gp">... <span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">action<span class="o">=<span class="n">FooAction<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="n">action<span class="o">=<span class="n">FooAction<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">args <span class="o">= <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'1 --foo 2'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bar=None, foo=None) '1' None <span class="go">Namespace(bar='1', foo=None) '2' '--foo' <span class="gp">&gt;&gt;&gt; <span class="n">args <span class="go">Namespace(bar='1', foo='2') </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
  <div id="nargs" class="section"> 
   <h4><span id="337">15.4.3.3. nargs 参数</span></h4> 
   <p><span id="131">ArgumentParser对象通常将一个动作与一个命令行参数关联。</span><span id="132"><tt class="docutils literal"><span class="pre">nargs</span></tt>关键字参数将一个动作与不同数目的命令行参数关联在一起。</span><span id="133">它支持的值有：</span></p> 
   <ul><li> <p class="first"><span id="134"><tt class="docutils literal"><span class="pre">N</span></tt>（一个整数）。</span><span id="135">命令行中的<tt class="docutils literal"><span class="pre">N</span></tt>个参数将被一起收集在一个列表中。</span><span id="136">例如：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">nargs<span class="o">=<span class="mi">2<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="n">nargs<span class="o">=<span class="mi">1<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'c --foo a b'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bar=['c'], foo=['a', 'b']) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> <p><span id="137">注意<tt class="docutils literal"><span class="pre">nargs=1</span></tt>生成一个只有一个元素的列表。</span><span id="138">这和默认的行为是不一样的，默认情况下生成的是元素自己。</span></p> </li><li> <p class="first"><span id="139"><tt class="docutils literal"><span class="pre">'?'</span></tt>。</span><span id="140">如果有的话就从命令行读取一个参数并生成一个元素。</span><span id="141">如果没有对应的命令行参数，则产生一个来自<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#default" rel="nofollow">default</a>的值。</span><span id="142">注意，对于可选参数，有另外一种情况 - 有选项字符串但是后面没有跟随命令行参数。</span><span id="143">在这种情况下，将生成一个来自<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#const" rel="nofollow">const</a>的值。</span><span id="144">用一些例子加以解释：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'?'<span class="p">, <span class="n">const<span class="o">=<span class="s">'c'<span class="p">, <span class="n">default<span class="o">=<span class="s">'d'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'?'<span class="p">, <span class="n">default<span class="o">=<span class="s">'d'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'XX --foo YY'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bar='XX', foo='YY') <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'XX --foo'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bar='XX', foo='c') <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">''<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bar='d', foo='d') </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> <p><span id="145"><tt class="docutils literal"><span class="pre">nargs='?'</span></tt>的一种更常见的用法是允许可选的输入和输出文件：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'infile'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'?'<span class="p">, <span class="nb">type<span class="o">=<span class="n">argparse<span class="o">.<span class="n">FileType<span class="p">(<span class="s">'r'<span class="p">), <span class="gp">... <span class="n">default<span class="o">=<span class="n">sys<span class="o">.<span class="n">stdin<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'outfile'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'?'<span class="p">, <span class="nb">type<span class="o">=<span class="n">argparse<span class="o">.<span class="n">FileType<span class="p">(<span class="s">'w'<span class="p">), <span class="gp">... <span class="n">default<span class="o">=<span class="n">sys<span class="o">.<span class="n">stdout<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'input.txt'<span class="p">, <span class="s">'output.txt'<span class="p">]) <span class="go">Namespace(infile=&lt;open file 'input.txt', mode 'r' at 0x...&gt;, <span class="go"> outfile=&lt;open file 'output.txt', mode 'w' at 0x...&gt;) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([]) <span class="go">Namespace(infile=&lt;open file '&lt;stdin&gt;', mode 'r' at 0x...&gt;, <span class="go"> outfile=&lt;open file '&lt;stdout&gt;', mode 'w' at 0x...&gt;) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> </li><li> <p class="first"><span id="146"><tt class="docutils literal"><span class="pre">'*'</span></tt>。</span><span id="147">出现的所有命令行参数都被收集到一个列表中。</span><span id="148">注意，一般情况下具有多个带有<tt class="docutils literal"><span class="pre">nargs='*'</span></tt>的位置参数是不合理的，但是多个带有<tt class="docutils literal"><span class="pre">nargs='*'</span></tt>的可选参数是可能的。</span><span id="149">例如：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'*'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--bar'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'*'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'baz'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'*'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'a b --foo x y --bar 1 2'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bar=['1', '2'], baz=['a', 'b'], foo=['x', 'y']) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> </li><li> <p class="first"><span id="150"><tt class="docutils literal"><span class="pre">'+'</span></tt>。</span><span id="151">和<tt class="docutils literal"><span class="pre">'*'</span></tt>一样，出现的所有命令行参数都被收集到一个列表中。</span><span id="152">除此之外，如果没有至少出现一个命令行参数将会产生一个错误信息。</span><span id="153">例如：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'foo'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'+'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'a b'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo=['a', 'b']) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">''<span class="o">.<span class="n">split<span class="p">()) <span class="go">usage: PROG [-h] foo [foo ...] <span class="go">PROG: error: too few arguments </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> </li><li> <p class="first"><span id="154"><tt class="docutils literal"><span class="pre">argparse.REMAINDER</span></tt>.</span><span id="156">所有剩余的命令行参数都被收集到一个列表中。</span><span id="157">这通常用于命令行工具分发命令到其它命令行工具：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'command'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'args'<span class="p">, <span class="n">nargs<span class="o">=<span class="n">argparse<span class="o">.<span class="n">REMAINDER<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="k">print <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'--foo B cmd --arg1 XX ZZ'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(args=['--arg1', 'XX', 'ZZ'], command='cmd', foo='B') </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> </li></ul> 
   <p><span id="158">如果没有提供<tt class="docutils literal"><span class="pre">nargs</span></tt>关键字参数，读取的参数个数取决于<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#action" rel="nofollow">action</a>。</span><span id="159">通常这意味着将读取一个命令行参数并产生一个元素（不是一个列表）。</span></p> 
  </div> 
  <div id="const" class="section"> 
   <h4><span id="338">15.4.3.4. const 参数</span></h4> 
   <p><span id="160"><a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a>的<tt class="docutils literal"><span class="pre">const</span></tt> 参数用于保存常量值，它们不是从命令行读入但是是<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a> 的动作所要求的。</span><span id="161">它的两个最常见的用法是：</span></p> 
   <ul class="simple"><li><span id="405">当以<tt class="docutils literal"><span class="pre">action='store_const'</span></tt>或者<tt class="docutils literal"><span class="pre">action='append_const'</span></tt>调用<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow">add_argument()</a>时。</span><span id="406">这些动作向<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow">parse_args()</a>返回对象的一个属性添加<tt class="docutils literal"><span class="pre">const</span></tt>值。</span><span id="407">参见<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#action" rel="nofollow">action</a>的描述。</span></li><li><span id="408">当以选项字符串（例如<tt class="docutils literal"><span class="pre">-f</span></tt>或者<tt class="docutils literal"><span class="pre">--foo</span></tt>和<tt class="docutils literal"><span class="pre">nargs='?'</span></tt>）调用<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow">add_argument()</a>时。</span><span id="409">它创建一个后面可以跟随零个或者一个命令行字符串的可选参数。</span><span id="476">当解析命令行参数时，如果选项字符串后面没有跟随命令行参数，则假定其为<tt class="docutils literal"><span class="pre">const</span></tt>的值。</span><span id="477">参见<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#nargs" rel="nofollow">nargs</a>的描述。</span></li></ul> 
   <p><span id="162"><tt class="docutils literal"><span class="pre">const</span></tt> 关键字的默认值是<tt class="xref docutils literal"><span class="pre">None</span></tt>。</span></p> 
  </div> 
  <div id="default" class="section"> 
   <h4><span id="339">15.4.3.5. default 参数</span></h4> 
   <p><span id="163">所有可选的参数以及某些位置参数可以在命令行中省略。</span><span id="164"><a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a>的<tt class="docutils literal"><span class="pre">default</span></tt>关键字参数，其默认值为<tt class="xref docutils literal"><span class="pre">None</span></tt>，指出如果命令行参数没有出现时它们应该是什么值。</span><span id="165">对于可选参数，<tt class="docutils literal"><span class="pre">default</span></tt>的值用于选项字符串没有出现在命令行中的时候：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">default<span class="o">=<span class="mi">42<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'--foo 2'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo='2') <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">''<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo=42) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="166">如果<tt class="docutils literal"><span class="pre">default</span></tt>的值是一个字符串，解析器将像命令行参数一样解析这个值。</span><span id="167">特别地，在设置<a class="reference internal" title="argparse.Namespace" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.Namespace" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">Namespace</span></tt></a>返回值的属性之前，解析器会调用<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#type" rel="nofollow">type</a>的转换参数。</span><span id="168">否则，解析器就使用其原始值：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--length'<span class="p">, <span class="n">default<span class="o">=<span class="s">'10'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--width'<span class="p">, <span class="n">default<span class="o">=<span class="mf">10.5<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">() <span class="go">Namespace(length=10, width=10.5) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="169">对于<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#nargs" rel="nofollow">nargs</a>等于<tt class="docutils literal"><span class="pre">?</span></tt>或者<tt class="docutils literal"><span class="pre">*</span></tt>的位置参数，<tt class="docutils literal"><span class="pre">default</span></tt>在没有其命令行参数时使用：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'foo'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'?'<span class="p">, <span class="n">default<span class="o">=<span class="mi">42<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'a'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo='a') <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">''<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo=42) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="170"><tt class="docutils literal"><span class="pre">default=argparse.SUPPRESS</span></tt>将导致如果没有命令行参数时不会添加属性：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">default<span class="o">=<span class="n">argparse<span class="o">.<span class="n">SUPPRESS<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([]) <span class="go">Namespace() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--foo'<span class="p">, <span class="s">'1'<span class="p">]) <span class="go">Namespace(foo='1') </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
  <div id="type" class="section"> 
   <h4><span id="340">15.4.3.6. type 参数</span></h4> 
   <p><span id="172">默认情况下，<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>对象以简单字符串方式读入命令行参数。</span><span id="173">然而，很多时候命令行字符串应该被解释成另外一种类型，例如<a class="reference internal" title="float" href="http://python.usyiyi.cn/documents/python_278/library/functions.html#float" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">浮点数</span></tt></a>或者<a class="reference internal" title="int" href="http://python.usyiyi.cn/documents/python_278/library/functions.html#int" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">整数</span></tt></a>。</span><span id="174"><a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a>的<tt class="docutils literal"><span class="pre">type</span></tt>关键字参数允许任意必要的类型检查并作类型转换。</span><span id="175">常见的内建类型和函数可以直接用作<tt class="docutils literal"><span class="pre">type</span></tt>参数的值：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'foo'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">file<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'2 temp.txt'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bar=&lt;open file 'temp.txt', mode 'r' at 0x...&gt;, foo=2) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="176">参见<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#default" rel="nofollow">default</a>关键字参数一节关于何时<tt class="docutils literal"><span class="pre">type</span></tt>参数应用与默认参数的信息。</span></p> 
   <p><span id="177">为了简化各种文件类型的使用，argparse提供了工厂类型FileType，它以<tt class="docutils literal"><span class="pre">file</span></tt>对象的<tt class="docutils literal"><span class="pre">mode=</span></tt>和<tt class="docutils literal"><span class="pre">bufsize=</span></tt>为参数。</span><span id="178">例如，<tt class="docutils literal"><span class="pre">FileType('w')</span></tt>可以用于创建一个可写的文件：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="nb">type<span class="o">=<span class="n">argparse<span class="o">.<span class="n">FileType<span class="p">(<span class="s">'w'<span class="p">)) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'out.txt'<span class="p">]) <span class="go">Namespace(bar=&lt;open file 'out.txt', mode 'w' at 0x...&gt;) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="179"><tt class="docutils literal"><span class="pre">type=</span></tt>可以接受任何可调用类型，只要该类型以一个字符串为参数并且返回转换后的类型：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="k">def <span class="nf">perfect_square<span class="p">(<span class="n">string<span class="p">): <span class="gp">... <span class="n">value <span class="o">= <span class="nb">int<span class="p">(<span class="n">string<span class="p">) <span class="gp">... <span class="n">sqrt <span class="o">= <span class="n">math<span class="o">.<span class="n">sqrt<span class="p">(<span class="n">value<span class="p">) <span class="gp">... <span class="k">if <span class="n">sqrt <span class="o">!= <span class="nb">int<span class="p">(<span class="n">sqrt<span class="p">): <span class="gp">... <span class="n">msg <span class="o">= <span class="s">"<span class="si">%r<span class="s"> is not a perfect square" <span class="o">% <span class="n">string <span class="gp">... <span class="k">raise <span class="n">argparse<span class="o">.<span class="n">ArgumentTypeError<span class="p">(<span class="n">msg<span class="p">) <span class="gp">... <span class="k">return <span class="n">value <span class="gp">... <span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'foo'<span class="p">, <span class="nb">type<span class="o">=<span class="n">perfect_square<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'9'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo=9) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'7'<span class="o">.<span class="n">split<span class="p">()) <span class="go">usage: PROG [-h] foo <span class="go">PROG: error: argument foo: '7' is not a perfect square </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="180"><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#choices" rel="nofollow">choices</a>关键字参数对于简单的某个范围内的类型检查可能更方便：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'foo'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">, <span class="n">choices<span class="o">=<span class="nb">xrange<span class="p">(<span class="mi">5<span class="p">, <span class="mi">10<span class="p">)) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'7'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo=7) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'11'<span class="o">.<span class="n">split<span class="p">()) <span class="go">usage: PROG [-h] {5,6,7,8,9} <span class="go">PROG: error: argument foo: invalid choice: 11 (choose from 5, 6, 7, 8, 9) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="181">更多细节请参阅<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#choices" rel="nofollow">choices</a>一节。</span></p> 
  </div> 
  <div id="choices" class="section"> 
   <h4><span id="341">15.4.3.7. choices 参数</span></h4> 
   <p><span id="182">某些命令行参数应该从一个受限的集合中选择。</span><span id="183">这种情况的处理可以通过传递一个容器对象作为choices关键字参数给<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a>。</span><span id="184">当解析命令行时，将检查参数的值，如果参数不是一个可接受的值则显示一个错误信息：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'game.py'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'move'<span class="p">, <span class="n">choices<span class="o">=<span class="p">[<span class="s">'rock'<span class="p">, <span class="s">'paper'<span class="p">, <span class="s">'scissors'<span class="p">]) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'rock'<span class="p">]) <span class="go">Namespace(move='rock') <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'fire'<span class="p">]) <span class="go">usage: game.py [-h] {rock,paper,scissors} <span class="go">game.py: error: argument move: invalid choice: 'fire' (choose from 'rock', <span class="go">'paper', 'scissors') </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="185">注意choices 容器包含的对象在<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#type" rel="nofollow">type</a>转换之后检查，所以choices容器中对象的类型应该与<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#type" rel="nofollow">type</a>指出的类型相匹配：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'doors.py'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'door'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">, <span class="n">choices<span class="o">=<span class="nb">range<span class="p">(<span class="mi">1<span class="p">, <span class="mi">4<span class="p">)) <span class="gp">&gt;&gt;&gt; <span class="k">print<span class="p">(<span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'3'<span class="p">])) <span class="go">Namespace(door=3) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'4'<span class="p">]) <span class="go">usage: doors.py [-h] {1,2,3} <span class="go">doors.py: error: argument door: invalid choice: 4 (choose from 1, 2, 3) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="186">支持<tt class="docutils literal"><span class="pre">in</span></tt>操作符的任何对象都可以传递给choices作为它的值，所以<a class="reference internal" title="dict" href="http://python.usyiyi.cn/documents/python_278/library/stdtypes.html#dict" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a>对象、<a class="reference internal" title="set" href="http://python.usyiyi.cn/documents/python_278/library/stdtypes.html#set" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">set</span></tt></a>对象以及自定义的容器等等都支持。</span></p> 
  </div> 
  <div id="required" class="section"> 
   <h4><span id="342">15.4.3.8. required 参数</span></h4> 
   <p><span id="187">一般情况下，<a class="reference internal" title="argparse: Command-line option and argument parsing library." href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#module-argparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a>模块假定<tt class="docutils literal"><span class="pre">-f</span></tt>和<tt class="docutils literal"><span class="pre">--bar</span></tt>标记表示可选参数，它们在命令行中可以省略。</span><span id="188">如果要使得选项是必需的，可以指定<tt class="xref docutils literal"><span class="pre">True</span></tt>作为<tt class="docutils literal"><span class="pre">required=</span></tt>关键字参数的值给<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a>：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">required<span class="o">=<span class="bp">True<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--foo'<span class="p">, <span class="s">'BAR'<span class="p">]) <span class="go">Namespace(foo='BAR') <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([]) <span class="go">usage: argparse.py [-h] [--foo FOO] <span class="go">argparse.py: error: option --foo is required </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="189">正如例子所演示的，如果一个命令被标记为<tt class="docutils literal"><span class="pre">required</span></tt>，那么如果命令行中没有出现该参数<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a> 将报告一个错误。</span></p> 
   <div class="admonition note"> 
    <p class="first admonition-title"><span id="190">注意</span></p>   
    <p class="last"><span id="191">Required 选项一般情况下认为是不好的形式因为用户期望选项 是可选 的，因此应该尽可能避免这种形式。</span></p> 
   </div> 
  </div> 
  <div id="help" class="section"> 
   <h4><span id="343">15.4.3.9. help 参数</span></h4> 
   <p><span id="192"><tt class="docutils literal"><span class="pre">help</span></tt>的值是一个包含参数简短描述的字符串。</span><span id="193">当用户要求帮助时（通常通过使用<tt class="docutils literal"><span class="pre">-h</span></tt>或者<tt class="docutils literal"><span class="pre">--help</span></tt> at the command line），这些<tt class="docutils literal"><span class="pre">help</span></tt>的描述将随每个参数一起显示出来：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'frobble'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_true'<span class="p">, <span class="gp">... <span class="n">help<span class="o">=<span class="s">'foo the bars before frobbling'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'+'<span class="p">, <span class="gp">... <span class="n">help<span class="o">=<span class="s">'one of the bars to be frobbled'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'-h'<span class="o">.<span class="n">split<span class="p">()) <span class="go">usage: frobble [-h] [--foo] bar [bar ...] <span class="go">positional arguments: <span class="go"> bar one of the bars to be frobbled <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="go"> --foo foo the bars before frobbling </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="194"><tt class="docutils literal"><span class="pre">help</span></tt>字符串可以包含各种格式指示符以避免如程序名字和参数<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#default" rel="nofollow">default</a>的重复。</span><span id="195">可用的指示符包括程序的名称<tt class="docutils literal"><span class="pre">%(prog)s</span></tt>以及大部分<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a>的关键字参数，例如<tt class="docutils literal"><span class="pre">%(default)s</span></tt>、<tt class="docutils literal"><span class="pre">%(type)s</span></tt>等：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'frobble'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'?'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">, <span class="n">default<span class="o">=<span class="mi">42<span class="p">, <span class="gp">... <span class="n">help<span class="o">=<span class="s">'the bar to <span class="si">%(prog)s<span class="s"> (default: <span class="si">%(default)s<span class="s">)'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: frobble [-h] [bar] <span class="go">positional arguments: <span class="go"> bar the bar to frobble (default: 42) <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="196">通过设置<tt class="docutils literal"><span class="pre">help</span></tt>值为<tt class="docutils literal"><span class="pre">argparse.SUPPRESS</span></tt>，<a class="reference internal" title="argparse: Command-line option and argument parsing library." href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#module-argparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a>支持隐藏特定选项的帮助：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'frobble'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">help<span class="o">=<span class="n">argparse<span class="o">.<span class="n">SUPPRESS<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: frobble [-h] <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
  <div id="metavar" class="section"> 
   <h4><span id="344">15.4.3.10. metavar 参数</span></h4> 
   <p><span id="198">当<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>生成帮助信息时，它需要以某种方式引用每一个参数。 </span><span id="199">默认情况下，ArgumentParser对象使用<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#dest" rel="nofollow">dest</a>的值作为每个对象的“名字”。</span><span id="200">默认情况下，对于位置参数直接使用<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#dest" rel="nofollow">dest</a>的值，对于可选参数则将<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#dest" rel="nofollow">dest</a>的值变为大写。</span><span id="201">所以，位置参数<tt class="docutils literal"><span class="pre">dest='bar'</span></tt>将引用成<tt class="docutils literal"><span class="pre">bar</span></tt>。</span><span id="202">后面带有一个命令行参数的可选参数<tt class="docutils literal"><span class="pre">--foo</span></tt>将引用成<tt class="docutils literal"><span class="pre">FOO</span></tt>。</span><span id="203">一个例子：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'X --foo Y'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bar='X', foo='Y') <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: [-h] [--foo FOO] bar <span class="go">positional arguments: <span class="go"> bar <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="go"> --foo FOO </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="204">可以用<tt class="docutils literal"><span class="pre">metavar</span></tt>指定另外一个名字：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">metavar<span class="o">=<span class="s">'YYY'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="n">metavar<span class="o">=<span class="s">'XXX'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'X --foo Y'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bar='X', foo='Y') <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: [-h] [--foo YYY] XXX <span class="go">positional arguments: <span class="go"> XXX <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="go"> --foo YYY </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="205">注意<tt class="docutils literal"><span class="pre">metavar</span></tt>只会改变显示出来的名字 - <a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a> 对象中属性的名字仍然由<a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#dest" rel="nofollow">dest</a>的值决定。</span></p> 
   <p><span id="206"><tt class="docutils literal"><span class="pre">nargs</span></tt>的不同值可能导致metavar使用多次。</span><span id="207">传递一个列表给<tt class="docutils literal"><span class="pre">metavar</span></tt>将给每个参数指定一个不同的显示名字：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-x'<span class="p">, <span class="n">nargs<span class="o">=<span class="mi">2<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">nargs<span class="o">=<span class="mi">2<span class="p">, <span class="n">metavar<span class="o">=<span class="p">(<span class="s">'bar'<span class="p">, <span class="s">'baz'<span class="p">)) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: PROG [-h] [-x X X] [--foo bar baz] <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="go"> -x X X <span class="go"> --foo bar baz </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
  <div id="dest" class="section"> 
   <h4><span id="345">15.4.3.11. dest 参数</span></h4> 
   <p><span id="208">大部分<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>动作给<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>返回对象的某个属性添加某些值。</span><span id="209">该属性的名字由<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a>的<tt class="docutils literal"><span class="pre">dest</span></tt>关键字参数决定。</span><span id="210">对于位置参数的动作，<tt class="docutils literal"><span class="pre">dest</span></tt> 通常作为第一个参数提供给<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a>：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'XXX'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bar='XXX') </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="211">对于可选参数的动作，<tt class="docutils literal"><span class="pre">dest</span></tt>的动作通常从选项字符串推导出来。</span><span id="212"><a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>生成的<tt class="docutils literal"><span class="pre">dest</span></tt>的值是将第一个长的选项字符串前面的<tt class="docutils literal"><span class="pre">--</span></tt>字符串去掉。</span><span id="213">如果没有提供长选项字符串，<tt class="docutils literal"><span class="pre">dest</span></tt>的获得则是将第一个短选项字符串前面的<tt class="docutils literal"><span class="pre">-</span></tt>字符去掉。</span><span id="214">任何内部的<tt class="docutils literal"><span class="pre">-</span></tt>将被转换为<tt class="docutils literal"><span class="pre">_</span></tt>字符以确保字符串是合法的属性名字。</span><span id="215">下面的实例解释了这个行为：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-f'<span class="p">, <span class="s">'--foo-bar'<span class="p">, <span class="s">'--foo'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-x'<span class="p">, <span class="s">'-y'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'-f 1 -x 2'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo_bar='1', x='2') <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'--foo 1 -y 2'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo_bar='1', x='2') </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="216"><tt class="docutils literal"><span class="pre">dest</span></tt>允许提供自定义的属性名：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">dest<span class="o">=<span class="s">'bar'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'--foo XXX'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bar='XXX') </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
 </div> 
 <p> </p> 
 <div id="the-parse-args-method" class="section"> 
  <h3><span id="317">15.4.4. parse_args() 方法</span></h3> 
  <dl class="method"> 
    
    <tt class="descclassname">ArgumentParser.</tt> 
    <tt class="descname">parse_args</tt> 
    <big>(</big>args=None, namespace=None 
    <big>)</big> 
    
   <dd> 
    <p><span id="217">将参数字符串转换成对象并设置成命名空间的属性。</span><span id="218">返回构成的命名空间。</span></p> 
    <p><span id="219">之前对<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a> 的调用完全决定了创建什么对象以及如何设置。</span><span id="220">详见<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a>的文档。</span></p> 
    <p><span id="221">默认情况下，参数字符串取自于<a class="reference internal" title="sys.argv" href="http://python.usyiyi.cn/documents/python_278/library/sys.html#sys.argv" rel="nofollow"><tt class="xref py py-data docutils literal"><span class="pre">sys.argv</span></tt></a>，并创建一个空的<a class="reference internal" title="argparse.Namespace" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.Namespace" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">Namespace</span></tt></a>对象用于保存属性。</span></p> 
   </dd> 
  </dl> 
  <div id="option-value-syntax" class="section"> 
   <h4><span id="346">15.4.4.1. 可选值的语法</span></h4> 
   <p><span id="222"><a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>方法支持几种指定一个选项的值的方法。</span><span id="223">最简单的方法是，将选项和它的值以两个分开的参数传递：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-x'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'-x X'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo=None, x='X') <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'--foo FOO'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo='FOO', x=None) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="224">对于长选项（名字长度超过一个字符的选项），选项和它的值还可以用一个单一的命令行参数传递，并用<tt class="docutils literal"><span class="pre">=</span></tt>分隔它们：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'--foo=FOO'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo='FOO', x=None) </span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="225">对于短选项（长度只有一个字符的选项），选项及其值可以连在一起：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'-xX'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(foo=None, x='X') </span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="226">几个短选项可以连在一起仅使用一个<tt class="docutils literal"><span class="pre">-</span></tt>前缀，只要只有最后一个选项要求有值或者都不要有值：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-x'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_true'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-y'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_true'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-z'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'-xyzZ'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(x=True, y=True, z='Z') </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
  <div id="invalid-arguments" class="section"> 
   <h4><span id="347">15.4.4.2. 非法的参数</span></h4> 
   <p><span id="227">在解析命令行的同时，<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>会检查各种错误，包括有歧义的选项、不合法的类型、不合法的选项、错误的位置参数个数等等。</span><span id="228">当它遇到此类错误时，会退出并跟随用法信息一起打印出错误：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'?'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="c"># invalid type <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--foo'<span class="p">, <span class="s">'spam'<span class="p">]) <span class="go">usage: PROG [-h] [--foo FOO] [bar] <span class="go">PROG: error: argument --foo: invalid int value: 'spam' <span class="gp">&gt;&gt;&gt; <span class="c"># invalid option <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--bar'<span class="p">]) <span class="go">usage: PROG [-h] [--foo FOO] [bar] <span class="go">PROG: error: no such option: --bar <span class="gp">&gt;&gt;&gt; <span class="c"># wrong number of arguments <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'spam'<span class="p">, <span class="s">'badger'<span class="p">]) <span class="go">usage: PROG [-h] [--foo FOO] [bar] <span class="go">PROG: error: extra arguments found: badger </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
  <div id="arguments-containing" class="section"> 
   <h4><span id="348">15.4.4.3. Arguments containing </span><tt class="docutils literal"><span class="pre">-</span></tt></h4> 
   <p><span id="229"><a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>方法每当用户犯了明确的错误时会努力给出错误信息，但是有些情况天生就有歧义。</span><span id="230">例如，命令行参数<tt class="docutils literal"><span class="pre">-1</span></tt>既可以是想指明一个选项也可以是想提供一个位置参数。</span><span id="231">这里<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>会非常小心：位置参数只有在它们看上去像负数且解析器中没有选项看上去是负数时才可以以<tt class="docutils literal"><span class="pre">-</span></tt>开始：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-x'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'foo'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'?'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="c"># no negative number options, so -1 is a positional argument <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'-x'<span class="p">, <span class="s">'-1'<span class="p">]) <span class="go">Namespace(foo=None, x='-1') <span class="gp">&gt;&gt;&gt; <span class="c"># no negative number options, so -1 and -5 are positional arguments <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'-x'<span class="p">, <span class="s">'-1'<span class="p">, <span class="s">'-5'<span class="p">]) <span class="go">Namespace(foo='-5', x='-1') <span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-1'<span class="p">, <span class="n">dest<span class="o">=<span class="s">'one'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'foo'<span class="p">, <span class="n">nargs<span class="o">=<span class="s">'?'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="c"># negative number options present, so -1 is an option <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'-1'<span class="p">, <span class="s">'X'<span class="p">]) <span class="go">Namespace(foo=None, one='X') <span class="gp">&gt;&gt;&gt; <span class="c"># negative number options present, so -2 is an option <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'-2'<span class="p">]) <span class="go">usage: PROG [-h] [-1 ONE] [foo] <span class="go">PROG: error: no such option: -2 <span class="gp">&gt;&gt;&gt; <span class="c"># negative number options present, so both -1s are options <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'-1'<span class="p">, <span class="s">'-1'<span class="p">]) <span class="go">usage: PROG [-h] [-1 ONE] [foo] <span class="go">PROG: error: argument -1: expected one argument </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="232">如果你有必须以<tt class="docutils literal"><span class="pre">-</span></tt> 开始的位置参数且不是负数，你可以插入伪参数<tt class="docutils literal"><span class="pre">'--'</span></tt>告诉<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>其后的所有内容都为位置参数：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--'<span class="p">, <span class="s">'-f'<span class="p">]) <span class="go">Namespace(foo='-f', one=None) </span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
  <div id="argument-abbreviations-prefix-matching" class="section"> 
   <h4><span id="349">15.4.4.4. 参数的缩写（前缀匹配）</span></h4> 
   <p><span id="233"><a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>方法允许长选项简写成一个前缀，如果简写的形式没有歧义（前缀只匹配唯一的一个选项）：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-bacon'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-badger'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'-bac MMM'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bacon='MMM', badger=None) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'-bad WOOD'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(bacon=None, badger='WOOD') <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'-ba BA'<span class="o">.<span class="n">split<span class="p">()) <span class="go">usage: PROG [-h] [-bacon BACON] [-badger BADGER] <span class="go">PROG: error: ambiguous option: -ba could match -badger, -bacon </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="234">如果参数可能匹配多个选项则生成一个错误信息。</span></p> 
  </div> 
  <div id="beyond-sys-argv" class="section"> 
   <h4><span id="350">15.4.4.5. Beyond </span><tt class="docutils literal"><span class="pre">sys.argv</span></tt></h4> 
   <p><span id="235">有时候可能需要ArgumentParser解析的参数不是来自<a class="reference internal" title="sys.argv" href="http://python.usyiyi.cn/documents/python_278/library/sys.html#sys.argv" rel="nofollow"><tt class="xref py py-data docutils literal"><span class="pre">sys.argv</span></tt></a>。</span><span id="236">这可以通过传递一个字符串列表给<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>来完成。</span><span id="237">这在交互式命令行中测试时很有用：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">( <span class="gp">... <span class="s">'integers'<span class="p">, <span class="n">metavar<span class="o">=<span class="s">'int'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">, <span class="n">choices<span class="o">=<span class="nb">xrange<span class="p">(<span class="mi">10<span class="p">), <span class="gp">... <span class="n">nargs<span class="o">=<span class="s">'+'<span class="p">, <span class="n">help<span class="o">=<span class="s">'an integer in the range 0..9'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">( <span class="gp">... <span class="s">'--sum'<span class="p">, <span class="n">dest<span class="o">=<span class="s">'accumulate'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_const'<span class="p">, <span class="n">const<span class="o">=<span class="nb">sum<span class="p">, <span class="gp">... <span class="n">default<span class="o">=<span class="nb">max<span class="p">, <span class="n">help<span class="o">=<span class="s">'sum the integers (default: find the max)'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'1'<span class="p">, <span class="s">'2'<span class="p">, <span class="s">'3'<span class="p">, <span class="s">'4'<span class="p">]) <span class="go">Namespace(accumulate=&lt;built-in function max&gt;, integers=[1, 2, 3, 4]) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'1 2 3 4 --sum'<span class="o">.<span class="n">split<span class="p">()) <span class="go">Namespace(accumulate=&lt;built-in function sum&gt;, integers=[1, 2, 3, 4]) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
  <div id="the-namespace-object" class="section"> 
   <h4><span id="351">15.4.4.6. Namespace 对象</span></h4> 
   <dl class="class"> 
     
     <span class="property">class <tt class="descclassname">argparse.</tt><tt class="descname">Namespace</tt></span> 
     
    <dd> 
     <p><span id="238"><a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a> 默认使用的简单的类，用于创建一个保存属性的对象并返回该对象。</span></p> 
    </dd> 
   </dl> 
   <p><span id="239">这个类故意设计得非常简单，只是<a class="reference internal" title="object" href="http://python.usyiyi.cn/documents/python_278/library/functions.html#object" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></a>的一个可以打印可读字符串的子类。</span><span id="240">如果你喜欢以字典的形式查看其属性，可以使用Python标准的语句<a class="reference internal" title="vars" href="http://python.usyiyi.cn/documents/python_278/library/functions.html#vars" rel="nofollow"><tt class="xref py py-func docutils literal"><span class="pre">vars()</span></tt></a>：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">args <span class="o">= <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--foo'<span class="p">, <span class="s">'BAR'<span class="p">]) <span class="gp">&gt;&gt;&gt; <span class="nb">vars<span class="p">(<span class="n">args<span class="p">) <span class="go">{'foo': 'BAR'} </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <p><span id="241">有时可能需要让<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>分配属性给一个已经存在的对象而不是一个新的<a class="reference internal" title="argparse.Namespace" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.Namespace" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">Namespace</span></tt></a>对象。</span><span id="242">这可以通过指定<tt class="docutils literal"><span class="pre">namespace=</span></tt>关键字参数达到：</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="k">class <span class="nc">C<span class="p">(<span class="nb">object<span class="p">): <span class="gp">... <span class="k">pass <span class="gp">... <span class="gp">&gt;&gt;&gt; <span class="n">c <span class="o">= <span class="n">C<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="n">args<span class="o">=<span class="p">[<span class="s">'--foo'<span class="p">, <span class="s">'BAR'<span class="p">], <span class="n">namespace<span class="o">=<span class="n">c<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">c<span class="o">.<span class="n">foo <span class="go">'BAR' </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
  </div> 
 </div> 
 <p> </p> 
 <div id="other-utilities" class="section"> 
  <h3><span id="318">15.4.5. 其它实用工具</span></h3> 
  <div id="sub-commands" class="section"> 
   <h4><span id="352">15.4.5.1. 子命令</span></h4> 
   <dl class="method"> 
     
     <tt class="descclassname">ArgumentParser.</tt> 
     <tt class="descname">add_subparsers</tt> 
     <big>(</big> 
     <span class="optional">[title<span class="optional">]<span class="optional">[, description<span class="optional">]<span class="optional">[, prog<span class="optional">]<span class="optional">[, parser_class<span class="optional">]<span class="optional">[, action<span class="optional">]<span class="optional">[, option_string<span class="optional">]<span class="optional">[, dest<span class="optional">]<span class="optional">[, help<span class="optional">]<span class="optional">[,metavar<span class="optional">]<big>)</big></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> 
     
    <dd> 
     <p><span id="243">许多程序将它们的功能分成多个子命令，例如，<tt class="docutils literal"><span class="pre">svn</span></tt>可以调用如<tt class="docutils literal"><span class="pre">svn <span class="pre">checkout</span></span></tt>、<tt class="docutils literal"><span class="pre">svn <span class="pre">update</span></span></tt>和<tt class="docutils literal"><span class="pre">svn <span class="pre">commit</span></span></tt>子命令。</span><span id="244">在程序实现的几个不同的功能要求不同类型的命令行参数时，以这种方式分割程序的功能是特别好的主意。</span><span id="245"><a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>支持用<a class="reference internal" title="argparse.ArgumentParser.add_subparsers" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_subparsers" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_subparsers()</span></tt></a>方法创建这种子命令。</span><span id="246"><a class="reference internal" title="argparse.ArgumentParser.add_subparsers" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_subparsers" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_subparsers()</span></tt></a> 方法的调用通常不带参数并返回一个特殊的动作对象。</span><span id="247">该对象只有一个方法<tt class="xref py py-meth docutils literal"><span class="pre">add_parser()</span></tt>，它的参数是一个命令行名字和任意<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>构造器，返回的是一个可以像平常一样修改的<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>对象。</span></p> 
     <p><span id="248">参数的描述：</span></p> 
     <ul class="simple"><li>title - <span id="485">在输出的帮助中子解析器组的标题；默认情况下，如果提供description参数则为“subcommands”，否则使用位置参数的标题</span></li><li>description - <span id="486">在输出的帮助中子解析器组的描述，默认为None</span></li><li>prog - <span id="487">与子命令的帮助一起显示的使用帮助信息，默认为程序的名字和子解析器参数之前的所有位置参数</span></li><li>parser_class - <span id="488">用于创建子解析器实例的类，默认为当前的解析器（例如ArgumentParser）</span></li><li>dest - <span id="489">子命令的名字应该存储的属性名称；默认为None且不存储任何值</span></li><li>help - <span id="490">在输出的帮助中子解析器中的帮助信息，默认为None</span></li><li>metavar - <span id="491">在帮助中表示可用的子命令的字符串；默认为None并以{cmd1, cmd2, ..}的形式表示子命令</span></li></ul> 
     <p><span id="249">一些示例用法：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="c"># create the top-level parser
<span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_true'<span class="p">, <span class="n">help<span class="o">=<span class="s">'foo help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">subparsers <span class="o">= <span class="n">parser<span class="o">.<span class="n">add_subparsers<span class="p">(<span class="n">help<span class="o">=<span class="s">'sub-command help'<span class="p">) <span class="go">&gt;&gt;&gt; <span class="gp">&gt;&gt;&gt; <span class="c"># create the parser for the "a" command <span class="gp">&gt;&gt;&gt; <span class="n">parser_a <span class="o">= <span class="n">subparsers<span class="o">.<span class="n">add_parser<span class="p">(<span class="s">'a'<span class="p">, <span class="n">help<span class="o">=<span class="s">'a help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser_a<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">, <span class="n">help<span class="o">=<span class="s">'bar help'<span class="p">) <span class="go">&gt;&gt;&gt; <span class="gp">&gt;&gt;&gt; <span class="c"># create the parser for the "b" command <span class="gp">&gt;&gt;&gt; <span class="n">parser_b <span class="o">= <span class="n">subparsers<span class="o">.<span class="n">add_parser<span class="p">(<span class="s">'b'<span class="p">, <span class="n">help<span class="o">=<span class="s">'b help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser_b<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--baz'<span class="p">, <span class="n">choices<span class="o">=<span class="s">'XYZ'<span class="p">, <span class="n">help<span class="o">=<span class="s">'baz help'<span class="p">) <span class="go">&gt;&gt;&gt; <span class="gp">&gt;&gt;&gt; <span class="c"># parse some argument lists <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'a'<span class="p">, <span class="s">'12'<span class="p">]) <span class="go">Namespace(bar=12, foo=False) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--foo'<span class="p">, <span class="s">'b'<span class="p">, <span class="s">'--baz'<span class="p">, <span class="s">'Z'<span class="p">]) <span class="go">Namespace(baz='Z', foo=True) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
     <p><span id="250">注意<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>返回的对象只包含主解析器和命令行选择的子解析器（不包含任何其它子解析器）的属性。</span><span id="251">所以在上面的示例中，当指定<tt class="docutils literal"><span class="pre">a</span></tt>命令时，只有<tt class="docutils literal"><span class="pre">foo</span></tt>和<tt class="docutils literal"><span class="pre">bar</span></tt>属性，当指定<tt class="docutils literal"><span class="pre">b</span></tt>命令时，只有<tt class="docutils literal"><span class="pre">foo</span></tt>和<tt class="docutils literal"><span class="pre">baz</span></tt> 属性。</span></p> 
     <p><span id="252">类似地，当查看子命令的帮助信息时，只有特定的解析器的帮助会打印出来。</span><span id="253">帮助信息不包括父解析器和兄弟解析器的信息。</span><span id="254">（然而，可以通过提供<tt class="docutils literal"><span class="pre">help=</span></tt>参数给<tt class="xref py py-meth docutils literal"><span class="pre">add_parser()</span></tt>来给每个子命令添加帮助信息。）</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--help'<span class="p">]) <span class="go">usage: PROG [-h] [--foo] {a,b} ... <span class="go">positional arguments: <span class="go"> {a,b} sub-command help <span class="go"> a a help <span class="go"> b b help <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="go"> --foo foo help <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'a'<span class="p">, <span class="s">'--help'<span class="p">]) <span class="go">usage: PROG a [-h] bar <span class="go">positional arguments: <span class="go"> bar bar help <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'b'<span class="p">, <span class="s">'--help'<span class="p">]) <span class="go">usage: PROG b [-h] [--baz {X,Y,Z}] <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="go"> --baz {X,Y,Z} baz help </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
     <p><span id="255"><a class="reference internal" title="argparse.ArgumentParser.add_subparsers" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_subparsers" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_subparsers()</span></tt></a>方法还支持<tt class="docutils literal"><span class="pre">title</span></tt>和<tt class="docutils literal"><span class="pre">description</span></tt>关键字参数。</span><span id="256">当任意一个出现时，在输出的帮助中子命令将出现在它们自己的组里。</span><span id="257">例如：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">subparsers <span class="o">= <span class="n">parser<span class="o">.<span class="n">add_subparsers<span class="p">(<span class="n">title<span class="o">=<span class="s">'subcommands'<span class="p">, <span class="gp">... <span class="n">description<span class="o">=<span class="s">'valid subcommands'<span class="p">, <span class="gp">... <span class="n">help<span class="o">=<span class="s">'additional help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">subparsers<span class="o">.<span class="n">add_parser<span class="p">(<span class="s">'foo'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">subparsers<span class="o">.<span class="n">add_parser<span class="p">(<span class="s">'bar'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'-h'<span class="p">]) <span class="go">usage: [-h] {foo,bar} ... <span class="go">optional arguments: <span class="go"> -h, --help show this help message and exit <span class="go">subcommands: <span class="go"> valid subcommands <span class="go"> {foo,bar} additional help </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
     <p><span id="258">处理子命令的一个特别有效的方法是将<a class="reference internal" title="argparse.ArgumentParser.add_subparsers" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_subparsers" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_subparsers()</span></tt></a>方法和<a class="reference internal" title="argparse.ArgumentParser.set_defaults" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.set_defaults" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">set_defaults()</span></tt></a> 调用绑在一起使用，这样每个子命令就可以知道它应该执行哪个Python 函数。</span><span id="259">例如：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="c"># sub-command functions
<span class="gp">&gt;&gt;&gt; <span class="k">def <span class="nf">foo<span class="p">(<span class="n">args<span class="p">): <span class="gp">... <span class="k">print <span class="n">args<span class="o">.<span class="n">x <span class="o">* <span class="n">args<span class="o">.<span class="n">y <span class="gp">... <span class="gp">&gt;&gt;&gt; <span class="k">def <span class="nf">bar<span class="p">(<span class="n">args<span class="p">): <span class="gp">... <span class="k">print <span class="s">'((<span class="si">%s<span class="s">))' <span class="o">% <span class="n">args<span class="o">.<span class="n">z <span class="gp">... <span class="gp">&gt;&gt;&gt; <span class="c"># create the top-level parser <span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">subparsers <span class="o">= <span class="n">parser<span class="o">.<span class="n">add_subparsers<span class="p">() <span class="go">&gt;&gt;&gt; <span class="gp">&gt;&gt;&gt; <span class="c"># create the parser for the "foo" command <span class="gp">&gt;&gt;&gt; <span class="n">parser_foo <span class="o">= <span class="n">subparsers<span class="o">.<span class="n">add_parser<span class="p">(<span class="s">'foo'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser_foo<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-x'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">, <span class="n">default<span class="o">=<span class="mi">1<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser_foo<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'y'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">float<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser_foo<span class="o">.<span class="n">set_defaults<span class="p">(<span class="n">func<span class="o">=<span class="n">foo<span class="p">) <span class="go">&gt;&gt;&gt; <span class="gp">&gt;&gt;&gt; <span class="c"># create the parser for the "bar" command <span class="gp">&gt;&gt;&gt; <span class="n">parser_bar <span class="o">= <span class="n">subparsers<span class="o">.<span class="n">add_parser<span class="p">(<span class="s">'bar'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser_bar<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'z'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser_bar<span class="o">.<span class="n">set_defaults<span class="p">(<span class="n">func<span class="o">=<span class="n">bar<span class="p">) <span class="go">&gt;&gt;&gt; <span class="gp">&gt;&gt;&gt; <span class="c"># parse the args and call whatever function was selected <span class="gp">&gt;&gt;&gt; <span class="n">args <span class="o">= <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'foo 1 -x 2'<span class="o">.<span class="n">split<span class="p">()) <span class="gp">&gt;&gt;&gt; <span class="n">args<span class="o">.<span class="n">func<span class="p">(<span class="n">args<span class="p">) <span class="go">2.0 <span class="go">&gt;&gt;&gt; <span class="gp">&gt;&gt;&gt; <span class="c"># parse the args and call whatever function was selected <span class="gp">&gt;&gt;&gt; <span class="n">args <span class="o">= <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">(<span class="s">'bar XYZYX'<span class="o">.<span class="n">split<span class="p">()) <span class="gp">&gt;&gt;&gt; <span class="n">args<span class="o">.<span class="n">func<span class="p">(<span class="n">args<span class="p">) <span class="go">((XYZYX)) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
     <p><span id="260">这样的话，你可以让<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>在参数解析完成之后去做调用适当的函数的工作。</span><span id="261">像这种方式将函数和动作关联起来是最简单的方法来处理你每个子命令的不同动作。</span><span id="262">然而，如果需要检查调用的子命令的名字，用<tt class="docutils literal"><span class="pre">dest</span></tt>关键字参数调用<a class="reference internal" title="argparse.ArgumentParser.add_subparsers" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_subparsers" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_subparsers()</span></tt></a> 就可以：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">subparsers <span class="o">= <span class="n">parser<span class="o">.<span class="n">add_subparsers<span class="p">(<span class="n">dest<span class="o">=<span class="s">'subparser_name'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">subparser1 <span class="o">= <span class="n">subparsers<span class="o">.<span class="n">add_parser<span class="p">(<span class="s">'1'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">subparser1<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'-x'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">subparser2 <span class="o">= <span class="n">subparsers<span class="o">.<span class="n">add_parser<span class="p">(<span class="s">'2'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">subparser2<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'y'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'2'<span class="p">, <span class="s">'frobble'<span class="p">]) <span class="go">Namespace(subparser_name='2', y='frobble') </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
    </dd> 
   </dl> 
  </div> 
  <div id="filetype-objects" class="section"> 
   <h4><span id="353">15.4.5.2. FileType 对象</span></h4> 
   <dl class="class"> 
     
     <span class="property">class <tt class="descclassname">argparse.</tt><tt class="descname">FileType</tt><big>(</big>mode='r', bufsize=None<big>)</big></span> 
     
    <dd> 
     <p><span id="263"><a class="reference internal" title="argparse.FileType" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.FileType" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">FileType</span></tt></a>创建可以传递给<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">ArgumentParser.add_argument()</span></tt></a>的type参数的对象。</span><span id="264">以<a class="reference internal" title="argparse.FileType" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.FileType" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">FileType</span></tt></a>对象为类型的参数将用要求的模式和缓冲区大小来打开命令行参数作为文件：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--output'<span class="p">, <span class="nb">type<span class="o">=<span class="n">argparse<span class="o">.<span class="n">FileType<span class="p">(<span class="s">'wb'<span class="p">, <span class="mi">0<span class="p">)) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--output'<span class="p">, <span class="s">'out'<span class="p">]) <span class="go">Namespace(output=&lt;open file 'out', mode 'wb' at 0x...&gt;) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
     <p><span id="265">FileType对象能够理解伪参数<tt class="docutils literal"><span class="pre">'-'</span></tt> 并主动将它转换成<tt class="docutils literal"><span class="pre">sys.stdin</span></tt>作为可读的<a class="reference internal" title="argparse.FileType" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.FileType" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">FileType</span></tt></a>对象和<tt class="docutils literal"><span class="pre">sys.stdout</span></tt>作为可写的<a class="reference internal" title="argparse.FileType" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.FileType" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">FileType</span></tt></a>对象：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'infile'<span class="p">, <span class="nb">type<span class="o">=<span class="n">argparse<span class="o">.<span class="n">FileType<span class="p">(<span class="s">'r'<span class="p">)) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'-'<span class="p">]) <span class="go">Namespace(infile=&lt;open file '&lt;stdin&gt;', mode 'r' at 0x...&gt;) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
    </dd> 
   </dl> 
  </div> 
  <div id="argument-groups" class="section"> 
   <h4><span id="354">15.4.5.3. Argument groups</span></h4> 
   <dl class="method"> 
     
     <tt class="descclassname">ArgumentParser.</tt> 
     <tt class="descname">add_argument_group</tt> 
     <big>(</big>title=None, description=None 
     <big>)</big> 
     
    <dd> 
     <p><span id="266">默认情况下，在显示帮助信息的时候<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>将命令行参数分成“位置参数”和“可选参数”两个组。</span><span id="267">当有比这个默认的分组更好的分组时，可以使用<a class="reference internal" title="argparse.ArgumentParser.add_argument_group" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument_group" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument_group()</span></tt></a>方法创建合适的分组：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">, <span class="n">add_help<span class="o">=<span class="bp">False<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">group <span class="o">= <span class="n">parser<span class="o">.<span class="n">add_argument_group<span class="p">(<span class="s">'group'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">group<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">help<span class="o">=<span class="s">'foo help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">group<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">, <span class="n">help<span class="o">=<span class="s">'bar help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: PROG [--foo FOO] bar <span class="go">group: <span class="go"> bar bar help <span class="go"> --foo FOO foo help </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
     <p><span id="268"><a class="reference internal" title="argparse.ArgumentParser.add_argument_group" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument_group" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument_group()</span></tt></a>方法返回的参数分组对象具有一个和普通的<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>一样的<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a>方法。</span><span id="269">当有参数添加进这个分组时解析器会以正常的参数对待，但是在帮助信息中显示在一个单独的分组里。</span><span id="270"><a class="reference internal" title="argparse.ArgumentParser.add_argument_group" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument_group" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument_group()</span></tt></a>方法接受title和description参数可以用来定制显示：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">, <span class="n">add_help<span class="o">=<span class="bp">False<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">group1 <span class="o">= <span class="n">parser<span class="o">.<span class="n">add_argument_group<span class="p">(<span class="s">'group1'<span class="p">, <span class="s">'group1 description'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">group1<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'foo'<span class="p">, <span class="n">help<span class="o">=<span class="s">'foo help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">group2 <span class="o">= <span class="n">parser<span class="o">.<span class="n">add_argument_group<span class="p">(<span class="s">'group2'<span class="p">, <span class="s">'group2 description'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">group2<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--bar'<span class="p">, <span class="n">help<span class="o">=<span class="s">'bar help'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">print_help<span class="p">() <span class="go">usage: PROG [--bar BAR] foo <span class="go">group1: <span class="go"> group1 description <span class="go"> foo foo help <span class="go">group2: <span class="go"> group2 description <span class="go"> --bar BAR bar help </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
     <p><span id="271">注意任何没有加入到你自定义的分组中的参数仍将放在通常的“位置参数”和“可选参数”部分。</span></p> 
    </dd> 
   </dl> 
  </div> 
  <div id="mutual-exclusion" class="section"> 
   <h4><span id="355">15.4.5.4. 互斥分组</span></h4> 
   <dl class="method"> 
     
     <tt class="descclassname">ArgumentParser.</tt> 
     <tt class="descname">add_mutually_exclusive_group</tt> 
     <big>(</big>required=False 
     <big>)</big> 
     
    <dd> 
     <p><span id="272">创建一个互斥分组。</span><span id="273"><a class="reference internal" title="argparse: Command-line option and argument parsing library." href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#module-argparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a>将确保互斥分组中的一个参数出现在命令行上：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">group <span class="o">= <span class="n">parser<span class="o">.<span class="n">add_mutually_exclusive_group<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">group<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_true'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">group<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--bar'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_false'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--foo'<span class="p">]) <span class="go">Namespace(bar=True, foo=True) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--bar'<span class="p">]) <span class="go">Namespace(bar=False, foo=False) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'--foo'<span class="p">, <span class="s">'--bar'<span class="p">]) <span class="go">usage: PROG [-h] [--foo | --bar] <span class="go">PROG: error: argument --bar: not allowed with argument --foo </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
     <p><span id="274"><a class="reference internal" title="argparse.ArgumentParser.add_mutually_exclusive_group" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_mutually_exclusive_group" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_mutually_exclusive_group()</span></tt></a>接受一个required 参数，用于指示互斥分组中至少有一个参数是必需的：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">(<span class="n">prog<span class="o">=<span class="s">'PROG'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">group <span class="o">= <span class="n">parser<span class="o">.<span class="n">add_mutually_exclusive_group<span class="p">(<span class="n">required<span class="o">=<span class="bp">True<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">group<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_true'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">group<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--bar'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_false'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([]) <span class="go">usage: PROG [-h] (--foo | --bar) <span class="go">PROG: error: one of the arguments --foo --bar is required </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
     <p><span id="275">注意目前互斥分组不支持<a class="reference internal" title="argparse.ArgumentParser.add_argument_group" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument_group" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument_group()</span></tt></a>的title和description 参数。</span></p> 
    </dd> 
   </dl> 
  </div> 
  <div id="parser-defaults" class="section"> 
   <h4><span id="356">15.4.5.5. 解析器的默认值</span></h4> 
   <dl class="method"> 
     
     <tt class="descclassname">ArgumentParser.</tt> 
     <tt class="descname">set_defaults</tt> 
     <big>(</big>**kwargs 
     <big>)</big> 
     
    <dd> 
     <p><span id="276">大部分时候，<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>返回的对象的属性完全由命令行参数和参数的动作决定。</span><span id="277"><a class="reference internal" title="argparse.ArgumentParser.set_defaults" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.set_defaults" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">set_defaults()</span></tt></a>允许添加一些额外的属性而不用命令行的解析决定：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'foo'<span class="p">, <span class="nb">type<span class="o">=<span class="nb">int<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">set_defaults<span class="p">(<span class="n">bar<span class="o">=<span class="mi">42<span class="p">, <span class="n">baz<span class="o">=<span class="s">'badger'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([<span class="s">'736'<span class="p">]) <span class="go">Namespace(bar=42, baz='badger', foo=736) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
     <p><span id="278">注意解析器基本的默认值会永远覆盖参数级别的默认值：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">default<span class="o">=<span class="s">'bar'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">set_defaults<span class="p">(<span class="n">foo<span class="o">=<span class="s">'spam'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_args<span class="p">([]) <span class="go">Namespace(foo='spam') </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
     <p><span id="279">解析器级别的默认值在使用多个解析器时特别有用。</span><span id="280">参考<a class="reference internal" title="argparse.ArgumentParser.add_subparsers" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_subparsers" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_subparsers()</span></tt></a>方法可以看到这方面的一个示例。</span></p> 
    </dd> 
   </dl> 
   <dl class="method"> 
     
     <tt class="descclassname">ArgumentParser.</tt> 
     <tt class="descname">get_default</tt> 
     <big>(</big>dest 
     <big>)</big> 
     
    <dd> 
     <p><span id="281">获得namespace某个属性的默认值，由<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">add_argument()</span></tt></a>或<a class="reference internal" title="argparse.ArgumentParser.set_defaults" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.set_defaults" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">set_defaults()</span></tt></a>设定：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
       <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">default<span class="o">=<span class="s">'badger'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">get_default<span class="p">(<span class="s">'foo'<span class="p">) <span class="go">'badger' </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
    </dd> 
   </dl> 
  </div> 
  <div id="printing-help" class="section"> 
   <h4><span id="357">15.4.5.6. 打印帮助</span></h4> 
   <p><span id="282">在大部分典型的应用中，<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>将负责用法和错误信息的格式和打印。</span><span id="283">然而，也可以使用几种格式化的方法：</span></p> 
   <dl class="method"> 
     
     <tt class="descclassname">ArgumentParser.</tt> 
     <tt class="descname">print_usage</tt> 
     <big>(</big>file=None 
     <big>)</big> 
     
    <dd> 
     <p><span id="284">打印关于如何在命令行上调用<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>的简单描述。</span><span id="285">如果file为<tt class="xref docutils literal"><span class="pre">None</span></tt>，则假定为<a class="reference internal" title="sys.stdout" href="http://python.usyiyi.cn/documents/python_278/library/sys.html#sys.stdout" rel="nofollow"><tt class="xref py py-data docutils literal"><span class="pre">sys.stdout</span></tt></a>。</span></p> 
    </dd> 
   </dl> 
   <dl class="method"> 
     
     <tt class="descclassname">ArgumentParser.</tt> 
     <tt class="descname">print_help</tt> 
     <big>(</big>file=None 
     <big>)</big> 
     
    <dd> 
     <p><span id="286">打印帮助信息，包括程序的使用方法以及用<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>注册的参数信息。</span><span id="287">如果file为<tt class="xref docutils literal"><span class="pre">None</span></tt>，则假定为<a class="reference internal" title="sys.stdout" href="http://python.usyiyi.cn/documents/python_278/library/sys.html#sys.stdout" rel="nofollow"><tt class="xref py py-data docutils literal"><span class="pre">sys.stdout</span></tt></a>。</span></p> 
    </dd> 
   </dl> 
   <p><span id="288">同样这些方法还有变体只是简单地返回字符串而不是打印出来：</span></p> 
   <dl class="method"> 
     
     <tt class="descclassname">ArgumentParser.</tt> 
     <tt class="descname">format_usage</tt> 
     <big>(</big> 
     <big>)</big> 
     
    <dd> 
     <p><span id="289">返回一个字符串，包含如何在命令上调用<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>的简单描述。</span></p> 
    </dd> 
   </dl> 
   <dl class="method"> 
     
     <tt class="descclassname">ArgumentParser.</tt> 
     <tt class="descname">format_help</tt> 
     <big>(</big> 
     <big>)</big> 
     
    <dd> 
     <p><span id="290">返回一个字符串，包含程序的使用方法以及用<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>注册的参数信息。</span></p> 
    </dd> 
   </dl> 
  </div> 
  <div id="partial-parsing" class="section"> 
   <h4><span id="358">15.4.5.7. 部分解析</span></h4> 
   <dl class="method"> 
     
     <tt class="descclassname">ArgumentParser.</tt> 
     <tt class="descname">parse_known_args</tt> 
     <big>(</big>args=None, namespace=None 
     <big>)</big> 
     
    <dd></dd> 
   </dl> 
   <p><span id="291">有些时候，脚本可能只会解析命令行参数一部分并将剩余的参数传递给另外一个脚本或程序。</span><span id="292">在这些情况下，<a class="reference internal" title="argparse.ArgumentParser.parse_known_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_known_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_known_args()</span></tt></a>方法可以派上用场。</span><span id="293">除了在出现多余的参数时不会产生错误信息以外，它工作的方式与<a class="reference internal" title="argparse.ArgumentParser.parse_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.parse_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">parse_args()</span></tt></a>非常类似。</span><span id="294">相反，它返回一个两个元素的元组，包含构造的namespace和剩余的参数字符串的列表。</span></p> 
   <div class="highlight-python"> 
    <div class="highlight"> 
     <span class="copybutton" title="Hide the prompts and output"><span class="copybutton" title="Hide the prompts and output">&gt;&gt;&gt;</span></span> 
     <pre><span class="gp">&gt;&gt;&gt; <span class="n">parser <span class="o">= <span class="n">argparse<span class="o">.<span class="n">ArgumentParser<span class="p">() <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'--foo'<span class="p">, <span class="n">action<span class="o">=<span class="s">'store_true'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">add_argument<span class="p">(<span class="s">'bar'<span class="p">) <span class="gp">&gt;&gt;&gt; <span class="n">parser<span class="o">.<span class="n">parse_known_args<span class="p">([<span class="s">'--foo'<span class="p">, <span class="s">'--badger'<span class="p">, <span class="s">'BAR'<span class="p">, <span class="s">'spam'<span class="p">]) <span class="go">(Namespace(bar='BAR', foo=True), ['--badger', 'spam']) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
    </div> 
   </div> 
   <div class="admonition warning"> 
    <p class="first admonition-title"><span id="295">警告</span></p>   
    <p class="last"><span id="296"><a class="reference internal" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#prefix-matching" rel="nofollow">Prefix matching</a>规则适用于<tt class="xref py py-meth docutils literal"><span class="pre">parse_known_args()</span></tt>。</span><span id="297">解析器将消耗一个选项即使它只是一个已知选项的前缀，而不会将它留在剩余的参数列表中。</span></p> 
   </div> 
  </div> 
  <div id="customizing-file-parsing" class="section"> 
   <h4><span id="359">15.4.5.8. 定制文件的解析</span></h4> 
   <dl class="method"> 
     
     <tt class="descclassname">ArgumentParser.</tt> 
     <tt class="descname">convert_arg_line_to_args</tt> 
     <big>(</big>arg_line 
     <big>)</big> 
     
    <dd> 
     <p><span id="298">从文件中读取的参数（参见<a class="reference internal" title="argparse.ArgumentParser" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser" rel="nofollow"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentParser</span></tt></a>构造器的fromfile_prefix_chars关键字参数）是按行每行读取一个参数。</span><span id="299">可以覆盖<a class="reference internal" title="argparse.ArgumentParser.convert_arg_line_to_args" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.convert_arg_line_to_args" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">convert_arg_line_to_args()</span></tt></a>以获得更好的阅读体验。</span></p> 
     <p><span id="300">该方法接受一个参数arg_line，它是从参数文件中读取出来的一个字符串。</span><span id="301">它返回从该字符串中解析出来的参数列表。</span><span id="302">该方法按顺序对参数文件中的每一行调用一次。</span></p> 
     <p><span id="303">该方法的一个有用的覆盖是以空格分隔的单词作为参数：</span></p> 
     <div class="highlight-python"> 
      <div class="highlight"> 
       <pre><span class="k">def <span class="nf">convert_arg_line_to_args<span class="p">(<span class="bp">self<span class="p">, <span class="n">arg_line<span class="p">): <span class="k">for <span class="n">arg <span class="ow">in <span class="n">arg_line<span class="o">.<span class="n">split<span class="p">(): <span class="k">if <span class="ow">not <span class="n">arg<span class="o">.<span class="n">strip<span class="p">(): <span class="k">continue <span class="k">yield <span class="n">arg </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre> 
      </div> 
     </div> 
    </dd> 
   </dl> 
  </div> 
  <div id="exiting-methods" class="section"> 
   <h4><span id="360">15.4.5.9. 退出的方法</span></h4> 
   <dl class="method"> 
     
     <tt class="descclassname">ArgumentParser.</tt> 
     <tt class="descname">exit</tt> 
     <big>(</big>status=0, message=None 
     <big>)</big> 
     
    <dd> 
     <p><span id="304">该方法将终止程序，以指定的status退出，如果给出message，则会在此之前打印出它。</span></p> 
    </dd> 
   </dl> 
   <dl class="method"> 
     
     <tt class="descclassname">ArgumentParser.</tt> 
     <tt class="descname">error</tt> 
     <big>(</big>message 
     <big>)</big> 
     
    <dd> 
     <p><span id="305">该方法打印一个用法信息包括message参数到标准错误输出并以状态码2终止程序。</span></p> 
    </dd> 
   </dl> 
  </div> 
 </div> 
 <p> </p> 
 <div id="upgrading-optparse-code" class="section"> 
  <h3><span id="319">15.4.6. 升级optparse的代码</span></h3> 
  <p><span id="306">最初，<a class="reference internal" title="argparse: Command-line option and argument parsing library." href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#module-argparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a>模块尝试保持与<a class="reference internal" title="optparse: Command-line option parsing library. (deprecated)" href="http://python.usyiyi.cn/documents/python_278/library/optparse.html#module-optparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">optparse</span></tt></a>的兼容性。</span><span id="307">然而，<a class="reference internal" title="optparse: Command-line option parsing library. (deprecated)" href="http://python.usyiyi.cn/documents/python_278/library/optparse.html#module-optparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">optparse</span></tt></a>很难透明地扩展，特别是新的变化要求支持<tt class="docutils literal"><span class="pre">nargs=</span></tt>指示符和更好的用法帮助信息。</span><span id="308">当<a class="reference internal" title="optparse: Command-line option parsing library. (deprecated)" href="http://python.usyiyi.cn/documents/python_278/library/optparse.html#module-optparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">optparse</span></tt></a>中的大部分内容已经被复制粘贴或者胡乱地打上补丁时，试图维持向后兼容性似乎不太实际。</span></p> 
  <p><span id="309">从<a class="reference internal" title="optparse: Command-line option parsing library. (deprecated)" href="http://python.usyiyi.cn/documents/python_278/library/optparse.html#module-optparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">optparse</span></tt></a>到<a class="reference internal" title="argparse: Command-line option and argument parsing library." href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#module-argparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a>的部分升级路线：</span></p> 
  <ul class="simple"><li><span id="478">替换所有的<a class="reference internal" title="optparse.OptionParser.add_option" href="http://python.usyiyi.cn/documents/python_278/library/optparse.html#optparse.OptionParser.add_option" rel="nofollow">optparse.OptionParser.add_option()</a>调用为<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow">ArgumentParser.add_argument()</a>调用。</span></li><li><span id="479">替换<tt class="docutils literal"><span class="pre">(options, <span class="pre">args) <span class="pre">= <span class="pre">parser.parse_args()</span></span></span></span></tt>为<tt class="docutils literal"><span class="pre">args <span class="pre">= <span class="pre">parser.parse_args()</span></span></span></tt>并为位置参数增加一个额外的<a class="reference internal" title="argparse.ArgumentParser.add_argument" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.ArgumentParser.add_argument" rel="nofollow"><tt class="xref py py-meth docutils literal"><span class="pre">ArgumentParser.add_argument()</span></tt></a>调用。 记住之前叫做<tt class="docutils literal"><span class="pre">options</span></tt>的东西，现在在<a class="reference internal" title="argparse: Command-line option and argument parsing library." href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#module-argparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a>环境中叫做<tt class="docutils literal"><span class="pre">args</span></tt>。</span></li><li><span id="480">替换回调动作和<tt class="docutils literal"><span class="pre">callback_*</span></tt>关键字参数为<tt class="docutils literal"><span class="pre">type</span></tt>或者<tt class="docutils literal"><span class="pre">action</span></tt>参数。</span></li><li><span id="481">替换<tt class="docutils literal"><span class="pre">type</span></tt>关键字参数的字符串名称为相应的类型对象（例如int、float、complex等）。</span></li><li><span id="482">替换<tt class="xref py py-class docutils literal"><span class="pre">optparse.Values</span></tt>为<a class="reference internal" title="argparse.Namespace" href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#argparse.Namespace" rel="nofollow">Namespace</a>并替换<tt class="xref py py-exc docutils literal"><span class="pre">optparse.OptionError</span></tt>和<tt class="xref py py-exc docutils literal"><span class="pre">optparse.OptionValueError</span></tt>为 <tt class="xref py py-exc docutils literal"><span class="pre">ArgumentError</span></tt>。</span></li><li><span id="483">替换隐式参数的字符串为Python 的标准语法以使用字典来格式化字符串，例如替换<tt class="docutils literal"><span class="pre">%default</span></tt>和<tt class="docutils literal"><span class="pre">%prog</span></tt>为<tt class="docutils literal"><span class="pre">%(default)s</span></tt>和<tt class="docutils literal"><span class="pre">%(prog)s</span></tt>。</span></li><li><span id="484">替换OptionParser构造器的<tt class="docutils literal"><span class="pre">version</span></tt>参数为调用<tt class="docutils literal"><span class="pre">parser.add_argument('--version', <span class="pre">action='version', <span class="pre">version='&lt;the <span class="pre">version&gt;')</span></span></span></span></tt>。</span></li></ul> 
 </div> 
 <p><a class="reference internal" title="argparse: Command-line option and argument parsing library." href="http://python.usyiyi.cn/documents/python_278/library/argparse.html#module-argparse" rel="nofollow"><tt class="xref py py-mod docutils literal"><span class="pre"> </span></tt></a></p> 
</div> 
<p>转载于:https://www.cnblogs.com/xiaofeiIDO/p/6154953.html</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/48dc0f635e9b272258507c0eced35846/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">在matlab中提取一个比较大的矩阵的部分元素</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d5e7b2daeb8a4ec7b333fb517cb442e2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Jsoup解析html某片段的问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>