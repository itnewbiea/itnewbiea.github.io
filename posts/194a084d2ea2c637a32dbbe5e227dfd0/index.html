<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Electron &#43; Vue3 å¼€å‘æ¡Œé¢åº”ç”¨ - ITå­¦ä¹ è€…åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Electron &#43; Vue3 å¼€å‘æ¡Œé¢åº”ç”¨" />
<meta property="og:description" content="ç›®å½• ä¸€ã€æ­å»ºé¡¹ç›®1ã€åˆ›å»º Vue é¡¹ç›®2ã€å®‰è£… Electron3ã€è¿è¡Œ Electron4ã€Vue å’Œ Electron ç»“åˆ5ã€å…¶å®ƒé…ç½®6ã€å…¶å®ƒé—®é¢˜ï¼ˆ1ï¼‰çƒ­æ›´æ–°å¤±æ•ˆã€æ§åˆ¶å°æŠ¥é”™ äºŒã€æ‰“åŒ…1ã€å®‰è£… electron-builder2ã€æ‰“åŒ…é…ç½®ï¼ˆ1ï¼‰ä¿®æ”¹å…¬å…±åŸºç¡€è·¯å¾„ï¼ˆ2ï¼‰ä¿®æ”¹ Electron é…ç½®ï¼ˆ3ï¼‰æ‰“åŒ…é…ç½®ï¼ˆ3ï¼‰æ‰“åŒ… 3ã€å…¶å®ƒé—®é¢˜ï¼ˆ1ï¼‰webå’Œå®¢æˆ·ç«¯åŒæ—¶éƒ¨ç½²ï¼ˆ2ï¼‰åˆ·æ–°é¡µé¢åæŠ¥é”™é—®é¢˜ï¼ˆ3ï¼‰ä¸å¸¦åè®®çš„ url è¢«è§£æä¸º file åè®®é—®é¢˜ï¼ˆ4ï¼‰å­˜å– `cookie` é—®é¢˜ï¼ˆ5ï¼‰é™åˆ¶åªèƒ½æ‰“å¼€ä¸€ä¸ªçª—å£ï¼ˆ6ï¼‰å…³é—­çª—å£æ—¶æç¤º ä¸‰ã€ä»£ç ç­¾åï¼ˆ1ï¼‰windowsï¼ˆ2ï¼‰mac å››ã€è‡ªåŠ¨æ›´æ–° ç›¸å…³æ–‡æ¡£
Vite: https://vitejs.cn
Vue : https://cn.vuejs.org
Electron: https://www.electronjs.org/
electron-builder: https://github.com/electron-userland/electron-builder
concurrently: https://github.com/open-cli-tools/concurrently
ç¤ºä¾‹ç¯å¢ƒ
ç”µè„‘ï¼š MacBook Pro (13-inch, M1, 2020)
ç³»ç»Ÿï¼š macOS 11.6
Node ç‰ˆæœ¬ï¼š v16.14.0
npm ç‰ˆæœ¬ï¼š v7.1.2
Electron ç‰ˆæœ¬ï¼š v20.1.0
Vue ç‰ˆæœ¬ï¼š v3.2.37
ä¸€ã€æ­å»ºé¡¹ç›® 1ã€åˆ›å»º Vue é¡¹ç›® å‚è€ƒï¼šhttps://cn.vuejs.org/guide/quick-start.html
ç¡®ä¿ä½ å®‰è£…äº†æœ€æ–°ç‰ˆæœ¬çš„ Node.jsï¼Œç„¶ååœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
npm init vue@latest è¿™ä¸€æŒ‡ä»¤å°†ä¼šå®‰è£…å¹¶æ‰§è¡Œ create-vueï¼Œå®ƒæ˜¯ Vue å®˜æ–¹çš„é¡¹ç›®è„šæ‰‹æ¶å·¥å…·ã€‚ä½ å°†ä¼šçœ‹åˆ°ä¸€äº›è¯¸å¦‚ TypeScript å’Œæµ‹è¯•æ”¯æŒä¹‹ç±»çš„å¯é€‰åŠŸèƒ½æç¤ºï¼Œæœ¬é¡¹ç›®åªåšç¤ºä¾‹ï¼Œæ‰€ä»¥åªé€‰äº† Vue Router ï¼š" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/194a084d2ea2c637a32dbbe5e227dfd0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-29T12:09:42+08:00" />
<meta property="article:modified_time" content="2023-12-29T12:09:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ITå­¦ä¹ è€…åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ITå­¦ä¹ è€…åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Electron &#43; Vue3 å¼€å‘æ¡Œé¢åº”ç”¨</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>ç›®å½•</h4> 
 <ul><li><a href="#_21" rel="nofollow">ä¸€ã€æ­å»ºé¡¹ç›®</a></li><li><ul><li><a href="#1_Vue__22" rel="nofollow">1ã€åˆ›å»º Vue é¡¹ç›®</a></li><li><a href="#2_Electron_70" rel="nofollow">2ã€å®‰è£… Electron</a></li><li><a href="#3_Electron_91" rel="nofollow">3ã€è¿è¡Œ Electron</a></li><li><a href="#4Vue__Electron__152" rel="nofollow">4ã€Vue å’Œ Electron ç»“åˆ</a></li><li><a href="#5_213" rel="nofollow">5ã€å…¶å®ƒé…ç½®</a></li><li><a href="#6_288" rel="nofollow">6ã€å…¶å®ƒé—®é¢˜</a></li><li><ul><li><a href="#1_289" rel="nofollow">ï¼ˆ1ï¼‰çƒ­æ›´æ–°å¤±æ•ˆã€æ§åˆ¶å°æŠ¥é”™</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_317" rel="nofollow">äºŒã€æ‰“åŒ…</a></li><li><ul><li><a href="#1_electronbuilder_318" rel="nofollow">1ã€å®‰è£… electron-builder</a></li><li><a href="#2_330" rel="nofollow">2ã€æ‰“åŒ…é…ç½®</a></li><li><ul><li><a href="#1_333" rel="nofollow">ï¼ˆ1ï¼‰ä¿®æ”¹å…¬å…±åŸºç¡€è·¯å¾„</a></li><li><a href="#2_Electron__341" rel="nofollow">ï¼ˆ2ï¼‰ä¿®æ”¹ Electron é…ç½®</a></li><li><a href="#3_351" rel="nofollow">ï¼ˆ3ï¼‰æ‰“åŒ…é…ç½®</a></li><li><a href="#3_414" rel="nofollow">ï¼ˆ3ï¼‰æ‰“åŒ…</a></li></ul> 
   </li><li><a href="#3_417" rel="nofollow">3ã€å…¶å®ƒé—®é¢˜</a></li><li><ul><li><a href="#1web_418" rel="nofollow">ï¼ˆ1ï¼‰webå’Œå®¢æˆ·ç«¯åŒæ—¶éƒ¨ç½²</a></li><li><a href="#2_471" rel="nofollow">ï¼ˆ2ï¼‰åˆ·æ–°é¡µé¢åæŠ¥é”™é—®é¢˜</a></li><li><a href="#3_url__file__526" rel="nofollow">ï¼ˆ3ï¼‰ä¸å¸¦åè®®çš„ url è¢«è§£æä¸º file åè®®é—®é¢˜</a></li><li><a href="#4_cookie__552" rel="nofollow">ï¼ˆ4ï¼‰å­˜å– `cookie` é—®é¢˜</a></li><li><a href="#5_658" rel="nofollow">ï¼ˆ5ï¼‰é™åˆ¶åªèƒ½æ‰“å¼€ä¸€ä¸ªçª—å£</a></li><li><a href="#6_680" rel="nofollow">ï¼ˆ6ï¼‰å…³é—­çª—å£æ—¶æç¤º</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_718" rel="nofollow">ä¸‰ã€ä»£ç ç­¾å</a></li><li><ul><li><ul><li><a href="#1windows_720" rel="nofollow">ï¼ˆ1ï¼‰windows</a></li><li><a href="#2mac_736" rel="nofollow">ï¼ˆ2ï¼‰mac</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_807" rel="nofollow">å››ã€è‡ªåŠ¨æ›´æ–°</a></li></ul> 
</div> 
<p></p> 
<hr> 
<p><strong>ç›¸å…³æ–‡æ¡£</strong></p> 
<blockquote> 
 <p><strong>Vite:</strong> <a href="https://vitejs.cn" rel="nofollow">https://vitejs.cn</a><br> <strong>Vue :</strong> <a href="https://cn.vuejs.org" rel="nofollow">https://cn.vuejs.org</a><br> <strong>Electron:</strong> <a href="https://www.electronjs.org/" rel="nofollow">https://www.electronjs.org/</a><br> <strong>electron-builder:</strong> <a href="https://www.electron.build/" rel="nofollow">https://github.com/electron-userland/electron-builder</a><br> <strong>concurrently:</strong> <a href="https://github.com/open-cli-tools/concurrently">https://github.com/open-cli-tools/concurrently</a></p> 
</blockquote> 
<p><strong>ç¤ºä¾‹ç¯å¢ƒ</strong></p> 
<blockquote> 
 <p><strong>ç”µè„‘ï¼š</strong> MacBook Pro (13-inch, M1, 2020)<br> <strong>ç³»ç»Ÿï¼š</strong> macOS 11.6<br> <strong>Node ç‰ˆæœ¬ï¼š</strong> v16.14.0<br> <strong>npm ç‰ˆæœ¬ï¼š</strong> v7.1.2<br> <strong>Electron ç‰ˆæœ¬ï¼š</strong> v20.1.0<br> <strong>Vue ç‰ˆæœ¬ï¼š</strong> v3.2.37</p> 
</blockquote> 
<hr> 
<h2><a id="_21"></a>ä¸€ã€æ­å»ºé¡¹ç›®</h2> 
<h3><a id="1_Vue__22"></a>1ã€åˆ›å»º Vue é¡¹ç›®</h3> 
<blockquote> 
 <p>å‚è€ƒï¼š<a href="https://cn.vuejs.org/guide/quick-start.html" rel="nofollow">https://cn.vuejs.org/guide/quick-start.html</a></p> 
</blockquote> 
<p>ç¡®ä¿ä½ å®‰è£…äº†æœ€æ–°ç‰ˆæœ¬çš„ Node.jsï¼Œç„¶ååœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p> 
<pre><code>npm init vue@latest 
</code></pre> 
<p>è¿™ä¸€æŒ‡ä»¤å°†ä¼šå®‰è£…å¹¶æ‰§è¡Œ create-vueï¼Œå®ƒæ˜¯ Vue å®˜æ–¹çš„é¡¹ç›®è„šæ‰‹æ¶å·¥å…·ã€‚ä½ å°†ä¼šçœ‹åˆ°ä¸€äº›è¯¸å¦‚ TypeScript å’Œæµ‹è¯•æ”¯æŒä¹‹ç±»çš„å¯é€‰åŠŸèƒ½æç¤ºï¼Œæœ¬é¡¹ç›®åªåšç¤ºä¾‹ï¼Œæ‰€ä»¥åªé€‰äº† <code>Vue Router</code> ï¼š</p> 
<pre><code>âœ” Project name: â€¦ electron_vue3_test
âœ” Add TypeScript? â€¦ No
âœ” Add JSX Support? â€¦ No
âœ” Add Vue Router for Single Page Application development? â€¦ Yes
âœ” Add Pinia for state management? â€¦ No
âœ” Add Vitest for Unit Testing? â€¦ No
âœ” Add Cypress for both Unit and End-to-End testing? â€¦ No
âœ” Add ESLint for code quality? â€¦ No
âœ” Add Prettier for code formatting? â€¦ No
</code></pre> 
<p>åœ¨é¡¹ç›®è¢«åˆ›å»ºåï¼Œé€šè¿‡ä»¥ä¸‹æ­¥éª¤å®‰è£…ä¾èµ–å¹¶å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š</p> 
<pre><code>cd &lt;your-project-name&gt;
npm install
npm run dev
</code></pre> 
<p>æ‰§è¡Œåç»ˆç«¯æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-javascript">  <span class="token constant">VITE</span> v3<span class="token punctuation">.</span><span class="token number">1.2</span>  ready <span class="token keyword">in</span> <span class="token number">333</span> ms

  âœ  Local<span class="token operator">:</span>   http<span class="token operator">:</span><span class="token operator">/</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">localhost:5173</span><span class="token regex-delimiter">/</span></span>
  âœ  Network<span class="token operator">:</span> use <span class="token operator">--</span>host to expose
</code></pre> 
<p>è®¿é—® <a href="http://localhost:5173/" rel="nofollow">http://localhost:5173/</a> æ˜¾ç¤ºé¡µé¢å¦‚ä¸‹æ‰€ç¤ºï¼Œ<code>Vue</code> é¡¹ç›®åˆ›å»ºæˆåŠŸ</p> 
<p><img src="https://images2.imgbox.com/ca/b8/Xnd8rkqp_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>å¦‚æœæƒ³è¦ä¿®æ”¹ç«¯å£å·ï¼Œä¿®æ”¹ <code>vite.config.js</code> æ–‡ä»¶çš„ <code> server.port</code> é€‰é¡¹ä¸ºä½ æƒ³è¦çš„ç«¯å£å·ï¼Œè¿™é‡Œæˆ‘æ”¹æˆäº† <code>3004</code></p> 
<pre><code class="prism language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// ...</span>
  <span class="token literal-property property">server</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">3004</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="2_Electron_70"></a>2ã€å®‰è£… Electron</h3> 
<blockquote> 
 <p>å‚è€ƒï¼š<a href="https://www.electronjs.org/zh/docs/latest/tutorial/installation" rel="nofollow">https://www.electronjs.org/zh/docs/latest/tutorial/installation</a></p> 
</blockquote> 
<p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… <code>Electron</code> ï¼š</p> 
<pre><code>npm install electron --save-dev
</code></pre> 
<p>å¦‚æœå®‰è£…è¿‡ç¨‹ä¸­å¡ä½ï¼Œå¯å°è¯•è®¾ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡</p> 
<pre><code>ELECTRON_MIRROR="https://npmmirror.com/mirrors/electron/"
</code></pre> 
<blockquote> 
 <p><strong>mac ä¿®æ”¹ç¯å¢ƒå˜é‡çš„æ–¹æ³•ï¼š</strong><br> åœ¨ <code>ç»ˆç«¯</code> ä¸­è¾“å…¥ <code>vim ~/.zshrc</code> æ‰“å¼€æ–‡ä»¶<br> æŒ‰ <code>i</code> è¿›å…¥ç¼–è¾‘æ¨¡å¼<br> æ·»åŠ ä¸€è¡Œ <code>export ELECTRON_MIRROR="https://npmmirror.com/mirrors/electron/"</code><br> æŒ‰ <code>esc</code> é€€å‡ºç¼–è¾‘æ¨¡å¼<br> è¾“å…¥ <code>:wq</code> ä¿å­˜å¹¶é€€å‡º<br> åœ¨ <code>ç»ˆç«¯</code> è¾“å…¥ <code>source ~/.zshrc</code> ä½¿åˆšæ‰çš„ä¿®æ”¹ç”Ÿæ•ˆ</p> 
</blockquote> 
<h3><a id="3_Electron_91"></a>3ã€è¿è¡Œ Electron</h3> 
<blockquote> 
 <p>å‚è€ƒï¼š<a href="https://www.electronjs.org/zh/docs/latest/tutorial/quick-start" rel="nofollow">https://www.electronjs.org/zh/docs/latest/tutorial/quick-start</a></p> 
</blockquote> 
<p>åœ¨æ ¹ç›®å½•åˆ›å»º <code>electron</code> æ–‡ä»¶å¤¹ï¼Œæ–°å»º <code>index.html</code> æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p> 
<pre><code class="prism language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span>
      <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Security-Policy<span class="token punctuation">"</span></span>
      <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>default-src 'self'; script-src 'self'<span class="token punctuation">"</span></span>
    <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span>
      <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-Content-Security-Policy<span class="token punctuation">"</span></span>
      <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>default-src 'self'; script-src 'self'<span class="token punctuation">"</span></span>
    <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Hello from Electron renderer!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Hello from Electron renderer!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>ğŸ‘‹<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>åœ¨ <code>electron</code> ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶ <code>main.js</code>ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> app<span class="token punctuation">,</span> BrowserWindow <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">createWindow</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span>
    <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  
  <span class="token comment">// ä½¿ç”¨ loadFile åŠ è½½ electron/index.html æ–‡ä»¶</span>
  mainWindow<span class="token punctuation">.</span><span class="token function">loadFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"./index.html"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// åœ¨åº”ç”¨å‡†å¤‡å°±ç»ªæ—¶è°ƒç”¨å‡½æ•°</span>
app<span class="token punctuation">.</span><span class="token function">whenReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>ä¿®æ”¹ <code>package.json</code> æ–‡ä»¶ï¼ŒæŒ‡å®š <code>electron/main.js</code> ä¸º <code>Electron</code> çš„å…¥å£æ–‡ä»¶ï¼Œå¹¶æ·»åŠ  <code>electron:dev</code> å‘½ä»¤ä»¥å¼€å‘æ¨¡å¼è¿è¡Œ <code>Electron</code>ï¼š</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"main"</span><span class="token operator">:</span> <span class="token string">"electron/main.js"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"electron:dev"</span><span class="token operator">:</span> <span class="token string">"electron ."</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>ç„¶åæ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œ <code>npm run electron:dev</code> ï¼Œæ˜¾ç¤ºçª—å£å¦‚ä¸‹æ‰€ç¤ºï¼Œ<code>Electron</code> è¿è¡ŒæˆåŠŸ</p> 
<p><img src="https://images2.imgbox.com/6e/79/Rox7sCgr_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="4Vue__Electron__152"></a>4ã€Vue å’Œ Electron ç»“åˆ</h3> 
<p>åˆ é™¤ <code>electron/index.html</code> æ–‡ä»¶ï¼Œä¿®æ”¹ <code>electron/main.js</code> æ–‡ä»¶ä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> app<span class="token punctuation">,</span> BrowserWindow <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span>
<span class="token comment">// const path = require("path")</span>

<span class="token keyword">const</span> <span class="token function-variable function">createWindow</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span>
    <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// ä¸»è¦æ”¹äº†è¿™é‡Œ</span>
  <span class="token comment">// mainWindow.loadFile(path.join(__dirname, "./index.html"));</span>
  <span class="token comment">// ä½¿ç”¨ loadURL åŠ è½½ http://localhost:3004 ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„ Vue é¡¹ç›®åœ°å€</span>
  <span class="token comment">// 3004 æ”¹ä¸ºä½  Vue é¡¹ç›®çš„ç«¯å£å·</span>
  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">"http://localhost:3004/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

app<span class="token punctuation">.</span><span class="token function">whenReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>æœ‰æ—¶å¼€å‘éœ€è¦ï¼Œä¼šä½¿ç”¨ <code>nginx</code> ä»£ç†ä¸ºçº¿ä¸Šåœ°å€ï¼Œåˆ™å°† <code>loadURL</code> çš„å‚æ•°æ”¹ä¸ºä»£ç†çš„åœ°å€ï¼Œå¹¶åœ¨ <code>electron/main.js</code> ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p> 
<blockquote> 
 <p>å‚è€ƒï¼š<a href="https://stackoverflow.com/questions/49637026/mainwindow-loadurlhttps-localhost3000-show-white-screen-on-electron-app/49673272" rel="nofollow">https://stackoverflow.com/questions/49637026/mainwindow-loadurlhttps-localhost3000-show-white-screen-on-electron-app/49673272</a></p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token comment">// è¯ä¹¦çš„é“¾æ¥éªŒè¯å¤±è´¥æ—¶ï¼Œè§¦å‘è¯¥äº‹ä»¶</span>
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>
  <span class="token string">"certificate-error"</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> webContents<span class="token punctuation">,</span> url<span class="token punctuation">,</span> error<span class="token punctuation">,</span> certificate<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œ <code>npm run dev</code> å¯åŠ¨ <code>Vue</code> é¡¹ç›®ï¼Œå†æ–°å»ºä¸€ä¸ªç»ˆç«¯ï¼Œæ‰§è¡Œ <code>npm run electron:dev</code> å¯åŠ¨ <code>Electron</code> ï¼Œå³å¯æˆåŠŸå¯åŠ¨ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š</p> 
<p><img src="https://images2.imgbox.com/45/7a/q9SmVboq_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>è¿™æ ·æ¯æ¬¡å¯åŠ¨é¡¹ç›®éœ€è¦åˆ†åˆ«æ‰§è¡Œä¸¤ä¸ªå‘½ä»¤ï¼Œæœ‰äº›éº»çƒ¦ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>concurrently</code>æŠŠå®ƒä»¬åˆå¹¶æˆä¸€ä¸ªå‘½ä»¤ã€‚</p> 
<blockquote> 
 <p>å‚è€ƒï¼š<a href="https://github.com/open-cli-tools/concurrently">https://github.com/open-cli-tools/concurrently</a></p> 
</blockquote> 
<p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£… <code>concurrently</code>ï¼š</p> 
<pre><code> npm install concurrently --save-dev
</code></pre> 
<p>ä¿®æ”¹ <code>package.json</code> æ–‡ä»¶ä¸­çš„ <code>electron:dev</code> å‘½ä»¤ï¼ŒåŒæ—¶æ‰§è¡Œ <code>vite</code> å’Œ <code>electron .</code> ä¸¤ä¸ªå‘½ä»¤ï¼Œç”¨å¼•å·å°†å•ç‹¬çš„å‘½ä»¤æ‹¬èµ·æ¥ï¼Œå¹¶ä½¿ç”¨ <code>\</code> è½¬ä¹‰å¼•å·ï¼Œä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-json"><span class="token comment">// package.json</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"electron:dev"</span><span class="token operator">:</span> <span class="token string">"concurrently vite \"electron .\""</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>é‡æ–°æ‰§è¡Œ <code>npm run electron:dev</code> ï¼Œå³å¯æˆåŠŸæ˜¾ç¤ºã€‚</p> 
<h3><a id="5_213"></a>5ã€å…¶å®ƒé…ç½®</h3> 
<p>ä»¥ä¸‹æ˜¯å¼€å‘ç¯å¢ƒä¸‹ï¼Œæˆ‘çš„ä¸€äº›å…¶å®ƒé…ç½®ï¼Œå¯ä¾›å‚è€ƒï¼š</p> 
<pre><code class="prism language-javascript"><span class="token comment">// electron/main.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">,</span> Menu<span class="token punctuation">,</span> screen <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"electron"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æ˜¯å¦æ˜¯ç”Ÿäº§ç¯å¢ƒ</span>
<span class="token keyword">const</span> isPackaged <span class="token operator">=</span> app<span class="token punctuation">.</span>isPackaged<span class="token punctuation">;</span>

<span class="token comment">// ç¦æ­¢æ˜¾ç¤ºé»˜è®¤èœå•</span>
Menu<span class="token punctuation">.</span><span class="token function">setApplicationMenu</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä¸»çª—å£</span>
<span class="token keyword">let</span> mainWindow<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">createWindow</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// åˆ›å»ºæµè§ˆå™¨çª—å£</span>
  mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// é»˜è®¤çª—å£æ ‡é¢˜ï¼Œå¦‚æœç”±loadURL()åŠ è½½çš„HTMLæ–‡ä»¶ä¸­å«æœ‰æ ‡ç­¾&lt;title&gt;ï¼Œæ­¤å±æ€§å°†è¢«å¿½ç•¥ã€‚</span>
    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"Electron + Vue3"</span><span class="token punctuation">,</span>
    <span class="token comment">// width: 800,</span>
    <span class="token comment">// height: 600,</span>
    <span class="token comment">// è®¾ç½®çª—å£å°ºå¯¸ä¸ºå±å¹•å·¥ä½œåŒºå°ºå¯¸</span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> screen<span class="token punctuation">.</span><span class="token function">getPrimaryDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>workAreaSize<span class="token punctuation">.</span>width<span class="token punctuation">,</span>
    <span class="token literal-property property">height</span><span class="token operator">:</span> screen<span class="token punctuation">.</span><span class="token function">getPrimaryDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>workAreaSize<span class="token punctuation">.</span>height<span class="token punctuation">,</span>
    <span class="token comment">// è®¾ç½®æœ€å°å°ºå¯¸</span>
    <span class="token literal-property property">minWidth</span><span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span>
    <span class="token literal-property property">minHeight</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
    <span class="token comment">// çª—å£å›¾æ ‡ã€‚ åœ¨ Windows ä¸Šæ¨èä½¿ç”¨ ICO å›¾æ ‡æ¥è·å¾—æœ€ä½³çš„è§†è§‰æ•ˆæœ, é»˜è®¤ä½¿ç”¨å¯æ‰§è¡Œæ–‡ä»¶çš„å›¾æ ‡.</span>
    <span class="token comment">// åœ¨æ ¹ç›®å½•ä¸­æ–°å»º build æ–‡ä»¶å¤¹å­˜æ”¾å›¾æ ‡ç­‰æ–‡ä»¶</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"../build/icon.ico"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// å¼€å‘ç¯å¢ƒä¸‹ï¼Œæ‰“å¼€å¼€å‘è€…å·¥å…·ã€‚</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isPackaged<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    mainWindow<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">openDevTools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ä½¿ç”¨ loadURL åŠ è½½ http://localhost:3004 ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„ Vue é¡¹ç›®åœ°å€</span>
  <span class="token comment">// 3004 æ”¹ä¸ºä½  Vue é¡¹ç›®çš„ç«¯å£å·</span>
  <span class="token comment">// mainWindow.loadURL("http://localhost:3004/");</span>
  <span class="token comment">// å¦‚æœä½¿ç”¨äº† nginx ä»£ç†ï¼Œurl æ”¹ä¸ºä»£ç†åœ°å€</span>
  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">"https://example.com/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// åœ¨åº”ç”¨å‡†å¤‡å°±ç»ªæ—¶è°ƒç”¨å‡½æ•°</span>
app<span class="token punctuation">.</span><span class="token function">whenReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"activate"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// é€šå¸¸åœ¨ macOS ä¸Šï¼Œå½“ç‚¹å‡» dock ä¸­çš„åº”ç”¨ç¨‹åºå›¾æ ‡æ—¶ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–</span>
    <span class="token comment">// æ‰“å¼€çš„çª—å£ï¼Œé‚£ä¹ˆç¨‹åºä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªçª—å£ã€‚</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>BrowserWindow<span class="token punctuation">.</span><span class="token function">getAllWindows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// é™¤äº† macOS å¤–ï¼Œå½“æ‰€æœ‰çª—å£éƒ½è¢«å…³é—­çš„æ—¶å€™é€€å‡ºç¨‹åºã€‚ å› æ­¤ï¼Œé€šå¸¸å¯¹ç¨‹åºå’Œå®ƒä»¬åœ¨ä»»åŠ¡æ ä¸Šçš„å›¾æ ‡æ¥è¯´ï¼Œåº”å½“ä¿æŒæ´»è·ƒçŠ¶æ€ï¼Œç›´åˆ°ç”¨æˆ·ä½¿ç”¨ Cmd + Q é€€å‡ºã€‚</span>
app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"window-all-closed"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>platform <span class="token operator">!==</span> <span class="token string">"darwin"</span><span class="token punctuation">)</span> app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å¦‚æœå¼€å‘ç¯å¢ƒä½¿ç”¨äº† nginx ä»£ç†ï¼Œç¦æ­¢è¯ä¹¦æŠ¥é”™</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isPackaged<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// è¯ä¹¦çš„é“¾æ¥éªŒè¯å¤±è´¥æ—¶ï¼Œè§¦å‘è¯¥äº‹ä»¶</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>
    <span class="token string">"certificate-error"</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> webContents<span class="token punctuation">,</span> url<span class="token punctuation">,</span> error<span class="token punctuation">,</span> certificate<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">callback</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="6_288"></a>6ã€å…¶å®ƒé—®é¢˜</h3> 
<h4><a id="1_289"></a>ï¼ˆ1ï¼‰çƒ­æ›´æ–°å¤±æ•ˆã€æ§åˆ¶å°æŠ¥é”™</h4> 
<p>æˆ‘ä½¿ç”¨äº† <code>nginx</code> ä»£ç†ï¼Œå¼€å‘æ—¶å‡ºç°äº†çƒ­æ›´æ–°å¤±æ•ˆçš„é—®é¢˜ï¼Œå¹¶ä¸”æ§åˆ¶å°æŠ¥äº†å¦‚ä¸‹é”™è¯¯</p> 
<pre><code>WebSocket connection to 'wss://example.com/' failed: 
WebSocket connection to 'wss://localhost:3004/' failed: 
[vite] failed to connect to websocket.
your current setup:
  (browser) example.com/ &lt;--[HTTP]--&gt; localhost:3004/ (server)
  (browser) example.com:/ &lt;--[WebSocket (failing)]--&gt; localhost:3004/ (server)
Check out your Vite / network configuration and https://vitejs.dev/config/server-options.html#server-hmr 
</code></pre> 
<p>å·²ç»é€šè¿‡åœ¨ <code>nginx</code> çš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç è§£å†³ï¼š</p> 
<blockquote> 
 <p>å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_39621860/article/details/111490058">https://blog.csdn.net/weixin_39621860/article/details/111490058</a></p> 
</blockquote> 
<pre><code>server {
    # ...
    location / {
        # ...
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
    }
}
</code></pre> 
<hr> 
<h2><a id="_317"></a>äºŒã€æ‰“åŒ…</h2> 
<h3><a id="1_electronbuilder_318"></a>1ã€å®‰è£… electron-builder</h3> 
<blockquote> 
 <p>å‚è€ƒï¼š<a href="https://www.electron.build/#installation" rel="nofollow">https://www.electron.build/#installation</a></p> 
</blockquote> 
<p>æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä¸€ä¸‹å‘½ä»¤å®‰è£…ï¼š<br> ä½¿ç”¨ <code>yarn</code> ï¼ˆå®˜æ–¹æ¨èï¼‰ï¼š</p> 
<pre><code>yarn add electron-builder --dev
</code></pre> 
<p>æˆ–æ˜¯ <code>npm</code> :</p> 
<pre><code>npm install electron-builder --save-dev
</code></pre> 
<h3><a id="2_330"></a>2ã€æ‰“åŒ…é…ç½®</h3> 
<h4><a id="1_333"></a>ï¼ˆ1ï¼‰ä¿®æ”¹å…¬å…±åŸºç¡€è·¯å¾„</h4> 
<p>ä¿®æ”¹ <code>vite.config.js</code> ä¸­çš„ <code>base</code> é€‰é¡¹ä¸º â€œ<code>./</code>â€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p> 
<pre><code>export default defineConfig({
  base: "./"
  // ...
});
</code></pre> 
<h4><a id="2_Electron__341"></a>ï¼ˆ2ï¼‰ä¿®æ”¹ Electron é…ç½®</h4> 
<p>ä¿®æ”¹ <code>electron/main.js</code> æ–‡ä»¶ä¸­ <code>mainWindow.loadURL</code> çš„å‚æ•°ä¸º <code>vue</code> æ‰“åŒ…åçš„æ–‡ä»¶è·¯å¾„</p> 
<pre><code>// electron/main.js
const path = require("path");
const createWindow = () =&gt; {
  //...
  mainWindow.loadURL(`file://${path.join(__dirname, "../dist/index.html")}`);
};
</code></pre> 
<h4><a id="3_351"></a>ï¼ˆ3ï¼‰æ‰“åŒ…é…ç½®</h4> 
<p>åœ¨ <code>package.json</code> ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼Œå¯æ ¹æ®éœ€æ±‚è°ƒæ•´ï¼š</p> 
<blockquote> 
 <p>å‚è€ƒï¼š<br> <a href="https://www.electron.build/#quick-setup-guide" rel="nofollow">https://www.electron.build/#quick-setup-guide</a><br> <a href="https://docs.npmjs.com/cli/v9/configuring-npm/package-json?v=true" rel="nofollow">https://docs.npmjs.com/cli/v9/configuring-npm/package-json?v=true</a></p> 
</blockquote> 
<pre><code>{
  "name": "electron_vue3_test",
  "description": "Electron + Vue3 å¼€å‘æ¡Œé¢åº”ç”¨",
  "author": "å–µå–µå–µ",
  "version": "1.0.0",
  "scripts": {
    // ...
    "electron:build": "npm run build &amp;&amp; electron-builder",
    "postinstall": "electron-builder install-app-deps"
  },
  // ...
  "build":{
    "appId": "your.id",
    "productName": "Electron + Vue3 å¼€å‘æ¡Œé¢åº”ç”¨",
    "copyright": "Copyright Â© year ${author}",
    "directories": {
      "output": "app_client"
    },
    "mac": {
      "category": "public.app-category.music",
      "icon": "build/icon.icns",
      "target": [
        {
          "target": "dmg",
          "arch": [
            "x64"
          ]
        },
        {
          "target": "zip",
          "arch": [
            "x64"
          ]
        }
      ]
    },
    "win": {
      "icon": "build/icon.ico",
      "target": [
        {
          "target": "nsis",
          "arch": [
            "x64",
            "ia32"
          ]
        }
      ]
    },
    "nsis": {
      "oneClick": false,
      "allowToChangeInstallationDirectory": true,
      "installerIcon": "build/icon.ico",
      "uninstallerIcon": "build/icon.ico"
    }
  }
}
</code></pre> 
<h4><a id="3_414"></a>ï¼ˆ3ï¼‰æ‰“åŒ…</h4> 
<p>æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œ <code>npm run electron:build</code> æ‰“åŒ…ï¼Œæ‰“åŒ…åçš„åº”ç”¨ç¨‹åºåœ¨ <code>app_client</code> ç›®å½•ä¸‹ï¼Œ<code>.dmg</code> æ–‡ä»¶ä¸º mac çš„å®‰è£…åŒ…ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img src="https://images2.imgbox.com/ca/33/2kijg3L0_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="3_417"></a>3ã€å…¶å®ƒé—®é¢˜</h3> 
<h4><a id="1web_418"></a>ï¼ˆ1ï¼‰webå’Œå®¢æˆ·ç«¯åŒæ—¶éƒ¨ç½²</h4> 
<p>å¦‚æœè¦ä¸€å¥—ä»£ç éƒ¨ç½²åœ¨webç«¯å’Œå®¢æˆ·ç«¯ï¼Œè¿˜éœ€è¦å†åšäº›å¤„ç†ã€‚</p> 
<p>åœ¨æ ¹ç›®å½•ä¸‹æ–°å¢ä»¥ä¸‹ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼š<br> <code>.env.development</code> æ–‡ä»¶ï¼Œweb ç«¯å¼€å‘ç¯å¢ƒé…ç½®ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p> 
<pre><code>VITE_PLATFORM = 'web'
</code></pre> 
<p><code>.env.production</code> æ–‡ä»¶ï¼Œweb ç«¯ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p> 
<pre><code>VITE_PLATFORM = 'web'
</code></pre> 
<p><code>.env.electron_production</code> æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p> 
<pre><code>VITE_PLATFORM = 'electron'
</code></pre> 
<p>ä¿®æ”¹ <code>package.json</code> æ–‡ä»¶ <code>scripts</code> ä¸‹çš„ <code>electron:build</code> å‘½ä»¤ä¸º <code>vite build --mode electron_production &amp;&amp; electron-builder</code>ã€‚</p> 
<p>ä¿®æ”¹ <code>vite.config.js</code> æ–‡ä»¶å¦‚ä¸‹ï¼š</p> 
<pre><code>import { defineConfig, loadEnv } from "vite";

export default ({ mode }) =&gt; {
  const isWeb = loadEnv(mode, process.cwd()).VITE_PLATFORM === "web";

  const config = {
    base: isWeb ? "/" : "./",
    // ...
  };
  return defineConfig(config);
};
</code></pre> 
<p>å¦‚æœå›¾ç‰‡ã€cssç­‰èµ„æºæ–‡ä»¶éœ€ä¸Šä¼ cdnï¼Œ<code>vite.config.js</code> æ–‡ä»¶è¿˜è¦å¢åŠ å¦‚ä¸‹ä»£ç ï¼š</p> 
<pre><code>// ...
export default ({ mode }) =&gt; {
  const isWeb = loadEnv(mode, process.cwd()).VITE_PLATFORM === "web";
  const config = {
  // ...
  }
  if (isWeb) {
    config.experimental = {
      renderBuiltUrl(filename: string, { type }: { type: "public" | "asset" }) {
        if (type === "asset") {
          return "https://example.com/" + filename;
        }
      },
    };
  }
  return defineConfig(config);
};
</code></pre> 
<h4><a id="2_471"></a>ï¼ˆ2ï¼‰åˆ·æ–°é¡µé¢åæŠ¥é”™é—®é¢˜</h4> 
<p>æˆ‘çš„æ–¹æ³•æ˜¯ç›‘å¬åŠ è½½å¤±è´¥å’Œå¯¼èˆªäº‹ä»¶ï¼Œä½¿ç”¨ <code>loadURL</code> é‡æ–°åŠ è½½é¡µé¢ï¼Œå¹¶ç¦æ­¢åˆ·æ–°é¡µé¢çš„å¿«æ·é”®ã€‚</p> 
<p>åœ¨ <code>electron/main.js</code> ä¸­åˆ¤æ–­å¦‚æœæ˜¯ç”Ÿäº§ç¯å¢ƒåˆ™åšå¤„ç†ï¼š</p> 
<pre><code>// electron/main.js
const { app, BrowserWindow } = require("electron");

const isPackaged = app.isPackaged;
let mainWindow;

const createWindow = () =&gt; {
  mainWindow = new BrowserWindow({
  // ...
  });

  // åŠ è½½æ–‡ä»¶
  function load() {
    mainWindow.loadURL(
      isPackaged
        ? `file://${path.join(__dirname, "../dist/index.html")}`
        : "https://example.com/"
    );
  }

  if (isPackaged) {
    // ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œload çš„æ˜¯ html æ–‡ä»¶ï¼Œè¦åšç‰¹æ®Šå¤„ç†ã€‚
    // åŠ è½½å¤±è´¥ä¹‹åè§¦å‘
    mainWindow.webContents.on("did-fail-load", () =&gt; {
      load();
    });

    // å½“ç”¨æˆ·æˆ–é¡µé¢æƒ³è¦å¯¼èˆªæ—¶è§¦å‘ã€‚
    // å®ƒå¯èƒ½å‘ç”Ÿåœ¨ window.location å¯¹è±¡æ”¹å˜æˆ–ç”¨æˆ·ç‚¹å‡»é¡µé¢ä¸Šçš„é“¾æ¥æ—¶ï¼Œå¯èƒ½ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚
    // å½“ä½¿ç”¨å¦‚ webContents.loadURL å’Œ webContents.back APIs ä»¥ç¼–ç¨‹æ–¹å¼å¯¼èˆªæ—¶ï¼Œå°†ä¸ä¼šè§¦å‘æ­¤äº‹ä»¶ã€‚
    // é¡µé¢å†…å¯¼èˆªä¹Ÿä¸ä¼šè§¦å‘ï¼Œä¾‹å¦‚ç‚¹å‡»é”šç‚¹æˆ–æ›´æ–° window.location.hashã€‚ å¯ä½¿ç”¨ did-navigate-in-page äº‹ä»¶ã€‚
    mainWindow.webContents.on("will-navigate", (event, url) =&gt; {
      event.preventDefault();
      load();
    });
    
    // ç¦æ­¢ä½¿ç”¨å¿«æ·é”®åˆ·æ–°
    mainWindow.webContents.on("before-input-event", (event, input) =&gt; {
      mainWindow.webContents.setIgnoreMenuShortcuts(
        input.key.toLowerCase() === "f5" ||
        (input.control &amp;&amp; input.key.toLowerCase() === "r") ||
        (input.meta &amp;&amp; input.key.toLowerCase() === "r")
      );
    });
  }

  load();
};

</code></pre> 
<h4><a id="3_url__file__526"></a>ï¼ˆ3ï¼‰ä¸å¸¦åè®®çš„ url è¢«è§£æä¸º file åè®®é—®é¢˜</h4> 
<p>é¡¹ç›®æ¥å£ä¸­æœ‰å¾ˆå¤šä¸å¸¦åè®®åçš„ url é“¾æ¥ï¼Œåº”è§£æä¸º https åè®®ï¼Œä½†æ‰“åŒ…åè¢«è§£æä¸º file åè®®ï¼Œåœ¨ <code>onBeforeRequest</code> æ–¹æ³•ä¸­å¯¹ url åšå¤„ç†ï¼š</p> 
<pre><code>// electron/main.js
const { app, BrowserWindow } = require("electron");

const isPackaged = app.isPackaged;
let mainWindow;

const createWindow = () =&gt; {
  mainWindow = new BrowserWindow({
  // ...
  });

  if (isPackaged) {
    // å°† file://example.com/xxx çš„ æ–‡ä»¶æ”¹ä¸º https åè®®
    session.defaultSession.webRequest.onBeforeRequest((details, callback) =&gt; {
      if (/^file:\/\/example\.com\//.test(details.url)) {
        callback({ redirectURL: details.url.replace(/^file/, "https") });
      } else {
        callback(details);
      }
    });
  }
};
</code></pre> 
<h4><a id="4_cookie__552"></a>ï¼ˆ4ï¼‰å­˜å– <code>cookie</code> é—®é¢˜</h4> 
<p>ç½‘ç«™æœ‰äº›åŠŸèƒ½ç”¨åˆ°äº† <code>cookie</code> ï¼Œä½†æ‰“åŒ…åçš„åº”ç”¨ç¨‹åºè¯»å–çš„ <code>html</code> æ–‡ä»¶ä¸º <code>file</code> åè®®ï¼Œå­˜å– <code>cookie</code> ä¼šæœ‰é—®é¢˜ã€‚</p> 
<p>ç¬¬ä¸€é—®é¢˜æ˜¯è¯·æ±‚æ¥å£æ—¶è·å– cookie å’Œæ¥æ”¶æœåŠ¡ç«¯å“åº”æ—¶è®¾ç½® cookie çš„é—®é¢˜ï¼Œæˆ‘è§£å†³çš„åŠæ³•æ˜¯åœ¨ <code>onBeforeSendHeaders</code> å’Œ <code>onHeadersReceived</code> æ–¹æ³•ä¸­å¯¹ <code>cookie</code> åšå¤„ç†ï¼Œåœ¨ç½‘ç«™åŸŸåä¸‹å­˜å– <code>cookie</code>ã€‚</p> 
<p>åœ¨ <code>electron</code> ç›®å½•ä¸‹æ–°å»º <code>utils.js</code> æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p> 
<pre><code>const { session } = require("electron");

// å°†å“åº”å¤´ä¸­çš„ set-cookie è½¬æˆ set() æ–¹æ³•éœ€è¦çš„ details å¯¹è±¡
function getCookieDetails(cookie) {
  const details = {
    url: "https://example.com/",
  };
  cookie = cookie.split("; ");
  cookie.forEach((item, index) =&gt; {
    item = item.split("=");
    if (index === 0) {
      details.name = item[0];
      details.value = item[1];
    } else if (["domain", "path"].includes(item[0])) {
      details[item[0]] = item[1];
    } else if (item[0] == "expires") {
      details.expirationDate = new Date(item[1]).getTime() / 1000;
    } else if (item[0] == "HttpOnly") {
      details.httpOnly = true;
    }
    // HttpOnly æ²¡æœ‰ item[1]  value è®¾ä¸º true
  });
  return details;
}

module.exports = {
  // æ˜¯å¦æ˜¯æœ¬ç«™æ¥å£
  isWeapi: /^https:\/\/example\.com\/api\//,
  // è®¾ç½® cookies
  setCookies: function (cookies) {
    const setCookiePromise = [];

    cookies.forEach((cookie) =&gt; {
      const details = getCookieDetails(cookie);
      setCookiePromise.push(session.defaultSession.cookies.set(details));
    });

    return Promise.all(setCookiePromise);
  },

  // è·å– cookiesï¼Œä¼ ç»™åç«¯
  getCookies: async function () {
    const cookies = await session.defaultSession.cookies.get({
      domain: ".example.com"
    });
    const cookiesArr = [];
    cookies.forEach((cookie) =&gt; {
      cookiesArr.push(`${cookie.name}=${cookie.value}`);
    });
    return cookiesArr.join("; ");
  },
};
</code></pre> 
<p>åœ¨ <code>electron/main.js</code> ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p> 
<pre><code>const { app, BrowserWindow, session } = require("electron");
const { isWeapi, setCookies, getCookies } = require("./utils.js");

const isPackaged = app.isPackaged;
let mainWindow;

const createWindow = () =&gt; {
  mainWindow = new BrowserWindow({
  // ...
  });

  if (isPackaged) {
    // è¯·æ±‚æ¥å£æ—¶ï¼Œå¦‚æœæ˜¯æœ¬ç«™æ¥å£ï¼Œåˆ™è·å– .example.com ä¸­çš„ cookieï¼Œæ·»åŠ åˆ°è¯·æ±‚å¤´ä¸­
    session.defaultSession.webRequest.onBeforeSendHeaders(
      async (details, callback) =&gt; {
        if (isWeapi.test(details.url)) {
          const cookies = await getCookies();
          if (cookies) details.requestHeaders.cookie = cookies;
        }
        callback({ requestHeaders: details.requestHeaders });
      }
    );

    // æ¥å—åˆ°æœåŠ¡ç«¯å“åº”æ—¶ï¼Œå¦‚æœæ˜¯æœ¬ç«™æ¥å£ï¼Œåˆ™è·å–å“åº”å¤´ä¸­çš„ set-cookieï¼Œæ·»åŠ åˆ° .example.com çš„ cookie ä¸­
    session.defaultSession.webRequest.onHeadersReceived(
      async (details, callback) =&gt; {
        if (
          isWeapi.test(details.url) &amp;&amp;
          "responseHeaders" in details &amp;&amp;
          "set-cookie" in details.responseHeaders
        ) {
          await setCookies(details.responseHeaders["set-cookie"]);
        }
        callback({ responseHeaders: details.responseHeaders });
      }
    );
  }
};
</code></pre> 
<p>ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ <code>document.cookie</code> è·å–ä¸åˆ°ï¼Œæˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨çš„æ˜¯ <a href="https://github.com/js-cookie/js-cookie">js-cookie</a> è¿™ä¸ªæ’ä»¶ï¼Œæˆ‘çš„è§£å†³æ–¹æ¡ˆæ˜¯å°è£…ä¸€ä¸ª Cookieå¯¹è±¡ï¼Œæ ¹æ®å½“å‰çš„åè®®ç±»å‹åˆ¤æ–­ä½¿ç”¨å“ªç§æ–¹æ³•ï¼Œå¦‚æœæ˜¯ <code>file</code> åè®®ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code>// TODO: å¾…æ›´æ–°
</code></pre> 
<h4><a id="5_658"></a>ï¼ˆ5ï¼‰é™åˆ¶åªèƒ½æ‰“å¼€ä¸€ä¸ªçª—å£</h4> 
<p>ä½¿ç”¨ <code>requestSingleInstanceLock</code> æ–¹æ³•åˆ¤æ–­æ˜¯å¦å·²æœ‰å®ä¾‹åœ¨è¿è¡Œï¼Œå¹¶ç›‘å¬ <code>second-instance</code> ï¼Œå½“è¿è¡Œç¬¬äºŒä¸ªå®ä¾‹æ—¶ï¼Œèšç„¦åˆ°ä¸»çª—å£ï¼Œåœ¨ <code>electron/main.js</code> ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p> 
<pre><code>// é™åˆ¶åªèƒ½æ‰“å¼€ä¸€ä¸ªçª—å£
const gotTheLock = app.requestSingleInstanceLock();
if (!gotTheLock) {
  app.quit();
} else {
  app.on("second-instance", () =&gt; {
    // å½“è¿è¡Œç¬¬äºŒä¸ªå®ä¾‹æ—¶,å°†ä¼šèšç„¦åˆ° mainWindow è¿™ä¸ªçª—å£
    if (mainWindow) {
      if (mainWindow.isMinimized()) mainWindow.restore();
      mainWindow.focus();
      // mainWindow.show();
    }
  });
  
  app.whenReady().then(() =&gt; {
  // ...
  });
}
</code></pre> 
<h4><a id="6_680"></a>ï¼ˆ6ï¼‰å…³é—­çª—å£æ—¶æç¤º</h4> 
<p>ç›‘å¬ <code>close</code> äº‹ä»¶ï¼Œä½¿ç”¨ <code>dialog</code> å¼¹å‡ºæç¤ºï¼Œåœ¨ <code>electron/main.js</code> ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p> 
<pre><code>// electron/main.js
const { app, BrowserWindow, dialog } = require("electron");

const isPackaged = app.isPackaged;
let mainWindow;

const createWindow = () =&gt; {
  mainWindow = new BrowserWindow({
  // ...
  });
  
  // åœ¨çª—å£è¦å…³é—­çš„æ—¶å€™è§¦å‘
  mainWindow.on("close", (e) =&gt; {
    e.preventDefault();
    dialog
      .showMessageBox(mainWindow, {
        type: "info",
        title: "é€€å‡ºæç¤º",
        defaultId: 0,
        cancelId: 1,
        message: "ç¡®å®šè¦é€€å‡ºå—ï¼Ÿ",
        buttons: ["é€€å‡º", "å–æ¶ˆ"],
      })
      .then((res) =&gt; {
        if (res.response === 0) {
          // e.preventDefault();
          // mainWindow.destroy();
          app.exit(0);
        }
      });
  });
};
</code></pre> 
<hr> 
<h2><a id="_718"></a>ä¸‰ã€ä»£ç ç­¾å</h2> 
<blockquote> 
 <p>å‚è€ƒï¼š<a href="https://www.electron.build/code-signing" rel="nofollow">https://www.electron.build/code-signing</a></p> 
</blockquote> 
<h4><a id="1windows_720"></a>ï¼ˆ1ï¼‰windows</h4> 
<p>windows çš„è¯ä¹¦éœ€è¦æ‰¾æœ‰èµ„è´¨çš„å•†å®¶è´­ä¹°ï¼Œåœ¨æ­¤ä¸åšè¯´æ˜ï¼Œåªè¯´ä¸€ä¸‹ç­¾åé…ç½®ã€‚</p> 
<p>åœ¨ <code>package.json</code> çš„ <code>build</code> ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œè®¾ç½®ä½¿ç”¨çš„ç­¾åç®—æ³•ï¼Œæˆ‘ç”¨çš„æ˜¯ <code>sha256</code>:</p> 
<pre><code>{
  "build": {
    "win": {
      "signingHashAlgorithms": [
        "sha256"
      ]
    }
  }
}
</code></pre> 
<p>è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œ<code>CSC_LINK</code>ï¼ˆè¯ä¹¦åœ°å€ï¼‰ å’Œ <code>CSC_KEY_PASSWORD</code>ï¼ˆè¯ä¹¦å¯†ç ï¼‰ã€‚è¿è¡Œ <code>npm run electron:build</code> å³å¯æ‰“åŒ…ç­¾åçš„å®¢æˆ·ç«¯ã€‚</p> 
<h4><a id="2mac_736"></a>ï¼ˆ2ï¼‰mac</h4> 
<blockquote> 
 <p>å‚è€ƒï¼š<a href="https://kilianvalkhof.com/2019/electron/notarizing-your-electron-application/" rel="nofollow">Notarizing your Electron application</a></p> 
</blockquote> 
<p>mac ä»£ç ç­¾åéœ€è¦ç”³è¯· <a href="https://developer.apple.com/programs/" rel="nofollow">Apple Developer Program</a> ï¼Œå…·ä½“æµç¨‹å¯å‚è€ƒ<a href="https://www.cnblogs.com/shook/p/14536851.html" rel="nofollow">è‹¹æœå¼€å‘è€…å…¬å¸è´¦å·ç”³è¯·å…¨æµç¨‹ä»¥åŠå‡ºç°çš„é—®é¢˜</a>ï¼Œæœ‰é—®é¢˜å°±åœ¨<a href="https://developer.apple.com/contact/" rel="nofollow">å®¢æœé¡µé¢</a>æ‰“ç”µè¯å’¨è¯¢å®¢æœã€‚</p> 
<p>Apple Developer Program ç”³è¯·å®Œæˆåï¼Œè¦ç”Ÿæˆç­¾åè¯ä¹¦ï¼Œå‚è€ƒ<a href="https://www.cnblogs.com/lovesong/p/11782449.html" rel="nofollow">Mac Electron åº”ç”¨çš„ç­¾åï¼ˆsignatureï¼‰å’Œå…¬è¯ï¼ˆnotarizationï¼‰</a>ã€‚</p> 
<p>è¯ä¹¦ç”Ÿæˆåï¼Œéœ€è¦ä¿®æ”¹ä¸€ä¸‹é…ç½®ï¼Œä½¿ç”¨ <a href="https://github.com/electron/notarize">Electron Notarize</a> å…¬è¯åº”ç”¨ç¨‹åºï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… Electron Notarizeï¼š</p> 
<pre><code> npm install @electron/notarize --save-dev
</code></pre> 
<p>æµè§ˆå™¨æ‰“å¼€ <a href="https://appleid.apple.com/account/manage" rel="nofollow">https://appleid.apple.com/account/manage</a>ï¼Œç”Ÿæˆ Apple ä¸“ç”¨å¯†ç ã€‚</p> 
<p>æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œå…¶ä¸­ <code>&lt;USERNAME&gt;</code> æ›¿æ¢ä¸ºä½ çš„ Apple Idï¼Œ<code>&lt;PASSWORD&gt;</code> æ›¿æ¢ä¸ºåˆšæ‰ç”Ÿæˆçš„ä¸“ç”¨å¯†ç ï¼š</p> 
<pre><code>security add-generic-password -a "&lt;USERNAME&gt;" -w "&lt;PASSWORD&gt;" -s "AC_PASSWORD"
</code></pre> 
<p>åœ¨ <code>build</code> ç›®å½•ä¸‹æ–°å»º <code>notarize.js</code> æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p> 
<pre><code>const { notarize } = require("@electron/notarize");

exports.default = async function packageTask(context) {
  const { electronPlatformName, appOutDir } = context;
  if (electronPlatformName !== "darwin") {
    return;
  }

  const appName = context.packager.appInfo.productFilename;

  return await notarize({
    appBundleId: "your.id",
    appPath: `${appOutDir}/${appName}.app`,
    appleId: "email@example.com",
    appleIdPassword: `@keychain:AC_PASSWORD`,
  });
};
</code></pre> 
<p>åœ¨ <code>build</code> ç›®å½•ä¸‹æ–°å»º <code>entitlements.mac.plist</code> æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p> 
<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
  &lt;dict&gt;
    &lt;key&gt;com.apple.security.cs.allow-jit&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;com.apple.security.cs.debugger&lt;/key&gt;
    &lt;true/&gt;
  &lt;/dict&gt;
&lt;/plist&gt;
</code></pre> 
<p>åœ¨ <code>package.json</code> çš„ <code>build</code> ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p> 
<pre><code>{
  "build": {
    "afterSign": "build/notarize.js",
    "mac": {
      "hardenedRuntime": true,
      "gatekeeperAssess": false,
      "entitlements": "build/entitlements.mac.plist",
      "entitlementsInherit": "build/entitlements.mac.plist",
    }
  }
}
</code></pre> 
<p>è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œ<code>CSC_LINK</code>ï¼ˆè¯ä¹¦åœ°å€ï¼‰ å’Œ <code>CSC_KEY_PASSWORD</code>ï¼ˆè¯ä¹¦å¯†ç ï¼‰ã€‚è¿è¡Œ <code>npm run electron:build</code> å³å¯æ‰“åŒ…ç­¾åçš„å®¢æˆ·ç«¯ã€‚</p> 
<hr> 
<h2><a id="_807"></a>å››ã€è‡ªåŠ¨æ›´æ–°</h2> 
<blockquote> 
 <p>å‚è€ƒï¼š<a href="https://www.electron.build/auto-update" rel="nofollow">Auto Update</a></p> 
</blockquote> 
<p>æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… electron-updaterï¼š</p> 
<pre><code>npm install electron-updater
</code></pre> 
<p>åœ¨ <code>package.json</code> çš„ <code>build</code> ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œå…¶ä¸­ url ä¸ºå®¢æˆ·ç«¯æ›´æ–°åœ°å€ï¼š</p> 
<pre><code>{
  "build": {
    "publish": {
      "provider": "generic",
      "url": "https://example.com/app_client/",
      "channel": "latest"
    },
  }
}
</code></pre> 
<p>æ³¨ï¼šmac å¿…é¡»è¿›è¡Œä»£ç ç­¾åã€target åŒæ—¶å¯ç”¨ dmg å’Œ zipï¼Œæ‰èƒ½è‡ªåŠ¨æ›´æ–°</p> 
<p>åœ¨ <code>electron/main.js</code> æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p> 
<pre><code>const { app, BrowserWindow, dialog } = require("electron");
const { autoUpdater } = require("electron-updater");

const isPackaged = app.isPackaged;
let mainWindow;

const createWindow = () =&gt; {
  mainWindow = new BrowserWindow({
  // ...
  });

  // è‡ªåŠ¨æ›´æ–°
  function handleUpdate() {
    // æ›´æ–°åœ°å€
    const updateURL = "https://js.houzi8.com/app_client/";
    // è®¾ç½®æ˜¯å¦è‡ªåŠ¨ä¸‹è½½ï¼Œé»˜è®¤æ˜¯true,å½“ç‚¹å‡»æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬æ—¶ï¼Œä¼šè‡ªåŠ¨ä¸‹è½½å®‰è£…åŒ…ï¼Œæ‰€ä»¥è®¾ç½®ä¸ºfalse
    autoUpdater.autoDownload = false;
    // å¦‚æœå®‰è£…åŒ…ä¸‹è½½å¥½äº†ï¼Œé‚£ä¹ˆå½“åº”ç”¨é€€å‡ºåæ˜¯å¦è‡ªåŠ¨å®‰è£…æ›´æ–°
    autoUpdater.autoInstallOnAppQuit = true;
    // æ˜¯å¦æ¥å—å¼€å‘ç‰ˆï¼Œæµ‹è¯•ç‰ˆä¹‹ç±»çš„ç‰ˆæœ¬å·
    autoUpdater.allowPrerelease = false;
    // æ˜¯å¦å¯ä»¥å›é€€ç‰ˆæœ¬ï¼Œæ¯”å¦‚ä»å¼€å‘ç‰ˆé™åˆ°æ—§çš„ç¨³å®šç‰ˆ
    autoUpdater.allowDowngrade = false;
    autoUpdater.setFeedURL(updateURL);
    autoUpdater.on("error", function (error) {
      // æ£€æŸ¥æ›´æ–°å‡ºé”™
    });
    autoUpdater.on("checking-for-update", function () {
      // æ£€æŸ¥ä¸­
    });
    autoUpdater.on("update-not-available", function (info) {
      // å·²ç»æ˜¯æœ€æ–°ç‰ˆ
    });
    autoUpdater.on("update-available", function (info) {
      // æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬
      dialog
        .showMessageBox(mainWindow, {
          type: "info",
          title: "æ›´æ–°æç¤º",
          defaultId: 0,
          cancelId: 1,
          message: "æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬ï¼Œæ˜¯å¦ç«‹å³æ›´æ–°ï¼Ÿ",
          buttons: ["ç¡®å®š", "å–æ¶ˆ"],
        })
        .then((res) =&gt; {
          if (res.response === 0) {
            // æ‰§è¡Œä¸‹è½½å®‰è£…åŒ…
            autoUpdater.downloadUpdate();
          }
        });
    });
    autoUpdater.on("download-progress", function (progress) {
      // ä¸‹è½½è¿›åº¦
    });
    autoUpdater.on("update-downloaded", function (info) {
      // æ–°å®‰è£…åŒ…ä¸‹è½½å®Œæˆ
      dialog
        .showMessageBox(mainWindow, {
          type: "info",
          title: "æ›´æ–°æç¤º",
          defaultId: 0,
          cancelId: 1,
          message: "æ–°ç‰ˆæœ¬ä¸‹è½½å®Œæˆï¼Œæ˜¯å¦ç«‹å³å®‰è£…ï¼Ÿ",
          buttons: ["ç¡®å®š", "å–æ¶ˆ"],
        })
        .then((res) =&gt; {
          if (res.response === 0) {
            // é€€å‡ºåº”ç”¨å¹¶å®‰è£…æ›´æ–°
            autoUpdater.quitAndInstall();
            mainWindow.destroy();
          }
        });
    });

    // æ‰§è¡Œè‡ªåŠ¨æ›´æ–°æ£€æŸ¥
    autoUpdater.checkForUpdates();
  }

  if (isPackaged) {
    handleUpdate();
  }
};
</code></pre> 
<p>é…ç½®å®Œæˆåï¼Œæ‰§è¡Œ <code>npm run electron:build</code> æ‰“åŒ…ï¼Œå°†æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶ä¸Šä¼ åˆ° https://example.com/app_client/ å³å¯ã€‚<br> mac ä¸‹éœ€ä¸Šä¼ çš„æ–‡ä»¶æœ‰ï¼šlatest-mac.ymlã€Electron + Vue3 å¼€å‘æ¡Œé¢åº”ç”¨-1.0.0-mac.zipã€Electron + Vue3 å¼€å‘æ¡Œé¢åº”ç”¨-1.0.0.dmg<br> windows ä¸‹éœ€ä¸Šä¼ çš„æ–‡ä»¶æœ‰ï¼šlatest.ymlã€Electron + Vue3 å¼€å‘æ¡Œé¢åº”ç”¨ Setup 1.0.0.exe</p> 
<hr> 
<p><strong>å‚è€ƒæ–‡çŒ®ï¼š</strong></p> 
<blockquote> 
 <p><a href="https://vitejs.cn" rel="nofollow">Vite</a><br> <a href="https://cn.vuejs.org" rel="nofollow">Vue</a><br> <a href="https://www.electronjs.org/" rel="nofollow">Electron</a><br> <a href="https://www.electron.build/" rel="nofollow">electron-builder</a><br> <a href="https://github.com/open-cli-tools/concurrently">concurrently</a><br> <a href="https://www.bilibili.com/video/BV1j44y1J7x1?spm_id_from=333.999.0.0&amp;vd_source=184ecc37e30bb471877e3208d0ff15cd" rel="nofollow">electron-vite-vue3-tså¼€å‘ç¯å¢ƒæ­å»º</a><br> <a href="https://stackoverflow.com/questions/49637026/mainwindow-loadurlhttps-localhost3000-show-white-screen-on-electron-app/49673272" rel="nofollow">mainWindow.loadURL(â€œhttps://localhost:3000/â€) show white screen on Electron app</a><br> <a href="https://blog.csdn.net/weixin_39621860/article/details/111490058">vueçƒ­æ›´æ–°å¤±æ•ˆ_vue-cli3çƒ­æ›´æ–°å¤±æ•ˆ</a><br> <a href="https://docs.npmjs.com/cli/v9/configuring-npm/package-json?v=true" rel="nofollow">package.json æ–‡æ¡£</a><br> <a href="https://kilianvalkhof.com/2019/electron/notarizing-your-electron-application/" rel="nofollow">Notarizing your Electron application</a><br> <a href="https://developer.apple.com/programs/" rel="nofollow">Apple Developer Program</a><br> <a href="https://www.cnblogs.com/shook/p/14536851.html" rel="nofollow">è‹¹æœå¼€å‘è€…å…¬å¸è´¦å·ç”³è¯·å…¨æµç¨‹ä»¥åŠå‡ºç°çš„é—®é¢˜</a><br> <a href="https://www.cnblogs.com/lovesong/p/11782449.html" rel="nofollow">Mac Electron åº”ç”¨çš„ç­¾åï¼ˆsignatureï¼‰å’Œå…¬è¯ï¼ˆnotarizationï¼‰</a><br> <a href="https://github.com/electron/notarize">Electron Notarize</a></p> 
</blockquote>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6dbfbf3a649674a84f16f73e6260f21e/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">clickhouseè¿æ¥å·¥å…·dbeaver</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/005db6a16874961fce4c2db0384b6230/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">ä¿æ—¶æ·ç‰ˆå°ç±³æ±½è½¦æ¥äº†ï¼Œ9.9ä¸‡ä¸å¯èƒ½ï¼</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ITå­¦ä¹ è€…åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>