<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C&#43;&#43; functional - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C&#43;&#43; functional" />
<meta property="og:description" content="文章目录 std::function std::bad_function_callstd::bindstd::ref std::cref std::reference_wrapperstd::mem_fn 类模板std::function是通用多态函数封装器。 std::function的实例能存储、复制及调用任何可调用函数、 lambda表达式、 bind表达式或其他函数对象，还有指向成员函数指针和指向数据成员指针。 若 std::function 不含目标，则称它为空。调用空std::function的目标导致抛出std::bad_function_call异常。 std::function std::bad_function_call function是一个类模板，模板声明如下。
构造函数支持默认构造（空function，不是一个有效的function）、引用类型、右值引用、拷贝赋值运算符支持的类型也很全。重载了bool()可以用于判断function是否是有效的支持交互function重载了()，支持不定参数支持获取函数类型信息target_type template&lt;class&gt; class function; // undefined template&lt;class R, class... ArgTypes&gt; class function&lt;R(ArgTypes...)&gt; : public unary_function&lt;T1, R&gt; // iff sizeof...(ArgTypes) == 1 and ArgTypes contains T1 : public binary_function&lt;T1, T2, R&gt; // iff sizeof...(ArgTypes) == 2 and ArgTypes contains T1 and T2 { public: typedef R result_type; // construct/copy/destroy: function() noexcept; function(nullptr_t) noexcept; function(const function&amp;); function(function&amp;&amp;) noexcept; template&lt;class F&gt; function(F); function&amp; operator=(const function&amp;); function&amp; operator=(function&amp;&amp;) noexcept; function&amp; operator=(nullptr_t) noexcept; template&lt;class F&gt; function&amp; operator=(F&amp;&amp;); template&lt;class F&gt; function&amp; operator=(reference_wrapper&lt;F&gt;) noexcept; ~function(); // function modifiers: void swap(function&amp;) noexcept; // function capacity: explicit operator bool() const noexcept; // function invocation: R operator()(ArgTypes." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/1705156def8161cd2fa25510a5b3aa4b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-05-13T10:11:02+08:00" />
<meta property="article:modified_time" content="2021-05-13T10:11:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C&#43;&#43; functional</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#stdfunction_stdbad_function_call_4" rel="nofollow">std::function std::bad_function_call</a></li><li><a href="#stdbind_90" rel="nofollow">std::bind</a></li><li><a href="#stdref_stdcref_stdreference_wrapper_172" rel="nofollow">std::ref std::cref std::reference_wrapper</a></li><li><a href="#stdmem_fn_175" rel="nofollow">std::mem_fn</a></li></ul> 
</div> 
<br> 类模板std::function是通用多态函数封装器。 std::function的实例能存储、复制及调用任何可调用函数、 lambda表达式、 bind表达式或其他函数对象，还有指向成员函数指针和指向数据成员指针。 
<br> 若 std::function 不含目标，则称它为空。调用空std::function的目标导致抛出std::bad_function_call异常。 
<p></p> 
<h2><a id="stdfunction_stdbad_function_call_4"></a>std::function std::bad_function_call</h2> 
<p><code>function</code>是一个类模板，模板声明如下。</p> 
<ul><li>构造函数支持默认构造（空function，不是一个有效的function）、引用类型、右值引用、拷贝赋值运算符支持的类型也很全。</li><li>重载了<code>bool()</code>可以用于判断function是否是有效的</li><li>支持交互function</li><li>重载了<code>()</code>，支持不定参数</li><li>支持获取函数类型信息target_type</li></ul> 
<pre><code class="prism language-c">template<span class="token operator">&lt;</span>class<span class="token operator">&gt;</span> class function<span class="token punctuation">;</span> <span class="token comment">// undefined</span>
template<span class="token operator">&lt;</span>class R<span class="token punctuation">,</span> class<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> ArgTypes<span class="token operator">&gt;</span>
class function<span class="token operator">&lt;</span><span class="token function">R</span><span class="token punctuation">(</span>ArgTypes<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">&gt;</span>
  <span class="token operator">:</span> public unary_function<span class="token operator">&lt;</span>T1<span class="token punctuation">,</span> R<span class="token operator">&gt;</span>      <span class="token comment">// iff sizeof...(ArgTypes) == 1 and ArgTypes contains T1</span>
  <span class="token operator">:</span> public binary_function<span class="token operator">&lt;</span>T1<span class="token punctuation">,</span> T2<span class="token punctuation">,</span> R<span class="token operator">&gt;</span> <span class="token comment">// iff sizeof...(ArgTypes) == 2 and ArgTypes contains T1 and T2</span>
<span class="token punctuation">{<!-- --></span>
public<span class="token operator">:</span>
    <span class="token keyword">typedef</span> R result_type<span class="token punctuation">;</span>

    <span class="token comment">// construct/copy/destroy:</span>
    <span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> noexcept<span class="token punctuation">;</span>
    <span class="token function">function</span><span class="token punctuation">(</span><span class="token class-name">nullptr_t</span><span class="token punctuation">)</span> noexcept<span class="token punctuation">;</span>
    <span class="token function">function</span><span class="token punctuation">(</span><span class="token keyword">const</span> function<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">function</span><span class="token punctuation">(</span>function<span class="token operator">&amp;&amp;</span><span class="token punctuation">)</span> noexcept<span class="token punctuation">;</span>
    template<span class="token operator">&lt;</span>class F<span class="token operator">&gt;</span> <span class="token function">function</span><span class="token punctuation">(</span>F<span class="token punctuation">)</span><span class="token punctuation">;</span>

    function<span class="token operator">&amp;</span> operator<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> function<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    function<span class="token operator">&amp;</span> operator<span class="token operator">=</span><span class="token punctuation">(</span>function<span class="token operator">&amp;&amp;</span><span class="token punctuation">)</span> noexcept<span class="token punctuation">;</span>
    function<span class="token operator">&amp;</span> operator<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">nullptr_t</span><span class="token punctuation">)</span> noexcept<span class="token punctuation">;</span>
    template<span class="token operator">&lt;</span>class F<span class="token operator">&gt;</span> function<span class="token operator">&amp;</span> operator<span class="token operator">=</span><span class="token punctuation">(</span>F<span class="token operator">&amp;&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    template<span class="token operator">&lt;</span>class F<span class="token operator">&gt;</span> function<span class="token operator">&amp;</span> operator<span class="token operator">=</span><span class="token punctuation">(</span>reference_wrapper<span class="token operator">&lt;</span>F<span class="token operator">&gt;</span><span class="token punctuation">)</span> noexcept<span class="token punctuation">;</span>

    <span class="token operator">~</span><span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// function modifiers:</span>
    <span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>function<span class="token operator">&amp;</span><span class="token punctuation">)</span> noexcept<span class="token punctuation">;</span>

    <span class="token comment">// function capacity:</span>
    explicit operator <span class="token function">bool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> noexcept<span class="token punctuation">;</span>

    <span class="token comment">// function invocation:</span>
    R <span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ArgTypes<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

    <span class="token comment">// function target access:</span>
    <span class="token keyword">const</span> std<span class="token operator">::</span>type_info<span class="token operator">&amp;</span> <span class="token function">target_type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> noexcept<span class="token punctuation">;</span>
    template <span class="token operator">&lt;</span>typename T<span class="token operator">&gt;</span>       T<span class="token operator">*</span> <span class="token function">target</span><span class="token punctuation">(</span><span class="token punctuation">)</span> noexcept<span class="token punctuation">;</span>
    template <span class="token operator">&lt;</span>typename T<span class="token operator">&gt;</span> <span class="token keyword">const</span> T<span class="token operator">*</span> <span class="token function">target</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> noexcept<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>例子<br> 尽量覆盖大部分功能</li></ul> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;functional&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">struct</span> <span class="token class-name">S</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">void</span> <span class="token function">operator</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"S::()"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"f()"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">ff</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ff()"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token function">f1</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token function">f2</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出f()</span>
    <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出f()</span>
    f2 <span class="token operator">=</span> ff<span class="token punctuation">;</span>
    <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出ff()</span>
    f1<span class="token punctuation">.</span><span class="token function">swap</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出ff()</span>
    <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出f()</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> f1<span class="token punctuation">.</span><span class="token function">target_type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">", "</span> <span class="token operator">&lt;&lt;</span> f2<span class="token punctuation">.</span><span class="token function">target_type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token comment">// 可能输出PFvvE, PFvvE</span>
    std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> f3 <span class="token operator">=</span> <span class="token function">S</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">f3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出S::()</span>
    std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> f4<span class="token punctuation">;</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>f4 <span class="token operator">?</span> <span class="token string">"valid"</span> <span class="token operator">:</span> <span class="token string">"invalid"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>  <span class="token comment">// 输出invalid</span>
    try <span class="token punctuation">{<!-- --></span> <span class="token function">f4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token function">catch</span><span class="token punctuation">(</span>std<span class="token operator">::</span>bad_function_call e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*std::exceptionvalid*/</span> <span class="token punctuation">}</span>
    f4 <span class="token operator">=</span> f2<span class="token punctuation">;</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>f4 <span class="token operator">?</span> <span class="token string">"valid"</span> <span class="token operator">:</span> <span class="token string">"invalid"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token comment">// 输出valid</span>
    <span class="token keyword">auto</span> f5 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"lambda"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">auto</span> f6 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"lambda with parameter "</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">f5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出lambda</span>
    <span class="token function">f6</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出lambda with parameter 100</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="stdbind_90"></a>std::bind</h2> 
<ul><li><code>bind</code>是一个函数模块，支持带返回值，它会返回类模板<code>__bind</code>对象，我们可以通过调用<code>__bind</code>中的<code>()</code>调用函数，它会自动填充我们设置的参数。</li><li><code>__bind</code>通过<code>tuple</code>存储我们传入的参数，在我们调用<code>()</code>的时候再依次取出</li></ul> 
<pre><code class="prism language-c">template<span class="token operator">&lt;</span>class _Fp<span class="token punctuation">,</span> class <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>_BoundArgs<span class="token operator">&gt;</span>
<span class="token keyword">inline</span> _LIBCPP_INLINE_VISIBILITY __bind<span class="token operator">&lt;</span>_Fp<span class="token punctuation">,</span> _BoundArgs<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span> <span class="token function">bind</span><span class="token punctuation">(</span>_Fp<span class="token operator">&amp;&amp;</span> __f<span class="token punctuation">,</span> _BoundArgs<span class="token operator">&amp;&amp;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> __bound_args<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">typedef</span> __bind<span class="token operator">&lt;</span>_Fp<span class="token punctuation">,</span> _BoundArgs<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span> type<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">type</span><span class="token punctuation">(</span>_VSTD<span class="token operator">::</span>forward<span class="token operator">&lt;</span>_Fp<span class="token operator">&gt;</span><span class="token punctuation">(</span>__f<span class="token punctuation">)</span><span class="token punctuation">,</span> _VSTD<span class="token operator">::</span>forward<span class="token operator">&lt;</span>_BoundArgs<span class="token operator">&gt;</span><span class="token punctuation">(</span>__bound_args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

template<span class="token operator">&lt;</span>class _Rp<span class="token punctuation">,</span> class _Fp<span class="token punctuation">,</span> class <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>_BoundArgs<span class="token operator">&gt;</span>
<span class="token keyword">inline</span> _LIBCPP_INLINE_VISIBILITY __bind_r<span class="token operator">&lt;</span>_Rp<span class="token punctuation">,</span> _Fp<span class="token punctuation">,</span> _BoundArgs<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span> <span class="token function">bind</span><span class="token punctuation">(</span>_Fp<span class="token operator">&amp;&amp;</span> __f<span class="token punctuation">,</span> _BoundArgs<span class="token operator">&amp;&amp;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> __bound_args<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">typedef</span> __bind_r<span class="token operator">&lt;</span>_Rp<span class="token punctuation">,</span> _Fp<span class="token punctuation">,</span> _BoundArgs<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span> type<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">type</span><span class="token punctuation">(</span>_VSTD<span class="token operator">::</span>forward<span class="token operator">&lt;</span>_Fp<span class="token operator">&gt;</span><span class="token punctuation">(</span>__f<span class="token punctuation">)</span><span class="token punctuation">,</span> _VSTD<span class="token operator">::</span>forward<span class="token operator">&lt;</span>_BoundArgs<span class="token operator">&gt;</span><span class="token punctuation">(</span>__bound_args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

template<span class="token operator">&lt;</span>class _Fp<span class="token punctuation">,</span> class <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>_BoundArgs<span class="token operator">&gt;</span>
class __bind <span class="token operator">:</span> public __weak_result_type<span class="token operator">&lt;</span>typename decay<span class="token operator">&lt;</span>_Fp<span class="token operator">&gt;</span><span class="token operator">::</span>type<span class="token operator">&gt;</span>
<span class="token punctuation">{<!-- --></span>
protected<span class="token operator">:</span>
    <span class="token keyword">typedef</span> typename decay<span class="token operator">&lt;</span>_Fp<span class="token operator">&gt;</span><span class="token operator">::</span>type _Fd<span class="token punctuation">;</span>
    <span class="token keyword">typedef</span> tuple<span class="token operator">&lt;</span>typename decay<span class="token operator">&lt;</span>_BoundArgs<span class="token operator">&gt;</span><span class="token operator">::</span>type<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span> _Td<span class="token punctuation">;</span>
private<span class="token operator">:</span>
    _Fd __f_<span class="token punctuation">;</span>
    _Td __bound_args_<span class="token punctuation">;</span>

    <span class="token keyword">typedef</span> typename __make_tuple_indices<span class="token operator">&lt;</span><span class="token keyword">sizeof</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>_BoundArgs<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">::</span>type __indices<span class="token punctuation">;</span>
public<span class="token operator">:</span>
    template <span class="token operator">&lt;</span>class _Gp<span class="token punctuation">,</span> class <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>_BA<span class="token punctuation">,</span>
              class <span class="token operator">=</span> typename enable_if<span class="token operator">&lt;</span>is_constructible<span class="token operator">&lt;</span>_Fd<span class="token punctuation">,</span> _Gp<span class="token operator">&gt;</span><span class="token operator">::</span>value <span class="token operator">&amp;&amp;</span>
                                  <span class="token operator">!</span>is_same<span class="token operator">&lt;</span>typename remove_reference<span class="token operator">&lt;</span>_Gp<span class="token operator">&gt;</span><span class="token operator">::</span>type<span class="token punctuation">,</span> __bind<span class="token operator">&gt;</span><span class="token operator">::</span>value<span class="token operator">&gt;</span><span class="token operator">::</span>type<span class="token operator">&gt;</span>
      _LIBCPP_INLINE_VISIBILITY
      explicit <span class="token function">__bind</span><span class="token punctuation">(</span>_Gp<span class="token operator">&amp;&amp;</span> __f<span class="token punctuation">,</span> _BA<span class="token operator">&amp;&amp;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>__bound_args<span class="token punctuation">)</span>
        <span class="token operator">:</span> <span class="token function">__f_</span><span class="token punctuation">(</span>_VSTD<span class="token operator">::</span>forward<span class="token operator">&lt;</span>_Gp<span class="token operator">&gt;</span><span class="token punctuation">(</span>__f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token function">__bound_args_</span><span class="token punctuation">(</span>_VSTD<span class="token operator">::</span>forward<span class="token operator">&lt;</span>_BA<span class="token operator">&gt;</span><span class="token punctuation">(</span>__bound_args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

    template <span class="token operator">&lt;</span>class <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>_Args<span class="token operator">&gt;</span>
        _LIBCPP_INLINE_VISIBILITY
        typename __bind_return<span class="token operator">&lt;</span>_Fd<span class="token punctuation">,</span> _Td<span class="token punctuation">,</span> tuple<span class="token operator">&lt;</span>_Args<span class="token operator">&amp;&amp;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span><span class="token operator">::</span>type <span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_Args<span class="token operator">&amp;&amp;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>__args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> _VSTD<span class="token operator">::</span><span class="token function">__apply_functor</span><span class="token punctuation">(</span>__f_<span class="token punctuation">,</span> __bound_args_<span class="token punctuation">,</span> <span class="token function">__indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tuple<span class="token operator">&lt;</span>_Args<span class="token operator">&amp;&amp;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>_VSTD<span class="token operator">::</span>forward<span class="token operator">&lt;</span>_Args<span class="token operator">&gt;</span><span class="token punctuation">(</span>__args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    template <span class="token operator">&lt;</span>class <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>_Args<span class="token operator">&gt;</span>
        _LIBCPP_INLINE_VISIBILITY
        typename __bind_return<span class="token operator">&lt;</span><span class="token keyword">const</span> _Fd<span class="token punctuation">,</span> <span class="token keyword">const</span> _Td<span class="token punctuation">,</span> tuple<span class="token operator">&lt;</span>_Args<span class="token operator">&amp;&amp;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span><span class="token operator">::</span>type  <span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_Args<span class="token operator">&amp;&amp;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>__args<span class="token punctuation">)</span> <span class="token keyword">const</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> _VSTD<span class="token operator">::</span><span class="token function">__apply_functor</span><span class="token punctuation">(</span>__f_<span class="token punctuation">,</span> __bound_args_<span class="token punctuation">,</span> <span class="token function">__indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  tuple<span class="token operator">&lt;</span>_Args<span class="token operator">&amp;&amp;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>_VSTD<span class="token operator">::</span>forward<span class="token operator">&lt;</span>_Args<span class="token operator">&gt;</span><span class="token punctuation">(</span>__args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>例子</li></ul> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;functional&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">struct</span> <span class="token class-name">S</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">S</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">i</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"["</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">"] "</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"S::f()"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> a2<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"a1="</span> <span class="token operator">&lt;&lt;</span> a1 <span class="token operator">&lt;&lt;</span> <span class="token string">", a2="</span> <span class="token operator">&lt;&lt;</span> a2 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> a2<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// ctor</span>
    S <span class="token function">s</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> f1 <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>S<span class="token operator">::</span>f1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> f2 <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>S<span class="token operator">::</span>f1<span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token function">S</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [0] S::f()</span>
    <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1] S::f()</span>
    <span class="token keyword">int</span> a1 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> a2 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> f3 <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>S<span class="token operator">::</span>f2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> a1<span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">ref</span><span class="token punctuation">(</span>a2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">f3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a1=5, a2=10</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"a1="</span> <span class="token operator">&lt;&lt;</span> a1 <span class="token operator">&lt;&lt;</span> <span class="token string">", a2="</span> <span class="token operator">&lt;&lt;</span> a2 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token comment">// a1=5, a2=100</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="stdref_stdcref_stdreference_wrapper_172"></a>std::ref std::cref std::reference_wrapper</h2> 
<p>函数模板<code>ref</code>与<code>cref</code>是生成<code>std::reference_wrapper</code>类型对象的帮助函数，它们用模板实参推导确定结果的模板实参。上面的bind例子有用到。</p> 
<h2><a id="stdmem_fn_175"></a>std::mem_fn</h2> 
<p><code>mem_fn</code>是一个函数模板，以下是<code>mem_fn</code>的定义，它的返回值是指向成员指针的包装对象<code>__mem_fn</code>。</p> 
<pre><code class="prism language-c">template<span class="token operator">&lt;</span>class _Rp<span class="token punctuation">,</span> class _Tp<span class="token operator">&gt;</span>
<span class="token keyword">inline</span> _LIBCPP_INLINE_VISIBILITY __mem_fn<span class="token operator">&lt;</span>_Rp _Tp<span class="token operator">::</span><span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token function">mem_fn</span><span class="token punctuation">(</span>_Rp _Tp<span class="token operator">::</span><span class="token operator">*</span> __pm<span class="token punctuation">)</span> _NOEXCEPT
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> __mem_fn<span class="token operator">&lt;</span>_Rp _Tp<span class="token operator">::</span><span class="token operator">*</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>__pm<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>例子</li></ul> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;functional&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">struct</span> <span class="token class-name">S</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">S</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">i</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">S</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"["</span> <span class="token operator">&lt;&lt;</span> this <span class="token operator">&lt;&lt;</span> <span class="token string">"] i = "</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    S <span class="token function">s1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">s2</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">auto</span> f1 <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">mem_fn</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>S<span class="token operator">::</span>f1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">f1</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">f1</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>输出</li></ul> 
<pre><code>[0x7ffee7f5e138] i = 10
[0x7ffee7f5e130] i = 100
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c32bc9e5110d34b7e0f3c5dfa88dfd2c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Hashcat使用教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8dd1b7f3f71d102a96ba16bf0c61ce51/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">进程调度</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>