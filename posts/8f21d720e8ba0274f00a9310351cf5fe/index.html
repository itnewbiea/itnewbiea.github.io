<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>gradle和git_使用git，gradle和markdown创建漂亮的发行说明 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="gradle和git_使用git，gradle和markdown创建漂亮的发行说明" />
<meta property="og:description" content="gradle和git
在最后几天，我问自己如何从git的commit / tag消息中获得的信息生成发行说明。 决定 我的第一种方法是直接从提交消息创建更改列表，但是这种方法有很多缺点。 提交消息必须写得非常严格 需要一个标记来收集属于发行版的消息（通常的标记就足够了） 提交消息的内容必须遵循约定，以便功能 ， 错误修正和更改可以收集并在一个块中显示。 因此，我选择了带注释的标签，该标签必须提供带有标签的消息。 使用git创建它们相当容易 git tag -a v.1.0.0 -m &#34;This is an annotated tag&#34; 旁注：这种标记有一个不错的补充，它允许检查哪些提交属于特定标记。 下一个决定是关于消息应使用的标记语言。 因为我是markdown的粉丝，所以决定这么做。 这将导致人类可读的消息以及众所周知且有效的解析。 重要提示 Git通常将＃解释为注释的开始。 如果您要使用的头标和头标更多，则必须使用选项–cleanup = verbatim创建带注释的标签，以禁止使用此功能。 通过这一决定，我开始在gradle中实现一个小示例，该示例在构建过程中创建发行说明。 在下一节中，我向您展示所需的代码 实作 先决条件 因为我也想要发行说明的漂亮版本，所以我决定将markdown直接转换为html页面。 为此，我将PegDown用作Markdown处理器，并使用带有bootswatch主题的twitter bootstrap来对输出进行样式设置。 初始构建脚本 buildscript { repositories { mavenCentral() mavenLocal() } dependencies { classpath &#39;org.pegdown:pegdown:1.4.1&#39; } } import org.pegdown.PegDownProcessor import groovy.text.SimpleTemplateEngine 实施逻辑 我们从控制控件生成发行说明的过程开始 task releaseNotes() { def releaseNotes = new File(&#39;releaseNotes.md&#39;) releaseNotes.delete() def versions = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8f21d720e8ba0274f00a9310351cf5fe/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-14T02:55:52+08:00" />
<meta property="article:modified_time" content="2020-05-14T02:55:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">gradle和git_使用git，gradle和markdown创建漂亮的发行说明</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="entry" style="font-size: 16px;"> 
 <p>gradle和git</p> 
 <div class="e3lan-post"> 
  <div> 
   <span class="bt-uid-tg"></span> 
  </div> 
 </div> 
 <p> 在最后几天，我问自己如何从git的commit / tag消息中获得的信息生成发行说明。 </p> 
 <h3>决定</h3> 
 <p> 我的第一种方法是直接从提交消息创建更改列表，但是这种方法有很多缺点。 <br><br></p> 
 <ul><li> 提交消息必须写得非常严格 </li><li> 需要一个标记来收集属于发行版的消息（通常的标记就足够了） </li><li> 提交消息的内容必须遵循约定，以便<em>功能</em> ， <em>错误修正</em>和<em>更改</em>可以收集并在一个块中显示。 </li></ul> 
 <p> 因此，我选择了带注释的标签，该标签必须提供带有标签的消息。 使用git创建它们相当容易 </p> 
 <pre class="has"><code class="notranslate brush:shell">git tag -a v.1.0.0 -m "This is an annotated tag"</code></pre> 
 <p> 旁注：这种标记有一个不错的补充，它允许检查哪些提交属于特定标记。 </p> 
 <p> 下一个决定是关于消息应使用的标记语言。 因为我是markdown的粉丝，所以决定这么做。 这将导致人类可读的消息以及众所周知且有效的解析。 </p> 
 <h5> <span style="font-weight: bold;">重要提示</span> </h5> 
 <p> Git通常将＃解释为注释的开始。 如果您要使用的头标和头标更多，则必须使用选项–cleanup = verbatim创建带注释的标签，以禁止使用此功能。 </p> 
 <p> 通过这一决定，我开始在gradle中实现一个小示例，该示例在构建过程中创建发行说明。 在下一节中，我向您展示所需的代码 </p> 
 <h3>实作</h3> 
 <h4>先决条件</h4> 
 <p> 因为我也想要发行说明的漂亮版本，所以我决定将markdown直接转换为html页面。 为此，我将<a href="https://github.com/sirthias/pegdown" target="_blank" rel="noopener noreferrer">PegDown</a>用作Markdown处理器，并使用带有<a href="https://bootswatch.com/" rel="nofollow noopener noreferrer" target="_blank">bootswatch</a>主题的<a href="https://getbootstrap.com/" rel="nofollow noopener noreferrer" target="_blank">twitter bootstrap</a>来对输出进行样式设置。 </p> 
 <h4>初始构建脚本</h4> 
 <pre class="has"><code class="notranslate brush:java">buildscript {
    repositories {
        mavenCentral()
        mavenLocal()
    }
    dependencies {
        classpath 'org.pegdown:pegdown:1.4.1'
    }
}
 
import org.pegdown.PegDownProcessor
import groovy.text.SimpleTemplateEngine</code></pre> 
 <h4>实施逻辑</h4> 
 <p> 我们从控制控件生成发行说明的过程开始 </p> 
 <pre class="has"><code class="notranslate brush:java">task releaseNotes() {
    def releaseNotes = new File('releaseNotes.md')
    releaseNotes.delete()
    def versions = ""
    def tags = readTags()
    tags.each {tag -&gt;
        versions += "- [$tag](#$tag)\n"
    }
 
    tags.each {tag -&gt;
        releaseNotes &lt;&lt; "# ${tag}<a name="%24tag"></a>\n"
        def message = readTagMessage(tag)
        message.each{releaseNotes &lt;&lt; "$it\n"}
        releaseNotes &lt;&lt; "\n"
    }
 
    def writer = new StringWriter()
    def pdp = new PegDownProcessor()
    def engine = new SimpleTemplateEngine()
    def template = engine.createTemplate(new File("releaseNotes.tpl"))
    def daten = [releaseNotes:pdp.markdownToHtml(new File("releaseNotes.md").text), application: project.name, versions:pdp.markdownToHtml(versions)]
 
    def ergebnis = template.make(daten)
    new File('releaseNotes.html').withWriter { w -&gt;
        w.write(ergebnis)
    }
}</code></pre> 
 <p> 这个过程真的很简单。 </p> 
 <ul><li> 首先，我们清理降价文件的旧工件（第2行和第3行）。 之后，我们创建了<i class="raw_i_node">Versions</i>部分，并加载可用的标签（第5至10行），并将所有内容放入单独的列表中。 </li><li> 然后，我们创建有关<em>发行说明的</em>信息，并为每个标签添加一个标头，然后添加属于该标签的消息（第12至18行）。 </li><li> 作为最后一步，我们解析markdown文件并通过将解析后的值传递给模板来创建html页面。 </li></ul> 
 <p> 如您所见，还需要三个组件 </p> 
 <ol><li> <em>readTags</em>方法 </li><li> <em>readTagMessage</em>方法 </li><li> html页面的模板 </li></ol> 
 <h4>readTags</h4> 
 <p> 该方法调用： </p> 
 <pre class="has"><code class="notranslate brush:java">git tag -l</code></pre> 
 <p> 并返回标签的反向排序列表 </p> 
 <pre class="has"><code class="notranslate brush:java">def readTags() {
    def tags = []
    def proc = "git tag -l".execute()
    proc.in.eachLine { line -&gt; tags += line}
    tags.sort {}
    Collections.reverse( tags )
    tags
}</code></pre> 
 <h4>readTagMessage</h4> 
 <p> 该方法使用 </p> 
 <pre class="has"><code class="notranslate brush:java&gt; git cat-file tag &lt;TAG&gt;&lt;/pre&gt;&lt;p&gt;to retrieve the message that was provided for this tag.&lt;/p&gt;&lt;pre class=">def readTagMessage(String tag) {
    def message = []
    def proc = "git cat-file tag $tag".execute()
    def startCollection = false
    proc.in.eachLine { line -&gt;
        if (line.isEmpty()) {
            startCollection = true
        }
        if (startCollection) {
            message += line
        }
    }
    proc.err.eachLine { line -&gt; println line }
    message
}</code></pre> 
 <h4>releaseNotes.tpl</h4> 
 <p> 该模板包含三个属性<em>应用程序，</em> <em>releaseNotes</em>和<em>版本</em> 。 <em>应用程序</em>将替换为您的应用程序名称，并在标题中使用。 <em>releaseNotes</em>包含转换后的发行说明。 最后， <em>版本</em>代表： </p> 
 <pre class="has"><code class="notranslate brush:xml">&lt;?xml version="1.0" encoding="iso-8859-1" ?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xml:lang='de' xmlns='http://www.w3.org/1999/xhtml' lang='de'&gt;
    &lt;head&gt;
        &lt;title&gt;Release Notes of $application&lt;/title&gt;
        &lt;link rel="stylesheet" href="http://bootswatch.com/yeti/bootstrap.min.css"&gt;
        &lt;link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css"&gt;
        &lt;style type="text/css"&gt;
        .releasenotes h1 {
          font-size: 1.5em;
        }
        .releasenotes h2 {
          font-size: 1.2em;
        }
      &lt;/style&gt;
    &lt;/head&gt;
    &lt;body&gt;
      &lt;div class="row"&gt;
      &lt;div class="navbar navbar-default"&gt;
        &lt;div class="col-md-4"&gt;&lt;/div&gt;
        &lt;div class="col-md-4"&gt;
          &lt;h1&gt;Releasenotes&lt;/h1&gt;
        &lt;/div&gt;
        &lt;div class="col-md-4"&gt;&lt;/div&gt;
      &lt;/div&gt;
      &lt;/div&gt;
        &lt;div class="row releasenotes"&gt;
            &lt;div class="col-md-4"&gt;&lt;/div&gt;
            &lt;div class="col-md-4"&gt;$releaseNotes&lt;/div&gt;
            &lt;div class="col-md-4"&gt;&lt;h1&gt;Versions&lt;/h1&gt;$versions&lt;/div&gt;
        &lt;/div&gt;
        &lt;script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre> 
 <p> 如先决条件中所述，twitter引导程序和bootswatch的主题将用于美化代码。 </p> 
 <h4>最后</h4> 
 <p> 将所有内容放在一起后，我们可以创建一个带注释的标签并简单地调用 </p> 
 <pre class="has"><code class="notranslate brush:java">gradle releaseNotes</code></pre> 
 <p> gradle将读取所有消息和标签并创建两个文件 </p> 
 <ul><li> releaseNotes.md和 </li><li> releaseNotes.html（ <a href="http://coders-kitchen.com/additional/releaseNotes.html" rel="nofollow">示例</a> –感谢我的一位同事对这个版本的布局和设计的想法） </li></ul> 
 <h3>结论</h3> 
 <p> 通过这个简单的构建脚本和一些约定，我们可以从存储库信息中创建发行说明。 另外，由于所有内容都直接存储在存储库中，因此我们不必维护发行说明的多个位置。 </p> 
 <p> 通过使用Markdown，我们可以使用简单的标记和人类可读的标记语言，使我们能够为Web应用程序创建漂亮的发行说明。 像我在本示例中一样，可以将markdown信息直接解析到html页面，但是您也可以提供简单的markdown文件，并在客户端或服务器上的交付时解析它。 </p> 
 <ul><li> 像往常一样，完整的代码可在github <a href="https://github.com/coders-kitchen/tut-releaseNotesFromTags">https://github.com/coders-kitchen/tut-releaseNotesFromTags上找到。</a> </li></ul> 
 <p></p> 
 <div> 
  <b class="raw_b_node"><i class="raw_i_node">参考：</i></b>来自<a href="http://coders-kitchen.com/" rel="nofollow">Coders Kitchen</a>博客的<a href="//www.javacodegeeks.com/jcg" rel="nofollow">JCG合作伙伴</a> Peter Daum <a href="http://coders-kitchen.com/2014/03/13/creating-beautiful-release-notes-with-git-gradle-and-markdown/" rel="nofollow">使用git，gradle和markdown创建了漂亮的发行说明</a> 。 
 </div> 
 <br> 
 <blockquote> 
  <p>翻译自: <a href="https://www.javacodegeeks.com/2014/03/creating-beautiful-release-notes-with-git-gradle-and-markdown.html" rel="nofollow">https://www.javacodegeeks.com/2014/03/creating-beautiful-release-notes-with-git-gradle-and-markdown.html</a></p> 
 </blockquote> 
 <p>gradle和git</p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4c59ed1f4343c9677826c9f03199e24d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Spring的Web MVC –重定向到内存泄漏</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/53276d77aef124dfe61a3b8e5e941d6f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue轮播图简单实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>