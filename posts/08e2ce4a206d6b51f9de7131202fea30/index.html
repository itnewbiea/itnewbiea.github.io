<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#使用dev的ChartControl控件绘图 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#使用dev的ChartControl控件绘图" />
<meta property="og:description" content="一、准备数据 画图首先需要有数据，本教程使用Bogus生成测试数据
这个教程建了一个demo类，结构如下所示: public class Demo { public int? Id { get; set; } public string? City { get; set; } } 只有两个属性，一个Id，一个City
使用Bogus生成测试数据的代码如下：
Randomizer.Seed = new Random(8675309); var Cities = new[] { &#34;武汉&#34;, &#34;长沙&#34;, &#34;福州&#34;, &#34;南昌&#34;, &#34;厦门&#34;, &#34;泉州&#34; }; var orderIds = 0; var demoGenerator = new Faker&lt;Demo&gt;(&#34;zh_CN&#34;) .RuleFor(x =&gt; x.Id, f =&gt; orderIds&#43;&#43;) .RuleFor(x =&gt; x.City, f =&gt; f.PickRandom(Cities)); var demos = demoGenerator.Generate(1000); 指定Randomizer.Seed可以使生成的测试数据不变，具体怎么使用bogus不是本文讨论的内容，暂且不表。
查看生成的内容
本教程假定需求是要统计每个City出现的次数，并绘制图表
对列表中City字段进行去重，可以使用linq中的distinct方法，如下所示：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/08e2ce4a206d6b51f9de7131202fea30/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-31T20:40:12+08:00" />
<meta property="article:modified_time" content="2023-10-31T20:40:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#使用dev的ChartControl控件绘图</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>一、准备数据</h3> 
<p>画图首先需要有数据，本教程使用Bogus生成测试数据</p> 
<p>这个教程建了一个demo类，结构如下所示:  </p> 
<pre><code class="language-cs">
        public class Demo
        {
            public int? Id { get; set; }
            public string? City { get; set; }
        }

</code></pre> 
<p>只有两个属性，一个Id，一个City</p> 
<p>使用Bogus生成测试数据的代码如下：</p> 
<pre><code class="language-cs">            Randomizer.Seed = new Random(8675309);
            var Cities = new[] { "武汉", "长沙", "福州", "南昌", "厦门", "泉州" };
            var orderIds = 0;
            var demoGenerator = new Faker&lt;Demo&gt;("zh_CN")
                .RuleFor(x =&gt; x.Id, f =&gt; orderIds++)
                .RuleFor(x =&gt; x.City, f =&gt; f.PickRandom(Cities));
            var demos = demoGenerator.Generate(1000);</code></pre> 
<p>指定Randomizer.Seed可以使生成的测试数据不变，具体怎么使用bogus不是本文讨论的内容，暂且不表。</p> 
<p>查看生成的内容</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/e0/18/VAqKK1iq_o.png"></p> 
<p><strong>本教程假定需求是要统计每个City出现的次数，并绘制图表</strong></p> 
<p>对列表中City字段进行去重，可以使用linq中的distinct方法，如下所示：</p> 
<pre><code class="language-cs"> var regionList = demos.Select(x =&gt; x.City).Distinct().ToList();</code></pre> 
<p>查看regionList的结果</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/a3/a0/vuLKEPgz_o.png"></p> 
<p>然后利用linq中的count方法统计每个City出现的次数，为了方便画图，这里新建了一个DataPoint类</p> 
<p>DataPoint类的结构如下所示：</p> 
<pre><code class="language-cs">        public class DataPoint
        {
            public string? name { get; set; } // X轴值
            public int? value { get; set; }    // Y轴值
        }</code></pre> 
<p>统计各个City出现的次数，并写入DataPoint类列表中，代码如下所示：</p> 
<pre><code class="language-cs">            for (int i = 0; i &lt; regionList.Count; i++)
            {
                DataPoint point = new DataPoint();
                point.name = regionList[i];
                int count = demos.Count(x =&gt; x.City == regionList[i]);
                point.value = count;
                dataPoints.Add(point);
            }</code></pre> 
<p>结果如下图所示：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/79/f0/XiXpC7t4_o.png"></p> 
<p>现在我们已经有画图的数据了，现在就可以正式开始画图了</p> 
<h3>二、使用ChartControl控件画图</h3> 
<h4>添加控件</h4> 
<p>为了便于展示画图结果，添加了一个tabcontrol控件并添加了4个tabpage，在每个tabpage上添加对应的控件，并设置Dock为fill，如下图所示：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/db/65/oxdXuFLa_o.png"></p> 
<p>这种拖拉控件的方式比较简单，但是如果想在运行时生成也是可以的，这里也提供一下运行时生成的示例代码，如下所示：</p> 
<pre><code class="language-cs">            ChartControl chart = new ChartControl();
            xtraTabPage1.Controls.Add(chart);
            chart.Dock = DockStyle.Fill;</code></pre> 
<h4>添加Series</h4> 
<p>新建Series的代码如下所示：</p> 
<pre><code class="language-cs">            // 创建一个折线图Series
            Series series = new Series("折线图", ViewType.Line);
            // 创建一个柱状图Series
            Series series1 = new Series("柱状图", ViewType.Bar);
            // 创建一个饼状图Series
            Series series2 = new Series("饼状图", ViewType.Pie);</code></pre> 
<p>将数据添加到Series的方法如下所示：</p> 
<pre><code class="language-cs">            // 将数据添加到Series中
            foreach (var dataPoint in dataPoints)
            {
                series.Points.Add(new SeriesPoint(dataPoint.name, dataPoint.value));
                series1.Points.Add(new SeriesPoint(dataPoint.name, dataPoint.value));
                series2.Points.Add(new SeriesPoint(dataPoint.name, dataPoint.value));
            }</code></pre> 
<p>将Series添加到ChartControl的方法如下所示：</p> 
<pre><code class="language-cs">            // 将Series添加到ChartControl中        
            chartControl1.Series.Add(series);
            chartControl2.Series.Add(series1);
            chartControl3.Series.Add(series2);</code></pre> 
<h4>自定义图表样式</h4> 
<p>自定义图表的外观代码如下所示：</p> 
<pre><code class="language-cs">            // 自定义图表的外观       
            //将折线图的Legend隐藏
            series.ShowInLegend = false;
            //将柱状图的Legend隐藏
            series1.ShowInLegend = false;
            //显示饼状图的值和百分比
            series2.LegendTextPattern = "{A}: {VP:P2}";</code></pre> 
<p>     </p> 
<h4>添加标题</h4> 
<p>为图表添加标题的代码如下：</p> 
<pre><code class="language-cs">            // 添加标题
            ChartTitle chartTitle = new ChartTitle();
            chartTitle.Text = "City统计折线图";
            chartControl1.Titles.Add(chartTitle);

            ChartTitle chartTitle1 = new ChartTitle();
            chartTitle1.Text = "City统计柱状图";
            chartControl2.Titles.Add(chartTitle1);

            ChartTitle chartTitle2 = new ChartTitle();
            chartTitle2.Text = "City统计饼状图";
            chartControl3.Titles.Add(chartTitle2);</code></pre> 
<h4>查看绘图结果</h4> 
<p>绘制的折线图如下图所示：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/a6/9e/u4zvfNYN_o.png"></p> 
<p>绘制的柱状图所下图所示：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/c7/66/75svTIPU_o.png"></p> 
<p>绘制的饼状图如下所示：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/cc/2b/whSfQrry_o.png"></p> 
<h3>补充</h3> 
<p>该Demo还有一个数据展示页签，使用了gridcontrol控件这里不展开讲，涉及到的代码如下：</p> 
<pre><code class="language-cs"> //新建DataTable类
 DataTable dt = new DataTable();
 //DataTable添加列
 dt.Columns.Add("Name", typeof(string));
 dt.Columns.Add("Value", typeof(int));
 // 将数据添加到Series中
 foreach (var dataPoint in dataPoints)
  {
         series.Points.Add(new SeriesPoint(dataPoint.name, dataPoint.value));
         series1.Points.Add(new SeriesPoint(dataPoint.name, dataPoint.value));
         series2.Points.Add(new SeriesPoint(dataPoint.name, dataPoint.value));
         DataRow dataRow = dt.NewRow();
         dataRow["Name"] = dataPoint.name;
         dataRow["Value"] = dataPoint.value;
         dt.Rows.Add(dataRow);
  }
 //将DataTable绑定到GridControl上
 gridControl1.DataSource = dt;</code></pre> 
<p>结果如下图所示：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/58/b1/HD5u4a3T_o.png"></p> 
<h3>完整代码</h3> 
<pre><code class="language-cs">using Bogus;
using DevExpress.XtraBars;
using DevExpress.XtraCharts;
using DevExpress.XtraGrid;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace ChartControlDemo
{
    public partial class ToolbarForm1 : DevExpress.XtraEditors.XtraForm
    {
        List&lt;DataPoint&gt; dataPoints = new List&lt;DataPoint&gt;();
        DataTable dt = new DataTable();
        public class Demo
        {
            public int? Id { get; set; }
            public string? City { get; set; }

        }
        public class DataPoint
        {
            public string? name { get; set; } // X轴值
            public int? value { get; set; }    // Y轴值
        }
        public ToolbarForm1()
        {
            InitializeComponent();
        }

        private void barButtonItem1_ItemClick(object sender, ItemClickEventArgs e)
        {
            Randomizer.Seed = new Random(8675309);
            var Cities = new[] { "武汉", "长沙", "福州", "南昌", "厦门", "泉州" };
            var orderIds = 0;
            var demoGenerator = new Faker&lt;Demo&gt;("zh_CN")
                .RuleFor(x =&gt; x.Id, f =&gt; orderIds++)
                .RuleFor(x =&gt; x.City, f =&gt; f.PickRandom(Cities));
            var demos = demoGenerator.Generate(1000);
            var regionList = demos.Select(x =&gt; x.City).Distinct().ToList();
            for (int i = 0; i &lt; regionList.Count; i++)
            {
                DataPoint point = new DataPoint();
                point.name = regionList[i];
                int count = demos.Count(x =&gt; x.City == regionList[i]);
                point.value = count;
                dataPoints.Add(point);
            }

            //开始画图

            // 创建一个折线图Series
            Series series = new Series("折线图", ViewType.Line);
            // 创建一个柱状图Series
            Series series1 = new Series("柱状图", ViewType.Bar);
            // 创建一个饼状图Series
            Series series2 = new Series("饼状图", ViewType.Pie);

            //DataTable添加列
            dt.Columns.Add("Name", typeof(string));
            dt.Columns.Add("Value", typeof(int));

            // 将数据添加到Series中
            foreach (var dataPoint in dataPoints)
            {
                series.Points.Add(new SeriesPoint(dataPoint.name, dataPoint.value));
                series1.Points.Add(new SeriesPoint(dataPoint.name, dataPoint.value));
                series2.Points.Add(new SeriesPoint(dataPoint.name, dataPoint.value));
                DataRow dataRow = dt.NewRow();
                dataRow["Name"] = dataPoint.name;
                dataRow["Value"] = dataPoint.value;
                dt.Rows.Add(dataRow);
            }

            // 将Series添加到ChartControl中        
            chartControl1.Series.Add(series);
            chartControl2.Series.Add(series1);
            chartControl3.Series.Add(series2);

            // 自定义图表的外观       
            //将折线图的Legend隐藏
            series.ShowInLegend = false;
            //将柱状图的Legend隐藏
            series1.ShowInLegend = false;
            //显示饼状图的值和百分比
            series2.LegendTextPattern = "{A}: {VP:P2}";

            // 添加标题
            ChartTitle chartTitle = new ChartTitle();
            chartTitle.Text = "City统计折线图";
            chartControl1.Titles.Add(chartTitle);

            ChartTitle chartTitle1 = new ChartTitle();
            chartTitle1.Text = "City统计柱状图";
            chartControl2.Titles.Add(chartTitle1);

            ChartTitle chartTitle2 = new ChartTitle();
            chartTitle2.Text = "City统计饼状图";
            chartControl3.Titles.Add(chartTitle2);

            //将DataTable绑定到GridControl上
            gridControl1.DataSource = dt;
        }</code></pre> 
<h3>项目地址</h3> 
<p><a href="https://github.com/Ming-jiayou/ChartControlDemo" title="GitHub - Ming-jiayou/ChartControlDemo: A simple example of using dev's ChartControl control in Winforms">GitHub - Ming-jiayou/ChartControlDemo: A simple example of using dev's ChartControl control in Winforms</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f3c27f56ac08932168ccecd649277f2f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C#HttpClient返回的结果为乱码的解决方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/07a590b7e5c4b1c9326eed484304c1aa/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C#在Winform中使用Spire.OCR进行图片文字识别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>