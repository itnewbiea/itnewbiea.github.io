<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>痛点-调研-明确需求-实现-测试-发布 不需要手一步到位使用AGI生成去广告脚本,复制粘贴发布到Greasy Fork - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="痛点-调研-明确需求-实现-测试-发布 不需要手一步到位使用AGI生成去广告脚本,复制粘贴发布到Greasy Fork" />
<meta property="og:description" content="总算又想起密码了, 自从用了语雀后, 其他平台基本都不再使用了
csdn 真的**, c h a t g p t 是禁词(已经改为了AGI, 通用型人工智能), 你倒是说清楚啊,直接来一句违反社区规定, 莫名其妙, 得靠猜…服了 今天来补上一篇利用AGI生成的js去广告脚本 前置知识(不看也问题不大) 转发与重定向
转发页面的URL不会改变，而重定向地址会改变
301与302
页面广告生成原理(也是使用AGI) 网页上的广告实现主要依赖于两个技术：Cookie和JavaScript。
Cookie是一种存储在用户计算机上的小型文本文件，它可以记录用户的浏览历史、兴趣偏好等信息。当用户访问网站时，网站会将Cookie存储在用户计算机上。广告平台可以通过读取Cookie中的信息，了解用户的兴趣偏好，从而向用户投放相关的广告。
JavaScript是一种脚本语言，它可以在网页中实现动态效果和交互功能。广告平台通常会将JavaScript代码嵌入到网页中，当用户访问网页时，JavaScript代码会向广告平台发送请求，请求广告内容。广告平台会根据请求的参数，选择合适的广告内容返回给JavaScript代码，然后JavaScript代码将广告内容插入到网页中。
综上所述，网页上的广告实现主要依赖于Cookie和JavaScript技术，通过收集用户信息和动态插入广告内容来实现。
痛点-调研-明确需求-技术选型-编码实现 发现痛点: 经常观看的动漫网站(正经人看的正经网站, 我就不说了, 主打的就是一个吊胃口)有一个很顽固的广告(移动端)
调研: 网上没有相关移动端网站去广告的脚本, 在网上找找相关解决文案需求: 写一个脚本, 能力是去广告技术选型: 使用JavaScript实现: 很多移动端浏览器不支持插件脚本,使用的是火狐浏览器可以使用油猴插件(油猴插件是可以运行脚本, via浏览器可以直接运行脚本) 使用HttpCanary(小黄鸟)抓 包发现广告请求的状态码是301(永久重定向), 然后让gpt帮我写一个脚本测试:分别使用两个浏览器进行测试, 如未达预期跳转到第4步, 成功则发布发布:发布到Greasy Fork脚本网站
进行微调, 处理边界条件, 尝试进行优化: 黑白名单, 防误触, 长按加入黑名单,禁止重定向
最终生成最强1.9版本 // ==UserScript== // @name Advertising Plus // @namespace http://your-namespace-here // @version 1.9 // @description Disable 301 redirects on web pages and block potential ads." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c989cbae17d279ebfefe18e3bf21caa7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-04T01:04:18+08:00" />
<meta property="article:modified_time" content="2023-07-04T01:04:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">痛点-调研-明确需求-实现-测试-发布 不需要手一步到位使用AGI生成去广告脚本,复制粘贴发布到Greasy Fork</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>总算又想起密码了, 自从用了语雀后, 其他平台基本都不再使用了</p> 
<h2><a id="csdn__c_h_a_t_g_p_t_AGI_____1"></a>csdn 真的**, c h a t g p t 是禁词(已经改为了AGI, 通用型人工智能), 你倒是说清楚啊,直接来一句违反社区规定, 莫名其妙, 得靠猜…服了</h2> 
<h2><a id="AGIjs_2"></a>今天来补上一篇利用AGI生成的js去广告脚本</h2> 
<h3><a id="_3"></a>前置知识(不看也问题不大)</h3> 
<p><a href="https://blog.csdn.net/weixin_51270766/article/details/124594365">转发与重定向</a><br> <strong>转发页面的URL不会改变，而重定向地址会改变</strong><br> <a href="https://blog.csdn.net/qq_43842093/article/details/122973464">301与302</a></p> 
<h3><a id="AGI_8"></a>页面广告生成原理(也是使用AGI)</h3> 
<p><img src="https://images2.imgbox.com/44/61/2pwk1Qua_o.png" alt="在这里插入图片描述"></p> 
<p>网页上的广告实现主要依赖于两个技术：Cookie和JavaScript。</p> 
<p>Cookie是一种存储在用户计算机上的小型文本文件，它可以记录用户的浏览历史、兴趣偏好等信息。当用户访问网站时，网站会将Cookie存储在用户计算机上。广告平台可以通过读取Cookie中的信息，了解用户的兴趣偏好，从而向用户投放相关的广告。</p> 
<p>JavaScript是一种脚本语言，它可以在网页中实现动态效果和交互功能。广告平台通常会将JavaScript代码嵌入到网页中，当用户访问网页时，JavaScript代码会向广告平台发送请求，请求广告内容。广告平台会根据请求的参数，选择合适的广告内容返回给JavaScript代码，然后JavaScript代码将广告内容插入到网页中。</p> 
<p>综上所述，网页上的广告实现主要依赖于Cookie和JavaScript技术，通过收集用户信息和动态插入广告内容来实现。</p> 
<h3><a id="_19"></a>痛点-调研-明确需求-技术选型-编码实现</h3> 
<ol><li>发现痛点: 经常观看的动漫网站(正经人看的正经网站, 我就不说了, 主打的就是一个吊胃口)有一个很顽固的广告(移动端)<br> 调研: 网上没有相关移动端网站去广告的脚本, 在网上找找相关解决文案</li><li>需求: 写一个脚本, 能力是去广告</li><li>技术选型: 使用JavaScript</li><li>实现: 很多移动端浏览器不支持插件脚本,使用的是火狐浏览器可以使用油猴插件(油猴插件是可以运行脚本, via浏览器可以直接运行脚本) 使用HttpCanary(小黄鸟)抓 包发现广告请求的状态码是301(永久重定向), 然后让gpt帮我写一个脚本</li><li>测试:分别使用两个浏览器进行测试, 如未达预期跳转到第4步, 成功则发布</li><li>发布:发布到Greasy Fork脚本网站<br> <img src="https://images2.imgbox.com/78/04/dvCj4y8H_o.png" alt="在这里插入图片描述"><br> 进行微调, 处理边界条件, 尝试进行优化: <strong>黑白名单, 防误触, 长按加入黑名单,禁止重定向</strong><br> <img src="https://images2.imgbox.com/15/6f/i241C0Fx_o.png" alt="在这里插入图片描述"><br> 最终生成最强1.9版本</li></ol> 
<pre><code class="prism language-js"><span class="token comment">// ==UserScript==</span>
<span class="token comment">// @name         Advertising Plus</span>
<span class="token comment">// @namespace    http://your-namespace-here</span>
<span class="token comment">// @version      1.9</span>
<span class="token comment">// @description  Disable 301 redirects on web pages and block potential ads.  通过HttpCanary抓 包发现某动漫网站广告状态码为301(永久重定向),</span>

<span class="token comment">// @match        *://www.脚本生效的网站.com/*</span>
<span class="token comment">// @grant        none</span>
<span class="token comment">// @license MIT</span>
<span class="token comment">// ==/UserScript==</span>

<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'use strict'</span><span class="token punctuation">;</span>
    <span class="token comment">// 定义允许访问的小说网站域名白名单</span>
    <span class="token keyword">var</span> allowedDomains <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">'https://www.脚本生效的网站.com'</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// 从 LocalStorage 中加载已保存的黑名单列表</span>
    <span class="token keyword">var</span> blockedDomains <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'blockedDomains'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>blockedDomains<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        blockedDomains <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>blockedDomains<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        blockedDomains <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 默认为空列表</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 检查当前域名是否在允许访问的域名白名单中</span>
    <span class="token keyword">var</span> currentDomain <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hostname<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDomainAllowed</span><span class="token punctuation">(</span>currentDomain<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 拦截所有请求</span>
        window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'beforeunload'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">var</span> url <span class="token operator">=</span> xhr<span class="token punctuation">.</span>responseURL<span class="token punctuation">;</span>
            <span class="token keyword">var</span> domain <span class="token operator">=</span> <span class="token function">getDomainFromUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 检查请求的域名是否在白名单中</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isDomainAllowed</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 在这里可以选择显示一个提示或执行其他自定义操作</span>
                <span class="token comment">// 阻止301重定向</span>
                window<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 遍历页面上的所有链接和图片元素</span>
        <span class="token keyword">var</span> links <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> images <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 屏蔽链接中包含被列入黑名单的域名的广告</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> links<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> link <span class="token operator">=</span> links<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isPotentialAd</span><span class="token punctuation">(</span>link<span class="token punctuation">.</span>href<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isDomainAllowed</span><span class="token punctuation">(</span><span class="token function">getDomainFromUrl</span><span class="token punctuation">(</span>link<span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                link<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>detail <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        event<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> domain <span class="token operator">=</span> <span class="token function">getDomainFromUrl</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'是否将 '</span> <span class="token operator">+</span> domain <span class="token operator">+</span> <span class="token string">' 标记为广告并加入黑名单？'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token function">addToBlockedDomains</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token comment">// 在这里可以选择显示一个成功提示或执行其他自定义操作</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 屏蔽图片中包含被列入黑名单的域名的广告</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> images<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> image <span class="token operator">=</span> images<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isPotentialAd</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>src<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isDomainAllowed</span><span class="token punctuation">(</span><span class="token function">getDomainFromUrl</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> mouseDownTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> mouseUpTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                image<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousedown'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    mouseDownTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                image<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mouseup'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    mouseUpTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> clickDuration <span class="token operator">=</span> mouseUpTime <span class="token operator">-</span> mouseDownTime<span class="token punctuation">;</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span>clickDuration <span class="token operator">&lt;</span> <span class="token number">500</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 假设点击持续时间少于500毫秒为误触</span>
                        event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        event<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> domain <span class="token operator">=</span> <span class="token function">getDomainFromUrl</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'是否将 '</span> <span class="token operator">+</span> domain <span class="token operator">+</span> <span class="token string">' 标记为广告并加入黑名单？'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token function">addToBlockedDomains</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token comment">// 在这里可以选择显示一个成功提示或执行其他自定义操作</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 将域名加入到黑名单</span>
    <span class="token keyword">function</span> <span class="token function">addToBlockedDomains</span><span class="token punctuation">(</span><span class="token parameter">domain</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>blockedDomains<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            blockedDomains<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 保存更新后的黑名单到 LocalStorage</span>
            localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'blockedDomains'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>blockedDomains<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 检查域名是否在白名单中</span>
    <span class="token keyword">function</span> <span class="token function">isDomainAllowed</span><span class="token punctuation">(</span><span class="token parameter">domain</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> allowedDomains<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">matchWildcard</span><span class="token punctuation">(</span>allowedDomains<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> domain<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 检查链接的域名是否为潜在广告</span>
    <span class="token keyword">function</span> <span class="token function">isPotentialAd</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> domain <span class="token operator">=</span> <span class="token function">getDomainFromUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> domain <span class="token operator">!==</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isDomainAllowed</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 提取链接的域名</span>
    <span class="token keyword">function</span> <span class="token function">getDomainFromUrl</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> anchor <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        anchor<span class="token punctuation">.</span>href <span class="token operator">=</span> url<span class="token punctuation">;</span>
        <span class="token keyword">return</span> anchor<span class="token punctuation">.</span>hostname<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 通配符匹配函数</span>
    <span class="token keyword">function</span> <span class="token function">matchWildcard</span><span class="token punctuation">(</span><span class="token parameter">pattern<span class="token punctuation">,</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> regex <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">'^'</span> <span class="token operator">+</span> pattern<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\*</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">'.*'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'$'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> regex<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>总结如下: 在两个浏览器都试验了下, 最终结果…</p> 
<h4><a id="Greasy_Fork_171"></a>发布到Greasy Fork</h4> 
<p><img src="https://images2.imgbox.com/9a/70/AQReXrCL_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5d/02/gXGzdhum_o.png" alt="在这里插入图片描述"><br> 拉到最下方[发布脚本]即可</p> 
<p>脚本地址<a href="https://greasyfork.org/zh-CN/scripts/468854-advertising-plus" rel="nofollow">点我</a>: https://greasyfork.org/zh-CN/scripts/468854-advertising-plus</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3ad8ffff982d4a77833eda2e3973bfa3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">深入探索NT架构：建立高性能、可扩展的系统</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/813cb449705e4e31a295843b851db2d2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">问题较真之 ScrollView嵌套ListView listView只显示一个条目的高度</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>