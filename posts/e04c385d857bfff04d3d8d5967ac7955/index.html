<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>服务器文件上传ajax,AJAX实现基于WEB的文件上传的进度控制 - 代码实现(服务器端)... - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="服务器文件上传ajax,AJAX实现基于WEB的文件上传的进度控制 - 代码实现(服务器端)..." />
<meta property="og:description" content="2.1. 服务器端代码
2.1.1. 文件上传状态类(FileUploadStatus)
使用FileUploadStatus这个类记录文件上传状态，并将其作为服务器端与web客户端之间通信的媒介，通过对这个类对象提供上传状态作为服务器回应发送给web客户端，web客户端使用JavaScript获得文件上传状态。源代码如下：/**
* 本例程演示了通过Web上传文件过程中的进度显示。您可以对本例程进行任何修改和使用。
*
* 如需要转载，请注明作者。
*
* 作者： 刘作晨
*
*/
package liuzuochen.sample.upload;
import java.util.*;
public class FileUploadStatus {
//上传用户地址
private String uploadAddr;
//上传总量
private long uploadTotalSize = 0;
//读取上传总量
private long readTotalSize = 0;
//当前上传文件号
private int currentUploadFileNum = 0;
//成功读取上传文件数
private int successUploadFileCount = 0;
//状态
private String status = &#34;&#34;;
//处理起始时间
private long processStartTime = 0l;
//处理终止时间
private long processEndTime = 0l;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e04c385d857bfff04d3d8d5967ac7955/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-11T21:20:49+08:00" />
<meta property="article:modified_time" content="2021-08-11T21:20:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">服务器文件上传ajax,AJAX实现基于WEB的文件上传的进度控制 - 代码实现(服务器端)...</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>2.1. 服务器端代码</p> 
 <p>2.1.1. 文件上传状态类(FileUploadStatus)</p> 
 <p>使用FileUploadStatus这个类记录文件上传状态，并将其作为服务器端与web客户端之间通信的媒介，通过对这个类对象提供上传状态作为服务器回应发送给web客户端，web客户端使用JavaScript获得文件上传状态。源代码如下：/**</p> 
 <p>* 本例程演示了通过Web上传文件过程中的进度显示。您可以对本例程进行任何修改和使用。</p> 
 <p>*</p> 
 <p>* 如需要转载，请注明作者。</p> 
 <p>*</p> 
 <p>* 作者： 刘作晨</p> 
 <p>*</p> 
 <p>*/</p> 
 <p>package liuzuochen.sample.upload;</p> 
 <p>import java.util.*;</p> 
 <p>public class FileUploadStatus {<!-- --></p> 
 <p>//上传用户地址</p> 
 <p>private String uploadAddr;</p> 
 <p>//上传总量</p> 
 <p>private long uploadTotalSize = 0;</p> 
 <p>//读取上传总量</p> 
 <p>private long readTotalSize = 0;</p> 
 <p>//当前上传文件号</p> 
 <p>private int currentUploadFileNum = 0;</p> 
 <p>//成功读取上传文件数</p> 
 <p>private int successUploadFileCount = 0;</p> 
 <p>//状态</p> 
 <p>private String status = "";</p> 
 <p>//处理起始时间</p> 
 <p>private long processStartTime = 0l;</p> 
 <p>//处理终止时间</p> 
 <p>private long processEndTime = 0l;</p> 
 <p>//处理执行时间</p> 
 <p>private long processRunningTime = 0l;</p> 
 <p>//上传文件URL列表</p> 
 <p>private List uploadFileUrlList = new ArrayList();</p> 
 <p>//取消上传</p> 
 <p>private boolean cancel = false;</p> 
 <p>//上传base目录</p> 
 <p>private String baseDir = "";</p> 
 <p>public FileUploadStatus() {<!-- --></p> 
 <p>}</p> 
 <p>public String getBaseDir() {<!-- --></p> 
 <p>return baseDir;</p> 
 <p>}</p> 
 <p>public void setBaseDir(String baseDir) {<!-- --></p> 
 <p>this.baseDir = baseDir;</p> 
 <p>}</p> 
 <p>public boolean getCancel() {<!-- --></p> 
 <p>return cancel;</p> 
 <p>}</p> 
 <p>public void setCancel(boolean cancel) {<!-- --></p> 
 <p>this.cancel = cancel;</p> 
 <p>}</p> 
 <p>public List getUploadFileUrlList() {<!-- --></p> 
 <p>return uploadFileUrlList;</p> 
 <p>}</p> 
 <p>public void setUploadFileUrlList(List uploadFileUrlList)</p> 
 <p>{    this.uploadFileUrlList = uploadFileUrlList;</p> 
 <p>}</p> 
 <p>public long getProcessRunningTime() {<!-- --></p> 
 <p>return processRunningTime;</p> 
 <p>}</p> 
 <p>public void setProcessRunningTime(long</p> 
 <p>processRunningTime) {<!-- --></p> 
 <p>this.processRunningTime = processRunningTime;</p> 
 <p>}</p> 
 <p>public long getProcessEndTime() {<!-- --></p> 
 <p>return processEndTime;</p> 
 <p>}</p> 
 <p>public void setProcessEndTime(long processEndTime) {<!-- --></p> 
 <p>this.processEndTime = processEndTime;</p> 
 <p>}</p> 
 <p>public long getProcessStartTime() {<!-- --></p> 
 <p>return processStartTime;</p> 
 <p>}</p> 
 <p>public void setProcessStartTime(long processStartTime) {<!-- --></p> 
 <p>this.processStartTime = processStartTime;</p> 
 <p>}</p> 
 <p>public long getReadTotalSize() {<!-- --></p> 
 <p>return readTotalSize;</p> 
 <p>}</p> 
 <p>public void setReadTotalSize(long readTotalSize) {<!-- --></p> 
 <p>this.readTotalSize = readTotalSize;</p> 
 <p>}</p> 
 <p>public int getSuccessUploadFileCount() {<!-- --></p> 
 <p>return successUploadFileCount;</p> 
 <p>}</p> 
 <p>public void setSuccessUploadFileCount(int</p> 
 <p>successUploadFileCount) {<!-- --></p> 
 <p>this.successUploadFileCount =</p> 
 <p>successUploadFileCount;</p> 
 <p>}</p> 
 <p>public int getCurrentUploadFileNum() {<!-- --></p> 
 <p>return currentUploadFileNum;</p> 
 <p>}</p> 
 <p>public void setCurrentUploadFileNum(int</p> 
 <p>currentUploadFileNum) {<!-- --></p> 
 <p>this.currentUploadFileNum = currentUploadFileNum;</p> 
 <p>}</p> 
 <p>public String getStatus() {<!-- --></p> 
 <p>return status;</p> 
 <p>}</p> 
 <p>public void setStatus(String status) {<!-- --></p> 
 <p>this.status = status;</p> 
 <p>}</p> 
 <p>public long getUploadTotalSize() {<!-- --></p> 
 <p>return uploadTotalSize;</p> 
 <p>}</p> 
 <p>public String getUploadAddr() {<!-- --></p> 
 <p>return uploadAddr;</p> 
 <p>}</p> 
 <p>public void setUploadTotalSize(long uploadTotalSize) {<!-- --></p> 
 <p>this.uploadTotalSize = uploadTotalSize;</p> 
 <p>}</p> 
 <p>public void setUploadAddr(String uploadAddr) {<!-- --></p> 
 <p>this.uploadAddr = uploadAddr;</p> 
 <p>}</p> 
 <p>public String toJSon() {<!-- --></p> 
 <p>StringBuffer strJSon = new StringBuffer();</p> 
 <p>strJSon.append("</p> 
 <p>{UploadTotalSize:").append(getUploadTotalSize()).append(</p> 
 <p>",")</p> 
 <p>.append</p> 
 <p>("ReadTotalSize:").append(getReadTotalSize()).append</p> 
 <p>(",")</p> 
 <p>.append</p> 
 <p>("CurrentUploadFileNum:").append(getCurrentUploadFileNum()).</p> 
 <p>append(",")</p> 
 <p>.append</p> 
 <p>("SuccessUploadFileCount:").append(</p> 
 <p>getSuccessUploadFileCount()).append(",")      .append</p> 
 <p>("Status:'").append(getStatus()).append("',")      .append</p> 
 <p>("ProcessStartTime:").append(getProcessStartTime()).      append(",")</p> 
 <p>.append("ProcessEndTime:").append(getProcessEndTime()).append(        ",")</p> 
 <p>.append("ProcessRunningTime:").append(getProcessRunningTime()).</p> 
 <p>append(",")      .append("Cancel:").append(getCancel()).append("}");</p> 
 <p>return strJSon.toString();</p> 
 <p>}</p> 
 <p>}</p> 
 <p>2.1.2. 文件上传状态侦听类(FileUploadListener)</p> 
 <p>使用Common-FileUpload 1.2版本(20070103)。此版本提供了能够监视文件上传情况的 ProcessListener接口，</p> 
 <p>使开发者通过FileUploadBase类对象的setProcessListener方法植入自己的Listener。</p> 
 <p>FileUploadListener类实现了ProcessListener，在整个文件上传过程中，它对上传进度进行监控，</p> 
 <p>并且根据上传 情况实时的更新上传状态Bean。源代码如下：/**</p> 
 <p>* 本例程演示了通过Web上传文件过程中的进度显示。您可以对本例程进行任何修改和使用。</p> 
 <p>*</p> 
 <p>* 如需要转载，请注明作者。</p> 
 <p>*</p> 
 <p>* 作者： 刘作晨</p> 
 <p>*</p> 
 <p>*/</p> 
 <p>package liuzuochen.sample.upload;</p> 
 <p>import org.apache.commons.fileupload.ProgressListener;</p> 
 <p>import javax.servlet.http.HttpServletRequest;</p> 
 <p>public class FileUploadListener implements ProgressListener{<!-- --></p> 
 <p>private HttpServletRequest request=null;</p> 
 <p>public FileUploadListener(HttpServletRequest request){<!-- --></p> 
 <p>this.request=request;</p> 
 <p>}</p> 
 <p>/**</p> 
 <p>* 更新状态</p> 
 <p>*/</p> 
 <p>public void update(long pBytesRead, long pContentLength, int pItems){<!-- --></p> 
 <p>FileUploadStatus statusBean= BackGroundService.getStatusBean(request);</p> 
 <p>statusBean.setUploadTotalSize(pContentLength);</p> 
 <p>//读取完成</p> 
 <p>if (pContentLength == -1) {<!-- --></p> 
 <p>statusBean.setStatus("完成对" + pItems +"个文件的读取:读取了 " + pBytesRead + " bytes.");</p> 
 <p>statusBean.setReadTotalSize(pBytesRead);</p> 
 <p>statusBean.setSuccessUploadFileCount(pItems);</p> 
 <p>statusBean.setProcessEndTime(System.currentTimeMillis());</p> 
 <p>statusBean.setProcessRunningTime(statusBean.getProcessEndTime());</p> 
 <p>//读取中</p> 
 <p>} else {<!-- --></p> 
 <p>statusBean.setStatus("当前正在处理第" + pItems +"个文件:已经读取了 " + pBytesRead + " / " + pContentLength+ " bytes.");</p> 
 <p>statusBean.setReadTotalSize(pBytesRead);</p> 
 <p>statusBean.setCurrentUploadFileNum(pItems);</p> 
 <p>statusBean.setProcessRunningTime(System.currentTimeMillis());</p> 
 <p>}</p> 
 <p>BackGroundService.saveStatusBean(request,statusBean);</p> 
 <p>}</p> 
 <p>}</p> 
 <p>2.1.3. 后台服务类(BackGroundService)</p> 
 <p>BackGroundService这个Servlet类负责接收Form Post数据、回应状态轮询请求、处理取消文件上传的请求。</p> 
 <p>尽管可以把这些功能相互分离开来，但为了简单明了，还是将它们放到Servlet中，只是由不同的方法进行分割。</p> 
 <p>源代码如下：/**</p> 
 <p>* 本例程演示了通过Web上传文件过程中的进度显示。您可以对本例程进行任何修改和使用。</p> 
 <p>*</p> 
 <p>* 如需要转载，请注明作者。</p> 
 <p>*</p> 
 <p>* 作者： 刘作晨</p> 
 <p>*</p> 
 <p>*/</p> 
 <p>package liuzuochen.sample.upload;</p> 
 <p>import java.io.File;</p> 
 <p>import java.io.IOException;</p> 
 <p>import java.util.List;</p> 
 <p>import javax.servlet.ServletException;</p> 
 <p>import javax.servlet.http.HttpServletRequest;</p> 
 <p>import javax.servlet.http.HttpServletResponse;</p> 
 <p>import org.apache.commons.fileupload.FileItem;</p> 
 <p>import org.apache.commons.fileupload.FileUploadException;</p> 
 <p>import org.apache.commons.fileupload.disk.DiskFileItemFactory;</p> 
 <p>import org.apache.commons.fileupload.servlet.*;</p> 
 <p>public class BackGroundService extends javax.servlet.http.HttpServlet implements    javax.servlet.Servlet {<!-- --></p> 
 <p>public static final String UPLOAD_DIR = "/upload";</p> 
 <p>public static final String DEFAULT_UPLOAD_FAILURE_URL = "./result.jsp";</p> 
 <p>public BackGroundService() {<!-- --></p> 
 <p>super();</p> 
 <p>}</p> 
 <p>protected void doGet(HttpServletRequest request,         HttpServletResponse response) throws ServletException,     IOException {<!-- --></p> 
 <p>doPost(request, response);</p> 
 <p>}</p> 
 <p>/**</p> 
 <p>* 从文件路径中取出文件名</p> 
 <p>*/</p> 
 <p>private String takeOutFileName(String filePath) {<!-- --></p> 
 <p>int pos = filePath.lastIndexOf(File.separator);</p> 
 <p>if (pos &gt; 0) {<!-- --></p> 
 <p>return filePath.substring(pos + 1);</p> 
 <p>} else {<!-- --></p> 
 <p>return filePath;</p> 
 <p>}</p> 
 <p>}</p> 
 <p>/**</p> 
 <p>* 从request中取出FileUploadStatus Bean</p> 
 <p>*/</p> 
 <p>public static FileUploadStatus getStatusBean(</p> 
 <p>HttpServletRequest request) {<!-- --></p> 
 <p>BeanControler beanCtrl = BeanControler.getInstance();</p> 
 <p>return beanCtrl.getUploadStatus(request.getRemoteAddr());</p> 
 <p>}</p> 
 <p>/**</p> 
 <p>* 把FileUploadStatus Bean保存到类控制器BeanControler</p> 
 <p>*/</p> 
 <p>public static void saveStatusBean(     HttpServletRequest request,     FileUploadStatus statusBean) {<!-- --></p> 
 <p>statusBean.setUploadAddr(request.getRemoteAddr());</p> 
 <p>BeanControler beanCtrl = BeanControler.getInstance();</p> 
 <p>beanCtrl.setUploadStatus(statusBean);</p> 
 <p>}</p> 
 <p>/**</p> 
 <p>* 删除已经上传的文件</p> 
 <p>*/</p> 
 <p>private void deleteUploadedFile(HttpServletRequest request) {<!-- --></p> 
 <p>FileUploadStatus satusBean = getStatusBean(request);</p> 
 <p>for (int i = 0; i &lt; satusBean.getUploadFileUrlList().size(); i++) {<!-- --></p> 
 <p>File uploadedFile = new File(request.getRealPath(UPLOAD_DIR) +             File.separator +             satusBean.getUploadFileUrlList().             get(i));</p> 
 <p>uploadedFile.delete();</p> 
 <p>}</p> 
 <p>satusBean.getUploadFileUrlList().clear();</p> 
 <p>satusBean.setStatus("删除已上传的文件");</p> 
 <p>saveStatusBean(request, satusBean);</p> 
 <p>}</p> 
 <p>/**</p> 
 <p>* 上传过程中出错处理</p> 
 <p>*/</p> 
 <p>private void uploadExceptionHandle(     HttpServletRequest request,     String errMsg) throws ServletException, IOException {<!-- --></p> 
 <p>//首先删除已经上传的文件</p> 
 <p>deleteUploadedFile(request);</p> 
 <p>FileUploadStatus satusBean = getStatusBean(request);</p> 
 <p>satusBean.setStatus(errMsg);</p> 
 <p>saveStatusBean(request, satusBean);</p> 
 <p>}</p> 
 <p>/**</p> 
 <p>* 初始化文件上传状态Bean</p> 
 <p>*/</p> 
 <p>private FileUploadStatus initStatusBean(HttpServletRequest</p> 
 <p>request) {<!-- --></p> 
 <p>FileUploadStatus satusBean = new FileUploadStatus();</p> 
 <p>satusBean.setStatus("正在准备处理");</p> 
 <p>satusBean.setUploadTotalSize(request.getContentLength());</p> 
 <p>satusBean.setProcessStartTime(System.currentTimeMillis());</p> 
 <p>satusBean.setBaseDir(request.getContextPath() + UPLOAD_DIR);</p> 
 <p>return satusBean;</p> 
 <p>}</p> 
 <p>/**</p> 
 <p>* 处理文件上传</p> 
 <p>*/</p> 
 <p>private void processFileUpload(HttpServletRequest request,</p> 
 <p>HttpServletResponse response) throws     ServletException, IOException {<!-- --></p> 
 <p>DiskFileItemFactory factory = new DiskFileItemFactory();</p> 
 <p>//设置内存缓冲区，超过后写入临时文件</p> 
 <p>factory.setSizeThreshold(10240000);</p> 
 <p>//设置临时文件存储位置</p> 
 <p>factory.setRepository(new File(request.getRealPath("/upload/temp")));</p> 
 <p>ServletFileUpload upload = new ServletFileUpload(factory);</p> 
 <p>//设置单个文件的最大上传值</p> 
 <p>upload.setFileSizeMax(102400000);</p> 
 <p>//设置整个request的最大值</p> 
 <p>upload.setSizeMax(102400000);</p> 
 <p>upload.setProgressListener(new FileUploadListener(request));</p> 
 <p>//保存初始化后的FileUploadStatus Bean</p> 
 <p>saveStatusBean(request, initStatusBean(request));</p> 
 <p>String forwardURL = "";</p> 
 <p>try {<!-- --></p> 
 <p>List items = upload.parseRequest(request);</p> 
 <p>//获得返回url</p> 
 <p>for (int i = 0; i &lt; items.size(); i++) {<!-- --></p> 
 <p>FileItem item = (FileItem) items.get(i);</p> 
 <p>if (item.isFormField()) {<!-- --></p> 
 <p>forwardURL = item.getString();</p> 
 <p>break;</p> 
 <p>}</p> 
 <p>}</p> 
 <p>//处理文件上传</p> 
 <p>for (int i = 0; i &lt; items.size(); i++) {<!-- --></p> 
 <p>FileItem item = (FileItem) items.get(i);</p> 
 <p>//取消上传</p> 
 <p>if (getStatusBean(request).getCancel()) {<!-- --></p> 
 <p>deleteUploadedFile(request);</p> 
 <p>break;</p> 
 <p>}</p> 
 <p>//保存文件</p> 
 <p>else if (!item.isFormField() &amp;&amp; item.getName().length() &gt; 0) {<!-- --></p> 
 <p>String fileName = takeOutFileName(item.getName());</p> 
 <p>File uploadedFile = new File(request.getRealPath(UPLOAD_DIR) +</p> 
 <p>File.separator + fileName);       item.write(uploadedFile);       //更新上传文件列表       FileUploadStatus</p> 
 <p>satusBean =         getStatusBean(request);</p> 
 <p>satusBean.getUploadFileUrlList().add(fileName);</p> 
 <p>saveStatusBean(request, satusBean);</p> 
 <p>Thread.sleep(500);</p> 
 <p>}</p> 
 <p>}</p> 
 <p>} catch (FileUploadException e) {<!-- --></p> 
 <p>uploadExceptionHandle(request, "上传文件时发生错误:" + e.getMessage());</p> 
 <p>} catch (Exception e) {<!-- --></p> 
 <p>uploadExceptionHandle(request, "保存上传文件时发生错误:" + e.getMessage());</p> 
 <p>}</p> 
 <p>if (forwardURL.length() == 0) {<!-- --></p> 
 <p>forwardURL = DEFAULT_UPLOAD_FAILURE_URL;</p> 
 <p>}</p> 
 <p>request.getRequestDispatcher(forwardURL).forward(request, response);</p> 
 <p>}</p> 
 <p>/**</p> 
 <p>* 回应上传状态查询</p> 
 <p>*/</p> 
 <p>private void responseStatusQuery(HttpServletRequest request,</p> 
 <p>HttpServletResponse response) throws     IOException {<!-- --></p> 
 <p>response.setContentType("text/xml");</p> 
 <p>response.setCharacterEncoding("UTF-8");</p> 
 <p>response.setHeader("Cache-Control", "no-cache");</p> 
 <p>FileUploadStatus satusBean = getStatusBean(request);</p> 
 <p>response.getWriter().write(satusBean.toJSon());</p> 
 <p>}</p> 
 <p>/**</p> 
 <p>* 处理取消文件上传</p> 
 <p>*/</p> 
 <p>private void processCancelFileUpload(HttpServletRequest request,</p> 
 <p>HttpServletResponse response) throws     IOException {<!-- --></p> 
 <p>FileUploadStatus satusBean = getStatusBean(request);</p> 
 <p>satusBean.setCancel(true);</p> 
 <p>saveStatusBean(request, satusBean);</p> 
 <p>responseStatusQuery(request, response);</p> 
 <p>}</p> 
 <p>protected void doPost(HttpServletRequest request,</p> 
 <p>HttpServletResponse response) throws ServletException,     IOException {<!-- --></p> 
 <p>boolean isMultipart = ServletFileUpload.isMultipartContent(request);</p> 
 <p>if (isMultipart) {<!-- --></p> 
 <p>processFileUpload(request, response);</p> 
 <p>} else {<!-- --></p> 
 <p>request.setCharacterEncoding("UTF-8");</p> 
 <p>if (request.getParameter("uploadStatus") != null) {<!-- --></p> 
 <p>responseStatusQuery(request, response);</p> 
 <p>}</p> 
 <p>if (request.getParameter("cancelUpload") != null) {<!-- --></p> 
 <p>processCancelFileUpload(request, response);</p> 
 <p>}</p> 
 <p>}</p> 
 <p>}</p> 
 <p>}</p> 
 <p>2.1.4. 文件上传状态控制类(BeanControler)</p> 
 <p>这是一个单例类，它的功能是为客户端保存文件上传状态，这里我没有使用Session来存储 文件上传状态，</p> 
 <p>因为对于AJAX这种异步调用，服务器会开启不同的Session，所以无法通过Session保存文件上传状态。</p> 
 <p>我并不认为这种方法最好，如果有更好的方法，欢迎大家一起讨论。 源代码如下：/**</p> 
 <p>* 本例程演示了通过Web上传文件过程中的进度显示。您可以对本例程进行任何修改和使用。</p> 
 <p>*</p> 
 <p>* 如需要转载，请注明作者。</p> 
 <p>*</p> 
 <p>* 作者： 刘作晨</p> 
 <p>*</p> 
 <p>*/</p> 
 <p>package liuzuochen.sample.upload;</p> 
 <p>import java.util.Vector;</p> 
 <p>public class BeanControler {<!-- --></p> 
 <p>private static BeanControler beanControler = new BeanControler();</p> 
 <p>private Vector vector = new Vector();</p> 
 <p>private BeanControler() {<!-- --></p> 
 <p>}</p> 
 <p>public static BeanControler getInstance() {<!-- --></p> 
 <p>return beanControler;</p> 
 <p>}</p> 
 <p>/**</p> 
 <p>* 取得相应FileUploadStatus类对象的存储位置</p> 
 <p>*/</p> 
 <p>private int indexOf(String strID) {<!-- --></p> 
 <p>int nReturn = -1;</p> 
 <p>for (int i = 0; i &lt; vector.size(); i++) {<!-- --></p> 
 <p>FileUploadStatus status = (FileUploadStatus) vector.elementAt(i);</p> 
 <p>if (status.getUploadAddr().equals(strID)) {<!-- --></p> 
 <p>nReturn = i;</p> 
 <p>break;</p> 
 <p>}</p> 
 <p>}</p> 
 <p>return nReturn;</p> 
 <p>}</p> 
 <p>/**</p> 
 <p>* 取得相应FileUploadStatus类对象</p> 
 <p>*/</p> 
 <p>public FileUploadStatus getUploadStatus(String strID) {<!-- --></p> 
 <p>return (FileUploadStatus) vector.elementAt(indexOf(strID));</p> 
 <p>}</p> 
 <p>/**</p> 
 <p>* 存储FileUploadStatus类对象</p> 
 <p>*/</p> 
 <p>public void setUploadStatus(FileUploadStatus status) {<!-- --></p> 
 <p>int nIndex = indexOf(status.getUploadAddr());</p> 
 <p>if ( -1 == nIndex) {<!-- --></p> 
 <p>vector.add(status);</p> 
 <p>} else {<!-- --></p> 
 <p>vector.insertElementAt(status, nIndex);</p> 
 <p>vector.removeElementAt(nIndex + 1);</p> 
 <p>}</p> 
 <p>}</p> 
 <p>/**</p> 
 <p>* 删除FileUploadStatus类对象</p> 
 <p>*/</p> 
 <p>public void removeUploadStatus(String strID){<!-- --></p> 
 <p>int nIndex = indexOf(strID);</p> 
 <p>if(-1!=nIndex)</p> 
 <p>vector.removeElementAt(nIndex);</p> 
 <p>}</p> 
 <p>}</p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7d65dafb5b5e7f37000f79cd2834dc72/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">光遇服务器什么时候维护好2.7,光遇：开服如何坚持到现在？老玩家坦言，这四件事难以割舍...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8cab536964a533e935520cd655ccc60a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">citrix服务器虚拟化视频,部署第1台虚拟化主机XenServer 7.5</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>