<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>TWaver中的Node对象加右键菜单项 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="TWaver中的Node对象加右键菜单项" />
<meta property="og:description" content="network.sendtotoponselected =false; 上面那个机柜的图片里面的每个设备都是一个对象可以拖放，有没有办法控制这些设备对象的可拖动范围，比如只能在某一范围内上下拖动，还有就是拖动这些设备时有一个问题，点击一个对象后，它总是覆盖在其它对象的上面，这样如果两个设备比较接近时下层的设备就覆盖了上层的设备，有没有办法固定它的层次关系 这里面也是有两个小技巧 1.就是每个设备作图的时候,注意满足电话中跟你说的那个构图技巧 2.给这些设备加上个location监听,当设备拖拽的时候,不允许将设备拖动超出一个范围即可.这个范围可以由几个相关的参数来共同制定,比如某个设备位于机架的第三层(当成这个设备的一个属性), 第三层的 y 坐标根据我们的底图应该是在 levelY 处,我们定义这个范围是 levelY&#43;/- 20. ok,现在开始编码.(1)添加属性变化监听器,专门监听这种设备的location变化(2)这类设备的location发生变化后,在监听器中判断这类设备处于机架的哪一层,例如第三层,当前设备的location是否满足了Math.abs(location.y - level3)&gt;20的条件,如果一旦满足,那么就重新设置该设备location回到指定位置 element.location = new Point(location.x,level3-element.height); 基本的思路大概如此,你看看根据实际情况变通一下 Re: 请问如何给TWaver中的Node对象加右键菜单项 如果右键点击树节点时，让此节点选中最好，不过现在还没有通过ContextMenuEvent或者MouseEvent获得TreeData的方法，可以考虑先自己继承twaver.Tree，添加如下方法（TWaver Flex 1.5版本将添加）： view plaincopy to clipboardprint?
代码: public function getTreeDataByContextMenuEvent(event:ContextMenuEvent):TreeData{ var itemRenderer:IListItemRenderer; var target:DisplayObject = event.mouseTarget; while (target &amp;&amp; target != this) { if (target is IListItemRenderer &amp;&amp; target.parent == listContent) { if (target.visible) { itemRenderer = IListItemRenderer(target); } break; } if (target is IUIComponent){ target = IUIComponent(target)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/466d970e8689d69617d7257fdb2b4d76/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2011-04-23T13:03:02+08:00" />
<meta property="article:modified_time" content="2011-04-23T13:03:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">TWaver中的Node对象加右键菜单项</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    network.sendtotoponselected =false; 
<br>上面那个机柜的图片里面的每个设备都是一个对象可以拖放，有没有办法控制这些设备对象的可拖动范围，比如只能在某一范围内上下拖动，还有就是拖动这些设备时有一个问题，点击一个对象后，它总是覆盖在其它对象的上面，这样如果两个设备比较接近时下层的设备就覆盖了上层的设备，有没有办法固定它的层次关系 
<br> 
<br> 
<br>这里面也是有两个小技巧 
<br>1.就是每个设备作图的时候,注意满足电话中跟你说的那个构图技巧 
<br>2.给这些设备加上个location监听,当设备拖拽的时候,不允许将设备拖动超出一个范围即可.这个范围可以由几个相关的参数来共同制定,比如某个设备位于机架的第三层(当成这个设备的一个属性), 第三层的 y 坐标根据我们的底图应该是在 levelY 处,我们定义这个范围是 levelY+/- 20. ok,现在开始编码.(1)添加属性变化监听器,专门监听这种设备的location变化(2)这类设备的location发生变化后,在监听器中判断这类设备处于机架的哪一层,例如第三层,当前设备的location是否满足了Math.abs(location.y - level3)&gt;20的条件,如果一旦满足,那么就重新设置该设备location回到指定位置 element.location = new Point(location.x,level3-element.height); 
<br> 
<br>基本的思路大概如此,你看看根据实际情况变通一下 
<br>Re: 请问如何给TWaver中的Node对象加右键菜单项 
<br>如果右键点击树节点时，让此节点选中最好，不过现在还没有通过ContextMenuEvent或者MouseEvent获得TreeData的方法，可以考虑先自己继承twaver.Tree，添加如下方法（TWaver Flex 1.5版本将添加）： 
<br> 
<pre><code class="language-java"><br>view plaincopy to clipboardprint?<br>代码:  <br>      public function getTreeDataByContextMenuEvent(event:ContextMenuEvent):TreeData{  <br>         var itemRenderer:IListItemRenderer;  <br>         var target:DisplayObject = event.mouseTarget;  <br>         while (target &amp;&amp; target != this) {  <br>            if (target is IListItemRenderer &amp;&amp; target.parent == listContent) {  <br>               if (target.visible) {  <br>                  itemRenderer =  IListItemRenderer(target);  <br>               }  <br>               break;  <br>            }  <br><br>            if (target is IUIComponent){  <br>               target = IUIComponent(target).owner;  <br>            } else {  <br>               target = target.parent;  <br>            }  <br>         }  <br><br>         if(itemRenderer != null){  <br>            return this.getTreeDataByIndex(this.itemRendererToIndex(itemRenderer));  <br>         }  <br>         return null;  <br>      }  <br>      public function getTreeDataByMouseEvent(event:MouseEvent):TreeData{  <br>         var itemRenderer:IListItemRenderer = this.mouseEventToItemRenderer(event);  <br>         if(itemRenderer != null){  <br>            return this.getTreeDataByIndex(this.itemRendererToIndex(itemRenderer));  <br>         }  <br>         return null;  <br>      }  <br>其实不难不过需要你扩展一下UI，我在CustomGridDemo里面增加了一种ClippableCell，所有代码就是下面寥寥几行 关键之处就是这一行);<br>view plaincopy to clipboardprint?<br>代码:  <br>package demo.network.chassis.customgrid;  <br>import java.awt.Color;  <br>import java.awt.Graphics2D;  <br>import java.awt.Rectangle;  <br>import twaver.Node;  <br>import twaver.network.TNetwork;  <br>import twaver.network.ui.ResizableNodeUI;  <br>public class ClippableCellUI extends ResizableNodeUI {  <br>   public ClippableCellUI(TNetwork network, ClippableCell clippableCell) {  <br>      super(network, clippableCell);  <br>   }  <br>   public void paintBody(Graphics2D g2d) {  <br>      ClippableCell cell = (ClippableCell)this.element;  <br>      Node host = cell.getHost();  <br>      Rectangle drawBound = null;  <br>      if(host == null){  <br>         drawBound = cell.getBounds();  <br>      }else{  <br>         Rectangle hostRect;  <br>         if(host instanceof CustomGrid){  <br>            hostRect = ((CustomGrid)host).getInnerBounds();  <br>         }else{  <br>            hostRect = host.getBounds();  <br>         }  <br>         drawBound = hostRect.intersection(cell.getBounds());  <br>      }  <br>      if(drawBound != null){  <br>         g2d.setColor((Color)cell.getClientProperty("color"));  <br>         g2d.fill(drawBound);  <br>      }   <br>   }  <br>}  <br>代码:  <br>package demo.network.chassis.customgrid;  <br>import java.awt.Color;  <br>import twaver.Follower;  <br>public class ClippableCell extends Follower {  <br><br>   public ClippableCell(){  <br>      init();  <br>   }  <br><br>   public ClippableCell(Object id){  <br>      super(id);  <br>      init();  <br>   }  <br><br>   private void init(){  <br>      this.putClientProperty("color", Color.red);  <br>   }  <br><br>   public String getUIClassID() {  <br>      return ClippableCellUI.class.getName();  <br>   }     <br>}  </code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a7fa8f2571c075da3dfd3d4bd21ada80/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">iBatis大数据量分页查询的性能问题分析及改进</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d388f8b9c500b6fe6d2ed74874de95fc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">如何给TWaver中的Node对象加右键菜单项</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>