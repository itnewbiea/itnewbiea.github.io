<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>利用STM32实现按键控制LED灯 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="利用STM32实现按键控制LED灯" />
<meta property="og:description" content="利用野火开发版，一下是说明
/*********************************************************************************************/
【*】程序简介
-工程名称：GPIO输入--按键
-实验平台: 野火STM32 F429 开发板
-MDK版本：5.16
-ST固件库版本：1.5.1
【 ！】功能简介：
使用两个按键控制彩灯的红、绿灯反转，按一下KEY1 红灯反转一次，按一下KEY2,绿灯反转一次。
学习目的：学会检测GPIO引脚输入的基本方法。
【 ！！】注意事项：
跳线帽：彩灯需要用跳线帽连接J35 (出厂默认已连接，J35位置在彩灯附近)
/*********************************************************************************************/
【*】 引脚分配
KEY:
两个按键均有硬件去抖，按下的时候均为高电平，不按时为低电平。
KEY1&lt;---&gt;PA0
KEY2&lt;---&gt;PC13
LED：
RGB彩灯的三个阴极接到STM32三个引脚上，LED低电平亮。
R&lt;---&gt;PH10
G&lt;---&gt;PH11
B&lt;---&gt;PH12
LED4&lt;---&gt;PD11
/*********************************************************************************************/
【*】 时钟
A.晶振：
-外部高速晶振：25MHz
-RTC晶振：32.768KHz
B.各总线运行时钟：
-系统时钟 = SYCCLK = AHB1 = 180MHz
-APB2 = 90MHz -APB1 = 45MHz
C.浮点运算单元：
不使用
main代码 /**
******************************************************************************
* @file main.c
* @author fire
* @version V1.0
* @date 2015-xx-xx" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/766532c7f1efd9f4de520ebd901a31f4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-31T17:01:38+08:00" />
<meta property="article:modified_time" content="2023-10-31T17:01:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">利用STM32实现按键控制LED灯</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>利用野火开发版，一下是说明</p> 
<p>/*********************************************************************************************/</p> 
<p>【*】程序简介<br> -工程名称：GPIO输入--按键<br> -实验平台: 野火STM32 F429 开发板<br> -MDK版本：5.16<br> -ST固件库版本：1.5.1</p> 
<p><br> 【 ！】功能简介：<br> 使用两个按键控制彩灯的红、绿灯反转，按一下KEY1 红灯反转一次，按一下KEY2,绿灯反转一次。</p> 
<p>学习目的：学会检测GPIO引脚输入的基本方法。</p> 
<p>【 ！！】注意事项：<br>  跳线帽：彩灯需要用跳线帽连接J35 (出厂默认已连接，J35位置在彩灯附近)</p> 
<p>/*********************************************************************************************/</p> 
<p>【*】 引脚分配<br> KEY:<br> 两个按键均有硬件去抖，按下的时候均为高电平，不按时为低电平。</p> 
<p>    KEY1&lt;---&gt;PA0<br>     KEY2&lt;---&gt;PC13</p> 
<p>LED：<br> RGB彩灯的三个阴极接到STM32三个引脚上，LED低电平亮。</p> 
<p>    R&lt;---&gt;PH10<br>     G&lt;---&gt;PH11<br>     B&lt;---&gt;PH12<br>     <br>     LED4&lt;---&gt;PD11</p> 
<p><br> /*********************************************************************************************/</p> 
<p>【*】 时钟</p> 
<p>A.晶振：<br> -外部高速晶振：25MHz<br> -RTC晶振：32.768KHz</p> 
<p>B.各总线运行时钟：<br> -系统时钟 = SYCCLK = AHB1 = 180MHz<br> -APB2 = 90MHz <br> -APB1 = 45MHz</p> 
<p>C.浮点运算单元：<br>   不使用</p> 
<h2>main代码</h2> 
<p>/**<br>   ******************************************************************************<br>   * @file    main.c<br>   * @author  fire<br>   * @version V1.0<br>   * @date    2015-xx-xx<br>   * @brief   使用按键控制彩灯<br>   ******************************************************************************<br>   * @attention<br>   *<br>   * 实验平台:野火  STM32 F429 开发板<br>   * 论坛    :http://www.firebbs.cn<br>   * 淘宝    :https://fire-stm32.taobao.com<br>   *<br>   ******************************************************************************<br>   */<br>   <br> #include "stm32f4xx.h"<br> #include "./led/bsp_led.h"<br> #include "./key/bsp_key.h" </p> 
<p>/**<br>   * @brief  主函数<br>   * @param  无<br>   * @retval 无<br>   */<br> int main(void)<br> {<!-- --><br>     /* LED 端口初始化 */<br>     LED_GPIO_Config();     <br>   <br>   /*初始化按键*/<br>   Key_GPIO_Config();<br>     <br>  <br>     /* 轮询按键状态，若按键按下则反转LED */ <br>     while(1)                            <br>     {       <br>         if( Key_Scan(KEY1_GPIO_PORT,KEY1_PIN) == KEY_ON  )<br>         {<!-- --><br>             /*LED1反转*/<br>             LED1_TOGGLE;<br>         }   <br>     <br>     if( Key_Scan(KEY2_GPIO_PORT,KEY2_PIN) == KEY_ON  )<br>         {<!-- --><br>             /*LED2反转*/<br>             LED2_TOGGLE;<br>         }   <br>     }<br> }</p> 
<p>/*********************************************END OF FILE**********************/</p> 
<h2>LED文件</h2> 
<p>/**<br>   ******************************************************************************<br>   * @file    bsp_led.c<br>   * @author  fire<br>   * @version V1.0<br>   * @date    2015-xx-xx<br>   * @brief   led应用函数接口<br>   ******************************************************************************<br>   * @attention<br>   *<br>   * 实验平台:野火  STM32 F429 开发板  <br>   * 论坛    :http://www.firebbs.cn<br>   * 淘宝    :https://fire-stm32.taobao.com<br>   *<br>   ******************************************************************************<br>   */<br>   <br> #include "./led/bsp_led.h"   </p> 
<p> /**<br>   * @brief  初始化控制LED的IO<br>   * @param  无<br>   * @retval 无<br>   */<br> void LED_GPIO_Config(void)<br> {        <br>         /*定义一个GPIO_InitTypeDef类型的结构体*/<br>         GPIO_InitTypeDef GPIO_InitStructure;</p> 
<p>        /*开启LED相关的GPIO外设时钟*/<br>         RCC_AHB1PeriphClockCmd ( LED1_GPIO_CLK|<br>                                LED2_GPIO_CLK|<br>                                LED3_GPIO_CLK, ENABLE); </p> 
<p>        /*选择要控制的GPIO引脚*/                                                               <br>         GPIO_InitStructure.GPIO_Pin = LED1_PIN;    </p> 
<p>        /*设置引脚模式为输出模式*/<br>         GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;   <br>     <br>     /*设置引脚的输出类型为推挽输出*/<br>     GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;<br>     <br>     /*设置引脚为上拉模式*/<br>     GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP;</p> 
<p>        /*设置引脚速率为2MHz */   <br>         GPIO_InitStructure.GPIO_Speed = GPIO_Speed_2MHz; </p> 
<p>        /*调用库函数，使用上面配置的GPIO_InitStructure初始化GPIO*/<br>         GPIO_Init(LED1_GPIO_PORT, &amp;GPIO_InitStructure);    <br>     <br>     /*选择要控制的GPIO引脚*/                                                               <br>         GPIO_InitStructure.GPIO_Pin = LED2_PIN;    <br>     GPIO_Init(LED2_GPIO_PORT, &amp;GPIO_InitStructure);    <br>     <br>     /*选择要控制的GPIO引脚*/                                                               <br>         GPIO_InitStructure.GPIO_Pin = LED3_PIN;    <br>     GPIO_Init(LED3_GPIO_PORT, &amp;GPIO_InitStructure);    <br>         <br>         /*关闭RGB灯*/<br>         LED_RGBOFF;        <br> }<br> /*********************************************END OF FILE**********************/<br>  </p> 
<h2>按键文件</h2> 
<pre><code class="hljs">/**
  ******************************************************************************
  * @file    bsp_key.c
  * @author  fire
  * @version V1.0
  * @date    2015-xx-xx
  * @brief   按键应用bsp（扫描模式）
  ******************************************************************************
  * @attention
  *
  * 实验平台:野火  STM32 F429 开发板 
  * 论坛    :http://www.firebbs.cn
  * 淘宝    :https://fire-stm32.taobao.com
  *
  ******************************************************************************
  */ 
  
#include "./key/bsp_key.h" 

/// 不精确的延时
void Key_Delay(__IO u32 nCount)
{
	for(; nCount != 0; nCount--);
} 

/**
  * @brief  配置按键用到的I/O口
  * @param  无
  * @retval 无
  */
void Key_GPIO_Config(void)
{
	GPIO_InitTypeDef GPIO_InitStructure;
	
	/*开启按键GPIO口的时钟*/
	RCC_AHB1PeriphClockCmd(KEY1_GPIO_CLK|KEY2_GPIO_CLK,ENABLE);
	
  /*选择按键的引脚*/
	GPIO_InitStructure.GPIO_Pin = KEY1_PIN; 
  
  /*设置引脚为输入模式*/
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN; 
  
  /*设置引脚不上拉也不下拉*/
  GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL;
	
  /*使用上面的结构体初始化按键*/
	GPIO_Init(KEY1_GPIO_PORT, &amp;GPIO_InitStructure);    
  
  /*选择按键的引脚*/
	GPIO_InitStructure.GPIO_Pin = KEY2_PIN; 
  
  /*使用上面的结构体初始化按键*/
	GPIO_Init(KEY2_GPIO_PORT, &amp;GPIO_InitStructure);  
}

/**
  * @brief   检测是否有按键按下     
  *	@param 	GPIOx:具体的端口, x可以是（A...K） 
	*	@param 	GPIO_PIN:具体的端口位， 可以是GPIO_PIN_x（x可以是0...15）
  * @retval  按键的状态
  *		@arg KEY_ON:按键按下
  *		@arg KEY_OFF:按键没按下
  */
uint8_t Key_Scan(GPIO_TypeDef* GPIOx,uint16_t GPIO_Pin)
{			
	/*检测是否有按键按下 */
	if(GPIO_ReadInputDataBit(GPIOx,GPIO_Pin) == KEY_ON )  
	{	 
		/*等待按键释放 */
		while(GPIO_ReadInputDataBit(GPIOx,GPIO_Pin) == KEY_ON);   
		return 	KEY_ON;	 
	}
	else
		return KEY_OFF;
}
/*********************************************END OF FILE**********************/
/**
  ******************************************************************************
  * @file    bsp_key.c
  * @author  fire
  * @version V1.0
  * @date    2015-xx-xx
  * @brief   按键应用bsp（扫描模式）
  ******************************************************************************
  * @attention
  *
  * 实验平台:野火  STM32 F429 开发板 
  * 论坛    :http://www.firebbs.cn
  * 淘宝    :https://fire-stm32.taobao.com
  *
  ******************************************************************************
  */ 
  
#include "./key/bsp_key.h" 

/// 不精确的延时
void Key_Delay(__IO u32 nCount)
{
	for(; nCount != 0; nCount--);
} 

/**
  * @brief  配置按键用到的I/O口
  * @param  无
  * @retval 无
  */
void Key_GPIO_Config(void)
{
	GPIO_InitTypeDef GPIO_InitStructure;
	
	/*开启按键GPIO口的时钟*/
	RCC_AHB1PeriphClockCmd(KEY1_GPIO_CLK|KEY2_GPIO_CLK,ENABLE);
	
  /*选择按键的引脚*/
	GPIO_InitStructure.GPIO_Pin = KEY1_PIN; 
  
  /*设置引脚为输入模式*/
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN; 
  
  /*设置引脚不上拉也不下拉*/
  GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL;
	
  /*使用上面的结构体初始化按键*/
	GPIO_Init(KEY1_GPIO_PORT, &amp;GPIO_InitStructure);    
  
  /*选择按键的引脚*/
	GPIO_InitStructure.GPIO_Pin = KEY2_PIN; 
  
  /*使用上面的结构体初始化按键*/
	GPIO_Init(KEY2_GPIO_PORT, &amp;GPIO_InitStructure);  
}

/**
  * @brief   检测是否有按键按下     
  *	@param 	GPIOx:具体的端口, x可以是（A...K） 
	*	@param 	GPIO_PIN:具体的端口位， 可以是GPIO_PIN_x（x可以是0...15）
  * @retval  按键的状态
  *		@arg KEY_ON:按键按下
  *		@arg KEY_OFF:按键没按下
  */
uint8_t Key_Scan(GPIO_TypeDef* GPIOx,uint16_t GPIO_Pin)
{			
	/*检测是否有按键按下 */
	if(GPIO_ReadInputDataBit(GPIOx,GPIO_Pin) == KEY_ON )  
	{	 
		/*等待按键释放 */
		while(GPIO_ReadInputDataBit(GPIOx,GPIO_Pin) == KEY_ON);   
		return 	KEY_ON;	 
	}
	else
		return KEY_OFF;
}
/*********************************************END OF FILE**********************/
</code></pre> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/56c1d96bc890d94411302486bc380e07/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">激光雷达点云基础-点云滤波算法与点云配准算法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/313d17a20722f38fcb86e6e88a8d5ec1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">微信小程序获取最新隐私协议授权 以及涉及隐私API权限申请</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>