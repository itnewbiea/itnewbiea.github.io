<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue实现多栏布局拖拽（drag-box） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue实现多栏布局拖拽（drag-box）" />
<meta property="og:description" content="定义dragLayouter文件下---组件DragBox 和DragItem
DragBox：
&lt;template&gt; &lt;div ref=&#39;dragBox&#39; style=&#39;display: flex; width: 100%; height: 100%;&#39;&gt; &lt;slot&gt;&lt;/slot&gt; &lt;/div&gt; &lt;/template&gt; mounted () { this.setDragItemFlex() this.dragControllerDiv() }, // 如果dragItem 没有定义宽度，则flex=1 setDragItemFlex () { const dragBox = this.$refs.dragBox const childsLen = dragBox.children.length for (let i = 0; i &lt; childsLen; i&#43;&#43;) { const node = dragBox.children[i] if (!node.style.width) { // 如果没有定义宽度，则flex=1 node.style.flex = 1 } } }, dragControllerDiv () { const resize = document.getElementsByClassName(&#39;resize&#39;) // 拖拽条 // 循环为每个拖拽条添加事件 for (let i = 0; i &lt; resize." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/a211bd94482edc11e904254481aa41cf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-13T13:49:06+08:00" />
<meta property="article:modified_time" content="2023-02-13T13:49:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue实现多栏布局拖拽（drag-box）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>定义dragLayouter文件下---组件DragBox 和DragItem</p> 
<p>DragBox：</p> 
<pre><code class="hljs">&lt;template&gt;
    &lt;div ref='dragBox' style='display: flex; width: 100%; height: 100%;'&gt;
        &lt;slot&gt;&lt;/slot&gt;
    &lt;/div&gt;
&lt;/template&gt;



mounted () {
  this.setDragItemFlex()
  this.dragControllerDiv()
},

// 如果dragItem 没有定义宽度，则flex=1
    setDragItemFlex () {
      const dragBox = this.$refs.dragBox
      const childsLen = dragBox.children.length

      for (let i = 0; i &lt; childsLen; i++) {
        const node = dragBox.children[i]
        if (!node.style.width) {
          // 如果没有定义宽度，则flex=1
          node.style.flex = 1
        }
      }
    },

dragControllerDiv () {
  const resize = document.getElementsByClassName('resize') // 拖拽条
  // 循环为每个拖拽条添加事件
  for (let i = 0; i &lt; resize.length; i++) {
    // 鼠标按下事件
    resize[i].addEventListener('mousedown', this.onMouseDown)
  }
},


onMouseDown (e) {
  this.resizeBox = e.target
  this.currentBox = this.resizeBox.parentNode// 当前盒子
  this.rightBox = this.getNextElement(this.currentBox)// 当前盒子的下个兄弟节点
  if (!this.rightBox) return
  this.curLen = this.currentBox.clientWidth
  this.otherBoxWidth = this.$refs.dragBox.clientWidth - this.currentBox.clientWidth - this.rightBox.clientWidth // 其他盒子的宽度
  // 颜色改变提醒
  this.resizeBox.style.background = '#818181'
  this.startX = e.clientX
  document.addEventListener('mousemove', this.onMousemove)
  document.addEventListener('mouseup', this.onMouseup)
},

// 获取下一个兄弟元素的兼容函数
getNextElement (element) {
  if (element.nextElementSibling) {
    return element.nextElementSibling
  } else {
    var next = element.nextSibling// 下一个兄弟节点
    while (next &amp;&amp; next.nodeType !== 1) { // 有 并且 不是我想要的
      next = next.nextSibling
    }
    return next
  }
}


onMousemove (e) {
  const endX = e.clientX
  const moveLen = endX - this.startX // （endx-startx）= 移动的距离
  const CurBoxLen = this.curLen + moveLen // resize[i].left+移动的距离=左边区域最后的宽度
  const rightBoxLen = this.$refs.dragBox.clientWidth - CurBoxLen - this.otherBoxWidth // 右侧宽度=总宽度-左侧宽度-其它盒子宽度
  // 当最小宽度时，无法继续拖动
  if (CurBoxLen &lt;= 200 || rightBoxLen &lt;= 200) return
  this.currentBox.style.width = CurBoxLen + 'px'// 当前盒子的宽度
  this.resizeBox.style.left = CurBoxLen // 设置左侧区域的宽度
  this.rightBox.style.width = rightBoxLen + 'px'
},


onMouseup () {
 // 颜色恢复
 this.resizeBox.style.background = '#d6d6d6'
 document.removeEventListener('mousedown', this.onMouseDown)
 document.removeEventListener('mousemove', this.onMousemove)
},


</code></pre> 
<p>DragItem：</p> 
<pre><code class="hljs">&lt;template&gt;
    &lt;div ref="container" class="d-flex" style="min-width: 200px; position: relative;"&gt;
        &lt;div style="width: 100%; height: 100%;"&gt;
            &lt;slot&gt;默认信息&lt;/slot&gt;
        &lt;/div&gt;
		&lt;!-- 拖拽条 --&gt;
        &lt;div v-if="resizeShow" class="resize" /&gt;
    &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
export default {
  props: {
  // 控制拖拽条的是否显示，默认显示
    resizeShow: {
      type: Boolean,
      default: true
    }
  }
}
&lt;/script&gt;
&lt;style&gt;
.resize {
    position: absolute;
    top: 0;
    right: 0;
    width: 4px;
    height: 100%;
    cursor: col-resize;
    background-color: #d6d6d6;
}
&lt;/style&gt;
</code></pre> 
<p>最后要引用并注册该组件</p> 
<pre><code class="hljs">&lt;template&gt;
  &lt;div id="app" style="width: 100%; height: 100vh; border:1px solid #ccc;"&gt;
    &lt;drag-box style="width: 100%; height: 100%;"&gt;
      &lt;drag-item style="width: 20%;"&gt;item1&lt;/drag-item&gt;
      &lt;drag-item&gt;item2&lt;/drag-item&gt;
      &lt;drag-item style="width: 20%;" :resizeShow='false'&gt;item3&lt;/drag-item&gt;
    &lt;/drag-box&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import {DragBox, DragItem} from './components/dragLayouter'

export default {
  name: 'App',
  components: {
    DragBox,
    DragItem
  }
}
&lt;/script&gt;
</code></pre> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3d9a22b4a4232cc771bdd58b78a46ca5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">js 中filter 什么时候加return</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/224fa8beeae112e086422488909b5d5a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">go mod导入本地自定义包问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>