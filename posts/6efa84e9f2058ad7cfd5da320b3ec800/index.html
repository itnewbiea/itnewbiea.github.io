<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用JDK发布和调用webservice服务 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用JDK发布和调用webservice服务" />
<meta property="og:description" content="1、使用JDK发布webservice服务 创建接口 package com.test.service; public interface WeatherService { /** * 查询指定城市的天气 * @param cityName 城市名称 * @return */ String queryWeather(String cityName); } 创建接口实现类，添加webservice服务端注解 package com.test.service.impl; import com.test.service.WeatherService; import javax.jws.WebService; @WebService public class WeatherServiceImpl implements WeatherService { @Override public String queryWeather(String cityName) { System.out.println(&#34;查询天气的城市为：&#34; &#43; cityName); String result = &#34;该城市的天气为：晴天&#34;; System.out.println(result); return result; } } 发布webservice服务 package com.test.service; import com.test.service.impl.WeatherServiceImpl; import javax.xml.ws.Endpoint; /** * 使用JDK的方式发布服务 */ public class PushWebService { public static void main(String[] args) { //使用jdk提供的Endpoint类可以将webservice服务发布出去 /** * Endpoint." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/6efa84e9f2058ad7cfd5da320b3ec800/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-05T15:11:43+08:00" />
<meta property="article:modified_time" content="2020-05-05T15:11:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用JDK发布和调用webservice服务</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>1、使用JDK发布webservice服务</h3> 
<ul><li>创建接口</li></ul> 
<pre><code class="language-java">package com.test.service;

public interface WeatherService {

    /**
     * 查询指定城市的天气
     * @param cityName 城市名称
     * @return
     */
    String queryWeather(String cityName);
}</code></pre> 
<ul><li>创建接口实现类，添加webservice服务端注解</li></ul> 
<pre><code class="language-java">package com.test.service.impl;

import com.test.service.WeatherService;
import javax.jws.WebService;

@WebService
public class WeatherServiceImpl implements WeatherService {

    @Override
    public String queryWeather(String cityName) {
        System.out.println("查询天气的城市为：" + cityName);
        String result = "该城市的天气为：晴天";
        System.out.println(result);
        return result;
    }

}</code></pre> 
<ul><li>发布webservice服务</li></ul> 
<pre><code class="language-java">package com.test.service;


import com.test.service.impl.WeatherServiceImpl;
import javax.xml.ws.Endpoint;

/**
 * 使用JDK的方式发布服务
 */
public class PushWebService {

    public static void main(String[] args) {
        //使用jdk提供的Endpoint类可以将webservice服务发布出去
        /**
         * Endpoint.publish(String address, Object implementor):
         * 参数1：提供服务对外的访问地址
         * 参数2：提供服务的类的对象
         */
        //发布查询天气的接口
        Endpoint.publish("http://localhost:8080/WeatherService",new WeatherServiceImpl());
        System.out.println("webservice接口发布成功");
    }

}
</code></pre> 
<ul><li>打开浏览器，输入“<a href="http://localhost:8080/WeatherService?wsdl" rel="nofollow">http://localhost:8080/WeatherService?wsdl</a>”按回车即可查看我们发布好的webservice服务的wsdl，如下图所示：</li></ul> 
<p style="text-align:center;"><img alt="" height="630" src="https://images2.imgbox.com/bf/8b/UL18gp6G_o.png" width="1200"></p> 
<ul><li>wsdl阅读的顺序是从下往上去阅读的。wsdl标签解释如下：</li></ul> 
<table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><td>&lt;service&gt;</td><td>服务视图，WebService的服务端点</td></tr><tr><td>&lt;binding&gt;</td><td>Web Service的通信协议，其中描述额Web Service的方法、输入和输出</td></tr><tr><td>&lt;protType&gt;</td><td>描述了Web Service可执行的操作，通过binding指向portType</td></tr><tr><td>&lt;message&gt;</td><td>描述了服务中发布的方法，包括参数，返回值等</td></tr><tr><td>&lt;types&gt;</td><td>定义了WebService总使用的数据类型</td></tr></tbody></table> 
<ul><li>JDK中webservice相关注解部分属性值介绍</li></ul> 
<table border="1" cellpadding="1" cellspacing="1" style="width:685px;"><tbody><tr><td>注解名</td><td style="width:118px;">作用范围</td><td style="width:131px;">属性</td><td style="width:342px;">作用</td></tr><tr><td>WebService</td><td style="width:118px;">作用在实现类上</td><td style="width:131px;">endpointInterfase</td><td style="width:342px;">当实现类实现了多个接口，但是我们又不想将一些接口中的方法发布出去时，就可以用该属性去选择需要发布出去的接口，属性值为接口的全路径</td></tr><tr><td>WebMethod</td><td style="width:118px;">作用在方法上</td><td style="width:131px;">exclud</td><td style="width:342px;">是否发布该方法，false表示不发布，默认为true</td></tr><tr><td>WebParam</td><td style="width:118px;">作用在方法的请求参数上</td><td style="width:131px;">name</td><td style="width:342px;">请求参数的名称，为了方便别人查看wsdl时能明白这个参数表明的意思</td></tr><tr><td>WebResult</td><td style="width:118px;">作用在方法的返回值上</td><td style="width:131px;">name</td><td style="width:342px;">返回参数的名称，为了方便别人查看wsdl时能明白这个参数表明的意思</td></tr></tbody></table> 
<ul><li>注意事项</li></ul> 
<pre><code>1、Endpoint是java jdk提供的类，用来发布webservice，所以你的jdk版本必须在1.6.0_21之上....

2、被发布的类当中必须包含一个有效(方法必须为public的非静态，非final的方法)的方法

3、被发布的类上面必须有"@WebService"注解，否则会抛出"Exception in thread "main" java.lang.IllegalArgumentException: class com.test.service.impl.WeatherServiceImpl has neither @WebService nor @WebServiceProvider annotation"错误</code></pre> 
<h3>2、使用JDK调用webservice服务</h3> 
<ul><li>使用jdk自带的wsimport命令根据服务端说明文档（wsdl）生成本地的java代码。<a href="https://blog.csdn.net/Yinyaowei/article/details/105932185">wsimport命令介绍</a></li></ul> 
<ul><li>打开CMD窗口，输入“wsimport -encoding utf-8 -s D:\IdeaProjects\WebService\FirstWebService_Client\src -p com.test.service.impl http://localhost:8080/WeatherService?wsdl”命令生成服务端接口的java代码，结果如下所示：</li></ul> 
<p style="text-align:center;"><img alt="" height="210" src="https://images2.imgbox.com/ec/94/YJ6CH6pa_o.png" width="961"></p> 
<p style="text-align:center;"><img alt="" height="194" src="https://images2.imgbox.com/e7/22/siA423RB_o.png" width="331"></p> 
<ul><li>使用JDK的两种方式调用webservice接口</li></ul> 
<pre><code class="language-java">import com.test.service.impl.WeatherServiceImpl;
import com.test.service.impl.WeatherServiceImplService;
import org.junit.Test;
import javax.xml.namespace.QName;
import javax.xml.ws.Service;
import java.net.MalformedURLException;
import java.net.URL;

/**
 * 使用JDK的方式调用WebService服务
 */
public class UseWebService {

    @Test
    public void test1() {
        //该类名对应wsdl说明文档中的service标签中的name属性值
        WeatherServiceImplService service = new WeatherServiceImplService();
        //该类名对应wsdl说明文档中的portType标签中的name属性值。找到需要调用方法所在哪个portType标签中，然后去对应的name属性值即可
        WeatherServiceImpl weatherService = service.getPort(WeatherServiceImpl.class);
        String result = weatherService.queryWeather("郑州");
        System.out.println(result);
    }

    @Test
    public void test2() throws MalformedURLException {
        //wsdl文档地址
        URL url = new URL("http://localhost:8080/WeatherService?wsdl");
        /**
         * QName(String namespaceURI, String localPart)
         * 参数1：命名空间。对应wsdl说明文档中的definitions标签中的targetNamespace属性值
         * 参数2：服务名称。对应wsdl说明文档中的service标签中的name属性值
         */
        QName qName = new QName("http://impl.service.test.com/","WeatherServiceImplService");
        Service service = Service.create(url,qName);
        //获取接口类型
        WeatherServiceImpl weatherService = service.getPort(WeatherServiceImpl.class);
        //调用方法
        String result = weatherService.queryWeather("郑州");
        System.out.println(result);
    }

}
</code></pre> 
<p> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bcfba83bd805964ffe9e1f2a9dfddd35/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">halcon培训-快速傅里叶变换（FFT）对塑料制品-@龙熙视觉</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/67dd1cc0fd94ad4b18ee11138b7cfafb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Sift特征匹配以及ransac消除误差解析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>