<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Ubuntu部署crontab开机自启动 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Ubuntu部署crontab开机自启动" />
<meta property="og:description" content="1.安装cron组件 1.1更新软件列表 apt-get update
1.2 安装 apt-get install cron
1.3 开启日志功能
1.3.1 安装rsylog组件 apt-get install rsyslog
1.3.2 配置日志记录 vim /etc/rsyslog.d/50-default.conf 配置文件的cron.* /var/log/cron.log前面的注释#去掉。
重启rsyslog服务
service rsyslog restart
待后续配置好cron启动程序后，会有日志输出到这个文件中 2.设定定时任务 定时任务有用户级别和系统级别两种方式的任务文件。
2.1用户级别crontab -e crontab -e是用户级别的计划任务文件。
2.1.1 crontab -e crontab -e
在末尾添加 * * * * * echo &#34;Hello,world from crontab -e&#34; &gt;&gt; /tmp/Helloworld.txt
每分钟输出Hello,world from crontab -e到/tmp/Helloworld.txt文件下。
2.1.2 service cron restart service cron restart重启cron服务。 2.1.2 文本编辑问题 如果出现下面的情况，则需要修改默认文本编辑器。
先关掉ssh连接，重连接ssh
sudo select-editor选择3，vim编辑器即可。
2.2 系统级别/etc/crontab /etc/crontab是系统级别的计划任务文件。在/etc/crontab文件中，需要指定任务的运行用户，/etc/crontab文件需要使用root用户来编辑。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/5627bb0c6a1bd0cc29238c2bdcf2848f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-05T17:32:00+08:00" />
<meta property="article:modified_time" content="2023-05-05T17:32:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Ubuntu部署crontab开机自启动</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>1.安装cron组件</h2> 
<h3>1.1更新软件列表</h3> 
<p>apt-get update</p> 
<p><img alt="" height="543" src="https://images2.imgbox.com/81/ea/OWAF407s_o.png" width="683"></p> 
<h3>1.2 安装</h3> 
<p>apt-get install cron</p> 
<p>1.3 开启日志功能</p> 
<h4>1.3.1 安装rsylog组件</h4> 
<p> apt-get install rsyslog</p> 
<p><img alt="" height="918" src="https://images2.imgbox.com/01/59/H59OZEjG_o.png" width="1122"></p> 
<h4> 1.3.2 配置日志记录</h4> 
<p>vim /etc/rsyslog.d/50-default.conf 配置文件的cron.* /var/log/cron.log前面的注释#去掉。</p> 
<p><img alt="" height="894" src="https://images2.imgbox.com/da/64/iWEBZLND_o.png" width="831"></p> 
<p>重启rsyslog服务</p> 
<p>service rsyslog restart</p> 
<p>待后续配置好cron启动程序后，会有日志输出到这个文件中 </p> 
<p><img alt="" height="561" src="https://images2.imgbox.com/77/71/IjMdOuvM_o.png" width="1093"></p> 
<p></p> 
<h2>2.设定定时任务</h2> 
<p>定时任务有用户级别和系统级别两种方式的任务文件。</p> 
<h3>2.1用户级别crontab -e</h3> 
<p>crontab -e是用户级别的计划任务文件。</p> 
<h4>2.1.1 crontab -e</h4> 
<p>crontab -e</p> 
<p><img alt="" height="24" src="https://images2.imgbox.com/59/a2/TaorxUsP_o.png" width="186"></p> 
<p> 在末尾添加 </p> 
<p>* * * * * echo "Hello,world from crontab -e" &gt;&gt; /tmp/Helloworld.txt</p> 
<p> 每分钟输出Hello,world from crontab -e到/tmp/Helloworld.txt文件下。</p> 
<p><img alt="" height="373" src="https://images2.imgbox.com/b4/f2/OUn0EI4B_o.png" width="536"></p> 
<h4>2.1.2 service cron restart</h4> 
<p>service cron restart重启cron服务。 </p> 
<p><img alt="" height="28" src="https://images2.imgbox.com/44/f0/Ooc3jMer_o.png" width="272"></p> 
<p><img alt="" height="298" src="https://images2.imgbox.com/d3/bf/vpolKLgy_o.png" width="1061"></p> 
<p></p> 
<h4>2.1.2 文本编辑问题</h4> 
<p>如果出现下面的情况，则需要修改默认文本编辑器。</p> 
<p>先关掉ssh连接，重连接ssh</p> 
<p><img alt="" height="389" src="https://images2.imgbox.com/a8/34/U16FIXdM_o.png" width="1200"></p> 
<p>sudo select-editor选择3，vim编辑器即可。</p> 
<p> <img alt="" height="176" src="https://images2.imgbox.com/0e/21/HvtgJCC9_o.png" width="452"></p> 
<h3>2.2 系统级别/etc/crontab</h3> 
<p>/etc/crontab是系统级别的计划任务文件。在/etc/crontab文件中，需要指定任务的运行用户，<strong>/etc/crontab文件需要使用root用户来编辑</strong>。</p> 
<p>例如：</p> 
<p>* * * * * root echo "Hello,world from /etc/crontab" &gt;&gt; /tmp/Helloworld.txt</p> 
<p>操作流程如下：</p> 
<p>a、vim /etc/crontab</p> 
<p><img alt="" height="25" src="https://images2.imgbox.com/92/b9/J2CWsgDU_o.png" width="231"></p> 
<p>b、 在末尾添加 </p> 
<p>* * * * * root echo "Hello,world from /etc/crontab" &gt;&gt; /tmp/Helloworld.txt</p> 
<p>每分钟输出Hello,world到/tmp/Helloworld.txt文件下。</p> 
<p><img alt="" height="298" src="https://images2.imgbox.com/36/43/FKSismuz_o.png" width="1061"></p> 
<h2> 3 cron组件常用命令</h2> 
<h3>3.1启停服务</h3> 
<p>用以下的方法启动、关闭这个cron服务：</p> 
<p>service cron status //查看crontab服务状态 <br> service cron start //启动服务 <br> service cron stop //关闭服务 <br> service cron restart //重启服务 <br> service cron reload //重新载入配置</p> 
<p>crontab -e配置是针对某个用户的，而编辑/etc/crontab是针对系统的任务</p> 
<p>查看调度任务 <br> crontab -l //列出当前的所有调度任务 <br> crontab -l -u jp //列出用户jp的所有调度任务 <br> 删除任务调度工作 <br> crontab -r //删除所有任务调度工作</p> 
<h3>3.2 定时任务</h3> 
<p>* * * * * echo "Hello world!" 中“*”的解释：</p> 
<p>minute - 从0到59的整数 </p> 
<p>hour - 从0到23的整数 <br> day - 从1到31的整数 (必须是指定月份的有效日期)<br> month - 从1到12的整数 (或如Jan或Feb简写的月份)<br> dayofweek - 从0到7的整数，0或7用来描述周日 (或用Sun或Mon简写来表示)<br> command - 需要执行的命令(可用as ls /proc &gt;&gt; /tmp/proc或 执行自定义脚本的命令) <br> 除了数字还有几个特殊的符号："*"、"/"和"-"、","</p> 
<p>*代表所有的取值范围内的数字<br> "/"代表每的意思,"/5"表示每5个单位<br> "-"代表从某个数字到某个数字<br> ","分开几个离散的数字</p> 
<p>例子：<br> 15,30,45,59 * * * * echo "xgmtest....."     表示，每隔15分钟，执行一次打印命令 </p> 
<p><br> 每天早上 6 点<br> 0  6  * * * echo  "Good morning."  &gt;&gt; /tmp/test.txt //注意单纯echo，从屏幕上看不到任何输出，因为cron把任何输出都email到root的信箱了。<br>  <br> 每两个小时(第一个为 15 ，指明没两个小时的第 15 min中执行一次)<br> 15  */ 2  * * * echo  "Have a break now."  &gt;&gt; /tmp/test.txt <br>  <br> 晚上 11 点到早上 8 点之间每两个小时和早上八点<br> 0  23 -7 / 2 ， 8  * * * echo  "Have a good dream"  &gt;&gt; /tmp/test.txt<br>  <br> 每个月的 4 号和每个礼拜的礼拜一到礼拜三的早上 11 点<br> 0  11  4  *  1 -3  command line<br>  <br> 1 月 1 日早上 4 点<br> 0  4  1  1  * command line<br>  <br> 每小时（第一分钟）执行/etc/cron.hourly内的脚本<br> 01  * * * * root run-parts /etc/cron.hourly<br>  <br> 每天（凌晨 4 ： 02 ）执行/etc/cron.daily内的脚本<br> 02  4  * * * root run-parts /etc/cron.daily<br>  <br> 每星期（周日凌晨 4 ： 22 ）执行/etc/cron.weekly内的脚本<br> 22  4  * *  0  root run-parts /etc/cron.weekly<br>  <br> 每月（ 1 号凌晨 4 ： 42 ）去执行/etc/cron.monthly内的脚本<br> 42  4  1  * * root run-parts /etc/cron.monthly<br>  <br> 注意:   "run-parts" 这个参数了，如果去掉这个参数的话，后面就可以写要运行的某个脚本名，而不是文件夹名。 　<br>  <br> 每天的下午 4 点、 5 点、 6 点的 5  min、 15  min、 25  min、 35  min、 45  min、 55  min时执行命令。<br> 5 ， 15 ， 25 ， 35 ， 45 ， 55  16 ， 17 ， 18  * * * command<br>  <br> 每周一，三，五的下午 3 ： 00 系统进入维护状态，重新启动系统。<br> 00  15  * * 1 ， 3 ， 5  shutdown -r + 5<br>  <br> 每小时的 10 分， 40 分执行用户目录下的innd/bbslin这个指令：<br> 10 ， 40  * * * * innd/bbslink<br>  <br> 每小时的 1 分执行用户目录下的bin/account这个指令：<br> 1  * * * * bin/account<br>  <br> 每天早晨三点二十分执行用户目录下如下所示的两个指令（每个指令以;分隔）：<br> 203  * * * （/bin/rm -f expire.ls logins.bad;bin/expire$#@ 62 ;expire. 1 st）　　<br>  <br> 每年的一月和四月， 4 号到 9 号的 3 点 12 分和 3 点 55 分执行/bin/rm -f expire. 1 st这个指令，并把结果添加在mm.txt这个文件之后（mm.txt文件位于用户自己的目录位置）。<br> 12 , 553  4 -91 , 4  * /bin/rm -f expire. 1 st$#@ 62 ;$#@ 62 ;mm.txt<br><br> 本节引用文章来源：https://blog.csdn.net/qq_30270931/article/details/79137486</p> 
<h3>3.3 开机任务</h3> 
<p>可以在用户级别或者系统级别中添加该任务</p> 
<h4>3.3.1 用户级别</h4> 
<p>@reboot echo "Hello,world!reboot from crontab -e" &gt;&gt; /tmp/Helloworld.txt</p> 
<p><img alt="" height="372" src="https://images2.imgbox.com/2b/43/6KeIlM0T_o.png" width="585"></p> 
<p> </p> 
<h4>3.3.2 系统级别</h4> 
<p>@reboot root echo "Hello,world!reboot from /etc/crontab" &gt;&gt; /tmp/Helloworld.txt </p> 
<p><img alt="" height="377" src="https://images2.imgbox.com/4c/6e/jAjorQKP_o.png" width="818"></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2369dd6d6ec6c519c388a41c1b3844b7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">连接VPN后无法上网 Windows Route 轻松解决</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8505a86871592c2bfdab75dab0e5a568/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue首屏白屏原因及解决办法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>