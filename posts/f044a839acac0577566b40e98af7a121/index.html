<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>网工配置命令基础总结（2）----VRRP配置 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="网工配置命令基础总结（2）----VRRP配置" />
<meta property="og:description" content="目录
1.配置VRRP主备备份
2.配置VRRP负载分担
3.配置VRRP域BFD联动实现快速切换
VRRP
虚拟路由冗余协议 VRRP（Virtual Router Redundancy Protocol）通过把几台路由设备联合组成一台虚拟的路由设备，将虚拟网关设备的 IP 地址作为用户的默认网关实现与外部网络通信。当网关 设备发生故障时，VRRP 机制能够选举新的网关设备承担数据流量，从而保障网络的可靠通信。
常用配置命令
1.执行命令 vrrp vrid virtual-router-id virtual-ip virtual-address，接口视图创建 VRRP 备份组并给备份组配置虚拟 IP 地址。
2.执行命令 vrrp vrid virtual-router-id priority priority-value，配置交换机在备
份组中的优先级。 缺省情况下，优先级的取值是100。数值越大，优先级越高，优先级越高，越可能成为master 设备。
3.执行命令 vrrp vrid virtual-router-id preempt-mode timer delay delay-value，
配置备份组中交换机的抢占延迟时间。
4.执行命令 vrrp vrid virtual-router-id track bfd-session { bfd-session-id | session-name bfd-configure-name } [ increased value-increased | reduced value-reduced ]，备设备 Backup 接口视图下，配置 VRRP 与 BFD 联动。
5. 执 行 命 令 vrrp vrid virtual-router-id track interface interface-type interface-number [ increased value-increased | reduced value-reduced ]，配置 VRRP" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/f044a839acac0577566b40e98af7a121/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-14T09:23:29+08:00" />
<meta property="article:modified_time" content="2023-10-14T09:23:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">网工配置命令基础总结（2）----VRRP配置</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%C2%A01.%E9%85%8D%E7%BD%AEVRRP%E4%B8%BB%E5%A4%87%E5%A4%87%E4%BB%BD-toc" style="margin-left:80px;"><a href="#%C2%A01.%E9%85%8D%E7%BD%AEVRRP%E4%B8%BB%E5%A4%87%E5%A4%87%E4%BB%BD" rel="nofollow">1.配置VRRP主备备份</a></p> 
<p id="2.%E9%85%8D%E7%BD%AEVRRP%E8%B4%9F%E8%BD%BD%E5%88%86%E6%8B%85-toc" style="margin-left:80px;"><a href="#2.%E9%85%8D%E7%BD%AEVRRP%E8%B4%9F%E8%BD%BD%E5%88%86%E6%8B%85" rel="nofollow">2.配置VRRP负载分担</a></p> 
<p id="3.%E9%85%8D%E7%BD%AEVRRP%E5%9F%9FBFD%E8%81%94%E5%8A%A8%E5%AE%9E%E7%8E%B0%E5%BF%AB%E9%80%9F%E5%88%87%E6%8D%A2-toc" style="margin-left:80px;"><a href="#3.%E9%85%8D%E7%BD%AEVRRP%E5%9F%9FBFD%E8%81%94%E5%8A%A8%E5%AE%9E%E7%8E%B0%E5%BF%AB%E9%80%9F%E5%88%87%E6%8D%A2" rel="nofollow">3.配置VRRP域BFD联动实现快速切换</a></p> 
<hr id="hr-toc"> 
<p><strong>VRRP</strong></p> 
<p>虚拟路由冗余协议 VRRP（Virtual Router Redundancy Protocol）通过把几台路由设备联合组成一台虚拟的路由设备，将虚拟网关设备的 IP 地址作为用户的默认网关实现与外部网络通信。当网关 设备发生故障时，VRRP 机制能够选举新的网关设备承担数据流量，从而保障网络的可靠通信。</p> 
<p><strong>常用配置命令</strong></p> 
<blockquote> 
 <p>1.执行命令<strong> vrrp vrid</strong> virtual-router-id <strong>virtual-ip</strong> virtual-address，接口视图创建 VRRP 备份组并给备份组配置虚拟 IP 地址。<br> 2.执行命令 <strong>vrrp vrid </strong>virtual-router-id<strong> priority</strong> priority-value，配置交换机在备<br> 份组中的优先级。 缺省情况下，优先级的取值是100。数值越大，优先级越高，优先级越高，越可能成为master 设备。<br> 3.执行命令<strong> vrrp vrid </strong>virtual-router-id<strong> preempt-mode timer delay </strong>delay-value，<br> 配置备份组中交换机的抢占延迟时间。<br> 4.执行命令 vrrp vrid virtual-router-id track bfd-session { bfd-session-id | <br> session-name bfd-configure-name } [ increased value-increased | reduced <br> value-reduced ]，备设备 Backup 接口视图下，配置 VRRP 与 BFD 联动。<br> 5. 执 行 命 令 vrrp vrid virtual-router-id track interface interface-type <br> interface-number [ increased value-increased | reduced value-reduced ]，配置 VRRP<br> 与接口状态联动监视上行接口。</p> 
</blockquote> 
<h4 id="%C2%A01.%E9%85%8D%E7%BD%AEVRRP%E4%B8%BB%E5%A4%87%E5%A4%87%E4%BB%BD">1.配置VRRP主备备份</h4> 
<p><img alt="" height="470" src="https://images2.imgbox.com/a9/49/NZ7MsSMH_o.png" width="1168"></p> 
<p>用户希望实现：</p> 
<p>•正常情况下，主机以 SwitchA 为默认网关接入 Internet，当 SwitchA 故障时，SwitchB 接 替作为网关继续进行工作，实现网关的冗余备份。</p> 
<p>•SwitchA 故障恢复后，可以在20秒内重新成为网关。</p> 
<p><img alt="" height="775" src="https://images2.imgbox.com/45/da/3pVFqpbc_o.png" width="927"></p> 
<p>思路: </p> 
<p>•配置各设备接口 IP 地址及路由协议，使各设备间网络层连通。</p> 
<p>•在 SwitchA 和 SwitchB 上配置 VRRP 备份组。其中，SwitchA 上配置较高优先级和20秒抢占 延时，作为 Master 设备承担流量转发；SwitchB 上配置较低优先级，作为备用交换机，实现网关冗余备 份。</p> 
<p>•在 SwitchA、SwitchB 和 Switch上配置破环协议，防止环路的产生（此处以配置 STP 为例)</p> 
<p><strong>SwitchA的配置</strong></p> 
<pre><code>1、配置设备间的网络互连
# 配置 SwitchA 设备各接口的 IP 地址。
&lt;Quidway&gt; system-view
[Quidway] sysname SwitchA
[SwitchA] vlan batch 100 300
[SwitchA] interface ethernet 0/0/1
[SwitchA-Ethernet0/0/1] port link-type access
[SwitchA-Ethernet0/0/1] port default vlan 300
[SwitchA-Ethernet0/0/1] quit
[SwitchA] interface ethernet 0/0/2
[SwitchA-Ethernet0/0/2] port link-type access
[SwitchA-Ethernet0/0/2] port default vlan 100
[SwitchA-Ethernet0/0/2] quit
[SwitchA] interface ethernet 0/0/5
[SwitchA-Ethernet0/0/5] port link-type access
[SwitchA-Ethernet0/0/5] port hybrid untagged vlan 100
[SwitchA-Ethernet0/0/5] quit
[SwitchA] interface vlanif 100
[SwitchA-Vlanif100] ip address 10.1.1.1 24
[SwitchA-Vlanif100] quit
[SwitchA] interface vlanif 300
[SwitchA-Vlanif300] ip address 192.168.1.1 24
[SwitchA-Vlanif300] quit
2、配置 VRRP 备份组
# 在 SwitchA 上创建 VRRP 备份组1，配置 SwitchA 在该备份组中的优先级为120，并配置抢占时
间为20秒。
[SwitchA] interface vlanif 100
[SwitchA-Vlanif100] vrrp vrid 1 virtual-ip 10.1.1.111
[SwitchA-Vlanif100] vrrp vrid 1 priority 120
[SwitchA-Vlanif100] vrrp vrid 1 preempt-mode timer delay 20
[SwitchA-Vlanif100] quit
3、配置 SwitchA 和 SwitchC 间采用静态路由协议进行互连。
[SwitchA]ip route-static 0.0.0.0 0.0.0.0 192.168.1.2
4、配置 STP 协议
# 在 SwitchA 上全局使能 STP。
[SwitchA]stp enable</code></pre> 
<p><strong>SwitchB的配置</strong></p> 
<pre><code>1、配置设备间的网络互连
# 配置 SwitchB 设备各接口的 IP 地址。
&lt;Quidway&gt; system-view
[Quidway] sysname SwitchB
[SwitchB] vlan batch 100 200
[SwitchB] interface ethernet 0/0/1
[SwitchB-Ethernet0/0/1] port link-type access
[SwitchB-Ethernet0/0/1] port default vlan 200
[SwitchB-Ethernet0/0/1] quit
[SwitchB] interface ethernet 0/0/2
[SwitchB-Ethernet0/0/2] port link-type access
[SwitchB-Ethernet0/0/2] port default vlan 100
[SwitchB-Ethernet0/0/2] quit
[SwitchB] interface ethernet 0/0/5
[SwitchB-Ethernet0/0/5] port link-type access
[SwitchB-Ethernet0/0/5] port hybrid untagged vlan 100
[SwitchB-Ethernet0/0/5] quit
[SwitchB] interface vlanif 100
[SwitchB-Vlanif100] ip address 10.1.1.2 24
[SwitchB-Vlanif100] quit
[SwitchB] interface vlanif 300
[SwitchB-Vlanif300] ip address 192.168.2.1 24
[SwitchB-Vlanif300] quit
1、配置 VRRP 备份组
# 在 SwitchB 上创建 VRRP 备份组1，其在该备份组中的优先级为缺省值100。
[SwitchB] interface vlanif 100
[SwitchB-Vlanif100] vrrp vrid 1 virtual-ip 10.1.1.111
[SwitchB-Vlanif100] quit
2、配置 SwitchB 和 SwitchC 间采用静态路由协议进行互连。
[SwitchA]ip route-static 0.0.0.0 0.0.0.0 192.168.2.2
3、配置 STP 协议
# 在 SwitchB 上全局使能 STP。
[SwitchB]stp enable</code></pre> 
<p><strong>SwitchC的配置</strong></p> 
<pre><code>1、配置设备间的网络互连
# 配置 SwitchC 设备各接口的 IP 地址。
&lt;Quidway&gt; system-view
[Quidway] sysname SwitchC
[SwitchC] vlan batch 200 300 400
[SwitchC] interface ethernet 0/0/1
[SwitchC-Ethernet0/0/1] port link-type access
[SwitchC-Ethernet0/0/1] port default vlan 300
[SwitchC-Ethernet0/0/1] quit
[SwitchC] interface ethernet 0/0/2
[SwitchC-Ethernet0/0/2] port link-type access
[SwitchC-Ethernet0/0/2] port default vlan 200
[SwitchC-Ethernet0/0/2] quit
[SwitchC] interface ethernet 0/0/3
[SwitchC-Ethernet0/0/5] port link-type access
[SwitchC-Ethernet0/0/5] port hybrid untagged vlan 400
[SwitchC-Ethernet0/0/5] quit
[SwitchC] interface vlanif 200
[SwitchC-Vlanif100] ip address 192.168.2.2 24
[SwitchC-Vlanif100] quit
[SwitchC] interface vlanif 300
[SwitchC-Vlanif300] ip address 192.168.1.2 24
[SwitchC-Vlanif300] quit
[SwitchC] interface vlanif 400
[SwitchC-Vlanif300] ip address 20.1.1.100 24
[SwitchC-Vlanif300] quit
2、配置 SwitchC 和 Switch A 、SwitchB 间采用静态路由协议进行互连。
[SwitchC]ip route-static 10.1.1.0 255.255.255.0 192.168.1.1
[SwitchC]ip route-static 10.1.1.0 255.255.255.0 192.168.2.1
Switch 设备配置如下：
1、配置 Switch 的二层透传功能。
&lt;Quidway&gt; system-view
[Quidway] sysname Switch
[Switch] vlan 100
[Switch-vlan100] quit
[Switch] interface ethernet 0/0/1
[Switch-Ethernet0/0/1] port link-type access
[Switch-Ethernet0/0/1] port default vlan 100
[Switch-Ethernet0/0/1] quit
[Switch] interface ethernet 0/0/2
[Switch-Ethernet0/0/2] port link-type access
[Switch-Ethernet0/0/2] port default vlan 100
[Switch-Ethernet0/0/2] quit
2、配置 STP 协议
# 在 SwitchC 上全局使能 STP。
[SwitchC]stp enable
</code></pre> 
<p></p> 
<h4 id="2.%E9%85%8D%E7%BD%AEVRRP%E8%B4%9F%E8%BD%BD%E5%88%86%E6%8B%85">2.配置VRRP负载分担</h4> 
<p>如图所示，HostA 和 HostC 通过 Switch 双归属到 SwitchA 和 SwitchB。为减轻 SwitchA 上数据流量的承载压力，HostA 以 SwitchA 为默认网关接入 Internet，SwitchB 作为备份网关；HostC 以 SwitchB 为默认网关接入 Internet，SwitchA 作为备份网关，以实现流量的负载均衡。</p> 
<p><img alt="" height="580" src="https://images2.imgbox.com/5f/ca/CEQerSwC_o.png" width="1133"></p> 
<p> <img alt="" height="626" src="https://images2.imgbox.com/9b/19/OXnA3Vkn_o.png" width="957"></p> 
<p> 思路:</p> 
<p>•配置各设备接口 IP 地址及路由协议，使各设备间网络层连通。</p> 
<p>•在 SwitchA 和 SwitchB 上创建 VRRP 备份组1和 VRRP 备份组2，在备份组1中，配置 SwitchA 为 Master 设备，SwitchB 为 Backup 设备；在备份组2中，配置 SwitchB 为 Master 设备，SwitchA 为 Backup 设备，实现流量的负载均衡。</p> 
<p><strong>配置SwitchA设备各接口的IP地址</strong></p> 
<pre><code>1. 配置设备间的网络互连
# 配置 SwitchA 设备各接口的 IP 地址。
&lt;Quidway&gt; system-view
[Quidway] sysname SwitchA
[SwitchA] vlan batch 100 300
[SwitchA] interface ethernet 0/0/1
[SwitchA-Ethernet0/0/1] port link-type access
[SwitchA-Ethernet0/0/1] port default vlan 300
[SwitchA-Ethernet0/0/1] quit
[SwitchA] interface ethernet 0/0/2
[SwitchA-Ethernet0/0/2] port link-type access
[SwitchA-Ethernet0/0/2] port default vlan 100
[SwitchA-Ethernet0/0/2] quit
[SwitchA] interface vlanif 100
[SwitchA-Vlanif100] ip address 10.1.1.1 24
[SwitchA-Vlanif100] quit
[SwitchA] interface vlanif 300
[SwitchA-Vlanif300] ip address 192.168.1.1 24
[SwitchA-Vlanif300] quit
2. 配置 VRRP 备份组
# 在 SwitchA 上创建 VRRP 备份组1，配置 SwitchA 在该备份组中的优先级为120，抢占延时为20
秒，作为 Master 设备；
[SwitchA] interface vlanif 100
[SwitchA-Vlanif100] vrrp vrid 1 virtual-ip 10.1.1.111
[SwitchA-Vlanif100] vrrp vrid 1 priority 120
[SwitchA-Vlanif100] vrrp vrid 1 preempt-mode timer delay 20
[SwitchA-Vlanif100] quit
# 在 SwitchA 上创建 VRRP 备份组2，SwitchA 在该备份组中的优先级为缺省值，作为 Backup 设
备。
[SwitchA] interface vlanif 100
[SwitchA-Vlanif100] vrrp vrid 2 virtual-ip 10.1.1.112
[SwitchA-Vlanif100] quit
3. 配置 SwitchA 和 SwitchC 间采用静态路由协议进行互连。
[SwitchA]ip route-static 0.0.0.0 0.0.0.0 192.168.1.2</code></pre> 
<p><strong>SwitchB设备配置</strong></p> 
<pre><code>1. 配置设备间的网络互连
# 配置 SwitchB 设备各接口的 IP 地址。
&lt;Quidway&gt; system-view
[Quidway] sysname SwitchB
[SwitchB] vlan batch 100 200
[SwitchB] interface ethernet 0/0/1
[SwitchB-Ethernet0/0/1] port link-type access
[SwitchB-Ethernet0/0/1] port default vlan 200
[SwitchB-Ethernet0/0/1] quit
[SwitchB] interface ethernet 0/0/2
[SwitchB-Ethernet0/0/2] port link-type access
[SwitchB-Ethernet0/0/2] port default vlan 100
[SwitchB-Ethernet0/0/2] quit
[SwitchB] interface vlanif 100
[SwitchB-Vlanif100] ip address 10.1.1.2 24
[SwitchB-Vlanif100] quit
[SwitchB] interface vlanif 200
[SwitchB-Vlanif300] ip address 192.168.2.1 24
[SwitchB-Vlanif300] quit
2. 配置 VRRP 备份组
# 在 SwitchB 上创建 VRRP 备份组2，配置 SwitchB 在该备份组中的优先级为120，抢占延时为20
秒，作为 Master 设备；
[SwitchB] interface vlanif 100
[SwitchB-Vlanif100] vrrp vrid 2 virtual-ip 10.1.1.112
[SwitchB-Vlanif100] vrrp vrid 2 priority 120
[SwitchB-Vlanif100] vrrp vrid 2 preempt-mode timer delay 20
[SwitchB-Vlanif100] quit
# 在 SwitchB 上创建 VRRP 备份组1，SwitchB 在该备份组中的优先级为缺省值，作为 Backup 设备。
[SwitchB] interface vlanif 100
[SwitchB-Vlanif100] vrrp vrid 1 virtual-ip 10.1.1.111
[SwitchB-Vlanif100] quit
3. 配置 SwitchB 和 SwitchC 间采用静态路由协议进行互连。
[SwitchB]ip route-static 0.0.0.0 0.0.0.0 192.168.1.2</code></pre> 
<p><strong>Switch设备配置</strong></p> 
<pre><code>1. 配置设备间的网络互连
# 配置 SwitchC 设备各接口的 IP 地址。
&lt;Quidway&gt; system-view
[Quidway] sysname SwitchC
[SwitchC] vlan batch 200 300 400
[SwitchC] interface ethernet 0/0/1
[SwitchC-Ethernet0/0/1] port link-type access
[SwitchC-Ethernet0/0/1] port default vlan 300
[SwitchC-Ethernet0/0/1] quit
[SwitchC] interface ethernet 0/0/2
[SwitchC-Ethernet0/0/2] port link-type access
[SwitchC-Ethernet0/0/2] port default vlan 200
[SwitchC-Ethernet0/0/2] quit
[SwitchC] interface ethernet 0/0/3
[SwitchC-Ethernet0/0/5] port link-type access
[SwitchC-Ethernet0/0/5] port hybrid untagged vlan 400
[SwitchC-Ethernet0/0/5] quit
[SwitchC] interface vlanif 200
[SwitchC-Vlanif100] ip address 192.168.2.2 24
[SwitchC-Vlanif100] quit
[SwitchC] interface vlanif 300
[SwitchC-Vlanif300] ip address 192.168.1.2 24
[SwitchC-Vlanif300] quit
[SwitchC] interface vlanif 400
[SwitchC-Vlanif300] ip address 20.1.1.100 24
[SwitchC-Vlanif300] quit
2. 配置 SwitchC 和 Switch A 、SwitchB 间采用静态路由协议进行互连。
[SwitchC]ip route-static 10.1.1.0 255.255.255.0 192.168.1.1
[SwitchC]ip route-static 10.1.1.0 255.255.255.0 192.168.2.1
Switch 设备配置如下：
1. 配置 Switch 的二层透传功能。
&lt;Quidway&gt; system-view
[Quidway] sysname Switch
[Switch] vlan 100
[Switch-vlan100] quit
[Switch] interface ethernet 0/0/1
[Switch-Ethernet0/0/1] port link-type access
[Switch-Ethernet0/0/1] port default vlan 100
[Switch-Ethernet0/0/1] quit
[Switch] interface ethernet 0/0/2
[Switch-Ethernet0/0/2] port link-type access
[Switch-Ethernet0/0/2] port default vlan 100
[Switch-Ethernet0/0/2] quit</code></pre> 
<p></p> 
<h4 id="3.%E9%85%8D%E7%BD%AEVRRP%E5%9F%9FBFD%E8%81%94%E5%8A%A8%E5%AE%9E%E7%8E%B0%E5%BF%AB%E9%80%9F%E5%88%87%E6%8D%A2">3.配置VRRP域BFD联动实现快速切换</h4> 
<p>如图所示，局域网内的主机通过 Switch 双归属到部署了VRRP 备份组的 SwitchA 和SwitchB， 其中 SwitchA 为 Master。</p> 
<p>当 SwitchA 或 SwitchA 到 SwitchB 间链路出现故障时，VRRP 报文协商需要一定的协商周期。为 了实现链路故障时快速切换，可以在链路中部署 BFD 链路检测机制，并配置 VRRP 监视 BFD 会话，实现当 主用接口或者链路出现 Down 时，备用设备迅速切换为 Master，承担网络流量，以减少故障对业务传输的影响。</p> 
<p><img alt="" height="323" src="https://images2.imgbox.com/04/e0/tVc58aUy_o.png" width="757"></p> 
<p> 思路:</p> 
<p>•配置各设备接口 IP 地址及路由协议，使网络层路由可达。</p> 
<p>•在 SwitchA 和 SwitchB 上配置 VRRP 备份组，其中 SwitchA 的优先级为120，抢占延时为20 秒，作为 Master 设备；SwitchB 的优先级为缺省值，作为 Backup 设备，实现网关的主备备份。</p> 
<p>•在 SwitchA 和 SwitchB 上配置静态 BFD 会话，监测备份组之间的链路。</p> 
<p>•在 SwitchB 上配置 VRRP 与 BFD 联动，实现链路故障时 VRRP 备份组快速切换</p> 
<p><strong>SwitchA设备各接口的IP地址</strong></p> 
<pre><code># 配置 SwitchA 设备各接口的 IP 地址。
&lt;Quidway&gt; system-view
[Quidway] sysname SwitchA
[SwitchA] vlan batch 100 
[SwitchA] interface ethernet 0/0/1
[SwitchA-Ethernet0/0/1] port link-type access
[SwitchA-Ethernet0/0/1] port default vlan 100
[SwitchA-Ethernet0/0/1] quit
[SwitchA] interface vlanif 100
[SwitchA-Vlanif100] ip address 10.1.1.1 24
[SwitchA-Vlanif100] quit
2. 配置 VRRP 备份组
# 在 SwitchA 上创建 VRRP 备份组1，配置 SwitchA 在该备份组中的优先级为120，抢占延时为20
秒，作为 Master 设备；
[SwitchA] interface vlanif 100
[SwitchA-Vlanif100] vrrp vrid 1 virtual-ip 10.1.1.3
[SwitchA-Vlanif100] vrrp vrid 1 priority 120
[SwitchA-Vlanif100] vrrp vrid 1 preempt-mode timer delay 20
[SwitchA-Vlanif100] quit
3. 配置静态 BFD 会话
# 在 SwitchA 上配置 BFD 会话。
[SwitchA] bfd
[SwitchA-bfd] quit
[SwitchA] bfd atob bind peer-ip 10.1.1.2 interface vlanif 100
[SwitchA-bfd-session-atob] discriminator local 1
[SwitchA-bfd-session-atob] discriminator remote 2
[SwitchA-bfd-session-atob] min-rx-interval 100
[SwitchA-bfd-session-atob] min-tx-interval 100
[SwitchB-bfd-session-atob] commit
[SwitchA-bfd-session-atob] quit</code></pre> 
<p><strong>SwitchB设备配置</strong></p> 
<pre><code>1. 配置设备间的网络互连
# 配置 SwitchB 设备各接口的 IP 地址。
&lt;Quidway&gt; system-view
106
[Quidway] sysname SwitchB
[SwitchB] vlan batch 100 
[SwitchB] interface ethernet 0/0/1
[SwitchB-Ethernet0/0/1] port link-type access
[SwitchB-Ethernet0/0/1] port default vlan 100
[SwitchB-Ethernet0/0/1] quit
[SwitchB] interface vlanif 100
[SwitchB-Vlanif100] ip address 10.1.1.2 24
[SwitchB-Vlanif100] quit
2. 配置 VRRP 备份组
# 在 SwitchB 上创建 VRRP 备份组1，优先级为默认值100，作为 Slave 设备；
[SwitchB] interface vlanif 100
[SwitchB-Vlanif100] vrrp vrid 1 virtual-ip 10.1.1.3
3. 配置静态 BFD 会话
# 在 SwitchB 上配置 BFD 会话。
[SwitchB] bfd
[SwitchB-bfd] quit
[SwitchB] bfd atob bind peer-ip 10.1.1.1 interface vlanif 100
[SwitchB-bfd-session-atob] discriminator local 2
[SwitchB-bfd-session-atob] discriminator remote 1
[SwitchB-bfd-session-atob] min-rx-interval 100
[SwitchB-bfd-session-atob] min-tx-interval 100
[SwitchB-bfd-session-atob] commit
[SwitchB-bfd-session-atob] quit
4. 配置 VRRP 与 BFD 联动功能
# 在 SwitchB 上配置 VRRP 与 BFD 联动，当 BFD 会话状态 Down 时，SwitchB 的优先级增加40。
[SwitchB] interface vlanif 100
[SwitchB-Vlanif100] vrrp vrid 1 track bfd-session 2 increased 40 //bfd-session 
的取值和 local 的取值一样
[SwitchB-Vlanif100] quit</code></pre> 
<p><strong>Switch的配置</strong></p> 
<pre><code># 配置 Switch 的二层透传能力
&lt;Quidway&gt; system-view
[Quidway] sysname Switch
107
[Switch] vlan 100
[Switch-vlan100] quit
[Switch] interface ethernet 0/0/1
[Switch-Ethernet0/0/1] port hybrid pvid vlan 100
[Switch-Ethernet0/0/1] port hybrid untagged vlan 100
[Switch-Ethernet0/0/1] quit
[Switch] interface ethernet 0/0/2
[Switch-Ethernet0/0/2] port hybrid pvid vlan 100
[Switch-Ethernet0/0/2] port hybrid untagged vlan 100
[Switch-Ethernet0/0/2] quit</code></pre> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/257a9d721912def1b957b61939d987e6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【数据结构】顺序表(SeqList)（增、删、查、改）详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3a5a1e703835e80681061259ef02e1c2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python自定义装饰器以及while 循环</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>