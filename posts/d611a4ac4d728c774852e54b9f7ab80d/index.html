<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用java代码方式解决XSS、Host Head漏洞问题 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用java代码方式解决XSS、Host Head漏洞问题" />
<meta property="og:description" content="一、使用java代码方式解决XSS漏洞问题 1 ESAPI方式 1.1 引入jar包 compile(&#39;org.owasp.esapi:esapi:2.2.3.1&#39;) { exclude group: &#39;log4j&#39;, module: &#39;log4j&#39; exclude group: &#39;org.slf4j&#39;, module: &#39;slf4j-simple&#39; } 1.2 增加配置文件 1.2.1 ESAPI.properties配置文件内容 # 是否要打印配置属性,默认为true ESAPI.printProperties=true ESAPI.AccessControl=org.owasp.esapi.reference.DefaultAccessController ESAPI.Authenticator=org.owasp.esapi.reference.FileBasedAuthenticator ESAPI.Encoder=org.owasp.esapi.reference.DefaultEncoder ESAPI.Encryptor=org.owasp.esapi.reference.crypto.JavaEncryptor ESAPI.Executor=org.owasp.esapi.reference.DefaultExecutor ESAPI.HTTPUtilities=org.owasp.esapi.reference.DefaultHTTPUtilities ESAPI.IntrusionDetector=org.owasp.esapi.reference.DefaultIntrusionDetector ESAPI.Logger=org.owasp.esapi.logging.slf4j.Slf4JLogFactory ESAPI.Randomizer=org.owasp.esapi.reference.DefaultRandomizer ESAPI.Validator=org.owasp.esapi.reference.DefaultValidator #=========================================================================== # ESAPI Encoder Encoder.AllowMultipleEncoding=false Encoder.AllowMixedEncoding=false Encoder.DefaultCodecList=HTMLEntityCodec,PercentCodec,JavaScriptCodec #=========================================================================== # ESAPI 加密模块 Encryptor.PreferredJCEProvider= Encryptor.EncryptionAlgorithm=AES Encryptor.CipherTransformation=AES/CBC/PKCS5Padding Encryptor.cipher_modes.combined_modes=GCM,CCM,IAPM,EAX,OCB,CWC Encryptor.cipher_modes.additional_allowed=CBC Encryptor.EncryptionKeyLength=128 Encryptor.ChooseIVMethod=random Encryptor.fixedIV=0x000102030405060708090a0b0c0d0e0f Encryptor.CipherText.useMAC=true Encryptor.PlainText.overwrite=true Encryptor.HashAlgorithm=SHA-512 Encryptor.HashIterations=1024 Encryptor.DigitalSignatureAlgorithm=SHA1withDSA Encryptor.DigitalSignatureKeyLength=1024 Encryptor.RandomAlgorithm=SHA1PRNG Encryptor.CharacterEncoding=UTF-8 Encryptor.KDF.PRF=HmacSHA256 #=========================================================================== # ESAPI Http工具 HttpUtilities.UploadDir=C:\\ESAPI\\testUpload HttpUtilities.UploadTempDir=C:\\temp # Force flags on cookies, if you use HttpUtilities to set cookies HttpUtilities." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/d611a4ac4d728c774852e54b9f7ab80d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-04T14:57:22+08:00" />
<meta property="article:modified_time" content="2021-08-04T14:57:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用java代码方式解决XSS、Host Head漏洞问题</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="javaXSS_0"></a>一、使用java代码方式解决XSS漏洞问题</h2> 
<h3><a id="1_ESAPI_1"></a>1 ESAPI方式</h3> 
<h4><a id="11_jar_2"></a>1.1 引入jar包</h4> 
<pre><code class="prism language-groovy"><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">'org.owasp.esapi:esapi:2.2.3.1'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    exclude group<span class="token punctuation">:</span> <span class="token string">'log4j'</span><span class="token punctuation">,</span> module<span class="token punctuation">:</span> <span class="token string">'log4j'</span>
    exclude group<span class="token punctuation">:</span> <span class="token string">'org.slf4j'</span><span class="token punctuation">,</span> module<span class="token punctuation">:</span> <span class="token string">'slf4j-simple'</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="12__9"></a>1.2 增加配置文件</h4> 
<p><img src="https://images2.imgbox.com/4d/6c/FOSYm26e_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="121_ESAPIproperties_12"></a>1.2.1 ESAPI.properties配置文件内容</h5> 
<pre><code class="prism language-java"># 是否要打印配置属性<span class="token punctuation">,</span>默认为<span class="token boolean">true</span>
ESAPI<span class="token punctuation">.</span>printProperties<span class="token operator">=</span><span class="token boolean">true</span>

<span class="token class-name">ESAPI<span class="token punctuation">.</span>AccessControl</span><span class="token operator">=</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>reference<span class="token punctuation">.</span></span>DefaultAccessController</span>
<span class="token class-name">ESAPI<span class="token punctuation">.</span>Authenticator</span><span class="token operator">=</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>reference<span class="token punctuation">.</span></span>FileBasedAuthenticator</span>
<span class="token class-name">ESAPI<span class="token punctuation">.</span>Encoder</span><span class="token operator">=</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>reference<span class="token punctuation">.</span></span>DefaultEncoder</span>
<span class="token class-name">ESAPI<span class="token punctuation">.</span>Encryptor</span><span class="token operator">=</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>reference<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span>JavaEncryptor</span>
<span class="token class-name">ESAPI<span class="token punctuation">.</span>Executor</span><span class="token operator">=</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>reference<span class="token punctuation">.</span></span>DefaultExecutor</span>
<span class="token class-name">ESAPI<span class="token punctuation">.</span>HTTPUtilities</span><span class="token operator">=</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>reference<span class="token punctuation">.</span></span>DefaultHTTPUtilities</span>
<span class="token class-name">ESAPI<span class="token punctuation">.</span>IntrusionDetector</span><span class="token operator">=</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>reference<span class="token punctuation">.</span></span>DefaultIntrusionDetector</span>
<span class="token class-name">ESAPI<span class="token punctuation">.</span>Logger</span><span class="token operator">=</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>logging<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span>Slf4JLogFactory</span>
<span class="token class-name">ESAPI<span class="token punctuation">.</span>Randomizer</span><span class="token operator">=</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>reference<span class="token punctuation">.</span></span>DefaultRandomizer</span>
<span class="token class-name">ESAPI<span class="token punctuation">.</span>Validator</span><span class="token operator">=</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>reference<span class="token punctuation">.</span></span>DefaultValidator</span>


#<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
# ESAPI <span class="token class-name">Encoder</span>
<span class="token class-name">Encoder<span class="token punctuation">.</span>AllowMultipleEncoding</span><span class="token operator">=</span><span class="token boolean">false</span>
<span class="token class-name">Encoder<span class="token punctuation">.</span>AllowMixedEncoding</span><span class="token operator">=</span><span class="token boolean">false</span>
<span class="token class-name">Encoder<span class="token punctuation">.</span>DefaultCodecList</span><span class="token operator">=</span><span class="token class-name">HTMLEntityCodec</span><span class="token punctuation">,</span><span class="token class-name">PercentCodec</span><span class="token punctuation">,</span><span class="token class-name">JavaScriptCodec</span>


#<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
# ESAPI 加密模块
<span class="token class-name">Encryptor<span class="token punctuation">.</span>PreferredJCEProvider</span><span class="token operator">=</span>
<span class="token class-name">Encryptor<span class="token punctuation">.</span>EncryptionAlgorithm</span><span class="token operator">=</span>AES
<span class="token class-name">Encryptor<span class="token punctuation">.</span>CipherTransformation</span><span class="token operator">=</span>AES<span class="token operator">/</span>CBC<span class="token operator">/</span><span class="token class-name">PKCS5Padding</span>
<span class="token class-name">Encryptor</span><span class="token punctuation">.</span>cipher_modes<span class="token punctuation">.</span>combined_modes<span class="token operator">=</span>GCM<span class="token punctuation">,</span>CCM<span class="token punctuation">,</span>IAPM<span class="token punctuation">,</span>EAX<span class="token punctuation">,</span>OCB<span class="token punctuation">,</span>CWC
<span class="token class-name">Encryptor</span><span class="token punctuation">.</span>cipher_modes<span class="token punctuation">.</span>additional_allowed<span class="token operator">=</span>CBC
<span class="token class-name">Encryptor<span class="token punctuation">.</span>EncryptionKeyLength</span><span class="token operator">=</span><span class="token number">128</span>
<span class="token class-name">Encryptor<span class="token punctuation">.</span>ChooseIVMethod</span><span class="token operator">=</span>random
<span class="token class-name">Encryptor</span><span class="token punctuation">.</span>fixedIV<span class="token operator">=</span><span class="token number">0x000102030405060708090a0b0c0d0e0f</span>
<span class="token class-name">Encryptor<span class="token punctuation">.</span>CipherText</span><span class="token punctuation">.</span>useMAC<span class="token operator">=</span><span class="token boolean">true</span>
<span class="token class-name">Encryptor<span class="token punctuation">.</span>PlainText</span><span class="token punctuation">.</span>overwrite<span class="token operator">=</span><span class="token boolean">true</span>
<span class="token class-name">Encryptor<span class="token punctuation">.</span>HashAlgorithm</span><span class="token operator">=</span>SHA<span class="token operator">-</span><span class="token number">512</span>
<span class="token class-name">Encryptor<span class="token punctuation">.</span>HashIterations</span><span class="token operator">=</span><span class="token number">1024</span>
<span class="token class-name">Encryptor<span class="token punctuation">.</span>DigitalSignatureAlgorithm</span><span class="token operator">=</span><span class="token class-name">SHA1withDSA</span>
<span class="token class-name">Encryptor<span class="token punctuation">.</span>DigitalSignatureKeyLength</span><span class="token operator">=</span><span class="token number">1024</span>
<span class="token class-name">Encryptor<span class="token punctuation">.</span>RandomAlgorithm</span><span class="token operator">=</span>SHA1PRNG
<span class="token class-name">Encryptor<span class="token punctuation">.</span>CharacterEncoding</span><span class="token operator">=</span>UTF<span class="token operator">-</span><span class="token number">8</span>
<span class="token class-name">Encryptor</span><span class="token punctuation">.</span>KDF<span class="token punctuation">.</span>PRF<span class="token operator">=</span><span class="token class-name">HmacSHA256</span>

#<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
# ESAPI <span class="token class-name">Http</span>工具

<span class="token class-name">HttpUtilities<span class="token punctuation">.</span>UploadDir</span><span class="token operator">=</span><span class="token class-name">C</span><span class="token operator">:</span>\\ESAPI\\testUpload
<span class="token class-name">HttpUtilities<span class="token punctuation">.</span>UploadTempDir</span><span class="token operator">=</span><span class="token class-name">C</span><span class="token operator">:</span>\\temp
# <span class="token class-name">Force</span> flags on cookies<span class="token punctuation">,</span> <span class="token keyword">if</span> you use <span class="token class-name">HttpUtilities</span> <span class="token keyword">to</span> <span class="token namespace">set</span> cookies
<span class="token class-name">HttpUtilities<span class="token punctuation">.</span>ForceHttpOnlySession</span><span class="token operator">=</span><span class="token boolean">false</span>
<span class="token class-name">HttpUtilities<span class="token punctuation">.</span>ForceSecureSession</span><span class="token operator">=</span><span class="token boolean">false</span>
<span class="token class-name">HttpUtilities<span class="token punctuation">.</span>ForceHttpOnlyCookies</span><span class="token operator">=</span><span class="token boolean">true</span>
<span class="token class-name">HttpUtilities<span class="token punctuation">.</span>ForceSecureCookies</span><span class="token operator">=</span><span class="token boolean">true</span>
# <span class="token class-name">Maximum</span> size of HTTP headers
<span class="token class-name">HttpUtilities<span class="token punctuation">.</span>MaxHeaderSize</span><span class="token operator">=</span><span class="token number">4096</span>
# <span class="token class-name">File</span> upload configuration
<span class="token class-name">HttpUtilities<span class="token punctuation">.</span>ApprovedUploadExtensions</span><span class="token operator">=</span><span class="token punctuation">.</span>zip<span class="token punctuation">,</span><span class="token punctuation">.</span>pdf<span class="token punctuation">,</span><span class="token punctuation">.</span>doc<span class="token punctuation">,</span><span class="token punctuation">.</span>docx<span class="token punctuation">,</span><span class="token punctuation">.</span>ppt<span class="token punctuation">,</span><span class="token punctuation">.</span>pptx<span class="token punctuation">,</span><span class="token punctuation">.</span>tar<span class="token punctuation">,</span><span class="token punctuation">.</span>gz<span class="token punctuation">,</span><span class="token punctuation">.</span>tgz<span class="token punctuation">,</span><span class="token punctuation">.</span>rar<span class="token punctuation">,</span><span class="token punctuation">.</span>war<span class="token punctuation">,</span><span class="token punctuation">.</span>jar<span class="token punctuation">,</span><span class="token punctuation">.</span>ear<span class="token punctuation">,</span><span class="token punctuation">.</span>xls<span class="token punctuation">,</span><span class="token punctuation">.</span>rtf<span class="token punctuation">,</span><span class="token punctuation">.</span>properties<span class="token punctuation">,</span><span class="token punctuation">.</span>java<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token punctuation">.</span>txt<span class="token punctuation">,</span><span class="token punctuation">.</span>xml<span class="token punctuation">,</span><span class="token punctuation">.</span>jsp<span class="token punctuation">,</span><span class="token punctuation">.</span>jsf<span class="token punctuation">,</span><span class="token punctuation">.</span>exe<span class="token punctuation">,</span><span class="token punctuation">.</span>dll
<span class="token class-name">HttpUtilities<span class="token punctuation">.</span>MaxUploadFileBytes</span><span class="token operator">=</span><span class="token number">500000000</span>
# <span class="token class-name">Using</span> UTF<span class="token operator">-</span><span class="token number">8</span> throughout your stack is highly <span class="token class-name"><span class="token namespace">recommended<span class="token punctuation">.</span></span> That</span> includes your database driver<span class="token punctuation">,</span>
# container<span class="token punctuation">,</span> and any other technologies you may be <span class="token class-name"><span class="token namespace">using<span class="token punctuation">.</span></span> Failure</span> <span class="token keyword">to</span> <span class="token keyword">do</span> <span class="token keyword">this</span> may expose you
# <span class="token keyword">to</span> <span class="token class-name">Unicode</span> transcoding injection <span class="token class-name"><span class="token namespace">attacks<span class="token punctuation">.</span></span> Use</span> of UTF<span class="token operator">-</span><span class="token number">8</span> does not hinder <span class="token class-name"><span class="token namespace">internationalization<span class="token punctuation">.</span></span>
HttpUtilities<span class="token punctuation">.</span>ResponseContentType</span><span class="token operator">=</span>text<span class="token operator">/</span>html<span class="token punctuation">;</span> charset<span class="token operator">=</span>UTF<span class="token operator">-</span><span class="token number">8</span>
# <span class="token class-name">This</span> is the name of the cookie used <span class="token keyword">to</span> <span class="token namespace">represent</span> the HTTP session
# <span class="token class-name">Typically</span> <span class="token keyword">this</span> will be the <span class="token keyword">default</span> <span class="token string">"JSESSIONID"</span>
<span class="token class-name">HttpUtilities<span class="token punctuation">.</span>HttpSessionIdName</span><span class="token operator">=</span>JSESSIONID



#<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
# ESAPI <span class="token class-name">Executor</span>
<span class="token class-name">Executor<span class="token punctuation">.</span>WorkingDirectory</span><span class="token operator">=</span>
<span class="token class-name">Executor<span class="token punctuation">.</span>ApprovedExecutables</span><span class="token operator">=</span>


#<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
# ESAPI <span class="token class-name">Logging</span>
# <span class="token class-name">Set</span> the application name <span class="token keyword">if</span> these logs are combined <span class="token keyword">with</span> <span class="token namespace">other</span> applications
<span class="token class-name">Logger<span class="token punctuation">.</span>ApplicationName</span><span class="token operator">=</span><span class="token class-name">ExampleApplication</span>
# <span class="token class-name">If</span> you use an HTML log viewer that does not properly HTML escape log data<span class="token punctuation">,</span> you can set <span class="token class-name">LogEncodingRequired</span> <span class="token keyword">to</span> <span class="token namespace">true</span>
<span class="token class-name">Logger<span class="token punctuation">.</span>LogEncodingRequired</span><span class="token operator">=</span><span class="token boolean">false</span>
# <span class="token class-name">Determines</span> whether ESAPI should log the application <span class="token class-name"><span class="token namespace">name<span class="token punctuation">.</span></span> This</span> might be clutter in some single<span class="token operator">-</span>server<span class="token operator">/</span>single<span class="token operator">-</span>app <span class="token class-name"><span class="token namespace">environments<span class="token punctuation">.</span></span>
Logger<span class="token punctuation">.</span>LogApplicationName</span><span class="token operator">=</span><span class="token boolean">true</span>
# <span class="token class-name">Determines</span> whether ESAPI should log the server IP and <span class="token class-name"><span class="token namespace">port<span class="token punctuation">.</span></span> This</span> might be clutter in some single<span class="token operator">-</span>server <span class="token class-name"><span class="token namespace">environments<span class="token punctuation">.</span></span>
Logger<span class="token punctuation">.</span>LogServerIP</span><span class="token operator">=</span><span class="token boolean">true</span>
# <span class="token class-name">LogFileName</span><span class="token punctuation">,</span> the name of the logging <span class="token class-name"><span class="token namespace">file<span class="token punctuation">.</span></span> Provide</span> a full directory path <span class="token punctuation">(</span>e<span class="token punctuation">.</span>g<span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token class-name">C</span><span class="token operator">:</span>\\ESAPI\\<span class="token class-name">ESAPI_logging_file</span><span class="token punctuation">)</span> <span class="token keyword">if</span> you
# want <span class="token keyword">to</span> <span class="token namespace">place</span> it in a specific <span class="token class-name"><span class="token namespace">directory<span class="token punctuation">.</span></span>
Logger<span class="token punctuation">.</span>LogFileName</span><span class="token operator">=</span><span class="token class-name">ESAPI_logging_file</span>
# <span class="token class-name">MaxLogFileSize</span><span class="token punctuation">,</span> the max size <span class="token punctuation">(</span>in bytes<span class="token punctuation">)</span> of a single log file before it cuts over <span class="token keyword">to</span> <span class="token namespace">a</span> <span class="token keyword">new</span> one <span class="token punctuation">(</span><span class="token keyword">default</span> is <span class="token number">10</span><span class="token punctuation">,</span><span class="token number">000</span><span class="token punctuation">,</span><span class="token number">000</span><span class="token punctuation">)</span>
<span class="token class-name">Logger<span class="token punctuation">.</span>MaxLogFileSize</span><span class="token operator">=</span><span class="token number">10000000</span>
<span class="token class-name">Logger<span class="token punctuation">.</span>UserInfo</span><span class="token operator">=</span><span class="token boolean">false</span>
<span class="token class-name">Logger<span class="token punctuation">.</span>ClientInfo</span><span class="token operator">=</span><span class="token boolean">false</span>

#<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
# ESAPI <span class="token class-name">Intrusion</span> <span class="token class-name">Detection</span>
<span class="token class-name">IntrusionDetector<span class="token punctuation">.</span>Disable</span><span class="token operator">=</span><span class="token boolean">false</span>
<span class="token class-name">IntrusionDetector</span><span class="token punctuation">.</span>event<span class="token punctuation">.</span>test<span class="token punctuation">.</span>count<span class="token operator">=</span><span class="token number">2</span>
<span class="token class-name">IntrusionDetector</span><span class="token punctuation">.</span>event<span class="token punctuation">.</span>test<span class="token punctuation">.</span>interval<span class="token operator">=</span><span class="token number">10</span>
<span class="token class-name">IntrusionDetector</span><span class="token punctuation">.</span>event<span class="token punctuation">.</span>test<span class="token punctuation">.</span>actions<span class="token operator">=</span>disable<span class="token punctuation">,</span>log

<span class="token class-name">IntrusionDetector</span><span class="token punctuation">.</span>org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>IntrusionException<span class="token punctuation">.</span>count<span class="token operator">=</span><span class="token number">1</span>
<span class="token class-name">IntrusionDetector</span><span class="token punctuation">.</span>org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>IntrusionException<span class="token punctuation">.</span>interval<span class="token operator">=</span><span class="token number">1</span>
<span class="token class-name">IntrusionDetector</span><span class="token punctuation">.</span>org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>IntrusionException<span class="token punctuation">.</span>actions<span class="token operator">=</span>log<span class="token punctuation">,</span>disable<span class="token punctuation">,</span>logout

<span class="token class-name">IntrusionDetector</span><span class="token punctuation">.</span>org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>IntegrityException<span class="token punctuation">.</span>count<span class="token operator">=</span><span class="token number">10</span>
<span class="token class-name">IntrusionDetector</span><span class="token punctuation">.</span>org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>IntegrityException<span class="token punctuation">.</span>interval<span class="token operator">=</span><span class="token number">5</span>
<span class="token class-name">IntrusionDetector</span><span class="token punctuation">.</span>org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>IntegrityException<span class="token punctuation">.</span>actions<span class="token operator">=</span>log<span class="token punctuation">,</span>disable<span class="token punctuation">,</span>logout

<span class="token class-name">IntrusionDetector</span><span class="token punctuation">.</span>org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>AuthenticationHostException<span class="token punctuation">.</span>count<span class="token operator">=</span><span class="token number">2</span>
<span class="token class-name">IntrusionDetector</span><span class="token punctuation">.</span>org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>AuthenticationHostException<span class="token punctuation">.</span>interval<span class="token operator">=</span><span class="token number">10</span>
<span class="token class-name">IntrusionDetector</span><span class="token punctuation">.</span>org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>AuthenticationHostException<span class="token punctuation">.</span>actions<span class="token operator">=</span>log<span class="token punctuation">,</span>logout


#<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
# ESAPI 校验器
#校验器的配置文件
<span class="token class-name">Validator<span class="token punctuation">.</span>ConfigurationFile</span><span class="token operator">=</span>validation<span class="token punctuation">.</span>properties

# <span class="token class-name">Validators</span> used by ESAPI
<span class="token class-name">Validator<span class="token punctuation">.</span>AccountName</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">}</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>SystemCommand</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span><span class="token class-name">Z</span>\\<span class="token operator">-</span>\\<span class="token operator">/</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">}</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>RoleName</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>z<span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">}</span>$

#the word TEST below should be changed <span class="token keyword">to</span> <span class="token namespace">your</span> application
#name <span class="token operator">-</span> only relative URL's are supported
<span class="token class-name">Validator<span class="token punctuation">.</span>Redirect</span><span class="token operator">=</span><span class="token operator">^</span>\\<span class="token operator">/</span>test<span class="token punctuation">.</span>*$

# <span class="token class-name">Global</span> HTTP <span class="token class-name">Validation</span> <span class="token class-name">Rules</span>
# <span class="token class-name">Values</span> <span class="token keyword">with</span> <span class="token class-name">Base64</span> encoded data <span class="token punctuation">(</span>e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> encrypted state<span class="token punctuation">)</span> will need at least <span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9</span>\<span class="token operator">/</span><span class="token operator">+=</span><span class="token punctuation">]</span>
<span class="token class-name">Validator<span class="token punctuation">.</span>HTTPScheme</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">(</span>http<span class="token operator">|</span>https<span class="token punctuation">)</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>HTTPServerName</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9_.</span>\\<span class="token operator">-</span><span class="token punctuation">]</span><span class="token operator">*</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>HTTPParameterName</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9_</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">}</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>HTTPParameterValue</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9.</span>\\<span class="token operator">-</span>\\<span class="token operator">/</span><span class="token operator">+=</span><span class="token annotation punctuation">@_</span> <span class="token punctuation">]</span><span class="token operator">*</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>HTTPCookieName</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9</span>\\<span class="token operator">-</span>_<span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">}</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>HTTPCookieValue</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9</span>\\<span class="token operator">-</span>\\<span class="token operator">/</span><span class="token operator">+=</span>_ <span class="token punctuation">]</span><span class="token operator">*</span>$

# <span class="token class-name">Note</span> that max header name capped at <span class="token number">150</span> in <span class="token class-name">SecurityRequestWrapper</span><span class="token operator">!</span>
<span class="token class-name">Validator<span class="token punctuation">.</span>HTTPHeaderName</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9</span>\\<span class="token operator">-</span>_<span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">}</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>HTTPHeaderValue</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token function">9</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\\<span class="token operator">-=</span>\\<span class="token operator">*</span>\\<span class="token punctuation">.</span>\\<span class="token operator">?</span><span class="token punctuation">;</span><span class="token punctuation">,</span><span class="token operator">+</span>\\<span class="token operator">/</span><span class="token operator">:</span><span class="token operator">&amp;</span>_ <span class="token punctuation">]</span><span class="token operator">*</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>HTTPContextPath</span><span class="token operator">=</span><span class="token operator">^</span>\\<span class="token operator">/</span><span class="token operator">?</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9.</span>\\<span class="token operator">-</span>\\<span class="token operator">/</span>_<span class="token punctuation">]</span><span class="token operator">*</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>HTTPServletPath</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9.</span>\\<span class="token operator">-</span>\\<span class="token operator">/</span>_<span class="token punctuation">]</span><span class="token operator">*</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>HTTPPath</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9.</span>\\<span class="token operator">-</span>_<span class="token punctuation">]</span><span class="token operator">*</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>HTTPQueryString</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token function">9</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\\<span class="token operator">-=</span>\\<span class="token operator">*</span>\\<span class="token punctuation">.</span>\\<span class="token operator">?</span><span class="token punctuation">;</span><span class="token punctuation">,</span><span class="token operator">+</span>\\<span class="token operator">/</span><span class="token operator">:</span><span class="token operator">&amp;</span>_ <span class="token operator">%</span><span class="token punctuation">]</span><span class="token operator">*</span>$
<span class="token class-name">Validator</span><span class="token punctuation">.</span>HTTPURI<span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token function">9</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\\<span class="token operator">-=</span>\\<span class="token operator">*</span>\\<span class="token punctuation">.</span>\\<span class="token operator">?</span><span class="token punctuation">;</span><span class="token punctuation">,</span><span class="token operator">+</span>\\<span class="token operator">/</span><span class="token operator">:</span><span class="token operator">&amp;</span>_ <span class="token punctuation">]</span><span class="token operator">*</span>$
<span class="token class-name">Validator</span><span class="token punctuation">.</span>HTTPURL<span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">.</span>*$
<span class="token class-name">Validator</span><span class="token punctuation">.</span>HTTPJSESSIONID<span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span><span class="token class-name">A</span><span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">}</span>$

# <span class="token class-name">Validation</span> of file related input
<span class="token class-name">Validator<span class="token punctuation">.</span>FileName</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9</span><span class="token operator">!</span>@#$<span class="token operator">%</span><span class="token operator">^</span><span class="token operator">&amp;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>\\<span class="token punctuation">[</span>\\<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>_<span class="token operator">+</span>\\<span class="token operator">-=</span><span class="token punctuation">,</span><span class="token punctuation">.</span>~'` <span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">}</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>DirectoryName</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9</span><span class="token operator">:</span><span class="token operator">/</span>\\\\<span class="token operator">!</span>@#$<span class="token operator">%</span><span class="token operator">^</span><span class="token operator">&amp;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>\\<span class="token punctuation">[</span>\\<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>_<span class="token operator">+</span>\\<span class="token operator">-=</span><span class="token punctuation">,</span><span class="token punctuation">.</span>~'` <span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">}</span>$

# <span class="token class-name">Validation</span> of <span class="token class-name"><span class="token namespace">dates<span class="token punctuation">.</span></span> Controls</span> whether or not <span class="token string">'lenient'</span> dates are accepted<span class="token punctuation">.</span>
# <span class="token class-name">See</span> <span class="token class-name">DataFormat</span><span class="token punctuation">.</span><span class="token function">setLenient</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> flag<span class="token punctuation">)</span> <span class="token keyword">for</span> further <span class="token class-name"><span class="token namespace">details<span class="token punctuation">.</span></span>
Validator<span class="token punctuation">.</span>AcceptLenientDates</span><span class="token operator">=</span><span class="token boolean">false</span>
</code></pre> 
<h5><a id="122_validationproperties__168"></a>1.2.2 validation.properties 配置文件内容</h5> 
<pre><code class="prism language-java"><span class="token class-name">Validator<span class="token punctuation">.</span>SafeString</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span><span class="token punctuation">.</span>\\p<span class="token punctuation">{<!-- --></span><span class="token class-name">Alnum</span><span class="token punctuation">}</span>\\p<span class="token punctuation">{<!-- --></span><span class="token class-name">Space</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">}</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>Email</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">[</span><span class="token class-name">A</span><span class="token operator">-</span><span class="token class-name">Za</span><span class="token operator">-</span>z0<span class="token operator">-</span><span class="token number">9._</span><span class="token operator">%</span>'<span class="token operator">-</span><span class="token punctuation">]</span><span class="token operator">+</span>@<span class="token punctuation">[</span><span class="token class-name">A</span><span class="token operator">-</span><span class="token class-name">Za</span><span class="token operator">-</span>z0<span class="token operator">-</span><span class="token number">9.</span><span class="token operator">-</span><span class="token punctuation">]</span><span class="token operator">+</span>\\<span class="token punctuation">.</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span><span class="token class-name">Z</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>IPAddress</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">|</span><span class="token number">2</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">|</span><span class="token punctuation">[</span><span class="token number">01</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token punctuation">)</span>\\<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">|</span><span class="token number">2</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">|</span><span class="token punctuation">[</span><span class="token number">01</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token punctuation">)</span>$
<span class="token class-name">Validator</span><span class="token punctuation">.</span>URL<span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">(</span>ht<span class="token operator">|</span>f<span class="token punctuation">)</span><span class="token function">tp</span><span class="token punctuation">(</span>s<span class="token operator">?</span><span class="token punctuation">)</span>\\<span class="token operator">:</span>\\<span class="token operator">/</span>\\<span class="token operator">/</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span>a<span class="token operator">-</span>zA<span class="token operator">-</span><span class="token class-name">Z</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">.</span>\\w<span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span>a<span class="token operator">-</span>zA<span class="token operator">-</span><span class="token class-name">Z</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>\\<span class="token operator">/</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z0<span class="token operator">-</span><span class="token number">9</span>\\<span class="token operator">-</span>\\<span class="token punctuation">.</span>\\<span class="token operator">?</span>\\<span class="token punctuation">,</span>\\<span class="token operator">:</span>\\'\\<span class="token operator">/</span>\\\\\\<span class="token operator">+=</span><span class="token operator">&amp;</span>amp<span class="token punctuation">;</span><span class="token operator">%</span>\\$#_<span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">?</span>$
<span class="token class-name">Validator<span class="token punctuation">.</span>CreditCard</span><span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">(</span>\\d<span class="token punctuation">{<!-- --></span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token operator">-</span> <span class="token punctuation">]</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token number">3</span><span class="token punctuation">}</span>\\d<span class="token punctuation">{<!-- --></span><span class="token number">4</span><span class="token punctuation">}</span>$
<span class="token class-name">Validator</span><span class="token punctuation">.</span>SSN<span class="token operator">=</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">!</span><span class="token number">000</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">]</span>\\d<span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">|</span><span class="token function">7</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">]</span>\\d<span class="token operator">|</span><span class="token number">7</span><span class="token punctuation">[</span><span class="token number">012</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token operator">-</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">!</span><span class="token number">00</span><span class="token punctuation">)</span>\\d\\d\\<span class="token function">3</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">!</span><span class="token number">0000</span><span class="token punctuation">)</span>\\d<span class="token punctuation">{<!-- --></span><span class="token number">4</span><span class="token punctuation">}</span>$

</code></pre> 
<h4><a id="13__180"></a>1.3 代码</h4> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>lensyn<span class="token punctuation">.</span>system<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>xss</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * xss过滤器
 *
 * @author : gumingjun
 * @date : 2021-07-06
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">XssFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">XssHttpServletRequestWrapper</span> xssRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XssHttpServletRequestWrapper</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">)</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>xssRequest<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>lensyn<span class="token punctuation">.</span>system<span class="token punctuation">.</span>filter</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>lensyn<span class="token punctuation">.</span>system<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>host<span class="token punctuation">.</span></span><span class="token class-name">HostCleanFilter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>lensyn<span class="token punctuation">.</span>system<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>xss<span class="token punctuation">.</span></span><span class="token class-name">XssFilter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">FilterRegistrationBean</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">Filter</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * xss过滤器配置
 *
 * @author : gumingjun
 * @date : 2021-07-06
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FilterConfig</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${filter.host.hosts}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> hosts<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${filter.host.host-filter-url}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> hostFilterUrl<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">FilterRegistrationBean</span> <span class="token function">xssFilterRegistrationBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">FilterRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Filter</span><span class="token punctuation">&gt;</span></span> registration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilterRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registration<span class="token punctuation">.</span><span class="token function">setFilter</span><span class="token punctuation">(</span><span class="token function">xssFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registration<span class="token punctuation">.</span><span class="token function">addUrlPatterns</span><span class="token punctuation">(</span><span class="token string">"/users/list"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registration<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"xssFilter"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> registration<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Filter</span> <span class="token function">xssFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">XssFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">FilterRegistrationBean</span> <span class="token function">hostsFilterRegistrationBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">FilterRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Filter</span><span class="token punctuation">&gt;</span></span> registration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilterRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registration<span class="token punctuation">.</span><span class="token function">setFilter</span><span class="token punctuation">(</span><span class="token function">hostsFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registration<span class="token punctuation">.</span><span class="token function">addUrlPatterns</span><span class="token punctuation">(</span>hostFilterUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
        registration<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"hostsFilter"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registration<span class="token punctuation">.</span><span class="token function">addInitParameter</span><span class="token punctuation">(</span><span class="token string">"hosts"</span><span class="token punctuation">,</span> hosts<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> registration<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Filter</span> <span class="token function">hostsFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HostCleanFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>gumj<span class="token punctuation">.</span>system<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>xss</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>jsoup<span class="token punctuation">.</span></span><span class="token class-name">Jsoup</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>jsoup<span class="token punctuation">.</span>safety<span class="token punctuation">.</span></span><span class="token class-name">Whitelist</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>owasp<span class="token punctuation">.</span>esapi<span class="token punctuation">.</span></span>ESAPI<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequestWrapper</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>regex<span class="token punctuation">.</span></span><span class="token class-name">Pattern</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * xss请求处理包装类
 *
 * @author : gumingjun
 * @date : 2021-07-06
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">XssHttpServletRequestWrapper</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServletRequestWrapper</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token class-name">XssHttpServletRequestWrapper</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> servletRequest<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>servletRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getParameterValues</span><span class="token punctuation">(</span><span class="token class-name">String</span> parameter<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values <span class="token operator">=</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getParameterValues</span><span class="token punctuation">(</span>parameter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>values <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">int</span> length <span class="token operator">=</span> values<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encodedValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        	<span class="token comment">//以下二者采用其一即可</span>
        	<span class="token comment">//ESAPI方式</span>
            encodedValues<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">cleanXss</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//Jsoup方式</span>
            <span class="token comment">//encodedValues[i] = Jsoup.clean(values[i], Whitelist.relaxed()).trim();</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> encodedValues<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token class-name">String</span> parameter<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> value <span class="token operator">=</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span>parameter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">cleanXss</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> value <span class="token operator">=</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">cleanXss</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Pattern</span> scriptPattern <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"&lt;script&gt;(.*?)&lt;/script&gt;"</span><span class="token punctuation">,</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>CASE_INSENSITIVE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Pattern</span> srcPattern1 <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"src[\r\n]*=[\r\n]*\\\'(.*?)\\\'"</span><span class="token punctuation">,</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>CASE_INSENSITIVE <span class="token operator">|</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>MULTILINE <span class="token operator">|</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>DOTALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Pattern</span> srcPattern2 <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"src[\r\n]*=[\r\n]*\\\"(.*?)\\\""</span><span class="token punctuation">,</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>CASE_INSENSITIVE <span class="token operator">|</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>MULTILINE <span class="token operator">|</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>DOTALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Pattern</span> scriptPattern2 <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"&lt;/script&gt;"</span><span class="token punctuation">,</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>CASE_INSENSITIVE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Pattern</span> scriptPattern3 <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"&lt;script(.*?)&gt;"</span><span class="token punctuation">,</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>CASE_INSENSITIVE <span class="token operator">|</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>MULTILINE <span class="token operator">|</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>DOTALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Pattern</span> evalPattern <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"eval\\((.*?)\\)"</span><span class="token punctuation">,</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>CASE_INSENSITIVE <span class="token operator">|</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>MULTILINE <span class="token operator">|</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>DOTALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Pattern</span> expressionPattern <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"expression\\((.*?)\\)"</span><span class="token punctuation">,</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>CASE_INSENSITIVE <span class="token operator">|</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>MULTILINE <span class="token operator">|</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>DOTALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Pattern</span> javascriptPattern <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"javascript:"</span><span class="token punctuation">,</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>CASE_INSENSITIVE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Pattern</span> vbScriptPattern <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"vbscript:"</span><span class="token punctuation">,</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>CASE_INSENSITIVE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Pattern</span> onloadPattern <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"onload(.*?)="</span><span class="token punctuation">,</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>CASE_INSENSITIVE <span class="token operator">|</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>MULTILINE <span class="token operator">|</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>DOTALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Pattern</span> onPattern <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"on.*(.*?)="</span><span class="token punctuation">,</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>CASE_INSENSITIVE <span class="token operator">|</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>MULTILINE <span class="token operator">|</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span>DOTALL<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">cleanXss</span><span class="token punctuation">(</span><span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 推荐使用ESAPI库来避免脚本攻击</span>
            value <span class="token operator">=</span> ESAPI<span class="token punctuation">.</span><span class="token function">encoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">canonicalize</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 避免空字符串</span>
            value <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">"\\s"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 避免script 标签</span>
            value <span class="token operator">=</span> scriptPattern<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 避免src形式的表达式</span>
            value <span class="token operator">=</span> srcPattern1<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            value <span class="token operator">=</span> srcPattern2<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 删除单个的 &lt;/script&gt; 标签</span>
            value <span class="token operator">=</span> scriptPattern2<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 删除单个的&lt;script ...&gt; 标签</span>
            value <span class="token operator">=</span> scriptPattern3<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 避免 eval(...) 形式表达式</span>
            value <span class="token operator">=</span> evalPattern<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 避免 expression(...) 表达式</span>
            value <span class="token operator">=</span> expressionPattern<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 避免 javascript: 表达式</span>
            value <span class="token operator">=</span> javascriptPattern<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 避免 vbscript: 表达式</span>
            value <span class="token operator">=</span> vbScriptPattern<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 避免 οnlοad= 表达式</span>
            value <span class="token operator">=</span> onloadPattern<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 避免 onXX= 表达式</span>
            value <span class="token operator">=</span> onPattern<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token comment">/**
 * host head漏洞
 *
 * @author : gumingjun
 * @date : 2021-07-09
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HostCleanFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     * host集合
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> hosts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 自定义实现host白名单添加
     *
     * @param filterConfig 过滤器配置
     * @throws ServletException
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">FilterConfig</span> filterConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">final</span> <span class="token class-name">String</span> hostsStr <span class="token operator">=</span> filterConfig<span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span><span class="token string">"hosts"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>hostsStr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hostArr <span class="token operator">=</span> hostsStr<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> host <span class="token operator">:</span> hostArr<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                hosts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>host<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> servletRequest<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> servletResponse<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> filterChain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">HttpServletRequest</span> request <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">)</span> servletRequest<span class="token punctuation">;</span>
        <span class="token class-name">HttpServletResponse</span> response <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">)</span> servletResponse<span class="token punctuation">;</span>
        <span class="token class-name">String</span> host <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">"Host"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"Host-debug:"</span> <span class="token operator">+</span> host<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>host<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">checkBlankList</span><span class="token punctuation">(</span>host<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                filterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>servletRequest<span class="token punctuation">,</span> servletResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"host deny"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                response<span class="token punctuation">.</span><span class="token function">flushBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            filterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>servletRequest<span class="token punctuation">,</span> servletResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 校验当前host是否在白名单中
     *
     * @param host host
     * @return 是否包含在hosts允许的范围内
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">checkBlankList</span><span class="token punctuation">(</span><span class="token class-name">String</span> host<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 访问白名单</span>
        <span class="token comment">// 127.0.0.1:8080就不能访问</span>
        <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hostSplit <span class="token operator">=</span> host<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> hosts<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>hostSplit<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h3><a id="2_Jsoup_445"></a>2 Jsoup方式</h3> 
<h4><a id="21_jar_446"></a>2.1 引入jar</h4> 
<pre><code class="prism language-groovy">implementation <span class="token string">'org.jsoup:jsoup:1.13.1'</span>
</code></pre> 
<h4><a id="23_451"></a>2.3使用方式</h4> 
<pre><code class="prism language-java"><span class="token comment">//详见：XssHttpServletRequestWrapper 类</span>
<span class="token class-name">Jsoup</span><span class="token punctuation">.</span><span class="token function">clean</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Whitelist</span><span class="token punctuation">.</span><span class="token function">relaxed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="NginxXSS_457"></a>二、使用Nginx处理XSS漏洞问题</h2> 
<h3><a id="1__nginx__458"></a>1 修改 nginx 配置</h3> 
<p>在 nginx.conf 配置文件中，增加如下配置内容：</p> 
<pre><code class="prism language-nginx">add_header X-XSS-Protection "1; mode=block";
</code></pre> 
<p>X-XSS-Protection 的字段有三个可选配置值，说明如下：</p> 
<table><thead><tr><th>参数值</th><th>描述</th></tr></thead><tbody><tr><td><code>0</code></td><td>表示关闭浏览器的XSS防护机制</td></tr><tr><td><code>1</code></td><td>删除检测到的恶意代码， 如果响应报文中没有看到X-XSS-Protection 字段，<br>那么浏览器就认为X-XSS-Protection配置为1，这是浏览器的默认设置</td></tr><tr><td><code>1; mode=block</code></td><td>如果检测到恶意代码，则不渲染恶意代码</td></tr></tbody></table> 
<p><img src="https://images2.imgbox.com/a1/29/SJYkLfid_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_nginx_471"></a>2 重启nginx</h3> 
<pre><code class="prism language-shell">systemctl restart nginx
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7792abe97e6b83930844e4254981d961/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ResponseCode响应状态码</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b36269ef621315e8a92e70c24a93fab6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL insert into添加数据并返回该条数据的id的方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>