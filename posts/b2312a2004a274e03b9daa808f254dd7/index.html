<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Windows系统安装WSL，并安装docker服务 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Windows系统安装WSL，并安装docker服务" />
<meta property="og:description" content="背景 因为工作需要，要在电脑上执行sh脚本，并启动docker服务执行具体逻辑。因为我的电脑是windows系统，对做本任务来说，比较吃力，所以想到使用wsl，让windows电脑具有linux电脑的能力。
什么是 WSL 2 WSL 2 是适用于 Linux 的 Windows 子系统体系结构的一个新版本，它支持适用于 Linux 的 Windows 子系统在 Windows 上运行 ELF64 Linux 二进制文件。 它的主要目标是提高文件系统性能，以及添加完全的系统调用兼容性。
这一新的体系结构改变了这些 Linux 二进制文件与Windows 和计算机硬件进行交互的方式，但仍然提供与 WSL 1（当前广泛可用的版本）中相同的用户体验。
单个 Linux 分发版可以在 WSL 1 或 WSL 2 体系结构中运行。 每个分发版可随时升级或降级，并且你可以并行运行 WSL 1 和 WSL 2 分发版。 WSL 2 使用全新的体系结构，该体系结构受益于运行真正的 Linux 内核。
操作步骤： 1、开启windows上的wsl能力
命令行方式：
打开 PowerShell 并运行：
启用“适用于 Linux 的 Windows 子系统”可选功能
dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart 启用“虚拟机平台”可选功能。
dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart windows界面形式（win10系统）" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/b2312a2004a274e03b9daa808f254dd7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-14T19:58:04+08:00" />
<meta property="article:modified_time" content="2023-04-14T19:58:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Windows系统安装WSL，并安装docker服务</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>背景</h4> 
<p>因为工作需要，要在电脑上执行sh脚本，并启动docker服务执行具体逻辑。因为我的电脑是windows系统，对做本任务来说，比较吃力，所以想到使用wsl，让windows电脑具有linux电脑的能力。</p> 
<p></p> 
<h4>什么是 WSL 2</h4> 
<p><br> WSL 2 是适用于 Linux 的 Windows 子系统体系结构的一个新版本，它支持适用于 Linux 的 Windows 子系统在 Windows 上运行 ELF64 Linux 二进制文件。 它的主要目标是提高文件系统性能，以及添加完全的系统调用兼容性。</p> 
<p>这一新的体系结构改变了这些 Linux 二进制文件与Windows 和计算机硬件进行交互的方式，但仍然提供与 WSL 1（当前广泛可用的版本）中相同的用户体验。</p> 
<p>单个 Linux 分发版可以在 WSL 1 或 WSL 2 体系结构中运行。 每个分发版可随时升级或降级，并且你可以并行运行 WSL 1 和 WSL 2 分发版。 WSL 2 使用全新的体系结构，该体系结构受益于运行真正的 Linux 内核。<br>  </p> 
<h4>操作步骤：</h4> 
<p><strong>1、开启windows上的wsl能力</strong></p> 
<p>命令行方式：</p> 
<p>打开 PowerShell 并运行：</p> 
<p>启用“适用于 Linux 的 Windows 子系统”可选功能</p> 
<pre><code>dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart</code></pre> 
<p>启用“虚拟机平台”可选功能。</p> 
<pre><code>dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart</code></pre> 
<p>windows界面形式（win10系统）</p> 
<p>依次执行：开始》设置》应用》可选功能》更多Windows功能</p> 
<p><img alt="" height="660" src="https://images2.imgbox.com/ce/fc/TEy9pVcH_o.png" width="925"></p> 
<p> <img alt="" height="501" src="https://images2.imgbox.com/67/d9/0p9UNhEA_o.png" width="1200"></p> 
<p> </p> 
<p><img alt="" height="400" src="https://images2.imgbox.com/40/65/eoYzFiN7_o.png" width="429"></p> 
<p> 下面这一项我也打开了，没有去验证不开启是否有影响，因为安装的时候比较费力，所以没有再去验证</p> 
<p><img alt="" height="400" src="https://images2.imgbox.com/a7/79/Jgu0XN6U_o.png" width="429"></p> 
<p><strong> 2、Microsoft store安装wsl</strong></p> 
<p>第一次尝试是从Microsoft store中安装的，但是因为尝试多次也没有办法从WSL1切换到WSL2，所以后面又从命令行安装的，目前回想一下当时的安装过程，因该是修改了第1步的配置后，没有重启电脑导致的（使用命令行模式修改的配置，用图形界面修改配置的时候，会提示重启电脑的）</p> 
<p>（1）检查当前电脑上安装的wsl</p> 
<p>命令行执行：</p> 
<pre><code class="hljs">wsl  -l -v   </code></pre> 
<p>--查看当前电脑上的子系统</p> 
<p><img alt="" height="94" src="https://images2.imgbox.com/a5/79/xSjuOysX_o.png" width="552"></p> 
<p>version处为2就表示WSL2，为1就表示WSL1</p> 
<p>（2）打开Microsoft store</p> 
<p><img alt="" height="1040" src="https://images2.imgbox.com/32/59/IR6aiNxT_o.png" width="1200"></p> 
<p>因为要安装ubuntu版本，本处选了ubuntu20.04版本 </p> 
<p> <img alt="" height="1040" src="https://images2.imgbox.com/3d/fa/DUSRa0K1_o.png" width="1200"></p> 
<p>点击安装按钮就可以进行安装</p> 
<p> 安装界面具有迷惑性，会一直停留在如下界面</p> 
<p><img alt="" height="74" src="https://images2.imgbox.com/71/c9/N7FsPMd5_o.png" width="1200"></p> 
<p> 其实过个几分钟，在这个页面敲几下键盘就可以，否则会一直不往下执行，我就在这个页面等了半个小时，以为下载比较慢呢，坑</p> 
<p><img alt="" height="241" src="https://images2.imgbox.com/f6/79/iyYr98iv_o.png" width="1200"></p> 
<p> 输入账号和密码就行了</p> 
<p>进去之后，就可以使用sudo su -命令，输入当前用户的密码，切换到root用户</p> 
<p>（3）版本检查</p> 
<p>此时到命令行界面再敲一次wsl -l -v命令，会发现当前版本是1，使用如下命令进行切换：</p> 
<pre><code class="hljs">wsl --set-version Ubuntu-20.04 2</code></pre> 
<p>其中Ubuntu-20.04就是使用wsl -l -v命令查到的name属性</p> 
<p>升级不成功的话，可以参考官方文档，先升级linux内核</p> 
<p><a href="https://learn.microsoft.com/zh-cn/windows/wsl/install-manual#step-4---download-the-linux-kernel-update-package" rel="nofollow" title="旧版 WSL 的手动安装步骤 | Microsoft Learn">旧版 WSL 的手动安装步骤 | Microsoft Learn</a></p> 
<p>（4）访问windows中目录</p> 
<p>在WSL中，可以使用<code>/mnt</code>目录来访问Windows的文件系统。例如，要访问Windows中的C盘，可以在WSL中使用<code>/mnt/c</code>路径。</p> 
<p><strong>3、通过wsl命令安装ubuntu</strong></p> 
<p>（1）查看可安装版本</p> 
<pre><code class="hljs">wsl --list --online</code></pre> 
<p><img alt="" height="776" src="https://images2.imgbox.com/d6/85/eleXfLs0_o.png" width="1200"></p> 
<p> （2）设置wsl默认安装版本</p> 
<pre><code class="hljs">wsl --set-default-version 2</code></pre> 
<p>（3）开始安装</p> 
<pre><code class="hljs">wsl --install -d Ubuntu20.04</code></pre> 
<p>（4）查看版本</p> 
<pre><code class="hljs">wsl -l -v</code></pre> 
<p>如果版本号不是2，则使用下方命令切换版本</p> 
<pre><code class="hljs">wsl --set-version Ubuntu-20.04 2</code></pre> 
<p><strong>4、安装docker</strong></p> 
<p>wsl安装完成后，就可以开始安装docker了，如下命令都是在wls的界面完成，不是windows的命令行界面</p> 
<p><img alt="" height="167" src="https://images2.imgbox.com/b6/29/bVmEN1fU_o.png" width="794"></p> 
<p> </p> 
<p>（1）添加Docker存储库</p> 
<p>Docker存储库包含Docker软件包，您需要将其添加到系统中。可以使用以下命令：</p> 
<pre><code class="hljs">sudo apt-get update
sudo apt-get install apt-transport-https ca-certificates curl gnupg-agent software-properties-common
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
</code></pre> 
<p>（2）安装Docker</p> 
<p>安装最新版本的Docker Engine和containerd。可以使用以下命令：</p> 
<pre><code class="hljs">sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io
</code></pre> 
<p>（3）验证Docker是否安装成功</p> 
<pre><code class="hljs">sudo docker run hello-world
</code></pre> 
<p>此处执行这个命令是会报错的，错误信息如下</p> 
<pre><code class="hljs">docker: Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?.
See 'docker run --help'.</code></pre> 
<p>原因是wsl2不支持systemctl命令，而是支持systemed命令</p> 
<p>所以需要执行如下命令先启动docker</p> 
<pre><code class="hljs">service docker start</code></pre> 
<p><strong>5、下载镜像</strong></p> 
<p>（1）登录镜像库</p> 
<p>先登录需要下载镜像的镜像库</p> 
<pre><code class="hljs">docker login -u username -p password 镜像库地址</code></pre> 
<p>（2）下载镜像</p> 
<p>执行docker pull命令即可</p> 
<p>6、启动和卸载</p> 
<p>至此，wsl2已经安装完毕，docker也已经安装上了，重启电脑后，可以从开始菜单启动wsl</p> 
<p><img alt="" height="316" src="https://images2.imgbox.com/64/34/Ce0L4tvG_o.png" width="639"></p> 
<p> 也可以像卸载普通软件一样，从应用和功能页卸载wsl</p> 
<p></p> 
<p>参考文档</p> 
<p><a href="https://blog.csdn.net/weixin_45027467/article/details/106862520" title="WSL使用史上最详细教程_勿忘VS初心的博客-CSDN博客">WSL使用史上最详细教程_勿忘VS初心的博客-CSDN博客</a></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/466afdc71dd0e3f6492e484c8a17f2c1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">uni-app 抖音小程序接入友盟数据统计</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/809bc9356aefd85b6a67a2bf2dc4260d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">1、传统神经网络和卷积神经网络</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>