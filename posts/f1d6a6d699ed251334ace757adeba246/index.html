<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Axios异步请求 &amp; json格式 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Axios异步请求 &amp; json格式" />
<meta property="og:description" content="Axios是Ajax的一个框架,简化Ajax操作。
需要axios.min.js 和vue.js的jar。
发送普通参数异步请求以及相应异常情况 客户端向服务器端异步发送普通参数值： - 基本格式： axios().then().catch() - 示例： axios({ // axios表示要发送一个异步请求 method : &#34;POST&#34;, //请求方式 url : &#34;....&#34;, // 发送地址(发给谁) params:{ //带的参数 uname:&#34;lina&#34;, pwd:&#34;ok&#34; } }) .then(function ( value ){ }) //成功响应时执行的回调 value.data可以获取到服务器响应容 .catch(function(reason){}); //有异常时执行的回调reason.response.data可以获取到响应的内容 reason.message / reason.stack 可以查看错误的信息 html代码
&lt;div id=&#34;div0&#34;&gt; uname:&lt;input type=&#34;text&#34; v-model=&#34;uname&#34;/&gt;&lt;br&gt; pwd:&lt;input type=&#34;text&#34; v-model=&#34;pwd&#34;/&gt;&lt;br&gt;&lt;br&gt; &lt;input type=&#34;button&#34; value=&#34;发送一个带普通请求参数值的异步请求&#34; @click=&#34;axios01&#34;&gt; &lt;/div&gt; Axios和vue
&lt;script language=&#34;JavaScript&#34; src=&#34;script/vue.js&#34;&gt;&lt;/script&gt; &lt;script language=&#34;JavaScript&#34; src=&#34;script/axios.min.js&#34;&gt;&lt;/script&gt; &lt;script language=&#34;JavaScript&#34;&gt; window.onload=function (){ var vue=new Vue({ el:&#39;#div0&#39;, data:{ uname:&#39;lina&#39;, pwd:&#39;true&#39; }, methods:{ // 标签里面定义了 @click=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/f1d6a6d699ed251334ace757adeba246/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-16T21:23:49+08:00" />
<meta property="article:modified_time" content="2023-02-16T21:23:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Axios异步请求 &amp; json格式</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <p style=""> Axios是Ajax的一个框架,简化Ajax操作。</p> 
 <p style=""><span class="kdocs-fontSize" style="font-size:13pt;"> 需要axios.min.js 和vue.js的jar。</span></p> 
 <h2 style="">发送普通参数异步请求以及相应异常情况</h2> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:1675px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:27.880596%;height:0;"> 
    <img src="https://images2.imgbox.com/8a/bb/W6voQchU_o.png" style="margin-left:;display:block;width:1675px;margin-top:-27.880596%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""></p> 
 <blockquote class="kdocs-blockquote" style="">
   客户端向服务器端异步发送普通参数值： 
  <br> - 基本格式： axios().then().catch() 
  <br> - 示例： 
  <br> axios({ // axios表示要发送一个异步请求 
  <br> method : "POST", //请求方式 
  <br> url : "....", // 发送地址(发给谁) 
  <br> params:{ //带的参数 
  <br> uname:"lina", 
  <br> pwd:"ok" 
  <br> } 
  <br> }) 
  <br> .then(function ( value ){ }) //成功响应时执行的回调 value.data可以获取到服务器响应容 
  <br> 
  <br> .catch(function(reason){}); //有异常时执行的回调reason.response.data可以获取到响应的内容 
  <br> reason.message / reason.stack 可以查看错误的信息 
 </blockquote> 
 <p style=""></p> 
 <p style=""><span class="kdocs-fontSize" style="font-size:13pt;"><span class="kdocs-bold" style="font-weight:bold;">html代码</span></span></p> 
 <pre class="kdocs-xml"><code class="language-xml">&lt;div id="div0"&gt;
    uname:&lt;input type="text" v-model="uname"/&gt;&lt;br&gt;
    pwd:&lt;input type="text" v-model="pwd"/&gt;&lt;br&gt;&lt;br&gt;
    &lt;input type="button" value="发送一个带普通请求参数值的异步请求" @click="axios01"&gt;
&lt;/div&gt;</code></pre> 
 <p style=""><span class="kdocs-fontSize" style="font-size:13pt;"><span class="kdocs-bold" style="font-weight:bold;">Axios和vue</span></span></p> 
 <pre class="kdocs-xml"><code class="language-xml">&lt;script language="JavaScript" src="script/vue.js"&gt;&lt;/script&gt;
    &lt;script language="JavaScript" src="script/axios.min.js"&gt;&lt;/script&gt;
    &lt;script language="JavaScript"&gt;
        window.onload=function (){
            var vue=new Vue({
                el:'#div0',
                data:{
                    uname:'lina',
                    pwd:'true'
                },
                methods:{
                //  标签里面定义了 @click="axios01"事件，所以缺个方法进行处理
                    axios01:function (){
                        axios({   // 表示将要给服务器端发送一个异步的请求
                            method:"POST",
                            url:"axios01.do",
                            params:{
                     // this已经进入方法function内部了，但是uname是vue里面的data的uname，所以要用vue
                                uname:vue.uname,
                                pwd:vue.pwd
                            }
                        })
                            .then(function (value) {    //成功响应的时候 (回调)
                            //    接收服务器端响应的数据
                                console.log(value)
                            })
                            .catch(function (reason){   //出问题的时候执行
                                console.log(reason)
                            })
                    }
                }
            });
        }
    &lt;/script&gt;</code></pre> 
 <blockquote class="kdocs-blockquote" style="">
   效果：所有请求参数都被放到URL地址后面了，哪怕我们现在用的是POST请求方式。 
 </blockquote> 
 <p style=""><span class="kdocs-fontSize" style="font-size:13pt;"><span class="kdocs-bold" style="font-weight:bold;">后端服务器代码</span></span></p> 
 <pre class="kdocs-java"><code class="language-java">@WebServlet("/axios01.do")
public class Axios01Servlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setCharacterEncoding("utf-8");
   // 获取参数
        String uname = request.getParameter("uname");
        String pwd = request.getParameter("pwd");
        System.out.println("uname="+uname);
        System.out.println("pwd="+pwd);

 response.setCharacterEncoding("utf-8");
 response.setContentType("text/html;charset=utf-8");
//        把两个值返回(响应)到客户端        
        PrintWriter out= response.getWriter(); //得到一个打印流
        out.write("uname="+uname+"pwd="+pwd); //返回给客户端

//        抛异常
        throw new NullPointerException("这里抛出空指针异常");
    }
}</code></pre> 
 <p style=""></p> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:15pt;"><span class="kdocs-bold" style="font-weight:bold;">axios程序接收到的响应对象结构</span></span></p> 
 <div style=""> 
  <table class="kdocs-table" border="1" cellpadding="1" cellspacing="1" style=""><tbody><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:369px;vertical-align:top;height:52px;"><p style=""><span class="kdocs-bold" style="font-weight:bold;">属性名</span></p></td><td class="kdocs-tableCell" style="width:369px;vertical-align:top;height:52px;"><p style=""><span class="kdocs-bold" style="font-weight:bold;">作用</span></p></td></tr><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:369px;vertical-align:top;height:52px;"><p style="">config</p></td><td class="kdocs-tableCell" style="width:369px;vertical-align:top;height:52px;"><p style="">调用axios(config对象)方法时传入的JSON对象</p></td></tr><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:369px;vertical-align:top;height:52px;"><p style="">data</p></td><td class="kdocs-tableCell" style="width:369px;vertical-align:top;height:52px;"><p style="">服务器端返回的响应体数据</p></td></tr><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:369px;vertical-align:top;height:52px;"><p style="">headers</p></td><td class="kdocs-tableCell" style="width:369px;vertical-align:top;height:52px;"><p style="">响应消息头</p></td></tr><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:369px;vertical-align:top;height:52px;"><p style="">request</p></td><td class="kdocs-tableCell" style="width:369px;vertical-align:top;height:52px;"><p style="">原生JavaScript执行Ajax操作时使用的XMLHttpRequest</p></td></tr><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:369px;vertical-align:top;height:52px;"><p style="">status</p></td><td class="kdocs-tableCell" style="width:369px;vertical-align:top;height:52px;"><p style="">响应状态码</p></td></tr><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:369px;vertical-align:top;height:52px;"><p style="">statusText</p></td><td class="kdocs-tableCell" style="width:369px;vertical-align:top;height:52px;"><p style="">响应状态码的说明文本</p></td></tr></tbody></table> 
 </div> 
 <p style=""></p> 
 <h2 style="">发送请求体为JSON格式</h2> 
 <p style=""> <span class="kdocs-fontSize" style="font-size:13pt;"> - 什么是JSON：JSON是一种数据格式</span></p> 
 <blockquote class="kdocs-blockquote" style="">
   例如：JSON格式表示两个学员信息的代码如下： 
  <br> [{sid:"s001",age:18},{sid:"s002",age:19}] 
 </blockquote> 
 <p style=""><span class="kdocs-fontSize" style="font-size:13pt;"><span class="kdocs-bold" style="font-weight:bold;">特点：</span> - JSON表达数据更简洁，更能够节约网络带宽</span></p> 
 <p style=""><span class="kdocs-fontSize" style="font-size:13pt;"> 客户端发送JSON格式的数据给服务器端:</span></p> 
 <blockquote class="kdocs-blockquote" style=""> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> 1) 客户端中params需要修改成： data:</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> 2) 服务器获取参数值不再是 request.getParameter()...</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> 而是：</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> StringBuffer stringBuffer = new StringBuffer("");</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> BufferedReader bufferedReader = request.getReader();</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> - 服务器端给客户端响应JSON格式的字符串，然后客户端需要将字符串</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> 转化成js Object 所需要的jar：gson 会把客户端发送来的json格式的</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> 数据封装到对象中。</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> Gson gson =new Gson();</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> - GSON有两个API</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> --可以把某个json的字符串转换为所指定的类型</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> gson.fromJson( json字符串,需要转换的类型)</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> --将java object转换成json字符串，这样才能响应给客户端</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> gson.toJson(java Object) </span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> -响应客户端为json的时候，要告诉客户端响应的内容是json格式数据</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> MIME-TYPE类型</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;">第一个参数给谁发请求response.setContentType("application/json;charset=utf-8");</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:9pt;"> </span> 
  <span class="kdocs-fontSize" style="font-size:13pt;">- 客户端中如果获取的是字符串："{}"</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> --js语言中 也有字符串和js对象之间互转的API</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> string JSON.stringify(object) object -&gt;string</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:13pt;"> object JSON.parse(string) string-&gt;object</span> 
 </blockquote> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:2142px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:40.522877%;height:0;"> 
    <img src="https://images2.imgbox.com/85/55/fjitKeAZ_o.png" style="margin-left:;display:block;width:2142px;margin-top:-40.522877%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""></p> 
 <p style=""><span class="kdocs-bold" style="font-weight:bold;">html代码</span></p> 
 <pre class="kdocs-xml"><code class="language-xml">&lt;div id="div0"&gt;
    uname:&lt;input type="text" v-model="uname"/&gt;&lt;br&gt;
    pwd:&lt;input type="text" v-model="pwd"/&gt;&lt;br&gt;&lt;br&gt;
    &lt;input type="button" value="发送一个带json格式的参数值的异步请求" @click="axios02"&gt;
&lt;/div&gt;</code></pre> 
 <p style=""><span class="kdocs-bold" style="font-weight:bold;">axios和vue代码</span></p> 
 <pre class="kdocs-xml"><code class="language-xml">&lt;script language="JavaScript" src="script/vue.js"&gt;&lt;/script&gt;
    &lt;script language="JavaScript" src="script/axios.min.js"&gt;&lt;/script&gt;
    &lt;script language="JavaScript"&gt;
        window.onload=function (){
            var vue=new Vue({
                el:'#div0',
                data:{
                    uname:'lina',
                    pwd:'ok'
                },
                methods:{
                //  标签里面定义了 @click="axios01"事件，所以缺个方法进行处理
                    axios02:function (){
                        axios({   // 表示将要给服务器端发送一个异步的请求
                            method:"POST",
                            url:"axios02.do",
                            data:{ //用json格式就要把params转换为data
                                uname:vue.uname,
                                pwd:vue.pwd
                            }
                        })
                            .then(function (value) {    //成功响应的时候 (回调)
                            //    接收服务器端响应的数据进行解析
                                var data=value.data;
                                // console.log(data)
                                //data对应的数据：
                                //{uname:"lina",pwd:"123"}

                                // 一点击输入框的值就改变
                                vue.uname=data.uname;
                                vue.pwd=data.pwd;
                            //    此处value中的data返回的是js object，因此可以直接点出属性
                            //    如果获取的是字符串："{}"
                            //    js语言中 也有字符串和js对象之间互转的API
                            //    string JSON.stringify(object)   object -&gt;string
                            //     object JSON.parse(string)      string-&gt;object
                            })
                            .catch(function (reason){   //出问题的时候执行
                                console.log(reason)
                            })
                    }
                }
            });
        }
    &lt;/script&gt;</code></pre> 
 <p style=""><span class="kdocs-bold" style="font-weight:bold;">服务器端代码</span></p> 
 <pre class="kdocs-java"><code class="language-java">@WebServlet("/axios02.do")
public class Axios01Servlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
//        1.获取客户端发送过来的参数
//    获取请求流    BufferedReader：带一个缓冲的字符流  Reader：字符流
        BufferedReader reader = request.getReader();
//        准备一个StringBuffer
        StringBuffer stringBuffer=new StringBuffer();
//        从流里面读数据
//        准备临时字符串
        String str=null;
//        判断如果读到数据了，就可以往一个 StringBuffer追加
        while ((str=reader.readLine())!=null){
            stringBuffer.append(str);
            str=stringBuffer.toString();  //     得到客户端传过来的json格式的字符串
//            需要转换成JavaObject(封装到java对象中)  比如要注册功能，string转换为User，在调用UserDao保存数据库
//             Gson有两个API
//            1. fromJson(string,T) 将字符串转换成java object
//            2. toJson(java Object) 将java object转化成json字符串，这样才能响应给客户端
            Gson gson=new Gson();
            User user = gson.fromJson(str, User.class);
            System.out.print(user);
//         转换后 打印的是tostring类型  User{uname='lina', pwd='true'}

//        2.    响应给客户端
//            假设user是从数据库查询出来的，现在需要将其转换成json格式的字符串，然后响应给客户端
            user.setUname("a");
            user.setPwd("123");

            String userJsonStr = gson.toJson(user);
            response.setCharacterEncoding("UTF-8");
//      响应给客户端之前，要告诉客户端响应的内容是json格式的数据 所以叫做 MIME-type
//            response.setContentType("text/html;charset=utf-8");  //之前的
     response.setContentType("application/json;charset=utf-8"); //现在的表示发送的是应用程序的json
            response.getWriter().write(userJsonStr);
        }
    }
}</code></pre> 
 <p style=""></p> 
 <h2 style="">优化Axios</h2> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p> get方式：一般使用params才用get，因为get方式没有请求体，直接把数据拼接到地址url后</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>post方式：有请求体 data方式传输，以json格式发送请求参数，</p></li></ul> 
 <p style=""> 请求参数会被保存到请求报文的请求体传输到服务器。</p> 
 <pre class="kdocs-xml"><code class="language-xml">         methods:{
            testAjax(){
                axios.post(
                    "/SpringMVC/test/ajax?id=1001",  //后面拼接普通的请求参数
                    {username:"admin",password:"123456"}  //json格式参数
                ).then(response=&gt;{            //response 封装了服务器响应回来的结果
                    console.log(response.data)
                });
            }
        }</code></pre> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/add0b8165d176594ad0fda84148c3ca8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">树莓派安装MQTT服务</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c8a199062e1954c991f33235b224ad7d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Java】死锁</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>