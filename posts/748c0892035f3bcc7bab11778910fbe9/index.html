<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>欲与天公试比高：决策树算法及实现 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="欲与天公试比高：决策树算法及实现" />
<meta property="og:description" content="恭贺我国神舟十二号载人飞船成功发射！数风流人物，还看今朝！！！
emsp;老规矩，决策树的数学推导部分再次不在赘述，因为决策树是一种非常直观的算法。其中需要注意的地方是特征选择，涉及到了信息增益。算法的描述如下图：
但是在具体的实现过程中是有一内内难度的。关键是在于数据集的处理，我们仍用Mnist数据集的话，它有28*28=784个特征，但是选择一个特征后，我们如何对数据进行划分？比如选择了第一个特征，此特征下的数据取值为0~255，那我们如何划分？二分？还是三分？四分？或者第一个特征二分，第二个特征三分，或者其他的自由组合。所以这是一个挠头问题，极有可能发生过拟合。本次我们姑且选择二分，即大于128的化为一类，小于128的化为一类。
import numpy as np from math import log import time def make_data_set(file): f=open(file) data_set=[] for line in f: value=line.split(&#39;,&#39;) tempt_list=list(map(int,value)) data_set.append(tempt_list) f.close() return data_set def tran_data(data_set): for line in data_set: for i in range(len(line)): if i==0: continue #因为第一个值是数据的标签 else: if line[i]&gt;=128: line[i]=1 #二分 else: line[i]=0 def pre_cut(train_data_set,test_data_set): train=np.array(train_data_set) test=np.array(test_data_set) for i in range(train.shape[1]): if i==0: continue temp=set(train[:,i]) if len(temp)==1: #对特征进行初步处理，因为如果测试集中某一特征值全为同一值，那么这个特征值对数据的划分是 #无任何价值的，直接删去该列特征值即可 train=np.delete(train,i,1) test=np.delete(test,i,1) return train.tolist(),test.tolist() def cal_shann(train_data_set): pro=[0,0,0,0,0,0,0,0,0,0] entropy=0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/748c0892035f3bcc7bab11778910fbe9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-18T21:10:37+08:00" />
<meta property="article:modified_time" content="2021-06-18T21:10:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">欲与天公试比高：决策树算法及实现</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>恭贺我国神舟十二号载人飞船成功发射！数风流人物，还看今朝！！！</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/49/36/NuZP6nge_o.jpg" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/fd/c3/LfNIHgRy_o.jpg" alt="在这里插入图片描述"></p> 
<p>emsp;老规矩，决策树的数学推导部分再次不在赘述，因为决策树是一种非常直观的算法。其中需要注意的地方是特征选择，涉及到了信息增益。算法的描述如下图：<br> <img src="https://images2.imgbox.com/66/c7/3jweZ3QU_o.jpg" alt="在这里插入图片描述"><br>  但是在具体的实现过程中是有一内内难度的。关键是在于数据集的处理，我们仍用Mnist数据集的话，它有28*28=784个特征，但是选择一个特征后，我们如何对数据进行划分？比如选择了第一个特征，此特征下的数据取值为0~255，那我们如何划分？二分？还是三分？四分？或者第一个特征二分，第二个特征三分，或者其他的自由组合。所以这是一个挠头问题，极有可能发生过拟合。本次我们姑且选择二分，即大于128的化为一类，小于128的化为一类。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> math <span class="token keyword">import</span> log
<span class="token keyword">import</span> time
<span class="token keyword">def</span> <span class="token function">make_data_set</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    f<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
    data_set<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>
        value<span class="token operator">=</span>line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
        tempt_list<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
        data_set<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tempt_list<span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> data_set
<span class="token keyword">def</span> <span class="token function">tran_data</span><span class="token punctuation">(</span>data_set<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> data_set<span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
                <span class="token comment">#因为第一个值是数据的标签</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> line<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&gt;=</span><span class="token number">128</span><span class="token punctuation">:</span>
                    line<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>
                    <span class="token comment">#二分</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    line<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">def</span> <span class="token function">pre_cut</span><span class="token punctuation">(</span>train_data_set<span class="token punctuation">,</span>test_data_set<span class="token punctuation">)</span><span class="token punctuation">:</span>
    train<span class="token operator">=</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>train_data_set<span class="token punctuation">)</span>
    test<span class="token operator">=</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>test_data_set<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
        temp<span class="token operator">=</span><span class="token builtin">set</span><span class="token punctuation">(</span>train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token comment">#对特征进行初步处理，因为如果测试集中某一特征值全为同一值，那么这个特征值对数据的划分是</span>
            <span class="token comment">#无任何价值的，直接删去该列特征值即可</span>
            train<span class="token operator">=</span>np<span class="token punctuation">.</span>delete<span class="token punctuation">(</span>train<span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
            test<span class="token operator">=</span>np<span class="token punctuation">.</span>delete<span class="token punctuation">(</span>test<span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> train<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>test<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">cal_shann</span><span class="token punctuation">(</span>train_data_set<span class="token punctuation">)</span><span class="token punctuation">:</span>
    pro<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
    entropy<span class="token operator">=</span><span class="token number">0.0</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>train_data_set<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">0</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> train_data_set<span class="token punctuation">:</span>
        pro<span class="token punctuation">[</span>line<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        prob<span class="token operator">=</span>pro<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>train_data_set<span class="token punctuation">)</span>
        <span class="token keyword">if</span> prob<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>
            entropy<span class="token operator">-=</span>prob<span class="token operator">*</span>log<span class="token punctuation">(</span>prob<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> entropy
<span class="token keyword">def</span> <span class="token function">split_data_set</span><span class="token punctuation">(</span>train_data_set<span class="token punctuation">,</span>axis<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#axix是第几个特征，value是该特征对应的特征值</span>
    split_data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> train_data_set<span class="token punctuation">:</span>
        <span class="token keyword">if</span> line<span class="token punctuation">[</span>axis<span class="token punctuation">]</span><span class="token operator">==</span>value<span class="token punctuation">:</span>
            reduced<span class="token operator">=</span>line<span class="token punctuation">[</span><span class="token punctuation">:</span>axis<span class="token punctuation">]</span>
            reduced<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>line<span class="token punctuation">[</span>axis<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            split_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>reduced<span class="token punctuation">)</span>
    <span class="token keyword">return</span> split_data
    <span class="token comment">#注意：其可能返回空的列表，因为可能数据集中某一项特征值均为1或0，导致if后的语句无法执行</span>
    
<span class="token keyword">def</span> <span class="token function">chose_best_feature</span><span class="token punctuation">(</span>data_set<span class="token punctuation">)</span><span class="token punctuation">:</span>
    base_entropy<span class="token operator">=</span>cal_shann<span class="token punctuation">(</span>data_set<span class="token punctuation">)</span>
    best_info<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_set<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
            <span class="token comment">#因为第一个值是数据的标签</span>
        new_entropy<span class="token operator">=</span><span class="token number">0</span>
        <span class="token keyword">for</span> value <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sub_data_set<span class="token operator">=</span>split_data_set<span class="token punctuation">(</span>data_set<span class="token punctuation">,</span>i<span class="token punctuation">,</span>value<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data_set<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            prob<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>sub_data_set<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_set<span class="token punctuation">)</span>
            new_entropy<span class="token operator">+=</span>cal_shann<span class="token punctuation">(</span>sub_data_set<span class="token punctuation">)</span>
            info<span class="token operator">=</span>base_entropy<span class="token operator">-</span>new_entropy
            <span class="token keyword">if</span> info <span class="token operator">&gt;</span> best_info<span class="token punctuation">:</span>
                best_info<span class="token operator">=</span>info
                best_feature<span class="token operator">=</span>i
    <span class="token keyword">return</span> best_feature<span class="token punctuation">,</span>best_info
    <span class="token comment">#返回最优的特征，和对应的信息增益</span>
<span class="token keyword">def</span> <span class="token function">get_label</span><span class="token punctuation">(</span>label_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    number<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span>  i <span class="token keyword">in</span> label_list<span class="token punctuation">:</span>
        number<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+=</span><span class="token number">1</span>
    <span class="token keyword">return</span> number<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">#投票表决，哪一类别的最多，则该集合数据就属于那一类</span>
<span class="token keyword">def</span> <span class="token function">creat_tree</span><span class="token punctuation">(</span>data_set<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data_set<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">233</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> 
    ep <span class="token operator">=</span> <span class="token number">0.1</span>
    <span class="token comment">#设置信息增益的阈值</span>
    class_list<span class="token operator">=</span><span class="token punctuation">[</span>line<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> line <span class="token keyword">in</span> data_set<span class="token punctuation">]</span>
    <span class="token keyword">if</span> class_list<span class="token punctuation">.</span>count<span class="token punctuation">(</span>class_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token builtin">len</span><span class="token punctuation">(</span>class_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> class_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token comment">#说明该列表中均是同一类别的数据，则返回该类别</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data_set<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> get_label<span class="token punctuation">(</span>class_list<span class="token punctuation">)</span>
        <span class="token comment">#特征选完了，只剩标签了，则投票表决</span>
    best_feature<span class="token punctuation">,</span>best_info<span class="token operator">=</span>chose_best_feature<span class="token punctuation">(</span>data_set<span class="token punctuation">)</span>
    <span class="token keyword">if</span> best_info <span class="token operator">&lt;</span> ep<span class="token punctuation">:</span>
        <span class="token keyword">return</span> get_label<span class="token punctuation">(</span>class_list<span class="token punctuation">)</span>
    my_tree<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>best_feature<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token comment">#建立字典树</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>split_data_set<span class="token punctuation">(</span>data_set<span class="token punctuation">,</span> best_feature<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>      
        my_tree<span class="token punctuation">[</span>best_feature<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> creat_tree<span class="token punctuation">(</span>split_data_set<span class="token punctuation">(</span>data_set<span class="token punctuation">,</span> best_feature<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>split_data_set<span class="token punctuation">(</span>data_set<span class="token punctuation">,</span> best_feature<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>
        my_tree<span class="token punctuation">[</span>best_feature<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> creat_tree<span class="token punctuation">(</span>split_data_set<span class="token punctuation">(</span>data_set<span class="token punctuation">,</span> best_feature<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> my_tree
<span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>test_data_per_row<span class="token punctuation">,</span>tree<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#注意是切出测试数据集中的一行来预测</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">=</span>tree<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>tree<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__name__ <span class="token operator">==</span> <span class="token string">'dict'</span><span class="token punctuation">:</span>
            feature_data<span class="token operator">=</span>test_data_per_row<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
            <span class="token comment">#得到该特征所对应的特征值</span>
            <span class="token keyword">del</span> test_data_per_row<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
            <span class="token keyword">if</span> feature_data <span class="token operator">not</span> <span class="token keyword">in</span> value<span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token number">11</span>
                <span class="token comment">#如果该特征值不在测试集生成的树中，那么直接判为0~9之外的数，相当于直接判为错误</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                tree <span class="token operator">=</span> value<span class="token punctuation">[</span>feature_data<span class="token punctuation">]</span>
            <span class="token comment">#选择该特征值对应的子树</span>
            <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">.</span>__name__ <span class="token operator">==</span> <span class="token string">'int'</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> tree
                <span class="token comment">#返回分类值</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> value
            <span class="token comment">#返回分类值</span>

<span class="token keyword">def</span> <span class="token function">cal_accuracy</span><span class="token punctuation">(</span>test_data_set<span class="token punctuation">,</span>tree<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cnt<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> test_data_set<span class="token punctuation">:</span>
        <span class="token keyword">if</span> line<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span>predict<span class="token punctuation">(</span>line<span class="token punctuation">,</span>tree<span class="token punctuation">)</span><span class="token punctuation">:</span>
            cnt<span class="token operator">+=</span><span class="token number">1</span>
    <span class="token keyword">return</span> cnt<span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>test_data_set<span class="token punctuation">)</span>
    
start<span class="token operator">=</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
train_data_set<span class="token operator">=</span>make_data_set<span class="token punctuation">(</span><span class="token string">'D:\\bpnetwork\\mnist_train.csv'</span><span class="token punctuation">)</span>
test_data_set<span class="token operator">=</span>make_data_set<span class="token punctuation">(</span><span class="token string">'D:\\bpnetwork\\mnist_test.csv'</span><span class="token punctuation">)</span>  
tran_data<span class="token punctuation">(</span>train_data_set<span class="token punctuation">)</span>
tran_data<span class="token punctuation">(</span>test_data_set<span class="token punctuation">)</span>
train_data_set<span class="token punctuation">,</span>test_data_set<span class="token operator">=</span>pre_cut<span class="token punctuation">(</span>train_data_set<span class="token punctuation">,</span>test_data_set<span class="token punctuation">)</span>
tree<span class="token operator">=</span>creat_tree<span class="token punctuation">(</span>train_data_set<span class="token punctuation">)</span>
accuracy<span class="token operator">=</span>cal_accuracy<span class="token punctuation">(</span>test_data_set<span class="token punctuation">,</span>tree<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'the accuracy :'</span><span class="token punctuation">,</span>accuracy<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'the time'</span><span class="token punctuation">,</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start<span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/22/17/u6cAHXuD_o.png" alt="在这里插入图片描述"><br>  debug好几天，感觉怪怪的，该算法还有极大的改进空间，留着后面慢慢优化。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9c37765fb5a0d60b53f4531290026cd1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">利用 Transformer 网络建立预测模型</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0237e21bdc568857a24e98e55ad194ee/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL数据库死锁的产生原因及解决方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>