<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>el-table横纵向滚动条固定在可视屏幕内，并自适应分辨率 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="el-table横纵向滚动条固定在可视屏幕内，并自适应分辨率" />
<meta property="og:description" content="提示：vue2 &#43; elementUi（适用于table不使用fixed固定列，否则会错位，修复错位方法在下篇)
前言 需求：在使用el-table中，当每页数据过多时浏览器会自动产生纵向滚动条，拖动后表头也看不到了，当表头过长后，也会产生横向滚动条，但是横向滚动条固定在table最底部，不利于操作。
思路：利用自定义指令中的el找出table的dom元素，获取到视窗总高度，获取到table离视窗上面的高度，获取到指令中回传想设置的离底部的高度，计算后获得table高度，并设置css，再通过resize监听动态获取高度，设置高度。
一、使用步骤 1. 在src下面创建一个directive文件夹，再创建index.js和tableHeight.js tableHeight.js 代码如下：
import { addResizeListener, removeResizeListener } from &#39;element-ui/src/utils/resize-event&#39; // 设置表格高度 const doResize = async (el, binding, vnode) =&gt; { // 获取表格Dom对象 const { componentInstance: $table } = await vnode // 获取调用传递过来的数据 const { value } = binding // if (!$table.height) { // throw new Error(`el-$table must set the height. Such as height=&#39;100px&#39;`) // } // console.log($table, &#39;$table$table$table$table&#39;) // 获取距底部距离（用于展示页码等信息） const bottomOffset = (value &amp;&amp; value." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/7b2c2ef0a85b0d574b659c259be78ff7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-09T20:14:42+08:00" />
<meta property="article:modified_time" content="2023-03-09T20:14:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">el-table横纵向滚动条固定在可视屏幕内，并自适应分辨率</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p>提示：vue2 + elementUi（<span style="color:#fe2c24;">适用于table不使用fixed固定列，否则会错位，修复错位方法在下篇</span>)</p> 
</blockquote> 
<p></p> 
<hr> 
<h2><a id="_7"></a>前言</h2> 
<p>需求：在使用el-table中，当每页数据过多时浏览器会自动产生纵向滚动条，拖动后表头也看不到了，当表头过长后，也会产生横向滚动条，但是横向滚动条固定在table最底部，不利于操作。</p> 
<p>思路：利用自定义指令中的el找出table的dom元素，获取到视窗总高度，获取到table离视窗上面的高度，获取到指令中回传想设置的离底部的高度，计算后获得table高度，并设置css，再通过resize监听动态获取高度，设置高度。</p> 
<hr> 
<p></p> 
<h2><a id="pandas_16"></a>一、使用步骤</h2> 
<h3><a id="1_20"></a>1. 在src下面创建一个directive文件夹，再创建index.js和tableHeight.js</h3> 
<p>tableHeight.js 代码如下：</p> 
<pre><code class="language-c language-javascript">import {
    addResizeListener,
    removeResizeListener
} from 'element-ui/src/utils/resize-event'

// 设置表格高度
const doResize = async (el, binding, vnode) =&gt; {
    // 获取表格Dom对象
    const {
        componentInstance: $table
    } = await vnode
    // 获取调用传递过来的数据
    const {
        value
    } = binding
    // if (!$table.height) {
    //   throw new Error(`el-$table must set the height. Such as height='100px'`)
    // }
    // console.log($table, '$table$table$table$table')
    // 获取距底部距离（用于展示页码等信息）
    const bottomOffset = (value &amp;&amp; value.bottomOffset) || 30
    if (!$table) return
    // 计算列表高度并设置
    const height = window.innerHeight - el.getBoundingClientRect().top - bottomOffset
    // $table.layout.setMaxHeight(height)
    // $table.layout.setHeight(height)  //头部和底部滚动条不会固定

    //头部和底部顿滚动条会固定但不适用于 使用了fixed固定列的table会错位
    let wrapper = Array.from(el.getElementsByClassName("el-table__body-wrapper"))
      if (wrapper &amp;&amp; wrapper.length) {
        wrapper[0].style.height = height + 'px'
        wrapper[0].style.overflow = 'auto'
      }

     $table.doLayout()
    }

export default {
    // 初始化设置
    bind(el, binding, vnode) {
        // 设置resize监听方法
        el.resizeListener = async () =&gt; {
            await doResize(el, binding, vnode)
        }
        // 绑定监听方法到addResizeListener
        addResizeListener(window.document.body, el.resizeListener)
    },
    // // 绑定默认高度
    async inserted(el, binding, vnode) {
        await doResize(el, binding, vnode)
    },
    // // 销毁时设置
    unbind(el) {
        // 移除resize监听
        removeResizeListener(el, el.resizeListener)
    }
}</code></pre> 
<h3><a id="2_34"></a></h3> 
<p>index.js 代码如下：</p> 
<pre><code class="language-javascript">import tableHeight from './tableHeight'

const install = function (Vue) {
    // 绑定v-adaptive指令
    Vue.directive('tableHeight', tableHeight)
}

if (window.Vue) {
    window['tableHeight'] = tableHeight
    // eslint-disable-next-line no-undef
    Vue.use(install)
}

tableHeight.install = install

export default tableHeight</code></pre> 
<p></p> 
<p>main.js 中注册指令：</p> 
<pre><code class="language-javascript">import tableHeight from '@/directive/index.js'
// 表格自适应指令
Vue.use(tableHeight)</code></pre> 
<p></p> 
<p>最后在el-table 中使用：</p> 
<pre><code class="language-javascript">  &lt;el-table :data="tableData" v-tableHeight="{bottomOffset: 150}"&gt;
     &lt;el-table-column prop="date" label="日期" width="180"&gt;&lt;/el-table-column&gt;
     &lt;el-table-column prop="name" label="姓名" width="180"&gt;&lt;/el-table-column&gt;
     &lt;el-table-column prop="address" label="地址"&gt;&lt;/el-table-column&gt;
     &lt;el-table-column prop="caozuo" label="操作"  fixed="right"&gt;&lt;/el-table-column&gt;
  &lt;/el-table&gt;</code></pre> 
<h2><a id="_45"></a></h2>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9f48551efacf95be0338e24268219503/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Visual Studio 2019 &#43; Qt 项目版本信息新增到资源以及通过代码读取资源存储的版本信息</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bb0dccb88a9a74fcb9de89e139f5439e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Qt C&#43;&#43; 判断文件夹或者文件是否存在的方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>