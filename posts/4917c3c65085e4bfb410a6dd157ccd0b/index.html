<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>springboot&#43;vue项目在国产机东方通部署详细教程！ - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="springboot&#43;vue项目在国产机东方通部署详细教程！" />
<meta property="og:description" content="文章目录 一、部署东方通TongWeb二、部署TongHttpServer三、springboot多模块后端打包四、vue前端打包（TongWeb部署）五、TongWeb部署（前后端一样） 一、部署东方通TongWeb 上传安装包：TongWeb7.0.4.9_Enterprise_Linux.tar.gz
解压：tar -xvf TongWeb7.0.4.9_Enterprise_Linux.tar.gz
证书：提供的license 文件是企业版的，企业版支持以 war 包方式部署应用。 解压后，将license.dat 放在安装的根目录下
进入bin目录启动：./startserverbg.sh
访问页面：http://ip:9060/console
ps：默认账号密码thanos/thanos123.com，首次登陆需要修改账号密码
二、部署TongHttpServer ps1：TongHttpServer实际上就是nginx在国产机上的替代品，除了名字意外，其他的原理跟nginx是一样的
pa2：nginx也可以直接部署在国产机上，且操作比部署linux上简单。即不需要安装gcc等插件，直接下载，解压，安装，编译即可！详情可见https://blog.csdn.net/weixin_40496191/article/details/121028500
由于我是拿linux验证的，国产机其实也差不多，我这里使用的安装包是：TongHttpServer_6.0.0.2_x86_64.tar.gz
解压：tar -xvf TongHttpServer_6.0.0.2_x86_64.tar.gz
将证书文件license.dat拷贝到TongHttpServer的解压文件夹里面
在THS/bin目录下，执行命令查看license信息：./start.sh -l
启动指令：./start.sh
停止指令：./start.sh stop
配置文件：/TongHttpServer/THS/conf/httpserver.conf
使用：跟nginx的使用方法一样。相关反向代理直接在httpserver.conf，然后重启TongHttpServer即可！
三、springboot多模块后端打包 需要改的配置
1）主要启动模块pom文件添加配置
&lt;packaging&gt;war&lt;/packaging&gt; 2）启动类添加SpringApplicationBuilder方法
@Override protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) { return builder.sources(WebApplication.class); } 剩下的就是解决bug
遇到的坑1：在filter过滤器引入变量的时候，使用@Value导致引入的变量都为null
ps：所有的filter类有涉及@Value的都要改，因为东方通中，filter加载在spring之前，都需要改成静态加载方式才能够读取到
public static String whiteUrl; @Value(&#34;${FormXssFilter.url}&#34;) public void setWhiteUrl(String whiteUrl) { FormXssFilter.whiteUrl=whiteUrl; } 遇到的坑2：遇到ZonedDate转换错误的，需要加下以下这个类
package com.ffcs.biyiict.config; import java.sql.*; import java.time.ZoneId; import java.time.ZonedDateTime; import java." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/4917c3c65085e4bfb410a6dd157ccd0b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-15T16:53:39+08:00" />
<meta property="article:modified_time" content="2023-12-15T16:53:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">springboot&#43;vue项目在国产机东方通部署详细教程！</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#TongWeb_1" rel="nofollow">一、部署东方通TongWeb</a></li><li><a href="#TongHttpServer_18" rel="nofollow">二、部署TongHttpServer</a></li><li><a href="#springboot_45" rel="nofollow">三、springboot多模块后端打包</a></li><li><a href="#vueTongWeb_265" rel="nofollow">四、vue前端打包（TongWeb部署）</a></li><li><a href="#TongWeb_284" rel="nofollow">五、TongWeb部署（前后端一样）</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="TongWeb_1"></a>一、部署东方通TongWeb</h3> 
<ol><li> <p>上传安装包：TongWeb7.0.4.9_Enterprise_Linux.tar.gz</p> </li><li> <p>解压：tar -xvf TongWeb7.0.4.9_Enterprise_Linux.tar.gz</p> </li><li> <p>证书：提供的license 文件是企业版的，企业版支持以 war 包方式部署应用。 解压后，将license.dat 放在安装的根目录下</p> </li><li> <p>进入bin目录启动：./startserverbg.sh</p> </li><li> <p>访问页面：http://ip:9060/console</p> <p>ps：默认账号密码thanos/thanos123.com，首次登陆需要修改账号密码</p> </li></ol> 
<p><img src="https://images2.imgbox.com/94/09/pg3Rxdzn_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="TongHttpServer_18"></a>二、部署TongHttpServer</h3> 
<p>ps1：TongHttpServer实际上就是nginx在国产机上的替代品，除了名字意外，其他的原理跟nginx是一样的</p> 
<p>pa2：nginx也可以直接部署在国产机上，且操作比部署linux上简单。即不需要安装gcc等插件，直接下载，解压，安装，编译即可！详情可见https://blog.csdn.net/weixin_40496191/article/details/121028500</p> 
<ol><li> <p>由于我是拿linux验证的，国产机其实也差不多，我这里使用的安装包是：TongHttpServer_6.0.0.2_x86_64.tar.gz</p> </li><li> <p>解压：tar -xvf TongHttpServer_6.0.0.2_x86_64.tar.gz</p> </li><li> <p>将证书文件license.dat拷贝到TongHttpServer的解压文件夹里面</p> </li><li> <p>在THS/bin目录下，执行命令查看license信息：./start.sh -l</p> <p><img src="https://images2.imgbox.com/d4/9f/ZN08DC2s_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-awITfevp-1692188867573)(C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230816202137909.png)]"></p> </li><li> <p>启动指令：./start.sh</p> </li><li> <p>停止指令：./start.sh stop</p> </li><li> <p>配置文件：/TongHttpServer/THS/conf/httpserver.conf</p> </li><li> <p>使用：跟nginx的使用方法一样。相关反向代理直接在httpserver.conf，然后重启TongHttpServer即可！</p> </li></ol> 
<h3><a id="springboot_45"></a>三、springboot多模块后端打包</h3> 
<ol><li> <p>需要改的配置</p> <p>1）主要启动模块pom文件添加配置</p> <pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>packaging<span class="token punctuation">&gt;</span></span>war<span class="token operator">&lt;</span><span class="token operator">/</span>packaging<span class="token operator">&gt;</span>
</code></pre> <p>2）启动类添加SpringApplicationBuilder方法</p> <pre><code class="prism language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token class-name">SpringApplicationBuilder</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">SpringApplicationBuilder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">sources</span><span class="token punctuation">(</span><span class="token class-name">WebApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <p>剩下的就是解决bug</p> </li><li> <p>遇到的坑1：在filter过滤器引入变量的时候，使用@Value导致引入的变量都为null</p> <p>ps：所有的filter类有涉及@Value的都要改，因为东方通中，filter加载在spring之前，都需要改成静态加载方式才能够读取到</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> whiteUrl<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${FormXssFilter.url}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setWhiteUrl</span><span class="token punctuation">(</span><span class="token class-name">String</span> whiteUrl<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   <span class="token class-name">FormXssFilter</span><span class="token punctuation">.</span>whiteUrl<span class="token operator">=</span>whiteUrl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>遇到的坑2：遇到ZonedDate转换错误的，需要加下以下这个类</p> <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ffcs<span class="token punctuation">.</span>biyiict<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">ZoneId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">ZonedDateTime</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span>format<span class="token punctuation">.</span></span><span class="token class-name">DateTimeFormatter</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>type<span class="token punctuation">.</span></span><span class="token class-name">BaseTypeHandler</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>type<span class="token punctuation">.</span></span><span class="token class-name">JdbcType</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span></span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>convert<span class="token punctuation">.</span>converter<span class="token punctuation">.</span></span><span class="token class-name">Converter</span></span><span class="token punctuation">;</span>
<span class="token comment">/**
 * String转ZonedDateTime，解决时间条件查询格式转换问题
 * @author lym
 *
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ZonedDateTimeConverter</span> <span class="token keyword">extends</span> <span class="token class-name">BaseTypeHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZonedDateTime</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>

	<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> log <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">ZonedDateTimeConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">ZonedDateTime</span><span class="token punctuation">&gt;</span></span> <span class="token function">zonedDateTimeConvert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">ZonedDateTime</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">ZonedDateTime</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">String</span> source<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            	<span class="token comment">/*根据需要修改时间格式与时区*/</span>
                <span class="token class-name">DateTimeFormatter</span> df <span class="token operator">=</span> <span class="token class-name">DateTimeFormatter</span>
                        <span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withZone</span><span class="token punctuation">(</span><span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">systemDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">ZonedDateTime</span> date <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                	date <span class="token operator">=</span> <span class="token class-name">ZonedDateTime</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> df<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withZoneSameInstant</span><span class="token punctuation">(</span><span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"UTC"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                	log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"can not convert ZonedDateTime to Date"</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> date<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNonNullParameter</span><span class="token punctuation">(</span><span class="token class-name">PreparedStatement</span> ps<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token class-name">ZonedDateTime</span> parameter<span class="token punctuation">,</span> <span class="token class-name">JdbcType</span> jdbcType<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 将 ZonedDateTime 转换为适当的数据库类型并设置参数</span>
        ps<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> parameter<span class="token punctuation">.</span><span class="token function">toLocalDateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ZonedDateTime</span> <span class="token function">getNullableResult</span><span class="token punctuation">(</span><span class="token class-name">ResultSet</span> rs<span class="token punctuation">,</span> <span class="token class-name">String</span> columnName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 从结果集中获取适当的数据库类型并转换为 ZonedDateTime</span>
        <span class="token class-name">Timestamp</span> value <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getTimestamp</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> value <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> value<span class="token punctuation">.</span><span class="token function">toLocalDateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">atZone</span><span class="token punctuation">(</span><span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">systemDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ZonedDateTime</span> <span class="token function">getNullableResult</span><span class="token punctuation">(</span><span class="token class-name">ResultSet</span> rs<span class="token punctuation">,</span> <span class="token keyword">int</span> columnIndex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Timestamp</span> value <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getTimestamp</span><span class="token punctuation">(</span>columnIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> value <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> value<span class="token punctuation">.</span><span class="token function">toLocalDateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">atZone</span><span class="token punctuation">(</span><span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">systemDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ZonedDateTime</span> <span class="token function">getNullableResult</span><span class="token punctuation">(</span><span class="token class-name">CallableStatement</span> cs<span class="token punctuation">,</span> <span class="token keyword">int</span> columnIndex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Timestamp</span> value <span class="token operator">=</span> cs<span class="token punctuation">.</span><span class="token function">getTimestamp</span><span class="token punctuation">(</span>columnIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> value <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> value<span class="token punctuation">.</span><span class="token function">toLocalDateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">atZone</span><span class="token punctuation">(</span><span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">systemDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>遇到的坑3：报错：Caused by:com.mysq1.cj . jdbc.exceptions ,Mysq1DataTruncation: Data truncation: Incorrect datetime value:‘ox. xDNxz0lxl5sr ox1.xlIjava. tiom …erlx2E5] oxe4 xEBA ×xl5 1YxBE2 xlNC x1.xoxpwkxl xlb6 xOlx0xO7xEElx09.xO1x7x03-0fFxlO \x’ for colu…</p> <p>ps：若是应用用到的库是 mysql 的，需要更改驱动的版本才用正常运行，原先的版本是8.0.22，改成8.0.30</p> <pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>mysql<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mysql<span class="token operator">-</span>connector<span class="token operator">-</span>java<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">8.0</span><span class="token number">.30</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> </li><li> <p>遇到的坑4：由于是多模块的，我的system模块重写了jar代码，主模块引入了system模块。发现，以jar的方式引入system模块，会导致重写的类失效</p> <p>1）修改system的pom，改成war打包方式，避免重写类无效</p> <pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>packaging<span class="token punctuation">&gt;</span></span>war<span class="token operator">&lt;</span><span class="token operator">/</span>packaging<span class="token operator">&gt;</span>
</code></pre> <p>2）非server模块的其他模块，有引用system模块的，统一加上provided，这样子打包的时候就不会打包system模块</p> <pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
     <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>xx<span class="token punctuation">.</span>xx<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
     <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>system<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
     <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.0</span><span class="token number">.0</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
     <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>provided<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> <p>3）修改主模块引入system的方式</p> <pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
       <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>xx<span class="token punctuation">.</span>xx<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>system<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.0</span><span class="token number">.0</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>type<span class="token punctuation">&gt;</span></span>war<span class="token operator">&lt;</span><span class="token operator">/</span>type<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>exclusions<span class="token punctuation">&gt;</span></span>
           <span class="token generics"><span class="token punctuation">&lt;</span>exclusion<span class="token punctuation">&gt;</span></span>
               <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span><span class="token operator">*</span><span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
           <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span><span class="token operator">*</span><span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
           <span class="token operator">&lt;</span><span class="token operator">/</span>exclusion<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>exclusions<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 添加 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>plugin<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>maven<span class="token punctuation">.</span>plugins<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>maven<span class="token operator">-</span>war<span class="token operator">-</span>plugin<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>configuration<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>overlays<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>overlay<span class="token punctuation">&gt;</span></span>
                 <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>xx<span class="token punctuation">.</span>xx<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
                 <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>system<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>overlay<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>overlays<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>plugin<span class="token operator">&gt;</span>
</code></pre> <p>4）打包的时候，system模块需要先install打一个jar包在target，再install打一个war包到target下，否则有可能报错类找不到</p> <p>5）然后全局package即可</p> <p>6）如果还是不行，可能是idea缓存问题，删除.dea文件，重新加载项目</p> </li><li> <p>遇到的坑5：项目里面的非pom管理的jar包，无法读取，需要在主模块的pom加上以下这串</p> <pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>plugin<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>maven<span class="token punctuation">.</span>plugins<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>maven<span class="token operator">-</span>dependency<span class="token operator">-</span>plugin<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>executions<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>execution<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>id<span class="token punctuation">&gt;</span></span>copy<span class="token operator">-</span>dependencies<span class="token operator">&lt;</span><span class="token operator">/</span>id<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>phase<span class="token punctuation">&gt;</span></span>compile<span class="token operator">&lt;</span><span class="token operator">/</span>phase<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>goals<span class="token punctuation">&gt;</span></span>
                <span class="token generics"><span class="token punctuation">&lt;</span>goal<span class="token punctuation">&gt;</span></span>copy<span class="token operator">-</span>dependencies<span class="token operator">&lt;</span><span class="token operator">/</span>goal<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>goals<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>configuration<span class="token punctuation">&gt;</span></span>
                <span class="token generics"><span class="token punctuation">&lt;</span>includeScope<span class="token punctuation">&gt;</span></span>system<span class="token operator">&lt;</span><span class="token operator">/</span>includeScope<span class="token operator">&gt;</span>
                <span class="token generics"><span class="token punctuation">&lt;</span>outputDirectory<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>project<span class="token punctuation">.</span>build<span class="token punctuation">.</span>directory<span class="token punctuation">}</span><span class="token operator">/</span>$<span class="token punctuation">{<!-- --></span>project<span class="token punctuation">.</span>build<span class="token punctuation">.</span>finalName<span class="token punctuation">}</span><span class="token operator">/</span><span class="token constant">WEB</span><span class="token operator">-</span><span class="token constant">INF</span><span class="token operator">/</span>lib<span class="token operator">&lt;</span><span class="token operator">/</span>outputDirectory<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>execution<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>executions<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>plugin<span class="token operator">&gt;</span>
</code></pre> </li><li> <p>遇到的坑6：存在一些写法，比如public static String xxx= env.getProperty(“xxx”);这种写法可能在java -jar启动的时候正常，但是放在东方通导致null。</p> <p>因为放入东方通后，spring的加载顺序发生了一些变化。导致env可能获取不到，所以触发了异常。这种情况有两种解决办法</p> <p>1）使用@value+static静态化加载yml环境变量参数</p> <p>2）如果只是暂时部署，最差的方法可以写死变量！<br> 注：如果是非yml配置文件参数，可以直接使用final修饰，这样子在编译成class文件时，就自动赋值变量了。</p> </li><li> <p>报错Request header is too large</p> <p>原因：springboot项目里面可能已经设置了max-http-header-size，并且没有报错，但是部署到东方通却报错了。这是因为我们springboot设置的这个参数是针对于springboot内置tomcat的，部署到东方通后将不再使用内置的tomcat，所以无效。</p> <p>正确的做法是在东方通界面上的"虚拟主机管理"和"HTTP通道管理"都配置以下两个参数即可</p> <pre><code class="prism language-java">maxPostSize			<span class="token operator">-</span><span class="token number">1</span>
maxHttpHeaderSize	<span class="token number">102400</span>
</code></pre> <p><img src="https://images2.imgbox.com/07/92/9OYS8beF_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-HLWORN94-1692188867573)(C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230816201053050.png)]"></p> </li></ol> 
<h3><a id="vueTongWeb_265"></a>四、vue前端打包（TongWeb部署）</h3> 
<p>ps：这种打包方式是针对于TongWeb部署的，如果是nginx或者TongHttpServer部署，跟普通服务器部署方式一样，打个dist包上传解压即可！</p> 
<ol><li> <p>npm run build 得到 dist</p> </li><li> <p>dist 文件夹里面，添加文件夹和文件</p> <p>1）创建文件夹：WEB-INBF</p> <p>2）进入WEB-INBF创建文件rewrite.config</p> <pre><code class="prism language-java"><span class="token class-name">RewriteRule</span> <span class="token operator">^</span><span class="token operator">/</span>index\<span class="token punctuation">.</span>html$ <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token class-name">L</span><span class="token punctuation">]</span>
<span class="token class-name">RewriteCond</span> <span class="token operator">%</span><span class="token punctuation">{<!-- --></span><span class="token constant">REQUEST_PATH</span><span class="token punctuation">}</span> <span class="token operator">!</span><span class="token operator">-</span>f
<span class="token class-name">RewriteRule</span> <span class="token punctuation">(</span><span class="token punctuation">.</span>*<span class="token punctuation">)</span> <span class="token operator">/</span>index<span class="token punctuation">.</span>html <span class="token punctuation">[</span><span class="token class-name">L</span><span class="token punctuation">]</span>
</code></pre> </li><li> <p>进入 dist,打开 cmd,运行 jar -cvf dist.war * 得到 dist.war</p> </li><li> <p>前端一般不会遇到什么bug，直接将dist.war部署上去即可</p> </li></ol> 
<h3><a id="TongWeb_284"></a>五、TongWeb部署（前后端一样）</h3> 
<ol><li> <p>参数设置</p> <p>ps：这里的参数是部署到当前东方通的所有项目共用，可酌情修改，也可以不动</p> <p><img src="https://images2.imgbox.com/f5/15/DTKlN848_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ui6ypdaL-1692190319626)(C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230816203341541.png)]"></p> </li><li> <p>创建主机</p> <p>ps：建议一个应用一个主机，便于区分，参数酌情填写即可</p> <p><img src="https://images2.imgbox.com/32/19/7VOIColL_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-BBqbULYv-1692190319628)(C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230816203426260.png)]"></p> <p><img src="https://images2.imgbox.com/da/d4/0LCWkvcB_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-WHwvlTLg-1692190319628)(C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230816203751474.png)]"></p> </li><li> <p>创建HTTP通道管理</p> <p><img src="https://images2.imgbox.com/0b/03/gSEmRkcM_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-noyWLmc3-1692190319629)(C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230816203709113.png)]"></p> <p><img src="https://images2.imgbox.com/a1/6f/bjNXXhOO_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-jWfVTOPD-1692190319630)(C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230816203834620.png)]"></p> <p>然后一直下一步，参数自己看着修改，直到最后一步</p> <p><img src="https://images2.imgbox.com/46/bb/zcrmPznv_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-KWrUl5a3-1692190319630)(C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230816203934114.png)]"></p> <p>创建完毕后，需要再重新修改</p> <p><img src="https://images2.imgbox.com/0e/72/DMJtXdHB_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-dXb9P9Of-1692190319631)(C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230816204018417.png)]"></p> <p>根据自己项目实际情况进行勾选，然后保存即可！</p> <p><img src="https://images2.imgbox.com/e5/4a/jscNLW1f_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-PDzFE60q-1692190319632)(C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230816204046215.png)]"></p> </li><li> <p>设置服务器文件路径</p> <p>ps：主要是为了部署项目的时候，文件可以直接从服务器指定路径进行勾选</p> <p><img src="https://images2.imgbox.com/ba/d9/rjJovgTi_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-TgY1IBmJ-1692190319632)(C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230816204345975.png)]"></p> </li><li> <p>部署项目</p> <p><img src="https://images2.imgbox.com/7d/d7/IVUeToQ8_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-Tr0Kyixy-1692190319633)(C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230816204131279.png)]"></p> <p>1）上传文件，选择服务器的话就默认从上一步选择的路径里面，选择底下的文件）<br> <img src="https://images2.imgbox.com/84/99/e3aaCzdT_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-JQIN7spo-1692190319633)(C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230816204845279.png)]"><br> 2）设置前缀<br> <img src="https://images2.imgbox.com/ff/a5/oodYonmb_o.png" alt="在这里插入图片描述"><br> 3）选择主机<br> <img src="https://images2.imgbox.com/86/4b/cq4ZrqPk_o.png" alt="在这里插入图片描述"><br> 4）完成<br> <img src="https://images2.imgbox.com/0a/a4/UkQtWOVW_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-Oi7flhhT-1692190319635)(C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230816205043869.png)]"></p> </li><li> <p>部署结束后，直接使用刚刚设置的端口进行测试访问即可！！！</p> </li></ol>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2e0f9e2dadb399a02efb1a1ae1d08f1a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Uniapp小程序通过camera组件实现视频拍摄</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1b6c185ef4aa02752d0b885aa2c9f035/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">超详细的性能测试需求分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>