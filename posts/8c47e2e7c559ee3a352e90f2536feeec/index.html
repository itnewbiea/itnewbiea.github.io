<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基因组survey - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基因组survey" />
<meta property="og:description" content="几种做基因组survey的方法
包括jellyfish、genomescope2.0、gce等软件
1.jellyfish计算k-mer频率
jellyfish count -C -m 21 -s 1000000000 -t 10 -o reads.jf *.fastq 注意：jellyfish只支持未压缩的fasta格式和fastq格式 ###################################################### # -s 内存 # -t 线程数 # -m kmer值 如果覆盖率低或者错误率高，需要缩小kmer值 # -C 统计正负链	###################################################### #计算k-mer频率的直方图 生成read.histo文件 $ jellyfish histo -t 10 reads.jf &gt; reads.histo R语言结果可视化
&gt;histo &lt;- read.table(&#34;readsSH.histo&#34;,header = F, sep = &#34; &#34;, stringsAsFactors = F) &gt;ggplot(histo, aes(x=V1, y=V2))&#43; &gt;P=geom_line(size=0.8,color=&#34;#6495ed&#34;)&#43;xlim(0,200)&#43; ylim(0,58000000)&#43;theme_classic()&#43;xlab(&#34;K-mer depth&#34;)&#43;ylab(&#34;Kmer Freqence&#34;)&#43; theme(axis.title.x=element_text(size=15),axis.title.y=element_text(size=15),axis.text.y=element_text(size=12),axis.text.x=element_text(size=12)) &gt;P #在图中添加一条虚线 &gt;P&#43;geom_vline(aes(xintercept=51), colour=&#34;#BB0000&#34;, linetype=&#34;dashed&#34;,size=0.8) #xintercept=51 该值为峰值的位置 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8c47e2e7c559ee3a352e90f2536feeec/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-26T20:33:52+08:00" />
<meta property="article:modified_time" content="2021-10-26T20:33:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基因组survey</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>几种做基因组survey的方法<br> 包括jellyfish、genomescope2.0、gce等软件<br> 1.jellyfish计算k-mer频率</p> 
<pre><code>jellyfish count -C -m 21 -s 1000000000 -t 10 -o reads.jf *.fastq
注意：jellyfish只支持未压缩的fasta格式和fastq格式
######################################################
# -s 内存                                             
# -t 线程数                                           
# -m kmer值 如果覆盖率低或者错误率高，需要缩小kmer值     
# -C 统计正负链					  
######################################################
#计算k-mer频率的直方图 生成read.histo文件
$ jellyfish histo -t 10 reads.jf &gt; reads.histo
</code></pre> 
<p>R语言结果可视化</p> 
<pre><code>&gt;histo &lt;- read.table("readsSH.histo",header = F, sep = " ", stringsAsFactors = F)
&gt;ggplot(histo, aes(x=V1, y=V2))+
&gt;P=geom_line(size=0.8,color="#6495ed")+xlim(0,200)+
ylim(0,58000000)+theme_classic()+xlab("K-mer depth")+ylab("Kmer Freqence")+
theme(axis.title.x=element_text(size=15),axis.title.y=element_text(size=15),axis.text.y=element_text(size=12),axis.text.x=element_text(size=12))
&gt;P
#在图中添加一条虚线
&gt;P+geom_vline(aes(xintercept=51), colour="#BB0000", linetype="dashed",size=0.8)
#xintercept=51 该值为峰值的位置
</code></pre> 
<p><img src="https://images2.imgbox.com/58/14/9U7R83Hp_o.png" alt="Kmer depth-Freqence.jpg"><br> 2.genomescope2.0<br> 软件安装</p> 
<pre><code>git clone https://github.com/tbenavi1/genomescope2.0.git
cd genomescope2.0/
mkdir ~/R_libs
echo "R_LIBS=~/R_libs/" &gt;&gt; ~/.Renviron
Rscript install.R
</code></pre> 
<p>genomescope.R</p> 
<pre><code>genomescope.R -i read.histo -o OUTPUT -k 21 -n name -p 倍性 
-i 输入jellyfish产生的read.histo文件
-o 输出文件夹
-k kmer值
-p 倍性 填1、2、3、4、5、6
-n 名字
-l 平均k-mer覆盖度的初始猜测
-m the cutoff for excluding high frequence k-mers from the analysis.分析中最高的k-mer分布频率
</code></pre> 
<p>结果<br> <img src="https://images2.imgbox.com/0e/ef/Se2iNWrh_o.png" alt="GenomeScope"><br> 网页版本：<a href="http://qb.cshl.edu/genomescope/genomescope2.0/" rel="nofollow">genomescope2.0</a><br> 3.kmerfreq gce</p> 
<pre><code>kmerfreq -p OUTPUT -t 10 reads_files.lib
-p 输出文件夹
-t 线程数
-k kmer值
将测序数据的路径写入reads_files.lib文件中
</code></pre> 
<p>gce</p> 
<pre><code>less AF.kmer.freq.stat | grep "#Kmer indivdual number" 
less AF.kmer.freq.stat | perl -ne 'next if(/^#/ || /^\s/); print; ' | awk '{print $1"\t"$2}' &gt; AF.kmer.freq.stat.2colum 
</code></pre> 
<p>对于纯合和接近纯合的基因组</p> 
<pre><code>gce -g 173854609857 -f AF.freq.stat.2colum &gt;gce.table 2&gt;gce.log
</code></pre> 
<p>对于杂合基因组</p> 
<pre><code>gce -g 173854609857 -f AF.freq.stat.2colum -c 75 -H 1 &gt;gce2.table 2&gt;gce2.log
</code></pre> 
<p>查询植物基因组大小的网站：<a href="http://data.kew.org/cvalues" rel="nofollow">http://data.kew.org/cvalues</a><br> 查询动物基因组大小的网站：<a href="http://www.genomesize.com/" rel="nofollow">http://www.genomesize.com</a></p> 
<p>引用：<br> https://github.com/gmarcais/Jellyfish<br> https://kat.readthedocs.io/en/latest/using.html<br> https://github.com/fanagislab/GCE</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e5ddad2e2e7105686a1d66075c7ff996/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">八皇后问题（启发式搜索）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/326e97bafcad184643444ad1ed6636ab/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">2021-10-26</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>