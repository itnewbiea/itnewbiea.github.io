<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Django集成第三方标签功能 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Django集成第三方标签功能" />
<meta property="og:description" content="django-taggit模块是一个可重用的应用程序，它主要提供一个标签模型和一个管理器，可以轻松地向任意模型添加标签。
https://github.com/alex/django-taggit
目录
安装django-taggit
添加taggit到setting.py中的INSTALLED_APPS
编辑models.py，将标签应用到post模型
更新数据库
重构blog应用程序的views.py文件
添加标签路径到urls.py
更新list.html模版，为标签增加链接
安装django-taggit python -m pip install django-taggit 添加taggit到setting.py中的INSTALLED_APPS INSTALL_APPS = [ #... &#39;taggit&#39;, ] 编辑models.py，将标签应用到post模型 from taggit.managers import TaggableManager class Post(models.Mocel): #... tags = TaggableManager() 标记管理器将允许您从Post对象中添加、检索和删除标记。
更新数据库 python manage.py makemigrations blog python manage.py migrate 重构blog应用程序的views.py文件 导入标签模型表单django-taggit，并将post_list视图更改为根据标签筛选帖子。视图最终是这样的。
def post_list(request,tag_slug=None): object_list = Post.published.all() tag = None if tag_slug: tag = get_object_or_404(Tag, slug=tag_slug) object_list = object_list.filter(tags__in=[tag]) paginator = Paginator(object_list,3) page = request.GET.get(&#39;page&#39;) try: posts = paginator." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/69be63f642e1baefd0c256b16f5ea616/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-04T09:52:05+08:00" />
<meta property="article:modified_time" content="2024-01-04T09:52:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Django集成第三方标签功能</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>django-taggit模块是一个可重用的应用程序，它主要提供一个标签模型和一个管理器，可以轻松地向任意模型添加标签。<br> https://github.com/alex/django-taggit</p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%AE%89%E8%A3%85django-taggit-toc" style="margin-left:0px;"><a href="#%E5%AE%89%E8%A3%85django-taggit" rel="nofollow">安装django-taggit</a></p> 
<p id="%E6%B7%BB%E5%8A%A0taggit%E5%88%B0setting.py%E4%B8%AD%E7%9A%84INSTALLED_APPS-toc" style="margin-left:0px;"><a href="#%E6%B7%BB%E5%8A%A0taggit%E5%88%B0setting.py%E4%B8%AD%E7%9A%84INSTALLED_APPS" rel="nofollow">添加taggit到setting.py中的INSTALLED_APPS</a></p> 
<p id="%E7%BC%96%E8%BE%91models.py%EF%BC%8C%E5%B0%86%E6%A0%87%E7%AD%BE%E5%BA%94%E7%94%A8%E5%88%B0post%E6%A8%A1%E5%9E%8B-toc" style="margin-left:0px;"><a href="#%E7%BC%96%E8%BE%91models.py%EF%BC%8C%E5%B0%86%E6%A0%87%E7%AD%BE%E5%BA%94%E7%94%A8%E5%88%B0post%E6%A8%A1%E5%9E%8B" rel="nofollow">编辑models.py，将标签应用到post模型</a></p> 
<p id="%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE%E5%BA%93-toc" style="margin-left:0px;"><a href="#%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE%E5%BA%93" rel="nofollow">更新数据库</a></p> 
<p id="%E9%87%8D%E6%9E%84blog%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%9A%84views.py%E6%96%87%E4%BB%B6-toc" style="margin-left:0px;"><a href="#%E9%87%8D%E6%9E%84blog%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%9A%84views.py%E6%96%87%E4%BB%B6" rel="nofollow">重构blog应用程序的views.py文件</a></p> 
<p id="%E6%B7%BB%E5%8A%A0%E6%A0%87%E7%AD%BE%E8%B7%AF%E5%BE%84%E5%88%B0urls.py-toc" style="margin-left:0px;"><a href="#%E6%B7%BB%E5%8A%A0%E6%A0%87%E7%AD%BE%E8%B7%AF%E5%BE%84%E5%88%B0urls.py" rel="nofollow">添加标签路径到urls.py</a></p> 
<p id="%E6%9B%B4%E6%96%B0list.html%E6%A8%A1%E7%89%88%EF%BC%8C%E4%B8%BA%E6%A0%87%E7%AD%BE%E5%A2%9E%E5%8A%A0%E9%93%BE%E6%8E%A5-toc" style="margin-left:0px;"><a href="#%E6%9B%B4%E6%96%B0list.html%E6%A8%A1%E7%89%88%EF%BC%8C%E4%B8%BA%E6%A0%87%E7%AD%BE%E5%A2%9E%E5%8A%A0%E9%93%BE%E6%8E%A5" rel="nofollow">更新list.html模版，为标签增加链接</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E5%AE%89%E8%A3%85django-taggit">安装django-taggit</h2> 
<pre><code class="language-bash">python -m pip install django-taggit</code></pre> 
<h2 id="%E6%B7%BB%E5%8A%A0taggit%E5%88%B0setting.py%E4%B8%AD%E7%9A%84INSTALLED_APPS">添加taggit到setting.py中的INSTALLED_APPS</h2> 
<pre><code class="language-python">INSTALL_APPS = [
	#...
	'taggit',
]</code></pre> 
<h2 id="%E7%BC%96%E8%BE%91models.py%EF%BC%8C%E5%B0%86%E6%A0%87%E7%AD%BE%E5%BA%94%E7%94%A8%E5%88%B0post%E6%A8%A1%E5%9E%8B">编辑models.py，将标签应用到post模型</h2> 
<pre><code class="language-python">from taggit.managers import TaggableManager

class Post(models.Mocel):
	#...
	tags = TaggableManager()</code></pre> 
<p>标记管理器将允许您从Post对象中添加、检索和删除标记。</p> 
<h2 id="%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE%E5%BA%93">更新数据库</h2> 
<pre><code class="language-python">python manage.py makemigrations blog

python manage.py migrate</code></pre> 
<h2 id="%E9%87%8D%E6%9E%84blog%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%9A%84views.py%E6%96%87%E4%BB%B6">重构blog应用程序的views.py文件</h2> 
<p>导入标签模型表单django-taggit，并将post_list视图更改为根据标签筛选帖子。视图最终是这样的。</p> 
<pre><code class="language-python">def post_list(request,tag_slug=None):
    object_list = Post.published.all()
    tag = None
    if tag_slug:
        tag = get_object_or_404(Tag, slug=tag_slug)
        object_list = object_list.filter(tags__in=[tag])
    paginator = Paginator(object_list,3)
    page = request.GET.get('page')
    try:
        posts = paginator.page(page)
    except PageNotAnInteger:
        posts = paginator.page(1)
    except EmptyPage:
        posts = paginator.page(paginator.num_pages)
  
    template = "blog/post/list.html"
    context = {
        "page":page,
        "posts":posts,
        "tag":tag,
    }

    return render(request,template,context)</code></pre> 
<ul><li>视图接受一个可选的tag_slug参数，默认值为None。该参数将出现在URL中。  </li><li>在视图中，构建初始QuerySet，检索所有已发布的文章，如果存在给定的标记段，我们使用get_object_or_404()获取带有给定段的tag对象。  </li><li>然后，根据包含给定标记的帖子筛选帖子列表。由于这是一个多对多关系，我们必须根据给定列表中包含的标记进行筛选，在示例中，该列表只包含一个元素。</li></ul> 
<h2 id="%E6%B7%BB%E5%8A%A0%E6%A0%87%E7%AD%BE%E8%B7%AF%E5%BE%84%E5%88%B0urls.py">添加标签路径到urls.py</h2> 
<pre><code class="language-python">path("", views.post_list, name="post_list"),
path('tag/&lt;slug:tag_slug&gt;/',views.post_list, name='post_list_by_tag'),</code></pre> 
<p>两个路径都指向相同的视图，但是我们对它们的命名不同。  </p> 
<p>第一种模式将调用不带任何可选参数的post_list视图，而第二种模式将调用带tag_slug参数的视图。这里使用一个slug路径转换器将参数匹配为一个小写字符串，其中包含ASCII字母或数字，以及连字符和下划线字符。</p> 
<h2 id="%E6%9B%B4%E6%96%B0list.html%E6%A8%A1%E7%89%88%EF%BC%8C%E4%B8%BA%E6%A0%87%E7%AD%BE%E5%A2%9E%E5%8A%A0%E9%93%BE%E6%8E%A5">更新list.html模版，为标签增加链接</h2> 
<pre><code class="language-html">    {% if tag %}
        &lt;h2&gt;Posts tagged with "{<!-- -->{ tag.name }}"&lt;/h2&gt;
    {% endif %}</code></pre> 
<p>如果tag不是None，显示正在过滤的tag名称。</p> 
<pre><code class="language-html">
        &lt;p class="tags"&gt;
            Tags:
            {% for tag in post.tags.all %}
                &lt;a href="{% url 'blog:post_list_by_tag' tag.slug %}"&gt;
                    {<!-- -->{ tag.name }}
                &lt;/a&gt;
                {% if not forloop.last %},{% endif %}
            {% endfor %}
        &lt;/p&gt;</code></pre> 
<p>遍历一个帖子的所有标记，显示一个自定义链接到URL，以根据该标记过滤帖子。我们使用{% URL "blog:post_list_by_tag"标签构建URL。使用URL的名称和slug标记作为其参数。我们用逗号分隔标签。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ac5be8bf1972cce128fd34997368c95f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">RabbitMQ（七）ACK 消息确认机制</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/88bb3f7ccb8aa4b60d848818e1907c26/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">北京大学漏洞报送证书</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>