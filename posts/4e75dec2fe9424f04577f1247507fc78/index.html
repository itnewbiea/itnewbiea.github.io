<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue &#43; gojs  实现拖拽流程图（实战项目） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue &#43; gojs  实现拖拽流程图（实战项目）" />
<meta property="og:description" content="一、流程图效果 最近一段时间在研究go.js,它是一款前端开发画流程图的一个插件，也是一个难点，要说为什么是难点，首先，它是依赖画布canvas知识开发。其次，要依赖于内部API开发需求，开发项目实战需求的时候就要花费大量的时间去熟悉go.js的API，然后才能进行开发。话不多说，我就先把我最近做的项目案例效果图展示一下：
看到效果图大家可能会想这个挺简单的，会想没什么难点，其实真正开发的时候才会知道的、才会领悟到。
二、为什么选go.js流程图插件去开发项目？ 在项目开发一期的时候我用的不是go.js,而用的是一款轻便的流程插件jsplumb.js,它也集成了各种功能性API，但是在开发二期的时候它的内部功能已经满足不了需求了，所以我就开始在网上查找流程插件来学习，看了很多插件，比如：G6，D3 等这些可视化流程插件都是不能满足需求。要说为什么不能满足需求,原因如下：
一、首先，看到效果图里的内置多点和其他模块单点连线问题，其他插件是无法这个满足需求的，可能我没有深入去了解其他的流程插件吧，但是go.js里内置点连线可以让开发者很快的理解代码逻辑，不用耗费大量的时间去想点与点的连线。
二、代码上的数据结构问题，其他插件里的API数据字段繁琐量多，不够清晰明了，而go.js里的数据结构就两个重要字段，一是所有模块的字段集合二是连线字段集合，根据需求可以随意加字段。
三、项目开发 （一）、首先直接使用go.js，画布中是有水印的
其实这个问题不大，替换一行代码就可以去除水印
引入go.js后，直接在编辑器中全局搜索7eba17a4ca3b1a8346，找到类似这样结构的代码
a.ir=b.W[Ra(&#34;7eba17a4ca3b1a8346&#34;)][Ra(&#34;78a118b7&#34;)](b.W,ok,4,4); 注：不同的版本代码不是完全相同的，可能是a.jv（属性名是会变的） =‘xxxxx’，将这行代码替换成
a.ir=function(){return true;}; //a.属性名 要保持一致 去除水印的效果
（二）、HTML
&lt;--第一种--&gt;
&lt;template&gt; &lt;div id=&#34;wrap&#34;&gt; &lt;div id=&#34;chart-wrap&#34;&gt; &lt;div id=&#34;chart-palette&#34;&gt;&lt;/div&gt;&lt;-- 画布一 --&gt; &lt;div id=&#34;chart-diagram&#34;&gt;&lt;/div&gt;&lt;-- 画布二 --&gt; &lt;/div&gt; &lt;/div&gt; &lt;/template&gt; 如图：
第二种
结合vue的拖拽组件vuedraggable 实现业务需求。
&lt;template&gt; &lt;div id=&#34;chart-wrap&#34;&gt; &lt;div v-for=&#34;tab in tabLIst&#34; :key=&#34;tab.id&#34; class=&#34;tab&#34;&gt; //拖动 &lt;vuedraggable @end.stop=&#34;end&#34; @start.stop=&#34;move&#34;&gt; &lt;i :class=&#34;tab.icon&#34; /&gt; {{ tab.text }} &lt;el-tooltip effect=&#34;dark&#34; :content=&#34;tab.tooltip&#34; placement=&#34;top&#34;&gt; &lt;i class=&#34;el-icon-question&#34; /&gt; &lt;/el-tooltip&gt; &lt;/vuedraggable&gt; &lt;/div&gt; &lt;div id=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/4e75dec2fe9424f04577f1247507fc78/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-04T23:36:12+08:00" />
<meta property="article:modified_time" content="2023-04-04T23:36:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue &#43; gojs  实现拖拽流程图（实战项目）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <h3 style="text-align:left;"> 一、流程图效果 </h3> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> 最近一段时间在研究go.js,它是一款前端开发画流程图的一个插件，也是一个难点，要说为什么是难点，首先，它是依赖画布canvas知识开发。其次，要依赖于内部API开发需求，开发项目实战需求的时候就要花费大量的时间去熟悉go.js的API，然后才能进行开发。话不多说，我就先把我最近做的项目案例效果图展示一下：</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:740px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:45.135136%;height:0;"> 
    <img src="https://images2.imgbox.com/a0/50/SlHMlqKx_o.png" style="margin-left:;display:block;width:740px;margin-top:-45.135136%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> </span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:740px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:46.081078%;height:0;"> 
    <img src="https://images2.imgbox.com/c6/ce/l6pjgYEb_o.png" style="margin-left:;display:block;width:740px;margin-top:-46.081078%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> </span></p> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> </span></p> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">看到效果图大家可能会想这个挺简单的，会想没什么难点，其实真正开发的时候才会知道的、才会领悟到。</span></p> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> </span></p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">二、为什么选go.js流程图插件去开发项目？ </span></h3> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> 在项目开发一期的时候我用的不是go.js,而用的是一款轻便的流程插件jsplumb.js,它也集成了各种功能性API，但是在开发二期的时候它的内部功能已经满足不了需求了，所以我就开始在网上查找流程插件来学习，看了很多插件，比如：G6，D3 等这些可视化流程插件都是不能满足需求。要说为什么不能满足需求,原因如下：</span></p> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> 一、首先，看到效果图里的内置多点和其他模块单点连线问题，其他插件是无法这个满足需求的，可能我没有深入去了解其他的流程插件吧，但是go.js里内置点连线可以让开发者很快的理解代码逻辑，不用耗费大量的时间去想点与点的连线。</span></p> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> 二、代码上的数据结构问题，其他插件里的API数据字段繁琐量多，不够清晰明了，而go.js里的数据结构就两个重要字段，一是所有模块的字段集合二是连线字段集合，根据需求可以随意加字段。</span></p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">三、项目开发 </span></h3> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;"> </span> （一）、首先直接使用go.js，画布中是有水印的</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:740px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:48.24324%;height:0;"> 
    <img src="https://images2.imgbox.com/17/ab/8MjN0BZg_o.png" style="margin-left:;display:block;width:740px;margin-top:-48.24324%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">其实这个问题不大，替换一行代码就可以去除水印</span></p> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">引入go.js后，直接在编辑器中全局搜索7eba17a4ca3b1a8346，找到类似这样结构的代码</span></p> 
 <h6 style="text-align:left;">a.ir=b.W[Ra("7eba17a4ca3b1a8346")][Ra("78a118b7")](b.W,ok,4,4);</h6> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">注：不同的版本代码不是完全相同的，可能是a.jv（属性名是会变的） =‘xxxxx’，将这行代码替换成</span></p> 
 <h6 style="text-align:left;">a.ir=function(){return true;}; //a.属性名 要保持一致</h6> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">去除水印的效果</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:740px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:53.51351%;height:0;"> 
    <img src="https://images2.imgbox.com/6c/2a/51D0gsoM_o.png" style="margin-left:;display:block;width:740px;margin-top:-53.51351%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">（二）、HTML</span></p> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">&lt;--第一种--&gt;</span></p> 
 <pre class="kdocs-xml"><code class="language-xml">&lt;template&gt;
    &lt;div id="wrap"&gt;
        &lt;div id="chart-wrap"&gt;
            &lt;div id="chart-palette"&gt;&lt;/div&gt;&lt;-- 画布一 --&gt;
            &lt;div id="chart-diagram"&gt;&lt;/div&gt;&lt;-- 画布二 --&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/template&gt;</code></pre> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">如图：</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:740px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:56.62162%;height:0;"> 
    <img src="https://images2.imgbox.com/88/3a/DBeOysrF_o.png" style="margin-left:;display:block;width:740px;margin-top:-56.62162%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">第二种</span></p> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> 结合vue的拖拽组件vuedraggable 实现业务需求。</span></p> 
 <pre class="kdocs-xml"><code class="language-xml">&lt;template&gt;
     &lt;div id="chart-wrap"&gt;
                &lt;div v-for="tab in tabLIst" :key="tab.id" class="tab"&gt;
              //拖动
           &lt;vuedraggable @end.stop="end" @start.stop="move"&gt;
          
                                 &lt;i :class="tab.icon" /&gt; {<!-- -->{ tab.text }}
                                 &lt;el-tooltip effect="dark" :content="tab.tooltip" placement="top"&gt;
                                             &lt;i class="el-icon-question" /&gt;
                                 &lt;/el-tooltip&gt;
                    &lt;/vuedraggable&gt;
                  &lt;/div&gt;
         &lt;div id="chart-diagram"/&gt; &lt;--画布--&gt;
      &lt;/div&gt;
&lt;/template&gt;  
　　</code></pre> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">如图：</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:740px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:33.91892%;height:0;"> 
    <img src="https://images2.imgbox.com/39/ce/ZYLN87Hw_o.png" style="margin-left:;display:block;width:740px;margin-top:-33.91892%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> </span></p> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> </span></p> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">　　</span></p> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">（三）、画布的基本设置 。</span></p> 
 <pre class="kdocs-javascript"><code class="language-javascript">this.diagram = $(go.Diagram, "chart-diagram",
                {
                    // 画布初始位置
                    initialContentAlignment: go.Spot.LeftSide, // 居中显示
                    "undoManager.isEnabled": true, // 支持 Ctrl-Z 和 Ctrl-Y 操作
                    // 初始坐标
                    // initialPosition: new go.Point(0, 0),
                    //allowSelect:false,  ///禁止选中
                    // "toolManager.hoverDelay": 100, //tooltip提示显示延时
                    // "toolManager.toolTipDuration": 10000, //tooltip持续显示时间
                    //  isReadOnly:true,//只读

                    //禁止水平拖动画布
                    //禁止水平滚动条
                    allowHorizontalScroll: false,
                    // 禁止垂直拖动画布
                    //禁止垂直滚动条
                    allowVerticalScroll: false,
                    allowZoom: true,//画布是否可以缩放
                    "grid.visible": false, //显示网格
                    // allowMove: true, //允许拖动
                    // allowDragOut:true,
                    allowDelete: true,//禁止删除节点
                    allowCopy: true,//禁止复制
                    // 禁止撤销和重做
                    // "undoManager.isEnabled": false,
                    // 画布比例
                    // scale:1.5，
                    // minScale:1.2,//画布最小比例
                    // maxScale:2.0,//画布最大比例
                    // 画布初始化动画时间
                    // "animationManager.duration": 600,
                    // 禁止画布初始化动画
                    "animationManager.isEnabled": false,
                    // autoScale:go.Diagram.Uniform,//自适应

                    // autoScale:go.Diagram.UniformToFill,//自适应
                    //    "draggingTool.dragsLink": false,//拖动线
                    // autoScale:go.Diagram.None,//默认值不自适应
                    // 画布边距padding
                    // padding:80或者new go.Margin(2, 0)或new go.Margin(1, 0, 0, 1)
                    // validCycle: go.Diagram.CycleDestinationTree，//只允许有一个父节点
                    //节点模块动画  S
                    // "animationManager.initialAnimationStyle":go.Animation.EaseOutExpo,
                    // "animationManager.initialAnimationStyle": go.Animation.EaseInOutQuad,
                    "animationManager.initialAnimationStyle": go.AnimationManager.None,
                    // "animationManager.initialAnimationStyle":go.AnimationManager.AnimateLocations,
                    //节点模块动画   D
                    // validCycle: go.Diagram.CycleNotUndirected，

                    // validCycle: go.Diagram.CycleNotDirected，
                    // validCycle: go.Diagram.CycleSourceTree，
                    //ismodelfied:true //禁止拖拽
                    // 禁止鼠标拖动区域选中
                    // "dragSelectingTool.isEnabled" : false,
                    //允许使用delete键删除模块
                    "commandHandler.deletesTree": true,
                    // "hasHorizontalScrollbar":false,//去除水平滚动条
                    // "hasVerticalScrollbar":false,//去除竖直滚动条
                    // "canStart":false,
                    // allowClipboard: true,
                    // "toolManager.mouseWheelBehavior": go.ToolManager.WheelZoom, //有鼠标滚轮事件放大和缩小，而不是向上和向下滚动
                    // layout: $(go.TreeLayout,
                    //     { angle: 90, layerSpacing: 80 }),
                }
            );</code></pre> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">（三）、整体画布事件及节点的监听<span class="kdocs-bold" style="font-weight:bold;"> </span></span></p> 
 <pre class="kdocs-javascript"><code class="language-javascript">                // 监听连线
                this.diagram.addDiagramListener("LinkDrawn", (e) =&gt; { 
                    console.log(e.subject.part); 
                });
                // 监听删除
                 this.diagram.addDiagramListener("SelectionDeleted", (e) =&gt; {
                     e.subject.each(function (n) {
                         console.log(n.data.key);
                     });
                  })
                // 修改节点
                this.diagram.addDiagramListener("TextEdited", (evt) =&gt; {
                    console.log(e.subject.part);
                });
                // 监听点击
                this.diagram.addDiagramListener("ObjectSingleClicked", (e) =&gt; {
　　　　　　　　　　　　
                   //这是清除高亮的
                   // e.diagram.commit((d) =&gt; {
                    //      d.clearHighlighteds();
                     // }, "no highlighteds"); 
                });

                // // 移动事件
                this.diagram.addDiagramListener("SelectionMoved", (e) =&gt; {
                    console.log(e.diagram.lastInput.documentPoint);
                });</code></pre> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">(四)、连线点封装函数 </span></p> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> // 节点连接线</span></p> 
 <pre class="kdocs-javascript"><code class="language-javascript">            makePort (name, align, spot, output, input) {
                var horizontal = align.equals(go.Spot.Top) || align.equals(go.Spot.Bottom)
                return $(go.Shape, {
                    fill: 'transparent', // 默认透明不现实
                    strokeWidth: 0, // 无边框
                    fromMaxLinks: 1, //
                    width: horizontal ? NaN : 10, // 垂直"port"则8像素宽
                    height: !horizontal ? NaN : 5, // 水平"port"则8像素
                    alignment: align, // 同其模块对齐
                    stretch: horizontal
                        ? go.GraphObject.Horizontal
                        : go.GraphObject.Vertical, // 自动同其模块一同伸缩
                    portId: name, // 声明ID
                    fromSpot: spot, // 声明连线头连出此"port"的位置
                    fromLinkable: output, // 布尔型，是否允许连线从此"port"连出
                    toLinkable: input, // 布尔型，是否允许连线从此"port"连出
                    toSpot: spot, // 声明连线尾连入此"port"的位置
                    cursor: 'pointer', // 鼠标由指针改为手指，表示此处可点击生成连线
                    mouseEnter: function (e, port) {
                        // 鼠标移到"port"位置后，高亮
                        if (!e.diagram.isReadOnly) port.fill = 'rgba(255,0,255,0.3)'
                    },
                    mouseLeave: function (e, port) {
                        // 鼠标移出"port"位置后，透明
                        port.fill = 'transparent'
                    }
                })
            }</code></pre> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">（五）、节点连线的高亮函数。</span></p> 
 <pre class="kdocs-javascript"><code class="language-javascript">isHighlightedFun(link) {
                return $$(go.Shape,
                      "RoundedRectangle", {
                          fill: "rgba(217,236,255,.2)",
                          stroke: "rgba(39,154,242,.1)",
                          strokeWidth: 1,
                      },
                      new go.Binding("stroke", "isHighlighted", (h) =&gt; {
                            return h ? "rgba(39,154,242,1)" : "rgba(39,154,242,.8)"; 
                      }).ofObject(),
                      new go.Binding("strokeWidth", "isHighlighted", (h) =&gt; {
                          return h ? 2.5 : 1.3;
                      }).ofObject(),
                )
    }</code></pre> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> 如图：</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:740px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:37.162163%;height:0;"> 
    <img src="https://images2.imgbox.com/81/5b/xGXuNPGW_o.png" style="margin-left:;display:block;width:740px;margin-top:-37.162163%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> </span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:740px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:51.48649%;height:0;"> 
    <img src="https://images2.imgbox.com/25/39/kMOeb9j1_o.png" style="margin-left:;display:block;width:740px;margin-top:-51.48649%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> </span></p> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;"> (六)、 节点连接线。（方法封装）</span></p> 
 <pre class="kdocs-javascript"><code class="language-javascript">makePort(name, align, spot, output, input) {
                var horizontal = align.equals(go.Spot.Top) || align.equals(go.Spot.Bottom);
                return $$(go.Shape,
                      {
                          fill: "transparent",  // 默认透明
                          strokeWidth: 0,  // 无边框
                          fromMaxLinks: 1,  //最大连接数
                          width: horizontal ? NaN : 10,  // 垂直"port"则8像素宽
                          height: !horizontal ? NaN : 2,  // 水平"port"则8像素
                          alignment: align,  // 同其模块对齐
                          stretch: (horizontal ? go.GraphObject.Horizontal : go.GraphObject.Vertical),//自动同其模块一同伸缩
                          portId: name,  // 声明ID
                          fromSpot: spot,  // 声明连线头连出此"port"的位置
                          fromLinkable: output,  // 布尔型，是否允许连线从此"port"连出
                          toLinkable: input,  // 布尔型，是否允许连线从此"port"连出
                          toSpot: spot,  // 声明连线尾连入此"port"的位置
                          cursor: "pointer",  // 鼠标由指针改为手指，表示此处可点击生成连线
                          mouseEnter: (e, port) =&gt; {  //鼠标移到"port"位置后，高亮
                              if (!e.diagram.isReadOnly) port.fill = "rgba(255,0,255,0.3)";
                          },
                          mouseLeave: (e, port) =&gt; {// 鼠标移出"port"位置后，透明
                              port.fill = "transparent";
                          }
                      });
            }</code></pre> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">注意：要在this.diagram.nodeTemplateMap.add 增加模块里调用。</span></p> 
 <p style="text-align:null;"><span class="kdocs-fontSize" style="font-size:9pt;">示例：</span></p> 
 <pre class="kdocs-javascript"><code class="language-javascript">this.diagram.nodeTemplateMap.add(type,
                      $$(go.Node, "Auto",
               this.makePort("T", go.Spot.Top, go.Spot.TopCenter, false, true)
))</code></pre> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">四、当前画布的监听事件名称包括</span></h3> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">AnimationStarting</span>" ：动画渲染前事件,加载图表的动画即将开始;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">AnimationFinished</span>" ：动画渲染完事件,加载图表刚刚完成的动画;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">BackgroundSingleClicked</span>"： 背景单击事件, 单击图表背景;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">BackgroundDoubleClicked</span>" ：背景双击事件, 双击图表背景;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">BackgroundContextClicked</span>" ：背景右键事件, 右键单击图表背景;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">ChangingSelection</span>"： 改变选择前事件, 一个操作即将改变Diagram.selection图表选择集合,</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">ChangedSelection</span>" ：改变选择后事件, 一个操作已经改变?Diagram.selection图表选择集合,</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">ClipboardChanged</span>" ：剪切板改变事件, 零部件已被CommandHandler.copySelection复制到剪贴板上;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">ClipboardPasted</span>" ：剪切板粘贴事件,零部件已由CommandHandler.pasteSelection从剪贴板复制到图表中;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">DocumentBoundsChanged</span>"： 文档范围改变事件, 图表中各零部件的面积,?Diagram.documentBounds,已经改变了;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">ExternalObjectsDropped</span>" ：(节点或线等)零部件拖放生成事件, 零部件已经通过拖拽从图的外部复制到图中;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">GainedFocus</span>" ：获得键盘焦点事件, 该图获得了键盘焦点，例如在调用Diagram.focus之后.</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">LayoutCompleted</span>" ：布局完成事件, 整个图表布局刚刚更新;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">LinkDrawn</span>"： 线创建事件,用户刚刚使用LinkingTool创建了一个新链接;?</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">LinkRelinked</span>"： 线重新连接事件, 用户刚刚通过RelinkingTool?或?DraggingTool重新连接了现有线;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">LinkReshaped</span>"： 线路径改变事件, 用户刚刚通过LinkReshapingTool调整了线的路径;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">LostFocus</span>" ：图表失去焦点事件,这个图表失去了键盘焦点,</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">Modified</span>" ：图表改变事件,?Diagram.isModified?属性已被设置为一个新值——用于将窗口标记为自上次保存以来已被修改;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">ObjectSingleClicked</span>"： 对象单击事件, 单击了图形对象（节点和线等）;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">ObjectDoubleClicked</span>"：双击了图形对象（节点和线等）;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">ObjectContextClicked</span>"：右键单击了图形对象（节点和线等）;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">PartCreated</span>" ：Part创建事件,用户通过?ClickCreatingTool插入新的零部件;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">PartResized</span>" ：Part大小改变事件, 用户通过ResizingTool 调整工具改变了一个图形对象的大小;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">PartRotated</span>" ：Part旋转事件, 用户通过RotatingTool 旋转工具改变了一个图形对象的角度 ;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">SelectionMoved</span>" ：拖动事件, 用户通过DraggingTool 拖动工具移动了选定的部分;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">SelectionCopied</span>" ：复制事件,户通过DraggingTool 拖动工具复制了选定的部分;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">SelectionDeleted</span>" ：删除后事件,用户通过?CommandHandler.deleteSelection?已经删除了选定的部分;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">SelectionDeleting</span>" ：删除前事件,用户通过?CommandHandler.deleteSelection即将删除选定的部分;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">SelectionGrouped</span>" ：选择创建分组事件, 通过CommandHandler.groupSelection已经从选择的零部件中创建了一个新的组 ;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">SelectionUngrouped</span>"：用户已删除选定的组，但通过CommandHandler.ungroupSelection保留其成员;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">SubGraphCollapsed</span>" ：子图折叠事件, 用户通过CommandHandler.collapseSubGraph将选定的组折叠;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">SubGraphExpanded</span>" ：子图展开事件, 用户通过CommandHandler.expandSubGraph将选定的组展开;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">TextEdited</span>" ：文本块修改事件,用户通过文本编辑工具改变了文本块的字符串值;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">TreeCollapsed</span>"： 树折叠事件, 用户通过CommandHandler.collapseTree折叠所选节点的子树;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">TreeExpanded</span>" ：树展开事件, 用户通过CommandHandler.expandTree展开了所选节点的子树;</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>"<span class="kdocs-bold" style="font-weight:bold;">ViewportBoundsChanged</span>"：视窗范围改变事件,图表中可见的区域,?Diagram.viewportBounds,发生了改变;</p></li></ul> 
 <h3 style="">五、迭代篇</h3> 
 <h6 style="text-align:left;"> （一）、项目的迭代。</h6> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;"> 从数据结构到ui风格的整体重构，有了新的变化。</span></p> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;"> 整体流程 如图一：</span></p> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;"> </span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:2682px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:47.94929%;height:0;"> 
    <img src="https://images2.imgbox.com/85/8a/1mGejuez_o.png" style="margin-left:;display:block;width:2682px;margin-top:-47.94929%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;"></p> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;"> 模块流程侧边设置图二：</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:740px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:48.918915%;height:0;"> 
    <img src="https://images2.imgbox.com/c5/cd/Y3HfbsNc_o.png" style="margin-left:;display:block;width:740px;margin-top:-48.918915%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;"> </span></p> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;"> 伸缩当前灰色意图如图三：</span></p> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;">为什么收起意图会有多条连线，是因为当前模块下的意图和部分模块有关系线，所以在收起时要知道当前模块下有几个意图和其他模块有关系。</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:740px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:47.567566%;height:0;"> 
    <img src="https://images2.imgbox.com/49/b6/b44WFi86_o.png" style="margin-left:;display:block;width:740px;margin-top:-47.567566%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;"> </span></p> 
 <h6 style="text-align:left;">（二）、整体用的js方法</h6> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;"> 1、画布里的功能js：</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:503px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:119.4831%;height:0;"> 
    <img src="https://images2.imgbox.com/2b/ef/glreukoR_o.png" style="margin-left:;display:block;width:503px;margin-top:-119.4831%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;"> </span></p> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;"> 2、工具条js 方法：</span></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:666px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:72.67267%;height:0;"> 
    <img src="https://images2.imgbox.com/fe/54/tbKqSewl_o.png" style="margin-left:;display:block;width:666px;margin-top:-72.67267%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;"> </span></p> 
 <h6 style="text-align:left;">（三）、功能分析</h6> 
 <p style="text-align:left;"> 1<span class="kdocs-bold" style="font-weight:bold;">、工具条中的功能方法</span></p> 
 <p style="text-align:left;"> （1）、查看 </p> 
 <p style="text-align:left;"> 注： 是通过gojs 实例中的makeSVG方法打开一个新窗口生成的一个svg</p> 
 <pre class="kdocs-javascript"><code class="language-javascript">printDiagram() {
    var svgWindow = window.open();
if (!svgWindow) return;
var printSize = new go.Size(3000, 2000);
var bnds = this.diagram.documentBounds;
var x = bnds.x;
var y = bnds.y;
while (y &lt; bnds.bottom) {
        while (x &lt; bnds.right) {
            var svg = this.diagram.makeSVG({scale: 1.0, position: new go.Point(x, y), size: printSize});
svgWindow.document.body.appendChild(svg);
x += printSize.width;
}
        x = bnds.x;
y += printSize.height;
}
}</code></pre> 
 <p style="text-align:left;"> （2）、居中</p> 
 <p style="text-align:left;"> 这里将调用CommandHandler.scrollToPart，先还原画布初始状态后执行动画以将视口滚动到节点所在的位置。</p> 
 <p style="text-align:left;">注：如果节点靠近边缘，除非您增加Diagram.scrollMargin，否则无法滚动视口，以使该节点更靠近视口的中心。</p> 
 <pre class="kdocs-javascript"><code class="language-javascript">centerDiagram() {
            this.resetCanvas();
            this.diagram.commandHandler.scrollToPart(this.diagram.findNodeForKey(this.initModuleId));
},
 // 还原
        resetCanvas() {
            this.diagram.scale = 1;
            this.$refs.set.zoom = 100;
        },</code></pre> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;">尽请等待周六周日继续完善。如有不足可共享技术经验。。。。。。。。。。。。。</span></p> 
 <p style=""></p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b31a07f20e4a493de6f44cdb02d71c04/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vscode添加PHP代码注释的插件及设置教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/608fdbd8d8dcd3556ff682ec87f35886/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android中将APK放入系统APK目录中,启动失败</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>