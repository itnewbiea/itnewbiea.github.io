<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[Mysql] 经典 50 题 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[Mysql] 经典 50 题" />
<meta property="og:description" content="50道MySql练习题（本文档只有45道）流传自远古，相当经典。这套练习在多样性和难度上平衡的比较好，换句话说，基础sql查询练习有这套就够了。
这套练习在互联网上存在时间悠久，有很多版本，本文档力图在可读性，规范性，可操作性上比这些版本做的更好
本文档用Pandas实现查询操作，这么做的原因是方便写在vscode的jupyter notebook里，更方便导出为Markdown文件。原juypter文件附在最后
导入必需库,连接数据库
import pandas as pd import pymysql eng = pymysql.connect(host=&#39;localhost&#39;, user=&#39;root&#39;, password=&#39;root&#39;, db=&#39;50题_1&#39;, charset=&#39;utf8&#39;) 新建练习数据库,插入样表,此部分无法在 Pandas 里操作 CREATE DATABASE 50题; USE 50题; CREATE TABLE student (s_id VARCHAR(10),s_name VARCHAR(10),s_birthday datetime,s_sex VARCHAR(10)); INSERT INTO student VALUES(&#39;01&#39; , &#39;赵雷&#39; , &#39;1990-01-01&#39; , &#39;男&#39;); INSERT INTO student VALUES(&#39;02&#39; , &#39;钱电&#39; , &#39;1990-12-21&#39; , &#39;男&#39;); INSERT INTO student VALUES(&#39;03&#39; , &#39;孙风&#39; , &#39;1990-05-20&#39; , &#39;男&#39;); INSERT INTO student VALUES(&#39;04&#39; , &#39;李云&#39; , &#39;1990-08-06&#39; , &#39;男&#39;); INSERT INTO student VALUES(&#39;05&#39; , &#39;周梅&#39; , &#39;1991-12-01&#39; , &#39;女&#39;); INSERT INTO student VALUES(&#39;06&#39; , &#39;吴兰&#39; , &#39;1992-03-01&#39; , &#39;女&#39;); INSERT INTO student VALUES(&#39;07&#39; , &#39;郑竹&#39; , &#39;1989-07-01&#39; , &#39;女&#39;); INSERT INTO student VALUES(&#39;09&#39; , &#39;张三&#39; , &#39;2017-12-20&#39; , &#39;女&#39;); INSERT INTO student VALUES(&#39;10&#39; , &#39;李四&#39; , &#39;2017-12-25&#39; , &#39;女&#39;); INSERT INTO student VALUES(&#39;11&#39; , &#39;李四&#39; , &#39;2017-12-30&#39; , &#39;女&#39;); INSERT INTO student VALUES(&#39;12&#39; , &#39;赵六&#39; , &#39;2017-01-01&#39; , &#39;女&#39;); INSERT INTO student VALUES(&#39;13&#39; , &#39;孙七&#39; , &#39;2018-01-01&#39; , &#39;女&#39;); CREATE TABLE course(c_id VARCHAR(10),c_name nVARCHAR(10),t_id VARCHAR(10)); INSERT INTO course VALUES(&#39;01&#39; , &#39;语文&#39; , &#39;02&#39;); INSERT INTO course VALUES(&#39;02&#39; , &#39;数学&#39; , &#39;01&#39;); INSERT INTO course VALUES(&#39;03&#39; , &#39;英语&#39; , &#39;03&#39;); CREATE TABLE teacher(t_id VARCHAR(10),t_name VARCHAR(10)); INSERT INTO teacher VALUES(&#39;01&#39; , &#39;张三&#39;); INSERT INTO teacher VALUES(&#39;02&#39; , &#39;李四&#39;); INSERT INTO teacher VALUES(&#39;03&#39; , &#39;王五&#39;); CREATE TABLE score(s_id VARCHAR(10),c_id VARCHAR(10),score decimal(18,1)); INSERT INTO score VALUES(&#39;01&#39; , &#39;01&#39; , 80); INSERT INTO score VALUES(&#39;01&#39; , &#39;02&#39; , 90); INSERT INTO score VALUES(&#39;01&#39; , &#39;03&#39; , 99); INSERT INTO score VALUES(&#39;02&#39; , &#39;01&#39; , 70); INSERT INTO score VALUES(&#39;02&#39; , &#39;02&#39; , 60); INSERT INTO score VALUES(&#39;02&#39; , &#39;03&#39; , 80); INSERT INTO score VALUES(&#39;03&#39; , &#39;01&#39; , 80); INSERT INTO score VALUES(&#39;03&#39; , &#39;02&#39; , 80); INSERT INTO score VALUES(&#39;03&#39; , &#39;03&#39; , 80); INSERT INTO score VALUES(&#39;04&#39; , &#39;01&#39; , 50); INSERT INTO score VALUES(&#39;04&#39; , &#39;02&#39; , 30); INSERT INTO score VALUES(&#39;04&#39; , &#39;03&#39; , 20); INSERT INTO score VALUES(&#39;05&#39; , &#39;01&#39; , 76); INSERT INTO score VALUES(&#39;05&#39; , &#39;02&#39; , 87); INSERT INTO score VALUES(&#39;06&#39; , &#39;01&#39; , 31); INSERT INTO score VALUES(&#39;06&#39; , &#39;03&#39; , 34); INSERT INTO score VALUES(&#39;07&#39; , &#39;02&#39; , 89); INSERT INTO score VALUES(&#39;07&#39; , &#39;03&#39; , 98); 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/31674e17cfaef215db1906f413357b33/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-27T11:41:48+08:00" />
<meta property="article:modified_time" content="2022-07-27T11:41:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[Mysql] 经典 50 题</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <ul><li> <p>50道MySql练习题（本文档只有45道）流传自远古，相当经典。这套练习在多样性和难度上平衡的比较好，换句话说，基础sql查询练习有这套就够了。</p> </li><li> <p>这套练习在互联网上存在时间悠久，有很多版本，本文档力图在可读性，规范性，可操作性上比这些版本做的更好</p> </li><li> <p>本文档用Pandas实现查询操作，这么做的原因是方便写在vscode的jupyter notebook里，更方便导出为Markdown文件。原juypter文件附在最后</p> </li><li> <p><strong>导入必需库,连接数据库</strong></p> </li></ul> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> pymysql

eng <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> db<span class="token operator">=</span><span class="token string">'50题_1'</span><span class="token punctuation">,</span> charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li><strong>新建练习数据库,插入样表,此部分无法在 <code>Pandas</code> 里操作</strong></li></ul> 
<pre><code class="prism language-sql">    <span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token number">50</span>题<span class="token punctuation">;</span>
    <span class="token keyword">USE</span> <span class="token number">50</span>题<span class="token punctuation">;</span>
    <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> student <span class="token punctuation">(</span>s_id <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>s_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>s_birthday <span class="token keyword">datetime</span><span class="token punctuation">,</span>s_sex <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'赵雷'</span> <span class="token punctuation">,</span> <span class="token string">'1990-01-01'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'钱电'</span> <span class="token punctuation">,</span> <span class="token string">'1990-12-21'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'孙风'</span> <span class="token punctuation">,</span> <span class="token string">'1990-05-20'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'04'</span> <span class="token punctuation">,</span> <span class="token string">'李云'</span> <span class="token punctuation">,</span> <span class="token string">'1990-08-06'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'05'</span> <span class="token punctuation">,</span> <span class="token string">'周梅'</span> <span class="token punctuation">,</span> <span class="token string">'1991-12-01'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'06'</span> <span class="token punctuation">,</span> <span class="token string">'吴兰'</span> <span class="token punctuation">,</span> <span class="token string">'1992-03-01'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'07'</span> <span class="token punctuation">,</span> <span class="token string">'郑竹'</span> <span class="token punctuation">,</span> <span class="token string">'1989-07-01'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'09'</span> <span class="token punctuation">,</span> <span class="token string">'张三'</span> <span class="token punctuation">,</span> <span class="token string">'2017-12-20'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'10'</span> <span class="token punctuation">,</span> <span class="token string">'李四'</span> <span class="token punctuation">,</span> <span class="token string">'2017-12-25'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'11'</span> <span class="token punctuation">,</span> <span class="token string">'李四'</span> <span class="token punctuation">,</span> <span class="token string">'2017-12-30'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'12'</span> <span class="token punctuation">,</span> <span class="token string">'赵六'</span> <span class="token punctuation">,</span> <span class="token string">'2017-01-01'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'13'</span> <span class="token punctuation">,</span> <span class="token string">'孙七'</span> <span class="token punctuation">,</span> <span class="token string">'2018-01-01'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> course<span class="token punctuation">(</span>c_id <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>c_name nVARCHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>t_id <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> course <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'语文'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> course <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'数学'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> course <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'英语'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> teacher<span class="token punctuation">(</span>t_id <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>t_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> teacher <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> teacher <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> teacher <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> score<span class="token punctuation">(</span>s_id <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>c_id <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>score <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'04'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'04'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'04'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'05'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'05'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'06'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'06'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'07'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> score <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'07'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="1__01__02__64"></a><strong>1. 查询 “<code>01</code>” 课程比 “<code>02</code>” 课程成绩高的学生的信息及课程分数</strong></h6> 
<ul><li>同一个表同一个字段值的比较,把一个表变为两个表,才能比较</li><li><strong>1.1 查询同时存在 “<code>01</code>” 课程和 “<code>02</code>” 课程的情况</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span>
            t1<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
            t2<span class="token punctuation">.</span>score<span class="token punctuation">,</span>
            t3<span class="token punctuation">.</span>score 
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span>score t2<span class="token punctuation">,</span>score t3 
        <span class="token keyword">WHERE</span> t2<span class="token punctuation">.</span>c_id<span class="token operator">=</span><span class="token string">'01'</span> 
            <span class="token operator">AND</span> t3<span class="token punctuation">.</span>c_id<span class="token operator">=</span><span class="token string">'02'</span> 
            <span class="token operator">AND</span> t2<span class="token punctuation">.</span>score<span class="token operator">&gt;</span>t3<span class="token punctuation">.</span>score 
            <span class="token operator">AND</span> t1<span class="token punctuation">.</span>s_id<span class="token operator">=</span>t2<span class="token punctuation">.</span>s_id 
            <span class="token operator">AND</span> t1<span class="token punctuation">.</span>s_id<span class="token operator">=</span>t3<span class="token punctuation">.</span>s_id
</code></pre> 
<pre><code class="prism language-python">sql <span class="token operator">=</span> <span class="token string">'SELECT t1.*,t2.score,t3.score FROM student t1,score t2,score t3 WHERE t2.c_id="01" AND t3.c_id="02" AND t2.score&gt;t3.score AND t1.s_id=t2.s_id AND t1.s_id=t3.s_id'</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> eng<span class="token punctuation">)</span>
df
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th><th>score</th><th>score</th></tr></thead><tbody><tr><td>0</td><td>02</td><td>钱电</td><td>1990-12-21</td><td>男</td><td>70.0</td><td>60.0</td></tr><tr><td>1</td><td>04</td><td>李云</td><td>1990-08-06</td><td>男</td><td>50.0</td><td>30.0</td></tr></tbody></table> 
<ul><li><strong>1.2 查询存在 <code>01</code> 课程但可能不存在 <code>02</code> 课程的情况 (不存在时显示为 <code>NULL</code>)</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            <span class="token operator">*</span> 
        <span class="token keyword">FROM</span> student t1 
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id<span class="token operator">=</span>t2<span class="token punctuation">.</span>s_id <span class="token operator">AND</span> t2<span class="token punctuation">.</span>c_id<span class="token operator">=</span><span class="token string">'01'</span>
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score t3 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id<span class="token operator">=</span>t3<span class="token punctuation">.</span>s_id <span class="token operator">AND</span> t3<span class="token punctuation">.</span>c_id<span class="token operator">=</span><span class="token string">'02'</span>
            <span class="token operator">AND</span> t2<span class="token punctuation">.</span>score<span class="token operator">&gt;</span>t3<span class="token punctuation">.</span>score 
            <span class="token operator">AND</span> t2<span class="token punctuation">.</span>s_id <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th><th>s_id</th><th>c_id</th><th>score</th><th>s_id</th><th>c_id</th><th>score</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>赵雷</td><td>1990-01-01</td><td>男</td><td>01</td><td>01</td><td>80.0</td><td>None</td><td>None</td><td>NaN</td></tr><tr><td>1</td><td>02</td><td>钱电</td><td>1990-12-21</td><td>男</td><td>02</td><td>01</td><td>70.0</td><td>02</td><td>02</td><td>60.0</td></tr><tr><td>2</td><td>03</td><td>孙风</td><td>1990-05-20</td><td>男</td><td>03</td><td>01</td><td>80.0</td><td>None</td><td>None</td><td>NaN</td></tr><tr><td>3</td><td>04</td><td>李云</td><td>1990-08-06</td><td>男</td><td>04</td><td>01</td><td>50.0</td><td>04</td><td>02</td><td>30.0</td></tr><tr><td>4</td><td>05</td><td>周梅</td><td>1991-12-01</td><td>女</td><td>05</td><td>01</td><td>76.0</td><td>None</td><td>None</td><td>NaN</td></tr><tr><td>5</td><td>06</td><td>吴兰</td><td>1992-03-01</td><td>女</td><td>06</td><td>01</td><td>31.0</td><td>None</td><td>None</td><td>NaN</td></tr><tr><td>6</td><td>07</td><td>郑竹</td><td>1989-07-01</td><td>女</td><td>None</td><td>None</td><td>NaN</td><td>None</td><td>None</td><td>NaN</td></tr><tr><td>7</td><td>09</td><td>张三</td><td>2017-12-20</td><td>女</td><td>None</td><td>None</td><td>NaN</td><td>None</td><td>None</td><td>NaN</td></tr><tr><td>8</td><td>10</td><td>李四</td><td>2017-12-25</td><td>女</td><td>None</td><td>None</td><td>NaN</td><td>None</td><td>None</td><td>NaN</td></tr><tr><td>9</td><td>11</td><td>李四</td><td>2017-12-30</td><td>女</td><td>None</td><td>None</td><td>NaN</td><td>None</td><td>None</td><td>NaN</td></tr><tr><td>10</td><td>12</td><td>赵六</td><td>2017-01-01</td><td>女</td><td>None</td><td>None</td><td>NaN</td><td>None</td><td>None</td><td>NaN</td></tr><tr><td>11</td><td>13</td><td>孙七</td><td>2018-01-01</td><td>女</td><td>None</td><td>None</td><td>NaN</td><td>None</td><td>None</td><td>NaN</td></tr></tbody></table> 
<h6><a id="2__60__123"></a><strong>2. 查询平均成绩大于等于 <code>60</code> 分的同学的学生编号和学生姓名和平均成绩</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
            <span class="token function">AVG</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> 
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span>score t2 
        <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>s_id<span class="token operator">=</span>t2<span class="token punctuation">.</span>s_id 
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>s_id
        <span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">60</span> 
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token function">AVG</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>AVG(t2.score)</th></tr></thead><tbody><tr><td>0</td><td>07</td><td>郑竹</td><td>93.50000</td></tr><tr><td>1</td><td>01</td><td>赵雷</td><td>89.66667</td></tr><tr><td>2</td><td>05</td><td>周梅</td><td>81.50000</td></tr><tr><td>3</td><td>03</td><td>孙风</td><td>80.00000</td></tr><tr><td>4</td><td>02</td><td>钱电</td><td>70.00000</td></tr></tbody></table> 
<h6><a id="3__score__145"></a><strong>3. 查询在 <code>score</code> 表存在成绩的学生信息</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            <span class="token keyword">DISTINCT</span> t1<span class="token punctuation">.</span><span class="token operator">*</span> 
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span>score t2 
        <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>s_id<span class="token operator">=</span>t2<span class="token punctuation">.</span>s_id 
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>s_id<span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>赵雷</td><td>1990-01-01</td><td>男</td></tr><tr><td>1</td><td>02</td><td>钱电</td><td>1990-12-21</td><td>男</td></tr><tr><td>2</td><td>03</td><td>孙风</td><td>1990-05-20</td><td>男</td></tr><tr><td>3</td><td>04</td><td>李云</td><td>1990-08-06</td><td>男</td></tr><tr><td>4</td><td>05</td><td>周梅</td><td>1991-12-01</td><td>女</td></tr><tr><td>5</td><td>06</td><td>吴兰</td><td>1992-03-01</td><td>女</td></tr><tr><td>6</td><td>07</td><td>郑竹</td><td>1989-07-01</td><td>女</td></tr></tbody></table> 
<h6><a id="4__NULL_165"></a><strong>4.查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩 (没成绩的显示为 <code>NULL</code>)</strong></h6> 
<ul><li><strong>4.1查询有成绩的SQL</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
            <span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">SUM</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> 
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span>score t2 
        <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>s_id<span class="token operator">=</span>t2<span class="token punctuation">.</span>s_id 
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>s_id<span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th><th>COUNT(t2.score)</th><th>SUM(t2.score)</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>赵雷</td><td>1990-01-01</td><td>男</td><td>3</td><td>269.0</td></tr><tr><td>1</td><td>02</td><td>钱电</td><td>1990-12-21</td><td>男</td><td>3</td><td>210.0</td></tr><tr><td>2</td><td>03</td><td>孙风</td><td>1990-05-20</td><td>男</td><td>3</td><td>240.0</td></tr><tr><td>3</td><td>04</td><td>李云</td><td>1990-08-06</td><td>男</td><td>3</td><td>100.0</td></tr><tr><td>4</td><td>05</td><td>周梅</td><td>1991-12-01</td><td>女</td><td>2</td><td>163.0</td></tr><tr><td>5</td><td>06</td><td>吴兰</td><td>1992-03-01</td><td>女</td><td>2</td><td>65.0</td></tr><tr><td>6</td><td>07</td><td>郑竹</td><td>1989-07-01</td><td>女</td><td>2</td><td>187.0</td></tr></tbody></table> 
<ul><li><strong>4.2 查询所有(包括有成绩和无成绩)的SQL</strong></li></ul> 
<pre><code class="prism language-sql">    <span class="token keyword">SELECT</span> 
        t1<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
        <span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">SUM</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> 
    <span class="token keyword">FROM</span> student t1 
    <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id<span class="token operator">=</span>t2<span class="token punctuation">.</span>s_id 
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>s_id<span class="token punctuation">;</span>
</code></pre> 
<ul><li>表格较长，只截取部分</li></ul> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th><th>COUNT(t2.score)</th><th>SUM(t2.score)</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>赵雷</td><td>1990-01-01</td><td>男</td><td>3</td><td>269.0</td></tr><tr><td>1</td><td>02</td><td>钱电</td><td>1990-12-21</td><td>男</td><td>3</td><td>210.0</td></tr><tr><td>2</td><td>03</td><td>孙风</td><td>1990-05-20</td><td>男</td><td>3</td><td>240.0</td></tr><tr><td>3</td><td>04</td><td>李云</td><td>1990-08-06</td><td>男</td><td>3</td><td>100.0</td></tr><tr><td>4</td><td>05</td><td>周梅</td><td>1991-12-01</td><td>女</td><td>2</td><td>163.0</td></tr><tr><td>5</td><td>06</td><td>吴兰</td><td>1992-03-01</td><td>女</td><td>2</td><td>65.0</td></tr><tr><td>6</td><td>07</td><td>郑竹</td><td>1989-07-01</td><td>女</td><td>2</td><td>187.0</td></tr><tr><td>7</td><td>09</td><td>张三</td><td>2017-12-20</td><td>女</td><td>0</td><td>NaN</td></tr><tr><td>8</td><td>10</td><td>李四</td><td>2017-12-25</td><td>女</td><td>0</td><td>NaN</td></tr></tbody></table> 
<h6><a id="5__215"></a><strong>5. 查询「李」姓老师的数量</strong></h6> 
<pre><code class="prism language-sql">    <span class="token keyword">SELECT</span> 
        <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 
    <span class="token keyword">FROM</span> teacher t1<span class="token punctuation">.</span>t_name 
    WHEREt1 <span class="token operator">like</span> <span class="token string">'李%'</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>COUNT(*)</th></tr></thead><tbody><tr><td>0</td><td>1</td></tr></tbody></table> 
<h6><a id="6_228"></a><strong>6.查询学过「张三」老师授课的同学的信息</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span><span class="token operator">*</span> 
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span> teacher t2<span class="token punctuation">,</span>course t3<span class="token punctuation">,</span>score t4 
        <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>s_id<span class="token operator">=</span>t4<span class="token punctuation">.</span>s_id
            <span class="token operator">AND</span> t4<span class="token punctuation">.</span>c_id<span class="token operator">=</span>t3<span class="token punctuation">.</span>c_id
            <span class="token operator">AND</span> t3<span class="token punctuation">.</span>t_id<span class="token operator">=</span>t2<span class="token punctuation">.</span>t_id
            <span class="token operator">AND</span> t2<span class="token punctuation">.</span>t_name<span class="token operator">=</span><span class="token string">'张三'</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>赵雷</td><td>1990-01-01</td><td>男</td></tr><tr><td>1</td><td>02</td><td>钱电</td><td>1990-12-21</td><td>男</td></tr><tr><td>2</td><td>03</td><td>孙风</td><td>1990-05-20</td><td>男</td></tr><tr><td>3</td><td>04</td><td>李云</td><td>1990-08-06</td><td>男</td></tr><tr><td>4</td><td>05</td><td>周梅</td><td>1991-12-01</td><td>女</td></tr><tr><td>5</td><td>07</td><td>郑竹</td><td>1989-07-01</td><td>女</td></tr></tbody></table> 
<h6><a id="7_249"></a><strong>7.查询没有学全所有课程的同学的信息</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            <span class="token operator">*</span> 
        <span class="token keyword">FROM</span> student
        <span class="token keyword">WHERE</span> s_id <span class="token operator">NOT</span> <span class="token operator">IN</span> 
            <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> 
                    s_id 
                <span class="token keyword">FROM</span> score 
                <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> s_id
                <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>c_id<span class="token punctuation">)</span><span class="token operator">=</span>
                    <span class="token punctuation">(</span>
                        <span class="token keyword">SELECT</span> 
                            <span class="token function">COUNT</span><span class="token punctuation">(</span>c_id<span class="token punctuation">)</span> 
                        <span class="token keyword">FROM</span> course
                    <span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th></tr></thead><tbody><tr><td>0</td><td>05</td><td>周梅</td><td>1991-12-01</td><td>女</td></tr><tr><td>1</td><td>06</td><td>吴兰</td><td>1992-03-01</td><td>女</td></tr><tr><td>2</td><td>07</td><td>郑竹</td><td>1989-07-01</td><td>女</td></tr><tr><td>3</td><td>09</td><td>张三</td><td>2017-12-20</td><td>女</td></tr><tr><td>4</td><td>10</td><td>李四</td><td>2017-12-25</td><td>女</td></tr><tr><td>5</td><td>11</td><td>李四</td><td>2017-12-30</td><td>女</td></tr><tr><td>6</td><td>12</td><td>赵六</td><td>2017-01-01</td><td>女</td></tr><tr><td>7</td><td>13</td><td>孙七</td><td>2018-01-01</td><td>女</td></tr></tbody></table> 
<h6><a id="8_01__281"></a><strong>8.查询至少有一门课与学号为 “01” 的同学所学相同的同学的信息</strong></h6> 
<ul><li><strong>解法一</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            <span class="token operator">*</span> 
        <span class="token keyword">FROM</span> student
        WHEREs_id <span class="token operator">IN</span>
            <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> 
                    t2<span class="token punctuation">.</span>s_id 
                <span class="token keyword">FROM</span> score t2
                <span class="token keyword">WHERE</span> t2<span class="token punctuation">.</span>c_id <span class="token operator">IN</span>
                    <span class="token punctuation">(</span>
                        <span class="token keyword">SELECT</span> 
                            t2<span class="token punctuation">.</span>c_id 
                        <span class="token keyword">FROM</span> score t2
                        <span class="token keyword">WHERE</span> t2<span class="token punctuation">.</span>s_id <span class="token operator">=</span> <span class="token string">'01'</span>
                    <span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
</code></pre> 
<ul><li>解法2</li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            <span class="token keyword">DISTINCT</span> t1<span class="token punctuation">.</span><span class="token operator">*</span> 
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span> score t2
        <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
            <span class="token operator">AND</span> t2<span class="token punctuation">.</span>c_id <span class="token operator">IN</span>
                <span class="token punctuation">(</span>
                    <span class="token keyword">SELECT</span> 
                        t2<span class="token punctuation">.</span>c_id 
                    <span class="token keyword">FROM</span> score t2
                    <span class="token keyword">WHERE</span> t2<span class="token punctuation">.</span>s_id <span class="token operator">=</span> <span class="token string">'01'</span>
                <span class="token punctuation">)</span>
            <span class="token operator">AND</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">&lt;&gt;</span> <span class="token string">'01'</span><span class="token punctuation">;</span>

<span class="token operator">|</span>   <span class="token operator">|</span> s_id <span class="token operator">|</span> s_name <span class="token operator">|</span> s_birthday      <span class="token operator">|</span> s_sex <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token operator">-</span> <span class="token operator">|</span> <span class="token comment">--- | ------ | ---------- | ----- |</span>
<span class="token operator">|</span> <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> 赵雷 <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> 钱电 <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">21</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2</span> <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> 孙风 <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">20</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">3</span> <span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> 李云 <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">06</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">4</span> <span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> 周梅 <span class="token operator">|</span> <span class="token number">1991</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">01</span> <span class="token operator">|</span> 女   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">5</span> <span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> 吴兰 <span class="token operator">|</span> <span class="token number">1992</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">01</span> <span class="token operator">|</span> 女   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">6</span> <span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> 郑竹 <span class="token operator">|</span> <span class="token number">1989</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">01</span> <span class="token operator">|</span> 女   <span class="token operator">|</span>

<span class="token comment">##### **9. 查询和 "01" 号的同学学习的课程完全相同的其他同学的信息**</span>

<span class="token operator">*</span> 解法<span class="token number">1</span>
<span class="token identifier"><span class="token punctuation">`</span><span class="token punctuation">`</span></span><span class="token punctuation">`</span><span class="token keyword">sql</span>
        <span class="token keyword">SELECT</span> 
            <span class="token keyword">DISTINCT</span> t1<span class="token punctuation">.</span><span class="token operator">*</span> 
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span>score t2
        <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
        <span class="token operator">AND</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">&lt;&gt;</span> <span class="token string">'01'</span>
        <span class="token operator">AND</span> t2<span class="token punctuation">.</span>c_id <span class="token operator">IN</span> 
            <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> 
                    <span class="token keyword">DISTINCT</span> t3<span class="token punctuation">.</span>c_id 
                <span class="token keyword">FROM</span> score t3
                <span class="token keyword">WHERE</span> t3<span class="token punctuation">.</span>s_id <span class="token operator">=</span> <span class="token string">'01'</span>
            <span class="token punctuation">)</span>
</code></pre> 
<ul><li><strong>解法二</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            student<span class="token punctuation">.</span><span class="token operator">*</span> 
        <span class="token keyword">FROM</span> student 
        <span class="token keyword">WHERE</span> s_id <span class="token operator">IN</span> 
            <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> 
                    <span class="token keyword">DISTINCT</span> sc<span class="token punctuation">.</span>s_id 
                <span class="token keyword">FROM</span> sc
                <span class="token keyword">WHERE</span> s_id <span class="token operator">&lt;&gt;</span> <span class="token string">'01'</span>
                    <span class="token operator">AND</span> sc<span class="token punctuation">.</span>c_id <span class="token operator">IN</span> 
                        <span class="token punctuation">(</span>
                            <span class="token keyword">SELECT</span> 
                                c_id 
                            <span class="token keyword">FROM</span> sc
                            WHEREs_id <span class="token operator">=</span> <span class="token string">'01'</span>
                        <span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th></tr></thead><tbody><tr><td>0</td><td>02</td><td>钱电</td><td>1990-12-21</td><td>男</td></tr><tr><td>1</td><td>03</td><td>孙风</td><td>1990-05-20</td><td>男</td></tr><tr><td>2</td><td>04</td><td>李云</td><td>1990-08-06</td><td>男</td></tr><tr><td>3</td><td>05</td><td>周梅</td><td>1991-12-01</td><td>女</td></tr><tr><td>4</td><td>06</td><td>吴兰</td><td>1992-03-01</td><td>女</td></tr><tr><td>5</td><td>07</td><td>郑竹</td><td>1989-07-01</td><td>女</td></tr></tbody></table> 
<h6><a id="10____379"></a><strong>10. 查询没学过 “张三” 老师讲授的任一门课程的学生姓名</strong></h6> 
<ul><li><strong>解法一</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            <span class="token keyword">DISTINCT</span> t1<span class="token punctuation">.</span>s_name 
        <span class="token keyword">FROM</span> student t1
        <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">NOT</span> <span class="token operator">IN</span>
            <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> 
                    t2<span class="token punctuation">.</span>s_id 
                <span class="token keyword">FROM</span> score t2<span class="token punctuation">,</span> course t3
                <span class="token keyword">WHERE</span> t2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t3<span class="token punctuation">.</span>c_id
                    <span class="token operator">AND</span> t3<span class="token punctuation">.</span>t_id <span class="token operator">IN</span>
                        <span class="token punctuation">(</span>
                            <span class="token keyword">SELECT</span> 
                                t4<span class="token punctuation">.</span>t_id 
                            <span class="token keyword">FROM</span> teacher t4
                            WHEREt_name <span class="token operator">=</span> <span class="token string">'张三'</span>
                        <span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li><strong>解法二</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            <span class="token keyword">DISTINCT</span> t1<span class="token punctuation">.</span>s_name 
        <span class="token keyword">FROM</span> student t1
        <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">NOT</span> <span class="token operator">IN</span>
            <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> 
                    t2<span class="token punctuation">.</span>s_id 
                <span class="token keyword">FROM</span> score t2<span class="token punctuation">,</span> course t3<span class="token punctuation">,</span> teacher t4
                WHEREt2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t3<span class="token punctuation">.</span>c_id
                    <span class="token operator">AND</span> t3<span class="token punctuation">.</span>t_id <span class="token operator">=</span> t4<span class="token punctuation">.</span>t_id
                    <span class="token operator">AND</span> t4<span class="token punctuation">.</span>t_name <span class="token operator">=</span> <span class="token string">'张三'</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_name</th></tr></thead><tbody><tr><td>0</td><td>吴兰</td></tr><tr><td>1</td><td>张三</td></tr><tr><td>2</td><td>李四</td></tr><tr><td>3</td><td>赵六</td></tr><tr><td>4</td><td>孙七</td></tr></tbody></table> 
<h6><a id="11_428"></a><strong>11.查询两门及其以上不及格课程的同学的学号,姓名及其平均成绩</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
            <span class="token function">AVG</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> 
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span>score t2
        <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
            <span class="token operator">AND</span> t2<span class="token punctuation">.</span>score <span class="token operator">&lt;</span> <span class="token number">60</span>
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span><span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th>s_id</th><th>s_name</th><th>AVG(t2.score)</th></tr></thead><tbody><tr><td>0</td><td>04</td><td>李云</td></tr><tr><td>1</td><td>06</td><td>吴兰</td></tr></tbody></table> 
<h6><a id="12_01__60_447"></a><strong>12.检索 “<code>01</code>” 课程分数小于 <code>60</code>,按分数降序排列的学生信息</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
            t2<span class="token punctuation">.</span>score 
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span>score t2
        <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id 
            <span class="token operator">AND</span> t2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token string">'01'</span>
            <span class="token operator">AND</span> score <span class="token operator">&lt;</span><span class="token number">60</span>
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>score <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th><th>score</th></tr></thead><tbody><tr><td>0</td><td>04</td><td>李云</td><td>1990-08-06</td><td>男</td><td>50.0</td></tr><tr><td>1</td><td>06</td><td>吴兰</td><td>1992-03-01</td><td>女</td><td>31.0</td></tr></tbody></table> 
<h6><a id="13__465"></a><strong>13. 按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
            t3<span class="token punctuation">.</span>avgscore 
        <span class="token keyword">FROM</span> score t1 
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> 
            <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> 
                    t2<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
                    <span class="token function">AVG</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> avgscore 
                <span class="token keyword">FROM</span> score t2 
                <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>s_id
            <span class="token punctuation">)</span> 
        <span class="token keyword">AS</span> t3 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t3<span class="token punctuation">.</span>s_id       
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t3<span class="token punctuation">.</span>avgscore <span class="token keyword">DESC</span><span class="token punctuation">;</span> 
</code></pre> 
<ul><li>表格较长，只截取部分</li></ul> 
<table><thead><tr><th>s_id</th><th>c_id</th><th>score</th><th>avgscore</th></tr></thead><tbody><tr><td>0</td><td>07</td><td>02</td><td>89.0</td></tr><tr><td>1</td><td>07</td><td>03</td><td>98.0</td></tr><tr><td>2</td><td>01</td><td>01</td><td>80.0</td></tr><tr><td>3</td><td>01</td><td>02</td><td>90.0</td></tr><tr><td>4</td><td>01</td><td>03</td><td>99.0</td></tr><tr><td>5</td><td>05</td><td>01</td><td>76.0</td></tr></tbody></table> 
<h6><a id="14__495"></a><strong>14. 查询各科成绩最高分、最低分和平均分:</strong></h6> 
<pre><code>#以如下形式显示：课程 ID,课程 name,最高分,最低分,平均分,及格率,中等率,优良率,优秀率
#及格为 &gt;=60,中等为：70-80,优良为：80-90,优秀为：&gt;=90
#要求输出课程号和选修人数,查询结果按人数降序排列,若人数相同,按课程号升序排列
</code></pre> 
<pre><code class="prism language-sql">    <span class="token keyword">SELECT</span> 
        t1<span class="token punctuation">.</span>c_id <span class="token keyword">AS</span> 课程ID<span class="token punctuation">,</span>
        <span class="token function">MAX</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 最高分<span class="token punctuation">,</span>
        <span class="token function">MIN</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 最低分<span class="token punctuation">,</span>
        <span class="token function">AVG</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 平均分<span class="token punctuation">,</span>
        <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 选修人数<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t1<span class="token punctuation">.</span>score<span class="token operator">&gt;=</span><span class="token number">60</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 及格率<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t1<span class="token punctuation">.</span>score<span class="token operator">&gt;=</span><span class="token number">70</span> <span class="token operator">AND</span> t1<span class="token punctuation">.</span>score<span class="token operator">&lt;</span><span class="token number">80</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 中等率<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t1<span class="token punctuation">.</span>score<span class="token operator">&gt;=</span><span class="token number">80</span> <span class="token operator">AND</span> t1<span class="token punctuation">.</span>score<span class="token operator">&lt;</span><span class="token number">90</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 优良率<span class="token punctuation">,</span>
    <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t1<span class="token punctuation">.</span>score<span class="token operator">&gt;</span><span class="token number">90</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 优秀率
    <span class="token keyword">FROM</span> score t1
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>c_id
    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>c_id <span class="token keyword">ASC</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>课程ID</th><th>最高分</th><th>最低分</th><th>平均分</th><th>选修人数</th><th>及格率</th><th>中等率</th><th>优良率</th><th>优秀率</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>80.0</td><td>31.0</td><td>64.50000</td><td>6</td><td>0.6667</td><td>0.3333</td><td>0.3333</td><td>0.0000</td></tr><tr><td>1</td><td>02</td><td>90.0</td><td>30.0</td><td>72.66667</td><td>6</td><td>0.8333</td><td>0.0000</td><td>0.5000</td><td>0.0000</td></tr><tr><td>2</td><td>03</td><td>99.0</td><td>20.0</td><td>68.50000</td><td>6</td><td>0.6667</td><td>0.0000</td><td>0.3333</td><td>0.3333</td></tr></tbody></table> 
<h6><a id="15_score__523"></a><strong>15.按各科成绩进行排序，并显示排名， <code>score</code> 重复时保留名次空缺</strong></h6> 
<ul><li><strong>解法一</strong></li></ul> 
<pre><code class="prism language-sql">      <span class="token keyword">SELECT</span> 
        t1<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
        <span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span> <span class="token keyword">AS</span> 排名
      <span class="token keyword">FROM</span> score t1
      <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>score<span class="token operator">&lt;</span>t2<span class="token punctuation">.</span>score 
        <span class="token operator">AND</span> t1<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>c_id
      <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>score
      <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span> 排名 <span class="token keyword">ASC</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li><strong>解法二</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span> 
            <span class="token keyword">CASE</span> 
                <span class="token keyword">WHEN</span> <span class="token variable">@fontscore</span> <span class="token operator">=</span> score <span class="token keyword">THEN</span> <span class="token variable">@currank</span>
                <span class="token keyword">WHEN</span> <span class="token variable">@fontscore</span> :<span class="token operator">=</span> score <span class="token keyword">THEN</span> <span class="token variable">@currank</span>:<span class="token operator">=</span><span class="token variable">@currank</span><span class="token operator">+</span><span class="token number">1</span>
                <span class="token keyword">END</span> 
            <span class="token keyword">AS</span> 排名<span class="token punctuation">,</span> 
            t1<span class="token punctuation">.</span>score 
        <span class="token keyword">FROM</span> 
        <span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> 
                <span class="token variable">@currank</span>:<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> 
                <span class="token variable">@fontage</span>:<span class="token operator">=</span><span class="token boolean">NULL</span>
        <span class="token punctuation">)</span>
        <span class="token keyword">AS</span> t2<span class="token punctuation">,</span> score t1
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>score <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>c_id</th><th>排名</th><th>score</th></tr></thead><tbody><tr><td>0</td><td>03</td><td>1</td><td>99.0</td></tr><tr><td>1</td><td>03</td><td>2</td><td>98.0</td></tr><tr><td>2</td><td>02</td><td>3</td><td>90.0</td></tr><tr><td>3</td><td>02</td><td>4</td><td>89.0</td></tr><tr><td>4</td><td>02</td><td>5</td><td>87.0</td></tr></tbody></table> 
<h6><a id="16__567"></a><strong>16. 查询学生的总成绩，并进行排名，总分重复时保留名次空缺</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SET</span> <span class="token variable">@crank</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> 
            total<span class="token punctuation">,</span> 
            <span class="token variable">@crank</span> :<span class="token operator">=</span> <span class="token variable">@crank</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">AS</span> 排名 
        <span class="token keyword">FROM</span> 
            <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> 
                    t2<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> 
                    <span class="token function">SUM</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> total 
                <span class="token keyword">FROM</span> score t2
                <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>s_id
                <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> total <span class="token keyword">DESC</span>
            <span class="token punctuation">)</span> <span class="token keyword">AS</span> t1<span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th>s_id</th><th>total</th><th>排名</th></tr></thead><tbody><tr><td>01</td><td>269.0</td><td>1</td></tr><tr><td>03</td><td>240.0</td><td>2</td></tr><tr><td>02</td><td>210.0</td><td>3</td></tr><tr><td>07</td><td>187.0</td><td>4</td></tr><tr><td>05</td><td>163.0</td><td>5</td></tr><tr><td>04</td><td>100.0</td><td>6</td></tr><tr><td>06</td><td>65.0</td><td>7</td></tr></tbody></table> 
<h6><a id="17_1008585707060600__597"></a><strong>17. 统计各科成绩各分数段人数：课程编号，课程名称，[<code>100-85</code>]，[<code>85-70</code>]，[<code>70-60</code>]，[<code>60-0</code>] 及所占百分比</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>c_name<span class="token punctuation">,</span>
            <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t2<span class="token punctuation">.</span>score <span class="token operator">&lt;=</span><span class="token number">100</span> <span class="token operator">AND</span> t2<span class="token punctuation">.</span>score <span class="token operator">&gt;</span> <span class="token number">85</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">"100-85"</span><span class="token punctuation">,</span>
            <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t2<span class="token punctuation">.</span>score <span class="token operator">&lt;=</span><span class="token number">85</span> <span class="token operator">AND</span> t2<span class="token punctuation">.</span>score <span class="token operator">&gt;</span> <span class="token number">70</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">"85-70"</span><span class="token punctuation">,</span>
            <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t2<span class="token punctuation">.</span>score <span class="token operator">&lt;=</span><span class="token number">70</span> <span class="token operator">AND</span> t2<span class="token punctuation">.</span>score <span class="token operator">&gt;</span> <span class="token number">60</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">"70-60"</span><span class="token punctuation">,</span>
            <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> t2<span class="token punctuation">.</span>score <span class="token operator">&lt;=</span><span class="token number">60</span> <span class="token operator">AND</span> t2<span class="token punctuation">.</span>score <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">"60-0"</span> 
        <span class="token keyword">FROM</span> course t1 <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span>  score t2  <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>c_id
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>c_id<span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>c_id</th><th>c_name</th><th>100-85</th><th>85-70</th><th>70-60</th><th>60-0</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>语文</td><td>0.0</td><td>3.0</td><td>1.0</td><td>2.0</td></tr><tr><td>1</td><td>02</td><td>数学</td><td>3.0</td><td>1.0</td><td>0.0</td><td>2.0</td></tr><tr><td>2</td><td>03</td><td>英语</td><td>2.0</td><td>2.0</td><td>0.0</td><td>2.0</td></tr></tbody></table> 
<ul><li> <p><strong>18. 查询各科成绩前三名的记录</strong></p> </li><li> <p><strong>解法一</strong></p> </li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            <span class="token operator">*</span> 
        <span class="token keyword">FROM</span> score t1
        <span class="token keyword">WHERE</span>
            <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> 
                    <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
                <span class="token keyword">FROM</span> score t2
                <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>c_id
                    <span class="token operator">AND</span> t1<span class="token punctuation">.</span>score <span class="token operator">&lt;</span> t2<span class="token punctuation">.</span>score
            <span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">3</span>
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> c_id <span class="token keyword">ASC</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>score <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li><strong>解法二</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span><span class="token operator">*</span> 
        <span class="token keyword">FROM</span> score t1
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>c_id
            <span class="token operator">AND</span> t1<span class="token punctuation">.</span>score <span class="token operator">&lt;</span> t2<span class="token punctuation">.</span>score
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>c_id<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>s_id
        <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>c_id<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">3</span>
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>c_id<span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>c_id</th><th>score</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>01</td><td>80.0</td></tr><tr><td>1</td><td>03</td><td>01</td><td>80.0</td></tr><tr><td>2</td><td>05</td><td>01</td><td>76.0</td></tr><tr><td>3</td><td>01</td><td>02</td><td>90.0</td></tr><tr><td>4</td><td>07</td><td>02</td><td>90.0</td></tr><tr><td>5</td><td>05</td><td>02</td><td>87.0</td></tr><tr><td>6</td><td>01</td><td>03</td><td>99.0</td></tr><tr><td>7</td><td>07</td><td>03</td><td>98.0</td></tr><tr><td>8</td><td>02</td><td>03</td><td>80.0</td></tr><tr><td>9</td><td>03</td><td>03</td><td>80.0</td></tr></tbody></table> 
<h6><a id="19__662"></a><strong>19. 查询每门课程被选修的学生数</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            c_id<span class="token punctuation">,</span> 
        <span class="token function">COUNT</span><span class="token punctuation">(</span>s_id<span class="token punctuation">)</span> 
        <span class="token keyword">FROM</span> score <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> c_id 
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> c_id <span class="token keyword">ASC</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>c_id</th><th>COUNT(s_id)</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>6</td></tr><tr><td>1</td><td>02</td><td>6</td></tr><tr><td>2</td><td>03</td><td>6</td></tr></tbody></table> 
<h6><a id="20__678"></a><strong>20. 查询出只选修两门课程的学生学号和姓名</strong></h6> 
<ul><li><strong>解法一</strong>: 嵌套查询</li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>s_name 
        <span class="token keyword">FROM</span> student t1
        <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">IN</span> 
            <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> 
                    t2<span class="token punctuation">.</span>s_id 
                <span class="token keyword">FROM</span> score t2
                <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>s_id
                <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>c_id<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li><strong>解法二</strong>:多表关联查询</li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>s_name 
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span>score t2
        <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>c_id<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th></tr></thead><tbody><tr><td>0</td><td>05</td><td>周梅</td></tr><tr><td>1</td><td>06</td><td>吴兰</td></tr><tr><td>2</td><td>07</td><td>郑竹</td></tr></tbody></table> 
<h6><a id="21__715"></a><strong>21. 查询男生、女生人数</strong></h6> 
<ul><li><strong>解法一</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            s_sex<span class="token punctuation">,</span> 
            <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 
        <span class="token keyword">FROM</span> student 
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> s_sex<span class="token punctuation">;</span>
</code></pre> 
<ul><li><strong>解法二</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span>
            <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> s_sex <span class="token operator">=</span> <span class="token string">'男'</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> 男<span class="token punctuation">,</span>
            <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> s_sex <span class="token operator">=</span> <span class="token string">'女'</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> 女
        <span class="token keyword">FROM</span> student<span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_sex</th><th>COUNT(*)</th></tr></thead><tbody><tr><td>0</td><td>男</td><td>4</td></tr><tr><td>1</td><td>女</td><td>8</td></tr></tbody></table> 
<table><thead><tr><th></th><th>男</th><th>女</th></tr></thead><tbody><tr><td>0</td><td>4.0</td><td>8.0</td></tr></tbody></table> 
<h6><a id="22__745"></a><strong>22. 查询名字中含有「风」字的学生信息</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            <span class="token operator">*</span> 
        <span class="token keyword">FROM</span> student 
        <span class="token keyword">WHERE</span> s_name <span class="token operator">LIKE</span> <span class="token string">'%风%'</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th></tr></thead><tbody><tr><td>0</td><td>03</td><td>孙风</td><td>1990-05-20</td><td>男</td></tr></tbody></table> 
<h6><a id="23__758"></a><strong>23. 查询同名学生名单，并统计同名人数</strong></h6> 
<ul><li><strong>解法一</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            <span class="token operator">*</span><span class="token punctuation">,</span> 
            <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 
        <span class="token keyword">FROM</span> student 
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> s_name 
        <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li><strong>解法二</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            <span class="token operator">*</span><span class="token punctuation">,</span>
            <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 
        <span class="token keyword">FROM</span> student 
        WHEREs_name <span class="token operator">IN</span> 
            <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> 
                    s_name 
                <span class="token keyword">FROM</span> student
                <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> s_name
                <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th><th>COUNT(*)</th></tr></thead><tbody><tr><td>0</td><td>10</td><td>李四</td><td>2017-12-25</td><td>女</td><td>2</td></tr></tbody></table> 
<h6><a id="24__1990__792"></a><strong>24. 查询 1990 年出生的学生名单</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            <span class="token operator">*</span> 
        <span class="token keyword">FROM</span> student 
        WHEREYEAR<span class="token punctuation">(</span>s_birthday<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1990</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>赵雷</td><td>1990-01-01</td><td>男</td></tr><tr><td>1</td><td>02</td><td>钱电</td><td>1990-12-21</td><td>男</td></tr><tr><td>2</td><td>03</td><td>孙风</td><td>1990-05-20</td><td>男</td></tr><tr><td>3</td><td>04</td><td>李云</td><td>1990-08-06</td><td>男</td></tr></tbody></table> 
<h6><a id="25_808"></a>25.查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列</h6> 
<ul><li><strong>解法一</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> 
            t1<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span> 
            <span class="token function">AVG</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 平均成绩 
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span> score t2
        <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">85</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li><strong>解法二</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> 
            t1<span class="token punctuation">.</span>s_name<span class="token punctuation">,</span>
            <span class="token function">AVG</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 平均成绩 
        <span class="token keyword">FROM</span> student t1
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">85</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>平均成绩</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>赵雷</td><td>89.66667</td></tr><tr><td>1</td><td>07</td><td>郑竹</td><td>94.00000</td></tr></tbody></table> 
<h6><a id="26_85__841"></a>26.查询平均成绩大于等于 85 的所有学生的学号、姓名和平均成绩</h6> 
<pre><code class="prism language-sql">    <span class="token keyword">SELECT</span> 
        t1<span class="token punctuation">.</span>sid <span class="token keyword">AS</span> 学号<span class="token punctuation">,</span>
        t1<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> 姓名<span class="token punctuation">,</span>   
        <span class="token function">AVG</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 平均成绩
    <span class="token keyword">FROM</span> student t1
    <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> sc t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>sid <span class="token operator">=</span> t2<span class="token punctuation">.</span>sid
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>sid
    <span class="token keyword">HAVING</span> 平均成绩 <span class="token operator">&gt;=</span> <span class="token number">85</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-python">sql <span class="token operator">=</span> <span class="token string">'SELECT t1.s_id, t1.s_name, AVG(t2.score) AS 平均成绩 FROM student t1, score t2 WHERE t1.s_id = t2.s_id GROUP BY t2.s_id HAVING AVG(t2.score) &gt;= 85'</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> eng<span class="token punctuation">)</span>
df
</code></pre> 
<table border="1" class="dataframe"><thead><tr><th></th><th>s_id</th><th>s_name</th><th>平均成绩</th></tr></thead><tbody><tr><th>0</th><td>01</td><td>赵雷</td><td>89.66667</td></tr><tr><th>1</th><td>07</td><td>郑竹</td><td>93.50000</td></tr></tbody></table> 
<h6><a id="27__60__890"></a><strong>27. 查询课程名称为「数学」，且分数低于 60 的学生姓名和分数</strong></h6> 
<ul><li><strong>解法一</strong>:</li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> 学生姓名<span class="token punctuation">,</span> 
            t3<span class="token punctuation">.</span>c_name <span class="token keyword">AS</span> 课程<span class="token punctuation">,</span>
            t2<span class="token punctuation">.</span>score <span class="token keyword">AS</span> 分数
        <span class="token keyword">FROM</span> student t1
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> course t3 <span class="token keyword">ON</span> t2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t3<span class="token punctuation">.</span>c_id
        WHEREt3<span class="token punctuation">.</span>c_name <span class="token operator">=</span> <span class="token string">'数学'</span>
            <span class="token operator">AND</span> t2<span class="token punctuation">.</span>score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li><strong>解法二</strong>:</li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> 学生姓名<span class="token punctuation">,</span>
            t3<span class="token punctuation">.</span>c_name <span class="token keyword">AS</span> 课程<span class="token punctuation">,</span>
            t2<span class="token punctuation">.</span>score <span class="token keyword">AS</span> 分数
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span> score t2<span class="token punctuation">,</span> course t3
        <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
            <span class="token operator">AND</span> t2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t3<span class="token punctuation">.</span>c_id
            <span class="token operator">AND</span> t3<span class="token punctuation">.</span>c_name <span class="token operator">=</span> <span class="token string">'数学'</span>
            <span class="token operator">AND</span> t2<span class="token punctuation">.</span>score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>学生姓名</th><th>课程</th><th>分数</th></tr></thead><tbody><tr><td>0</td><td>李云</td><td>数学</td><td>30.0</td></tr></tbody></table> 
<h6><a id="28__924"></a><strong>28. 查询所有学生的课程及分数情况（存在学生没成绩，没选课的情况）</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span>
            t1<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> 学号<span class="token punctuation">,</span> 
            t1<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> 姓名<span class="token punctuation">,</span>
            t3<span class="token punctuation">.</span>c_name <span class="token keyword">AS</span> 课程<span class="token punctuation">,</span>
            t2<span class="token punctuation">.</span>c_id <span class="token keyword">AS</span> 课程编号<span class="token punctuation">,</span>
            t2<span class="token punctuation">.</span>score <span class="token keyword">AS</span> 分数
        <span class="token keyword">FROM</span> student t1    
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> course t3 <span class="token keyword">ON</span> t2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t3<span class="token punctuation">.</span>c_id
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>s_id<span class="token punctuation">,</span> t2<span class="token punctuation">.</span>c_id<span class="token punctuation">;</span>
</code></pre> 
<ul><li>表格较长，只截取部分</li></ul> 
<table><thead><tr><th></th><th>学号</th><th>姓名</th><th>课程</th><th>课程编号</th><th>分数</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>赵雷</td><td>语文</td><td>01</td><td>80.0</td></tr><tr><td>1</td><td>01</td><td>赵雷</td><td>数学</td><td>02</td><td>90.0</td></tr><tr><td>2</td><td>01</td><td>赵雷</td><td>英语</td><td>03</td><td>99.0</td></tr></tbody></table> 
<h6><a id="29__70__947"></a><strong>29. 查询任何一门课程成绩在 <code>70</code> 分以上的姓名、课程名称和分数</strong></h6> 
<ul><li><strong>解法一</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span>  
            t1<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> 姓名<span class="token punctuation">,</span>
            t3<span class="token punctuation">.</span>c_name <span class="token keyword">AS</span> 课程<span class="token punctuation">,</span>
            t2<span class="token punctuation">.</span>score <span class="token keyword">AS</span> 分数
        <span class="token keyword">FROM</span> student t1
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> course t3 <span class="token keyword">ON</span> t2<span class="token punctuation">.</span>c_id<span class="token operator">=</span>t3<span class="token punctuation">.</span>c_id
        WHEREt2<span class="token punctuation">.</span>score <span class="token operator">&gt;</span> <span class="token number">70</span>
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 姓名<span class="token punctuation">;</span>
</code></pre> 
<ul><li><strong>解法二</strong></li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span>
            t1<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> 姓名<span class="token punctuation">,</span>
            t3<span class="token punctuation">.</span>c_name <span class="token keyword">AS</span> 课程<span class="token punctuation">,</span>
            t2<span class="token punctuation">.</span>score <span class="token keyword">AS</span> 分数
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span> score t2<span class="token punctuation">,</span> course t3
        WHEREt2<span class="token punctuation">.</span>score <span class="token operator">&gt;</span> <span class="token number">70</span>
            <span class="token operator">AND</span> t2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t3<span class="token punctuation">.</span>c_id
            <span class="token operator">AND</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 姓名<span class="token punctuation">;</span>
</code></pre> 
<ul><li>表格较长，只截取部分</li></ul> 
<table><thead><tr><th></th><th>姓名</th><th>课程</th><th>分数</th></tr></thead><tbody><tr><td>0</td><td>周梅</td><td>数学</td><td>87.0</td></tr><tr><td>1</td><td>周梅</td><td>语文</td><td>76.0</td></tr><tr><td>2</td><td>孙风</td><td>英语</td><td>80.0</td></tr><tr><td>3</td><td>孙风</td><td>数学</td><td>80.0</td></tr></tbody></table> 
<h6><a id="30__986"></a><strong>30. 查询存在不及格的课程</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span>c_id <span class="token keyword">AS</span> 课程编号<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>c_name <span class="token keyword">AS</span> 课程名
        <span class="token keyword">FROM</span> course t1
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>c_id
        WHEREt2<span class="token punctuation">.</span>score <span class="token operator">&lt;</span> <span class="token number">60</span>
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 课程名
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 课程编号<span class="token punctuation">;</span>
        <span class="token comment">#这里也可以不用 GROUP BY,而在 SELECT 后加 DITINCT 来取唯一</span>
</code></pre> 
<table><thead><tr><th></th><th>课程编号</th><th>课程名</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>语文</td></tr><tr><td>1</td><td>02</td><td>数学</td></tr><tr><td>2</td><td>03</td><td>英语</td></tr></tbody></table> 
<h6><a id="31__01__80__1006"></a><strong>31. 查询课程编号为 <code>01</code> 且课程成绩在 <code>80</code> 分及以上的学生的学号和姓名</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span>
            t1<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> 学号<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> 姓名<span class="token punctuation">,</span>
            t2<span class="token punctuation">.</span>c_id <span class="token keyword">AS</span> 课程编号<span class="token punctuation">,</span>
            t2<span class="token punctuation">.</span>score <span class="token keyword">AS</span> 成绩
        <span class="token keyword">FROM</span> student t1
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
        WHEREt2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> <span class="token string">'01'</span>
        <span class="token operator">AND</span> t2<span class="token punctuation">.</span>score <span class="token operator">&gt;=</span> <span class="token number">80</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>学号</th><th>姓名</th><th>课程编号</th><th>成绩</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>赵雷</td><td>01</td><td>80.0</td></tr><tr><td>1</td><td>03</td><td>孙风</td><td>01</td><td>80.0</td></tr></tbody></table> 
<h6><a id="32__1025"></a><strong>32. 求每门课程的学生人数</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span>
            t1<span class="token punctuation">.</span>c_id <span class="token keyword">AS</span> 课程编号<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>c_name <span class="token keyword">AS</span> 课程<span class="token punctuation">,</span>
            <span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>s_id<span class="token punctuation">)</span> <span class="token keyword">AS</span> 总人数
        <span class="token keyword">FROM</span> course t1
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>c_id
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>c_id<span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>课程编号</th><th>课程</th><th>总人数</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>语文</td><td>6</td></tr><tr><td>1</td><td>02</td><td>数学</td><td>6</td></tr><tr><td>2</td><td>03</td><td>英语</td><td>6</td></tr></tbody></table> 
<h6><a id="33__1043"></a><strong>33. 成绩不重复，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</strong></h6> 
<ul><li><strong>解法一</strong>:</li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
            t4<span class="token punctuation">.</span>t_name <span class="token keyword">AS</span> 教师<span class="token punctuation">,</span>
            t3<span class="token punctuation">.</span>c_name <span class="token keyword">AS</span> 课程<span class="token punctuation">,</span>
            <span class="token function">MAX</span><span class="token punctuation">(</span>T2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 分数
        <span class="token keyword">FROM</span> student t1
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> course t3 <span class="token keyword">ON</span> t2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t3<span class="token punctuation">.</span>c_id
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> teacher t4 <span class="token keyword">ON</span> t4<span class="token punctuation">.</span>t_id <span class="token operator">=</span> t3<span class="token punctuation">.</span>t_id
        WHEREt4<span class="token punctuation">.</span>t_name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li><strong>解法二</strong>:</li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span>
            t1<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
            t2<span class="token punctuation">.</span>score<span class="token punctuation">,</span>
            t2<span class="token punctuation">.</span>c_id
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span> score t2<span class="token punctuation">,</span> course t3<span class="token punctuation">,</span> teacher t4
        WHEREt4<span class="token punctuation">.</span>t_id <span class="token operator">=</span> t3<span class="token punctuation">.</span>t_id
            <span class="token operator">AND</span> t3<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>c_id
            <span class="token operator">AND</span> t2<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t1<span class="token punctuation">.</span>s_id
            <span class="token operator">AND</span> t4<span class="token punctuation">.</span>t_name <span class="token operator">=</span> <span class="token string">'张三'</span>
        <span class="token keyword">HAVING</span> <span class="token function">MAX</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">#‘HAVING MAX(t2.score)’ 也可以写成 ‘ORDER BY t2.score DEscore LIMIT 1’</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th><th>教师</th><th>课程</th><th>分数</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>赵雷</td><td>1990-01-01</td><td>男</td><td>张三</td><td>数学</td><td>90.0</td></tr></tbody></table> 
<h6><a id="34__1080"></a><strong>34. 成绩有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</strong></h6> 
<ul><li>为了验证，让数学有两个最高分</li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">UPDATE</span> score <span class="token keyword">SET</span> score <span class="token operator">=</span> <span class="token number">90</span> WHEREc_id <span class="token operator">=</span> <span class="token string">'02'</span> <span class="token operator">AND</span> s_id <span class="token operator">=</span> <span class="token string">'07'</span><span class="token punctuation">;</span>

        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
            t4<span class="token punctuation">.</span>t_name <span class="token keyword">AS</span> 教师<span class="token punctuation">,</span>
            t3<span class="token punctuation">.</span>c_name <span class="token keyword">AS</span> 课程<span class="token punctuation">,</span>
            T2<span class="token punctuation">.</span>score <span class="token keyword">AS</span> 分数
        <span class="token keyword">FROM</span> student t1
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> course t3 <span class="token keyword">ON</span> t2<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t3<span class="token punctuation">.</span>c_id
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> teacher t4 <span class="token keyword">ON</span> t4<span class="token punctuation">.</span>t_id <span class="token operator">=</span> t3<span class="token punctuation">.</span>t_id
        WHEREt4<span class="token punctuation">.</span>t_name <span class="token operator">=</span> <span class="token string">'张三'</span>
        <span class="token operator">AND</span> t2<span class="token punctuation">.</span>score <span class="token operator">=</span> 
            <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> 
                    <span class="token function">MAX</span><span class="token punctuation">(</span>t5<span class="token punctuation">.</span>score<span class="token punctuation">)</span> 
                <span class="token keyword">FROM</span> score t5
                <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> course t6 <span class="token keyword">ON</span> t5<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t6<span class="token punctuation">.</span>c_id
                <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> teacher t7 <span class="token keyword">ON</span> t6<span class="token punctuation">.</span>t_id <span class="token operator">=</span> t7<span class="token punctuation">.</span>t_id
                <span class="token keyword">WHERE</span> t7<span class="token punctuation">.</span>t_name <span class="token operator">=</span> <span class="token string">'张三'</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th><th>教师</th><th>课程</th><th>分数</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>赵雷</td><td>1990-01-01</td><td>男</td><td>张三</td><td>数学</td><td>90.0</td></tr><tr><td>1</td><td>07</td><td>郑竹</td><td>1989-07-01</td><td>女</td><td>张三</td><td>数学</td><td>90.0</td></tr></tbody></table> 
<h6><a id="35__1113"></a><strong>35. 查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩</strong></h6> 
<ul><li>先改个数方便验证：</li></ul> 
<pre><code class="prism language-sql">        <span class="token keyword">UPDATE</span> score <span class="token keyword">SET</span> score <span class="token operator">=</span> <span class="token number">30</span> WHEREs_id <span class="token operator">=</span> <span class="token string">'04'</span> <span class="token operator">AND</span> c_id <span class="token operator">=</span> <span class="token string">'03'</span><span class="token punctuation">;</span>

        <span class="token keyword">SELECT</span> 
            t1<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> 学生编号<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>c_id <span class="token keyword">AS</span> 课程编号<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>score <span class="token keyword">AS</span> 学生成绩
        <span class="token keyword">FROM</span> score t1
        <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> score t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
        WHEREt1<span class="token punctuation">.</span>c_id <span class="token operator">!=</span> t2<span class="token punctuation">.</span>c_id
            <span class="token operator">AND</span> t1<span class="token punctuation">.</span>score <span class="token operator">=</span> t2<span class="token punctuation">.</span>score
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>s_id<span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>学生编号</th><th>课程编号</th><th>学生成绩</th></tr></thead><tbody><tr><td>0</td><td>03</td><td>03</td><td>80.0</td></tr></tbody></table> 
<h6><a id="36__1135"></a><strong>36. 查询每门功课成绩最好的前两名</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span>
            t1<span class="token punctuation">.</span>c_id <span class="token keyword">AS</span> 课程编号<span class="token punctuation">,</span>
            t2<span class="token punctuation">.</span>c_name <span class="token keyword">AS</span> 课程名<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> 学号<span class="token punctuation">,</span>
            t3<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> 姓名<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>score <span class="token keyword">AS</span> 成绩
        <span class="token keyword">FROM</span> score t1
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> course t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>c_id
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> student t3 <span class="token keyword">ON</span> t3<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t1<span class="token punctuation">.</span>s_id
        <span class="token keyword">WHERE</span>
            <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> 
                    <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 
                <span class="token keyword">FROM</span> score t4 
                WHEREt1<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t4<span class="token punctuation">.</span>c_id
                    <span class="token operator">AND</span> t4<span class="token punctuation">.</span>score <span class="token operator">&gt;</span> t1<span class="token punctuation">.</span>score
            <span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">2</span>
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>c_id<span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>课程编号</th><th>课程名</th><th>学号</th><th>姓名</th><th>成绩</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>语文</td><td>01</td><td>赵雷</td><td>80.0</td></tr><tr><td>1</td><td>01</td><td>语文</td><td>03</td><td>孙风</td><td>80.0</td></tr><tr><td>2</td><td>02</td><td>数学</td><td>01</td><td>赵雷</td><td>90.0</td></tr><tr><td>3</td><td>02</td><td>数学</td><td>07</td><td>郑竹</td><td>89.0</td></tr><tr><td>4</td><td>03</td><td>英语</td><td>01</td><td>赵雷</td><td>99.0</td></tr><tr><td>5</td><td>03</td><td>英语</td><td>07</td><td>郑竹</td><td>98.0</td></tr></tbody></table> 
<h6><a id="37__5__1167"></a><strong>37. 统计每门课程的学生选修人数（超过 5 人的课程才统计）</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span>
            t1<span class="token punctuation">.</span>c_id <span class="token keyword">AS</span> 课程号<span class="token punctuation">,</span>
            t2<span class="token punctuation">.</span>c_name <span class="token keyword">AS</span> 课程名<span class="token punctuation">,</span>
            <span class="token function">COUNT</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>s_id<span class="token punctuation">)</span> <span class="token keyword">AS</span> 选修人数
        <span class="token keyword">FROM</span> score t1
        <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> course t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>c_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>c_id
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>c_id
        <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>s_id<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">4</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>课程号</th><th>课程名</th><th>选修人数</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>语文</td><td>6</td></tr><tr><td>1</td><td>02</td><td>数学</td><td>6</td></tr><tr><td>2</td><td>03</td><td>英语</td><td>6</td></tr></tbody></table> 
<h6><a id="38__1186"></a><strong>38. 检索至少选修两门课程的学生学号</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span>
            t1<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> 学号<span class="token punctuation">,</span>
            <span class="token function">COUNT</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>c_id<span class="token punctuation">)</span> <span class="token keyword">AS</span> 选修数
        <span class="token keyword">FROM</span> score t1
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>s_id
        <span class="token keyword">HAVING</span> 选修数 <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>学号</th><th>选修数</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>3</td></tr><tr><td>1</td><td>02</td><td>3</td></tr><tr><td>2</td><td>03</td><td>3</td></tr><tr><td>3</td><td>04</td><td>3</td></tr><tr><td>4</td><td>05</td><td>2</td></tr><tr><td>5</td><td>06</td><td>2</td></tr><tr><td>6</td><td>07</td><td>2</td></tr></tbody></table> 
<h6><a id="39__1207"></a><strong>39. 查询选修了全部课程的学生信息</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span>
            t1<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> 学号<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> 姓名<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>s_birthday <span class="token keyword">AS</span> 出生年月<span class="token punctuation">,</span>
            t1<span class="token punctuation">.</span>s_sex <span class="token keyword">AS</span> 性别
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span> score t2
        WHEREt1<span class="token punctuation">.</span>s_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>s_id
        <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>c_id<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th></th><th>学号</th><th>姓名</th><th>出生年月</th><th>性别</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>赵雷</td><td>1990-01-01</td><td>男</td></tr><tr><td>1</td><td>02</td><td>钱电</td><td>1990-12-21</td><td>男</td></tr><tr><td>2</td><td>03</td><td>孙风</td><td>1990-05-20</td><td>男</td></tr><tr><td>3</td><td>04</td><td>李云</td><td>1990-08-06</td><td>男</td></tr></tbody></table> 
<h6><a id="40__1228"></a><strong>40. 查询各学生的年龄，只按年份来算</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span>
        t1<span class="token punctuation">.</span>s_id <span class="token keyword">AS</span> 学号<span class="token punctuation">,</span>
        t1<span class="token punctuation">.</span>s_name <span class="token keyword">AS</span> 姓名<span class="token punctuation">,</span>
        TIMESTAMPDIFF<span class="token punctuation">(</span><span class="token keyword">YEAR</span><span class="token punctuation">,</span>t1<span class="token punctuation">.</span>s_birthday<span class="token punctuation">,</span>CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 年龄
        <span class="token keyword">FROM</span> student t1<span class="token punctuation">;</span>
        <span class="token comment">#TIMESTAMPDIFF函数规范：https://blog.csdn.net/zmxiangde_88/article/details/8011661</span>
</code></pre> 
<ul><li>表格较长，只截取部分</li></ul> 
<table><thead><tr><th></th><th>学号</th><th>姓名</th><th>年龄</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>赵雷</td><td>32</td></tr><tr><td>1</td><td>02</td><td>钱电</td><td>31</td></tr><tr><td>2</td><td>03</td><td>孙风</td><td>32</td></tr></tbody></table> 
<h6><a id="41____1247"></a><strong>41. 按照出生日期来算，当前月日 <code>&lt;</code> 出生年月的月日则，年龄减一</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            s_id<span class="token punctuation">,</span>
            s_name<span class="token punctuation">,</span>
            <span class="token punctuation">(</span>DATE_FORMAT<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%Y'</span><span class="token punctuation">)</span><span class="token operator">-</span>DATE_FORMAT<span class="token punctuation">(</span>s_birthday<span class="token punctuation">,</span><span class="token string">'%Y'</span><span class="token punctuation">)</span> <span class="token operator">-</span> 
                <span class="token punctuation">(</span>
                    <span class="token keyword">CASE</span> <span class="token keyword">when</span> 
                        DATE_FORMAT<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%m%d'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span>DATE_FORMAT<span class="token punctuation">(</span>s_birthday<span class="token punctuation">,</span><span class="token string">'%m%d'</span><span class="token punctuation">)</span> <span class="token keyword">then</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">1</span> <span class="token keyword">END</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span> <span class="token keyword">AS</span> age
        <span class="token keyword">FROM</span> student<span class="token punctuation">;</span>
</code></pre> 
<ul><li>表格较长，只截取部分</li></ul> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>age</th></tr></thead><tbody><tr><td>0</td><td>01</td><td>赵雷</td><td>32.0</td></tr><tr><td>10</td><td>12</td><td>赵六</td><td>5.0</td></tr><tr><td>11</td><td>13</td><td>孙七</td><td>4.0</td></tr></tbody></table> 
<h6><a id="42__1269"></a><strong>42. 查询本周过生日的学生</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
            <span class="token operator">*</span>
        <span class="token keyword">FROM</span> student
        WHEREWEEKOFYEAR<span class="token punctuation">(</span>student<span class="token punctuation">.</span>s_birthday<span class="token punctuation">)</span> <span class="token operator">=</span> WEEKOFYEAR<span class="token punctuation">(</span>CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th></tr></thead></table> 
<h6><a id="43__1281"></a><strong>43. 查询下周过生日的学生</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
                <span class="token operator">*</span>
        <span class="token keyword">FROM</span> student
        WHEREWEEKOFYEAR<span class="token punctuation">(</span>student<span class="token punctuation">.</span>s_birthday<span class="token punctuation">)</span> <span class="token operator">=</span> WEEKOFYEAR<span class="token punctuation">(</span>CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> 
</code></pre> 
<table><thead><tr><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th></tr></thead></table> 
<h6><a id="44__1293"></a><strong>44. 查询本月过生日的学生</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
                <span class="token operator">*</span>
        <span class="token keyword">FROM</span> student t1
        WHEREMONTH<span class="token punctuation">(</span>t1<span class="token punctuation">.</span>s_birthday<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span>CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th></tr></thead><tbody><tr><td>0</td><td>07</td><td>郑竹</td><td>1989-07-01</td><td>女</td></tr></tbody></table> 
<h6><a id="45__1306"></a><strong>45. 查询下月过生日的学生</strong></h6> 
<pre><code class="prism language-sql">        <span class="token keyword">SELECT</span> 
                <span class="token operator">*</span>
        <span class="token keyword">FROM</span> student t1
        WHEREMONTH<span class="token punctuation">(</span>t1<span class="token punctuation">.</span>s_birthday<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span>CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> 
</code></pre> 
<pre><code class="prism language-python">sql <span class="token operator">=</span> <span class="token string">'SELECT * FROM student t1 WHEREMONTH(t1.s_birthday) = MONTH(CURDATE())+1; '</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> eng<span class="token punctuation">)</span>
df
</code></pre> 
<table><thead><tr><th></th><th>s_id</th><th>s_name</th><th>s_birthday</th><th>s_sex</th></tr></thead><tbody><tr><td>0</td><td>04</td><td>李云</td><td>1990-08-06</td><td>男</td></tr></tbody></table>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3df876a413654aecebca5cdaa395df80/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mysql查询条件字段值末尾有空格也能查到数据问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5c45020437241aa1acd80a0e63e97a75/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue中省市区</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>