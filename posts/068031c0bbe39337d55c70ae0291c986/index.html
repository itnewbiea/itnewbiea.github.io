<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue3form循环校验 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue3form循环校验" />
<meta property="og:description" content="setup(props,{expose}) {
const addFormRef = ref&lt;FormInstance&gt;({}); // 灰度抽屉组件ref
}
const handleValidate = (key) =&gt; {
return new Promise((resolve, reject) =&gt; {
addFormRef?.value[key].validate(async (valid: any, fields: any) =&gt; {
if (valid) {
resolve(true)
} else {
resolve(false)
return
}
})
})
}
expose({
handleValidate
})
{
formConfig.value?.[props.type]?.map((itemModel, index) =&gt; {
return (&lt;ElCard class={`${className(style[&#39;add-card-comp&#39;])} relative mb-[20px]`} key={itemModel.key}&gt;
&lt;ElForm class=&#34;w-[720px]&#34; model={itemModel} ref={
(el) =&gt; { if (el) addFormRef.value[itemModel.key] = el }
}&gt;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/068031c0bbe39337d55c70ae0291c986/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-09T10:19:00+08:00" />
<meta property="article:modified_time" content="2023-10-09T10:19:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue3form循环校验</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>setup(props,{expose}) {<!-- --></p> 
<p>    const addFormRef = ref&lt;FormInstance&gt;({}); // 灰度抽屉组件ref</p> 
<p>}</p> 
<p>const handleValidate = (key) =&gt; {<!-- --></p> 
<p>      return new Promise((resolve, reject) =&gt; {<!-- --></p> 
<p>        addFormRef?.value[key].validate(async (valid: any, fields: any) =&gt; {<!-- --></p> 
<p>              if (valid) {<!-- --></p> 
<p>                resolve(true)</p> 
<p>              } else {<!-- --></p> 
<p>                resolve(false)</p> 
<p>                return</p> 
<p>              }</p> 
<p>          })</p> 
<p>      })</p> 
<p>    }</p> 
<p>    expose({<!-- --></p> 
<p>      handleValidate</p> 
<p>    })</p> 
<p></p> 
<p>{<!-- --></p> 
<p>          formConfig.value?.[props.type]?.map((itemModel, index) =&gt; {<!-- --></p> 
<p>            return (&lt;ElCard class={`${className(style['add-card-comp'])} relative mb-[20px]`} key={itemModel.key}&gt;</p> 
<p>              &lt;ElForm class="w-[720px]" model={itemModel} ref={<!-- --></p> 
<p>                (el) =&gt; { if (el) addFormRef.value[itemModel.key] = el }</p> 
<p>              }&gt;</p> 
<p>                &lt;ElFormItem label="优先级序号"&gt;</p> 
<p>                  &lt;span&gt;{index + 1}&lt;/span&gt;</p> 
<p>                &lt;/ElFormItem&gt;</p> 
<p>&lt;/ElForm&gt;</p> 
<p>}</p> 
<p></p> 
<p>Js中调用校验</p> 
<p>formEl.validate(async (valid) =&gt; {<!-- --></p> 
<p>        if (valid) {<!-- --></p> 
<p>          const ValidateArr = []</p> 
<p>          enumParams.forEach(item =&gt; {<!-- --></p> 
<p>            if (formConfig.value[item].length &gt; 0) {<!-- --></p> 
<p>              formConfig.value[item].forEach(i =&gt; {<!-- --></p> 
<p>                if (item === 'boardListJson') {<!-- --></p> 
<p>                  ValidateArr.push((boardListJsonRef?.value as any)?.handleValidate(i.key))</p> 
<p>                }</p> 
<p>              })</p> 
<p>            }</p> 
<p>          })</p> 
<p>          if (ValidateArr.length &gt; 0) {<!-- --></p> 
<p>            const res: Array&lt;boolean&gt; = await Promise.all(ValidateArr)</p> 
<p>            if (res.includes(false)) {<!-- --></p> 
<p>                ElMessage({<!-- --></p> 
<p>                message: '请检查后提交',</p> 
<p>                type: 'error'</p> 
<p>                })</p> 
<p>                return</p> 
<p>            }</p> 
<p>          }</p> 
<p>})</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9f8db21d06cb99c66cb8e94555f819ae/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">@Scheduled(cron = “* * * * * *“) cron表达式详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b4d3135f3de38fc63dd06286b0a63372/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux 部署 MinIO 分布式对象存储 &amp; 配置为 typora 图床</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>