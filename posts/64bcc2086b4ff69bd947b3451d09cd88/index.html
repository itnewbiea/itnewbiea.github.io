<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>log4cpp的使用 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="log4cpp的使用" />
<meta property="og:description" content="log4cpp的使用逻辑构造基本模板布局的格式化目的地对象操作文件回卷文件 log4cpp的使用 逻辑构造 目的地Appender：用于表示日志系统最后输出到哪
布局Layout：表示你输出的格式，类似与printf
优先级Priority：常见的优先级有emerg，alert，crit，error，warn，notice，info，debug，优先级从高到低排列，优先级主要针对不同用户设定，如果一个用户设定的优先级是warn，那么notice，info，debug的信息就会忽略掉不输出
日志Category：是整个日志系统的主干，目的地的设定添加和模板设置，日志记录都由Category完成
一个目的地只能有一个布局，一个布局对应一个目的地
基本模板 #include &lt;iostream&gt; #include &lt;log4cpp/OstreamAppender.hh&gt; #include &lt;log4cpp/Appender.hh&gt; #include &lt;log4cpp/BasicLayout.hh&gt; #include &lt;log4cpp/Category.hh&gt; #include &lt;log4cpp/Priority.hh&gt; using std::cout; using namespace log4cpp; void test0() { //设置目的地对象 //参数1 目的地的名字 console代表控制台， //参数2 流对象 OstreamAppender* posAp = new OstreamAppender(&#34;console&#34;, &amp;cout); //设置目的地布局 BasicLayout函数是创建布局对象 posAp-&gt;setLayout(new BasicLayout()); //创建日志对象，getRoot函数返回的是创建的日志对象，用引用符号接取 Category&amp; root = Category::getRoot(); //设置日志的目的地 root.setAppender(posAp); //设置日志的优先级 root.setPriority(Priority::DEBUG); //设置模板 Category&amp; model1 = root.getInstance(&#34;register&#34;); //打印日志记录 root.emerg(&#34;this is an emrge&#34;); root.alert(&#34;this is an alert&#34;); root.crit(&#34;this is a critical&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/64bcc2086b4ff69bd947b3451d09cd88/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-23T19:56:13+08:00" />
<meta property="article:modified_time" content="2023-05-23T19:56:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">log4cpp的使用</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4> </h4> 
 <ul><li><a href="#log4cpp_1" rel="nofollow">log4cpp的使用</a></li><li><ul><li><a href="#_2" rel="nofollow">逻辑构造</a></li><li><a href="#_11" rel="nofollow">基本模板</a></li><li><a href="#_77" rel="nofollow">布局的格式化</a></li><li><a href="#_131" rel="nofollow">目的地对象操作文件</a></li><li><a href="#_211" rel="nofollow">回卷文件</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="log4cpp_1"></a>log4cpp的使用</h2> 
<h3><a id="_2"></a>逻辑构造</h3> 
<blockquote> 
 <p>目的地Appender：用于表示日志系统最后输出到哪<br> 布局Layout：表示你输出的格式，类似与printf<br> 优先级Priority：常见的优先级有emerg，alert，crit，error，warn，notice，info，debug，优先级从高到低排列，优先级主要针对不同用户设定，如果一个用户设定的优先级是warn，那么notice，info，debug的信息就会忽略掉不输出<br> 日志Category：是整个日志系统的主干，目的地的设定添加和模板设置，日志记录都由Category完成</p> 
</blockquote> 
<p>一个目的地只能有一个布局，一个布局对应一个目的地</p> 
<h3><a id="_11"></a>基本模板</h3> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/OstreamAppender.hh&gt;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/Appender.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/BasicLayout.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/Category.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/Priority.hh&gt;</span></span>

<span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> log4cpp<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test0</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//设置目的地对象</span>
	<span class="token comment">//参数1 目的地的名字 console代表控制台，</span>
	<span class="token comment">//参数2 流对象</span>
	OstreamAppender<span class="token operator">*</span> posAp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">OstreamAppender</span><span class="token punctuation">(</span><span class="token string">"console"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>cout<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//设置目的地布局 BasicLayout函数是创建布局对象</span>
	posAp<span class="token operator">-&gt;</span><span class="token function">setLayout</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">BasicLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">//创建日志对象，getRoot函数返回的是创建的日志对象，用引用符号接取</span>
	Category<span class="token operator">&amp;</span> root <span class="token operator">=</span> <span class="token class-name">Category</span><span class="token operator">::</span><span class="token function">getRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">//设置日志的目的地</span>
	root<span class="token punctuation">.</span><span class="token function">setAppender</span><span class="token punctuation">(</span>posAp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//设置日志的优先级</span>
	root<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span>Priority<span class="token operator">::</span>DEBUG<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//设置模板</span>
	Category<span class="token operator">&amp;</span> model1 <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"register"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//打印日志记录</span>
	root<span class="token punctuation">.</span><span class="token function">emerg</span><span class="token punctuation">(</span><span class="token string">"this is an emrge"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"this is an alert"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">crit</span><span class="token punctuation">(</span><span class="token string">"this is a critical"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"this is an error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"this is a warn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">notice</span><span class="token punctuation">(</span><span class="token string">"this is a notice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"this is an info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"this is a debug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	model1<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">test0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>输出结果</p> 
<pre><code>1684758947 FATAL  : this is an emrge
1684758947 ALERT  : this is an alert
1684758947 CRIT  : this is a critical
1684758947 ERROR  : this is an error
1684758947 WARN  : this is a warn
1684758947 NOTICE  : this is a notice
1684758947 INFO  : this is an info
1684758947 DEBUG  : this is a debug
1684758947 DEBUG register : 123456
</code></pre> 
<p>打印第一列代表时间，单位为秒，第二列为优先级，第三列为模块名，root没有设置所以是空白，最后面为日志内容</p> 
<h3><a id="_77"></a>布局的格式化</h3> 
<p>类似于priintf函数，常以%d代表输出十进制，Layout对象也有着类似的表达方式</p> 
<p>PatternLayout</p> 
<blockquote> 
 <p>setConversionPattern成员函数，PatternLayout的格式化函数<br> %c 获取模块名<br> %d 打印日期时间，将第一列时间单位为秒转化为可读性时间<br> %m 打印消息内容<br> %p 打印优先级<br> %n 换行符</p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/PatternLayout.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/OstreamAppender.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/Category.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/Priority.hh&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> log4cpp<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test0</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	OstreamAppender<span class="token operator">*</span> posAp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">OstreamAppender</span><span class="token punctuation">(</span><span class="token string">"console"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>cout<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//设置格式化布局</span>
	PatternLayout<span class="token operator">*</span> ptnLayout <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">PatternLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	ptnLayout<span class="token operator">-&gt;</span><span class="token function">setConversionPattern</span><span class="token punctuation">(</span><span class="token string">"%d [%c] [%p] %m %n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	posAp<span class="token operator">-&gt;</span><span class="token function">setLayout</span><span class="token punctuation">(</span>ptnLayout<span class="token punctuation">)</span><span class="token punctuation">;</span>

	Category<span class="token operator">&amp;</span> root <span class="token operator">=</span> <span class="token class-name">Category</span><span class="token operator">::</span><span class="token function">getRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	root<span class="token punctuation">.</span><span class="token function">setAppender</span><span class="token punctuation">(</span>posAp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span>Priority<span class="token operator">::</span>DEBUG<span class="token punctuation">)</span><span class="token punctuation">;</span>

	Category<span class="token operator">&amp;</span> model1 <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"register"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	model1<span class="token punctuation">.</span><span class="token function">emerg</span><span class="token punctuation">(</span><span class="token string">"this is an emerg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">emerg</span><span class="token punctuation">(</span><span class="token string">"this is an emerg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token class-name">Category</span><span class="token operator">::</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">test0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>输出结果</p> 
<pre><code>2023-05-23 18:57:33,748 [register] [FATAL] this is an emerg
2023-05-23 18:57:33,749 [] [FATAL] this is an emerg
</code></pre> 
<h3><a id="_131"></a>目的地对象操作文件</h3> 
<p>FileAppender</p> 
<pre><code>参数列表
参数1 目的地名字
参数2 文件名
参数3 是否以追加模式写入（默认追加）
参数4 文件权限（不写以默认权限为主）
</code></pre> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/OstreamAppender.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/FileAppender.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/BasicLayout.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/PatternLayout.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/Category.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/Priority.hh&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> log4cpp<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test0</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//两个目的地对象创建，最后一个输出在控制台一个写入到文件中去</span>
	OstreamAppender<span class="token operator">*</span> posAp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">OstreamAppender</span><span class="token punctuation">(</span><span class="token string">"console"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>cout<span class="token punctuation">)</span><span class="token punctuation">;</span>
	FileAppender<span class="token operator">*</span> FileAp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">FileAppender</span><span class="token punctuation">(</span><span class="token string">"FileAp"</span><span class="token punctuation">,</span> <span class="token string">"test.log"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	PatternLayout<span class="token operator">*</span> ptnLayout <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">PatternLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	ptnLayout<span class="token operator">-&gt;</span><span class="token function">setConversionPattern</span><span class="token punctuation">(</span><span class="token string">"%d [%c] [%p] %m %n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//让目的地为控制台的对象打印普通日志信息</span>
	<span class="token comment">//让目的地为文件的对象打印格式化日志信息</span>
	posAp<span class="token operator">-&gt;</span><span class="token function">setLayout</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">BasicLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	FileAp<span class="token operator">-&gt;</span><span class="token function">setLayout</span><span class="token punctuation">(</span>ptnLayout<span class="token punctuation">)</span><span class="token punctuation">;</span>

	Category<span class="token operator">&amp;</span> root <span class="token operator">=</span> <span class="token class-name">Category</span><span class="token operator">::</span><span class="token function">getRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">setAppender</span><span class="token punctuation">(</span>posAp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//追加目的地</span>
	root<span class="token punctuation">.</span><span class="token function">addAppender</span><span class="token punctuation">(</span>FileAp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span>Priority<span class="token operator">::</span>DEBUG<span class="token punctuation">)</span><span class="token punctuation">;</span>

	Category<span class="token operator">&amp;</span> model <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"register"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	root<span class="token punctuation">.</span><span class="token function">emerg</span><span class="token punctuation">(</span><span class="token string">"root emerg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"root alert"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">crit</span><span class="token punctuation">(</span><span class="token string">"root crit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"root error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"root warn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">notice</span><span class="token punctuation">(</span><span class="token string">"root notice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"root info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"root debug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	model<span class="token punctuation">.</span><span class="token function">emerg</span><span class="token punctuation">(</span><span class="token string">"model emerg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	model<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"model debug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token class-name">Category</span><span class="token operator">::</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">test0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>输出结果</p> 
<pre><code>1684840653 FATAL  : root emerg
1684840653 ALERT  : root alert
1684840653 CRIT  : root crit
1684840653 ERROR  : root error
1684840653 WARN  : root warn
1684840653 NOTICE  : root notice
1684840653 INFO  : root info
1684840653 DEBUG  : root debug
1684840653 FATAL register : model emerg
1684840653 DEBUG register : model debug
</code></pre> 
<p>同时在该项目目录下可以找到之前生成的文件test.log<br> <img src="https://images2.imgbox.com/d6/35/RlHuImC2_o.png" alt="在这里插入图片描述"><br> 打开后可看到日志内容（我这里生成了两次所以上下时间不同，写入了两次，也可以看出FileAppender默认是以追加模式进行写入的）<img src="https://images2.imgbox.com/cb/cc/ANxob8VL_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_211"></a>回卷文件</h3> 
<p>RollingFileAppender</p> 
<blockquote> 
 <p>应用场景：用于一些对于存储空间要求较高，不希望日志文件占用过多空间<br> 回卷文件说明：假如一次产生连续十个回卷文件，编号为1-10，要求日志文件只能占10M空间，那么每个回卷文件最大大小为1M，当日志信息填入回卷文件1且填满时，会使用回卷文件2继续写入，当10个回卷文件都填满时，会删除最早的回卷文件，重新写入数据，在当前场景下，回卷文件1是最早的一个，于是将他重定向操作，这种结构类似于队列一样，也有着先进先出的特点（再严谨一点是循环队列）</p> 
</blockquote> 
<blockquote> 
 <p>参数列表<br> 参数1 目的地名字<br> 参数2 文件名<br> 参数3 每个文件大小，单位为字节，5000则为5KB<br> 参数4 需要多少个回卷文件</p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/OstreamAppender.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/FileAppender.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/RollingFileAppender.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/PatternLayout.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/BasicLayout.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/Category.hh&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;log4cpp/Priority.hh&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> log4cpp<span class="token punctuation">;</span>
<span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test0</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//设置三个对象，分别对应控制台，文件，回卷文件</span>
	OstreamAppender<span class="token operator">*</span> posAp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">OstreamAppender</span><span class="token punctuation">(</span><span class="token string">"console"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>cout<span class="token punctuation">)</span><span class="token punctuation">;</span>
	FileAppender<span class="token operator">*</span> FileAp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">FileAppender</span><span class="token punctuation">(</span><span class="token string">"FileAp"</span><span class="token punctuation">,</span><span class="token string">"test.log"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	RollingFileAppender<span class="token operator">*</span> RollingFileAp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">RollingFileAppender</span><span class="token punctuation">(</span><span class="token string">"RollingFileAp"</span><span class="token punctuation">,</span><span class="token string">"a.log"</span><span class="token punctuation">,</span><span class="token number">5000</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	PatternLayout<span class="token operator">*</span> ptnLayout1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">PatternLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	PatternLayout<span class="token operator">*</span> ptnLayout2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">PatternLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	ptnLayout2<span class="token operator">-&gt;</span><span class="token function">setConversionPattern</span><span class="token punctuation">(</span><span class="token string">"%d [%c] [%p] %m %n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	ptnLayout2<span class="token operator">-&gt;</span><span class="token function">setConversionPattern</span><span class="token punctuation">(</span><span class="token string">"%d [%c] [%p] %m %n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//一个目的地只能对应一个布局，一个布局只能对应一个目的地</span>
	
	posAp<span class="token operator">-&gt;</span><span class="token function">setLayout</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">BasicLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	FileAp<span class="token operator">-&gt;</span><span class="token function">setLayout</span><span class="token punctuation">(</span>ptnLayout1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	RollingFileAp<span class="token operator">-&gt;</span><span class="token function">setLayout</span><span class="token punctuation">(</span>ptnLayout2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	Category<span class="token operator">&amp;</span> root <span class="token operator">=</span> <span class="token class-name">Category</span><span class="token operator">::</span><span class="token function">getRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">setAppender</span><span class="token punctuation">(</span>posAp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">addAppender</span><span class="token punctuation">(</span>FileAp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">addAppender</span><span class="token punctuation">(</span>RollingFileAp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	root<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span>Priority<span class="token operator">::</span>DEBUG<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	Category<span class="token operator">&amp;</span> model <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"register"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		root<span class="token punctuation">.</span><span class="token function">emerg</span><span class="token punctuation">(</span><span class="token string">"this is an emrge"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		root<span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"this is an alert"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		root<span class="token punctuation">.</span><span class="token function">crit</span><span class="token punctuation">(</span><span class="token string">"this is a critical"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		root<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"this is an error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		root<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"this is a warn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		root<span class="token punctuation">.</span><span class="token function">notice</span><span class="token punctuation">(</span><span class="token string">"this is a notice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		root<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"this is an info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		root<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"this is a debug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
		model<span class="token punctuation">.</span><span class="token function">emerg</span><span class="token punctuation">(</span><span class="token string">"this is an emrge"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		model<span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"this is an alert"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		model<span class="token punctuation">.</span><span class="token function">crit</span><span class="token punctuation">(</span><span class="token string">"this is a critical"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		model<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"this is an error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		model<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"this is a warn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		model<span class="token punctuation">.</span><span class="token function">notice</span><span class="token punctuation">(</span><span class="token string">"this is a notice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		model<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"this is an info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		model<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"this is a debug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	Category<span class="token operator">::</span>shutdown<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">test0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>输出结果</p> 
<pre><code>1684842384 FATAL  : this is an emrge
1684842384 ALERT  : this is an alert
1684842384 CRIT  : this is a critical
1684842384 ERROR  : this is an error
1684842384 WARN  : this is a warn
1684842384 NOTICE  : this is a notice
1684842384 INFO  : this is an info
1684842384 DEBUG  : this is a debug
1684842384 FATAL register : this is an emrge
1684842384 ALERT register : this is an alert
1684842384 CRIT register : this is a critical
1684842384 ERROR register : this is an error
1684842384 WARN register : this is a warn
1684842384 NOTICE register : this is a notice
1684842384 INFO register : this is an info
1684842384 DEBUG register : this is a debug
...
...
1684842384 FATAL  : this is an emrge
1684842384 ALERT  : this is an alert
1684842384 CRIT  : this is a critical
1684842384 ERROR  : this is an error
1684842384 WARN  : this is a warn
1684842384 NOTICE  : this is a notice
1684842384 INFO  : this is an info
1684842384 DEBUG  : this is a debug
1684842384 FATAL register : this is an emrge
1684842384 ALERT register : this is an alert
1684842384 CRIT register : this is a critical
1684842384 ERROR register : this is an error
1684842384 WARN register : this is a warn
1684842384 NOTICE register : this is a notice
1684842384 INFO register : this is an info
1684842384 DEBUG register : this is a debug
1684842384 FATAL  : this is an emrge
1684842384 ALERT  : this is an alert
1684842384 CRIT  : this is a critical
1684842384 ERROR  : this is an error
1684842384 WARN  : this is a warn
1684842384 NOTICE  : this is a notice
1684842384 INFO  : this is an info
1684842384 DEBUG  : this is a debug
1684842384 FATAL register : this is an emrge
1684842384 ALERT register : this is an alert
1684842384 CRIT register : this is a critical
1684842384 ERROR register : this is an error
1684842384 WARN register : this is a warn
1684842384 NOTICE register : this is a notice
1684842384 INFO register : this is an info
1684842384 DEBUG register : this is a debug
</code></pre> 
<p>目录下生成结果<br> <img src="https://images2.imgbox.com/d8/c2/JkFWiUnb_o.png" alt="![在这里插入图片描述](https://img-blog.csdnimg.cn/a1f4133bd1c3459587ef0281c5c029ed.png"></p> 
<p><img src="https://images2.imgbox.com/52/51/ncuidbng_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/e7/fd/CKfJPX0y_o.png" alt="在这里插入图片描述"><br> 可以看到通过FileAppender生成了test.log，文件大小为28KB<br> 通过RollingFileAppender生成了10个a.log回卷文件，每个文件大小都为5KB，总和为50KB，此时还并不能体现出回卷文件节省空间的能力<br> 我们把for循环改为1000次<br> <img src="https://images2.imgbox.com/0f/0b/toeXm3JH_o.png" alt="在这里插入图片描述"></p> 
<p>此时可以看到test.log大小为899KB，a.log回卷文件大小总和依然为50KB</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7966ecafd8785c591fa79419fe372c6e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java 微信公众号服务器配置token验证</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/51b351a4585810d6d2e897a4cef24b25/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">IGMP协议基础，组播配置和过程解析（华为）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>