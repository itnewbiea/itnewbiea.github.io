<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java调用C语言执行dll文件 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java调用C语言执行dll文件" />
<meta property="og:description" content="这是一个很大的坑。在里面遨游了两天时间，很无语
注：.dll是运行在Windows环境的。想要在Linux环境运行就是.so文件（.so就是和.dll文件一样，只不过是适用的系统环境不一样而已）
业务：
我的业务是需要调用dll文件，返回一个json格式的结果。
我们有多个应用。其中有上位机应用服务是运行在Windows环境的。因此Linux环境上的那个应用需要调用dll的接口里面组装我我们自己的业务，然后接口里面通过http去请求上位机上的接口，来调用dll文件。
起初。这个上位机在eclipse上是可以直接调用dll文件去运行的。但是idea是无法运行的。
然后上位机这个打成jar包（dll文件放在和src同级、以及src\main\resources下，还有打成war），运行在本地，报了很多错。
类似于下面的。
各种百度说是什么环境变量里面配置，
什么把dll文件复制到C:\Windows\System32、jre\bin等等路径里面、eclipse上的配置等等各种试，还说是缺少什么dll文件让下载。将dll放在java.library.path包含的路径中。都不行。
认真分析一下，eclipse上能运行，肯定就是dll文件放的位置不对。不可能是缺少什么dll文件都不行。
一直的误区是：System.loadLibrary(&#34;dll文件名，没有后缀&#34;);扫描的事jar包内或者war内的。
所以一直在这里转圈圈。最后在打成jar包。在桌面创建一个文件夹，把jar包和所要用的dll文件都复制进入都是同级。结果测试就ok。感觉真滴很坑。
以上分享给大家。具体我也不太清楚我这个方法是否适用你，但是我目前是ok了。
有什么不足之处，还希望请教大家。
在eclipse上配置后调用执行正常，但是在idea中就不行。一共有三个类型的错，大概的意思都是下面这个截图中的报错
主要的方法是：将比如将一个jar包放在Windows环境的卓某一个文件夹中，那么把所有的dll文件复制进入，和这个jar同级目录。启动这个jar，就可以正常的调用了
public class Demo { public native int sum(int a,int b); public static void main(String[] args) { int a = 2; int b = 6; int c; Demo d = new Demo(); c = d.sum(a, b); } public int getSumAB(int a, int b){ Demo d = new Demo(); int sum = d.sum(a, b); return sum; } static { System." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/9b7430b97c4b8d1b74544197e54a2711/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-28T18:21:52+08:00" />
<meta property="article:modified_time" content="2020-05-28T18:21:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java调用C语言执行dll文件</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>这是一个很大的坑。在里面遨游了两天时间，很无语</p> 
<p>注：.dll是运行在Windows环境的。想要在Linux环境运行就是.so文件（.so就是和.dll文件一样，只不过是适用的系统环境不一样而已）</p> 
<p>业务：</p> 
<p>我的业务是需要调用dll文件，返回一个json格式的结果。</p> 
<p>我们有多个应用。其中有上位机应用服务是运行在Windows环境的。因此Linux环境上的那个应用需要调用dll的接口里面组装我我们自己的业务，然后接口里面通过http去请求上位机上的接口，来调用dll文件。</p> 
<p>起初。这个上位机在eclipse上是可以直接调用dll文件去运行的。但是idea是无法运行的。</p> 
<p>然后上位机这个打成jar包（dll文件放在和src同级、以及src\main\resources下，还有打成war），运行在本地，报了很多错。</p> 
<p>类似于下面的。</p> 
<p>各种百度说是什么环境变量里面配置，</p> 
<p>什么把dll文件复制到C:\Windows\System32、jre\bin等等路径里面、eclipse上的配置等等各种试，还说是缺少什么dll文件让下载。将dll放在java.library.path包含的路径中。都不行。</p> 
<p>认真分析一下，eclipse上能运行，肯定就是dll文件放的位置不对。不可能是缺少什么dll文件都不行。</p> 
<p>一直的误区是：System.loadLibrary("dll文件名，没有后缀");扫描的事jar包内或者war内的。</p> 
<p>所以一直在这里转圈圈。最后在打成jar包。<strong><span style="color:#f33b45;">在桌面创建一个文件夹，把jar包和所要用的dll文件都复制进入都是同级。结果测试就ok</span></strong>。感觉真滴很坑。<br><br> 以上分享给大家。具体我也不太清楚我这个方法是否适用你，但是我目前是ok了。<br> 有什么不足之处，还希望请教大家。</p> 
<p> </p> 
<p>在eclipse上配置后调用执行正常，但是在idea中就不行。一共有三个类型的错，大概的意思都是下面这个截图中的报错</p> 
<p> </p> 
<p>主要的方法是：将比如将一个jar包放在Windows环境的卓某一个文件夹中，那么把所有的dll文件复制进入，和这个jar同级目录。启动这个jar，就可以正常的调用了</p> 
<p><img alt="" height="431" src="https://images2.imgbox.com/12/1c/ftVWUa3a_o.png" width="1200"></p> 
<p><img alt="" height="343" src="https://images2.imgbox.com/07/40/86rHlqa0_o.png" width="1200"></p> 
<p> </p> 
<pre class="has"><code class="language-java">public class Demo {
	
	public native int sum(int a,int b);

	public static void main(String[] args) {
		int a = 2;
		int b = 6;
		int c;
		Demo d = new Demo();
		c = d.sum(a, b);
	}
	
	public int getSumAB(int a, int b){
		Demo d = new Demo();
		int sum = d.sum(a, b);
		return sum;
	}

	static
	{
		System.loadLibrary("dll文件名，没有后缀");
	}
}
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a51bee0ef880f563f4f9c6ed42578ce2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">队列的入队和出队</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f6b489b920b8f89e6d0539ad43c22e3e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">OVS DPDK--介绍（一）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>