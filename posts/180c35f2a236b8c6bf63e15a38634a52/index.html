<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>input上传图片，以及动态添加表单，img白边 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="input上传图片，以及动态添加表单，img白边" />
<meta property="og:description" content="import &#39;./App.scss&#39;; import { useState } from &#39;react&#39;; function getBase64(img, callback) { const reader = new FileReader(); reader.addEventListener(&#39;load&#39;, () =&gt; callback(reader.result)); reader.readAsDataURL(img); } function App() { const [btn,setBtn]=useState([ { name: &#39;&#39;, page: &#39;&#39;, lik:&#39;&#39;, imgUrl:&#39;&#39; } ]) const addbtn = ()=&gt;{//往btn这个数组里面，添加一个对象，对象里面是表单字段，动态添加了一项表单 const aa = [...btn] aa.push( { name: &#39;&#39;, page: &#39;&#39;, lik:&#39;&#39;, imgUrl:&#39;&#39; } ) setBtn(aa) } const handleImageChange = (e,index) =&gt; {//图片上传函数 let aa = e.target.files[0] getBase64(aa, function(res){//图片解码base64 const a = [." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/180c35f2a236b8c6bf63e15a38634a52/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-16T15:37:17+08:00" />
<meta property="article:modified_time" content="2022-05-16T15:37:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">input上传图片，以及动态添加表单，img白边</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre><code class="language-javascript">import './App.scss';
import { useState } from 'react';

function getBase64(img, callback) {
  const reader = new FileReader();
  reader.addEventListener('load', () =&gt; callback(reader.result));
  reader.readAsDataURL(img);
}

function App() {
  const [btn,setBtn]=useState([
    {
      name: '',
      page: '',
      lik:'',
      imgUrl:''
    }
  ])

  const addbtn = ()=&gt;{//往btn这个数组里面，添加一个对象，对象里面是表单字段，动态添加了一项表单
    const aa = [...btn]
    aa.push(
      {
        name: '',
        page: '',
        lik:'',
        imgUrl:''
      }
    )
    setBtn(aa)
  }

  const handleImageChange = (e,index) =&gt; {//图片上传函数
    let aa = e.target.files[0]
    getBase64(aa, function(res){//图片解码base64
      const a = [...btn]
      a[index].imgUrl = res
      setBtn(a)
    })
  }

  const handleNameChange =(index,e)=&gt;{//属于name的change事件，通过拿到index可以得知你是btn这个数组的第几个对象，也就能修改你点击的表单在数组里对应的对象
    const a = [...btn]
    a[index].name = e.target.value
    setBtn(a)
  }
  const handlePageChange =(e,index)=&gt;{
    const a = [...b]
    a[index].page = e.target.value
    setBtn(a)
  }

  return (
    &lt;div className="App"&gt;
      &lt;div className='btn' onClick={addbtn}&gt;
        点击添加一个表单
      &lt;/div&gt;
      &lt;div&gt;
        {
          btn.map((item, index) =&gt; {
            return (
              &lt;div className='box' key={index}&gt;
                &lt;div&gt;
                  &lt;input type="file" onChange={(e)=&gt; handleImageChange(e,index)} multiple&gt;&lt;/input&gt;
                  &lt;img src={btn[index].imgUrl}/&gt;
                &lt;/div&gt;

                &lt;div&gt;
                  &lt;input
                    placeholder='NAME'
                    value={btn[index].name}
                    onChange={(e)=&gt; handleNameChange(index,e)}
                  /&gt;
                  &lt;textarea
                    placeholder='INTORDUCE'
                    value={btn[index].page}
                    onChange={(e)=&gt; handlePageChange(e,index)}
                  /&gt;

                &lt;/div&gt;

                &lt;div&gt;
                  &lt;input&gt;&lt;/input&gt;
                  &lt;input&gt;&lt;/input&gt;
                  &lt;input&gt;&lt;/input&gt;
                &lt;/div&gt;
              &lt;/div&gt;
            )
          })
        }

      &lt;/div&gt;
    &lt;/div&gt;
  );
}

export default App;
</code></pre> 
<p></p> 
<p></p> 
<p><img alt="" height="256" src="https://images2.imgbox.com/2c/96/1aWSKApH_o.png" width="1200"></p> 
<p>主要看看input type=file；</p> 
<p>上传主要通过onchange事件来接受e.target来接受上传的文件数据。</p> 
<p><img alt="" height="317" src="https://images2.imgbox.com/7d/91/dWSB7eBQ_o.png" width="882"></p> 
<p>e.target.files据我摸索，上传的资源是在这的，当你设置了 multiple（选择多个文件）时，files会是一个数组来接受多个文件。</p> 
<p><img alt="" height="229" src="https://images2.imgbox.com/7f/6c/keOBNKLT_o.png" width="1034"></p> 
<p>此函数可以帮助我们把e.target.files解码成base64格式，设置给img的src可以直接显示图片的，第一个参数是未解码的图片资源，第二个参数是一个匿名函数，reader.result作为匿名函数的参数传进来以后，匿名函数把这个参数设置给对象的imgUrl。</p> 
<p></p> 
<p></p> 
<p>当上传的img的src为空时，会有白边：这样可以消除</p> 
<p><img alt="" height="189" src="https://images2.imgbox.com/eb/3b/xLp2cEzI_o.png" width="761"></p> 
<p> </p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4881a551af04bc29f2f3c2f654ab68d6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">启发式搜索学习笔记</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2203ae016ccd7d99f9e814b1f6a923a1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[MIT]微积分重点 第十六课 关于增长的微分方程 学习笔记</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>