<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>阅读笔记-KDD2020-MoFlow: An Invertible Flow Model for Generating Molecular Graphs - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="阅读笔记-KDD2020-MoFlow: An Invertible Flow Model for Generating Molecular Graphs" />
<meta property="og:description" content="阅读笔记-MoFlow: An Invertible Flow Model for Generating Molecular Graphs 一、 Introduction二、Inference（encoding）2.1 Model Preliminary.2.1.1 The flow framework.2.1.2 Invertible affine coupling layers.2.1.3 Splitting Dimensions.2.1.4 Numerical stability by actnorm 2.2 Proposed Moflow Model2.2.1 Problem Definition: Learning a ProbabilityModel of Molecular Graphs2.2.2 Glow for Bonds2.2.3 Graph Conditional Flow for Atoms2.2.4 Validity Correction 三、Experiments3.1 生成与重建3.2潜在空间的可视化3.3 性能优化3.4 约束属性优化 相关资料： SlidesVideoPaperCode 一、 Introduction 这篇文章是 f l o w − b a s e d flow-based flow−based，大致就是有两个概率分布，如果他们之间的变换是可逆的，那么就可以根据一个较为简单地分布通过逆变换获得另外一个较复杂的概率分布。这篇文章采用的就是将邻接矩阵和原子矩阵这两个概率分布与另外两个较为简单的潜在变量的分布（文中将这两个潜在变量的分布采样为高斯分布）利用flow联系了起来。通过设计一个可逆的分布，以及从高斯分布中采样，将采样的潜在变量通过这个可逆的变换就可以得到分子图结构。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/66579a9552b74fdccc86c3e2f8f328e1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-09-30T23:58:13+08:00" />
<meta property="article:modified_time" content="2020-09-30T23:58:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">阅读笔记-KDD2020-MoFlow: An Invertible Flow Model for Generating Molecular Graphs</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>阅读笔记-MoFlow: An Invertible Flow Model for Generating Molecular Graphs</h4> 
 <ul><li><a href="#_Introduction_10" rel="nofollow">一、 Introduction</a></li><li><a href="#Inferenceencoding_15" rel="nofollow">二、Inference（encoding）</a></li><li><ul><li><a href="#21_Model_Preliminary_16" rel="nofollow">2.1 Model Preliminary.</a></li><li><ul><li><a href="#211_The_flow_framework_17" rel="nofollow">2.1.1 The flow framework.</a></li><li><a href="#212_Invertible_affine_coupling_layers_28" rel="nofollow">2.1.2 Invertible affine coupling layers.</a></li><li><a href="#213_Splitting_Dimensions_37" rel="nofollow">2.1.3 Splitting Dimensions.</a></li><li><a href="#214_Numerical_stability_by_actnorm_42" rel="nofollow">2.1.4 Numerical stability by actnorm</a></li></ul> 
   </li><li><a href="#22_Proposed_Moflow_Model_44" rel="nofollow">2.2 Proposed Moflow Model</a></li><li><ul><li><a href="#221_Problem_Definition_Learning_a_ProbabilityModel_of_Molecular_Graphs_45" rel="nofollow">2.2.1 Problem Definition: Learning a ProbabilityModel of Molecular Graphs</a></li><li><a href="#222_Glow_for_Bonds_60" rel="nofollow">2.2.2 Glow for Bonds</a></li><li><a href="#223_Graph_Conditional_Flow_for_Atoms_69" rel="nofollow">2.2.3 Graph Conditional Flow for Atoms</a></li><li><a href="#224_Validity_Correction_91" rel="nofollow">2.2.4 Validity Correction</a></li></ul> 
  </li></ul> 
  </li><li><a href="#Experiments_102" rel="nofollow">三、Experiments</a></li><li><ul><li><a href="#31__113" rel="nofollow">3.1 生成与重建</a></li><li><a href="#32_127" rel="nofollow">3.2潜在空间的可视化</a></li><li><a href="#33__135" rel="nofollow">3.3 性能优化</a></li><li><a href="#34__143" rel="nofollow">3.4 约束属性优化</a></li></ul> 
 </li></ul> 
</div> 
<br> 
<strong>相关资料：</strong> 
<p></p> 
<ul><li><a href="https://www.calvinzang.com/file/kdd20/2020_kdd_ndcn_oral.pdf" rel="nofollow">Slides</a></li><li><a href="https://youtu.be/Yx6dkkYfw8o" rel="nofollow">Video</a></li><li><a href="https://arxiv.org/abs/2006.10137" rel="nofollow">Paper</a></li><li><a href="https://github.com/calvin-zcx/moflow">Code</a></li></ul> 
<h2><a id="_Introduction_10"></a>一、 Introduction</h2> 
<p><img src="https://images2.imgbox.com/09/7d/Pu8tCYdV_o.png" alt="在这里插入图片描述"><br> 这篇文章是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         f 
        
       
         l 
        
       
         o 
        
       
         w 
        
       
         − 
        
       
         b 
        
       
         a 
        
       
         s 
        
       
         e 
        
       
         d 
        
       
      
        flow-based 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span></span></span></span></span>，大致就是有两个概率分布，如果他们之间的变换是可逆的，那么就可以根据一个较为简单地分布通过逆变换获得另外一个较复杂的概率分布。这篇文章采用的就是将邻接矩阵和原子矩阵这两个概率分布与另外两个较为简单的潜在变量的分布（文中将这两个潜在变量的分布采样为高斯分布）利用flow联系了起来。通过设计一个可逆的分布，以及从高斯分布中采样，将采样的潜在变量通过这个可逆的变换就可以得到分子图结构。<br> <strong>生成过程如下：</strong><br> <img src="https://images2.imgbox.com/3a/19/6Ot0rF1S_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Inferenceencoding_15"></a>二、Inference（encoding）</h2> 
<h3><a id="21_Model_Preliminary_16"></a>2.1 Model Preliminary.</h3> 
<h4><a id="211_The_flow_framework_17"></a>2.1.1 The flow framework.</h4> 
<p>给定两个分布：</p> 
<ul><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          Z 
         
        
          ∼ 
         
         
         
           P 
          
         
           Z 
          
         
        
          ( 
         
        
          Z 
         
        
          ) 
         
        
       
         \mathbf{\mathcal Z\sim P_{\mathcal Z}(Z)} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.07944em;">Z</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.07944em;">Z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">Z</span><span class="mclose">)</span></span></span></span></span></span>：较为容易建模的一个概率分布（在这样一个潜在的空间里，有很强的独立性）；</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          X 
         
        
          ∼ 
         
         
         
           P 
          
         
           X 
          
         
        
          ( 
         
        
          X 
         
        
          ) 
         
        
       
         \mathbf{\mathcal X\sim P_{\mathcal X}(X)} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.14643em;">X</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.14643em;">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mclose">)</span></span></span></span></span></span>：较为复杂的高维数据；</li></ul> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         f 
        
       
         l 
        
       
         o 
        
       
         w 
        
       
         − 
        
       
         b 
        
       
         a 
        
       
         s 
        
       
         e 
        
       
         d 
        
       
      
        flow-based 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span></span></span></span></span>的模型旨在找到一系列的可逆变换<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          f 
         
        
          Θ 
         
        
       
         = 
        
        
        
          f 
         
        
          L 
         
        
       
         ∘ 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         ∘ 
        
        
        
          f 
         
        
          1 
         
        
       
      
        \mathbf{f_{\Theta}=f_{L}\circ...\circ f_{1}} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right: 0.10903em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.330277em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">Θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.10903em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.330277em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathbf">.</span><span class="mord mathbf">.</span><span class="mord mathbf">.</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.10903em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>，来实现这两个概率分布之间的变换。并且当<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Z 
        
       
         = 
        
        
        
          f 
         
        
          Θ 
         
        
       
         ( 
        
       
         X 
        
       
         ) 
        
       
         = 
        
        
        
          f 
         
        
          L 
         
        
       
         ∘ 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         ∘ 
        
        
        
          f 
         
        
          1 
         
        
       
         ( 
        
       
         X 
        
       
         ) 
        
       
      
        \mathbf{Z=f_{\Theta}(X)=f_{L}\circ...\circ f_{1}(X)} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathbf">Z</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.10903em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.330277em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">Θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.10903em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.330277em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathbf">.</span><span class="mord mathbf">.</span><span class="mord mathbf">.</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.10903em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mclose">)</span></span></span></span></span></span>时，有<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          P 
         
        
          X 
         
        
       
         ( 
        
       
         X 
        
       
         ) 
        
       
         = 
        
        
        
          P 
         
        
          Z 
         
        
       
         ( 
        
       
         Z 
        
       
         ) 
        
       
         ∣ 
        
       
         d 
        
       
         e 
        
       
         t 
        
       
         ( 
        
        
         
         
           ∂ 
          
         
           Z 
          
         
         
         
           ∂ 
          
         
           X 
          
         
        
       
         ) 
        
       
         ∣ 
        
       
      
        \mathbf{P_{\mathcal X}(X)=P_{\mathcal Z}(Z)|det(\frac{\partial Z}{\partial X})|} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.14643em;">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.07944em;">Z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">Z</span><span class="mclose">)</span><span class="mord mathbf">∣</span><span class="mord mathbf">d</span><span class="mord mathbf">e</span><span class="mord mathbf">t</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right: 0.06389em;">∂</span><span class="mord mathbf mtight">X</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right: 0.06389em;">∂</span><span class="mord mathbf mtight">Z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord mathbf">∣</span></span></span></span></span></span>。所以有：<br> <img src="https://images2.imgbox.com/cd/65/UbuB927s_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="212_Invertible_affine_coupling_layers_28"></a>2.1.2 Invertible affine coupling layers.</h4> 
<p>然而，如何设计一个满足以下三个条件的可逆变换：（a.）这个变换是一个可逆的函数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          f 
         
        
          Θ 
         
        
       
      
        f_{\Theta} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>；（b.）这个可逆变换富有表现力；（c.）这个可逆变换可以高效计算雅可比矩阵的行列式。<br> 作者设计了如下的变换来满足上述条件：<br> <img src="https://images2.imgbox.com/2c/cb/XCmhW0SW_o.png" alt="在这里插入图片描述"></p> 
<ul><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           t 
          
         
           h 
          
         
           e 
              
         
           S 
          
         
           c 
          
         
           a 
          
         
           l 
          
         
           e 
              
         
           f 
          
         
           u 
          
         
           n 
          
         
           c 
          
         
           t 
          
         
           i 
          
         
           o 
          
         
           n 
          
           
         
         
           S 
          
         
           Θ 
          
         
        
          : 
         
         
         
           R 
          
         
           d 
          
         
        
          ↦ 
         
         
         
           R 
          
          
          
            n 
           
          
            − 
           
          
            d 
           
          
         
        
       
         \mathbf{the\;\;Scale\;\;function}\;S_{\Theta}:\mathbb R^{d}\mapsto\mathbb R^{n-d} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbf">t</span><span class="mord mathbf">h</span><span class="mord mathbf">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf">S</span><span class="mord mathbf">c</span><span class="mord mathbf">a</span><span class="mord mathbf">l</span><span class="mord mathbf">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf" style="margin-right: 0.10903em;">f</span><span class="mord mathbf">u</span><span class="mord mathbf">n</span><span class="mord mathbf">c</span><span class="mord mathbf">t</span><span class="mord mathbf">i</span><span class="mord mathbf">o</span><span class="mord mathbf">n</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.05764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.860108em; vertical-align: -0.011em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">↦</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></span></li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           t 
          
         
           h 
          
         
           e 
              
         
           T 
          
         
           r 
          
         
           a 
          
         
           n 
          
         
           s 
          
         
           f 
          
         
           o 
          
         
           r 
          
         
           m 
          
         
           a 
          
         
           t 
          
         
           i 
          
         
           o 
          
         
           n 
              
         
           f 
          
         
           u 
          
         
           n 
          
         
           c 
          
         
           t 
          
         
           i 
          
         
           o 
          
         
           n 
          
           
         
         
           T 
          
         
           Θ 
          
         
        
          : 
         
         
         
           R 
          
         
           d 
          
         
        
          ↦ 
         
         
         
           R 
          
          
          
            n 
           
          
            − 
           
          
            d 
           
          
         
        
       
         \mathbf{the\;\;Transformation\;\;function}\;T_{\Theta}:\mathbb R^{d}\mapsto\mathbb R^{n-d} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbf">t</span><span class="mord mathbf">h</span><span class="mord mathbf">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf">T</span><span class="mord mathbf">r</span><span class="mord mathbf">a</span><span class="mord mathbf">n</span><span class="mord mathbf">s</span><span class="mord mathbf" style="margin-right: 0.10903em;">f</span><span class="mord mathbf">o</span><span class="mord mathbf">r</span><span class="mord mathbf">m</span><span class="mord mathbf">a</span><span class="mord mathbf">t</span><span class="mord mathbf">i</span><span class="mord mathbf">o</span><span class="mord mathbf">n</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf" style="margin-right: 0.10903em;">f</span><span class="mord mathbf">u</span><span class="mord mathbf">n</span><span class="mord mathbf">c</span><span class="mord mathbf">t</span><span class="mord mathbf">i</span><span class="mord mathbf">o</span><span class="mord mathbf">n</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.860108em; vertical-align: -0.011em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">↦</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></span></li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          d 
         
        
          e 
         
        
          t 
         
        
          ( 
         
         
          
          
            ∂ 
           
          
            Z 
           
          
          
          
            ∂ 
           
          
            X 
           
          
         
        
          ) 
         
        
          = 
         
        
          e 
         
        
          x 
         
        
          p 
         
        
          ( 
         
         
         
           Σ 
          
         
           j 
          
         
         
         
           S 
          
         
           Θ 
          
         
        
          ( 
         
         
         
           X 
          
          
          
            1 
           
          
            : 
           
          
            d 
           
          
         
         
         
           ) 
          
         
           j 
          
         
        
          ) 
         
        
          . 
         
        
       
         det(\frac{\partial Z}{\partial X})=exp(\Sigma_{j}S_{\Theta}(X_{1:d})_{j}). 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.07847em;">X</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">Z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.05764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span></li></ul> 
<h4><a id="213_Splitting_Dimensions_37"></a>2.1.3 Splitting Dimensions.</h4> 
<p>压缩空间维度将<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          X 
         
         
         
           c 
          
         
           × 
          
         
           n 
          
         
           × 
          
         
           n 
          
         
        
       
      
        X^{c\times n\times n} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.771331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.771331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span>转换为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          X 
         
         
         
           ( 
          
         
           c 
          
          
          
            h 
           
          
            2 
           
          
         
           ) 
          
         
           × 
          
          
          
            n 
           
          
            h 
           
          
         
           × 
          
          
          
            n 
           
          
            h 
           
          
         
        
       
      
        X^{(ch^{2})\times\frac nh\times\frac nh} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.98692em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.98692em;"><span class="" style="top: -3.363em; margin-right: 0.05em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">c</span><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.891314em;"><span class="" style="top: -2.931em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.691543em;"><span class="" style="top: -2.656em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">h</span></span></span><span class="" style="top: -3.2255em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line mtight" style="border-bottom-width: 0.049em;"></span></span><span class="" style="top: -3.384em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.344em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.691543em;"><span class="" style="top: -2.656em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">h</span></span></span><span class="" style="top: -3.2255em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line mtight" style="border-bottom-width: 0.049em;"></span></span><span class="" style="top: -3.384em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.344em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span>来获得更多的channels并将这些channels分隔开，分别送进模型中。</p> 
<ul><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled> 2.1.3 Splitting Dimensions.</li></ul> 
<h4><a id="214_Numerical_stability_by_actnorm_42"></a>2.1.4 Numerical stability by actnorm</h4> 
<p>为了保证基于流的模型的数值稳定性，Glow中引入了actnorm层，该层通过一个具有可学习尺度和偏差的仿射变换对批次内每个通道的尺寸进行规范化。刻度和偏差被初始化为Batch中每个通道的平均值和标准差的倒数。</p> 
<h3><a id="22_Proposed_Moflow_Model_44"></a>2.2 Proposed Moflow Model</h3> 
<h4><a id="221_Problem_Definition_Learning_a_ProbabilityModel_of_Molecular_Graphs_45"></a>2.2.1 Problem Definition: Learning a ProbabilityModel of Molecular Graphs</h4> 
<ul><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          A 
         
        
          ∈ 
         
         
         
           R 
          
          
          
            n 
           
          
            × 
           
          
            k 
           
          
         
        
       
         \mathcal A\in\mathcal R^{n\times k} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathcal">A</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></span>：原子矩阵，并且这个原子矩阵最多具有<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          n 
         
        
       
         n 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">n</span></span></span></span></span>个，以及<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          k 
         
        
       
         k 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span>种类型的原子。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          A 
         
        
          ( 
         
        
          i 
         
        
          , 
         
        
          k 
         
        
          ) 
         
        
          = 
         
        
          1 
         
        
       
         \mathcal A(i,k)=1 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathcal">A</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>代表着原子<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          i 
         
        
       
         i 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>的类型为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          k 
         
        
       
         k 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span>；</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          B 
         
        
          ∈ 
         
         
         
           R 
          
          
          
            c 
           
          
            × 
           
          
            n 
           
          
            × 
           
          
            n 
           
          
         
        
       
         \mathcal B\in\mathcal R^{c\times n \times n} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathcal" style="margin-right: 0.03041em;">B</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.771331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.771331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span>：化学键矩阵。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          c 
         
        
       
         c 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span>：代表着化学键类型的数量。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          B 
         
        
          ( 
         
        
          c 
         
        
          , 
         
        
          j 
         
        
          , 
         
        
          i 
         
        
          ) 
         
        
          = 
         
        
          1 
         
        
       
         B(c,j,i)=1 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>代表着原子<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          i 
         
        
       
         i 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>与原子<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          j 
         
        
       
         j 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span></span></span></span></span>之间的化学键类型为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          c 
         
        
       
         c 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span>；</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          M 
         
        
          = 
         
        
          A 
         
        
          × 
         
        
          B 
         
        
          ∈ 
         
         
         
           R 
          
          
          
            n 
           
          
            × 
           
          
            k 
           
          
         
        
          × 
         
         
         
           R 
          
          
          
            c 
           
          
            × 
           
          
            n 
           
          
            × 
           
          
            n 
           
          
         
        
       
         \mathcal M=\mathcal A\times\mathcal B\in\mathbb R^{n\times k}\times\mathbb R^{c\times n\times n} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">M</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathcal">A</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathcal" style="margin-right: 0.03041em;">B</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.932438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.771331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.771331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span>，即矩阵<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          M 
         
        
       
         \mathcal M 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">M</span></span></span></span></span>是矩阵<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          A 
         
        
       
         \mathcal A 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          B 
         
        
       
         \mathcal B 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span></span></span></span>的笛卡尔积。因此分子图结构<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          M 
         
        
       
         \mathcal M 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">M</span></span></span></span></span>可以看做具有多种类型的节点与多种类型的边的无向图。</li></ul> 
<p>为了捕捉分子图中原子和键的组合结构，作者将这种分子生成模型分解为两个部分：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
      
                                                                              
        
         
         
           P 
          
         
           M 
          
         
        
          ( 
         
        
          M 
         
        
          ) 
         
        
          = 
         
         
         
           P 
          
         
           M 
          
         
        
          ( 
         
        
          ( 
         
        
          A 
         
        
          , 
         
        
          B 
         
        
          ) 
         
        
          ) 
         
        
          ≈ 
         
         
         
           P 
          
          
          
            A 
           
          
            ∣ 
           
          
            B 
           
          
         
        
          ( 
         
        
          A 
         
        
          ∣ 
         
        
          B 
         
        
          ; 
         
         
         
           θ 
          
          
          
            A 
           
          
            ∣ 
           
          
            B 
           
          
         
        
          ) 
         
         
         
           P 
          
         
           B 
          
         
        
          ( 
         
        
          B 
         
        
          ; 
         
         
         
           θ 
          
         
           B 
          
         
        
          ) 
         
        
       
      
        \;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\,\mathbf{P_{\mathcal M} (M) = \mathbf P_{\mathcal M}((A,B))\approx P_{\mathcal{A|B}}(A|B;\theta_{\mathcal {A|B}})P_{\mathcal B}(B;{\theta}_{\mathcal B})} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.1052em; vertical-align: -0.3552em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">M</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathbf">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathbf">B</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mord mtight">∣</span><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">A</span><span class="mord mathbf">∣</span><span class="mord mathbf">B</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mord mtight">∣</span><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">B</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em;">θ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p> 
<p>参数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          θ 
         
        
          B 
         
        
       
         与 
        
        
        
          θ 
         
         
         
           A 
          
         
           ∣ 
          
         
           B 
          
         
        
       
      
        \theta_{\mathcal B}与\theta_{\mathcal A|\mathcal B} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.04964em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">与</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mord mtight">∣</span><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span></span></span></span></span>通过最大化下式来学习到：<br> <img src="https://images2.imgbox.com/19/de/EdmnLv3e_o.png" alt="在这里插入图片描述"><br> 模型包含两个部分：</p> 
<ul><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          g 
         
        
          r 
         
        
          a 
         
        
          p 
         
        
          h 
           
        
          c 
         
        
          o 
         
        
          n 
         
        
          d 
         
        
          i 
         
        
          t 
         
        
          i 
         
        
          o 
         
        
          n 
         
        
          a 
         
        
          l 
           
        
          f 
         
        
          l 
         
        
          o 
         
        
          w 
           
        
          f 
         
        
          o 
         
        
          r 
           
        
          a 
         
        
          t 
         
        
          o 
         
        
          m 
         
        
          s 
         
        
       
         graph\;conditional\;flow\;for\;atoms 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">m</span><span class="mord mathdefault">s</span></span></span></span></span>；</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          f 
         
        
          l 
         
        
          o 
         
        
          w 
           
        
          f 
         
        
          o 
         
        
          r 
           
        
          b 
         
        
          o 
         
        
          n 
         
        
          d 
         
        
          s 
         
        
       
         flow\;for\;bonds 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mord mathdefault">s</span></span></span></span></span>；</li></ul> 
<p>作者还提出了进一步学习了学习到的潜在向量和分子特性之间的映射关系，以回归基于图的分子特性，并指导优化分子图的生成。</p> 
<h4><a id="222_Glow_for_Bonds_60"></a>2.2.2 Glow for Bonds</h4> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          Z 
         
        
          B 
         
        
       
         = 
        
        
        
          f 
         
        
          B 
         
        
       
         ( 
        
       
         B 
        
       
         ) 
        
       
      
        Z_{B}=f_{\mathcal B}(B) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mclose">)</span></span></span></span></span>，并且<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          Z 
         
        
          B 
         
        
       
      
        Z_{B} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>满足多元高斯分布，由于变换<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         f 
        
       
      
        f 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span></span></span></span></span>是可逆的，所以可得：<br> <img src="https://images2.imgbox.com/48/bc/Yc5jvCFe_o.png" alt="在这里插入图片描述"><br> 我们先从<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          P 
         
        
          Z 
         
        
       
         ( 
        
       
         Z 
        
       
         ) 
        
       
      
        P_{\mathcal Z}(Z) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.07944em;">Z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.07153em;">Z</span><span class="mclose">)</span></span></span></span></span>中采样<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          Z 
         
        
          ~ 
         
        
       
      
        \tilde Z 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.92019em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.92019em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">Z</span></span><span class="" style="top: -3.60233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">~</span></span></span></span></span></span></span></span></span></span>，并根据<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         f 
        
       
      
        f 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span></span></span></span></span>的逆变换得到边矩阵即<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          B 
         
        
          ~ 
         
        
       
         = 
        
        
        
          f 
         
        
          B 
         
         
         
           − 
          
         
           1 
          
         
        
       
         ( 
        
        
        
          Z 
         
        
          ~ 
         
        
       
         ) 
        
       
      
        \tilde B=f^{-1}_{\mathcal B}(\tilde Z) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.92019em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.92019em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span></span><span class="" style="top: -3.60233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">~</span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.21372em; vertical-align: -0.293531em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.854239em;"><span class="" style="top: -2.40647em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span><span class="" style="top: -3.10313em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.92019em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">Z</span></span><span class="" style="top: -3.60233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">~</span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p> 
<p>具体过程如下图所示：<br> <img src="https://images2.imgbox.com/77/6f/a93hlj4p_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="223_Graph_Conditional_Flow_for_Atoms_69"></a>2.2.3 Graph Conditional Flow for Atoms</h4> 
<ul><li> <p>给定化学键矩阵<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           B 
          
         
           ∈ 
          
         
           B 
          
         
           ⊂ 
          
          
          
            R 
           
           
           
             c 
            
           
             × 
            
           
             n 
            
           
             × 
            
           
             n 
            
           
          
         
        
          B\in\mathcal B\subset\mathbb R^{c\times n\times n} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathcal" style="margin-right: 0.03041em;">B</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.771331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.771331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           a 
          
         
           t 
          
         
           o 
          
         
           m 
            
         
           f 
          
         
           l 
          
         
           o 
          
         
           w 
          
         
        
          atom\;flow 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span></span></span></span></span>的目标是为了生成正确的原子矩阵<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           A 
          
         
           ∈ 
          
         
           A 
          
         
           ⊂ 
          
          
          
            R 
           
           
           
             n 
            
           
             × 
            
           
             k 
            
           
          
         
        
          A\in\mathcal A\subset\mathbb R^{n\times k} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathcal">A</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></span>从而来组装有效的分子<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           M 
          
         
           = 
          
         
           ( 
          
         
           A 
          
         
           , 
          
         
           B 
          
         
           ) 
          
         
           ∈ 
          
         
           M 
          
         
           ⊂ 
          
          
          
            R 
           
           
           
             n 
            
           
             × 
            
           
             k 
            
           
             + 
            
           
             c 
            
           
             × 
            
           
             n 
            
           
             × 
            
           
             n 
            
           
          
         
        
          M=(A,B)\in\mathcal M\subset\mathbb R^{n\times k+c\times n\times n} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">M</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathcal">M</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">c</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span>。作者先定义了<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           B 
          
         
        
          \mathcal B 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span></span></span></span><strong>-conditional flow and graph conditional flow</strong><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
        
               
          
          
            f 
           
           
           
             A 
            
           
             ∣ 
            
           
             B 
            
           
          
         
        
          \;\;\mathcal f_{\mathcal {A|B}} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.04964em; vertical-align: -0.3552em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mord mtight">∣</span><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。这个变换是根据给定的矩阵<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           B 
          
         
        
          \mathcal B 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span></span></span></span>，来将矩阵<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           A 
          
         
        
          \mathcal A 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span>转换为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            Z 
           
           
           
             A 
            
           
             ∣ 
            
           
             B 
            
           
          
         
        
          \mathcal Z_{A|B} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.03853em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.07944em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: -0.07944em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right: 0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span></span></span></span></span>即<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            Z 
           
           
           
             A 
            
           
             ∣ 
            
           
             B 
            
           
          
         
           = 
          
          
          
            f 
           
           
           
             A 
            
           
             ∣ 
            
           
             B 
            
           
          
         
           ( 
          
          
          
            A 
           
          
            ∣ 
           
          
            B 
           
          
         
           ) 
          
         
        
          Z_{A|B}=\mathcal f_{\mathcal{A|B}}(\mathcal{A|B}) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.03853em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right: 0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.1052em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mord mtight">∣</span><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathcal">A</span><span class="mord">∣</span><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span><span class="mclose">)</span></span></span></span></span>，并且<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            P 
           
           
           
             Z 
            
            
            
              A 
             
            
              ∣ 
             
            
              B 
             
            
           
          
         
        
          P_{\mathcal Z_{\mathcal{A|B}}} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.09197em; vertical-align: -0.40864em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.07944em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3448em; margin-left: -0.07944em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mord mtight">∣</span><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.369486em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.40864em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是一个 各向同性的多元高斯分布。</p> </li><li> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            Z 
           
           
           
             A 
            
           
             ∣ 
            
           
             B 
            
           
          
         
           = 
          
          
          
            f 
           
           
           
             A 
            
           
             ∣ 
            
           
             B 
            
           
          
         
           ( 
          
          
          
            A 
           
          
            ∣ 
           
          
            B 
           
          
         
           ) 
          
         
        
          Z_{A|B}=\mathcal f_{\mathcal{A|B}}(\mathcal{A|B}) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.03853em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right: 0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.1052em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mord mtight">∣</span><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathcal">A</span><span class="mord">∣</span><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span><span class="mclose">)</span></span></span></span></span>是一个可逆的变换（即存在<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            f 
           
           
           
             A 
            
           
             ∣ 
            
           
             B 
            
           
           
           
             − 
            
           
             1 
            
           
          
         
           ( 
          
          
          
            Z 
           
           
           
             A 
            
           
             ∣ 
            
           
             B 
            
           
          
         
           ∣ 
          
         
           B 
          
         
           ) 
          
         
           = 
          
         
           A 
          
         
           ∣ 
          
         
           B 
          
         
        
          f^{-1}_{\mathcal{A|B}}(Z_{A|B}|B)=A|B 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.36944em; vertical-align: -0.5152em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.854239em;"><span class="" style="top: -2.3598em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mord mtight">∣</span><span class="mord mathcal mtight" style="margin-right: 0.03041em;">B</span></span></span></span></span><span class="" style="top: -3.10313em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.5152em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right: 0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span></span></span></span></span>），并且变换前后维数保持不变。接下来来求取满足flow模型的雅克比矩阵。因为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           B 
          
         
           ∈ 
          
         
           B 
          
         
        
          B\in\mathcal B 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.03041em;">B</span></span></span></span></span>在整个变换过程中保持不变。所以有<br> <img src="https://images2.imgbox.com/91/12/KfexYMuw_o.png" alt="在这里插入图片描述"><br> 则有<br> <img src="https://images2.imgbox.com/1a/d8/Cr1HGWTB_o.png" alt="在这里插入图片描述">则有:<br> <img src="https://images2.imgbox.com/db/dd/HRMOwgy2_o.png" alt="在这里插入图片描述"></p> </li><li> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           g 
          
         
           r 
          
         
           a 
          
         
           p 
          
         
           h 
              
         
           c 
          
         
           o 
          
         
           u 
          
         
           p 
          
         
           l 
          
         
           i 
          
         
           n 
          
         
           g 
              
         
           l 
          
         
           a 
          
         
           y 
          
         
           e 
          
         
           r 
          
         
        
          \mathbf{graph\;\;coupling\;\;layer} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.01597em;">g</span><span class="mord mathbf">r</span><span class="mord mathbf">a</span><span class="mord mathbf">p</span><span class="mord mathbf">h</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf">c</span><span class="mord mathbf">o</span><span class="mord mathbf">u</span><span class="mord mathbf">p</span><span class="mord mathbf">l</span><span class="mord mathbf">i</span><span class="mord mathbf">n</span><span class="mord mathbf" style="margin-right: 0.01597em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf">l</span><span class="mord mathbf">a</span><span class="mord mathbf" style="margin-right: 0.01597em;">y</span><span class="mord mathbf">e</span><span class="mord mathbf">r</span></span></span></span></span></span>：<br> <img src="https://images2.imgbox.com/a5/c9/eQhn1OYg_o.png" alt="在这里插入图片描述"><br> 则：<br> <img src="https://images2.imgbox.com/c2/34/uBX1M1bR_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>actnorm2D</strong>：来执行一个正则化<br> <img src="https://images2.imgbox.com/a9/82/0TLlzwJU_o.png" alt="在这里插入图片描述"><br> 则有<img src="https://images2.imgbox.com/ff/c1/xkWFvL6m_o.png" alt="在这里插入图片描述"><br> 接下来作者介绍了如何使得网络变得更深的一个技巧：即每隔一层交换<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            A 
           
          
            1 
           
          
         
           , 
          
          
          
            A 
           
          
            2 
           
          
         
           或 
          
         
           者 
          
          
          
            B 
           
          
            1 
           
          
         
           , 
          
          
          
            B 
           
          
            2 
           
          
         
        
          A_{1},A_{2}或者B_{1},B_{2} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">或</span><span class="mord cjk_fallback">者</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的位置。如下所示：</p> </li></ul> 
<p><img src="https://images2.imgbox.com/bc/73/6fr6rMFY_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="224_Validity_Correction_91"></a>2.2.4 Validity Correction</h4> 
<p>分子必须遵循每个原子的化合价约束，但是用生成的键张量和原子矩阵组装一个分子可能会导致化学无效。所以需要为每个原子定义一个有效性检查：<br> <img src="https://images2.imgbox.com/2a/cf/aclm3eUw_o.png" alt="在这里插入图片描述"><br> 作者举例说明了这一形式。对于铵根正离子<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         [ 
        
       
         N 
        
        
        
          H 
         
        
          4 
         
        
        
        
          ] 
         
        
          + 
         
        
       
      
        [NH_{4}]^{+} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.02133em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.771331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span></span></span></span></span></span></span></span></span>中的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         N 
        
       
      
        N 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span></span></span></span></span>它会有四个化学键，而不是三个。同样的，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          S 
         
        
          + 
         
        
       
         与 
        
        
        
          O 
         
        
          + 
         
        
       
      
        S^{+}与O^{+} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.771331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.771331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback">与</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.771331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span></span></span></span></span></span></span></span></span>也会有3个化学键而不是两个。作者将<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          O 
         
        
          + 
         
          
       
         , 
        
        
        
          S 
         
        
          + 
         
          
       
         , 
        
        
        
          N 
         
        
          + 
         
        
       
      
        O^{+}\;,S^{+}\;,N^{+} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.965771em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.771331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.771331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.771331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span></span></span></span></span></span></span></span></span>的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         C 
        
       
         h 
        
       
      
        Ch 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mord mathdefault">h</span></span></span></span></span>设为1，其他原子的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         C 
        
       
         h 
        
       
      
        Ch 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mord mathdefault">h</span></span></span></span></span>设为0。</p> 
<p>作者设计的有效性检查尝试对分子做最小的改变来使其具有化学上的合理性，并使分子图中最大的连接成分尽可能大。有效性检查如下：</p> 
<ul><li>首先，根据上式，为每个原子检查化学键数目的有效性；</li><li>如果分子满足上述约束，将图结构中最大的连接成分作为最终生成的分子输出，整个生成过程结束；</li><li>如果分子中第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          i 
         
        
       
         i 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>个原子没有满足上述约束，则对按顺序对这个原子的化学键进行排序，并将顺序最大的键减去1，将得到的新分子重新进行第一步。</li></ul> 
<h2><a id="Experiments_102"></a>三、Experiments</h2> 
<p>作者通过以下四个方面进行了实验来评估MoFlow模型：</p> 
<ul><li><strong>分子图生成与重建</strong>：首先是重建数据集中的所有分子，并生成尽可能多的有效的，不属于数据集的分子图；</li><li><strong>可视化潜在空间</strong>：MoFlow能否将分子图嵌入到具有合理化学相似性的连续潜空间中?</li><li><strong>性质优化</strong>：模型能否生成具有优化性质的分子图；</li><li><strong>约束属性优化</strong>：，模型能否生成具有优化特性的新颖分子图，同时尽可能保持化学相似性？</li></ul> 
<p>作者采用的数据集如下：<br> <img src="https://images2.imgbox.com/8e/cd/YEvjL8V2_o.png" alt="在这里插入图片描述"><br> 作者在文章中提到，对于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Z 
        
       
         I 
        
       
         N 
        
       
         C 
        
       
         250 
        
       
         K 
        
       
      
        ZINC250K 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">Z</span><span class="mord mathdefault" style="margin-right: 0.07847em;">I</span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mord">2</span><span class="mord">5</span><span class="mord">0</span><span class="mord mathdefault" style="margin-right: 0.07153em;">K</span></span></span></span></span>MoFlow只用了22小时便训练完成，而基于自回归的方法<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         G 
        
       
         r 
        
       
         a 
        
       
         p 
        
       
         h 
        
       
         A 
        
       
         F 
        
       
      
        GraphAF 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span></span></span></span></span>用了124个小时，这也体现了非自回归方法高效的优点。</p> 
<h3><a id="31__113"></a>3.1 生成与重建</h3> 
<p>五个指标：</p> 
<ul><li><strong>Validity</strong>：化学有效分子在所有生成的分子中的百分比；</li><li><strong>Uniqueness</strong>：所有生成的分子中不属于原数据集并且满足化学有效性的分子数与生成的分子数之比；</li><li><strong>Novelty</strong>：所有生成的分子中不属于原数据集并且满足化学有效性的分子数与数据集所含分子数之比（貌似和上一个指标有些重复，可能上一个指标将生成的分子中重复的分子删去后在进行计算）；</li><li><strong>Reconstruction</strong>：原数据集中能够完全被模型重建的分子数与数据集所含分子数之比；</li><li><strong>N.U.V.</strong>：生成的分子中满足：<strong>Validity</strong>，<strong>Uniqueness</strong>，<strong>Novelty</strong>分子的数量与生成的分子数之比。</li><li><strong>Validity without check/correction</strong></li></ul> 
<p>实验结果如下：<br> <img src="https://images2.imgbox.com/57/e1/siuvgyfq_o.png" alt="在这里插入图片描述"><br> MoFlow在不进行化学有效性检查的情况下，仍然获得了极佳的生成结果。</p> 
<h3><a id="32_127"></a>3.2潜在空间的可视化</h3> 
<p>作者利用谷本系数来反应化学相似性。<br> 作者先讲一个分子映射为一个潜在向量Z，通过下式来得到与之相近的分子：<br> <img src="https://images2.imgbox.com/5c/47/ZapfUIgY_o.png" alt="在这里插入图片描述"><br> X,Y均为单位矢量。<br> 结果如下：<br> <img src="https://images2.imgbox.com/39/b9/BV1wRQT5_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="33__135"></a>3.3 性能优化</h3> 
<p>这个任务的目的是为了生成具有最佳QED分数的分子。<br> 作者先将分子图映射为嵌入向量<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Z 
        
       
      
        Z 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">Z</span></span></span></span></span>，然后训练一个多层的MLP来回归预测其QED分数。训练完成后，根据先将Z送入MLP中得到QED分数y，然后根据梯度来优化<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Z 
        
       
      
        Z 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">Z</span></span></span></span></span>即：<br> <img src="https://images2.imgbox.com/d6/3a/YBjqlwyc_o.png" alt="在这里插入图片描述"><br> 执行K次后，得到最终的优化分子，经过逆变换生成对应的分子。实验结果表明，MoFlow模型能够找到更多具有最佳QED分数的分子图结构：<br> <img src="https://images2.imgbox.com/be/36/mA8nwbYx_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/33/41/EhI2Ciu3_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="34__143"></a>3.4 约束属性优化</h3> 
<p>这个任务致力于给定一个分子图，来找到一个符合两个最值的分子，即与原分子最相似，在相关性能分数上得到最大的提升。<br> 作者使用了morgan指纹的tanimoto相似性系数来衡量两个分子之间的相似性，以及<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         l 
        
       
         o 
        
       
         g 
        
       
         P 
        
       
      
        logP 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span></span>作为目标性质。作者同样用基于梯度的方法来实现。实验结果如下：</p> 
<p><img src="https://images2.imgbox.com/29/ce/7lK6xcks_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/57dac1af83aaa5f97da43f741b037300/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Vue 中数组对象排序</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/851c5801233fa4319a90893df37e5101/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Caffeine使用篇 - Eviction</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>