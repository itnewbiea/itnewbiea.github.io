<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MobileNet、GhostNet理解及测试 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MobileNet、GhostNet理解及测试" />
<meta property="og:description" content="MobileNet由谷歌于2017年提出，它是一种能够用在端侧设备上的轻量级网络。GhostNet是华为诺亚实验室开发的一款轻量级网络，论文发表在CVPR2020。我认为学习论文还是要实际跑一跑代码，这样才能有更深入的体会和理解，本文首先简介两个网络的原理，然后在cifar10上进行对比试验，并展开一定的讨论分析。毕竟个人水平有限，资源也有限试验开展的不够充分，所以理解不正确的地方还请批评指正。
MobileNet论文：https://arxiv.org/abs/1704.04861
MobileNet代码：https://github.com/Zehaos/MobileNet
GhostNet论文：https://arxiv.org/abs/1911.11907
GhostNet代码：https://github.com/huawei-noah/ghostnet
文章目录 一、主要原理1.MobileNet的深度可分离卷积2.GhostNet的幻影模块 二、cifar10数据试验1.试验说明2.试验结果3.结果分析 三、讨论 一、主要原理 1.MobileNet的深度可分离卷积 MobileNet的核心是深度可分离卷积，就是把普通卷积操作分成两步：第一步称为Depthwise卷积，先对各通道进行单通道的卷积，每次输出也是单通道的特征图，再合并起来得到和输入通道数相同的特征图，这个操作比原操作大大降低了参数量和计算量（FLOPs，浮点运算数，即加法和乘法的次数），但是它没有结合各通道间的信息，所以还要第二步；第二步称为Pointwise卷积，对第一步输出的特征图进行1×1卷积，进行通道信息混合后按需要的通道数输出。
普通卷积的参数量是： k 2 × C i n × C o u t k^2×C_{in}×C_{out} k2×Cin​×Cout​
普通卷积的FLOPs是： 2 k 2 × C i n × C o u t × H o u t × W o u t 2k^2×C_{in}×C_{out}×H_{out}×W_{out} 2k2×Cin​×Cout​×Hout​×Wout​
可分离卷积的参数量是： k 2 × C i n &#43; C i n × C o u t k^2×C_{in} &#43; C_{in}×C_{out} k2×Cin​&#43;Cin​×Cout​" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/7b04c67ca0fdc7a930d44043771ff0d9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-17T22:34:38+08:00" />
<meta property="article:modified_time" content="2021-01-17T22:34:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MobileNet、GhostNet理解及测试</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>  MobileNet由谷歌于2017年提出，它是一种能够用在端侧设备上的轻量级网络。GhostNet是华为诺亚实验室开发的一款轻量级网络，论文发表在CVPR2020。我认为学习论文还是要实际跑一跑代码，这样才能有更深入的体会和理解，本文首先简介两个网络的原理，然后在cifar10上进行对比试验，并展开一定的讨论分析。毕竟个人水平有限，资源也有限试验开展的不够充分，所以理解不正确的地方还请批评指正。<br> MobileNet论文：<a href="https://arxiv.org/abs/1704.04861" rel="nofollow">https://arxiv.org/abs/1704.04861</a><br> MobileNet代码：<a href="https://github.com/Zehaos/MobileNet">https://github.com/Zehaos/MobileNet</a><br> GhostNet论文：<a href="https://arxiv.org/abs/1911.11907" rel="nofollow">https://arxiv.org/abs/1911.11907</a><br> GhostNet代码：<a href="https://github.com/huawei-noah/ghostnet">https://github.com/huawei-noah/ghostnet</a><br> </p> 
<hr color="#000000" size='1"'> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_15" rel="nofollow">一、主要原理</a></li><li><ul><li><a href="#1MobileNet_16" rel="nofollow">1.MobileNet的深度可分离卷积</a></li><li><a href="#2GhostNet_25" rel="nofollow">2.GhostNet的幻影模块</a></li></ul> 
  </li><li><a href="#cifar10_29" rel="nofollow">二、cifar10数据试验</a></li><li><ul><li><a href="#1_30" rel="nofollow">1.试验说明</a></li><li><a href="#2_45" rel="nofollow">2.试验结果</a></li><li><a href="#3_60" rel="nofollow">3.结果分析</a></li></ul> 
  </li><li><a href="#_64" rel="nofollow">三、讨论</a></li></ul> 
</div> 
<p></p> 
<hr color="#000000" size='1"'> 
<h2><a id="_15"></a>一、主要原理</h2> 
<h3><a id="1MobileNet_16"></a>1.MobileNet的深度可分离卷积</h3> 
<p>  MobileNet的核心是深度可分离卷积，就是把普通卷积操作分成两步：第一步称为Depthwise卷积，先对各通道进行单通道的卷积，每次输出也是单通道的特征图，再合并起来得到和输入通道数相同的特征图，这个操作比原操作大大降低了参数量和计算量（FLOPs，浮点运算数，即加法和乘法的次数），但是它没有结合各通道间的信息，所以还要第二步；第二步称为Pointwise卷积，对第一步输出的特征图进行1×1卷积，进行通道信息混合后按需要的通道数输出。<br>   普通卷积的参数量是：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          k 
         
        
          2 
         
        
       
         × 
        
        
        
          C 
         
         
         
           i 
          
         
           n 
          
         
        
       
         × 
        
        
        
          C 
         
         
         
           o 
          
         
           u 
          
         
           t 
          
         
        
       
      
        k^2×C_{in}×C_{out} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br>   普通卷积的FLOPs是：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         2 
        
        
        
          k 
         
        
          2 
         
        
       
         × 
        
        
        
          C 
         
         
         
           i 
          
         
           n 
          
         
        
       
         × 
        
        
        
          C 
         
         
         
           o 
          
         
           u 
          
         
           t 
          
         
        
       
         × 
        
        
        
          H 
         
         
         
           o 
          
         
           u 
          
         
           t 
          
         
        
       
         × 
        
        
        
          W 
         
         
         
           o 
          
         
           u 
          
         
           t 
          
         
        
       
      
        2k^2×C_{in}×C_{out}×H_{out}×W_{out} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br>   可分离卷积的参数量是：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          k 
         
        
          2 
         
        
       
         × 
        
        
        
          C 
         
         
         
           i 
          
         
           n 
          
         
        
       
         + 
        
        
        
          C 
         
         
         
           i 
          
         
           n 
          
         
        
       
         × 
        
        
        
          C 
         
         
         
           o 
          
         
           u 
          
         
           t 
          
         
        
       
      
        k^2×C_{in} + C_{in}×C_{out} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br>   可分离卷积的FLOPs是：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         2 
        
        
        
          k 
         
        
          2 
         
        
       
         × 
        
        
        
          C 
         
         
         
           i 
          
         
           n 
          
         
        
       
         × 
        
        
        
          H 
         
         
         
           o 
          
         
           u 
          
         
           t 
          
         
        
       
         × 
        
        
        
          W 
         
         
         
           o 
          
         
           u 
          
         
           t 
          
         
        
       
         + 
        
       
         2 
        
        
        
          C 
         
         
         
           i 
          
         
           n 
          
         
        
       
         × 
        
        
        
          C 
         
         
         
           o 
          
         
           u 
          
         
           t 
          
         
        
       
         × 
        
        
        
          H 
         
         
         
           o 
          
         
           u 
          
         
           t 
          
         
        
       
         × 
        
        
        
          W 
         
         
         
           o 
          
         
           u 
          
         
           t 
          
         
        
       
      
        2k^2×C_{in}×H_{out}×W_{out} + 2C_{in}×C_{out}×H_{out}×W_{out} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br>   通常中间层的通道数和特征图尺寸数都较大，可分离卷积的参数量和计算量主要集中在第二步1×1卷积部分，与比较常用的3×3卷积的普通卷积相比，它的参数量核计算量只有1/9。</p> 
<p><img src="https://images2.imgbox.com/be/9a/mrcmTsiR_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2GhostNet_25"></a>2.GhostNet的幻影模块</h3> 
<p>  GhostNet的核心是提出了GhostModule，我们暂且称为幻影模块，幻影模块也是把普通卷积分为两步：作者认为普通卷积生成的特征图中有大量冗余，所以第一步用原卷积运算先生成少部分通道数的特征图；第二步再用“廉价运算”Cheap Operation对第一步生成的特征图再简单运算生成更多的特征，把两步生成的特征图cat合并得到和原来普通卷积同样尺寸的特征图。所谓的廉价运算，就是指的单通道分组卷积，和Depthwise卷积差不多。参数量和计算量主要集中在第一步，第一步生成的通道数和原卷积通道数的比例被称为压缩比，如果压缩比为2，则参数量和计算量就大约是原卷积参数量和计算量的1/2，考虑到精度影响，根据作者的试验数据，压缩比以2为佳，不宜超过4。<br>   由于MobileNet的深度可分离卷积通常可以实现1/9左右的压缩，所以如果仅把普通卷积替换为幻影模块，压缩量还不如MobileNet。看作者的开源代码，如果我理解没错的话，实际上是对MobileNet的1×1卷积Pointwise部分再替换为幻影模块，也就是说在压缩基础上再压缩。<br> <img src="https://images2.imgbox.com/c7/97/GVAPq0nG_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="cifar10_29"></a>二、cifar10数据试验</h2> 
<h3><a id="1_30"></a>1.试验说明</h3> 
<p>  由于cifar10的图片尺寸是32×32的，运算速度特别快，我卡只一个，人只一枚，所以就在cifar10上做一些对比试验。训练的时候没有使用各种tricks，比如数据增广、学习率调整等等，所以训练远未充分，我的主要目的是通过实际跑代码深入学习理解两个网络，并不作为测评对比指标。<br> 使用的网络如下表：</p> 
<table><thead><tr><th><strong>VGG16</strong></th><th><strong>VGG16(DW-PW)</strong></th><th><strong>VGG16(Ghost)</strong></th></tr></thead><tbody><tr><td><a href="https://blog.csdn.net/qq_41563738/article/details/91346181">VGG16 开源</a></td><td>把VGG16的卷积替换为深度可分离卷积</td><td>替换为Ghost模块</td></tr><tr><td><strong>ResNet34</strong></td><td><strong>ResNet34(DW-PW)</strong></td><td><strong>ResNet34(Ghost)</strong></td></tr><tr><td>ResNet34开源</td><td>把ResNet34的非1×1卷积替换为深度可分离卷积</td><td>替换为Ghost模块</td></tr><tr><td><strong>GhostNet</strong></td><td><strong>GhostNet(DW-PW)</strong></td><td><strong>GhostNet(Conv)</strong></td></tr><tr><td><a href="https://github.com/huawei-noah/ghostnet">GhostNet开源代码</a></td><td>把GhostNet的GhostModule替换为深度可分离卷积</td><td>替换为普通卷积</td></tr></tbody></table> 
<p>试验配置：<br> 数据：cifar10, 训练集50000张32×32×3图片，测试集10000张32×32×3图片，10类。<br> 训练：Adam(lr=0.01)，batch_size=512, epoch=50, GPU: 2080Ti×1</p> 
<h3><a id="2_45"></a>2.试验结果</h3> 
<p>其中参数量和FLOPs仅指所有卷积层的，计算方法和代码参见我之前的博客：<a href="https://blog.csdn.net/Brikie/article/details/112646865">https://blog.csdn.net/Brikie/article/details/112646865</a><br> 由于训练不充分，精度比文献给出的值低不少。</p> 
<table><thead><tr><th>网络</th><th>参数量</th><th>FLOPs</th><th>训练速度/epoch</th><th>验证速度</th><th>推理速度/单图</th><th>显存</th><th>精度%</th></tr></thead><tbody><tr><td>VGG16</td><td>14.7M</td><td>626M</td><td>10.6s</td><td>1.68s</td><td>5.9ms</td><td>4.8G</td><td>83.9</td></tr><tr><td>VGG16(DW-PW)</td><td>1.68M</td><td>72.9M</td><td>8.03s</td><td>1.59s</td><td>3.3ms</td><td>3.6G</td><td>82.1</td></tr><tr><td>VGG16(Ghost)</td><td>877K</td><td>40.6M</td><td>9.97s</td><td>1.62s</td><td>5.9ms</td><td>3.9G</td><td>82.0</td></tr><tr><td>ResNet34</td><td>21.26M</td><td>2.32G</td><td>27.7s</td><td>2.66s</td><td>4.7ms</td><td>6.5GB</td><td>84.3</td></tr><tr><td>ResNet34(DW-PW)</td><td>2.58M</td><td>283M</td><td>24.0s</td><td>2.37s</td><td>7.2ms</td><td>9.5GB</td><td>85.4</td></tr><tr><td>ResNet34(Ghost)</td><td>1.44M</td><td>163M</td><td>32.3s</td><td>2.92s</td><td>4.8ms</td><td>10.5GB</td><td>84.8</td></tr><tr><td>GhostNet(Conv)</td><td>19.1M</td><td>80.7M</td><td>6.41s</td><td>1.48s</td><td>7.0ms</td><td>5.1GB</td><td>75.6</td></tr><tr><td>GhostNet(DW-PW)</td><td>4.81M</td><td>15.3M</td><td>6.38s</td><td>1.44s</td><td>9.5ms</td><td>5.9GB</td><td>75.3</td></tr><tr><td>GhostNet</td><td>3.88M</td><td>11.0M</td><td>6.99s</td><td>1.49s</td><td>13.3ms</td><td>5.0GB</td><td>74.2</td></tr></tbody></table> 
<h3><a id="3_60"></a>3.结果分析</h3> 
<p>（1）能够明显观察到使用深度可分离卷积以及使用Ghost模块后，参数量和浮点运算量都会明显下降。<br> （2）但是观察训练速度、推理速度以及显存占用都没有明显下降甚至还有上升。我认为这可能是电脑GPU上的CUDA没有专门针对可分离卷积以及Ghost模块进行优化导致的，因为加入可分离卷积或Ghost模块后虽然参数量下降，但是卷积层数变多，这导致串行运算更多，没有专门优化的时候速度反而会下降。显存为什么会变多我没有弄清楚。但可以肯定的是这些轻量级网络在端侧设备应用时还必须有专门的优化才能发挥其性能。<br> （3）深度可分离卷积和幻影模块加入后训练精度没有明显降低，甚至还有提高，和论文结论不一致，可能是训练不够充分没能观察到最终的结果。</p> 
<h2><a id="_64"></a>三、讨论</h2> 
<p>下面的一些讨论涉及的试验数据不再给出，仅给出结论。<br> 1，深度可分离卷积中为什么先DW后PW，反过来会怎样？<br> 反过来也是可以的，效果没有太大的区别。<br> 2，Ghost模块中的cheap特征毕竟是用简单运算生成的，我们想知道是否它们是必要的？如果我们直接用无参数的线性变换生成cheap特征会怎样？如果去掉它们会怎样？<br> 试验发现cheap特征是有用的，使用全部置零的方式放弃这部分特征会降低精度。如果使用固定的线性变换生成cheap特征，即不使用含可学习参数的卷积运算也会导致精度降低。所以这些特征是必要的。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3d33416d9be94af9e5e24b7311dba66a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">时间复杂度和空间复杂度分析</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bdae351809a026410c498d1b10b7616a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">RepVGG网络结构解读</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>