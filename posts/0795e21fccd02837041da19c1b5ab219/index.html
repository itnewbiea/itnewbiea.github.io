<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>阿白数模笔记之灰色-马尔科夫模型（Grey Markov model） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="阿白数模笔记之灰色-马尔科夫模型（Grey Markov model）" />
<meta property="og:description" content="目录
前言（preface）
GM(1,1)
简介(brief introdution)
①级比检验（Grade ratio test）
②建立GM(1,1)模型
Ⅰ、邻值生成序列（Adjacent value generating sequence ）
Ⅱ、回归分析（regression analysis）
Ⅲ、残差检验（Residual test）
Markov chain
① 转移概率矩阵（Transition probability matrix）
②状态分布向量(state vector)
③平稳分布向量(steady-state vector)
灰色马尔可夫模型（Grey Markov model）
①对y0建立GM(1,1)得到e1
Ⅰ、Grade ratio test
Ⅱ、Accumulative generation sequence
Ⅱ、Regression analysis&amp;Residual test
②对abs(e1)建立GM(1,1)
Ⅰ、Grade ratio test
Ⅱ、Accumulative generation sequence
Ⅱ、Regression analysis&amp;Residual test
③修正（revise）
Ⅰ、转移概率矩阵
Ⅱ、初始分布与预测
Ⅲ、修正效果
④总结（summary）
参考文章（Reference articles）
前言（preface） 在学习模拟退火算法时(Simulated Annealing，SA)发现了一个新名词——马尔科夫链（Markov chain）,所以就先学习了Markov chain的相关知识，本文主要介绍GM(1,1)，Markov chain，并将Grey Markov model应用到实例。
GM(1,1) 简介(brief introdution) 黑色未知，白色已知，而灰色是介于黑白之间的，意味着部分数据已知，而数据间有内在联系，但内在函数关系未知。GM(1,1)适用的情况大致满足以下条件：一、数据量少，二、短期预测，三、指数增长。下面是原数据和经过生成后的数据折线图，发现处理后的数据具有更明显的规律。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/0795e21fccd02837041da19c1b5ab219/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-02T10:50:52+08:00" />
<meta property="article:modified_time" content="2023-03-02T10:50:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">阿白数模笔记之灰色-马尔科夫模型（Grey Markov model）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%89%8D%E8%A8%80%EF%BC%88preface%EF%BC%89-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80%EF%BC%88preface%EF%BC%89" rel="nofollow">前言（preface）</a></p> 
<p id="GM(1%2C1)-toc" style="margin-left:0px;"><a href="#GM%281%2C1%29" rel="nofollow">GM(1,1)</a></p> 
<p id="%E7%AE%80%E4%BB%8B(brief%20introdution)-toc" style="margin-left:40px;"><a href="#%E7%AE%80%E4%BB%8B%28brief%20introdution%29" rel="nofollow">简介(brief introdution)</a></p> 
<p id="%C2%A0%E2%91%A0%E7%BA%A7%E6%AF%94%E6%A3%80%E9%AA%8C%EF%BC%88Grade%20ratio%20test%EF%BC%89-toc" style="margin-left:40px;"><a href="#%C2%A0%E2%91%A0%E7%BA%A7%E6%AF%94%E6%A3%80%E9%AA%8C%EF%BC%88Grade%20ratio%20test%EF%BC%89" rel="nofollow"> ①级比检验（Grade ratio test）</a></p> 
<p id="%E2%91%A1%E5%BB%BA%E7%AB%8BGM(1%2C1)%E6%A8%A1%E5%9E%8B-toc" style="margin-left:0px;"><a href="#%E2%91%A1%E5%BB%BA%E7%AB%8BGM%281%2C1%29%E6%A8%A1%E5%9E%8B" rel="nofollow">②建立GM(1,1)模型</a></p> 
<p id="%E2%85%A0%E3%80%81%E9%82%BB%E5%80%BC%E7%94%9F%E6%88%90%E5%BA%8F%E5%88%97%EF%BC%88Adjacent%20value%20generating%20sequence%C2%A0%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E2%85%A0%E3%80%81%E9%82%BB%E5%80%BC%E7%94%9F%E6%88%90%E5%BA%8F%E5%88%97%EF%BC%88Adjacent%20value%20generating%20sequence%C2%A0%EF%BC%89" rel="nofollow">Ⅰ、邻值生成序列（Adjacent value generating sequence ）</a></p> 
<p id="%E2%85%A1%E3%80%81%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%EF%BC%88regression%20analysis%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E2%85%A1%E3%80%81%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%EF%BC%88regression%20analysis%EF%BC%89" rel="nofollow">Ⅱ、回归分析（regression analysis）</a></p> 
<p id="%E2%85%A2%E3%80%81%E6%AE%8B%E5%B7%AE%E6%A3%80%E9%AA%8C%EF%BC%88Residual%20test%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E2%85%A2%E3%80%81%E6%AE%8B%E5%B7%AE%E6%A3%80%E9%AA%8C%EF%BC%88Residual%20test%EF%BC%89" rel="nofollow">Ⅲ、残差检验（Residual test）</a></p> 
<p id="Markov%20chain-toc" style="margin-left:0px;"><a href="#Markov%20chain" rel="nofollow">Markov chain</a></p> 
<p id="%E2%91%A0%20%E8%BD%AC%E7%A7%BB%E6%A6%82%E7%8E%87%E7%9F%A9%E9%98%B5%EF%BC%88Transition%20probability%20matrix%EF%BC%89-toc" style="margin-left:40px;"><a href="#%E2%91%A0%20%E8%BD%AC%E7%A7%BB%E6%A6%82%E7%8E%87%E7%9F%A9%E9%98%B5%EF%BC%88Transition%20probability%20matrix%EF%BC%89" rel="nofollow">① 转移概率矩阵（Transition probability matrix）</a></p> 
<p id="%E2%91%A1%E7%8A%B6%E6%80%81%E5%88%86%E5%B8%83%E5%90%91%E9%87%8F(state%20vector)-toc" style="margin-left:40px;"><a href="#%E2%91%A1%E7%8A%B6%E6%80%81%E5%88%86%E5%B8%83%E5%90%91%E9%87%8F%28state%20vector%29" rel="nofollow">②状态分布向量(state vector)</a></p> 
<p id="%E2%91%A2%E5%B9%B3%E7%A8%B3%E5%88%86%E5%B8%83%E5%90%91%E9%87%8F(steady-state%20vector)-toc" style="margin-left:40px;"><a href="#%E2%91%A2%E5%B9%B3%E7%A8%B3%E5%88%86%E5%B8%83%E5%90%91%E9%87%8F%28steady-state%20vector%29" rel="nofollow">③平稳分布向量(steady-state vector)</a></p> 
<p id="%E7%81%B0%E8%89%B2%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B%EF%BC%88Grey%20Markov%20model%EF%BC%89-toc" style="margin-left:0px;"><a href="#%E7%81%B0%E8%89%B2%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B%EF%BC%88Grey%20Markov%20model%EF%BC%89" rel="nofollow">灰色马尔可夫模型（Grey Markov model）</a></p> 
<p id="%E2%91%A0%E5%AF%B9y0%E5%BB%BA%E7%AB%8BGM(1%2C1)%E5%BE%97%E5%88%B0e1-toc" style="margin-left:40px;"><a href="#%E2%91%A0%E5%AF%B9y0%E5%BB%BA%E7%AB%8BGM%281%2C1%29%E5%BE%97%E5%88%B0e1" rel="nofollow">①对y0建立GM(1,1)得到e1</a></p> 
<p id="%E2%85%A0%E3%80%81Grade%20ratio%20test-toc" style="margin-left:80px;"><a href="#%E2%85%A0%E3%80%81Grade%20ratio%20test" rel="nofollow">Ⅰ、Grade ratio test</a></p> 
<p id="%E2%85%A1%E3%80%81Accumulative%20generation%20sequence-toc" style="margin-left:80px;"><a href="#%E2%85%A1%E3%80%81Accumulative%20generation%20sequence" rel="nofollow">Ⅱ、Accumulative generation sequence</a></p> 
<p id="%E2%85%A1%E3%80%81Regression%20analysis%26Residual%20test-toc" style="margin-left:40px;"><a href="#%E2%85%A1%E3%80%81Regression%20analysis%26Residual%20test" rel="nofollow">Ⅱ、Regression analysis&amp;Residual test</a></p> 
<p id="%E2%91%A1%E5%AF%B9abs(e1)%E5%BB%BA%E7%AB%8BGM(1%2C1)-toc" style="margin-left:40px;"><a href="#%E2%91%A1%E5%AF%B9abs%28e1%29%E5%BB%BA%E7%AB%8BGM%281%2C1%29" rel="nofollow">②对abs(e1)建立GM(1,1)</a></p> 
<p id="%E2%85%A0%E3%80%81Grade%20ratio%20test-toc" style="margin-left:80px;"><a href="#%E2%85%A0%E3%80%81Grade%20ratio%20test" rel="nofollow">Ⅰ、Grade ratio test</a></p> 
<p id="%E2%85%A1%E3%80%81Accumulative%20generation%20sequence-toc" style="margin-left:80px;"><a href="#%E2%85%A1%E3%80%81Accumulative%20generation%20sequence" rel="nofollow">Ⅱ、Accumulative generation sequence</a></p> 
<p id="%C2%A0%E2%85%A1%E3%80%81Regression%20analysis%26Residual%20test-toc" style="margin-left:80px;"><a href="#%C2%A0%E2%85%A1%E3%80%81Regression%20analysis%26Residual%20test" rel="nofollow"> Ⅱ、Regression analysis&amp;Residual test</a></p> 
<p id="%E2%91%A2%E4%BF%AE%E6%AD%A3%EF%BC%88revise%EF%BC%89-toc" style="margin-left:40px;"><a href="#%E2%91%A2%E4%BF%AE%E6%AD%A3%EF%BC%88revise%EF%BC%89" rel="nofollow">③修正（revise）</a></p> 
<p id="%E2%85%A0%E3%80%81%E8%BD%AC%E7%A7%BB%E6%A6%82%E7%8E%87%E7%9F%A9%E9%98%B5-toc" style="margin-left:80px;"><a href="#%E2%85%A0%E3%80%81%E8%BD%AC%E7%A7%BB%E6%A6%82%E7%8E%87%E7%9F%A9%E9%98%B5" rel="nofollow">Ⅰ、转移概率矩阵</a></p> 
<p id="%E2%85%A1%E3%80%81%E5%88%9D%E5%A7%8B%E5%88%86%E5%B8%83%E4%B8%8E%E9%A2%84%E6%B5%8B-toc" style="margin-left:80px;"><a href="#%E2%85%A1%E3%80%81%E5%88%9D%E5%A7%8B%E5%88%86%E5%B8%83%E4%B8%8E%E9%A2%84%E6%B5%8B" rel="nofollow">Ⅱ、初始分布与预测</a></p> 
<p id="%E2%85%A2%E3%80%81%E4%BF%AE%E6%AD%A3%E6%95%88%E6%9E%9C-toc" style="margin-left:80px;"><a href="#%E2%85%A2%E3%80%81%E4%BF%AE%E6%AD%A3%E6%95%88%E6%9E%9C" rel="nofollow">Ⅲ、修正效果</a></p> 
<p id="%C2%A0%E2%91%A3%E6%80%BB%E7%BB%93%EF%BC%88summary%EF%BC%89-toc" style="margin-left:40px;"><a href="#%C2%A0%E2%91%A3%E6%80%BB%E7%BB%93%EF%BC%88summary%EF%BC%89" rel="nofollow"> ④总结（summary）</a></p> 
<p id="%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0%EF%BC%88Reference%20articles%EF%BC%89-toc" style="margin-left:0px;"><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0%EF%BC%88Reference%20articles%EF%BC%89" rel="nofollow">参考文章（Reference articles）</a></p> 
<hr id="hr-toc"> 
<h2>前言（preface）</h2> 
<p>        在学习模拟退火算法时(Simulated Annealing，SA)发现了一个新名词——马尔科夫链（Markov chain）,所以就先学习了Markov chain的相关知识，本文主要介绍GM(1,1)，Markov chain，并将Grey Markov model应用到实例。</p> 
<h2 id="GM(1%2C1)">GM(1,1)</h2> 
<h3 id="%E7%AE%80%E4%BB%8B(brief%20introdution)">简介(brief introdution)</h3> 
<p>        黑色未知，白色已知，而灰色是介于黑白之间的，意味着部分数据已知，而数据间有内在联系，但内在函数关系未知。GM(1,1)适用的情况大致满足以下条件：一、数据量少，二、短期预测，三、指数增长。下面是原数据和经过生成后的数据折线图，发现处理后的数据具有更明显的规律。</p> 
<p><img alt="" class="left" height="259" src="https://images2.imgbox.com/6d/dd/2xMAHB04_o.png" width="318"><img alt="" height="262" src="https://images2.imgbox.com/6a/79/gOn4LN7S_o.png" width="332"></p> 
<p></p> 
<h3 id="%C2%A0%E2%91%A0%E7%BA%A7%E6%AF%94%E6%A3%80%E9%AA%8C%EF%BC%88Grade%20ratio%20test%EF%BC%89"> ①级比检验（Grade ratio test）</h3> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/4b/21/UTaJAGKL_o.png"></p> 
<pre><code class="language-Matlab">%Grade ratio test
y0=[71.1,72.4,72.4,72.1,71.4,72.0,71.6];
[m,n]=size(y0);
k=0;
for i=2:n;
    a=y0(i-1)/y0(i);
    if exp(-2/(n+1))&lt;a&lt;exp(2/(n+1));
        k=k+1;
    end
end
if k==n-1
    disp('grey modle is vailable')
else
    disp('grey modle is invailable')
end

output:
grey modle is vailable</code></pre> 
<h2 id="%E2%91%A1%E5%BB%BA%E7%AB%8BGM(1%2C1)%E6%A8%A1%E5%9E%8B">②建立GM(1,1)模型</h2> 
<h4 id="%E2%85%A0%E3%80%81%E9%82%BB%E5%80%BC%E7%94%9F%E6%88%90%E5%BA%8F%E5%88%97%EF%BC%88Adjacent%20value%20generating%20sequence%C2%A0%EF%BC%89">Ⅰ、邻值生成序列（Adjacent value generating sequence ）</h4> 
<pre><code class="language-Matlab">%GM(1,1)
x=1986:1992;
y0=[71.1,72.4,72.4,72.1,71.4,72.0,71.6];

plot(x,y0,'-ok','markerfacecolor','r','linewidth',2);
axis([1985,1993,60,80]);
title('某城市1986-1992交通噪声平均声级');grid on

%累加生成数列
y1=zeros(size(y0));
for i=1:size(y0,2);
    y1(i)=sum(y0(1:i));
end
figure,plot(x,y1,'-ok','markerfacecolor','r','linewidth',2);
axis([1985,1993,60,600]);

%均值生成数列
z1=zeros(size(y0));
for i=1:size(y0,2);
    if i==1;
        z1(i)=y1(i);
    else
        z1(i)=(y1(i)+y1(i-1))*0.5;
    end
end
hold on
plot(x,z1,'-ok','markerfacecolor','r','linewidth',2);
axis([1985,1993,60,600]);
title('生成序列');
legend('累加生成序列','均值生成序列');grid on</code></pre> 
<h4 id="%E2%85%A1%E3%80%81%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%EF%BC%88regression%20analysis%EF%BC%89">Ⅱ、回归分析（regression analysis）</h4> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/bc/9a/ut8Ydmzq_o.png"></p> 
<pre><code class="language-Matlab">fit1=polyfit(y1,y0,1);%拟合的一次函数
a1=fit1(1);u1=fit1(2);
%prediction
y11=zeros([1,1+n]);%n=size(y(0),2)
%y11是拟合后的累加生成序列
%y01用来储存时间步的预测值，y01(k+1)=y11(k+1)-y11(k)
y01=[y0(1),zeros([1,n])];
for k=0:n
    y11(k+1)=(y0(1)+u1/a1)*exp(a1*k)-u1/a1; %求解微分方程后的函数
    if k~=0
        y01(k+1)=y11(k+1)-y11(k);
    end
end

figure,plot(x,y0,'b*-');hold on
plot([x,1993],y01,'ro--');axis([1985,1993,60,80]);grid on
legend('actual','pred');title('Accumulative generation sequence')</code></pre> 
<h4 id="%E2%85%A2%E3%80%81%E6%AE%8B%E5%B7%AE%E6%A3%80%E9%AA%8C%EF%BC%88Residual%20test%EF%BC%89">Ⅲ、残差检验（Residual test）</h4> 
<pre><code class="language-Matlab">%Residual test
e1=abs((y0-y01(1,1:7)))./y0;
r11=length(e1(find(e1&lt;0.1)));
r12=length(e1(find(e1&lt;0.2)));
if r1==n
    disp('The fitting effect of the model is very good')
elseif r2==n
    disp('The fitting effect of the model is not bad' )
else
    disp('GM(1,1) is not suitable to solve this problem')
end

output:
The fitting effect of the model is very good</code></pre> 
<h2 id="Markov%20chain">Markov chain</h2> 
<p><img alt="" class="left" height="283" src="https://images2.imgbox.com/8c/f3/sbXmEf9P_o.png" width="677"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/50/ba/imNAxDIr_o.png"></p> 
<h3 id="%E2%91%A0%20%E8%BD%AC%E7%A7%BB%E6%A6%82%E7%8E%87%E7%9F%A9%E9%98%B5%EF%BC%88Transition%20probability%20matrix%EF%BC%89">① 转移概率矩阵（Transition probability matrix）</h3> 
<p>        动态规划算法中有个概念叫状态转移方程，就是说从前面 t-1 时刻的状态到 t时刻的状态的实现方式。Markov chain中的转移概率矩阵定义类似：（t-1）时刻处于状态 i，转移到状态 j 的概率为<img alt="p_{ij}=P(X_t=j|X_{t-1}=i)" class="mathcode" src="https://images2.imgbox.com/e2/29/dOcpwoEw_o.png">，则<img alt="p_{ij}\geq 0,\sum _jp_{ij}=1" class="mathcode" src="https://images2.imgbox.com/c6/67/dywlt3IK_o.png">，即每一行的和为1，称<img alt="P=[p_{ij}]" class="mathcode" src="https://images2.imgbox.com/05/61/ABpFk86N_o.png">为转移概率矩阵</p> 
<h3 id="%E2%91%A1%E7%8A%B6%E6%80%81%E5%88%86%E5%B8%83%E5%90%91%E9%87%8F(state%20vector)">②状态分布向量<strong>(state vector)</strong></h3> 
<p>        <img alt="\pi(t)=[\pi_1(t),\pi_2(t),...]^T" class="mathcode" src="https://images2.imgbox.com/fd/3a/U45X7zOU_o.png">,称为t时刻的状态分布向量，<img alt="\sum _{i=1}\pi_i(t)=1" class="mathcode" src="https://images2.imgbox.com/0b/7d/QnRj7IoD_o.png">，一般取<img alt="\pi(0)=[...0...1...0...]^T" class="mathcode" src="https://images2.imgbox.com/8e/a6/FWbaaTtW_o.png">为给定的初始分布，<img alt="\pi(t)=P\pi(t-1)=...=P^t\pi(0)" class="mathcode" src="https://images2.imgbox.com/22/29/xQAVmXt4_o.png">,其中P是转移概率矩阵</p> 
<h3 id="%E2%91%A2%E5%B9%B3%E7%A8%B3%E5%88%86%E5%B8%83%E5%90%91%E9%87%8F(steady-state%20vector)">③平稳分布向量(steady-state vector)</h3> 
<p>        对于一般的Markov chain ,当 t 足够大时，状态分布向量会收敛于某一特殊向量<img alt="\pi" class="mathcode" src="https://images2.imgbox.com/00/4d/nYZFdqJm_o.png">，即平稳分布向量，满足<img alt="P\pi(t)=P\pi(t+1)\Rightarrow P\pi(t)=P^2\pi(t)\Rightarrow P\pi=\pi" class="mathcode" src="https://images2.imgbox.com/ab/df/ucuyMLgr_o.png">，<img alt="\pi" class="mathcode" src="https://images2.imgbox.com/61/87/Jr3IXfTl_o.png">即是P特征值为 1 时对应的特征向量</p> 
<h2 id="%E7%81%B0%E8%89%B2%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B%EF%BC%88Grey%20Markov%20model%EF%BC%89">灰色马尔可夫模型（Grey Markov model）</h2> 
<p>        y0 是原始序列，y1是累加生成序列，y11是拟合后的累加生成序列，y01是对原时间步的预测</p> 
<p>e1是一阶残差序列e1=(y0-y1）</p> 
<h3 id="%E2%91%A0%E5%AF%B9y0%E5%BB%BA%E7%AB%8BGM(1%2C1)%E5%BE%97%E5%88%B0e1">①对y0建立GM(1,1)得到e1</h3> 
<h4 id="%E2%85%A0%E3%80%81Grade%20ratio%20test">Ⅰ、Grade ratio test</h4> 
<pre><code class="language-Matlab">%级比检验 Grade ratio test
y0=d;
[m,n]=size(y0);
k=0;
for i=2:n;
    a=y0(i-1)/y0(i);
    if exp(-2/(n+1))&lt;a&lt;exp(2/(n+1));
        k=k+1;
    end
end
if k==n-1
    disp('grey modle is vailable')
else
    disp('grey modle is invailable')
end
output:
grey modle is vailable</code></pre> 
<h4 id="%E2%85%A1%E3%80%81Accumulative%20generation%20sequence">Ⅱ、Accumulative generation sequence</h4> 
<pre><code class="language-Matlab">%GM(1,1)
x=1:20;
plot(x,y0,'-ok','markerfacecolor','r','linewidth',2);
axis([1,22,20,40]);
title('20旬某超市的的营业额');grid on;legend('data');
xlabel('时间/旬（10天）');ylabel('营业额/万元')

%累加生成数列
y1=zeros(size(y0));
for i=1:size(y0,2);
    y1(i)=sum(y0(1:i));
end

figure,plot(x,y1,'-ok','markerfacecolor','r','linewidth',2);
axis([1,22,0,600]);
grid on;legend('Accumulative generation sequence','location','northwest');
xlabel('时间/旬（10天）');ylabel('营业额/万元')</code></pre> 
<p><img alt="" class="left" height="260" src="https://images2.imgbox.com/8c/db/IQB0fgwK_o.png" width="311"><img alt="" height="260" src="https://images2.imgbox.com/f2/a4/yfBj66nE_o.png" width="337"></p> 
<h3 id="%E2%85%A1%E3%80%81Regression%20analysis%26Residual%20test">Ⅱ、Regression analysis&amp;Residual test</h3> 
<pre><code class="language-Matlab">fit1=polyfit(y1,y0,1);
a1=fit1(1);u1=fit1(2);
%prediction
y11=zeros([1,1+n]);%n=size(y(0),2)
%y11是拟合后的累加生成序列
%y01用来储存时间步的预测值，y01(k+1)=y11(k+1)-y11(k)
y01=[y0(1),zeros([1,n])];
for k=0:n
    y11(k+1)=(y0(1)+u1/a1)*exp(a1*k)-u1/a1;
    if k~=0
        y01(k+1)=y11(k+1)-y11(k);
    end
end

figure,plot(x,y0,'b*-');hold on
plot([x,21],y01,'ro--');axis([1,22,20,40]);grid on
legend('actual','Uncorrected GM(1,1)');title('Accumulative generation sequence')

%Residual test
e1=y0-y01(1,1:n)
e2=abs(e1)./y0;
r1=length(e2(find(e2&lt;0.1)));
r2=length(e2(find(e2&lt;0.2)));
if r1==n
    disp('The fitting effect of the model is very good')
elseif r2==n
    disp('The fitting effect of the model is not bad' )
else
    disp('GM(1,1) is not suitable to solve this problem')
end
</code></pre> 
<p style="text-align:center;"><img alt="" class="left" height="249" src="https://images2.imgbox.com/f5/2e/6YrjikXt_o.png" width="295">运行后的结果显示：The fitting effect of the model is not bad，但从预测图来看效果是非常差的，因此需要某种方法对GM(1,1)模型做出修正</p> 
<h3 id="%E2%91%A1%E5%AF%B9abs(e1)%E5%BB%BA%E7%AB%8BGM(1%2C1)">②对abs(e1)建立GM(1,1)</h3> 
<p>        代码与上面是基本一致的，只给出各步骤对应结果</p> 
<h4>Ⅰ、Grade ratio test</h4> 
<p>        grey modle is vailable</p> 
<h4>Ⅱ、Accumulative generation sequence</h4> 
<p style="text-align:center;"><img alt="" height="261" src="https://images2.imgbox.com/da/74/0hsYvE15_o.png" width="317"><img alt="" class="left" height="264" src="https://images2.imgbox.com/0d/e3/bXG08oSH_o.png" width="323"></p> 
<h4 id="%C2%A0%E2%85%A1%E3%80%81Regression%20analysis%26Residual%20test"> Ⅱ、Regression analysis&amp;Residual test</h4> 
<p><img alt="" class="left" height="274" src="https://images2.imgbox.com/b0/1a/v0z1c9EW_o.png" width="325"><img alt="" height="274" src="https://images2.imgbox.com/8d/b1/iK5xROiW_o.png" width="331"></p> 
<p> pred即为残差修正值，用e01储存GM(1,1)对e0的预测结果；y00为修正（corrected）的结果；<img alt="y00_k=y01_k+m_ke01_{k+1}" class="mathcode" src="https://images2.imgbox.com/f1/cd/QQwNx7JU_o.png">，其中<img alt="e1_{k}&gt;0,m_k=1" class="mathcode" src="https://images2.imgbox.com/31/61/labmQYBM_o.png">，<img alt="e1_k&lt;0,m_k=-1" class="mathcode" src="https://images2.imgbox.com/83/0d/SRP1QUXJ_o.png"></p> 
<h3 id="%E2%91%A2%E4%BF%AE%E6%AD%A3%EF%BC%88revise%EF%BC%89">③修正（revise）</h3> 
<h4 id="%E2%85%A0%E3%80%81%E8%BD%AC%E7%A7%BB%E6%A6%82%E7%8E%87%E7%9F%A9%E9%98%B5">Ⅰ、转移概率矩阵</h4> 
<p>      状态划分为正<img alt="M_1" class="mathcode" src="https://images2.imgbox.com/28/0e/58nB3pNX_o.png">,负<img alt="M_2" class="mathcode" src="https://images2.imgbox.com/a4/26/x5CSLfQN_o.png">，计算后知<img alt="M_1=6,M_2=12;M_{11}=2,M_{12}=4.M_{21}=5,M_{22}=7" class="mathcode" src="https://images2.imgbox.com/e4/ce/QP358OZ4_o.png"></p> 
<p><img alt="P=\binom{2/6\quad\quad4/6}{5/12\quad\quad7/12}" class="mathcode" src="https://images2.imgbox.com/4f/9a/yXfwzwa0_o.png">即为概率转移矩阵</p> 
<h4 id="%E2%85%A1%E3%80%81%E5%88%9D%E5%A7%8B%E5%88%86%E5%B8%83%E4%B8%8E%E9%A2%84%E6%B5%8B">Ⅱ、初始分布与预测</h4> 
<p>        以最后一个残差为初始分布<img alt="\pi (0)" class="mathcode" src="https://images2.imgbox.com/c6/ea/gTuumhfm_o.png">，若大于0，则<img alt="\pi (0)=\binom{1}{0}" class="mathcode" src="https://images2.imgbox.com/77/aa/rZ2U7hFp_o.png">，否则<img alt="\pi (0)=\binom{0}{1}" class="mathcode" src="https://images2.imgbox.com/93/15/xeq1foHk_o.png">，预测之后 t 个时间步，则对应的状态分布为<img alt="\pi (t)=P^t\pi(0)=\binom{p_{t1}}{p_{t2}}" class="mathcode" src="https://images2.imgbox.com/91/bd/CkNzyEwl_o.png">,若<img alt="p_{t1}\geq p_{t2}" class="mathcode" src="https://images2.imgbox.com/51/01/7YJJqhRh_o.png">，则取<img alt="m_k=1" class="mathcode" src="https://images2.imgbox.com/5b/30/lhli10AZ_o.png">，否则<img alt="m_k=-1" class="mathcode" src="https://images2.imgbox.com/d1/07/4gcOeCoE_o.png">。</p> 
<h4 id="%E2%85%A2%E3%80%81%E4%BF%AE%E6%AD%A3%E6%95%88%E6%9E%9C">Ⅲ、修正效果</h4> 
<p style="text-align:center;"><img alt="" class="left" height="531" src="https://images2.imgbox.com/2b/e0/hhB11fOH_o.png" width="645"></p> 
<h3 id="%C2%A0%E2%91%A3%E6%80%BB%E7%BB%93%EF%BC%88summary%EF%BC%89"> ④总结（summary）</h3> 
<p>        通过引入残差的GM(1,1)来修正误差，并采用Markov chain 预测残差和原data下一个时间步的值，通过状态分布向量预估正负号，再对数据进行修正。Grey Markov model 弥补了传统GM(1,1)对波动性和趋势性数据预测精度低的不足</p> 
<h2 id="%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0%EF%BC%88Reference%20articles%EF%BC%89">参考文章（Reference articles）</h2> 
<p><a class="link-info" href="https://blog.csdn.net/qq547276542/article/details/77865341?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167766466616800197033207%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=167766466616800197033207&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-77865341-null-null.142%5Ev73%5Einsert_down4,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&amp;utm_term=GM%281%2C1%29&amp;spm=1018.2226.3001.4187" title="灰色预测模型GM(1,1) 与例题分析">灰色预测模型GM(1,1) 与例题分析</a></p> 
<p><a class="link-info" href="https://blog.csdn.net/qq_42374697/article/details/111086335?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167766321916800197027473%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=167766321916800197027473&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-111086335-null-null.142%5Ev73%5Einsert_down4,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&amp;utm_term=%E7%81%B0%E8%89%B2%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E9%A2%84%E6%B5%8B%E6%A8%A1%E5%9E%8B&amp;spm=1018.2226.3001.4187" title="灰色-马尔可夫模型">灰色-马尔可夫模型</a></p> 
<p><a class="link-info" href="https://zhuanlan.zhihu.com/p/448575579" rel="nofollow" title="简述马尔可夫链【通俗易懂】">简述马尔可夫链【通俗易懂】</a></p> 
<p><a class="link-info" href="https://blog.csdn.net/weixin_42437114/article/details/120935992" title="马尔可夫链 (Markov Chains)">马尔可夫链 (Markov Chains)</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/68a50c89e8ecce285fcafdc758b78c41/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">idea启动报Plugin Error错误的解决办法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ca75bf129910b81132731b9b8920ffde/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">西门子PLC S7-200SMART Modbus TCP通讯的步骤和要点</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>