<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java 利用poi根据excel模板导出数据（三） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java 利用poi根据excel模板导出数据（三）" />
<meta property="og:description" content="本文是 java 利用poi根据excel模板导出数据（一） 的优化版本
主要针对于 fillBodyData 方法这块，具体如下
源代码：
private static void fillBodyData(Sheet sheet, int startRow, List&lt;NutMap&gt; bodyList, int[] colWidth) { // 碰到 时间、金额等需要转换的 在setCellValue 里面操作 for (int rowNum = 0; rowNum &lt; bodyList.size(); rowNum&#43;&#43;) { NutMap map = bodyList.get(rowNum); Row row = sheet.createRow(rowNum &#43; startRow); int colNum = 0; // comm Cell accountNumberCell = row.createCell(colNum&#43;&#43;, CellType.STRING); String accountNumber = map.getString(&#34;comm&#34;); colWidth[colNum - 1] = Math.max(colWidth[colNum - 1], Strings.charLength(accountNumber)); accountNumberCell.setCellValue(accountNumber); // a Cell accountNameCell = row." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/f78a50759049ced1a15363b2f16d5cbf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-01T09:49:06+08:00" />
<meta property="article:modified_time" content="2023-06-01T09:49:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java 利用poi根据excel模板导出数据（三）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>本文是  <a href="https://blog.csdn.net/wazz753/article/details/130981373?spm=1001.2014.3001.5501" title="java 利用poi根据excel模板导出数据（一）">java 利用poi根据excel模板导出数据（一）</a> 的优化版本</strong></p> 
<p></p> 
<p><strong>主要针对于  </strong>fillBodyData 方法这块，具体如下</p> 
<p>源代码：</p> 
<pre><code class="language-java">private static void fillBodyData(Sheet sheet, int startRow, List&lt;NutMap&gt; bodyList, int[] colWidth) {
 
        // 碰到 时间、金额等需要转换的  在setCellValue 里面操作
        for (int rowNum = 0; rowNum &lt; bodyList.size(); rowNum++) {
            NutMap map = bodyList.get(rowNum);
            Row row = sheet.createRow(rowNum + startRow);
            int colNum = 0;
            // comm
            Cell accountNumberCell = row.createCell(colNum++, CellType.STRING);
            String accountNumber = map.getString("comm");
            colWidth[colNum - 1] = Math.max(colWidth[colNum - 1], Strings.charLength(accountNumber));
            accountNumberCell.setCellValue(accountNumber);
            // a
            Cell accountNameCell = row.createCell(colNum++, CellType.STRING);
            String accountName = map.getString("a");
            colWidth[colNum - 1] = Math.max(colWidth[colNum - 1], Strings.charLength(accountName));
            accountNameCell.setCellValue(accountName);
            // b
            Cell mobileCell = row.createCell(colNum++, CellType.STRING);
            String mobile = map.getString("b");
            colWidth[colNum - 1] = Math.max(colWidth[colNum - 1], Strings.charLength(mobile));
            mobileCell.setCellValue(mobile);
 
            // c
            Cell addressCell = row.createCell(colNum++, CellType.STRING);
            String address = map.getString("c");
            colWidth[colNum - 1] = Math.max(colWidth[colNum - 1], Strings.charLength(address));
            addressCell.setCellValue(address);
 
            // d
            Cell meterNoCell = row.createCell(colNum++, CellType.STRING);
            String meterNo = map.getString("d");
            meterNoCell.setCellValue(meterNo);
            colWidth[colNum - 1] = Math.max(colWidth[colNum - 1], Strings.charLength(meterNo));
 
            // e
            Cell uncollectedNumberCell = row.createCell(colNum++, CellType.STRING);
            String uncollectedNumber = map.getString("e");
            uncollectedNumberCell.setCellValue(uncollectedNumber);
            colWidth[colNum - 1] = Math.max(colWidth[colNum - 1], Strings.charLength(uncollectedNumber));
 
            // f
            Cell uncollectedDosageCell = row.createCell(colNum++, CellType.STRING);
            String uncollectedDosage = map.getString("f");
            uncollectedDosageCell.setCellValue(uncollectedDosage);
            colWidth[colNum - 1] = Math.max(colWidth[colNum - 1], Strings.charLength(uncollectedDosage));
 
            // g
            Cell uncollectedDosageCell1 = row.createCell(colNum++, CellType.STRING);
            String uncollectedDosage1 = map.getString("g");
            uncollectedDosageCell1.setCellValue(uncollectedDosage1);
            colWidth[colNum - 1] = Math.max(colWidth[colNum - 1], Strings.charLength(uncollectedDosage1));
 
            // h
            Cell uncollectedDosageCell2 = row.createCell(colNum++, CellType.STRING);
            String uncollectedDosage2 = map.getString("h");
            uncollectedDosageCell2.setCellValue(uncollectedDosage2);
            colWidth[colNum - 1] = Math.max(colWidth[colNum - 1], Strings.charLength(uncollectedDosage2));
        }
    }</code></pre> 
<p>修改后代码：</p> 
<pre><code class="language-java"> 
    private void fillBodyData(XSSFWorkbook workbook, Sheet sheet, int startRow, int startCol, List&lt;List&lt;String&gt;&gt; bodyList, int[] colWidth) {
 
        // 单元格样式
        XSSFCellStyle cellStyle = workbook.createCellStyle();
        // 设置单元格的水平对齐类型
        cellStyle.setAlignment(HorizontalAlignment.CENTER);
        // 设置单元格的垂直对齐类型
        cellStyle.setVerticalAlignment(VerticalAlignment.CENTER);
        //设置样式对象，这里仅设置了边框属性
        cellStyle.setBorderBottom(BorderStyle.THIN); //下边框
        cellStyle.setBorderLeft(BorderStyle.THIN);//左边框
        cellStyle.setBorderTop(BorderStyle.THIN);//上边框
        cellStyle.setBorderRight(BorderStyle.THIN);//右边框
 
        for (int rowNum = 0; rowNum &lt; bodyList.size(); rowNum++) {
            List&lt;String&gt; rowData = bodyList.get(rowNum);
            Row row = sheet.getRow(rowNum + startRow);
            if (null == row) {
                row = sheet.createRow(rowNum + startRow);
                row.setHeight((short) 440);
            }
            int colNum = startCol;
 
            for (String cellValue : rowData) {
                Cell rowCell = row.getCell(colNum);
                if (null == rowCell) {
                    rowCell = row.createCell(colNum, CellType.STRING);
                    rowCell.setCellStyle(cellStyle);
                }
                colWidth[colNum - startCol] = Math.max(colWidth[colNum - startCol], Strings.charLength(cellValue));
                rowCell.setCellValue(cellValue);
                colNum++;
            }
        }
    }</code></pre> 
<p>相当于不用一个一个列去渲染了直接循环解决，</p> 
<p>两个参数</p> 
<p>1. <strong>startRow</strong> 起始行号  从0开始</p> 
<p>2.<strong>startCol</strong>  起始列号  从0开始</p> 
<p></p> 
<p>当然具体的要根据需求来，也建议大家自己去去优化</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d66772701a61b1f6895af59372b5f14c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java 利用poi根据excel模板导出数据（二）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/18d39ada8d945ef6c209f305dfe5dd3a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">麒麟操作系统-01-java环境说明</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>