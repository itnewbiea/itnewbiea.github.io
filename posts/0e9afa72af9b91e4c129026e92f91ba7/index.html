<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>窗口置顶,并且屏蔽系统按键 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="窗口置顶,并且屏蔽系统按键" />
<meta property="og:description" content="Public Class Form1
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
Dim sbfm As MsgboxForm
sbfm = New MsgboxForm()
sbfm.ShowDialog()
End Sub
End Class
&#39;MsgboxForm警告窗体
Imports WinFromHook.FormHook
Imports Microsoft.Win32
Public Class MsgboxForm
Dim hhkLowLevelKybd As Long
Public KeyBoardHookProcedure As HookProc
Dim fh As FormHook
Private Sub MsgboxForm_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
FormBorderStyle = Windows.Forms.FormBorderStyle.None
Me.WindowState = FormWindowState.Maximized
Button1.Text = &#34;退出&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/0e9afa72af9b91e4c129026e92f91ba7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2011-05-10T09:04:00+08:00" />
<meta property="article:modified_time" content="2011-05-10T09:04:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">窗口置顶,并且屏蔽系统按键</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Class</span><span style="color: #000000;"> Form1<br><br>    </span><span style="color: #0000ff;">Private</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Sub</span><span style="color: #000000;"> Button1_Click(</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> sender </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> System.Object, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> e </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> System.EventArgs) </span><span style="color: #0000ff;">Handles</span><span style="color: #000000;"> Button1.Click<br>        </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> sbfm </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> MsgboxForm<br>        sbfm </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">New</span><span style="color: #000000;"> MsgboxForm()<br>        sbfm.ShowDialog()<br><br>    </span><span style="color: #0000ff;">End Sub</span><span style="color: #000000;"><br><br></span><span style="color: #0000ff;">End Class</span></p> 
<p> </p> 
<p><span style="color: #0000ff;"><span style="color: #000000;">'MsgboxForm警告窗体</span><br></span></p> 
<p><span style="color: #0000ff;"><span style="color: #0000ff;">Imports</span><span style="color: #000000;"> WinFromHook.FormHook<br></span><span style="color: #0000ff;">Imports</span><span style="color: #000000;"> Microsoft.Win32<br><br></span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Class</span><span style="color: #000000;"> MsgboxForm<br>    </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> hhkLowLevelKybd </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Long</span><span style="color: #000000;"><br>    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> KeyBoardHookProcedure </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> HookProc<br>    </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> fh </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> FormHook<br><br>    </span><span style="color: #0000ff;">Private</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Sub</span><span style="color: #000000;"> MsgboxForm_Load(</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> sender </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Object</span><span style="color: #000000;">, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> e </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> System.EventArgs) </span><span style="color: #0000ff;">Handles</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Me</span><span style="color: #000000;">.Load<br>        FormBorderStyle </span><span style="color: #000000;">=</span><span style="color: #000000;"> Windows.Forms.FormBorderStyle.None<br>        </span><span style="color: #0000ff;">Me</span><span style="color: #000000;">.WindowState </span><span style="color: #000000;">=</span><span style="color: #000000;"> FormWindowState.Maximized<br>        Button1.Text </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">退出</span><span style="color: #800000;">"</span><span style="color: #000000;"><br>        Button2.Text </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">可用</span><span style="color: #800000;">"</span><span style="color: #000000;"><br>        Label1.Text </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">最大化警告窗体屏蔽键盘(Ctrl+Alt+Delete)</span><span style="color: #800000;">"</span><span style="color: #000000;"><br>        Destroy()<br><br>    </span><span style="color: #0000ff;">End Sub</span><span style="color: #000000;"><br><br>    </span><span style="color: #0000ff;">Private</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Sub</span><span style="color: #000000;"> MsgboxForm_FormClosing(</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> sender </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> System.Object, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> e </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> System.Windows.Forms.FormClosingEventArgs) </span><span style="color: #0000ff;">Handles</span><span style="color: #000000;"> </span><span style="color: #0000ff;">MyBase</span><span style="color: #000000;">.FormClosing<br>        </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> hhkLowLevelKybd </span><span style="color: #000000;">&lt;&gt;</span><span style="color: #000000;"> </span><span style="color: #800080;">0</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Then</span><span style="color: #000000;"> UnhookWindowsHookEx(hhkLowLevelKybd)<br>    </span><span style="color: #0000ff;">End Sub</span><span style="color: #000000;"><br><br>    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Sub</span><span style="color: #000000;"> SetCtrlAltDeleteStatus(</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> value </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">)<br><br>        </span><span style="color: #008000;">'</span><span style="color: #008000;">1不可用 0可用   </span><span style="color: #008000;"><br></span><span style="color: #000000;">        </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> key </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> Microsoft.Win32.RegistryKey </span><span style="color: #000000;">=</span><span style="color: #000000;"> Microsoft.Win32.Registry.CurrentUser<br>        </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> key1 </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> Microsoft.Win32.RegistryKey </span><span style="color: #000000;">=</span><span style="color: #000000;"> key.CreateSubKey(</span><span style="color: #800000;">"</span><span style="color: #800000;">Software//Microsoft//Windows//CurrentVersion//Policies//System</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br>        key1.SetValue(</span><span style="color: #800000;">"</span><span style="color: #800000;">DisableTaskMgr</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #800080;">1</span><span style="color: #000000;">, Microsoft.Win32.RegistryValueKind.DWord)<br>        </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> r </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> RegistryKey<br>        r </span><span style="color: #000000;">=</span><span style="color: #000000;"> Registry.CurrentUser.OpenSubKey(</span><span style="color: #800000;">"</span><span style="color: #800000;">Software//Microsoft//Windows//CurrentVersion//Policies//System</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #0000ff;">True</span><span style="color: #000000;">)<br>        </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> r </span><span style="color: #0000ff;">Is</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Nothing</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Then</span><span style="color: #000000;"><br>            r </span><span style="color: #000000;">=</span><span style="color: #000000;"> Registry.CurrentUser.CreateSubKey(</span><span style="color: #800000;">"</span><span style="color: #800000;">Software//Microsoft//Windows//CurrentVersion//Policies//System</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br>        </span><span style="color: #0000ff;">End</span><span style="color: #000000;"> </span><span style="color: #0000ff;">If</span><span style="color: #000000;"><br><br>        r.SetValue(</span><span style="color: #800000;">"</span><span style="color: #800000;">DisableTaskMgr</span><span style="color: #800000;">"</span><span style="color: #000000;">, value, RegistryValueKind.DWord)<br>    </span><span style="color: #0000ff;">End Sub</span><span style="color: #000000;"><br><br>    </span><span style="color: #0000ff;">Private</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Sub</span><span style="color: #000000;"> Destroy()<br>        fh </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">New</span><span style="color: #000000;"> FormHook()<br>        fh.Hook_Start()<br>        </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> handleTaskMask </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> IntPtr </span><span style="color: #000000;">=</span><span style="color: #000000;"> FindWindowEx(IntPtr.Zero, IntPtr.Zero, </span><span style="color: #800000;">"</span><span style="color: #800000;">Shell_TrayWnd</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #0000ff;">Nothing</span><span style="color: #000000;">)<br>        ShowWindow(handleTaskMask, </span><span style="color: #800080;">0</span><span style="color: #000000;">)<br>        </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> handleDeskTop </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> IntPtr </span><span style="color: #000000;">=</span><span style="color: #000000;"> FindWindowEx(IntPtr.Zero, IntPtr.Zero, </span><span style="color: #800000;">"</span><span style="color: #800000;">Progman</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #0000ff;">Nothing</span><span style="color: #000000;">)<br>        ShowWindow(handleDeskTop, </span><span style="color: #800080;">0</span><span style="color: #000000;">)<br>        SetCtrlAltDeleteStatus(</span><span style="color: #800080;">1</span><span style="color: #000000;">)<br>        </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> p </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Boolean</span><span style="color: #000000;"> </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">True</span><span style="color: #000000;"><br>        SystemParametersInfo(spi_screensaverrunning, </span><span style="color: #800080;">1</span><span style="color: #000000;">, p, </span><span style="color: #800080;">0</span><span style="color: #000000;">)         </span><span style="color: #008000;">'</span><span style="color: #008000;">关Ctrl+Alt+Del窗口，SystemParametersInfo(97, False, A, 0)，uParam为布尔型</span><span style="color: #008000;"><br></span><span style="color: #000000;">    </span><span style="color: #0000ff;">End Sub</span><span style="color: #000000;"><br><br>    </span><span style="color: #0000ff;">Private</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Sub</span><span style="color: #000000;"> Recover()<br>        fh </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">New</span><span style="color: #000000;"> FormHook()<br>        fh.Hook_Clear()<br>        </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> handle </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> IntPtr </span><span style="color: #000000;">=</span><span style="color: #000000;"> FindWindowEx(IntPtr.Zero, IntPtr.Zero, </span><span style="color: #800000;">"</span><span style="color: #800000;">Shell_TrayWnd</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #0000ff;">Nothing</span><span style="color: #000000;">)<br>        ShowWindow(handle, </span><span style="color: #800080;">1</span><span style="color: #000000;">)<br>        </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> handleDeskTop </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> IntPtr </span><span style="color: #000000;">=</span><span style="color: #000000;"> FindWindowEx(IntPtr.Zero, IntPtr.Zero, </span><span style="color: #800000;">"</span><span style="color: #800000;">Progman</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #0000ff;">Nothing</span><span style="color: #000000;">)<br>        ShowWindow(handleDeskTop, </span><span style="color: #800080;">1</span><span style="color: #000000;">)<br>        SetCtrlAltDeleteStatus(</span><span style="color: #800080;">0</span><span style="color: #000000;">)<br>        </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> p </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Boolean</span><span style="color: #000000;"> </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">True</span><span style="color: #000000;"><br>        SystemParametersInfo(spi_screensaverrunning, </span><span style="color: #800080;">0</span><span style="color: #000000;">, p, </span><span style="color: #800080;">0</span><span style="color: #000000;">)        </span><span style="color: #008000;">'</span><span style="color: #008000;">开Ctrl+Alt+Del窗口，SystemParametersInfo(97, False, A, 0)，uParam为布尔型</span><span style="color: #008000;"><br></span><span style="color: #000000;">    </span><span style="color: #0000ff;">End Sub</span><span style="color: #000000;"><br><br>    </span><span style="color: #0000ff;">Private</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Sub</span><span style="color: #000000;"> Button2_Click(</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> sender </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> System.Object, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> e </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> System.EventArgs) </span><span style="color: #0000ff;">Handles</span><span style="color: #000000;"> Button2.Click<br>        Recover()<br>    </span><span style="color: #0000ff;">End Sub</span><span style="color: #000000;"><br><br>    </span><span style="color: #0000ff;">Private</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Sub</span><span style="color: #000000;"> Button1_Click(</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> sender </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> System.Object, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> e </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> System.EventArgs) </span><span style="color: #0000ff;">Handles</span><span style="color: #000000;"> Button1.Click<br>        </span><span style="color: #0000ff;">Me</span><span style="color: #000000;">.Close()<br>    </span><span style="color: #0000ff;">End Sub</span><span style="color: #000000;"><br></span><span style="color: #0000ff;">End Class</span><span style="color: #000000;"><br></span><br></span><span style="color: #000000;"> '类模块 FormHook.vb</span></p> 
<p> </p> 
<p><span style="color: #000000;"><br><span style="color: #0000ff;">Imports</span><span style="color: #000000;"> System.Runtime.InteropServices<br><br></span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Class</span><span style="color: #000000;"> FormHook<br>    </span><span style="color: #008000;">'</span><span style="color: #008000;">委托   </span><span style="color: #008000;"><br></span><span style="color: #000000;">    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Delegate</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Function</span><span style="color: #000000;"> HookProc(</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> nCode </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> wParam </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> lParam </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> IntPtr) </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;"><br>    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> hHook </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;"> </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800080;">0</span><span style="color: #000000;"><br>    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Const</span><span style="color: #000000;"> WH_KEYBOARD_LL </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800080;">13</span><span style="color: #000000;"><br>    </span><span style="color: #008000;">'</span><span style="color: #008000;">LowLevel键盘截获，如果是WH_KEYBOARD＝2，并不能对系统键盘截取，Acrobat Reader会在你截取之前获得键盘。   </span><span style="color: #008000;"><br></span><span style="color: #000000;">    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> KeyBoardHookProcedure </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> HookProc<br>    </span><span style="color: #008000;">'</span><span style="color: #008000;">键盘Hook结构函数   </span><span style="color: #008000;"><br></span><span style="color: #000000;">    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Structure</span><span style="color: #000000;"> KeyBoardHookStruct<br>        </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> vkCode </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;"><br>        </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> scanCode </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;"><br>        </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> flags </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;"><br>        </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> time </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;"><br>        </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> dwExtraInfo </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;"><br>    </span><span style="color: #0000ff;">End Structure</span><span style="color: #000000;"><br><br>    </span><span style="color: #008000;">'</span><span style="color: #008000;">设置钩子   </span><span style="color: #008000;"><br></span><span style="color: #000000;">    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Declare</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Function</span><span style="color: #000000;"> SetWindowsHookEx </span><span style="color: #0000ff;">Lib</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">user32.dll</span><span style="color: #800000;">"</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Alias</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">SetWindowsHookExA</span><span style="color: #800000;">"</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> idHook </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> lpfn </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> HookProc, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> hInstance </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> IntPtr, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> threadId </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">) </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;"><br><br>    </span><span style="color: #008000;">'</span><span style="color: #008000;">抽掉钩子   </span><span style="color: #008000;"><br></span><span style="color: #000000;">    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Declare</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Function</span><span style="color: #000000;"> UnhookWindowsHookEx </span><span style="color: #0000ff;">Lib</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">user32.dll</span><span style="color: #800000;">"</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> idHook </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">) </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Boolean</span><span style="color: #000000;"><br><br>    </span><span style="color: #008000;">'</span><span style="color: #008000;">调用下一个钩子   </span><span style="color: #008000;"><br></span><span style="color: #000000;">    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Declare</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Function</span><span style="color: #000000;"> CallNextHookEx </span><span style="color: #0000ff;">Lib</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">user32.dll</span><span style="color: #800000;">"</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> idHook </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> nCode </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> wParam </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> lParam </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> IntPtr) </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;"><br><br>    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Declare</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Function</span><span style="color: #000000;"> GetCurrentThreadId </span><span style="color: #0000ff;">Lib</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">kernel32.dll</span><span style="color: #800000;">"</span><span style="color: #000000;"> () </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;"><br><br>    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Declare</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Function</span><span style="color: #000000;"> GetModuleHandle </span><span style="color: #0000ff;">Lib</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">kernel32.dll</span><span style="color: #800000;">"</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Alias</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">GetModuleHandleA</span><span style="color: #800000;">"</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> name </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">String</span><span style="color: #000000;">) </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> IntPtr<br><br>    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Declare</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Function</span><span style="color: #000000;"> FindWindowEx </span><span style="color: #0000ff;">Lib</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">User32.dll</span><span style="color: #800000;">"</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Alias</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">FindWindowExA</span><span style="color: #800000;">"</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> ph </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> IntPtr, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> ch </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> IntPtr, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> cn </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">String</span><span style="color: #000000;">, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> wn </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">String</span><span style="color: #000000;">) </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> IntPtr<br><br>    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Declare</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Function</span><span style="color: #000000;"> ShowWindow </span><span style="color: #0000ff;">Lib</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">User32.dll</span><span style="color: #800000;">"</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> hWnd </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> IntPtr, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> nCmdShow </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Long</span><span style="color: #000000;">) </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Boolean</span><span style="color: #000000;"><br><br>    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Const</span><span style="color: #000000;"> spi_screensaverrunning </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">UInteger</span><span style="color: #000000;"> </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800080;">97</span><span style="color: #000000;"><br><br>    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Declare</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Function</span><span style="color: #000000;"> SystemParametersInfo </span><span style="color: #0000ff;">Lib</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">user32.dll</span><span style="color: #800000;">"</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Alias</span><span style="color: #000000;"> </span><span style="color: #800000;">"</span><span style="color: #800000;">SystemParametersInfoA</span><span style="color: #800000;">"</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> uiAction </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">UInteger</span><span style="color: #000000;">, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> uiParam </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">UInteger</span><span style="color: #000000;">, </span><span style="color: #0000ff;">ByRef</span><span style="color: #000000;"> pvParam </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Boolean</span><span style="color: #000000;">, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> fWinIni </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">UInteger</span><span style="color: #000000;">) </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Boolean</span><span style="color: #000000;"><br><br>    </span><span style="color: #008000;">'</span><span style="color: #008000;">自定义事件</span><span style="color: #008000;"><br></span><span style="color: #000000;">    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Sub</span><span style="color: #000000;"> Hook_Start()<br>        </span><span style="color: #008000;">'</span><span style="color: #008000;">安装键盘钩子   </span><span style="color: #008000;"><br></span><span style="color: #000000;">        </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> hHook </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800080;">0</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Then</span><span style="color: #000000;"><br><br>            KeyBoardHookProcedure </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">New</span><span style="color: #000000;"> HookProc(</span><span style="color: #0000ff;">AddressOf</span><span style="color: #000000;"> KeyBoardHookProc)<br><br>            </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> hInstance </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> IntPtr<br>            hInstance </span><span style="color: #000000;">=</span><span style="color: #000000;"> GetModuleHandle(Process.GetCurrentProcess().MainModule.ModuleName)<br><br>            hHook </span><span style="color: #000000;">=</span><span style="color: #000000;"> SetWindowsHookEx(WH_KEYBOARD_LL, KeyBoardHookProcedure, hInstance, </span><span style="color: #800080;">0</span><span style="color: #000000;">)<br>            </span><span style="color: #008000;">'</span><span style="color: #008000;">如果设置钩子失败.   </span><span style="color: #008000;"><br></span><span style="color: #000000;">            </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> hHook </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800080;">0</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Then</span><span style="color: #000000;"><br>                Hook_Clear()<br>                </span><span style="color: #008000;">'</span><span style="color: #008000;">throw new Exception("设置Hook失败!");   </span><span style="color: #008000;"><br></span><span style="color: #000000;">            </span><span style="color: #0000ff;">End</span><span style="color: #000000;"> </span><span style="color: #0000ff;">If</span><span style="color: #000000;"><br>        </span><span style="color: #0000ff;">End</span><span style="color: #000000;"> </span><span style="color: #0000ff;">If</span><span style="color: #000000;"><br>    </span><span style="color: #0000ff;">End Sub</span><span style="color: #000000;"><br><br>    </span><span style="color: #008000;">'</span><span style="color: #008000;">取消钩子事件   </span><span style="color: #008000;"><br></span><span style="color: #000000;">    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Sub</span><span style="color: #000000;"> Hook_Clear()<br><br>        </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> retKeyboard </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Boolean</span><span style="color: #000000;"> </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">True</span><span style="color: #000000;"><br>        </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> hHook </span><span style="color: #000000;">&lt;&gt;</span><span style="color: #000000;"> </span><span style="color: #800080;">0</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Then</span><span style="color: #000000;"><br>            retKeyboard </span><span style="color: #000000;">=</span><span style="color: #000000;"> UnhookWindowsHookEx(hHook)<br>            hHook </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800080;">0</span><span style="color: #000000;"><br>        </span><span style="color: #0000ff;">End</span><span style="color: #000000;"> </span><span style="color: #0000ff;">If</span><span style="color: #000000;"><br>        </span><span style="color: #008000;">'</span><span style="color: #008000;">如果去掉钩子失败.   </span><span style="color: #008000;"><br></span><span style="color: #000000;">        </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> retKeyboard </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">False</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Then</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Throw</span><span style="color: #000000;"> </span><span style="color: #0000ff;">New</span><span style="color: #000000;"> Exception(</span><span style="color: #800000;">"</span><span style="color: #800000;">UnhookWindowsHookEx failed.</span><span style="color: #800000;">"</span><span style="color: #000000;">)<br>    </span><span style="color: #0000ff;">End Sub</span><span style="color: #000000;"><br><br>    </span><span style="color: #008000;">'</span><span style="color: #008000;">这里可以添加自己想要的信息处理   </span><span style="color: #008000;"><br></span><span style="color: #000000;">    </span><span style="color: #0000ff;">Public</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Function</span><span style="color: #000000;"> KeyBoardHookProc(</span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> nCode </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> wParam </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">, </span><span style="color: #0000ff;">ByVal</span><span style="color: #000000;"> lParam </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> IntPtr) </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;"><br><br>        </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> nCode </span><span style="color: #000000;">&gt;=</span><span style="color: #000000;"> </span><span style="color: #800080;">0</span><span style="color: #000000;"> </span><span style="color: #0000ff;">Then</span><span style="color: #000000;"><br><br>            </span><span style="color: #0000ff;">Dim</span><span style="color: #000000;"> kbh </span><span style="color: #0000ff;">As</span><span style="color: #000000;"> KeyBoardHookStruct </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CType</span><span style="color: #000000;">(Marshal.PtrToStructure(lParam, </span><span style="color: #0000ff;">GetType</span><span style="color: #000000;">(KeyBoardHookStruct)), KeyBoardHookStruct)<br><br>            </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> kbh.vkCode </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Keys.S) </span><span style="color: #0000ff;">And</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Control.ModifierKeys) </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Keys.Control) </span><span style="color: #0000ff;">Then</span><span style="color: #000000;">  </span><span style="color: #008000;">'</span><span style="color: #008000;"> 截获Ctrl+S </span><span style="color: #008000;"><br></span><span style="color: #000000;">                </span><span style="color: #0000ff;">Return</span><span style="color: #000000;"> </span><span style="color: #800080;">1</span><span style="color: #000000;"><br>            </span><span style="color: #0000ff;">End</span><span style="color: #000000;"> </span><span style="color: #0000ff;">If</span><span style="color: #000000;"><br><br>            </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> kbh.vkCode </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Keys.Y) </span><span style="color: #0000ff;">And</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Control.ModifierKeys) </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Keys.Control) </span><span style="color: #000000;">+</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Keys.Alt) </span><span style="color: #0000ff;">Then</span><span style="color: #000000;">  </span><span style="color: #008000;">'</span><span style="color: #008000;">截获Ctrl+Alt+Y   </span><span style="color: #008000;"><br></span><span style="color: #000000;">                </span><span style="color: #0000ff;">Return</span><span style="color: #000000;"> </span><span style="color: #800080;">1</span><span style="color: #000000;"><br>            </span><span style="color: #0000ff;">End</span><span style="color: #000000;"> </span><span style="color: #0000ff;">If</span><span style="color: #000000;"><br><br>            </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> kbh.vkCode </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Keys.LWin) </span><span style="color: #0000ff;">Then</span><span style="color: #000000;">   </span><span style="color: #008000;">'</span><span style="color: #008000;">截获win   </span><span style="color: #008000;"><br></span><span style="color: #000000;">                </span><span style="color: #0000ff;">Return</span><span style="color: #000000;"> </span><span style="color: #800080;">1</span><span style="color: #000000;"><br>            </span><span style="color: #0000ff;">End</span><span style="color: #000000;"> </span><span style="color: #0000ff;">If</span><span style="color: #000000;"><br><br>            </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> kbh.vkCode </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Keys.Tab) </span><span style="color: #0000ff;">And</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Control.ModifierKeys) </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Keys.Alt) </span><span style="color: #0000ff;">Then</span><span style="color: #000000;"> </span><span style="color: #008000;">'</span><span style="color: #008000;">截获Alt+Tab   </span><span style="color: #008000;"><br></span><span style="color: #000000;">                </span><span style="color: #0000ff;">Return</span><span style="color: #000000;"> </span><span style="color: #800080;">1</span><span style="color: #000000;"><br>            </span><span style="color: #0000ff;">End</span><span style="color: #000000;"> </span><span style="color: #0000ff;">If</span><span style="color: #000000;"><br><br>            </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> kbh.vkCode </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Keys.F4) </span><span style="color: #0000ff;">And</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Control.ModifierKeys) </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Keys.Alt) </span><span style="color: #0000ff;">Then</span><span style="color: #000000;">  </span><span style="color: #008000;">'</span><span style="color: #008000;">截获Alt + F4   </span><span style="color: #008000;"><br></span><span style="color: #000000;">                </span><span style="color: #0000ff;">Return</span><span style="color: #000000;"> </span><span style="color: #800080;">1</span><span style="color: #000000;"><br>            </span><span style="color: #0000ff;">End</span><span style="color: #000000;"> </span><span style="color: #0000ff;">If</span><span style="color: #000000;"><br><br>            </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> kbh.vkCode </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Keys.E) </span><span style="color: #0000ff;">And</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Control.ModifierKeys) </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Keys.LWin) </span><span style="color: #0000ff;">Then</span><span style="color: #000000;">   </span><span style="color: #008000;">'</span><span style="color: #008000;">截获win + e   </span><span style="color: #008000;"><br></span><span style="color: #000000;">                </span><span style="color: #0000ff;">Return</span><span style="color: #000000;"> </span><span style="color: #800080;">1</span><span style="color: #000000;"><br>            </span><span style="color: #0000ff;">End</span><span style="color: #000000;"> </span><span style="color: #0000ff;">If</span><span style="color: #000000;"><br><br>            </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> kbh.vkCode </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Keys.Escape) </span><span style="color: #0000ff;">And</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Control.ModifierKeys) </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CInt</span><span style="color: #000000;">(Keys.Alt) </span><span style="color: #0000ff;">Then</span><span style="color: #000000;">   </span><span style="color: #008000;">'</span><span style="color: #008000;">截获Alt + esc   </span><span style="color: #008000;"><br></span><span style="color: #000000;">                </span><span style="color: #0000ff;">Return</span><span style="color: #000000;"> </span><span style="color: #800080;">1</span><span style="color: #000000;"><br>            </span><span style="color: #0000ff;">End</span><span style="color: #000000;"> </span><span style="color: #0000ff;">If</span><span style="color: #000000;"><br><br>            </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CType</span><span style="color: #000000;">(Control.ModifierKeys, </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">) </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CType</span><span style="color: #000000;">(Keys.Control, </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">) </span><span style="color: #000000;">+</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CType</span><span style="color: #000000;">(Keys.Alt, </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">) </span><span style="color: #000000;">+</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CType</span><span style="color: #000000;">(Keys.Delete, </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">) </span><span style="color: #0000ff;">Then</span><span style="color: #000000;">   </span><span style="color: #008000;">'</span><span style="color: #008000;">截获Ctrl+Alt+Delete 不成功   </span><span style="color: #008000;"><br></span><span style="color: #000000;">                </span><span style="color: #0000ff;">Return</span><span style="color: #000000;"> </span><span style="color: #800080;">1</span><span style="color: #000000;"><br>            </span><span style="color: #0000ff;">End</span><span style="color: #000000;"> </span><span style="color: #0000ff;">If</span><span style="color: #000000;"><br><br>            </span><span style="color: #0000ff;">If</span><span style="color: #000000;"> kbh.vkCode </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CType</span><span style="color: #000000;">(Keys.Escape, </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">) </span><span style="color: #0000ff;">And</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CType</span><span style="color: #000000;">(Control.ModifierKeys, </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">) </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000ff;">CType</span><span style="color: #000000;">(Keys.Control, </span><span style="color: #0000ff;">Integer</span><span style="color: #000000;">) </span><span style="color: #0000ff;">Then</span><span style="color: #000000;">   </span><span style="color: #008000;">'</span><span style="color: #008000;">截获Ctrl + esc   </span><span style="color: #008000;"><br></span><span style="color: #000000;">                </span><span style="color: #0000ff;">Return</span><span style="color: #000000;"> </span><span style="color: #800080;">1</span><span style="color: #000000;"><br>            </span><span style="color: #0000ff;">End</span><span style="color: #000000;"> </span><span style="color: #0000ff;">If</span><span style="color: #000000;"><br>        </span><span style="color: #0000ff;">End</span><span style="color: #000000;"> </span><span style="color: #0000ff;">If</span><span style="color: #000000;"><br><br>        </span><span style="color: #0000ff;">Return</span><span style="color: #000000;"> CallNextHookEx(hHook, nCode, wParam, lParam)<br>    </span><span style="color: #0000ff;">End Function</span><span style="color: #000000;"><br><br></span><span style="color: #0000ff;">End Class</span><span style="color: #000000;"><br><br></span><br></span></p> 
<p><br><br></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d388f8b9c500b6fe6d2ed74874de95fc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何给TWaver中的Node对象加右键菜单项</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9f13c4a5d2b67fd8c6caf09efd5b58ab/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">gtk&#43;分栏列表实现例子</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>