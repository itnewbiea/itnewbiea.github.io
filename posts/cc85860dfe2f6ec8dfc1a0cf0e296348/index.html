<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>8.sql和hsql以及flink-sql总结 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="8.sql和hsql以及flink-sql总结" />
<meta property="og:description" content="文章目录 1. SQL1.1. 初始化操作1.2. 数据定义语言DDL（==Data Definition Language==）1.3. 数据操纵语言DML（==Data Manipulation Language==）1.4. 数据查询语言DQL（==Data Query Language==）1.5. 数据控制语言DCL（==Data Control Language==） 2. HQL2.1. 数据定义语言DDL2.2. 数据操纵语言DML2.3. 数据查询语言DQL2.4. 桶表的相关案例2.5. Hive 的集合类型2.6. Hive 严格模式2.7. [Hive参数配置方式](https://cwiki.apache.org/confluence/display/Hive/Configuration&#43;Properties)2.8. [Hive 函数](https://cwiki.apache.org/confluence/display/Hive/LanguageManual&#43;UDF)2.9. [hive面试套路 - 累计报表](https://blog.csdn.net/u012808902/article/details/77874722) 3. FLINK-SQL3.1. [Flink最锋利的武器：Flink SQL入门和实战 ](https://blog.csdn.net/u013411339/article/details/93267838?depth_1-utm_source=distribute.pc_relevant_right.none-task-blog-OPENSEARCH-1&amp;utm_source=distribute.pc_relevant_right.none-task-blog-OPENSEARCH-1)3.2. [Flink1.10集成Hive快速入门](https://mp.weixin.qq.com/s/EQIDS-DEmo4Ld-N4s1W_Iw) 4. 微语：你的每个点赞，我都认真当成了喜欢 1. SQL 1.1. 初始化操作 链接数据库mysql -h 192.168.1.30 -P 3306 -uroot -p123456退出数据库exit/quit/ctrl&#43;d显示时间select now();显示数据库的版本select version(); 1.2. 数据定义语言DDL（Data Definition Language） 关键词： create alter drop truncate(删除当前表再新建一个一模一样的表结构)创建数据库create database hadoop-01 charset=utf8; # 注意有特殊字符时，用tab键上面的字符引起来查看所有的数据库/表show databases/tables查看创建数据库的语句show create database db_test;\G格式化，在终端可以直接拷贝出sql语句查看当前使用的数据库select database();使用数据库use db_test;删除数据库drop database db_test;创建表 格式 auto_increment表示自动增长not null 表示不能为空primary key 表示主键default 默认值create table 数据表名字 (字段 类型 约束[, 字段 类型 约束]); 实例 create table xxxxx(id int, name varchar(30));" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/cc85860dfe2f6ec8dfc1a0cf0e296348/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-04-03T19:54:09+08:00" />
<meta property="article:modified_time" content="2020-04-03T19:54:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">8.sql和hsql以及flink-sql总结</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1_SQL_1" rel="nofollow">1. SQL</a></li><li><ul><li><a href="#11__2" rel="nofollow">1.1. 初始化操作</a></li><li><a href="#12_DDLData_Definition_Language_7" rel="nofollow">1.2. 数据定义语言DDL（==Data Definition Language==）</a></li><li><a href="#13_DMLData_Manipulation_Language_71" rel="nofollow">1.3. 数据操纵语言DML（==Data Manipulation Language==）</a></li><li><a href="#14_DQLData_Query_Language_126" rel="nofollow">1.4. 数据查询语言DQL（==Data Query Language==）</a></li><li><a href="#15_DCLData_Control_Language_372" rel="nofollow">1.5. 数据控制语言DCL（==Data Control Language==）</a></li></ul> 
  </li><li><a href="#2_HQL_375" rel="nofollow">2. HQL</a></li><li><ul><li><a href="#21_DDL_376" rel="nofollow">2.1. 数据定义语言DDL</a></li><li><a href="#22_DML_454" rel="nofollow">2.2. 数据操纵语言DML</a></li><li><a href="#23_DQL_462" rel="nofollow">2.3. 数据查询语言DQL</a></li><li><a href="#24__469" rel="nofollow">2.4. 桶表的相关案例</a></li><li><a href="#25_Hive__472" rel="nofollow">2.5. Hive 的集合类型</a></li><li><a href="#26_Hive__474" rel="nofollow">2.6. Hive 严格模式</a></li><li><a href="#27_HivehttpscwikiapacheorgconfluencedisplayHiveConfigurationProperties_477" rel="nofollow">2.7. [Hive参数配置方式](https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties)</a></li><li><a href="#28_Hive_httpscwikiapacheorgconfluencedisplayHiveLanguageManualUDF_479" rel="nofollow">2.8. [Hive 函数](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF)</a></li><li><a href="#29_hive__httpsblogcsdnnetu012808902articledetails77874722_482" rel="nofollow">2.9. [hive面试套路 - 累计报表](https://blog.csdn.net/u012808902/article/details/77874722)</a></li></ul> 
  </li><li><a href="#3_FLINKSQL_485" rel="nofollow">3. FLINK-SQL</a></li><li><ul><li><a href="#31_FlinkFlink_SQL_httpsblogcsdnnetu013411339articledetails93267838depth_1utm_sourcedistributepc_relevant_rightnonetaskblogOPENSEARCH1utm_sourcedistributepc_relevant_rightnonetaskblogOPENSEARCH1_486" rel="nofollow">3.1. [Flink最锋利的武器：Flink SQL入门和实战 ](https://blog.csdn.net/u013411339/article/details/93267838?depth_1-utm_source=distribute.pc_relevant_right.none-task-blog-OPENSEARCH-1&amp;utm_source=distribute.pc_relevant_right.none-task-blog-OPENSEARCH-1)</a></li><li><a href="#32_Flink110HivehttpsmpweixinqqcomsEQIDSDEmo4LdN4s1W_Iw_488" rel="nofollow">3.2. [Flink1.10集成Hive快速入门](https://mp.weixin.qq.com/s/EQIDS-DEmo4Ld-N4s1W_Iw)</a></li></ul> 
  </li><li><a href="#4__491" rel="nofollow">4. 微语：你的每个点赞，我都认真当成了喜欢</a></li></ul> 
</div> 
<p></p> 
<h2><a id="1_SQL_1"></a>1. SQL</h2> 
<h3><a id="11__2"></a>1.1. 初始化操作</h3> 
<ul><li>链接数据库<code>mysql -h 192.168.1.30 -P 3306 -uroot -p123456</code></li><li>退出数据库<code>exit/quit/ctrl+d</code></li><li>显示时间<code>select now();</code></li><li>显示数据库的版本<code>select version();</code></li></ul> 
<h3><a id="12_DDLData_Definition_Language_7"></a>1.2. 数据定义语言DDL（<mark>Data Definition Language</mark>）</h3> 
<ul><li><strong>关键词：</strong> <code>create</code> <code>alter</code> <code>drop</code> <code>truncate(删除当前表再新建一个一模一样的表结构)</code></li><li>创建数据库create database <code>hadoop-01</code> charset=utf8; # 注意有特殊字符时，用tab键上面的字符引起来</li><li>查看所有的数据库/表<code>show databases/tables</code></li><li>查看创建数据库的语句<code>show create database db_test;</code><strong>\G格式化，在终端可以直接拷贝出sql语句</strong></li><li>查看当前使用的数据库<code>select database();</code></li><li>使用数据库<code>use db_test;</code></li><li>删除数据库<code>drop database db_test;</code></li><li>创建表 
  <ul><li><mark>格式</mark> 
    <ul><li>auto_increment表示自动增长</li><li>not null 表示不能为空</li><li>primary key 表示主键</li><li>default 默认值</li><li>create table 数据表名字 (<code>字段</code> <code>类型</code> <code>约束</code>[, 字段 类型 约束]);</li></ul> </li><li><mark>实例</mark> 
    <ul><li> <p>create table xxxxx(id int, name varchar(30));</p> </li><li> <p>create table yyyyy(id int primary key not null auto_increment, name varchar(30));</p> </li><li> <p>创建students表(id、name、age、high、gender、cls_id)</p> <pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> students<span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">unsigned</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    age <span class="token keyword">tinyint</span> <span class="token keyword">unsigned</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">,</span>
    high <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    gender <span class="token keyword">enum</span><span class="token punctuation">(</span><span class="token string">"男"</span><span class="token punctuation">,</span> <span class="token string">"女"</span><span class="token punctuation">,</span> <span class="token string">"中性"</span><span class="token punctuation">,</span> <span class="token string">"保密"</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">"保密"</span><span class="token punctuation">,</span>
    cls_id <span class="token keyword">int</span> <span class="token keyword">unsigned</span><span class="token punctuation">,</span>
	is_delete <span class="token keyword">bit</span> <span class="token keyword">default</span> <span class="token number">0</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li></ul> </li></ul> </li><li>查看表结构<code>desc xxxxx;</code></li><li>查看创建表的创建语句<code>show create table xxxxx;</code> <strong>\G格式化，在终端可以直接拷贝出sql语句</strong></li><li>修改表 
  <ul><li> <p><mark>增加列</mark><code>alter table 表名 add 列名 类型;</code></p> <pre><code class="prism language-sql"> <span class="token keyword">alter</span> <span class="token keyword">table</span> students <span class="token keyword">add</span> birthday <span class="token keyword">datetime</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p><mark>修改字段：不重命名字段</mark><code>alter table 表名 modify 列名 类型及约束</code></p> <pre><code class="prism language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> students <span class="token keyword">modify</span> birthday <span class="token keyword">date</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p><mark>修改表-修改字段：重命名字段</mark><code>alter table 表名 change 原名 新名 类型及约束;</code></p> <pre><code class="prism language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> students change birthday birth <span class="token keyword">date</span> <span class="token keyword">default</span> <span class="token string">"2020-03-30"</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p><mark>修改表-删除字段</mark><code>alter table 表名 drop 列名;</code></p> <pre><code class="prism language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> students <span class="token keyword">drop</span> high<span class="token punctuation">;</span>
</code></pre> </li></ul> </li><li>删除表<code>drop table xxxxx;</code></li><li>复制表结构,不包含数据<code>create table stu like students;</code></li><li>复制表结构和数据<code>create table stu1 (select * from students);</code></li></ul> 
<h3><a id="13_DMLData_Manipulation_Language_71"></a>1.3. 数据操纵语言DML（<mark>Data Manipulation Language</mark>）</h3> 
<ul><li> <p><strong>关键词：</strong> <code>insert</code> <code>update</code> <code>delete</code></p> </li><li> <p><strong>注意点</strong></p> 
  <ul><li>开发中很少使用delete,删除有物理删除和逻辑删除，其中逻辑删除可以通过给表添加一个字段(isDel)，若值为1，代表删除；若值为0，代表没有删除。此时，对数据的删除操作就变成了update操作了。</li><li>truncate和delete的区别：<code>truncate是删除表，再重新创建这个表。属于DDL，delete是一条一条删除表中的数据，属于DML。</code></li></ul> </li><li> <p>数据的增加</p> 
  <ul><li><mark>全列插入</mark><code>insert [into] 表名 values(...)</code><pre><code class="prism language-sql"><span class="token comment">-- auto_increment:从当前最大的自增值开始偏移，即使缺少了中间部分值，也可以指定，只要不冲突就可以，一般用0或者null</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> students <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"小李飞刀"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span><span class="token number">166.66</span><span class="token punctuation">,</span><span class="token string">"女"</span><span class="token punctuation">,</span><span class="token string">"1990-01-01"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 是否删除位一般采用一个bit即可</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> students <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">"小李飞刀"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span><span class="token number">166.6</span><span class="token punctuation">,</span><span class="token string">"女"</span><span class="token punctuation">,</span><span class="token string">"1990-01-01"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 枚举中 的 下标从1 开始 1---“男” 2---&gt;"女"....</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> students <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">"小李飞刀"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span><span class="token number">166.6</span><span class="token punctuation">,</span><span class="token string">"2"</span><span class="token punctuation">,</span><span class="token string">"1990-01-01"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li><mark>部分插入</mark><code>insert into 表名(列1,...) values(值1,...)</code><pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> students <span class="token punctuation">(</span>name<span class="token punctuation">,</span> gender<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">"小乔"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li><mark>多行插入</mark><pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> students <span class="token punctuation">(</span>name<span class="token punctuation">,</span> gender<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">"大乔"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">"貂蝉"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> students <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">"小李飞刀"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span><span class="token number">166.6</span><span class="token punctuation">,</span><span class="token string">"女"</span><span class="token punctuation">,</span><span class="token string">"1990-01-01"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">"小李飞刀"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span><span class="token number">166.6</span><span class="token punctuation">,</span><span class="token string">"女"</span><span class="token punctuation">,</span><span class="token string">"1990-01-01"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li></ul> </li><li> <p>修改数据<code>update 表名 set 列1=值1,列2=值2... where 条件;</code></p> <pre><code class="prism language-sql"><span class="token comment">-- 全部修改</span>
<span class="token keyword">update</span> students <span class="token keyword">set</span> gender<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">-- 只要name是小李飞刀的 全部的修改</span>
<span class="token keyword">update</span> students <span class="token keyword">set</span> gender<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">where</span> name<span class="token operator">=</span><span class="token string">"小李飞刀"</span><span class="token punctuation">;</span>
<span class="token comment">-- 只要id为3的 进行修改</span>
<span class="token keyword">update</span> students <span class="token keyword">set</span> gender<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
<span class="token comment">-- 只要id为3的 进行修改,修改多列</span>
<span class="token keyword">update</span> students <span class="token keyword">set</span> age<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">,</span> gender<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>删除数据</p> 
  <ul><li> <p><mark>物理删除</mark> <code>delete from 表名 where 条件</code></p> <pre><code class="prism language-sql"><span class="token keyword">delete</span> <span class="token keyword">from</span> students<span class="token punctuation">;</span> 
<span class="token keyword">delete</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> name<span class="token operator">=</span><span class="token string">"小李飞刀"</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p><mark>逻辑删除</mark></p> <pre><code class="prism language-sql"><span class="token comment">-- 用一个字段来表示 这条信息是否已经不能再使用了</span>
<span class="token comment">-- 给students表添加一个is_delete字段 bit 类型</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> students <span class="token keyword">add</span> is_delete <span class="token keyword">bit</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> students <span class="token keyword">set</span> is_delete<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">;</span>
</code></pre> </li></ul> </li></ul> 
<h3><a id="14_DQLData_Query_Language_126"></a>1.4. 数据查询语言DQL（<mark>Data Query Language</mark>）</h3> 
<ul><li> <p><strong>关键词</strong><code>select</code></p> </li><li> <p><strong>执行顺序</strong><code>from</code>-&gt;<code>where</code>-&gt;<code>group by</code>-&gt;<code>having</code>-&gt;<code>order by</code>-&gt;<code>select</code></p> 
  <ul><li>其中select和from是必须的，其他关键词是可选的，这六个关键词的执行顺序与sql语句的书写顺序并不是一样的，而是按照下面的顺序来执行：</li><li>from–where–group by–having–select–order by, 
    <ul><li>from:需要从哪个数据表检索数据</li><li>where:过滤表中数据的条件</li><li>group by:如何将上面过滤出的数据分组</li><li>having:对上面已经分组的数据进行过滤的条件</li><li>select:查看结果集中的哪个列，或列的计算结果</li><li>order by :按照什么样的顺序来查看返回的数据</li></ul> </li></ul> </li><li> <p><strong>注意点</strong></p> 
  <ul><li>group by 通常和聚合函数(avg(),count()…)一起使用 ,经常先使用group by关键字进行分组，然后再进行集合运算。</li><li>group by与having 一起使用，可以限制输出的结果，只有满足条件表达式的结果才会显示。</li><li>having和where的区别：<code>where作用于表或视图，是表和视图的查询条件。having作用于分组后的记录，用于选择满足条件的组。</code></li></ul> </li><li> <p><strong>查询</strong></p> <pre><code class="prism language-sql"><span class="token comment">/*查询所有字段*/</span>
<span class="token comment">-- select * from 表名;</span>
<span class="token comment">-- 查询指定字段 select 列1,列2,... from 表名;</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> age <span class="token keyword">from</span> students<span class="token punctuation">;</span>
<span class="token comment">-- 使用 as 给字段起别名 select 字段 as 名字.... from 表名;</span>
<span class="token keyword">select</span> name <span class="token keyword">as</span> 姓名<span class="token punctuation">,</span> age <span class="token keyword">as</span> 年龄 <span class="token keyword">from</span> students<span class="token punctuation">;</span>
<span class="token comment">-- 可以通过 as 给表起别名 select 别名.字段 .... from 表名 as 别名;</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>age <span class="token keyword">from</span> students <span class="token keyword">as</span> s<span class="token punctuation">;</span>
<span class="token comment">-- 消除重复行 distinct 字段</span>
<span class="token keyword">select</span> <span class="token keyword">distinct</span> gender <span class="token keyword">from</span> students<span class="token punctuation">;</span>
</code></pre> </li><li> <p><strong>条件查询</strong></p> 
  <ul><li> <p>比较运算符（<code>&lt;,``&gt;</code>,<code>&lt;=</code>,<code>&gt;=</code>,<code>!=</code>,<code>=</code>）</p> <pre><code class="prism language-sql"><span class="token comment">-- 查询大于18岁的信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> age <span class="token operator">&gt;</span> <span class="token number">18</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询不等于18岁的信息</span>
<span class="token comment">-- != 或者 &lt;&gt;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> age <span class="token operator">&lt;&gt;</span> <span class="token number">18</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p><strong>逻辑运算符</strong>(<code>and</code>, <code>or</code>, <code>not</code>)</p> <pre><code class="prism language-sql"><span class="token comment">-- 18到28之间的所以学生信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> age<span class="token operator">&gt;</span><span class="token number">18</span> <span class="token operator">and</span> age<span class="token operator">&lt;</span><span class="token number">28</span><span class="token punctuation">;</span>
<span class="token comment">-- 18岁以上的女性</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> age<span class="token operator">&gt;</span><span class="token number">18</span> <span class="token operator">and</span> gender<span class="token operator">=</span><span class="token string">"女"</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> age<span class="token operator">&gt;</span><span class="token number">18</span> <span class="token operator">and</span> gender<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">-- 18以上或者身高超过过180(包含)以上</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> age<span class="token operator">&gt;</span><span class="token number">18</span> <span class="token operator">or</span> height<span class="token operator">&gt;=</span><span class="token number">180</span><span class="token punctuation">;</span>
<span class="token comment">-- 不在 18岁以上的女性 这个范围内的信息</span>
<span class="token comment">-- select * from students where not age&gt;18 and gender=2;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> <span class="token operator">not</span> <span class="token punctuation">(</span>age<span class="token operator">&gt;</span><span class="token number">18</span> <span class="token operator">and</span> gender<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 年龄不是小于或者等于18 并且是女性</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> <span class="token punctuation">(</span><span class="token operator">not</span> age<span class="token operator">&lt;=</span><span class="token number">18</span><span class="token punctuation">)</span> <span class="token operator">and</span> gender<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> </li></ul> </li><li> <p><strong>模糊查询</strong>（<code>like</code>,<code>rlike</code>）</p> <pre><code class="prism language-sql"><span class="token comment">-- like % 替换1个或者多个 _ 替换1个</span>
<span class="token comment">-- 查询姓名中 以 "小" 开始的名字</span>
<span class="token keyword">select</span> name <span class="token keyword">from</span> students <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">"小%"</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询姓名中 有 "小" 所有的名字</span>
<span class="token keyword">select</span> name <span class="token keyword">from</span> students <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">"%小%"</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询有2个字的名字</span>
<span class="token keyword">select</span> name <span class="token keyword">from</span> students <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">"__"</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询至少有2个字的名字</span>
<span class="token keyword">select</span> name <span class="token keyword">from</span> students <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">"__%"</span><span class="token punctuation">;</span>
<span class="token comment">-- rlike 正则</span>
<span class="token comment">-- 查询以 周开始的姓名</span>
<span class="token keyword">select</span> name <span class="token keyword">from</span> students <span class="token keyword">where</span> name <span class="token operator">rlike</span> <span class="token string">"^周.*"</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询以 周开始、伦结尾的姓名</span>
<span class="token keyword">select</span> name <span class="token keyword">from</span> students <span class="token keyword">where</span> name <span class="token operator">rlike</span> <span class="token string">"^周.*伦$"</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p><strong>范围查询</strong></p> <pre><code class="prism language-sql"><span class="token comment">-- in (1, 3, 8)表示在一个非连续的范围内</span>
<span class="token comment">-- 查询 年龄为18、34的姓名</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span>age <span class="token keyword">from</span> students <span class="token keyword">where</span> age <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- not in 不非连续的范围之内</span>
<span class="token comment">-- 年龄不是 18、34岁之间的信息</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span>age <span class="token keyword">from</span> students <span class="token keyword">where</span> age <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- between ... and ...表示在一个连续的范围内</span>
<span class="token comment">-- 查询 年龄在18到34之间的的信息</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> age <span class="token keyword">from</span> students <span class="token keyword">where</span> age <span class="token operator">between</span> <span class="token number">18</span> <span class="token operator">and</span> <span class="token number">34</span><span class="token punctuation">;</span>

<span class="token comment">-- not between ... and ...表示不在一个连续的范围内</span>
<span class="token comment">-- 查询 年龄不在在18到34之间的的信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> age <span class="token operator">not</span> <span class="token operator">between</span> <span class="token number">18</span> <span class="token operator">and</span> <span class="token number">34</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> <span class="token operator">not</span> age <span class="token operator">between</span> <span class="token number">18</span> <span class="token operator">and</span> <span class="token number">34</span><span class="token punctuation">;</span>
<span class="token comment">-- 失败的查询案例</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> age <span class="token operator">not</span> <span class="token punctuation">(</span><span class="token operator">between</span> <span class="token number">18</span> <span class="token operator">and</span> <span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p><strong>空判断</strong></p> <pre><code class="prism language-sql"><span class="token comment">-- 判空is null</span>
<span class="token comment">-- 查询身高为空的信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> height <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
<span class="token comment">-- 判非空is not null</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> height <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p><strong>排序</strong><code>order by</code></p> <pre><code class="prism language-sql"><span class="token comment">-- 查询年龄在18到34岁之间的男性，按照年龄从小到大排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> <span class="token punctuation">(</span>age <span class="token operator">between</span> <span class="token number">18</span> <span class="token operator">and</span> <span class="token number">34</span><span class="token punctuation">)</span> <span class="token operator">and</span> gender<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">order</span> <span class="token keyword">by</span> age <span class="token keyword">asc</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询年龄在18到34岁之间的女性，身高从高到矮排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> <span class="token punctuation">(</span>age <span class="token operator">between</span> <span class="token number">18</span> <span class="token operator">and</span> <span class="token number">34</span><span class="token punctuation">)</span> <span class="token operator">and</span> gender<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">order</span> <span class="token keyword">by</span> height <span class="token keyword">desc</span><span class="token punctuation">;</span>
<span class="token comment">-- order by 多个字段</span>
<span class="token comment">-- 查询年龄在18到34岁之间的女性，身高从高到矮排序, 如果身高相同的情况下按照年龄从小到大排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> <span class="token punctuation">(</span>age <span class="token operator">between</span> <span class="token number">18</span> <span class="token operator">and</span> <span class="token number">34</span><span class="token punctuation">)</span> <span class="token operator">and</span> gender<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">order</span> <span class="token keyword">by</span> height <span class="token keyword">desc</span><span class="token punctuation">,</span>id <span class="token keyword">desc</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询年龄在18到34岁之间的女性，身高从高到矮排序, 如果身高相同的情况下按照年龄从小到大排序,</span>
<span class="token comment">-- 如果年龄也相同那么按照id从大到小排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> <span class="token punctuation">(</span>age <span class="token operator">between</span> <span class="token number">18</span> <span class="token operator">and</span> <span class="token number">34</span><span class="token punctuation">)</span> <span class="token operator">and</span> gender<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">order</span> <span class="token keyword">by</span> height <span class="token keyword">desc</span><span class="token punctuation">,</span>age <span class="token keyword">asc</span><span class="token punctuation">,</span>id <span class="token keyword">desc</span><span class="token punctuation">;</span>
<span class="token comment">-- 按照年龄从小到大、身高从高到矮的排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">order</span> <span class="token keyword">by</span> age <span class="token keyword">asc</span><span class="token punctuation">,</span> height <span class="token keyword">desc</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p><strong>聚合函数</strong></p> <pre><code class="prism language-sql"><span class="token comment">-- 总数count</span>
<span class="token comment">-- 查询男性有多少人，女性有多少人</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> 男性人数 <span class="token keyword">from</span> students <span class="token keyword">where</span> gender<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> 女性人数 <span class="token keyword">from</span> students <span class="token keyword">where</span> gender<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">-- 最大值/最小值 max/min</span>
<span class="token comment">-- 查询最大的年龄</span>
<span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token keyword">from</span> students<span class="token punctuation">;</span>
<span class="token comment">-- 查询女性的最高 身高</span>
<span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> gender<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">-- 求和 sum</span>
<span class="token comment">-- 计算所有人的年龄总和</span>
<span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token keyword">from</span> students<span class="token punctuation">;</span>
<span class="token comment">-- 平均值 avg</span>
<span class="token comment">-- 计算平均年龄</span>
<span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token keyword">from</span> students<span class="token punctuation">;</span>
<span class="token comment">-- 计算平均年龄 sum(age)/count(*)</span>
<span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> students<span class="token punctuation">;</span>
<span class="token comment">-- 四舍五入 round(123.23 , 1) 保留1位小数</span>
<span class="token comment">-- 计算所有人的平均年龄，保留2位小数</span>
<span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">from</span> students<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">from</span> students<span class="token punctuation">;</span>
<span class="token comment">-- 计算男性的平均身高 保留2位小数</span>
<span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>high<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> gender<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p><strong>分组（和聚合配合使用）</strong></p> <pre><code class="prism language-sql"><span class="token comment">-- group by  先分组，从组里面取数据</span>
<span class="token comment">-- 按照性别分组,查询所有的性别</span>
<span class="token keyword">select</span> gender <span class="token keyword">from</span> students <span class="token keyword">group</span> <span class="token keyword">by</span> gender<span class="token punctuation">;</span>
<span class="token comment">-- 失败select * from students group by gender;    查询列当中必须包含分组的字段，并能用*</span>
<span class="token comment">-- 计算每种性别中的人数</span>
<span class="token keyword">select</span> gender<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> students <span class="token keyword">group</span> <span class="token keyword">by</span> gender<span class="token punctuation">;</span>
<span class="token comment">-- 计算男性的人数</span>
<span class="token keyword">select</span> gender<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> gender<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">group</span> <span class="token keyword">by</span> gender<span class="token punctuation">;</span>
<span class="token comment">-- group_concat(...)</span>
<span class="token comment">-- 查询同种性别中的姓名</span>
<span class="token keyword">select</span> gender<span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> gender<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">group</span> <span class="token keyword">by</span> gender<span class="token punctuation">;</span>
<span class="token keyword">select</span> gender<span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> id<span class="token punctuation">)</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> gender<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">group</span> <span class="token keyword">by</span> gender<span class="token punctuation">;</span>
<span class="token keyword">select</span> gender<span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"_"</span><span class="token punctuation">,</span> age<span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> gender<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">group</span> <span class="token keyword">by</span> gender<span class="token punctuation">;</span>
<span class="token comment">-- having</span>
<span class="token comment">-- 查询平均年龄超过30岁的性别，以及姓名 having avg(age) &gt; 30</span>
<span class="token keyword">select</span> gender<span class="token punctuation">,</span> group_concat<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token keyword">from</span> students <span class="token keyword">group</span> <span class="token keyword">by</span> gender <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">30</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询每种性别中的人数多于2个的信息</span>
<span class="token keyword">select</span> gender<span class="token punctuation">,</span> group_concat<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">from</span> students <span class="token keyword">group</span> <span class="token keyword">by</span> gender <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p><strong>分页查询</strong></p> <pre><code class="prism language-sql"><span class="token comment">-- limit start, count</span>
<span class="token comment">-- 限制查询出来的数据个数</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> gender<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">limit</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询前5个数据</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token comment">-- 每页显示2个，第1个页面</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">-- 每页显示2个，第2个页面</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">limit</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">-- 每页显示2个，第3个页面</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">limit</span> <span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">-- 每页显示2个，第4个页面</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">limit</span> <span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">;</span> 
<span class="token comment">-- -----&gt; limit (第N页-1)*每个的个数, 每页的个数;</span>
<span class="token comment">-- 每页显示2个，显示第6页的信息, 按照年龄从小到大排序</span>
<span class="token comment">-- 失败select * from students limit 2*(6-1),2;</span>
<span class="token comment">-- 失败select * from students limit 10,2 order by age asc;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">order</span> <span class="token keyword">by</span> age <span class="token keyword">asc</span> <span class="token keyword">limit</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">;</span>

</code></pre> </li><li> <p><strong>链接查询</strong></p> <pre><code class="prism language-sql"><span class="token comment">-- inner join ... on</span>

<span class="token comment">-- select ... from 表A inner join 表B;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">inner</span> <span class="token keyword">join</span> classes<span class="token punctuation">;</span>
<span class="token comment">-- 查询 有能够对应班级的学生以及班级信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">inner</span> <span class="token keyword">join</span> classes <span class="token keyword">on</span> students<span class="token punctuation">.</span>cls_id<span class="token operator">=</span>classes<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
<span class="token comment">-- 按照要求显示姓名、班级</span>
<span class="token keyword">select</span> students<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> classes<span class="token punctuation">.</span>name <span class="token keyword">from</span> students <span class="token keyword">inner</span> <span class="token keyword">join</span> classes <span class="token keyword">on</span> students<span class="token punctuation">.</span>cls_id<span class="token operator">=</span>classes<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
<span class="token keyword">select</span> students<span class="token punctuation">.</span>name<span class="token punctuation">,</span> classes<span class="token punctuation">.</span>name <span class="token keyword">from</span> students <span class="token keyword">inner</span> <span class="token keyword">join</span> classes <span class="token keyword">on</span> students<span class="token punctuation">.</span>cls_id<span class="token operator">=</span>classes<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
<span class="token comment">-- 给数据表起名字</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>name<span class="token punctuation">,</span> c<span class="token punctuation">.</span>name <span class="token keyword">from</span> students <span class="token keyword">as</span> s <span class="token keyword">inner</span> <span class="token keyword">join</span> classes <span class="token keyword">as</span> c <span class="token keyword">on</span> s<span class="token punctuation">.</span>cls_id<span class="token operator">=</span>c<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
<span class="token comment">-- 查询 有能够对应班级的学生以及班级信息，显示学生的所有信息，只显示班级名称</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>name <span class="token keyword">from</span> students <span class="token keyword">as</span> s <span class="token keyword">inner</span> <span class="token keyword">join</span> classes <span class="token keyword">as</span> c <span class="token keyword">on</span> s<span class="token punctuation">.</span>cls_id<span class="token operator">=</span>c<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
<span class="token comment">-- 在以上的查询中，将班级姓名显示在第1列</span>
<span class="token keyword">select</span> c<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">as</span> s <span class="token keyword">inner</span> <span class="token keyword">join</span> classes <span class="token keyword">as</span> c <span class="token keyword">on</span> s<span class="token punctuation">.</span>cls_id<span class="token operator">=</span>c<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
<span class="token comment">-- 查询 有能够对应班级的学生以及班级信息, 按照班级进行排序</span>
<span class="token comment">-- select c.xxx s.xxx from student as s inner join clssses as c on .... order by ....;</span>
<span class="token keyword">select</span> c<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">as</span> s <span class="token keyword">inner</span> <span class="token keyword">join</span> classes <span class="token keyword">as</span> c <span class="token keyword">on</span> s<span class="token punctuation">.</span>cls_id<span class="token operator">=</span>c<span class="token punctuation">.</span>id <span class="token keyword">order</span> <span class="token keyword">by</span> c<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token comment">-- 当时同一个班级的时候，按照学生的id进行从小到大排序</span>
<span class="token keyword">select</span> c<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">as</span> s <span class="token keyword">inner</span> <span class="token keyword">join</span> classes <span class="token keyword">as</span> c <span class="token keyword">on</span> s<span class="token punctuation">.</span>cls_id<span class="token operator">=</span>c<span class="token punctuation">.</span>id <span class="token keyword">order</span> <span class="token keyword">by</span> c<span class="token punctuation">.</span>name<span class="token punctuation">,</span>s<span class="token punctuation">.</span>id<span class="token punctuation">;</span>

<span class="token comment">-- left join</span>
<span class="token comment">-- 查询每位学生对应的班级信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">as</span> s <span class="token keyword">left</span> <span class="token keyword">join</span> classes <span class="token keyword">as</span> c <span class="token keyword">on</span> s<span class="token punctuation">.</span>cls_id<span class="token operator">=</span>c<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
<span class="token comment">-- 查询没有对应班级信息的学生</span>
<span class="token comment">-- select ... from xxx as s left join xxx as c on..... where .....</span>
<span class="token comment">-- select ... from xxx as s left join xxx as c on..... having .....		-- having 一般也用在多表关联之后的结果中取数据的条件</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">as</span> s <span class="token keyword">left</span> <span class="token keyword">join</span> classes <span class="token keyword">as</span> c <span class="token keyword">on</span> s<span class="token punctuation">.</span>cls_id<span class="token operator">=</span>c<span class="token punctuation">.</span>id <span class="token keyword">having</span> c<span class="token punctuation">.</span>id <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">as</span> s <span class="token keyword">left</span> <span class="token keyword">join</span> classes <span class="token keyword">as</span> c <span class="token keyword">on</span> s<span class="token punctuation">.</span>cls_id<span class="token operator">=</span>c<span class="token punctuation">.</span>id <span class="token keyword">where</span> c<span class="token punctuation">.</span>id <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>

<span class="token comment">-- right join   on</span>
<span class="token comment">-- 将数据表名字互换位置，用left join完成</span>
</code></pre> </li><li> <p>子查询</p> <pre><code class="prism language-sql"><span class="token comment">-- 标量子查询</span>
<span class="token comment">-- 查询出高于平均身高的信息</span>

<span class="token comment">-- 查询最高的男生信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> height <span class="token operator">=</span> <span class="token number">188</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> height <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span> <span class="token keyword">from</span> students<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 列级子查询</span>
<span class="token comment">-- 查询学生的班级号能够对应的学生信息</span>
<span class="token comment">-- select * from students where cls_id in (select id from classes);</span>
</code></pre> </li></ul> 
<h3><a id="15_DCLData_Control_Language_372"></a>1.5. 数据控制语言DCL（<mark>Data Control Language</mark>）</h3> 
<ul><li><strong>关键字：</strong><code>用户</code>，<code>权限</code>，<code>事务</code>。</li><li><a href="https://blog.csdn.net/Backpace_/article/details/103230146">MySQL：事务与DCL</a></li></ul> 
<h2><a id="2_HQL_375"></a>2. HQL</h2> 
<h3><a id="21_DDL_376"></a>2.1. 数据定义语言DDL</h3> 
<ul><li> <p><strong>建表语句及说明</strong><br> <img src="https://images2.imgbox.com/83/3e/Hz1MnVZi_o.png" alt="在这里插入图片描述"></p> </li><li> <p>显示当前在哪个数据库下面<code>select current_database();</code></p> </li><li> <p>强制删除有数据的数据库<code>drop database db_test cascade;</code></p> </li><li> <p>显示分区表中的分区<code>show partitions table_name;</code></p> </li><li> <p>显示函数<code>show functions;</code></p> </li><li> <p>执行查看表结构（更为详细）<code>desc formatted table_name;</code></p> </li><li> <p><strong>分区表的创建</strong></p> <pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> t_invites<span class="token punctuation">(</span>id <span class="token keyword">int</span><span class="token punctuation">,</span> name string<span class="token punctuation">)</span>
partitioned <span class="token keyword">by</span><span class="token punctuation">(</span>cls string<span class="token punctuation">)</span>
<span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span> stored <span class="token keyword">as</span> textfile<span class="token punctuation">;</span>
</code></pre> </li><li> <p><strong>内部表和外部表</strong></p> 
  <ul><li> <p><mark>区别</mark></p> 
    <ul><li>内部表数据由Hive自身管理，外部表数据由HDFS管理；</li><li>内部表数据存储的位置是hive.metastore.warehouse.dir（默认：/user/hive/warehouse），外部表数据的存储位置由自己制定（如果没有LOCATION，Hive将在HDFS上的/user/hive/warehouse文件夹下以外部表的表名创建一个文件夹，并将属于这个表的数据存放在这里）；</li><li>删除内部表会直接删除元数据（metadata）及存储数据；删除外部表仅仅会删除元数据，HDFS上的文件并不会被删除；</li><li>对内部表的修改会将修改直接同步给元数据，而<code>对外部表的表结构和分区进行修改，则需要修复（MSCK REPAIR TABLE table_name;）</code></li><li><code>注意： 在创建外部表时，要保证指定的location目录下面没有其他的“脏文件或者文件夹”</code></li></ul> </li><li> <p><mark>内部表</mark></p> 
    <ul><li> <p>创建</p> <pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> t1<span class="token punctuation">(</span>
    id      <span class="token keyword">int</span>
   <span class="token punctuation">,</span>name    string
   <span class="token punctuation">,</span>hobby   array<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>
   <span class="token punctuation">,</span><span class="token keyword">add</span>     map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span>string<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
<span class="token keyword">row</span> format delimited
<span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
collection items <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'-'</span>
map <span class="token keyword">keys</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">':'</span>
<span class="token punctuation">;</span>
</code></pre> </li><li> <p>装载数据<code>LOAD DATA [LOCAL] INPATH 'filepath' [OVERWRITE] INTO TABLE tablename [PARTITION (partcol1=val1, partcol2=val2 ...)]</code></p> <pre><code>1,xiaoming,book-TV-code,beijing:chaoyang-shagnhai:pudong
2,lilei,book-code,nanjing:jiangning-taiwan:taibei
3,lihua,music-book,heilongjiang:haerbin
</code></pre> <pre><code class="prism language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> inpath <span class="token string">'/user/hadoop/xiaofan/data/tmp/t1.data'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> t1<span class="token punctuation">;</span>
</code></pre> </li><li> <p>查看表数据<br> <img src="https://images2.imgbox.com/f0/7e/sdOY3D5E_o.png" alt="在这里插入图片描述"></p> </li></ul> </li><li> <p><mark>外部表</mark></p> 
    <ul><li>创建<pre><code class="prism language-sql"><span class="token keyword">create</span> external <span class="token keyword">table</span> t2<span class="token punctuation">(</span>
    id      <span class="token keyword">int</span>
   <span class="token punctuation">,</span>name    string
   <span class="token punctuation">,</span>hobby   array<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>
   <span class="token punctuation">,</span><span class="token keyword">add</span>     map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span>string<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
<span class="token keyword">row</span> format delimited
<span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span>
collection items <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'-'</span>
map <span class="token keyword">keys</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">':'</span>
location <span class="token string">'/user/hadoop/xiaofan/data/tmp'</span>
</code></pre> </li><li>表信息<br> <img src="https://images2.imgbox.com/eb/50/Mt4w4GrY_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/0f/06/hsuXg5au_o.png" alt="在这里插入图片描述"></li></ul> </li></ul> </li><li> <p><strong>MSCK REPAIR TABLE命令</strong><code>主要是用来解决通过hdfs dfs -put或者hdfs api写入hive分区表的数据在hive中无法被查询到的问题</code></p> 
  <ul><li><a href="https://www.jianshu.com/p/c1b0dc86f9b0" rel="nofollow">HIVE常用命令之MSCK REPAIR TABLE命令简述</a></li></ul> </li><li> <p><strong>修改表</strong><br> <img src="https://images2.imgbox.com/c5/bf/intKuD21_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h3><a id="22_DML_454"></a>2.2. 数据操纵语言DML</h3> 
<ul><li> <p><strong>Load操作</strong><br> <img src="https://images2.imgbox.com/df/ea/CdD6X9l0_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>INSERT(将查询结果插入Hive表)</strong><br> <img src="https://images2.imgbox.com/eb/5c/4LBflAzX_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>导出数据表</strong><br> <img src="https://images2.imgbox.com/c9/59/jrGOKDoW_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h3><a id="23_DQL_462"></a>2.3. 数据查询语言DQL</h3> 
<p><img src="https://images2.imgbox.com/c4/7e/YNc2RYEn_o.png" alt="在这里插入图片描述"></p> 
<ul><li> <p><a href="https://blog.csdn.net/wangxingxing2006/article/details/53367011">Hive 区分cluster by、distribute by ＋ sort by、order by以及创建表带有clustered by和sort by</a></p> </li><li> <p><strong>Hive join（只支持等值链接，和sql用法类似）</strong><br> <img src="https://images2.imgbox.com/94/6a/9RVnMzwf_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h3><a id="24__469"></a>2.4. 桶表的相关案例</h3> 
<p><img src="https://images2.imgbox.com/ae/2f/B9vjHUZ3_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/97/23/maoEXE8i_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="25_Hive__472"></a>2.5. Hive 的集合类型</h3> 
<p><img src="https://images2.imgbox.com/86/6c/HyOT4V3o_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="26_Hive__474"></a>2.6. Hive 严格模式</h3> 
<p><img src="https://images2.imgbox.com/7b/7b/lxRoFoNx_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="27_HivehttpscwikiapacheorgconfluencedisplayHiveConfigurationProperties_477"></a>2.7. <a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties" rel="nofollow">Hive参数配置方式</a></h3> 
<h3><a id="28_Hive_httpscwikiapacheorgconfluencedisplayHiveLanguageManualUDF_479"></a>2.8. <a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF" rel="nofollow">Hive 函数</a></h3> 
<p><img src="https://images2.imgbox.com/55/50/n6dAVA6K_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6b/3a/ygJ7d6B4_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="29_hive__httpsblogcsdnnetu012808902articledetails77874722_482"></a>2.9. <a href="https://blog.csdn.net/u012808902/article/details/77874722">hive面试套路 - 累计报表</a></h3> 
<ul><li>要求输出每个客户在每个月的总访问次数，以及在当前月份之前所有月份的累积访问次数。</li></ul> 
<h2><a id="3_FLINKSQL_485"></a>3. FLINK-SQL</h2> 
<h3><a id="31_FlinkFlink_SQL_httpsblogcsdnnetu013411339articledetails93267838depth_1utm_sourcedistributepc_relevant_rightnonetaskblogOPENSEARCH1utm_sourcedistributepc_relevant_rightnonetaskblogOPENSEARCH1_486"></a>3.1. <a href="https://blog.csdn.net/u013411339/article/details/93267838?depth_1-utm_source=distribute.pc_relevant_right.none-task-blog-OPENSEARCH-1&amp;utm_source=distribute.pc_relevant_right.none-task-blog-OPENSEARCH-1">Flink最锋利的武器：Flink SQL入门和实战 </a></h3> 
<h3><a id="32_Flink110HivehttpsmpweixinqqcomsEQIDSDEmo4LdN4s1W_Iw_488"></a>3.2. <a href="https://mp.weixin.qq.com/s/EQIDS-DEmo4Ld-N4s1W_Iw" rel="nofollow">Flink1.10集成Hive快速入门</a></h3> 
<h2><a id="4__491"></a>4. 微语：你的每个点赞，我都认真当成了喜欢</h2>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/08c2f6358172dcf300837325ec6f917c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Vuex及其五个属性的作用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2b283596510dec7a1daf31e7cf0808c8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Xshell 连接 Ubuntu 教程（超详细）,并解决二个常见问题（一直连不上、root用户拒绝密码）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>