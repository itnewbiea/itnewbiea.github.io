<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JavaMail邮件传输 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="JavaMail邮件传输" />
<meta property="og:description" content="QQ邮箱服务器
网易邮箱服务器
一、发送一封只包含文本的简单邮件
import java.util.Properties; import javax.mail.Message; import javax.mail.Session; import javax.mail.Transport; import javax.mail.internet.InternetAddress; import javax.mail.internet.MimeMessage; public class Sendmail { public static void main(String[] args) throws Exception { Properties prop = new Properties(); prop.setProperty(&#34;mail.smtp.host&#34;, &#34;smtp.163.com&#34;); prop.setProperty(&#34;mail.transport.protocol&#34;, &#34;smtp&#34;); prop.setProperty(&#34;mail.smtp.auth&#34;, &#34;true&#34;); // 使用JavaMail发送邮件的5个步骤 // 1、创建session Session session = Session.getInstance(prop); // 开启Session的debug模式，这样就可以查看到程序发送Email的运行状态 session.setDebug(true); // 2、通过session得到transport对象 Transport ts = session.getTransport(); // 3、使用邮箱的用户名和密码连上邮件服务器，发送邮件时，发件人需要提交邮箱的用户名和密码给 // smtp服务器，用户名和密码都通过验证之后才能够正常发送邮件给收件人。 ts.connect(&#34;smtp.163.com&#34;, &#34;18883283****@163.com&#34;, &#34;****avfnmrjptvpz&#34;); // 4、创建邮件 Message message = createSimpleMail(session); // 5、发送邮件 ts." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/b51d2edda6850772222956a81e49a3d2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-01-06T23:32:50+08:00" />
<meta property="article:modified_time" content="2016-01-06T23:32:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">JavaMail邮件传输</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px">QQ邮箱服务器<br> </span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"><img src="https://images2.imgbox.com/5e/a1/rMqKpf6W_o.jpg" alt=""><br> </span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"><span style="font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14.44444465637207px; line-height:27.77777862548828px"><br> </span></span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"><span style="font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14.44444465637207px; line-height:27.77777862548828px">网易邮箱服务器</span><br> </span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"><span style="font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14.44444465637207px; line-height:27.77777862548828px"><img src="https://images2.imgbox.com/4c/d1/WLwUzTET_o.jpg" alt=""><br> </span></span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px">一、发送一封只包含文本的简单邮件</span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"></span></p> 
<pre><code class="language-java">import java.util.Properties;
import javax.mail.Message;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class Sendmail {
	public static void main(String[] args) throws Exception {

		Properties prop = new Properties();
		prop.setProperty("mail.smtp.host", "smtp.163.com");
		prop.setProperty("mail.transport.protocol", "smtp");
		prop.setProperty("mail.smtp.auth", "true");

		// 使用JavaMail发送邮件的5个步骤
		// 1、创建session
		Session session = Session.getInstance(prop);
		// 开启Session的debug模式，这样就可以查看到程序发送Email的运行状态
		session.setDebug(true);
		// 2、通过session得到transport对象
		Transport ts = session.getTransport();
		// 3、使用邮箱的用户名和密码连上邮件服务器，发送邮件时，发件人需要提交邮箱的用户名和密码给
		// smtp服务器，用户名和密码都通过验证之后才能够正常发送邮件给收件人。
		ts.connect("smtp.163.com", "18883283****@163.com", "****avfnmrjptvpz");
		// 4、创建邮件
		Message message = createSimpleMail(session);
		// 5、发送邮件
		ts.sendMessage(message, message.getAllRecipients());
		ts.close();
	}
	/**
	 * 创建一封只包含文本的邮件
	 * @param session
	 * @return
	 * @throws Exception
	 */
	public static MimeMessage createSimpleMail(Session session) throws Exception {
		// 创建邮件对象
		MimeMessage message = new MimeMessage(session);
		// 指明邮件的发件人
		message.setFrom(new InternetAddress("1888328****@163.com"));
		// 指明邮件的收件人，现在发件人和收件人是一样的，那就是自己给自己发
		message.setRecipient(Message.RecipientType.TO, new InternetAddress("165974****@qq.com"));
		// 邮件的标题
		message.setSubject("只包含文本的简单邮件");
		// 邮件的文本内容
		message.setContent("你好啊！", "text/html;charset=UTF-8");
		// 返回创建好的邮件对象
		return message;
	}
}
</code></pre> 
<br> 二、发送包含内嵌图片的邮件 
<br> 
<p></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"></span></p> 
<pre><code class="language-java">import java.io.FileOutputStream;
import java.util.Properties;

import javax.activation.DataHandler;
import javax.activation.FileDataSource;
import javax.mail.Message;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMultipart;

public class Sendmail {
	public static void main(String[] args) throws Exception {

		Properties prop = new Properties();
		prop.setProperty("mail.host", "smtp.163.com");
		prop.setProperty("mail.transport.protocol", "smtp");
		prop.setProperty("mail.smtp.auth", "true");
		// 使用JavaMail发送邮件的5个步骤
		// 1、创建session
		Session session = Session.getInstance(prop);
		// 开启Session的debug模式，这样就可以查看到程序发送Email的运行状态
		session.setDebug(true);
		// 2、通过session得到transport对象
		Transport ts = session.getTransport();
		// 3、连上邮件服务器，需要发件人提供邮箱的用户名和密码进行验证
		ts.connect("smtp.163.com", "1888328****@163.com", "****gfrhuubwymzx");
		// 4、创建邮件
		Message message = createImageMail(session);
		// 5、发送邮件
		ts.sendMessage(message, message.getAllRecipients());
		ts.close();
	}
	/**
	 * 生成一封邮件正文带图片的邮件
	 * @param session
	 * @return
	 * @throws Exception
	 */
	public static MimeMessage createImageMail(Session session) throws Exception {
		// 创建邮件
		MimeMessage message = new MimeMessage(session);
		// 设置邮件的基本信息
		// 发件人
		message.setFrom(new InternetAddress("1888328****@163.com"));
		// 收件人
		message.setRecipient(Message.RecipientType.TO, new InternetAddress("1888328****@163.com"));
		// 邮件标题
		message.setSubject("带图片的邮件");

		// 准备邮件数据
		// 准备邮件正文数据
		MimeBodyPart text = new MimeBodyPart();
		text.setContent("这是一封邮件正文带图片&lt;img src='cid:xxx.jpg'&gt;的邮件", "text/html;charset=UTF-8");
		// 准备图片数据
		MimeBodyPart image = new MimeBodyPart();
		// E:/mmexport1437314383879.jpg 
		DataHandler dh = new DataHandler(new FileDataSource("WebContent/image/mmexport1437314383879.jpg"));
		image.setDataHandler(dh);
		image.setContentID("xxx.jpg");
		// 描述数据关系
		MimeMultipart mm = new MimeMultipart();
		mm.addBodyPart(text);
		mm.addBodyPart(image);
		mm.setSubType("related");

		message.setContent(mm);
		message.saveChanges();
		// 将创建好的邮件写入到E盘以文件的形式进行保存
		message.writeTo(new FileOutputStream("E:\\ImageMail.eml"));
		// 返回创建好的邮件
		return message;
	}
}</code></pre> 
<br> 三、发送包含附件的邮件 
<p></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"></span></p> 
<pre><code class="language-java">import java.io.FileOutputStream;
import java.util.Properties;

import javax.activation.DataHandler;
import javax.activation.FileDataSource;
import javax.mail.Message;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMultipart;
import javax.mail.internet.MimeUtility;

public class Sendmail {
	public static void main(String[] args) throws Exception {

		Properties prop = new Properties();
		prop.setProperty("mail.host", "smtp.163.com");
		prop.setProperty("mail.transport.protocol", "smtp");
		prop.setProperty("mail.smtp.auth", "true");
		// 使用JavaMail发送邮件的5个步骤
		// 1、创建session
		Session session = Session.getInstance(prop);
		// 开启Session的debug模式，这样就可以查看到程序发送Email的运行状态
		session.setDebug(true);
		// 2、通过session得到transport对象
		Transport ts = session.getTransport();
		// 3、连上邮件服务器
		ts.connect("smtp.163.com", "1888328****@163.com", "****gfrhuubwymzx");
		// 4、创建邮件
		Message message = createAttachMail(session);
		// 5、发送邮件
		ts.sendMessage(message, message.getAllRecipients());
		ts.close();
	}

	/**
	 * 创建一封带附件的邮件
	 * @param session
	 * @return
	 * @throws Exception
	 */
	public static MimeMessage createAttachMail(Session session) throws Exception {
		MimeMessage message = new MimeMessage(session);

		// 设置邮件的基本信息
		// 发件人
		message.setFrom(new InternetAddress("1888328****@163.com"));
		// 收件人
		message.setRecipient(Message.RecipientType.TO, new InternetAddress("18883283****@163.com"));
		// 邮件标题
		message.setSubject("JavaMail邮件发送测试");

		// 创建邮件正文，为了避免邮件正文中文乱码问题，需要使用charset=UTF-8指明字符编码
		MimeBodyPart text = new MimeBodyPart();
		text.setContent("使用JavaMail创建的带附件的邮件", "text/html;charset=UTF-8");

		// 创建邮件附件
		MimeBodyPart attach = new MimeBodyPart();
		DataHandler dh = new DataHandler(new FileDataSource("F:/学生成绩信息管理系统.txt"));
		String filename = dh.getName();//获取文件名
		System.out.println("文件名："+filename);
		attach.setDataHandler(dh);
		attach.setFileName(MimeUtility.encodeText(filename)); //

		// 创建容器描述数据关系
		MimeMultipart mp = new MimeMultipart();
		mp.addBodyPart(text);
		mp.addBodyPart(attach);
		mp.setSubType("mixed");

		message.setContent(mp);
		message.saveChanges();
		// 将创建的Email写入到E盘存储
		message.writeTo(new FileOutputStream("E:\\attachMail.eml"));
		// 返回生成的邮件
		return message;
	}
}
</code></pre> 
<br> 四、发送包含内嵌图片和附件的复杂邮件 
<br> 
<p></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"></span></p> 
<pre><code class="language-java">import java.io.FileOutputStream;
import java.util.Properties;
import javax.activation.DataHandler;
import javax.activation.FileDataSource;
import javax.mail.Message;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMultipart;
import javax.mail.internet.MimeUtility;

public class Sendmail {
	public static void main(String[] args) throws Exception {

		Properties prop = new Properties();
		prop.setProperty("mail.host", "smtp.163.com");
		prop.setProperty("mail.transport.protocol", "smtp");
		prop.setProperty("mail.smtp.auth", "true");
		// 使用JavaMail发送邮件的5个步骤
		// 1、创建session
		Session session = Session.getInstance(prop);
		// 开启Session的debug模式，这样就可以查看到程序发送Email的运行状态
		session.setDebug(true);
		// 2、通过session得到transport对象
		Transport ts = session.getTransport();
		// 3、连上邮件服务器
		ts.connect("smtp.163.com", "1888328****@163.com", "****gfrhuubwymzx");
		// 4、创建邮件
		Message message = createMixedMail(session);
		// 5、发送邮件
		ts.sendMessage(message, message.getAllRecipients());
		ts.close();
	}

	/**
	 * 
	 * @param session
	 * @return
	 * @throws Exception
	 */
	public static MimeMessage createMixedMail(Session session) throws Exception {
		// 创建邮件
		MimeMessage message = new MimeMessage(session);

		// 设置邮件的基本信息
		message.setFrom(new InternetAddress("1888328****@163.com"));
		message.setRecipient(Message.RecipientType.TO, new InternetAddress("165974****@qq.com"));
		message.setSubject("带附件和带图片的的邮件");

		// 正文
		MimeBodyPart text = new MimeBodyPart();
		text.setContent("xxx这是xxxx&lt;br/&gt;&lt;img src='cid:aaa.jpg'&gt;", "text/html;charset=UTF-8");

		// 图片
		MimeBodyPart image = new MimeBodyPart();
		image.setDataHandler(new DataHandler(new FileDataSource("E:/mmexport1437314383879.jpg")));
		image.setContentID("aaa.jpg");

		// 附件1
		MimeBodyPart attach = new MimeBodyPart();
		DataHandler dh = new DataHandler(new FileDataSource("F:/学生成绩信息管理系统.txt"));
		String filename = dh.getName();//获取文件名
		attach.setDataHandler(dh);
		attach.setFileName(MimeUtility.encodeText(filename));

		// 附件2
		MimeBodyPart attach2 = new MimeBodyPart();
		DataHandler dh2 = new DataHandler(new FileDataSource("F:/环境变量.doc"));
		attach2.setDataHandler(dh2);
		attach2.setFileName(MimeUtility.encodeText(dh2.getName()));

		// 描述关系:正文和图片
		MimeMultipart mp1 = new MimeMultipart();
		mp1.addBodyPart(text);
		mp1.addBodyPart(image);
		mp1.setSubType("related");

		// 描述关系:正文和附件
		MimeMultipart mp2 = new MimeMultipart();
		mp2.addBodyPart(attach);
		mp2.addBodyPart(attach2);

		// 代表正文的bodypart
		MimeBodyPart content = new MimeBodyPart();
		content.setContent(mp1);
		
		mp2.addBodyPart(content);
		mp2.setSubType("mixed");

		message.setContent(mp2);
		message.saveChanges();

		message.writeTo(new FileOutputStream("E:\\MixedMail.eml"));
		// 返回创建好的的邮件
		return message;
	}
}
</code></pre> 
<br> 在这里有几个疑问： 
<p></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"><strong>1、一直用的是网易邮箱发送邮件的，QQ邮箱一直没成功，但是QQ邮箱可以接收~</strong></span></p> 
<p><span style="font-family:Verdana,Arial,Helvetica,sans-serif; color:#333333"><span style="font-size:14px; line-height:27.765625px">网易邮箱报异常解决：</span></span></p> 
<p><span style="font-family:Verdana,Arial,Helvetica,sans-serif"><span style="font-size:14px; line-height:27.765625px"><span style="color:#333333"> </span><span style="color:#ff0000">javax.mail.AuthenticationFailedException: 550 User has no permission</span><br> </span></span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px">网易邮箱能发送，需要去网易邮箱界面进行设置：</span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px">1）登录自己的163邮箱，注意，要用你的应用程序中设置的邮箱地址去登录。<br> </span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px">2）在主菜单栏上的“设置”子菜单里面，选择POP3/SMTP/IAMP菜单。</span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"><img src="https://images2.imgbox.com/fe/d9/DAnDXDzi_o.png" alt=""><br> </span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px">3）若没有开启“客户端授权密码”，则选择将其开启。开启后，会给你生成一个应用授权密码。要用这个生成的密码作为java mail API发送邮件的认证密码，如此，才能解除500密码，若用邮箱的登录密码去设置这个认证密码，会遇到550的错误。下图是开启“客户端授权密码”功能后的截图：</span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"><img src="https://images2.imgbox.com/df/37/R7PRKGxZ_o.png" alt=""><br> </span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"><strong>2、但是，第二个内嵌图片时，QQ邮箱是不支持的，网易邮箱是支持的~</strong></span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"><strong>3、第四个内嵌图片和附件组合QQ邮箱支持的，网易邮箱是不支持的~</strong></span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px">网易邮箱显示结果：（把文本、照片、2个附件4个全部弄成附件了）</span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"><img src="https://images2.imgbox.com/54/09/93jI6NAP_o.png" alt=""><br> </span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"><br> </span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px">QQ邮箱显示结果：</span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"><img src="https://images2.imgbox.com/05/ba/cJUS4QpH_o.png" alt=""><br> </span></p> 
<p><br> </p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px">望大家给予帮助解决这三个问题，小弟在此感激不尽~</span></p> 
<p><span style="color:rgb(51,51,51); font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px; line-height:27.765625px"><br> </span></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4f4b857385120f5dc3169f144915fc46/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Caffe学习系列(17)：模型各层特征和过滤器可视化</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fef18fcad8f22f530bf8549f3f00a763/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">使用gdal ogr创建shapefile文件（c&#43;&#43;）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>