<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Mybatis之使用 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Mybatis之使用" />
<meta property="og:description" content="Mybatis之使用 一、Mybatis是什么？二、小试牛刀1.创建表2.新建maven项目并导入依赖3.编写mybaitis的配置文件4.编写实体类5.编写ORM映射文件6.在mybatis配置文件注册映射文件6.1映射文件放置在哪 7.编写测试方法 三、对象分析1.Resources2.SqlSessionFactoryBuilder3.SqlSessionFactory4.SqlSession5.执行过程 四、配置日志文件1.添加jar依赖2.添加日志配置文件3.结果展示 五、使用Mapper的接口编写Mybatis项目1.编写StudentMapper.java2.编写StudentMapper.xml3.在mybatis.xml中配置映射文件4.编写测试类5.展示结果6.getMapper实现原理 六、映射文件编写1.获取自增主键1.1正常返回1.1.1向StudentMapper.java添加方法1.1.2向StudentMapper.xml添加sql语句1.1.3编写测试方法1.1.4展示结果 1.2主键为数字自增11.2.1修改StudentMapper.xml1.2.2展示结果 1.3主键为数字自增21.3.1修改StudentMapper.xml1.2.3展示结果 1.4主键为varchar类型获取1.4.1 新建表1.4.2 复制Student.java并修改1.4.3 向StudentMapper.java添加方法1.4.3 修改StudentMapper.xml1.4.4 添加测试方法1.4.5 展示结果 七、映射1. 输入映射parameterType1.1 单个参数1.2 多个参数指定参数名1.2 多个参数不指定参数名 2.输出映射1.1resultType1.1.1输出基本类型1.1.2输出pojo类型1.1.3输出Map类型 1.2数据库与列名不一致1.1.1使用别名1.1.2使用resultMap 1.3resultMap 3. #{} 和 ${}的区别1.1 #{}1.2${} 八、全局配置文件1.文件头部约束2.配置文件内容3.自定义别名4.Mappers5.事务 九、映射关系1.多对一2.一对多 十、动态SQL1.where2.set3. forEach 十一、分页插件1.引入依赖2.配置插件3.测试方法 十二、Mybatis缓存简介1.作用2.一级缓存3.二级缓存 一、Mybatis是什么？ Mybatis是一个基于Java的持久层框架，内部封装类JDBC，让开发人员只需要关注sql语句本身，不需要花费精力在驱动的加载、连接的创建、Statement的创建等复杂的过程。Mybatis通过XML或注解的方式将要执行的各种statement配置起来，并通过Java对象和statement中的sql动态参数进行映射生成最终执行的sql语句，最后由mybatis框架执行sql语句，并将结果直接映射为Java对象。
Mybatis采用ORM（对象关系映射）思想解决了实体类和数据库表映射的问题。对JDBC进行了封装，屏蔽了JDBC API底层的访问细节。
二、小试牛刀 1.创建表 CREATE TABLE `student` ( `studentid` int NOT NULL AUTO_INCREMENT, `studentname` varchar(10) NOT NULL, `studentsex` varchar(5) NOT NULL, `studentage` int(5) NOT NULL, `studenttel` varchar(20) NOT NULL, PRIMARY KEY (`studentid`) USING BTREE ) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=COMPACT; 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/56909dcfc229f7fdeac2f42d632010bb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-11T22:52:57+08:00" />
<meta property="article:modified_time" content="2021-11-11T22:52:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Mybatis之使用</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Mybatis之使用</h4> 
 <ul><li><a href="#Mybatis_8" rel="nofollow">一、Mybatis是什么？</a></li><li><a href="#_15" rel="nofollow">二、小试牛刀</a></li><li><ul><li><a href="#1_16" rel="nofollow">1.创建表</a></li><li><a href="#2maven_28" rel="nofollow">2.新建maven项目并导入依赖</a></li><li><a href="#3mybaitis_49" rel="nofollow">3.编写mybaitis的配置文件</a></li><li><a href="#4_74" rel="nofollow">4.编写实体类</a></li><li><a href="#5ORM_87" rel="nofollow">5.编写ORM映射文件</a></li><li><a href="#6mybatis_105" rel="nofollow">6.在mybatis配置文件注册映射文件</a></li><li><ul><li><a href="#61_113" rel="nofollow">6.1映射文件放置在哪</a></li></ul> 
   </li><li><a href="#7_142" rel="nofollow">7.编写测试方法</a></li></ul> 
  </li><li><a href="#_157" rel="nofollow">三、对象分析</a></li><li><ul><li><a href="#1Resources_158" rel="nofollow">1.Resources</a></li><li><a href="#2SqlSessionFactoryBuilder_160" rel="nofollow">2.SqlSessionFactoryBuilder</a></li><li><a href="#3SqlSessionFactory_162" rel="nofollow">3.SqlSessionFactory</a></li><li><a href="#4SqlSession_164" rel="nofollow">4.SqlSession</a></li><li><a href="#5_167" rel="nofollow">5.执行过程</a></li></ul> 
  </li><li><a href="#_175" rel="nofollow">四、配置日志文件</a></li><li><ul><li><a href="#1jar_176" rel="nofollow">1.添加jar依赖</a></li><li><a href="#2_185" rel="nofollow">2.添加日志配置文件</a></li><li><a href="#3_193" rel="nofollow">3.结果展示</a></li></ul> 
  </li><li><a href="#MapperMybatis_195" rel="nofollow">五、使用Mapper的接口编写Mybatis项目</a></li><li><ul><li><a href="#1StudentMapperjava_196" rel="nofollow">1.编写StudentMapper.java</a></li><li><a href="#2StudentMapperxml_203" rel="nofollow">2.编写StudentMapper.xml</a></li><li><a href="#3mybatisxml_216" rel="nofollow">3.在mybatis.xml中配置映射文件</a></li><li><a href="#4_223" rel="nofollow">4.编写测试类</a></li><li><a href="#5_245" rel="nofollow">5.展示结果</a></li><li><a href="#6getMapper_247" rel="nofollow">6.getMapper实现原理</a></li></ul> 
  </li><li><a href="#_252" rel="nofollow">六、映射文件编写</a></li><li><ul><li><a href="#1_253" rel="nofollow">1.获取自增主键</a></li><li><ul><li><a href="#11_255" rel="nofollow">1.1正常返回</a></li><li><ul><li><a href="#111StudentMapperjava_257" rel="nofollow">1.1.1向StudentMapper.java添加方法</a></li><li><a href="#112StudentMapperxmlsql_261" rel="nofollow">1.1.2向StudentMapper.xml添加sql语句</a></li><li><a href="#113_268" rel="nofollow">1.1.3编写测试方法</a></li><li><a href="#114_286" rel="nofollow">1.1.4展示结果</a></li></ul> 
    </li><li><a href="#121_290" rel="nofollow">1.2主键为数字自增1</a></li><li><ul><li><a href="#121StudentMapperxml_291" rel="nofollow">1.2.1修改StudentMapper.xml</a></li><li><a href="#122_303" rel="nofollow">1.2.2展示结果</a></li></ul> 
    </li><li><a href="#132_306" rel="nofollow">1.3主键为数字自增2</a></li><li><ul><li><a href="#131StudentMapperxml_307" rel="nofollow">1.3.1修改StudentMapper.xml</a></li><li><a href="#123_323" rel="nofollow">1.2.3展示结果</a></li></ul> 
    </li><li><a href="#14varchar_325" rel="nofollow">1.4主键为varchar类型获取</a></li><li><ul><li><a href="#141__326" rel="nofollow">1.4.1 新建表</a></li><li><a href="#142_Studentjava_338" rel="nofollow">1.4.2 复制Student.java并修改</a></li><li><a href="#143_StudentMapperjava_350" rel="nofollow">1.4.3 向StudentMapper.java添加方法</a></li><li><a href="#143_StudentMapperxml_357" rel="nofollow">1.4.3 修改StudentMapper.xml</a></li><li><a href="#144__372" rel="nofollow">1.4.4 添加测试方法</a></li><li><a href="#145__391" rel="nofollow">1.4.5 展示结果</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#_393" rel="nofollow">七、映射</a></li><li><ul><li><a href="#1_parameterType_394" rel="nofollow">1. 输入映射parameterType</a></li><li><ul><li><a href="#11__396" rel="nofollow">1.1 单个参数</a></li><li><ul><li><a href="#12__421" rel="nofollow">1.2 多个参数指定参数名</a></li><li><a href="#12__447" rel="nofollow">1.2 多个参数不指定参数名</a></li></ul> 
   </li></ul> 
   </li><li><a href="#2_475" rel="nofollow">2.输出映射</a></li><li><ul><li><a href="#11resultType_476" rel="nofollow">1.1resultType</a></li><li><ul><li><a href="#111_478" rel="nofollow">1.1.1输出基本类型</a></li><li><a href="#112pojo_499" rel="nofollow">1.1.2输出pojo类型</a></li><li><a href="#113Map_501" rel="nofollow">1.1.3输出Map类型</a></li></ul> 
    </li><li><a href="#12_524" rel="nofollow">1.2数据库与列名不一致</a></li><li><ul><li><a href="#111_525" rel="nofollow">1.1.1使用别名</a></li><li><a href="#112resultMap_526" rel="nofollow">1.1.2使用resultMap</a></li></ul> 
    </li><li><a href="#13resultMap_527" rel="nofollow">1.3resultMap</a></li></ul> 
   </li><li><a href="#3_____551" rel="nofollow">3. #{} 和 ${}的区别</a></li><li><ul><li><a href="#11__552" rel="nofollow">1.1 #{}</a></li><li><a href="#12_554" rel="nofollow">1.2${}</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_580" rel="nofollow">八、全局配置文件</a></li><li><ul><li><a href="#1_581" rel="nofollow">1.文件头部约束</a></li><li><a href="#2_588" rel="nofollow">2.配置文件内容</a></li><li><a href="#3_604" rel="nofollow">3.自定义别名</a></li><li><a href="#4Mappers_615" rel="nofollow">4.Mappers</a></li><li><a href="#5_639" rel="nofollow">5.事务</a></li></ul> 
  </li><li><a href="#_645" rel="nofollow">九、映射关系</a></li><li><ul><li><a href="#1_685" rel="nofollow">1.多对一</a></li><li><a href="#2_716" rel="nofollow">2.一对多</a></li></ul> 
  </li><li><a href="#SQL_741" rel="nofollow">十、动态SQL</a></li><li><ul><li><a href="#1where_743" rel="nofollow">1.where</a></li><li><a href="#2set_765" rel="nofollow">2.set</a></li><li><a href="#3_forEach_784" rel="nofollow">3. forEach</a></li></ul> 
  </li><li><a href="#_797" rel="nofollow">十一、分页插件</a></li><li><ul><li><a href="#1_798" rel="nofollow">1.引入依赖</a></li><li><a href="#2_807" rel="nofollow">2.配置插件</a></li><li><a href="#3_815" rel="nofollow">3.测试方法</a></li></ul> 
  </li><li><a href="#Mybatis_832" rel="nofollow">十二、Mybatis缓存简介</a></li><li><ul><li><a href="#1_833" rel="nofollow">1.作用</a></li><li><a href="#2_835" rel="nofollow">2.一级缓存</a></li><li><a href="#3_845" rel="nofollow">3.二级缓存</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr color="#000000" size='1"'> 
<h2><a id="Mybatis_8"></a>一、Mybatis是什么？</h2> 
<p>Mybatis是一个基于Java的持久层框架，内部封装类JDBC，让开发人员只需要关注sql语句本身，不需要花费精力在驱动的加载、连接的创建、Statement的创建等复杂的过程。Mybatis通过XML或注解的方式将要执行的各种statement配置起来，并通过Java对象和statement中的sql动态参数进行映射生成最终执行的sql语句，最后由mybatis框架执行sql语句，并将结果直接映射为Java对象。<br> Mybatis采用ORM（对象关系映射）思想解决了实体类和数据库表映射的问题。对JDBC进行了封装，屏蔽了JDBC API底层的访问细节。</p> 
<h2><a id="_15"></a>二、小试牛刀</h2> 
<h3><a id="1_16"></a>1.创建表</h3> 
<pre><code class="prism language-java">CREATE TABLE `student` <span class="token punctuation">(</span>
  `studentid` <span class="token keyword">int</span> NOT <span class="token class-name">NULL</span> AUTO_INCREMENT<span class="token punctuation">,</span>
  `studentname` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `studentsex` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `studentage` <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `studenttel` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  <span class="token class-name">PRIMARY</span> KEY <span class="token punctuation">(</span>`studentid`<span class="token punctuation">)</span> <span class="token class-name">USING</span> BTREE
<span class="token punctuation">)</span> ENGINE<span class="token operator">=</span><span class="token class-name">InnoDB</span> <span class="token class-name">DEFAULT</span> CHARSET<span class="token operator">=</span>utf8 ROW_FORMAT<span class="token operator">=</span>COMPACT<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="2maven_28"></a>2.新建maven项目并导入依赖</h3> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.25<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.5.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3><a id="3mybaitis_49"></a>3.编写mybaitis的配置文件</h3> 
<p>配置文件头可以在Mybatis参考文档查找<br> <a href="https://mybatis.org/mybatis-3/zh/getting-started.html" rel="nofollow">Mybatis参考文档</a></p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span> <span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE configuration
        PUBLIC <span class="token string">"-//mybatis.org//DTD Config 3.0//EN"</span>
        <span class="token string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span><span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>configuration<span class="token punctuation">&gt;</span></span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>配置mybatis的环境<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>environments <span class="token keyword">default</span><span class="token operator">=</span><span class="token string">"dev"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>environment id<span class="token operator">=</span><span class="token string">"dev"</span><span class="token operator">&gt;</span>
        	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>事务类型<span class="token operator">--</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>transactionManager type<span class="token operator">=</span><span class="token string">"JDBC"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>transactionManager<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>使用连接池<span class="token operator">--</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>dataSource type<span class="token operator">=</span><span class="token string">"POOLED"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"driver"</span> value<span class="token operator">=</span><span class="token string">"com.mysql.cj.jdbc.Driver"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"url"</span> value<span class="token operator">=</span><span class="token string">"jdbc:mysql://127.0.0.1:3306/dm?useUnicode=true&amp;amp;characterEncoding=utf-8&amp;amp;useSSL=false&amp;amp;serverTimezone=GMT"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"username"</span> value<span class="token operator">=</span><span class="token string">"root"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"password"</span> value<span class="token operator">=</span><span class="token string">"root"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>dataSource<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>environment<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>environments<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="4_74"></a>4.编写实体类</h3> 
<p>实体类中属性需要和表的列名保持一致</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> studentId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> studentName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> studentSex<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> studentAge<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> studentTel<span class="token punctuation">;</span>
    <span class="token comment">//setter、getter、toString</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="5ORM_87"></a>5.编写ORM映射文件</h3> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span> <span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE mapper
        PUBLIC <span class="token string">"-//mybatis.org//DTD Mapper 3.0//EN"</span>
        <span class="token string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>mapper namespace<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token class-name">MappedStatement</span>
		id：<span class="token class-name">MappedStatement</span>名称
		resultType：返回值类型
		parameterType：参数类型
	<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectAll"</span> parameterType<span class="token operator">=</span><span class="token string">"int"</span> resultType<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span><span class="token operator">&gt;</span>
        select <span class="token operator">*</span> from student
    <span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>mapper<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="6mybatis_105"></a>6.在mybatis配置文件注册映射文件</h3> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>environments下方<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>mappers<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span>mapper resource<span class="token operator">=</span><span class="token string">"com/dmlll/pojo/Student.xml"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>mapper<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>mappers<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="61_113"></a>6.1映射文件放置在哪</h4> 
<ol><li>Student.xml可以放在与实体类同一目录，但是此时需要在pom.xml中添加一段配置</li></ol> 
<pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>build<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>resources<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>resource<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>directory<span class="token punctuation">&gt;</span></span>src<span class="token operator">/</span>main<span class="token operator">/</span>java<span class="token operator">&lt;</span><span class="token operator">/</span>directory<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>includes<span class="token punctuation">&gt;</span></span>
                <span class="token generics"><span class="token punctuation">&lt;</span>include<span class="token punctuation">&gt;</span></span><span class="token operator">*</span><span class="token operator">*</span><span class="token comment">/*.xml&lt;/include&gt;&lt;!--正常maven项目只在resources下加载配置文件，如果想要放在main下，则需让他加载--&gt;
            &lt;/includes&gt;
        &lt;/resource&gt;
    &lt;/resources&gt;
&lt;/build&gt;
</span></code></pre> 
<p><img src="https://images2.imgbox.com/4c/44/6egxOMGP_o.png" alt="在这里插入图片描述"><br> 2. 可以放在resources目录下与Java目录相同<br> <img src="https://images2.imgbox.com/9d/84/DqsZLgkE_o.png" alt="在这里插入图片描述"></p> 
<ol start="3"><li>也可以直接放在resources目录下<br> <img src="https://images2.imgbox.com/15/e7/q7mOgquR_o.png" alt="在这里插入图片描述"></li></ol> 
<p>此时在mybatis配置文件配置时resource需要改变</p> 
<pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>mappers<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span>mapper resource<span class="token operator">=</span><span class="token string">"Student.xml"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>mapper<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>mappers<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="7_142"></a>7.编写测试方法</h3> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Reader</span> reader <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsReader</span><span class="token punctuation">(</span><span class="token string">"mybatis.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">SqlSessionFactory</span> sessionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">SqlSession</span> session <span class="token operator">=</span> sessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//命名空间+MappedStatement名称</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> students <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token string">"com.dmlll.pojo.Student.selectAll"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    students<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>student <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>添条数据测试<br> <img src="https://images2.imgbox.com/9c/a4/aBC6sPhu_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_157"></a>三、对象分析</h2> 
<h3><a id="1Resources_158"></a>1.Resources</h3> 
<p>读取资源文件</p> 
<h3><a id="2SqlSessionFactoryBuilder_160"></a>2.SqlSessionFactoryBuilder</h3> 
<p>创建SqlSessionFactory，使用他的build()方法。</p> 
<h3><a id="3SqlSessionFactory_162"></a>3.SqlSessionFactory</h3> 
<p>SqlSessionFactory接口对象是一个重量级对象，是线程安全的，所以一个应用只需要一个该对象即可。创建SqlSession需要使用SqlsessionFactory接口的openSession()方法</p> 
<h3><a id="4SqlSession_164"></a>4.SqlSession</h3> 
<p>SqlSession接口对象用于执行持久化操作。一个SqlSession对应着一次数据库会话，一次会话以SqlSession对象的创建开始，以SqlSession对象的关闭结束。<br> SqlSession接口对象是线程不安全的，所以每次数据库会话结束前，需要马上调用其close()方法，将其关闭。再次需要会话，再次创建。</p> 
<h3><a id="5_167"></a>5.执行过程</h3> 
<ol><li>Mybatis.xml文件是mybatis的全局配置文件，配置了mybatis框架运行的环境等信息。<br> 映射文件配置了所有操作数据库的sql语句，这些文件也会随着配置文件中加载</li><li>通过mybatis环境等配置信息构建SqlSessionFactory，相当于产生了连接池</li><li>由会话工厂创建SqlSession即会话，操作数据库需要通过SqlSession进行</li><li>Mybatis底层自定义了Executor执行器的接口操作数据库，Executor接口有两个实现，一个是基本的执行器，一个是缓存的执行器</li><li>MappedStatement也是mybatis框架一个底层的封装对象，他包装了mybaits配置信息以及sql的映射信息。Mapper.xml文件是一个文件中一个sql语句对应一个MappedStatement对象，sql的id就是MappedStatement的id</li><li>MappedStatement对sql执行输入参数的定义，输入参数包括HashMap、基本类型、pojo，Executor通过MappedStatement在执行sql语句前将输入java对象映射到sql语句中，执行sql完毕后，输出映射就是JDBC编码中的对preparedStatement执行结果的定义</li></ol> 
<h2><a id="_175"></a>四、配置日志文件</h2> 
<h3><a id="1jar_176"></a>1.添加jar依赖</h3> 
<pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>log4j<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>log4j<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.2</span><span class="token number">.17</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="2_185"></a>2.添加日志配置文件</h3> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>environments之前<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>settings<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span>setting name<span class="token operator">=</span><span class="token string">"logImpl"</span> value<span class="token operator">=</span><span class="token string">"log4j"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>settings<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="3_193"></a>3.结果展示</h3> 
<p><img src="https://images2.imgbox.com/03/32/DFbSekJR_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="MapperMybatis_195"></a>五、使用Mapper的接口编写Mybatis项目</h2> 
<h3><a id="1StudentMapperjava_196"></a>1.编写StudentMapper.java</h3> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">StudentMapper</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="2StudentMapperxml_203"></a>2.编写StudentMapper.xml</h3> 
<p>注意：此时的命名空间跟Student.xml不同</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span> <span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE mapper
        PUBLIC <span class="token string">"-//mybatis.org//DTD Mapper 3.0//EN"</span>
        <span class="token string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>mapper namespace<span class="token operator">=</span><span class="token string">"com.dmlll.mapper.StudentMapper"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectAll"</span> resultType<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span><span class="token operator">&gt;</span>
        select <span class="token operator">*</span> from student
    <span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>mapper<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="3mybatisxml_216"></a>3.在mybatis.xml中配置映射文件</h3> 
<pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>mappers<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span>mapper resource<span class="token operator">=</span><span class="token string">"StudentMapper.xml"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>mapper<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>mappers<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="4_223"></a>4.编写测试类</h3> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tests2</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Before</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Reader</span> reader <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsReader</span><span class="token punctuation">(</span><span class="token string">"mybatis.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SqlSessionFactory</span> build <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSession <span class="token operator">=</span> build<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//通过SqlSession获得mapper，动态代理获得一个接口的实现类</span>
        <span class="token class-name">StudentMapper</span> mapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">StudentMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//调用实现类方法</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> students <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        students<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>student <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSession<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="5_245"></a>5.展示结果</h3> 
<p><img src="https://images2.imgbox.com/02/fb/bika3aZM_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="6getMapper_247"></a>6.getMapper实现原理</h3> 
<p><img src="https://images2.imgbox.com/14/f9/9evMUvHJ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/70/9e/enudqHhz_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d0/8b/RxwCodUl_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/07/e4/ta5G2gKg_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_252"></a>六、映射文件编写</h2> 
<h3><a id="1_253"></a>1.获取自增主键</h3> 
<p>前提：主键自增</p> 
<h4><a id="11_255"></a>1.1正常返回</h4> 
<p>实体类就使用之前的Student</p> 
<h5><a id="111StudentMapperjava_257"></a>1.1.1向StudentMapper.java添加方法</h5> 
<pre><code class="prism language-java"><span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Student</span> student<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="112StudentMapperxmlsql_261"></a>1.1.2向StudentMapper.xml添加sql语句</h5> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>insert id<span class="token operator">=</span><span class="token string">"add"</span> parameterType<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span><span class="token operator">&gt;</span>
    INSERT INTO `dm`<span class="token punctuation">.</span>`student` <span class="token punctuation">(</span>`studentname`<span class="token punctuation">,</span> `studentsex`<span class="token punctuation">,</span> `studentage`<span class="token punctuation">,</span> `studenttel`<span class="token punctuation">)</span>
    VALUES <span class="token punctuation">(</span>#<span class="token punctuation">{<!-- --></span>studentName<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>studentSex<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>studentAge<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>studentTel<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>insert<span class="token operator">&gt;</span>
</code></pre> 
<h5><a id="113_268"></a>1.1.3编写测试方法</h5> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//通过SqlSession获得mapper，动态代理获得一个接口的实现类</span>
    <span class="token class-name">StudentMapper</span> mapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">StudentMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//调用实现类方法</span>
    <span class="token class-name">Student</span> student <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    student<span class="token punctuation">.</span><span class="token function">setStudentAge</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    student<span class="token punctuation">.</span><span class="token function">setStudentName</span><span class="token punctuation">(</span><span class="token string">"红孩儿"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    student<span class="token punctuation">.</span><span class="token function">setStudentSex</span><span class="token punctuation">(</span><span class="token string">"男"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    student<span class="token punctuation">.</span><span class="token function">setStudentTel</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sqlSession<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="114_286"></a>1.1.4展示结果</h5> 
<p>主键依旧为空<br> <img src="https://images2.imgbox.com/fb/3f/kAWXL4kP_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="121_290"></a>1.2主键为数字自增1</h4> 
<h5><a id="121StudentMapperxml_291"></a>1.2.1修改StudentMapper.xml</h5> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>
useGeneratedKeys：表示生成主键
keyProperty：主键填充到pojo的哪个字段
<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>insert id<span class="token operator">=</span><span class="token string">"add"</span> parameterType<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span> useGeneratedKeys<span class="token operator">=</span><span class="token string">"true"</span> keyProperty<span class="token operator">=</span><span class="token string">"studentId"</span><span class="token operator">&gt;</span>
    INSERT INTO `dm`<span class="token punctuation">.</span>`student` <span class="token punctuation">(</span>`studentname`<span class="token punctuation">,</span> `studentsex`<span class="token punctuation">,</span> `studentage`<span class="token punctuation">,</span> `studenttel`<span class="token punctuation">)</span>
    VALUES <span class="token punctuation">(</span>#<span class="token punctuation">{<!-- --></span>studentName<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>studentSex<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>studentAge<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>studentTel<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>insert<span class="token operator">&gt;</span>
</code></pre> 
<h5><a id="122_303"></a>1.2.2展示结果</h5> 
<p>其他不变，只改变mapper，可以看到主键被填充了<br> <img src="https://images2.imgbox.com/56/3a/mby0ET9o_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="132_306"></a>1.3主键为数字自增2</h4> 
<h5><a id="131StudentMapperxml_307"></a>1.3.1修改StudentMapper.xml</h5> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>
selectKey：声明在添加语句执行前后查询最后插入的id，返回到哪
keyProperty：返回到pojo的studentId
order：在插入语句之后执行（<span class="token class-name">Mysql</span>是先插入在生成主键）
<span class="token function">last_insert_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：mysql内置函数，查询最后插入的主键
<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>insert id<span class="token operator">=</span><span class="token string">"add"</span> parameterType<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>selectKey keyProperty<span class="token operator">=</span><span class="token string">"studentId"</span> order<span class="token operator">=</span><span class="token string">"AFTER"</span> resultType<span class="token operator">=</span><span class="token string">"java.lang.Integer"</span><span class="token operator">&gt;</span>
        select <span class="token function">last_insert_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>selectKey<span class="token operator">&gt;</span>
    INSERT INTO `dm`<span class="token punctuation">.</span>`student` <span class="token punctuation">(</span>`studentname`<span class="token punctuation">,</span> `studentsex`<span class="token punctuation">,</span> `studentage`<span class="token punctuation">,</span> `studenttel`<span class="token punctuation">)</span>
    VALUES <span class="token punctuation">(</span>#<span class="token punctuation">{<!-- --></span>studentName<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>studentSex<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>studentAge<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>studentTel<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="123_323"></a>1.2.3展示结果</h5> 
<p><img src="https://images2.imgbox.com/06/e5/oOIamZMb_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="14varchar_325"></a>1.4主键为varchar类型获取</h4> 
<h5><a id="141__326"></a>1.4.1 新建表</h5> 
<pre><code class="prism language-java">CREATE TABLE `student2` <span class="token punctuation">(</span>
  `studentid` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL <span class="token punctuation">,</span>
  `studentname` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `studentsex` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `studentage` <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `studenttel` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  <span class="token class-name">PRIMARY</span> KEY <span class="token punctuation">(</span>`studentid`<span class="token punctuation">)</span> <span class="token class-name">USING</span> BTREE
<span class="token punctuation">)</span> ENGINE<span class="token operator">=</span><span class="token class-name">InnoDB</span> <span class="token class-name">DEFAULT</span> CHARSET<span class="token operator">=</span>utf8 ROW_FORMAT<span class="token operator">=</span>COMPACT<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="142_Studentjava_338"></a>1.4.2 复制Student.java并修改</h5> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student2</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> studentId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> studentName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> studentSex<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> studentAge<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> studentTel<span class="token punctuation">;</span>
    <span class="token comment">//setter、getter、toString</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="143_StudentMapperjava_350"></a>1.4.3 向StudentMapper.java添加方法</h5> 
<p>一般一个Mapper对一个pojo操作，这里偷点懒在一个Mapper进行操作</p> 
<pre><code class="prism language-java">    <span class="token keyword">int</span> <span class="token function">add2</span><span class="token punctuation">(</span><span class="token class-name">Student2</span> student2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="143_StudentMapperxml_357"></a>1.4.3 修改StudentMapper.xml</h5> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>
插入之前先获取<span class="token number">36</span>位字符串存在studentId
因为主键不是数字自增，所以需要先获取主键，然后添加
<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>insert id<span class="token operator">=</span><span class="token string">"add2"</span> parameterType<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student2"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>selectKey keyProperty<span class="token operator">=</span><span class="token string">"studentId"</span> order<span class="token operator">=</span><span class="token string">"BEFORE"</span> resultType<span class="token operator">=</span><span class="token string">"java.lang.String"</span><span class="token operator">&gt;</span>
        select <span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>selectKey<span class="token operator">&gt;</span>
    INSERT INTO `dm`<span class="token punctuation">.</span>`student2` <span class="token punctuation">(</span>`studentid`<span class="token punctuation">,</span>`studentname`<span class="token punctuation">,</span> `studentsex`<span class="token punctuation">,</span> `studentage`<span class="token punctuation">,</span> `studenttel`<span class="token punctuation">)</span>
    VALUES <span class="token punctuation">(</span>#<span class="token punctuation">{<!-- --></span>studentId<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>studentName<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>studentSex<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>studentAge<span class="token punctuation">}</span><span class="token punctuation">,</span> #<span class="token punctuation">{<!-- --></span>studentTel<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>insert<span class="token operator">&gt;</span>
</code></pre> 
<h5><a id="144__372"></a>1.4.4 添加测试方法</h5> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//通过SqlSession获得mapper，动态代理获得一个接口的实现类</span>
    <span class="token class-name">StudentMapper</span> mapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">StudentMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//调用实现类方法</span>
    <span class="token class-name">Student2</span> student <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    student<span class="token punctuation">.</span><span class="token function">setStudentAge</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    student<span class="token punctuation">.</span><span class="token function">setStudentName</span><span class="token punctuation">(</span><span class="token string">"红孩儿"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    student<span class="token punctuation">.</span><span class="token function">setStudentSex</span><span class="token punctuation">(</span><span class="token string">"男"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    student<span class="token punctuation">.</span><span class="token function">setStudentTel</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> res <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">add2</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sqlSession<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"结果条数："</span><span class="token operator">+</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"student："</span><span class="token operator">+</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="145__391"></a>1.4.5 展示结果</h5> 
<p><img src="https://images2.imgbox.com/62/7d/mCzBwU4N_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_393"></a>七、映射</h2> 
<h3><a id="1_parameterType_394"></a>1. 输入映射parameterType</h3> 
<p>parameterType：接口中方法参数的类型，类型必须是完全限定名或者别名。该属性非必须，因为Mybatis能够自行推断出传入参数的类型</p> 
<h4><a id="11__396"></a>1.1 单个参数</h4> 
<p>单个参数直接指定参数即可</p> 
<pre><code class="prism language-java"><span class="token class-name">Student</span> <span class="token function">selectById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>mapper中parameterType可省略，传递的参数名随便写也可以</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectById"</span> resultType<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span><span class="token operator">&gt;</span>
    select <span class="token operator">*</span> from student where studentid <span class="token operator">=</span> #<span class="token punctuation">{<!-- --></span>abc<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
</code></pre> 
<p>编写测试方法</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//通过SqlSession获得mapper，动态代理获得一个接口的实现类</span>
    <span class="token class-name">StudentMapper</span> mapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">StudentMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Student</span> student <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectById</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>查看结果<br> <img src="https://images2.imgbox.com/07/07/9fkrZ70b_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="12__421"></a>1.2 多个参数指定参数名</h5> 
<p>多个参数如果要指定参数名则需要使用@Param注解</p> 
<pre><code class="prism language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectByNameAndAge</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>concat连接字符串<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectByNameAndAge"</span> resultType<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span><span class="token operator">&gt;</span>
    select <span class="token operator">*</span> from student where studentname like <span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">'%'</span><span class="token punctuation">,</span>#<span class="token punctuation">{<!-- --></span>name<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">)</span> and studentage<span class="token operator">&gt;</span> #<span class="token punctuation">{<!-- --></span>age<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test5</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//通过SqlSession获得mapper，动态代理获得一个接口的实现类</span>
    <span class="token class-name">StudentMapper</span> mapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">StudentMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> students <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectByNameAndAge</span><span class="token punctuation">(</span><span class="token string">"红"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Student</span> student <span class="token operator">:</span> students<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d6/01/kc6kdwaC_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="12__447"></a>1.2 多个参数不指定参数名</h5> 
<pre><code class="prism language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectByNameAndAge2</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token class-name">Integer</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>此时在使用之前指定的名称则会报错</p> 
<pre><code class="prism language-java"><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span></span>PersistenceException</span><span class="token operator">:</span> 
### <span class="token class-name">Error</span> querying <span class="token class-name"><span class="token namespace">database<span class="token punctuation">.</span></span>  Cause</span><span class="token operator">:</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>binding<span class="token punctuation">.</span></span>BindingException</span><span class="token operator">:</span> <span class="token class-name">Parameter</span> <span class="token string">'name'</span> not <span class="token class-name"><span class="token namespace">found<span class="token punctuation">.</span></span> Available</span> parameters are <span class="token punctuation">[</span>arg1<span class="token punctuation">,</span> arg0<span class="token punctuation">,</span> param1<span class="token punctuation">,</span> param2<span class="token punctuation">]</span>
### <span class="token class-name">Cause</span><span class="token operator">:</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>binding<span class="token punctuation">.</span></span>BindingException</span><span class="token operator">:</span> <span class="token class-name">Parameter</span> <span class="token string">'name'</span> not <span class="token class-name"><span class="token namespace">found<span class="token punctuation">.</span></span> Available</span> parameters are <span class="token punctuation">[</span>arg1<span class="token punctuation">,</span> arg0<span class="token punctuation">,</span> param1<span class="token punctuation">,</span> param2<span class="token punctuation">]</span>

</code></pre> 
<p>报错信息告诉我们可以使用[arg1, arg0, param1, param2]表示。<br> 尝试一下</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectByNameAndAge2"</span> resultType<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span><span class="token operator">&gt;</span>
    select <span class="token operator">*</span> from student where studentname like <span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">'%'</span><span class="token punctuation">,</span>#<span class="token punctuation">{<!-- --></span>arg0<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">)</span> and studentage <span class="token operator">&gt;</span> #<span class="token punctuation">{<!-- --></span>arg1<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
</code></pre> 
<p>可以得到正确的结果</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectByNameAndAge2"</span> resultType<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span><span class="token operator">&gt;</span>
    select <span class="token operator">*</span> from student where studentname like <span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">'%'</span><span class="token punctuation">,</span>#<span class="token punctuation">{<!-- --></span>param1<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">)</span> and studentage <span class="token operator">&gt;</span> #<span class="token punctuation">{<!-- --></span>param2<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
</code></pre> 
<p>这种的也可以</p> 
<h3><a id="2_475"></a>2.输出映射</h3> 
<h4><a id="11resultType_476"></a>1.1resultType</h4> 
<p>resultType：执行sql得到ResultSet转换的类型，使用类型的完全限定名或者别名。如果返回的是集合，设置集合元素的类型，而不是集合本身。</p> 
<h5><a id="111_478"></a>1.1.1输出基本类型</h5> 
<pre><code class="prism language-java"><span class="token keyword">int</span> <span class="token function">selectCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectCount"</span> resultType<span class="token operator">=</span><span class="token string">"java.lang.Integer"</span><span class="token operator">&gt;</span>
    select <span class="token function">count</span><span class="token punctuation">(</span>studentid<span class="token punctuation">)</span> from student
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test8</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">StudentMapper</span> mapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">StudentMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> students <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>students<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f0/4b/bq4mdrhN_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="112pojo_499"></a>1.1.2输出pojo类型</h5> 
<p>之前已经演示，这里不在赘述</p> 
<h5><a id="113Map_501"></a>1.1.3输出Map类型</h5> 
<pre><code class="prism language-java"><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectStudentAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>查一条<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectStudentAll"</span> resultType<span class="token operator">=</span><span class="token string">"java.util.HashMap"</span><span class="token operator">&gt;</span>
    select <span class="token operator">*</span> from student limit <span class="token number">1</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test9</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">StudentMapper</span> mapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">StudentMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> students <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectStudentAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>students<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e5/f6/diMDrYHE_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="12_524"></a>1.2数据库与列名不一致</h4> 
<h5><a id="111_525"></a>1.1.1使用别名</h5> 
<h5><a id="112resultMap_526"></a>1.1.2使用resultMap</h5> 
<h4><a id="13resultMap_527"></a>1.3resultMap</h4> 
<pre><code class="prism language-java">CREATE TABLE `student` <span class="token punctuation">(</span>
  `student_id` <span class="token keyword">int</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `student_name` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `student_sex` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `student_age` <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `student_tel` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  <span class="token class-name">PRIMARY</span> KEY <span class="token punctuation">(</span>`studentid`<span class="token punctuation">)</span> <span class="token class-name">USING</span> BTREE
<span class="token punctuation">)</span> ENGINE<span class="token operator">=</span><span class="token class-name">InnoDB</span> <span class="token class-name">DEFAULT</span> CHARSET<span class="token operator">=</span>utf8 ROW_FORMAT<span class="token operator">=</span>COMPACT<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectStudentAll"</span> resultMap<span class="token operator">=</span><span class="token string">"base"</span><span class="token operator">&gt;</span>
  select <span class="token operator">*</span> from student limit <span class="token number">1</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>resultMap id<span class="token operator">=</span><span class="token string">"base"</span> type<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>id property<span class="token operator">=</span><span class="token string">"studentId"</span> column<span class="token operator">=</span><span class="token string">"student_id"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result property<span class="token operator">=</span><span class="token string">"studentName"</span> column<span class="token operator">=</span><span class="token string">"student_name"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>resultMap<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="3_____551"></a>3. #{} 和 ${}的区别</h3> 
<h4><a id="11__552"></a>1.1 #{}</h4> 
<p>#{}：表示一个占位符，通知mybatis使用实际的值代替。并使用PreparedStatement对象执行sql语句。#{}代替了?。这个是mybatis的首选做法，安全迅速，避免sql注入。</p> 
<h4><a id="12_554"></a>1.2${}</h4> 
<p>${}：表示字符串原样替换，通知mybatis替换使用$包含的字符串，一般用在替换表名，列名，不同列排序等</p> 
<pre><code class="prism language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectByColumn</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"columnName"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> columnName<span class="token punctuation">,</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"columnValue"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> columnValue<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectByColumn"</span> resultType<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span><span class="token operator">&gt;</span>
    select <span class="token operator">*</span> from student where $<span class="token punctuation">{<!-- --></span>columnName<span class="token punctuation">}</span> like <span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">'%'</span><span class="token punctuation">,</span>#<span class="token punctuation">{<!-- --></span>columnValue<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test7</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//通过SqlSession获得mapper，动态代理获得一个接口的实现类</span>
    <span class="token class-name">StudentMapper</span> mapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">StudentMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> students <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectByColumn</span><span class="token punctuation">(</span><span class="token string">"studentname"</span><span class="token punctuation">,</span> <span class="token string">"红"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Student</span> student <span class="token operator">:</span> students<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/45/dc/HsvPBMxU_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_580"></a>八、全局配置文件</h2> 
<h3><a id="1_581"></a>1.文件头部约束</h3> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span> <span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE configuration
        PUBLIC <span class="token string">"-//mybatis.org//DTD Config 3.0//EN"</span>
        <span class="token string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span><span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="2_588"></a>2.配置文件内容</h3> 
<pre><code class="prism language-java">configuration（配置）
    properties<span class="token operator">--</span>属性：加载外部的配置文件，例如加载数据库的连接信息
    <span class="token class-name">Settings</span><span class="token operator">--</span>全局配置参数：例如日志配置
    typeAliases<span class="token operator">--</span>类型别名
    typeHandlers<span class="token operator">--</span><span class="token operator">--</span>类型处理器
    objectFactory<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>对象工厂
    <span class="token class-name">Plugins</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>插件：例如分页插件
    <span class="token class-name">Environments</span><span class="token operator">--</span><span class="token operator">--</span>环境集合属性对象
        environment（环境变量）
            transactionManager（事务管理器）
            dataSource（数据源）
    <span class="token class-name">Mappers</span><span class="token operator">--</span><span class="token operator">-</span>映射器：注册映射文件用
</code></pre> 
<h3><a id="3_604"></a>3.自定义别名</h3> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>自定义类型别名<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>typeAliases<span class="token punctuation">&gt;</span></span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>对单个的实体类定义别名<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>typeAlias type<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span> alias<span class="token operator">=</span><span class="token string">"Student"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>推荐写法：批量定义别名：扫描指定包下的所有类，同时别名定义为类名，别名的首字母大小写都可以<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token keyword">package</span> <span class="token namespace">name</span><span class="token operator">=</span><span class="token string">"com.dmlll.pojo"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>typeAliases<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="4Mappers_615"></a>4.Mappers</h3> 
<p>1.使用相对于类路径的资源引用</p> 
<pre><code class="prism language-java">语法：<span class="token operator">&lt;</span>mapper resource<span class="token operator">=</span><span class="token string">""</span><span class="token operator">/</span><span class="token operator">&gt;</span>
使用相对于类路径的资源<span class="token punctuation">,</span>从 classpath 路径查找文件
例如：<span class="token operator">&lt;</span>mapper resource<span class="token operator">=</span><span class="token string">"com/kkb/mapper/TeamMapper.xml"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>  
</code></pre> 
<p>2.使用映射器接口实现类的完全限定类名</p> 
<pre><code class="prism language-java">语法<span class="token operator">:</span><span class="token operator">&lt;</span>mapper <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">""</span><span class="token operator">/</span><span class="token operator">&gt;</span>
使用的mapper接口的完全限定名
要求：接口和映射文件同包同名
例如<span class="token operator">&lt;</span>mapper <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.kkb.mapper.GameRecordMapper"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> 
<p>3.将包内的映射器接口实现全部注册为映射器</p> 
<pre><code class="prism language-java">语法<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token keyword">package</span> <span class="token namespace">name</span><span class="token operator">=</span><span class="token string">""</span><span class="token operator">/</span><span class="token operator">&gt;</span>
指定包下的所有<span class="token class-name">Mapper</span>接口
如：<span class="token operator">&lt;</span><span class="token keyword">package</span> <span class="token namespace">name</span><span class="token operator">=</span><span class="token string">"com.kkb.mapper"</span><span class="token operator">/</span><span class="token operator">&gt;</span> 
注意：此种方法要求 <span class="token class-name">Mapper</span>接口名称和 mapper 映射文件名称相同，且在同一个目录中。
</code></pre> 
<h3><a id="5_639"></a>5.事务</h3> 
<p>Mybatis默认事务手动提交，如果自动提交可以在获取SqlSession是指定参数</p> 
<pre><code class="prism language-java">sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_645"></a>九、映射关系</h2> 
<pre><code class="prism language-java">CREATE TABLE `<span class="token keyword">class</span>` <span class="token punctuation">(</span>
  `classid` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `classname` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  <span class="token class-name">PRIMARY</span> KEY <span class="token punctuation">(</span>`classid`<span class="token punctuation">)</span> <span class="token class-name">USING</span> BTREE
<span class="token punctuation">)</span> ENGINE<span class="token operator">=</span><span class="token class-name">InnoDB</span> <span class="token class-name">DEFAULT</span> CHARSET<span class="token operator">=</span>utf8 ROW_FORMAT<span class="token operator">=</span>COMPACT<span class="token punctuation">;</span>
INSERT INTO `dm`<span class="token punctuation">.</span>`<span class="token keyword">class</span>` <span class="token punctuation">(</span>`classid`<span class="token punctuation">,</span> `classname`<span class="token punctuation">)</span> VALUES <span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'西游一班'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

CREATE TABLE `student` <span class="token punctuation">(</span>
  `studentid` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `studentname` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `studentsex` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `studentage` <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `studenttel` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  `studentclass` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
  <span class="token class-name">PRIMARY</span> KEY <span class="token punctuation">(</span>`studentid`<span class="token punctuation">)</span> <span class="token class-name">USING</span> BTREE<span class="token punctuation">,</span>
  KEY `studentclass` <span class="token punctuation">(</span>`studentclass`<span class="token punctuation">)</span> <span class="token class-name">USING</span> BTREE<span class="token punctuation">,</span>
  CONSTRAINT `student_ibfk_1` <span class="token class-name">FOREIGN</span> KEY <span class="token punctuation">(</span>`studentclass`<span class="token punctuation">)</span> REFERENCES `<span class="token keyword">class</span>` <span class="token punctuation">(</span>`classid`<span class="token punctuation">)</span>
<span class="token punctuation">)</span> ENGINE<span class="token operator">=</span><span class="token class-name">InnoDB</span> <span class="token class-name">DEFAULT</span> CHARSET<span class="token operator">=</span>utf8 ROW_FORMAT<span class="token operator">=</span>COMPACT<span class="token punctuation">;</span>
INSERT INTO `dm`<span class="token punctuation">.</span>`student` <span class="token punctuation">(</span>`studentid`<span class="token punctuation">,</span> `studentname`<span class="token punctuation">,</span> `studentsex`<span class="token punctuation">,</span> `studentage`<span class="token punctuation">,</span> `studenttel`<span class="token punctuation">,</span> `studentclass`<span class="token punctuation">)</span> VALUES <span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'孙悟空'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> studentId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> studentName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> studentSex<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> studentAge<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> studentTel<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> studentClass<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Clazz</span> clazz<span class="token punctuation">;</span><span class="token comment">//多对一</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Clazz</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> classId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> className<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> students<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="1_685"></a>1.多对一</h3> 
<pre><code class="prism language-java"><span class="token class-name">Student</span> <span class="token function">selectById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectById"</span> resultMap<span class="token operator">=</span><span class="token string">"baseEntity"</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>两表连接找出字段<span class="token operator">--</span><span class="token operator">&gt;</span>
    select <span class="token operator">*</span> from student<span class="token punctuation">,</span><span class="token keyword">class</span> where studentclass <span class="token operator">=</span> classid and studentid <span class="token operator">=</span> #<span class="token punctuation">{<!-- --></span>abc<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>resultMap id<span class="token operator">=</span><span class="token string">"baseEntity"</span> type<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>id property<span class="token operator">=</span><span class="token string">"studentId"</span> column<span class="token operator">=</span><span class="token string">"studentId"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result property<span class="token operator">=</span><span class="token string">"studentName"</span> column<span class="token operator">=</span><span class="token string">"studentName"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result property<span class="token operator">=</span><span class="token string">"studentSex"</span> column<span class="token operator">=</span><span class="token string">"studentSex"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result property<span class="token operator">=</span><span class="token string">"studentAge"</span> column<span class="token operator">=</span><span class="token string">"studentAge"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result property<span class="token operator">=</span><span class="token string">"studentTel"</span> column<span class="token operator">=</span><span class="token string">"studentTel"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result property<span class="token operator">=</span><span class="token string">"studentClass"</span> column<span class="token operator">=</span><span class="token string">"studentClass"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>
        如果有<span class="token class-name">Clazz</span>的resultMap也可以使用
        <span class="token operator">&lt;</span>association property<span class="token operator">=</span><span class="token string">"clazz"</span> resultMap<span class="token operator">=</span><span class="token string">"clazz的resultMap路径"</span><span class="token operator">&gt;</span>
    <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>association property<span class="token operator">=</span><span class="token string">"clazz"</span> javaType<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Clazz"</span> column<span class="token operator">=</span><span class="token string">"studentClass"</span> <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>id property<span class="token operator">=</span><span class="token string">"classId"</span> column<span class="token operator">=</span><span class="token string">"classId"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>result property<span class="token operator">=</span><span class="token string">"className"</span> column<span class="token operator">=</span><span class="token string">"className"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>association<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>resultMap<span class="token operator">&gt;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9f/2a/LhUImTqP_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_716"></a>2.一对多</h3> 
<pre><code class="prism language-java"><span class="token class-name">Clazz</span> <span class="token function">selectById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectById"</span> resultMap<span class="token operator">=</span><span class="token string">"baseEntity"</span><span class="token operator">&gt;</span>
    select <span class="token operator">*</span> from student<span class="token punctuation">,</span><span class="token keyword">class</span> where studentclass <span class="token operator">=</span> classid and classid <span class="token operator">=</span> #<span class="token punctuation">{<!-- --></span>abc<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>resultMap id<span class="token operator">=</span><span class="token string">"baseEntity"</span> type<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Clazz"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>id property<span class="token operator">=</span><span class="token string">"classId"</span> column<span class="token operator">=</span><span class="token string">"classId"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>result property<span class="token operator">=</span><span class="token string">"className"</span> column<span class="token operator">=</span><span class="token string">"className"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>collection property<span class="token operator">=</span><span class="token string">"students"</span> ofType<span class="token operator">=</span><span class="token string">"com.dmlll.pojo.Student"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>id property<span class="token operator">=</span><span class="token string">"studentId"</span> column<span class="token operator">=</span><span class="token string">"studentId"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>result property<span class="token operator">=</span><span class="token string">"studentName"</span> column<span class="token operator">=</span><span class="token string">"studentName"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>result property<span class="token operator">=</span><span class="token string">"studentSex"</span> column<span class="token operator">=</span><span class="token string">"studentSex"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>result property<span class="token operator">=</span><span class="token string">"studentAge"</span> column<span class="token operator">=</span><span class="token string">"studentAge"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>result property<span class="token operator">=</span><span class="token string">"studentTel"</span> column<span class="token operator">=</span><span class="token string">"studentTel"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>result property<span class="token operator">=</span><span class="token string">"studentClass"</span> column<span class="token operator">=</span><span class="token string">"studentClass"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>collection<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>resultMap<span class="token operator">&gt;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b2/2d/Ov5ASF1m_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="SQL_741"></a>十、动态SQL</h2> 
<p>偷个懒，直接贴mapper</p> 
<h3><a id="1where_743"></a>1.where</h3> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"queryByVO"</span> parameterType<span class="token operator">=</span><span class="token string">"QueryVO"</span> resultMap<span class="token operator">=</span><span class="token string">"baseResultMap"</span><span class="token operator">&gt;</span>
        select <span class="token operator">*</span> from team
        <span class="token generics"><span class="token punctuation">&lt;</span>where<span class="token punctuation">&gt;</span></span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 如果用户输入了名称，就模糊查询   and teamName like <span class="token string">'%?%'</span><span class="token operator">--</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token keyword">if</span> test<span class="token operator">=</span><span class="token string">"name!=null "</span><span class="token operator">&gt;</span>
                and teamName like <span class="token function">concat</span><span class="token punctuation">(</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">'%'</span><span class="token punctuation">,</span>#<span class="token punctuation">{<!-- --></span>name<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">)</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">if</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token keyword">if</span> test<span class="token operator">=</span><span class="token string">"beginTime!=null "</span><span class="token operator">&gt;</span>
                and createTime<span class="token operator">&gt;=</span>#<span class="token punctuation">{<!-- --></span>beginTime<span class="token punctuation">}</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">if</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token keyword">if</span> test<span class="token operator">=</span><span class="token string">"endTime!=null "</span><span class="token operator">&gt;</span>
                and createTime<span class="token operator">&amp;</span>lt<span class="token punctuation">;</span><span class="token operator">=</span>#<span class="token punctuation">{<!-- --></span>endTime<span class="token punctuation">}</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">if</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token keyword">if</span> test<span class="token operator">=</span><span class="token string">"location!=null "</span><span class="token operator">&gt;</span>
                and location<span class="token operator">=</span>#<span class="token punctuation">{<!-- --></span>location<span class="token punctuation">}</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">if</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>where<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="2set_765"></a>2.set</h3> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>update id<span class="token operator">=</span><span class="token string">"update1"</span> parameterType<span class="token operator">=</span><span class="token string">"com.kkb.pojo.Team"</span><span class="token operator">&gt;</span>
    update team
    <span class="token generics"><span class="token punctuation">&lt;</span>set<span class="token punctuation">&gt;</span></span>
        <span class="token operator">&lt;</span><span class="token keyword">if</span> test<span class="token operator">=</span><span class="token string">"teamName!=null"</span><span class="token operator">&gt;</span>
            teamName<span class="token operator">=</span>#<span class="token punctuation">{<!-- --></span>teamName<span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">if</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token keyword">if</span> test<span class="token operator">=</span><span class="token string">"location!=null"</span><span class="token operator">&gt;</span>
            location<span class="token operator">=</span>#<span class="token punctuation">{<!-- --></span>location<span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">if</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token keyword">if</span> test<span class="token operator">=</span><span class="token string">"createTime!=null"</span><span class="token operator">&gt;</span>
            createTime<span class="token operator">=</span>#<span class="token punctuation">{<!-- --></span>createTime<span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">if</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>set<span class="token operator">&gt;</span>
    where teamId<span class="token operator">=</span>#<span class="token punctuation">{<!-- --></span>teamId<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>update<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="3_forEach_784"></a>3. forEach</h3> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>insert id<span class="token operator">=</span><span class="token string">"addList"</span> parameterType<span class="token operator">=</span><span class="token string">"arraylist"</span><span class="token operator">&gt;</span>
        INSERT <span class="token class-name">INTO</span> team <span class="token punctuation">(</span>teamName<span class="token punctuation">,</span>location<span class="token punctuation">)</span> VALUES
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>collection<span class="token operator">:</span>要遍历的集合；参数是集合类型，直接写list
        item<span class="token operator">:</span>遍历的集合中的每一个数据
        separator：将遍历的结果用，分割<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>foreach collection<span class="token operator">=</span><span class="token string">"list"</span> item<span class="token operator">=</span><span class="token string">"t"</span> separator<span class="token operator">=</span><span class="token string">","</span><span class="token operator">&gt;</span>
            <span class="token punctuation">(</span>#<span class="token punctuation">{<!-- --></span>t<span class="token punctuation">.</span>teamName<span class="token punctuation">}</span><span class="token punctuation">,</span>#<span class="token punctuation">{<!-- --></span>t<span class="token punctuation">.</span>location<span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>foreach<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>insert
</code></pre> 
<h2><a id="_797"></a>十一、分页插件</h2> 
<h3><a id="1_798"></a>1.引入依赖</h3> 
<pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>github<span class="token punctuation">.</span>pagehelper<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>pagehelper<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.1</span><span class="token number">.10</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="2_807"></a>2.配置插件</h3> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>environments之前<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>plugins<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span>plugin interceptor<span class="token operator">=</span><span class="token string">"com.github.pagehelper.PageInterceptor"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>plugin<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>plugins<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="3_815"></a>3.测试方法</h3> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test10</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">StudentMapper</span> mapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">StudentMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">PageHelper</span><span class="token punctuation">.</span><span class="token function">startPage</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//查询语句之前</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> students <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">PageInfo</span> pageInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageInfo</span><span class="token punctuation">(</span>students<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//查询语句之后</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"总数："</span><span class="token operator">+</span>pageInfo<span class="token punctuation">.</span><span class="token function">getTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Student</span> student <span class="token operator">:</span> students<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/30/0e/VjsIMLvW_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Mybatis_832"></a>十二、Mybatis缓存简介</h2> 
<h3><a id="1_833"></a>1.作用</h3> 
<p>提升查询的效率和减少数据库的压力。将经常查询的数据存在缓存（内存）中，用户查询该数据的时候不需要从磁盘（关系型数据库文件）上查询，而是直接从缓存中查询，提高查询效率，解决高并发问题。</p> 
<h3><a id="2_835"></a>2.一级缓存</h3> 
<p>自动开启，SqlSession级别的缓存<br> 读取的数据写入缓存，下次查询相同的数据不需要在查询数据库，如果发生增删改或提交回滚或sqlSession关闭都会清空缓存<br> 清空缓存：<br> 1、 session.clearCache( ) ;<br> 2、 execute update(增删改) ;<br> 3、 session.close( );<br> 4、 xml配置 flushCache=“true” ；<br> 5、 rollback；<br> 6、 commit。</p> 
<h3><a id="3_845"></a>3.二级缓存</h3> 
<p>默认关闭，Mapper级别<br> 多个SqlSession去操作一个Mapper的sql语句，得到的数据会存放在二级缓存，多个SqlSession共享二级缓存。<br> 二级缓存是多个SqlSession共享的，其作用域是mapper的同一namespace。<br> 不同的sqlSession两次执行相同namespace下的sql语句参数相同即最终执行相同的sql语句，第一次执行完毕会将数据库中查询的数据写到缓存（内存），第二次会从缓存中获取数据将不再从数据库查询，从而提高查询效率。<br> 开启二级缓存</p> 
<pre><code class="prism language-java"><span class="token comment">//mybatis.xml</span>
<span class="token operator">&lt;</span>setting name<span class="token operator">=</span><span class="token string">"cacheEnabled"</span> value<span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token comment">//需要开启缓存的mapper.xml</span>
<span class="token generics"><span class="token punctuation">&lt;</span>cache<span class="token punctuation">&gt;</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>cache<span class="token operator">&gt;</span>
</code></pre> 
<p>mapper中的statement想要禁用</p> 
<pre><code class="prism language-java">useCache<span class="token operator">=</span><span class="token boolean">false</span>
</code></pre> 
<p>缓存的属性配置</p> 
<pre><code class="prism language-java">	<span class="token generics"><span class="token punctuation">&lt;</span>cache<span class="token punctuation">&gt;</span></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"eviction"</span> value<span class="token operator">=</span><span class="token string">"LRU"</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>回收策略为LRU<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"flushInterval"</span> value<span class="token operator">=</span><span class="token string">"60000"</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>自动刷新时间间隔为<span class="token number">60</span>S<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"size"</span> value<span class="token operator">=</span><span class="token string">"1024"</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>最多缓存<span class="token number">1024</span>个引用对象<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"readOnly"</span> value<span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>只读<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>cache<span class="token operator">&gt;</span>
</code></pre> 
<p>没时间了，草草收尾，抱歉</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/29aed8a3c41b5a8fcd2e0aa4276bc8f4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Qt&#43;openCV学习笔记（八）openCV4.5.4&#43;android如何使用动、静态库</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dd52ef5b573c305c125832cf6352f514/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">实现微信小程序分享朋友圈及好友</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>