<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MySQL中varchar最大长度是多少？ - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MySQL中varchar最大长度是多少？" />
<meta property="og:description" content="被问到一个问题：MySQL中varchar最大长度是多少？这不是一个固定的数字。本文简要说明一下限制规则。
1、限制规则
字段的限制在字段定义的时候有以下规则：
a) 存储限制
varchar 字段是将实际内容单独存储在聚簇索引之外，内容开头用1到2个字节表示实际长度（长度超过255时需要2个字节），因此最大长度不能超过65535。
b) 编码长度限制
字符类型若为gbk，每个字符最多占2个字节，最大长度不能超过32766;
字符类型若为utf8，每个字符最多占3个字节，最大长度不能超过21845。
若定义的时候超过上述限制，则varchar字段会被强行转为text类型，并产生warning。
c) 行长度限制
导致实际应用中varchar长度限制的是一个行定义的长度。 MySQL要求一个行的定义长度不能超过65535。若定义的表长度超过这个值，则提示
ERROR 1118 (42000): Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535. You have to change some columns to TEXT or BLOBs。
2、计算例子
举两个例说明一下实际长度的计算。
a) 若一个表只有一个varchar类型，如定义为
create table t4(c varchar(N)) charset=gbk;
则此处N的最大值为(65535-1-2)/2= 32766。
减1的原因是实际行存储从第二个字节开始’;
减2的原因是varchar头部的2个字节表示长度;
除2的原因是字符编码是gbk。
b) 若一个表定义为
create table t4(c int, c2 char(30), c3 varchar(N)) charset=utf8;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/f1dbec9aa1c555e91548890c888d1fc0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2013-02-24T22:09:49+08:00" />
<meta property="article:modified_time" content="2013-02-24T22:09:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MySQL中varchar最大长度是多少？</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>    被问到一个问题：MySQL中varchar最大长度是多少？这不是一个固定的数字。本文简要说明一下限制规则。</p> 
<p><strong>1、限制规则</strong></p> 
<p>字段的限制在字段定义的时候有以下规则：</p> 
<p> </p> 
<p>a)                  存储限制</p> 
<p>varchar 字段是将实际内容单独存储在聚簇索引之外，内容开头用1到2个字节表示实际长度（长度超过255时需要2个字节），因此最大长度不能超过65535。</p> 
<p> </p> 
<p>b)                  编码长度限制</p> 
<p>字符类型若为gbk，每个字符最多占2个字节，最大长度不能超过32766;</p> 
<p>字符类型若为utf8，每个字符最多占3个字节，最大长度不能超过21845。</p> 
<p>若定义的时候超过上述限制，则varchar字段会被强行转为text类型，并产生warning。</p> 
<p> </p> 
<p>c)                   行长度限制</p> 
<p>导致实际应用中varchar长度限制的是一个行定义的长度。 MySQL要求一个行的定义长度不能超过65535。若定义的表长度超过这个值，则提示</p> 
<p>ERROR 1118 (42000): Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535. You have to change some columns to TEXT or BLOBs。</p> 
<p> </p> 
<p><strong>2、计算例子</strong></p> 
<p>举两个例说明一下实际长度的计算。</p> 
<p> </p> 
<p>a)                  若一个表只有一个varchar类型，如定义为</p> 
<p>create table t4(c varchar(N)) charset=gbk;</p> 
<p>则此处N的最大值为(65535-1-2)/2= 32766。</p> 
<p>减1的原因是实际行存储从第二个字节开始’;</p> 
<p>减2的原因是varchar头部的2个字节表示长度;</p> 
<p>除2的原因是字符编码是gbk。</p> 
<p> </p> 
<p>b)                  若一个表定义为</p> 
<p>create table t4(c int, c2 char(30), c3 varchar(N)) charset=utf8;</p> 
<p>则此处N的最大值为 (65535-1-2-4-30*3)/3=21812</p> 
<p>减1和减2与上例相同;</p> 
<p>减4的原因是int类型的c占4个字节;</p> 
<p>减30*3的原因是char(30)占用90个字节，编码是utf8。</p> 
<p> </p> 
<p>       如果被varchar超过上述的b规则，被强转成text类型，则每个字段占用定义长度为11字节，当然这已经不是“varchar”了。</p> 
<p><br> </p> 
<p>出自http://dinglin.iteye.com/blog/914276</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b0c3e4d6d74187974349978e0c49ee16/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">varchar和Nvarchar区别</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/efe03e11f3f57e1ef65c90e9c4472561/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据库模糊搜索时，关键字中处理特殊字符（%,_）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>