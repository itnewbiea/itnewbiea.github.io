<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java中调用c(c&#43;&#43;)写的dll文件的实现及步骤 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java中调用c(c&#43;&#43;)写的dll文件的实现及步骤" />
<meta property="og:description" content="从网上找了这篇文档，做这个的时候感觉并不是特困难,感觉非常的新奇,毕竟自己做c语言的项目特别少.现在把这篇文章转载过来，加了自己的一些注意项。
JNI 使用技巧点滴 本文为在 32 位 Windows 平台上实现 Java 本地方法提供了实用的示例、步骤和准则。本文中的示例使用 Sun Microsystems 公司创建的 Java Development Kit (JDK) 版本 1.4.1。用 C 语言编写的本地代码是用 Microsoft Visual C&#43;&#43; 6.0编译器编译生成。 简介 近日，由于项目需要，要在WEB页面实现图像转换功能，而VC在图像转换方面有着得天独厚的优势。我们首先用VC封装出图像转换的DLL，然后用JAVA的本地化方法JNI调用用于图像转换的DLL，最后用JavaBean调用JNI生成的DLL。 通过近几天在网上找资料和自己的摸索，收获很多，现总结如下，让以后做这方面的人少走弯路。 一. JAVA部分 1. 无包的情况： 实例一： public class MyNative { static { System.loadLibrary( &#34;MyNative&#34; ); } public native static void HelloWord(); public native static String cToJava(); } 说明： 1)在JAVA程序中，首先需要在类中声明所调用的库名称System.loadLibrary( String libname );，在库的搜寻路径中定位这个库。定位库的具体操作依赖于操作系统。在windows下，首先从当前目录查找，然后再搜寻”PATH”环境变量列出的目录。如果找不到该库，则会抛出UnsatisfiedLinkError。 2)这里加载的是JNI生成的DLL，而不是其他生成的DLL的名称。 在这里，库的扩展名字可以不用写出来，究竟是DLL还是SO，由系统自己判断。 3) 还需要对将要调用的方法做本地声明，关键字为native。并且只需要声明，而不需要具体实现。 实现放在C中实现，稍后将做说明。 4)如果加了static，表明是静态方法。如果不加，表明是一般的方法。加与不加，生成的头文件中有一个参数不同。稍后将做说明。 现在开始编译它: 用javac MyNative.h编译它，生成对应的class文件。 用javah MyNative ，就会生成对应的MyNative." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/d2a9f6c8c286919873f2ab29aaad28aa/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2006-03-17T15:16:00+08:00" />
<meta property="article:modified_time" content="2006-03-17T15:16:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java中调用c(c&#43;&#43;)写的dll文件的实现及步骤</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>从网上找了这篇文档，做这个的时候感觉并不是特困难,感觉非常的新奇,毕竟自己做c语言的项目特别少.现在把这篇文章转载过来，加了自己的一些注意项。</p> 
<div> 
 <strong><span style="COLOR: #339900">JNI</span></strong> 
 <strong><span style="COLOR: #339900">使用技巧点滴</span></strong> 
</div> 
<div>
    
</div> 
<div>
  本文为在 32 位 Windows 平台上实现 Java 本地方法提供了实用的示例、步骤和准则。本文中的示例使用 Sun Microsystems 公司创建的 Java Development Kit (JDK) 版本 1.4.1。用 C 语言编写的本地代码是用 Microsoft Visual C++ 6.0编译器编译生成。 
</div> 
<div>
    
</div> 
<div>
  　　简介 
</div> 
<div>
    
</div> 
<div>
  　　近日，由于项目需要，要在WEB页面实现图像转换功能，而VC在图像转换方面有着得天独厚的优势。我们首先用VC封装出图像转换的DLL，然后用JAVA的本地化方法JNI调用用于图像转换的DLL，最后用JavaBean调用JNI生成的DLL。 
</div> 
<div>
    
</div> 
<div>
  　　通过近几天在网上找资料和自己的摸索，收获很多，现总结如下，让以后做这方面的人少走弯路。 
</div> 
<div>
    
</div> 
<div>
  　　一. JAVA部分 
</div> 
<div>
    
</div> 
<div>
  　　1. 无包的情况： 
</div> 
<div>
    
</div> 
<div>
  　　实例一： 
</div> 
<div>
    
</div> 
<div>
    
</div> 
<div> 
  　　public class MyNative 
</div> 
<div>
    
</div> 
<div>
  　　{ 
</div> 
<div>
    
</div> 
<div>
  　　static 
</div> 
<div>
    
</div> 
<div>
  　　{ 
</div> 
<div>
    
</div> 
<div>
  　　System.loadLibrary( "MyNative" ); 
              
</div> 
<div>
    
</div> 
<div>
  　　} 
</div> 
<div>
    
</div> 
<div>
  　　public native static void HelloWord(); 
</div> 
<div>
    
</div> 
<div>
  　　public native static String cToJava(); 
</div> 
<div>
    
</div> 
<div>
  　　} 
</div> 
<div> 
   
</div> 
<div> 
 　 
 <font size="4"><strong>　说明：</strong></font> 
</div> 
<div>
    
</div> 
<div>
  　　1)在JAVA程序中，首先需要在类中声明所调用的库名称System.loadLibrary( String libname );，在库的搜寻路径中定位这个库。定位库的具体操作依赖于操作系统。在windows下，首先从当前目录查找，然后再搜寻”PATH”环境变量列出的目录。如果找不到该库，则会抛出UnsatisfiedLinkError。 
</div> 
<div>
    
</div> 
<div style="TEXT-INDENT: 21pt">
  2)这里加载的是JNI生成的DLL，而不是其他生成的DLL的名称。 在这里，库的扩展名字可以不用写出来，究竟是DLL还是SO，由系统自己判断。 
</div> 
<div style="TEXT-INDENT: 21pt">
  3) 还需要对将要调用的方法做本地声明，关键字为native。并且只需要声明，而不需要具体实现。 实现放在C中实现，稍后将做说明。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　4)如果加了static，表明是静态方法。如果不加，表明是一般的方法。加与不加，生成的头文件中有一个参数不同。稍后将做说明。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　现在开始编译它: 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　用javac MyNative.h编译它，生成对应的class文件。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　用javah MyNative ，就会生成对应的MyNative.h头文件。剩下的是就开始交给VC来完成了（我们用VC来实现对应的C实现部分）。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　2. 有包的情况： 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　实例二： 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt"> 
  　　package com..myNative; 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　public class MyNative 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　{ 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　static 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　{ 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　System.loadLibrary( "MyNative" ); 
              
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　} 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　public native static void HelloWord(); 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　public native static String cToJava(); 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　}  
</div> 
<div style="TEXT-INDENT: 21pt">
  　　其他与上面相同，就是在用javac和javah时有所不同。对于有包的情况一定要注意这一点，开始时我的程序始终运行都不成功，问题就出在这里。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt"> 
  　　javac ./com/myNative/MyNative.java 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　javah com.myNative.MyNative 
</div> 
<div style="TEXT-INDENT: 21pt"> 
   
</div> 
<div style="TEXT-INDENT: 21pt"> 
   
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　上面一句就不用解释了。对下面的一句解释一下：本类的前面均是包名。这样生成的头文件就是：com.myNative.MyNative.h。 开始时，在这种情况下我用javah MyNative生成的头文件始终是MyNative.h。在网上查资料时，看见别人的头文件名砸那长，我的那短。但不知道为什么，现在大家和我一样知道为什么了吧。：）。有时还需要带上路径。具体查看javah的语法。 
</div> 
<div style="TEXT-INDENT: 21pt">
  二．C实现部分 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　刚才用javah MyNative生成的MyNative.h头文件内容如下： 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt"> 
  　　/* DO NOT EDIT THIS FILE - it is machine generated */ 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　#include &lt;jni.h&gt; 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　/* Header for class MyNative */ 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　#ifndef _Included_MyNative 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　#define _Included_MyNative 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　#ifdef __cplusplus 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　extern "C" { 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　#endif 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　/* 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　* Class: 
      MyNative 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　* Method: 
     HelloWord 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　* Signature: ()V 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　*/ 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　JNIEXPORT void JNICALL Java_MyNative_HelloWord (JNIEnv *, jclass); 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　/* 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　* Class: 
      MyNative 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　* Method: 
     cToJava 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　* Signature: ()Ljava/lang/String; 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　*/ 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　JNIEXPORT jstring JNICALL Java_MyNative_cToJava (JNIEnv *, jclass); 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　#ifdef __cplusplus 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　} 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　#endif 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　#endif 
</div> 
<div style="TEXT-INDENT: 21pt"> 
   
</div> 
<div style="TEXT-INDENT: 21pt">
  接下来,就是如何实现它了。其实，用JNI作出的东西也是DLL，被JAVA所调用。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　在具体实现的时候，我们只关心两个函数原型： 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt"> 
  　　JNIEXPORT void JNICALL Java_MyNative_HelloWord(JNIEnv *, jclass);和JNIEXPORT jstring JNICALL Java_MyNative_cToJava(JNIEnv *, jclass); 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt"> 
   
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　现在让我们开始激动人心的第一步吧 : ) 。在project里面选择win32 Dynamic-link Library，然后点击下一步，其余的取默认。如果不取默认的，将会有dllmain()函数。取空DLL工程的话，将无这个函数。我在这里取的是空。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　然后选择new-&gt;File-&gt;C++ Source File，生成一个空*.cpp文件。我们把他取名为MyNative。把JNIEXPORT void JNICALL Java_MyNative_HelloWord(JNIEnv *, jclass);和JNIEXPORT jstring JNICALL Java_MyNative_cToJava(JNIEnv *, jclass);拷贝到CPP文件中去。然后把头文件包含进来。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　生成的MyNative.cpp内容如下： 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt"> 
  　　#include &lt;stdio.h&gt; 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　#include "MyNative.h" 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　JNIEXPORT void JNICALL Java_MyNative_HelloWord (JNIEnv *env, jclass jobject) 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　{ 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　printf("hello word!/n");  
         
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　} 
</div> 
<div style="TEXT-INDENT: 21pt">
  　　JNIEXPORT jstring JNICALL Java_MyNative_cToJavaJNIEnv *env, jclass obj) 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　{ 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　jstring jstr; 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　char str[]="Hello,word!/n"; 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　jstr=env-&gt;NewStringUTF(str); 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　return jstr; 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　} 
   
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　在编译前一定要注意下列情况。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　注意：一定要把SDK中的include文件夹中(和它下面的win32文件夹下的头文件)的几个头文件拷贝到VC的include文件夹中。或者在VC的tools/options/directories中设置，把头文件给包含进来。 
</div> 
<div style="TEXT-INDENT: 21pt">
  对程序的一点解释： 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　1)前文不是说过，加了static和不加只是一个参数的区别吗。就是jclass的不同，不加static这里就是jobject。也就是JNIEXPORT void JNICALL Java_MyNative_HelloWord(JNIEnv *env, jobject obj)。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　2)这里JNIEXPORT和JNICALL都是JNI的关键字，表示此函数是要被JNI调用的。而jstring是以JNI为中介使JAVA的String类型与本地的string沟通的一种类型，我们可以视而不见，就当做String使用(具体对应见表一)。函数的名称是JAVA_再加上java程序的package路径再加函数名组成的（参见有包的情况）。参数中，我们也只需要关心在JAVA程序中存在的参数，至于JNIEnv*和jclass我们一般没有必要去碰它。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　3)NewStringUTF()是JNI函数，从一个包含UTF格式编码字符的char类型数组中创建一个新的jstring对象。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　4) 以上程序片断jstr=env-&gt;NewStringUTF(str);是C++中的写法，不必使用env指针。因为JNIEnv函数的C++版本包含有直接插入成员函数，他们负责查找函数指针。而对于C的写法，应改为：jstr=(*env)-&gt;NewStringUTF(env,str);因为所有JNI函数的调用都使用env指针，它是任意一个本地方法的第一个参数。env指针是指向一个函数指针表的指针。因此在每个JNI函数访问前加前缀(*env)-&gt;，以确保间接引用函数指针。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　在C和Java编程语言之间传送值时，需要理解这些值类型在这两种语言间的对应关系。这些都在头文件jni.h中，用typedef语句声明了这些类在目标平台上的代价类。头文件也定义了常量如：JNI_FALSE=0 和JNI_TRUE=1; 
</div> 
<div style="TEXT-INDENT: 21pt"></div> 
<div style="TEXT-INDENT: 21pt">
  表一说明了Java类型和C类型之间的对应关系。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　表一 
    Java类型和C类型 
</div> 
<div align="center"> 
 <table style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; BORDER-LEFT: medium none; WIDTH: 429.1pt; BORDER-BOTTOM: medium none; BORDER-COLLAPSE: collapse" cellspacing="0" cellpadding="0" width="572" border="1"><tbody><tr style="HEIGHT: 16.25pt"><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 143pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div style="TEXT-ALIGN: center" align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">Java</span> 
      <span style="FONT-SIZE: 10pt; COLOR: black">编程语言</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">C</span> 
      <span style="FONT-SIZE: 10pt; COLOR: black">编程语言</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">字节</span> 
     </div> </td></tr><tr style="HEIGHT: 15.45pt"><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 143pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 15.45pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div style="TEXT-ALIGN: center" align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">boolean</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 15.45pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">jboolean</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 15.45pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">1</span> 
     </div> </td></tr><tr style="HEIGHT: 16.25pt"><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 143pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div style="TEXT-ALIGN: center" align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">byte</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">jbyte</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">1</span> 
     </div> </td></tr><tr style="HEIGHT: 15.45pt"><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 143pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 15.45pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div style="TEXT-ALIGN: center" align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">char</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 15.45pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">jchar</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 15.45pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">2</span> 
     </div> </td></tr><tr style="HEIGHT: 16.25pt"><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 143pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div style="TEXT-ALIGN: center" align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">short</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">jshort</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">2</span> 
     </div> </td></tr><tr style="HEIGHT: 15.45pt"><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 143pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 15.45pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div style="TEXT-ALIGN: center" align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">int</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 15.45pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">jint</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 15.45pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">4</span> 
     </div> </td></tr><tr style="HEIGHT: 16.25pt"><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 143pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div style="TEXT-ALIGN: center" align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">long</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">jlong</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">8</span> 
     </div> </td></tr><tr style="HEIGHT: 15.45pt"><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 143pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 15.45pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div style="TEXT-ALIGN: center" align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">float</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 15.45pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">jfloat</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 15.45pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">4</span> 
     </div> </td></tr><tr style="HEIGHT: 16.25pt"><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 143pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div style="TEXT-ALIGN: center" align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">double</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">jdouble</span> 
     </div> </td><td style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0cm; WIDTH: 143.05pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; HEIGHT: 16.25pt; BACKGROUND-COLOR: transparent" width="191"> 
     <div align="center"> 
      <span style="FONT-SIZE: 10pt; COLOR: black">8</span> 
     </div> </td></tr></tbody></table> 
</div> 
<div style="TEXT-INDENT: 21pt">
  现在开始对所写的程序进行编译。选择build-&gt;rebuild all对所写的程序进行编译。点击build-&gt;build MyNative.DLL生成DLL文件。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　也可以用命令行cl来编译。具体参看其他书籍。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　再次强调（曾经为这个东西大伤脑筋）：DLL放置地方 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　1) 当前目录。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　2) 放在path所指的路径中 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　3) 自己在path环境变量中设置一个路径，要注意所指引的路径应该到.dll文件的上一级，如果指到.dll，则会报错。 
</div> 
<div style="TEXT-INDENT: 21pt">
  下面就开始测试我们的所写的DLL吧（假设DLL已放置正确）。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt"> 
  　　public class mytest 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　{ 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　public static void main(String[] args) 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　{ 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　MyNative a=new MyNative(); 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　a.HelloWord(); 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　System.out.println(a.cToJava()); 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　} 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　} 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt"> 
   
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　注意也要把MyNative.class放在与mytest.java同一个路径下。现在开始编译运行mytest，是不是在DOS窗口上输出： 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt"> 
  　　Hello word! 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　Hello,world! 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　以上是我们通过JNI方法调用的一个简单C程序。但在实际情况中要比这复杂的多。特别是在通过JNI调用其他DLL时，还有很多的地方需要注意。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　现在开始来讨论包含包的情况，步骤与上面的相同，只是有一点点不同。我们来看其中的一个函数。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt"> 
  　　JNIEXPORT void JNICALL Java_com_MyNative_MyNative_HelloWord (JNIEnv *env, jclass jobject) 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　{ 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　printf("hello word!/n"); 
           
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　}  
</div> 
<div style="TEXT-INDENT: 21pt"> 
   
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　我们来观察函数名称。函数的名称是JAVA_再加上java程序的package路径再加函数名组成的。现在这句话应该理解了吧。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　我们也写一个程序来测试包含包的情况。程序略。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt"> 
  　　javac ./com/MyNative/mytest.java 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　java mytest 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　是不是在DOS窗口上也显示同样的内容：）。 
</div> 
<div style="TEXT-INDENT: 21pt">
    
</div> 
<div style="TEXT-INDENT: 21pt">
  　　  
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e66b90f628516a8f019c2477ed80ff3f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">正则表达式,网上资料收集整理!</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b4d8d77c617ed1b79e2a40095c541b65/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Oracle里时间的应用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>