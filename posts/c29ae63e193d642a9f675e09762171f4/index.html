<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>利用强化学习进行股票操作实战（四） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="利用强化学习进行股票操作实战（四）" />
<meta property="og:description" content="本次实战代码仍是在之前基础上进行了一些修改。之前只在一支股票上进行训练，这次我将模型放在多支股票上训练，并在多支股票上进行了测试。对于多支股票的训练策略，没有参考过别人的训练方案（做这个的比较少）。我按自己的理解去训练，每一轮训练，都将每支股票从头到尾走一次。核心代码如下：
结果：
股票1：
不加均线的回测结果：
加均线的回测结果：
股票2：
不加均线的回测结果：
加均线的回测结果：
股票3：
不加均线的回测结果：
加均线的回测结果：
从上图可以发现，加了均线系统限制股票买卖效果不一定好，但是可以从一定程度上规避风险。在下跌趋势比较明显的股票中，均线系统能够很好的保护账户，减少损失。（如股票3）我这个均线策略设计的比较粗糙，如果细化一点，效果应该会好一些。
我本想依靠强化学习实现自动加减仓的功能，但发现这个似乎不太好做。
我最开始尝试了DDPG模型（ActorCritic中的一种），想利用Critic进行评价当前动作能够得到的收益（或是当前动作有多优秀），但是我发现critic很难训练，可能跟我使用的姿势不太对。我是将当前状态和当前动作当做特征输入critic网络中进行评价，这样输入可能很难让神经网络从中学到，应该输入当前状态，评价不同状态的得分。（现在才想到可以这么做，也有可能是神经网络需要精心设计过才好）
然后我又尝试了强制每次交易不满仓，只买入1/5仓位或只买入1/3仓位，每次卖出也同样。但我发现多数情况下这种分批次加减仓操作的效果都不如每次满仓操作效果好。我尝试了两种训练方式：1、在训练中满仓操作单，回测时分批买入；2、在训练中分批买入或卖出，回测同样。这两种训练方式效果都表现不好。
于是我就放弃了加减仓的设计。其实加减仓也可以结合大盘和个股的走势情况进行一个判断，可以通过建模得到当前风险状况来评估仓位设置。（这个后期再考虑了）
最后我再说下我对强化学习用在股票交易上的看法，我个人觉得强化学习用在股票交易上就是大材小用。强化学习适合当前动作对于之后影响没法立刻体现的任务，而在股票交易上，你今天买入或卖出第二天就知道当前操作是否正确。当然可以看一个长期的收益，但如果看一个长期的收益，似乎就不需要强化学习了，可以利用传统的机器学习算法或因子模型等。可能确实可以用强化学习，但我个人还是觉得有些大材小用，有监督学习就可以较好的解决股票交易这个问题。
代码github:
https://github.com/wbbhcb/stock_market
对量化、数据挖掘、深度学习感兴趣的可以关注公众号，本人不定期分享有关这些方面的研究。
个人知乎：
https://www.zhihu.com/people/e-zhe-shi-wo/activities" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c29ae63e193d642a9f675e09762171f4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-02-19T16:11:24+08:00" />
<meta property="article:modified_time" content="2020-02-19T16:11:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">利用强化学习进行股票操作实战（四）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>本次实战代码仍是在之前基础上进行了一些修改。之前只在一支股票上进行训练，这次我将模型放在多支股票上训练，并在多支股票上进行了测试。对于多支股票的训练策略，没有参考过别人的训练方案（做这个的比较少）。我按自己的理解去训练，每一轮训练，都将每支股票从头到尾走一次。核心代码如下：<br> <img src="https://images2.imgbox.com/b9/d5/vBbjBNWm_o.png" alt="在这里插入图片描述"><br> <strong>结果：</strong><br> 股票1：<br> 不加均线的回测结果：<br> <img src="https://images2.imgbox.com/e4/fe/u2Aj54BR_o.png" alt="在这里插入图片描述"><br> 加均线的回测结果：<br> <img src="https://images2.imgbox.com/74/7b/aPMFiJgy_o.png" alt="在这里插入图片描述"><br> 股票2：<br> 不加均线的回测结果：<br> <img src="https://images2.imgbox.com/f8/60/6aLb8apX_o.png" alt="在这里插入图片描述"><br> 加均线的回测结果：<br> <img src="https://images2.imgbox.com/29/78/Z5nVJaLM_o.png" alt="在这里插入图片描述"><br> 股票3：<br> 不加均线的回测结果：<br> <img src="https://images2.imgbox.com/20/d0/ufuFEdIi_o.png" alt="在这里插入图片描述"><br> 加均线的回测结果：<br> <img src="https://images2.imgbox.com/55/6d/lZtEtdJl_o.png" alt="在这里插入图片描述"><br> 从上图可以发现，加了均线系统限制股票买卖效果不一定好，但是可以从一定程度上规避风险。在下跌趋势比较明显的股票中，均线系统能够很好的保护账户，减少损失。（如股票3）我这个均线策略设计的比较粗糙，如果细化一点，效果应该会好一些。</p> 
<p>我本想依靠强化学习实现自动加减仓的功能，但发现这个似乎不太好做。</p> 
<p>我最开始尝试了DDPG模型（ActorCritic中的一种），想利用Critic进行评价当前动作能够得到的收益（或是当前动作有多优秀），但是我发现critic很难训练，可能跟我使用的姿势不太对。我是将当前状态和当前动作当做特征输入critic网络中进行评价，这样输入可能很难让神经网络从中学到，应该输入当前状态，评价不同状态的得分。（现在才想到可以这么做，也有可能是神经网络需要精心设计过才好）</p> 
<p>然后我又尝试了强制每次交易不满仓，只买入1/5仓位或只买入1/3仓位，每次卖出也同样。但我发现多数情况下这种分批次加减仓操作的效果都不如每次满仓操作效果好。我尝试了两种训练方式：1、在训练中满仓操作单，回测时分批买入；2、在训练中分批买入或卖出，回测同样。这两种训练方式效果都表现不好。</p> 
<p>于是我就放弃了加减仓的设计。其实加减仓也可以结合大盘和个股的走势情况进行一个判断，可以通过建模得到当前风险状况来评估仓位设置。（这个后期再考虑了）</p> 
<p>最后我再说下我对强化学习用在股票交易上的看法，我个人觉得强化学习用在股票交易上就是大材小用。强化学习适合当前动作对于之后影响没法立刻体现的任务，而在股票交易上，你今天买入或卖出第二天就知道当前操作是否正确。当然可以看一个长期的收益，但如果看一个长期的收益，似乎就不需要强化学习了，可以利用传统的机器学习算法或因子模型等。可能确实可以用强化学习，但我个人还是觉得有些大材小用，有监督学习就可以较好的解决股票交易这个问题。</p> 
<p>代码github:<br> https://github.com/wbbhcb/stock_market</p> 
<p>对量化、数据挖掘、深度学习感兴趣的可以关注公众号，本人不定期分享有关这些方面的研究。<br> <img src="https://images2.imgbox.com/2f/b8/pgW19xUi_o.png" alt="在这里插入图片描述"></p> 
<p>个人知乎：<br> https://www.zhihu.com/people/e-zhe-shi-wo/activities</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b78e529198eeddf31c8c209cb6dde225/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">word 如何快速比较两个文档的区别</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6ffcaaaada67d1e6d3624c43327b90cf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">&lt;Linux&gt;解决Ubuntu中vi编辑方向键不能移动光标的问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>