<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>äº’è”ç½‘åŠ ç«èµ› åŸºäºäººå·¥æ™ºèƒ½çš„å›¾åƒåˆ†ç±»ç®—æ³•ç ”ç©¶ä¸å®ç° - æ·±åº¦å­¦ä¹ å·ç§¯ç¥ç»ç½‘ç»œå›¾åƒåˆ†ç±» - ITå­¦ä¹ è€…åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="äº’è”ç½‘åŠ ç«èµ› åŸºäºäººå·¥æ™ºèƒ½çš„å›¾åƒåˆ†ç±»ç®—æ³•ç ”ç©¶ä¸å®ç° - æ·±åº¦å­¦ä¹ å·ç§¯ç¥ç»ç½‘ç»œå›¾åƒåˆ†ç±»" />
<meta property="og:description" content="æ–‡ç« ç›®å½• 0 ç®€ä»‹1 å¸¸ç”¨çš„åˆ†ç±»ç½‘ç»œä»‹ç»1.1 CNN1.2 VGG1.3 GoogleNet 2 å›¾åƒåˆ†ç±»éƒ¨åˆ†ä»£ç å®ç°2.1 ç¯å¢ƒä¾èµ–2.2 éœ€è¦å¯¼å…¥çš„åŒ…2.3 å‚æ•°è®¾ç½®(è·¯å¾„ï¼Œå›¾åƒå°ºå¯¸ï¼Œæ•°æ®é›†åˆ†å‰²æ¯”ä¾‹)2.4 ä»preprocessedFolderè¯»å–å›¾ç‰‡å¹¶è¿”å›numpyæ ¼å¼(ä¾¿äºåœ¨ç¥ç»ç½‘ç»œä¸­è®­ç»ƒ)2.5 æ•°æ®é¢„å¤„ç†2.6 è®­ç»ƒåˆ†ç±»æ¨¡å‹2.7 æ¨¡å‹è®­ç»ƒæ•ˆæœ2.8 æ¨¡å‹æ€§èƒ½è¯„ä¼° 3 1000ç§å›¾åƒåˆ†ç±»4 æœ€å 0 ç®€ä»‹ ğŸ”¥ ä¼˜è´¨ç«èµ›é¡¹ç›®ç³»åˆ—ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯
åŸºäºäººå·¥æ™ºèƒ½çš„å›¾åƒåˆ†ç±»æŠ€æœ¯
è¯¥é¡¹ç›®è¾ƒä¸ºæ–°é¢–ï¼Œé€‚åˆä½œä¸ºç«èµ›è¯¾é¢˜æ–¹å‘ï¼Œå­¦é•¿éå¸¸æ¨èï¼
ğŸ§¿ æ›´å¤šèµ„æ–™, é¡¹ç›®åˆ†äº«ï¼š
https://gitee.com/dancheng-senior/postgraduate
1 å¸¸ç”¨çš„åˆ†ç±»ç½‘ç»œä»‹ç» 1.1 CNN ä¼ ç»ŸCNNåŒ…å«å·ç§¯å±‚ã€å…¨è¿æ¥å±‚ç­‰ç»„ä»¶ï¼Œå¹¶é‡‡ç”¨softmaxå¤šç±»åˆ«åˆ†ç±»å™¨å’Œå¤šç±»äº¤å‰ç†µæŸå¤±å‡½æ•°ã€‚å¦‚ä¸‹å›¾ï¼š
å·ç§¯å±‚(convolution layer): æ‰§è¡Œå·ç§¯æ“ä½œæå–åº•å±‚åˆ°é«˜å±‚çš„ç‰¹å¾ï¼Œå‘æ˜å‡ºå›¾ç‰‡å±€éƒ¨å…³è”æ€§è´¨å’Œç©ºé—´ä¸å˜æ€§è´¨ã€‚
æ± åŒ–å±‚(pooling layer): æ‰§è¡Œé™é‡‡æ ·æ“ä½œã€‚é€šè¿‡å–å·ç§¯è¾“å‡ºç‰¹å¾å›¾ä¸­å±€éƒ¨åŒºå—çš„æœ€å¤§å€¼(max-pooling)æˆ–è€…å‡å€¼(avg-pooling)ã€‚é™é‡‡æ ·ä¹Ÿæ˜¯å›¾åƒå¤„ç†ä¸­å¸¸è§çš„ä¸€ç§æ“ä½œï¼Œå¯ä»¥è¿‡æ»¤æ‰ä¸€äº›ä¸é‡è¦çš„é«˜é¢‘ä¿¡æ¯ã€‚
å…¨è¿æ¥å±‚(fully-connected layerï¼Œæˆ–è€…fc layer): è¾“å…¥å±‚åˆ°éšè—å±‚çš„ç¥ç»å…ƒæ˜¯å…¨éƒ¨è¿æ¥çš„ã€‚
éçº¿æ€§å˜åŒ–: å·ç§¯å±‚ã€å…¨è¿æ¥å±‚åé¢ä¸€èˆ¬éƒ½ä¼šæ¥éçº¿æ€§å˜åŒ–å±‚ï¼Œä¾‹å¦‚Sigmoidã€Tanhã€ReLuç­‰æ¥å¢å¼ºç½‘ç»œçš„è¡¨è¾¾èƒ½åŠ›ï¼Œåœ¨CNNé‡Œæœ€å¸¸ä½¿ç”¨çš„ä¸ºReLuæ¿€æ´»å‡½æ•°ã€‚
Dropout : åœ¨æ¨¡å‹è®­ç»ƒé˜¶æ®µéšæœºè®©ä¸€äº›éšå±‚èŠ‚ç‚¹æƒé‡ä¸å·¥ä½œï¼Œæé«˜ç½‘ç»œçš„æ³›åŒ–èƒ½åŠ›ï¼Œä¸€å®šç¨‹åº¦ä¸Šé˜²æ­¢è¿‡æ‹Ÿåˆ
åœ¨CNNçš„è®­ç»ƒè¿‡ç¨‹æ€»ï¼Œç”±äºæ¯ä¸€å±‚çš„å‚æ•°éƒ½æ˜¯ä¸æ–­æ›´æ–°çš„ï¼Œä¼šå¯¼è‡´ä¸‹ä¸€æ¬¡è¾“å…¥åˆ†å¸ƒå‘ç”Ÿå˜åŒ–ï¼Œè¿™æ ·å°±éœ€è¦åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èŠ±è´¹æ—¶é—´å»è®¾è®¡å‚æ•°ã€‚åœ¨åç»­æå‡ºçš„BNç®—æ³•ä¸­ï¼Œç”±äºæ¯ä¸€å±‚éƒ½åšäº†å½’ä¸€åŒ–å¤„ç†ï¼Œä½¿å¾—æ¯ä¸€å±‚çš„åˆ†å¸ƒç›¸å¯¹ç¨³å®šï¼Œè€Œä¸”å®éªŒè¯æ˜è¯¥ç®—æ³•åŠ é€Ÿäº†æ¨¡å‹çš„æ”¶æ•›è¿‡ç¨‹ï¼Œæ‰€ä»¥è¢«å¹¿æ³›åº”ç”¨åˆ°è¾ƒæ·±çš„æ¨¡å‹ä¸­ã€‚
1.2 VGG VGG æ¨¡å‹æ˜¯ç”±ç‰›æ´¥å¤§å­¦æå‡ºçš„ï¼ˆ19å±‚ç½‘ç»œï¼‰ï¼Œè¯¥æ¨¡å‹çš„ç‰¹ç‚¹æ˜¯åŠ å®½åŠ æ·±äº†ç½‘ç»œç»“æ„ï¼Œæ ¸å¿ƒæ˜¯äº”ç»„å·ç§¯æ“ä½œï¼Œæ¯ä¸¤ç»„ä¹‹é—´åšMax-
Poolingç©ºé—´é™ç»´ã€‚åŒä¸€ç»„å†…é‡‡ç”¨å¤šæ¬¡è¿ç»­çš„3X3å·ç§¯ï¼Œå·ç§¯æ ¸çš„æ•°ç›®ç”±è¾ƒæµ…ç»„çš„64å¢å¤šåˆ°æœ€æ·±ç»„çš„512ï¼ŒåŒä¸€ç»„å†…çš„å·ç§¯æ ¸æ•°ç›®æ˜¯ä¸€æ ·çš„ã€‚å·ç§¯ä¹‹åæ¥ä¸¤å±‚å…¨è¿æ¥å±‚ï¼Œä¹‹åæ˜¯åˆ†ç±»å±‚ã€‚è¯¥æ¨¡å‹ç”±äºæ¯ç»„å†…å·ç§¯å±‚çš„ä¸åŒä¸»è¦åˆ†ä¸º
11ã€13ã€16ã€19 è¿™å‡ ç§æ¨¡å‹
å¢åŠ ç½‘ç»œæ·±åº¦å’Œå®½åº¦ï¼Œä¹Ÿå°±æ„å‘³ç€å·¨é‡çš„å‚æ•°,è€Œå·¨é‡å‚æ•°å®¹æ˜“äº§ç”Ÿè¿‡æ‹Ÿåˆï¼Œä¹Ÿä¼šå¤§å¤§å¢åŠ è®¡ç®—é‡ã€‚
1.3 GoogleNet GoogleNetæ¨¡å‹ç”±å¤šç»„Inceptionæ¨¡å—ç»„æˆï¼Œæ¨¡å‹è®¾è®¡å€Ÿé‰´äº†NINçš„ä¸€äº›æ€æƒ³.
NINæ¨¡å‹ç‰¹ç‚¹ï¼š
1. å¼•å…¥äº†å¤šå±‚æ„ŸçŸ¥å·ç§¯ç½‘ç»œ(Multi-Layer Perceptron Convolution, MLPconv)ä»£æ›¿ä¸€å±‚çº¿æ€§å·ç§¯ç½‘ç»œã€‚MLPconvæ˜¯ä¸€ä¸ªå¾®å°çš„å¤šå±‚å·ç§¯ç½‘ç»œï¼Œå³åœ¨çº¿æ€§å·ç§¯åé¢å¢åŠ è‹¥å¹²å±‚1x1çš„å·ç§¯ï¼Œè¿™æ ·å¯ä»¥æå–å‡ºé«˜åº¦éçº¿æ€§ç‰¹å¾ã€‚ 2)è®¾è®¡æœ€åä¸€å±‚å·ç§¯å±‚åŒ…å«ç±»åˆ«ç»´åº¦å¤§å°çš„ç‰¹å¾å›¾ï¼Œç„¶åé‡‡ç”¨å…¨å±€å‡å€¼æ± åŒ–(Avg-Pooling)æ›¿ä»£å…¨è¿æ¥å±‚ï¼Œå¾—åˆ°ç±»åˆ«ç»´åº¦å¤§å°çš„å‘é‡ï¼Œå†è¿›è¡Œåˆ†ç±»ã€‚è¿™ç§æ›¿ä»£å…¨è¿æ¥å±‚çš„æ–¹å¼æœ‰åˆ©äºå‡å°‘å‚æ•°ã€‚ Inception ç»“æ„çš„ä¸»è¦æ€è·¯æ˜¯æ€æ ·ç”¨å¯†é›†æˆåˆ†æ¥è¿‘ä¼¼æœ€ä¼˜çš„å±€éƒ¨ç¨€ç–ç»“æ„ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/13488994347434407a46d03298f222c8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-06T14:12:56+08:00" />
<meta property="article:modified_time" content="2024-01-06T14:12:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ITå­¦ä¹ è€…åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ITå­¦ä¹ è€…åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">äº’è”ç½‘åŠ ç«èµ› åŸºäºäººå·¥æ™ºèƒ½çš„å›¾åƒåˆ†ç±»ç®—æ³•ç ”ç©¶ä¸å®ç° - æ·±åº¦å­¦ä¹ å·ç§¯ç¥ç»ç½‘ç»œå›¾åƒåˆ†ç±»</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><a href="#0__3" rel="nofollow">0 ç®€ä»‹</a></li><li><a href="#1__16" rel="nofollow">1 å¸¸ç”¨çš„åˆ†ç±»ç½‘ç»œä»‹ç»</a></li><li><ul><li><a href="#11_CNN_18" rel="nofollow">1.1 CNN</a></li><li><a href="#12_VGG_36" rel="nofollow">1.2 VGG</a></li><li><a href="#13_GoogleNet_46" rel="nofollow">1.3 GoogleNet</a></li></ul> 
  </li><li><a href="#2__59" rel="nofollow">2 å›¾åƒåˆ†ç±»éƒ¨åˆ†ä»£ç å®ç°</a></li><li><ul><li><a href="#21__61" rel="nofollow">2.1 ç¯å¢ƒä¾èµ–</a></li><li><a href="#22__78" rel="nofollow">2.2 éœ€è¦å¯¼å…¥çš„åŒ…</a></li><li><a href="#23__103" rel="nofollow">2.3 å‚æ•°è®¾ç½®(è·¯å¾„ï¼Œå›¾åƒå°ºå¯¸ï¼Œæ•°æ®é›†åˆ†å‰²æ¯”ä¾‹)</a></li><li><a href="#24_preprocessedFoldernumpy_118" rel="nofollow">2.4 ä»preprocessedFolderè¯»å–å›¾ç‰‡å¹¶è¿”å›numpyæ ¼å¼(ä¾¿äºåœ¨ç¥ç»ç½‘ç»œä¸­è®­ç»ƒ)</a></li><li><a href="#25__149" rel="nofollow">2.5 æ•°æ®é¢„å¤„ç†</a></li><li><a href="#26__187" rel="nofollow">2.6 è®­ç»ƒåˆ†ç±»æ¨¡å‹</a></li><li><a href="#27__231" rel="nofollow">2.7 æ¨¡å‹è®­ç»ƒæ•ˆæœ</a></li><li><a href="#28__250" rel="nofollow">2.8 æ¨¡å‹æ€§èƒ½è¯„ä¼°</a></li></ul> 
  </li><li><a href="#3_1000_325" rel="nofollow">3 1000ç§å›¾åƒåˆ†ç±»</a></li><li><a href="#4__335" rel="nofollow">4 æœ€å</a></li></ul> 
</div> 
<p></p> 
<h2><a id="0__3"></a>0 ç®€ä»‹</h2> 
<p>ğŸ”¥ ä¼˜è´¨ç«èµ›é¡¹ç›®ç³»åˆ—ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯</p> 
<p><strong>åŸºäºäººå·¥æ™ºèƒ½çš„å›¾åƒåˆ†ç±»æŠ€æœ¯</strong></p> 
<p>è¯¥é¡¹ç›®è¾ƒä¸ºæ–°é¢–ï¼Œé€‚åˆä½œä¸ºç«èµ›è¯¾é¢˜æ–¹å‘ï¼Œå­¦é•¿éå¸¸æ¨èï¼</p> 
<p>ğŸ§¿ <strong>æ›´å¤šèµ„æ–™, é¡¹ç›®åˆ†äº«ï¼š</strong></p> 
<p><a href="https://gitee.com/dancheng-senior/postgraduate" rel="nofollow">https://gitee.com/dancheng-senior/postgraduate</a></p> 
<h2><a id="1__16"></a>1 å¸¸ç”¨çš„åˆ†ç±»ç½‘ç»œä»‹ç»</h2> 
<h3><a id="11_CNN_18"></a>1.1 CNN</h3> 
<p>ä¼ ç»ŸCNNåŒ…å«å·ç§¯å±‚ã€å…¨è¿æ¥å±‚ç­‰ç»„ä»¶ï¼Œå¹¶é‡‡ç”¨softmaxå¤šç±»åˆ«åˆ†ç±»å™¨å’Œå¤šç±»äº¤å‰ç†µæŸå¤±å‡½æ•°ã€‚å¦‚ä¸‹å›¾ï¼š</p> 
<p><img src="https://images2.imgbox.com/b0/7b/90AZJhnz_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<ul><li> <p>å·ç§¯å±‚(convolution layer): æ‰§è¡Œå·ç§¯æ“ä½œæå–åº•å±‚åˆ°é«˜å±‚çš„ç‰¹å¾ï¼Œå‘æ˜å‡ºå›¾ç‰‡å±€éƒ¨å…³è”æ€§è´¨å’Œç©ºé—´ä¸å˜æ€§è´¨ã€‚</p> </li><li> <p>æ± åŒ–å±‚(pooling layer): æ‰§è¡Œé™é‡‡æ ·æ“ä½œã€‚é€šè¿‡å–å·ç§¯è¾“å‡ºç‰¹å¾å›¾ä¸­å±€éƒ¨åŒºå—çš„æœ€å¤§å€¼(max-pooling)æˆ–è€…å‡å€¼(avg-pooling)ã€‚é™é‡‡æ ·ä¹Ÿæ˜¯å›¾åƒå¤„ç†ä¸­å¸¸è§çš„ä¸€ç§æ“ä½œï¼Œå¯ä»¥è¿‡æ»¤æ‰ä¸€äº›ä¸é‡è¦çš„é«˜é¢‘ä¿¡æ¯ã€‚</p> </li><li> <p>å…¨è¿æ¥å±‚(fully-connected layerï¼Œæˆ–è€…fc layer): è¾“å…¥å±‚åˆ°éšè—å±‚çš„ç¥ç»å…ƒæ˜¯å…¨éƒ¨è¿æ¥çš„ã€‚</p> </li><li> <p>éçº¿æ€§å˜åŒ–: å·ç§¯å±‚ã€å…¨è¿æ¥å±‚åé¢ä¸€èˆ¬éƒ½ä¼šæ¥éçº¿æ€§å˜åŒ–å±‚ï¼Œä¾‹å¦‚Sigmoidã€Tanhã€ReLuç­‰æ¥å¢å¼ºç½‘ç»œçš„è¡¨è¾¾èƒ½åŠ›ï¼Œåœ¨CNNé‡Œæœ€å¸¸ä½¿ç”¨çš„ä¸ºReLuæ¿€æ´»å‡½æ•°ã€‚</p> </li><li> <p>Dropout : åœ¨æ¨¡å‹è®­ç»ƒé˜¶æ®µéšæœºè®©ä¸€äº›éšå±‚èŠ‚ç‚¹æƒé‡ä¸å·¥ä½œï¼Œæé«˜ç½‘ç»œçš„æ³›åŒ–èƒ½åŠ›ï¼Œä¸€å®šç¨‹åº¦ä¸Šé˜²æ­¢è¿‡æ‹Ÿåˆ</p> </li></ul> 
<p>åœ¨CNNçš„è®­ç»ƒè¿‡ç¨‹æ€»ï¼Œç”±äºæ¯ä¸€å±‚çš„å‚æ•°éƒ½æ˜¯ä¸æ–­æ›´æ–°çš„ï¼Œä¼šå¯¼è‡´ä¸‹ä¸€æ¬¡è¾“å…¥åˆ†å¸ƒå‘ç”Ÿå˜åŒ–ï¼Œè¿™æ ·å°±éœ€è¦åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èŠ±è´¹æ—¶é—´å»è®¾è®¡å‚æ•°ã€‚åœ¨åç»­æå‡ºçš„BNç®—æ³•ä¸­ï¼Œç”±äºæ¯ä¸€å±‚éƒ½åšäº†å½’ä¸€åŒ–å¤„ç†ï¼Œä½¿å¾—æ¯ä¸€å±‚çš„åˆ†å¸ƒç›¸å¯¹ç¨³å®šï¼Œè€Œä¸”å®éªŒè¯æ˜è¯¥ç®—æ³•åŠ é€Ÿäº†æ¨¡å‹çš„æ”¶æ•›è¿‡ç¨‹ï¼Œæ‰€ä»¥è¢«å¹¿æ³›åº”ç”¨åˆ°è¾ƒæ·±çš„æ¨¡å‹ä¸­ã€‚</p> 
<h3><a id="12_VGG_36"></a>1.2 VGG</h3> 
<p>VGG æ¨¡å‹æ˜¯ç”±ç‰›æ´¥å¤§å­¦æå‡ºçš„ï¼ˆ19å±‚ç½‘ç»œï¼‰ï¼Œè¯¥æ¨¡å‹çš„ç‰¹ç‚¹æ˜¯åŠ å®½åŠ æ·±äº†ç½‘ç»œç»“æ„ï¼Œæ ¸å¿ƒæ˜¯äº”ç»„å·ç§¯æ“ä½œï¼Œæ¯ä¸¤ç»„ä¹‹é—´åšMax-<br> Poolingç©ºé—´é™ç»´ã€‚åŒä¸€ç»„å†…é‡‡ç”¨å¤šæ¬¡è¿ç»­çš„3X3å·ç§¯ï¼Œå·ç§¯æ ¸çš„æ•°ç›®ç”±è¾ƒæµ…ç»„çš„64å¢å¤šåˆ°æœ€æ·±ç»„çš„512ï¼ŒåŒä¸€ç»„å†…çš„å·ç§¯æ ¸æ•°ç›®æ˜¯ä¸€æ ·çš„ã€‚å·ç§¯ä¹‹åæ¥ä¸¤å±‚å…¨è¿æ¥å±‚ï¼Œä¹‹åæ˜¯åˆ†ç±»å±‚ã€‚è¯¥æ¨¡å‹ç”±äºæ¯ç»„å†…å·ç§¯å±‚çš„ä¸åŒä¸»è¦åˆ†ä¸º<br> 11ã€13ã€16ã€19 è¿™å‡ ç§æ¨¡å‹</p> 
<p><img src="https://images2.imgbox.com/05/7a/nd21Ohae_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>å¢åŠ ç½‘ç»œæ·±åº¦å’Œå®½åº¦ï¼Œä¹Ÿå°±æ„å‘³ç€å·¨é‡çš„å‚æ•°,è€Œå·¨é‡å‚æ•°å®¹æ˜“äº§ç”Ÿè¿‡æ‹Ÿåˆï¼Œä¹Ÿä¼šå¤§å¤§å¢åŠ è®¡ç®—é‡ã€‚</strong></p> 
<h3><a id="13_GoogleNet_46"></a>1.3 GoogleNet</h3> 
<p><strong>GoogleNetæ¨¡å‹ç”±å¤šç»„Inceptionæ¨¡å—ç»„æˆï¼Œæ¨¡å‹è®¾è®¡å€Ÿé‰´äº†NINçš„ä¸€äº›æ€æƒ³.</strong></p> 
<p><strong>NINæ¨¡å‹ç‰¹ç‚¹ï¼š</strong></p> 
<ul><li> <pre><code>1. å¼•å…¥äº†å¤šå±‚æ„ŸçŸ¥å·ç§¯ç½‘ç»œ(Multi-Layer Perceptron Convolution, MLPconv)ä»£æ›¿ä¸€å±‚çº¿æ€§å·ç§¯ç½‘ç»œã€‚MLPconvæ˜¯ä¸€ä¸ªå¾®å°çš„å¤šå±‚å·ç§¯ç½‘ç»œï¼Œå³åœ¨çº¿æ€§å·ç§¯åé¢å¢åŠ è‹¥å¹²å±‚1x1çš„å·ç§¯ï¼Œè¿™æ ·å¯ä»¥æå–å‡ºé«˜åº¦éçº¿æ€§ç‰¹å¾ã€‚
</code></pre> </li><li>2)è®¾è®¡æœ€åä¸€å±‚å·ç§¯å±‚åŒ…å«ç±»åˆ«ç»´åº¦å¤§å°çš„ç‰¹å¾å›¾ï¼Œç„¶åé‡‡ç”¨å…¨å±€å‡å€¼æ± åŒ–(Avg-Pooling)æ›¿ä»£å…¨è¿æ¥å±‚ï¼Œå¾—åˆ°ç±»åˆ«ç»´åº¦å¤§å°çš„å‘é‡ï¼Œå†è¿›è¡Œåˆ†ç±»ã€‚è¿™ç§æ›¿ä»£å…¨è¿æ¥å±‚çš„æ–¹å¼æœ‰åˆ©äºå‡å°‘å‚æ•°ã€‚</li></ul> 
<p><strong>Inception ç»“æ„çš„ä¸»è¦æ€è·¯æ˜¯æ€æ ·ç”¨å¯†é›†æˆåˆ†æ¥è¿‘ä¼¼æœ€ä¼˜çš„å±€éƒ¨ç¨€ç–ç»“æ„ã€‚</strong></p> 
<p><img src="https://images2.imgbox.com/de/f5/IcQBUov6_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="2__59"></a>2 å›¾åƒåˆ†ç±»éƒ¨åˆ†ä»£ç å®ç°</h2> 
<h3><a id="21__61"></a>2.1 ç¯å¢ƒä¾èµ–</h3> 
<p>â€‹</p> 
<pre><code class="prism language-python">python <span class="token number">3.7</span>
jupyter<span class="token operator">-</span>notebook <span class="token punctuation">:</span> <span class="token number">6.0</span><span class="token number">.3</span>
cudatoolkit <span class="token number">10.0</span><span class="token number">.130</span>
cudnn <span class="token number">7.6</span><span class="token number">.5</span>
tensorflow<span class="token operator">-</span>gpu <span class="token number">2.0</span><span class="token number">.0</span>
scikit<span class="token operator">-</span>learn <span class="token number">0.22</span><span class="token number">.1</span>
numpy
cv2
matplotlib
</code></pre> 
<h3><a id="22__78"></a>2.2 éœ€è¦å¯¼å…¥çš„åŒ…</h3> 
<p>â€‹</p> 
<pre><code class="prism language-python">  <span class="token keyword">import</span> os
  <span class="token keyword">import</span> cv2
  <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
  <span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
  <span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
  <span class="token keyword">from</span> tensorflow <span class="token keyword">import</span> keras
  <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras <span class="token keyword">import</span> layers<span class="token punctuation">,</span>models
  <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Sequential
  <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>optimizers <span class="token keyword">import</span> Adam
  <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>callbacks <span class="token keyword">import</span> Callback
  <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>utils <span class="token keyword">import</span> to_categorical
  <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>applications <span class="token keyword">import</span> VGG19
  <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> load_model
  <span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
  <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> label_binarize
  tf<span class="token punctuation">.</span>compat<span class="token punctuation">.</span>v1<span class="token punctuation">.</span>disable_eager_execution<span class="token punctuation">(</span><span class="token punctuation">)</span>
  os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">'CUDA_VISIBLE_DEVICES'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0'</span> <span class="token comment">#ä½¿ç”¨GPU</span>
</code></pre> 
<h3><a id="23__103"></a>2.3 å‚æ•°è®¾ç½®(è·¯å¾„ï¼Œå›¾åƒå°ºå¯¸ï¼Œæ•°æ®é›†åˆ†å‰²æ¯”ä¾‹)</h3> 
<p>â€‹</p> 
<pre><code class="prism language-python"> preprocessedFolder <span class="token operator">=</span> <span class="token string">'.\\ClassificationData\\'</span> <span class="token comment">#é¢„å¤„ç†æ–‡ä»¶å¤¹</span>
 outModelFileName<span class="token operator">=</span><span class="token string">".\\outModelFileName\\"</span> 
 ImageWidth <span class="token operator">=</span> <span class="token number">512</span>
 ImageHeight <span class="token operator">=</span> <span class="token number">320</span>
 ImageNumChannels <span class="token operator">=</span> <span class="token number">3</span>
 TrainingPercent <span class="token operator">=</span> <span class="token number">70</span>  <span class="token comment">#è®­ç»ƒé›†æ¯”ä¾‹</span>
 ValidationPercent <span class="token operator">=</span> <span class="token number">15</span> <span class="token comment">#éªŒè¯é›†æ¯”ä¾‹</span>
</code></pre> 
<h3><a id="24_preprocessedFoldernumpy_118"></a>2.4 ä»preprocessedFolderè¯»å–å›¾ç‰‡å¹¶è¿”å›numpyæ ¼å¼(ä¾¿äºåœ¨ç¥ç»ç½‘ç»œä¸­è®­ç»ƒ)</h3> 
<p>â€‹</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">read_dl_classifier_data_set</span><span class="token punctuation">(</span>preprocessedFolder<span class="token punctuation">)</span><span class="token punctuation">:</span>
  num <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># å›¾ç‰‡çš„æ€»æ•°é‡</span>
  cnt_class <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment">#å›¾ç‰‡æ‰€å±çš„ç±»åˆ«</span>
  label_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># å­˜æ”¾æ¯ä¸ªå›¾åƒçš„label,å›¾åƒçš„ç±»åˆ«</span>
  img_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>   <span class="token comment">#å­˜æ”¾å›¾ç‰‡æ•°æ®</span>
  <span class="token keyword">for</span> directory <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>preprocessedFolder<span class="token punctuation">)</span><span class="token punctuation">:</span>
      tmp_dir <span class="token operator">=</span> preprocessedFolder <span class="token operator">+</span> directory
      cnt_class <span class="token operator">+=</span> <span class="token number">1</span>
      <span class="token keyword">for</span> image <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>tmp_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
          num <span class="token operator">+=</span> <span class="token number">1</span>
          tmp_img_filepath <span class="token operator">=</span> tmp_dir <span class="token operator">+</span> <span class="token string">'\\'</span> <span class="token operator">+</span> image
          im <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>tmp_img_filepath<span class="token punctuation">)</span>  <span class="token comment"># numpy.ndarray</span>
          im <span class="token operator">=</span> cv2<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>im<span class="token punctuation">,</span> <span class="token punctuation">(</span>ImageWidth<span class="token punctuation">,</span> ImageHeight<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># é‡æ–°è®¾ç½®å›¾ç‰‡çš„å¤§å°</span>
          img_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>im<span class="token punctuation">)</span>
          label_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cnt_class<span class="token punctuation">)</span>  <span class="token comment"># åœ¨æ ‡ç­¾ä¸­æ·»åŠ ç±»åˆ«</span>
          <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Picture "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"Load "</span><span class="token operator">+</span>tmp_img_filepath<span class="token operator">+</span><span class="token string">"successfully"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å…±æœ‰"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"å¼ å›¾ç‰‡"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"all"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"picturs belong to "</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>cnt_class<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"classes"</span><span class="token punctuation">)</span>
<span class="token keyword">return</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>img_list<span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>label_list<span class="token punctuation">)</span>

all_data<span class="token punctuation">,</span>all_label<span class="token operator">=</span>read_dl_classifier_data_set<span class="token punctuation">(</span>preprocessedFolder<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/93/d1/pec9Qt0V_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="25__149"></a>2.5 æ•°æ®é¢„å¤„ç†</h3> 
<p><strong>å›¾åƒæ•°æ®å‹ç¼©, æ ‡ç­¾æ•°æ®è¿›è¡Œç‹¬ç«‹çƒ­ç¼–ç one-hot</strong></p> 
<p>â€‹</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">preprocess_dl_Image</span><span class="token punctuation">(</span>all_data<span class="token punctuation">,</span>all_label<span class="token punctuation">)</span><span class="token punctuation">:</span>
      all_data <span class="token operator">=</span> all_data<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">"float32"</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">255</span>  <span class="token comment">#æŠŠå›¾åƒç°åº¦å€¼å‹ç¼©åˆ°0--1.0ä¾¿äºç¥ç»ç½‘ç»œè®­ç»ƒ</span>
      all_label <span class="token operator">=</span> to_categorical<span class="token punctuation">(</span>all_label<span class="token punctuation">)</span>  <span class="token comment">#å¯¹æ ‡ç­¾æ•°æ®è¿›è¡Œç‹¬ç«‹çƒ­ç¼–ç </span>
      <span class="token keyword">return</span> all_data<span class="token punctuation">,</span>all_label

all_data<span class="token punctuation">,</span>all_label <span class="token operator">=</span> preprocess_dl_Image<span class="token punctuation">(</span>all_data<span class="token punctuation">,</span>all_label<span class="token punctuation">)</span> <span class="token comment">#å¤„ç†åçš„æ•°æ®</span>
</code></pre> 
<p><strong>å¯¹æ•°æ®åŠè¿›è¡Œåˆ’åˆ†ï¼ˆè®­ç»ƒé›†ï¼šéªŒè¯é›†ï¼šæµ‹è¯•é›† = 0.7:0.15:0.15ï¼‰</strong></p> 
<p>â€‹</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">split_dl_classifier_data_set</span><span class="token punctuation">(</span>all_data<span class="token punctuation">,</span>all_label<span class="token punctuation">,</span>TrainingPercent<span class="token punctuation">,</span>ValidationPercent<span class="token punctuation">)</span><span class="token punctuation">:</span>
      s <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>all_data<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>s<span class="token punctuation">)</span>  <span class="token comment">#éšæœºæ‰“ä¹±é¡ºåº</span>
      all_data <span class="token operator">=</span> all_data<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token comment">#æ‰“ä¹±åçš„å›¾åƒæ•°æ®</span>
      all_label <span class="token operator">=</span> all_label<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token comment">#æ‰“ä¹±åçš„æ ‡ç­¾æ•°æ®</span>
      all_len <span class="token operator">=</span> all_data<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
      train_len <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>all_len<span class="token operator">*</span>TrainingPercent<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span>  <span class="token comment">#è®­ç»ƒé›†é•¿åº¦</span>
      valadation_len <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>all_len<span class="token operator">*</span>ValidationPercent<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token comment">#éªŒè¯é›†é•¿åº¦</span>
      temp_len<span class="token operator">=</span>train_len<span class="token operator">+</span>valadation_len
      train_data<span class="token punctuation">,</span>train_label <span class="token operator">=</span> all_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>train_len<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span>all_label<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>train_len<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment">#è®­ç»ƒé›†</span>
      valadation_data<span class="token punctuation">,</span>valadation_label <span class="token operator">=</span> all_data<span class="token punctuation">[</span>train_len<span class="token punctuation">:</span>temp_len<span class="token punctuation">,</span> <span class="token punctuation">:</span> <span class="token punctuation">,</span> <span class="token punctuation">:</span> <span class="token punctuation">,</span> <span class="token punctuation">:</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>all_label<span class="token punctuation">[</span>train_len<span class="token punctuation">:</span>temp_len<span class="token punctuation">,</span> <span class="token punctuation">:</span> <span class="token punctuation">]</span> <span class="token comment">#éªŒè¯é›†</span>
      test_data<span class="token punctuation">,</span>test_label <span class="token operator">=</span> all_data<span class="token punctuation">[</span>temp_len<span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span> <span class="token punctuation">,</span> <span class="token punctuation">:</span> <span class="token punctuation">,</span> <span class="token punctuation">:</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>all_label<span class="token punctuation">[</span>temp_len<span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span> <span class="token punctuation">]</span> <span class="token comment">#æµ‹è¯•é›†</span>
      <span class="token keyword">return</span> train_data<span class="token punctuation">,</span>train_label<span class="token punctuation">,</span>valadation_data<span class="token punctuation">,</span>valadation_label<span class="token punctuation">,</span>test_data<span class="token punctuation">,</span>test_label

train_data<span class="token punctuation">,</span>train_label<span class="token punctuation">,</span>valadation_data<span class="token punctuation">,</span>valadation_label<span class="token punctuation">,</span>test_data<span class="token punctuation">,</span>test_label<span class="token operator">=</span>split_dl_classifier_data_set<span class="token punctuation">(</span>all_data<span class="token punctuation">,</span>all_label<span class="token punctuation">,</span>TrainingPercent<span class="token punctuation">,</span>ValidationPercent<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="26__187"></a>2.6 è®­ç»ƒåˆ†ç±»æ¨¡å‹</h3> 
<ul><li> <p>ä½¿ç”¨è¿ç§»å­¦ä¹ ï¼ˆåŸºäºVGG19ï¼‰</p> </li><li> <p>epochs = 30</p> </li><li> <p>batch_size = 16</p> </li><li> <p>ä½¿ç”¨ keras.callbacks.EarlyStopping æå‰ç»“æŸè®­ç»ƒ</p> <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">train_classifier</span><span class="token punctuation">(</span>train_data<span class="token punctuation">,</span>train_label<span class="token punctuation">,</span>valadation_data<span class="token punctuation">,</span>valadation_label<span class="token punctuation">,</span>lr<span class="token operator">=</span><span class="token number">1e-4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      conv_base <span class="token operator">=</span> VGG19<span class="token punctuation">(</span>weights<span class="token operator">=</span><span class="token string">'imagenet'</span><span class="token punctuation">,</span>
              include_top<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
              input_shape<span class="token operator">=</span><span class="token punctuation">(</span>ImageHeight<span class="token punctuation">,</span> ImageWidth<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  
      model <span class="token operator">=</span> models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
      model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>conv_base<span class="token punctuation">)</span>
      model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>layers<span class="token punctuation">.</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
      model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>layers<span class="token punctuation">.</span>Dense<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#Dense: å…¨è¿æ¥å±‚ã€‚activation: æ¿€åŠ±å‡½æ•°ï¼Œâ€˜linearâ€™ä¸€èˆ¬ç”¨åœ¨å›å½’ä»»åŠ¡çš„è¾“å‡ºå±‚ï¼Œè€Œâ€˜softmaxâ€™ä¸€èˆ¬ç”¨åœ¨åˆ†ç±»ä»»åŠ¡çš„è¾“å‡ºå±‚</span>
      conv_base<span class="token punctuation">.</span>trainable<span class="token operator">=</span><span class="token boolean">False</span>
      model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>
      loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span><span class="token comment">#loss: æ‹ŸåˆæŸå¤±æ–¹æ³•ï¼Œè¿™é‡Œç”¨åˆ°äº†å¤šåˆ†ç±»æŸå¤±å‡½æ•°äº¤å‰ç†µ  </span>
      optimizer<span class="token operator">=</span>Adam<span class="token punctuation">(</span>lr<span class="token operator">=</span>lr<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#optimizer: ä¼˜åŒ–å™¨ï¼Œæ¢¯åº¦ä¸‹é™çš„ä¼˜åŒ–æ–¹æ³• #rmsprop</span>
      metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#æ¯ä¸ªå±‚ä¸­çš„è¾“å‡ºå½¢çŠ¶å’Œå‚æ•°ã€‚</span>
      early_stoping <span class="token operator">=</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>EarlyStopping<span class="token punctuation">(</span>monitor<span class="token operator">=</span><span class="token string">"val_loss"</span><span class="token punctuation">,</span>min_delta<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>patience<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>verbose<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>baseline<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>restore_best_weights<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
      history <span class="token operator">=</span> model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>
      train_data<span class="token punctuation">,</span> train_label<span class="token punctuation">,</span>
      batch_size<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token comment">#æ›´æ–°æ¢¯åº¦çš„æ‰¹æ•°æ®çš„å¤§å° iteration = epochs / batch_size,</span>
      epochs<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>  <span class="token comment"># è¿­ä»£æ¬¡æ•°</span>
      validation_data<span class="token operator">=</span><span class="token punctuation">(</span>valadation_data<span class="token punctuation">,</span> valadation_label<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># éªŒè¯é›†</span>
      callbacks<span class="token operator">=</span><span class="token punctuation">[</span>early_stoping<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> model<span class="token punctuation">,</span>history
model<span class="token punctuation">,</span>history <span class="token operator">=</span> train_classifier<span class="token punctuation">(</span>train_data<span class="token punctuation">,</span>train_label<span class="token punctuation">,</span>valadation_data<span class="token punctuation">,</span>valadation_label<span class="token punctuation">,</span><span class="token punctuation">)</span>
</code></pre> </li></ul> 
<p><img src="https://images2.imgbox.com/06/34/32Sr0RGv_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="27__231"></a>2.7 æ¨¡å‹è®­ç»ƒæ•ˆæœ</h3> 
<p>â€‹</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">plot_history</span><span class="token punctuation">(</span>history<span class="token punctuation">)</span><span class="token punctuation">:</span>
      history_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>history<span class="token punctuation">.</span>history<span class="token punctuation">)</span>
      history_df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'loss'</span><span class="token punctuation">,</span> <span class="token string">'val_loss'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
      plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Train and valadation loss'</span><span class="token punctuation">)</span>
      history_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>history<span class="token punctuation">.</span>history<span class="token punctuation">)</span>
      history_df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">,</span> <span class="token string">'val_accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
      plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Train and valadation accuracy'</span><span class="token punctuation">)</span>

plot_history<span class="token punctuation">(</span>history<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/7a/aa/RfeZFJFX_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="28__250"></a>2.8 æ¨¡å‹æ€§èƒ½è¯„ä¼°</h3> 
<ul><li> <p>ä½¿ç”¨æµ‹è¯•é›†è¿›è¡Œè¯„ä¼°</p> </li><li> <p>è¾“å‡ºåˆ†ç±»æŠ¥å‘Šå’Œæ··æ·†çŸ©é˜µ</p> </li><li> <p>ç»˜åˆ¶ROCå’ŒAUCæ›²çº¿</p> <pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> confusion_matrix
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
Y_pred_tta<span class="token operator">=</span>model<span class="token punctuation">.</span>predict_classes<span class="token punctuation">(</span>test_data<span class="token punctuation">)</span> <span class="token comment">#æ¨¡å‹å¯¹æµ‹è¯•é›†æ•°æ®è¿›è¡Œé¢„æµ‹</span>
Y_test <span class="token operator">=</span> <span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>one_hot<span class="token punctuation">)</span><span class="token keyword">for</span> one_hot <span class="token keyword">in</span> test_label<span class="token punctuation">]</span><span class="token comment"># ç”±one-hotè½¬æ¢ä¸ºæ™®é€šnpæ•°ç»„</span>
Y_pred_tta<span class="token operator">=</span>model<span class="token punctuation">.</span>predict_classes<span class="token punctuation">(</span>test_data<span class="token punctuation">)</span> <span class="token comment">#æ¨¡å‹å¯¹æµ‹è¯•é›†è¿›è¡Œé¢„æµ‹</span>
Y_test <span class="token operator">=</span> <span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>one_hot<span class="token punctuation">)</span><span class="token keyword">for</span> one_hot <span class="token keyword">in</span> test_label<span class="token punctuation">]</span><span class="token comment"># ç”±one-hotè½¬æ¢ä¸ºæ™®é€šnpæ•°ç»„</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'éªŒè¯é›†åˆ†ç±»æŠ¥å‘Šï¼š\n'</span><span class="token punctuation">,</span>classification_report<span class="token punctuation">(</span>Y_test<span class="token punctuation">,</span>Y_pred_tta<span class="token punctuation">)</span><span class="token punctuation">)</span>
confusion_mc <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>Y_test<span class="token punctuation">,</span>Y_pred_tta<span class="token punctuation">)</span><span class="token comment">#æ··æ·†çŸ©é˜µ</span>
df_cm <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>confusion_mc<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>df_cm<span class="token punctuation">,</span> annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">"BuPu"</span><span class="token punctuation">,</span>linewidths<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">"d"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'PipeLine accuracy:{0:.3f}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>accuracy_score<span class="token punctuation">(</span>Y_test<span class="token punctuation">,</span>Y_pred_tta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'True label'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Predicted label'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
</code></pre> </li></ul> 
<p><img src="https://images2.imgbox.com/eb/c8/pzaw97Ut_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/27/59/Saa9n5Fd_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>â€‹</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> precision_recall_curve
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> average_precision_score
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> roc_curve
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics
<span class="token keyword">import</span> matplotlib <span class="token keyword">as</span> mpl

<span class="token comment"># è®¡ç®—å±äºå„ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œè¿”å›å€¼çš„shape = [n_samples, n_classes]</span>
y_score <span class="token operator">=</span> model<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>test_data<span class="token punctuation">)</span>
<span class="token comment"># 1ã€è°ƒç”¨å‡½æ•°è®¡ç®—éªŒè¯é›†çš„AUC </span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">'è°ƒç”¨å‡½æ•°aucï¼š'</span><span class="token punctuation">,</span> metrics<span class="token punctuation">.</span>roc_auc_score<span class="token punctuation">(</span>test_label<span class="token punctuation">,</span> y_score<span class="token punctuation">,</span> average<span class="token operator">=</span><span class="token string">'micro'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 2ã€æ‰‹åŠ¨è®¡ç®—éªŒè¯é›†çš„AUC</span>
<span class="token comment">#é¦–å…ˆå°†çŸ©é˜µtest_labelå’Œy_scoreå±•å¼€ï¼Œç„¶åè®¡ç®—å‡æ­£ä¾‹ç‡FPRå’ŒçœŸæ­£ä¾‹ç‡TPR</span>
fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span> thresholds <span class="token operator">=</span> metrics<span class="token punctuation">.</span>roc_curve<span class="token punctuation">(</span>test_label<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>y_score<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
auc <span class="token operator">=</span> metrics<span class="token punctuation">.</span>auc<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'æ‰‹åŠ¨è®¡ç®—aucï¼š'</span><span class="token punctuation">,</span> auc<span class="token punctuation">)</span>
mpl<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">u'SimHei'</span>
mpl<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token comment">#FPRå°±æ˜¯æ¨ªåæ ‡,TPRå°±æ˜¯çºµåæ ‡</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token string">'r'</span><span class="token punctuation">,</span> lw <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">0.7</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">u'AUC=%.3f'</span> <span class="token operator">%</span> auc<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token string">'#808080'</span><span class="token punctuation">,</span> lw <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> ls <span class="token operator">=</span> <span class="token string">'--'</span><span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">0.7</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">1.02</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">1.02</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'False Positive Rate'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'True Positive Rate'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>b<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> ls<span class="token operator">=</span><span class="token string">':'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'lower right'</span><span class="token punctuation">,</span> fancybox<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> framealpha<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'37ä¸ªéªŒè¯é›†åˆ†ç±»åçš„ROCå’ŒAUC'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">18</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f2/c7/fVVNsvsw_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="3_1000_325"></a>3 1000ç§å›¾åƒåˆ†ç±»</h2> 
<p>è¿™æ˜¯å­¦é•¿è®­ç»ƒçš„èƒ½è¯†åˆ«1000ç§ç±»ç›®æ ‡çš„å›¾åƒåˆ†ç±»æ¨¡å‹ï¼Œæ¼”ç¤ºæ•ˆæœå¦‚ä¸‹</p> 
<p><img src="https://images2.imgbox.com/a2/79/ucURpxAc_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/72/e3/HYbnMclz_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/34/06/pv5b5Owi_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="4__335"></a>4 æœ€å</h2> 
<p>ğŸ§¿ <strong>æ›´å¤šèµ„æ–™, é¡¹ç›®åˆ†äº«ï¼š</strong></p> 
<p><a href="https://gitee.com/dancheng-senior/postgraduate" rel="nofollow">https://gitee.com/dancheng-senior/postgraduate</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6fa1f8a380a90e1530b2b57767e9baad/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">åä¸ºODæœºè¯•2024å¹´æœ€æ–°é¢˜åº“ï¼ˆPythonã€JAVAã€C&#43;&#43;ã€JSï¼‰</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5dbe09105384668e18c97b51e147f6d6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">ã€LeetCodeã€‘1341. ç”µå½±è¯„åˆ†</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ITå­¦ä¹ è€…åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>