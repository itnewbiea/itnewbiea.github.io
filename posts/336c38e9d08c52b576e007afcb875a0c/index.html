<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Pandas教程：教你DataFrame数据的条件筛选——精选篇 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Pandas教程：教你DataFrame数据的条件筛选——精选篇" />
<meta property="og:description" content="1.1DataFrame数据的筛选与分布统计的示例用法
import pandas as pd data = {&#39;诗人&#39;: [&#39;李白&#39;, &#39;苏轼&#39;, &#39;李清照&#39;, &#39;杜甫&#39;, &#39;岳飞&#39;], &#39;性别&#39;: [&#39;男&#39;, &#39;男&#39;, &#39;女&#39;, &#39;男&#39;, &#39;男&#39;], &#39;芳龄&#39;: [18, 26, 13, 15, 28], &#39;朝代&#39;: [&#39;唐&#39;, &#39;北宋&#39;, &#39;宋&#39;, &#39;唐&#39;, &#39;南宋&#39;], &#39;薪资&#39;: [9000, 7000, 8000, 5000, 7000]} df = pd.DataFrame(data, index=[&#39;一&#39;, &#39;二&#39;, &#39;三&#39;, &#39;四&#39;, &#39;五&#39;]) print(&#39;0.原始DataFrame数据&#39;.center(40, &#39;-&#39;)) print(df) print(&#39;1.计数器：统计性别字段里面，男女的分别个数&#39;.center(40, &#39;-&#39;)) print(df[&#39;性别&#39;].value_counts()) print(&#39;显示占比，在数量统计的基础上加一个参数 normalize=True&#39;.center(40, &#39;-&#39;)) print(df[&#39;性别&#39;].value_counts(normalize=True)) print(&#39;2.筛选出性别为男的数据&#39;.center(40, &#39;-&#39;)) print(df[df[&#39;性别&#39;] == &#39;男&#39;]) print(&#39;3.筛选出朝代是唐，宋的数据&#39;.center(40, &#39;-&#39;)) print(df[df[&#39;朝代&#39;].isin([&#39;唐&#39;, &#39;宋&#39;])]) print(&#39;4.筛选出薪资大于等于8000的数据&#39;.center(40, &#39;-&#39;)) print(df[df[&#39;薪资&#39;] &gt;= 8000]) 输出内容：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/336c38e9d08c52b576e007afcb875a0c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-08T10:38:21+08:00" />
<meta property="article:modified_time" content="2023-12-08T10:38:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Pandas教程：教你DataFrame数据的条件筛选——精选篇</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>1.1DataFrame数据的筛选与分布统计的示例用法</strong></p> 
<pre><code class="prism language-bash"><span class="token function">import</span> pandas as pd

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'诗人'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">'李白'</span>, <span class="token string">'苏轼'</span>, <span class="token string">'李清照'</span>, <span class="token string">'杜甫'</span>, <span class="token string">'岳飞'</span><span class="token punctuation">]</span>,
        <span class="token string">'性别'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">'男'</span>, <span class="token string">'男'</span>, <span class="token string">'女'</span>, <span class="token string">'男'</span>, <span class="token string">'男'</span><span class="token punctuation">]</span>,
        <span class="token string">'芳龄'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token number">18</span>, <span class="token number">26</span>, <span class="token number">13</span>, <span class="token number">15</span>, <span class="token number">28</span><span class="token punctuation">]</span>,
        <span class="token string">'朝代'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">'唐'</span>, <span class="token string">'北宋'</span>, <span class="token string">'宋'</span>, <span class="token string">'唐'</span>, <span class="token string">'南宋'</span><span class="token punctuation">]</span>,
        <span class="token string">'薪资'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token number">9000</span>, <span class="token number">7000</span>, <span class="token number">8000</span>, <span class="token number">5000</span>, <span class="token number">7000</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

<span class="token function">df</span> <span class="token operator">=</span> pd.DataFrame<span class="token punctuation">(</span>data, <span class="token assign-left variable">index</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'一'</span>, <span class="token string">'二'</span>, <span class="token string">'三'</span>, <span class="token string">'四'</span>, <span class="token string">'五'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span><span class="token string">'0.原始DataFrame数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">)</span>

print<span class="token punctuation">(</span><span class="token string">'1.计数器：统计性别字段里面，男女的分别个数'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'性别'</span><span class="token punctuation">]</span>.value_counts<span class="token punctuation">(</span><span class="token punctuation">))</span>

print<span class="token punctuation">(</span><span class="token string">'显示占比，在数量统计的基础上加一个参数 normalize=True'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'性别'</span><span class="token punctuation">]</span>.value_counts<span class="token punctuation">(</span>normalize<span class="token operator">=</span>True<span class="token punctuation">))</span>

print<span class="token punctuation">(</span><span class="token string">'2.筛选出性别为男的数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'性别'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'男'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

print<span class="token punctuation">(</span><span class="token string">'3.筛选出朝代是唐，宋的数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'朝代'</span><span class="token punctuation">]</span>.isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'唐'</span>, <span class="token string">'宋'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

print<span class="token punctuation">(</span><span class="token string">'4.筛选出薪资大于等于8000的数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'薪资'</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token number">8000</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出内容：</p> 
<pre><code class="prism language-bash">------------0.原始DataFrame数据-------------
    诗人 性别  芳龄  朝代    薪资
一   李白  男  <span class="token number">18</span>   唐  <span class="token number">9000</span>
二   苏轼  男  <span class="token number">26</span>  北宋  <span class="token number">7000</span>
三  李清照  女  <span class="token number">13</span>   宋  <span class="token number">8000</span>
四   杜甫  男  <span class="token number">15</span>   唐  <span class="token number">5000</span>
五   岳飞  男  <span class="token number">28</span>  南宋  <span class="token number">7000</span>
---------1.计数器：统计性别字段里面，男女的分别个数---------
性别
男    <span class="token number">4</span>
女    <span class="token number">1</span>
Name: count, dtype: int64
---显示占比，在数量统计的基础上加一个参数 <span class="token assign-left variable">normalize</span><span class="token operator">=</span>True---
性别
男    <span class="token number">0.8</span>
女    <span class="token number">0.2</span>
Name: proportion, dtype: float64
--------------2.筛选出性别为男的数据--------------
   诗人 性别  芳龄  朝代    薪资
一  李白  男  <span class="token number">18</span>   唐  <span class="token number">9000</span>
二  苏轼  男  <span class="token number">26</span>  北宋  <span class="token number">7000</span>
四  杜甫  男  <span class="token number">15</span>   唐  <span class="token number">5000</span>
五  岳飞  男  <span class="token number">28</span>  南宋  <span class="token number">7000</span>
-------------3.筛选出朝代是唐，宋的数据-------------
    诗人 性别  芳龄 朝代    薪资
一   李白  男  <span class="token number">18</span>  唐  <span class="token number">9000</span>
三  李清照  女  <span class="token number">13</span>  宋  <span class="token number">8000</span>
四   杜甫  男  <span class="token number">15</span>  唐  <span class="token number">5000</span>
-----------4.筛选出薪资大于等于8000的数据-----------
    诗人 性别  芳龄 朝代    薪资
一   李白  男  <span class="token number">18</span>  唐  <span class="token number">9000</span>
三  李清照  女  <span class="token number">13</span>  宋  <span class="token number">8000</span>
</code></pre> 
<p><strong>2.不同列/字段的数据值的比较：</strong> 例如我们可以筛选出A列大于等于B列的数据，<strong>如果ab是一个字符串的类型数据，可以使用astype(int)先将他们转化成数值类型，再作比较运算</strong>，可以使用下面的代码。</p> 
<pre><code class="prism language-bash"><span class="token function">import</span> pandas as pd

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'A'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token number">100</span>, <span class="token number">10</span>, <span class="token number">50</span>, <span class="token number">34</span>, <span class="token number">20</span><span class="token punctuation">]</span>,
        <span class="token string">'B'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token number">10</span>, <span class="token number">20</span>, <span class="token number">30</span>, <span class="token number">40</span>, <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token function">df</span> <span class="token operator">=</span> pd.DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

print<span class="token punctuation">(</span><span class="token string">'0.原始dataFrame数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
print<span class="token punctuation">(</span><span class="token string">'0.筛选A列大于等于B列的数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
<span class="token comment"># 先将B列字段类型转为数值类型</span>
<span class="token comment"># df['B'] = df['B'].astype(int)</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> df<span class="token punctuation">[</span><span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出内容：</p> 
<pre><code class="prism language-bash">------------0.原始dataFrame数据-------------
     A   B
<span class="token number">0</span>  <span class="token number">100</span>  <span class="token number">10</span>
<span class="token number">1</span>   <span class="token number">10</span>  <span class="token number">20</span>
<span class="token number">2</span>   <span class="token number">50</span>  <span class="token number">30</span>
<span class="token number">3</span>   <span class="token number">34</span>  <span class="token number">40</span>
<span class="token number">4</span>   <span class="token number">20</span>  <span class="token number">50</span>
------------0.筛选A列大于等于B列的数据-------------
     A   B
<span class="token number">0</span>  <span class="token number">100</span>  <span class="token number">10</span>
<span class="token number">2</span>   <span class="token number">50</span>  <span class="token number">30</span>
</code></pre> 
<p><strong>3.筛选数据data中年龄字段值，不为空的数据</strong></p> 
<pre><code class="prism language-bash"><span class="token function">import</span> pandas as pd
<span class="token function">import</span> numpy as np

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'name'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span>, <span class="token string">'Bob'</span>, <span class="token string">'Charlie'</span><span class="token punctuation">]</span>,
        <span class="token string">'age'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token number">25</span>, np.nan, <span class="token number">35</span><span class="token punctuation">]</span>,
        <span class="token string">'city'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">'New York'</span>, np.nan, np.nan<span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token function">df</span> <span class="token operator">=</span> pd.DataFrame<span class="token punctuation">(</span>data, <span class="token assign-left variable">index</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span>, <span class="token number">1</span>, <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span><span class="token string">'0.原始DataFrame数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
print<span class="token punctuation">(</span><span class="token string">'1.获取字段值不为空的数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">]</span>.notna<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span><span class="token string">'2.获取字段值为空的数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">]</span>.isna<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出内容：</p> 
<pre><code class="prism language-bash">------------0.原始DataFrame数据-------------
      name   age      city
<span class="token number">0</span>    Alice  <span class="token number">25.0</span>  New York
<span class="token number">1</span>      Bob   NaN       NaN
<span class="token number">2</span>  Charlie  <span class="token number">35.0</span>       NaN
-------------1.检查字段值不为空的数据--------------
      name   age      city
<span class="token number">0</span>    Alice  <span class="token number">25.0</span>  New York
<span class="token number">2</span>  Charlie  <span class="token number">35.0</span>       NaN
-------------2.检查字段值不为空的数据--------------
  name  age city
<span class="token number">1</span>  Bob  NaN  NaN
</code></pre> 
<p><strong>4.按关键字匹配文本数据</strong></p> 
<pre><code class="prism language-bash"><span class="token function">import</span> pandas as pd

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'诗人'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">'李白'</span>, <span class="token string">'苏轼'</span>, <span class="token string">'李清照'</span>, <span class="token string">'杜甫'</span>, <span class="token string">'岳飞'</span><span class="token punctuation">]</span>,
        <span class="token string">'性别'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">'男'</span>, <span class="token string">'男'</span>, <span class="token string">'女'</span>, <span class="token string">'男'</span>, <span class="token string">'男'</span><span class="token punctuation">]</span>,
        <span class="token string">'芳龄'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token number">18</span>, <span class="token number">26</span>, <span class="token number">13</span>, <span class="token number">15</span>, <span class="token number">28</span><span class="token punctuation">]</span>,
        <span class="token string">'朝代'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">'唐'</span>, <span class="token string">'北宋'</span>, <span class="token string">'宋'</span>, <span class="token string">'唐'</span>, <span class="token string">'南宋'</span><span class="token punctuation">]</span>,
        <span class="token string">'薪资'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token number">9000</span>, <span class="token number">7000</span>, <span class="token number">8000</span>, <span class="token number">5000</span>, <span class="token number">7000</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

<span class="token function">df</span> <span class="token operator">=</span> pd.DataFrame<span class="token punctuation">(</span>data, <span class="token assign-left variable">index</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'一'</span>, <span class="token string">'二'</span>, <span class="token string">'三'</span>, <span class="token string">'四'</span>, <span class="token string">'五'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span><span class="token string">'0.原始DataFrame数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">)</span>

print<span class="token punctuation">(</span><span class="token string">'1.在朝代列中筛选出，含有宋的关键字，即南宋，北宋，宋'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'朝代'</span><span class="token punctuation">]</span>.str.contains<span class="token punctuation">(</span><span class="token string">'宋'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

print<span class="token punctuation">(</span><span class="token string">'2.使用~符号，选出不含有"宋"的数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span>~df<span class="token punctuation">[</span><span class="token string">'朝代'</span><span class="token punctuation">]</span>.str.contains<span class="token punctuation">(</span><span class="token string">'宋'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

print<span class="token punctuation">(</span><span class="token string">'3.字段中含有 唐|北宋 的数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'朝代'</span><span class="token punctuation">]</span>.str.contains<span class="token punctuation">(</span><span class="token string">'唐|北宋'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

print<span class="token punctuation">(</span><span class="token string">'4.字段中字符长度，小于等于2的数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'诗人'</span><span class="token punctuation">]</span>.str.len<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出内容：</p> 
<pre><code class="prism language-bash">------------0.原始DataFrame数据-------------
    诗人 性别  芳龄  朝代    薪资
一   李白  男  <span class="token number">18</span>   唐  <span class="token number">9000</span>
二   苏轼  男  <span class="token number">26</span>  北宋  <span class="token number">7000</span>
三  李清照  女  <span class="token number">13</span>   宋  <span class="token number">8000</span>
四   杜甫  男  <span class="token number">15</span>   唐  <span class="token number">5000</span>
五   岳飞  男  <span class="token number">28</span>  南宋  <span class="token number">7000</span>
------1.在朝代列中筛选出，含有宋的关键字，即南宋，北宋，宋-------
    诗人 性别  芳龄  朝代    薪资
二   苏轼  男  <span class="token number">26</span>  北宋  <span class="token number">7000</span>
三  李清照  女  <span class="token number">13</span>   宋  <span class="token number">8000</span>
五   岳飞  男  <span class="token number">28</span>  南宋  <span class="token number">7000</span>
----------2.使用~符号，选出不含有<span class="token string">"宋"</span>的数据-----------
   诗人 性别  芳龄 朝代    薪资
一  李白  男  <span class="token number">18</span>  唐  <span class="token number">9000</span>
四  杜甫  男  <span class="token number">15</span>  唐  <span class="token number">5000</span>
------------3.字段中含有 唐<span class="token operator">|</span>北宋 的数据------------
   诗人 性别  芳龄  朝代    薪资
一  李白  男  <span class="token number">18</span>   唐  <span class="token number">9000</span>
二  苏轼  男  <span class="token number">26</span>  北宋  <span class="token number">7000</span>
四  杜甫  男  <span class="token number">15</span>   唐  <span class="token number">5000</span>
-----------4.字段中字符长度，小于等于2的数据-----------
   诗人 性别  芳龄  朝代    薪资
一  李白  男  <span class="token number">18</span>   唐  <span class="token number">9000</span>
二  苏轼  男  <span class="token number">26</span>  北宋  <span class="token number">7000</span>
四  杜甫  男  <span class="token number">15</span>   唐  <span class="token number">5000</span>
五  岳飞  男  <span class="token number">28</span>  南宋  <span class="token number">7000</span>
</code></pre> 
<p><strong>5.日期筛选：<strong>除了对数值和字符进行筛选，Pandas也能像 Excel 那样根据日期筛选数据，例如筛选 2023 年&gt;=(2023, 12, 15)的数据，就可以使用下面的代码。同样</strong>如果****字段列，不是日期类型的数据，需要先使用.astype转化，然后才能比较。</strong></p> 
<pre><code class="prism language-bash"><span class="token function">import</span> pandas as pd
<span class="token function">import</span> numpy as np

<span class="token comment"># 创建日期序列</span>
date_list <span class="token operator">=</span> pd.date_range<span class="token punctuation">(</span><span class="token string">'2023-12-01'</span>, <span class="token assign-left variable">periods</span><span class="token operator">=</span><span class="token number">20</span>, <span class="token assign-left variable">freq</span><span class="token operator">=</span><span class="token string">'D'</span><span class="token punctuation">)</span>
value_list <span class="token operator">=</span> np.random.randn<span class="token punctuation">(</span>len<span class="token punctuation">(</span>date_list<span class="token punctuation">))</span>

<span class="token function">df</span> <span class="token operator">=</span> pd.DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">'日期'</span><span class="token builtin class-name">:</span> date_list,
    <span class="token string">'数值'</span><span class="token builtin class-name">:</span> value_list<span class="token punctuation">}</span><span class="token punctuation">)</span>

print<span class="token punctuation">(</span><span class="token string">'0.原始DataFrame数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token comment"># 先将 上市日期 字段转为 python 中的日期类型</span>
print<span class="token punctuation">(</span><span class="token string">'1.筛选日期 &gt;=(2023, 12, 15)的数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
<span class="token comment">#  df['日期'] = df['日期'].astype('datetime64[ns]')</span>
<span class="token comment"># 筛选 2023 年新上市的A股企业</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'日期'</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> pd.Timestamp<span class="token punctuation">(</span><span class="token number">2023</span>, <span class="token number">12</span>, <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>**6.多条件筛选：<strong>当存在多个条件时，每个条件最好都使用括号括起来，如果其中两个条件是“或”关系，那么使用逻辑或符号</strong>|<strong>来连接它们；如果两个条件的关系是“与”关系，那么就要用逻辑与符号</strong>&amp;**来连接它们</p> 
<pre><code class="prism language-bash"><span class="token function">import</span> pandas as pd

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'诗人'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">'李白'</span>, <span class="token string">'苏轼'</span>, <span class="token string">'李清照'</span>, <span class="token string">'杜甫'</span>, <span class="token string">'岳飞'</span><span class="token punctuation">]</span>,
        <span class="token string">'性别'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">'男'</span>, <span class="token string">'男'</span>, <span class="token string">'女'</span>, <span class="token string">'男'</span>, <span class="token string">'男'</span><span class="token punctuation">]</span>,
        <span class="token string">'芳龄'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token number">18</span>, <span class="token number">26</span>, <span class="token number">13</span>, <span class="token number">15</span>, <span class="token number">28</span><span class="token punctuation">]</span>,
        <span class="token string">'朝代'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">'唐'</span>, <span class="token string">'北宋'</span>, <span class="token string">'宋'</span>, <span class="token string">'唐'</span>, <span class="token string">'南宋'</span><span class="token punctuation">]</span>,
        <span class="token string">'薪资'</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token number">9000</span>, <span class="token number">7000</span>, <span class="token number">8000</span>, <span class="token number">5000</span>, <span class="token number">7000</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

<span class="token function">df</span> <span class="token operator">=</span> pd.DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
print<span class="token punctuation">(</span><span class="token string">'0.原始DataFrame数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">)</span>

print<span class="token punctuation">(</span><span class="token string">'1.且用法: 即朝代为唐或北宋，且薪资&gt;=7000'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'朝代'</span><span class="token punctuation">]</span>.isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'唐'</span>, <span class="token string">'北宋'</span><span class="token punctuation">]</span><span class="token punctuation">))</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'薪资'</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token number">7000</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

print<span class="token punctuation">(</span><span class="token string">'2.或用法: 筛选出性别为女，或薪资 &gt;= 9000的数据'</span>.center<span class="token punctuation">(</span><span class="token number">40</span>, <span class="token string">'-'</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'性别'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'女'</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'薪资'</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token number">9000</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出内容：</p> 
<pre><code class="prism language-bash">------------0.原始DataFrame数据-------------
    诗人 性别  芳龄  朝代    薪资
<span class="token number">0</span>   李白  男  <span class="token number">18</span>   唐  <span class="token number">9000</span>
<span class="token number">1</span>   苏轼  男  <span class="token number">26</span>  北宋  <span class="token number">7000</span>
<span class="token number">2</span>  李清照  女  <span class="token number">13</span>   宋  <span class="token number">8000</span>
<span class="token number">3</span>   杜甫  男  <span class="token number">15</span>   唐  <span class="token number">5000</span>
<span class="token number">4</span>   岳飞  男  <span class="token number">28</span>  南宋  <span class="token number">7000</span>
-------1.且用法: 即朝代为唐或北宋，且薪资<span class="token operator">&gt;=</span><span class="token number">7000</span>--------
   诗人 性别  芳龄  朝代    薪资
<span class="token number">0</span>  李白  男  <span class="token number">18</span>   唐  <span class="token number">9000</span>
<span class="token number">1</span>  苏轼  男  <span class="token number">26</span>  北宋  <span class="token number">7000</span>
-----2.或用法: 筛选出性别为女，或薪资 <span class="token operator">&gt;=</span> <span class="token number">9000</span>的数据------
    诗人 性别  芳龄 朝代    薪资
<span class="token number">0</span>   李白  男  <span class="token number">18</span>  唐  <span class="token number">9000</span>
<span class="token number">2</span>  李清照  女  <span class="token number">13</span>  宋  <span class="token number">8000</span>
</code></pre> 
<p><font face="幼圆" size="4" color="red">感兴趣的小伙伴，赠送全套Python学习资料，包含面试题、简历资料等具体看下方。<br> </font><br> <img src="https://images2.imgbox.com/f5/84/YZ6e4kAz_o.png"></p> 
<p><strong>一、Python所有方向的学习路线</strong></p> 
<p>Python所有方向的技术点做的整理，形成各个领域的知识点汇总，它的用处就在于，你可以按照下面的知识点去找对应的学习资源，保证自己学得较为全面。</p> 
<p><img src="https://images2.imgbox.com/a9/69/fsO5wRBl_o.png" alt="img"><br> <img src="https://images2.imgbox.com/63/d2/QJGWaQdN_o.png" alt="img"></p> 
<p><strong>二、Python必备开发工具</strong></p> 
<p>工具都帮大家整理好了，安装就可直接上手！<img src="https://images2.imgbox.com/5f/df/cLOazxOa_o.gif" alt="img"></p> 
<p><strong>三、最新Python学习笔记</strong></p> 
<p>当我学到一定基础，有自己的理解能力的时候，会去阅读一些前辈整理的书籍或者手写的笔记资料，这些笔记详细记载了他们对一些技术点的理解，这些理解是比较独到，可以学到不一样的思路。</p> 
<p><img src="https://images2.imgbox.com/90/c5/UsQWATGu_o.png" alt="img"></p> 
<p><strong>四、Python视频合集</strong></p> 
<p>观看全面零基础学习视频，看视频学习是最快捷也是最有效果的方式，跟着视频中老师的思路，从基础到深入，还是很容易入门的。</p> 
<p><img src="https://images2.imgbox.com/8f/ef/ZvgMifcM_o.png" alt="img"></p> 
<p><strong>五、实战案例</strong></p> 
<p>纸上得来终觉浅，要学会跟着视频一起敲，要动手实操，才能将自己的所学运用到实际当中去，这时候可以搞点实战案例来学习。</p> 
<p><img src="https://images2.imgbox.com/9a/88/R87AskJJ_o.png" alt="img"></p> 
<p><strong>六、面试宝典</strong></p> 
<p><img src="https://images2.imgbox.com/68/1c/LBKYcJwG_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/ed/03/2kg4DIVX_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="httpsimgblogcsdnimgcn646863996ac44da8af500c049bb72fbdpngpic_center_309"></a><strong>简历模板</strong><img src="https://images2.imgbox.com/95/e7/cs4FqJZ6_o.png" alt="在这里插入图片描述"></h6> 
<img src="https://images2.imgbox.com/9d/66/uVG9O4N5_o.png"> 若有侵权，请联系删除
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9c4241dbaca8ea06ba513e6240f02d3c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">edge浏览器ie兼容模式怎么打开控制台？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a9c740859d59197dd25ecb027a77ad2e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ArrayList 多线程操作的问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>