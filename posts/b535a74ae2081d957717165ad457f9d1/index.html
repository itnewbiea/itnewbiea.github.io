<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux环境下离线安装和配置nginx - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux环境下离线安装和配置nginx" />
<meta property="og:description" content="Linux安装nginx 序言参考的文章：[Nginx安装与使用](https://www.cnblogs.com/skynet/p/4146083.html) 一、下载依赖包下载说明 二、解压三、安装nginx1、进入解压后的nginx的目录2、创建安装目录3、编译nginx的安装目录4、安装nginx 四、修改配置文件五、查看版本和检测1、查看版本2、检测 六、启动nginx七、遇到的坑1、nginx的版本2、下载依赖包3、编译nginx 八、补充nginx的相关命令1、停止nginx2、nginx重新加载 九、安装过程中可能遇到的问题 序言 由于测试环境的nginx是已经搭建完成的，把搭建完成的nginx打包后传到生产的主机上，在sbin目录下测试nginx，就会报错找不到路径，所以我决定自己重新安装，于是经过不断的踩坑和请教，诞生了这篇文章。
参考的文章：Nginx安装与使用 一、下载依赖包 nginx：http://nginx.org/en/download.html （版本：nginx-1.16.1 tar.gz）
pcre：https://sourceforge.net/projects/pcre/files/pcre/8.41/（版本：pcre-8.41.tar.gz）
zlib：http://www.zlib.net/（版本：zlib-1.2.11.tar.gz）
oppenssl：https://www.openssl.org/source/（版本：openssl-1.1.1g.tar.gz）
下载说明 我之所以没有在生产中用yum或wget，是由于用不了，所以只能下载到本地后传到生产中。
1、下载zlib的位置：
2、下载openssl：
二、解压 tar -zxvf nginx-1.16.1.tar.gz tar -zxvf openssl-1.1.1g.tar.gz tar -zxvf pcre-8.41.tar.gz tar -zxvf zlib-1.2.11.tar.gz 三、安装nginx 1、进入解压后的nginx的目录 cd nginx-1.16.1 2、创建安装目录 由于我是安装在普通用户下的，所以需要创建安装目录。
建议：最好是安装在普通目录，
因为：我们这边的规定是：所有生产的nginx都必需在普通用户下编译和启停。
mkdir installs 3、编译nginx的安装目录 ./configure --prefix=/home/nginxsrv/nginx/nginx-1.16.1/installs --with-pcre=../pcre-8.41 --with-openssl=../openssl-1.1.1g --with-zlib=../zlib-1.2.11 4、安装nginx make &amp;&amp; make install 四、修改配置文件 cp nginx.conf nginx.conf.bak.fanhf.202006021600.orig vim nginx.conf 先备份原来的，再将端口号80修改为8081
修改后的部分配置如下：
server { listen 8081; server_name localhost; #charset koi8-r; #access_log logs/host." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/b535a74ae2081d957717165ad457f9d1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-06-02T17:09:36+08:00" />
<meta property="article:modified_time" content="2020-06-02T17:09:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux环境下离线安装和配置nginx</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Linux安装nginx</h4> 
 <ul><li><a href="#_1" rel="nofollow">序言</a></li><li><ul><li><ul><li><ul><li><ul><li><a href="#Nginxhttpswwwcnblogscomskynetp4146083html_4" rel="nofollow">参考的文章：[Nginx安装与使用](https://www.cnblogs.com/skynet/p/4146083.html)</a></li></ul> 
    </li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#_6" rel="nofollow">一、下载依赖包</a></li><li><ul><li><ul><li><a href="#_12" rel="nofollow">下载说明</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_19" rel="nofollow">二、解压</a></li><li><a href="#nginx_27" rel="nofollow">三、安装nginx</a></li><li><ul><li><a href="#1nginx_29" rel="nofollow">1、进入解压后的nginx的目录</a></li><li><a href="#2_34" rel="nofollow">2、创建安装目录</a></li><li><a href="#3nginx_42" rel="nofollow">3、编译nginx的安装目录</a></li><li><a href="#4nginx_47" rel="nofollow">4、安装nginx</a></li></ul> 
  </li><li><a href="#_52" rel="nofollow">四、修改配置文件</a></li><li><a href="#_76" rel="nofollow">五、查看版本和检测</a></li><li><ul><li><a href="#1_77" rel="nofollow">1、查看版本</a></li><li><a href="#2_90" rel="nofollow">2、检测</a></li></ul> 
  </li><li><a href="#nginx_101" rel="nofollow">六、启动nginx</a></li><li><a href="#_109" rel="nofollow">七、遇到的坑</a></li><li><ul><li><a href="#1nginx_110" rel="nofollow">1、nginx的版本</a></li><li><a href="#2_112" rel="nofollow">2、下载依赖包</a></li><li><a href="#3nginx_119" rel="nofollow">3、编译nginx</a></li></ul> 
  </li><li><a href="#nginx_137" rel="nofollow">八、补充nginx的相关命令</a></li><li><ul><li><a href="#1nginx_138" rel="nofollow">1、停止nginx</a></li><li><a href="#2nginx_144" rel="nofollow">2、nginx重新加载</a></li></ul> 
  </li><li><a href="#_153" rel="nofollow">九、安装过程中可能遇到的问题</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>序言</h2> 
<p>由于测试环境的nginx是已经搭建完成的，把搭建完成的nginx打包后传到生产的主机上，在sbin目录下测试nginx，就会报错找不到路径，所以我决定自己重新安装，于是经过不断的踩坑和请教，诞生了这篇文章。</p> 
<h6><a id="Nginxhttpswwwcnblogscomskynetp4146083html_4"></a>参考的文章：<a href="https://www.cnblogs.com/skynet/p/4146083.html" rel="nofollow">Nginx安装与使用</a></h6> 
<h2><a id="_6"></a>一、下载依赖包</h2> 
<p>nginx：<a href="http://nginx.org/en/download.html" rel="nofollow">http://nginx.org/en/download.html</a> （版本：nginx-1.16.1 tar.gz）<br> pcre：<a href="https://sourceforge.net/projects/pcre/files/pcre/8.41/" rel="nofollow">https://sourceforge.net/projects/pcre/files/pcre/8.41/</a>（版本：pcre-8.41.tar.gz）<br> zlib：<a href="http://www.zlib.net/" rel="nofollow">http://www.zlib.net/</a>（版本：zlib-1.2.11.tar.gz）<br> oppenssl：<a href="https://www.openssl.org/source/" rel="nofollow">https://www.openssl.org/source/</a>（版本：openssl-1.1.1g.tar.gz）</p> 
<h4><a id="_12"></a>下载说明</h4> 
<p>我之所以没有在生产中用yum或wget，是由于用不了，所以只能下载到本地后传到生产中。</p> 
<p>1、下载zlib的位置：<br> <img src="https://images2.imgbox.com/e7/75/2Y6Hv7i9_o.png" alt="在这里插入图片描述"><br> 2、下载openssl：<br> <img src="https://images2.imgbox.com/9e/11/KWQx1hc3_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_19"></a>二、解压</h2> 
<pre><code class="prism language-shell"><span class="token function">tar</span> -zxvf nginx-1.16.1.tar.gz
<span class="token function">tar</span> -zxvf openssl-1.1.1g.tar.gz
<span class="token function">tar</span> -zxvf pcre-8.41.tar.gz
<span class="token function">tar</span> -zxvf zlib-1.2.11.tar.gz
</code></pre> 
<h2><a id="nginx_27"></a>三、安装nginx</h2> 
<h3><a id="1nginx_29"></a>1、进入解压后的nginx的目录</h3> 
<pre><code class="prism language-shell"><span class="token function">cd</span>  nginx-1.16.1
</code></pre> 
<h3><a id="2_34"></a>2、创建安装目录</h3> 
<p>由于我是安装在普通用户下的，所以需要创建安装目录。<br> 建议：最好是安装在普通目录，<br> 因为：我们这边的规定是：所有生产的nginx都必需在普通用户下编译和启停。</p> 
<pre><code class="prism language-shell"><span class="token function">mkdir</span> installs
</code></pre> 
<h3><a id="3nginx_42"></a>3、编译nginx的安装目录</h3> 
<pre><code class="prism language-shell">./configure  --prefix<span class="token operator">=</span>/home/nginxsrv/nginx/nginx-1.16.1/installs  --with-pcre<span class="token operator">=</span><span class="token punctuation">..</span>/pcre-8.41   --with-openssl<span class="token operator">=</span><span class="token punctuation">..</span>/openssl-1.1.1g  --with-zlib<span class="token operator">=</span><span class="token punctuation">..</span>/zlib-1.2.11
</code></pre> 
<h3><a id="4nginx_47"></a>4、安装nginx</h3> 
<pre><code class="prism language-shell"><span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span>
</code></pre> 
<h2><a id="_52"></a>四、修改配置文件</h2> 
<pre><code class="prism language-shell"><span class="token function">cp</span>  nginx.conf  nginx.conf.bak.fanhf.202006021600.orig
vim  nginx.conf  
</code></pre> 
<p>先备份原来的，再将端口号80修改为8081<br> 修改后的部分配置如下：</p> 
<pre><code>    server {
        listen       8081;
        server_name  localhost;

        #charset koi8-r;

        #access_log  logs/host.access.log  main;

        location / {
            root   html;
            index  index.html index.htm;
        }
</code></pre> 
<p>nginx.conf只修改了端口号，其他的不曾做任何修改！</p> 
<h2><a id="_76"></a>五、查看版本和检测</h2> 
<h3><a id="1_77"></a>1、查看版本</h3> 
<pre><code class="prism language-shell"><span class="token function">cd</span> /home/nginxsrv/nginx/nginx-1.16.1/installs/sbin
./nginx -V
</code></pre> 
<p>显示：</p> 
<pre><code>nginx version: nginx/1.16.1
built by gcc 4.8.5 20150623 (Red Hat 4.8.5-11) (GCC) 
configure arguments: --prefix=/home/nginxsrv/nginx/nginx-1.16.1/installs --with-pcre=../pcre-8.41 --with-openssl=../openssl-1.1.1g --with-zlib=../zlib-1.2.11
</code></pre> 
<h3><a id="2_90"></a>2、检测</h3> 
<pre><code class="prism language-shell">./nginx -t
</code></pre> 
<p>显示：</p> 
<pre><code>nginx: the configuration file /home/nginxsrv/nginx/nginx-1.16.1/installs/conf/nginx.conf syntax is ok
nginx: configuration file /home/nginxsrv/nginx/nginx-1.16.1/installs/conf/nginx.conf test is successful
</code></pre> 
<h2><a id="nginx_101"></a>六、启动nginx</h2> 
<pre><code class="prism language-shell"><span class="token function">cd</span> /home/nginxsrv/nginx/nginx-1.16.1/installs/sbin
./nginx 
</code></pre> 
<p>查看启动情况：<br> <img src="https://images2.imgbox.com/e8/91/aU89pjNz_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_109"></a>七、遇到的坑</h2> 
<h3><a id="1nginx_110"></a>1、nginx的版本</h3> 
<p>我原本在测试环境用的是nginx-1.9.9的版本，而且是没有问题的，但是同事说还是用1.16.1的版本，比较稳定，所以就改成了1.16.1。</p> 
<h3><a id="2_112"></a>2、下载依赖包</h3> 
<p>由于下载的prce是最新版本的pcre2-10.33.tar.gz，而不是pcre-8.41.tar.gz，导致在nginx的解压目录下执行：make &amp;&amp; make install 的时候报错：</p> 
<pre><code>src/core/ngx_regex.h:15:18: fatal error:pcre.h No such file or directory
</code></pre> 
<p>于是查了一下，参考了<a href="https://blog.csdn.net/fly7765/article/details/103479648">这篇文章</a>说是要把pcre的版本降低，于是就是改为pcre-8.41.tar.gz，解压后，重新编译和安装，就可以了。</p> 
<h3><a id="3nginx_119"></a>3、编译nginx</h3> 
<p>在第一次编译nginx的时候，<br> 编译指令：</p> 
<pre><code>./configure --prefix=/home/nginxsrv/nginx/nginx-1.16.1/installs
</code></pre> 
<p>报错如下：</p> 
<pre><code>./configure: error: the HTTP rewrite module requires the PCRE library.
You can either disable the module by using --without-http_rewrite_module
option, or install the PCRE library into the system, or build the PCRE library
statically from the source with nginx by using --with-pcre=&lt;path&gt; option.
</code></pre> 
<p>查了之后说是少依赖包，于是一步一步查，一步一步下载需要的3个依赖包，然后就想着把这3个依赖包都编译和安装，但是反复尝试了之后依旧不行，删了安，安了删，甚至在root里面也试了，都无果。于是问一位大神，他说3个依赖包不需要编译和安装，直接在编译nginx的时候指定3个依赖包的路径就可以，这才安装成功。</p> 
<h2><a id="nginx_137"></a>八、补充nginx的相关命令</h2> 
<h3><a id="1nginx_138"></a>1、停止nginx</h3> 
<pre><code class="prism language-shell"><span class="token function">cd</span> /home/nginxsrv/nginx/nginx-1.16.1/installs/sbin
./nginx  -s stop
</code></pre> 
<h3><a id="2nginx_144"></a>2、nginx重新加载</h3> 
<pre><code class="prism language-shell"><span class="token function">cd</span> /home/nginxsrv/nginx/nginx-1.16.1/installs/sbin
./nginx –s reload
</code></pre> 
<p>至此，nginx的安装和配置就完成了，关于nginx的配置还有其他的一些内容，我这里就不赘述了，网上有很多资料，可自行查找和学习。</p> 
<h2><a id="_153"></a>九、安装过程中可能遇到的问题</h2> 
<p><a href="https://www.jianshu.com/p/15fa13a1d6f4" rel="nofollow">解决nginx: [error] open() “/usr/local/nginx/logs/nginx.pid” failed (2: No such file or directory)错误</a></p> 
<p><a href="https://blog.csdn.net/songchuan0201/article/details/62037010">nginx: [emerg] open() “/usr/local/nginx/logs/access.log” failed (21: Is a directory)</a></p> 
<p><a href="https://blog.csdn.net/kingzma/article/details/44205813">Nginx的安装，以及总是出现找不到pcre library的解决方法</a></p> 
<p><font color="blue" size="6"> 与君共勉！！！</font></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f69dfb54f0757ed40290751589c39128/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java考试系统demo_在线考试_在线答题_考试系统</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ae3c6811e0e7177dc86df834f7798900/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">推荐几款精美耐看的xshell配色方案</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>