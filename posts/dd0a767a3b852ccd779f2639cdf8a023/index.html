<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>缺失数据处理-插值法 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="缺失数据处理-插值法" />
<meta property="og:description" content="1. 前言 在数据挖掘中，原始数据中存在着大量不完整、偏离的数据。这些问题数据轻则影响数据挖掘执行效率，重则影响执行结果。因此数据预处理工作必不可少，而其中常见工作的就是数据集的缺失值处理。
数据缺失值处理可分两类。一类是删除缺失数据，一类是进行数据插补。前者比较简单粗暴，但是这种方法最大的局限就是它是以减少历史数据来换取数据的完备，会造成资源的大量浪费，尤其在数据集本身就少的情况下，删除记录可能会直接影响分析结果的客观性和准确性
本文介绍数据常用的插补方法。对拉格朗日插值法和滑动平均窗口法进行重点介绍和实现。
2. 介绍 2.1 常用的插值方法如下： 这里只对插值法和窗口滑动平均进行介绍。
2.2 滑动平均窗口法 一个列表a 中的第 i 个位置数据为缺失数据，则取前后 window 个数据的平均值，作为插补数据。例如：
a = [3,4,5,6,None,4,5,2,5] 、 window = 3
则 None位置的数据为：(4&#43;5&#43;6&#43;4&#43;5&#43;2)/6 = 2.67
2.3 拉格朗日插值法 根据数学概念可知，对于平面上已知的n个点（无两点在一条直线上）可以找到一个n-1次的多项式，使此多项式通过这n个点。
因此我们需先求得多项式函数L(x)，然后将缺失值对应的点x带入插值多项式得到缺失值的近似值L(x)。多项式函数L(x)的求法如下：
3. 实现 3.1 代码 # coding:utf-8 # 拉格朗日插值代码 import pandas as pd # 导入数据分析库Pandas from scipy.interpolate import lagrange # 导入拉格朗日插值函数 # 构建原始数据 data = pd.DataFrame([ [&#34;2015/3/1&#34;, 59], [&#34;2015/2/28&#34;, 2618.2], [&#34;2015/2/27&#34;, 2608.4], [&#34;2015/2/26&#34;, 2651.9], [&#34;2015/2/25&#34;, 3442.1], [&#34;2015/2/24&#34;, 3393." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/dd0a767a3b852ccd779f2639cdf8a023/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-06-01T14:48:59+08:00" />
<meta property="article:modified_time" content="2017-06-01T14:48:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">缺失数据处理-插值法</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1__0"></a>1. 前言</h3> 
<p>在数据挖掘中，原始数据中存在着大量不完整、偏离的数据。这些问题数据轻则影响数据挖掘执行效率，重则影响执行结果。因此数据预处理工作必不可少，而其中常见工作的就是数据集的缺失值处理。</p> 
<p>数据缺失值处理可分两类。一类是删除缺失数据，一类是进行数据插补。前者比较简单粗暴，但是这种方法最大的局限就是它是以减少历史数据来换取数据的完备，会造成资源的大量浪费，尤其在数据集本身就少的情况下，删除记录可能会直接影响分析结果的客观性和准确性</p> 
<p>本文介绍数据常用的插补方法。对拉格朗日插值法和滑动平均窗口法进行重点介绍和实现。</p> 
<h3><a id="2__7"></a>2. 介绍</h3> 
<h4><a id="21__8"></a>2.1 常用的插值方法如下：</h4> 
<p><img src="https://images2.imgbox.com/9c/d2/oNCJ6gl8_o.png" alt="这里写图片描述"><br> 这里只对插值法和窗口滑动平均进行介绍。</p> 
<h4><a id="22__11"></a>2.2 滑动平均窗口法</h4> 
<p>一个列表a 中的第 i 个位置数据为缺失数据，则取前后 window 个数据的平均值，作为插补数据。例如：</p> 
<p>a = [3,4,5,6,None,4,5,2,5] 、 window = 3<br> 则 None位置的数据为：(4+5+6+4+5+2)/6 = 2.67</p> 
<h4><a id="23__17"></a>2.3 拉格朗日插值法</h4> 
<p>根据数学概念可知，对于平面上已知的n个点（无两点在一条直线上）可以找到一个n-1次的多项式，使此多项式通过这n个点。<br> <img src="https://images2.imgbox.com/8e/3c/7tYs0dre_o.png" width="50%" alt=""></p> 
<p>因此我们需先求得多项式函数L(x)，然后将缺失值对应的点x带入插值多项式得到缺失值的近似值L(x)。多项式函数L(x)的求法如下：<br> <img src="https://images2.imgbox.com/0f/8f/PSF3bUf2_o.png" alt="这里写图片描述"></p> 
<h3><a id="3__24"></a>3. 实现</h3> 
<h4><a id="31__25"></a>3.1 代码</h4> 
<pre><code># coding:utf-8
# 拉格朗日插值代码
import pandas as pd  # 导入数据分析库Pandas
from scipy.interpolate import lagrange  # 导入拉格朗日插值函数

# 构建原始数据
data = pd.DataFrame([
    ["2015/3/1", 59],
    ["2015/2/28", 2618.2],
    ["2015/2/27", 2608.4],
    ["2015/2/26", 2651.9],
    ["2015/2/25", 3442.1],
    ["2015/2/24", 3393.1],
    ["2015/2/23", 3136.6],
    ["2015/2/22", 3744.1],
    ["2015/2/21", ],
    ["2015/2/20", 4060.3],
    ["2015/2/19", 3614.7],
    ["2015/2/18", 3295.5],
    ["2015/2/16", 2332.1],
    ["2015/2/15", 2699.3],
    ["2015/2/14", ],
    ["2015/2/13", 3036.8],
    ["2015/2/12", 1865],
    ["2015/2/11", 3014.3],
    ["2015/2/10", 2742.8],
    ["2015/2/9", 2173.5],
    ["2015/2/8", 3161.8],
    ["2015/2/7", 3023.8],
    ["2015/2/6", 2998.1],
], columns=[u'日期', u'销量'])

# 设置异常值,把销量大于5000和销量小于400的异常值替换为None
data[u'销量'][(data[u'销量'] &lt; 400) | (data[u'销量'] &gt; 5000)] = None

# 把要处理的数据取出来,pandas中dataframe格式单独取出一列就是series数据格式
tmp_data_1 = data[u'销量'].copy()
tmp_data_2 = data[u'销量'].copy()


def ployinterp_column(series, pos, window=5):
    """
    :param series: 列向量
    :param pos: 被插值的位置
    :param window: 为取前后的数据个数
    :return:
    """
    y = series[list(range(pos - window, pos)) + list(range(pos + 1, pos + 1 + window))]  # 取数
    y = y[y.notnull()]  # 剔除空值
    return lagrange(y.index, list(y))(pos)  # 插值并返回插值结果


def sma_mothod(series, pos, window=5):
    """
    :param series: 列向量
    :param pos: 被插值的位置
    :param window: 为取前后的数据个数
    :return:
    """
    y = series[list(range(pos - window, pos)) + list(range(pos + 1, pos + 1 + window))]  # 取数
    y = y[y.notnull()]
    return reduce(lambda a, b: a + b, y) / len(y)

for j in range(len(tmp_data_1)):
    if (tmp_data_1.isnull())[j]:  # 如果为空即插值。
        tmp_data_1[j] = ployinterp_column(tmp_data_1, j)
        print j, data.loc[j, u'日期'], tmp_data_1[j]

print 

for j in range(len(tmp_data_2)):
    if (tmp_data_2.isnull())[j]:  # 如果为空即插值。
        tmp_data_2[j] = sma_mothod(tmp_data_2, j)
        print j, data.loc[j, u'日期'], tmp_data_2[j]
</code></pre> 
<h4><a id="32__102"></a>3.2 输出</h4> 
<p>0 2015/3/1 -291.4<br> 8 2015/2/21 4275.25476248<br> 14 2015/2/14 3680.66999227</p> 
<p>0 2015/3/1 2942.74<br> 8 2015/2/21 3236.97<br> 14 2015/2/14 2883.43</p> 
<h4><a id="33__111"></a>3.3 分析</h4> 
<p>对比之下，滑动窗口方法的输出都还比较合理。但显而易见的是拉格朗日插值对0位置的数据处理的很不好，插值为 -291.4。拟合点的数据格式为(x,y)，具体数据：(1, 2618.2), (2, 2608.4),(3, 2651.9),(4, 3442.1), (5, 3393.1)。我们把拉格朗日多项式打印出来：</p> 
<p>  L(x) = -94.97 x^4 + 1065 x^3 - 3991 x^2 + 5930 x^1 - 291.4</p> 
<p>把 x= 0 带入得到 L(x)，就得到了 -291.4。这里x=0就是L(x)的截距。直观感觉就不太合理，猜测就是拉格朗日插值法对边缘数据敏感（即插值需要左右两边数据提供信息，在缺失左边数据信息情况下，得到的结果就不太合理），日后求证！</p> 
<h3><a id="4__118"></a>4. 参考：</h3> 
<p>《python数据分析与挖掘实战》</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4099c1a6ae712dbfe9d465069e587287/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">arduino读取处理UWB（匿名科技的）数据集</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/76929193d29b164e294034df081c9ccc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mySQL （关系型数据库管理系统）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>