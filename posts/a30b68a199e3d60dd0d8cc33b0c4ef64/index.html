<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CryptoJS C/C&#43;&#43; openssl Java AES_256_ecb 加密解密互通 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CryptoJS C/C&#43;&#43; openssl Java AES_256_ecb 加密解密互通" />
<meta property="og:description" content="CryptoJS &lt;script type=&#34;text/javascript&#34; src=&#34;crypto-js.js&#34;&gt;&lt;/script&gt; &lt;script type=&#34;text/javascript&#34;&gt; // 加密 var ciphertext = CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(&#39;123456&#39;), CryptoJS.enc.Utf8.parse(&#39;12345678901234567890123456789012&#39;), { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.Pkcs7 }).toString(); console.log(ciphertext); // 解密 var bytes = CryptoJS.AES.decrypt(ciphertext, CryptoJS.enc.Utf8.parse(&#39;12345678901234567890123456789012&#39;), { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.Pkcs7 }); var originalText = bytes.toString(CryptoJS.enc.Utf8); console.log(originalText); &lt;/script&gt; 效果
解析base64查看原始密文
Java public static byte[] AES_256_ecb_encrypt(byte[] input, byte[] byteKey) throws NoSuchPaddingException, NoSuchAlgorithmException, InvalidKeyException, BadPaddingException, IllegalBlockSizeException { Cipher cipher = Cipher.getInstance(&#34;AES/ECB/PKCS5Padding&#34;); SecretKey key = new SecretKeySpec(byteKey, &#34;AES&#34;); cipher.init(Cipher.ENCRYPT_MODE, key); byte[] encrypted = cipher." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/a30b68a199e3d60dd0d8cc33b0c4ef64/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-01T16:26:50+08:00" />
<meta property="article:modified_time" content="2021-03-01T16:26:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CryptoJS C/C&#43;&#43; openssl Java AES_256_ecb 加密解密互通</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>CryptoJS</h2> 
<pre><code>&lt;script type="text/javascript" src="crypto-js.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
        // 加密
        var ciphertext = CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse('123456'), CryptoJS.enc.Utf8.parse('12345678901234567890123456789012'), { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.Pkcs7 }).toString();
        console.log(ciphertext);
        // 解密        
        var bytes = CryptoJS.AES.decrypt(ciphertext, CryptoJS.enc.Utf8.parse('12345678901234567890123456789012'), { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.Pkcs7 });
        var originalText = bytes.toString(CryptoJS.enc.Utf8);
        console.log(originalText);
&lt;/script&gt;</code></pre> 
<p>效果</p> 
<p><img alt="" height="170" src="https://images2.imgbox.com/3c/0b/0P6Qyn5o_o.png" width="584"></p> 
<p>解析base64查看原始密文</p> 
<p><img alt="" height="152" src="https://images2.imgbox.com/23/7a/yyDPzo6V_o.png" width="651"></p> 
<h2>Java</h2> 
<pre><code>    public static byte[] AES_256_ecb_encrypt(byte[] input, byte[] byteKey) throws NoSuchPaddingException, NoSuchAlgorithmException, InvalidKeyException, BadPaddingException, IllegalBlockSizeException {
        Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5Padding");
        SecretKey key = new SecretKeySpec(byteKey, "AES");
        cipher.init(Cipher.ENCRYPT_MODE, key);
        byte[] encrypted = cipher.doFinal(input);
        return encrypted;
    }

    public static byte[] AES_256_ecb_decrypt(byte[] input, byte[] byteKey) throws NoSuchPaddingException, NoSuchAlgorithmException, InvalidKeyException, BadPaddingException, IllegalBlockSizeException {
        Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5Padding");
        SecretKey key = new SecretKeySpec(byteKey, "AES");
        cipher.init(Cipher.DECRYPT_MODE, key);
        byte[] decrypted = cipher.doFinal(input);
        return decrypted;
    }</code></pre> 
<pre><code> @Test
    public void testAES_256_ecb_encrypt() throws Exception {
        String input = "123456";
        String key = "12345678901234567890123456789012";
        byte[] encrypted = CipherUtil.AES_256_ecb_encrypt(input.getBytes(), key.getBytes());
        log.debug(CipherUtil.hexDumpEncoder.encode(encrypted));
        byte[] decrypted = CipherUtil.AES_256_ecb_decrypt(encrypted, key.getBytes());
        String decyptedStr = new String(decrypted);
        log.debug(decyptedStr);
    }</code></pre> 
<p>效果</p> 
<p><img alt="" height="134" src="https://images2.imgbox.com/a3/e2/WstMXHDJ_o.png" width="830"></p> 
<h2>C（调用openssl crypto库）</h2> 
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;openssl/evp.h&gt;
#include &lt;openssl/aes.h&gt;

void printhexDump(const char *buffer, size_t len)
{
    if (buffer == NULL || len &lt;= 0)
    {
        return;
    }
    printf("0x%x: (len=%d)[", buffer, len);
    for (size_t i = 0; i &lt; len; i++)
    {
        printf("%.2X ", (unsigned char)buffer[i]);
    }
    printf("]\n");
}

int main()
{
    unsigned char key[32] = "12345678901234567890123456789012";
    unsigned char *rawData = "123456";
    int rawDataLen = strlen(rawData);
    int encLen = 0;
    int outLen = 0;

    unsigned char encData[1024];
    printf("%s\n", rawData);

    EVP_CIPHER_CTX *ctx;
    ctx = EVP_CIPHER_CTX_new();

    EVP_CipherInit_ex(ctx, EVP_aes_256_ecb(), NULL, key, NULL, AES_ENCRYPT);
    EVP_CipherUpdate(ctx, encData, &amp;outLen, rawData, rawDataLen);
    encLen = outLen;
    printf("%d\n", encLen);
    EVP_CipherFinal(ctx, encData + outLen, &amp;outLen);
    encLen += outLen;
    printf("%d\n", encLen);
    EVP_CIPHER_CTX_free(ctx);
    printhexDump(encData, encLen);

    //
    int decLen = 0;
    int outlen = 0;
    unsigned char decData[1024];
    EVP_CIPHER_CTX *ctx2;
    ctx2 = EVP_CIPHER_CTX_new();
    EVP_CipherInit_ex(ctx2, EVP_aes_256_ecb(), NULL, key, NULL, AES_DECRYPT);
    EVP_CipherUpdate(ctx2, decData, &amp;outlen, encData, encLen);
    decLen = outlen;
    EVP_CipherFinal(ctx2, decData + outlen, &amp;outlen);
    decLen += outlen;
    EVP_CIPHER_CTX_free(ctx2);

    decData[decLen] = '\0';
    printf("decrypt: %s\n", decData);
    return 0;
}</code></pre> 
<p>效果</p> 
<p><img alt="" height="193" src="https://images2.imgbox.com/e7/97/z7YfrqVi_o.png" width="657"></p> 
<p> </p> 
<h2>总结</h2> 
<p>明文：123456</p> 
<p>密钥（32字节256位）：12345678901234567890123456789012</p> 
<p>经AES加密算法</p> 
<p>  CryptoJS： { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.Pkcs7 }</p> 
<p>  Java： Cipher.getInstance("AES/ECB/PKCS5Padding"))</p> 
<p>  C openssl：EVP_aes_256_ecb()</p> 
<p>得到相同密文十六进制：D7 86 C4 BC 0E C2 7B 22   28 A2 96 24 62 AB 4D 5B</p> 
<p>解密得到相同明文：123456</p> 
<p> </p> 
<p>Qt C++可直接采用C openssl库方案。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0f073c2b1de6dbbf1c7cb8163e80dc8c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">px和毫米的换算_像素跟毫米换算(像素和毫米换算器)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/103545842c25e3ef86839076e032513a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关于csv文件转化为张量</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>