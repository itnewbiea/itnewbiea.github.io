<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[GDOUCTF 2023] 部分web题解 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[GDOUCTF 2023] 部分web题解" />
<meta property="og:description" content="目录
hate eat snake
EZ WEB
受不了一点
泄露的伪装
hate eat snake 打开页面，是一个贪吃蛇游戏
打了两把结束后点取消发现卡在下一次隔40s开始按空格键就可以得到flag（也可以找js文件更改score的运算或者speed等）
EZ WEB 参考知识：(1条消息) PUT和POST方法的区别-比较POST和PUT方法_zhangpaopao0609的博客-CSDN博客
打开环境，看看源代码，发现有一个注释
访问看看，是一个flask的模板，要求是PUT方式下访问/super-secret-route-nobody-will-guess，可以def flag():
BP抓包改一下即可
受不了一点 bypass类型的题目，第一层，数组绕过即可，后面md5因为无法解析数组内容，然后会读入一个字符串array，然后两个参数md5值就相等了
第二层cookie方式传入cookie=j0k3r
第三层GET方式传入aaa和bbb参数，且值都为114514，但是不相等，这里的弱比较可以用114514a来绕过，解析后仍为114514。这个是字符串的弱比较，因为== 在进行比较的时候，会先将字符串类型转化成相同，再比较
最后一层可以get方式变量覆盖进行flag的传入， a=flag&amp;flag=a
&lt;ez_ze&gt; 参考和知识的博客：
PayloadsAllTheThings/Server Side Template Injection at master · swisskyrepo/PayloadsAllTheThings (github.com)
Marven11/Fenjing: 一个类似SQLMap的Jinja2 SSTI利用脚本 | A SQLMap-like Jinja2 SSTI cracker (github.com)
(2条消息) GDOUCTF_YAy17的博客-CSDN博客
抓包看看数据怎么传的
并且传入{{}}，发现被过滤，猜测是ssti注入，手注可以参考第三篇师傅写的，我手注也是看师傅们的payload，太强了
在群里聊天后新见识了一个工具，fenjing就可以一把梭
- scan: 扫描整个网站 - crack: 对某个特定的表单进行攻击 Usage: python -m fenjing scan [OPTIONS] Options: --url TEXT 需要扫描的URL --exec-cmd TEXT 成功后执行的shell指令，不填则进入交互模式 --help Show this message and exit." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c4abb018b8895fdb6b6792bccdfe2cc9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-18T20:21:52+08:00" />
<meta property="article:modified_time" content="2023-04-18T20:21:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[GDOUCTF 2023] 部分web题解</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:40px;"></p> 
<p id="hate%20eat%20snake-toc" style="margin-left:40px;"><a href="#hate%20eat%20snake" rel="nofollow">hate eat snake</a></p> 
<p id="EZ%20WEB-toc" style="margin-left:40px;"><a href="#EZ%20WEB" rel="nofollow">EZ WEB</a></p> 
<p id="%E5%8F%97%E4%B8%8D%E4%BA%86%E4%B8%80%E7%82%B9-toc" style="margin-left:40px;"><a href="#%E5%8F%97%E4%B8%8D%E4%BA%86%E4%B8%80%E7%82%B9" rel="nofollow">受不了一点</a></p> 
<p id="%3Cez_ze%3E-toc" style="margin-left:40px;"><a href="#%3Cez_ze%3E" rel="nofollow"></a></p> 
<p id="%E6%B3%84%E9%9C%B2%E7%9A%84%E4%BC%AA%E8%A3%85-toc" style="margin-left:40px;"><a href="#%E6%B3%84%E9%9C%B2%E7%9A%84%E4%BC%AA%E8%A3%85" rel="nofollow">泄露的伪装</a></p> 
<p></p> 
<h3 id="hate%20eat%20snake">hate eat snake</h3> 
<p>打开页面，是一个贪吃蛇游戏</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b8/ea/75nWylXQ_o.png"></p> 
<p>打了两把结束后点取消发现卡在下一次隔40s开始按空格键就可以得到flag（也可以找js文件更改score的运算或者speed等）</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/26/54/0dpzbGY1_o.png"></p> 
<p></p> 
<p></p> 
<p></p> 
<h3 id="EZ%20WEB">EZ WEB</h3> 
<p>参考知识：<a href="https://blog.csdn.net/qq_41800366/article/details/108792197?ops_request_misc=%7B%22request_id%22%3A%22168172911916800217233126%22%2C%22scm%22%3A%2220140713.130102334.pc_all.%22%7D&amp;request_id=168172911916800217233126&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-6-108792197-null-null.142%5Ev83%5Epc_search_v2,239%5Ev2%5Einsert_chatgpt&amp;utm_term=PUT%E6%98%AF%E4%BB%80%E4%B9%88&amp;spm=1018.2226.3001.4187" title="(1条消息) PUT和POST方法的区别-比较POST和PUT方法_zhangpaopao0609的博客-CSDN博客">(1条消息) PUT和POST方法的区别-比较POST和PUT方法_zhangpaopao0609的博客-CSDN博客</a></p> 
<p>打开环境，看看源代码，发现有一个注释</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/2d/88/ppq0xIpa_o.png"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/3a/0d/TnhJzO3h_o.png"></p> 
<p>访问看看，是一个flask的模板，要求是PUT方式下访问/super-secret-route-nobody-will-guess，可以def flag():</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/56/4d/B2sjkqFA_o.png"></p> 
<p> BP抓包改一下即可</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/6a/70/WV5ZMi1s_o.png"></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<h3 id="%E5%8F%97%E4%B8%8D%E4%BA%86%E4%B8%80%E7%82%B9">受不了一点</h3> 
<p>bypass类型的题目，第一层，数组绕过即可，后面md5因为无法解析数组内容，然后会读入一个字符串<code>array</code>，然后两个参数md5值就相等了</p> 
<p>第二层cookie方式传入cookie=j0k3r</p> 
<p>第三层GET方式传入aaa和bbb参数，且值都为114514，但是不相等，这里的弱比较可以用114514a来绕过，解析后仍为114514。这个是字符串的弱比较，因为== 在进行比较的时候，会先将字符串类型转化成相同，再比较</p> 
<p>最后一层可以get方式变量覆盖进行flag的传入， a=flag&amp;flag=a</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ff/82/v41UWKDT_o.png"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/c8/cc/SNzbJIca_o.png"></p> 
<p></p> 
<p></p> 
<p></p> 
<h3 id="%3Cez_ze%3E">&lt;ez_ze&gt;</h3> 
<p> 参考和知识的博客：</p> 
<p><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#exploit-the-ssti-by-calling-ospopenread" title="PayloadsAllTheThings/Server Side Template Injection at master · swisskyrepo/PayloadsAllTheThings (github.com)">PayloadsAllTheThings/Server Side Template Injection at master · swisskyrepo/PayloadsAllTheThings (github.com)</a></p> 
<p><a href="https://github.com/Marven11/Fenjing" title="Marven11/Fenjing: 一个类似SQLMap的Jinja2 SSTI利用脚本 | A SQLMap-like Jinja2 SSTI cracker (github.com)">Marven11/Fenjing: 一个类似SQLMap的Jinja2 SSTI利用脚本 | A SQLMap-like Jinja2 SSTI cracker (github.com)</a></p> 
<p><a href="https://blog.csdn.net/weixin_44770698/article/details/130193662?ops_request_misc=%7B%22request_id%22%3A%22168174114316782425194220%22%2C%22scm%22%3A%2220140713.130102334.pc_all.%22%7D&amp;request_id=168174114316782425194220&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-130193662-null-null.142%5Ev84%5Epc_search_v2,239%5Ev2%5Einsert_chatgpt&amp;utm_term=%5BGDOUCTF%202023%5D&amp;spm=1018.2226.3001.4187" title="(2条消息) GDOUCTF_YAy17的博客-CSDN博客">(2条消息) GDOUCTF_YAy17的博客-CSDN博客</a></p> 
<p>抓包看看数据怎么传的<img alt="" src="https://images2.imgbox.com/e8/c4/0lnOF96a_o.png"></p> 
<p> 并且传入{<!-- -->{}}，发现被过滤，猜测是ssti注入，手注可以参考第三篇师傅写的，我手注也是看师傅们的payload，太强了</p> 
<p>在群里聊天后新见识了一个工具，fenjing就可以一把梭</p> 
<pre><code>- scan: 扫描整个网站
- crack: 对某个特定的表单进行攻击

Usage: python -m fenjing scan [OPTIONS]

Options:
  --url TEXT       需要扫描的URL
  --exec-cmd TEXT  成功后执行的shell指令，不填则进入交互模式
  --help           Show this message and exit.

Usage: python -m fenjing crack [OPTIONS]

Options:
  --url TEXT       form所在的URL
  --action TEXT    form的action，默认为当前路径
  --method TEXT    form的提交方式，默认为POST
  --inputs TEXT    form的参数，以逗号分隔
  --exec-cmd TEXT  成功后执行的shell指令，不填则进入交互模式
  --help           Show this message and exit.</code></pre> 
<p>payload：</p> 
<p>python3 -m fenjing crack --url '<a href="http://node1.anna.nssctf.cn:28807/get_flag" rel="nofollow" title="http://node1.anna.nssctf.cn:28807/get_flag">http://node1.anna.nssctf.cn:28807/get_flag</a>' --method POST --inputs name --action get_flag <img alt="" src="https://images2.imgbox.com/3c/6c/iE1HMNnO_o.png"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/7a/76/gDmGyGD2_o.png"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/48/4c/tEGbmAaL_o.png"></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<h3 id="%E6%B3%84%E9%9C%B2%E7%9A%84%E4%BC%AA%E8%A3%85">泄露的伪装</h3> 
<p>打开环境，发现没有什么，提示比较明显，存在泄露问题</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/a6/6e/zyvZuobS_o.png"></p> 
<p>dir扫一下，发现test.txt和www.rar文件，点进去看一看</p> 
<p><img alt="" src="https://images2.imgbox.com/3e/b2/8hcfz5T6_o.png"> 在www.rar里面给了/orzorz.php的页面，访问进去看一看</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/60/f7/blAsZlws_o.png"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/1f/69/NUF52X3P_o.png"></p> 
<p>文件包含问题，可以使用data伪协议读取,payload:</p> 
<p>orzorz.php?cxk=data://text/plain,ctrl  </p> 
<p style="text-align:center;"> <img alt="" src="https://images2.imgbox.com/1e/04/mZ2hPCqm_o.png"></p> 
<p> </p> 
<p> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2d33d1df1e936d0b74d42eec18383518/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">在sql中通过特定字符截取String类型的中间值</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/29a3cc0ddad5dbd5867fd4baf70544b6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python学习：构建代理池</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>