<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java调用C的dll - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java调用C的dll" />
<meta property="og:description" content="早就听说了 jni 可是到现在我才岛鼓出来，是不是很笨.......
好了费话不说了，开始进入正题
1.首先创建一个java类 Hello.java
public class Hello {
//在静态块里面,把lib.dll导进来,记住不能写.dll的，否则会找不到的
static
{
System.loadLibrary(&#34;lib&#34;);
}
//申明一个本地方法,该本地方法的实现在lib.dll中
public native static void printString(String str);
public static void main(String[] args) {
Hello.printString(&#34;Hello&#34;);
}
}
2.用javac编译这个类 : java Hello.java
不清楚的QQ:283066589
用javah对.clss生成C的头文件:javah Hello
现在头文件Hello.h的内容是:
/* DO NOT EDIT THIS FILE - it is machine generated */
#include &lt;jni.h&gt;
/* Header for class Hello */
#ifndef _Included_Hello
#define _Included_Hello
#ifdef __cplusplus
extern &#34;C&#34; {
#endif" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/b5f9697ad34b2d47001425b78b21c5b4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2007-04-12T09:38:00+08:00" />
<meta property="article:modified_time" content="2007-04-12T09:38:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java调用C的dll</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>早就听说了 jni   可是到现在我才岛鼓出来，是不是很笨.......</p> 
<p>好了费话不说了，开始进入正题</p> 
<p>1.首先创建一个java类    Hello.java</p> 
<p>public class Hello {<!-- --><br>    //在静态块里面,把lib.dll导进来,记住不能写.dll的，否则会找不到的<br>    static<br>    {<!-- --><br>         System.loadLibrary("lib");<br>    }<br>    //申明一个本地方法,该本地方法的实现在lib.dll中<br>    public native static void printString(String str);<br>    public static void main(String[] args) {<!-- --><br>        Hello.printString("Hello");<br>    }<br>}</p> 
<p>2.用javac编译这个类 : java Hello.java</p> 
<p>不清楚的QQ:283066589</p> 
<p>用javah对.clss生成C的头文件:javah Hello</p> 
<p>现在头文件Hello.h的内容是:</p> 
<p>/* DO NOT EDIT THIS FILE - it is machine generated */<br>#include &lt;jni.h&gt;<br>/* Header for class Hello */</p> 
<p>#ifndef _Included_Hello<br>#define _Included_Hello<br>#ifdef __cplusplus<br>extern "C" {<!-- --><br>#endif<br>/*<br> * Class:     Hello<br> * Method:    printString<br> * Signature: (Ljava/lang/String;)V<br> */<br>JNIEXPORT void JNICALL Java_Hello_printString<br>  (JNIEnv *, jclass, jstring);</p> 
<p>#ifdef __cplusplus<br>}<br>#endif<br>#endif</p> 
<p>要提醒大家的是可能jdk的版本不同，生成的头文件可能有点不同，，不过都大同小意，改改就行了，我用的是jdk1.5,根据上面的头文件，改一个.c文件,(现在只把这个.h的文件后辍改成.c就可以，先这么写) 记住最好复制一个，因为这个头文件还有用了,如何改一个.c文件呢?下面我告诉</p> 
<p>先打开一个Visual C++,创建一个工程,记住这个工程应该是生成dll的工程,,应该选择Win32 Dynamic-Link Library</p> 
<p>工程创建好了,那么把那个.c文件导进来</p> 
<p>在导之前先把.c文件复制到工程下</p> 
<p>以下是我改的.c文件</p> 
<p>/* DO NOT EDIT THIS FILE - it is machine generated */<br>#include &lt;jni.h&gt;<br>/* Header for class Hello */</p> 
<p>#ifndef _Included_Hello<br>#define _Included_Hello<br>#ifdef __cplusplus<br>extern "C" {<!-- --><br>#endif<br>/*<br> * Class:     Hello<br> * Method:    printString<br> * Signature: (Ljava/lang/String;)V<br> */<br>JNIEXPORT void JNICALL Java_Hello_printString<br>  (JNIEnv *env, jclass obj, jstring str)<br> {<!-- --><br>  printf(str);<br> }<br>#ifdef __cplusplus<br>}<br>#endif<br>#endif</p> 
<p>这个时候你可能已经发现了  #include &lt;jni.h&gt;<br>这个头文件，它在哪里了，找到他了，应该入到哪了呢？/</p> 
<p>jni.h在jdk1.5目录下的include目录下</p> 
<p>那么把它放到visual目录下VC98/include下,编辑文件生成dll</p> 
<p>在工程下找到debug 下的dll改名为lib.dll,把这个dll放到jdk1.5的bin目录下</p> 
<p>现在用java Hello</p> 
<p>就会输出Hello.哈哈，是不是很简单....................</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a8b128f1c6a6f134a48a0f2f28223fa2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">LR中判断HTTP返回状态</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c1dd84400c8164a9ddf930dc4308f0d7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Servlet入门1——第一個Servlet程式</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>