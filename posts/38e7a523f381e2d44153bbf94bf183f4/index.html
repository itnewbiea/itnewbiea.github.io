<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>QCustomPlot系列(6)-在图中插入文本框/直线箭头/图片/矩形/椭圆/游标等 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="QCustomPlot系列(6)-在图中插入文本框/直线箭头/图片/矩形/椭圆/游标等" />
<meta property="og:description" content="效果图如下：
QCustomPlot已经为我们提供了文字框QCPItemText、直线(可设置带箭头)类QCPItemLine。
一、QCPItemText的基本用法：
textLabel = new QCPItemText(this);//在QCustomplot中新建文字框 textLabel-&gt;setPositionAlignment(Qt::AlignTop|Qt::AlignLeft);//文字布局：顶、左对齐 textLabel-&gt;position-&gt;setType(QCPItemPosition::ptAxisRectRatio);//位置类型（当前轴范围的比例为单位/实际坐标为单位） textLabel-&gt;position-&gt;setCoords(0.5, 0); //把文字框放在X轴的中间，Y轴的最顶部 textLabel-&gt;setText(&#34;Text Item Demo&#34;); textLabel-&gt;setFont(QFont(font().family(), 16)); //字体大小 textLabel-&gt;setPen(QPen(Qt::black)); //字体颜色 textLabel-&gt;setPadding(QMargins(2,2,2,2));//文字距离边框几个像素 美中不足的是，官方没有提供设置QCPItemText背景色的方法，默认背景是透明的。不过好在有源码，我们改改官方源码，使他支持设置背景色。修改步骤如下：
跳转到QCPItemText类的virtual void draw(QCPPainter *painter) Q_DECL_OVERRIDE函数里来看一下，
QCPItemText绘制边框、绘制文字都是在这个函数里干的，上面红色框的那一句是我自己加的，我把背景设置成了绿色（原理就是在绘制方框、文字之前，先绘制一个绿色矩形面）。知道了这一点，我们就可以添加一个private的QColor变量，然后通过public接口操作这个颜色就可以随时修改文字框的背景了。
二、下面再看看QCustomPlot的直线类QCPItemLine
基本用法如下：
arrow = new QCPItemLine(this); arrow-&gt;start-&gt;setParentAnchor(textLabel-&gt;bottom); //设置该直线的起点为文字框的下锚点 arrow-&gt;end-&gt;setCoords(4, 1.6); //设置直线终点为坐标系中的点 arrow-&gt;setHead(QCPLineEnding::esSpikeArrow);//设置箭头类型（三角形、菱形、方形等） arrow-&gt;setVisible(false); 较为简单，不再赘述。
三、设置跟随锚定点
setParentAnchor(QCPItemAnchor *)、
setParentAnchorX(QCPItemAnchor *) 、
setParentAnchorY(QCPItemAnchor *)
设置锚定点的作用是什么？
举2个例子：
（1）我们在plot中画了一个箭头，箭头的起点位于某文本框的底部中心，如本文的第一张图所示，我们希望当文本框发生移动时，箭头的起点能够总是保持在文本框的底部中心，实现这一功能，只需把箭头的起始点设置为锚定到文本框的底部锚上即可：arrow-&gt;start-&gt;setParentAnchor(textLabel-&gt;bottom);
（2）我们在plot中添加了一个游标和文本框，我们希望游标能跟随鼠标实时移动，然后文本框紧贴plot的左边沿，文本框的Y位置总是等于游标的Y位置。由于游标、文本框都继承了QCPAbstractItem，都具备锚定功能，只需把文本框的Y位置锚定在游标锚的Y位置上即可。
图形元素中的QCPItemAnchor 或QCPItemPosition类型的成员就是锚定点（见上图），QCustomplot中的QCPAbstractItem类型的图形元素（见下图）都有锚定点，
文本框类QCPItemText含有4个锚点成员变量：上下左右，锚点坐标就是文本框四边的正中心。如果设置了某个QCPAbstractItem对象的锚点锚定（也可以设置只锚定X值或Y值）在文本框的某个锚点上，那么QCPAbstractItem对象的锚点（或者X坐标/Y坐标）就会总是等于文本框的锚点坐标。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/38e7a523f381e2d44153bbf94bf183f4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-05-21T15:02:25+08:00" />
<meta property="article:modified_time" content="2019-05-21T15:02:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">QCustomPlot系列(6)-在图中插入文本框/直线箭头/图片/矩形/椭圆/游标等</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>效果图如下：</p> 
<p><img alt="" class="has" height="243" src="https://images2.imgbox.com/0c/51/Vwu5JS2b_o.png" width="813"></p> 
<p> </p> 
<p>QCustomPlot已经为我们提供了文字框QCPItemText、直线(可设置带箭头)类QCPItemLine。</p> 
<p>一、QCPItemText的基本用法：</p> 
<pre class="has"><code>textLabel = new QCPItemText(this);//在QCustomplot中新建文字框
textLabel-&gt;setPositionAlignment(Qt::AlignTop|Qt::AlignLeft);//文字布局：顶、左对齐
textLabel-&gt;position-&gt;setType(QCPItemPosition::ptAxisRectRatio);//位置类型（当前轴范围的比例为单位/实际坐标为单位）
textLabel-&gt;position-&gt;setCoords(0.5, 0); //把文字框放在X轴的中间，Y轴的最顶部
textLabel-&gt;setText("Text Item Demo");
textLabel-&gt;setFont(QFont(font().family(), 16)); //字体大小
textLabel-&gt;setPen(QPen(Qt::black)); //字体颜色
textLabel-&gt;setPadding(QMargins(2,2,2,2));//文字距离边框几个像素
</code></pre> 
<p>美中不足的是，官方没有提供设置QCPItemText背景色的方法，默认背景是透明的。不过好在有源码，我们改改官方源码，使他支持设置背景色。修改步骤如下：</p> 
<p>跳转到QCPItemText类的virtual void draw(QCPPainter *painter) Q_DECL_OVERRIDE函数里来看一下，</p> 
<pre> </pre> 
<p>QCPItemText绘制边框、绘制文字都是在这个函数里干的，上面红色框的那一句是我自己加的，我把背景设置成了绿色（原理就是在绘制方框、文字之前，先绘制一个绿色矩形面）。知道了这一点，我们就可以添加一个private的QColor变量，然后通过public接口操作这个颜色就可以随时修改文字框的背景了。</p> 
<p> </p> 
<p>二、下面再看看QCustomPlot的直线类QCPItemLine</p> 
<p>基本用法如下：</p> 
<pre class="has"><code>arrow = new QCPItemLine(this);
arrow-&gt;start-&gt;setParentAnchor(textLabel-&gt;bottom);  //设置该直线的起点为文字框的下锚点  
arrow-&gt;end-&gt;setCoords(4, 1.6); //设置直线终点为坐标系中的点
arrow-&gt;setHead(QCPLineEnding::esSpikeArrow);//设置箭头类型（三角形、菱形、方形等）
arrow-&gt;setVisible(false);</code></pre> 
<p>较为简单，不再赘述。</p> 
<p> </p> 
<p> </p> 
<p>三、设置跟随锚定点</p> 
<p>setParentAnchor(QCPItemAnchor *)、<br> setParentAnchorX(QCPItemAnchor *) 、<br> setParentAnchorY(QCPItemAnchor *)</p> 
<p>设置锚定点的作用是什么？</p> 
<p>举2个例子：</p> 
<p>（1）我们在plot中画了一个箭头，箭头的起点位于某文本框的底部中心，如本文的第一张图所示，我们希望当文本框发生移动时，箭头的起点能够总是保持在文本框的底部中心，实现这一功能，只需把箭头的起始点设置为锚定到文本框的底部锚上即可：arrow-&gt;start-&gt;setParentAnchor(textLabel-&gt;bottom);</p> 
<p>（2）我们在plot中添加了一个游标和文本框，我们希望游标能跟随鼠标实时移动，然后文本框紧贴plot的左边沿，文本框的Y位置总是等于游标的Y位置。由于游标、文本框都继承了QCPAbstractItem，都具备锚定功能，只需把文本框的Y位置锚定在游标锚的Y位置上即可。</p> 
<p> </p> 
<p><img alt="" class="has" height="137" src="https://images2.imgbox.com/7d/89/xUbbJ6nL_o.png" width="289"></p> 
<p>图形元素中的QCPItemAnchor 或QCPItemPosition类型的成员就是锚定点（见上图），QCustomplot中的QCPAbstractItem类型的图形元素（见下图）都有锚定点，</p> 
<p><img alt="" class="has" height="433" src="https://images2.imgbox.com/5b/6d/Zp8R9Ozm_o.png" width="579"></p> 
<p>文本框类QCPItemText含有4个锚点成员变量：上下左右，锚点坐标就是文本框四边的正中心。如果设置了某个QCPAbstractItem对象的锚点锚定（也可以设置只锚定X值或Y值）在文本框的某个锚点上，那么QCPAbstractItem对象的锚点（或者X坐标/Y坐标）就会总是等于文本框的锚点坐标。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2d1cf9fb5a24225543b3413cc99a361b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">申请者评分模型(A卡)开发（基于逻辑回归）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ee522f012e8781b0081f654b7bf06df1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Git使用出现git@github.com: Permission denied (publickey).  处理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>