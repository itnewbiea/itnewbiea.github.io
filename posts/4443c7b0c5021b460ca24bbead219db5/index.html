<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Window 硬件】检测哪个程序占用了串口 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【Window 硬件】检测哪个程序占用了串口" />
<meta property="og:description" content=" 一、常见提问 如何解决串口（COM）被占用问题 电脑串口号被占用,如何清除 解决串口(COM)被占用问题 我的电脑显示串口被占用,什么原因? 串口端口被占用的解决方法 串口被占用怎么办 window下，怎么查看串口被哪个进程占用，有什么方法或者软件可以协助查看吗？ 串口不知被什么程序占用,有谁能帮我找出来吗 如何使用被其它程序占用的串口? 怎样查串口被个程序占用 如何清除Win7中被占用的COM口 串口 二、串口常见占用统计 自己的软件存在BUG没有退出，可以在任务管理器中查看，修复自身软件bug；别的软件开机优先占用，此时需要找到占用串口的程序，卸载程序或删除；USB转串口设备在使用过程热插拔，此时需要查看隐藏的串口，删除、重启计算机。莫名奇妙的Windows软件、硬件占用如：mstsc.exe、svchost.exe、控制面板-电话/调制解调选择-调制解调器、声卡等，这些占用情况，关闭或禁用基本能够解决占用情况，至于是怎么导致的，有可能是由于个人操作、硬件驱动、系统版本等原因导致。 三、查看串口号是否正在使用中 【Win&#43;R】-运行-regedit
计算机\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\COM Name Arbiter 3.1ComDB二进制值说明 ComDB为二进制数据，表示相应串口是否在使用状态。ComDB的数据规则为，COMn 在ComDB数据数值的使用标识为从左到有，第( (n-1)/8&#43;1)列的1&lt;&lt;( (n-1) mode 8&#43;1)位 。0标识无此串口，1标识此串口正在使用。
每两位16进制数据为1列，m范围[0,31]：
第m&#43;1列的第1位标识COM[m*8&#43;1]的使用状态；第m&#43;1列的第2位标识COM[m*8&#43;2]的使用状态；第m&#43;1列的第3位标识COM[m*8&#43;3]的使用状态；第m&#43;1列的第4位标识COM[m*8&#43;4]的使用状态；第m&#43;1列的第5位标识COM[m*8&#43;5]的使用状态；第m&#43;1列的第6位标识COM[m*8&#43;6]的使用状态；第m&#43;1列的第7位标识COM[m*8&#43;7]的使用状态；第m&#43;1列的第8位标识COM[m*8&#43;8]的使用状态。 例：如下图，第30&#43;1=31列数据为0x80，则标识COM [30*8&#43;8]=COM248的串口号为正在使用状态。
3.2重新分配串口号 删除ComDB项，计算机会重建此字段，意味着重新分配所有串口号，如果没有生效可尝试重启计算机。
四、查看隐藏的串口设备 设备管理器中看不到此串口号，但又不能将其他串口设置为此串口号；一些USB设备热插拔后自动分配了更高的串口号；这些都是隐藏串口导致的，找到他们并删除，USB尽量避免热插拔。
4.1设置显示硬件设备状态 set devmgr_show_nonpresent_devices=1 4.2显示隐藏的设备 devmgmt.msc 4.3删除隐藏占用的串口设备 五使用DOS命令查看串口运行状态 Mode 六、查找占用串口的程序 6.1准备好串口工具 如：CEIWEI CommMonitor10.0.1.18011.rar
6.2截获占用串口的程序PID 安装好后监控所有串口，使用对应串口连接的下位机的功能，如“上电”、“断电”或“单片机自定义的弹片触发”等一切可能的功能，往上位机推送数据，此时监控工具会截获下位机往上位机推送的数据并显示在数据区，其中就包括了占用此串口程序进程的PID。
6.3根据PID找到占用串口的程序 任务栏【右键】-任务管理器-详细信息，根据监控工具所示的PID在任务管理器中可以找到对应占用此串口程序的名称。
七、强制释放占用中的串口 7.1方式一、在任务管理器中结束占用串口的程序 任务栏【右键】-任务管理器-详细信息
7.2方式二、先禁用后启用串口设备 计算机【右键】-管理-计算机管理(本地)-系统工具-设备管理器-端口(COM和LPT)-通讯端口【右键】-禁用。
计算机【右键】-管理-计算机管理(本地)-系统工具-设备管理器-端口(COM和LPT)-通讯端口【右键】-启用。
7.3方式三、重启计算机 " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/4443c7b0c5021b460ca24bbead219db5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-01-11T17:02:19+08:00" />
<meta property="article:modified_time" content="2019-01-11T17:02:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Window 硬件】检测哪个程序占用了串口</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、常见提问</h2> 
<pre class="has"><code>如何解决串口（COM）被占用问题

电脑串口号被占用,如何清除

解决串口(COM)被占用问题

我的电脑显示串口被占用,什么原因?

串口端口被占用的解决方法

串口被占用怎么办

window下，怎么查看串口被哪个进程占用，有什么方法或者软件可以协助查看吗？

串口不知被什么程序占用,有谁能帮我找出来吗

如何使用被其它程序占用的串口?

怎样查串口被个程序占用

如何清除Win7中被占用的COM口 串口</code></pre> 
<h2>二、串口常见占用统计</h2> 
<ul><li>自己的软件存在BUG没有退出，可以在任务管理器中查看，修复自身软件bug；</li><li>别的软件开机优先占用，此时需要找到占用串口的程序，卸载程序或删除；</li><li>USB转串口设备在使用过程热插拔，此时需要查看隐藏的串口，删除、重启计算机。</li><li>莫名奇妙的Windows软件、硬件占用如：mstsc.exe、svchost.exe、控制面板-电话/调制解调选择-调制解调器、声卡等，这些占用情况，关闭或禁用基本能够解决占用情况，至于是怎么导致的，有可能是由于个人操作、硬件驱动、系统版本等原因导致。</li></ul> 
<p style="margin-left:0cm;"> </p> 
<h2>三、查看串口号是否正在使用中</h2> 
<p style="margin-left:0cm;"><span style="color:#5b9bd5;"><em>【Win+R</em></span><span style="color:#5b9bd5;"><em>】-</em></span><span style="color:#5b9bd5;"><em>运行-regedit</em></span></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="272" src="https://images2.imgbox.com/4b/f9/stni324U_o.png" width="513"></p> 
<pre class="has"><code class="language-vbscript">计算机\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\COM Name Arbiter</code></pre> 
<p style="margin-left:0cm;"><img alt="" class="has" height="248" src="https://images2.imgbox.com/75/41/Yz3ScPhm_o.png" width="1025"></p> 
<h3>3.1ComDB二进制值说明</h3> 
<p style="margin-left:0cm;">ComDB为二进制数据，表示相应串口是否在使用状态。ComDB的数据规则为，<span style="color:#1f4e79;">COM</span>n 在ComDB数据数值的使用标识为<span style="color:#5b9bd5;"><em>从左到有</em></span>，第( (n-1)/8+1)列的1&lt;&lt;( (n-1) <span style="color:#1f4e79;">mode</span> 8+1)位 。0标识无此串口，1标识此串口正在使用。</p> 
<p style="margin-left:0cm;">每两位16进制数据为1列，m范围[0,31]：</p> 
<ul><li>第m+1列的第1位标识COM[m*8+1]的使用状态；</li><li>第m+1列的第2位标识COM[m*8+2]的使用状态；</li><li>第m+1列的第3位标识COM[m*8+3]的使用状态；</li><li>第m+1列的第4位标识COM[m*8+4]的使用状态；</li><li>第m+1列的第5位标识COM[m*8+5]的使用状态；</li><li>第m+1列的第6位标识COM[m*8+6]的使用状态；</li><li>第m+1列的第7位标识COM[m*8+7]的使用状态；</li><li>第m+1列的第8位标识COM[m*8+8]的使用状态。</li></ul> 
<p style="margin-left:0cm;">例：如下图，第30+1=31列数据为0x80，则标识COM [30*8+8]=COM248的串口号为正在使用状态。</p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="192" src="https://images2.imgbox.com/be/4b/8iMbxQML_o.png" width="1087"></p> 
<h3>3.2重新分配串口号</h3> 
<p style="margin-left:0cm;"><span style="color:#c00000;">删除</span><span style="color:#c00000;">ComDB</span><span style="color:#c00000;">项，计算机会重建此字段，意味着重新分配所有串口号，如果没有生效可尝试重启计算机。</span></p> 
<h2>四、查看隐藏的串口设备</h2> 
<p style="margin-left:0cm;">设备管理器中看不到此串口号，但又不能将其他串口设置为此串口号；一些USB设备热插拔后自动分配了更高的串口号；这些都是隐藏串口导致的，找到他们并删除，USB尽量避免热插拔。</p> 
<h3>4.1设置显示硬件设备状态</h3> 
<pre class="has"><code class="language-vbscript">set devmgr_show_nonpresent_devices=1</code></pre> 
<p style="margin-left:0cm;"><img alt="" class="has" height="154" src="https://images2.imgbox.com/cf/af/Qv4r8yH3_o.png" width="671"></p> 
<h3>4.2显示隐藏的设备</h3> 
<pre class="has"><code class="language-vbscript">devmgmt.msc</code></pre> 
<p style="margin-left:0cm;"><img alt="" class="has" height="107" src="https://images2.imgbox.com/d0/f2/OEYrVvSN_o.png" width="671"></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="715" src="https://images2.imgbox.com/15/4f/D5h8DYYv_o.png" width="976"></p> 
<h3>4.3删除隐藏占用的串口设备</h3> 
<p style="margin-left:0cm;"><img alt="" class="has" height="715" src="https://images2.imgbox.com/75/ee/qfXKWakV_o.png" width="976"></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="715" src="https://images2.imgbox.com/cf/fc/Ncst9ApG_o.png" width="976"></p> 
<h2>五使用DOS命令查看串口运行状态</h2> 
<pre class="has"><code class="language-vbscript">Mode</code></pre> 
<p style="margin-left:0cm;"><img alt="" class="has" height="490" src="https://images2.imgbox.com/3a/bf/M5mjuPs3_o.png" width="677"></p> 
<h2>六、查找占用串口的程序</h2> 
<h3>6.1准备好串口工具</h3> 
<p style="margin-left:0cm;">如：CEIWEI CommMonitor10.0.1.18011.rar</p> 
<p> </p> 
<h3>6.2截获占用串口的程序PID</h3> 
<p style="margin-left:0cm;">安装好后监控所有串口，使用对应串口连接的下位机的功能，如“上电”、“断电”或“单片机自定义的弹片触发”等一切可能的功能，往上位机推送数据，此时监控工具会截获下位机往上位机推送的数据并显示在数据区，其中就包括了占用此串口程序进程的PID。</p> 
<h3>6.3根据PID找到占用串口的程序</h3> 
<p style="margin-left:0cm;"><span style="color:#5b9bd5;"><em>任务栏【右键】-</em></span><span style="color:#5b9bd5;"><em>任务管理器-</em></span><span style="color:#5b9bd5;"><em>详细信息</em></span>，根据监控工具所示的PID在任务管理器中可以找到对应占用此串口程序的名称。</p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="900" src="https://images2.imgbox.com/b4/9c/vrfnuQgA_o.png" width="1200"></p> 
<h2>七、强制释放占用中的串口</h2> 
<h3>7.1方式一、在任务管理器中结束占用串口的程序</h3> 
<p style="margin-left:0cm;"><span style="color:#5b9bd5;"><em>任务栏【右键】-</em></span><span style="color:#5b9bd5;"><em>任务管理器-</em></span><span style="color:#5b9bd5;"><em>详细信息</em></span></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="742" src="https://images2.imgbox.com/a5/ec/2VxkbvRd_o.png" width="834"></p> 
<p> </p> 
<h3>7.2方式二、先禁用后启用串口设备</h3> 
<p style="margin-left:0cm;"><span style="color:#5b9bd5;"><em>计算机【右键】-</em></span><span style="color:#5b9bd5;"><em>管理-</em></span><span style="color:#5b9bd5;"><em>计算机管理(</em></span><span style="color:#5b9bd5;"><em>本地)-</em></span><span style="color:#5b9bd5;"><em>系统工具-</em></span><span style="color:#5b9bd5;"><em>设备管理器-</em></span><span style="color:#5b9bd5;"><em>端口(COM</em></span><span style="color:#5b9bd5;"><em>和LPT)-</em></span><span style="color:#5b9bd5;"><em>通讯端口【右键】-</em></span><span style="color:#5b9bd5;"><em>禁用。</em></span></p> 
<p style="margin-left:0cm;"><span style="color:#5b9bd5;"><em>计算机【右键】-</em></span><span style="color:#5b9bd5;"><em>管理-</em></span><span style="color:#5b9bd5;"><em>计算机管理(</em></span><span style="color:#5b9bd5;"><em>本地)-</em></span><span style="color:#5b9bd5;"><em>系统工具-</em></span><span style="color:#5b9bd5;"><em>设备管理器-</em></span><span style="color:#5b9bd5;"><em>端口(COM</em></span><span style="color:#5b9bd5;"><em>和LPT)-</em></span><span style="color:#5b9bd5;"><em>通讯端口【右键】-</em></span><span style="color:#5b9bd5;"><em>启用。</em></span></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="1080" src="https://images2.imgbox.com/64/d6/yn3XXbyK_o.png" width="1200"></p> 
<p style="margin-left:0cm;"> </p> 
<p> </p> 
<h3>7.3方式三、重启计算机</h3>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/51b0e33a2d929efa1a0b208aca3e1266/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">EventEmitter事件通信（发布订阅）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/49aa7fcf81ac2b54407691d0f1bf74cc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">汇编语言-王爽（学习笔记）-12章 中断</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>