<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>毕业设计 图像识别文字区域提取算法研究与实现 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="毕业设计 图像识别文字区域提取算法研究与实现" />
<meta property="og:description" content="文章目录 0 项目说明1 使用说明2 算法流程3 部分实验效果4 项目源码5 最后 0 项目说明 图像中文字区域提取研究
提示：适合用于课程设计或毕业设计，工作量达标，源码开放
1 使用说明 基于swt和mser算法的文本检测，用到了SVM分类器只限于检测字体较为规范的英文文本使用时，先运行mser_swt.m文件，再运行detection_Eng.m文件 2 算法流程 3 部分实验效果 4 项目源码 %函数功能：计算输入图像的笔画宽度图像 %包含两次计算，第二次为笔画拐角处的计算值的修正 function [swtmap2]=SwtTransform(str,searchDirection) im=imread(str); if size(im,3)==3 im=rgb2gray(im); end im=im2double((im)); %figure,imshow(im); edgeMap=edge(im,&#39;canny&#39;); %figure,imshow(edgeMap,[]); sobelMask = fspecial(&#39;sobel&#39;); dx = imfilter(im,sobelMask); dy = imfilter(im,sobelMask&#39;); [edgePointRows, edgePointCols] = find(edgeMap); %初始化梯度角度矩阵 theta=zeros(size(edgeMap,1),size(edgeMap,2)); %计算边缘图像中每个像素的梯度方向 for i=1:size(edgeMap,1) for j=1:size(edgeMap,2) if edgeMap(i,j)==1 theta(i,j)=atan2(dy(i,j),dx(i,j)); end end end [m,n] = size(edgeMap); % 初始化笔画宽度 swtMap = zeros(m,n); for i=1:m for j=1:n swtMap(i,j) =1000; end end % 笔划宽度最大值 maxStrokeWidth = 350; % 初始化矩阵储存所有可能的笔画点 strokePointsX = zeros(size(edgePointCols)); strokePointsY = zeros(size(strokePointsX)); sizeOfStrokePoints = 0; widthvalue=zeros(1,10000); widthvalue(1)=inf; % Iterate through all edge points and compute stoke widths for i=1:size(edgePointRows) step = 1; initialX = edgePointRows(i); initialY = edgePointCols(i); isStroke = 0; initialTheta = theta(initialX,initialY); sizeOfRay = 0; pointOfRayX = zeros(maxStrokeWidth,1); pointOfRayY = zeros(maxStrokeWidth,1); % 记录射线的第一个点 pointOfRayX(sizeOfRay&#43;1) = initialX; pointOfRayY(sizeOfRay&#43;1) = initialY; % 增加射线长度 sizeOfRay = sizeOfRay &#43; 1; while step &lt; maxStrokeWidth nextX = round(initialX &#43; cos(initialTheta) * searchDirection * step); nextY = round(initialY &#43; sin(initialTheta) * searchDirection * step); step = step &#43; 1; if nextX &lt; 1 || nextY &lt; 1 || nextX &gt; m || nextY &gt; n break end % 记录射线的下一个点 pointOfRayX(sizeOfRay&#43;1) = nextX; pointOfRayY(sizeOfRay&#43;1) = nextY; %增加射线长度 sizeOfRay = sizeOfRay &#43; 1; % 找到对应的边缘像素点 if edgeMap(nextX,nextY) oppositeTheta = theta(nextX,nextY); % 判断梯度方向角度 if abs(abs(initialTheta - oppositeTheta) - pi) &lt; pi/2 isStroke = 1; strokePointsX(sizeOfStrokePoints&#43;1) = initialX; strokePointsY(sizeOfStrokePoints&#43;1) = initialY; sizeOfStrokePoints = sizeOfStrokePoints &#43; 1; end break end end if isStroke % 计算笔划宽度 strokeWidth = sqrt((nextX - initialX)^2 &#43; (nextY - initialY)^2); widthvalue(i)=strokeWidth; % Iterate all ray points and populate with the minimum stroke width for j=1:sizeOfRay swtMap(pointOfRayX(j),pointOfRayY(j)) = min(swtMap(pointOfRayX(j),pointOfRayY(j)),strokeWidth); end end end a=max(widthvalue,[],2); [a,b]=size(swtMap); for i=1:m for j=1:n if swtMap(i,j)&gt;=0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/4ea480deff1560f0b841beed3828acdc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-02T11:21:42+08:00" />
<meta property="article:modified_time" content="2023-02-02T11:21:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">毕业设计 图像识别文字区域提取算法研究与实现</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#0__3" rel="nofollow">0 项目说明</a></li><li><a href="#1__9" rel="nofollow">1 使用说明</a></li><li><a href="#2__14" rel="nofollow">2 算法流程</a></li><li><a href="#3__16" rel="nofollow">3 部分实验效果</a></li><li><a href="#4__19" rel="nofollow">4 项目源码</a></li><li><a href="#5__206" rel="nofollow">5 最后</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="0__3"></a>0 项目说明</h2> 
<p><strong>图像中文字区域提取研究</strong></p> 
<p><code>提示：适合用于课程设计或毕业设计，工作量达标，源码开放</code></p> 
<hr> 
<h2><a id="1__9"></a>1 使用说明</h2> 
<ul><li>基于swt和mser算法的文本检测，用到了SVM分类器</li><li>只限于检测字体较为规范的英文文本</li><li>使用时，先运行mser_swt.m文件，再运行detection_Eng.m文件</li></ul> 
<h2><a id="2__14"></a>2 算法流程</h2> 
<p><img src="https://images2.imgbox.com/ae/09/N67zLBId_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3__16"></a>3 部分实验效果</h2> 
<p><img src="https://images2.imgbox.com/b6/68/tEn9Jgh6_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="4__19"></a>4 项目源码</h2> 
<pre><code class="prism language-c"><span class="token operator">%</span>函数功能：计算输入图像的笔画宽度图像
<span class="token operator">%</span>包含两次计算，第二次为笔画拐角处的计算值的修正
function <span class="token punctuation">[</span>swtmap2<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">SwtTransform</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span>searchDirection<span class="token punctuation">)</span>
 im<span class="token operator">=</span><span class="token function">imread</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">if</span> <span class="token function">size</span><span class="token punctuation">(</span>im<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">3</span>
     im<span class="token operator">=</span><span class="token function">rgb2gray</span><span class="token punctuation">(</span>im<span class="token punctuation">)</span><span class="token punctuation">;</span>
 end
im<span class="token operator">=</span><span class="token function">im2double</span><span class="token punctuation">(</span><span class="token punctuation">(</span>im<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span>figure<span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span>im<span class="token punctuation">)</span><span class="token punctuation">;</span>
edgeMap<span class="token operator">=</span><span class="token function">edge</span><span class="token punctuation">(</span>im<span class="token punctuation">,</span><span class="token char">'canny'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span>figure<span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span>edgeMap<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

sobelMask <span class="token operator">=</span> <span class="token function">fspecial</span><span class="token punctuation">(</span><span class="token char">'sobel'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dx <span class="token operator">=</span> <span class="token function">imfilter</span><span class="token punctuation">(</span>im<span class="token punctuation">,</span>sobelMask<span class="token punctuation">)</span><span class="token punctuation">;</span>
dy <span class="token operator">=</span> <span class="token function">imfilter</span><span class="token punctuation">(</span>im<span class="token punctuation">,</span>sobelMask'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>edgePointRows<span class="token punctuation">,</span> edgePointCols<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>edgeMap<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span>初始化梯度角度矩阵
theta<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>edgeMap<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">size</span><span class="token punctuation">(</span>edgeMap<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span>计算边缘图像中每个像素的梯度方向
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>edgeMap<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>edgeMap<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token function">edgeMap</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span>
            <span class="token function">theta</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">atan2</span><span class="token punctuation">(</span><span class="token function">dy</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">dx</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        end
    end
end
<span class="token punctuation">[</span>m<span class="token punctuation">,</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>edgeMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span> 初始化笔画宽度
swtMap <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>m
    <span class="token keyword">for</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
        <span class="token function">swtMap</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>
    end
end

<span class="token operator">%</span> 笔划宽度最大值
maxStrokeWidth <span class="token operator">=</span> <span class="token number">350</span><span class="token punctuation">;</span>

<span class="token operator">%</span> 初始化矩阵储存所有可能的笔画点
strokePointsX <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>edgePointCols<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
strokePointsY <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>strokePointsX<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sizeOfStrokePoints <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
widthvalue<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">widthvalue</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>inf<span class="token punctuation">;</span>
<span class="token operator">%</span> Iterate through all edge points and compute stoke widths
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>edgePointRows<span class="token punctuation">)</span>
    step <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    initialX <span class="token operator">=</span> <span class="token function">edgePointRows</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    initialY <span class="token operator">=</span> <span class="token function">edgePointCols</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    isStroke <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    initialTheta <span class="token operator">=</span> <span class="token function">theta</span><span class="token punctuation">(</span>initialX<span class="token punctuation">,</span>initialY<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sizeOfRay <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    pointOfRayX <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>maxStrokeWidth<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pointOfRayY <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>maxStrokeWidth<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token operator">%</span> 记录射线的第一个点
    <span class="token function">pointOfRayX</span><span class="token punctuation">(</span>sizeOfRay<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> initialX<span class="token punctuation">;</span>
    <span class="token function">pointOfRayY</span><span class="token punctuation">(</span>sizeOfRay<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> initialY<span class="token punctuation">;</span>
    
    <span class="token operator">%</span> 增加射线长度
    sizeOfRay <span class="token operator">=</span> sizeOfRay <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> step <span class="token operator">&lt;</span> maxStrokeWidth
        nextX <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>initialX <span class="token operator">+</span> <span class="token function">cos</span><span class="token punctuation">(</span>initialTheta<span class="token punctuation">)</span> <span class="token operator">*</span> searchDirection <span class="token operator">*</span> step<span class="token punctuation">)</span><span class="token punctuation">;</span>
        nextY <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>initialY <span class="token operator">+</span> <span class="token function">sin</span><span class="token punctuation">(</span>initialTheta<span class="token punctuation">)</span> <span class="token operator">*</span> searchDirection <span class="token operator">*</span> step<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        step <span class="token operator">=</span> step <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        
        
        <span class="token keyword">if</span> nextX <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> nextY <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> nextX <span class="token operator">&gt;</span> m <span class="token operator">||</span> nextY <span class="token operator">&gt;</span> n
            <span class="token keyword">break</span>
        end
        
        <span class="token operator">%</span> 记录射线的下一个点
        <span class="token function">pointOfRayX</span><span class="token punctuation">(</span>sizeOfRay<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> nextX<span class="token punctuation">;</span>
        <span class="token function">pointOfRayY</span><span class="token punctuation">(</span>sizeOfRay<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> nextY<span class="token punctuation">;</span>
        
        <span class="token operator">%</span>增加射线长度
        sizeOfRay <span class="token operator">=</span> sizeOfRay <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        
        <span class="token operator">%</span> 找到对应的边缘像素点
        <span class="token keyword">if</span> <span class="token function">edgeMap</span><span class="token punctuation">(</span>nextX<span class="token punctuation">,</span>nextY<span class="token punctuation">)</span>
            
            oppositeTheta <span class="token operator">=</span> <span class="token function">theta</span><span class="token punctuation">(</span>nextX<span class="token punctuation">,</span>nextY<span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token operator">%</span> 判断梯度方向角度
            <span class="token keyword">if</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>initialTheta <span class="token operator">-</span> oppositeTheta<span class="token punctuation">)</span> <span class="token operator">-</span> pi<span class="token punctuation">)</span> <span class="token operator">&lt;</span> pi<span class="token operator">/</span><span class="token number">2</span>
                isStroke <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token function">strokePointsX</span><span class="token punctuation">(</span>sizeOfStrokePoints<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> initialX<span class="token punctuation">;</span>
                <span class="token function">strokePointsY</span><span class="token punctuation">(</span>sizeOfStrokePoints<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> initialY<span class="token punctuation">;</span>
                sizeOfStrokePoints <span class="token operator">=</span> sizeOfStrokePoints <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            end                   
            
  <span class="token keyword">break</span>           
        end
    end
    
    <span class="token keyword">if</span> isStroke
        
        <span class="token operator">%</span> 计算笔划宽度
        strokeWidth <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nextX <span class="token operator">-</span> initialX<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span>nextY <span class="token operator">-</span> initialY<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">widthvalue</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span>strokeWidth<span class="token punctuation">;</span>
        <span class="token operator">%</span> Iterate all ray points and populate with the minimum stroke width
        <span class="token keyword">for</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>sizeOfRay
            <span class="token function">swtMap</span><span class="token punctuation">(</span><span class="token function">pointOfRayX</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">pointOfRayY</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">swtMap</span><span class="token punctuation">(</span><span class="token function">pointOfRayX</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">pointOfRayY</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>strokeWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
        end
    end
    
end

a<span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>widthvalue<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>a<span class="token punctuation">,</span>b<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">size</span><span class="token punctuation">(</span>swtMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>m
    <span class="token keyword">for</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
        <span class="token keyword">if</span> <span class="token function">swtMap</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">0.1</span><span class="token operator">*</span>a
            <span class="token function">swtMap</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>
        end
    end
end

<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>sizeOfStrokePoints
    step <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    initialX <span class="token operator">=</span> <span class="token function">strokePointsX</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    initialY <span class="token operator">=</span> <span class="token function">strokePointsY</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    initialTheta <span class="token operator">=</span> <span class="token function">theta</span><span class="token punctuation">(</span>initialX<span class="token punctuation">,</span>initialY<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sizeOfRay <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    pointOfRayX <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>maxStrokeWidth<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pointOfRayY <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>maxStrokeWidth<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    swtValues <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>maxStrokeWidth<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sizeOfSWTValues <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    
    <span class="token operator">%</span> 记录射线第一个点
    <span class="token function">pointOfRayX</span><span class="token punctuation">(</span>sizeOfRay<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> initialX<span class="token punctuation">;</span>
    <span class="token function">pointOfRayY</span><span class="token punctuation">(</span>sizeOfRay<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> initialY<span class="token punctuation">;</span>
   <span class="token operator">%</span> 增加射线长度
    sizeOfRay <span class="token operator">=</span> sizeOfRay <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    
    <span class="token operator">%</span> Record the swt value of first stoke point
    <span class="token function">swtValues</span><span class="token punctuation">(</span>sizeOfSWTValues<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">swtMap</span><span class="token punctuation">(</span>initialX<span class="token punctuation">,</span>initialY<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sizeOfSWTValues <span class="token operator">=</span> sizeOfSWTValues <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    
    <span class="token keyword">while</span> step <span class="token operator">&lt;</span> maxStrokeWidth
        nextX <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>initialX <span class="token operator">+</span> <span class="token function">cos</span><span class="token punctuation">(</span>initialTheta<span class="token punctuation">)</span> <span class="token operator">*</span> searchDirection <span class="token operator">*</span> step<span class="token punctuation">)</span><span class="token punctuation">;</span>
        nextY <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>initialY <span class="token operator">+</span> <span class="token function">sin</span><span class="token punctuation">(</span>initialTheta<span class="token punctuation">)</span> <span class="token operator">*</span> searchDirection <span class="token operator">*</span> step<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        step <span class="token operator">=</span> step <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        
        <span class="token operator">%</span> 记录射线的下一个点
        <span class="token function">pointOfRayX</span><span class="token punctuation">(</span>sizeOfRay<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> nextX<span class="token punctuation">;</span>
        <span class="token function">pointOfRayY</span><span class="token punctuation">(</span>sizeOfRay<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> nextY<span class="token punctuation">;</span>
        
        <span class="token operator">%</span> 增加射线长度
        sizeOfRay <span class="token operator">=</span> sizeOfRay <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        
        <span class="token operator">%</span> Record the swt value of next stoke point
        <span class="token function">swtValues</span><span class="token punctuation">(</span>sizeOfSWTValues<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">swtMap</span><span class="token punctuation">(</span>nextX<span class="token punctuation">,</span>nextY<span class="token punctuation">)</span><span class="token punctuation">;</span>
        sizeOfSWTValues <span class="token operator">=</span> sizeOfSWTValues <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        
        <span class="token operator">%</span>找到对应的像素点
        <span class="token keyword">if</span> <span class="token function">edgeMap</span><span class="token punctuation">(</span>nextX<span class="token punctuation">,</span>nextY<span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        end
    end
    
    <span class="token operator">%</span> 计算笔画宽度中值
    strokeWidth <span class="token operator">=</span> <span class="token function">median</span><span class="token punctuation">(</span><span class="token function">swtValues</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>sizeOfSWTValues<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token operator">%</span> 取最小值
    <span class="token keyword">for</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>sizeOfRay
        <span class="token function">swtMap</span><span class="token punctuation">(</span><span class="token function">pointOfRayX</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">pointOfRayY</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">swtMap</span><span class="token punctuation">(</span><span class="token function">pointOfRayX</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">pointOfRayY</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>strokeWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
    
end

se<span class="token operator">=</span><span class="token function">strel</span><span class="token punctuation">(</span><span class="token char">'square'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
swtmap<span class="token operator">=</span><span class="token function">imopen</span><span class="token punctuation">(</span>swtMap<span class="token punctuation">,</span>se<span class="token punctuation">)</span><span class="token punctuation">;</span>
swtmap2<span class="token operator">=</span><span class="token function">imclose</span><span class="token punctuation">(</span>swtmap<span class="token punctuation">,</span>se<span class="token punctuation">)</span><span class="token punctuation">;</span>
figure<span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span>swtmap2<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

swtmap2<span class="token operator">=</span>swtmap2<span class="token operator">/</span><span class="token number">1000</span><span class="token punctuation">;</span>

</code></pre> 
<h2><a id="5__206"></a>5 最后</h2>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fc7c71a1fa0c5b92b07865cb4d5bcfce/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Ubuntu/Linux用户管理与权限管理（超详细解析）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cc69db0811e81a7ad621274f1de80112/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于vue3&#43;ts&#43;scss的后台管理系统(一)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>