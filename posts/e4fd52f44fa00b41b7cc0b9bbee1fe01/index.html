<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Unity 之 发布WebGL转微信小游戏过程详解 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Unity 之 发布WebGL转微信小游戏过程详解" />
<meta property="og:description" content="Unity 之 发布WebGL转微信小游戏 前言一，准备工作1.1 下载插件1.2 下载Unity1.3 安装微信开发者工具1.4 创建小程序 二，开始转换2.1 创建项目2.2 Mac适配2.3 Mac适配的一个问题2.4 打包报错 需要-x执行权限2.5 资源文件过大2.6 常见问题 三，发布游戏3.1 发布设置3.2 首次使用3.3 完美运行 前言 用 Unity WebGL 小游戏适配(转换)方案，本方案设计目的是降低 Unity 游戏转换到微信小游戏的开发成本。基于WebAssembly技术，无需更换Unity引擎与重写核心代码的情况下将原有游戏项目适配到微信小游戏。
效果展示
一，准备工作 1.1 下载插件 进入官方GitHub地址，找到安装与使用 – Unity插件， 也可直接点击下载，下载完成后是.unitypackage的包：
1.2 下载Unity 我这里用的是Unity2021.3.3f1c1版本：
下载时需要添加：WebGL Build Support 模块:
官方提示：转微信小游戏插件已验证Unity版本：2018、2019、2020、2021（请尽量使用LTS, 推荐使用2019、2021）。使用Big Sur版本Mac系统的童鞋，在使用2019.4.14之前的版本，会遇到些问题，则需另外安装 python3，并安装brotli 命令如下: python3 -m pip install brotli。
若你没有安装过，则等着进度条走完即可：
若已安装，则会显示python3的版本号：
1.3 安装微信开发者工具 点击进入，微信小游戏开发工具页，根据系统选择下载工具，然后安装到本地。
打开后大致长这个样子：
1.4 创建小程序 点击进入，小游戏注册页，每个邮箱仅能申请一个小程序，按照要求填写信息：
注册完成后，点击登录。然后完成小程序信息和小程序类目的信息补充。
小程序信息：按照你的需求填写即可
小程序类目：类目设置为&#34;游戏&#34;，若不设置则后续使用此Appid打开时，否则开发工具会自动将你的项目转化成小程序。
最后，在后台界面往下滑，左侧找到”开发工具“ --&gt; 获取AppID
目前的设置，已经满足测试需求了。
二，开始转换 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e4fd52f44fa00b41b7cc0b9bbee1fe01/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-24T11:34:53+08:00" />
<meta property="article:modified_time" content="2023-11-24T11:34:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Unity 之 发布WebGL转微信小游戏过程详解</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Unity 之 发布WebGL转微信小游戏</h4> 
 <ul><li><a href="#_3" rel="nofollow">前言</a></li><li><a href="#_11" rel="nofollow">一，准备工作</a></li><li><ul><li><a href="#11__13" rel="nofollow">1.1 下载插件</a></li><li><a href="#12_Unity_21" rel="nofollow">1.2 下载Unity</a></li><li><a href="#13__39" rel="nofollow">1.3 安装微信开发者工具</a></li><li><a href="#14__50" rel="nofollow">1.4 创建小程序</a></li></ul> 
  </li><li><a href="#_77" rel="nofollow">二，开始转换</a></li><li><ul><li><a href="#21__80" rel="nofollow">2.1 创建项目</a></li><li><a href="#22_Mac_91" rel="nofollow">2.2 Mac适配</a></li><li><a href="#23_Mac_124" rel="nofollow">2.3 Mac适配的一个问题</a></li><li><a href="#24__x_140" rel="nofollow">2.4 打包报错 需要-x执行权限</a></li><li><a href="#25__162" rel="nofollow">2.5 资源文件过大</a></li><li><a href="#26__173" rel="nofollow">2.6 常见问题</a></li></ul> 
  </li><li><a href="#_197" rel="nofollow">三，发布游戏</a></li><li><ul><li><a href="#31__200" rel="nofollow">3.1 发布设置</a></li><li><a href="#32__215" rel="nofollow">3.2 首次使用</a></li><li><a href="#33__245" rel="nofollow">3.3 完美运行</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_3"></a>前言</h2> 
<blockquote> 
 <p>用 Unity WebGL 小游戏适配(转换)方案，本方案设计目的是降低 Unity 游戏转换到微信小游戏的开发成本。基于WebAssembly技术，无需更换Unity引擎与重写核心代码的情况下将原有游戏项目适配到微信小游戏。</p> 
</blockquote> 
<p>效果展示</p> 
<p><img src="https://images2.imgbox.com/3b/e5/KzDRGJI1_o.gif" alt=""></p> 
<h2><a id="_11"></a>一，准备工作</h2> 
<h3><a id="11__13"></a>1.1 下载插件</h3> 
<p>进入官方GitHub地址，找到安装与使用 – <a href="https://github.com/wechat-miniprogram/minigame-unity-webgl-transform">Unity插件</a>， 也可直接<a href="https://game.weixin.qq.com/cgi-bin/gamewxagwasmsplitwap/getunityplugininfo?download=1" rel="nofollow">点击下载</a>，下载完成后是<code>.unitypackage</code>的包：</p> 
<p><img src="https://images2.imgbox.com/0e/c6/ug4Eybuq_o.png" alt=""></p> 
<hr> 
<h3><a id="12_Unity_21"></a>1.2 下载Unity</h3> 
<p>我这里用的是<strong>Unity2021.3.3f1c1</strong>版本：</p> 
<p>下载时需要添加：<code>WebGL Build Support</code> 模块:<br> <img src="https://images2.imgbox.com/fa/9a/4BzZvPLb_o.png" alt=""></p> 
<blockquote> 
 <p>官方提示：转微信小游戏插件已验证Unity版本：2018、2019、2020、2021（请尽量使用LTS, 推荐使用2019、2021）。使用Big Sur版本Mac系统的童鞋，在使用2019.4.14之前的版本，会遇到些问题，则需另外安装 python3，并安装brotli 命令如下: <code>python3 -m pip install brotli</code>。</p> 
</blockquote> 
<p>若你没有安装过，则等着进度条走完即可：<br> <img src="https://images2.imgbox.com/fa/07/3te89Zcp_o.png" alt=""></p> 
<p>若已安装，则会显示python3的版本号：<br> <img src="https://images2.imgbox.com/b7/b3/dXNukRki_o.png" alt=""></p> 
<hr> 
<h3><a id="13__39"></a>1.3 安装微信开发者工具</h3> 
<p>点击进入，<a href="https://developers.weixin.qq.com/minigame/dev/devtools/download.html" rel="nofollow">微信小游戏开发</a>工具页，根据系统选择下载工具，然后安装到本地。</p> 
<p><img src="https://images2.imgbox.com/6b/17/VcQ9oBTU_o.png" alt=""></p> 
<p>打开后大致长这个样子：<br> <img src="https://images2.imgbox.com/47/4d/FEhJcq6c_o.png" alt=""></p> 
<hr> 
<h3><a id="14__50"></a>1.4 创建小程序</h3> 
<p>点击进入，<a href="https://mp.weixin.qq.com/wxopen/waregister?action=step1" rel="nofollow">小游戏注册页</a>，每个邮箱仅能申请一个小程序，按照要求填写信息：</p> 
<p><img src="https://images2.imgbox.com/8b/c0/gcYLzTmv_o.png" alt=""></p> 
<p>注册完成后，点击登录。然后完成<strong>小程序信息</strong>和<strong>小程序类目</strong>的信息补充。</p> 
<p><img src="https://images2.imgbox.com/57/ed/Cf8itGgG_o.png" alt=""></p> 
<p>小程序信息：按照你的需求填写即可</p> 
<p><img src="https://images2.imgbox.com/29/f1/edMddNQ3_o.png" alt=""></p> 
<p>小程序类目：类目设置为"游戏"，若不设置则后续使用此Appid打开时，否则开发工具会自动将你的项目转化成小程序。</p> 
<p><img src="https://images2.imgbox.com/c8/7b/0KHyJNIH_o.png" alt=""></p> 
<p>最后，在后台界面往下滑，左侧找到”开发工具“ --&gt; 获取AppID<br> <img src="https://images2.imgbox.com/4b/6f/4nrBv3CM_o.png" alt=""></p> 
<p>目前的设置，已经满足测试需求了。</p> 
<hr> 
<h2><a id="_77"></a>二，开始转换</h2> 
<h3><a id="21__80"></a>2.1 创建项目</h3> 
<p>使用刚刚下载的新版本Unity创建一个Webgl平台的项目：</p> 
<p><img src="https://images2.imgbox.com/d5/fd/1QzimpeZ_o.png" alt=""></p> 
<p>打开后，将1.1下的插件导入到工程中，导入后工程目录如下：</p> 
<p><img src="https://images2.imgbox.com/06/69/jQ0lfME0_o.png" alt=""></p> 
<h3><a id="22_Mac_91"></a>2.2 Mac适配</h3> 
<p><strong>若使用的不是Mac可直接跳到2.3。</strong></p> 
<p><code>2019.4.13f1</code> 版本:<br> <img src="https://images2.imgbox.com/82/a2/b41lLSXN_o.png" alt=""></p> 
<p>使用Big Sur版本Mac系统的童鞋，在使用2019.4.14之前的版本，会遇到些问题，则需另外安装 python3，在上面1.2已经说了，没安装的话，再去看一下。</p> 
<p>Mac版本打包之前，找到<strong>微信小游戏</strong>菜单，点<code>MacOS脚本授权</code>：</p> 
<p><img src="https://images2.imgbox.com/ca/01/GogTkjti_o.png" alt=""></p> 
<ol><li> <p>提示：无法打开“PVRTextoolCLI”，因为无法验证开发者。点击取消：</p> <p><img src="https://images2.imgbox.com/62/d6/xCkD9Abl_o.png" alt=""></p> <p>会在设置 “安全与隐私” -&gt; “通用” 点击 <strong>仍然允许</strong> 。 后的2，3同样处理<br> <img src="https://images2.imgbox.com/59/3c/JcWpulo0_o.png" alt=""></p> </li><li> <p>提示：无法打开“pngquant”，因为Apple无法检查其是否包含恶意软件。<br> <img src="https://images2.imgbox.com/3a/78/qrVN8uje_o.png" alt=""></p> </li><li> <p>提示：无法打开“brolib_x64.dylib”，因为无法验证开发者。<br> <img src="https://images2.imgbox.com/8b/e8/C8epVlWq_o.png" alt=""></p> </li></ol> 
<p>MacOS脚本授权 成功后会打印一个日志：<br> <img src="https://images2.imgbox.com/97/a5/HHDdwraX_o.png" alt=""></p> 
<hr> 
<h3><a id="23_Mac_124"></a>2.3 Mac适配的一个问题</h3> 
<p><font color="red" size="3"><strong>【新版SDK官方做了适配，已经没有这个问题了】</strong> </font></p> 
<p>我使用2019.4.8f1也遇到了同样的问题，但是使用2021.3.3f1版本就可以弹出下面这个提示，然后“安全与隐私” -&gt; "通用"中允许授权就没问题了。</p> 
<p><img src="https://images2.imgbox.com/95/fc/0zsAyN8L_o.png" alt=""></p> 
<p>2019.4.8f1 不知道为什么弹不出来，就一直授权不成功（多操作几次）：<br> <img src="https://images2.imgbox.com/81/f5/ripOanJQ_o.png" alt=""></p> 
<p>MaxOS脚本授权一直失败 – 我目前也没有解决，只能升级了工程使用的Unity版本，可以点<a href="https://github.com/wechat-miniprogram/minigame-unity-webgl-transform/issues/70">官方issues</a> 看一下，没准你看到的时候，这个问题已经解决了。</p> 
<hr> 
<h3><a id="24__x_140"></a>2.4 打包报错 需要-x执行权限</h3> 
<p>发布微信小游戏，权限问题：<br> <img src="https://images2.imgbox.com/d2/1d/31W7RLCg_o.png" alt="在这里插入图片描述"></p> 
<p>命令行解决：</p> 
<ol><li>查看权限：</li></ol> 
<pre><code class="prism language-c">ls <span class="token operator">-</span>l 执行文件目录
</code></pre> 
<ol start="2"><li>添加权限</li></ol> 
<pre><code class="prism language-c">chmod <span class="token operator">+</span>x 文件目录
</code></pre> 
<ol start="3"><li>验证是否添加成功</li></ol> 
<pre><code class="prism language-c">ls <span class="token operator">-</span>l 执行文件目录
</code></pre> 
<p><img src="https://images2.imgbox.com/02/70/T7cnclPK_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h3><a id="25__162"></a>2.5 资源文件过大</h3> 
<p>使用包内加载时，资源过大打包完成后会提示：<br> <img src="https://images2.imgbox.com/43/86/adEFNRKJ_o.png" alt="在这里插入图片描述"><br> 使用微信开发工具打开导出的文件会报错：<br> <img src="https://images2.imgbox.com/ba/58/O8stwT4Y_o.png" alt="在这里插入图片描述"></p> 
<p>解决方法：将首包资源加载方式修改为：CDN，然后将资源上传到CDN地址即可。<br> <img src="https://images2.imgbox.com/81/55/sYsMJfyl_o.png" alt="在这里插入图片描述"><br> 将打包出来的webgl文件夹下所有资源都上传到上面指定的CDN目录下：<br> <img src="https://images2.imgbox.com/17/e4/3YI58Hlo_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="26__173"></a>2.6 常见问题</h3> 
<p>官方技术常见问题QA，<a href="https://github.com/wechat-miniprogram/minigame-unity-webgl-transform/blob/main/Design/DevelopmentQAList.md">点击查看更多</a></p> 
<p><img src="https://images2.imgbox.com/73/08/LhIEQObk_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ce/42/DEKqJfJU_o.png" alt="在这里插入图片描述"><br> 设置帧率</p> 
<pre><code class="prism language-csharp"><span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_WEBGL &amp;&amp; </span><span class="token return-type class-name">WX</span>
		WeChatWASM<span class="token punctuation">.</span>WX<span class="token punctuation">.</span><span class="token function">SetPreferredFramesPerSecond</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
		Application<span class="token punctuation">.</span>targetFrameRate <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>
</code></pre> 
<p>设置小程序常亮 – 仅当前小程序生效</p> 
<pre><code class="prism language-csharp">WeChatWASM<span class="token punctuation">.</span>WX<span class="token punctuation">.</span><span class="token function">SetKeepScreenOn</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">SetKeepScreenOnOption</span>
        <span class="token punctuation">{<!-- --></span>
            keepScreenOn <span class="token operator">=</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<hr> 
<h2><a id="_197"></a>三，发布游戏</h2> 
<h3><a id="31__200"></a>3.1 发布设置</h3> 
<p>点击”转换小游戏“：<br> <img src="https://images2.imgbox.com/cc/45/iYJEoVVZ_o.png" alt=""></p> 
<p>会弹出一个设置面板：</p> 
<p>填写AppId（在1.4申请的那个），CDN和项目名先随便写一个，选择一个导出路径，将首包资源加载方式转换为<strong>小游戏分包</strong>，最后点击<strong>导出WEBGL并转换为小游戏(常用)</strong>:<br> <img src="https://images2.imgbox.com/d1/1a/W1d9gJmH_o.png" alt=""></p> 
<p>等待导出完成，导出后的目录：</p> 
<p><img src="https://images2.imgbox.com/b2/a3/l3mJldRV_o.png" alt=""></p> 
<h3><a id="32__215"></a>3.2 首次使用</h3> 
<p>打开微信开发者工具，选择小游戏 --&gt; 导入 --&gt; 选择导出的<code>minigame</code>路径：</p> 
<p><img src="https://images2.imgbox.com/c7/9a/G5Xp5A4d_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/f4/3c/RuwobaLx_o.png" alt=""></p> 
<p>打开后，输入上面的<code>AppID</code>，后端服务选择<code>不使用云服务</code></p> 
<p><img src="https://images2.imgbox.com/86/49/oEompCGx_o.png" alt=""><br> 若不消息打开了微信云开发，在打开后的界面点 “云开发” 按照下面操作进行删除，然后重新进入即可：<br> <img src="https://images2.imgbox.com/59/5b/WYYFcXGT_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/98/df/8CnPjBqO_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/c3/70/r6M72NSQ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/cb/54/sYIZQqTM_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p>首次打开，会提示插件未授权使用，双击添加（下次使用就不用添加了）</p> 
<p><img src="https://images2.imgbox.com/ac/35/WEQNoIld_o.png" alt=""></p> 
<p>点击添加即可，添加后需要手动关闭，<br> <img src="https://images2.imgbox.com/c3/d3/VPjxnA0y_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/c4/96/vQFXOu4H_o.png" alt=""></p> 
<h3><a id="33__245"></a>3.3 完美运行</h3> 
<p>等待编译完成，即可看到我么熟悉的Unity的加载动画，然后进入到场景</p> 
<p><img src="https://images2.imgbox.com/6a/f2/uBVLgx8D_o.gif" alt=""></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6387c54ed3713ddbbfba027d4d36190b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">HarmonyOS从基础到实战-高性能华为在线答题元服务</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f2441805e1833335beab4e5010a7bed3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">js 获取时间戳</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>