<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>阅读笔记-GRAPHAF:A FLOW-BASED AUTOREGRESSIVE MODEL FOR MOLECULAR GRAPH GENERATION - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="阅读笔记-GRAPHAF:A FLOW-BASED AUTOREGRESSIVE MODEL FOR MOLECULAR GRAPH GENERATION" />
<meta property="og:description" content="GRAPHAF:A FLOW-BASED AUTOREGRESSIVE MODEL FOR MOLECULAR GRAPH GENERATION 一、概要二、预备知识2.1 Autoregressive flow2.2 Graph Representation Learning 三、方法介绍3.1 GraphAF架构3.2 Efficient Parallel Training3.3 Validity Constrained Sampling3.4 Goal-Directed Molecule Generation with Reinforcement Learning 四、实验4.1 实验设置4.2 Numerical Results 文章链接
一、概要 设计具有所需特性的新型分子结构是诸如药物发现和材料科学等各种应用中的基本问题。.由于化学空间本质上是离散的，整个搜索空间是巨大的，大概有 1 0 33 10^{33} 1033这么大，所以这个问题是非常具有挑战性的。由于这些领域中的大量数据，机器学习技术在分子设计中看到了巨大的机遇。近年来，人们越来越致力于开发能够自动生成化学有效分子结构并优化其性质的机器学习算法。
对于自回归模型作者也有论述：自回归模型的迭代性质允许在生成过程中有效利用化学规则进行化合价检查，因此这些模型生成的有效分子的比例非常高。 但是，由于顺序生成的性质，训练过程通常很慢。 GraphAF方法具有像自动回归模型（从潜在空间到观察空间的映射）这样的迭代生成过程的优势，同时可以计算与前馈神经网络（从观察空间到潜在空间的映射）相对应的精确似然性。 通过并行计算有效地进行。
二、预备知识 2.1 Autoregressive flow \;\;\;\;\;\; N o r m a l i z i n g f l o w \mathbf{Normalizing \;\;flow} Normalizingflow为从基本分布 E \mathcal E E（可以是高斯分布）映射到真实世界可以观测到的空间 Z \mathcal Z Z（比如图片或者语音）的一个参数化的可逆的确定性变换。即： ϵ ∼ p E ( ϵ ) \epsilon\sim p_{\mathcal E}(\epsilon) ϵ∼pE​(ϵ)是基础分布，而 f : E → Z f:\mathcal E\to\mathcal Z f:E→Z是一个可逆变换。则真实世界中的分布 p Z ( z ) p_{\mathbf Z}(z) pZ​(z)可由如下公式计算：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/3697aa211a44563b7321ebbea39324dc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-09-28T00:03:43+08:00" />
<meta property="article:modified_time" content="2020-09-28T00:03:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">阅读笔记-GRAPHAF:A FLOW-BASED AUTOREGRESSIVE MODEL FOR MOLECULAR GRAPH GENERATION</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>GRAPHAF:A FLOW-BASED AUTOREGRESSIVE MODEL FOR MOLECULAR GRAPH GENERATION</h4> 
 <ul><li><a href="#_4" rel="nofollow">一、概要</a></li><li><a href="#_8" rel="nofollow">二、预备知识</a></li><li><ul><li><a href="#21_Autoregressive_flow_9" rel="nofollow">2.1 Autoregressive flow</a></li><li><a href="#22_Graph_Representation_Learning_22" rel="nofollow">2.2 Graph Representation Learning</a></li></ul> 
  </li><li><a href="#_33" rel="nofollow">三、方法介绍</a></li><li><ul><li><a href="#31_GraphAF_34" rel="nofollow">3.1 GraphAF架构</a></li><li><a href="#32_Efficient_Parallel_Training_58" rel="nofollow">3.2 Efficient Parallel Training</a></li><li><a href="#33_Validity_Constrained_Sampling_62" rel="nofollow">3.3 Validity Constrained Sampling</a></li><li><a href="#34_GoalDirected_Molecule_Generation_with_Reinforcement_Learning_70" rel="nofollow">3.4 Goal-Directed Molecule Generation with Reinforcement Learning</a></li></ul> 
  </li><li><a href="#_75" rel="nofollow">四、实验</a></li><li><ul><li><a href="#41__76" rel="nofollow">4.1 实验设置</a></li><li><a href="#42_Numerical_Results_91" rel="nofollow">4.2 Numerical Results</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p><a href="https://arxiv.org/pdf/2001.09382.pdf" rel="nofollow">文章链接</a></p> 
<h2><a id="_4"></a>一、概要</h2> 
<p>设计具有所需特性的新型分子结构是诸如药物发现和材料科学等各种应用中的基本问题。.由于化学空间本质上是离散的，整个搜索空间是巨大的，大概有<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         1 
        
        
        
          0 
         
        
          33 
         
        
       
      
        10^{33} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></span>这么大，所以这个问题是非常具有挑战性的。由于这些领域中的大量数据，机器学习技术在分子设计中看到了巨大的机遇。近年来，人们越来越致力于开发能够自动生成化学有效分子结构并优化其性质的机器学习算法。<br> 对于自回归模型作者也有论述：自回归模型的迭代性质允许在生成过程中有效利用化学规则进行化合价检查，因此这些模型生成的有效分子的比例非常高。 但是，由于顺序生成的性质，训练过程通常很慢。 GraphAF方法具有像自动回归模型（从潜在空间到观察空间的映射）这样的迭代生成过程的优势，同时可以计算与前馈神经网络（从观察空间到潜在空间的映射）相对应的精确似然性。 通过并行计算有效地进行。</p> 
<h2><a id="_8"></a>二、预备知识</h2> 
<h3><a id="21_Autoregressive_flow_9"></a>2.1 Autoregressive flow</h3> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
      
                     
       
      
        \;\;\;\;\;\; 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span></span></span></span></span><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         N 
        
       
         o 
        
       
         r 
        
       
         m 
        
       
         a 
        
       
         l 
        
       
         i 
        
       
         z 
        
       
         i 
        
       
         n 
        
       
         g 
            
       
         f 
        
       
         l 
        
       
         o 
        
       
         w 
        
       
      
        \mathbf{Normalizing \;\;flow} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathbf">N</span><span class="mord mathbf">o</span><span class="mord mathbf">r</span><span class="mord mathbf">m</span><span class="mord mathbf">a</span><span class="mord mathbf">l</span><span class="mord mathbf">i</span><span class="mord mathbf">z</span><span class="mord mathbf">i</span><span class="mord mathbf">n</span><span class="mord mathbf" style="margin-right: 0.01597em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf" style="margin-right: 0.10903em;">f</span><span class="mord mathbf">l</span><span class="mord mathbf">o</span><span class="mord mathbf" style="margin-right: 0.01597em;">w</span></span></span></span></span></span>为从基本分布<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         E 
        
       
      
        \mathcal E 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.08944em;">E</span></span></span></span></span>（可以是高斯分布）映射到真实世界可以观测到的空间<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Z 
        
       
      
        \mathcal Z 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.07944em;">Z</span></span></span></span></span>（比如图片或者语音）的一个参数化的可逆的确定性变换。即：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ϵ 
        
       
         ∼ 
        
        
        
          p 
         
        
          E 
         
        
       
         ( 
        
       
         ϵ 
        
       
         ) 
        
       
      
        \epsilon\sim p_{\mathcal E}(\epsilon) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">ϵ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right: 0.08944em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">ϵ</span><span class="mclose">)</span></span></span></span></span>是基础分布，而<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         f 
        
       
         : 
        
       
         E 
        
       
         → 
        
       
         Z 
        
       
      
        f:\mathcal E\to\mathcal Z 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.08944em;">E</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.07944em;">Z</span></span></span></span></span>是一个可逆变换。则真实世界中的分布<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          p 
         
        
          Z 
         
        
       
         ( 
        
       
         z 
        
       
         ) 
        
       
      
        p_{\mathbf Z}(z) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.330277em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">Z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mclose">)</span></span></span></span></span>可由如下公式计算：<br> <img src="https://images2.imgbox.com/df/97/xIquCuYY_o.png" alt="在这里插入图片描述"><br> 规范化流（<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         N 
        
       
         o 
        
       
         r 
        
       
         m 
        
       
         a 
        
       
         l 
        
       
         i 
        
       
         z 
        
       
         i 
        
       
         n 
        
       
         g 
            
       
         f 
        
       
         l 
        
       
         o 
        
       
         w 
        
       
      
        \mathbf{Normalizing \;\;flow} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathbf">N</span><span class="mord mathbf">o</span><span class="mord mathbf">r</span><span class="mord mathbf">m</span><span class="mord mathbf">a</span><span class="mord mathbf">l</span><span class="mord mathbf">i</span><span class="mord mathbf">z</span><span class="mord mathbf">i</span><span class="mord mathbf">n</span><span class="mord mathbf" style="margin-right: 0.01597em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf" style="margin-right: 0.10903em;">f</span><span class="mord mathbf">l</span><span class="mord mathbf">o</span><span class="mord mathbf" style="margin-right: 0.01597em;">w</span></span></span></span></span></span>）作为生成模型的两个关键过程：</p> 
<ol><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           p 
          
         
           Z 
          
         
        
          ( 
         
        
          z 
         
        
          ) 
         
        
       
         p_{Z}(z) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">Z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mclose">)</span></span></span></span></span>可以通过<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          f 
         
        
       
         f 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span></span></span></span></span>的逆变换来计算：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ϵ 
         
        
          = 
         
         
         
           f 
          
         
           θ 
          
          
          
            − 
           
          
            1 
           
          
         
        
          ( 
         
        
          z 
         
        
          ) 
         
        
       
         \epsilon =f_{\theta}^{-1}(\mathcal z) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">ϵ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.15555em; vertical-align: -0.301308em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.854239em;"><span class="" style="top: -2.39869em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">θ</span></span></span></span><span class="" style="top: -3.10313em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mclose">)</span></span></span></span></span>；</li><li>为了获得<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          z 
         
        
       
         z 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span></span></span></span></span>，计算方式如下：首先，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           f 
          
         
           θ 
          
         
        
       
         f_{\theta} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是一个可逆变换并且对应的雅可比行列式应该较为容易计算；接下来按照<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ϵ 
         
        
          ∼ 
         
        
          p 
         
        
          ( 
         
        
          ϵ 
         
        
          ) 
         
        
       
         \epsilon\sim p(\epsilon) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">ϵ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">ϵ</span><span class="mclose">)</span></span></span></span></span>进行采样，并执行前向变换<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          z 
         
        
          = 
         
         
         
           f 
          
         
           θ 
          
         
        
          ( 
         
        
          ϵ 
         
        
          ) 
         
        
       
         z=f_{\theta}(\epsilon) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">ϵ</span><span class="mclose">)</span></span></span></span></span>，从而的到<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          z 
         
        
       
         z 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span></span></span></span></span>。</li></ol> 
<p>自回归流（AF）是满足这些条件的一种变体，其中包含三角Jacobian矩阵，并且行列式可以线性计算。给定<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         z 
        
       
         ∈ 
        
        
        
          R 
         
        
          D 
         
        
       
      
        z\in\mathbb R^{D} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">D</span></span></span></span></span></span></span></span></span></span></span></span></span>（<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         D 
        
       
      
        D 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span></span></span></span></span>是观测数据的维度），自回归条件概率可以参数化为高斯分布。<br> <img src="https://images2.imgbox.com/a9/4b/NVw5r6iS_o.png" alt="在这里插入图片描述"><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          g 
         
        
          μ 
         
        
       
      
        g_{\mu} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">μ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          g 
         
        
          α 
         
        
       
      
        g_{\alpha} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          z 
         
         
         
           1 
          
         
           : 
          
         
           d 
          
         
           − 
          
         
           1 
          
         
        
       
      
        z_{1:d-1} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.638891em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathdefault mtight">d</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的正标量函数，用来得到均值和偏差。在实际中，这些函数可以用神经网络来实现。由此可得：<br> <img src="https://images2.imgbox.com/79/bd/RrNqO7pU_o.png" alt="在这里插入图片描述"><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
      
                     
       
      
        \;\;\;\;\;\; 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span></span></span></span></span><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         A 
        
       
         F 
        
       
      
        \mathbf{AF} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68611em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbf">A</span><span class="mord mathbf">F</span></span></span></span></span></span>的雅克比矩阵是下三角的，因为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
         
           ∂ 
          
          
          
            z 
           
          
            i 
           
          
         
         
         
           ∂ 
          
          
          
            ϵ 
           
          
            j 
           
          
         
        
       
      
        \frac{\partial z_{i}}{\partial {\epsilon}_{j}} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.43853em; vertical-align: -0.54232em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.896208em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.281886em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.4101em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: -0.04398em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.54232em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>仅仅对于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         j 
        
       
         &lt; 
        
       
         i 
        
       
      
        j&lt;i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>是非零的。具体来说，要执行密度估算，我们可以并行应用所有单独的标量仿射变换来计算基本密度，每个密度都取决于先前的变量<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          z 
         
         
         
           1 
          
         
           : 
          
         
           d 
          
         
           − 
          
         
           1 
          
         
        
       
      
        z_{1:d-1} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.638891em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathdefault mtight">d</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span>,在刚开始我们可以先采样<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ϵ 
        
       
         ∈ 
        
        
        
          R 
         
        
          D 
         
        
       
      
        \epsilon\in\mathbb R_{D} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathdefault">ϵ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83889em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>并通过仿射参数计算<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          z 
         
        
          1 
         
        
       
      
        z_{1} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>接下来再根据之前得到的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          z 
         
         
         
           1 
          
         
           : 
          
         
           d 
          
         
           − 
          
         
           1 
          
         
        
       
      
        z_{1:d-1} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.638891em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathdefault mtight">d</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span>来计算<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          z 
         
        
          d 
         
        
       
      
        z_{d} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。</p> 
<h3><a id="22_Graph_Representation_Learning_22"></a>2.2 Graph Representation Learning</h3> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
      
                     
       
      
        \;\;\;\;\;\; 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span></span></span></span></span>作者将分子图表示为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         G 
        
       
         = 
        
       
         ( 
        
       
         A 
        
       
         , 
        
       
         X 
        
       
         ) 
        
       
         , 
        
       
         A 
        
       
      
        \mathcal G=(\mathbf A,\mathbf X),\mathbf A 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.78055em; vertical-align: -0.09722em;"></span><span class="mord mathcal" style="margin-right: 0.0593em;">G</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathbf">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathbf">X</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathbf">A</span></span></span></span></span>是伴随矩阵，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
      
        \mathbf X 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68611em; vertical-align: 0em;"></span><span class="mord mathbf">X</span></span></span></span></span>是节点特征矩阵。假设图中有<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         n 
        
       
      
        n 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">n</span></span></span></span></span>个节点，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         d 
        
       
         , 
        
       
         b 
        
       
      
        d,b 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">b</span></span></span></span></span>分别代表着节点的种类的数量与边种类的数量。则有：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         A 
        
       
         ∈ 
        
        
         
         
           { 
          
         
           0 
          
         
           , 
          
         
           1 
          
         
           } 
          
         
         
         
           n 
          
         
           × 
          
         
           n 
          
         
           × 
          
         
           d 
          
         
        
       
         , 
              
       
         X 
        
       
         ∈ 
        
        
         
         
           { 
          
         
           0 
          
         
           , 
          
         
           1 
          
         
           } 
          
         
         
         
           n 
          
         
           × 
          
         
           d 
          
         
          
       
      
        A\in\left\{0,1\right\}^{n\times n\times d},\;\;\;\mathbf X\in\left\{0,1\right\}^{n\times d}\; 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.23901em; vertical-align: -0.25em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{<!-- --></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose delimcenter" style="top: 0em;">}</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.989008em;"><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf">X</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.23901em; vertical-align: -0.25em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{<!-- --></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose delimcenter" style="top: 0em;">}</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.989008em;"><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span></span></span></span></span>，并且当第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
      
        i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>个节点和第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         j 
        
       
      
        j 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span></span></span></span></span>个节点之间以第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
      
        k 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span>种类型的边相连，则有<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          A 
         
         
         
           i 
          
         
           j 
          
         
           k 
          
         
        
       
         = 
        
       
         1 
        
       
      
        \mathbf A_{ijk}=1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.972218em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>。作者采用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         − 
        
       
         G 
        
       
         C 
        
       
         N 
        
       
      
        \mathbf{R-GCN} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.76944em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathbf">R</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathbf">G</span><span class="mord mathbf">C</span><span class="mord mathbf">N</span></span></span></span></span></span>来学习节点的表征向量。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
      
        k 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span>代表着节点嵌入向量的维度，我们定义第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         l 
        
       
      
        l 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span></span></span></span></span>层<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         − 
        
       
         G 
        
       
         C 
        
       
         N 
        
       
      
        R-GCN 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span></span></span></span></span>的节点的嵌入矩阵为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          H 
         
        
          l 
         
        
       
         ∈ 
        
        
        
          R 
         
         
         
           n 
          
         
           × 
          
         
           k 
          
         
        
       
      
        H^{l}\in\mathbb R^{n\times k} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.888208em; vertical-align: -0.0391em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></span>：<br> <img src="https://images2.imgbox.com/ee/f1/KsGJKsH7_o.png" alt="在这里插入图片描述"><br> <strong>符号含义：</strong></p> 
<ul><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           E 
          
         
           i 
          
         
        
          = 
         
         
         
           A 
          
          
          
            [ 
           
          
            : 
           
          
            , 
           
          
            : 
           
          
            , 
           
          
            i 
           
          
            ] 
           
          
         
        
       
         \mathbf E_{i}=\mathbf A_{[:,:,i]} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83611em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbf">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.04131em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mrel mtight">:</span><span class="mpunct mtight">,</span><span class="mrel mtight">:</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span></span></span></span></span>；</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
            E 
           
          
            ~ 
           
          
         
           i 
          
         
        
          = 
         
         
         
           E 
          
         
           i 
          
         
        
          + 
         
        
          I 
         
        
       
         \mathbf{\tilde E_{i}}=\mathbf E_{i}+\mathbf I 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.07297em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.92297em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathbf">E</span></span><span class="" style="top: -3.60511em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83611em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbf">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.68611em; vertical-align: 0em;"></span><span class="mord mathbf">I</span></span></span></span></span>；</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
            D 
           
          
            ~ 
           
          
         
           i 
          
         
        
          = 
         
         
         
           Σ 
          
         
           k 
          
         
         
          
          
            E 
           
          
            ~ 
           
          
         
           i 
          
         
        
          [ 
         
        
          j 
         
        
          , 
         
        
          k 
         
        
          ] 
         
        
       
         \mathbf{\tilde D_{i}}={\Sigma}_{k}\tilde E_{i}[j,k] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.07297em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.92297em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathbf">D</span></span><span class="" style="top: -3.60511em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.17019em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord"><span class="mord">Σ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.92019em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">E</span></span><span class="" style="top: -3.60233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.05764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mclose">]</span></span></span></span></span>；</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           W 
          
         
           i 
          
          
          
            ( 
           
          
            l 
           
          
            ) 
           
          
         
        
       
         \mathbf W_{i}^{(l)} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.32166em; vertical-align: -0.276864em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.01597em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.42314em; margin-left: -0.01597em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.276864em;"><span class=""></span></span></span></span></span></span></span></span></span></span>：是第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          l 
         
        
       
         l 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span></span></span></span></span>层<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          R 
         
        
          − 
         
        
          G 
         
        
          C 
         
        
          N 
         
        
       
         \mathbf{R-GCN} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.76944em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathbf">R</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathbf">G</span><span class="mord mathbf">C</span><span class="mord mathbf">N</span></span></span></span></span></span>对于第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          i 
         
        
       
         i 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>种边类型的可以训练的权重矩阵。</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          A 
         
        
          g 
         
        
          g 
         
        
          ( 
         
        
          ⋅ 
         
        
          ) 
         
        
       
         Agg(\cdot) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span>：表示聚合函数，例如求平均值或者相加求和。</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           H 
          
         
           0 
          
         
        
       
         \mathbf H^{0} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbf">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span></span>由节点特征矩阵<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          X 
         
        
       
         \mathbf X 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68611em; vertical-align: 0em;"></span><span class="mord mathbf">X</span></span></span></span></span>初始化，经过<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          L 
         
        
       
         \mathbf L 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68611em; vertical-align: 0em;"></span><span class="mord mathbf">L</span></span></span></span></span>层消息传递网络，得到表示矩阵<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           H 
          
         
           L 
          
         
        
       
         \mathbf H^{L} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbf">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span></span></span></span></span></span></span></span></span></span></span></span></span>来作为最终的节点表征向量。同时，整个图的表征向量可以通过聚合最终的每个节点的表征向量来得到。</li></ul> 
<h2><a id="_33"></a>三、方法介绍</h2> 
<h3><a id="31_GraphAF_34"></a>3.1 GraphAF架构</h3> 
<p><img src="https://images2.imgbox.com/53/dd/2VaDefcX_o.png" alt="在这里插入图片描述"></p> 
<ul><li>首先，给定一张空图<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           G 
          
         
           1 
          
         
        
       
         \mathbf G_{1} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83611em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbf">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>；</li><li>每一次迭代过程中，都会根据现有的子图结构添加一个新的节点即<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          p 
         
        
          ( 
         
         
         
           X 
          
         
           i 
          
         
        
          ∣ 
         
         
         
           G 
          
         
           i 
          
         
        
          ) 
         
        
       
         p(X_{i}|G_{i}) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>；</li><li>然后，根据当前图结构顺序生成新节点与现有节点之间的边，即<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          p 
         
        
          ( 
         
         
         
           A 
          
          
          
            i 
           
          
            j 
           
          
         
        
          ∣ 
         
         
         
           G 
          
         
           i 
          
         
        
          , 
         
         
         
           X 
          
         
           i 
          
         
        
          , 
         
         
         
           A 
          
          
          
            i 
           
          
            , 
           
          
            1 
           
          
            : 
           
          
            j 
           
          
            − 
           
          
            1 
           
          
         
        
          ) 
         
        
       
         p(\mathbf A_{ij}|\mathbf G_{i},\mathbf X_{i},\mathbf A_{i,1:j-1}) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathbf">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>；</li><li>重复上述过程，直到所有的节点和边都生成完毕，如图1（a）所示。<br> GraphAF旨定义一个从基本分布（比如多元高斯分布）到分子图结构<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          G 
         
        
          = 
         
        
          ( 
         
        
          A 
         
        
          , 
         
        
          X 
         
        
          ) 
         
        
       
         \mathbf G=(\mathbf A,\mathbf X) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68611em; vertical-align: 0em;"></span><span class="mord mathbf">G</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathbf">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathbf">X</span><span class="mclose">)</span></span></span></span></span>的可逆变换。注意，对于两个节点之间的边的类型，我们还要再加一项:“<strong>no edge</strong>”,即两个节点之间没有相连（连个原子之间没有形成化学键），则有：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          A 
         
        
          ∈ 
         
         
          
          
            { 
           
          
            0 
           
          
            , 
           
          
            1 
           
          
            } 
           
          
          
          
            n 
           
          
            × 
           
          
            n 
           
          
            × 
           
          
            ( 
           
          
            b 
           
          
            + 
           
          
            1 
           
          
            ) 
           
          
         
        
       
         \mathbf A\in\left\{0,1\right\}^{n\times n\times(b+1)} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72521em; vertical-align: -0.0391em;"></span><span class="mord mathbf">A</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.2779em; vertical-align: -0.25em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{<!-- --></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose delimcenter" style="top: 0em;">}</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.0279em;"><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">b</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span>。由于节点类型<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           X 
          
         
           i 
          
         
        
       
         \mathbf X_{i} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83611em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>与边类型<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           A 
          
          
          
            i 
           
          
            j 
           
          
         
        
       
         \mathbf A_{ij} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.972218em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是离散的，这并不适合flow-based的模型。一种标准的解决方法是利用<strong>Dequantization</strong>技术，就是在离散数据上添加真是的噪声，对于图<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          G 
         
        
          = 
         
        
          ( 
         
        
          A 
         
        
          , 
         
        
          X 
         
        
          ) 
         
        
       
         G=(A,X) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span></span></span></span></span>经过处理得到连续的表示<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          z 
         
        
          = 
         
        
          ( 
         
         
         
           z 
          
         
           A 
          
         
        
          , 
         
         
         
           z 
          
         
           X 
          
         
        
          ) 
         
        
       
         z=(z^{A},z^{X}) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09133em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07847em;">X</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>有：<br> <img src="https://images2.imgbox.com/b3/2e/AjIw9H9G_o.png" alt="在这里插入图片描述"><br> 对于图生成的条件分布为：<br> <img src="https://images2.imgbox.com/ee/17/EGPW6IB1_o.png" alt="在这里插入图片描述"><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           g 
          
          
           
            
           
             μ 
            
           ⁣ 
          
            X 
           
          
         
        
       
         \mathbf g_{<!-- -->{}_{\mu}\!X} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.79176em; vertical-align: -0.34732em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.01597em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.01597em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">μ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.281886em;"><span class=""></span></span></span></span></span></span><span class="mspace mtight" style="margin-right: -0.195167em;"></span><span class="mord mathdefault mtight" style="margin-right: 0.07847em;">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.34732em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           g 
          
          
           
            
           
             μ 
            
           ⁣ 
          
            A 
           
          
         
        
       
         \mathbf g_{<!-- -->{}_{\mu}\!A} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.79176em; vertical-align: -0.34732em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.01597em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.01597em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">μ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.281886em;"><span class=""></span></span></span></span></span></span><span class="mspace mtight" style="margin-right: -0.195167em;"></span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.34732em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           g 
          
          
           
            
           
             α 
            
           ⁣ 
          
            X 
           
          
         
        
       
         \mathbf g_{<!-- -->{}_{\alpha}\!X} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69454em; vertical-align: -0.2501em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.01597em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.01597em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mspace mtight" style="margin-right: -0.195167em;"></span><span class="mord mathdefault mtight" style="margin-right: 0.07847em;">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           g 
          
          
           
            
           
             α 
            
           ⁣ 
          
            A 
           
          
         
        
       
         \mathbf g_{<!-- -->{}_{\alpha}\!A} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69454em; vertical-align: -0.2501em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.01597em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.01597em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mspace mtight" style="margin-right: -0.195167em;"></span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是用来生成高斯分布均值以及偏差的被参数化的神经网络。给定子图结构<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           G 
          
         
           i 
          
         
        
       
         G_{i} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，我们用一个<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          L 
         
        
       
         L 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">L</span></span></span></span></span>层的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          R 
         
        
          e 
         
        
          l 
         
        
          a 
         
        
          t 
         
        
          i 
         
        
          o 
         
        
          n 
         
        
          a 
         
        
          l 
         
        
          − 
         
        
          G 
         
        
          C 
         
        
          N 
         
        
       
         \mathbf {Relational-GCN} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathbf">R</span><span class="mord mathbf">e</span><span class="mord mathbf">l</span><span class="mord mathbf">a</span><span class="mord mathbf">t</span><span class="mord mathbf">i</span><span class="mord mathbf">o</span><span class="mord mathbf">n</span><span class="mord mathbf">a</span><span class="mord mathbf">l</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathbf">G</span><span class="mord mathbf">C</span><span class="mord mathbf">N</span></span></span></span></span></span>来学习到节点嵌入向量<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           H 
          
         
           i 
          
         
           L 
          
         
        
          ∈ 
         
         
         
           R 
          
          
          
            n 
           
          
            × 
           
          
            k 
           
          
         
        
       
         \mathbf H_{i}^{L}\in\mathbb R^{n\times k} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.09999em; vertical-align: -0.258664em;"></span><span class="mord"><span class="mord mathbf">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.44134em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.258664em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></span>，以及整个子图的表征嵌入<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
            h 
           
          
            ~ 
           
          
         
           i 
          
         
        
          ∈ 
         
         
         
           R 
          
         
           k 
          
         
        
       
         \tilde h_{i}\in\mathbb R^{k} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0813em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9313em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault">h</span></span><span class="" style="top: -3.61344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></span>，并在此基础上定义高斯分布的均值和标准差，分别生成节点和边：<br> <img src="https://images2.imgbox.com/6d/e3/ABHlyzbq_o.png" alt="在这里插入图片描述"><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           m 
          
          
           
            
           
             μ 
            
           ⁣ 
          
            X 
           
          
         
        
       
         m_{<!-- -->{}_{\mu}\!X} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.77788em; vertical-align: -0.34732em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">μ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.281886em;"><span class=""></span></span></span></span></span></span><span class="mspace mtight" style="margin-right: -0.195167em;"></span><span class="mord mathdefault mtight" style="margin-right: 0.07847em;">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.34732em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           m 
          
          
           
            
           
             α 
            
           ⁣ 
          
            X 
           
          
         
        
       
         m_{<!-- -->{}_{\alpha}\!X} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68066em; vertical-align: -0.2501em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mspace mtight" style="margin-right: -0.195167em;"></span><span class="mord mathdefault mtight" style="margin-right: 0.07847em;">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，分别是用来根据现有的子图的embedding预测节点种类的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          M 
         
        
          L 
         
        
          P 
         
        
       
         \mathbf {MLP} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68611em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbf">M</span><span class="mord mathbf">L</span><span class="mord mathbf">P</span></span></span></span></span></span>。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           m 
          
          
           
            
           
             μ 
            
           ⁣ 
          
            A 
           
          
         
        
       
         m_{<!-- -->{}_{\mu}\!A} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.77788em; vertical-align: -0.34732em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">μ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.281886em;"><span class=""></span></span></span></span></span></span><span class="mspace mtight" style="margin-right: -0.195167em;"></span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.34732em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           m 
          
          
           
            
           
             α 
            
           ⁣ 
          
            A 
           
          
         
        
       
         m_{<!-- -->{}_{\alpha}\!A} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68066em; vertical-align: -0.2501em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mspace mtight" style="margin-right: -0.195167em;"></span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，是用来根据现有的子图的<strong>embedding</strong>以及节点的<strong>embeddings</strong>来预测边的类型。为了生成一个新的节点以及它与现存节点相连的边，我们依据基本的高斯分布得到随机变量<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           ϵ 
          
         
           i 
          
         
        
       
         {\epsilon}_i 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           ϵ 
          
          
          
            i 
           
          
            j 
           
          
         
        
       
         {\epsilon}_{ij} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>,即：<br> <img src="https://images2.imgbox.com/4d/d9/DwjgtQTh_o.png" alt="在这里插入图片描述"><br> 由此得到节点的类型和边的类型：</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           X 
          
         
           i 
          
         
        
          = 
         
         
         
           v 
          
          
          
            a 
           
          
            r 
           
          
            g 
           
          
            m 
           
          
            a 
           
          
            x 
           
          
            ( 
           
           
           
             z 
            
           
             i 
            
           
             X 
            
           
          
            ) 
           
          
         
           d 
          
         
        
       
         X_{i}=v^{d}_{argmax(z_{i}^{X})} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.45473em; vertical-align: -0.605625em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.31998em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">x</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.832893em;"><span class="" style="top: -2.17771em; margin-left: -0.04398em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="" style="top: -2.8448em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07847em;">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.322286em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.605625em;"><span class=""></span></span></span></span></span></span></span></span></span></span>；</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           A 
          
          
          
            i 
           
          
            j 
           
          
         
        
          = 
         
         
         
           v 
          
          
          
            a 
           
          
            r 
           
          
            g 
           
          
            m 
           
          
            a 
           
          
            x 
           
          
            ( 
           
           
           
             z 
            
            
            
              i 
             
            
              j 
             
            
           
             A 
            
           
          
            ) 
           
          
          
          
            b 
           
          
            + 
           
          
            1 
           
          
         
        
       
         A_{ij}=v^{b+1}_{argmax(z_{ij}^{A})} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.61028em; vertical-align: -0.721045em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.889239em;"><span class="" style="top: -2.30178em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">x</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.832893em;"><span class="" style="top: -2.17771em; margin-left: -0.04398em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="" style="top: -2.8448em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.461171em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span class="" style="top: -3.10313em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.721045em;"><span class=""></span></span></span></span></span></span></span></span></span></span></li><li>注：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           v 
          
         
           q 
          
         
           p 
          
         
        
       
         v_{q}^{p} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0475em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">q</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示一个<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          p 
         
        
       
         p 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span></span>维的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          o 
         
        
          n 
         
        
          e 
         
        
          − 
         
        
          h 
         
        
          o 
         
        
          t 
         
        
       
         one-hot 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span></span></span></span></span>向量，它的第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          q 
         
        
       
         q 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span></span></span></span></span>个位置值为1；</li></ul> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ϵ 
        
       
         = 
        
        
         
         
           ϵ 
          
         
           1 
          
         
        
          , 
         
         
         
           ϵ 
          
         
           2 
          
         
        
          , 
         
         
         
           ϵ 
          
         
           21 
          
         
        
          , 
         
         
         
           ϵ 
          
         
           3 
          
         
        
          , 
         
         
         
           ϵ 
          
         
           31 
          
         
        
          , 
         
        
          . 
         
        
          . 
         
        
          . 
         
        
          , 
         
         
         
           ϵ 
          
         
           n 
          
         
        
          , 
         
         
         
           ϵ 
          
          
          
            n 
           
          
            1 
           
          
         
        
          , 
         
        
          . 
         
        
          . 
         
        
          . 
         
        
          , 
         
         
         
           ϵ 
          
          
          
            n 
           
          
            , 
           
          
            n 
           
          
            − 
           
          
            1 
           
          
         
        
          , 
         
        
       
      
        \epsilon={<!-- -->{\epsilon}_{1},{\epsilon}_{2},{\epsilon}_{21},{\epsilon}_{3},{\epsilon}_{31},...,{\epsilon}_{n},{\epsilon}_{n1},...,{\epsilon}_{n,n-1},} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">ϵ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span></span>。GraphAF定义了一个基本的高斯分布<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ϵ 
        
       
      
        {\epsilon} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">ϵ</span></span></span></span></span></span>与分子图结构<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         z 
        
       
         = 
        
       
         ( 
        
        
        
          z 
         
        
          A 
         
        
       
         , 
        
        
        
          z 
         
        
          X 
         
        
       
         ) 
        
       
      
        z=(z^{A},z^{X}) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09133em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07847em;">X</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>。则反变换的可以由如下式子计算：<br> <img src="https://images2.imgbox.com/94/2d/EP2l35d6_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8b/06/88Uh5kAS_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="32_Efficient_Parallel_Training_58"></a>3.2 Efficient Parallel Training</h3> 
<p>在<strong>GraphAF</strong>中，因为变换<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         f 
        
       
         : 
        
       
         E 
        
       
         → 
        
       
         Z 
        
       
      
        f:\mathcal E\to\mathcal Z 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.08944em;">E</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.07944em;">Z</span></span></span></span></span>是自回归的，则<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          f 
         
         
         
           − 
          
         
           1 
          
         
        
       
         : 
        
       
         Z 
        
       
         → 
        
       
         E 
        
       
      
        f^{-1}:\mathcal Z\to\mathcal E 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.00855em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.07944em;">Z</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.08944em;">E</span></span></span></span></span>的雅克比矩阵是下三角矩阵，并且它的行列式可以非常高效地计算。<br> 在训练过程中，我们可以利用<strong>masking</strong>在输入分子图G和输出潜变量<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ϵ 
        
       
      
        \epsilon 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">ϵ</span></span></span></span></span>之间定义一个前馈神经网络来进行并行计算。当我们推断节点<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
      
        i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>时，mask掉图的一些边来保证RGCN只处理子图<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          G 
         
        
          i 
         
        
       
      
        \mathbf G_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83611em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbf">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>；当我们推断边的存在时，我们<strong>mask</strong>掉一些链接来保证RGCN只处理到<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          G 
         
        
          i 
         
        
       
         , 
        
        
        
          X 
         
        
          i 
         
        
       
         , 
        
        
        
          A 
         
         
         
           i 
          
         
           , 
          
         
           1 
          
         
           : 
          
         
           j 
          
         
           − 
          
         
           1 
          
         
        
       
      
        G_i,X_i,A_{i,1:j-1} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。用这种<strong>masking</strong>的技巧，使得模型不仅满足了自回归的特性，而且能够通过并行计算所有条件，可以在一次向前传递中有效地计算<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         p 
        
       
         ( 
        
       
         G 
        
       
         ) 
        
       
      
        p(G) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">G</span><span class="mclose">)</span></span></span></span></span>。并且为了继续加速训练的过程，训练图的节点和边会根据<strong>BFS</strong>来被重新排序。由于BFS的性质，键只能存在于相同或连续的BFS深度内的节点之间。因此，节点间的最大依赖距离由单个BFS深度中最大的节点数所限定。在我们的数据集中，任何单个的BFS深度包含的节点不超过12个，这意味着我们只需要对当前原子和最近生成的12个原子之间的边缘进行建模。</p> 
<h3><a id="33_Validity_Constrained_Sampling_62"></a>3.3 Validity Constrained Sampling</h3> 
<p>化学种存在着很多化学规则，这能够帮助生成有效分子。由于我们的方法采取了顺序生成的过程，所以可以在每个生成步骤中利用这些规则。我们可以在采样过程中直接利用化合价约束来检查现有的化学键的数量是否满足这个约束。我的理解就是比如一个原子按照化学规则它最多能有四个与其他原子相连的化学键，但现在却有五个，那这个就不符合化学规则，需要重新采样，重新生成。<br> <img src="https://images2.imgbox.com/18/6d/IhpD8Eht_o.png" alt="在这里插入图片描述"><br> 并且当以下两种条件满足时，图的生成过程就停止了：</p> 
<ol><li>图的大小达到最大值n；</li><li>新生成的原子和之前的子图之间没有键。最后，氢被加到没有填满价键的原子上。</li></ol> 
<h3><a id="34_GoalDirected_Molecule_Generation_with_Reinforcement_Learning_70"></a>3.4 Goal-Directed Molecule Generation with Reinforcement Learning</h3> 
<p>到目前为止，我们已经介绍了如何使用GraphAF对分子图结构的数据密度进行建模并生成有效分子。 但是，对于药物发现，我们还需要优化生成分子的化学性质。 在这一部分中，我们将介绍如何通过强化学习来微调我们的生成过程，以优化生成的分子的特性。<br> 主要介绍一下<strong>Reward design</strong>，主要有阶段性的奖励以及最终性的奖励。阶段性的奖励为如果边缘预测违反了价检查，将引入一个小惩罚作为中间奖励。最终的奖励包括生成分子的目标特性的分数，如辛醇-水分配系数或者类药性，化学有效性奖励，例如对空间应变过大的分子和/或违反ZINC官能团过滤器的官能团的处罚。实际中，我们使用<strong>PPO</strong>来训练GraphAF<br> <img src="https://images2.imgbox.com/5f/97/eAUFtogg_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_75"></a>四、实验</h2> 
<h3><a id="41__76"></a>4.1 实验设置</h3> 
<p>一共有三个任务：</p> 
<ul><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          D 
         
        
          e 
         
        
          n 
         
        
          s 
         
        
          i 
         
        
          t 
         
        
          y 
           
        
          M 
         
        
          o 
         
        
          d 
         
        
          e 
         
        
          l 
         
        
          i 
         
        
          n 
         
        
          g 
           
        
          a 
         
        
          n 
         
        
          d 
           
        
          G 
         
        
          e 
         
        
          n 
         
        
          e 
         
        
          r 
         
        
          a 
         
        
          t 
         
        
          i 
         
        
          o 
         
        
          n 
         
        
       
         \mathbf{Density\;Modeling \;and \;Generation} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathbf">D</span><span class="mord mathbf">e</span><span class="mord mathbf">n</span><span class="mord mathbf">s</span><span class="mord mathbf">i</span><span class="mord mathbf">t</span><span class="mord mathbf" style="margin-right: 0.01597em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf">M</span><span class="mord mathbf">o</span><span class="mord mathbf">d</span><span class="mord mathbf">e</span><span class="mord mathbf">l</span><span class="mord mathbf">i</span><span class="mord mathbf">n</span><span class="mord mathbf" style="margin-right: 0.01597em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf">a</span><span class="mord mathbf">n</span><span class="mord mathbf">d</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf">G</span><span class="mord mathbf">e</span><span class="mord mathbf">n</span><span class="mord mathbf">e</span><span class="mord mathbf">r</span><span class="mord mathbf">a</span><span class="mord mathbf">t</span><span class="mord mathbf">i</span><span class="mord mathbf">o</span><span class="mord mathbf">n</span></span></span></span></span></span>：评估模型的能力，以学习数据分布和产生现实和多样化的分子。<strong>Validity</strong>是生成的所有图中有效分子的百分比；<strong>Uniqueness</strong>是生成的分子中唯一分子的百分比。<strong>Novelty</strong>是生成的分子中没有出现在训练集中的百分比，<strong>Reconstruction</strong>是可以从潜在的载体中重建的分子的百分比。我们从10000个随机生成的分子中计算出上述指标。</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          P 
         
        
          r 
         
        
          o 
         
        
          p 
         
        
          e 
         
        
          r 
         
        
          t 
         
        
          y 
           
        
          O 
         
        
          p 
         
        
          t 
         
        
          i 
         
        
          m 
         
        
          i 
         
        
          z 
         
        
          a 
         
        
          t 
         
        
          i 
         
        
          o 
         
        
          n 
         
        
       
         \mathbf{Property\;Optimization} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathbf">P</span><span class="mord mathbf">r</span><span class="mord mathbf">o</span><span class="mord mathbf">p</span><span class="mord mathbf">e</span><span class="mord mathbf">r</span><span class="mord mathbf">t</span><span class="mord mathbf" style="margin-right: 0.01597em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf">O</span><span class="mord mathbf">p</span><span class="mord mathbf">t</span><span class="mord mathbf">i</span><span class="mord mathbf">m</span><span class="mord mathbf">i</span><span class="mord mathbf">z</span><span class="mord mathbf">a</span><span class="mord mathbf">t</span><span class="mord mathbf">i</span><span class="mord mathbf">o</span><span class="mord mathbf">n</span></span></span></span></span></span>：专注于生成具有优化化学性能的新型分子。 对于此任务，我们对从密度建模任务预训练的网络进行微调，以最大化所需的属性。在这项任务中，我们的目标是生成具有理想性质的分子。具体来说，我们选择惩罚logP和QED作为我们的目标属性。前者的分数是logP分数，受环大小和合成可及性的影响，而后者则测量分子的药物相似性。请注意，这两个分数都是使用经验预测模型计算的，作者采用了<a href="https://arxiv.org/abs/1806.02473" rel="nofollow">这篇文章</a>中使用的脚本，以使结果具有可比性。为了完成这项任务，作者对GraphAF网络进行300个epoch的预训练，以进行似然建模，然后应用第3.4节中描述的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          R 
         
        
          L 
         
        
       
         RL 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mord mathdefault">L</span></span></span></span></span>过程来微调网络，使其达到所需的化学特性。如下所示，GraphAF在惩罚logP得分方面的表现优于所有基线，并在QED方面取得了可比的结果。这一现象表明，结合RL过程，GraphAF成功地捕捉到了所需分子的分布。</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          C 
         
        
          o 
         
        
          n 
         
        
          s 
         
        
          t 
         
        
          r 
         
        
          a 
         
        
          i 
         
        
          n 
         
        
          e 
         
        
          d 
           
        
          P 
         
        
          r 
         
        
          o 
         
        
          p 
         
        
          e 
         
        
          r 
         
        
          t 
         
        
          y 
           
        
          O 
         
        
          p 
         
        
          t 
         
        
          i 
         
        
          m 
         
        
          i 
         
        
          z 
         
        
          a 
         
        
          t 
         
        
          i 
         
        
          o 
         
        
          n 
         
        
       
         \mathbf{Constrained\;Property\;Optimization} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="mord mathbf">o</span><span class="mord mathbf">n</span><span class="mord mathbf">s</span><span class="mord mathbf">t</span><span class="mord mathbf">r</span><span class="mord mathbf">a</span><span class="mord mathbf">i</span><span class="mord mathbf">n</span><span class="mord mathbf">e</span><span class="mord mathbf">d</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf">P</span><span class="mord mathbf">r</span><span class="mord mathbf">o</span><span class="mord mathbf">p</span><span class="mord mathbf">e</span><span class="mord mathbf">r</span><span class="mord mathbf">t</span><span class="mord mathbf" style="margin-right: 0.01597em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathbf">O</span><span class="mord mathbf">p</span><span class="mord mathbf">t</span><span class="mord mathbf">i</span><span class="mord mathbf">m</span><span class="mord mathbf">i</span><span class="mord mathbf">z</span><span class="mord mathbf">a</span><span class="mord mathbf">t</span><span class="mord mathbf">i</span><span class="mord mathbf">o</span><span class="mord mathbf">n</span></span></span></span></span></span>：其目的是在满足相似性约束的前提下，对给定的分子进行修饰以改善期望的性质。约束条件是原始分子和修改后的分子之间的相似性高于一个阈值。与性能优化任务类似，我们通过密度模型对GraphAF进行预处理，然后用RL对模型进行微调。在生成过程中，我们将初始状态设置为从800个分子中随机抽取的子图进行优化。为了进行评估，我们在表6中报告了最高改进的平均值和标准差以及原始分子和改性分子之间的相应相似性。实验结果表明，GraphAF明显优于以往的所有方法，并且几乎总能成功地改善目标特性。图2（c）展示了两个优化实例，表明我们的模型能够大幅度提高惩罚logP得分，同时保持原分子和改性分子之间的高度相似性</li></ul> 
<p><strong>数据集</strong>：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Z 
        
       
         I 
        
       
         N 
        
       
         C 
        
       
         250 
        
       
         k 
        
       
      
        {ZINC250k} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">Z</span><span class="mord mathdefault" style="margin-right: 0.07847em;">I</span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mord">2</span><span class="mord">5</span><span class="mord">0</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span></span>，该数据集包含25万个类药物分子，最大原子数为38个。它具有9种原子类型和3种边类型。 我们使用开源化学软件RDkit对分子进行预处理，所有分子均以烷基化形式存在，并且去除了氢。</p> 
<p><img src="https://images2.imgbox.com/0a/14/dVUMVO4Z_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5b/05/d1dcQLhg_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="42_Numerical_Results_91"></a>4.2 Numerical Results</h3> 
<p>作者通过利用广泛使用的指标来评估所提出的方法对真实分子建模的能力：对于提出的四种度量方式，GraphAF的结果如下：<br> <img src="https://images2.imgbox.com/85/90/PKPQP87V_o.png" alt="在这里插入图片描述"><br> 并且作者为了验证GraphAF并非在<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Z 
        
       
         I 
        
       
         N 
        
       
         C 
        
       
         250 
        
       
         k 
        
       
      
        \mathbf{ZINC250k} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbf">Z</span><span class="mord mathbf">I</span><span class="mord mathbf">N</span><span class="mord mathbf">C</span><span class="mord mathbf">2</span><span class="mord mathbf">5</span><span class="mord mathbf">0</span><span class="mord mathbf">k</span></span></span></span></span></span>上过拟合。作者在另外两个数据集<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Q 
        
       
         M 
        
       
         9 
        
       
      
        \mathbf{QM9} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88055em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span><span class="mord mathbf">M</span><span class="mord mathbf">9</span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         M 
        
       
         O 
        
       
         S 
        
       
         E 
        
       
         S 
        
       
      
        \mathbf{MOSES} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68611em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbf">M</span><span class="mord mathbf">O</span><span class="mord mathbf">S</span><span class="mord mathbf">E</span><span class="mord mathbf">S</span></span></span></span></span></span>上进行了实验。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Q 
        
       
         M 
        
       
         9 
        
       
      
        \mathbf{QM9} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88055em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span><span class="mord mathbf">M</span><span class="mord mathbf">9</span></span></span></span></span></span>含有134k分子和9个重原子，而MOSES要大得多，也更具挑战性，它包含190万个分子和30个重原子。表3显示，即使在更复杂的数据集上，GraphAF也总是能够生成有效且新颖的分子。此外，尽管GraphAF最初是为分子图生成而设计的，但实际上它非常通用，可以通过简单地修改节点和边缘生成函数Edge-MLP和Node-MLP来用于对不同类型的图进行建模。按照GNF实验的设定，作者在两个通用的图形数据集利用GraphAF进行了实验。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         C 
        
       
         O 
        
       
         M 
        
       
         M 
        
       
         U 
        
       
         N 
        
       
         I 
        
       
         T 
        
       
         Y 
        
       
         − 
        
       
         S 
        
       
         M 
        
       
         A 
        
       
         L 
        
       
         L 
        
       
      
        \mathbf{COMMUNITY-SMALL} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.76944em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="mord mathbf">O</span><span class="mord mathbf">M</span><span class="mord mathbf">M</span><span class="mord mathbf">U</span><span class="mord mathbf">N</span><span class="mord mathbf">I</span><span class="mord mathbf">T</span><span class="mord mathbf" style="margin-right: 0.02875em;">Y</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathbf">S</span><span class="mord mathbf">M</span><span class="mord mathbf">A</span><span class="mord mathbf">L</span><span class="mord mathbf">L</span></span></span></span></span></span>是包含100个2社区图的综合数据集，而<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         E 
        
       
         G 
        
       
         O 
        
       
         − 
        
       
         S 
        
       
         M 
        
       
         A 
        
       
         L 
        
       
         L 
        
       
      
        \mathbf{EGO-SMALL} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.76944em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathbf">E</span><span class="mord mathbf">G</span><span class="mord mathbf">O</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathbf">S</span><span class="mord mathbf">M</span><span class="mord mathbf">A</span><span class="mord mathbf">L</span><span class="mord mathbf">L</span></span></span></span></span></span>是从<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         C 
        
       
         i 
        
       
         t 
        
       
         e 
        
       
         s 
        
       
         e 
        
       
         e 
        
       
         r 
        
       
      
        \mathbf{Citeseer} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbf">C</span><span class="mord mathbf">i</span><span class="mord mathbf">t</span><span class="mord mathbf">e</span><span class="mord mathbf">s</span><span class="mord mathbf">e</span><span class="mord mathbf">e</span><span class="mord mathbf">r</span></span></span></span></span></span>数据集中提取的一组图。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7b37e25318ba2bc3562d512d161c1265/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">遥感影像的纹理特征计算（基于ENVI和Python实践）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9e34efb1df98079186aaaa17b2e393a8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【mySQL】MySQL JOIN原理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>