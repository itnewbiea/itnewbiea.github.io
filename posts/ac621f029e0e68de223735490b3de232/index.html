<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Visual Studio二次安装时无法更改安装位置解决方案 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Visual Studio二次安装时无法更改安装位置解决方案" />
<meta property="og:description" content="背景：去年年底因为一个C#项目，安装过Visual Studio，当时采用的是默认安装，即安装到C盘。最近有个VB的桌面小项目，想安装Windows开发平台负载时发现C盘剩余空间不足15G，随起了卸载重新安装的想法，卸载后重新安装时，发现默认安装位置呈现灰色，不可更改，网络上解决方案好多说的比较单一，那么我在此总结下，方便自己和后来者。
本质：出现这个问题的本质原因为上一次安装卸载不彻底（一般指的是软件从硬盘里移除了，但写到注册表里面的配置信息并没有删除干净），导致后续安装时默认读取的注册表里面未删除的配置信息，本次无法更改安装位置就是这种情形。
搞清楚了问题本质，解决问题方案如下：
1、采用官方卸载工具执行强制卸载。下载地址：Releases · microsoft/VisualStudioUninstaller · GitHub ，点击如图所示的路径下载。
解压缩后，右键管理员运行下图箭头执行的exe文件，根据提示操作即可。注意：卸载时cmd窗口可能会长时间无反应，这一步是在执行卸载，耐心等待提示完成卸载即可！这一步目的是为了更加干净地卸载电脑已安装的Visual Studio软件和配置，只执行这一步可能仍然无法解决无法更改安装位置的问题，至少我是这样的。
2、步骤1执行完毕后，运行regedit打开注册表，查看注册表路径：HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\Setup 下是否还存在SharedInstallationPath和CachePath配置项，如果依然存在，那么手动右键删除即可。这一步一定要做，很关键！
注意以上两个步骤建议都操作下，单一执行某个步骤，都可能解决不了问题。
以上，完了！！" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/ac621f029e0e68de223735490b3de232/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-29T13:41:09+08:00" />
<meta property="article:modified_time" content="2022-03-29T13:41:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Visual Studio二次安装时无法更改安装位置解决方案</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>        背景：去年年底因为一个C#项目，安装过Visual Studio，当时采用的是默认安装，即安装到C盘。最近有个VB的桌面小项目，想安装Windows开发平台负载时发现C盘剩余空间不足15G，随起了卸载重新安装的想法，卸载后重新安装时，发现默认安装位置呈现灰色，不可更改，网络上解决方案好多说的比较单一，那么我在此总结下，方便自己和后来者。</p> 
<p>         本质：出现这个问题的本质原因为上一次安装卸载不彻底（一般指的是软件从硬盘里移除了，但写到注册表里面的配置信息并没有删除干净），导致后续安装时默认读取的注册表里面未删除的配置信息，本次无法更改安装位置就是这种情形。</p> 
<p>搞清楚了问题本质，解决问题方案如下：</p> 
<p>1、采用官方卸载工具执行强制卸载。下载地址：<a href="https://github.com/Microsoft/VisualStudioUninstaller/releases" title="Releases · microsoft/VisualStudioUninstaller · GitHub">Releases · microsoft/VisualStudioUninstaller · GitHub</a> ，点击如图所示的路径下载。</p> 
<p><img alt="" height="124" src="https://images2.imgbox.com/44/7a/nrkpdc6O_o.png" width="1025"></p> 
<p>解压缩后，右键管理员运行下图箭头执行的exe文件，根据提示操作即可。<span style="color:#f33b45;"><strong>注意：卸载时cmd窗口可能会长时间无反应，这一步是在执行卸载，耐心等待提示完成卸载即可！</strong></span>这一步目的是为了更加干净地卸载电脑已安装的Visual Studio软件和配置，只执行这一步可能仍然无法解决无法更改安装位置的问题，至少我是这样的。</p> 
<p><img alt="" height="264" src="https://images2.imgbox.com/54/4a/25kLUEuT_o.png" width="803"></p> 
<p>2、步骤1执行完毕后，运行regedit打开注册表，查看注册表路径：HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\Setup 下是否还存在SharedInstallationPath和CachePath配置项，如果依然存在，那么手动右键删除即可。这一步一定要做，很关键！</p> 
<p><img alt="" height="206" src="https://images2.imgbox.com/e6/85/P4WUaqAi_o.png" width="1132"></p> 
<p>注意以上两个步骤建议都操作下，单一执行某个步骤，都可能解决不了问题。</p> 
<p>以上，完了！！</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d339bc5af9c982ccc1569d0755cb30e2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VSCode如何返回上一步</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b0176fb0a88f1505c4b66cb0304e39c5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C&#43;&#43;之导入其他文件的函数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>