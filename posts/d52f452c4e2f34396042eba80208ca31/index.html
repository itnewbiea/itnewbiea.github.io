<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PyTorch的Tensor（张量） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PyTorch的Tensor（张量）" />
<meta property="og:description" content="一、Tensor概念 什么是张量？ 张量是一个多维数组，它是标量、向量、矩阵的高维拓展
Tensor与Variable Variable是torch.autograd中的数据类型，主要用于封装Tensor，进行自动求导。
data: 被包装的Tensorgrad: data的梯度（梦回数一）grad_fn: 创建Tensor的Function，是自动求导的关键requires_grad: 指示是否需要梯度is_leaf: 指示是否是叶子节点（张量） Tensor PyTorch 0.4.0版本开始，Variable已并入Tensor。
dtype: 张量的数据类型，例如torch.FloatTensor, torch.cuda.FloatTensorshape: 张量的形状，例如 (64, 3, 224, 224)device: 张量所在设备，GPU/CPU，是加速的关键
二、 Create Tensor 1、直接创建 torch.tensor( data, dtype=None, device=None, requires_grad=False, pin_memory=False ) 功能：从data创建tensor
• data: 数据, 可以是list, numpy
• dtype : 数据类型，默认与data的一致
• device : 所在设备, cuda/cpu
• requires_grad：是否需要梯度
• pin_memory：是否存于锁页内存
torch.from_numpy(ndarray) 功能：从numpy创建tensor。 注意事项：从torch.from_numpy创建的 tensor 与原始 ndarray 共享内存。 当修改其中一个的数据时，另一个也会被改动。 2、依据数值创建 torch.zeros( *size, out=None, dtype=None, layout=torch.strided, device=None, requires_grad=False ) 功能：依照size创建全0张量" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/d52f452c4e2f34396042eba80208ca31/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-01T21:30:59+08:00" />
<meta property="article:modified_time" content="2024-01-01T21:30:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PyTorch的Tensor（张量）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Tensor_0"></a>一、Tensor概念</h2> 
<h3><a id="_2"></a>什么是张量？</h3> 
<p>张量是一个<strong>多维数组</strong>，它是标量、向量、矩阵的高维拓展<br> <img src="https://images2.imgbox.com/b2/30/sXIZYPep_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="TensorVariable_5"></a>Tensor与Variable</h3> 
<p>Variable是torch.autograd中的数据类型，主要用于封装Tensor，进行自动求导。</p> 
<ul><li>data: 被包装的Tensor</li><li>grad: data的梯度（<strong>梦回数一</strong>）</li><li>grad_fn: 创建Tensor的Function，是自动求导的关键</li><li>requires_grad: 指示是否需要梯度</li><li>is_leaf: 指示是否是叶子节点（张量）</li></ul> 
<p><img src="https://images2.imgbox.com/b2/8d/jtkCu29F_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="Tensor_17"></a>Tensor</h3> 
<p>PyTorch 0.4.0版本开始，Variable已并入Tensor。</p> 
<ul><li>dtype: 张量的数据类型，例如torch.FloatTensor, torch.cuda.FloatTensor</li><li>shape: 张量的形状，例如 (64, 3, 224, 224)</li><li>device: 张量所在设备，GPU/CPU，是加速的关键<br> <img src="https://images2.imgbox.com/b1/44/0XAlkVEz_o.png" alt="在这里插入图片描述"></li></ul> 
<p><img src="https://images2.imgbox.com/b7/4b/HttjgqN2_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_Create_Tensor_26"></a>二、 Create Tensor</h2> 
<h3><a id="1_27"></a>1、直接创建</h3> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>
    data<span class="token punctuation">,</span>
    dtype<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    requires_grad<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
    pin_memory<span class="token operator">=</span><span class="token boolean">False</span>
<span class="token punctuation">)</span>
</code></pre> 
<p>功能：从data创建tensor</p> 
<p>• data: 数据, 可以是list, numpy<br> • dtype : 数据类型，默认与data的一致<br> • device : 所在设备, cuda/cpu<br> • requires_grad：是否需要梯度<br> • pin_memory：是否存于锁页内存</p> 
<pre><code class="prism language-c">torch<span class="token punctuation">.</span><span class="token function">from_numpy</span><span class="token punctuation">(</span>ndarray<span class="token punctuation">)</span>
功能：从numpy创建tensor。
注意事项：从torch<span class="token punctuation">.</span>from_numpy创建的 tensor 与原始 ndarray 共享内存。
当修改其中一个的数据时，另一个也会被改动。
</code></pre> 
<p><img src="https://images2.imgbox.com/17/e9/jMI6SC9Q_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_58"></a>2、依据数值创建</h3> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>
    <span class="token operator">*</span>size<span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    dtype<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    layout<span class="token operator">=</span>torch<span class="token punctuation">.</span>strided<span class="token punctuation">,</span>
    device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    requires_grad<span class="token operator">=</span><span class="token boolean">False</span>
<span class="token punctuation">)</span>
</code></pre> 
<p>功能：依照size创建全0张量</p> 
<p>• size: 张量的形状, 如(3, 3)、(3, 224,224)<br> • out : 输出的张量<br> • layout : 内存中布局形式, 有strided,sparse_coo等<br> • device : 所在设备, gpu/cpu<br> • requires_grad：是否需要梯度</p> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>
    <span class="token builtin">input</span><span class="token punctuation">,</span>
    dtype<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    layout<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    requires_grad<span class="token operator">=</span><span class="token boolean">False</span>
<span class="token punctuation">)</span>

</code></pre> 
<p>功能：依照 input 形状创建全0张量</p> 
<p>参数说明：</p> 
<ul><li>input: 作为模板的输入张量，新创建的张量将具有与此张量相同的形状和数据类型。</li><li>dtype（可选）: 新创建张量的数据类型，默认为 None（即与输入张量相同）。</li><li>layout（可选）: 新创建张量的布局，默认为 None（即与输入张量相同）。</li><li>device（可选）: 新创建张量所在设备，默认为 None（即与输入张量相同）。</li><li>requires_grad（可选）: 是否需要计算梯度，默认为 False，即不需要计算梯度。</li></ul> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>
    <span class="token operator">*</span>size<span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    dtype<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    layout<span class="token operator">=</span>torch<span class="token punctuation">.</span>strided<span class="token punctuation">,</span>
    device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    requires_grad<span class="token operator">=</span><span class="token boolean">False</span>
<span class="token punctuation">)</span>

</code></pre> 
<p>参数说明：</p> 
<ul><li>*size: 张量的形状，可以是一个数字或一个元组，用来指定张量每个维度的大小。</li><li>out（可选）: 输出张量。</li><li>dtype（可选）: 张量的数据类型，默认为 None，即自动推断。</li><li>layout（可选）: 张量的布局，默认为 torch.strided。</li><li>device（可选）: 张量所在设备，默认为 None，即 CPU。</li><li>requires_grad（可选）: 是否需要计算梯度，默认为 False，即不需要计算梯度。</li></ul> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>ones_like<span class="token punctuation">(</span>
    <span class="token builtin">input</span><span class="token punctuation">,</span>
    dtype<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    layout<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    requires_grad<span class="token operator">=</span><span class="token boolean">False</span>
<span class="token punctuation">)</span>

</code></pre> 
<p>参数说明：</p> 
<ul><li>input: 作为模板的输入张量，新创建的张量将具有与此张量相同的形状和数据类型。</li><li>dtype（可选）: 新创建张量的数据类型，默认为 None，即与输入张量相同。</li><li>layout（可选）: 新创建张量的布局，默认为 None，即与输入张量相同。</li><li>device（可选）: 新创建张量所在设备，默认为 None，即与输入张量相同。</li><li>requires_grad（可选）: 是否需要计算梯度，默认为 False，即不需要计算梯度。</li><li>torch.ones() 用于创建所有元素值为1的张量，而 torch.ones_like() 则创建与输入张量形状相同的张量，但所有元素的值都为1。这两个函数都可以选择性地指定数据类型、布局、设备和是否需要计算梯度。</li></ul> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>full<span class="token punctuation">(</span>
    size<span class="token punctuation">,</span>
    fill_value<span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    dtype<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    layout<span class="token operator">=</span>torch<span class="token punctuation">.</span>strided<span class="token punctuation">,</span>
    device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    requires_grad<span class="token operator">=</span><span class="token boolean">False</span>
<span class="token punctuation">)</span>

</code></pre> 
<p>参数说明：</p> 
<ul><li>size: 张量的形状，可以是一个数字或一个元组，用来指定张量每个维度的大小。</li><li>fill_value: 填充张量的值，可以是标量或与指定数据类型相同的张量。</li><li>out（可选）: 输出张量。</li><li>dtype（可选）: 张量的数据类型，默认为 None，即自动推断。</li><li>layout（可选）: 张量的布局，默认为 torch.strided。</li><li>device（可选）: 张量所在设备，默认为 None，即 CPU。</li><li>requires_grad（可选）: 是否需要计算梯度，默认为 False，即不需要计算梯度。</li></ul> 
<p>这个函数用于创建指定形状并用指定值填充的张量。填充值可以是一个标量或与指定数据类型相同的张量。可以选择性地指定数据类型、布局、设备和是否需要计算梯度。</p> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>
    start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
    end<span class="token punctuation">,</span>
    step<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    dtype<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    layout<span class="token operator">=</span>torch<span class="token punctuation">.</span>strided<span class="token punctuation">,</span>
    device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    requires_grad<span class="token operator">=</span><span class="token boolean">False</span>
<span class="token punctuation">)</span>

</code></pre> 
<p>参数说明：</p> 
<ul><li>start: 序列起始值，默认为 0。</li><li>end: 序列结束值（不包含），创建的序列不包含该值。</li><li>step: 序列中相邻值之间的步长，默认为 1。</li><li>out（可选）: 输出张量。</li><li>dtype（可选）: 张量的数据类型，默认为 None，即自动推断。</li><li>layout（可选）: 张量的布局，默认为 torch.strided。</li><li>device（可选）: 张量所在设备，默认为 None，即 CPU。</li><li>requires_grad（可选）: 是否需要计算梯度，默认为 False，即不需要计算梯度。</li></ul> 
<p>这个函数用于创建一个从 start 到 end（不包含 end）的数值序列，并以 step 为步长。可以选择性地指定数据类型、布局、设备和是否需要计算梯度。</p> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span>
    start<span class="token punctuation">,</span>
    end<span class="token punctuation">,</span>
    steps<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    dtype<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    layout<span class="token operator">=</span>torch<span class="token punctuation">.</span>strided<span class="token punctuation">,</span>
    device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    requires_grad<span class="token operator">=</span><span class="token boolean">False</span>
<span class="token punctuation">)</span>

</code></pre> 
<p>参数说明：</p> 
<ul><li>start: 序列起始值。</li><li>end: 序列结束值。</li><li>steps: 序列中的元素数量，默认为 100。</li><li>out（可选）: 输出张量。</li><li>dtype（可选）: 张量的数据类型，默认为 None，即自动推断。</li><li>layout（可选）: 张量的布局，默认为 torch.strided。</li><li>device（可选）: 张量所在设备，默认为 None，即 CPU。</li><li>requires_grad（可选）: 是否需要计算梯度，默认为 False，即不需要计算梯度。</li></ul> 
<p>这个函数创建一个在指定范围内（从 start 到 end）以均匀间隔的方式生成的数值序列，并且序列的元素数量由 steps 参数指定。可以选择性地指定数据类型、布局、设备和是否需要计算梯度。</p> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>logspace<span class="token punctuation">(</span>
    start<span class="token punctuation">,</span>
    end<span class="token punctuation">,</span>
    steps<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>
    base<span class="token operator">=</span><span class="token number">10.0</span><span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    dtype<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    layout<span class="token operator">=</span>torch<span class="token punctuation">.</span>strided<span class="token punctuation">,</span>
    device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    requires_grad<span class="token operator">=</span><span class="token boolean">False</span>
<span class="token punctuation">)</span>

</code></pre> 
<p>参数说明：</p> 
<ul><li>start: 序列起始值的指数。</li><li>end: 序列结束值的指数。</li><li>steps: 序列中的元素数量，默认为 100。</li><li>base: 序列中的数值以此为底进行指数计算，默认为 10.0。</li><li>out（可选）: 输出张量。</li><li>dtype（可选）: 张量的数据类型，默认为 None，即自动推断。</li><li>layout（可选）: 张量的布局，默认为 torch.strided。</li><li>device（可选）: 张量所在设备，默认为 None，即 CPU。</li><li>requires_grad（可选）: 是否需要计算梯度，默认为 False，即不需要计算梯度。</li></ul> 
<p>这个函数创建一个在对数刻度上以均匀间隔分布的数值序列，start 和 end 参数指定序列起始值和结束值的指数，base 参数确定对数的底。可以选择性地指定数据类型、布局、设备和是否需要计算梯度。</p> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>eye<span class="token punctuation">(</span>
    n<span class="token punctuation">,</span>
    m<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    dtype<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    layout<span class="token operator">=</span>torch<span class="token punctuation">.</span>strided<span class="token punctuation">,</span>
    device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    requires_grad<span class="token operator">=</span><span class="token boolean">False</span>
<span class="token punctuation">)</span>

</code></pre> 
<p>参数说明：</p> 
<ul><li>n: 矩阵的行数。</li><li>m（可选）: 矩阵的列数，默认为 None，如果为 None，则创建的是 n x n 的方阵。</li><li>out（可选）: 输出张量。</li><li>dtype（可选）: 张量的数据类型，默认为 None，即自动推断。</li><li>layout（可选）: 张量的布局，默认为 torch.strided。</li><li>device（可选）: 张量所在设备，默认为 None，即 CPU。</li><li>requires_grad（可选）: 是否需要计算梯度，默认为 False，即不需要计算梯度。</li></ul> 
<p>这个函数可以创建一个单位矩阵。如果提供了 m 参数，则创建的是一个 n x m 的矩阵，否则创建的是 n x n 的方阵。可以选择性地指定数据类型、布局、设备和是否需要计算梯度。</p> 
<h3><a id="3_275"></a>3、依概率分布创建张量</h3> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>
    mean<span class="token punctuation">,</span>
    std<span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span>
<span class="token punctuation">)</span>

</code></pre> 
<p>torch.normal() 是 PyTorch 中用于生成服从指定均值和标准差的正态分布随机数的函数。以下是该函数的参数说明：</p> 
<ul><li>mean: 正态分布的均值。</li><li>std: 正态分布的标准差。</li><li>out（可选）: 输出张量，用于保存生成的随机数。</li></ul> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>
    mean<span class="token punctuation">,</span>
    std<span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span>
<span class="token punctuation">)</span>

</code></pre> 
<p>用于生成服从指定均值和标准差的正态分布随机数。</p> 
<ul><li>mean: 正态分布的均值。</li><li>std: 正态分布的标准差。</li><li>out（可选）: 输出张量，用于保存生成的随机数。</li></ul> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>
    mean<span class="token punctuation">,</span>
    std<span class="token punctuation">,</span>
    size<span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span>
<span class="token punctuation">)</span>

</code></pre> 
<ul><li>mean: 正态分布的均值。</li><li>std: 正态分布的标准差。</li><li>size: 生成张量的形状。</li><li>out（可选）: 输出张量，用于保存生成的随机数。</li></ul> 
<blockquote> 
 <p><strong>四种模式：<br> mean为标量，std为标量<br> mean为标量，std为张量<br> mean为张量，std为标量<br> mean为张量，std为张量</strong></p> 
</blockquote> 
<p>这个函数与前一个函数类似，但是多了一个 size 参数，用于指定生成张量的形状。返回一个形状为 size 的张量，其中的元素服从均值为 mean、标准差为 std 的正态分布。可以选择性地提供一个输出张量 out 用于保存生成的随机数。</p> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>
    <span class="token operator">*</span>size<span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    dtype<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    layout<span class="token operator">=</span>torch<span class="token punctuation">.</span>strided<span class="token punctuation">,</span>
    device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    requires_grad<span class="token operator">=</span><span class="token boolean">False</span>
<span class="token punctuation">)</span>

</code></pre> 
<p>torch.rand() 是 PyTorch 中用于生成服从标准正态分布（均值为0，标准差为1）的随机数的函数。以下是该函数的参数说明：</p> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>rand<span class="token punctuation">(</span>
    <span class="token operator">*</span>size<span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    dtype<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    layout<span class="token operator">=</span>torch<span class="token punctuation">.</span>strided<span class="token punctuation">,</span>
    device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    requires_grad<span class="token operator">=</span><span class="token boolean">False</span>
<span class="token punctuation">)</span>
</code></pre> 
<ul><li>*size: 张量的形状，可以是一个数字或一个元组，用来指定张量每个维度的大小。</li><li>out（可选）: 输出张量，用于保存生成的随机数。</li><li>dtype（可选）: 张量的数据类型，默认为 None，即自动推断。</li><li>layout（可选）: 张量的布局，默认为 torch.strided。</li><li>device（可选）: 张量所在设备，默认为 None，即 CPU。</li><li>requires_grad（可选）: 是否需要计算梯度，默认为 False，即不需要计算梯度。</li></ul> 
<p>这个函数返回一个张量，其中的元素是在区间 [0, 1) 上均匀分布的随机数，形状由参数 *size 指定。可以选择性地指定数据类型、布局、设备和是否需要计算梯度。</p> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>randint<span class="token punctuation">(</span>
    low<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
    high<span class="token punctuation">,</span>
    size<span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    dtype<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    layout<span class="token operator">=</span>torch<span class="token punctuation">.</span>strided<span class="token punctuation">,</span>
    device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    requires_grad<span class="token operator">=</span><span class="token boolean">False</span>
<span class="token punctuation">)</span>
</code></pre> 
<ul><li>low: 区间的下界（包含在内）。</li><li>high: 区间的上界（不包含在内）。</li><li>size: 生成张量的形状。</li><li>out（可选）: 输出张量，用于保存生成的随机整数。</li><li>dtype（可选）: 张量的数据类型，默认为 None，即自动推断。</li><li>layout（可选）: 张量的布局，默认为 torch.strided。</li><li>device（可选）: 张量所在设备，默认为 None，即 CPU。</li><li>requires_grad（可选）: 是否需要计算梯度，默认为 False，即不需要计算梯度。</li></ul> 
<p>这个函数返回一个张量，其中的元素是在区间 [low, high) 上均匀分布的随机整数，形状由参数 size 指定。</p> 
<p>这个函数用于生成随机排列和按照伯努利分布生成随机二元数。</p> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>randperm<span class="token punctuation">(</span>
    n<span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>int64<span class="token punctuation">,</span>
    layout<span class="token operator">=</span>torch<span class="token punctuation">.</span>strided<span class="token punctuation">,</span>
    device<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    requires_grad<span class="token operator">=</span><span class="token boolean">False</span>
<span class="token punctuation">)</span>
</code></pre> 
<p>参数说明：</p> 
<ul><li>n: 生成随机排列的长度。</li><li>out（可选）: 输出张量，用于保存生成的随机排列。</li><li>dtype（可选）: 张量的数据类型，默认为 torch.int64。</li><li>layout（可选）: 张量的布局，默认为 torch.strided。</li><li>device（可选）: 张量所在设备，默认为 None，即 CPU。</li><li>requires_grad（可选）: 是否需要计算梯度，默认为 False，即不需要计算梯度。</li></ul> 
<p><strong>这个函数返回一个长度为 n 的张量，包含从 0 到 n-1 的随机排列整数。</strong></p> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>bernoulli<span class="token punctuation">(</span>
    <span class="token builtin">input</span><span class="token punctuation">,</span>
    <span class="token operator">*</span><span class="token punctuation">,</span>
    generator<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    out<span class="token operator">=</span><span class="token boolean">None</span>
<span class="token punctuation">)</span>

</code></pre> 
<ul><li>input: 输入张量，用于指定伯努利分布的概率值。</li><li>generator（可选）: 随机数生成器，默认为 None。</li><li>out（可选）: 输出张量，用于保存生成的随机二元数。</li></ul> 
<p><strong>这个函数返回一个张量，其中的元素按照输入张量中的概率值在伯努利分布上进行采样生成随机二元数（0 或 1）。</strong></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2eb30e1ba62c64c8f73de1ed44b2bbf0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">汽车驾驶的基础知识，驾照考试的科目练习</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b9fea87210e3d69bb31a9dc4acae9f9d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C语言程序设计——输入输出函数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>