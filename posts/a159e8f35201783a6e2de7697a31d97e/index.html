<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>el-input触发 el-popover银行弹窗封装 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="el-input触发 el-popover银行弹窗封装" />
<meta property="og:description" content="样式：主要是使用 el-popover和el-tabs
html：由于业务需求，我所使用的是input作为触发组件，所以在在触发条件这里要使用自定义trigger=&#34;manual&#34;
&lt;el-popover :ref=&#34;obj.display_field&#34; :key=&#34;index&#34; placement=&#34;bottom&#34; width=&#34;500&#34; size=&#34;medium&#34; trigger=&#34;manual&#34; @show=&#34;afterEnter&#34; :popper-options=&#34;{ boundariesElement: &#39;.el-form&#39;, removeOnDestroy: true }&#34;&gt; &lt;el-input v-model=&#34;basic[obj.display_field&#43;&#39;CN&#39;]&#34; size=&#34;medium&#34; readonly=&#34;true&#34; :placeholder=&#34;&#39;请选择&#39;&#43;obj.field_name&#34; slot=&#34;reference&#34; @focus=&#34;iptFocus(obj.display_field)&#34; :title=&#34;basic[obj.display_field]&#34;&gt; &lt;template slot=&#34;&#34;&gt; &lt;span&gt;{{basic[obj.display_field&#43;index]}}&lt;/span&gt; &lt;/template&gt; &lt;/el-input&gt; &lt;template&gt; &lt;el-tabs v-model=&#34;selectBank&#34; class=&#34;select_bank_list&#34; v-if=&#34;isShow&#34;&gt; &lt;el-tab-pane label=&#34;常用&#34; name=&#34;tab1&#34;&gt; &lt;el-row&gt; &lt;el-col v-for=&#34;(item) in commonBanks&#34; :span=&#34;7&#34; style=&#34;padding: 5px&#34;&gt; &lt;a :class=&#34;&#39;BK&#39;&#43; item.def_bankcode&#34; class=&#34;bankIcon&#34;&gt;&lt;/a&gt; &lt;el-link @click=&#34;getbank(item,obj,index)&#34;&gt; &lt;span v-if=&#34;item.simp_name!=&#39;中国银行&#39;&#34;&gt;中国&lt;/span&gt;{{item.simp_name}} &lt;/el-link&gt; &lt;/el-col&gt; &lt;/el-row&gt; &lt;/el-tab-pane&gt; &lt;el-tab-pane :label=&#34;item&#34; v-for=&#34;(item) in bankCapitalName&#34; &gt; &lt;el-row v-for=&#34;(v,k) in otherBanks[item]&#34;&gt; &lt;el-row :span=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/a159e8f35201783a6e2de7697a31d97e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-06T09:56:59+08:00" />
<meta property="article:modified_time" content="2023-06-06T09:56:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">el-input触发 el-popover银行弹窗封装</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>样式：主要是使用  el-popover和el-tabs</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/d4/cd/EbHBL2Dn_o.png"></p> 
<p></p> 
<p>html：由于业务需求，我所使用的是input作为触发组件，所以在在触发条件这里要使用自定义trigger="manual"</p> 
<pre><code class="language-html">&lt;el-popover :ref="obj.display_field"
:key="index"     
placement="bottom"         
 width="500"                                                
size="medium"                                               
trigger="manual"                                              
 @show="afterEnter"                                               
:popper-options="{ boundariesElement: '.el-form', removeOnDestroy: true }"&gt;
                                            &lt;el-input v-model="basic[obj.display_field+'CN']" size="medium"
                                                      readonly="true"
                                                      :placeholder="'请选择'+obj.field_name"
                                                      slot="reference"
                                                      @focus="iptFocus(obj.display_field)"
                                                      :title="basic[obj.display_field]"&gt;
                                                &lt;template slot=""&gt;
                                                    &lt;span&gt;{<!-- -->{basic[obj.display_field+index]}}&lt;/span&gt;
                                                &lt;/template&gt;
                                            &lt;/el-input&gt;
                                            &lt;template&gt;
                                                &lt;el-tabs v-model="selectBank" class="select_bank_list" v-if="isShow"&gt;
                                                    &lt;el-tab-pane label="常用" name="tab1"&gt;
                                                        &lt;el-row&gt;
                                                            &lt;el-col v-for="(item) in commonBanks" :span="7"
                                                                    style="padding: 5px"&gt;
                                                                &lt;a :class="'BK'+ item.def_bankcode"
                                                                   class="bankIcon"&gt;&lt;/a&gt;
                                                                &lt;el-link @click="getbank(item,obj,index)"&gt;
                                                                    &lt;span v-if="item.simp_name!='中国银行'"&gt;中国&lt;/span&gt;{<!-- -->{item.simp_name}}
                                                                &lt;/el-link&gt;
                                                            &lt;/el-col&gt;
                                                        &lt;/el-row&gt;
                                                    &lt;/el-tab-pane&gt;
                                                    &lt;el-tab-pane :label="item" v-for="(item) in bankCapitalName"
                                                    &gt;
                                                        &lt;el-row v-for="(v,k) in otherBanks[item]"&gt;
                                                            &lt;el-row :span="1"&gt;{<!-- -->{k}}&lt;/el-row&gt;
                                                            &lt;el-row style="padding: 5px"&gt;
                                                                &lt;el-col v-for="b in v" :span="8"&gt;
                                                                    &lt;el-link @click.native="getbank(b,obj,index)" :title="b.simp_name"&gt;
                                                                       &lt;span style="display:inline-block;max-width: 150px; overflow: hidden; white-space: nowrap;text-overflow: ellipsis;"&gt;
                                                                            {<!-- -->{b.simp_name}}
                                                                       &lt;/span&gt;
                                                                    &lt;/el-link&gt;
                                                                &lt;/el-col&gt;
                                                            &lt;/el-row&gt;
                                                        &lt;/el-row&gt;
                                                    &lt;/el-tab-pane&gt;
                                                &lt;/el-tabs&gt;
                                            &lt;/template&gt;
                                        &lt;/el-popover&gt;</code></pre> 
<p>数据格式：一般的json格式</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/8f/49/Ro0r5B28_o.png"></p> 
<p></p> 
<p>数据处理：</p> 
<pre><code class="language-javascript">//data ：   数据            
isShow: false,          //选择银行
                // visible: false,
                selectBank: 'tab1',//某人选择的tab
                commonBanks: [],//常用银行
                otherBanks: {},//其他银行
                bankCapitalName: ['ABCDEF', 'GHJK', 'LMNPQRS', 'TWXYZ'],


//methods:数据处理
  this.banks = resp.objectMap.banks || [];
                    this.commonBanks = []

                    this.otherBanks = []
                    this.banks.forEach(item =&gt; {
                        if (item.is_hot == 1) {
                            this.commonBanks.push(item)
                        } else {
                            let bankStr = item.simp_code != undefined ? item.simp_code.split('') : [];
                            this.bankCapitalName.forEach(i =&gt; {
                                this.otherBanks[i] = {...this.otherBanks[i]}
                                if (i.indexOf(bankStr[0]) != -1) {
                                    if (this.otherBanks[i][bankStr[0]] === undefined)
                                        this.otherBanks[i][bankStr[0]] = []
                                    this.otherBanks[i][bankStr[0]].push(item)
                                }
                            })
                        }
                    })
    </code></pre> 
<p>点击空白关掉弹窗：为了做成el-select的效果，单击空白时弹出框会关闭的效果，我写了一个全局的点击事件监听器，当点击的dom不是弹出框的内容区域就调取的el-popover的关闭函数，然后使用ref拿到弹出框的dom，这里要注意，如果是通过for循环生成的弹出框，ref拿到的会是一个数组，并且想要使用contains函数，一定要是dom节点，这里就突出了ref 和 id的不同了。ref拿到的是节点对象，而id拿到的直接就是dom节点。所以要想使用contains函数，我们需要拿到ref的el属性，进行判断。</p> 
<pre><code class="language-javascript"> mounted() {
            document.addEventListener("click", this.bodyCloseMenus);
        },
        beforeDestroy() {
            document.removeEventListener('click', this.bodyCloseMenus);
        },
        methods: {
            bodyCloseMenus(event) {
              
                    let that = this
                    if (that.$refs['a8'][0]) {
                        let el = (that.$refs['a8'][0].$el == 'undefined' ? '' : that.$refs['a8'][0].$el)
                        if (!el.contains(event.target)) {
                            this.$refs['account_bank'][0].doClose()
                        }
                    }
                    if (that.$refs['a10'][0]) {
                        let el = that.$refs['a10'][0].$el == 'undefined' ? '' : that.$refs['a10'][0].$el
                        if (!el.contains(event.target)) {
                            this.$refs['account_bank2'][0].doClose()
                        }
                    }
                    if (that.$refs['a12'][0]) {
                        let el = that.$refs['a12'][0].$el == 'undefined' ? '' : that.$refs['a12'][0].$el
                        if (!el.contains(event.target)) {
                            this.$refs['account_bank3'][0].doClose()
                        }
                    }
                
            },
}</code></pre> 
<p>可能会遇到的问题：el-tabs刚打开默认的第一个选项下滑线显示不完整。如下图：<img alt="" height="115" src="https://images2.imgbox.com/9c/8b/DU9AG6K3_o.png" width="201"></p> 
<p> 原因：是因为该功能是由两个组件同时使用的，也就是el-popover嵌套着el-tabs。出现上述的问题主要原因是因为外层的el-popover的节点未加载完成，el-tabs组件就开始渲染了。</p> 
<p>解决方法：</p> 
<p>使用el-popover的after-enter方法，在该方法中在让el-tabs进行节点的渲染。el-tab可以使用v-if控制一下。</p> 
<p><img alt="" height="123" src="https://images2.imgbox.com/91/74/7WM9Xd3J_o.png" width="587"></p> 
<p> </p> 
<p><img alt="" height="326" src="https://images2.imgbox.com/1e/6f/7WyTMI3J_o.png" width="978"></p> 
<p> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/46c1d81f0a83c7e28d79ed9932f90318/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">详解Java实现坦克大战小游戏（JavaFX，完整源码&#43;注释说明）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6fe5ae59b6f5ad9df63305825d99755f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">请问一下java在线编程的网站有哪一些?</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>