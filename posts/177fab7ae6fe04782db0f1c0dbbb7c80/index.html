<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>怎么实现mysql的数据自动修改密码_MySQL数据库自动生成并修改随机root密码的脚本... - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="怎么实现mysql的数据自动修改密码_MySQL数据库自动生成并修改随机root密码的脚本..." />
<meta property="og:description" content="在MySQL数据库部署的过程中，在安装了MySQL软件，并配置了my.cnf配置文件后，需要创建MySQL实例。
MySQL 5.5实例创建完成了，默认会有登陆用户名和密码为空的用户，一般需要修改root用户密码，并删除无效用户，然后才能提供给应用使用。
这个过程可以通过shell脚本自动完成实例创建，启动，自动生成密码，修改root用户密码，删除无效用户。
shell脚本有多种编写方法，我编写的shell脚本如下：#!/bin/bash
# this scripts used to initial the mysql instance and modify password
# created by zhaofx
# MySQL software directory.
readonly SYMLINK=&#39;/usr/local/mysql&#39;
echo &#34;MySQL的软件安装目录为${SYMLINK}&#34;
# MySQL database port
readonly MYSQL_PORT=3306
echo &#34;MySQL实例的端口为${MYSQL_PORT}&#34;
# MySQL database directory.
readonly MYSQL_DATA_DIR=&#34;/data/mysql_${MYSQL_PORT}&#34;
echo &#34;MySQL的实例数据文件目录为${MYSQL_DATA_DIR}&#34;
echo &#34;准备创建MySQL实例&#34;
cd $SYMLINK
./scripts/mysql_install_db --user=mysql --basedir=/usr/local/mysql --datadir=${MYSQL_DATA_DIR}/data
echo &#34;开始启动数据库实例，修改root用户密码，删除无效用户&#34;
echo &#34;&#34;
cp /etc/my.cnf /data/mysql_${MYSQL_PORT}/my.cnf
echo &#34;Startup MySQl Service:localhost_&#34;${MYSQL_PORT}
/usr/local/mysql/bin/mysqld_safe --defaults-file=/data/mysql_${MYSQL_PORT}/my.cnf &amp;
echo &#34;&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/177fab7ae6fe04782db0f1c0dbbb7c80/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-18T19:28:10+08:00" />
<meta property="article:modified_time" content="2021-01-18T19:28:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">怎么实现mysql的数据自动修改密码_MySQL数据库自动生成并修改随机root密码的脚本...</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>在MySQL数据库部署的过程中，在安装了MySQL软件，并配置了my.cnf配置文件后，需要创建MySQL实例。</p> 
 <p>MySQL 5.5实例创建完成了，默认会有登陆用户名和密码为空的用户，一般需要修改root用户密码，并删除无效用户，然后才能提供给应用使用。</p> 
 <p>这个过程可以通过shell脚本自动完成实例创建，启动，自动生成密码，修改root用户密码，删除无效用户。</p> 
 <p>shell脚本有多种编写方法，我编写的shell脚本如下：#!/bin/bash</p> 
 <p># this scripts used to initial the mysql instance and modify password</p> 
 <p># created by zhaofx</p> 
 <p># MySQL software directory.</p> 
 <p>readonly SYMLINK='/usr/local/mysql'</p> 
 <p>echo "MySQL的软件安装目录为${SYMLINK}"</p> 
 <p># MySQL database port</p> 
 <p>readonly MYSQL_PORT=3306</p> 
 <p>echo "MySQL实例的端口为${MYSQL_PORT}"</p> 
 <p># MySQL database directory.</p> 
 <p>readonly MYSQL_DATA_DIR="/data/mysql_${MYSQL_PORT}"</p> 
 <p>echo "MySQL的实例数据文件目录为${MYSQL_DATA_DIR}"</p> 
 <p>echo "准备创建MySQL实例"</p> 
 <p>cd $SYMLINK</p> 
 <p>./scripts/mysql_install_db --user=mysql --basedir=/usr/local/mysql --datadir=${MYSQL_DATA_DIR}/data</p> 
 <p>echo "开始启动数据库实例，修改root用户密码，删除无效用户"</p> 
 <p>echo ""</p> 
 <p>cp /etc/my.cnf /data/mysql_${MYSQL_PORT}/my.cnf</p> 
 <p>echo "Startup MySQl Service:localhost_"${MYSQL_PORT}</p> 
 <p>/usr/local/mysql/bin/mysqld_safe --defaults-file=/data/mysql_${MYSQL_PORT}/my.cnf &amp;</p> 
 <p>echo ""</p> 
 <p># MySQL root password</p> 
 <p># 随机生成八位密码，作为MySQL的密码</p> 
 <p>for i in {1..10}</p> 
 <p>do</p> 
 <p>A=`head -c 500 /dev/urandom | tr -dc a-zA-Z | tr [a-z] [A-Z]|head -c 1`</p> 
 <p>B=`head -c 500 /dev/urandom | tr -dc a-z0-9A-Z | head -c 6`</p> 
 <p>C=`echo $RANDOM|cut -c 2`</p> 
 <p>echo $A$B$C &gt; /home/mysql/.password_mysql</p> 
 <p>done</p> 
 <p>readonly MYSQL_ROOT_PASS=$A$B$C</p> 
 <p>echo "MySQL实例的root用户密码已经生成"</p> 
 <p>su - mysql &lt;</p> 
 <p>/usr/local/mysql/bin/mysql -uroot -S /data/mysql_${MYSQL_PORT}/tmp/mysql.sock -e "select user,host from mysql.user;"</p> 
 <p>/usr/local/mysql/bin/mysqladmin -uroot -S /data/mysql_${MYSQL_PORT}/tmp/mysql.sock password "${MYSQL_ROOT_PASS}"</p> 
 <p>EOF</p> 
 <p>echo "MySQL的root用户密码已经修改"</p> 
 <p>echo ""</p> 
 <p>/usr/local/mysql/bin/mysql -uroot -p${MYSQL_ROOT_PASS} -S /data/mysql_${MYSQL_PORT}/tmp/mysql.sock -e "delete from mysql.user where user='';delete from mysql.user where user='root' and host!='localhost'; FLUSH PRIVILEGES;"</p> 
 <p>/usr/local/mysql/bin/mysql -uroot -p${MYSQL_ROOT_PASS} -S /data/mysql_${MYSQL_PORT}/tmp/mysql.sock -e "delete from mysql.db where db='test' or db='test\\_%'; FLUSH PRIVILEGES;"</p> 
 <p>echo "MySQL实例启动成功，初始用户环境修改完毕"</p> 
 <p>echo ""</p> 
 <p>/usr/local/mysql/bin/mysql -uroot -p${MYSQL_ROOT_PASS} -S /data/mysql_${MYSQL_PORT}/tmp/mysql.sock -e " show databases;"</p> 
 <p>/usr/local/mysql/bin/mysql -uroot -p${MYSQL_ROOT_PASS} -S /data/mysql_${MYSQL_PORT}/tmp/mysql.sock -e " select user,host from mysql.user;"</p> 
 <p>大家可以参考！</p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b9699e303bf321aacd18aae895ce281a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">yum 安装mysql的位置_centos 7 查询mysql 安装 运行位置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9dd73fe38acef059f24dd9e3f3568d6c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mysql 多个 and_如何在MySQL中处理多个AND条件？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>