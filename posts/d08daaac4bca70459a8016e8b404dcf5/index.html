<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Vue打包发布 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Vue打包发布" />
<meta property="og:description" content="打包发布 理解打包 作用：用webpack把.vue,.less.js ----&gt; 浏览器可直接执行的代码。
命令: npm run build
结果：内部集成了webpack,会在根目录下创建 /dist，在这个目录下创建打包完成的结果。
chunk:块 vendors代理商
app-hash值.js ：主入口
chunk-vendors：第三方包的代码统一放在这里（dayjs,vue,vuex,vue-router,vant）
chunk-hash值.js 某个模块对应的js ,某个.vue文件编译之后的.js。
在配置路由时，如果采用路由懒加载的方式去配置
component: () =&gt; import(’…/views/search/index.vue’)，在打包时，就会生成对应的chunk.
chunk-hash.js.map ：它会记录当前的.js文件中包含了哪个模块，对应代码位置,有利于代码出错快速找到源代码的位置。
打包结果分析 vuecli中提供一个打包分析的工具：vue-cli-service build --report
操作：在package.json 中的build项中，添加 --report
“scripts”: {
“serve”: “vue-cli-service serve”,
“build”: “vue-cli-service build –report”,
“lint”: “vue-cli-service lint”
},
运行：
npm run build
它会在dist目录下产生一个report.html文件，其中就有对打包结果的分析说明。
效果
查看导出默认配置 vuecli打包工具仍是webpack，只不过vuecli把webpack的配置封装起来了，我们不能直接看到，可通过如下命令来查看：
#导出当前生产模式下的webpack配置文件到config.json
vue inspect --mode=production &gt; config.json
Gzip压缩 网站加载的速度很大程度取决于网站资源的大小，减少要传输的文件大小可以让加载更快。
HTTP协议上的GZIP编码是一种用来改进web应用程序性能的技术。它在服务器端器安装并使用，对纯文本文件的压缩可达原大小的40%。
如何开启？
不同的服务器软件配置不一样，大多数服务器都是默认开启的。
Nginx
Tomcat
Apache
IIS" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/d08daaac4bca70459a8016e8b404dcf5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-18T14:11:17+08:00" />
<meta property="article:modified_time" content="2021-01-18T14:11:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Vue打包发布</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>打包发布</h2> 
<h3><a id="_2"></a>理解打包</h3> 
<p>作用：用webpack把.vue,.less.js ----&gt; 浏览器可直接执行的代码。</p> 
<p>命令: npm run build</p> 
<p>结果：内部集成了webpack,会在根目录下创建 /dist，在这个目录下创建打包完成的结果。</p> 
<p>chunk:块 vendors代理商</p> 
<p>app-hash值.js ：主入口</p> 
<p>chunk-vendors：第三方包的代码统一放在这里（dayjs,vue,vuex,vue-router,vant）</p> 
<p>chunk-hash值.js 某个模块对应的js ,某个.vue文件编译之后的.js。</p> 
<p>在配置路由时，如果采用路由懒加载的方式去配置</p> 
<p>component: () =&gt; import(’…/views/search/index.vue’)，在打包时，就会生成对应的chunk.</p> 
<p>chunk-hash.js.map ：它会记录当前的.js文件中包含了哪个模块，对应代码位置,有利于代码出错快速找到源代码的位置。</p> 
<h3><a id="_24"></a>打包结果分析</h3> 
<p>vuecli中提供一个打包分析的工具：vue-cli-service build --report</p> 
<p>操作：在package.json 中的build项中，添加 --report</p> 
<p>“scripts”: {<!-- --><br> “serve”: “vue-cli-service serve”,<br> “build”: “vue-cli-service build <strong>–report</strong>”,<br> “lint”: “vue-cli-service lint”<br> },<br> 运行：</p> 
<p>npm run build<br> 它会在dist目录下产生一个report.html文件，其中就有对打包结果的分析说明。</p> 
<p><img src="https://images2.imgbox.com/7e/1c/aXsRIRxK_o.png" alt="在这里插入图片描述"></p> 
<p>效果</p> 
<p><img src="https://images2.imgbox.com/e6/6b/7glqPLbY_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_48"></a>查看导出默认配置</h3> 
<p>vuecli打包工具仍是webpack，只不过vuecli把webpack的配置封装起来了，我们不能直接看到，可通过如下命令来查看：</p> 
<p>#导出当前生产模式下的webpack配置文件到config.json<br> vue inspect --mode=production &gt; config.json</p> 
<h3><a id="Gzip_55"></a>Gzip压缩</h3> 
<p><img src="https://images2.imgbox.com/38/b8/LEEJZyTQ_o.png" alt="在这里插入图片描述"></p> 
<p>网站加载的速度很大程度取决于网站资源的大小，减少要传输的文件大小可以让加载更快。</p> 
<p>HTTP协议上的GZIP编码是一种用来改进web应用程序性能的技术。它在服务器端器安装并使用，对纯文本文件的压缩可达原大小的40%。</p> 
<p>如何开启？</p> 
<p>不同的服务器软件配置不一样，大多数服务器都是默认开启的。</p> 
<p>Nginx<br> Tomcat<br> Apache<br> IIS<br> …<br> 如何判断是否开启了Gzip?</p> 
<p>Content-Encoding: gzip<br> <img src="https://images2.imgbox.com/49/c6/nNeoBQne_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_80"></a>修改打包配置</h3> 
<p>由于vuecli4集成了webpack的配置，所以可以直接在根目录下新建vue.config.js文件，其中输入内容如下：</p> 
<pre><code class="prism language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// configureWebpack 配置是vuecli中提供的一个配置项</span>
  <span class="token comment">// 用来对webpack打包做更加精细的控制</span>
  <span class="token comment">// 后面的函数中，config就是当前打包时采用的webpack配置</span>
  <span class="token comment">// 我们可以在这个函数中，对config进行修改</span>
  configureWebpack<span class="token punctuation">:</span> <span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
    config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">'development'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// https://cli.vuejs.org/zh/config/#publicpath</span>
  <span class="token comment">// 设置打包后访问资源方式，以是相对路径来访问</span>
  <span class="token comment">// dist目录下的index.html就可以直接双击打开</span>
  publicPath<span class="token punctuation">:</span> <span class="token string">'./'</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在vue.config.js 中去修改webpack的配置。</p> 
<h3><a id="_101"></a>优化打包</h3> 
<p>优化打包的目标：让打包出来的文件尽可能的小一点。</p> 
<h3><a id="vant_105"></a>vant组件中的按需导入</h3> 
<p>如果我们开发时，只用到van中一部分组件，则我们在打包时，是否需要把整个van全部打包进来？</p> 
<p>答，并不需要全部导入，只需要按需导入!</p> 
<p>共三步：</p> 
<ol><li><strong>安装依赖包</strong></li></ol> 
<p>npm i babel-plugin-import -D</p> 
<ol start="2"><li><strong>在项目根目录创建:babel.config.js</strong></li></ol> 
<pre><code class="prism language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">'import'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
      libraryName<span class="token punctuation">:</span> <span class="token string">'vant'</span><span class="token punctuation">,</span>
      libraryDirectory<span class="token punctuation">:</span> <span class="token string">'es'</span><span class="token punctuation">,</span>
      style<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'vant'</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  presets<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'@vue/cli-plugin-babel/preset'</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<ol start="3"><li>.<strong>在main.js中，只引入需要的部分</strong>。</li></ol> 
<p>创建 plugin/vant.js</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>
  Button<span class="token punctuation">,</span>
  Tabbar<span class="token punctuation">,</span>
  TabbarItem<span class="token punctuation">,</span>
  Form<span class="token punctuation">,</span>
  Field<span class="token punctuation">,</span>
  NavBar<span class="token punctuation">,</span>
  Toast<span class="token punctuation">,</span>
  Tabs<span class="token punctuation">,</span>
  Tab<span class="token punctuation">,</span>
  List<span class="token punctuation">,</span>
  Lazyload<span class="token punctuation">,</span>
  CellGroup<span class="token punctuation">,</span>
  Cell<span class="token punctuation">,</span>
  Icon<span class="token punctuation">,</span>
  Grid<span class="token punctuation">,</span>
  GridItem<span class="token punctuation">,</span>
  Popup<span class="token punctuation">,</span>
  Row<span class="token punctuation">,</span>
  Col<span class="token punctuation">,</span>
  Tag<span class="token punctuation">,</span>
  Image<span class="token punctuation">,</span>
  Divider<span class="token punctuation">,</span>
  PullRefresh<span class="token punctuation">,</span>
  ActionSheet<span class="token punctuation">,</span>
  Loading<span class="token punctuation">,</span>
  Search，
  Dialog
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vant'</span>
<span class="token comment">// Vue.use(Lazyload)</span>

<span class="token comment">// Vue.use(Vant)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Tabbar<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>TabbarItem<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Form<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Field<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>NavBar<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Toast<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Tabs<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Tab<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>List<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Lazyload<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>CellGroup<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Cell<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Icon<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Grid<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>GridItem<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Popup<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Row<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Col<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Tag<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Image<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>PullRefresh<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ActionSheet<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Divider<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Loading<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Search<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>
</code></pre> 
<p>main.js去引入plugin/vant.js</p> 
<p>再次去打包，对比观察本次打包之后chunk-vendors.js文件是否变小了。</p> 
<p>如果代码报错，说某个组件没有注册，则在上面添加就可以了。</p> 
<h3><a id="consolelog_203"></a>去掉打包后的console.log</h3> 
<p>目标：</p> 
<p>​ 在开发时可以随意写console.log，只要打包时，自动去掉它们。</p> 
<p>步骤，共两步</p> 
<ol><li><strong>安装依赖</strong></li></ol> 
<p>npm install terser-webpack-plugin --save-dev</p> 
<ol start="2"><li><strong>修改配置文件</strong></li></ol> 
<pre><code class="prism language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
 
configureWebpack<span class="token punctuation">:</span> <span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// console.log(config)</span>
    <span class="token comment">// config.mode = 'development'</span>
    <span class="token comment">// 如果当前是生产模式</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 在webpack的配置对象 config的 optimization属性的minimizer数组的第一个元素的options中设置....</span>
      <span class="token comment">// 在打包之后的js中去掉console.log</span>
     config<span class="token punctuation">.</span>optimization<span class="token punctuation">.</span>minimizer<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>terserOptions<span class="token punctuation">.</span>compress<span class="token punctuation">.</span>drop_console <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  publicPath<span class="token punctuation">:</span> <span class="token string">'./'</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>再次打包，检查打后之后的.js文件中，是否还有console的输出。</p> 
<h3><a id="webpack_234"></a>webpack排除打包</h3> 
<p>cdn是一个很好的方式，像这种xlsx,element这种功能性很全的插件，我们可以放到CDN服务器上，一来，减轻整体包的大小，二来CDN的加速服务可以加快我们对于插件的访问速度</p> 
<h5><a id="_237"></a>使用方式：</h5> 
<p>先找到 <mark>vue.config.js</mark>， 添加 <mark>externals</mark>让 <mark>webpack</mark> 不打包 <mark>xlsx 和 element</mark></p> 
<blockquote> 
 <p>vue.config.js中</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token comment">// 排除 elementUI xlsx  和 vue </span>
  externals<span class="token punctuation">:</span>
      <span class="token punctuation">{<!-- --></span>
        <span class="token string">'vue'</span><span class="token punctuation">:</span> <span class="token string">'Vue'</span><span class="token punctuation">,</span>
        <span class="token string">'element-ui'</span><span class="token punctuation">:</span> <span class="token string">'ELEMENT'</span><span class="token punctuation">,</span>
        <span class="token string">'xlsx'</span><span class="token punctuation">:</span> <span class="token string">'XLSX'</span>
     <span class="token punctuation">}</span>
</code></pre> 
<p>再次运行，我们会发现包的大小已经大幅减小</p> 
<h3><a id="CDN_252"></a>CDN文件配置</h3> 
<p>可以采用CDN的方式，在页面模板中预先引入</p> 
<blockquote> 
 <p>vue.config.js 中</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> cdn <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  css<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// element-ui css</span>
    <span class="token string">'https://unpkg.com/element-ui/lib/theme-chalk/index.css'</span> <span class="token comment">// 样式表</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  js<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// vue must at first!</span>
    <span class="token string">'https://unpkg.com/vue/dist/vue.js'</span><span class="token punctuation">,</span> <span class="token comment">// vuejs</span>
    <span class="token comment">// element-ui js</span>
    <span class="token string">'https://unpkg.com/element-ui/lib/index.js'</span><span class="token punctuation">,</span> <span class="token comment">// elementUI</span>
      <span class="token string">'https://cdn.jsdelivr.net/npm/xlsx@0.16.6/dist/jszip.min.js'</span><span class="token punctuation">,</span>
    <span class="token string">'https://cdn.jsdelivr.net/npm/xlsx@0.16.6/dist/xlsx.full.min.js'</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>注意：这时的配置实际上是对开发环境和生产环境都生效的，在开发环境时，没有必要使用CDN，此时我们可以使用环境变量来进行区分</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token keyword">let</span> cdn <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> css<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> js<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token comment">// 通过环境变量 来区分是否使用cdn</span>
<span class="token keyword">const</span> isProd <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span> <span class="token comment">// 判断是否是生产环境</span>
<span class="token keyword">let</span> externals <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>isProd<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 如果是生产环境 就排除打包 否则不排除</span>
  externals <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// key(包名) / value(这个值 是 需要在CDN中获取js, 相当于 获取的js中 的该包的全局的对象的名字)</span>
    <span class="token string">'vue'</span><span class="token punctuation">:</span> <span class="token string">'Vue'</span><span class="token punctuation">,</span> <span class="token comment">// 后面的名字不能随便起 应该是 js中的全局对象名</span>
    <span class="token string">'element-ui'</span><span class="token punctuation">:</span> <span class="token string">'ELEMENT'</span><span class="token punctuation">,</span> <span class="token comment">// 都是js中全局定义的</span>
    <span class="token string">'xlsx'</span><span class="token punctuation">:</span> <span class="token string">'XLSX'</span> <span class="token comment">// 都是js中全局定义的</span>
  <span class="token punctuation">}</span>
  cdn <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    css<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token string">'https://unpkg.com/element-ui/lib/theme-chalk/index.css'</span> <span class="token comment">// 提前引入elementUI样式</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 放置css文件目录</span>
    js<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token string">'https://unpkg.com/vue/dist/vue.js'</span><span class="token punctuation">,</span> <span class="token comment">// vuejs</span>
      <span class="token string">'https://unpkg.com/element-ui/lib/index.js'</span><span class="token punctuation">,</span> <span class="token comment">// element</span>
      <span class="token string">'https://cdn.jsdelivr.net/npm/xlsx@0.16.6/dist/xlsx.full.min.js'</span><span class="token punctuation">,</span> <span class="token comment">// xlsx 相关</span>
      <span class="token string">'https://cdn.jsdelivr.net/npm/xlsx@0.16.6/dist/jszip.min.js'</span> <span class="token comment">// xlsx 相关</span>
    <span class="token punctuation">]</span> <span class="token comment">// 放置js文件目录</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="CDN_300"></a>注入CDN文件到模板</h3> 
<blockquote> 
 <p>之后通过 <mark>html-webpack-plugin</mark> 注入到 <mark>index.html</mark> 之中:</p> 
</blockquote> 
<pre><code class="prism language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	<span class="token operator">...</span>
	<span class="token function">chainWebpack</span> <span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token comment">//  注入cdn变量</span>
    	<span class="token comment">// 这行代码 会在执行打包的时候 执行 就会将cdn变量注入到 html模板中</span>
		config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>args <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
		  <span class="token comment">// args 是注入html模板的一个变量</span>
		  args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cdn <span class="token operator">=</span> cdn <span class="token comment">// 后面的cdn就是定义的变量</span>
		  <span class="token keyword">return</span> args <span class="token comment">// 需要返回这个参数</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// configureWebpack 配置是vuecli中提供的一个配置项</span>
  	<span class="token comment">// 用来对webpack打包做更加精细的控制</span>
  	<span class="token comment">// 后面的函数中，config就是当前打包时采用的webpack配置</span>
  	<span class="token comment">// 我们可以在这个函数中，对config进行修改</span>
  	configureWebpack<span class="token punctuation">:</span> <span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'config'</span><span class="token punctuation">,</span> config<span class="token punctuation">)</span>
    	<span class="token comment">// 打包方式</span>
    	<span class="token comment">// config.mode = 'development'</span>
    	<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      		<span class="token comment">// 在webpack的配置对象 config的 optimization属性的minimizer数组的第一个元素的options中设置....</span>
      		<span class="token comment">// 在打包之后的js中去掉console.log</span>
      		config<span class="token punctuation">.</span>optimization<span class="token punctuation">.</span>minimizer<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>terserOptions<span class="token punctuation">.</span>compress<span class="token punctuation">.</span>drop_console <span class="token operator">=</span> <span class="token boolean">true</span>
    	<span class="token punctuation">}</span>
    	config<span class="token punctuation">.</span>externals <span class="token operator">=</span> externals
  	<span class="token punctuation">}</span><span class="token punctuation">,</span>
  	<span class="token comment">// 或者</span>
  	<span class="token comment">// configureWebpack: {<!-- --></span>
  		<span class="token comment">// 要排除的包名</span>
  		<span class="token comment">// key(是要排除的包名): value(实际上是实际引入的包的全局的变量名 )</span>
	  	<span class="token comment">// 因为要排除element-ui 所以后面要引入CDN文件 CDN文件中有ELEMENTUI的全局变量名</span>
  		<span class="token comment">// externals首先会排除掉 定义的包名,空出来的位置  会用变量来替换</span>
  		<span class="token comment">// externals: externals</span>
  	<span class="token comment">// },</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>找到 <mark>public/index.html</mark>。通过你配置的 <mark>CDN Config</mark> 依次注入 css 和 js。</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 引入样式 <span class="token operator">--</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> css <span class="token keyword">of</span> htmlWebpackPlugin<span class="token punctuation">.</span>options<span class="token punctuation">.</span>cdn<span class="token punctuation">.</span>css<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token operator">%</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"&lt;%=css%&gt;"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">}</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 引入<span class="token constant">JS</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> js <span class="token keyword">of</span> htmlWebpackPlugin<span class="token punctuation">.</span>options<span class="token punctuation">.</span>cdn<span class="token punctuation">.</span>js<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token operator">%</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"&lt;%=js%&gt;"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">}</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
</code></pre> 
<p>最后打包</p> 
<blockquote> 
 <p>$ npm run build</p> 
</blockquote> 
<h3><a id="gitee_356"></a>上线-gitee为例</h3> 
<h6><a id="dist_358"></a>把dist目录中的内容推到仓库中；</h6> 
<p>在gitee中开启pages服务<br> dist目录中的内容推到仓库</p> 
<ol><li>修改 .gitignore</li></ol> 
<p>把/dist从忽略文件中删除。默认情况下，git会忽略dist目录，所以它不会被上传。</p> 
<ol start="2"><li>正常提交代码</li></ol> 
<p>git add。 把代码提交到库中。</p> 
<p>git commit -a -m “你的打包信息” --no-verify</p> 
<p>由于dist目录下的js代码的格式不符合eslint的要求，所以在commit时，就会出现提交不去的情况。</p> 
<p>解决方案是：本次提交不要验证eslint。</p> 
<p>git commit -a -m “XXXX” --no-verify</p> 
<ol start="3"><li>git push</li></ol> 
<p>在gitee中开启pages服务<br> 请到你的仓库中确认dist已经上传了。<br> <img src="https://images2.imgbox.com/a1/00/kc4WRDYZ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/00/ac/KaxCjucV_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/d7/48/Yz3dCauJ_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_391"></a>如果你代码有改动</h3> 
<p>在本地：</p> 
<p>修改代码…<br> npm run build<br> git add .<br> git commit -a -m “XXXX” --no-verify<br> git push<br> 去到pages服务下：</p> 
<p>点 更新。</p> 
<h3><a id="_404"></a>有自己的服务器</h3> 
<p><img src="https://images2.imgbox.com/32/62/4Fs3RJCD_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bdae351809a026410c498d1b10b7616a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">RepVGG网络结构解读</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1824392ef67387499e34e0cea0ecdecd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mysql转sqlserver_mysql迁移sqlserver</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>