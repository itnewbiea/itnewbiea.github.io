<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MUI 页面跳转、传参与刷新 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MUI 页面跳转、传参与刷新" />
<meta property="og:description" content="MUI教程 教程地址：http://www.hcoder.net/course/info_211.html
一、页面跳转 初始化时创建子页面 mui.init({ subpages: [{ url: your - subpage - url, //子页面HTML地址，支持本地地址和网络地址 id: your - subpage - id, //子页面标志 styles: { top: subpage - top - position, //子页面顶部位置 bottom: subpage - bottom - position, //子页面底部位置 width: subpage - width, //子页面宽度，默认为100% height: subpage - height, //子页面高度，默认为100% ...... }, extras: {} //额外扩展参数 }] }); 直接打开新页面 MUI封装了自己的页面打开的方法
mui.openWindow({ url: new - page - url, id: new - page - id, styles: { top: newpage - top - position, //新页面顶部位置 bottom: newage - bottom - position, //新页面底部位置 width: newpage - width, //新页面宽度，默认为100% height: newpage - height, //新页面高度，默认为100% ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/64810a24543c87ea45e419a6a05243e1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-02-28T17:07:30+08:00" />
<meta property="article:modified_time" content="2018-02-28T17:07:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MUI 页面跳转、传参与刷新</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3 id="mui教程">MUI教程</h3> 
<blockquote> 
 <p>教程地址：<a href="http://www.hcoder.net/course/info_211.html" rel="nofollow">http://www.hcoder.net/course/info_211.html</a></p> 
</blockquote> 
<h4 id="一页面跳转">一、页面跳转</h4> 
<h6 id="初始化时创建子页面">初始化时创建子页面</h6> 
<pre class="prettyprint"><code class=" hljs objectivec">mui<span class="hljs-variable">.init</span>({  
    subpages: [{  
        url: your - subpage - url, <span class="hljs-comment">//子页面HTML地址，支持本地地址和网络地址  </span>
        <span class="hljs-keyword">id</span>: your - subpage - <span class="hljs-keyword">id</span>, <span class="hljs-comment">//子页面标志  </span>
        styles: {  
            top: subpage - top - position, <span class="hljs-comment">//子页面顶部位置  </span>
            bottom: subpage - bottom - position, <span class="hljs-comment">//子页面底部位置  </span>
            width: subpage - width, <span class="hljs-comment">//子页面宽度，默认为100%  </span>
            height: subpage - height, <span class="hljs-comment">//子页面高度，默认为100%  </span>
            ......  
        },  
        extras: {} <span class="hljs-comment">//额外扩展参数  </span>
    }]  
}); </code></pre> 
<h6 id="直接打开新页面">直接打开新页面</h6> 
<p>MUI封装了自己的页面打开的方法</p> 
<pre class="prettyprint"><code class=" hljs lasso">mui<span class="hljs-built_in">.</span>openWindow({  
    url: <span class="hljs-literal">new</span> <span class="hljs-subst">-</span> page <span class="hljs-subst">-</span> url,  
    id: <span class="hljs-literal">new</span> <span class="hljs-subst">-</span> page <span class="hljs-subst">-</span> id,  
    styles: {  
        top: newpage <span class="hljs-subst">-</span> top <span class="hljs-subst">-</span> position, <span class="hljs-comment">//新页面顶部位置  </span>
        bottom: newage <span class="hljs-subst">-</span> bottom <span class="hljs-subst">-</span> position, <span class="hljs-comment">//新页面底部位置  </span>
        width: newpage <span class="hljs-subst">-</span> width, <span class="hljs-comment">//新页面宽度，默认为100%  </span>
        height: newpage <span class="hljs-subst">-</span> height, <span class="hljs-comment">//新页面高度，默认为100%  </span>
        <span class="hljs-attribute">...</span><span class="hljs-attribute">...</span>  
    },  
    extras: {  
        <span class="hljs-attribute">...</span><span class="hljs-built_in">..</span> <span class="hljs-comment">//自定义扩展参数，可以用来处理页面间传值  </span>
    }  
    show: {  
        autoShow: <span class="hljs-literal">true</span>, <span class="hljs-comment">//页面loaded事件发生后自动显示，默认为true  </span>
        aniShow: animationType, <span class="hljs-comment">//页面显示动画，默认为”slide-in-right“；  </span>
        <span class="hljs-built_in">duration</span>: animationTime <span class="hljs-comment">//页面动画持续时间，Android平台默认100毫秒，iOS平台默认200毫秒；  </span>
    },  
    waiting: {  
        autoShow: <span class="hljs-literal">true</span>, <span class="hljs-comment">//自动显示等待框，默认为true  </span>
        title: <span class="hljs-string">'正在加载...'</span>, <span class="hljs-comment">//等待对话框上显示的提示内容  </span>
        options: {  
            width: waiting <span class="hljs-subst">-</span> dialog <span class="hljs-subst">-</span> widht, <span class="hljs-comment">//等待框背景区域宽度，默认根据内容自动计算合适宽度  </span>
            height: waiting <span class="hljs-subst">-</span> dialog <span class="hljs-subst">-</span> height, <span class="hljs-comment">//等待框背景区域高度，默认根据内容自动计算合适高度  </span>
            <span class="hljs-attribute">...</span><span class="hljs-attribute">...</span>  
        }  
    }  
})  </code></pre> 
<h6 id="预加载页面">预加载页面</h6> 
<pre class="prettyprint"><code class=" hljs objectivec"><span class="hljs-comment">// 方式1  </span>
mui<span class="hljs-variable">.init</span>({  
    preloadPages: [{  
        url: prelaod - page - url,  
        <span class="hljs-keyword">id</span>: preload - page - <span class="hljs-keyword">id</span>,  
        styles: {}, <span class="hljs-comment">//窗口参数  </span>
        extras: {}, <span class="hljs-comment">//自定义扩展参数  </span>
        subpages: [{}, {}] <span class="hljs-comment">//预加载页面的子页面  </span>
    }]  
});  

<span class="hljs-comment">// 方式2  </span>
var page = mui<span class="hljs-variable">.preload</span>({  
    url: new - page - url,  
    <span class="hljs-keyword">id</span>: new - page - <span class="hljs-keyword">id</span>, <span class="hljs-comment">//默认使用当前页面的url作为id  </span>
    styles: {}, <span class="hljs-comment">//窗口参数  </span>
    extras: {} <span class="hljs-comment">//自定义扩展参数  </span>
});  </code></pre> 
<h6 id="子页面使用场景">子页面使用场景</h6> 
<ol><li>子页面适用于侧滑菜单</li><li>子页面适用于频繁切换的情况</li><li>子页面适用于下拉刷新和上拉加载</li></ol> 
<h4 id="二页面传参">二、页面传参</h4> 
<h6 id="通过extras传参">通过extras传参</h6> 
<pre class="prettyprint"><code class=" hljs scss"><span class="hljs-comment">// 传递参数</span>
mui<span class="hljs-class">.openWindow</span>({url<span class="hljs-value">:<span class="hljs-string">'B.html'</span>,extras:{id:<span class="hljs-string">'100'</span>}});</span></code></pre> 
<p>// 接收参数</p> 
<pre class="prettyprint"><code class=" hljs php"><span class="hljs-keyword">var</span> <span class="hljs-keyword">self</span>=plus.webview.currentWebview();<span class="hljs-comment">//获取当前窗体对象</span>
<span class="hljs-keyword">var</span> receiveID=<span class="hljs-keyword">self</span>.id;<span class="hljs-comment">//接收A页面传入的id参数值</span></code></pre> 
<h6 id="通过fire传参">通过fire()传参</h6> 
<pre class="prettyprint"><code class=" hljs cs"><span class="hljs-comment">// 传递参数 ( 要触发其他页面的自定义监听事件必须要先进行页面的预加载)</span>
mui.init({
     preloadPages:[{
       id:<span class="hljs-string">'detail.html'</span>,
       url:<span class="hljs-string">'detail.html'</span>
      }]
 });
mui.fire(plus.webview.getWebviewById(<span class="hljs-string">'page-id'</span>), <span class="hljs-string">"pageRefresh"</span>,{
    name: <span class="hljs-string">'zhangsan'</span>
  })
</code></pre> 
<pre class="prettyprint"><code class=" hljs javascript"><span class="hljs-comment">//  接收参数</span>
window.addEventListener(<span class="hljs-string">"pageRefresh"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {<!-- --></span>
    <span class="hljs-comment">//获得事件参数</span>
    <span class="hljs-keyword">var</span> id = e.detail.id;
});</code></pre> 
<h4 id="三页面刷新">三、页面刷新</h4> 
<h6 id="页面切换时刷新">页面切换时刷新</h6> 
<p>webview有show事件及hide事件</p> 
<p>先创建子页面</p> 
<pre class="prettyprint"><code class=" hljs perl">            var subpages = [<span class="hljs-string">'./views/tab-webview-subpage-home.html'</span>, <span class="hljs-string">'./views/tab-webview-subpage-list.html'</span>,<span class="hljs-string">'./views/tab-webview-subpage-map.html'</span>, <span class="hljs-string">'./views/tab-webview-subpage-setting.html'</span>];
            var subpage_style = { <span class="hljs-regexp">//</span> 子页面位置调整
                top: <span class="hljs-string">'70px'</span>,
                bottom: <span class="hljs-string">'51px'</span>
            };
            var aniShow = {};

             <span class="hljs-regexp">//</span>创建子页面，首个选项卡页面显示，其它均隐藏；
            mui.plusReady(function() {
                var self = plus.webview.currentWebview();
                <span class="hljs-keyword">for</span> (var i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) {
                    var temp = {};
                    var <span class="hljs-sub"><span class="hljs-keyword">sub</span> = plus.webview.create(subpages[i], subpages[i], subpage_style);</span>
                    <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>) {
                        <span class="hljs-sub"><span class="hljs-keyword">sub</span>.hide();</span>
                    }<span class="hljs-keyword">else</span>{
                        temp[subpages[i]] = <span class="hljs-string">"true"</span>;
                        mui.extend(aniShow,temp);
                    }

                    self.append(<span class="hljs-sub"><span class="hljs-keyword">sub</span>);</span>
                }

                 plus.device.setWakelock(true);
            });</code></pre> 
<p>创建当前页的 show 监听事件。代码如下：</p> 
<pre class="prettyprint"><code class=" hljs r">        mui.plusReady(<span class="hljs-keyword">function</span>() {
            var self = plus.webview.currentWebview();
            self.addEventListener(<span class="hljs-string">'show'</span>,<span class="hljs-keyword">function</span>(){
                console.log(<span class="hljs-string">'show'</span>);
                // <span class="hljs-keyword">...</span> 后续为渲染页面代码
            });
        });</code></pre> 
<h6 id="父页面a跳转到子页面bb页面修改数据后再跳回a页面刷新a页面数">父页面A跳转到子页面B，B页面修改数据后再跳回A页面，刷新A页面数</h6> 
<pre class="prettyprint"><code class=" hljs javascript"><span class="hljs-comment">// 父页面自定义页面刷新事件 </span>
window.addEventListener(<span class="hljs-string">"pageRefresh"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {<!-- --></span>
    <span class="hljs-comment">// 重新获取数据或触发刷新</span>
});</code></pre> 
<pre class="prettyprint"><code class=" hljs cs"><span class="hljs-comment">// 子页面触发父页面的自定义页面刷新事件 </span>
mui.fire(plus.webview.getWebviewById(<span class="hljs-string">'page-id'</span>), <span class="hljs-string">"pageRefresh"</span> ); </code></pre> 
<h6 id="返回刷新">返回刷新</h6> 
<pre class="prettyprint"><code class=" hljs javascript">           mui.plusReady(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>
                <span class="hljs-keyword">var</span> old_back = mui.back;
                mui.back = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>
                    <span class="hljs-keyword">var</span> wobj = plus.webview.getWebviewById(<span class="hljs-string">"page-id"</span>); 
                    wobj.reload(<span class="hljs-literal">true</span>);
                    old_back();
                }
            });</code></pre> 
<h6 id="h5的重载方法">H5+的重载方法</h6> 
<p>在子页面初始化时，注册beforeback方法；</p> 
<pre class="prettyprint"><code class=" hljs php">mui.init({  
    beforeback: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>  
        <span class="hljs-comment">//获得列表界面的webview  </span>
        <span class="hljs-keyword">var</span> <span class="hljs-keyword">list</span> = plus.webview.currentWebview().opener();  
        <span class="hljs-comment">//触发列表界面的自定义事件（refresh）,从而进行数据刷新  </span>
        mui.fire(<span class="hljs-keyword">list</span>, <span class="hljs-string">'refresh'</span>);  
        <span class="hljs-comment">//返回true，继续页面关闭逻辑  </span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;  
    }  
});  

<span class="hljs-comment">// 或者~</span>
mui.init({
    beforeback: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{<!-- --></span>
        <span class="hljs-comment">//获得列表界面的webview</span>
        <span class="hljs-keyword">var</span> i = plus.webview.getWebviewById(<span class="hljs-string">"./views/lsit.html"</span>);
        <span class="hljs-keyword">if</span>(i){
            <span class="hljs-comment">//触发列表界面的自定义事件（refresh）,从而进行数据刷新</span>
            i.evalJS(<span class="hljs-string">"getUserInfo()"</span>);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
    }
});</code></pre> 
<p>在父页面中添加事件监听</p> 
<pre class="prettyprint"><code class=" hljs javascript">window.addEventListener(<span class="hljs-string">'refresh'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> {<!-- --></span>  
        location.reload();  
})  </code></pre> 
<p>这样，在子页面执行返回操作mui.back()的时候，会执行父页面中的refesh事件，即location.reload()，刷新父页面； <br> 官方文档说明：<a href="http://dev.dcloud.net.cn/mui/event/#customevent" rel="nofollow">http://dev.dcloud.net.cn/mui/event/#customevent</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/070a0b01c0697fd75eec5fce767b1510/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">国内大型公司，京东，携程从c &amp;.net转型java的原因有哪些？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f2c84a4b26606d63b5af83d78d64e034/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Markdown 编辑器设置字体大小颜色</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>