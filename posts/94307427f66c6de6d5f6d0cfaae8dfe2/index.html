<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>javaweb简单的图书购买系统，超详细教程 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="javaweb简单的图书购买系统，超详细教程" />
<meta property="og:description" content="项目需求：
基于MVC模式制作一个购物程序，让学生可以在网页上订购教材。该系统由3个界面组成，运行系统，出现显示所有书本的界面。在这个界面中，标题为“欢迎选购图书”；界面上显示了所有的图书和价格，在每种图书后面有一个“购买”链接。单击“购买”链接，能够显示购买界面。单击图书后面的“购买”链接显示的界面，其中数量是手工输入的。在该界面中输入购买数量，提交，能够将该图书存入购物车。在存入之后可以显示购物车中的所有内容。在每种图书后面有一个“删除”链接，单击该链接，能够将相应内容从购物车中删除。另外，单击“继续买书”链接能够重新到达显示所有书本的页面。
1.首先在index.jsp界面设置，这样进入项目时，只输入项目名后便可以直接进入项目，省略了输入项目后再选择项目名下的子目录。
&lt;jsp:forward page=&#34;InitServlet&#34;&gt;&lt;/jsp:forward&gt;
如下图所示，这样做的好处是可以固定进入项目的先后顺序。
2.index.jsp界面首先跳转到InitServlet.java界面。InitServlet.java界面实例化BookDao类中的对象，通过实例化的对象调用getAllBook()方法得到数据库中的全部数据。
package servlet; import java.io.IOException; import java.util.HashMap; import javax.servlet.ServletException; import javax.servlet.annotation.WebServlet; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import com.mysql.fabric.Response; import dao.BookDao; @WebServlet(&#34;/InitServlet&#34;) public class InitServlet extends HttpServlet{ @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { BookDao bookDao=new BookDao(); HashMap allBook=null; try { allBook=bookDao.getAllBook(); } catch (Exception e) { // TODO Auto-generated catch block e.printStackTrace(); } req.getSession().setAttribute(&#34;allBook&#34;, allBook); resp.sendRedirect(&#34;showAllBook.jsp&#34;); } } 3." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/94307427f66c6de6d5f6d0cfaae8dfe2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-16T19:42:39+08:00" />
<meta property="article:modified_time" content="2022-05-16T19:42:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">javaweb简单的图书购买系统，超详细教程</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>项目需求：</p> 
<p style="margin-left:.0001pt;text-align:justify;">基于MVC模式制作一个购物程序，让学生可以在网页上订购教材。该系统由3个界面组成，运行系统，出现显示所有书本的界面。在这个界面中，标题为“欢迎选购图书”；界面上显示了所有的图书和价格，在每种图书后面有一个“购买”链接。单击“购买”链接，能够显示购买界面。单击图书后面的“购买”链接显示的界面，其中数量是手工输入的。在该界面中输入购买数量，提交，能够将该图书存入购物车。在存入之后可以显示购物车中的所有内容。在每种图书后面有一个“删除”链接，单击该链接，能够将相应内容从购物车中删除。另外，单击“继续买书”链接能够重新到达显示所有书本的页面。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="624" src="https://images2.imgbox.com/34/1c/GI80Iq3A_o.png" width="296"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;">1.首先在index.jsp界面设置，这样进入项目时，只输入项目名后便可以直接进入项目，省略了输入项目后再选择项目名下的子目录。</p> 
<p style="margin-left:.0001pt;text-align:justify;">&lt;jsp:forward page="InitServlet"&gt;&lt;/jsp:forward&gt;</p> 
<p style="margin-left:.0001pt;text-align:justify;">如下图所示，这样做的好处是可以固定进入项目的先后顺序。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="57" src="https://images2.imgbox.com/8a/22/LcGGaK79_o.png" width="634"></p> 
<p style="margin-left:.0001pt;text-align:justify;">2.index.jsp界面首先跳转到InitServlet.java界面。InitServlet.java界面实例化BookDao类中的对象，通过实例化的对象调用getAllBook()方法得到数据库中的全部数据。</p> 
<pre><code class="language-java">package servlet;

import java.io.IOException;

import java.util.HashMap;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.mysql.fabric.Response;

import dao.BookDao;
@WebServlet("/InitServlet")
public class InitServlet extends HttpServlet{
@Override
protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
	BookDao bookDao=new BookDao();
	HashMap allBook=null;
	try {
		allBook=bookDao.getAllBook();
	} catch (Exception e) {
		// TODO Auto-generated catch block
		e.printStackTrace();
	}
	req.getSession().setAttribute("allBook", allBook);
	resp.sendRedirect("showAllBook.jsp");
}
}</code></pre> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;">3.BookDao.java类连接数据库，对数据库中的数据进行全部查找并返回查询结果，其他类就可以通过调用该类的getAllBook()方法获取全部的查询结果。</p> 
<pre><code class="language-java">package dao;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.HashMap;



import vo.Book;

public class BookDao {
	private Connection conn=null;
	private PreparedStatement ps;
	private String sql;
	private ResultSet rs;
	private Book book = null;
	private HashMap hashMap;
	
public Connection initConnection() throws Exception{
	Class.forName("com.mysql.jdbc.Driver");
	conn=(Connection) DriverManager.getConnection("jdbc:mysql://localhost:3306/access?useUnicode=true&amp;characterEncoding=utf-8","root","123456");
	return conn;
}

public HashMap getAllBook() throws Exception{
	hashMap=new HashMap();
	initConnection();
	sql="select * from T_book";
	ps=(PreparedStatement) conn.prepareStatement(sql);
	rs=ps.executeQuery();
	while(rs.next()){
		book=new Book();
		book.setBookNo(rs.getString("bookNo"));
		book.setBookName(rs.getString("bookName"));
		book.setBookPrice(rs.getFloat("bookPrice"));
		hashMap.put(book.getBookNo(), book);
	}
	closeConnection();
	return hashMap;
}

public void closeConnection() throws SQLException{
	conn.close();
}

}</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">4.BookDao类中的实例化的book对象来源于，实体类Book,该类中的属性，与数据库中的属性一一对应，代码如下</p> 
<pre><code class="language-java">package vo;

public class Book {
private String bookNo;
private String bookName;
private Float bookPrice;
private int bookNumber;
public String getBookNo() {
	return bookNo;
}
public void setBookNo(String bookNo) {
	this.bookNo = bookNo;
}
public String getBookName() {
	return bookName;
}
public void setBookName(String bookName) {
	this.bookName = bookName;
}
public Float getBookPrice() {
	return bookPrice;
}
public void setBookPrice(Float bookPrice) {
	this.bookPrice = bookPrice;
}
public int getBookNumber() {
	return bookNumber;
}
public void setBookNumber(int bookNumber) {
	this.bookNumber = bookNumber;
}
@Override
public String toString() {
	return "Book [bookNo=" + bookNo + ", bookName=" + bookName + ", bookPrice=" + bookPrice + ", bookNumber="
			+ bookNumber + "]";
}


}</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">4.1数据库中的内容如下</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="272" src="https://images2.imgbox.com/91/77/naT3hcNd_o.png" width="692"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;">5.现在回到主线，InitServlet.java界面重定向跳转到ShowAllBook.jsp界面。</p> 
<pre><code class="language-html">&lt;%@ page language="java" import="java.util.*" import="vo.Book" pageEncoding="UTF-8"%&gt;

&lt;html&gt;
  &lt;head&gt;
    
    &lt;title&gt;My JSP 'showAllBook.jsp' starting page&lt;/title&gt;
    
  &lt;/head&gt;
  
  &lt;body&gt;
    欢迎选购图书&lt;br&gt;
    &lt;%
    HashMap	allBook=(HashMap)session.getAttribute("allBook");
     %&gt;
     &lt;table border="1"&gt;
     &lt;tr bgcolor="pink"&gt;
     &lt;td&gt;书本名称&lt;/td&gt;
     &lt;td&gt;书本价格&lt;/td&gt;
     &lt;td&gt;购买&lt;/td&gt;
     &lt;/tr&gt;
     &lt;%
      Set set = allBook.keySet();
     Iterator iterator=set.iterator();
     while(iterator.hasNext()){
     String bookNo=(String)iterator.next();
     Book book=(Book)allBook.get(bookNo); 
      %&gt;
      &lt;tr bgcolor="yellow"&gt;
      &lt;td&gt;&lt;%=book.getBookName()%&gt;&lt;/td&gt;
      &lt;td&gt;&lt;%=book.getBookPrice() %&gt;&lt;/td&gt;
      &lt;td&gt;&lt;a href="buyForm.jsp?bookNo=&lt;%=book.getBookNo() %&gt;"&gt;购买&lt;/a&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;%
      }
       %&gt;
     &lt;/table&gt;
     &lt;a href="showCart.jsp"&gt;查看购物车&lt;/a&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="300" src="https://images2.imgbox.com/e8/32/rKQcrGPF_o.png" width="339"></p> 
<p> 6..当点击购买连接时，跳转到buyForm.jsp，代码如下</p> 
<pre><code class="language-html">&lt;%@ page language="java" import="java.util.*" import="vo.Book" pageEncoding="UTF-8"%&gt;

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;My JSP 'buyForm.jsp' starting page&lt;/title&gt;
  &lt;/head&gt;

  &lt;body&gt;
  &lt;%
  String bookNo=request.getParameter("bookNo");
  HashMap allBook=(HashMap)session.getAttribute("allBook");
  Book book=(Book)allBook.get(bookNo);
//  System.out.println("buyForm.jsp测试是够从HashMap中取到了一个对象的数据"+book);//测试是够从HashMap中取到了一个对象的数据
  session.setAttribute("buyBook", book);
   %&gt;
    欢迎购买：&lt;%=book.getBookName() %&gt;
    &lt;form action="AddServlet" method="post"&gt;
    书本价格：&lt;%=book.getBookPrice() %&gt;&lt;br&gt;
    数量：&lt;input type="text" name="bookNumber"&gt;
    &lt;input type="submit" value="购买" &gt;
    &lt;/form&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="145" src="https://images2.imgbox.com/e5/fa/GQXTybjQ_o.png" width="378"></p> 
<p> 7.点击购买按键时，把数据提交到AddServlet.java界面，该界面获取购买的物品并进行判断，（注意：这里所说的第一次和第二次是同一个对象，也就是购买同一个商品）第一次购买时，直接存入HashMap的books对象中，第二次购买时，先获取第一次添加对象，把第一次添加的数量加上第二次添加的数量,把相加结果重新传给该对象的数量属性，再把该对象添加到books集合中，代码如下</p> 
<pre><code class="language-java">package servlet;

import java.io.IOException;
import java.util.HashMap;

import javax.jms.Session;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import vo.Book;
@WebServlet("/AddServlet")
public class AddServlet extends HttpServlet{
@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
	req.setCharacterEncoding("utf-8");
	Book buyBook=(Book)req.getSession().getAttribute("buyBook");
	String bookNumber=req.getParameter("bookNumber");
	int bookIntNumber=Integer.parseInt(bookNumber);
	
	
//	System.out.println("测试bookIntNumber是否为空："+bookIntNumber);

	HashMap books=(HashMap)req.getSession().getAttribute("books");
//	System.out.println("测试books是否为空："+books);
//	System.out.println("测试bookNo的值："+buyBook.getBookNo());
	if(!books.containsKey(buyBook.getBookNo())){
	buyBook.setBookNumber(bookIntNumber);
	//System.out.println("AddServlet测试是否取到了名称为buyBook的session对象"+buyBook);//测试是否取到了名称为buyBook的session对象
	books.put(buyBook.getBookNo(), buyBook);
	}else {
		Book book=(Book)books.get(buyBook.getBookNo());
		//System.out.println("测试book对象的数量："+book.getBookNumber());
		 int bookIntNumber1=book.getBookNumber()+bookIntNumber;
		buyBook.setBookNumber(bookIntNumber1);
		books.put(buyBook.getBookNo(), buyBook);
	}
	//总钱数增加
	Float money=(Float)req.getSession().getAttribute("money");
	System.out.println("测试money:"+money);
	System.out.println("测试(Float)buyBook.getBookPrice():"+(Float)buyBook.getBookPrice());
	System.out.println("测试bookIntNumber:"+bookIntNumber);
	money=money+(Float)buyBook.getBookPrice()*bookIntNumber;
	System.out.println("AddServlet测试计算是否正确"+money);//测试计算是否正确
	req.getSession().setAttribute("money", money);
	resp.sendRedirect("showCart.jsp");
}
}
</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">8.AddServlet.java重定向到showCart.jsp界面，代码如下</p> 
<pre><code class="language-html">&lt;%@ page language="java" import="java.util.*" import="vo.Book" pageEncoding="UTF-8"%&gt;

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html&gt;
  &lt;head&gt;  
    &lt;title&gt;My JSP 'showCart.jsp' starting page&lt;/title&gt;
  &lt;/head&gt;
  
  &lt;body&gt;
    &lt;table border="1" &gt;
    &lt;tr bgcolor="pink"&gt;
    &lt;td&gt;书本名称&lt;/td&gt;
    &lt;td&gt;书本价格&lt;/td&gt;
    &lt;td&gt;数量&lt;/td&gt;
    &lt;td&gt;删除&lt;/td&gt;
    &lt;/tr&gt;
    &lt;%
    HashMap books=(HashMap)session.getAttribute("books");
    Set set=books.keySet();
    System.out.println("在showCart.jsp页面测试keySet()会变成什么值："+set);//测试keySet()会变成什么值
    Iterator iterator=set.iterator();
    while(iterator.hasNext()){
    String bookNo=(String)iterator.next();
    Book book=(Book)books.get(bookNo);
    
     %&gt;
    &lt;tr bgcolor="yellow"&gt;
    &lt;td&gt;&lt;%=book.getBookName()%&gt;&lt;/td&gt;
    &lt;td&gt;&lt;%=book.getBookPrice() %&gt;&lt;/td&gt;
    &lt;td&gt;&lt;%=book.getBookNumber() %&gt;&lt;/td&gt;
    &lt;td&gt;&lt;a href="RemoveServlet?bookNo=&lt;%=book.getBookNo() %&gt;"&gt;删除&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;%
    }
     %&gt;
    &lt;/table&gt;
    现金总额：&lt;%=session.getAttribute("money") %&gt;&lt;hr&gt;
    &lt;a href="showAllBook.jsp"&gt;继续买书&lt;/a&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre> 
<p><img alt="" height="155" src="https://images2.imgbox.com/03/09/x0Aj51Ru_o.png" width="370"></p> 
<p>9.点击继续购买，跳回showAllBook.jsp界面，继续选择购买JAVA书，当然也可以购买其他书，当前主要展示重复购买JAVA书本，是否运行正确。 </p> 
<p><img alt="" height="172" src="https://images2.imgbox.com/5c/4f/sLNigyQq_o.png" width="345"></p> 
<p><img alt="" height="222" src="https://images2.imgbox.com/a8/34/r9USZYZw_o.png" width="395"></p> 
<p> 10.当点击删除时，跳转到RemoveServlet.java界面，对当前这条数据全部删除。总金额自动变化。代码如下</p> 
<p></p> 
<pre><code class="language-java">package servlet;

import java.io.IOException;
import java.util.HashMap;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import vo.Book;
@WebServlet("/RemoveServlet")
public class RemoveServlet extends HttpServlet{
	//测试一下dopost()是否可以接收a标签传过来的数值
@Override
protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
	req.setCharacterEncoding("utf-8");
	String bookNo=req.getParameter("bookNo");
	HashMap books=(HashMap)req.getSession().getAttribute("books");
	Book book=(Book)books.get(bookNo);
	System.out.print("测试删除时，获取过来的删除数是："+book.getBookNumber());
	Float money=(Float)req.getSession().getAttribute("money");
	money=money-book.getBookPrice()*book.getBookNumber();
	req.getSession().setAttribute("money", money);
	books.remove(bookNo);
	resp.sendRedirect("showCart.jsp");
}
@Override
	protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
	
	}
}</code></pre> 
<p><img alt="" height="214" src="https://images2.imgbox.com/50/75/bwu62si3_o.png" width="427"></p> 
<p>全部删除，金额为0 </p> 
<p><img alt="" height="177" src="https://images2.imgbox.com/61/01/B9KCOLmi_o.png" width="416"></p> 
<p> 11.设置session监听器，会在项目开始时自动运行，创建session。</p> 
<pre><code class="language-java">package listener;

import java.util.ArrayList;
import java.util.HashMap;

import javax.servlet.annotation.WebListener;
import javax.servlet.http.HttpSession;
import javax.servlet.http.HttpSessionEvent;
import javax.servlet.http.HttpSessionListener;
@WebListener
public class SessionListener implements HttpSessionListener {

	@Override
	public void sessionCreated(HttpSessionEvent se) {
		HttpSession session=se.getSession();
		HashMap books=new HashMap();
		ArrayList list=new ArrayList();
		System.out.println("测试list初始化的值："+list);
		System.out.println("测试books初始化时的值："+books);
		session.setAttribute("books", books);
		session.setAttribute("money", 0F);
	}

	@Override
	public void sessionDestroyed(HttpSessionEvent se) {
		// TODO Auto-generated method stub
		
	}

}</code></pre> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/98f9ddfa766a50e7be941792f1533395/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">入门激光雷达点云的3D目标检测</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b9b93cc67e08d454cbcf3231e9e5ed55/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Ubuntu18.04：gnutls_handshake() failed: Error in the pull function.</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>