<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>关于下载模版下载附件 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="关于下载模版下载附件" />
<meta property="og:description" content="方法一
//点击方法 async downloadTemplateBtn() { // 调用下载模板的API，获取到文件的数据和状态码 const { data, code } = await downloadTemplate(this.code); if (code !== 200) return; // 获取到文件的URL this.templateUrl = data.fileIdDesc[0].url; // 创建XMLHttpRequest对象 const xhr = new XMLHttpRequest(); xhr.open(&#34;GET&#34;, this.templateUrl, true); xhr.setRequestHeader(&#34;Content-type&#34;, &#34;application/x-www-form-urlencoded&#34;); xhr.responseType = &#34;blob&#34;; // 在下载完成后的回调函数中执行文件下载 xhr.onload = function () { if (this.status === 200) { // 创建一个URL对象 const url = window.URL.createObjectURL(this.response); // 创建一个隐藏的&lt;a&gt;元素，设置其href和download属性 const link = document.createElement(&#34;a&#34;); link.href = url; link.download = data." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/4747782c68e32b1e6cd0601fa36cb577/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-18T11:03:37+08:00" />
<meta property="article:modified_time" content="2023-09-18T11:03:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">关于下载模版下载附件</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>方法一</p> 
<pre><code class="hljs">//点击方法
async downloadTemplateBtn() {
      // 调用下载模板的API，获取到文件的数据和状态码
      const { data, code } = await downloadTemplate(this.code);
      
      if (code !== 200) return;
      // 获取到文件的URL
      this.templateUrl = data.fileIdDesc[0].url;
      // 创建XMLHttpRequest对象
      const xhr = new XMLHttpRequest();
      xhr.open("GET", this.templateUrl, true);
      xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
      xhr.responseType = "blob";
      // 在下载完成后的回调函数中执行文件下载
      xhr.onload = function () {
        if (this.status === 200) {
          // 创建一个URL对象
          const url = window.URL.createObjectURL(this.response);
          // 创建一个隐藏的&lt;a&gt;元素，设置其href和download属性
          const link = document.createElement("a");
          link.href = url;
          link.download = data.codeDesc + ".xlsx"; // 文件名
          // 设置样式为隐藏，并添加到DOM中
          link.style.display = "none";
          document.body.appendChild(link);
          // 模拟点击下载链接
          link.click();
          // 下载完成后移除&lt;a&gt;元素，并释放URL对象
          document.body.removeChild(link);
          window.URL.revokeObjectURL(url);
        }
      };
      // 发送XMLHttpRequest请求，开始下载文件
      xhr.send();
    },</code></pre> 
<p>方法二</p> 
<pre><code class="hljs">// 文件下载
    DownloadEviField(id) {
      if (!id) {
        return;
      }
      const loading = this.$loading({
        lock: true,
        text: "请求下载中...",
        spinner: "el-icon-loading",
        background: "rgba(0, 0, 0, 0.7)",
      });
      FileDetail(id).then((res) =&gt; {
        if (res.code === 200) {
          window.open(res.data[0].url);
          loading.close();
        }
      });
    },</code></pre> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7eb93ff1f4a2c04bc2eac256304cfb2e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Context.getExternalFilesDir()方法与返回的路径对照表</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/082b349e07e440580019863899356433/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">文件上传xslx</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>