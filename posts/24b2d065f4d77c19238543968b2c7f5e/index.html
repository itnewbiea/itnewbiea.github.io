<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>i.MX6ULL - Ubuntu 18.04.05 LTS根文件系统移植教程 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="i.MX6ULL - Ubuntu 18.04.05 LTS根文件系统移植教程" />
<meta property="og:description" content="i.MX6ULL - Ubuntu 18.04.05 LTS根文件系统移植教程 目录 i.MX6ULL - Ubuntu 18.04.05 LTS根文件系统移植教程1、根文件系统配置及测试3、SSH远程登录测试2、samba与windows数据互传测试4、如何将开发板设置为静态IP地址 1、根文件系统配置及测试 根文件系统的移植很简单的，ubuntu官方已经帮我们做好了，可以下载下来直接时候，但是这个根文件系统太过于精简(例如连ifconfig都没法使用)，一些常用的工具都没有，所以我们还需要自己简单的配置一下才行。
ubuntu-base文件系统下载地址：http://cdimage.ubuntu.com/ubuntu-base/releases/
注：以下操作均在root下进行！
安装运行模拟器：
sudo apt install qemu-user-static 创建用于ubuntu-base根文件系统目录，并解压到该文件夹：
mkdir /ubuntu-18.04.5-lts-rootfs tar xvf ubuntu-base-18.04.5-base-armhf.tar.gz -C /ubuntu-18.04.5-lts-rootfs cd /ubuntu-18.04.5-lts-rootfs 拷贝CPU架构为ARM的模拟器到根文件系统：
sudo cp /usr/bin/qemu-arm-static ./usr/bin/ 拷贝主机下的DNS配置文件，没有这个文件的话我们无法使用apt-get下载软件：
sudo cp /etc/resolv.conf ./etc/resolv.conf 添加源，打开sources.list这个文件，在这个文件最后追加中科大源：
vi etc/apt/sources.list 添加：
deb http://mirrors.ustc.edu.cn/ubuntu-ports/ xenial main multiverse restricted universe deb http://mirrors.ustc.edu.cn/ubuntu-ports/ xenial-backports main multiverse restricted universe deb http://mirrors.ustc.edu.cn/ubuntu-ports/ xenial-proposed main multiverse restricted universe deb http://mirrors.ustc.edu.cn/ubuntu-ports/ xenial-security main multiverse restricted universe deb http://mirrors." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/24b2d065f4d77c19238543968b2c7f5e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-25T22:04:45+08:00" />
<meta property="article:modified_time" content="2022-09-25T22:04:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">i.MX6ULL - Ubuntu 18.04.05 LTS根文件系统移植教程</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="iMX6ULL__Ubuntu_180405_LTS_0"></a>i.MX6ULL - Ubuntu 18.04.05 LTS根文件系统移植教程</h2> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#iMX6ULL__Ubuntu_180405_LTS_0" rel="nofollow">i.MX6ULL - Ubuntu 18.04.05 LTS根文件系统移植教程</a></li><li><ul><li><ul><li><a href="#1_8" rel="nofollow">1、根文件系统配置及测试</a></li><li><a href="#3SSH_153" rel="nofollow">3、SSH远程登录测试</a></li><li><a href="#2sambawindows_166" rel="nofollow">2、samba与windows数据互传测试</a></li><li><a href="#4IP_172" rel="nofollow">4、如何将开发板设置为静态IP地址</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h4><a id="1_8"></a>1、根文件系统配置及测试</h4> 
<p>根文件系统的移植很简单的，ubuntu官方已经帮我们做好了，可以下载下来直接时候，但是这个根文件系统太过于精简(例如连ifconfig都没法使用)，一些常用的工具都没有，所以我们还需要自己简单的配置一下才行。</p> 
<p>ubuntu-base文件系统下载地址：<a href="http://cdimage.ubuntu.com/ubuntu-base/releases/" rel="nofollow">http://cdimage.ubuntu.com/ubuntu-base/releases/</a></p> 
<p><img src="https://images2.imgbox.com/23/58/4qJHRUyy_o.png" alt=""></p> 
<p><strong>注：以下操作均在root下进行！</strong></p> 
<p>安装运行模拟器：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> qemu-user-static
</code></pre> 
<p>创建用于ubuntu-base根文件系统目录，并解压到该文件夹：</p> 
<pre><code class="prism language-bash"><span class="token function">mkdir</span> /ubuntu-18.04.5-lts-rootfs
<span class="token function">tar</span> xvf ubuntu-base-18.04.5-base-armhf.tar.gz -C /ubuntu-18.04.5-lts-rootfs
<span class="token builtin class-name">cd</span> /ubuntu-18.04.5-lts-rootfs
</code></pre> 
<p>拷贝CPU架构为ARM的模拟器到根文件系统：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">cp</span> /usr/bin/qemu-arm-static ./usr/bin/
</code></pre> 
<p>拷贝主机下的DNS配置文件，没有这个文件的话我们无法使用apt-get下载软件：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">cp</span> /etc/resolv.conf ./etc/resolv.conf
</code></pre> 
<p>添加源，打开<code>sources.list</code>这个文件，在这个文件最后<strong>追加</strong>中科大源：</p> 
<pre><code class="prism language-bash"><span class="token function">vi</span> etc/apt/sources.list
</code></pre> 
<p>添加：</p> 
<pre><code>deb http://mirrors.ustc.edu.cn/ubuntu-ports/ xenial main multiverse restricted universe 
deb http://mirrors.ustc.edu.cn/ubuntu-ports/ xenial-backports main multiverse restricted universe 
deb http://mirrors.ustc.edu.cn/ubuntu-ports/ xenial-proposed main multiverse restricted universe 
deb http://mirrors.ustc.edu.cn/ubuntu-ports/ xenial-security main multiverse restricted universe 
deb http://mirrors.ustc.edu.cn/ubuntu-ports/ xenial-updates main multiverse restricted universe 
deb-src http://mirrors.ustc.edu.cn/ubuntu-ports/ xenial main multiverse restricted universe 
deb-src http://mirrors.ustc.edu.cn/ubuntu-ports/ xenial-backports main multiverse restricted universe 
deb-src http://mirrors.ustc.edu.cn/ubuntu-ports/ xenial-proposed main multiverse restricted universe 
deb-src http://mirrors.ustc.edu.cn/ubuntu-ports/ xenial-security main multiverse restricted universe 
deb-src http://mirrors.ustc.edu.cn/ubuntu-ports/ xenial-updates main multiverse restricted universe 
</code></pre> 
<p>在主机上挂载ubuntu-base文件系统，因为我们还需要下载一些常用工具，需要挂载的目录和文件有<code>proc、sys、dev、dev/pts</code>这四个，挂载之后使用<code>chroot</code>将主机的根文件系统切换成我们现在配置的ubuntu-base文件系统，操作命令如下：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">mount</span> -t proc /proc ./proc
<span class="token function">sudo</span> <span class="token function">mount</span> -t sysfs /sysfs ./sys
<span class="token function">sudo</span> <span class="token function">mount</span> -o <span class="token builtin class-name">bind</span> /dev ./dev
<span class="token function">sudo</span> <span class="token function">mount</span> -o <span class="token builtin class-name">bind</span> /dev/pts ./dev/pts
<span class="token function">sudo</span> <span class="token function">chroot</span> ./
</code></pre> 
<p>安装常用软件工具：</p> 
<pre><code class="prism language-bash"><span class="token function">apt-get</span> update
<span class="token function">apt-get</span> <span class="token function">install</span> -y <span class="token function">sudo</span> <span class="token function">vim</span> kmod net-tools <span class="token function">ethtool</span> ifupdown language-pack-en-base rsyslog <span class="token function">htop</span> iputils-ping dosfstools systemd
</code></pre> 
<p><em>注意：ubuntu18必须安装systemd，否则没有串口设备文件</em></p> 
<p>安装samba（可选）：见博客：<a href="https://blog.csdn.net/qq153471503/article/details/79221047">https://blog.csdn.net/qq153471503/article/details/79221047</a></p> 
<p>安装ssh（可选）：见博客：<a href="https://blog.csdn.net/qq153471503/article/details/79221199">https://blog.csdn.net/qq153471503/article/details/79221199</a></p> 
<p>设置root密码：</p> 
<pre><code class="prism language-bash"><span class="token function">passwd</span> root
</code></pre> 
<p>设置主机名称：</p> 
<pre><code>echo "imx6ull" &gt; /etc/hostname
echo "127.0.0.1 localhost" &gt;&gt; /etc/hosts
echo "127.0.0.1 imx6ull" &gt;&gt; /etc/hosts
</code></pre> 
<p><em>其中<code>imx6ull</code>是主机名称，改成你要设置的即可。</em></p> 
<p>设置串口终端：以串口1为例，它的设备文件名称为ttymxc0，所以使用ln命令创建一个软链接文件指向<code>/lib/systemd/system/getty@.service</code>：</p> 
<pre><code class="prism language-bash"><span class="token function">ln</span> -s /lib/systemd/system/getty@.service /etc/systemd/system/getty.target.wants/getty@ttymxc0.service
</code></pre> 
<p>还配置网络自启，ubuntu-base根文件系统开机后默认网卡是没启动的。</p> 
<p>我的板子支持双网口，这里以网口1(也就是eth0)示例：</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> auto eth0 <span class="token operator">&gt;</span> /etc/network/interfaces.d/eth0
<span class="token builtin class-name">echo</span> iface eth0 inet dhcp <span class="token operator">&gt;&gt;</span> /etc/network/interfaces.d/eth0
</code></pre> 
<p>（可选）如果你有网口2，那么在设置网口2(eth1)的配置：</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> auto eth1 <span class="token operator">&gt;</span> /etc/network/interfaces.d/eth1
<span class="token builtin class-name">echo</span> iface eth1 inet dhcp <span class="token operator">&gt;&gt;</span> /etc/network/interfaces.d/eth1
</code></pre> 
<p>最后，退出当前文件系统，取消挂载<code>proc、sys、dev、dev/pts</code>这四个目录和文件：</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">exit</span> 
<span class="token function">sudo</span> <span class="token function">umount</span> ./proc
<span class="token function">sudo</span> <span class="token function">umount</span> ./sys
<span class="token function">sudo</span> <span class="token function">umount</span> ./dev/pts
<span class="token function">sudo</span> <span class="token function">umount</span> ./dev
</code></pre> 
<p>此时ubuntu-base根文件系统就配置完了，使用NFS挂载一下试试：</p> 
<p><img src="https://images2.imgbox.com/bf/c4/aojKQAeN_o.png" alt=""></p> 
<p>成功！</p> 
<p>打包文件系统用于MfgTool工具烧写，进入ubuntu-base根文件系统目录：</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> /ubuntu-18.04.5-lts-rootfs
</code></pre> 
<p>打包：</p> 
<pre><code class="prism language-bash"><span class="token function">tar</span> -vcjf ubuntu-18.04.5-lts-rootfs.tar.bz2 ./*
</code></pre> 
<p>然后就可以将<code>ubuntu-18.04.5-lts-rootfs.tar.bz2</code>使用 MfgTool 工具将 ubuntu 根文件系统烧写到开发板的EMMC或<br> NAND中了。</p> 
<hr> 
<h4><a id="3SSH_153"></a>3、SSH远程登录测试</h4> 
<p>我使用的是mobaxtrem这个软件：</p> 
<p><img src="https://images2.imgbox.com/9e/ec/G9fZRdQc_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/0b/63/5EZ3turO_o.png" alt=""></p> 
<p>没问题！</p> 
<hr> 
<h4><a id="2sambawindows_166"></a>2、samba与windows数据互传测试</h4> 
<p><img src="https://images2.imgbox.com/dd/2b/Am2XnGSi_o.png" alt=""></p> 
<hr> 
<h4><a id="4IP_172"></a>4、如何将开发板设置为静态IP地址</h4> 
<p>系统开机的时候出现：</p> 
<pre><code class="prism language-bash">A start job is running <span class="token keyword">for</span> Raise network interface（5min 13s ）
</code></pre> 
<p>这是因为如果开发板开机的时候没有插网线，或者网络配置的不对，系统默认开机检测网络的超时时间是5分钟，这太长了！所以我们改为3s：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/systemd/system/network-online.target.wants/networking.service
</code></pre> 
<p>将里面的<code>TimeoutStartSec=5min</code>修改为<code>TimeoutStartSec=3sec</code>，重启系统即可！</p> 
<p><strong>开发板静态IP地址设置：</strong></p> 
<pre><code class="prism language-bash"><span class="token function">vim</span> /etc/network/interfaces.d/eth0
</code></pre> 
<p>改为：</p> 
<pre><code class="prism language-bash">auto eth0
<span class="token comment">#iface eth0 inet dhcp</span>
iface eth0 inet static
address <span class="token number">192.168</span>.28.234
netmask <span class="token number">255.255</span>.255.0
gateway <span class="token number">192.168</span>.28.1
boardcast <span class="token number">192.168</span>.28.255
</code></pre> 
<pre><code class="prism language-bash"><span class="token function">vim</span> /etc/network/interfaces.d/eth1
</code></pre> 
<p>改为：</p> 
<pre><code class="prism language-bash">auto eth1
<span class="token comment">#iface eth1 inet dhcp</span>
iface eth1 inet static
address <span class="token number">192.168</span>.28.235
netmask <span class="token number">255.255</span>.255.0
gateway <span class="token number">192.168</span>.28.1
boardcast <span class="token number">192.168</span>.28.255
</code></pre> 
<p><strong>！！重要！！</strong></p> 
<p>还需要配置DNS！否则无法访问外网，当你<code>ping www.baidu.com</code> 的时候，会出现以下错误：</p> 
<pre><code class="prism language-bash">Temporary failure <span class="token keyword">in</span> name resolution
</code></pre> 
<p>Q：为什么使用DHCP动态获取IP地址的时候不需要设置DNS?</p> 
<p>A：因为DHCP自动获取了！</p> 
<p><strong>网上的增加DNS的方法：</strong></p> 
<p>方法①：修改<code>/etc/resolv.conf</code>文件，增加<code>nameserver 114.114.114.114</code>，固然可行，但是重启开发板之后该文件又恢复默认了！所以此方法在我这里失败！</p> 
<p>方法②：在<code>/etc/network/interfaces.d/eth0</code>文件中加入<code>dns-nameservers 8.8.8.8.8 114.114.114.114</code>，试过了，失败！</p> 
<p>方法③：</p> 
<p>以上两个办法都失败了，遂又仔细研究了之后，发现<code>/etc/resolv.conf</code>有软链接，说明这是一个运行时文件，所以手动修改没有用，重启还是会恢复默认：</p> 
<p><img src="https://images2.imgbox.com/32/e4/egtJFR4r_o.png" alt=""></p> 
<p>打开该文件中有注释：man systemd-resolved.service</p> 
<p>所以这个文件是由<code>systemd</code>工具所管理的，而<code>systemd</code>工具的配置是在<code>/etc/systemd</code>目录下，进入这个文件夹：</p> 
<p><img src="https://images2.imgbox.com/ee/94/LoQfB4kv_o.png" alt=""></p> 
<p>有一个<code>resolved.conf</code>文件，猜测该文件就是DNS的配置文件，里面的内容都被屏蔽了，所以我们开启DNS的配置：</p> 
<p><img src="https://images2.imgbox.com/40/5a/wJRxfKfh_o.png" alt=""></p> 
<p>重启系统即可！</p> 
<p>在查看一下<code>/run/systemd/resolve/resolv.conf</code>文件，可以看到我们添加的DNS已经被写入该文件：</p> 
<p><img src="https://images2.imgbox.com/41/70/bsQPyXFY_o.png" alt=""></p> 
<p>附上成功ping百度的截图：</p> 
<p><img src="https://images2.imgbox.com/54/04/EuhHbWDt_o.png" alt=""></p> 
<hr> 
<p>ends…</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dbd899d2bea8a79b42af289390b48403/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Vue组件间通信（消息订阅与发布）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cc5fe81681a604939710a50717d2b508/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">springboot整合mybatis-plus代码生成器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>