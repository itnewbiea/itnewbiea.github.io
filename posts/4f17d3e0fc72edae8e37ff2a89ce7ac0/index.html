<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>UE5 中 LiveLink 的开发全流程教程 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="UE5 中 LiveLink 的开发全流程教程" />
<meta property="og:description" content="注意，需要有源代码版本的 Unreal Engine，而不是从游戏 Launcher 中下载的 Unreal 版本。
本文使用是 Unreal Engine 5.1 版本。关于一些基础 API 介绍，可以参考之前的一篇。
起点 可以将 Engine\Source\Programs\BlankProgram 作为模板拷贝一份，然后重新命名（可以使用文本编辑器进行全局替换之类的），这里命名成 CircleLiveLinkProvider，作为 Program 的起点。
使用 GenerateProjectFiles 刷新项目，这样新的 Program 就会出现在 UE 的工程中。
// CircleLiveLinkProvider.cpp #include &#34;CircleLiveLinkProvider.h&#34; #include &#34;RequiredProgramMainCPPInclude.h&#34; DEFINE_LOG_CATEGORY_STATIC(LogCircleLiveLinkProvider, Log, All); IMPLEMENT_APPLICATION(CircleLiveLinkProvider, &#34;CircleLiveLinkProvider&#34;); INT32_MAIN_INT32_ARGC_TCHAR_ARGV() { GEngineLoop.PreInit(ArgC, ArgV); UE_LOG(LogCircleLiveLinkProvider, Display, TEXT(&#34;Hello World&#34;)); FEngineLoop::AppExit(); return 0; } 编译一下，在 Engine\Binaries\Win64（应该是对应平台下，我用的是 Windows，所以是在 Win64）文件夹下，会有对应编译好的可执行文件。
脱离引擎 如果想让程序独立引擎进行运行，需要使用和 Unreal 源码组织结构相同的目录层次结构。如果这时候你把生成的 .exe 拷贝出来运行，是会出现警告的，会提示没有游戏配置和引擎配置。
LogPaths: Warning: No paths for game localization data were specifed in the game configuration." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/4f17d3e0fc72edae8e37ff2a89ce7ac0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-04T15:47:46+08:00" />
<meta property="article:modified_time" content="2022-12-04T15:47:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">UE5 中 LiveLink 的开发全流程教程</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>注意，需要有源代码版本的 Unreal Engine，而不是从游戏 Launcher 中下载的 Unreal 版本。</p> 
</blockquote> 
<p>本文使用是 Unreal Engine 5.1 版本。关于一些基础 API 介绍，可以参考之前的<a href="https://gu.ink/2022/ue-livelink-dev-01/" rel="nofollow">一篇</a>。</p> 
<h3><a id="_5"></a>起点</h3> 
<p>可以将 <code>Engine\Source\Programs\BlankProgram</code> 作为模板拷贝一份，然后重新命名（可以使用文本编辑器进行全局替换之类的），这里命名成 <code>CircleLiveLinkProvider</code>，作为 Program 的起点。</p> 
<p>使用 <code>GenerateProjectFiles</code> 刷新项目，这样新的 Program 就会出现在 UE 的工程中。</p> 
<pre><code class="prism language-cpp"><span class="token comment">// CircleLiveLinkProvider.cpp</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"CircleLiveLinkProvider.h"</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"RequiredProgramMainCPPInclude.h"</span></span>

<span class="token function">DEFINE_LOG_CATEGORY_STATIC</span><span class="token punctuation">(</span>LogCircleLiveLinkProvider<span class="token punctuation">,</span> Log<span class="token punctuation">,</span> All<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">IMPLEMENT_APPLICATION</span><span class="token punctuation">(</span>CircleLiveLinkProvider<span class="token punctuation">,</span> <span class="token string">"CircleLiveLinkProvider"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">INT32_MAIN_INT32_ARGC_TCHAR_ARGV</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	GEngineLoop<span class="token punctuation">.</span><span class="token function">PreInit</span><span class="token punctuation">(</span>ArgC<span class="token punctuation">,</span> ArgV<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">UE_LOG</span><span class="token punctuation">(</span>LogCircleLiveLinkProvider<span class="token punctuation">,</span> Display<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"Hello World"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">FEngineLoop</span><span class="token double-colon punctuation">::</span><span class="token function">AppExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>编译一下，在 <code>Engine\Binaries\Win64</code>（应该是对应平台下，我用的是 Windows，所以是在 Win64）文件夹下，会有对应编译好的可执行文件。</p> 
<h4><a id="_33"></a>脱离引擎</h4> 
<p>如果想让程序独立引擎进行运行，需要使用和 Unreal 源码组织结构相同的目录层次结构。如果这时候你把生成的 .exe 拷贝出来运行，是会出现警告的，会提示没有游戏配置和引擎配置。</p> 
<pre><code>LogPaths: Warning: No paths for game localization data were specifed in the game configuration.
LogInit: Warning: No paths for engine localization data were specifed in the engine configuration.
LogCircleLiveLinkProvider: Display: Hello World
</code></pre> 
<p>但是如果在 <code>Engine\Binaries\Win64</code> 文件夹下进行运行（也就是程序生成的目录），并不会出现这种问题。</p> 
<blockquote> 
 <p>这种裸 exe 其实是会有一些副作用的，比如我的电脑上，运行之后，会在 <code>C:\Engine</code> 中生成日志文件。</p> 
</blockquote> 
<p>要想真正独立运行，我们需要把 .exe，放入到一个 <strong>伪装</strong> 的 Engine 下面。我们按照 <code>Engine\Binaries\Win64</code> 创建文件夹，并把引擎 Engine.和游戏配置拷贝出来。</p> 
<pre><code>CircleLiveLinkProvider
└─Engine
    ├─Binaries
    │  └─Win64
    │          CircleLiveLinkProvider.exe
    │          CircleLiveLinkProvider.pdb
    │
    └─Config
            Base.ini
            BaseEngine.ini
            BaseGame.ini
</code></pre> 
<p>这样这个 Program 就可以独立运行了。运行程序之后，会发现自动在 <code>Engine</code> 文件夹中生成了 <code>Programs</code> 和 <code>Saved</code></p> 
<pre><code>└─Engine
    ├─Binaries
    │  └─Win64
    │          CircleLiveLinkProvider.exe
    │          CircleLiveLinkProvider.pdb
    │
    ├─Config
    │      Base.ini
    │      BaseEngine.ini
    │      BaseGame.ini
    │
    ├─Programs
    │  └─CircleLiveLinkProvider
    │      └─Saved
    │          ├─Config
    │          │  ├─CrashReportClient
    │          │  │  └─UECC-Windows-69032E0743138D60D19DF9BAA8B91E3E
    │          │  │          CrashReportClient.ini
    │          │  │
    │          │  └─WindowsEditor
    │          │          Engine.ini
    │          │          Game.ini
    │          │
    │          └─Logs
    │                  CircleLiveLinkProvider.log
    │
    └─Saved
        └─Config
            └─WindowsEditor
                    Manifest.ini
</code></pre> 
<p>可以看到，日志就会出现在我们创建的文件夹中，而不会出现在系统默认（缺省）的执行路径中。</p> 
<h3><a id="Buildcs_99"></a>Build.cs</h3> 
<p>引入 LiveLink 所需的依赖，LiveLink 默认依赖 Udp，所以需要引入 <code>Messaging</code> 和 <code>UdpMessaging</code>。</p> 
<pre><code class="prism language-csharp"><span class="token comment">// Copyright Epic Games, Inc. All Rights Reserved.</span>

<span class="token keyword">using</span> <span class="token namespace">UnrealBuildTool</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CircleLiveLinkProvider</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ModuleRules</span></span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">public</span> <span class="token function">CircleLiveLinkProvider</span><span class="token punctuation">(</span><span class="token class-name">ReadOnlyTargetRules</span> Target<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span>Target<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		PublicIncludePaths<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"Runtime/Launch/Public"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		PrivateIncludePaths<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"Runtime/Launch/Private"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// For LaunchEngineLoop.cpp include</span>

		PrivateDependencyModuleNames<span class="token punctuation">.</span><span class="token function">AddRange</span><span class="token punctuation">(</span><span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token string">"Core"</span><span class="token punctuation">,</span>
			<span class="token string">"CoreUObject"</span><span class="token punctuation">,</span>
			<span class="token string">"Projects"</span><span class="token punctuation">,</span>
			<span class="token string">"LiveLinkMessageBusFramework"</span><span class="token punctuation">,</span>
			<span class="token string">"LiveLinkInterface"</span><span class="token punctuation">,</span>
			<span class="token string">"Messaging"</span><span class="token punctuation">,</span>
			<span class="token string">"UdpMessaging"</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="Targetcs_130"></a>Target.cs</h3> 
<pre><code class="prism language-csharp"><span class="token comment">// Copyright Epic Games, Inc. All Rights Reserved.</span>

<span class="token keyword">using</span> <span class="token namespace">UnrealBuildTool</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">SupportedPlatforms</span><span class="token attribute-arguments"><span class="token punctuation">(</span>UnrealPlatformClass<span class="token punctuation">.</span>All<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CircleLiveLinkProviderTarget</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">TargetRules</span></span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">public</span> <span class="token function">CircleLiveLinkProviderTarget</span><span class="token punctuation">(</span><span class="token class-name">TargetInfo</span> Target<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span>Target<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		Type <span class="token operator">=</span> TargetType<span class="token punctuation">.</span>Program<span class="token punctuation">;</span>
		IncludeOrderVersion <span class="token operator">=</span> EngineIncludeOrderVersion<span class="token punctuation">.</span>Latest<span class="token punctuation">;</span>
		LinkType <span class="token operator">=</span> TargetLinkType<span class="token punctuation">.</span>Monolithic<span class="token punctuation">;</span>
		LaunchModuleName <span class="token operator">=</span> <span class="token string">"CircleLiveLinkProvider"</span><span class="token punctuation">;</span>

		<span class="token comment">// Lean and mean</span>
		bBuildDeveloperTools <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

		<span class="token comment">// Never use malloc profiling in Unreal Header Tool.  We set this because often UHT is compiled right before the engine</span>
		<span class="token comment">// automatically by Unreal Build Tool, but if bUseMallocProfiler is defined, UHT can operate incorrectly.</span>
		bUseMallocProfiler <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

		<span class="token comment">// Editor-only is enabled for desktop platforms to run unit tests that depend on editor-only data</span>
		<span class="token comment">// It's disabled in test and shipping configs to make profiling similar to the game</span>
		<span class="token class-name"><span class="token keyword">bool</span></span> bDebugOrDevelopment <span class="token operator">=</span> Target<span class="token punctuation">.</span>Configuration <span class="token operator">==</span> UnrealTargetConfiguration<span class="token punctuation">.</span>Debug <span class="token operator">||</span> Target<span class="token punctuation">.</span>Configuration <span class="token operator">==</span> UnrealTargetConfiguration<span class="token punctuation">.</span>Development<span class="token punctuation">;</span>
		bBuildWithEditorOnlyData <span class="token operator">=</span> Target<span class="token punctuation">.</span>Platform<span class="token punctuation">.</span><span class="token function">IsInGroup</span><span class="token punctuation">(</span>UnrealPlatformGroup<span class="token punctuation">.</span>Desktop<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> bDebugOrDevelopment<span class="token punctuation">;</span>

		<span class="token comment">// Currently this app is not linking against the engine, so we'll compile out references from Core to the rest of the engine</span>
		bCompileAgainstEngine <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
		bCompileAgainstCoreUObject <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// !! 注意这里</span>
		bCompileAgainstApplicationCore <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
		bCompileICU <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

		<span class="token comment">// UnrealHeaderTool is a console application, not a Windows app (sets entry point to main(), instead of WinMain())</span>
		bIsBuildingConsoleApplication <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="LiveLink_Demo__174"></a>LiveLink Demo 的实现</h3> 
<p>在源码文件夹下创建两个文件，<code>LiveLinkCore.h</code> 和 <code>LiveLinkCore.cpp</code>，然后重新运行 <code>GenerateProjectFiles</code> 刷新项目的工程文件。</p> 
<pre><code class="prism language-cpp"><span class="token comment">// LiveLinkCore.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"CoreMinimal.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Misc/FrameRate.h"</span></span>

<span class="token keyword">struct</span> <span class="token class-name">ILiveLinkProvider</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">FLiveLinkProviderCoreInitArgs</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">FLiveLinkProviderCoreInitArgs</span><span class="token punctuation">(</span>int32 Argc<span class="token punctuation">,</span> TCHAR<span class="token operator">*</span> ArgV<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	FFrameRate Framerate <span class="token operator">=</span> <span class="token function">FFrameRate</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	FString SourceName<span class="token punctuation">{<!-- --></span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"CircleLiveLinkProvider"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">CIRCLELIVELINKPROVIDER_API</span> LiveLinkCore
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">explicit</span> <span class="token function">LiveLinkCore</span><span class="token punctuation">(</span><span class="token keyword">const</span> FLiveLinkProviderCoreInitArgs<span class="token operator">&amp;</span> InitArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	int32 <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">~</span><span class="token function">LiveLinkCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">StartProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">Tick</span><span class="token punctuation">(</span><span class="token keyword">float</span> DeltaTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">StopProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">double</span> FrameTime<span class="token punctuation">;</span>
	FLiveLinkProviderCoreInitArgs InitArgs<span class="token punctuation">;</span>
	TSharedPtr<span class="token operator">&lt;</span>ILiveLinkProvider<span class="token operator">&gt;</span> LiveLinkProvider<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>因为我们不想在这里就引入 LiveLink 的头文件，所以使用了前向声明 <code>struct ILiveLinkProvider;</code>。</p> 
<p>程序的大体结构设计就是 <code>FLiveLinkProviderCoreInitArgs</code> 负责解析命令行参数，然后将他注入到 <code>LiveLinkCore</code> 中，之后程序逻辑由 <code>LiveLinkCore</code> 负责。</p> 
<h4><a id="_219"></a>命令行参数解析</h4> 
<pre><code class="prism language-cpp"><span class="token comment">// LiveLinkCore.cpp</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"LiveLinkCore.h"</span></span>

<span class="token function">DEFINE_LOG_CATEGORY_STATIC</span><span class="token punctuation">(</span>LogCircleLiveLinkProviderCore<span class="token punctuation">,</span> Log<span class="token punctuation">,</span> All<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">FLiveLinkProviderCoreInitArgs</span><span class="token double-colon punctuation">::</span><span class="token function">FLiveLinkProviderCoreInitArgs</span><span class="token punctuation">(</span><span class="token keyword">const</span> int32 ArgC<span class="token punctuation">,</span> TCHAR<span class="token operator">*</span> ArgV<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">const</span> FString CmdLine <span class="token operator">=</span> <span class="token class-name">FCommandLine</span><span class="token double-colon punctuation">::</span><span class="token function">BuildFromArgV</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span> ArgC<span class="token punctuation">,</span> ArgV<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">FCommandLine</span><span class="token double-colon punctuation">::</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token operator">*</span>CmdLine<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>FString Value<span class="token punctuation">;</span> <span class="token class-name">FParse</span><span class="token double-colon punctuation">::</span><span class="token function">Value</span><span class="token punctuation">(</span><span class="token operator">*</span>CmdLine<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"-Framerate="</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Value<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token class-name">FParse</span><span class="token double-colon punctuation">::</span><span class="token function">Value</span><span class="token punctuation">(</span><span class="token operator">*</span>Value<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"Numerator="</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Framerate<span class="token punctuation">.</span>Numerator<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">FParse</span><span class="token double-colon punctuation">::</span><span class="token function">Value</span><span class="token punctuation">(</span><span class="token operator">*</span>Value<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"Denominator="</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Framerate<span class="token punctuation">.</span>Denominator<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token class-name">FParse</span><span class="token double-colon punctuation">::</span><span class="token function">Value</span><span class="token punctuation">(</span><span class="token operator">*</span>CmdLine<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"-SourceName="</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SourceName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>Framerate.Numerator</code> 是分母，<code>Framerate.Denominator</code> 是分子，<code>Framerate.Numerator</code> 为 60，<code>Framerate.Denominator</code> 为 1，就是 60 帧 1s。</p> 
<p>使用非常简单，在头文件中包含该头文件：</p> 
<pre><code class="prism language-cpp"><span class="token comment">// CircleLiveLinkProvider.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"CoreMinimal.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"LiveLinkCore.h"</span></span>
</code></pre> 
<pre><code class="prism language-cpp"><span class="token comment">// ...</span>
<span class="token function">INT32_MAIN_INT32_ARGC_TCHAR_ARGV</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	int32 Result <span class="token operator">=</span> GEngineLoop<span class="token punctuation">.</span><span class="token function">PreInit</span><span class="token punctuation">(</span>ArgC<span class="token punctuation">,</span> ArgV<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">" -messaging"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">check</span><span class="token punctuation">(</span>Result <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">check</span><span class="token punctuation">(</span>GConfig <span class="token operator">&amp;&amp;</span> GConfig<span class="token operator">-&gt;</span><span class="token function">IsReadyForUse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	FLiveLinkProviderCoreInitArgs <span class="token function">LoopInitArgs</span><span class="token punctuation">(</span>ArgC<span class="token punctuation">,</span> ArgV<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token class-name">FEngineLoop</span><span class="token double-colon punctuation">::</span><span class="token function">AppExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> Result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>游戏内不会默认启用UDP消息传递。可以通过在打包好的游戏（ <strong>不支持发布目标</strong> ）内添加 -messaging 来启用它。<a href="https://docs.unrealengine.com/5.1/zh-CN/live-link-in-unreal-engine/" rel="nofollow">文档</a></p> 
</blockquote> 
<h4><a id="_271"></a>核心逻辑</h4> 
<p>构造函数和析构函数：</p> 
<pre><code class="prism language-cpp"><span class="token class-name">LiveLinkCore</span><span class="token double-colon punctuation">::</span><span class="token function">LiveLinkCore</span><span class="token punctuation">(</span><span class="token keyword">const</span> FLiveLinkProviderCoreInitArgs<span class="token operator">&amp;</span> InitArgs<span class="token punctuation">)</span><span class="token operator">:</span>
	<span class="token function">FrameTime</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">InitArgs</span><span class="token punctuation">(</span>InitArgs<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>

<span class="token class-name">LiveLinkCore</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">LiveLinkCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">LiveLinkCore</span><span class="token double-colon punctuation">::</span><span class="token function">StartProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	LiveLinkProvider <span class="token operator">=</span> <span class="token class-name">ILiveLinkProvider</span><span class="token double-colon punctuation">::</span><span class="token function">CreateLiveLinkProvider</span><span class="token punctuation">(</span>InitArgs<span class="token punctuation">.</span>SourceName<span class="token punctuation">)</span><span class="token punctuation">;</span>
	FLiveLinkStaticDataStruct StaticData <span class="token operator">=</span> <span class="token function">FLiveLinkStaticDataStruct</span><span class="token punctuation">(</span><span class="token class-name">FLiveLinkTransformStaticData</span><span class="token double-colon punctuation">::</span><span class="token function">StaticStruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	FLiveLinkTransformStaticData<span class="token operator">&amp;</span> TransformStaticData <span class="token operator">=</span> <span class="token operator">*</span>StaticData<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">Cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>FLiveLinkTransformStaticData<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	TransformStaticData<span class="token punctuation">.</span>PropertyNames<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"Cosine"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	TransformStaticData<span class="token punctuation">.</span>PropertyNames<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"Sinine"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	LiveLinkProvider<span class="token operator">-&gt;</span><span class="token function">UpdateSubjectStaticData</span><span class="token punctuation">(</span><span class="token operator">*</span>InitArgs<span class="token punctuation">.</span>SourceName<span class="token punctuation">,</span> <span class="token class-name">ULiveLinkTransformRole</span><span class="token double-colon punctuation">::</span><span class="token function">StaticClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">MoveTemp</span><span class="token punctuation">(</span>StaticData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">LiveLinkCore</span><span class="token double-colon punctuation">::</span><span class="token function">StopProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	LiveLinkProvider<span class="token operator">-&gt;</span><span class="token function">RemoveSubject</span><span class="token punctuation">(</span><span class="token operator">*</span>InitArgs<span class="token punctuation">.</span>SourceName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>加载模块：</p> 
<pre><code class="prism language-cpp"><span class="token function">INT32_MAIN_INT32_ARGC_TCHAR_ARGV</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	int32 Result <span class="token operator">=</span> GEngineLoop<span class="token punctuation">.</span><span class="token function">PreInit</span><span class="token punctuation">(</span>ArgC<span class="token punctuation">,</span> ArgV<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">" -messaging"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">check</span><span class="token punctuation">(</span>Result <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">check</span><span class="token punctuation">(</span>GConfig <span class="token operator">&amp;&amp;</span> GConfig<span class="token operator">-&gt;</span><span class="token function">IsReadyForUse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">ProcessNewlyLoadedUObjects</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token class-name">FModuleManager</span><span class="token double-colon punctuation">::</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">StartProcessingNewlyLoadedObjects</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">FModuleManager</span><span class="token double-colon punctuation">::</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">LoadModuleChecked</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"UdpMessaging"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token class-name">FPlatformMisc</span><span class="token double-colon punctuation">::</span><span class="token function">SetGracefulTerminationHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	FLiveLinkProviderCoreInitArgs <span class="token function">LoopInitArgs</span><span class="token punctuation">(</span>ArgC<span class="token punctuation">,</span> ArgV<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token class-name">FEngineLoop</span><span class="token double-colon punctuation">::</span><span class="token function">AppPreExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">FModuleManager</span><span class="token double-colon punctuation">::</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">UnloadModulesAtShutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">FEngineLoop</span><span class="token double-colon punctuation">::</span><span class="token function">AppExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> Result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>主循环：</p> 
<pre><code class="prism language-cpp">
int32 <span class="token class-name">LiveLinkCore</span><span class="token double-colon punctuation">::</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">checkf</span><span class="token punctuation">(</span>InitArgs<span class="token punctuation">.</span>Framerate<span class="token punctuation">.</span><span class="token function">AsInterval</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"IdealFramerate must be greater than zero!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">checkf</span><span class="token punctuation">(</span><span class="token operator">!</span>InitArgs<span class="token punctuation">.</span>SourceName<span class="token punctuation">.</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"Source name cannot be empty!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">double</span> DeltaTime <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
	FrameTime <span class="token operator">=</span> <span class="token class-name">FPlatformTime</span><span class="token double-colon punctuation">::</span><span class="token function">Seconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">float</span> IdealFrameTime <span class="token operator">=</span> InitArgs<span class="token punctuation">.</span>Framerate<span class="token punctuation">.</span><span class="token function">AsInterval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">StartProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsEngineExitRequested</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">Tick</span><span class="token punctuation">(</span>DeltaTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">FTaskGraphInterface</span><span class="token double-colon punctuation">::</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ProcessThreadUntilIdle</span><span class="token punctuation">(</span>ENamedThreads<span class="token double-colon punctuation">::</span>GameThread<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">FTSTicker</span><span class="token double-colon punctuation">::</span><span class="token function">GetCoreTicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Tick</span><span class="token punctuation">(</span>DeltaTime<span class="token punctuation">)</span><span class="token punctuation">;</span>

		GFrameCounter<span class="token operator">++</span><span class="token punctuation">;</span>

		<span class="token function">IncrementalPurgeGarbage</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> FMath<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">Max</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">0.002f</span><span class="token punctuation">,</span> IdealFrameTime <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">FPlatformTime</span><span class="token double-colon punctuation">::</span><span class="token function">Seconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> FrameTime<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">FPlatformProcess</span><span class="token double-colon punctuation">::</span><span class="token function">Sleep</span><span class="token punctuation">(</span>FMath<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">Max</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">0.0f</span><span class="token punctuation">,</span> IdealFrameTime <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token class-name">FPlatformTime</span><span class="token double-colon punctuation">::</span><span class="token function">Seconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> FrameTime<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">const</span> <span class="token keyword">double</span> CurrentTime <span class="token operator">=</span> <span class="token class-name">FPlatformTime</span><span class="token double-colon punctuation">::</span><span class="token function">Seconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		DeltaTime <span class="token operator">=</span> CurrentTime <span class="token operator">-</span> FrameTime<span class="token punctuation">;</span>
		FrameTime <span class="token operator">=</span> CurrentTime<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">StopProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">UE_LOG</span><span class="token punctuation">(</span>LogCircleLiveLinkProviderCore<span class="token punctuation">,</span> Display<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"%s Shutdown"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span>InitArgs<span class="token punctuation">.</span>SourceName<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token class-name">FTaskGraphInterface</span><span class="token double-colon punctuation">::</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ProcessThreadUntilIdle</span><span class="token punctuation">(</span>ENamedThreads<span class="token double-colon punctuation">::</span>GameThread<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>帧数据：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">LiveLinkCore</span><span class="token double-colon punctuation">::</span><span class="token function">Tick</span><span class="token punctuation">(</span><span class="token keyword">float</span> DeltaTime<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	FLiveLinkFrameDataStruct FrameDataStruct <span class="token operator">=</span> <span class="token function">FLiveLinkFrameDataStruct</span><span class="token punctuation">(</span><span class="token class-name">FLiveLinkTransformFrameData</span><span class="token double-colon punctuation">::</span><span class="token function">StaticStruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	FLiveLinkTransformFrameData<span class="token operator">&amp;</span> TransformFrameData <span class="token operator">=</span> <span class="token operator">*</span>FrameDataStruct<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">Cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>FLiveLinkTransformFrameData<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">const</span> <span class="token keyword">float</span> Radians <span class="token operator">=</span> FMath<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">DegreesToRadians</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>GFrameCounter <span class="token operator">%</span> <span class="token number">360</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">float</span> CosValue <span class="token operator">=</span> <span class="token class-name">FMath</span><span class="token double-colon punctuation">::</span><span class="token function">Cos</span><span class="token punctuation">(</span>Radians<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">float</span> SinValue <span class="token operator">=</span> <span class="token class-name">FMath</span><span class="token double-colon punctuation">::</span><span class="token function">Sin</span><span class="token punctuation">(</span>Radians<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> ScaleFactor <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>

	TransformFrameData<span class="token punctuation">.</span>Transform<span class="token punctuation">.</span><span class="token function">SetLocation</span><span class="token punctuation">(</span><span class="token function">FVector</span><span class="token punctuation">(</span>ScaleFactor <span class="token operator">*</span> CosValue<span class="token punctuation">,</span> ScaleFactor <span class="token operator">*</span> SinValue<span class="token punctuation">,</span> ScaleFactor<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	TransformFrameData<span class="token punctuation">.</span>PropertyValues<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>CosValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
	TransformFrameData<span class="token punctuation">.</span>PropertyValues<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>SinValue<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>GFrameCounter <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">UE_LOG</span><span class="token punctuation">(</span>LogCircleLiveLinkProviderCore<span class="token punctuation">,</span> Display<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"(%d) - Cosine: %f Sine: %f"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> GFrameCounter<span class="token punctuation">,</span> CosValue<span class="token punctuation">,</span> SinValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>


	TransformFrameData<span class="token punctuation">.</span>WorldTime <span class="token operator">=</span> FrameTime<span class="token punctuation">;</span>
	<span class="token keyword">const</span> FTimecode EngineTimeCode <span class="token operator">=</span> <span class="token function">FTimecode</span><span class="token punctuation">(</span>FrameTime<span class="token punctuation">,</span> InitArgs<span class="token punctuation">.</span>Framerate<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	TransformFrameData<span class="token punctuation">.</span>MetaData<span class="token punctuation">.</span>SceneTime <span class="token operator">=</span> <span class="token function">FQualifiedFrameTime</span><span class="token punctuation">(</span>EngineTimeCode<span class="token punctuation">,</span> InitArgs<span class="token punctuation">.</span>Framerate<span class="token punctuation">)</span><span class="token punctuation">;</span>

	LiveLinkProvider<span class="token operator">-&gt;</span><span class="token function">UpdateSubjectFrameData</span><span class="token punctuation">(</span><span class="token operator">*</span>InitArgs<span class="token punctuation">.</span>SourceName<span class="token punctuation">,</span> <span class="token function">MoveTemp</span><span class="token punctuation">(</span>FrameDataStruct<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_401"></a>最终效果</h3> 
<pre><code>LogCircleLiveLinkProviderCore: Display: (0) - Cosine: 1.000000 Sine: 0.000000
LogCircleLiveLinkProviderCore: Display: (100) - Cosine: -0.173648 Sine: 0.984808
LogCircleLiveLinkProviderCore: Display: (200) - Cosine: -0.939693 Sine: -0.342020
LogCircleLiveLinkProviderCore: Display: (300) - Cosine: 0.500000 Sine: -0.866025
LogCore: Warning: *** INTERRUPTED *** : SHUTTING DOWN
LogCore: Warning: *** INTERRUPTED *** : CTRL-C TO FORCE QUIT
LogCircleLiveLinkProviderCore: Display: CircleLiveLinkProvider Shutdown
</code></pre> 
<p>可以看到退出的时候并不是暴力退出，而是有一段优雅退出的过程。</p> 
<h3><a id="_415"></a>游戏内使用</h3> 
<p>在游戏中勾选上 LiveLink 插件，重启编辑器</p> 
<p><img src="https://images2.imgbox.com/5b/bb/qfGlyLYV_o.png" alt="在这里插入图片描述"></p> 
<p>在编辑器内可以看到消息：</p> 
<p><img src="https://images2.imgbox.com/ad/f2/CfH7Klxy_o.png" alt="在这里插入图片描述"></p> 
<p>新建一个 Actor，添加一个 <code>LiveLinkComponentController</code>，选择主题。可以看到编辑器里的 Cube 在做圆周运动了。</p> 
<p><img src="https://images2.imgbox.com/d6/b2/yMPpSpSq_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_432"></a>打包</h3> 
<p>要在打包后的游戏中使用 LiveLink，需要保存预设，并且在游戏启动的时候引入预设。</p> 
<p><img src="https://images2.imgbox.com/a6/9a/BLLxQNM6_o.png" alt="在这里插入图片描述"></p> 
<p>新建一个变量，设置为我们保存的预设：</p> 
<p><img src="https://images2.imgbox.com/c9/56/veSBrYCN_o.png" alt="在这里插入图片描述"></p> 
<p>启动的时候应用该预设，</p> 
<p><img src="https://images2.imgbox.com/9b/84/9tybDAAE_o.png" alt="在这里插入图片描述"></p> 
<p>项目设置中，设置为默认预设：</p> 
<p><code>在这里插入代码片</code><img src="https://images2.imgbox.com/85/cc/kfViMuZC_o.png" alt="在这里插入图片描述"></p> 
<p>这样就可以打包，但在启动的时候需要加上 <code>-messaging</code>。</p> 
<h3><a id="_456"></a>小结</h3> 
<p>本文只是介绍一下基于 Unreal 的 Program 程序的开发，Unreal 某种意义上是一个平台，支持使用内部的 API 进行定制开发。当然，目前用的还是内置的数据结构，没有自定义数据结构，而且还有一点点关于如何从蓝图中获取和处理数据的部分没有涉及。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/012a3d7cd37bb2aa856d3f9dcffed665/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C语言学习之关键字解读</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/325d246a1547cacc1f6d2c34d143d48e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">VSCode 返回上一个光标 (上一个浏览位置) 前进/返回</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>