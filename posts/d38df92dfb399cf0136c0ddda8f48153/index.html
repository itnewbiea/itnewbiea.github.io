<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>大数据从入门到精通(超详细版)之Yarn的使用，安装与部署 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="大数据从入门到精通(超详细版)之Yarn的使用，安装与部署" />
<meta property="og:description" content="前言 嗨，各位小伙伴，恭喜大家学习到这里，不知道关于大数据前面的知识遗忘程度怎么样了，又或者是对大数据后面的知识是否感兴趣，本文是《大数据从入门到精通（超详细版）》的一部分，小伙伴们如果对此感谢兴趣的话，推荐大家按照大数据学习路径开始学习哦。
以下就是完整的学习路径哦。
↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓
大数据从入门到精通文章体系！！！！！！！！！！！！！！
↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑
推荐大家认真学习哦！！！
文章目录 前言大致的资源分配流程Yarn的架构Yarn容器Web应用代理概念独立部署的步骤 Yarn的历史服务器Yarn的部署部署总体说明集群规划配置过程mapreduce的配置配置mapred-env.sh文件配置mapred-site.xml文件 Yarn的配置配置yarn-env.sh配置yarn-site.xml文件把这些配置文件分发到其他节点的服务器 集群的启动命令MapReduce的在Yarn中的执行Yarn可以执行的程序wordCount程序实例 Yarn是什么" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/d38df92dfb399cf0136c0ddda8f48153/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-05T21:33:10+08:00" />
<meta property="article:modified_time" content="2023-09-05T21:33:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">大数据从入门到精通(超详细版)之Yarn的使用，安装与部署</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>前言</h2> 
<p>嗨，各位小伙伴，恭喜大家学习到这里，不知道关于大数据前面的知识遗忘程度怎么样了，又或者是对大数据后面的知识是否感兴趣，本文是<code>《大数据从入门到精通（超详细版）》</code>的一部分，小伙伴们如果对此感谢兴趣的话，推荐大家按照大数据学习路径开始学习哦。</p> 
<p>以下就是完整的学习路径哦。</p> 
<p> ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓</p> 
<p><strong><a href="https://blog.csdn.net/tyuiop321/article/details/132678470?spm=1001.2014.3001.5501">大数据从入门到精通文章体系！！！！！！！！！！！！！！</a></strong></p> 
<p> ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑</p> 
<p>推荐大家认真学习哦！！！</p> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_0" rel="nofollow">前言</a></li><li><a href="#_38" rel="nofollow">大致的资源分配流程</a></li><li><a href="#Yarn_43" rel="nofollow">Yarn的架构</a></li><li><a href="#Yarn_54" rel="nofollow">Yarn容器</a></li><li><a href="#Web_58" rel="nofollow">Web应用代理</a></li><li><ul><li><a href="#_60" rel="nofollow">概念</a></li><li><a href="#_73" rel="nofollow">独立部署的步骤</a></li></ul> 
  </li><li><a href="#Yarn_82" rel="nofollow">Yarn的历史服务器</a></li><li><a href="#Yarn_108" rel="nofollow">Yarn的部署</a></li><li><ul><li><a href="#_110" rel="nofollow">部署总体说明</a></li><li><a href="#_118" rel="nofollow">集群规划</a></li><li><a href="#_123" rel="nofollow">配置过程</a></li><li><a href="#mapreduce_125" rel="nofollow">mapreduce的配置</a></li><li><ul><li><a href="#mapredenvsh_129" rel="nofollow">配置mapred-env.sh文件</a></li><li><a href="#mapredsitexml_143" rel="nofollow">配置mapred-site.xml文件</a></li></ul> 
   </li><li><a href="#Yarn_189" rel="nofollow">Yarn的配置</a></li><li><ul><li><a href="#yarnenvsh_191" rel="nofollow">配置yarn-env.sh</a></li><li><a href="#yarnsitexml_204" rel="nofollow">配置yarn-site.xml文件</a></li><li><a href="#_275" rel="nofollow">把这些配置文件分发到其他节点的服务器</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_283" rel="nofollow">集群的启动命令</a></li><li><a href="#MapReduceYarn_320" rel="nofollow">MapReduce的在Yarn中的执行</a></li><li><ul><li><a href="#Yarn_322" rel="nofollow">Yarn可以执行的程序</a></li><li><a href="#wordCount_328" rel="nofollow">wordCount程序实例</a></li></ul> 
 </li></ul> 
</div> 
<br> 
<img src="https://images2.imgbox.com/93/2e/uvxK7ZgS_o.png" alt="在这里插入图片描述"> 
<p></p> 
<p>Yarn是什么</p> 
<p>Hadoop YARN（Yet Another Resource Negotiator）是 Hadoop 生态系统中的一个核心组件，用于集群资源的管理和任务调度。<strong><mark>YARN 的目标是为大规模分布式计算提供统一的资源管理框架，使得 Hadoop 除了支持 MapReduce 之外，还能够运行其他计算模型。</mark></strong></p> 
<p>YARN 的主要功能包括：</p> 
<ol><li>资源调度：YARN 管理着集群中的各种资源（如 CPU、内存等），根据不同应用的需求，动态地分配和调度这些资源。</li><li>任务协调和调度：YARN 提供了一个全局的资源调度器，可以将不同类型的任务（如 MapReduce、Spark、Hive 等）提交给 ResourceManager 进行调度，并将任务分配给合适的节点上的 NodeManager 执行。</li><li>容错处理：YARN 具备自动容错和故障转移机制，可以在节点故障时重新分配任务以保证作业的顺利执行。</li><li>扩展性：YARN 的架构设计具有良好的扩展性，可以轻松地增加或减少集群的容量，适应不同规模和负载的需求。</li></ol> 
<p>YARN 的核心组件包括：</p> 
<ul><li>ResourceManager：整个集群的资源管理器，负责接收客户端提交的任务，并将任务分配给合适的节点上的 NodeManager 执行。</li><li>NodeManager：运行在集群节点上，负责管理该节点的资源，并执行来自 ResourceManager 的任务。</li><li>ApplicationMaster：每个应用程序的主管进程，负责和 ResourceManager 通信，申请资源和监控任务的执行情况。</li></ul> 
<p>通过 YARN，Hadoop 可以不仅仅局限于 MapReduce，还可以支持更多计算模型和框架，提供更加灵活和高效的大规模数据处理能力。</p> 
<h2><a id="_38"></a>大致的资源分配流程</h2> 
<p><img src="https://images2.imgbox.com/28/18/qyKlpCvE_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Yarn_43"></a>Yarn的架构</h2> 
<p>于HDFS架构类似 , HDFS有NameNode和DataNode</p> 
<p>Yarn也有ResourceManager和NodeManager</p> 
<ul><li>ResourceManager : 整个集群的资源调度者 , 负责协调调度各个程序所需的资源</li><li>NodeManager : 单个服务器的资源调度者 , 负责调度单个服务器上的资源提供给应用程序使用<br> <img src="https://images2.imgbox.com/ae/e1/RwdDbYOW_o.png" alt="在这里插入图片描述"></li></ul> 
<h2><a id="Yarn_54"></a>Yarn容器</h2> 
<p><strong><mark>NodeManager会预先抢占这一部分的资源, 然后将这一部分的资源提供给程序使用 , 程序使用的资源也不能突破这部分的资源.</mark></strong></p> 
<h2><a id="Web_58"></a>Web应用代理</h2> 
<h3><a id="_60"></a>概念</h3> 
<p>代理服务器, 即Web应用代理是YARN的一部分 , 默认情况下 , 它将作为资源管理器(RM)的一部分运行 , 但是可以配置为独立模式下运行.\</p> 
<p>使用大理的原因是减少通过YARN进行基于网络的攻击可能性.</p> 
<p>这是因为 , Yarn在运行时会提供一个WEB UI站点 , 可以让用户在浏览器内查看Yarn的运行信息.</p> 
<p>对外提供WEB站点会有安全性问题 , 而代理服务器的功能就是最大限度的保障对WEB UI的访问安全性.</p> 
<ul><li>警告用户正在访问一个不受信任的站点</li><li>剥离用户访问的Cookie</li></ul> 
<h3><a id="_73"></a>独立部署的步骤</h3> 
<ol><li> <p>在yarn-site.xml中配置yarn.web-proxy.address参数即可</p> <p><img src="https://images2.imgbox.com/08/04/jiU9OffY_o.png" alt="在这里插入图片描述"></p> </li><li> <p>通过启动命令启动 : $HADOOP_YARN_HOME/sbin/yarn-daemon.sh start proxyserver</p> </li></ol> 
<h2><a id="Yarn_82"></a>Yarn的历史服务器</h2> 
<p>JobHistoryServer :</p> 
<p>记录历史运行的程序的信息以及产生的日志并提供WEB UI站点供用户使用浏览器查看。</p> 
<p><img src="https://images2.imgbox.com/0d/4f/wabwmG4w_o.png" alt="在这里插入图片描述"></p> 
<p>JobHistoryServer历史服务器功能：</p> 
<ul><li>提供WEB UI站点，供用户在浏览器上查看程序日志</li><li>可以保留历史数据，随时查看历史运行程序信息</li></ul> 
<p>JobHistoryServer需要配置：</p> 
<ul><li>开启日志聚合，即从容器中抓取日志到HDFS集中存储</li></ul> 
<p><img src="https://images2.imgbox.com/f1/6a/VfkaPE0e_o.png" alt="在这里插入图片描述"></p> 
<ul><li> <p>配置历史服务器端口和主机</p> <p><img src="https://images2.imgbox.com/42/a8/sl4o3GKc_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h2><a id="Yarn_108"></a>Yarn的部署</h2> 
<h3><a id="_110"></a>部署总体说明</h3> 
<table><thead><tr><th><strong>组件</strong></th><th><strong>配置文件</strong></th><th><strong>启动进程</strong></th><th><strong>备注</strong></th></tr></thead><tbody><tr><td>Hadoop HDFS</td><td>需修改</td><td>需启动NameNode作为主节点DataNode作为从节点SecondaryNameNode主节点辅助</td><td>分布式文件系统</td></tr><tr><td>Hadoop YARN</td><td>需修改</td><td>需启动ResourceManager作为集群资源管理者NodeManager作为单机资源管理者ProxyServer代理服务器提供安全性JobHistoryServer记录历史信息和日志</td><td>分布式资源调度</td></tr><tr><td>Hadoop MapReduce</td><td>需修改</td><td>无需启动任何进程MapReduce程序运行在YARN容器内</td><td>分布式数据计算</td></tr></tbody></table> 
<h3><a id="_118"></a>集群规划</h3> 
<p><img src="https://images2.imgbox.com/de/ed/RxgeVe69_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_123"></a>配置过程</h3> 
<h3><a id="mapreduce_125"></a>mapreduce的配置</h3> 
<p><strong><mark>以下配置都在$HADOOP_HOME/etc/hadoop的文件夹当中配置.</mark></strong></p> 
<h4><a id="mapredenvsh_129"></a>配置mapred-env.sh文件</h4> 
<pre><code class="prism language-sh"><span class="token comment">#JDK路径</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/export/server/jdk
<span class="token comment">#设置JobHistoryServer的进程内存为1G</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_JOB_HISTORYSERVER_HEAPSIZE</span><span class="token operator">=</span><span class="token number">1000</span>
<span class="token comment">#设置日志级别为INFO</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_MAPRED_ROOT_LOGGER</span><span class="token operator">=</span>INFO,RFA
</code></pre> 
<p><img src="https://images2.imgbox.com/af/1f/nasRWphp_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="mapredsitexml_143"></a>配置mapred-site.xml文件</h4> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.framework.name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>yarn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>MapReduce的运行框架设置为YARN<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.jobhistory.address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node:10020<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>历史服务器通讯端口为node:10020<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.jobhistory.webapp.address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node:19888<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>历史服务器web端口为node的19888<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.jobhistory.intermediate-done-dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/data/mr-history/tmp <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>历史信息在HDFS的记录临时路径<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.jobhistorydone-dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/data/mr-history/done<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>历史信息在HDFS的记录路径<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.app.mapreduce.am.env<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>HADOOP_MAPRED_HOME=$HADOOP_HOME<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>MapReduce HOME 设置为HADOOP_HOME<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.map.env<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>HADOOP_MAPRED_HOME=$HADOOP_HOME<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>MapReduce HOME 设置为HADOOP_HOME<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.reduce.env<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>HADOOP_MAPRED_HOME=$HADOOP_HOME<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>MapReduce HOME 设置为HADOOP_HOME<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3><a id="Yarn_189"></a>Yarn的配置</h3> 
<h4><a id="yarnenvsh_191"></a>配置yarn-env.sh</h4> 
<pre><code class="prism language-sh"><span class="token comment">#设置JDK路径的环境变量</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/export/server/jdk
<span class="token comment">#设置HADOOP_HOME的环境变量</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_HOME</span><span class="token operator">=</span>/export/server/hadoop
<span class="token comment">#设置配置文件路径的环境变量</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_CONF_DIR</span><span class="token operator">=</span><span class="token variable">$HADOOP_HOME</span>/etc/hadoop
<span class="token comment">#设置日志文件路径的环境变量</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_LOG_DIR</span><span class="token operator">=</span><span class="token variable">$HADOOP_HOME</span>/logs
</code></pre> 
<h4><a id="yarnsitexml_204"></a>配置yarn-site.xml文件</h4> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- Site specific YARN configuration properties --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.log.server.url<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>http://node:19888/jobhistory/logs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>历史服务器路径<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.web-proxy.address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node:8089<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>代理服务器主机和端口<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.log-aggregation-enable<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>开始日志聚合<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.remote-app-log-dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/tmp/logs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>程序日志HDFS的存储路径<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>


<span class="token comment">&lt;!-- Site specific YARN configuration properties --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.hostname<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>ResoucesManager的所在节点<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.scheduler.class<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.FairScheduler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>选择公平调度器<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.local-dirs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/data/nm-local<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>NodeManager中间数据本地存储路径<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.log-dirs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/data/nm-log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>NodeManager数据日志本地存储路径<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.log.retain-seconds<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>10800<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Default time (in seconds) to retain log files on the NodeManager Only applicable if log-aggregation is disabled.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.aux-services<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>mapreduce_shuffle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>为Mapreduce程序开启Shuffle服务<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>

</code></pre> 
<h4><a id="_275"></a>把这些配置文件分发到其他节点的服务器</h4> 
<pre><code class="prism language-shell"> <span class="token function">scp</span> mapred-env.sh mapred-site.xml yarn-env.sh yarn-site.xml node1:<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>/
 <span class="token function">scp</span> mapred-env.sh mapred-site.xml yarn-env.sh yarn-site.xml node2:<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>/
 
</code></pre> 
<h2><a id="_283"></a>集群的启动命令</h2> 
<p>一键启动YARN集群： $HADOOP_HOME/sbin/start-yarn.sh</p> 
<ul><li>会基于yarn-site.xml中配置的yarn.resourcemanager.hostname来决定在哪台机器上启动resourcemanager</li><li>会基于workers文件配置的主机启动NodeManager</li><li>代理服务器也会连带启动</li><li><img src="https://images2.imgbox.com/ba/94/1v4R9eJD_o.png" alt="在这里插入图片描述"></li></ul> 
<p>一键停止YARN集群： $HADOOP_HOME/sbin/stop-yarn.sh</p> 
<p>在当前机器，单独启动或停止进程 , 于hdfs类似</p> 
<ul><li> <pre><code>Hdfs :
hdfs --daemon start | stop namenode | datanode | secondarynamenode

Yarn : 
$HADOOP_HOME/bin/yarn --daemon start | stop resourcemanager | nodemanager|proxyserver
</code></pre> </li><li> <p>start和stop决定启动和停止</p> </li><li> <p>可控制resourcemanager、nodemanager、proxyserver三种进程</p> </li></ul> 
<p>历史服务器启动和停止</p> 
<ul><li> <pre><code>$HADOOP_HOME/bin/mapred --daemon start|stop historyserver
</code></pre> </li><li> <p><img src="https://images2.imgbox.com/e5/c5/wwGYXqM2_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h2><a id="MapReduceYarn_320"></a>MapReduce的在Yarn中的执行</h2> 
<h3><a id="Yarn_322"></a>Yarn可以执行的程序</h3> 
<ul><li>MapReduce程序(本文所讲)</li><li>Spark程序</li><li>Flink程序</li></ul> 
<h3><a id="wordCount_328"></a>wordCount程序实例</h3> 
<p>单词计数实例程序很简单 :</p> 
<ul><li>给定数据输入的路径(HDFS) , 给定输出的路径(HDFS)</li><li>将输入路径内的数据的单词进行计数 , 将结果写出到输出路径</li></ul> 
<ol><li> <p>准备一份文件, 输入单词</p> </li><li> <p>将文件上传到HDFS当中</p> </li><li> <p>执行如下命令，提交示例MapReduce程序WordCount到YARN中执行</p> <pre><code class="prism language-bash">hadoop jar <span class="token variable">$HADOOP_HOME</span>/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.3.4.jar wordcount hdfs://node:8020/input/wordcount/ hdfs://node:8020/output/wc1
</code></pre> </li></ol> 
<p>径(HDFS)</p> 
<ul><li>将输入路径内的数据的单词进行计数 , 将结果写出到输出路径</li></ul> 
<ol><li> <p>准备一份文件, 输入单词</p> </li><li> <p>将文件上传到HDFS当中</p> </li><li> <p>执行如下命令，提交示例MapReduce程序WordCount到YARN中执行</p> <pre><code class="prism language-bash">hadoop jar <span class="token variable">$HADOOP_HOME</span>/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.3.4.jar wordcount hdfs://node:8020/input/wordcount/ hdfs://node:8020/output/wc1
</code></pre> </li></ol>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/49eef028ba5f225e40dfeee458706748/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SpringBoot集成RabbitMQ基本使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6fb033347f75b82d2ed0f9d3b2b2e855/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Nginx如何安装SSL证书，在编辑nginx.conf，替换一下代码</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>