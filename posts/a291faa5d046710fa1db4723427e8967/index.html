<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>离线安装cdh6.3.1 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="离线安装cdh6.3.1" />
<meta property="og:description" content="离线安装cdh6.3.1（如需安装包请留言） 安装过程比较繁琐，请耐心阅读。祝您好运！
1.环境准备 三台linux服务器(安装jdk1.8&#43;，python2.7以上)：
192.168.10.53 node-cdh1（主节点，建议cpu32c，内存64G以上）
192.168.10.54 node-cdh2（建议内存32G以上）
192.168.10.55 node-cdh3（建议内存32G以上）
各节点/opt/cloudera/parcels目录建议10G以上
下载
官方下载地址如下：
https://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html（jdk已安装可省略）
https://archive.cloudera.com/cdh6/6.3.1/parcels/CDH-6.3.1-1.cdh6.3.1.p0.1470567-el7.parcel
https://archive.cloudera.com/cdh6/6.3.1/parcels/CDH-6.3.1-1.cdh6.3.1.p0.1470567-el7.parcel.sha1
https://archive.cloudera.com/cdh6/6.3.1/parcels/manifest.json
https://archive.cloudera.com/cm6/6.3.1/repo-as-tarball/cm6.3.1-redhat7.tar.gz
https://dev.mysql.com/downloads/mysql/5.7.html#downloads
http://central.maven.org/maven2/mysql/mysql-connector-java/5.1.47/mysql-connector-java-5.1.47.jar
1.1.设置linux主机名 各自节点执行修改主机名命令：
hostnamectl set-hostname node-cdh1 hostnamectl set-hostname node-cdh2 hostnamectl set-hostname node-cdh3 修改主机名也可编辑/etc/sysconfig/network
vi /etc/sysconfig/network
输入
NETWORKING=yes HOSTNAME=node-cdh1 每个节点上都添加以下内容至 /etc/hosts
vi /etc/hosts
192.168.10.53 node-cdh1 192.168.10.54 node-cdh2 192.168.10.55 node-cdh3 reboot重启各节点重启完成后用hostname命令查询系统主机名 1.2.关闭集群防火墙 systemctl stop firewalld &amp;&amp; systemctl disable firewalld &amp;&amp; iptables -F 1.3.关闭集群selinux vi /etc/selinux/config
SELINUX=disabled
修改成disabled之后 重启linux系统生效
1.4.设置集群时钟同步 1.4.1.所有节点设置亚洲上海时区 timedatectl set-timezone Asia/Shanghai 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/a291faa5d046710fa1db4723427e8967/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-26T10:33:28+08:00" />
<meta property="article:modified_time" content="2023-09-26T10:33:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">离线安装cdh6.3.1</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="cdh631_0"></a>离线安装cdh6.3.1（如需安装包请留言）</h2> 
<p><img src="https://images2.imgbox.com/ca/84/R67V4Piu_o.png" alt="在这里插入图片描述"><strong>安装过程比较繁琐，请耐心阅读。祝您好运！</strong></p> 
<h3><a id="1_3"></a>1.环境准备</h3> 
<blockquote> 
 <p><strong>三台linux服务器(安装jdk1.8+，python2.7以上)：</strong><br> 192.168.10.53 node-cdh1（主节点，建议cpu32c，内存64G以上）<br> 192.168.10.54 node-cdh2（建议内存32G以上）<br> 192.168.10.55 node-cdh3（建议内存32G以上）</p> 
 <p><strong>各节点/opt/cloudera/parcels目录建议10G以上</strong></p> 
</blockquote> 
<blockquote> 
 <p>下载<br> <img src="https://images2.imgbox.com/75/4a/jKY5fIuP_o.png" alt="在这里插入图片描述"><br> 官方下载地址如下：<br> <a href="https://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html" rel="nofollow">https://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html</a>（jdk已安装可省略）<br> <a href="https://archive.cloudera.com/cdh6/6.3.1/parcels/CDH-6.3.1-1.cdh6.3.1.p0.1470567-el7.parcel" rel="nofollow">https://archive.cloudera.com/cdh6/6.3.1/parcels/CDH-6.3.1-1.cdh6.3.1.p0.1470567-el7.parcel</a><br> <a href="https://archive.cloudera.com/cdh6/6.3.1/parcels/CDH-6.3.1-1.cdh6.3.1.p0.1470567-el7.parcel.sha1" rel="nofollow">https://archive.cloudera.com/cdh6/6.3.1/parcels/CDH-6.3.1-1.cdh6.3.1.p0.1470567-el7.parcel.sha1</a><br> <a href="https://archive.cloudera.com/cdh6/6.3.1/parcels/manifest.json" rel="nofollow">https://archive.cloudera.com/cdh6/6.3.1/parcels/manifest.json</a><br> <a href="https://archive.cloudera.com/cm6/6.3.1/repo-as-tarball/cm6.3.1-redhat7.tar.gz" rel="nofollow">https://archive.cloudera.com/cm6/6.3.1/repo-as-tarball/cm6.3.1-redhat7.tar.gz</a><br> <a href="https://dev.mysql.com/downloads/mysql/5.7.html#downloads" rel="nofollow">https://dev.mysql.com/downloads/mysql/5.7.html#downloads</a><br> <a href="http://central.maven.org/maven2/mysql/mysql-connector-java/5.1.47/mysql-connector-java-5.1.47.jar" rel="nofollow">http://central.maven.org/maven2/mysql/mysql-connector-java/5.1.47/mysql-connector-java-5.1.47.jar</a></p> 
</blockquote> 
<h4><a id="11linux_22"></a>1.1.设置linux主机名</h4> 
<p><strong>各自节点执行修改主机名命令：</strong></p> 
<pre><code class="prism language-shell">hostnamectl set-hostname node-cdh1

hostnamectl set-hostname node-cdh2

hostnamectl set-hostname node-cdh3
</code></pre> 
<blockquote> 
 <p>修改主机名也可编辑/etc/sysconfig/network<br> vi /etc/sysconfig/network<br> 输入</p> 
 <pre><code class="prism language-shell"><span class="token assign-left variable">NETWORKING</span><span class="token operator">=</span>yes
<span class="token assign-left variable"><span class="token environment constant">HOSTNAME</span></span><span class="token operator">=</span>node-cdh1
</code></pre> 
</blockquote> 
<p><strong>每个节点上都添加以下内容至 /etc/hosts</strong></p> 
<p>vi /etc/hosts</p> 
<pre><code class="prism language-shell"><span class="token number">192.168</span>.10.53 node-cdh1
<span class="token number">192.168</span>.10.54 node-cdh2
<span class="token number">192.168</span>.10.55 node-cdh3
</code></pre> 
<ul><li>reboot重启各节点</li><li>重启完成后用hostname命令查询系统主机名</li></ul> 
<h4><a id="12_52"></a>1.2.关闭集群防火墙</h4> 
<pre><code class="prism language-shell">systemctl stop firewalld <span class="token operator">&amp;&amp;</span> systemctl disable firewalld <span class="token operator">&amp;&amp;</span> iptables <span class="token parameter variable">-F</span>
</code></pre> 
<h4><a id="13selinux_56"></a>1.3.关闭集群selinux</h4> 
<p>vi /etc/selinux/config</p> 
<p>SELINUX=disabled</p> 
<p>修改成disabled之后 重启linux系统生效</p> 
<h4><a id="14_63"></a>1.4.设置集群时钟同步</h4> 
<h5><a id="141_64"></a>1.4.1.所有节点设置亚洲上海时区</h5> 
<pre><code class="prism language-shell">timedatectl set-timezone Asia/Shanghai
</code></pre> 
<h5><a id="142ntp_68"></a>1.4.2.所有节点安装ntp：</h5> 
<p>1）确认是否已安装ntp</p> 
<pre><code class="prism language-shell"><span class="token function">rpm</span> <span class="token parameter variable">-qa</span> <span class="token operator">|</span> <span class="token function">grep</span> ntp
</code></pre> 
<p>如：<br> ntp-4.2.6p5-29.el7.centos.2.x86_64<br> ntpdate-4.2.6p5-29.el7.centos.2.x86_64<br> fontpackages-filesystem-1.44-8.el7.noarch</p> 
<p>2）安装ntp</p> 
<pre><code class="prism language-shell">yum <span class="token function">install</span> <span class="token parameter variable">-y</span> ntp
</code></pre> 
<h5><a id="143ntp_83"></a>1.4.3.配置ntp服务</h5> 
<p><u>本例选取node-cdh1为ntp的主节点</u></p> 
<p>1）修改所有节点的/etc/ntp.conf</p> 
<blockquote> 
 <p>【命令】vi /etc/ntp.conf<br> 【内容】<br> restrict 192.168.10.xxx nomodify notrap nopeer noquery //配置当前节点IP地址<br> restrict 192.168.10.1 mask 255.255.255.0 nomodify notrap //配置集群所在网段的网关（Gateway），子网掩码（Genmask）</p> 
</blockquote> 
<p>2）选择一个主节点(192.168.10.53)，修改其/etc/ntp.conf</p> 
<blockquote> 
 <p>【命令】vi /etc/ntp.conf<br> 【内容】在server部分添加一下部分，并注释掉server 0 ~ n<br> server 127.127.1.0<br> Fudge 127.127.1.0 stratum 10</p> 
</blockquote> 
<p>3）主节点以外的节点，继续修改/etc/ntp.conf</p> 
<blockquote> 
 <p>【命令】vi /etc/ntp.conf<br> 【内容】在server部分添加如下语句，将server指向主节点。<br> server 192.168.10.53 //改为主节点ip<br> Fudge 192.168.10.53 stratum 10 //改为主节点ip</p> 
</blockquote> 
<p><strong>修改前</strong><br> <img src="https://images2.imgbox.com/0b/54/zrIsrmve_o.png" alt="在这里插入图片描述"></p> 
<p><strong>修改后</strong><br> 主节点（192.168.10.53）：<br> <img src="https://images2.imgbox.com/99/f0/nF5tvTb8_o.png" alt="在这里插入图片描述"></p> 
<p>节点（192.168.10.54）：<br> <img src="https://images2.imgbox.com/bf/64/VFUMQc4u_o.png" alt="在这里插入图片描述"></p> 
<p>节点（192.168.10.55）：<br> <img src="https://images2.imgbox.com/81/ed/y5PkJQnw_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="ntp_117"></a>三个节点启动ntp服务、查看状态</h6> 
<p>1）启动ntp服务<br> 【命令】service ntpd start</p> 
<p>2）查看ntp服务器有无和上层ntp连通<br> 【命令】ntpstat</p> 
<blockquote> 
 <p>查看ntp状态时，可能会出现如下所示情况<br> ① unsynchronised time server re-starting polling server every 8 s<br> ② unsynchronised polling server every 8 s</p> 
 <p>这种情况属于正常，ntp服务器配置完毕后，需要等待5-10分钟才能与/etc/ntp.conf中配置的标准时间进行同步。</p> 
 <p>等一段时间(5-10分钟)之后，再次使用ntpstat命令查看状态，就会变成如下正常结果：<br> <img src="https://images2.imgbox.com/a6/dd/zsJuwyAG_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>3）查看ntp服务器与上层ntp的状态<br> 【命令】ntpq -p<br> <img src="https://images2.imgbox.com/ce/7c/r8axMFGD_o.png" alt="在这里插入图片描述"></p> 
<p>4）查看ntpd进程的状态<br> 【命令】watch “ntpq -p”<br> 【终止】按 Ctrl+C 停止查看进程。</p> 
<p>5）设置开机启动<br> 【命令】chkconfig ntpd on</p> 
<h4><a id="15mysql_144"></a>1.5.主节点安装mysql</h4> 
<p><a href="https://github.com/Hackeruncle/MySQL/blob/master/MySQL%205.7.11%20Install.txt">https://github.com/Hackeruncle/MySQL/blob/master/MySQL%205.7.11%20Install.txt</a></p> 
<p>本例mysql安装在/app下</p> 
<blockquote> 
 <p><strong>卸载mariadb</strong><br> 安装mysql时候和centos7自带的数据库有冲突。<br> rpm -qa | grep mariadb<br> rpm -e --nodeps mariadb-libs-5.5.52-1.el7.x86_64</p> 
</blockquote> 
<h6><a id="151_153"></a>1.5.1.解压及创建目录</h6> 
<pre><code class="prism language-shell"><span class="token function">tar</span> xzvf mysql-5.7.11-linux-glibc2.5-x86_64.tar.gz <span class="token parameter variable">-C</span> /app
<span class="token builtin class-name">cd</span> /app
<span class="token function">mv</span> mysql-5.7.11-linux-glibc2.5-x86_64 mysql

<span class="token function">mkdir</span> mysql/arch mysql/data mysql/tmp
</code></pre> 
<h6><a id="152mycnf_161"></a>1.5.2.创建my.cnf(见文件)</h6> 
<p>vi /etc/my.cnf<br> 内容：</p> 
<pre><code class="prism language-properties">[client]
port            = 3306
socket          = /app/mysql/data/mysql.sock
default-character-set=utf8mb4

[mysqld]
port            = 3306
socket          = /app/mysql/data/mysql.sock

skip-slave-start

skip-external-locking
key_buffer_size = 256M
sort_buffer_size = 2M
read_buffer_size = 2M
read_rnd_buffer_size = 4M
query_cache_size= 32M
max_allowed_packet = 16M
myisam_sort_buffer_size=128M
tmp_table_size=32M

table_open_cache = 512
thread_cache_size = 8
wait_timeout = 86400
interactive_timeout = 86400
max_connections = 600

# Try number of CPU's*2 for thread_concurrency
#thread_concurrency = 32

#isolation level and default engine
default-storage-engine = INNODB
transaction-isolation = READ-COMMITTED

server-id  = 1739
basedir     = /app/mysql
datadir     = /app/mysql/data
pid-file     = /app/mysql/data/hostname.pid

#open performance schema
log-warnings
sysdate-is-now

binlog_format = ROW
log_bin_trust_function_creators=1
log-error  = /app/mysql/data/hostname.err
log-bin = /app/mysql/arch/mysql-bin
expire_logs_days = 7

innodb_write_io_threads=16

relay-log  = /app/mysql/relay_log/relay-log
relay-log-index = /app/mysql/relay_log/relay-log.index
relay_log_info_file= /app/mysql/relay_log/relay-log.info

log_slave_updates=1
gtid_mode=OFF
enforce_gtid_consistency=OFF

# slave
slave-parallel-type=LOGICAL_CLOCK
slave-parallel-workers=4
master_info_repository=TABLE
relay_log_info_repository=TABLE
relay_log_recovery=ON

#other logs
#general_log =1
#general_log_file  = /app/mysql/data/general_log.err
#slow_query_log=1
#slow_query_log_file=/app/mysql/data/slow_log.err

#for replication slave
sync_binlog = 500

#for innodb options
innodb_data_home_dir = /app/mysql/data/
innodb_data_file_path = ibdata1:1G;ibdata2:1G:autoextend

innodb_log_group_home_dir = /app/mysql/arch
innodb_log_files_in_group = 4
innodb_log_file_size = 1G
innodb_log_buffer_size = 200M

#根据生产需要，调整pool size
innodb_buffer_pool_size = 2G
#innodb_additional_mem_pool_size = 50M #deprecated in 5.6
tmpdir = /app/mysql/tmp

innodb_lock_wait_timeout = 1000
#innodb_thread_concurrency = 0
innodb_flush_log_at_trx_commit = 2
innodb_locks_unsafe_for_binlog=1

#innodb io features: add for mysql5.5.8
performance_schema
innodb_read_io_threads=4
innodb-write-io-threads=4
innodb-io-capacity=200
#purge threads change default(0) to 1 for purge
innodb_purge_threads=1
innodb_use_native_aio=on

#case-sensitive file names and separate tablespace
innodb_file_per_table = 1
lower_case_table_names=1

[mysqldump]
quick
max_allowed_packet = 128M

[mysql]
no-auto-rehash
default-character-set=utf8mb4

[mysqlhotcopy]
interactive-timeout

[myisamchk]
key_buffer_size = 256M
sort_buffer_size = 256M
read_buffer = 2M
write_buffer = 2M

</code></pre> 
<h6><a id="153_290"></a>1.5.3.创建用户组及用户</h6> 
<pre><code class="prism language-shell"><span class="token function">groupadd</span> <span class="token parameter variable">-g</span> <span class="token number">101</span> dba
<span class="token function">useradd</span> <span class="token parameter variable">-u</span> <span class="token number">514</span> <span class="token parameter variable">-g</span> dba <span class="token parameter variable">-G</span> root <span class="token parameter variable">-d</span> /app/mysql mysqladmin
</code></pre> 
<h6><a id="154copy_mysqladminhome_295"></a>1.5.4.copy 环境变量配置文件至mysqladmin用户的home目录中,为了以下步骤配置个人环境变量</h6> 
<pre><code class="prism language-sql">cp <span class="token operator">/</span>etc<span class="token operator">/</span>skel<span class="token operator">/</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token operator">/</span>app<span class="token operator">/</span>mysql
</code></pre> 
<h6><a id="155mysql_299"></a>1.5.5.配置mysql环境变量</h6> 
<p>vi mysql/.bashrc</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable">MYSQL_BASE</span><span class="token operator">=</span>/app/mysql
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token variable">${MYSQL_BASE}</span>/bin:<span class="token environment constant">$PATH</span>
</code></pre> 
<h6><a id="156mysqladmin_305"></a>1.5.6.赋权限和用户组，切换用户mysqladmin，安装</h6> 
<pre><code class="prism language-shell"><span class="token function">chown</span>  mysqladmin:dba /etc/my.cnf
<span class="token function">chmod</span>  <span class="token number">640</span> /etc/my.cnf  

<span class="token function">chown</span> <span class="token parameter variable">-R</span> mysqladmin:dba /app/mysql
<span class="token function">chmod</span> <span class="token parameter variable">-R</span> <span class="token number">755</span> /app/mysql
</code></pre> 
<h6><a id="157_313"></a>1.5.7.配置服务及开机自启动</h6> 
<p>#将服务文件拷贝到init.d下，并重命名为mysql<br> cp support-files/mysql.server /etc/rc.d/init.d/mysql<br> #赋予可执行权限<br> chmod +x /etc/rc.d/init.d/mysql<br> #添加服务<br> chkconfig --add mysql</p> 
<h6><a id="158_320"></a>1.5.8.初始化</h6> 
<pre><code class="prism language-shell"><span class="token builtin class-name">cd</span> /app/mysql
<span class="token comment">#执行</span>
bin/mysqld <span class="token punctuation">\</span>
--defaults-file<span class="token operator">=</span>/etc/my.cnf <span class="token punctuation">\</span>
<span class="token parameter variable">--user</span><span class="token operator">=</span>mysqladmin <span class="token punctuation">\</span>
<span class="token parameter variable">--basedir</span><span class="token operator">=</span>/app/mysql/ <span class="token punctuation">\</span>
<span class="token parameter variable">--datadir</span><span class="token operator">=</span>/app/mysql/data/ <span class="token punctuation">\</span>
<span class="token parameter variable">--initialize</span>
</code></pre> 
<h6><a id="159mysqlmysql_331"></a>1.5.9.启动mysql，修改初始密码，重启mysql</h6> 
<pre><code class="prism language-sql"><span class="token comment">#启动</span>
su <span class="token operator">-</span> mysqladmin
service mysql <span class="token keyword">start</span>

<span class="token comment">#查看初始密码</span>
cd <span class="token operator">/</span>app<span class="token operator">/</span>mysql<span class="token operator">/</span><span class="token keyword">data</span>
cat hostname<span class="token punctuation">.</span>err <span class="token operator">|</span>grep password
<span class="token comment">#冒号后为密码（例如）</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">09</span>T16:<span class="token number">02</span>:<span class="token number">19.331684</span>Z <span class="token number">1</span> <span class="token punctuation">[</span>Note<span class="token punctuation">]</span> A <span class="token keyword">temporary</span> password <span class="token operator">is</span> generated <span class="token keyword">for</span> root<span class="token variable">@localhost</span>: <span class="token operator">&gt;</span>jOzMCDx6<span class="token operator">+</span>t<span class="token punctuation">.</span>

<span class="token comment">#登录</span>
mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>p
<span class="token comment">#输入密码 &gt;jOzMCDx6+t.</span>

<span class="token comment">#修改初始密码</span>
<span class="token keyword">alter</span> <span class="token keyword">user</span> root<span class="token variable">@localhost</span> identified <span class="token keyword">by</span> <span class="token string">'naricdh'</span><span class="token punctuation">;</span>

<span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'root'</span><span class="token variable">@'%'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'naricdh'</span> <span class="token punctuation">;</span>
<span class="token comment">#刷新后生效！！！</span>
flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>

<span class="token comment">#重启mysql</span>
service mysql restart
</code></pre> 
<h4><a id="16CDHamon_357"></a>1.6.创建CDH源数据库、用户、amon服务的数据库</h4> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">database</span> cmf <span class="token keyword">default</span> <span class="token keyword">character</span> <span class="token keyword">set</span> utf8<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> amon <span class="token keyword">default</span> <span class="token keyword">character</span> <span class="token keyword">set</span> utf8<span class="token punctuation">;</span>

<span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">privileges</span> <span class="token keyword">on</span>  cmf<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> <span class="token string">'cmf'</span><span class="token variable">@'%'</span> identified <span class="token keyword">by</span> <span class="token string">'comnari'</span><span class="token punctuation">;</span>
<span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">privileges</span> <span class="token keyword">on</span> amon<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> <span class="token string">'amon'</span><span class="token variable">@'%'</span> identified <span class="token keyword">by</span> <span class="token string">'comnari'</span><span class="token punctuation">;</span>

flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="17JDBC_368"></a>1.7.主节点部署JDBC驱动</h4> 
<pre><code class="prism language-shell"><span class="token comment">#将mysql驱动cp到 /usr/share/java目录下面，修改文件名为：mysql-connector-java.jar</span>
<span class="token function">cp</span> mysql-connector-java-5.1.47.jar /usr/share/java/mysql-connector-java.jar
</code></pre> 
<h3><a id="2CDH_374"></a>2.CDH部署</h3> 
<p>#上传cm6.3.1-redhat7.tar.gz到所有节点<br> #解压cm6.3.1-redhat7.tar.gz<br> tar -zxf cm6.3.1-redhat7.tar.gz<br> cd cm6.3.1/RPMS/x86_64/<br> ll<br> <img src="https://images2.imgbox.com/bb/57/uhrSkDEC_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="21_clouderamanagerdaemons6311466458el7x86_64rpm_383"></a>2.1.所有节点安装 cloudera-manager-daemons-6.3.1-1466458.el7.x86_64.rpm依赖</h4> 
<pre><code class="prism language-shell"><span class="token function">rpm</span> <span class="token parameter variable">-ivh</span> cloudera-manager-daemons-6.3.1-1466458.el7.x86_64.rpm <span class="token parameter variable">--nodeps</span> <span class="token parameter variable">--force</span>
</code></pre> 
<h4><a id="22clouderascmserver_387"></a>2.2.主节点部署cloudera-scm-server</h4> 
<pre><code class="prism language-shell"><span class="token function">rpm</span> <span class="token parameter variable">-ivh</span> cloudera-manager-server-6.3.1-1466458.el7.x86_64.rpm <span class="token parameter variable">--nodeps</span> <span class="token parameter variable">--force</span>
</code></pre> 
<p>修改 vi /etc/cloudera-scm-server/db.properties</p> 
<pre><code class="prism language-properties">com.cloudera.cmf.db.type=mysql

com.cloudera.cmf.db.host=node-cdh1:3306

com.cloudera.cmf.db.name=cmf

com.cloudera.cmf.db.user=cmf

com.cloudera.cmf.db.password=comnari

com.cloudera.cmf.db.setupType=EXTERNAL
</code></pre> 
<p>如图：<br> <img src="https://images2.imgbox.com/84/af/bKpzUYie_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="23server_409"></a>2.3.主节点启动server，配置开机自启动</h4> 
<pre><code class="prism language-shell">systemctl start cloudera-scm-server
systemctl <span class="token builtin class-name">enable</span> cloudera-scm-server
</code></pre> 
<blockquote> 
 <p>server启动后，浏览器访问CM控制台 <strong>http://主节点ip:7180</strong>（账号：admin，密码：admin）<br> 能看到如下界面即可，先不要操作<br> <img src="https://images2.imgbox.com/46/cc/4r2niYpI_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<h4><a id="24agenthostagent_419"></a>2.4.所有节点（包括主节点）安装agent，配置主节点host，启动agent，设置开机自启动</h4> 
<ul><li>安装agent：</li></ul> 
<pre><code class="prism language-shell"><span class="token function">rpm</span> <span class="token parameter variable">-ivh</span> cloudera-manager-agent-6.3.1-1466458.el7.x86_64.rpm <span class="token parameter variable">--nodeps</span> <span class="token parameter variable">--force</span>
</code></pre> 
<ul><li> <p>配置主节点host：<br> 修改vim /etc/cloudera-scm-agent/config.ini<br> <img src="https://images2.imgbox.com/b5/43/AqRZWgWe_o.png" alt="在这里插入图片描述"></p> </li><li> <p>启动agent，设置开机自启动：</p> </li></ul> 
<pre><code class="prism language-shell">systemctl start cloudera-scm-agent 
systemctl <span class="token builtin class-name">enable</span> cloudera-manager-agent
</code></pre> 
<h4><a id="25httpdCM_435"></a>2.5.安装httpd（用于CM创建集群选择存储库时，使用代理，如不使用代理可省略此步）</h4> 
<pre><code class="prism language-shell">yum <span class="token function">install</span> <span class="token parameter variable">-y</span> httpd
<span class="token builtin class-name">cd</span> /var/www/html
<span class="token function">mkdir</span> download
</code></pre> 
<p>将三个文件copy到该目录下面<br> <img src="https://images2.imgbox.com/31/39/oGPLknK7_o.png" alt="在这里插入图片描述"></p> 
<p>#启动httpd服务<br> systemctl start httpd<br> #开机自启<br> systemctl enable httpd<br> #浏览器输入ip/download访问apachehttp服务器<br> <img src="https://images2.imgbox.com/6f/bb/xpPFn10l_o.png" alt="在这里插入图片描述"></p> 
<p><strong><u>登录http://主节点ip:7180，账号密码默认为admin开始设置集群，注意设置集群中途不要关闭浏览器（集群设置和使用较简单，可自行查阅资料，本教程后期更新CDH集群设置和使用）</u></strong></p> 
<blockquote> 
 <p><strong>设置完服务后效果如下：</strong><br> 登录http://主节点ip:7180/cmf/home<br> <img src="https://images2.imgbox.com/4b/9f/82E5Qz8T_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>完结！</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4d9243bf0e48eeb1173f511f588bc6a1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ChatGLM接入微信公众号（cpolar的使用）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4d825d12cac1c7035ffc009024284a58/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python判断float是否相等</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>