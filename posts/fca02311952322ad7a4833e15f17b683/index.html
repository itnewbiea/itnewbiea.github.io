<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android使用Itext生成pdf文件 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android使用Itext生成pdf文件" />
<meta property="og:description" content="对于生成pdf文件，上一篇文章介绍了使用android原生的方式生成pdf，使用android原生的方式对于将view上的内容生成pdf非常的简单，但有缺憾，就是生成的pdf文佳很多，对于在项目中需要将生成的pdf文件发送出去，这时就会发现发送的时间有点长了，这对于用户来说肯定是不可以接受的了，所以就有了这里接受的Itext了。
对于Itext，主要有两个版本，一个是5.x，另一个是7.x，这两个版本是完全是不兼容的，其区别可以参考官网：https://itextpdf.com/blog/itext-7-and-itext-5-roadmaps-differences-updates，
5.x的文档：https://itextsupport.com/apidocs/itext5/latest/
7.x的文档：https://itextsupport.com/apidocs/itext7/latest/
在项目中使用的是5.x，对于7.x没怎么去研究，下面主要是对5.x版本的使用介绍：
首先是下载一个5.x版本的jar包，链接：https://pan.baidu.com/s/1Gno-jNI7L15KSKZZGFai-g，下载完后，至于怎么导包就不用多说了吧，接下来就是看看怎么使用了，先看看文字怎么生存pdf：
public void textTransformPdf(String content,String pdf_save_address){ Document doc = new Document();// 创建一个document对象 FileOutputStream fos; try { fos = new FileOutputStream(pdf_save_address); // pdf_address为Pdf文件保存到sd卡的路径 PdfWriter.getInstance(doc, fos); doc.open(); doc.setPageCount(1); doc.add(new Paragraph(content, setChineseFont())); // result为保存的字符串 // ,setChineseFont()为pdf字体 // 一定要记得关闭document对象 doc.close(); } catch (FileNotFoundException e1) { e1.printStackTrace(); } catch (DocumentException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); } } public Font setChineseFont() { BaseFont bf = null; Font fontChinese = null; try { // STSong-Light : Adobe的字体 // UniGB-UCS2-H : pdf 字体 bf = BaseFont." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/fca02311952322ad7a4833e15f17b683/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-08-09T17:40:33+08:00" />
<meta property="article:modified_time" content="2018-08-09T17:40:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android使用Itext生成pdf文件</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-indent:50px;">对于生成pdf文件，上一篇文章介绍了使用android原生的方式生成pdf，使用android原生的方式对于将view上的内容生成pdf非常的简单，但有缺憾，就是生成的pdf文佳很多，对于在项目中需要将生成的pdf文件发送出去，这时就会发现发送的时间有点长了，这对于用户来说肯定是不可以接受的了，所以就有了这里接受的Itext了。</p> 
<p style="text-indent:50px;">对于Itext，主要有两个版本，一个是5.x，另一个是7.x，这两个版本是完全是不兼容的，其区别可以参考官网：<a href="https://itextpdf.com/blog/itext-7-and-itext-5-roadmaps-differences-updates" rel="nofollow">https://itextpdf.com/blog/itext-7-and-itext-5-roadmaps-differences-updates</a>，</p> 
<p style="text-indent:50px;">5.x的文档：<a href="https://itextsupport.com/apidocs/itext5/latest/" rel="nofollow">https://itextsupport.com/apidocs/itext5/latest/</a></p> 
<p style="text-indent:50px;">7.x的文档：<a href="https://itextsupport.com/apidocs/itext7/latest/" rel="nofollow">https://itextsupport.com/apidocs/itext7/latest/</a></p> 
<p style="text-indent:50px;">在项目中使用的是5.x，对于7.x没怎么去研究，下面主要是对5.x版本的使用介绍：</p> 
<p style="text-indent:50px;">首先是下载一个5.x版本的jar包，链接：<a href="https://pan.baidu.com/s/1Gno-jNI7L15KSKZZGFai-g" rel="nofollow">https://pan.baidu.com/s/1Gno-jNI7L15KSKZZGFai-g</a>，下载完后，至于怎么导包就不用多说了吧，接下来就是看看怎么使用了，先看看文字怎么生存pdf：</p> 
<pre class="has"><code class="language-java">   public void textTransformPdf(String content,String pdf_save_address){
        Document doc = new Document();// 创建一个document对象
        FileOutputStream fos;
        try {
            fos = new FileOutputStream(pdf_save_address); // pdf_address为Pdf文件保存到sd卡的路径
            PdfWriter.getInstance(doc, fos);
            doc.open();
            doc.setPageCount(1);
            doc.add(new Paragraph(content, setChineseFont())); // result为保存的字符串
            // ,setChineseFont()为pdf字体
            // 一定要记得关闭document对象
            doc.close();
        } catch (FileNotFoundException e1) {
            e1.printStackTrace();
        } catch (DocumentException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    public Font setChineseFont() {
        BaseFont bf = null;
        Font fontChinese = null;
        try {
            // STSong-Light : Adobe的字体
            // UniGB-UCS2-H : pdf 字体
            bf = BaseFont.createFont("STSong-Light", "UniGB-UCS2-H", BaseFont.NOT_EMBEDDED);
            fontChinese = new Font(bf, 12, Font.NORMAL);
        } catch (DocumentException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return fontChinese;
    }</code></pre> 
<p>这里设置字体是为了解决中文的问题，把生存pdf的内容和保存pdf的路径传进去就ok了，这是简单的使用，对于文字的设置也是可以的，后面讲到。（参考：<a href="https://blog.csdn.net/xuwenneng/article/details/52995392">https://blog.csdn.net/xuwenneng/article/details/52995392</a>）</p> 
<p style="text-indent:50px;">在讲了将文字生存pdf后，接下来就该说说如何将图片生成pdf了，话不多说，上代码：</p> 
<pre class="has"><code class="language-java">    public void imgTransformPdf(String[] imgPaths,String pdf_save_address){
        Document doc = new Document(PageSize.A4, 0, 0, 0, 0);
        try {
            //获取PDF书写器
            PdfWriter.getInstance(doc, new FileOutputStream(pdf_save_address));
            //打开文档
            doc.open();
            //图片对象
            Image img  = null;
            //遍历
            for (int i = 0; i &lt; imgPaths.length; i++) {
                //获取图片
                img = Image.getInstance(new URL(imgPaths[i]));
                //使图片与A4纸张大小自适应
                img.scaleToFit(new Rectangle(PageSize.A4));
                //添加到PDF文档
                doc.add(img);
                //下一页，每张图片一页
                doc.newPage();
            }

        } catch (Exception e) {
            e.printStackTrace();
        }finally{
            //关闭文档
            doc.close();
        }

    }</code></pre> 
<p style="text-indent:0;">这里就是根据传入的图片路径生成pdf，这里的设置是一张图片占用一页pdf。（参考：<a href="https://blog.csdn.net/HoKis/article/details/54136785">https://blog.csdn.net/HoKis/article/details/54136785</a>）</p> 
<p style="text-indent:50px;">上面讲到的都是单一的类型生成pdf，在实际中肯定是需要生成文字和图片混合的pdf，而且在排版上肯定也是会有一定要求的，接下来就来看下我封装的一个简单实现：</p> 
<pre class="has"><code class="language-java">public class PdfItextUtil {

    private Document document;

    // savePath:保存pdf的路径
    public PdfItextUtil(String savePath) throws FileNotFoundException, DocumentException {
        //创建新的PDF文档：A4大小，左右上下边框均为0
        document = new Document(PageSize.A4,50,50,30,30);
        //获取PDF书写器
        PdfWriter.getInstance(document, new FileOutputStream(savePath));
        //打开文档
        document.open();
    }

    public void close(){
        if (document.isOpen()) {
            document.close();
        }
    }

    // 添加图片到pdf中，这张图片在pdf中居中显示
    // imgPath:图片的路径，我使用的是sdcard中图片
    // imgWidth：图片在pdf中所占的宽
    // imgHeight：图片在pdf中所占的高
    public PdfItextUtil addImageToPdfCenterH(@NonNull String imgPath, float imgWidth, float imgHeight) throws IOException, DocumentException {
        //获取图片
        Image img = Image.getInstance(imgPath);
        img.setAlignment(Element.ALIGN_CENTER);
        img.scaleToFit(imgWidth,imgHeight);
        //添加到PDF文档
        document.add(img);

        return this;
    }

    public PdfItextUtil addPngToPdf(InputStream inputStream) throws DocumentException, IOException {
        Image img = PngImage.getImage(inputStream);
        img.setAlignment(Element.ALIGN_CENTER);
        //添加到PDF文档
        document.add(img);
        return this;
    }

    // 添加文本到pdf中
    public PdfItextUtil addTextToPdf(String content) throws DocumentException {
        Paragraph elements = new Paragraph(content, setChineseFont());
        elements.setAlignment(Element.ALIGN_BASELINE);
//        elements.setIndentationLeft(55);  //设置距离左边的距离
        document.add(elements); // result为保存的字符串
        return this;
    }

    // 给pdf添加个标题，居中黑体
    public PdfItextUtil addTitleToPdf(String title){
        try {
            Paragraph elements = new Paragraph(title, setChineseTiltleFont(18));
            elements.setAlignment(Element.ALIGN_CENTER);
            document.add(elements); // result为保存的字符串
        } catch (DocumentException e) {
            e.printStackTrace();
        }
        return this;
    }

    private Font setChineseFont() {
        return setChineseFont(12);
    }

    private Font setChineseFont(int size) {
        BaseFont bf;
        Font fontChinese = null;
        try {
            // STSong-Light : Adobe的字体
            // UniGB-UCS2-H : pdf 字体
            bf = BaseFont.createFont("STSong-Light", "UniGB-UCS2-H", BaseFont.NOT_EMBEDDED);
            fontChinese = new Font(bf, size, Font.NORMAL);
        } catch (DocumentException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return fontChinese;
    }

    private Font setChineseTiltleFont(int size) {
        BaseFont bf;
        Font fontChinese = null;
        try {
            // STSong-Light : Adobe的字体
            // UniGB-UCS2-H : pdf 字体
            bf = BaseFont.createFont("STSong-Light", "UniGB-UCS2-H", BaseFont.NOT_EMBEDDED);
            fontChinese = new Font(bf, size, Font.BOLD);
        } catch (DocumentException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return fontChinese;
    }
}</code></pre> 
<p>封装完后就该怎么使用了，直接上代码了：</p> 
<pre class="has"><code class="language-java">    public void toPDF() {
        PdfItextUtil pdfItextUtil = null;
        try {
            pdfItextUtil = new PdfItextUtil(getSavePdfFilePath())
                    .addTitleToPdf(getTvString(tv_title))
                    .addTextToPdf(getTvString(tv_part1))
                    .addImageToPdfCenterH(getImageFilePath(),160,160)
                    .addTextToPdf(getTvString(tv_part2))
                    .addImageToPdfCenterH(getImageFilePath(),160,160)
                    .addTextToPdf(getTvString(tv_content));
        } catch (IOException e) {
            e.printStackTrace();
        } catch (DocumentException e) {
            e.printStackTrace();
        } finally {
            if (pdfItextUtil != null)
                pdfItextUtil.close();
        }
    }</code></pre> 
<p>getTvString(tv_title)这个方法是获取TextView中的内容，这里主要还是拼接一个pdf，按顺序从上往下拼接，最后就是看下生成pdf的效果了，直接上图：</p> 
<p style="text-align:center;"><img alt="" class="has" height="600" src="https://images2.imgbox.com/f4/33/cBTlvWs3_o.png" width="900"></p> 
<p> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/44ef9147fcfdf1abe0d8609fd4ce2b43/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">今天在做微信分享功能的时候，遇到项目部署后出现 config:invalid url domain 弹窗提示的解决办法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6a7f83acbb5d5be69b6e35f504c72088/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">商品历史价格查询网站分享</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>