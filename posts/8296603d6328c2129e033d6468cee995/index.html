<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java开发调用C语言的DLL - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java开发调用C语言的DLL" />
<meta property="og:description" content=" 通过Java调用OCX控件或者DLL有以下几种方法，使用JNI、JACOB、Jawin等技术完成接口调用；
1.JNI
最直接的方式，也是最麻烦的方式，需要自己完成所有的工作，不推荐。
2.Jawin
尝试了一下，效果不错，但相对来说，其编程风格更贴近Windows，离Java有点远
3.Jacob
使用Jacob非常方便，Java编程风格，需要了解的知识比较少。官方的解释是Java COM Bridge，即java和
com组件间的桥梁（进一步了解com/dcom: http://docs.huihoo.com/com/）
com一般表现为dll或exe等二进制文件
下载地址： http://sourceforge.net/projects/jacob-project/ JACOB。e
Jacob的使用方法（64位的jacob组件对应 64为的OCX控件或者DLL文件）
1、将jacob.jar导入到开发项目（开发项目为需要引用的dll接口的项目）中，导入方法如下https://blog.csdn.net/zxz9900/article/details/99598807；
2、将jacob-1.xx-x64.dll放到 C:\Windows\System32文件夹下（注意：该dll必须与jacob.jar版本一致）；
3、注册DLL文件，regsvr32 D:\Code\EncryptionLibrary64.dll；
如果注册失败，提示没有入口的错误，请进行如下操作：
开始→所有程序→附件→右键点击命令提示符（CMD）→以管理员身份运行。
在DOS窗口中输入 regsvr32 msi.dll，提示成功，然后再执行 regsvr32 xx.dll
键盘操作win&#43;r弹出运行框，输入 regedit 查看注册表；
注意：如果部分电脑不能注册，或者注册失败，可手动进行如下操作，键盘操作win&#43;r弹出运行框，输入 regedit 查看注册表，选中“计算机”根节点，选中“文件”菜单中的【导入】，导入dll的注册文件（共两个注册文件，ProgId.reg与CLSID.reg），，导入完成后请查询“EncryptionLibrary64.EncryptionLibraryCom”，并修改注册文件中“InprocServer32”与“1.0.0.0”中“CodeBase”参数中“EncryptionLibrary64.dll”的相关路径（修改为dll文件在本地的路径）；
1.初始化 ComThread.InitMTA(true);
ActiveXComponent com = new ActiveXComponent(&#34;组件的ProgID&#34;) ;
Dispatch disp = com.getObject();
2.调用控件里面的方面
2.1调用无参的方法，并返回一个short值
Dispatch.call(disp, &#34;Init&#34;).getShort();
2.2调用有一个参数的方法，并返回一个boolean值
Dispatch.call(disp,&#34;Method&#34;,new Variant(args)).getBoolean();
调用多个参数依次类推，注意在传递参数前，将Java中的参数转换成Variant。
Demo链接： //download.csdn.net/download/aa2397199142/12038233 " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8296603d6328c2129e033d6468cee995/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-12-18T14:56:14+08:00" />
<meta property="article:modified_time" content="2019-12-18T14:56:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java开发调用C语言的DLL</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p> </p> 
<p style="margin-left:0cm;">通过Java调用OCX控件或者DLL有以下几种方法，使用JNI、JACOB、Jawin等技术完成接口调用；</p> 
<p style="margin-left:0cm;">1.JNI</p> 
<p style="margin-left:0cm;"><span style="color:#f33b45;">最直接的方式，也是最麻烦的方式</span>，需要自己完成所有的工作，不推荐。</p> 
<p style="margin-left:0cm;">2.Jawin</p> 
<p style="margin-left:0cm;">尝试了一下，效果不错，但相对来说，其编程风格<span style="color:#f33b45;">更贴近Windows，离Java有点远</span></p> 
<p style="margin-left:0cm;">3.Jacob</p> 
<p style="margin-left:0cm;"><span style="color:#f33b45;">使用Jacob非常方便，Java编程风格，需要了解的知识比较少</span>。<span style="color:#333333;">官方的解释是</span><span style="color:#333333;">Java COM Bridge</span><span style="color:#333333;">，即</span><span style="color:#333333;">java</span><span style="color:#333333;">和</span><br><span style="color:#333333;">com</span><span style="color:#333333;">组件间的桥梁（进一步了解</span><span style="color:#333333;">com/dcom: </span><span style="color:#3366cc;"><u><a href="http://docs.huihoo.com/com/" rel="nofollow">http://docs.huihoo.com/com/</a></u></span><span style="color:#333333;">）</span><br><span style="color:#333333;">com</span><span style="color:#333333;">一般表现为</span><span style="color:#333333;">dll</span><span style="color:#333333;">或</span><span style="color:#333333;">exe</span><span style="color:#333333;">等二进制文件</span></p> 
<p style="margin-left:0cm;">下载地址：  http://sourceforge.net/projects/jacob-project/     JACOB。e</p> 
<p style="margin-left:0cm;">Jacob的使用方法（<em><strong><span style="color:#f33b45;">64位的jacob组件对应 64为的OCX控件或者DLL文件</span></strong></em>）</p> 
<p style="margin-left:0cm;">1、<span style="color:#000000;">将jacob.jar</span><span style="color:#000000;">导入到开发项目（</span><span style="color:#f33b45;">开发项目为需要引用的dll接口的项目</span><span style="color:#000000;">）中，导入方法如下</span><a href="https://blog.csdn.net/zxz9900/article/details/99598807">https://blog.csdn.net/zxz9900/article/details/99598807</a><span style="color:#000000;">；</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">2、将jacob-1.xx-x64.dll</span><span style="color:#000000;">放到</span><span style="color:#000000;"> C:\Windows\System32</span><span style="color:#000000;">文件夹下（</span><span style="color:#ff0000;">注意：该</span><span style="color:#ff0000;">dll</span><span style="color:#ff0000;">必须与</span><span style="color:#ff0000;">jacob.jar</span><span style="color:#ff0000;">版本一致</span><span style="color:#000000;">）；</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">3、注册DLL文件，</span><span style="color:#f33b45;">regsvr32 D:\Code\EncryptionLibrary64.dll</span><span style="color:#000000;">；</span></p> 
<p style="margin-left:0cm;">      如果注册失败，提示没有入口的错误，请进行如下操作：</p> 
<p style="margin-left:0cm;">开始→所有程序→附件→右键点击命令提示符（CMD）→以管理员身份运行。</p> 
<p style="margin-left:0cm;">在DOS窗口中输入 regsvr32 msi.dll，提示成功，然后再执行 regsvr32 xx.dll</p> 
<p style="margin-left:0cm;">键盘操作win+r弹出运行框，输入  regedit  查看注册表；</p> 
<p><strong><em><span style="color:#000000;">注意：如果部分电脑不能注册，或者注册失败，</span></em></strong><span style="color:#000000;">可手动进行如下操作，</span>键盘操作win+r弹出运行框，输入  regedit  查看注册表，选中“计算机”根节点，选中“文件”菜单中的【导入】，<span style="color:#000000;">导入</span><span style="color:#000000;">dll</span><span style="color:#000000;">的注册文件（共两个注册文件，</span><span style="color:#000000;">ProgId.reg</span><span style="color:#000000;">与</span><span style="color:#000000;">CLSID.reg</span><span style="color:#000000;">），，导入完成后请查询“EncryptionLibrary64.EncryptionLibraryCom”，并修改注册文件中“InprocServer32</span><span style="color:#000000;">”与“</span><span style="color:#000000;">1.0.0.0</span><span style="color:#000000;">”中“</span><span style="color:#000000;">CodeBase</span><span style="color:#000000;">”参数中“</span><span style="color:#000000;">EncryptionLibrary64.dll</span><span style="color:#000000;">”的相关路径（</span><span style="color:#f33b45;">修改为dll文件在本地的路径</span><span style="color:#000000;">）；</span></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="379" src="https://images2.imgbox.com/0f/e4/umv2dvVL_o.png" width="800"></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">1.初始化 </p> 
<p style="margin-left:0cm;">ComThread.InitMTA(true);</p> 
<p style="margin-left:0cm;">ActiveXComponent com = new ActiveXComponent("组件的ProgID") ;</p> 
<p style="margin-left:0cm;">Dispatch disp = com.getObject();</p> 
<p style="margin-left:0cm;">2.调用控件里面的方面</p> 
<p style="margin-left:0cm;">2.1调用无参的方法，并返回一个short值</p> 
<p style="margin-left:0cm;">Dispatch.call(disp, "Init").getShort();</p> 
<p style="margin-left:0cm;">2.2调用有一个参数的方法，并返回一个boolean值</p> 
<p style="margin-left:0cm;">Dispatch.call(disp,"Method",new Variant(args)).getBoolean();</p> 
<p style="margin-left:0cm;">调用多个参数依次类推，注意在传递参数前，将Java中的参数转换成Variant。</p> 
<h3 style="margin-left:0cm;"><strong><span style="color:#f33b45;">Demo链接：</span></strong> //download.csdn.net/download/aa2397199142/12038233</h3>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d34fb8811d48796f919a17cd510be981/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">nvidia-smi命令很长时间才输出</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3a7d559baff5ccf8cef8ed98735d3c1e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Spark 异常总结及解决办法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>