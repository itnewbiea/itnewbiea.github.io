<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>LINQ 查询表达式（C# 编程指南） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="LINQ 查询表达式（C# 编程指南）" />
<meta property="og:description" content="语言集成查询 (LINQ) 是一组技术的名称，这些技术建立在将查询功能直接集成到 C# 语言（以及 Visual Basic 和可能的任何其他 .NET 语言）的基础上。 借助于 LINQ，查询现在已是高级语言构造，就如同类、方法、事件等等。 对于编写查询的开发人员来说，LINQ 最明显的“语言集成”部分是查询表达式。 查询表达式是使用 C# 3.0 中引入的声明性查询语法编写的。 通过使用查询语法，您甚至可以使用最少的代码对数据源执行复杂的筛选、排序和分组操作。 您使用相同的基本查询表达式模式来查询和转换 SQL 数据库、ADO.NET 数据集、XML 文档和流以及 .NET 集合中的数据。 下面的示例演示了完整的查询操作。 完整操作包括创建数据源、定义查询表达式，以及在 foreach 语句中执行查询。
class LINQQueryExpressions { static void Main() { // Specify the data source. int[] scores = new int[] { 97, 92, 81, 60 }; // Define the query expression. IEnumerable&lt;int&gt; scoreQuery = from score in scores where score &gt; 80 select score; // Execute the query." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/beeb8a8c107011e7aa0c07d42e585185/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-02-06T09:17:25+08:00" />
<meta property="article:modified_time" content="2017-02-06T09:17:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">LINQ 查询表达式（C# 编程指南）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>语言集成查询 (LINQ) 是一组技术的名称，这些技术建立在将查询功能直接集成到 C# 语言（以及 Visual Basic 和可能的任何其他 .NET 语言）的基础上。 借助于 LINQ，查询现在已是高级语言构造，就如同类、方法、事件等等。 <br> 对于编写查询的开发人员来说，<strong>LINQ 最明显的“语言集成”部分是查询表达式</strong>。 查询表达式是使用 C# 3.0 中引入的声明性查询语法编写的。 通过使用查询语法，您甚至可以使用最少的代码对数据源执行复杂的筛选、排序和分组操作。 您使用相同的基本查询表达式模式来查询和转换 SQL 数据库、ADO.NET 数据集、XML 文档和流以及 .NET 集合中的数据。 <br> 下面的示例演示了完整的查询操作。 完整操作包括创建数据源、定义查询表达式，以及在 foreach 语句中执行查询。</p> 
<pre class="prettyprint"><code class=" hljs cs">  class LINQQueryExpressions
    {
        <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> Main()
        {

            <span class="hljs-comment">// Specify the data source.</span>
            <span class="hljs-keyword">int</span>[] scores = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[] { <span class="hljs-number">97</span>, <span class="hljs-number">92</span>, <span class="hljs-number">81</span>, <span class="hljs-number">60</span> };

            <span class="hljs-comment">// Define the query expression.</span>
            IEnumerable&lt;<span class="hljs-keyword">int</span>&gt; scoreQuery =
                <span class="hljs-keyword">from</span> score <span class="hljs-keyword">in</span> scores
                <span class="hljs-keyword">where</span> score &gt; <span class="hljs-number">80</span>
                <span class="hljs-keyword">select</span> score;

            <span class="hljs-comment">// Execute the query.</span>
            <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">int</span> i <span class="hljs-keyword">in</span> scoreQuery)
            {
                Console.Write(i + <span class="hljs-string">" "</span>);
            }            
        }
    }
    <span class="hljs-comment">// Output: 97 92 81</span></code></pre> 
<h4 id="什么是查询它有什么用途"><strong>什么是查询？它有什么用途？</strong></h4> 
<p>“查询”是指一组指令，这些指令描述要从一个或多个给定数据源检索的数据以及返回的数据应该使用的格式和组织形式。 查询不同于它所产生的结果。 <br> 通常，源数据会在逻辑上组织为相同种类的元素序列。 SQL 数据库表包含一个行序列。 与此类似，ADO.NET DataTable 包含一个 DataRow 对象序列。 在 XML 文件中，有一个 XML 元素“序列”（不过这些元素按分层形式组织为树结构）。 内存中的集合包含一个对象序列。 <br> 从应用程序的角度来看，原始源数据的具体类型和结构并不重要。 应用程序始终将源数据视为一个 IEnumerable 或 IQueryable 集合。 在 LINQ to XML 中，源数据显示为一个 IEnumerable。 在 LINQ to DataSet 中，它是一个 IEnumerable。 在 LINQ to SQL 中，它是您定义用来表示 SQL 表中数据的任何自定义对象的 IEnumerable 或 IQueryable。</p> 
<p>指定此源序列后，查询可以进行下列三项工作之一：</p> 
<ul><li>检索一个元素子集以产生一个新序列，但不修改单个元素。 然后，查询可以按各种方式对返回的序列进行排序或分组，如下面的示例所示（假定 scores 是 int[]）：</li></ul> 
<pre class="prettyprint"><code class=" hljs cs">  IEnumerable&lt;<span class="hljs-keyword">int</span>&gt; highScoresQuery =
                <span class="hljs-keyword">from</span> score <span class="hljs-keyword">in</span> scores
                <span class="hljs-keyword">where</span> score &gt; <span class="hljs-number">80</span>
                <span class="hljs-keyword">orderby</span> score <span class="hljs-keyword">descending</span>
                <span class="hljs-keyword">select</span> score;</code></pre> 
<ul><li>如上一个示例所述检索一个元素序列，但是将这些元素转换为具有新类型的对象。 例如，查询可以只从数据源中的某些客户记录检索姓氏。 或者，查询可以检索完整的记录，再使用它构建另一个内存中对象类型甚至 XML 数据，然后生成最终的结果序列。 下面的示例演示了从 int 到 string 的转换。 请注意 highScoresQuery 的新类型。</li></ul> 
<pre class="prettyprint"><code class=" hljs cs"> IEnumerable&lt;<span class="hljs-keyword">string</span>&gt; highScoresQuery2 =
                <span class="hljs-keyword">from</span> score <span class="hljs-keyword">in</span> scores
                <span class="hljs-keyword">where</span> score &gt; <span class="hljs-number">80</span>
                <span class="hljs-keyword">orderby</span> score <span class="hljs-keyword">descending</span>
                <span class="hljs-keyword">select</span> String.Format(<span class="hljs-string">"The score is {0}"</span>, score);</code></pre> 
<ul><li>检索有关源数据的单一值，例如： <br> 
  <ul><li>符合某个条件的元素的数量。 <br> 符合某个条件的第一个元素，或一组指定元素中的特定值之和。 例如，下面的查询从 scores 整数数组中返回高于 80 的分数的数量。</li></ul></li></ul> 
<pre class="prettyprint"><code class=" hljs cs">   <span class="hljs-keyword">int</span> highScoreCount =
                (<span class="hljs-keyword">from</span> score <span class="hljs-keyword">in</span> scores
                 <span class="hljs-keyword">where</span> score &gt; <span class="hljs-number">80</span>
                 <span class="hljs-keyword">select</span> score)
                 .Count();</code></pre> 
<ul><li>在上一个示例中，请注意在 Count 方法调用之前的查询表达式两旁使用了括号。 另一种表示方式是使用一个新变量来存储具体结果。 此技术的可读性更好，因为它将存储查询的变量与存储结果的查询区分开来。</li></ul> 
<pre class="prettyprint"><code class=" hljs cs">     IEnumerable&lt;<span class="hljs-keyword">int</span>&gt; highScoresQuery3 =
                <span class="hljs-keyword">from</span> score <span class="hljs-keyword">in</span> scores
                <span class="hljs-keyword">where</span> score &gt; <span class="hljs-number">80</span>
                <span class="hljs-keyword">select</span> score;

            <span class="hljs-keyword">int</span> scoreCount = highScoresQuery3.Count();</code></pre> 
<p>在上一个示例中，查询是在 Count 调用中执行的，因为 Count 必须循环访问结果以便确定 highScoresQuery 返回的元素数量。</p> 
<h4 id="什么是查询表达式"><strong>什么是查询表达式？</strong></h4> 
<p>“查询表达式”是用查询语法表示的查询， 是一流的语言构造。 它就像任何其他表达式一样，并且可以用在 C# 表达式有效的任何上下文中。 查询表达式由一组用类似于 SQL 或 XQuery 的声明性语法编写的子句组成。 每个子句又包含一个或多个 C# 表达式，而这些表达式本身又可能是查询表达式或包含查询表达式。 <br> 查询表达式必须以 from 子句开头，并且必须以 select 或 group 子句结尾。 在第一个 from 子句和最后一个 select 或 group 子句之间，查询表达式可以包含一个或多个下列可选子句：where、orderby、join、let 甚至附加的 from 子句。 还可以使用 into 关键字使 join 或 group 子句的结果能够充当同一查询表达式中附加查询子句的源。</p> 
<h4 id="查询变量"><strong>查询变量</strong></h4> 
<p>在 LINQ 中，查询变量是任何存储查询（而非查询结果）的变量。更具体地说，查询变量始终是一个可枚举的类型，当在 foreach 语句中或在对其 IEnumerator.MoveNext 方法的直接调用中循环访问它时，它会生成一序列元素。 <br> 下面的代码示例演示了一个简单的查询表达式，它含有一个数据源、一个筛选子句和一个排序子句，但不对源元素进行转换。 select 子句结束了该查询。</p> 
<pre class="prettyprint"><code class=" hljs cs">  <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> Main()
        {
            <span class="hljs-comment">// Data source.</span>
            <span class="hljs-keyword">int</span>[] scores = { <span class="hljs-number">90</span>, <span class="hljs-number">71</span>, <span class="hljs-number">82</span>, <span class="hljs-number">93</span>, <span class="hljs-number">75</span>, <span class="hljs-number">82</span> };

            <span class="hljs-comment">// Query Expression.</span>
            IEnumerable&lt;<span class="hljs-keyword">int</span>&gt; scoreQuery = <span class="hljs-comment">//query variable</span>
                <span class="hljs-keyword">from</span> score <span class="hljs-keyword">in</span> scores <span class="hljs-comment">//required</span>
                <span class="hljs-keyword">where</span> score &gt; <span class="hljs-number">80</span> <span class="hljs-comment">// optional</span>
                <span class="hljs-keyword">orderby</span> score <span class="hljs-keyword">descending</span> <span class="hljs-comment">// optional</span>
                <span class="hljs-keyword">select</span> score; <span class="hljs-comment">//must end with select or group</span>

            <span class="hljs-comment">// Execute the query to produce the results</span>
            <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">int</span> testScore <span class="hljs-keyword">in</span> scoreQuery)
            {
                Console.WriteLine(testScore);
            }                  
        }
        <span class="hljs-comment">// Outputs: 93 90 82 82      </span></code></pre> 
<h4 id="标准的查询操作符"><strong>标准的查询操作符</strong></h4> 
<p><img src="https://images2.imgbox.com/64/48/sAneJgBt_o.jpg" alt="这里写图片描述" title=""> <br> <img src="https://images2.imgbox.com/da/34/5h6jODWQ_o.jpg" alt="这里写图片描述" title=""> <br> <img src="https://images2.imgbox.com/f9/1d/9ws1UCHR_o.jpg" alt="这里写图片描述" title=""> <br> <img src="https://images2.imgbox.com/e4/e6/JInY5ig3_o.jpg" alt="这里写图片描述" title=""></p> 
<blockquote> 
 <p><a href="https://msdn.microsoft.com/zh-cn/library/bb384065.aspx" rel="nofollow">https://msdn.microsoft.com/zh-cn/library/bb384065.aspx</a></p> 
</blockquote>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7f83b11dcf87d9069c5e67fa6fd302ff/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C. Two strings-二分的威力，思路题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a9aaeb117d630a300a6300ceff9ed01a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">android activity刚打开时内部动画卡顿问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>