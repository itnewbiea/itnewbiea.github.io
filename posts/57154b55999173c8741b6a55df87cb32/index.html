<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python&#43;OpenCV笔记（三十）：人脸检测与识别（二）——在静态图像与视频上进行人脸检测 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python&#43;OpenCV笔记（三十）：人脸检测与识别（二）——在静态图像与视频上进行人脸检测" />
<meta property="og:description" content="一、在静态图像上进行人脸检测 基本流程：
加载图片检测人脸绘制矩形 代码编写 import cv2 import matplotlib.pyplot as plt # 创建CascadeClassifier对象face_cascade，用于加载人脸级联检测 face_cascade = cv2.CascadeClassifier( &#39;C:/MyOpenCV/cascades/haarcascade_frontalface_default.xml&#39;) # 读取图片并转换为灰度图像（CascadeClassifier需要灰度图像） src = cv2.imread(&#39;C:/MyOpenCV/cascades/woodcutters.jpg&#39;) img = src.copy() gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY) # 进行实际的人脸检测 faces = face_cascade.detectMultiScale(gray, 1.08, 5) for (x, y, w, h) in faces: img = cv2.rectangle(img, (x, y), (x &#43; w, y &#43; h), (255, 0, 0), 2) # 显示图像 fig, axes = plt.subplots(nrows=1, ncols=2, figsize=(10, 8), dpi=100) axes[0].imshow(src[:, :, ::-1]) axes[0]." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/57154b55999173c8741b6a55df87cb32/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-30T16:04:24+08:00" />
<meta property="article:modified_time" content="2022-01-30T16:04:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python&#43;OpenCV笔记（三十）：人脸检测与识别（二）——在静态图像与视频上进行人脸检测</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、在静态图像上进行人脸检测</h2> 
<p>基本流程：</p> 
<ul><li>加载图片</li><li>检测人脸</li><li>绘制矩形</li></ul> 
<h4>代码编写</h4> 
<pre><code>import cv2
import matplotlib.pyplot as plt

# 创建CascadeClassifier对象face_cascade，用于加载人脸级联检测
face_cascade = cv2.CascadeClassifier(
    'C:/MyOpenCV/cascades/haarcascade_frontalface_default.xml')

# 读取图片并转换为灰度图像（CascadeClassifier需要灰度图像）
src = cv2.imread('C:/MyOpenCV/cascades/woodcutters.jpg')
img = src.copy()
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)

# 进行实际的人脸检测
faces = face_cascade.detectMultiScale(gray, 1.08, 5)
for (x, y, w, h) in faces:
    img = cv2.rectangle(img, (x, y), (x + w, y + h), (255, 0, 0), 2)

# 显示图像
fig, axes = plt.subplots(nrows=1, ncols=2, figsize=(10, 8), dpi=100)
axes[0].imshow(src[:, :, ::-1])
axes[0].set_title("原图")
axes[1].imshow(img[:, :, ::-1])
axes[1].set_title("人脸检测后的图像")
plt.show()</code></pre> 
<p><strong>说明：</strong></p> 
<p><span style="color:#4da8ee;"><em>1. OpenCV API：</em></span></p> 
<pre><code>faces = face_cascade.detectMultiScale(image, scaleFactor, minNeighbors, minSize, maxSize)</code></pre> 
<p>参数：</p> 
<ul><li>image：要进行检测的人脸图像（灰度图像）</li><li>scaleFactor：前后两次扫描中，搜索窗口的比例系数，参数应大于1.0，确定人脸检测过程中每次迭代时图像的降尺度比率。</li><li>minNeighbors：目标至少被检测到 minNeighbors 次才会被认为是目标。</li><li>minSize、maxSize：目标的最小尺寸和最大尺寸。</li></ul> 
<p>返回值：</p> 
<ul><li>faces ：返回的是一个人脸矩形的元组列表（x, y, w, h）</li></ul> 
<p><span style="color:#4da8ee;"><em>2.结果：</em></span></p> 
<p><img alt="" height="814" src="https://images2.imgbox.com/1d/69/UzJQOzpx_o.png" width="1200"></p> 
<p> 图片可从如下网址获取：<a href="https://github.com/PacktPublishing/Learning-OpenCV-4-Computer-Vision-with-Python-Third-Edition/blob/master/images/woodcutters.jpg" title="Learning-OpenCV-4-Computer-Vision-with-Python-Third-Edition/woodcutters.jpg at master · PacktPublishing/Learning-OpenCV-4-Computer-Vision-with-Python-Third-Edition · GitHub">Learning-OpenCV-4-Computer-Vision-with-Python-Third-Edition/woodcutters.jpg at master · PacktPublishing/Learning-OpenCV-4-Computer-Vision-with-Python-Third-Edition · GitHub</a></p> 
<p>缺少 haarcascade_frontalface_default.xml 等类似文件的可从如下网址获取：</p> 
<p><a href="https://github.com/PacktPublishing/Learning-OpenCV-4-Computer-Vision-with-Python-Third-Edition/tree/master/chapter05/cascades" title="Learning-OpenCV-4-Computer-Vision-with-Python-Third-Edition/chapter05/cascades at master · PacktPublishing/Learning-OpenCV-4-Computer-Vision-with-Python-Third-Edition · GitHub">Learning-OpenCV-4-Computer-Vision-with-Python-Third-Edition/chapter05/cascades at master · PacktPublishing/Learning-OpenCV-4-Computer-Vision-with-Python-Third-Edition · GitHub</a></p> 
<h2></h2> 
<h2>二、在视频上进行人脸识别</h2> 
<p>基本流程：</p> 
<ul><li>获取视频文件 / 摄像头回传信号</li><li>读取一帧图像</li><li>检测人脸</li><li>在检测到的人脸内检测眼睛</li><li>分别绘制矩形</li></ul> 
<h4>代码编写</h4> 
<pre><code>import cv2 as cv

# 初始化两个CascadeClassifier对象，分别用于人脸和眼睛
face_cascade = cv.CascadeClassifier(
    'C:/MyOpenCV/cascades/haarcascade_frontalface_default.xml')
eye_cascade = cv.CascadeClassifier(
    'C:/MyOpenCV/cascades/haarcascade_eye.xml')

camera = cv.VideoCapture(0)
while (cv.waitKey(1) == -1):
    success, frame = camera.read()
    if success:
        gray = cv.cvtColor(frame, cv.COLOR_BGR2GRAY)
        faces = face_cascade.detectMultiScale(
            gray, 1.3, 5, minSize=(120, 120))
        for (x, y, w, h) in faces:
            cv.rectangle(frame, (x, y), (x + w, y + h), (255, 0, 0), 2)
            roi_gray = gray[y:y + h, x:x + w]
            eyes = eye_cascade.detectMultiScale(
                roi_gray, 1.1, 5, minSize=(40, 40))
            for (ex, ey, ew, eh) in eyes:
                cv.rectangle(frame, (x + ex, y + ey),
                             (x + ex + ew, y + ey + eh), (0, 255, 0), 2)
        cv.imshow('Face Detection', frame)

camera.release()
cv.destroyAllWindows()</code></pre> 
<p>眼睛检测器的准确率要比人脸检测器的准确率低一些，我们可以随意更改 minSize 和 maxSize 参数来避免那些不太可能是眼睛的误报。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4947a01a93d07239490267b0f9df12a6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Vim编辑器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fba4fce89359ea52f36916cc2f5a125e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Makefile基础</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>