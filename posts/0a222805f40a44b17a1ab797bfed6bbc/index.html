<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>阅读Decoupled Spatial-Temporal Attention Network for Skeleton-Based Action Recognition - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="阅读Decoupled Spatial-Temporal Attention Network for Skeleton-Based Action Recognition" />
<meta property="og:description" content="基于骨骼动作识别的解耦时空注意网络
paper：https://arxiv.org/abs/2007.03263
文章目录 AbstractIntroductionMethod3.1 Spatial-temporal attention module 3.2 Decoupled Position encoding3.3 Spatial global regularization3.4 Complete attention module3.5 Overall architecture3.6 Data decoupling 后续补充 Abstract 以人体关节二维/三维坐标表示的动态骨骼数据，由于其高层次的语义信息和环境鲁棒性，在人体动作识别中得到了广泛的研究。然而，以往的方法在很大程度上依赖于手工设计遍历规则或图拓扑来绘制关节之间的依赖关系，这在性能和泛化方面都受到了限制。在这项工作中，我们提出了一种新的解耦时空注意网络（DSTA-Net），用于基于骨架的动作识别。它只涉及注意块，允许建模关节之间的时空依赖关系，而不需要知道它们的位置或相互连接。具体来说，针对骨骼数据的具体要求，提出了三种注意块构建技术，即时空注意解耦、解耦位置编码和空间全局正则化。此外，在数据方面，我们引入了骨骼数据解耦技术，以强调空间/时间和不同运动尺度的具体特征，从而对人类行为有更全面的了解。为了验证该方法的有效性，在四个具有挑战性的基于骨架的手势和动作识别数据集SHREC、DHG、NTU-60和NTU-120上进行了大量的实验，其中DSTA网络在所有这些数据集上都取得了SOTA。
Introduction 手工编制的规则是关节全局依赖建模并非最佳选择，作者阐述近年来transformer的自我注意力机制取得了很大的成功。自注意力机制可以降低计算复杂度，并提高全局依赖关系，而且不需要指导元素的内在关系，为发现有用模式提供更大的灵活性。
作者提出了一种新的解耦时空注意网络(DSTA-Net), 模型并没有用与结构相关的RNNs、CNNs或GCNs。但是根据注意力网络自我发现骨骼数据关联的难点如下：
(1) 原始自我注意机制的输入是序列数据，而骨架数据同时存在于空间和时间维度。一种简单的方法是简单地将时空数据展平成一个单一的序列。然而，将时间和空间等同对待是不合理的，因为它们包含完全不同的语义。此外，简单的展平操作增加了序列长度，由于自注意机制的点积运算，大大增加了计算成本。相反，我们建议将自我注意机制依次分解为空间注意和时间注意。为了平衡空间与时间的独立性和互动性，我们专门设计了三种策略。(2) 当将骨骼关节送入注意网络时，没有预定义的顺序或结构。为了给每个关节提供唯一的标记，引入了一种位置编码技术。基于同样的原因，它也被分解成空间编码和时间编码。(3) 结果表明，在先验知识的基础上加入适当的正则化，可以有效地减少过拟合问题，提高模型的泛化能力。例如，由于图像具有平移不变的结构，CNNs利用局部加权机制来迫使模型学习更多针对图像不同区域的通用滤波器。对于骨骼数据，骨骼的每个关节都有特定的物理/语义意义（如头或手），对于所有的帧都是固定的，对于所有的数据样本都是一致的。基于这一先验知识，提出了一种空间全局正则化方法，使模型能够针对不同的样本学习更多的一般注意事项。注意正则化不适用于时间维，因为没有这样的语义对齐特性。 另外，从数据的角度来看，对于不同的行为，不同的模式区别是明显的。我们主张应考虑两种性质。一个特征是动作是与动作相关还是与动作无关,选择特定的时空特征。例如，在对“向上挥手”和“向下挥手”手势进行分类时，手的全局轨迹比手形更重要，但在识别“一指一指”和“两指点”等手势时，空间模式比手势更重要。在此基础上，我们提出将数据分解为空间和时间两个维度，其中空间流只包含与运动无关的特征，而时间流只包含与运动相关的特征。通过分别对这两个流进行建模，该模型可以更好地关注空间/时间特征和特定于身份的模式。最后，通过融合这两条信息流，可以更全面地了解人类的行为。另一个特性是运动尺度的敏感性。对于时间流，一些动作的分类依赖于几个连续帧的运动模式，而另一些则依赖于整体运动趋势。例如，要将“鼓掌”与“双手合十”这两种手势进行分类，短期动作细节至关重要。但对于“向上挥手”与“向下挥手”，长期运动趋势更为重要。因此，我们根据采样率将时间信息分为快流和慢流。低帧速率流可以捕获更多关于全局运动的信息，而高帧速率流可以更关注细节运动。同样，对两个流进行融合，以提高识别性能。
作者在四个数据集上进行了大量的实验，包括两个手势识别数据集SHREC和DHG，以及两个人类动作识别数据集，即NTU-60和NTU-120。在不需要手工编制遍历规则或图拓扑的情况下，作者的方法在所有这些数据集上都达到了SOTA，这证明了该方法的有效性和可推广性。
作者的贡献共四个方面:
据我们所知，作者首次提出了一种用于基于骨架的动作识别的解耦时空注意网络（DSTA-Net），该网络由纯注意模块构成，无需人工设计遍历规则或图拓扑；我们提出了三种有效的建立注意网络的技术，即时空注意解耦、解耦位置编码和空间全局正则化；我们提出将数据分解为四个流，即时空流、空间流、慢时流和快时流，每一个流都集中在骨架序列的一个特定方面。通过融合不同类型的特征，该模型可以对人类行为有更全面的理解。在四个具有挑战性的动作识别数据集上，我们的方法达到了最先进的性能和显著的优势。在SHREC和DHG的14类/28类基准测试中，DSTA Net的表现分别优于SOTA 2.6%/3.2%和1.9%/2.9%。分别达到91.5%/96.4%和86.6%/89.0%分别是NTU-60和NTU-120的CS/CV基准。 Method 3.1 Spatial-temporal attention module 原始transformer由序列数据fed，即矩阵 X ∈ R N × C X \in \mathbb R^{N\times C} X∈RN×C，其中 N N N表示元素个数， C C C表示通道数.对于动态骨骼数据，输入是一个3阶张量 X ∈ R N × T × C X \in \mathbb R^{N\times T \times C} X∈RN×T×C，其中 T T T表示帧数。如何处理时间与空间的关系，是一个值得探讨的问题。Wang等人建议忽略时间和空间的差异，将输入视为一个连续的数据 X ∈ R N ^ × C X \in \mathbb R^{\hat N\times C} X∈RN^×C，，其中 N ^ = N T \hat N=N T N^=NT，但是时间维和空间维是完全不同的, 把它们等同对待是不合理的。此外，该策略计算注意映射的计算复杂度为 O ( T 2 N 2 C ) O(T^2N^2C) O(T2N2C)（采用朴素矩阵乘法算法），计算复杂度过大。相反，我们建议将空间和时间维度解耦，这样可以大大降低计算复杂度并提高性能." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/0a222805f40a44b17a1ab797bfed6bbc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-01T17:49:35+08:00" />
<meta property="article:modified_time" content="2020-08-01T17:49:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">阅读Decoupled Spatial-Temporal Attention Network for Skeleton-Based Action Recognition</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>基于骨骼动作识别的解耦时空注意网络<br> paper：<a href="https://arxiv.org/abs/2007.03263" rel="nofollow">https://arxiv.org/abs/2007.03263</a></p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#Abstract_5" rel="nofollow">Abstract</a></li><li><a href="#Introduction_7" rel="nofollow">Introduction</a></li><li><a href="#Method_21" rel="nofollow">Method</a></li><li><ul><li><a href="#31__Spatialtemporal_attention_module_22" rel="nofollow">3.1 Spatial-temporal attention module</a></li></ul> 
  </li><li><a href="#32__Decoupled_Position_encoding_29" rel="nofollow">3.2 Decoupled Position encoding</a></li><li><ul><li><a href="#33__Spatial_global_regularization_37" rel="nofollow">3.3 Spatial global regularization</a></li><li><a href="#34__Complete_attention_module_39" rel="nofollow">3.4 Complete attention module</a></li><li><a href="#35__Overall_architecture_43" rel="nofollow">3.5 Overall architecture</a></li><li><a href="#36__Data_decoupling_45" rel="nofollow">3.6 Data decoupling</a></li></ul> 
  </li><li><a href="#_49" rel="nofollow">后续补充</a></li></ul> 
</div> 
<p></p> 
<h2><a id="Abstract_5"></a>Abstract</h2> 
<p>  以人体关节二维/三维坐标表示的动态骨骼数据，由于其高层次的语义信息和环境鲁棒性，在人体动作识别中得到了广泛的研究。然而，以往的方法在很大程度上依赖于手工设计遍历规则或图拓扑来绘制关节之间的依赖关系，这在性能和泛化方面都受到了限制。在这项工作中，我们提出了一种新的解耦时空注意网络（DSTA-Net），用于基于骨架的动作识别。它只涉及注意块，允许建模关节之间的时空依赖关系，而不需要知道它们的位置或相互连接。具体来说，针对骨骼数据的具体要求，提出了三种注意块构建技术，即时空注意解耦、解耦位置编码和空间全局正则化。此外，在数据方面，我们引入了骨骼数据解耦技术，以强调空间/时间和不同运动尺度的具体特征，从而对人类行为有更全面的了解。为了验证该方法的有效性，在四个具有挑战性的基于骨架的手势和动作识别数据集SHREC、DHG、NTU-60和NTU-120上进行了大量的实验，其中DSTA网络在所有这些数据集上都取得了SOTA。</p> 
<h2><a id="Introduction_7"></a>Introduction</h2> 
<p>  手工编制的规则是关节全局依赖建模并非最佳选择，作者阐述近年来transformer的自我注意力机制取得了很大的成功。自注意力机制可以降低计算复杂度，并提高全局依赖关系，而且不需要指导元素的内在关系，为发现有用模式提供更大的灵活性。<br>   作者提出了一种新的解耦时空注意网络(DSTA-Net), 模型并没有用与结构相关的RNNs、CNNs或GCNs。但是根据注意力网络自我发现骨骼数据关联的难点如下：</p> 
<ul><li>(1) 原始自我注意机制的输入是序列数据，而骨架数据同时存在于空间和时间维度。一种简单的方法是简单地将时空数据展平成一个单一的序列。然而，将时间和空间等同对待是不合理的，因为它们包含完全不同的语义。此外，简单的展平操作增加了序列长度，由于自注意机制的点积运算，大大增加了计算成本。相反，我们建议将自我注意机制依次分解为空间注意和时间注意。为了平衡空间与时间的独立性和互动性，我们专门设计了三种策略。</li><li>(2) 当将骨骼关节送入注意网络时，没有预定义的顺序或结构。为了给每个关节提供唯一的标记，引入了一种位置编码技术。基于同样的原因，它也被分解成空间编码和时间编码。</li><li>(3) 结果表明，在先验知识的基础上加入适当的正则化，可以有效地减少过拟合问题，提高模型的泛化能力。例如，由于图像具有平移不变的结构，CNNs利用局部加权机制来迫使模型学习更多针对图像不同区域的通用滤波器。对于骨骼数据，骨骼的每个关节都有特定的物理/语义意义（如头或手），对于所有的帧都是固定的，对于所有的数据样本都是一致的。基于这一先验知识，提出了一种空间全局正则化方法，使模型能够针对不同的样本学习更多的一般注意事项。注意正则化不适用于时间维，因为没有这样的语义对齐特性。</li></ul> 
<p>  另外，从数据的角度来看，对于不同的行为，不同的模式区别是明显的。我们主张应考虑两种性质。一个特征是动作是与动作相关还是与动作无关,选择特定的时空特征。例如，在对“向上挥手”和“向下挥手”手势进行分类时，手的全局轨迹比手形更重要，但在识别“一指一指”和“两指点”等手势时，空间模式比手势更重要。在此基础上，我们提出将数据分解为空间和时间两个维度，其中空间流只包含与运动无关的特征，而时间流只包含与运动相关的特征。通过分别对这两个流进行建模，该模型可以更好地关注空间/时间特征和特定于身份的模式。最后，通过融合这两条信息流，可以更全面地了解人类的行为。另一个特性是运动尺度的敏感性。对于时间流，一些动作的分类依赖于几个连续帧的运动模式，而另一些则依赖于整体运动趋势。例如，要将“鼓掌”与“双手合十”这两种手势进行分类，短期动作细节至关重要。但对于“向上挥手”与“向下挥手”，长期运动趋势更为重要。因此，我们根据采样率将时间信息分为快流和慢流。低帧速率流可以捕获更多关于全局运动的信息，而高帧速率流可以更关注细节运动。同样，对两个流进行融合，以提高识别性能。<br>   作者在四个数据集上进行了大量的实验，包括两个手势识别数据集SHREC和DHG，以及两个人类动作识别数据集，即NTU-60和NTU-120。在不需要手工编制遍历规则或图拓扑的情况下，作者的方法在所有这些数据集上都达到了SOTA，这证明了该方法的有效性和可推广性。<br> 作者的贡献共四个方面:</p> 
<ol><li>据我们所知，作者首次提出了一种用于基于骨架的动作识别的解耦时空注意网络（DSTA-Net），该网络由纯注意模块构成，无需人工设计遍历规则或图拓扑；</li><li>我们提出了三种有效的建立注意网络的技术，即时空注意解耦、解耦位置编码和空间全局正则化；</li><li>我们提出将数据分解为四个流，即时空流、空间流、慢时流和快时流，每一个流都集中在骨架序列的一个特定方面。通过融合不同类型的特征，该模型可以对人类行为有更全面的理解。</li><li>在四个具有挑战性的动作识别数据集上，我们的方法达到了最先进的性能和显著的优势。在SHREC和DHG的14类/28类基准测试中，DSTA Net的表现分别优于SOTA 2.6%/3.2%和1.9%/2.9%。分别达到91.5%/96.4%和86.6%/89.0%分别是NTU-60和NTU-120的CS/CV基准。</li></ol> 
<h2><a id="Method_21"></a>Method</h2> 
<h3><a id="31__Spatialtemporal_attention_module_22"></a>3.1 Spatial-temporal attention module</h3> 
<p>  原始transformer由序列数据fed，即矩阵<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
         ∈ 
        
        
        
          R 
         
         
         
           N 
          
         
           × 
          
         
           C 
          
         
        
       
      
        X \in \mathbb R^{N\times C} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10903em;">N</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span></span></span></span></span></span></span></span></span>，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         N 
        
       
      
        N 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span></span></span></span></span>表示元素个数，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         C 
        
       
      
        C 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span></span></span></span></span>表示通道数.对于动态骨骼数据，输入是一个3阶张量<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
         ∈ 
        
        
        
          R 
         
         
         
           N 
          
         
           × 
          
         
           T 
          
         
           × 
          
         
           C 
          
         
        
       
      
        X \in \mathbb R^{N\times T \times C} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10903em;">N</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span></span></span></span></span></span></span></span></span>，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         T 
        
       
      
        T 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span>表示帧数。如何处理时间与空间的关系，是一个值得探讨的问题。Wang等人建议忽略时间和空间的差异，将输入视为一个连续的数据<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
         ∈ 
        
        
        
          R 
         
         
          
          
            N 
           
          
            ^ 
           
          
         
           × 
          
         
           C 
          
         
        
       
      
        X \in \mathbb R^{\hat N\times C} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.02574em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.02574em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class="mord mathdefault mtight" style="margin-right: 0.10903em;">N</span></span><span class="" style="top: -2.95233em;"><span class="pstrut" style="height: 2.7em;"></span><span class="accent-body" style="left: -0.16666em;"><span class="mtight">^</span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span></span></span></span></span></span></span></span></span>，，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          N 
         
        
          ^ 
         
        
       
         = 
        
       
         N 
        
       
         T 
        
       
      
        \hat N=N T 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.94677em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94677em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span></span><span class="" style="top: -3.25233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;">^</span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span>，但是时间维和空间维是完全不同的, 把它们等同对待是不合理的。此外，该策略计算注意映射的计算复杂度为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         O 
        
       
         ( 
        
        
        
          T 
         
        
          2 
         
        
        
        
          N 
         
        
          2 
         
        
       
         C 
        
       
         ) 
        
       
      
        O(T^2N^2C) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mclose">)</span></span></span></span></span>（采用朴素矩阵乘法算法），计算复杂度过大。相反，我们建议将空间和时间维度解耦，这样可以大大降低计算复杂度并提高性能.<br> <img src="https://images2.imgbox.com/6a/b5/DtaODD9e_o.png" alt="在这里插入图片描述"><br>   作者设计了三种解耦策略，如图1所示。以空间注意为例，第一策略（图1，a）逐帧计算注意映射，每个帧使用唯一的注意映射：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
           
            
            
              A 
             
            
              t 
             
            
           
             = 
            
           
             s 
            
           
             o 
            
           
             f 
            
           
             t 
            
           
             m 
            
           
             a 
            
           
             x 
            
           
             ( 
            
           
             σ 
            
           
             ( 
            
            
            
              X 
             
            
              t 
             
            
           
             ) 
            
           
             ϕ 
            
           
             ( 
            
            
            
              X 
             
            
              t 
             
            
            
            
              ) 
             
            
              ′ 
             
            
           
             ) 
            
           
          
          
          
          
            (2) 
           
          
         
        
       
         A^t=softmax(\sigma(X_t)\phi(X_t)')\tag{2} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.843556em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.843556em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.05189em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height: 1.09356em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span></span>其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          A 
         
        
          t 
         
        
       
         ∈ 
        
        
        
          R 
         
         
         
           N 
          
         
           × 
          
         
           N 
          
         
        
       
      
        A^t \in \mathbb R^{N\times N} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.832656em; vertical-align: -0.0391em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10903em;">N</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.10903em;">N</span></span></span></span></span></span></span></span></span></span></span></span></span>是t帧的注意映射，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          X 
         
        
          t 
         
        
       
         ∈ 
        
        
        
          R 
         
         
         
           N 
          
         
           × 
          
         
           C 
          
         
        
       
      
        X_t \in R^{N\times C} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10903em;">N</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span></span></span></span></span></span></span></span></span>。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         σ 
        
       
      
        \sigma 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">σ</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ϕ 
        
       
      
        \phi 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">ϕ</span></span></span></span></span>是两个嵌入函数。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
        
          ′ 
         
        
       
      
        ' 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class=""></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span>表示矩阵转置。该策略只考虑单帧中节点的相关性，缺乏建模能力。该策略计算空间注意的计算复杂度为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         O 
        
       
         ( 
        
       
         T 
        
        
        
          N 
         
        
          2 
         
        
       
         C 
        
       
         ) 
        
       
      
        O(TN^2C) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mclose">)</span></span></span></span></span>。对于时间注意，n个关节的注意映射为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          A 
         
        
          n 
         
        
       
         ∈ 
        
        
        
          R 
         
         
         
           T 
          
         
           × 
          
         
           C 
          
         
        
       
      
        A^n\in \mathbb R^{T\times C} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span></span></span></span></span></span></span></span></span>，输入数据为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          X 
         
        
          n 
         
        
       
         ∈ 
        
        
        
          R 
         
         
         
           T 
          
         
           ∈ 
          
         
           C 
          
         
        
       
      
        X_n\in \mathbb R^{T\in C} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span></span></span></span></span></span></span></span></span>，其计算与空间注意相似。考虑到空间和时间的注意，第一种策略对所有帧的计算复杂度为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         O 
        
       
         ( 
        
       
         T 
        
        
        
          N 
         
        
          2 
         
        
       
         C 
        
       
         + 
        
       
         N 
        
        
        
          T 
         
        
          2 
         
        
       
         C 
        
       
         ) 
        
       
      
        O(TN^2C+NT^2C) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mclose">)</span></span></span></span></span>。<br>   第二种策略（图1，b）是计算所有帧之间的两个关节的关系，这意味着同时考虑两个关节的帧内关系和帧间关系。注意力图在所有帧上共享。<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
           
            
            
              A 
             
            
              t 
             
            
           
             = 
            
           
             s 
            
           
             o 
            
           
             f 
            
           
             t 
            
           
             m 
            
           
             a 
            
           
             x 
            
           
             ( 
            
            
            
              ∑ 
             
            
              t 
             
            
              T 
             
            
            
            
              ∑ 
             
            
              τ 
             
            
              T 
             
            
           
             ( 
            
           
             σ 
            
           
             ( 
            
            
            
              X 
             
            
              t 
             
            
           
             ) 
            
           
             ϕ 
            
           
             ( 
            
            
            
              X 
             
            
              τ 
             
            
            
            
              ) 
             
            
              ′ 
             
            
           
             ) 
            
           
             ) 
            
           
          
          
          
          
            (3) 
           
          
         
        
       
         A^t=softmax(\sum_t^T\sum_\tau ^T(\sigma(X_t)\phi(X_\tau)'))\tag3 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.843556em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.843556em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.07834em; vertical-align: -1.25001em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.89999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25001em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.89999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.1132em;">τ</span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25001em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height: 3.07834em; vertical-align: -1.25001em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">3</span></span><span class="mord">)</span></span></span></span></span></span></span>这种策略的计算复杂度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         O 
        
       
         ( 
        
        
        
          T 
         
        
          2 
         
        
        
        
          N 
         
        
          2 
         
        
       
         C 
        
       
         + 
        
        
        
          N 
         
        
          2 
         
        
        
        
          T 
         
        
          2 
         
        
       
         C 
        
       
         ) 
        
       
      
        O(T^2N^2C+N^2T^2C) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mclose">)</span></span></span></span></span><br>   第三种策略（图1，c）是一种折衷方案，其中只考虑同一帧中的关节来计算注意映射，但是获得的所有帧的注意映射是平均和共享的。这相当于在注意力计算中增加了一个时间一致性约束，这在一定程度上减少了第二种策略的元级关系建模带来的过拟合问题。<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
           
            
            
              A 
             
            
              t 
             
            
           
             = 
            
           
             s 
            
           
             o 
            
           
             f 
            
           
             t 
            
           
             m 
            
           
             a 
            
           
             x 
            
           
             ( 
            
            
            
              ∑ 
             
            
              t 
             
            
              T 
             
            
           
             ( 
            
           
             σ 
            
           
             ( 
            
            
            
              X 
             
            
              t 
             
            
           
             ) 
            
           
             ϕ 
            
           
             ( 
            
            
            
              X 
             
            
              t 
             
            
            
            
              ) 
             
            
              ′ 
             
            
           
             ) 
            
           
             ) 
            
           
          
          
          
          
            (4) 
           
          
         
        
       
         A^t=softmax(\sum_t^T(\sigma(X_t)\phi(X_t)'))\tag4 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.843556em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.843556em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.07834em; vertical-align: -1.25001em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.89999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25001em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.07847em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height: 3.07834em; vertical-align: -1.25001em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">4</span></span><span class="mord">)</span></span></span></span></span></span></span><br>   通过将帧连接成<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         N 
        
       
         × 
        
       
         T 
        
       
         C 
        
       
      
        N\times TC 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span></span></span></span></span>矩阵，可以用一个大的矩阵乘法运算来高效地实现矩阵乘法的求和。该策略的计算复杂度为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         O 
        
       
         ( 
        
       
         T 
        
        
        
          N 
         
        
          2 
         
        
       
         C 
        
       
         + 
        
       
         N 
        
        
        
          T 
         
        
          2 
         
        
       
         C 
        
       
         ) 
        
       
      
        O(TN^2C+NT^2C) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mclose">)</span></span></span></span></span>。如消融研究4.3所示，我们最终在模型中使用策略（c）。</p> 
<h2><a id="32__Decoupled_Position_encoding_29"></a>3.2 Decoupled Position encoding</h2> 
<p>  骨骼关节被组织成张量输入神经网络。由于张量的每个元素没有预先定义的顺序或结构来显示其身份（例如，关节索引或帧索引），我们需要一个位置编码模块来为每个关节提供唯一的标记。我们使用不同频率的正弦和余弦函数作为编码函数：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
           
            
             
              
               
              
             
             
              
               
                
               
                 P 
                
               
                 E 
                
               
                 ( 
                
               
                 p 
                
               
                 , 
                
               
                 2 
                
               
                 i 
                
               
                 ) 
                
               
                 = 
                
               
                 sin 
                
               
                 ⁡ 
                
               
                 ( 
                
               
                 p 
                
               
                 / 
                
               
                 1000 
                
                
                
                  0 
                 
                 
                 
                   2 
                  
                 
                   i 
                  
                 
                   / 
                  
                  
                  
                    C 
                   
                   
                   
                     i 
                    
                   
                     n 
                    
                   
                  
                 
                
               
                 ) 
                
               
              
             
            
            
             
              
               
              
             
             
              
               
                
               
                 P 
                
               
                 E 
                
               
                 ( 
                
               
                 p 
                
               
                 , 
                
               
                 2 
                
               
                 i 
                
               
                 + 
                
               
                 1 
                
               
                 ) 
                
               
                 = 
                
               
                 cos 
                
               
                 ⁡ 
                
               
                 ( 
                
               
                 p 
                
               
                 / 
                
               
                 1000 
                
                
                
                  0 
                 
                 
                 
                   2 
                  
                 
                   i 
                  
                 
                   / 
                  
                  
                  
                    C 
                   
                   
                   
                     i 
                    
                   
                     n 
                    
                   
                  
                 
                
               
                 ) 
                
               
              
             
            
           
          
          
          
          
            (5) 
           
          
         
        
       
         \begin{aligned} &amp; PE(p,2i) = \sin(p/10000^{2i/C_{in}})\\ &amp; PE(p,2i + 1) = \cos(p/10000^{2i/C_{in}}) \end{aligned}\tag 5 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 3.196em; vertical-align: -1.348em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.848em;"><span class="" style="top: -3.848em;"><span class="pstrut" style="height: 2.938em;"></span><span class="mord"></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 2.938em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.348em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.848em;"><span class="" style="top: -3.91em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault" style="margin-right: 0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord">/</span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">i</span><span class="mord mtight">/</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: -0.07153em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -2.312em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault" style="margin-right: 0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord">/</span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">i</span><span class="mord mtight">/</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: -0.07153em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.348em;"><span class=""></span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height: 3.196em; vertical-align: -1.348em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">5</span></span><span class="mord">)</span></span></span></span></span></span></span>其中p表示元素的位置，i表示位置编码向量的维数。然而，与文献[31]不同的是，骨骼数据的输入有两个维度，即空间和时间。位置编码的一种策略是将空间和时间维度统一并按顺序编码。例如，假设有三个关节点，第一帧的关节点位置为1,2,3，第二帧的关节位置为4,5,6。这种策略不能很好地区分不同帧中的同一关节。另一种策略是将过程分解为空间位置编码和时间位置编码。以空间位置编码为例，对同一帧中的关节进行顺序编码，不同帧中的相同关节具有相同的编码。在上面的例子中，这意味着第一帧的位置是1,2,3，而对于第二帧，位置也是1,2,3。对于时间位置编码，它是反向的和类比的，即同一帧中的关节具有相同的编码，并且不同帧中的相同关节按顺序编码。最后，如图2所示，将位置特征添加到输入数据中。这样，每一个元素都有一个独特的标记来帮助学习关节之间的相互关系，并且空间和时间的差异也得到了很好的表达。<br> <img src="https://images2.imgbox.com/75/6e/iAKPsmEm_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="33__Spatial_global_regularization_37"></a>3.3 Spatial global regularization</h3> 
<p>  如第1节所述,每个关节都有特定的含义。基于这一先验知识，我们建议加入一个空间全局正则化，以迫使模型学习更多关于不同样本的一般注意事项。具体来说，在第二节介绍的点积注意机制学习到的注意图（N×N矩阵）中加入一个全局注意映射（N×N矩阵）。所有的数据样本共享全局注意力图，它代表了人体关节统一的内在关系模式。将其作为网络的参数，与模型一起进行优化。乘以α来平衡空间全局正则化的强度。该模块结构简单、重量轻，但在烧蚀实验中显示它是有效的。注意，正则化只是为了计算空间注意而添加的，因为时间维度没有这样的语义对齐特性。强制对时间注意进行全局正则化是不合理的，并且会损害性能。</p> 
<h3><a id="34__Complete_attention_module_39"></a>3.4 Complete attention module</h3> 
<p>  由于空间注意模块和时间注意模块是相似的，因此我们选择空间模块作为例子进行详细的介绍。完整的注意模块如图2所示。紫色圆形矩形框内的程序说明了单头注意力计算的过程。输入<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
         ∈ 
        
        
        
          R 
         
         
         
           N 
          
         
           × 
          
         
           T 
          
          
          
            C 
           
           
           
             i 
            
           
             n 
            
           
          
         
        
       
      
        X\in \mathbb R^{N\times TC_{in}} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10903em;">N</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: -0.07153em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>首先加上空间位置编码。然后在<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
         ∈ 
        
        
        
          R 
         
         
         
           N 
          
         
           × 
          
         
           T 
          
          
          
            C 
           
          
            e 
           
          
         
        
       
      
        X\in \mathbb R^{N\times TC_{e}} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathdefault" style="margin-right: 0.07847em;">X</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10903em;">N</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-left: -0.07153em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>上嵌入两个线性映射函数。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          C 
         
        
          e 
         
        
       
      
        C_{e} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>通常比<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          C 
         
         
         
           o 
          
         
           u 
          
         
           t 
          
         
        
       
      
        C_{out} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>小，以消除特征冗余，减少计算量。通过图1的策略（c）计算注意映射，并添加空间全局正则化。注意，我们发现Tanh比SoftMax在计算注意力图时更好。我们认为这是因为Tanh的输出不局限于正值，因此可以产生负关系并提供更大的灵活性。最后将注意力图与原始输入相乘得到输出特征。<br> <img src="https://images2.imgbox.com/61/81/JLjTO3Wb_o.png" alt="在这里插入图片描述"><br>   为了使模型能够共同处理来自不同表示子空间的信息，模块中共有S个heads进行注意力计算。所有heads的结果被连接并映射到具有线性层的输出空间<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          R 
         
         
         
           N 
          
         
           × 
          
         
           T 
          
          
          
            C 
           
           
           
             o 
            
           
             u 
            
           
             t 
            
           
          
         
        
       
      
        \mathbb R^{N\times T C_{out}} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.841331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10903em;">N</span><span class="mbin mtight">×</span><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.296343em;"><span class="" style="top: -2.357em; margin-left: -0.07153em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>。与transformer类似，在终端加入一个点式前馈层以获得最终输出。我们使用 leaky ReLU作为非线性函数。如图2所示，模块中有两个残差连接，用于稳定网络训练和集成不同的特征。最后，绿色圆角矩形框内的所有过程代表一个完整的注意模块</p> 
<h3><a id="35__Overall_architecture_43"></a>3.5 Overall architecture</h3> 
<p>  图3显示了我们方法的总体架构。输入是具有N个关节、T帧和C通道的骨架序列。在每一层中，我们首先将输入视为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         N 
        
       
         ∈ 
        
       
         T 
        
       
         C 
        
       
      
        N\in TC 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span></span></span></span></span>矩阵，即N个具有<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         T 
        
       
         C 
        
       
      
        TC 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span></span></span></span></span>通道的元素，并将其输入到空间注意模块（如图2所示）中，以模拟关节之间的空间关系。然后，将输出矩阵转换为T个元素，每个元素有N个C通道，并将其输入到时间注意模块中，以模拟帧之间的时间关系。总共有L层堆叠来更新功能。最终的输出特征是全局平均的，并输入到一个完全连接的层中，以获得分类分数。</p> 
<h3><a id="36__Data_decoupling_45"></a>3.6 Data decoupling</h3> 
<p>  动作可以分解为两个维度：空间维度和时间维度，如图4（a、b和c）所示。空间信息是指同一帧中两个不同关节的差异，主要包含不同关节之间的相对位置关系。为了减少冗余信息，我们只计算人体骨骼的空间信息。时间信息是具有相同空间意义的两个关节在不同的帧中的差异，主要描述一个关节在时间维上的运动轨迹。当我们像“一个手指指着”和“两个手指指着”这样的手势，空间信息更为重要。然而，当我们认识到像“向上挥手”和“向下挥手”这样的手势时，时间信息将更加重要。<br>   另外，对于时间流，不同的动作对运动尺度的敏感度也不同。对于一些动作，如“拍手”和“双手合十”，短期动作细节是必不可少的。但对于“向上挥手”和“向下挥手”这样的动作，长期的运动趋势更为重要。受文献[8]的启发，我们建议用高帧速率采样和低帧速率采样来计算时间运动，如图4（d）所示。生成的两个流分别称为快时态流和慢时态流。<br>   最后，我们共有四个流，分别是时空流（原始数据）、空间流、快时态流和慢时态流。我们分别为每个流训练具有相同体系结构的四个模型。对分类得分进行平均，得到最终结果。</p> 
<h2><a id="_49"></a>后续补充</h2> 
<p>。。。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6d5cf0fc5635badde233844ffe452982/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数据库字符集问题解决（Incorrect string value: ‘\xE5\xBC\xA0\xE6\x97\xA0...‘ for column ‘name‘ at row 1）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5189e5c243bf622ac8894c86bda0f555/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ubuntu date -R查看时区</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>