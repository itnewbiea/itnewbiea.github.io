<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>如何在Spring Boot中集成RabbitMQ - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="如何在Spring Boot中集成RabbitMQ" />
<meta property="og:description" content="如何在Spring Boot中集成RabbitMQ 在现代微服务架构中，消息队列（如RabbitMQ）扮演了关键的角色，它不仅能够提供高效的消息传递机制，还能解耦服务间的通信。本文将介绍如何在Spring Boot项目中集成RabbitMQ，实现生产者和消费者的基本配置。
步骤1：添加Maven依赖 首先，在你的Spring Boot项目的pom.xml中添加spring-boot-starter-amqp依赖：
&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt; &lt;/dependency&gt; 这个starter包含了与RabbitMQ集成所需的所有基本依赖。
步骤2：配置RabbitMQ 在application.yml或application.properties中配置RabbitMQ的连接信息：
spring: rabbitmq: host: 10.5.2.27 port: 30700 username: user password: Sungrow@2023 步骤3：实现生产者 在Spring Boot中，发送消息到RabbitMQ的生产者可以很简单地通过RabbitTemplate实现：
import org.springframework.amqp.rabbit.core.RabbitTemplate; import org.springframework.web.bind.annotation.*; import com.alibaba.fastjson.JSONObject; @RestController @RequestMapping(&#34;/menu&#34;) public class MenuController { @Resource private RabbitTemplate rabbitTemplate; @PostMapping(&#34;/add&#34;) public Result&lt;SysPermission&gt; add(@RequestBody SysPermission permission) { // ... 添加菜单的业务逻辑 rabbitTemplate.convertAndSend(RabbitConstant.GOODS_EXCHANGE, RabbitConstant.MENU_MESSAGE, JSONObject.toJSONString(permission)); return new Result&lt;SysPermission&gt;().success(&#34;添加成功！&#34;); } } 这里，convertAndSend方法用于发送消息到指定的交换机和路由键。
步骤4：配置RabbitMQ交换机、队列和绑定 在Spring Boot中，可以通过配置类来定义交换机、队列和它们之间的绑定关系：
import org.springframework.amqp.core.*; import org.springframework.context.annotation.Bean; import org." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8eaa67dad184de25203917d974e11813/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-07T19:42:31+08:00" />
<meta property="article:modified_time" content="2023-12-07T19:42:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">如何在Spring Boot中集成RabbitMQ</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="Spring_BootRabbitMQ_2"></a>如何在Spring Boot中集成RabbitMQ</h3> 
<p>在现代微服务架构中，消息队列（如RabbitMQ）扮演了关键的角色，它不仅能够提供高效的消息传递机制，还能解耦服务间的通信。本文将介绍如何在Spring Boot项目中集成RabbitMQ，实现生产者和消费者的基本配置。</p> 
<h3><a id="1Maven_6"></a>步骤1：添加Maven依赖</h3> 
<p>首先，在你的Spring Boot项目的pom.xml中添加spring-boot-starter-amqp依赖：</p> 
<pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>amqp<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> 
<p>这个starter包含了与RabbitMQ集成所需的所有基本依赖。</p> 
<h3><a id="2RabbitMQ_19"></a>步骤2：配置RabbitMQ</h3> 
<p>在application.yml或application.properties中配置RabbitMQ的连接信息：</p> 
<pre><code class="prism language-java">spring<span class="token operator">:</span>
  rabbitmq<span class="token operator">:</span>
    host<span class="token operator">:</span> <span class="token number">10.5</span><span class="token number">.2</span><span class="token number">.27</span>
    port<span class="token operator">:</span> <span class="token number">30700</span>
    username<span class="token operator">:</span> user
    password<span class="token operator">:</span> <span class="token class-name">Sungrow</span><span class="token annotation punctuation">@2023</span>
</code></pre> 
<h3><a id="3_32"></a>步骤3：实现生产者</h3> 
<p>在Spring Boot中，发送消息到RabbitMQ的生产者可以很简单地通过RabbitTemplate实现：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RabbitTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSONObject</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/menu"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MenuController</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/add"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Result</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysPermission</span><span class="token punctuation">&gt;</span></span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SysPermission</span> permission<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// ... 添加菜单的业务逻辑</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitConstant</span><span class="token punctuation">.</span><span class="token constant">GOODS_EXCHANGE</span><span class="token punctuation">,</span> <span class="token class-name">RabbitConstant</span><span class="token punctuation">.</span><span class="token constant">MENU_MESSAGE</span><span class="token punctuation">,</span> <span class="token class-name">JSONObject</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>permission<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysPermission</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">"添加成功！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这里，convertAndSend方法用于发送消息到指定的交换机和路由键。</p> 
<h3><a id="4RabbitMQ_59"></a>步骤4：配置RabbitMQ交换机、队列和绑定</h3> 
<p>在Spring Boot中，可以通过配置类来定义交换机、队列和它们之间的绑定关系：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitMQConfig</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 定义交换机、队列、路由键等常量</span>
    <span class="token comment">// ... </span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Queue</span> <span class="token function">queueA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token constant">GOODS_QUEUE_A</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">TopicExchange</span> <span class="token function">myExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TopicExchange</span><span class="token punctuation">(</span><span class="token constant">GOODS_EXCHANGE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">Binding</span> <span class="token function">bindingA</span><span class="token punctuation">(</span><span class="token class-name">Queue</span> queueA<span class="token punctuation">,</span> <span class="token class-name">TopicExchange</span> exchange<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>queueA<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token constant">GOODS_APP_ROUTING</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 其他队列和绑定的定义</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这段代码定义了队列、交换机，并将它们通过路由键绑定起来。<br> 有了配置后，启动服务，可以在rabbitmq控制台看到该交换机，队列以及他们之间的绑定<br> <img src="https://images2.imgbox.com/81/4c/ld1TmwNJ_o.png" alt="在这里插入图片描述"><br> 点进去后可以看到绑定的队列，<br> <img src="https://images2.imgbox.com/1c/0a/4DChPdN1_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3e/95/BT9eGM0J_o.png" alt="在这里插入图片描述"><br> 如果点进来，没有显示这个绑定队列，就说明配置的不对，后续也无法消费，点进队列后，就会显示队列中的消息了<br> <img src="https://images2.imgbox.com/ab/f2/yeeOYJGf_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5_101"></a>步骤5：实现消费者</h3> 
<p>消费者用于处理接收到的消息。使用@RabbitListener注解可以很容易地实现：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RabbitListener</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MessageReceiver</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span> <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>
        value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token class-name">RabbitMQConfig</span><span class="token punctuation">.</span><span class="token constant">GOODS_QUEUE_A</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token class-name">RabbitMQConfig</span><span class="token punctuation">.</span><span class="token constant">GOODS_EXCHANGE</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">ExchangeTypes</span><span class="token punctuation">.</span><span class="token constant">TOPIC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        key <span class="token operator">=</span> <span class="token class-name">RabbitMQConfig</span><span class="token punctuation">.</span><span class="token constant">GOODS_APP_ROUTING</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveAppMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">Channel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 处理接收到的消息</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 其他消费者方法</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这里，@RabbitListener注解定义了消息的监听和处理逻辑。</p> 
<h3><a id="6_127"></a>步骤6：处理死信队列</h3> 
<p>配置死信队列：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">Queue</span> <span class="token function">deadQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"x-dead-letter-exchange"</span><span class="token punctuation">,</span> <span class="token constant">DEAD_EXCHANGE_A</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"x-dead-letter-routing-key"</span><span class="token punctuation">,</span> <span class="token constant">DEAD_ROUTING_KEY_A</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token constant">DEAD_QUEUE_A</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token class-name">DirectExchange</span> <span class="token function">deadExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DirectExchange</span><span class="token punctuation">(</span><span class="token constant">DEAD_EXCHANGE_A</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token class-name">Binding</span> <span class="token function">bindingDead</span><span class="token punctuation">(</span><span class="token class-name">Queue</span> deadQueue<span class="token punctuation">,</span> <span class="token class-name">DirectExchange</span> deadExchange<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>deadQueue<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span>deadExchange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token constant">DEAD_ROUTING_KEY_A</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在RabbitMQ中，死信队列（Dead Letter Queue, DLQ）用于存储无法正常处理的消息。消息可能由于几种原因被发送到死信队列，包括：</p> 
<p>消息被拒绝（Basic.Reject/Basic.Nack）：当消费者明确拒绝消息且不重新排队时（通过设置requeue为false），消息会进入死信队列。</p> 
<p>消息过期：如果消息在队列中存活时间超过设定的TTL（Time-To-Live），它会被自动发送到死信队列。</p> 
<p>队列达到最大长度：如果队列设置了最大长度并达到这个限制，最老的消息可能会被移动到死信队列。</p> 
<p>在Spring Boot集成的RabbitMQ应用中，通常会在消费者处理消息时发生异常的情况下，明确地将消息发送到死信队列。例如：</p> 
<pre><code class="prism language-java"> 
<span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span> <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>
    value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token class-name">RabbitMQConfig</span><span class="token punctuation">.</span><span class="token constant">GOODS_QUEUE_A</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token class-name">RabbitMQConfig</span><span class="token punctuation">.</span><span class="token constant">GOODS_EXCHANGE</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">ExchangeTypes</span><span class="token punctuation">.</span><span class="token constant">TOPIC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    key <span class="token operator">=</span> <span class="token class-name">RabbitMQConfig</span><span class="token punctuation">.</span><span class="token constant">GOODS_APP_ROUTING</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveAppMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">Channel</span> channel<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 处理消息</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 处理消息失败，拒绝消息并不重新排队</span>
        channel<span class="token punctuation">.</span><span class="token function">basicNack</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">getMessageProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeliveryTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 将消息发送到死信队列</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitMQConfig</span><span class="token punctuation">.</span><span class="token constant">DEAD_EXCHANGE_A</span><span class="token punctuation">,</span> <span class="token class-name">RabbitMQConfig</span><span class="token punctuation">.</span><span class="token constant">DEAD_ROUTING_KEY_A</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在这个例子中，如果在处理消息的过程中发生异常，消息会被明确地拒绝，并发送到配置的死信队列。</p> 
<p>为什么使用死信队列<br> 避免消息丢失：死信队列确保无法处理的消息不会被丢失，而是存储在一个特定的地方，供进一步的检查和处理。<br> 分析和调试：可以对死信队列中的消息进行分析，以确定为什么消息不能被正常处理。<br> 避免重复处理无效消息：通过将无法处理的消息移动到死信队列，防止消费者重复尝试处理同一消息，这可能导致无限循环。<br> 死信队列（DLQ）用于处理无法正常消费的消息。配置死信队列类似于配置普通队列，但需要一些额外的参数，如TTL（Time-To-Live）和死信交换机：</p> 
<pre><code>
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d7bae55154b729300d9eef41d1052831/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【教程】逻辑回归怎么做多分类</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5bd430b64586a58d32fb87493d084e34/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【计算机视觉 | 目标检测】arxiv 计算机视觉关于目标检测的学术速递（12 月 6 日论文合集）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>