<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>HDU 5895 矩阵快速幂&#43;欧拉降幂公式&#43;指数循环节 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="HDU 5895 矩阵快速幂&#43;欧拉降幂公式&#43;指数循环节" />
<meta property="og:description" content="题目链接：HDU5895 注意到题目的数据非常之大，并且递归之后求的指数幂非常之大，所以要先知道欧拉降幂公式: ,相当于形成了指数的循环节。 根据递推关系得到： 建立矩阵: 用矩阵快速幂求解出g(n*y)，之后再利用快速幂取模求出最后的结果
由于数据很大，过程中把数据开大，及时取模。
AC代码：
#include &lt;cstdio&gt; #include &lt;cstring&gt; #include&lt;iostream&gt; #include &lt;cmath&gt; using namespace std; typedef long long LL; typedef unsigned long long ULL; const int N=4; LL n,x,y,s,mod; struct mat{ ULL m[N][N]; mat() {} mat unit(){ for(int i=0;i&lt;N;i&#43;&#43;) for(int j=0;j&lt;=N;j&#43;&#43;) m[i][j]=i==j?1:0; } }; mat t; mat operator * (mat a,mat b){ //cout&lt;&lt;mod&lt;&lt;endl; mat res; for(int i=0;i&lt;N;i&#43;&#43;) for(int j=0;j&lt;=N;j&#43;&#43;){ res.m[i][j]=0; for(int k=0;k&lt;N;k&#43;&#43;){ res.m[i][j]&#43;=a.m[i][k]*b.m[k][j]; if(res.m[i][j]&gt;mod) res.m[i][j]%=mod; } } return res; } mat operator ^ (mat res,LL n){ //矩阵快速幂 res." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/98905d16e3904b8d9965b3f5a51a416a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-09-21T14:42:38+08:00" />
<meta property="article:modified_time" content="2016-09-21T14:42:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">HDU 5895 矩阵快速幂&#43;欧拉降幂公式&#43;指数循环节</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>题目链接：<a href="http://acm.hdu.edu.cn/showproblem.php?pid=5895" rel="nofollow">HDU5895</a> <br> 注意到题目的数据非常之大，并且递归之后求的指数幂非常之大，所以要先知道欧拉降幂公式: <br> <img src="https://images2.imgbox.com/71/e8/FD1fQH2Q_o.png" alt="这里写图片描述" title="">,相当于形成了指数的循环节。 <br> 根据递推关系得到： <br> <img src="https://images2.imgbox.com/14/c4/B18Blw8T_o.png" alt="这里写图片描述" title=""> <br> 建立矩阵: <br> <img src="https://images2.imgbox.com/09/41/R2HUVGEy_o.png" alt="这里写图片描述" title=""> <br> 用矩阵快速幂求解出g(n*y)，之后再利用快速幂取模求出最后的结果</p> 
<p>由于数据很大，过程中把数据开大，及时取模。</p> 
<p>AC代码：</p> 
<pre class="prettyprint"><code class=" hljs cpp"><span class="hljs-preprocessor">#include &lt;cstdio&gt;</span>
<span class="hljs-preprocessor">#include &lt;cstring&gt;</span>
<span class="hljs-preprocessor">#include&lt;iostream&gt;</span>
<span class="hljs-preprocessor">#include &lt;cmath&gt;</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> LL;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ULL;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N=<span class="hljs-number">4</span>;
LL n,x,y,s,mod;
<span class="hljs-keyword">struct</span> mat{
    ULL m[N][N];
    mat() {}
    mat unit(){
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;N;i++)
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;=N;j++)
                m[i][j]=i==j?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>;
    }
};
mat t;
mat <span class="hljs-keyword">operator</span> * (mat a,mat b){
    <span class="hljs-comment">//cout&lt;&lt;mod&lt;&lt;endl;</span>
    mat res;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;N;i++)
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;=N;j++){
            res.m[i][j]=<span class="hljs-number">0</span>;
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k=<span class="hljs-number">0</span>;k&lt;N;k++){
                res.m[i][j]+=a.m[i][k]*b.m[k][j];
                <span class="hljs-keyword">if</span>(res.m[i][j]&gt;mod)
                    res.m[i][j]%=mod;
            }
    }
    <span class="hljs-keyword">return</span> res;
}
mat <span class="hljs-keyword">operator</span> ^ (mat res,LL n){ <span class="hljs-comment">//矩阵快速幂</span>
    res.unit();
    <span class="hljs-keyword">while</span>(n&gt;=<span class="hljs-number">1</span>){
        <span class="hljs-keyword">if</span>(n&amp;<span class="hljs-number">1</span>)
            res=res*t;
        n=n&gt;&gt;<span class="hljs-number">1</span>;
        t=t*t;
    }
    <span class="hljs-keyword">return</span> res;
}
<span class="hljs-keyword">void</span> init(){
    t.m[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]=<span class="hljs-number">4</span>;t.m[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]=<span class="hljs-number">4</span>;t.m[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]=<span class="hljs-number">1</span>;t.m[<span class="hljs-number">0</span>][<span class="hljs-number">3</span>]=<span class="hljs-number">0</span>;
    t.m[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]=<span class="hljs-number">2</span>;t.m[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]=<span class="hljs-number">1</span>;t.m[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>]=<span class="hljs-number">0</span>;t.m[<span class="hljs-number">1</span>][<span class="hljs-number">3</span>]=<span class="hljs-number">0</span>;
    t.m[<span class="hljs-number">2</span>][<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>;t.m[<span class="hljs-number">2</span>][<span class="hljs-number">1</span>]=<span class="hljs-number">0</span>;t.m[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>]=<span class="hljs-number">0</span>;t.m[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>]=<span class="hljs-number">0</span>;
    t.m[<span class="hljs-number">3</span>][<span class="hljs-number">0</span>]=<span class="hljs-number">4</span>;t.m[<span class="hljs-number">3</span>][<span class="hljs-number">1</span>]=<span class="hljs-number">4</span>;t.m[<span class="hljs-number">3</span>][<span class="hljs-number">2</span>]=<span class="hljs-number">1</span>;t.m[<span class="hljs-number">3</span>][<span class="hljs-number">3</span>]=<span class="hljs-number">1</span>;
}
LL quickpow(LL a,LL b,LL c){   <span class="hljs-comment">//快速幂取模</span>
    LL ans=<span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span>(b&gt;<span class="hljs-number">0</span>){
        <span class="hljs-keyword">if</span>(b&amp;<span class="hljs-number">1</span>)
            ans=ans*a%c;
        b=b&gt;&gt;<span class="hljs-number">1</span>;
        a=(a%c)*(a%c)%c;
    }
    <span class="hljs-keyword">return</span> ans;
}  
LL GetEuler(<span class="hljs-keyword">int</span> n)  <span class="hljs-comment">//欧拉函数</span>
{
     LL i;
     LL res = n,a = n;
     <span class="hljs-keyword">for</span>(i = <span class="hljs-number">2</span>;i*i &lt;= a; ++i){
         <span class="hljs-keyword">if</span>(a%i == <span class="hljs-number">0</span>){
             res -= res/i; 
             <span class="hljs-keyword">while</span>(a%i == <span class="hljs-number">0</span>) 
                 a/=i;
         }
     }
     <span class="hljs-keyword">if</span>(a &gt; <span class="hljs-number">1</span>) 
         res -= res/a;
     <span class="hljs-keyword">return</span> res;
}
<span class="hljs-keyword">int</span> main(){
    <span class="hljs-comment">//freopen("input.txt","r",stdin);</span>
    <span class="hljs-keyword">int</span> T;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>,&amp;T);
    <span class="hljs-keyword">while</span>(T--){
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%lld%lld%lld%lld"</span>,&amp;n,&amp;y,&amp;x,&amp;s);<span class="hljs-comment">//输入顺序搞成nxys，调了两个小时才发现，好气哦！</span>
        mat A;
        <span class="hljs-built_in">memset</span>(A.m,<span class="hljs-number">0</span>,<span class="hljs-keyword">sizeof</span>(A.m));
        init();
        mod=GetEuler(s+<span class="hljs-number">1</span>);
        <span class="hljs-comment">//cout&lt;&lt;mod&lt;&lt;endl;</span>
        n=n*y;
        <span class="hljs-keyword">if</span>(n==<span class="hljs-number">0</span>){
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"1\n"</span>);
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span>{
            LL ans=<span class="hljs-number">0</span>,res;
            <span class="hljs-comment">//cout&lt;&lt;n&lt;&lt;endl;</span>
            A=t^(n-<span class="hljs-number">1</span>);
            <span class="hljs-comment">/*for(int i=0;i&lt;N;i++){
                for(int j=0;j&lt;N;j++)
                    printf("%lld ",A.m[i][j]);
            cout&lt;&lt;endl;
            }*/</span>
            ans=(A.m[<span class="hljs-number">3</span>][<span class="hljs-number">0</span>]%mod+A.m[<span class="hljs-number">3</span>][<span class="hljs-number">3</span>]%mod)%mod;
            ans+=mod;
            res=quickpow(x,ans,s+<span class="hljs-number">1</span>);
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld\n"</span>,res);
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b84114e02132c8034094d59519433490/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">HDU 5895 欧拉定理&#43;快速幂&#43;公式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/45de6dec9008490726636d27b43ba9c7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">React实战-一个非常棒的React与Material风格相结合的UI控件库（Material-UI）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>