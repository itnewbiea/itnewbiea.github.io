<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>视觉学习笔记1——配置深度学习环境（安装Ubuntu18，NVIDIA驱动，cuda10.1，cudnn，pycharm，OpenCV4，anaconda3，TensorFlow，pytorch） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="视觉学习笔记1——配置深度学习环境（安装Ubuntu18，NVIDIA驱动，cuda10.1，cudnn，pycharm，OpenCV4，anaconda3，TensorFlow，pytorch）" />
<meta property="og:description" content="硬件：联想拯救者y7000
安装Ubuntu18.04 安装Ubuntu首先你要想好是这个Ubuntu你要放在哪里，常见的有3个方法:
1、放在VMware虚拟机里
2、弄成双系统
3、放在大容量硬盘或者U盘上挂载
考虑到自己是用在深度学习上，虚拟机和移动硬盘挂载可能不是特别适合我（原因可以自己去百度）所以我决定使用双系统方案。
那为什么要用18版不用20版的Ubuntu呢，因为18的时间比20长你遇到的坑别人绝大多数都踩过，网上可供参考的资料会更多，懂的都懂
安装准备 1、 Ubuntu系统镜像链接
2、 USB刻录软件Rufus
3、4G左右的U盘
烧录镜像与分配空间 其实这个烧录也没什么好说的你可以用Rufus，也可以用软碟通，只要把镜像ISO文件录进去就行了，这里就不过多解释，详细操作自己试一次就知道了。
首先不要急着去重启安装，要分配好所需要的磁盘空间，在桌面的“计算机”上右键，选择“管理”，进入如下窗口，点击“磁盘管理”（这图不是我的，因为我在Ubuntu里面写，所以没有专门去截图）。
我建议为Ubuntu分配50G到100G左右的空间（看你有多大的盘），选中一个盘（别选C盘，信我），我的是D盘分配了200G。选中D 盘，按鼠标右键，选择“压缩卷”，在新弹出的窗口上输入200000M就OK了。做完这些准备工作就可以正式安装了。
安装Ubuntu 第一步连接电源，插入U盘，关机重启，在电脑进入logo阶段时，快速长按bios键进入boot界面，注意是boot界面不是BIOS界面（我的电脑是拯救者，进入boot界面的BIOS键是F12）。bios设置u盘启动，这个网上依据不同机型教程各不相同，我就不说了自己查。
第二步在boot界面里有一个UEFI的U盘启动入口（如果你的不是UEFI或者没有的，可以去参考一下这篇博客），键盘控制进去，可以看见一个类似下图的的界面。
用键盘控制，选择 Install Ubuntu 回车进入安装。（我看见有的人会在回车后卡住，可是我没有遇到这种情况，不过我把别人的方法贴出来，注意不要急着去安装驱动）
第三步这里就要注意了，一些选项不要选错了：
选择 Install Ubuntu
选择中文汉语（选别的就自己看着办）
先不要连WiFi，不然在安装时会同时下载别的东西会很慢，跳过
这个选择第一个，第二个都行，区别是第一个会多配上一些工作软件，安装时间会长一点；第二个就比较空白（第三个就别选了，很多人都不建议所以我没试过，如果你试过可以去评论区告诉我）
必选其他选项，很重要，你的启动盘、系统盘和用户盘等都是在这里做的，然后继续
点击其它选项后继续，会弹出这个界面
选择空闲设备，这个空闲设备容量大约是200000M，它就是我们前面所压缩出来的200G硬盘。把这个硬盘分成4个（分多少个，每个分多少，看个人，别乱分就行），如下表：
名称分区格式大小/boot逻辑分区Ext4500M/主分区Ext450Gswap逻辑分区swap8G/home逻辑分区Ext4剩余 我们选择空闲设备，然后点击下面的&#43;号进行分区，在创建分区界面进行配置。
最后分区结束后，不要急着下一步安装，先点击&#43;号下面一行的“安装启动引导器设备”选项，选择你之前分了500M左右的那个/boot设备。
右下角继续安装将改动写入磁盘，继续配置时间地图、账号和密码，然后就开始安装等待了。
安装网卡和NVIDIA驱动 安装准备 1、更换清华源
清华源地址
打开终端
将系统自带的该文件做个备份： sudo cp /etc/apt/sources.list /etc/apt/sources.list.backup 备份后输入命令更换文件里面的内容： sudo gedit /etc/apt/sources.list sudo apt-get update 更新源 sudo apt-get upgrade 更新软件 有线网络无法连接，安装gcc和make后安装驱动 ，先跳过这一步，离线安装显卡驱动，安装后会有网卡驱动的。
无线网络无法连接，估计是驱动不匹配，比如我的型号是Intel® Wi-Fi 6E AX211 160MHz，参考这篇博客安装新驱动" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/3d0f616f4e4659baad3698f706b731ad/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-04T19:12:36+08:00" />
<meta property="article:modified_time" content="2023-07-04T19:12:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">视觉学习笔记1——配置深度学习环境（安装Ubuntu18，NVIDIA驱动，cuda10.1，cudnn，pycharm，OpenCV4，anaconda3，TensorFlow，pytorch）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>硬件：联想拯救者y7000</strong></p> 
<h2><a id="Ubuntu1804_1"></a>安装Ubuntu18.04</h2> 
<p><strong>安装Ubuntu首先你要想好是这个Ubuntu你要放在哪里，常见的有3个方法:<br> 1、放在VMware虚拟机里<br> 2、弄成双系统<br> 3、放在大容量硬盘或者U盘上挂载</strong><br> 考虑到自己是用在深度学习上，虚拟机和移动硬盘挂载可能不是特别适合我（原因可以自己去百度）所以我决定使用双系统方案。<br> <s>那为什么要用18版不用20版的Ubuntu呢，因为18的时间比20长你遇到的坑别人绝大多数都踩过，网上可供参考的资料会更多，懂的都懂</s></p> 
<h3><a id="_8"></a>安装准备</h3> 
<p>1、 <a href="https://ubuntu.com/download/desktop" rel="nofollow">Ubuntu系统镜像链接</a><br> 2、 <a href="https://rufus.ie/zh/" rel="nofollow">USB刻录软件Rufus</a><br> 3、4G左右的U盘</p> 
<h3><a id="_13"></a>烧录镜像与分配空间</h3> 
<p>其实这个烧录也没什么好说的你可以用Rufus，也可以用软碟通，只要把镜像ISO文件录进去就行了，这里就不过多解释，详细操作自己试一次就知道了。<br> <img src="https://images2.imgbox.com/78/20/pGQuEzfZ_o.png" alt="烧录"></p> 
<p>首先不要急着去重启安装，要分配好所需要的磁盘空间，在桌面的“计算机”上右键，选择“管理”，进入如下窗口，点击“磁盘管理”（这图不是我的，因为我在Ubuntu里面写，所以没有专门去截图）。<br> <img src="https://images2.imgbox.com/15/2b/VaGBGbRK_o.png" alt="在这里插入图片描述"></p> 
<p>我建议为Ubuntu分配50G到100G左右的空间（看你有多大的盘），选中一个盘（别选C盘，信我），我的是D盘分配了200G。选中D 盘，按鼠标右键，选择“压缩卷”，在新弹出的窗口上输入200000M就OK了。做完这些准备工作就可以正式安装了。</p> 
<h3><a id="Ubuntu_22"></a>安装Ubuntu</h3> 
<p>第一步连接电源，插入U盘，关机重启，在电脑进入logo阶段时，快速长按bios键进入boot界面，注意是boot界面不是BIOS界面（我的电脑是拯救者，进入boot界面的BIOS键是F12）。bios设置u盘启动，这个网上依据不同机型教程各不相同，我就不说了自己查。<br> 第二步在boot界面里有一个UEFI的U盘启动入口（如果你的不是UEFI或者没有的，可以去参考一下这篇<a href="https://blog.csdn.net/rorypeck/article/details/119146208?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E5%AE%89%E8%A3%85Ubuntu%20%E5%8D%A1%E4%BD%8F&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-3-119146208.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&amp;spm=1018.2226.3001.4187">博客</a>），键盘控制进去，可以看见一个类似下图的的界面。<br> <img src="https://images2.imgbox.com/98/ed/AJmcxYx9_o.png" alt="在这里插入图片描述"><br> 用键盘控制，选择 Install Ubuntu 回车进入安装。（我看见有的人会在回车后卡住，可是我没有遇到这种情况，不过我把别人的<a href="https://blog.csdn.net/Dod_Jdi/article/details/78635126">方法</a>贴出来，注意不要急着去安装驱动）<br> 第三步这里就要注意了，一些选项不要选错了：</p> 
<p>选择 Install Ubuntu<br> <img src="https://images2.imgbox.com/85/4f/jTThh6t4_o.png" alt="在这里插入图片描述"></p> 
<p>选择中文汉语（选别的就自己看着办）<br> <img src="https://images2.imgbox.com/6c/d1/LtdbF5kk_o.png" alt="在这里插入图片描述"></p> 
<p>先不要连WiFi，不然在安装时会同时下载别的东西会很慢，跳过<br> <img src="https://images2.imgbox.com/e5/56/FvcP7TbH_o.png" alt="在这里插入图片描述"></p> 
<p>这个选择第一个，第二个都行，区别是第一个会多配上一些工作软件，安装时间会长一点；第二个就比较空白（第三个就别选了，很多人都不建议所以我没试过，如果你试过可以去评论区告诉我）<br> <img src="https://images2.imgbox.com/24/e3/rJMvFCF4_o.png" alt="在这里插入图片描述"></p> 
<p>必选其他选项，很重要，你的启动盘、系统盘和用户盘等都是在这里做的，然后继续<br> <img src="https://images2.imgbox.com/ec/06/wTAoK3c6_o.png" alt="在这里插入图片描述"><br> 点击其它选项后继续，会弹出这个界面<br> <img src="https://images2.imgbox.com/7a/3a/cNBozkGw_o.png" alt="在这里插入图片描述"><br> 选择空闲设备，这个空闲设备容量大约是200000M，它就是我们前面所压缩出来的200G硬盘。把这个硬盘分成4个（分多少个，每个分多少，看个人，别乱分就行），如下表：</p> 
<table><thead><tr><th>名称</th><th>分区</th><th>格式</th><th>大小</th></tr></thead><tbody><tr><td>/boot</td><td>逻辑分区</td><td>Ext4</td><td>500M</td></tr><tr><td>/</td><td>主分区</td><td>Ext4</td><td>50G</td></tr><tr><td>swap</td><td>逻辑分区</td><td>swap</td><td>8G</td></tr><tr><td>/home</td><td>逻辑分区</td><td>Ext4</td><td>剩余</td></tr></tbody></table> 
<p>我们选择空闲设备，然后点击下面的+号进行分区，在创建分区界面进行配置。<br> 最后分区结束后，不要急着下一步安装，先点击+号下面一行的“<strong>安装启动引导器设备</strong>”选项，选择你之前分了500M左右的那个/boot设备。</p> 
<p>右下角继续安装将改动写入磁盘，继续配置时间地图、账号和密码，然后就开始安装等待了。</p> 
<h2><a id="NVIDIA_67"></a>安装网卡和NVIDIA驱动</h2> 
<h3><a id="_68"></a>安装准备</h3> 
<p><strong>1、更换清华源</strong><br> <a href="https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/" rel="nofollow">清华源地址</a><br> 打开终端</p> 
<pre><code class="prism language-javascript">将系统自带的该文件做个备份：
 sudo cp <span class="token operator">/</span>etc<span class="token operator">/</span>apt<span class="token operator">/</span>sources<span class="token punctuation">.</span>list <span class="token operator">/</span>etc<span class="token operator">/</span>apt<span class="token operator">/</span>sources<span class="token punctuation">.</span>list<span class="token punctuation">.</span>backup
 
 备份后输入命令更换文件里面的内容：
 sudo gedit <span class="token operator">/</span>etc<span class="token operator">/</span>apt<span class="token operator">/</span>sources<span class="token punctuation">.</span>list
 
 sudo apt<span class="token operator">-</span><span class="token keyword">get</span> update 更新源
sudo apt<span class="token operator">-</span><span class="token keyword">get</span> upgrade 更新软件
</code></pre> 
<p>有线网络无法连接，<s><a href="https://blog.csdn.net/qq_45765409/article/details/130955074?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522168838941916800213016329%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=168838941916800213016329&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-130955074-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&amp;utm_term=Ubuntu%E7%9A%84%E7%B3%BB%E7%BB%9F%E7%9B%98%E5%AE%89%E8%A3%85gcc%20make&amp;spm=1018.2226.3001.4187">安装gcc和make</a>后<a href="https://blog.csdn.net/weixin_39538031/article/details/125347638?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522168838923916800197023475%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=168838923916800197023475&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~times_rank-9-125347638-null-null.268%5Ev1%5Ekoosearch&amp;utm_term=Ubuntu%20%E5%AE%89%E8%A3%85%E6%9C%89%E7%BA%BF%E7%BD%91%E5%8D%A1%E9%A9%B1%E5%8A%A8&amp;spm=1018.2226.3001.4450">安装驱动</a></s> ，先跳过这一步，离线安装显卡驱动，安装后会有网卡驱动的。</p> 
<p>无线网络无法连接，估计是驱动不匹配，比如我的型号是Intel® Wi-Fi 6E AX211 160MHz，<a href="https://blog.csdn.net/weixin_44270218/article/details/128006989?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522168839603116800188573525%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=168839603116800188573525&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~times_rank-5-128006989-null-null.268%5Ev1%5Ekoosearch&amp;utm_term=Ubuntu%20WiFi%206E%20AX211%20160MHZ%20%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1&amp;spm=1018.2226.3001.4450">参考这篇博客安装新驱动</a></p> 
<p><strong>2、下载驱动</strong><br> 驱动安装有3种方法，大概可以看这个<a href="https://blog.csdn.net/chenyuping333/article/details/81705528">博客</a>介绍，不过我推荐用下载驱动进行安装这个方法，这样你就可以自由安置你的驱动文件<br> 去<a href="https://www.nvidia.cn/geforce/drivers/" rel="nofollow">Nvidia中文官网</a>选填对应信息，下载好对应驱动编译，注意自己电脑对应配置，选择对应的驱动（建议不要选择过高版本的驱动）<img src="https://images2.imgbox.com/b9/7c/Ybj6clen_o.png" alt="选填对应信息"><br> 1）打开终端，先删除旧的驱动：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> purge nvidia*
</code></pre> 
<p>2）禁用自带的 nouveau nvidia驱动</p> 
<p>创建一个文件通过命令 sudo vim /etc/modprobe.d/blacklist-nouveau.conf</p> 
<p>并添加如下内容：</p> 
<pre><code class="prism language-bash">blacklist nouveau
options nouveau <span class="token assign-left variable">modeset</span><span class="token operator">=</span><span class="token number">0</span>
</code></pre> 
<p>再更新一下</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> update-initramfs -u
</code></pre> 
<p>修改后需要重启系统。确认下Nouveau是已经被你干掉，使用命令：</p> 
<pre><code class="prism language-bash">lsmod <span class="token operator">|</span> <span class="token function">grep</span> nouveau
</code></pre> 
<p>3）重启系统至init 3（文本模式），也可先进入图形桌面再运行init 3进入文本模式，再安装下载的驱动就没问题</p> 
<p>首先我们需要结束x-window的服务，否则驱动将无法正常安装</p> 
<p>关闭X-Window，很简单：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">service</span> lightdm stop
</code></pre> 
<p>然后切换tty1控制台：Ctrl+Alt+F1即可（切换不出来可以把F1换成F2，F3，tty1,tty2,tty3感觉都一样）</p> 
<h3><a id="_130"></a>正式安装</h3> 
<p>接下来就是最关键的一步了：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">chmod</span> NVIDIA*.run
<span class="token function">sudo</span> ./NVIDIA-Linux-x86_64-***.**.run –no-x-check -no-nouveau-check -no-opengl-files
</code></pre> 
<p>–no-opengl-files：表示只安装驱动文件，不安装OpenGL文件。这个参数不可省略，否则会导致登陆界面死循环，英语一般称为”login loop”或者”stuck in login”。<br> –no-x-check：表示安装驱动时不检查X服务，非必需。<br> –no-nouveau-check：表示安装驱动时不检查nouveau，非必需。<br> -Z, --disable-nouveau：禁用nouveau。此参数非必需，因为之前已经手动禁用了nouveau。<br> -A：查看更多高级选项。</p> 
<p>安装过程中一些选项</p> 
<blockquote> 
 <p>The distribution-provided pre-install script failed! Are you sure you<br> want to continue?</p> 
</blockquote> 
<p>选择 yes 继续。</p> 
<blockquote> 
 <p>Would you like to register the kernel module souces with DKMS? This<br> will allow DKMS to automatically build a new module, if you install a<br> different kernel later?</p> 
</blockquote> 
<p>选择 No 继续。</p> 
<p>问题大概是：</p> 
<blockquote> 
 <p>Nvidia’s 32-bit compatibility libraries?</p> 
</blockquote> 
<p>选择 No 继续。</p> 
<blockquote> 
 <p>Would you like to run the nvidia-xconfigutility to automatically<br> update your x configuration so that the NVIDIA x driver will be used<br> when you restart x? Any pre-existing x confile will be backed up.</p> 
</blockquote> 
<p>选择Yes 继续<br> （这个sudo ./NVIDIA-Linux-x86_64-*****.run –no-x-check -no-nouveau-check -no-opengl-files是对应你的文件路径下的驱动文件）安装过程比较快，要多注意提示，选择和error字眼，如果安装失败了，那么根据它给出的失败提示进行百度查询即可，失败原因可能是环境没配好，类型比较花式，这里就不一一列举。</p> 
<p>最后安装完毕后，重新启动X-Window：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">service</span> lightdm start
</code></pre> 
<p>然后Ctrl+Alt+F7进入图形界面；</p> 
<p>最后测试一下是否安装成功</p> 
<pre><code class="prism language-bash">nvidia-smi

nvidia-settings
</code></pre> 
<p>成功图例如下<br> <img src="https://images2.imgbox.com/26/45/1yghxzUQ_o.png" alt="在这里插入图片描述"><br> 如果提示错误nvidia-smi has failed because it couldn‘t communicate with the nvidia driver，可以参考<a href="https://blog.csdn.net/qq_52234483/article/details/129454211?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522168839404016800180696825%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=168839404016800180696825&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~times_rank-26-129454211-null-null.268%5Ev1%5Ekoosearch&amp;utm_term=ubuntu%E5%AE%89%E8%A3%85%E6%98%BE%E5%8D%A1%E9%A9%B1%E5%8A%A8%20%20nvidia-smi%20has%20failed%20because&amp;spm=1018.2226.3001.4450">这篇博客</a>解决</p> 
<h2><a id="cuda101cudnn76_191"></a>安装cuda10.1，cudnn7.6</h2> 
<p>**<s>首先说明一下以下可以自定义安装位置的尽量自定义，这样可以有效控制管理自己的电脑，不要搞得乱七八糟。</s> **<br> <strong>2022年9月14日，更新多cuda教程</strong></p> 
<h3><a id="cuda_194"></a>安装cuda</h3> 
<p>cuda10.1是cuda目前的主流版本，而cudnn7.6是cuda10.1对应版本。在<a href="https://developer.nvidia.com/cuda-downloads" rel="nofollow">cuda</a>官网选择系统对应的版本下载CUDA10.1.</p> 
<ol><li>进入终端执行官网提示的命令（run和deb版都行，我用的是run）<br> <img src="https://images2.imgbox.com/0b/25/RDc9ny0y_o.png" alt="在这里插入图片描述"></li><li>进入终端可视化安装界面，要注意的是因为电脑已经搭载好驱动，所以<strong>不要勾选Driver</strong>，那么只需要移动到Driver，按enter键，将＂［］＂中的Ｘ去掉即是不选择．然后在Install安装。</li></ol> 
<p><img src="https://images2.imgbox.com/a0/b3/yiGIUg3K_o.png" alt="在这里插入图片描述"></p> 
<ol start="3"><li>出现以下画面表示coda10.1安装成功</li></ol> 
<p><img src="https://images2.imgbox.com/7d/e5/KeWfxHiQ_o.png" alt="在这里插入图片描述"></p> 
<ol start="4"><li>安装完成后还要对CUDA相关配置进行修改，将CUDA的编译器添加到环境变量中。<br> 打开终端输入命令：</li></ol> 
<pre><code class="prism language-bash"> <span class="token function">sudo</span> gedit  ~/.bashrc
</code></pre> 
<p>在最下面添加：</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/local/cuda-10.1/bin:<span class="token environment constant">$PATH</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">LD_LIBRARY_PATH</span><span class="token operator">=</span>/usr/local/cuda-10.1/lib64:<span class="token variable">$LD_LIBRARY_PATH</span>
</code></pre> 
<p>使配置文件生效：</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">source</span> ~/.bashrc
</code></pre> 
<ol start="5"><li>测试版本号是否对应 ，判断cuda是否安装成功，执行：</li></ol> 
<pre><code class="prism language-bash"> nvcc --version
</code></pre> 
<p>可以打印显卡信息查看：</p> 
<pre><code class="prism language-bash">nvidia-smi
</code></pre> 
<h3><a id="cudnn_243"></a>安装cudnn</h3> 
<p><a href="https://developer.nvidia.com/rdp/cudnn-archive" rel="nofollow">官方下载cudnn</a>，选择匹配CUDA10.1版本的cudnn下载<br> <img src="https://images2.imgbox.com/cc/fd/DFVnvBZW_o.png" alt="在这里插入图片描述"><br> 直接解压cudnn，进入对应的文件路径，把文件拷贝到cuda相应的文件夹下即可：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">cp</span> cuda/include/cudnn.h /usr/local/cuda/include
<span class="token function">sudo</span> <span class="token function">cp</span> cuda/lib64/*.* /usr/local/cuda/lib64
<span class="token function">sudo</span> <span class="token function">chmod</span> a+r /usr/local/cuda/include/cudnn.h /usr/local/cuda/lib64/libcudnn*
</code></pre> 
<p>查看cudnn版本</p> 
<pre><code class="prism language-bash"><span class="token function">cat</span> /usr/local/cuda/include/cudnn.h <span class="token operator">|</span> <span class="token function">grep</span> CUDNN_MAJOR -A <span class="token number">2</span>
</code></pre> 
<h2><a id="pycharm_259"></a>安装pycharm</h2> 
<p>有很多人会吐槽pycharm怎样怎样，推荐用别的文本编辑器比如sublime text3、VS code，Jupyter NoteBook等，甚至会叫你直接用记事本写。但是我推荐用pycharm的原因是集成度高，新手必备工具。</p> 
<h3><a id="_262"></a>下载安装</h3> 
<p><a href="https://www.jetbrains.com/pycharm/download/#section=linux" rel="nofollow">官方地址<br> </a><br> 下载社区版（专业版可以自己找找激活码）平时就够用了<br> pycharm更新很快，推荐下载前几个月的版本（从其他版本进去）<br> <img src="https://images2.imgbox.com/0e/65/pvUFilT0_o.png" alt="在这里插入图片描述"></p> 
<p>下载好软件包并找好地方进行解压，解压后可直接运行，无需安装。<br> 这时会有一个问题<br> 平时启动软件需要在终端输入：</p> 
<pre><code class="prism language-bash">（对应安装路径和安装包名称需改动）
<span class="token function">sh</span> pycharm/pycharm-2020.3.3/bin/pycharm.sh
</code></pre> 
<p>它没有生成快捷方式，想要生成快捷方式需要在/usr/share/applications创建一个文件：pycharm.desktop</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> /usr/share/applications
<span class="token function">sudo</span> gedit /usr/share/applications/pycharm.desktop
</code></pre> 
<p>在这个文件里添加以下内容</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>Desktop Entry<span class="token punctuation">]</span>
<span class="token assign-left variable">Version</span><span class="token operator">=</span><span class="token number">1.0</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>Application
<span class="token assign-left variable">Name</span><span class="token operator">=</span>Pycharm
<span class="token assign-left variable">Icon</span><span class="token operator">=</span><span class="token string">"/home/python/Program File/pycharm-2020.1.1/bin/pycharm.png"</span>
<span class="token assign-left variable">Exec</span><span class="token operator">=</span>sh <span class="token string">"/home/python/Program File/pycharm-2020.1.1/bin/pycharm.sh"</span>
<span class="token assign-left variable">MimeType</span><span class="token operator">=</span>application/x-py<span class="token punctuation">;</span>
Name<span class="token punctuation">[</span>en_US<span class="token punctuation">]</span><span class="token operator">=</span>pycharm
（注意！这里Icon和Exec的你对应路径和文件名，可以从该文件的属性里查看）
</code></pre> 
<p>最后通过系统应用程序搜索pycharm，找到并打开软件，此时桌面左侧会有快捷方式出现，然后右键锁定到桌面左侧。</p> 
<h2><a id="OpenCV4_298"></a>安装OpenCV4</h2> 
<p>OpenCV是什么我就不说了，在安装OpenCV时我是相当痛苦的，因为CV对接的是本机的Python3，可是调用anaconda3建立的Python虚拟环境才是我们的理想配置。那如何让anaconda3也能调用OpenCV呢？经过多次测试最好是一开始就先装opencv，这样系统自动用系统自带python进行编译，等生成了cv2.so再安装anaconda。</p> 
<h3><a id="_300"></a>安装依赖</h3> 
<p>搭建OpenCV需要安装依赖，否则容易失败：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> cmake
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> build-essential libgtk2.0-dev libavcodec-dev libavformat-dev libjpeg-dev libswscale-dev libtiff5-dev libgtk2.0-dev pkg-config
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> build-essential
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> cmake <span class="token function">git</span> libgtk2.0-dev pkg-config libavcodec-dev libavformat-dev libswscale-dev
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> python-dev python-numpy libtbb2 libtbb-dev libjpeg-dev libpng-dev libtiff-dev libjasper-dev libdc1394-22-dev
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libavcodec-dev libavformat-dev libswscale-dev libv4l-dev liblapacke-dev
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libxvidcore-dev libx264-dev
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libatlas-base-dev gfortran
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> ffmpeg
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libgtk-3-dev

</code></pre> 
<h3><a id="_315"></a>下载源码</h3> 
<ol><li>进入<a href="https://opencv.org/releases/" rel="nofollow">官网</a>，老规矩下载最新版的上一个版本，比如<strong>4.4Sources版本</strong>：<br> <img src="https://images2.imgbox.com/01/af/ql8yy4Vk_o.png" alt="在这里插入图片描述"></li><li>再去GitHub上下载<a href="https://github.com/opencv/opencv_contrib/releases">opencv_contrib源码</a>（<strong>两者的版本要一致</strong>）<br> <img src="https://images2.imgbox.com/be/91/LJqeuwh0_o.png" alt="在这里插入图片描述"></li><li>最后将contrib压缩包解压后放进之前解压好的Opencv Sources的文件夹下</li></ol> 
<p>在这里提前打个补丁，因为在后面编译OpenCV 以及 openc_contrib 时很容易出现提示：缺少boostdesc_bgm.i文件出错。可能是因为墙的问题，有一些文件下载不全</p> 
<pre><code class="prism language-bash">总共缺了以下几个文件：
boostdesc_bgm.i
boostdesc_bgm_bi.i
boostdesc_bgm_hd.i
boostdesc_lbgm.i
boostdesc_binboost_064.i
boostdesc_binboost_128.i
boostdesc_binboost_256.i
vgg_generated_120.i
vgg_generated_64.i
vgg_generated_80.i
vgg_generated_48.i
</code></pre> 
<p>所以需要手动打补丁。</p> 
<blockquote> 
 <p>这里感谢这位博主贡献的资源，自行下载：https://blog.csdn.net/AlexWang30/article/details/99612188</p> 
</blockquote> 
<p>下载解压到对应的opencv_contrib/modules/xfeatures2d/src/目录下</p> 
<h3><a id="cmakegui_346"></a>下载cmake-gui</h3> 
<p><a href="https://cmake.org/files/v3.14/" rel="nofollow">官网下载cmake</a>（我用的是3.14，直接终端下载的话版本很低，且听说会有点问题）,解压后打开cmake-gui。<br> <img src="https://images2.imgbox.com/f1/75/QwEOIJNQ_o.png" alt="在这里插入图片描述"><br> 进入cmake-gui后，需要进行参数配置，可以参考这篇博客的</p> 
<blockquote> 
 <p><strong>2.cmake 配置</strong><br> https://blog.csdn.net/qq_36275734/article/details/81158966</p> 
</blockquote> 
<p>一定要注意在配置中下面对应的路径指向</p> 
<pre><code class="prism language-bash">Python <span class="token number">3</span>:
    Interpreter:                 
    Libraries:                   
    numpy:                       
    packages path:  
</code></pre> 
<p>每次Configure 时都要注意下方区域有没有标红的和error字眼，如果有请自行百度，因为cmake的问题各种各样的，很奇葩。<br> 配置完成后，点击Generate,会在build文件夹中生成一系列文件．</p> 
<h3><a id="opencv_365"></a>终端编译opencv</h3> 
<p>重头戏来了</p> 
<ol><li>终端进入到build文件目录下</li><li>编译，可以使用多线程编译来加快编译速度（比如 make -j6之类的）但是这里每个人的配置都不一样，根据cpu性能选择多线程编译数，不要占满自己CPU，用一半就行了（编译需要好一会时间）</li></ol> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">make</span>
</code></pre> 
<ol start="3"><li>经过漫长的等待，终于编译成功了（失败了怎么办？检查编译失败的错误消息，在确保cmake-gui没问题下，可能是有一些依赖没安装好,并且我会在评论区记录一些遇到过的问题以及解决方法），安装：</li></ol> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">make</span> <span class="token function">install</span> 
</code></pre> 
<p>4.验证opencv安装：</p> 
<pre><code class="prism language-bash">pkg-config opencv4 --libs                   <span class="token punctuation">(</span>查看opencv的lib库<span class="token punctuation">)</span>
pkg-config opencv4 --modversion             <span class="token punctuation">(</span>查看opencv的安装版本<span class="token punctuation">)</span> 
</code></pre> 
<h2><a id="anaconda_393"></a>安装anaconda</h2> 
<p>Anaconda是python开发环境特好用的一个工具，可以让你建立不同的python虚拟环境不受外界干扰，在同一机器上不同python工程提供了方便。也是一个出色的集成开发工具集，包括了Python解释器、conda包管理器、以及众多集成好的数学科学库（numpy/pandas/matplotlib/scipy/sk-learn 等等）因此非常适合于对 python 有数据处理需求的工程师与学生使用，可以减少因包依赖导致的库下载失败而浪费时间。</p> 
<h3><a id="_395"></a>下载安装</h3> 
<p>国内用户可以从清华大学开源软件镜像站里面获取 <a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/" rel="nofollow">Anaconda 3</a><br> 根据自己的基础配置选择对应的 Linux 86_64 位版本下载。<br> <img src="https://images2.imgbox.com/82/53/EBWhhBCy_o.png" alt="在这里插入图片描述"></p> 
<p>下载好后，终端进入安装包所在的对应目录，执行：</p> 
<pre><code class="prism language-bash"><span class="token function">bash</span> Anaconda3-***-Linux-x86_64.sh
</code></pre> 
<p>然后就开始一直按回车，直到最后许可信息显示完出现下面提示，回复yes<br> <img src="https://images2.imgbox.com/fa/b8/2lchMIc1_o.png" alt="在这里插入图片描述"><br> 之后就提示你要将Anaconda安装在目录/home/xxx/anaconda3下面：（建议使用此目录）直接按回车键表示使用默认目录，进行安装过程了。<br> <img src="https://images2.imgbox.com/03/b9/WzoE3qpL_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d2/d5/SfvqJ2DZ_o.png" alt="在这里插入图片描述"></p> 
<p>等待安装完之后，会询问是否把anaconda的bin添加到用户的环境变量中<br> 输入yes<br> <img src="https://images2.imgbox.com/03/5c/fH5qQBU4_o.png" alt="在这里插入图片描述"><br> 检查是否安装<br> 打开一个新的终端，输入</p> 
<pre><code class="prism language-bash">python
或
conda --version
</code></pre> 
<p>安装成功后你就可以开始创建管理自己的虚拟环境了。<br> <img src="https://images2.imgbox.com/87/61/Xedq7EyC_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="OpenCVanaconda_425"></a>OpenCV与anaconda调用问题</h3> 
<p>接回OpenCV安装前谈到的问题：如何让anaconda3也能调用OpenCV？<br> 其实使用系统自带的python2和python3编译分别会生成对应Python版本的cv2.so和cv2.cpython-35m-x86_64-linux-gnu.so（一般现在都是Python3）这就是我们分别在anaconda2和anaconda3中import的cv2模块。</p> 
<p>因为我的是anaconda3，所以首先进入到~/opencv-4.4.0/my_build_dir/lib/python3目录下将其中的cv2.cpython-35m-x86_64-linux-gnu.so复制到anaconda下。（如果是anaconda2就直接将cv2.so复制进去就可以了）</p> 
<pre><code class="prism language-bash">（一定要找对位置）
<span class="token function">sudo</span> <span class="token function">cp</span> cv2.cpython-35m-x86_64-linux-gnu.so /home/zya/anaconda3/lib/python3.6/site-packages/
</code></pre> 
<p>然后改名：</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">mv</span> cv2.cpython-35m-x86_64-linux-gnu.so cv2.so
</code></pre> 
<p>当然你不愿意复制也可以使用建立软链接的方式（不太推荐，个人觉得没复制的方便）</p> 
<pre><code class="prism language-bash"><span class="token function">ln</span> -s /usr/local/lib/python3.6/site-packages/cv2.cpython-36m-x86_64-linux-gnu.so /anaconda3/lib/python3.6/site-packages/cv2.so
</code></pre> 
<p>然后问题完美解决了！</p> 
<h2><a id="TensorFlowGPU_449"></a>安装TensorFlow-GPU</h2> 
<h3><a id="_450"></a>版本对应</h3> 
<p>Anaconda中安装TensorFlow的时候发现：Anaconda自动安装TensorFlow的时候会配置你安装版本对应的CUDA和cuDNN,而我们的是反过来的，我觉得问题不大。TF与cuda、cudnn的版本对应如下：<br> <img src="https://images2.imgbox.com/ab/c7/MBbs1erX_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_453"></a>创建与安装</h3> 
<p>1.创建虚拟环境:<br> 我们在anaconda3中创建虚拟环境来调用TF，这样就不会影响电脑本身的环境。</p> 
<pre><code class="prism language-bash">创建tf虚拟环境
conda create -n tf <span class="token assign-left variable">python</span><span class="token operator">=</span><span class="token number">3.6</span>（tf为自定义命名）
</code></pre> 
<pre><code class="prism language-bash">激活环境
<span class="token builtin class-name">source</span> activate tf
</code></pre> 
<pre><code class="prism language-bash">退出虚拟环境。
conda deactivate
</code></pre> 
<pre><code class="prism language-bash">安装TensorFlow-gpu2.1.0，两方法（这个2.1.0可以自己修改为自己想要的）
pip <span class="token function">install</span> -i https://pypi.tuna.tsinghua.edu.cn/simple tensorflow-gpu<span class="token operator">==</span><span class="token number">2.1</span>.0
或
conda <span class="token function">install</span> tensorflow-gpu<span class="token operator">=</span><span class="token number">2.1</span>.0
</code></pre> 
<p>有时只修改镜像源是不够的，依旧会爆出HTTP超时，需要设置超时时间,还有就是pip和conda的都改一下，有时候用conda有时候用pip的。</p> 
<p>安装好后进行测试<br> 终端进入虚拟环境，然后输入</p> 
<pre><code class="prism language-bash">python
</code></pre> 
<p>输入</p> 
<pre><code class="prism language-bash"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token function">import</span> tensorflow as tf
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> print<span class="token punctuation">(</span>tf.__version__<span class="token punctuation">)</span>
<span class="token number">2.1</span>.0
</code></pre> 
<p>这样子就成功了</p> 
<h2><a id="pytorchGPU_497"></a>安装pytorch-GPU</h2> 
<h3><a id="_498"></a>版本对应</h3> 
<p>pytorch与cuda、cudnn的版本对应如下：<br> <img src="https://images2.imgbox.com/35/b7/7RIfzR4v_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_502"></a>创建与安装</h3> 
<p>1.创建虚拟环境:</p> 
<pre><code class="prism language-bash">创建tf虚拟环境
conda create -n torch <span class="token assign-left variable">python</span><span class="token operator">=</span><span class="token number">3.6</span>（tf为自定义命名）
</code></pre> 
<pre><code class="prism language-bash">激活环境
<span class="token builtin class-name">source</span> activate torch
</code></pre> 
<pre><code class="prism language-bash">退出虚拟环境。
conda deactivate
</code></pre> 
<p>2.安装</p> 
<pre><code class="prism language-bash">pip <span class="token function">install</span> <span class="token assign-left variable">torch</span><span class="token operator">==</span><span class="token number">1.6</span>.0 <span class="token assign-left variable">torchvision</span><span class="token operator">==</span><span class="token number">0.7</span>.0 -f http://download.pytorch.org/whl/torch_stable.html
</code></pre> 
<p>可能是因为国外的原因，下的比较慢，嫌弃的话可以到清华镜像下载对应版本的<a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/linux-64/" rel="nofollow">pytorch包</a>（<s>没试过</s> ,表示很好用，建议用这个）</p> 
<p>到下载好的目录下安装：</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> 压缩包所在文件夹
</code></pre> 
<pre><code class="prism language-bash">conda <span class="token function">install</span> --offline pytorch-1.6.0-py3.6_cuda10.1.243_cudnn7.6.3_0.tar.bz2
 conda <span class="token function">install</span> --offline torchvision-0.7.0-py36_cu101.tar.bz2
</code></pre> 
<h2><a id="_544"></a>结语</h2> 
<ol><li>自此，环境搭建基本结束了，如果有不对的地方请评论区留言，有问题我尽量回答</li><li>这个笔记原意是我自己的学习记录，不保证所有操作都是正确的（毕竟网络变得太快了，有的方法可能过时或者失效了）</li><li>由于我太懒了，这个笔记大概拖了大半年的更，只是师弟在催更，才想起没写完（哭）。</li><li>给个3连吧！！！</li></ol> 
<h2><a id="CUDA_552"></a>多CUDA安装</h2> 
<h3><a id="2022914cuda_553"></a>2022年9月14日，更新多cuda教程</h3> 
<p>公司服务器被多人使用导致需求不同的cuda版本，一直没找到一个完全完整靠谱的教程，这是我参考几个博客完成测试的全过程记录，方便以后操作，无任何商业用途，如有侵权，请联系删除。<br> <a href="https://developer.nvidia.com/cuda-toolkit-archive" rel="nofollow">CUDA历史下载</a><br> <a href="https://developer.nvidia.com/rdp/cudnn-archive" rel="nofollow">CUDNN历史下载</a></p> 
<p><strong>之前已经安装了一个cuda10.1，现在安装cuda10.2及其cudnn8.0.5</strong></p> 
<p>根据官网命令执行<br> <img src="https://images2.imgbox.com/da/3b/lsMQxthq_o.png" alt="在这里插入图片描述"></p> 
<p>这个选项表达已经有cuda存在于/usr/local/cuda，是否更新此安装？<br> 选yes没问题。<br> <img src="https://images2.imgbox.com/77/22/UiPTwZ6l_o.png" alt="在这里插入图片描述"><br> 至此之后安装成功，不专门截图。。。</p> 
<p>执行命令，查看是否有新的cuda</p> 
<pre><code>ls -l /usr/local | grep cuda
</code></pre> 
<p><img src="https://images2.imgbox.com/2a/a0/mcFT9ztB_o.png" alt="在这里插入图片描述"></p> 
<p>安装cudnn，选第一个<br> <img src="https://images2.imgbox.com/1a/a8/w5NXF5Zd_o.png" alt="在这里插入图片描述"></p> 
<p>下载解压后，进入该文件夹<br> <img src="https://images2.imgbox.com/8a/1c/kwuo9nrh_o.png" alt="在这里插入图片描述"><br> 执行以下命令，请根据自己下载的<strong>cuda版本号</strong>以及观察 <strong>/usr/local</strong>下的文件<strong>对命令进行修改</strong></p> 
<pre><code>sudo cp cuda/include/cudnn* /usr/local/cuda-10.2/include
sudo cp cuda/lib64/libcudnn* /usr/local/cuda-10.2/lib64
sudo chmod a+r /usr/local/cuda-10.2/include/cudnn.h /usr/local/cuda-10.2/lib64/libcudnn*
</code></pre> 
<p>同时建议把之前的cuda与cudnn文件也整理一下，到时候就可以直接整体进行软链接，命令与上面的一样格式.</p> 
<p>终端执行sudo gedit ~/.bashrc，打开环境变量配置文本。将里面所有与cuda有关的带版本号路径都改为无版本号的。比如我之前已经安装好了cuda10.1，然后当时配置环境变量时，有许多/usr/local/cuda-10.1/这样的路径，要做的就是把所有的-10.1都去掉。修改好之后，保存并关闭文件，然后在终端执行命令source ~/.bashrc使环境变量的修改生效。</p> 
<p><strong>切换不同的cuda执行以下命令</strong></p> 
<pre><code># 删除目前的软链接
sudo rm -rf /usr/local/cuda  
# 生成新的软链接
sudo ln -s /usr/local/cuda-10.2 /usr/local/cuda 
# 查看当前cuda的版本，或者用nvcc --version
cat /usr/local/cuda/version.txt
#查看cudnn版本
cat /usr/local/cuda/include/cudnn_version.h | grep CUDNN_MAJOR -A 2
</code></pre> 
<p>至此结束</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a75375cdb3f3ea887ebda466c58134b7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">(js)new Date() 怎么取年月日时分秒</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d661c66f652bb0a987dbb0a6d9fb6c98/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MapstructPlus的快速集成</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>