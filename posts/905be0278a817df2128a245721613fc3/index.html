<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java调用批处理bat文件调用python pdfkit把动态html转pdf - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java调用批处理bat文件调用python pdfkit把动态html转pdf" />
<meta property="og:description" content="项目中用到生成pdf征信报告的需求，最近尝试了好多方法
1.传统的方法，使用pdfbox itext方法，生成的pdf不仅难看，而且不容易控制
2.freemarker技术，首先创建个word模板，转xml模型，通过freemarker技术填充数据到xml模型中，生成word文件，然后转pdf文件。
这种方法，适合于表格填充数据，我就不贴代码了
3.wkhtmltopdf技术，这种html直接转pdf的方法，因为我用java来开发的，好多参数不管用，封面控制，页头，页尾不好控制
4.python pdfkit技术。最后我用的这种方法，因为我不是很懂python开发，既然用到了这个技术，我花了一天来研究，能写些简单的脚本语言就可以了。
总是思路，首先html预览数据样式，可以加入一些echarts效果图等，然后java调用bat批处理文件，把当前html转成pdf文件，最后html页面下载并预览本地磁盘文件。
这里碰到个很头疼的问题，java直接调用python是可以的，也可以传入参数，但是python脚本中加入了页头，页尾和封面等等 主要是import pdfkit 不能直接调用，所以最后写了个批处理文件来启动这个python脚本。很无语。
下面贴代码
java调用bat文件出
python脚本
当然由于不能直接调用pthon传入参数 所有这里使用的是 pdfkit.from_url方法，这里有个问题，如果你的html数据是动态渲染的，请求时间不能太长，否则转成的pdf是空的。 然后就是页面下载并预览本地磁盘的pdf文件了" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/905be0278a817df2128a245721613fc3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-05-25T17:28:10+08:00" />
<meta property="article:modified_time" content="2017-05-25T17:28:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java调用批处理bat文件调用python pdfkit把动态html转pdf</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>项目中用到生成pdf征信报告的需求，最近尝试了好多方法</p> 
<p>1.传统的方法，使用pdfbox itext方法，生成的pdf不仅难看，而且不容易控制</p> 
<p>2.freemarker技术，首先创建个word模板，转xml模型，通过freemarker技术填充数据到xml模型中，生成word文件，然后转pdf文件。</p> 
<p>这种方法，适合于表格填充数据，我就不贴代码了</p> 
<p>3.wkhtmltopdf技术，这种html直接转pdf的方法，因为我用java来开发的，好多参数不管用，封面控制，页头，页尾不好控制</p> 
<p>4.python  pdfkit技术。最后我用的这种方法，因为我不是很懂python开发，既然用到了这个技术，我花了一天来研究，能写些简单的脚本语言就可以了。</p> 
<p>总是思路，首先html预览数据样式，可以加入一些echarts效果图等，然后java调用bat批处理文件，把当前html转成pdf文件，最后html页面下载并预览本地磁盘文件。</p> 
<p>这里碰到个很头疼的问题，java直接调用python是可以的，也可以传入参数，但是python脚本中加入了页头，页尾和封面等等 主要是import pdfkit 不能直接调用，所以最后写了个批处理文件来启动这个python脚本。很无语。</p> 
<p>下面贴代码</p> 
<p><img src="" alt=""><br> </p> 
<p>java调用bat文件出</p> 
<p><img src="" alt=""><br> </p> 
<p><br> </p> 
<p>python脚本</p> 
<p><img src="" alt=""><br> </p> 
<p>当然由于不能直接调用pthon传入参数  所有这里使用的是 pdfkit.from_url方法，这里有个问题，如果你的html数据是动态渲染的，请求时间不能太长，否则转成的pdf是空的。 </p> 
<p>然后就是页面下载并预览本地磁盘的pdf文件了</p> 
<p><br> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/daa2239551d2dda4e08a4e2dda15a87d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于OpenCV和VTK的冠脉三维重建</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/320bf391cbe06e1d87992d8e56213f6a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">二分法查找示例</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>