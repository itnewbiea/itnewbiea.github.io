<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>apache的默认设置（端口，发布文件，发布目录） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="apache的默认设置（端口，发布文件，发布目录）" />
<meta property="og:description" content="一：apache的概念
Apache是世界使用排名第一的Web服务器软件。它可以运行在几乎所有广泛使用的计算机平台上，由于其跨平台和安全性被广泛使用，是最流行的Web服务器端软件之一。它快速、可靠并且可通过简单的API扩充，将Perl/Python等解释器编译到服务器中。
它可以运行在几乎所有广泛使用的计算机平台上
目录文件：
程序目录：/usr/sbin/httpd
默认网站主页存放目录： /var/www/html/
日志文件存放目录：/var/log/httpd/
主配置目录：/etc/httpd/conf/
主配置文件：/etc/httpd/conf/httpd.conf
从配置目录：/etc/httpd/conf.d/
apache的默认端口是80
二：apache的默认发布文件
/var/www
默认情况下将要发布的网页文件应该置于/var/www目录下，这一默认值可以同过主配置文件中的DocumentRoot 选项修改。
实验如下：
前提：
为了实验的纯净，我们将这台虚拟机reset
设置ip
修改主机名为apache.westos.com
搭建yum源
将图形界面转化为无图形界面，并用ssh去连接（看个人意愿）
此使我们在浏览器里输入172.25.254.115显示不能连接，如下图所示：
为了解决这个问题，我们需要做以下的实验。
实验如下：
&lt;1&gt;安装软件
yum search apache yum install httpd.x86_64 -y 安装httpd软件包 搜索出来的结果中安装这个软件包
安装
安装完成
&lt;2&gt;启动服务
systemctl start httpd systemctl enable httpd systemctl status httpd &lt;3&gt;对防火墙进行设置（若是嫌麻烦，可直接关掉防火墙）
firewall-cmd --permanent --add-service=http 防火墙允许的服务有http firewall-cmd --reload 重新加载 firewall-cmd --list-all 查看 &lt;4&gt;编辑默认发布文件
cd /var/www/html ls vim index.html （必须是index.html。服务默认的共享文件（默认发布文件）只有这一个） 在里面写入
重启服务
测试：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/386e06a06ed77b0d488ce6dd269d7fb2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-05-22T23:03:38+08:00" />
<meta property="article:modified_time" content="2019-05-22T23:03:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">apache的默认设置（端口，发布文件，发布目录）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>一：apache的概念</strong></p> 
<blockquote> 
 <p>Apache是世界使用排名第一的Web服务器软件。它可以运行在几乎所有广泛使用的计算机平台上，由于其跨平台和安全性被广泛使用，是最流行的Web服务器端软件之一。它快速、可靠并且可通过简单的API扩充，将Perl/Python等解释器编译到服务器中。</p> 
</blockquote> 
<p><mark>它可以运行在几乎所有广泛使用的计算机平台上</mark></p> 
<p>目录文件：</p> 
<blockquote> 
 <p>程序目录：/usr/sbin/httpd<br> 默认网站主页存放目录： /var/www/html/<br> 日志文件存放目录：/var/log/httpd/<br> 主配置目录：/etc/httpd/conf/<br> 主配置文件：/etc/httpd/conf/httpd.conf<br> 从配置目录：/etc/httpd/conf.d/</p> 
</blockquote> 
<p><mark>apache的默认端口是80</mark></p> 
<p><strong>二：apache的默认发布文件</strong></p> 
<p><mark>/var/www</mark><br> 默认情况下将要发布的网页文件应该置于/var/www目录下，这一默认值可以同过主配置文件中的DocumentRoot 选项修改。</p> 
<p><mark>实验如下</mark>：</p> 
<p><strong>前提：</strong></p> 
<p>为了实验的纯净，我们将这台虚拟机reset</p> 
<p><img src="https://images2.imgbox.com/22/0b/g87Sv9Dd_o.png" alt="在这里插入图片描述"><br> 设置ip<br> <img src="https://images2.imgbox.com/05/3b/C9HqoSXx_o.png" alt="在这里插入图片描述"></p> 
<p><a href="http://xn--apache-vy7iha820bqpnts1c69e.westos.com" rel="nofollow">修改主机名为apache.westos.com</a><br> <img src="https://images2.imgbox.com/0e/ba/dDO4iqWj_o.png" alt="在这里插入图片描述"><br> 搭建yum源</p> 
<p><img src="https://images2.imgbox.com/51/a0/QK5JiDcp_o.png" alt="在这里插入图片描述"></p> 
<p>将图形界面转化为无图形界面，并用ssh去连接（看个人意愿）</p> 
<p><img src="https://images2.imgbox.com/56/ff/VWCykM0M_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f6/e7/ckwvY7U7_o.png" alt="在这里插入图片描述"></p> 
<p>此使我们在浏览器里输入172.25.254.115显示不能连接，如下图所示：<br> <img src="https://images2.imgbox.com/e7/25/GEYI7lXR_o.png" alt="在这里插入图片描述"></p> 
<p>为了解决这个问题，我们需要做以下的实验。</p> 
<p><mark>实验如下</mark>：</p> 
<p><mark>&lt;1&gt;安装软件</mark></p> 
<pre><code>yum search apache      
yum install httpd.x86_64 -y                   安装httpd软件包
</code></pre> 
<p><img src="https://images2.imgbox.com/5a/3a/Nl6n29Qy_o.png" alt="在这里插入图片描述"><br> 搜索出来的结果中安装这个软件包<br> <img src="https://images2.imgbox.com/70/9b/SkI57RKA_o.png" alt="在这里插入图片描述"><br> 安装<br> <img src="https://images2.imgbox.com/94/0a/K4OcKEAH_o.png" alt="在这里插入图片描述"><br> 安装完成<br> <img src="https://images2.imgbox.com/63/5b/KwgdQxUV_o.png" alt="在这里插入图片描述"><mark>&lt;2&gt;启动服务</mark></p> 
<pre><code>systemctl start httpd  
systemctl enable httpd              
systemctl status httpd
</code></pre> 
<p><img src="https://images2.imgbox.com/87/0e/vr7A6phN_o.png" alt="在这里插入图片描述"></p> 
<p><mark>&lt;3&gt;对防火墙进行设置</mark>（若是嫌麻烦，可直接关掉防火墙）</p> 
<pre><code> firewall-cmd --permanent  --add-service=http      防火墙允许的服务有http
 firewall-cmd --reload                                 重新加载
 firewall-cmd --list-all                                  查看
</code></pre> 
<p><img src="https://images2.imgbox.com/77/06/cTVWWDso_o.png" alt="在这里插入图片描述"></p> 
<p>&lt;4&gt;编辑默认发布文件</p> 
<pre><code>cd /var/www/html
ls
vim index.html  （必须是index.html。服务默认的共享文件（默认发布文件）只有这一个）
</code></pre> 
<p><img src="https://images2.imgbox.com/03/8e/HuvAP59j_o.png" alt="在这里插入图片描述"></p> 
<p>在里面写入<br> <img src="https://images2.imgbox.com/81/4a/E7YB3bel_o.png" alt="在这里插入图片描述"><br> 重启服务<br> <img src="https://images2.imgbox.com/ff/3e/5x6jmqcq_o.png" alt="在这里插入图片描述"></p> 
<p><mark>测试：</mark></p> 
<p>浏览器输入172.25.254.115（本机ip）会出现下图所示<br> <img src="https://images2.imgbox.com/13/3e/RhbafHpc_o.png" alt="在这里插入图片描述"></p> 
<p><mark>注意</mark>：因为man不能查看http的用法，所以我们想要知道http的用法，得下载一个http手册</p> 
<p><img src="https://images2.imgbox.com/e6/b6/41v3iNTM_o.png" alt="在这里插入图片描述"><br> 安装完成<br> <img src="https://images2.imgbox.com/21/dc/HtBOrk4G_o.png" alt="在这里插入图片描述"><br> 可在浏览器里172.25.254.115/manual查看（中文版可去百度寻找）<br> <img src="https://images2.imgbox.com/df/c4/5mekCUGk_o.png" alt="在这里插入图片描述"></p> 
<p><strong>三：修改apache的默认设置</strong></p> 
<p>前提：</p> 
<pre><code>getenforce   此时看到的状态是disabled
vim /etc/sysconfig/selinux 
将selinux修改为enforcing
reboot
getenforce   此时看到的状态是enforcing
</code></pre> 
<p><img src="https://images2.imgbox.com/7f/63/XsR1svkk_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/32/f0/kL0phI6c_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/44/27/VMIFvxol_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/32/ea/0kpZwZa5_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/40/33/sIMhw4JU_o.png" alt="在这里插入图片描述"></p> 
<p><mark><strong>&lt;1&gt;修改默认端口（默认是80）</strong></mark></p> 
<p><mark>第一种：修改为8080端口（8080被selinux允许）</mark></p> 
<pre><code>netstat -antlupe | grep httpd    查看httpd的端口号，为80
</code></pre> 
<p><img src="https://images2.imgbox.com/f6/af/pC4R75bj_o.png" alt="在这里插入图片描述"></p> 
<pre><code>vim /etc/httpd/conf/httpd.conf    修改配置文件，将端口修改为8080
</code></pre> 
<p><img src="https://images2.imgbox.com/7f/53/7uWMvghL_o.png" alt="在这里插入图片描述"><br> 原本的端口是80<br> <img src="https://images2.imgbox.com/17/4a/WSpZ7hmE_o.png" alt="在这里插入图片描述"><br> 修改为8080<br> <img src="https://images2.imgbox.com/6d/de/M3lIetrv_o.png" alt="在这里插入图片描述"><br> 重启服务</p> 
<pre><code>systemctl restart httpd
</code></pre> 
<p><img src="https://images2.imgbox.com/2d/40/RFq45UjO_o.png" alt="在这里插入图片描述"></p> 
<pre><code>firewall-cmd --permanent  --add-port=8080/tcp    添加防火墙的tcp8080端口，如果嫌麻烦，可以直接关掉防火墙
firewall-cmd --reload       重新加载
</code></pre> 
<p><img src="https://images2.imgbox.com/3b/e3/tBbRPUjZ_o.png" alt="在这里插入图片描述"></p> 
<pre><code>netstat -antlupe | grep httpd     此时的端口号是8080
</code></pre> 
<p><img src="https://images2.imgbox.com/16/72/d2PjE7YQ_o.png" alt="在这里插入图片描述"></p> 
<p>测试：在浏览器测试，会看到默认发布文件<br> <img src="https://images2.imgbox.com/06/e3/tLUYBlUw_o.png" alt="在这里插入图片描述"></p> 
<p><mark>第二种：修改为6666端口（selinux不允许）</mark></p> 
<pre><code>netstat -antlupe | grep 6666  看这个端口是否被使用，没有被使用
vim /etc/httpd/conf/httpd.conf  修改配置文件，将端口修改为6666
</code></pre> 
<p><img src="https://images2.imgbox.com/9e/aa/oCLFI7DU_o.png" alt="在这里插入图片描述"><br> 修改为6666<br> <img src="https://images2.imgbox.com/b8/24/sAZiw0Yq_o.png" alt="在这里插入图片描述"></p> 
<pre><code>firewall-cmd --permanent  --add-port=6666/tcp
firewall-cmd --reload
systemctl restart httpd 此时重启服务起不来，因为selinux拒绝6666
</code></pre> 
<p><img src="https://images2.imgbox.com/fd/90/3ym5ZjXH_o.png" alt="在这里插入图片描述"></p> 
<pre><code>setenforce 0          将内核防火墙改为permission
getenforce             查看
systemctl restart httpd    可以重启起来，也可以访问到
</code></pre> 
<p><img src="https://images2.imgbox.com/c3/48/9B9GV2vU_o.png" alt="在这里插入图片描述"><br> 此时去浏览器访问，可以访问到<br> <img src="https://images2.imgbox.com/38/b0/3pvOEjNO_o.png" alt="在这里插入图片描述"></p> 
<p><mark>在防火墙为enforcing的时候可以开启服务，需要进行以下操作</mark></p> 
<pre><code>setenforce 1                       将内核防火墙修改为enforcing
getenforce 
semanage port -l | grep http            查看系统中selinux对http允许的端口号，没有6666
semanage port -a -t http_port_t -p tcp 6666    加入6666端口
semanage port -l | grep http     有了端口
systemctl restart httpd            重启服务
</code></pre> 
<p><img src="https://images2.imgbox.com/54/87/umSDjOMR_o.png" alt="在这里插入图片描述"></p> 
<p>在去浏览器172.25.254.115:6666查看</p> 
<p><img src="https://images2.imgbox.com/23/34/YKnHhz4r_o.png" alt="在这里插入图片描述"></p> 
<p><mark><strong>&lt;2&gt;修改发布文件</strong></mark>（做这个实验前先把默认端口修改为80）</p> 
<pre><code>cd /var/www/html
ls
vim test.html         在里面写点内容，将其作为访问时会出现的内容
</code></pre> 
<p><img src="https://images2.imgbox.com/a1/c8/SzWkRkCs_o.png" alt="在这里插入图片描述"></p> 
<pre><code>vim /etc/httpd/conf/httpd.conf   在这个里面修改默认发布文件
systemctl restart httpd
</code></pre> 
<p><img src="https://images2.imgbox.com/54/ec/d9s4lWEy_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f3/05/1ZCeZ2AF_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e7/45/It6BS8wn_o.png" alt="在这里插入图片描述"></p> 
<p>此时去浏览器172.25.254.115查看 此时查看到的是test.html里面的内容<br> <img src="https://images2.imgbox.com/69/11/4TSbGcva_o.png" alt="在这里插入图片描述"></p> 
<pre><code>vim /etc/httpd/conf/httpd.conf （在这个里面写两个发布文件，谁在前先访问谁）    此时index.html在前
systemctl restart httpd  
</code></pre> 
<p><img src="https://images2.imgbox.com/5b/02/B1IHMXp9_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ee/38/ivAAWCYY_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/e6/cb/HEq1u4W5_o.png" alt="在这里插入图片描述"></p> 
<p>此时 在浏览器172.25.254.115查看，此时查看到的是index.html里面的内容<br> <img src="https://images2.imgbox.com/74/e7/6EgvSIil_o.png" alt="在这里插入图片描述"></p> 
<pre><code> mv index.html    /mnt/              将index.html移动到/mnt下
</code></pre> 
<p><img src="https://images2.imgbox.com/24/73/PHfygtsF_o.png" alt="在这里插入图片描述"><br> 在浏览器172.25.254.115查看 此时查看的是test.html里面的内容</p> 
<p><img src="https://images2.imgbox.com/31/50/P5V0141I_o.png" alt="在这里插入图片描述"></p> 
<p><mark><strong>&lt;3&gt;修改默认配置目录</strong></mark>（将默认发布文件修改回来）</p> 
<pre><code>mkdir /meng/html -p      建立一个目录
vim  /meng/html/index.html   在这个目录的默认发布文件里面随便写点东西
</code></pre> 
<p><img src="https://images2.imgbox.com/27/ab/Cjb4kVJq_o.png" alt="在这里插入图片描述"></p> 
<pre><code> vim /etc/httpd/conf/httpd.conf    在配置文件里里面，将其默认目录修改为/meng/html
</code></pre> 
<p><img src="https://images2.imgbox.com/b6/85/f32QZ4Aj_o.png" alt="在这里插入图片描述"><br> 原本目录是/www/html<br> <img src="https://images2.imgbox.com/26/55/2raaGHR6_o.png" alt="在这里插入图片描述"><br> 将其修改为以下样子</p> 
<p><img src="https://images2.imgbox.com/a1/2d/5BUgsffW_o.png" alt="在这里插入图片描述"></p> 
<pre><code>systemctl restart httpd     重启服务
</code></pre> 
<p><img src="https://images2.imgbox.com/fb/44/ltwD2iRA_o.png" alt="在这里插入图片描述"></p> 
<p>再去重启服务<br> <img src="https://images2.imgbox.com/09/80/1lKPXbf9_o.png" alt="在这里插入图片描述"><br> 发现访问不到：<br> <img src="https://images2.imgbox.com/f3/b9/3UId1yKK_o.png" alt="在这里插入图片描述"><br> 这是因为这个默认目录没有被查看的权限，为了解决这个问题，我们需要进行以下操作：</p> 
<pre><code>vim /etc/httpd/conf/httpd.conf   在里面写入授权命令，如下（整体）
在里面写入以下内容：
DocumentRoot "/meng/html"       修改默认发布目录
    &lt;Directory "/meng/html"&gt;        授权
            Require all granted      所有人都可以来访问
    &lt;/Directory&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/2b/7a/YhDqJp4n_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5d/dc/cPfz9jJM_o.png" alt="在这里插入图片描述"></p> 
<pre><code>systemctl restart httpd        重启服务
</code></pre> 
<p><img src="https://images2.imgbox.com/8f/09/Q4Gaj2bx_o.png" alt="在这里插入图片描述"><br> 在浏览器172.25.254.115查看<br> 此时查看到的是/meng/html/index.html的内容<br> <img src="https://images2.imgbox.com/c8/43/DyJjS5iD_o.png" alt="在这里插入图片描述"></p> 
<p><mark>想要在seliunx为enforing为开启的时候访问到内容</mark></p> 
<pre><code>ls -Zd /var/www/html/      查看系统自己默认发布目录的安全上下文
ls -Zd /westos/html/      查看自己建立的默认发布目录的安全上下文
</code></pre> 
<p><img src="https://images2.imgbox.com/2c/2a/CmnH86Vy_o.png" alt="在这里插入图片描述"></p> 
<pre><code>setenforce 1    切换selinux的状态为enforcing
getenforce
semanage fcontext -a -t httpd_sys_content_t '/meng/html(/.*)?'          让系统记录目录和目录里面内容为http的标签
restorecon -RvvF /meng/html   修改目录及目录里面的内容的安全上下文
</code></pre> 
<p><img src="https://images2.imgbox.com/8f/f3/h6tNN1cy_o.png" alt="在这里插入图片描述"></p> 
<p>在浏览器172.25.254.115查看<br> 此时查看到的是/meng/html/index.html的内容<br> <img src="https://images2.imgbox.com/62/f2/GWsPilkb_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d0831a51cabf9384ddda0ad8968c7bbc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Windows上通过VLC播放器搭建rtsp流媒体测试地址操作步骤</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/49c68890d21bec0e75e08bb73bf28870/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">小程序手动获取用户信息</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>