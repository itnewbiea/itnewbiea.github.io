<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mysql 多表联合查询_数据库 | MySQL多表查询综合练习及答案 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mysql 多表联合查询_数据库 | MySQL多表查询综合练习及答案" />
<meta property="og:description" content="一、综合练习 1.1 init.sql文件内容
/* 数据导入： Navicat Premium Data Transfer Source Server : localhost Source Server Type : MySQL Source Server Version : 50624 Source Host : localhost Source Database : sqlexam Target Server Type : MySQL Target Server Version : 50624 File Encoding : utf-8 Date: 10/21/2016 06:46:46 AM*/SET NAMES utf8;SET FOREIGN_KEY_CHECKS = 0;-- ------------------------------ Table structure for `class`-- ----------------------------DROP TABLE IF EXISTS `class`;CREATE TABLE `class` ( `cid` int(11) NOT NULL AUTO_INCREMENT, `caption` varchar(32) NOT NULL, PRIMARY KEY (`cid`)) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;-- ------------------------------ Records of `class`-- ----------------------------BEGIN;INSERT INTO `class` VALUES (&#39;1&#39;, &#39;三年二班&#39;), (&#39;2&#39;, &#39;三年三班&#39;), (&#39;3&#39;, &#39;一年二班&#39;), (&#39;4&#39;, &#39;二年九班&#39;);COMMIT;-- ------------------------------ Table structure for `course`-- ----------------------------DROP TABLE IF EXISTS `course`;CREATE TABLE `course` ( `cid` int(11) NOT NULL AUTO_INCREMENT, `cname` varchar(32) NOT NULL, `teacher_id` int(11) NOT NULL, PRIMARY KEY (`cid`), KEY `fk_course_teacher` (`teacher_id`), CONSTRAINT `fk_course_teacher` FOREIGN KEY (`teacher_id`) REFERENCES `teacher` (`tid`)) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;-- ------------------------------ Records of `course`-- ----------------------------BEGIN;INSERT INTO `course` VALUES (&#39;1&#39;, &#39;生物&#39;, &#39;1&#39;), (&#39;2&#39;, &#39;物理&#39;, &#39;2&#39;), (&#39;3&#39;, &#39;体育&#39;, &#39;3&#39;), (&#39;4&#39;, &#39;美术&#39;, &#39;2&#39;);COMMIT;-- ------------------------------ Table structure for `score`-- ----------------------------DROP TABLE IF EXISTS `score`;CREATE TABLE `score` ( `sid` int(11) NOT NULL AUTO_INCREMENT, `student_id` int(11) NOT NULL, `course_id` int(11) NOT NULL, `num` int(11) NOT NULL, PRIMARY KEY (`sid`), KEY `fk_score_student` (`student_id`), KEY `fk_score_course` (`course_id`), CONSTRAINT `fk_score_course` FOREIGN KEY (`course_id`) REFERENCES `course` (`cid`), CONSTRAINT `fk_score_student` FOREIGN KEY (`student_id`) REFERENCES `student` (`sid`)) ENGINE=InnoDB AUTO_INCREMENT=53 DEFAULT CHARSET=utf8;-- ------------------------------ Records of `score`-- ----------------------------BEGIN;INSERT INTO `score` VALUES (&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;10&#39;), (&#39;2&#39;, &#39;1&#39;, &#39;2&#39;, &#39;9&#39;), (&#39;5&#39;, &#39;1&#39;, &#39;4&#39;, &#39;66&#39;), (&#39;6&#39;, &#39;2&#39;, &#39;1&#39;, &#39;8&#39;), (&#39;8&#39;, &#39;2&#39;, &#39;3&#39;, &#39;68&#39;), (&#39;9&#39;, &#39;2&#39;, &#39;4&#39;, &#39;99&#39;), (&#39;10&#39;, &#39;3&#39;, &#39;1&#39;, &#39;77&#39;), (&#39;11&#39;, &#39;3&#39;, &#39;2&#39;, &#39;66&#39;), (&#39;12&#39;, &#39;3&#39;, &#39;3&#39;, &#39;87&#39;), (&#39;13&#39;, &#39;3&#39;, &#39;4&#39;, &#39;99&#39;), (&#39;14&#39;, &#39;4&#39;, &#39;1&#39;, &#39;79&#39;), (&#39;15&#39;, &#39;4&#39;, &#39;2&#39;, &#39;11&#39;), (&#39;16&#39;, &#39;4&#39;, &#39;3&#39;, &#39;67&#39;), (&#39;17&#39;, &#39;4&#39;, &#39;4&#39;, &#39;100&#39;), (&#39;18&#39;, &#39;5&#39;, &#39;1&#39;, &#39;79&#39;), (&#39;19&#39;, &#39;5&#39;, &#39;2&#39;, &#39;11&#39;), (&#39;20&#39;, &#39;5&#39;, &#39;3&#39;, &#39;67&#39;), (&#39;21&#39;, &#39;5&#39;, &#39;4&#39;, &#39;100&#39;), (&#39;22&#39;, &#39;6&#39;, &#39;1&#39;, &#39;9&#39;), (&#39;23&#39;, &#39;6&#39;, &#39;2&#39;, &#39;100&#39;), (&#39;24&#39;, &#39;6&#39;, &#39;3&#39;, &#39;67&#39;), (&#39;25&#39;, &#39;6&#39;, &#39;4&#39;, &#39;100&#39;), (&#39;26&#39;, &#39;7&#39;, &#39;1&#39;, &#39;9&#39;), (&#39;27&#39;, &#39;7&#39;, &#39;2&#39;, &#39;100&#39;), (&#39;28&#39;, &#39;7&#39;, &#39;3&#39;, &#39;67&#39;), (&#39;29&#39;, &#39;7&#39;, &#39;4&#39;, &#39;88&#39;), (&#39;30&#39;, &#39;8&#39;, &#39;1&#39;, &#39;9&#39;), (&#39;31&#39;, &#39;8&#39;, &#39;2&#39;, &#39;100&#39;), (&#39;32&#39;, &#39;8&#39;, &#39;3&#39;, &#39;67&#39;), (&#39;33&#39;, &#39;8&#39;, &#39;4&#39;, &#39;88&#39;), (&#39;34&#39;, &#39;9&#39;, &#39;1&#39;, &#39;91&#39;), (&#39;35&#39;, &#39;9&#39;, &#39;2&#39;, &#39;88&#39;), (&#39;36&#39;, &#39;9&#39;, &#39;3&#39;, &#39;67&#39;), (&#39;37&#39;, &#39;9&#39;, &#39;4&#39;, &#39;22&#39;), (&#39;38&#39;, &#39;10&#39;, &#39;1&#39;, &#39;90&#39;), (&#39;39&#39;, &#39;10&#39;, &#39;2&#39;, &#39;77&#39;), (&#39;40&#39;, &#39;10&#39;, &#39;3&#39;, &#39;43&#39;), (&#39;41&#39;, &#39;10&#39;, &#39;4&#39;, &#39;87&#39;), (&#39;42&#39;, &#39;11&#39;, &#39;1&#39;, &#39;90&#39;), (&#39;43&#39;, &#39;11&#39;, &#39;2&#39;, &#39;77&#39;), (&#39;44&#39;, &#39;11&#39;, &#39;3&#39;, &#39;43&#39;), (&#39;45&#39;, &#39;11&#39;, &#39;4&#39;, &#39;87&#39;), (&#39;46&#39;, &#39;12&#39;, &#39;1&#39;, &#39;90&#39;), (&#39;47&#39;, &#39;12&#39;, &#39;2&#39;, &#39;77&#39;), (&#39;48&#39;, &#39;12&#39;, &#39;3&#39;, &#39;43&#39;), (&#39;49&#39;, &#39;12&#39;, &#39;4&#39;, &#39;87&#39;), (&#39;52&#39;, &#39;13&#39;, &#39;3&#39;, &#39;87&#39;);COMMIT;-- ------------------------------ Table structure for `student`-- ----------------------------DROP TABLE IF EXISTS `student`;CREATE TABLE `student` ( `sid` int(11) NOT NULL AUTO_INCREMENT, `gender` char(1) NOT NULL, `class_id` int(11) NOT NULL, `sname` varchar(32) NOT NULL, PRIMARY KEY (`sid`), KEY `fk_class` (`class_id`), CONSTRAINT `fk_class` FOREIGN KEY (`class_id`) REFERENCES `class` (`cid`)) ENGINE=InnoDB AUTO_INCREMENT=17 DEFAULT CHARSET=utf8;-- ------------------------------ Records of `student`-- ----------------------------BEGIN;INSERT INTO `student` VALUES (&#39;1&#39;, &#39;男&#39;, &#39;1&#39;, &#39;理解&#39;), (&#39;2&#39;, &#39;女&#39;, &#39;1&#39;, &#39;钢蛋&#39;), (&#39;3&#39;, &#39;男&#39;, &#39;1&#39;, &#39;张三&#39;), (&#39;4&#39;, &#39;男&#39;, &#39;1&#39;, &#39;张一&#39;), (&#39;5&#39;, &#39;女&#39;, &#39;1&#39;, &#39;张二&#39;), (&#39;6&#39;, &#39;男&#39;, &#39;1&#39;, &#39;张四&#39;), (&#39;7&#39;, &#39;女&#39;, &#39;2&#39;, &#39;铁锤&#39;), (&#39;8&#39;, &#39;男&#39;, &#39;2&#39;, &#39;李三&#39;), (&#39;9&#39;, &#39;男&#39;, &#39;2&#39;, &#39;李一&#39;), (&#39;10&#39;, &#39;女&#39;, &#39;2&#39;, &#39;李二&#39;), (&#39;11&#39;, &#39;男&#39;, &#39;2&#39;, &#39;李四&#39;), (&#39;12&#39;, &#39;女&#39;, &#39;3&#39;, &#39;如花&#39;), (&#39;13&#39;, &#39;男&#39;, &#39;3&#39;, &#39;刘三&#39;), (&#39;14&#39;, &#39;男&#39;, &#39;3&#39;, &#39;刘一&#39;), (&#39;15&#39;, &#39;女&#39;, &#39;3&#39;, &#39;刘二&#39;), (&#39;16&#39;, &#39;男&#39;, &#39;3&#39;, &#39;刘四&#39;);COMMIT;-- ------------------------------ Table structure for `teacher`-- ----------------------------DROP TABLE IF EXISTS `teacher`;CREATE TABLE `teacher` ( `tid` int(11) NOT NULL AUTO_INCREMENT, `tname` varchar(32) NOT NULL, PRIMARY KEY (`tid`)) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8;-- ------------------------------ Records of `teacher`-- ----------------------------BEGIN;INSERT INTO `teacher` VALUES (&#39;1&#39;, &#39;张磊老师&#39;), (&#39;2&#39;, &#39;李平老师&#39;), (&#39;3&#39;, &#39;刘海燕老师&#39;), (&#39;4&#39;, &#39;朱云海老师&#39;), (&#39;5&#39;, &#39;李杰老师&#39;);COMMIT;SET FOREIGN_KEY_CHECKS = 1; 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/91bd41f6510777e9f6591fb1be84b6a4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-21T06:54:19+08:00" />
<meta property="article:modified_time" content="2020-11-21T06:54:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mysql 多表联合查询_数据库 | MySQL多表查询综合练习及答案</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <h2><strong>一、综合练习</strong></h2> 
 <p><strong>1.1 init.sql文件内容</strong></p> 
 <pre><code>/* 数据导入： Navicat Premium Data Transfer Source Server : localhost Source Server Type : MySQL Source Server Version : 50624 Source Host : localhost Source Database : sqlexam Target Server Type : MySQL Target Server Version : 50624 File Encoding : utf-8 Date: 10/21/2016 06:46:46 AM*/SET NAMES utf8;SET FOREIGN_KEY_CHECKS = 0;-- ------------------------------ Table structure for `class`-- ----------------------------DROP TABLE IF EXISTS `class`;CREATE TABLE `class` ( `cid` int(11) NOT NULL AUTO_INCREMENT, `caption` varchar(32) NOT NULL, PRIMARY KEY (`cid`)) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;-- ------------------------------ Records of `class`-- ----------------------------BEGIN;INSERT INTO `class` VALUES ('1', '三年二班'), ('2', '三年三班'), ('3', '一年二班'), ('4', '二年九班');COMMIT;-- ------------------------------ Table structure for `course`-- ----------------------------DROP TABLE IF EXISTS `course`;CREATE TABLE `course` ( `cid` int(11) NOT NULL AUTO_INCREMENT, `cname` varchar(32) NOT NULL, `teacher_id` int(11) NOT NULL, PRIMARY KEY (`cid`), KEY `fk_course_teacher` (`teacher_id`), CONSTRAINT `fk_course_teacher` FOREIGN KEY (`teacher_id`) REFERENCES `teacher` (`tid`)) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;-- ------------------------------ Records of `course`-- ----------------------------BEGIN;INSERT INTO `course` VALUES ('1', '生物', '1'), ('2', '物理', '2'), ('3', '体育', '3'), ('4', '美术', '2');COMMIT;-- ------------------------------ Table structure for `score`-- ----------------------------DROP TABLE IF EXISTS `score`;CREATE TABLE `score` ( `sid` int(11) NOT NULL AUTO_INCREMENT, `student_id` int(11) NOT NULL, `course_id` int(11) NOT NULL, `num` int(11) NOT NULL, PRIMARY KEY (`sid`), KEY `fk_score_student` (`student_id`), KEY `fk_score_course` (`course_id`), CONSTRAINT `fk_score_course` FOREIGN KEY (`course_id`) REFERENCES `course` (`cid`), CONSTRAINT `fk_score_student` FOREIGN KEY (`student_id`) REFERENCES `student` (`sid`)) ENGINE=InnoDB AUTO_INCREMENT=53 DEFAULT CHARSET=utf8;-- ------------------------------ Records of `score`-- ----------------------------BEGIN;INSERT INTO `score` VALUES ('1', '1', '1', '10'), ('2', '1', '2', '9'), ('5', '1', '4', '66'), ('6', '2', '1', '8'), ('8', '2', '3', '68'), ('9', '2', '4', '99'), ('10', '3', '1', '77'), ('11', '3', '2', '66'), ('12', '3', '3', '87'), ('13', '3', '4', '99'), ('14', '4', '1', '79'), ('15', '4', '2', '11'), ('16', '4', '3', '67'), ('17', '4', '4', '100'), ('18', '5', '1', '79'), ('19', '5', '2', '11'), ('20', '5', '3', '67'), ('21', '5', '4', '100'), ('22', '6', '1', '9'), ('23', '6', '2', '100'), ('24', '6', '3', '67'), ('25', '6', '4', '100'), ('26', '7', '1', '9'), ('27', '7', '2', '100'), ('28', '7', '3', '67'), ('29', '7', '4', '88'), ('30', '8', '1', '9'), ('31', '8', '2', '100'), ('32', '8', '3', '67'), ('33', '8', '4', '88'), ('34', '9', '1', '91'), ('35', '9', '2', '88'), ('36', '9', '3', '67'), ('37', '9', '4', '22'), ('38', '10', '1', '90'), ('39', '10', '2', '77'), ('40', '10', '3', '43'), ('41', '10', '4', '87'), ('42', '11', '1', '90'), ('43', '11', '2', '77'), ('44', '11', '3', '43'), ('45', '11', '4', '87'), ('46', '12', '1', '90'), ('47', '12', '2', '77'), ('48', '12', '3', '43'), ('49', '12', '4', '87'), ('52', '13', '3', '87');COMMIT;-- ------------------------------ Table structure for `student`-- ----------------------------DROP TABLE IF EXISTS `student`;CREATE TABLE `student` ( `sid` int(11) NOT NULL AUTO_INCREMENT, `gender` char(1) NOT NULL, `class_id` int(11) NOT NULL, `sname` varchar(32) NOT NULL, PRIMARY KEY (`sid`), KEY `fk_class` (`class_id`), CONSTRAINT `fk_class` FOREIGN KEY (`class_id`) REFERENCES `class` (`cid`)) ENGINE=InnoDB AUTO_INCREMENT=17 DEFAULT CHARSET=utf8;-- ------------------------------ Records of `student`-- ----------------------------BEGIN;INSERT INTO `student` VALUES ('1', '男', '1', '理解'), ('2', '女', '1', '钢蛋'), ('3', '男', '1', '张三'), ('4', '男', '1', '张一'), ('5', '女', '1', '张二'), ('6', '男', '1', '张四'), ('7', '女', '2', '铁锤'), ('8', '男', '2', '李三'), ('9', '男', '2', '李一'), ('10', '女', '2', '李二'), ('11', '男', '2', '李四'), ('12', '女', '3', '如花'), ('13', '男', '3', '刘三'), ('14', '男', '3', '刘一'), ('15', '女', '3', '刘二'), ('16', '男', '3', '刘四');COMMIT;-- ------------------------------ Table structure for `teacher`-- ----------------------------DROP TABLE IF EXISTS `teacher`;CREATE TABLE `teacher` ( `tid` int(11) NOT NULL AUTO_INCREMENT, `tname` varchar(32) NOT NULL, PRIMARY KEY (`tid`)) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8;-- ------------------------------ Records of `teacher`-- ----------------------------BEGIN;INSERT INTO `teacher` VALUES ('1', '张磊老师'), ('2', '李平老师'), ('3', '刘海燕老师'), ('4', '朱云海老师'), ('5', '李杰老师');COMMIT;SET FOREIGN_KEY_CHECKS = 1;</code></pre> 
 <p><strong>1.2 从init.sql文件中导入数据</strong></p> 
 <pre><code># 准备表、记录mysql&gt; create database db1;mysql&gt; use db1;mysql&gt; source /root/init.sql</code></pre> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/17/d6/AZ3gcOyO_o.png" alt="1cf85120f828a73833c35daca00e6e96.png"> 
 </div> 
 <p><strong>1.3 基础练习</strong></p> 
 <ol><li>查询男生、女生的人数；</li><li>查询姓“张”的学生名单；</li><li>课程平均分从高到低显示</li><li>查询有课程成绩小于60分的同学的学号、姓名；</li><li>查询至少有一门课与学号为1的同学所学课程相同的同学的学号和姓名；</li><li>查询出只选修了一门课程的全部学生的学号和姓名；</li><li>查询各科成绩最高和最低的分：以如下形式显示：课程ID，最高分，最低分；</li><li>查询课程编号“2”的成绩比课程编号“1”课程低的所有同学的学号、姓名；</li><li>查询“生物”课程比“物理”课程成绩高的所有学生的学号；</li><li>查询平均成绩大于60分的同学的学号和平均成绩;</li><li>查询所有同学的学号、姓名、选课数、总成绩；</li><li>查询姓“李”的老师的个数；</li><li>查询没学过“张磊老师”课的同学的学号、姓名；</li><li>查询学过“1”并且也学过编号“2”课程的同学的学号、姓名；</li><li>查询学过“李平老师”所教的所有课的同学的学号、姓名；</li></ol> 
 <p><strong>1.4 进阶练习</strong></p> 
 <ol><li>查询没有学全所有课的同学的学号、姓名；</li><li>查询和“002”号的同学学习的课程完全相同的其他同学学号和姓名；</li><li>删除学习“叶平”老师课的SC表记录；</li><li>向SC表中插入一些记录，这些记录要求符合以下条件：①没有上过编号“002”课程的同学学号；②插入“002”号课程的平均成绩；</li><li>按平均成绩从低到高显示所有学生的“语文”、“数学”、“英语”三门的课程成绩，按如下形式显示： 学生ID,语文,数学,英语,有效课程数,有效平均分；</li><li>查询各科成绩最高和最低的分：以如下形式显示：课程ID，最高分，最低分；</li><li>按各科平均成绩从低到高和及格率的百分数从高到低顺序；</li><li>查询各科成绩前三名的记录:(不考虑成绩并列情况)</li><li>查询每门课程被选修的学生数；</li><li>查询同名同姓学生名单，并统计同名人数；</li><li>查询每门课程的平均成绩，结果按平均成绩升序排列，平均成绩相同时，按课程号降序排列；</li><li>查询平均成绩大于85的所有学生的学号. 姓名和平均成绩；</li><li>查询课程名称为“数学”，且分数低于60的学生姓名和分数；</li><li>查询课程编号为003且课程成绩在80分以上的学生的学号和姓名；</li><li>求选了课程的学生人数</li><li>查询选修“杨艳”老师所授课程的学生中，成绩最高的学生姓名及其成绩；</li><li>查询各个课程及相应的选修人数；</li><li>查询不同课程但成绩相同的学生的学号、课程号、学生成绩；</li><li>查询每门课程成绩最好的前两名；</li><li>检索至少选修两门课程的学生学号；</li><li>查询全部学生都选修的课程的课程号和课程名；</li><li>查询没学过“叶平”老师讲授的任一门课程的学生姓名；</li><li>查询两门以上不及格课程的同学的学号及其平均成绩；</li><li>检索“004”课程分数小于60，按分数降序排列的同学学号；</li><li>删除“002”同学的“001”课程的成绩；</li></ol> 
 <h2><strong>二、基础练习答案</strong></h2> 
 <pre><code>1、查询“生物”课程比“物理”课程成绩高的所有学生的学号；select * from(  (select * from score where course_id in (select cid from course where cname = '生物')) t1 left join  (select * from score where course_id in (select cid from course where cname = '物理')) t2 on t1.student_id = t2.student_id) where t1.num &gt; t2.num; 2、查询平均成绩大于60分的同学的学号和平均成绩;# 先查看每个同学的平均分数select student_id,avg(num) from score group by student_id;# 在筛选成绩大于60分的同学的学号和平均成绩；# select student_id,avg(num) from score group by student_id having avg(num) &gt; 60; 3、查询所有同学的学号、姓名、选课数、总成绩；# 先查看每个同学的总成绩select student_id,sum(num) from score group by student_id;# 学生和课程的关系只有成绩表中存在，因此要获取每个学生选择的课程，需要通过score表select count(sid),student_id from score group by student_id;# 将上面两步合并select sum(num),count(sid),student_id from score group by student_id;# 将学生的信息和成绩选课情况拼在一起select sid,sname,sum_num ,count_stu from student left join  (select sum(num) sum_num,count(sid) count_stu,student_id from score group by student_id) t2 on sid = student_id;# 还可以更严谨，那些没有选课的同学选课数和总成绩应该是0select sid,sname, ( CASE WHEN sum_num is null THEN 0  ELSE sum_num END ) as sum_num , ( CASE WHEN count_stu is null THEN 0  ELSE count_stu END ) as count_stu from student left join  (select sum(num) sum_num,count(sid) count_stu,student_id from score group by student_id) t2 on sid = student_id; 4、查询姓“李”的老师的个数；# 找到所有姓李的 # 方法一 # select * from teacher where tname like '李%'; # 方法二 # select * from teacher where tname regexp '^李';# 统计个数 select count(tid) from teacher where tname regexp '^李'; 或者 select count(id) from teacher where tname like '李%'; 5、查询没学过“张磊老师”课的同学的学号、姓名；# 找到张磊老师的id select tid from teacher where tname == '张磊老师';# 找到张磊老师所教课程select cid from course where teacher_id = (select tid from teacher where tname = '张磊老师');# 找到所有学习这门课的学生idselect student_id from score where course_id = (select cid from course where teacher_id = (select tid from teacher where tname = '张磊老师'));# 找到没有学过这门课的学生对应的学生学号、姓名select sid,sname from student where sid not in  (select student_id from score where course_id = (select cid from course where teacher_id = (select tid from teacher where tname = '张磊老师'))); 6、查询学过“1”并且也学过编号“2”课程的同学的学号、姓名；# 先查询学习课程id为1的所有学生select * from score where course_id = 1;# 先查询学习课程id为2的所有学生select * from score where course_id = 2;# 把这两张表按照学生的id 内连接起来 去掉只学习某一门课程的学生select t1.student_id from(select student_id from score where course_id = 1) t1inner join(select student_id from score where course_id = 2) t2on t1.student_id = t2.student_id# 根据学号在学生表中找到对应的姓名select sid,sname from student where sid in (select t1.student_id from (select student_id from score where course_id = 1) t1 inner join (select student_id from score where course_id = 2) t2 on t1.student_id = t2.student_id); 7、查询学过“李平老师”所教的所有课的同学的学号、姓名；#找到李平老师的tidselect tid from teacher where tname ='李平老师';# 找到李平老师教的所有课程cid select cid from course where teacher_id in (select tid from teacher where tname ='李平老师');# 找到李平老师教的所有课程数 select count(cid) from course where teacher_id in (select tid from teacher where tname ='李平老师');# 找到所有学习李平老师课程的学生select * from score where course_id in ( select cid from course where teacher_id in (select tid from teacher where tname ='李平老师'));# 查看所有学习李平老师课程的学生选课数select student_id,count(course_id) from score where course_id in ( select cid from course where teacher_id in (select tid from teacher where tname ='李平老师')) group by student_id;# 找到所有选择了李平老师所有课程的学生idselect student_id from (select student_id,count(course_id) course_count from score where course_id in ( select cid from course where teacher_id in (select tid from teacher where tname ='李平老师')) group by student_id) t1where t1.course_count =(select count(cid) from course where teacher_id in (select tid from teacher where tname ='李平老师'));# 找到学生的其他信息select sid,sname from student where sid in (select student_id from (select student_id,count(course_id) course_count from score where course_id in ( select cid from course where teacher_id in (select tid from teacher where tname ='李平老师')) group by student_id) t1where t1.course_count =(select count(cid) from course where teacher_id in (select tid from teacher where tname ='李平老师'))); 8、查询课程编号“2”的成绩比课程编号“1”课程低的所有同学的学号、姓名；# 先找到每个学生的课程编号“1”的和课程编号“2”的成绩组成一张表select t1.student_id from (select num num2,student_id from score where course_id = 2) t2 inner join (select student_id,num num1 from score where course_id = 1) t1 on t1.student_id = t2.student_id# 再找到课程编号“2”的成绩比课程编号“1”课程低的所有学生的学号select t1.student_id from (select num num2,student_id from score where course_id = 2) t2 inner join (select student_id,num num1 from score where course_id = 1) t1 on t1.student_id = t2.student_id where num2 &lt; num1# 再找到所有学生的学号、姓名select sid,sname from student where sid in(select t1.student_id from (select num num2,student_id from score where course_id = 2) t2 inner join (select student_id,num num1 from score where course_id = 1) t1 on t1.student_id = t2.student_id where num2 &lt; num1); 9、查询有课程成绩小于60分的同学的学号、姓名；# 先查询成绩小于60分的同学的学号select distinct student_id from score where num &lt; 60;# 再查询有课程成绩小于60分的同学的学号、姓名select sid,sname from student where sid in (select distinct student_id from score where num &lt; 60); 10、查询至少有一门课与学号为1的同学所学课程相同的同学的学号和姓名；# 先看看学号为1的同学都学了哪些课程select course_id from score where student_id = 1# 找到学习 学号为1的同学所学课程 的学号select distinct student_id from score where course_id in (select course_id from score where student_id = 1);# 找到学习 学号为1的同学所学课程 的学号姓名select sid,sname from student where sid in (select distinct student_id from score where course_id in (select course_id from score where student_id = 1)); 11、课程平均分从高到低显示select course_id,avg(num) avg_num from score group by course_id order by avg_num desc; 12、查询出只选修了一门课程的全部学生的学号和姓名；# 查询出只选修了一门课程的全部学生的学号select student_id,count(student_id) from score group by student_id having count(student_id) =1;# 查询出只选修了一门课程的全部学生的学号和姓名；select sid,sname from student where sid in (select student_id from score group by student_id having count(student_id) =1); 13、查询男生、女生的人数；select gender,count(sid) from student group by gender; 14、查询姓“张”的学生名单；select * from student where sname like '张%'; 15、查询各科成绩最高和最低的分：以如下形式显示：课程ID，最高分，最低分；# 查询成绩的最高分select course_id c1,max(num) from score group by course_id# 查询成绩的最低分select course_id c1,min(num) from score group by course_id# 查询成绩的最高分和最低分拼接select * from ( (select course_id c1,max(num) from score group by course_id) t1 inner join (select course_id c2,min(num) from score group by course_id) t2 on t1.c1 = t2.c2 );# 格式整理select t1.c1,t1.max_num,t2.min_num from ( (select course_id c1,max(num) max_num from score group by course_id) t1 inner join (select course_id c2,min(num) min_num from score group by course_id) t2 on t1.c1 = t2.c2 );</code></pre> 
 <h2><strong>三、进阶练习答案</strong></h2> 
 <pre><code>1、查询没有学全所有课的同学的学号、姓名；# 先统计一共有多少门课程select count(cid) from course;# 查看每个学生选择的课程书select count(course_id) from score group by student_id;# 查询所学课程数小于总课程数的学生学号select student_idfrom (select count(course_id) c_course_id,student_id from score group by student_id) t1 where t1.c_course_id &lt; (select count(cid) from course) ;# 查询没有学全所有课的同学的学号、姓名；select sid,sname from student where sid in ( select student_id from (select count(course_id) c_course_id,student_id from score group by student_id ) t1 where t1.c_course_id &lt; (select count(cid) from course)) ; 2、查询和“002”号的同学学习的课程完全相同的其他同学学号和姓名；# 先查询2号同学学了哪些课程select * from score where student_id =2;# 找到学习了2号同学没学习课程的所有同学(找到所有和2号同学学习的课程不一样的同学)select student_id from score where course_id not in (select course_id from score where student_id=2)# 找到score表中所有的学生并且把 2号同学 以及(和2号同学学习的课程不一样的同学)排除出去select student_id from score where student_id not in (select student_id from score where course_id not in (select course_id from score where student_id=2)) and student_id !=2# 对剩余的和2号同学所选课程没有不同的同学所选课程数进行统计，如果和2号同学的课程数相同，就是选择了相同的课程select student_id from score where student_id not in ( select student_id from score where course_id not in (select course_id from score where student_id=2) ) and student_id !=2group by student_id having count(course_id)= (select count(course_id) from score where student_id=2); 3、删除学习“叶平”老师课的SC(score)表记录；# 先查出李平老师的idselect tid from teacher where tname = '李平老师';# 查看李平老师所教授的课程select cid from course where teacher_id = (select tid from teacher where tname = '李平老师');# 查看李平老师所教课程的成绩数据select * from score where course_id in (select cid from course where teacher_id = (select tid from teacher where tname = '李平老师'));# 执行删除命令delete from score where course_id in (select cid from course where teacher_id = (select tid from teacher where tname = '李平老师'));4、向SC表中插入一些记录，这些记录要求符合以下条件：①没有上过编号“002”课程的同学学号；②插入“002”号课程的平均成绩； # 先找寻上过2号课程的同学select student_id from score where course_id = 2;# 再找到没上过2号课程的所有同学select * from student where sid not in (select student_id from score where course_id = 2);# 计算出学习2号课程的同学的平均成绩select avg(num) from score where course_id = 2 group by course_id;# 用笛卡尔积将上述两个表拼起来select * from (select sid from student where sid not in (select student_id from score where course_id = 2)) t1,(select avg(num) from score where course_id = 2 group by course_id) t2;# 向SC表中插入记录insert into score (course_id,student_id,num) select 2,t1.sid,t2.avg_num from (select sid from student where sid not in (select student_id from score where course_id = 2)) t1,(select avg(num) avg_num from score where course_id = 2 group by course_id) t2; 5、按平均成绩从低到高显示所有学生的“语文”、“数学”、“英语”三门的课程成绩，按如下形式显示： 学生ID,语文,数学,英语,有效课程数,有效平均分；# 查看每个学生的数学成绩select student_id,num from score where course_id = (select cid from course where cname = '数学');# 查看每个学生的语文成绩select student_id,num from score where course_id = (select cid from course where cname = '语文');# 查看每个学生的英语成绩select student_id,num from score where course_id = (select cid from course where cname = '英语');# 查看每个学生的平均成绩select student_id,avg(num),count(num) from score group by student_id;# 将上面的几张表拼接起来,为了生成所有学生的信息，用student表作为左连接的第一张表select sid 学生ID,t2.num 语文,t1.num 数学, t3.num 英语,t4.count_course 有效课程数,t4.avg_num 有效平均分 from student  left join (select student_id,num from score where course_id = (select cid from course where cname = '数学')) t1 on student.sid = t1.student_id left join (select student_id,num from score where course_id = (select cid from course where cname = '语文')) t2 on student.sid = t2.student_id left join (select student_id,num from score where course_id = (select cid from course where cname = '英语')) t3 on student.sid = t3.student_id left join (select student_id,avg(num) avg_num,count(num) count_course from score group by student_id) t4 on student.sid = t4.student_id 6、查询各科成绩最高和最低的分：以如下形式显示：课程ID，最高分，最低分；select course_id 课程ID,max(num) 最高分,min(num) 最低分 from score group by course_id; 7、按各科平均成绩从低到高和及格率的百分数从高到低顺序；# 方法1:# 先求平均成绩select course_id,avg(num) from score group by course_id;# 解决计算各科及格率的问题所有及格的人/所有人数select t1.course_id,t1.count1/t2.count2 from (select course_id,count(course_id) count1 from score where num&gt;60 group by course_id) t1 left join(select course_id,count(course_id) count2 from score group by course_id) t2on t1.course_id = t2.course_id;# 根据上述内容进行表的拼接select t_out1.course_id,t_out1.avgnum, t_out2.pass_per from (select course_id,avg(num) avgnum from score group by course_id ) t_out1left join (select t1.course_id,t1.count1/t2.count2 pass_per from (select course_id,count(course_id) count1 from score where num&gt;60 group by course_id) t1 left join(select course_id,count(course_id) count2 from score group by course_id) t2on t1.course_id = t2.course_id) t_out2on t_out1.course_id = t_out2.course_id# 加上排序select t_out1.course_id,t_out1.avgnum, t_out2.pass_per from (select course_id,avg(num) avgnum from score group by course_id ) t_out1 left join (select t1.course_id,t1.count1/t2.count2 pass_per from (select course_id,count(course_id) count1 from score where num&gt;60 group by course_id) t1 left join (select course_id,count(course_id) count2 from score group by course_id) t2 on t1.course_id = t2.course_id) t_out2 on t_out1.course_id = t_out2.course_id order by avgnum ,pass_per desc; # 方法2 # 使用case when直接计算合格率select sum(case when num&gt;60 then 1 else 0 end)/count(course_id)from score group by course_id# 加上课程id和平均值select course_id,avg(num),sum(case when num&gt;60 then 1 else 0 end)/count(course_id)from score group by course_id# 加上排序select course_id,avg(num) avgnum,sum(case when num&gt;60 then 1 else 0 end)/count(course_id) pass_per from score group by course_id order by avgnum ,pass_per desc;  8、查询各科成绩前三名的记录:(不考虑成绩并列情况) selectt1.sid,t1.student_id,t1.course_id,t1.num from score t1left join ( select sid,course_id, (select num from score as s2 where s2.course_id = s1.course_id order by num desc limit 0, 1) as first_num, (select num from score as s2 where s2.course_id = s1.course_id order by num desc limit 1, 1) as second_num, (select num from score as s2 where s2.course_id = s1.course_id order by num desc limit 2, 1) as third_num from score as s1 ) t2on t1.sid = t2.sidwhere t1.num = t2.first_num or t1.num = t2.second_num or t1.num = t2.third_num; 9、查询每门课程被选修的学生数；select course_id,count(course_id) from score group by course_id; 10、查询同名同姓学生名单，并统计同名人数；select sname,count(1) as count from student group by sname; 11、查询每门课程的平均成绩，结果按平均成绩升序排列，平均成绩相同时，按课程号降序排列；select course_id,avg(if(isnull(num), 0 ,num)) as avg from score group by course_id order by avg asc,course_id desc; 12、查询平均成绩大于85的所有学生的学号、姓名和平均成绩；select student_id,sname, avg(if(isnull(num), 0 ,num)) from score left join student on score.student_id = student.sid group by student_id; 13、查询课程名称为“数学”，且分数低于60的学生姓名和分数；select student.sname,score.num from scoreleft join course on score.course_id = course.cidleft join student on score.student_id = student.sidwhere score.num &lt; 60 and course.cname = '数学'  14、查询课程编号为003且课程成绩在80分以上的学生的学号和姓名； select * from score where score.student_id = 3 and score.num &gt; 80 15、求选了课程的学生人数select sid,sname from student where sid not in (select student_id from score group by student_id); 16、查询选修“杨艳”老师所授课程的学生中，成绩最高的学生姓名及其成绩；# 先找到“杨艳”老师的教师idselect tid from teacher where tname = '杨艳';# 再找到杨艳老师教的所有课程select cid from course where teacher_id in (select tid from teacher where tname = '杨艳');# 再找到杨艳老师教的所有课程的最高分select max(num) from score where course_id in (select cid from course where teacher_id in (select tid from teacher where tname = '李平老师'));# 再找到杨艳老师教的所有课程的最高分对应的学生select distinct student_id,num from score where num = (select max(num) from score where course_id in (select cid from course where teacher_id in (select tid from teacher where tname = '李平老师'))) and course_id in (select cid from course where teacher_id in (select tid from teacher where tname = '李平老师'));# 找到学生的姓名select student.sname,t1.num from(select distinct student_id,num from score where num = (select max(num) from score where course_id in (select cid from course where teacher_id in (select tid from teacher where tname = '李平老师'))) and course_id in (select cid from course where teacher_id in (select tid from teacher where tname = '李平老师'))) t1left joinstudenton t1.student_id = student.sid; 17、查询各个课程及相应的选修人数；select course.cname,count(1) from scoreleft join course on score.course_id = course.cidgroup by course_id; 18、查询不同课程但成绩相同的学生的学号、课程号、学生成绩；select DISTINCT s1.course_id,s2.course_id,s1.num,s2.num from score as s1, score as s2 where s1.num = s2.num and s1.course_id != s2.course_id; 19、查询每门课程成绩最好的前两名； 先查询每条数据对应学科成绩的第一名和第二名，这里必须要保留所有的s1，以便后续进行连表查询select sid,course_id, (select num from score as s2 where s2.course_id = s1.course_id order by num desc limit 0, 1) as first_num, (select num from score as s2 where s2.course_id = s1.course_id order by num desc limit 1, 1) as second_numfrom score as s1按照sid连表，把学生的成绩和对应的第一名、第二名成绩连起来select* from score t1left join ( select sid,course_id, (select num from score as s2 where s2.course_id = s1.course_id order by num desc limit 0, 1) as first_num, (select num from score as s2 where s2.course_id = s1.course_id order by num desc limit 1, 1) as second_num from score as s1 ) t2on t1.sid = t2.sid判断如果学生的成绩是第一名、第二名的成绩，那么就符合条件，显示学生的id、学科和成绩selectt1.sid,t1.student_id,t1.course_id,t1.num from score t1left join ( select sid,course_id, (select num from score as s2 where s2.course_id = s1.course_id order by num desc limit 0, 1) as first_num, (select num from score as s2 where s2.course_id = s1.course_id order by num desc limit 1, 1) as second_num from score as s1 ) t2on t1.sid = t2.sidwhere t1.num = t2.first_num or t1.num = t2.second_num;20、检索至少选修两门课程的学生学号；select student_id from score group by student_id having count(student_id) &gt; 1; 21、查询全部学生都选修的课程的课程号和课程名；# 先查看一共有多少学生select count(sid) from student;# 查看哪一门课选秀的学生个数和学生的总个数相等select course_id from score group by course_id having count(student_id) = (select count(sid) from student);22、查询没学过“叶平”老师讲授的任一门课程的学生姓名；# 先查看要查找老师的idselect tid from teacher where tname = '李平老师';# 查看该老师交了哪些课程select cid from course where teacher_id in (select tid from teacher where tname = '李平老师')# 看看有多少学生学习了该老师的课程select distinct student_id from score where course_id in (select cid from course where teacher_id in (select tid from teacher where tname = '李平老师'));# 把不在上表中的学生姓名查出来select sname from student where sid not in (select distinct student_id from score where course_id in (select cid from course where teacher_id in (select tid from teacher where tname = '李平老师')));23、查询两门以上不及格课程的同学的学号及其平均成绩；select student_id,avg(num) from score where num&lt;60 group by student_id having count(num)&gt;=2; 24、检索“004”课程分数小于60，按分数降序排列的同学学号；select student_id from score where num&lt; 60 and course_id = 4 order by num desc;25、删除“002”同学的“001”课程的成绩；delete from score where course_id = 1 and student_id = 2；</code></pre> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e2d9b7b35907c63f37e4c97fa129ef0b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python升序和降序排序_python中sort和sorted排序的实例方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2eb5701e43232db9df8065cae3b9a3ea/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">第七章 用函数实现模块化程序设计</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>