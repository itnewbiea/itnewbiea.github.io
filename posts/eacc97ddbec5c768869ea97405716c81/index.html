<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PHP7使用C&#43;&#43;扩展开发 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PHP7使用C&#43;&#43;扩展开发" />
<meta property="og:description" content="Windows
使用【php-sdk-binary-tools】工具在windows下编译dll扩展。
php-sdk-binary-tools：GitHub - microsoft/php-sdk-binary-tools: Tool kit for building PHP under Windows
编译过程：php mb扩展 windows7,php7.4自定义扩展的编写Windows篇-CSDN博客 注意事项：
config.w32配置【多个cpp的情况下编译】：
ARG_ENABLE(&#39;hello&#39;, &#39;hello support&#39;, &#39;yes&#39;); if (PHP_HELLO != &#39;no&#39;) { AC_DEFINE(&#39;HAVE_HELLO&#39;, 1, &#39;hello support enabled&#39;); } EXTENSION(&#39;hello&#39;, &#39;hello.cpp&#39;, null, &#39;/DZEND_ENABLE_STATIC_TSRMLS_CACHE=1&#39;); ADD_SOURCES(configure_module_dirname, &#34;AES.CPP base64.cpp&#34;, &#34;hello&#34;); PHP_INSTALL_HEADERS(&#34;ext/hello/&#34;, &#34;AES.h base64.h&#34;); 如果涉及lib库则在该路径放入头文件和库，测试发现静态的lib库不行诶。
C:\Users\dell\Desktop\php\phpdev\vc15\x64\deps 然后找到Makefile，一般在php源码目录下，文件中的LIBS添加你的lib文件名然后即可编译。
Liunx
config.m4配置【多个cpp的情况下编译】：
dnl In case of no dependencies PHP_REQUIRE_CXX() PHP_SUBST(HELLO_SHARED_LIBADD) PHP_ADD_LIBRARY(stdc&#43;&#43;, 1, HELLO_SHARED_LIBADD) AC_DEFINE(HAVE_HELLO, 1, [ Have hello support ]) PHP_NEW_EXTENSION(hello, hello.cpp AES.cpp base64." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/eacc97ddbec5c768869ea97405716c81/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-13T11:02:18+08:00" />
<meta property="article:modified_time" content="2023-11-13T11:02:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PHP7使用C&#43;&#43;扩展开发</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>Windows</strong></p> 
<p><strong>使用【</strong><strong>php-sdk-binary-tools</strong><strong>】工具在windows下编译dll扩展。</strong></p> 
<p><strong>php-sdk-binary-tools：</strong><a href="https://github.com/microsoft/php-sdk-binary-tools" title="GitHub - microsoft/php-sdk-binary-tools: Tool kit for building PHP under Windows">GitHub - microsoft/php-sdk-binary-tools: Tool kit for building PHP under Windows</a></p> 
<p>编译过程：<a href="https://blog.csdn.net/weixin_29959121/article/details/116005659" title="php mb扩展 windows7,php7.4自定义扩展的编写Windows篇-CSDN博客">php mb扩展 windows7,php7.4自定义扩展的编写Windows篇-CSDN博客</a> </p> 
<p> 注意事项：</p> 
<p>config.w32配置【多个cpp的情况下编译】：</p> 
<pre><code class="hljs">ARG_ENABLE('hello', 'hello support', 'yes');

if (PHP_HELLO != 'no') {
	AC_DEFINE('HAVE_HELLO', 1, 'hello support enabled');

}
EXTENSION('hello', 'hello.cpp', null, '/DZEND_ENABLE_STATIC_TSRMLS_CACHE=1');
ADD_SOURCES(configure_module_dirname, "AES.CPP base64.cpp", "hello");
PHP_INSTALL_HEADERS("ext/hello/", "AES.h base64.h");</code></pre> 
<p> 如果涉及lib库则在该路径放入头文件和库，测试发现静态的lib库不行诶。</p> 
<pre><code class="hljs">C:\Users\dell\Desktop\php\phpdev\vc15\x64\deps</code></pre> 
<p> 然后找到Makefile，一般在php源码目录下，文件中的LIBS添加你的lib文件名然后即可编译。</p> 
<p><strong>Liunx</strong></p> 
<p>config.m4配置【多个cpp的情况下编译】：</p> 
<pre><code class="hljs">  dnl In case of no dependencies
  PHP_REQUIRE_CXX()
  PHP_SUBST(HELLO_SHARED_LIBADD)
  PHP_ADD_LIBRARY(stdc++, 1, HELLO_SHARED_LIBADD)
  AC_DEFINE(HAVE_HELLO, 1, [ Have hello support ])
  PHP_NEW_EXTENSION(hello, hello.cpp AES.cpp base64.cpp, $ext_shared)
  PHP_INSTALL_HEADERS([ext/hello], [AES.h base64.h])</code></pre> 
<p> 如果涉及lib库，可以看我另一篇文章：</p> 
<p><a href="https://blog.csdn.net/weixin_47723549/article/details/126578667" title="【精选】Rust开发PHP扩展Liunx版【必须收藏】-CSDN博客">【精选】Rust开发PHP扩展Liunx版【必须收藏】-CSDN博客</a></p> 
<p> 编译可能会有报错，涉及C++11标准问题，修改如下：</p> 
<p>找到Makefile，一般在php源码的扩展源码目录下：</p> 
<p>找到CXX变量，后面加-std=c++11，如：</p> 
<pre><code class="hljs">CXX = g++ -std=c++11</code></pre> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7b00164a515accf92924143848604ab2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JDK1.8 新特性（一）【默认方法、静态方法和Lambda表达式】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7ba1a00d5ea382d35ceb2abbccb1af55/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【KVM-1】软件虚拟化和硬件虚拟化类型</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>