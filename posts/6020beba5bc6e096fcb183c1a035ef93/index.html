<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>内存管理实验：常用页面置换算法模拟实验 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="内存管理实验：常用页面置换算法模拟实验" />
<meta property="og:description" content="实验目的 通过模拟实现请求页式存储管理的几种基本页面置换算法，了解虚拟存储技术的特点，掌握虚拟存储请求页式存储管理中几种基本页面置换算法的基本思想和实现过程，并比较它们的效率。
实验内容 设计一个虚拟存储区和内存工作区，并使用下述算法计算访问命中率。
1、最佳淘汰算法（OPT）
2、先进先出的算法（FIFO）
3、最近最久未使用算法（LRU）
4、最不经常使用算法（LFU）
5、最近未使用算法（NUR）
命中率＝１－页面失效次数／页地址流长度
实验准备 本实验的程序设计基本上按照实验内容进行。即首先用srand( )和rand( )函数定义和产生指令序列，然后将指令序列变换成相应的页地址流，并针对不同的算法计算出相应的命中率。
（1）通过随机数产生一个指令序列，共320条指令。指令的地址按下述原则生成：
A：50%的指令是顺序执行的
B：25%的指令是均匀分布在前地址部分
C：25%的指令是均匀分布在后地址部分
具体的实施方法是：
A：在[0，319]的指令地址之间随机选取一起点m
B：顺序执行一条指令，即执行地址为m&#43;1的指令
C：在前地址[0,m&#43;1]中随机选取一条指令并执行，该指令的地址为m’
D：顺序执行一条指令，其地址为m’&#43;1
E：在后地址[m’&#43;2，319]中随机选取一条指令并执行
F：重复步骤A-E，直到320次指令
（2）将指令序列变换为页地址流
设：页面大小为1K；
用户内存容量4页到32页；
用户虚存容量为32K。
在用户虚存中，按每K存放10条指令排列虚存地址，即320条指令在虚存中的存放方式为：
第 0 条-第 9 条指令为第0页（对应虚存地址为[0，9]）
第10条-第19条指令为第1页（对应虚存地址为[10，19]）
………………………………
第310条-第319条指令为第31页（对应虚存地址为[310，319]）
按以上方式，用户指令可组成32页。
实验指导 一、虚拟存储系统
UNIX中，为了提高内存利用率，提供了内外存进程对换机制；内存空间的分配和回收均以页为单位进行；一个进程只需将其一部分（段或页）调入内存便可运行；还支持请求调页的存储管理方式。
当进程在运行中需要访问某部分程序和数据时，发现其所在页面不在内存，就立即提出请求（向CPU发出缺中断），由系统将其所需页面调入内存。这种页面调入方式叫请求调页。
为实现请求调页，核心配置了四种数据结构：页表、页框号、访问位、修改位、有效位、保护位等。
二、页面置换算法
当CPU接收到缺页中断信号，中断处理程序先保存现场，分析中断原因，转入缺页中断处理程序。该程序通过查找页表，得到该页所在外存的物理块号。如果此时内存未满，能容纳新页，则启动磁盘I/O将所缺之页调入内存，然后修改页表。如果内存已满，则须按某种置换算法从内存中选出一页准备换出，是否重新写盘由页表的修改位决定，然后将缺页调入，修改页表。利用修改后的页表，去形成所要访问数据的物理地址，再去访问内存数据。整个页面的调入过程对用户是透明的。
常用的页面置换算法有
1、最佳置换算法（Optimal）
2、先进先出法（Fisrt In First Out）
3、最近最久未使用（Least Recently Used）
4、最不经常使用法（Least Frequently Used）
5、最近未使用法（No Used Recently）
代码 #include &lt;iostream&gt; #include &lt;ctime&gt; #include &lt;random&gt; using namespace std; #define TRUE 1 #define FALSE 0 #define INVALID -1 #define NULL 0 #define total_instruction 320 //指令数量 #define total_vp 32 //页表数量 #define clear_period 50 //清0周期 struct pl_type { /*页表结构*/ int pn, pfn, counter, time; }; pl_type pl[total_vp]; //页表数组 struct pfc_type { /*内存表结构*/ int pn, pfn; pfc_type *next; }; pfc_type pfc[total_vp], *freepf_head, *busypf_head, *busypf_tail; int diseffect; // 未命中次数 int a[total_instruction]; // 存储320条指令 int page[total_instruction]; // 每条指令对应的页表号 int offset[total_instruction]; int initialize(int); int FIFO(int); int LRU(int); int NUR(int); int LFU(int); int OPT(int); int main(){ int s; srand(unsigned(time(0))); for (int i = 0; i &lt; total_instruction; i &#43;= 4) { /*产生指令队列*/ s = rand() % 320; a[i] = s &#43; 1; //顺序执行一条指令 a[i &#43; 1] = rand() % (a[i] &#43; 1);	//执行前地址指令m&#39; a[i &#43; 2] = a[i &#43; 1] &#43; 1; //顺序执行一条指令 a[i &#43; 3] = rand() % (319 - a[i &#43; 2]) &#43; (a[i &#43; 2] &#43; 1); // 执行后地址指令 if (a[i] &gt; 319 || a[i &#43; 1] &gt; 319 || a[i &#43; 2] &gt; 319 || a[i&#43;3] &gt; 319) { i -= 4; } } for (int i = 0; i &lt; total_instruction; i&#43;&#43;) { /*将指令序列变换成页表地址流*/ page[i] = a[i] / 10; offset[i] = a[i] % 10; } for (int i = 4; i &lt;= 32; i&#43;&#43;) { /*用户内存工作区从4个页面到32个页面*/ printf(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/6020beba5bc6e096fcb183c1a035ef93/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-11-24T16:26:44+08:00" />
<meta property="article:modified_time" content="2019-11-24T16:26:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">内存管理实验：常用页面置换算法模拟实验</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="_1"></a>实验目的</h4> 
<p>通过模拟实现请求页式存储管理的几种基本页面置换算法，了解虚拟存储技术的特点，掌握虚拟存储请求页式存储管理中几种基本页面置换算法的基本思想和实现过程，并比较它们的效率。</p> 
<h4><a id="_5"></a>实验内容</h4> 
<p>设计一个虚拟存储区和内存工作区，并使用下述算法计算访问命中率。</p> 
<p>1、最佳淘汰算法（OPT）</p> 
<p>2、先进先出的算法（FIFO）</p> 
<p>3、最近最久未使用算法（LRU）</p> 
<p>4、最不经常使用算法（LFU）</p> 
<p>5、最近未使用算法（NUR）</p> 
<p>命中率＝１－页面失效次数／页地址流长度</p> 
<h4><a id="_21"></a>实验准备</h4> 
<p>本实验的程序设计基本上按照实验内容进行。即首先用srand( )和rand( )函数定义和产生指令序列，然后将指令序列变换成相应的页地址流，并针对不同的算法计算出相应的命中率。</p> 
<p>（1）通过随机数产生一个指令序列，共320条指令。指令的地址按下述原则生成：</p> 
<p>A：50%的指令是顺序执行的</p> 
<p>B：25%的指令是均匀分布在前地址部分</p> 
<p>C：25%的指令是均匀分布在后地址部分</p> 
<p>具体的实施方法是：</p> 
<p>A：在[0，319]的指令地址之间随机选取一起点m</p> 
<p>B：顺序执行一条指令，即执行地址为m+1的指令</p> 
<p>C：在前地址[0,m+1]中随机选取一条指令并执行，该指令的地址为m’</p> 
<p>D：顺序执行一条指令，其地址为m’+1</p> 
<p>E：在后地址[m’+2，319]中随机选取一条指令并执行</p> 
<p>F：重复步骤A-E，直到320次指令</p> 
<p>（2）将指令序列变换为页地址流</p> 
<p>设：页面大小为1K；</p> 
<p>用户内存容量4页到32页；</p> 
<p>用户虚存容量为32K。</p> 
<p>在用户虚存中，按每K存放10条指令排列虚存地址，即320条指令在虚存中的存放方式为：</p> 
<p>第 0 条-第 9 条指令为第0页（对应虚存地址为[0，9]）</p> 
<p>第10条-第19条指令为第1页（对应虚存地址为[10，19]）</p> 
<p>………………………………</p> 
<p>第310条-第319条指令为第31页（对应虚存地址为[310，319]）</p> 
<p>按以上方式，用户指令可组成32页。</p> 
<h4><a id="_67"></a>实验指导</h4> 
<p>一、虚拟存储系统</p> 
<p>UNIX中，为了提高内存利用率，提供了内外存进程对换机制；内存空间的分配和回收均以页为单位进行；一个进程只需将其一部分（段或页）调入内存便可运行；还支持请求调页的存储管理方式。</p> 
<p>当进程在运行中需要访问某部分程序和数据时，发现其所在页面不在内存，就立即提出请求（向CPU发出缺中断），由系统将其所需页面调入内存。这种页面调入方式叫请求调页。</p> 
<p>为实现请求调页，核心配置了四种数据结构：页表、页框号、访问位、修改位、有效位、保护位等。</p> 
<p>二、页面置换算法</p> 
<p>当CPU接收到缺页中断信号，中断处理程序先保存现场，分析中断原因，转入缺页中断处理程序。该程序通过查找页表，得到该页所在外存的物理块号。如果此时内存未满，能容纳新页，则启动磁盘I/O将所缺之页调入内存，然后修改页表。如果内存已满，则须按某种置换算法从内存中选出一页准备换出，是否重新写盘由页表的修改位决定，然后将缺页调入，修改页表。利用修改后的页表，去形成所要访问数据的物理地址，再去访问内存数据。整个页面的调入过程对用户是透明的。</p> 
<p>常用的页面置换算法有</p> 
<p>1、最佳置换算法（Optimal）</p> 
<p>2、先进先出法（Fisrt In First Out）</p> 
<p>3、最近最久未使用（Least Recently Used）</p> 
<p>4、最不经常使用法（Least Frequently Used）</p> 
<p>5、最近未使用法（No Used Recently）</p> 
<h4><a id="_93"></a>代码</h4> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;ctime&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;random&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">define</span> TRUE 1</span>
<span class="token macro property">#<span class="token directive keyword">define</span> FALSE 0</span>
<span class="token macro property">#<span class="token directive keyword">define</span> INVALID -1</span>
<span class="token macro property">#<span class="token directive keyword">define</span> NULL  0</span>

<span class="token macro property">#<span class="token directive keyword">define</span>  total_instruction  320     </span><span class="token comment">//指令数量</span>
<span class="token macro property">#<span class="token directive keyword">define</span>  total_vp  32               </span><span class="token comment">//页表数量</span>
<span class="token macro property">#<span class="token directive keyword">define</span>  clear_period  50           </span><span class="token comment">//清0周期</span>

<span class="token keyword">struct</span> pl_type <span class="token punctuation">{<!-- --></span>               <span class="token comment">/*页表结构*/</span>
	<span class="token keyword">int</span> pn<span class="token punctuation">,</span> pfn<span class="token punctuation">,</span> counter<span class="token punctuation">,</span> time<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
pl_type pl<span class="token punctuation">[</span>total_vp<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//页表数组</span>

<span class="token keyword">struct</span> pfc_type <span class="token punctuation">{<!-- --></span>              <span class="token comment">/*内存表结构*/</span>
	<span class="token keyword">int</span> pn<span class="token punctuation">,</span> pfn<span class="token punctuation">;</span>
	pfc_type <span class="token operator">*</span>next<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
pfc_type pfc<span class="token punctuation">[</span>total_vp<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">*</span>freepf_head<span class="token punctuation">,</span> <span class="token operator">*</span>busypf_head<span class="token punctuation">,</span> <span class="token operator">*</span>busypf_tail<span class="token punctuation">;</span>

<span class="token keyword">int</span> diseffect<span class="token punctuation">;</span>  <span class="token comment">// 未命中次数</span>
<span class="token keyword">int</span> a<span class="token punctuation">[</span>total_instruction<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 存储320条指令</span>
<span class="token keyword">int</span> page<span class="token punctuation">[</span>total_instruction<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 每条指令对应的页表号</span>
<span class="token keyword">int</span> offset<span class="token punctuation">[</span>total_instruction<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">FIFO</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">LRU</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">NUR</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">LFU</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">OPT</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> s<span class="token punctuation">;</span>
	<span class="token function">srand</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> total_instruction<span class="token punctuation">;</span> i <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">/*产生指令队列*/</span>
		s <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">320</span><span class="token punctuation">;</span>
		a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token comment">//顺序执行一条指令</span>
		a<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	 <span class="token comment">//执行前地址指令m'</span>
		a<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>         <span class="token comment">//顺序执行一条指令</span>
		a<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">319</span> <span class="token operator">-</span> a<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 执行后地址指令</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">319</span> <span class="token operator">||</span> a<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">319</span> <span class="token operator">||</span> a<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">319</span> <span class="token operator">||</span> a<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">319</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			i <span class="token operator">-</span><span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> total_instruction<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">/*将指令序列变换成页表地址流*/</span>
		page<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span>
		offset<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">32</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">/*用户内存工作区从4个页面到32个页面*/</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"---%2d page frames---\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">FIFO</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">LRU</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">NUR</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">LFU</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">OPT</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token keyword">int</span> total_pf<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>              <span class="token comment">/*初始化相关数据结构*/</span>
	diseffect <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">// 初始化页表</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>total_vp<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		pl<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pn <span class="token operator">=</span> i<span class="token punctuation">;</span>
		pl<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">=</span> INVALID<span class="token punctuation">;</span>  <span class="token comment">// 初始，该页不在内存中</span>
		pl<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">// 访问次数或作为引用位</span>
		pl<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>time <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// 时间</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 初始内存表,建立pfc[i-1]和pfc[i]之间的链接</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> total_pf <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		pfc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token operator">&amp;</span>pfc<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		pfc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">=</span> i<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	pfc<span class="token punctuation">[</span>total_pf <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	pfc<span class="token punctuation">[</span>total_pf <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">=</span> total_pf <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
	freepf_head <span class="token operator">=</span> <span class="token operator">&amp;</span>pfc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//内存空页面队列的头指针为pfc[0]</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">FIFO</span><span class="token punctuation">(</span><span class="token keyword">int</span> total_pf<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>             <span class="token comment">/*先进先出算法*/</span>
	pfc_type <span class="token operator">*</span>p<span class="token punctuation">;</span>
	<span class="token function">initialize</span><span class="token punctuation">(</span>total_pf<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//初始化相关页面控制用数据结构</span>
	busypf_head <span class="token operator">=</span> busypf_tail <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  <span class="token comment">//内存页的队列头，队列尾指针接</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>total_instruction<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">==</span> INVALID<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">//页表项不在内存中</span>
			diseffect <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                  <span class="token comment">//失效次数</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>freepf_head <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>        <span class="token comment">//内存无空闲页面</span>
				p <span class="token operator">=</span> busypf_head<span class="token operator">-</span><span class="token operator">&gt;</span>next<span class="token punctuation">;</span>
				pl<span class="token punctuation">[</span>busypf_head<span class="token operator">-</span><span class="token operator">&gt;</span>pn<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">=</span> INVALID<span class="token punctuation">;</span>
				freepf_head <span class="token operator">=</span> busypf_head<span class="token punctuation">;</span>  <span class="token comment">//释放忙页面队列的第一个页面</span>
				freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
				busypf_head <span class="token operator">=</span> p<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">// 按FIFO方式调新页面入内存页面</span>
			p <span class="token operator">=</span> freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>next<span class="token punctuation">;</span>  <span class="token comment">// 先保存内存表中当前位置的下一位置</span>
			freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
			freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>pn <span class="token operator">=</span> page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 页表号</span>
			pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">=</span> freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>pfn<span class="token punctuation">;</span>  <span class="token comment">// 内存块号</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>busypf_tail <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				<span class="token comment">// busypf_head指向最老的，busypf_tail指向最新的</span>
				busypf_head <span class="token operator">=</span> busypf_tail <span class="token operator">=</span> freepf_head<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
				busypf_tail<span class="token operator">-</span><span class="token operator">&gt;</span>next <span class="token operator">=</span> freepf_head<span class="token punctuation">;</span>  <span class="token comment">//free页面减少一个</span>
				busypf_tail <span class="token operator">=</span> freepf_head<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			freepf_head <span class="token operator">=</span> p<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"FIFO:%6.4f\n"</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">-</span> diseffect <span class="token operator">/</span> <span class="token number">320.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">LRU</span><span class="token punctuation">(</span><span class="token keyword">int</span> total_pf<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>      <span class="token comment">/*最近最久未使用算法（使用时钟计数器）*/</span>
	<span class="token keyword">int</span> min<span class="token punctuation">,</span> minj<span class="token punctuation">,</span> present_time<span class="token punctuation">;</span>
	<span class="token function">initialize</span><span class="token punctuation">(</span>total_pf<span class="token punctuation">)</span><span class="token punctuation">;</span>
	present_time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>total_instruction<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">==</span> INVALID<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>            <span class="token comment">//页面失效，不在内存中</span>
			diseffect<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>freepf_head <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>             <span class="token comment">//内存无空闲页面</span>
				min <span class="token operator">=</span> <span class="token number">32767</span><span class="token punctuation">;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> total_vp<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">//找出内存块中time的最小值</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>min <span class="token operator">&gt;</span> pl<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>time <span class="token operator">&amp;&amp;</span> pl<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">!=</span> INVALID<span class="token punctuation">)</span>  <span class="token comment">// 查询页表</span>
					<span class="token punctuation">{<!-- --></span>
						min <span class="token operator">=</span> pl<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>time<span class="token punctuation">;</span>
						minj <span class="token operator">=</span> j<span class="token punctuation">;</span>  <span class="token comment">// 记下内存块号</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
				freepf_head <span class="token operator">=</span> <span class="token operator">&amp;</span>pfc<span class="token punctuation">[</span>pl<span class="token punctuation">[</span>minj<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn<span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">//腾出一个单元（对应的内存块）</span>
				pl<span class="token punctuation">[</span>minj<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">=</span> INVALID<span class="token punctuation">;</span>
				pl<span class="token punctuation">[</span>minj<span class="token punctuation">]</span><span class="token punctuation">.</span>time <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
				freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">=</span> freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>pfn<span class="token punctuation">;</span>   <span class="token comment">//有空闲页面,改为有效（内存块号）</span>
			pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>time <span class="token operator">=</span> present_time<span class="token punctuation">;</span>
			freepf_head <span class="token operator">=</span> freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>next<span class="token punctuation">;</span>      <span class="token comment">//减少一个free 页面</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
			pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>time <span class="token operator">=</span> present_time<span class="token punctuation">;</span>        <span class="token comment">//命中则设置时间</span>
		<span class="token punctuation">}</span>
		present_time<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"LRU:%6.4f\n"</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">-</span> diseffect <span class="token operator">/</span> <span class="token number">320.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">NUR</span><span class="token punctuation">(</span><span class="token keyword">int</span> total_pf<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>          <span class="token comment">/*最近未使用算法（每执行50条指令引用位清零一次）*/</span>
	<span class="token keyword">int</span> dp<span class="token punctuation">,</span> cont_flag<span class="token punctuation">,</span> old_dp<span class="token punctuation">;</span>
	<span class="token function">initialize</span><span class="token punctuation">(</span>total_pf<span class="token punctuation">)</span><span class="token punctuation">;</span>
	dp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> total_instruction<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">==</span> INVALID<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>        <span class="token comment">//页面失效，不在内存中</span>
			diseffect<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>freepf_head <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>              <span class="token comment">//无空闲页面</span>
				cont_flag <span class="token operator">=</span> TRUE<span class="token punctuation">;</span>
				old_dp <span class="token operator">=</span> dp<span class="token punctuation">;</span>
				<span class="token keyword">while</span> <span class="token punctuation">(</span>cont_flag<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					<span class="token comment">// 查页表（对应引用位0，在内存中）</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>pl<span class="token punctuation">[</span>dp<span class="token punctuation">]</span><span class="token punctuation">.</span>counter <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> pl<span class="token punctuation">[</span>dp<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">!=</span> INVALID<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
						cont_flag <span class="token operator">=</span> FALSE<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
						dp<span class="token operator">++</span><span class="token punctuation">;</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span>dp <span class="token operator">==</span> total_vp<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
							dp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span>dp <span class="token operator">==</span> old_dp<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
							<span class="token comment">// 第2轮扫描结束，失败（引用位全部置为0）</span>
							<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> total_vp<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
								pl<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
							<span class="token punctuation">}</span>
						<span class="token punctuation">}</span>	
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
				freepf_head <span class="token operator">=</span> <span class="token operator">&amp;</span>pfc<span class="token punctuation">[</span>pl<span class="token punctuation">[</span>dp<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//腾出一个单元（对应的内存块）</span>
				pl<span class="token punctuation">[</span>dp<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">=</span> INVALID<span class="token punctuation">;</span>
				freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">=</span> freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>pfn<span class="token punctuation">;</span>
			freepf_head <span class="token operator">=</span> freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>next<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
			pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>counter <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// 在内存中，“引用位”置为1</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 每执行50条指令，引用位清零一次</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">%</span>clear_period <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> total_vp<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				pl<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"NUR:%6.4f\n"</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">-</span> diseffect <span class="token operator">/</span> <span class="token number">320.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">OPT</span><span class="token punctuation">(</span><span class="token keyword">int</span> total_pf<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>      <span class="token comment">/*最佳置换算法*/</span>
	<span class="token keyword">int</span> max<span class="token punctuation">,</span> maxpage<span class="token punctuation">,</span> d<span class="token punctuation">,</span> dist<span class="token punctuation">[</span>total_vp<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">initialize</span><span class="token punctuation">(</span>total_pf<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> total_instruction<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">==</span> INVALID<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>      <span class="token comment">//页面失效，不在内存中</span>
			diseffect<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>freepf_head <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>        <span class="token comment">//无空闲页面</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> total_vp<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>pl<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">!=</span> INVALID<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
						dist<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">32767</span><span class="token punctuation">;</span>  <span class="token comment">/* 最大"距离" */</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
						dist<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
				d <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> total_instruction<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">!=</span> INVALID <span class="token operator">&amp;&amp;</span> dist<span class="token punctuation">[</span>page<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">32767</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
						dist<span class="token punctuation">[</span>page<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					d<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				max <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> total_vp<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>max <span class="token operator">&lt;</span> dist<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
						max <span class="token operator">=</span> dist<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
						maxpage <span class="token operator">=</span> j<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
				freepf_head <span class="token operator">=</span> <span class="token operator">&amp;</span>pfc<span class="token punctuation">[</span>pl<span class="token punctuation">[</span>maxpage<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn<span class="token punctuation">]</span><span class="token punctuation">;</span>
				freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
				pl<span class="token punctuation">[</span>maxpage<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">=</span> INVALID<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">=</span> freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>pfn<span class="token punctuation">;</span>
			freepf_head <span class="token operator">=</span> freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>next<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"OPT:%6.4f\n"</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">-</span> diseffect <span class="token operator">/</span> <span class="token number">320.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">LFU</span><span class="token punctuation">(</span><span class="token keyword">int</span> total_pf<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>        <span class="token comment">/*最不经常使用置换法*/</span>
	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> min<span class="token punctuation">,</span> minpage<span class="token punctuation">;</span>
	<span class="token function">initialize</span><span class="token punctuation">(</span>total_pf<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> total_instruction<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">==</span> INVALID<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>     <span class="token comment">//页面失效，不在内存中</span>
			diseffect<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>freepf_head <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>         <span class="token comment">//无空闲页面</span>
				min <span class="token operator">=</span> <span class="token number">32767</span><span class="token punctuation">;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> total_vp<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>min <span class="token operator">&gt;</span> pl<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>counter <span class="token operator">&amp;&amp;</span> pl<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">!=</span> INVALID<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
						min <span class="token operator">=</span> pl<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>counter<span class="token punctuation">;</span>
						minpage <span class="token operator">=</span> j<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token comment">//pl[j].counter = 0;</span>
					<span class="token comment">//pl[j].counter &gt;&gt;= 1;</span>
				<span class="token punctuation">}</span>
				freepf_head <span class="token operator">=</span> <span class="token operator">&amp;</span>pfc<span class="token punctuation">[</span>pl<span class="token punctuation">[</span>minpage<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn<span class="token punctuation">]</span><span class="token punctuation">;</span>
				pl<span class="token punctuation">[</span>minpage<span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">=</span> INVALID<span class="token punctuation">;</span>
				freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pfn <span class="token operator">=</span> freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>pfn<span class="token punctuation">;</span>   <span class="token comment">//有空闲页面,改为有效</span>
			pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>counter<span class="token operator">++</span><span class="token punctuation">;</span>
			freepf_head <span class="token operator">=</span> freepf_head<span class="token operator">-</span><span class="token operator">&gt;</span>next<span class="token punctuation">;</span>      <span class="token comment">//减少一个free页面</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
			pl<span class="token punctuation">[</span>page<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>counter<span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token comment">// 软件计数器（被访问次数）</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 定期右移</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">15</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> total_vp<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				pl<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>counter <span class="token operator">&gt;&gt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"LFU:%6.4f\n"</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">-</span> diseffect <span class="token operator">/</span> <span class="token number">320.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6e4d138473d9d5c85d279b08e6063df3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">简单快捷通用导出word功能</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0f2f2b9171f4776cbe1eaca00ee3edf1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">js对一个对象进行存取key和value值操作</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>