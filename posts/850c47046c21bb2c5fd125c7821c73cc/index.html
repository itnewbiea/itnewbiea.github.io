<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>clean code之优雅校验 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="clean code之优雅校验" />
<meta property="og:description" content="clean code之优雅校验 参数的非空判断，长度判断，集合的非空等等，
接口层校验:demo public interface TaskService { /** * insert tb_task_record * * @param taskRecordVo * @return */ Integer insertTbTaskRecord(@Valid TaskRecordVo taskRecordVo); } @Data public class TaskRecordVo implements Serializable { private static final long serialVersionUID = 9110133117222913758L; /** * 主键id */ @NotNull(message = &#34;id不能为空&#34;) private BigInteger id; } @Service @Validated public class TaskServiceImpl implements TaskService { @Override public Integer insertTbTaskRecord(TaskRecordVo taskRecordVo) { return 1; } @Test public void testQueryTaskRecordByTaskId() { try { taskService." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/850c47046c21bb2c5fd125c7821c73cc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-04T21:07:39+08:00" />
<meta property="article:modified_time" content="2021-07-04T21:07:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">clean code之优雅校验</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="clean_code_0"></a>clean code之优雅校验</h3> 
<p>参数的非空判断，长度判断，集合的非空等等，</p> 
<h3><a id="demo_6"></a>接口层校验:demo</h3> 
<pre><code class="prism language-java">
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">TaskService</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     * insert tb_task_record
     *
     * @param taskRecordVo
     * @return
     */</span>
    Integer <span class="token function">insertTbTaskRecord</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> TaskRecordVo taskRecordVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TaskRecordVo</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">9110133117222913758</span>L<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 主键id
     */</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"id不能为空"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> BigInteger id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>



<span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@Validated</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TaskServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">TaskService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> Integer <span class="token function">insertTbTaskRecord</span><span class="token punctuation">(</span>TaskRecordVo taskRecordVo<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

 <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQueryTaskRecordByTaskId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            taskService<span class="token punctuation">.</span><span class="token function">insertTbTaskRecord</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TaskRecordVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/1e/b3/fnwTXzav_o.png" alt="在这里插入图片描述"><br> ConstraintV<br> <img src="https://images2.imgbox.com/e2/cb/Ur14IBVT_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_demo_58"></a>2. 控制层的参数校验demo:</h3> 
<pre><code class="prism language-java">
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestValidController</span> <span class="token punctuation">{<!-- --></span>


    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"test1"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> Param Param<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        Preconditions<span class="token punctuation">.</span><span class="token function">checkArgument</span><span class="token punctuation">(</span>StringUtils<span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>Param<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"id不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Preconditions<span class="token punctuation">.</span><span class="token function">checkArgument</span><span class="token punctuation">(</span>CollectionUtils<span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>Param<span class="token punctuation">.</span><span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"List不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//do something</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Data</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Param</span> <span class="token punctuation">{<!-- --></span>
        <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"不能为空"</span><span class="token punctuation">)</span>
        <span class="token keyword">private</span> String id<span class="token punctuation">;</span>

        <span class="token annotation punctuation">@NotEmpty</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"不能为空"</span><span class="token punctuation">)</span>
        <span class="token keyword">private</span> List<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> list<span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/dc/86/mVewpNp1_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_91"></a>备注:</h3> 
<p>接口层的参数校验需要在实现类上加@Validated<br> 控制层只需在参数上加@Valid</p> 
<p>接口层抛出的异常是：ConstraintViolationException<br> 控制层抛出的异常是:MethodArgumentNotValidException</p> 
<p>参数校验的注解有:<br> spring-boot已经集成了spring validation和hibernate，直接使用就好了，spring支持的参数注解如下：<br> @NotNull validates that the annotated property value is not null.<br> @AssertTrue validates that the annotated property value is true.<br> @Size validates that the annotated property value has a size between the attributes min and max; can be applied to String, Collection, Map, and array properties.<br> @Min validates that the annotated property has a value no smaller than the value attribute.<br> @Max validates that the annotated property has a value no larger than the value attribute.<br> @Email validates that the annotated property is a valid email address.<br> Some annotations accept additional attributes, but the message attribute is common to all of them. This is the message that will usually be rendered when the value of the respective property fails validation.<br> And some additional annotations that can be found in the JSR:<br> @NotEmpty validates that the property is not null or empty; can be applied to String, Collection, Map or Array values.<br> @NotBlank can be applied only to text values and validates that the property is not null or whitespace.<br> @Positive and @PositiveOrZero apply to numeric values and validate that they are strictly positive, or positive including 0.<br> @Negative and @NegativeOrZero apply to numeric values and validate that they are strictly negative, or negative including 0.<br> @Past and @PastOrPresent validate that a date value is in the past or the past including the present; can be applied to date types including those added in Java 8.<br> @Future and @FutureOrPresent validate that a date value is in the future, or in the future including the present.</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/de5fb4aef7820fb1f158968e710eb999/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">windows 11系统字如何更改文本字体大小？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/019745e8494077d2101cb7122c9c139e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【转载】office2021</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>