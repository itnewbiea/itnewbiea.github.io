<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python sklearn 回归预测房价例子 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python sklearn 回归预测房价例子" />
<meta property="og:description" content="使用sklearn 回归模型,预测房价例子
from sklearn import linear_model import pandas as pd import numpy as np def get_data(): # square_feet,price train_data = pd.read_csv(&#34;train_data.csv&#34;) return np.array(train_data[[&#34;square_feet&#34;, &#34;comfortable&#34;]]).reshape(-1, 2), np.array(train_data[&#34;price&#34;]).reshape( -1, 1) if __name__ == &#34;__main__&#34;: # 获取训练数据 x, y = get_data() # 创建回归模型 regr = linear_model.LinearRegression() # 训练模型 regr.fit(x, y) # 获取预测数据 df = pd.read_csv(&#34;predict_data.csv&#34;) predict_x = np.array(df[[&#34;square_feet&#34;, &#34;comfortable&#34;]]).reshape(-1, 2) # 获取预测结果 predict_outcome = regr.predict(predict_x) # intercept_和coef_是模型参数 # y = coef_[0]*x1 &#43; coef_[1]*x2 &#43; intercept_ print({&#39;intercept&#39;: regr." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/368b4cc907571338b5c081187e391d18/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-07-25T15:53:50+08:00" />
<meta property="article:modified_time" content="2020-07-25T15:53:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python sklearn 回归预测房价例子</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>使用sklearn 回归模型,预测房价例子</p> 
<pre><code class="language-python">from sklearn import linear_model
import pandas as pd
import numpy as np


def get_data():
    # square_feet,price
    train_data = pd.read_csv("train_data.csv")
    return np.array(train_data[["square_feet", "comfortable"]]).reshape(-1, 2), np.array(train_data["price"]).reshape(
        -1, 1)


if __name__ == "__main__":
    # 获取训练数据
    x, y = get_data()
    # 创建回归模型
    regr = linear_model.LinearRegression()

    # 训练模型
    regr.fit(x, y)

    # 获取预测数据
    df = pd.read_csv("predict_data.csv")
    predict_x = np.array(df[["square_feet", "comfortable"]]).reshape(-1, 2)

    # 获取预测结果
    predict_outcome = regr.predict(predict_x)
    
    # intercept_和coef_是模型参数
    # y = coef_[0]*x1 + coef_[1]*x2 + intercept_
    print({'intercept': regr.intercept_, 'coefficient': regr.coef_})
    df['pred'] = predict_outcome
    print(df)</code></pre> 
<p>训练数据   train_data.csv</p> 
<blockquote> 
 <pre><code class="language-html hljs">square_feet,comfortable,price
1,1,100
2,1,200
3,1,300
4,1,400
5,1,500
6,1,600
7,1,700
8,1,800
9,1,900
1,2,200
2,2,400
3,2,600
4,2,800
5,2,1000
6,2,1200
7,2,1400
8,2,1600
9,2,1800
1,3,300
2,3,600
3,3,900
4,3,1200
5,3,1500
6,3,1800
7,3,2100
8,3,2400
9,3,2700
1,4,400
2,4,600
3,4,1000
4,4,1300
5,4,1400
6,4,1500
7,4,2600
8,4,2700
9,4,2800</code></pre> 
</blockquote> 
<p> 预测数据    predict_data.csv</p> 
<blockquote> 
 <pre><code class="language-html hljs">square_feet,comfortable
5,0.1
4,1</code></pre> 
</blockquote> 
<p>结果输出</p> 
<blockquote> 
 <p>{'intercept': array([-946.52777778]), 'coefficient': array([[230.41666667, 376.66666667]])}<br>    square_feet  comfortable        pred<br> 0            5          0.1  243.222222<br> 1            4          1.0  351.805556 </p> 
</blockquote>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3501e92404e419b993265ba6713b76b0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">shell脚本快速入门之-----正则三剑客之一grep用法大全！！！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2e50341e39e2e0f98d5a9b4da018f696/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">shell脚本快速入门之-----shell脚本练习100例！！！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>