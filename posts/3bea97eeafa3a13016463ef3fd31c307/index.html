<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>hdu4317（kd树模板） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="hdu4317（kd树模板）" />
<meta property="og:description" content="#include&lt;iostream&gt; #include&lt;cstdio&gt; #include&lt;algorithm&gt; #include&lt;cstring&gt; #include&lt;cmath&gt; #include&lt;vector&gt; #include&lt;queue&gt; #include&lt;set&gt; #define mem(a,x) memset(a,x,sizeof(a)) #define s1(x) scanf(&#34;%d&#34;,&amp;x) #define s2(x,y) scanf(&#34;%d%d&#34;,&amp;x,&amp;y) #define s3(x,y,z) scanf(&#34;%d%d%d&#34;,&amp;x,&amp;y,&amp;z) #define s4(x,y,z,k) scanf(&#34;%d%d%d%d&#34;,&amp;x,&amp;y,&amp;z,&amp;k) #define ff(a,n) for(int i = 0 ; i &lt; n; i&#43;&#43;) scanf(&#34;%d&#34;,a&#43;i) #define ls 2*rt #define rs 2*rt&#43;1 #define lson ls,L,mid #define rson rs,mid&#43;1,R #define ll long long using namespace std; typedef pair&lt;int,int&gt; pii; //inline ll ask(int x){ll res=0;while(x)res&#43;=c[x],x-=x&amp;(-x);return res;} //inline void add(int x,int d){while(x&lt;=n)c[x]&#43;=d,x&#43;=x&amp;(-x);} //int gcd(int a, int b) { return b == 0 ?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/3bea97eeafa3a13016463ef3fd31c307/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-10-12T13:16:20+08:00" />
<meta property="article:modified_time" content="2018-10-12T13:16:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">hdu4317（kd树模板）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre class="has"><code class="language-cpp">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
#include&lt;cstring&gt;
#include&lt;cmath&gt;
#include&lt;vector&gt;
#include&lt;queue&gt;
#include&lt;set&gt;
#define mem(a,x) memset(a,x,sizeof(a))
#define s1(x) scanf("%d",&amp;x)
#define s2(x,y) scanf("%d%d",&amp;x,&amp;y)
#define s3(x,y,z) scanf("%d%d%d",&amp;x,&amp;y,&amp;z)
#define s4(x,y,z,k) scanf("%d%d%d%d",&amp;x,&amp;y,&amp;z,&amp;k)
#define ff(a,n) for(int i = 0 ; i &lt; n; i++) scanf("%d",a+i)
#define ls 2*rt
#define rs 2*rt+1
#define lson ls,L,mid
#define rson rs,mid+1,R
#define ll long long
using namespace std;
typedef pair&lt;int,int&gt; pii;
//inline ll ask(int x){ll res=0;while(x)res+=c[x],x-=x&amp;(-x);return res;}
//inline void add(int x,int d){while(x&lt;=n)c[x]+=d,x+=x&amp;(-x);}
//int gcd(int a, int b) { return b == 0 ? a : gcd(b, a%b);}
const ll inf = 0x3f3f3f3f;
const int mx = 5e4+10;

int n,dim,k,m;
struct no{
    int v[12];
    bool operator &lt; (const no &amp;a)const{
        return v[k] &lt; a.v[k];
    } 
}p[mx*2],ob,data[mx],sta[12];
bool f[mx*4];
//priority_queue&lt; pair&lt;double,no&gt; &gt; que;
priority_queue&lt;pair&lt;double,no&gt; &gt; que;
double dis(no a, no b){
    double ans = 0;
    for(int i = 0;i &lt; dim; i++){
        ans+=(a.v[i]-b.v[i])*(a.v[i]-b.v[i]);
    }
    return sqrt(1.0*ans);
}
void build(int l, int r,int rt,int dir){
    k = dir; 
    if( l&gt;r)
        return;
    f[rt] = 1;
    int mid = (l+r)/2;
    nth_element(data+l,data+mid,data+r+1);
    p[rt] = data[mid];
    build(l,mid-1,rt*2,(dir+1)%dim);
    build(mid+1,r,rt*2+1,(dir+1)%dim);
}
void query(int rt,int dir){
    k = dir; 
    if(!f[rt])
        return;
    double d = dis(ob,p[rt]);
     pair&lt;double,no&gt; cur(d,p[rt]); 
    bool fa = 0;
    int son;
    if(ob.v[dir] &gt;= p[rt].v[dir]){
        son = rs;
    }
    else
        son = ls;
    if(f[son])
        query(son,(dir+1)%dim);
    if(que.size() &lt; m){
        que.push(cur);
        fa = 1;
    }
    else{
        if(cur &lt; que.top()){
            que.pop();
            que.push(cur);
        }
        if(fabs(ob.v[dir]-p[rt].v[dir]) &lt; que.top().first){
            fa = 1;
        }
    }
    if(f[son^1]&amp;&amp;fa)
        query(son^1,(dir+1)%dim);
}

int main(){
    //    freopen("F:\\in.txt","r",stdin);
    //int T=10;    scanf("%d",&amp;T);
    while(s2(n,dim) != EOF){
        mem(f,0);
        for(int i = 1; i &lt;= n ;i++)
            for(int j = 0; j &lt; dim; j++){
                s1(data[i].v[j]);
            }
        build( 1,  n, 1, 0);
        int t;
        s1(t);
        //no te;
        while(t--){
        //    cout&lt;&lt;"jin"&lt;&lt;endl;
            for(int j = 0; j &lt; dim; j++){
                s1(ob.v[j]);
            }
            s1(m);
            query( 1, 0);
            printf("the closest %d points are:\n", m);
            int top = 0;
            while(!que.empty()){
                sta[top++] = que.top().second;
                que.pop();
            } 
             while(top)
            {
                no tmp=sta[--top];
                printf("%d", tmp.v[0]);
                for(int i=1;i&lt;dim;i++)
                    printf(" %d", tmp.v[i]);
                printf("\n");
            }
            
        }
    } 
    


    return 0;
}</code></pre> 
<p> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5b2fc711c1aca5d81d2dcc8d27c6ba7e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android studio导出hprof到MAT工具流程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2efb748703f8ce1cfc0bb380e8f3172b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ubuntu16.04设置root用户登陆图形界面的方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>