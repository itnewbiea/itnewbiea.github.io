<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Ubuntu下搭建伪分布式从0开始安装Hive详细教程（从JDK安装、Hadoop搭建开始） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Ubuntu下搭建伪分布式从0开始安装Hive详细教程（从JDK安装、Hadoop搭建开始）" />
<meta property="og:description" content="Ubuntu下搭建伪分布式从0开始安装Hive详细教程（从JDK安装、Hadoop搭建开始） 环境：VMware® Workstation 16 Pro、Ubuntu18.04
1、安装SSH和配置SSH无密码登录 sudo apt-get install openssh-server 安装后，可使用以下命令登录本机：
ssh localhost 输入 yes 与用户密码，就可以登录到本机
接着我们退出 SSH 登录
exit 配置无密码登录：
cd ~/.ssh/ ssh-keygen -t rsa 注意这里第二步要你输入文件名时不用输入，直接一路 Enter 选择默认值就好了！
cat ./id_rsa.pub &gt;&gt; ./authorized_keys 此时再用 ssh localhost 命令无需密码即可登录了。
2、安装Java环境 2.1 安装JDK 对于 Hadoop3.1.3 及以上版本而言，需要使用 JDK1.8 或者更新的版本，这里我们使用的 JDK 版本为1.8.0_301，安装包可以从 Oracle 官网下载：Java Downloads | Oracle，Java官网安装太麻烦了
也可从我的百度网盘下载：jdk-8u301-linux-x64.tar.gz（提取码：6del）
接着在 /usr/lib 目录下创建 jvm 文件夹来保存 JDK 文件：
cd /usr/lib sudo mkdir jvm 可以用 Xshell 连接虚拟机，把 JDK 文件上传到虚拟机，解压缩之前的 JDK 文件到上述目录中：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/4926c86cc5091dede6700878e9f1b8e9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-07T08:39:31+08:00" />
<meta property="article:modified_time" content="2022-09-07T08:39:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Ubuntu下搭建伪分布式从0开始安装Hive详细教程（从JDK安装、Hadoop搭建开始）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Ubuntu0HiveJDKHadoop_0"></a>Ubuntu下搭建伪分布式从0开始安装Hive详细教程（从JDK安装、Hadoop搭建开始）</h2> 
<p>环境：VMware® Workstation 16 Pro、Ubuntu18.04</p> 
<h3><a id="1SSHSSH_2"></a>1、安装SSH和配置SSH无密码登录</h3> 
<pre><code class="prism language-powershell">sudo apt-get install openssh-server
</code></pre> 
<p>安装后，可使用以下命令登录本机：</p> 
<pre><code class="prism language-powershell">ssh localhost
</code></pre> 
<p>输入 yes 与用户密码，就可以登录到本机<br> <img src="https://images2.imgbox.com/15/d3/aitwTUm2_o.png" alt="在这里插入图片描述"><br> 接着我们退出 SSH 登录</p> 
<pre><code class="prism language-powershell"><span class="token keyword">exit</span>
</code></pre> 
<p>配置无密码登录：</p> 
<pre><code class="prism language-powershell">cd ~<span class="token operator">/</span><span class="token punctuation">.</span>ssh/
ssh-keygen <span class="token operator">-</span>t rsa
</code></pre> 
<p>注意这里第二步要你输入文件名时不用输入，直接一路 <strong>Enter</strong> 选择默认值就好了！</p> 
<pre><code class="prism language-powershell"><span class="token function">cat</span> <span class="token punctuation">.</span><span class="token operator">/</span>id_rsa<span class="token punctuation">.</span>pub &gt;&gt; <span class="token punctuation">.</span><span class="token operator">/</span>authorized_keys
</code></pre> 
<p>此时再用 ssh localhost 命令无需密码即可登录了。<br> <img src="https://images2.imgbox.com/52/b3/4u6Fgdmo_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2Java_32"></a>2、安装Java环境</h3> 
<h4><a id="21_JDK_33"></a>2.1 安装JDK</h4> 
<p>对于 Hadoop3.1.3 及以上版本而言，需要使用 JDK1.8 或者更新的版本，这里我们使用的 JDK 版本为1.8.0_301，安装包可以从 Oracle 官网下载：<a href="https://www.oracle.com/java/technologies/downloads/" rel="nofollow">Java Downloads | Oracle</a>，Java官网安装太麻烦了</p> 
<p>也可从我的百度网盘下载：<a href="https://pan.baidu.com/s/15wvkJF4p3pFaODGYPXjr8Q" rel="nofollow">jdk-8u301-linux-x64.tar.gz</a>（提取码：6del）</p> 
<p>接着在 /usr/lib 目录下创建 jvm 文件夹来保存 JDK 文件：</p> 
<pre><code class="prism language-powershell">cd <span class="token operator">/</span>usr/lib
sudo mkdir jvm
</code></pre> 
<p>可以用 Xshell 连接虚拟机，把 JDK 文件上传到虚拟机，解压缩之前的 JDK 文件到上述目录中：</p> 
<pre><code class="prism language-powershell">cd ~<span class="token operator">/</span>Downloads
sudo tar <span class="token operator">-</span>zxvf <span class="token punctuation">.</span><span class="token operator">/</span>jdk-8u301-linux-x64<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span>C <span class="token operator">/</span>usr/lib/jvm
</code></pre> 
<h4><a id="22_JDK_52"></a>2.2 配置JDK环境</h4> 
<pre><code class="prism language-powershell">vim ~<span class="token operator">/</span><span class="token punctuation">.</span>bashrc
</code></pre> 
<p>在文件末尾处添加以下几行内容：</p> 
<pre><code class="prism language-powershell">export JAVA_HOME=<span class="token operator">/</span>usr/lib/jvm/jdk1<span class="token punctuation">.</span>8<span class="token punctuation">.</span>0_301
export JRE_HOME=$<span class="token punctuation">{<!-- --></span>JAVA_HOME<span class="token punctuation">}</span><span class="token operator">/</span>jre
export CLASSPATH=<span class="token punctuation">.</span>:$<span class="token punctuation">{<!-- --></span>JAVA_HOME<span class="token punctuation">}</span><span class="token operator">/</span>lib:$<span class="token punctuation">{<!-- --></span>JRE_HOME<span class="token punctuation">}</span><span class="token operator">/</span>lib
export PATH=$<span class="token punctuation">{<!-- --></span>JAVA_HOME<span class="token punctuation">}</span><span class="token operator">/</span>bin:<span class="token variable">$PATH</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f9/5b/DjTeuxAR_o.png" alt="在这里插入图片描述"><br> 保存并退出，接着使我们刚加入的环境变量生效：</p> 
<pre><code class="prism language-powershell">source ~<span class="token operator">/</span><span class="token punctuation">.</span>bashrc
</code></pre> 
<h4><a id="33__72"></a>3.3 检验安装</h4> 
<p>输入以下命令：</p> 
<pre><code class="prism language-powershell">java <span class="token operator">-</span>version
</code></pre> 
<p>若出现如下则说明安装成功：<br> <img src="https://images2.imgbox.com/65/15/eyi9UuYC_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3Hadoop_81"></a>3、安装单机Hadoop</h3> 
<h4><a id="31_Hadoop_82"></a>3.1 下载安装Hadoop</h4> 
<p>下载地址：<a href="https://hadoop.apache.org/releases.html#Download" rel="nofollow">Apache Hadoop</a>，这里官网下载较快，不要下载 src 源码包！</p> 
<p>也可从我的百度网盘下载：<a href="https://pan.baidu.com/s/1m_N_Fg1fZMdA-0W7W3YGkA?pwd=ij6b" rel="nofollow">hadoop-3.1.3.tar.gz</a>（提取码: ij6b）</p> 
<p>这里我安装的 Hadoop 版本为3.1.3，下载好后，和上面的 JDK 一样上传到虚拟机，执行以下命令安装：</p> 
<pre><code class="prism language-powershell">sudo tar <span class="token operator">-</span>zxf ~<span class="token operator">/</span>Downloads/hadoop-3<span class="token punctuation">.</span>1<span class="token punctuation">.</span>3<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span>C <span class="token operator">/</span>usr/local
</code></pre> 
<p>修改目录名称：</p> 
<pre><code class="prism language-powershell">cd <span class="token operator">/</span>usr/local
sudo <span class="token function">mv</span>  <span class="token punctuation">.</span><span class="token operator">/</span>hadoop-3<span class="token punctuation">.</span>2<span class="token punctuation">.</span>2/ <span class="token punctuation">.</span><span class="token operator">/</span>hadoop
</code></pre> 
<p>赋予可执行权限:（如用 root 登录可以忽略，以下的 wyc 是我当前普通用户名）</p> 
<pre><code class="prism language-powershell">sudo chown <span class="token operator">-</span>R wyc <span class="token punctuation">.</span><span class="token operator">/</span>hadoop
</code></pre> 
<h4><a id="32__105"></a>3.2 检查安装</h4> 
<p>修改配置文件：</p> 
<pre><code class="prism language-powershell">vim ~<span class="token operator">/</span><span class="token punctuation">.</span>bashrc
</code></pre> 
<p>写入：</p> 
<pre><code class="prism language-powershell"><span class="token comment">##HADOOP_HOME</span>
export HADOOP_HOME=<span class="token operator">/</span>usr/local/hadoop
export PATH=<span class="token variable">$PATH</span>:$<span class="token punctuation">{<!-- --></span>HADOOP_HOME<span class="token punctuation">}</span><span class="token operator">/</span>bin
export PATH=<span class="token variable">$PATH</span>:$<span class="token punctuation">{<!-- --></span>HADOOP_HOME<span class="token punctuation">}</span><span class="token operator">/</span>sbin
</code></pre> 
<p>按 esc :wq 退出</p> 
<p>让环境生效：</p> 
<pre><code class="prism language-powershell">source  ~<span class="token operator">/</span><span class="token punctuation">.</span>bashrc
</code></pre> 
<p>输入下面代码就可以看到Hadoop版本号了</p> 
<pre><code class="prism language-powershell">hadoop version
</code></pre> 
<p><img src="https://images2.imgbox.com/d8/d8/Ek11opGT_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4Hadoop_130"></a>4、配置Hadoop伪分布</h3> 
<h4><a id="41__bashrc__131"></a>4.1 配置 .bashrc 文件</h4> 
<p>修改 .bashrc 文件：</p> 
<pre><code class="prism language-powershell">sudo vim ~<span class="token operator">/</span><span class="token punctuation">.</span>bashrc
</code></pre> 
<p>往文件末加入以下两行：</p> 
<pre><code class="prism language-powershell"><span class="token comment"># 注意此处的路径和你的hadoop文件最后解压存放的位置是一致的</span>
export HADOOP_HOME=<span class="token operator">/</span>usr/local/hadoop
</code></pre> 
<p><img src="https://images2.imgbox.com/fd/98/vUVHqpT9_o.png" alt="在这里插入图片描述"><br> 使配置文件立即生效：</p> 
<pre><code class="prism language-powershell">source ~<span class="token operator">/</span><span class="token punctuation">.</span>bashrc
</code></pre> 
<h4><a id="42__150"></a>4.2. 配置伪分布式</h4> 
<p>对于伪分布式配置，我们需要修改 core-site.xml 和 hdfs-site.xml 两个文件，这两个文件在我们单机安装好的 Hadoop 目录下的 /etc/hadoop 文件夹内。</p> 
<p>进入文件所在文件夹：</p> 
<pre><code class="prism language-powershell">cd <span class="token operator">/</span>usr/local/hadoop/etc/hadoop 
</code></pre> 
<p>修改我们的 core-site.xml 文件：</p> 
<pre><code class="prism language-powershell">sudo vim core-site<span class="token punctuation">.</span>xml
</code></pre> 
<p>修改文件内容如下：（实则就是往 configuration 里添加参数，注意缩进）</p> 
<pre><code class="prism language-powershell">&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;hadoop<span class="token punctuation">.</span>tmp<span class="token punctuation">.</span><span class="token function">dir</span>&lt;<span class="token operator">/</span>name&gt;
        &lt;value&gt;file:<span class="token operator">/</span>usr/local/hadoop/tmp&lt;<span class="token operator">/</span>value&gt;
        &lt;description&gt;Abase <span class="token keyword">for</span> other temporary directories<span class="token punctuation">.</span>&lt;<span class="token operator">/</span>description&gt;
    &lt;<span class="token operator">/</span>property&gt;
    &lt;property&gt;
        &lt;name&gt;fs<span class="token punctuation">.</span>defaultFS&lt;<span class="token operator">/</span>name&gt;
        &lt;value&gt;hdfs:<span class="token operator">/</span><span class="token operator">/</span>localhost:9000&lt;<span class="token operator">/</span>value&gt;
    &lt;<span class="token operator">/</span>property&gt;
&lt;<span class="token operator">/</span>configuration&gt;
</code></pre> 
<p>如下：<br> <img src="https://images2.imgbox.com/1b/ff/Ad6DFrTL_o.png" alt="在这里插入图片描述"><br> 接着修改 hdfs-site.xml 文件：</p> 
<pre><code class="prism language-powershell">sudo vim hdfs-site<span class="token punctuation">.</span>xml
</code></pre> 
<p>也是添加一些配置参数，修改后如下：（注意缩进）</p> 
<pre><code class="prism language-powershell">&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;dfs<span class="token punctuation">.</span>replication&lt;<span class="token operator">/</span>name&gt;
        &lt;value&gt;1&lt;<span class="token operator">/</span>value&gt;
    &lt;<span class="token operator">/</span>property&gt;
    &lt;property&gt;
        &lt;name&gt;dfs<span class="token punctuation">.</span>namenode<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">dir</span>&lt;<span class="token operator">/</span>name&gt;
        &lt;value&gt;file:<span class="token operator">/</span>usr/local/hadoop/tmp/dfs/name&lt;<span class="token operator">/</span>value&gt;
    &lt;<span class="token operator">/</span>property&gt;
    &lt;property&gt;
        &lt;name&gt;dfs<span class="token punctuation">.</span>datanode<span class="token punctuation">.</span><span class="token keyword">data</span><span class="token punctuation">.</span><span class="token function">dir</span>&lt;<span class="token operator">/</span>name&gt;
        &lt;value&gt;file:<span class="token operator">/</span>usr/local/hadoop/tmp/dfs/<span class="token keyword">data</span>&lt;<span class="token operator">/</span>value&gt;
    &lt;<span class="token operator">/</span>property&gt;
&lt;<span class="token operator">/</span>configuration&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/c2/5f/Qak9wWKb_o.png" alt="在这里插入图片描述"><br> 到这，伪分布式安装所需要的配置就配置好啦！</p> 
<h3><a id="5_207"></a>5、初始化文件系统</h3> 
<p>先回到我们的 Hadoop 安装目录下：</p> 
<pre><code class="prism language-powershell">cd <span class="token operator">/</span>usr/local/hadoop
</code></pre> 
<p>使用以下命令初始化文件系统：</p> 
<pre><code class="prism language-powershell"><span class="token punctuation">.</span><span class="token operator">/</span>bin/hdfs namenode <span class="token operator">-</span>format
</code></pre> 
<p>有如下输出，就是初始化成功了：<br> <img src="https://images2.imgbox.com/e5/4f/4HXSuMzA_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="6_220"></a>6、验证安装</h3> 
<h4><a id="61_HDFS_221"></a>6.1 启动HDFS</h4> 
<p>文件初始化成功后，赋予 logs 文件夹相关权限：</p> 
<pre><code class="prism language-powershell">sudo chmod <span class="token operator">-</span>R wyc <span class="token punctuation">.</span><span class="token operator">/</span>logs
</code></pre> 
<p>可使用如下命令启动 HDFS：</p> 
<pre><code class="prism language-powershell"><span class="token punctuation">.</span><span class="token operator">/</span>sbin/<span class="token function">start-dfs</span><span class="token punctuation">.</span>sh
</code></pre> 
<h4><a id="62__233"></a>6.2 部分报错</h4> 
<p>可是报了如下错误：</p> 
<pre><code class="prism language-powershell">root@wyc:<span class="token operator">/</span>usr/local/hadoop<span class="token comment"># ./sbin/start-dfs.sh</span>
Starting namenodes on <span class="token namespace">[localhost]</span>
ERROR: Attempting to operate on hdfs namenode as root
ERROR: but there is no HDFS_NAMENODE_USER defined<span class="token punctuation">.</span> Aborting operation<span class="token punctuation">.</span>
Starting datanodes
ERROR: Attempting to operate on hdfs datanode as root
ERROR: but there is no HDFS_DATANODE_USER defined<span class="token punctuation">.</span> Aborting operation<span class="token punctuation">.</span>
Starting secondary namenodes <span class="token namespace">[wyc]</span>
ERROR: Attempting to operate on hdfs secondarynamenode as root
ERROR: but there is no HDFS_SECONDARYNAMENODE_USER defined<span class="token punctuation">.</span> Aborting operation<span class="token punctuation">.</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0e/ec/R9OhpM8s_o.png" alt="在这里插入图片描述"><br> 解决办法：将start-dfs.sh，stop-dfs.sh(在hadoop安装目录的sbin里)两个文件顶部添加以下参数</p> 
<pre><code class="prism language-powershell">HDFS_DATANODE_USER=root
HDFS_DATANODE_SECURE_USER=hdfs
HDFS_NAMENODE_USER=root
HDFS_SECONDARYNAMENODE_USER=root
</code></pre> 
<p><img src="https://images2.imgbox.com/e5/97/W3cXAXIA_o.png" alt="在这里插入图片描述"><br> 将start-yarn.sh，stop-yarn.sh(在hadoop安装目录的sbin里)两个文件顶部添加以下参数</p> 
<pre><code class="prism language-powershell">YARN_RESOURCEMANAGER_USER=root
HADOOP_SECURE_DN_USER=yarn
YARN_NODEMANAGER_USER=root
</code></pre> 
<p>再次启动 HDFS命令，又接着报错：</p> 
<pre><code class="prism language-powershell">root@wyc:<span class="token operator">/</span>usr/local/hadoop<span class="token comment"># ./sbin/start-dfs.sh</span>
Starting namenodes on <span class="token namespace">[localhost]</span>
ERROR: JAVA_HOME is not <span class="token function">set</span> and could not be found<span class="token punctuation">.</span>
Starting datanodes
ERROR: JAVA_HOME is not <span class="token function">set</span> and could not be found<span class="token punctuation">.</span>
Starting secondary namenodes <span class="token namespace">[wyc]</span>
ERROR: JAVA_HOME is not <span class="token function">set</span> and could not be found<span class="token punctuation">.</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/34/be/e8pQtBaD_o.png" alt="在这里插入图片描述"><br> 使用如下命令修改环境文件：</p> 
<pre><code class="prism language-powershell">sudo vim <span class="token punctuation">.</span><span class="token operator">/</span>etc/hadoop/hadoop-env<span class="token punctuation">.</span>sh
</code></pre> 
<p>添加如下内容：</p> 
<pre><code class="prism language-powershell">export JAVA_HOME=<span class="token operator">/</span>usr/lib/jvm/jdk1<span class="token punctuation">.</span>8<span class="token punctuation">.</span>0_301
export HADOOP=<span class="token operator">/</span>usr/local/hadoop
export PATH=<span class="token variable">$PATH</span>:<span class="token operator">/</span>usr/local/hadoop/bin
</code></pre> 
<h4><a id="63__289"></a>6.3 启动成功</h4> 
<p>再次启动 HDFS命令，出现如下输出就没问题啦：<br> <img src="https://images2.imgbox.com/0a/50/s6TUHBJ9_o.png" alt="在这里插入图片描述"><br> 启动后，使用 jps 指令查看所有 Java 进程，若 HDFS 启动成功输出如下：<br> <img src="https://images2.imgbox.com/67/2b/e13anL9U_o.png" alt="在这里插入图片描述"><br> 此时可访问 Web 页面（在浏览器输入：http://192.168.153.142:9870（这里198.168.153.142是我 Ubuntu 的 IP ，你们换成自己的就可以了））:<br> <img src="https://images2.imgbox.com/79/54/o1phT3J7_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="7Hive_296"></a>7、安装Hive</h3> 
<h4><a id="71__297"></a>7.1 下载压缩包并解压</h4> 
<p>官网下载目录如下：<a href="https://dlcdn.apache.org/hive/" rel="nofollow">Index of /hive</a></p> 
<p>建议清华镜像网站下载：<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/hive/" rel="nofollow">https://mirrors.tuna.tsinghua.edu.cn/apache/hive/</a></p> 
<p>下载文件如下：apache-hive-3.1.2-bin.tar.gz，进入下载目录，解压压缩包：</p> 
<pre><code class="prism language-powershell">cd ~<span class="token operator">/</span>Downloads
sudo tar <span class="token operator">-</span>zxvf <span class="token punctuation">.</span><span class="token operator">/</span>apache-hive-3<span class="token punctuation">.</span>1<span class="token punctuation">.</span>2-bin<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span>C <span class="token operator">/</span>usr/local 
</code></pre> 
<h4><a id="72_Hive_308"></a>7.2 安装Hive</h4> 
<p>进入到 /usr/local 目录下，更改文件夹名，赋予用户权限：</p> 
<pre><code class="prism language-powershell">cd <span class="token operator">/</span>usr/local
sudo <span class="token function">mv</span> apache-hive-3<span class="token punctuation">.</span>1<span class="token punctuation">.</span>2-bin hive     
sudo chown <span class="token operator">-</span>R wyc <span class="token punctuation">.</span><span class="token operator">/</span>hive
</code></pre> 
<h4><a id="73__316"></a>7.3 配置环境变量</h4> 
<p>修改 ~/.bashrc 文件：</p> 
<pre><code class="prism language-powershell">vim ~<span class="token operator">/</span><span class="token punctuation">.</span>bashrc
</code></pre> 
<p>增添下面几行：</p> 
<pre><code class="prism language-powershell">export HIVE_HOME=<span class="token operator">/</span>usr/local/hive
export PATH=<span class="token variable">$PATH</span>:<span class="token variable">$HIVE_HOME</span><span class="token operator">/</span>bin
export HADOOP_HOME=<span class="token operator">/</span>usr/local/hadoop
</code></pre> 
<p><img src="https://images2.imgbox.com/a2/b0/zyoWhoEd_o.png" alt="在这里插入图片描述"><br> 运行如下命令使配置立即生效：</p> 
<pre><code class="prism language-powershell">source  ~<span class="token operator">/</span><span class="token punctuation">.</span>bashrc
</code></pre> 
<h4><a id="74__335"></a>7.4 修改配置文件</h4> 
<p>修改配置 hive-default.xml 文件：</p> 
<pre><code class="prism language-powershell">cd <span class="token operator">/</span>usr/local/hive/conf
sudo <span class="token function">mv</span> hive-default<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>template hive-default<span class="token punctuation">.</span>xml
</code></pre> 
<p>新建 hive-site.xml 文件：</p> 
<pre><code class="prism language-powershell">sudo vim hive-site<span class="token punctuation">.</span>xml
</code></pre> 
<p>将以下内容写入文件：</p> 
<pre><code class="prism language-powershell">&lt;?xml version=<span class="token string">"1.0"</span> encoding=<span class="token string">"UTF-8"</span> standalone=<span class="token string">"no"</span>?&gt;
&lt;?xml-stylesheet <span class="token function">type</span>=<span class="token string">"text/xsl"</span> href=<span class="token string">"configuration.xsl"</span>?&gt;
&lt;configuration&gt;
  &lt;property&gt;
    &lt;name&gt;javax<span class="token punctuation">.</span>jdo<span class="token punctuation">.</span>option<span class="token punctuation">.</span>ConnectionURL&lt;<span class="token operator">/</span>name&gt;
    &lt;value&gt;jdbc:mysql:<span class="token operator">/</span><span class="token operator">/</span>localhost:3306/hive?createDatabaseIfNotExist=true&amp;amp<span class="token punctuation">;</span>useSSL=false&amp;amp<span class="token punctuation">;</span>allowPublicKeyRetrieval=true&lt;<span class="token operator">/</span>value&gt;
    &lt;description&gt;JDBC connect string <span class="token keyword">for</span> a JDBC metastore&lt;<span class="token operator">/</span>description&gt;
  &lt;<span class="token operator">/</span>property&gt;
  &lt;property&gt;
    &lt;name&gt;javax<span class="token punctuation">.</span>jdo<span class="token punctuation">.</span>option<span class="token punctuation">.</span>ConnectionDriverName&lt;<span class="token operator">/</span>name&gt;
    &lt;value&gt;com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>cj<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver&lt;<span class="token operator">/</span>value&gt;
    &lt;description&gt;Driver <span class="token keyword">class</span> name <span class="token keyword">for</span> a JDBC metastore&lt;<span class="token operator">/</span>description&gt;
  &lt;<span class="token operator">/</span>property&gt;
  &lt;property&gt;
    &lt;name&gt;javax<span class="token punctuation">.</span>jdo<span class="token punctuation">.</span>option<span class="token punctuation">.</span>ConnectionUserName&lt;<span class="token operator">/</span>name&gt;
    &lt;value&gt;hive&lt;<span class="token operator">/</span>value&gt;
    &lt;description&gt;username to use against metastore database&lt;<span class="token operator">/</span>description&gt;
  &lt;<span class="token operator">/</span>property&gt;
  &lt;property&gt;
    &lt;name&gt;javax<span class="token punctuation">.</span>jdo<span class="token punctuation">.</span>option<span class="token punctuation">.</span>ConnectionPassword&lt;<span class="token operator">/</span>name&gt;
    &lt;value&gt;hive&lt;<span class="token operator">/</span>value&gt;
    &lt;description&gt;password to use against metastore database&lt;<span class="token operator">/</span>description&gt;
  &lt;<span class="token operator">/</span>property&gt;
  &lt;property&gt;
    &lt;name&gt;datanucleus<span class="token punctuation">.</span>autoCreateTables&lt;<span class="token operator">/</span>name&gt;
    &lt;value&gt;True&lt;<span class="token operator">/</span>value&gt;
  &lt;<span class="token operator">/</span>property&gt;
&lt;<span class="token operator">/</span>configuration&gt;
</code></pre> 
<p>按下 ESC 键，:wq，保存并退出。</p> 
<h3><a id="8MySQL_382"></a>8、MySQL安装与配置</h3> 
<h4><a id="81_MySQL_383"></a>8.1 安装MySQL</h4> 
<p>我们使用默认的 apt 包管理器安装即可：</p> 
<pre><code class="prism language-powershell">sudo apt-get update
sudo apt-get install mysql-server
</code></pre> 
<p>启动 MySQL：</p> 
<pre><code class="prism language-powershell">service mysql <span class="token function">start</span>
</code></pre> 
<p>检查是否启动成功：</p> 
<pre><code class="prism language-powershell">systemctl status mysql<span class="token punctuation">.</span>service
</code></pre> 
<p>如下输出有绿色 Active 就是正常启动：<br> <img src="https://images2.imgbox.com/df/01/2WN9zAib_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="82_MySQL_402"></a>8.2 配置MySQL</h4> 
<p>初始化 MySQL：</p> 
<pre><code class="prism language-powershell">sudo mysql_secure_installation
</code></pre> 
<p>接下来会需要配置好几个内容，下面是我的部分配置：</p> 
<pre><code class="prism language-powershell">root@wyc:~<span class="token comment"># sudo mysql_secure_installation</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token comment"># 这里是询问是否安装密码插件，我选择 No</span>
Would you like to setup VALIDATE PASSWORD component?
Press y<span class="token punctuation">|</span>Y <span class="token keyword">for</span> Yes<span class="token punctuation">,</span> any other key <span class="token keyword">for</span> No: n

<span class="token comment"># 这里为 root 用户设置密码</span>
Please <span class="token function">set</span> the password <span class="token keyword">for</span> root here<span class="token punctuation">.</span>
New password: 
Re-enter new password: 

<span class="token comment"># 删除匿名用户，我选 Yes</span>
Remove anonymous users? <span class="token punctuation">(</span>Press y<span class="token punctuation">|</span>Y <span class="token keyword">for</span> Yes<span class="token punctuation">,</span> any other key <span class="token keyword">for</span> No<span class="token punctuation">)</span> : y
Success<span class="token punctuation">.</span>

<span class="token comment"># 禁止root管理员从远程登录，这里我选 No</span>
Disallow root login remotely? <span class="token punctuation">(</span>Press y<span class="token punctuation">|</span>Y <span class="token keyword">for</span> Yes<span class="token punctuation">,</span> any other key <span class="token keyword">for</span> No<span class="token punctuation">)</span> : n

<span class="token comment"># 删除test数据库并取消对它的访问权限， 我选 Yes</span>
Remove test database and access to it? <span class="token punctuation">(</span>Press y<span class="token punctuation">|</span>Y <span class="token keyword">for</span> Yes<span class="token punctuation">,</span> any other key <span class="token keyword">for</span> No<span class="token punctuation">)</span> : y

<span class="token comment"># # 刷新授权表，让初始化后的设定立即生效, 选 Yes</span>
Reload privilege tables now? <span class="token punctuation">(</span>Press y<span class="token punctuation">|</span>Y <span class="token keyword">for</span> Yes<span class="token punctuation">,</span> any other key <span class="token keyword">for</span> No<span class="token punctuation">)</span> : y
Success<span class="token punctuation">.</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
<p>编辑 MySQL 配置文件：</p> 
<pre><code class="prism language-powershell">sudo vim <span class="token operator">/</span>etc/mysql/mysql<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>d/mysqld<span class="token punctuation">.</span>cnf
</code></pre> 
<p>在 mysqld 下添加以下一行数据：</p> 
<pre><code class="prism language-powershell">character_set_server=utf8
</code></pre> 
<p><img src="https://images2.imgbox.com/ea/a8/Wpow3uYj_o.png" alt="在这里插入图片描述"><br> 重启你的 MySQL 服务：</p> 
<pre><code class="prism language-powershell">service mysql restart
sudo mysql <span class="token operator">-</span>u root <span class="token operator">-</span>p  <span class="token comment">#登陆MySQL shell界面</span>
</code></pre> 
<p>使用如下命令查看你的 MySQL 版本：</p> 
<pre><code class="prism language-powershell">mysql&gt;<span class="token function">SELECT</span> @@VERSION<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/54/49/vqonAdh2_o.png" alt="在这里插入图片描述"><br> 我的 MySQL 是 5.7.37 的版本</p> 
<h3><a id="9_MySQL_jdbc_464"></a>9、 安装MySQL jdbc包</h3> 
<p>上述博客安装的 MySQL 版本为 5.7.37，所以我们需要下载对应版本的 MySQL jdbc 包<br> <img src="https://images2.imgbox.com/c2/9d/wiQY9UC5_o.png" alt="在这里插入图片描述"></p> 
<ul><li>MySQL Connector/J 8.0 is highly recommended for use with MySQL Server 8.0, 5.7, and 5.6. Please upgrade to MySQL Connector/J 8.0.</li><li>官方更推荐MySQL5.6以上使用connector/j 8.0</li></ul> 
<p><a href="https://mvnrepository.com/artifact/mysql/mysql-connector-java" rel="nofollow">mysql-connector-java各种版本下载</a> 地址在这，点击 jar 包下载，如下：<br> <img src="https://images2.imgbox.com/37/cf/pThQXm5M_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-powershell">cd ~<span class="token operator">/</span>Downloads
<span class="token function">cp</span> mysql-connector-java-5<span class="token punctuation">.</span>1<span class="token punctuation">.</span>37<span class="token punctuation">.</span>jar  <span class="token operator">/</span>usr/local/hive/lib
</code></pre> 
<h3><a id="10HiveMySQL_477"></a>10、为Hive创建MySQL账号</h3> 
<p>启动 MySQL 服务，登录 shell：</p> 
<pre><code class="prism language-powershell">service mysql <span class="token function">start</span> <span class="token comment">#启动mysql服务</span>
sudo mysql <span class="token operator">-</span>u root <span class="token operator">-</span>p  <span class="token comment">#登陆shell界面</span>
</code></pre> 
<p>新建 hive 数据库：</p> 
<pre><code class="prism language-powershell">mysql&gt;CREATE DATABASE hive<span class="token punctuation">;</span>
</code></pre> 
<p>创建用户 hive，设置密码（这里根据配置文件设置为 hive），使其能连接上 hive 数据库：</p> 
<pre><code class="prism language-powershell">mysql&gt;create user <span class="token string">'hive'</span>@<span class="token string">'%'</span> identified by  <span class="token string">'hive'</span><span class="token punctuation">;</span>
mysql&gt;grant all privileges on hive<span class="token punctuation">.</span><span class="token operator">*</span> to <span class="token string">'hive'</span>@<span class="token string">'%'</span> with grant option<span class="token punctuation">;</span>
mysql&gt;flush privileges<span class="token punctuation">;</span>
</code></pre> 
<p>这里若提示密码不符合，则先执行以下命令，再执行上述命令：</p> 
<pre><code class="prism language-powershell">mysql&gt;<span class="token function">set</span> global validate_password<span class="token punctuation">.</span>policy=LOW<span class="token punctuation">;</span>
mysql&gt;<span class="token function">set</span> global validate_password<span class="token punctuation">.</span>length=4<span class="token punctuation">;</span>
</code></pre> 
<p>退出 MySQL：</p> 
<pre><code class="prism language-powershell">mysql&gt;quit<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="11Hive_511"></a>11、验证Hive安装及错误处理</h3> 
<h4><a id="111_Hadoop_512"></a>11.1 启动Hadoop</h4> 
<pre><code class="prism language-powershell">cd <span class="token operator">/</span>usr/local/hadoop
sbin/<span class="token function">start-dfs</span><span class="token punctuation">.</span>sh
</code></pre> 
<h4><a id="112_Hive_518"></a>11.2 启动Hive</h4> 
<pre><code class="prism language-powershell">cd <span class="token operator">/</span>usr/local/hive
<span class="token punctuation">.</span><span class="token operator">/</span>bin/schematool <span class="token operator">-</span>dbType mysql <span class="token operator">-</span>initSchema
</code></pre> 
<h4><a id="113__525"></a>11.3 错误处理</h4> 
<p>在初始化hive时，报告错误：</p> 
<pre><code class="prism language-powershell">Cannot find hadoop installation: <span class="token variable">$HADOOP_HOME</span> or <span class="token variable">$HADOOP_PREFIX</span> must be <span class="token function">set</span> or hadoop must be in the path
</code></pre> 
<p>解决办法：在命令行中执行</p> 
<pre><code class="prism language-powershell">cd <span class="token operator">/</span>usr/local/hive/conf
<span class="token function">cp</span> hive-env<span class="token punctuation">.</span>sh<span class="token punctuation">.</span>template hive-env<span class="token punctuation">.</span>sh
</code></pre> 
<pre><code class="prism language-powershell">vim hive-env<span class="token punctuation">.</span>sh
</code></pre> 
<p>在hive-env.sh文件里加下面的内容：</p> 
<pre><code class="prism language-powershell">export HADOOP_HOME=<span class="token operator">/</span>usr/local/hadoop        
</code></pre> 
<pre><code class="prism language-powershell">source hive-env<span class="token punctuation">.</span>sh
</code></pre> 
<p>再次初始化，报下面错误</p> 
<pre><code class="prism language-powershell">Exception in thread <span class="token string">"main"</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>NoSuchMethodError: com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>common<span class="token punctuation">.</span>base<span class="token punctuation">.</span>Preconditions<span class="token punctuation">.</span>checkArgument<span class="token punctuation">(</span>ZLjava/lang/String<span class="token punctuation">;</span>Ljava/lang/Object<span class="token punctuation">;</span><span class="token punctuation">)</span>V
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>Configuration<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>Configuration<span class="token punctuation">.</span>java:1357<span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>Configuration<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>Configuration<span class="token punctuation">.</span>java:1338<span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>mapred<span class="token punctuation">.</span>JobConf<span class="token punctuation">.</span>setJar<span class="token punctuation">(</span>JobConf<span class="token punctuation">.</span>java:518<span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>mapred<span class="token punctuation">.</span>JobConf<span class="token punctuation">.</span>setJarByClass<span class="token punctuation">(</span>JobConf<span class="token punctuation">.</span>java:536<span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>mapred<span class="token punctuation">.</span>JobConf<span class="token punctuation">.</span>&lt;init&gt;<span class="token punctuation">(</span>JobConf<span class="token punctuation">.</span>java:430<span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>HiveConf<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span>HiveConf<span class="token punctuation">.</span>java:5141<span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>HiveConf<span class="token punctuation">.</span>&lt;init&gt;<span class="token punctuation">(</span>HiveConf<span class="token punctuation">.</span>java:5104<span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>beeline<span class="token punctuation">.</span>HiveSchemaTool<span class="token punctuation">.</span>&lt;init&gt;<span class="token punctuation">(</span>HiveSchemaTool<span class="token punctuation">.</span>java:96<span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>beeline<span class="token punctuation">.</span>HiveSchemaTool<span class="token punctuation">.</span>main<span class="token punctuation">(</span>HiveSchemaTool<span class="token punctuation">.</span>java:1473<span class="token punctuation">)</span>
	at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>NativeMethodAccessorImpl<span class="token punctuation">.</span>invoke0<span class="token punctuation">(</span>Native Method<span class="token punctuation">)</span>
	at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>NativeMethodAccessorImpl<span class="token punctuation">.</span>invoke<span class="token punctuation">(</span>NativeMethodAccessorImpl<span class="token punctuation">.</span>java:62<span class="token punctuation">)</span>
	at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>DelegatingMethodAccessorImpl<span class="token punctuation">.</span>invoke<span class="token punctuation">(</span>DelegatingMethodAccessorImpl<span class="token punctuation">.</span>java:43<span class="token punctuation">)</span>
	at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Method<span class="token punctuation">.</span>invoke<span class="token punctuation">(</span>Method<span class="token punctuation">.</span>java:498<span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>util<span class="token punctuation">.</span>RunJar<span class="token punctuation">.</span>run<span class="token punctuation">(</span>RunJar<span class="token punctuation">.</span>java:318<span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>util<span class="token punctuation">.</span>RunJar<span class="token punctuation">.</span>main<span class="token punctuation">(</span>RunJar<span class="token punctuation">.</span>java:232<span class="token punctuation">)</span>
</code></pre> 
<p>这是因为 hive 内依赖的 guava.jar 和 hadoop 内的版本不一致造成的。</p> 
<p>查看 hadoop 安装目录下的 guava.jar 版本：</p> 
<pre><code class="prism language-powershell"><span class="token function">ls</span> <span class="token operator">/</span>usr/local/hadoop/share/hadoop/common/lib/guava*
</code></pre> 
<p>输出如下：<br> <img src="https://images2.imgbox.com/63/5e/Jo7Tw3gy_o.png" alt="在这里插入图片描述"><br> 接着查看 Hive 下的 guava.jar 版本：</p> 
<pre><code class="prism language-powershell"><span class="token function">ls</span> <span class="token operator">/</span>usr/local/hive/lib/guava*
</code></pre> 
<p>输出如下：<br> <img src="https://images2.imgbox.com/40/bc/GbFNfCm3_o.png" alt="在这里插入图片描述"><br> 可以看到 Hadoop 内的 guava.jar 版本是要高于 Hive 内带的的，所以使用 Hadoop 的替代 Hive 的：</p> 
<pre><code class="prism language-powershell">sudo <span class="token function">rm</span> <span class="token operator">/</span>usr/local/hive/lib/guava-19<span class="token punctuation">.</span>0<span class="token punctuation">.</span>jar
sudo <span class="token function">cp</span> <span class="token operator">/</span>usr/local/hadoop/share/hadoop/common/lib/guava-27<span class="token punctuation">.</span>0-jre<span class="token punctuation">.</span>jar <span class="token operator">/</span>usr/local/hive/lib
</code></pre> 
<p>再次初始化，问题解决。<br> <img src="https://images2.imgbox.com/1a/51/qJjN95tR_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8a/90/BvTlQJ3D_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="114_Hive_594"></a>11.4 再次启动Hive</h4> 
<pre><code class="prism language-powershell">cd <span class="token operator">/</span>usr/local/hive
bin/hive
</code></pre> 
<p>正常启动会出现一个交互界面如下，就证明启动成功啦：</p> 
<pre><code class="prism language-powershell">hive&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/6f/ba/QtHAhjJO_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/38f9fb94f963b980b6132836086f14c7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">HTML基础语法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fa1546d38bdba1034b2d464bdb80aba1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C&#43;&#43;学习笔记</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>