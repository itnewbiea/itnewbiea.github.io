<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python之爬贴吧 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python之爬贴吧" />
<meta property="og:description" content="eg:
#要爬取某个贴吧前100页内容
import requests
class TiebaSpider:
def init(self,name,num):
self.num=num #爬取页面数量
self.name=name #爬取贴吧名称
self.url_temp=“https://tieba.baidu.com/f?kw=&#34;&#43;self.name&#43;&#34;&amp;ie=utf-8&amp;pn={}” #打开浏览器照着写
self.headers={“Referer”:“https://tieba.baidu.com/f?kw=李毅&amp;ie=utf-8”,
“User-Agent”: “Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36”,
“Request URL”: “https: // tbmsg.baidu.com / gmessage / get?mtype = 1 &amp; _ = 1556541342355”,
“Request Method”: “GET”
}
def get_url_list(self): return [self.url_temp.format(i*50) for i in range(self.num) ] def parse_url(self,url): #获取每一个url的响应并且解析，注意这里解析是utf-8 print(url) #输出这个url,让我们看一看 response=requests.get(url,headers=self.headers) return response.content.decode() def save_html(self,html_str,page_num): file_path=&#34;{}-第{}页.html&#34;.format(self.name,page_num) with open(file_path,&#34;w&#34;,encoding=&#34;utf-8&#34;) as f: f." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/a5aaadcc77ba0a3db3996640ede86e1c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-04-30T19:51:01+08:00" />
<meta property="article:modified_time" content="2019-04-30T19:51:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python之爬贴吧</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/6f/77/44QLAxo7_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b3/e0/1ZeYLXmD_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/fd/73/ZpMxOXv5_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e4/c8/OKJ3ohWs_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f2/47/sxBZq8Ua_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e4/83/dWS0E3T2_o.png" alt="在这里插入图片描述"><br> eg:<br> #要爬取某个贴吧前100页内容<br> import requests</p> 
<p>class TiebaSpider:<br> def <strong>init</strong>(self,name,num):<br> self.num=num #爬取页面数量<br> self.name=name #爬取贴吧名称<br> self.url_temp=“<a href="https://tieba.baidu.com/f?kw=%22+self.name+%22&amp;ie=utf-8&amp;pn=%7B%7D" rel="nofollow">https://tieba.baidu.com/f?kw="+self.name+"&amp;ie=utf-8&amp;pn={}</a>” #打开浏览器照着写<br> self.headers={“Referer”:“<a href="https://tieba.baidu.com/f?kw=%E6%9D%8E%E6%AF%85&amp;ie=utf-8" rel="nofollow">https://tieba.baidu.com/f?kw=李毅&amp;ie=utf-8</a>”,<br> “User-Agent”: “Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36”,<br> “Request URL”: “https: // <a href="http://tbmsg.baidu.com" rel="nofollow">tbmsg.baidu.com</a> / gmessage / get?mtype = 1 &amp; _ = 1556541342355”,<br> “Request Method”: “GET”<br> }</p> 
<pre><code>def get_url_list(self):
    return [self.url_temp.format(i*50) for i in range(self.num) ]

def parse_url(self,url):  #获取每一个url的响应并且解析，注意这里解析是utf-8
    print(url) #输出这个url,让我们看一看
    response=requests.get(url,headers=self.headers)
    return response.content.decode()

def save_html(self,html_str,page_num):
    file_path="{}-第{}页.html".format(self.name,page_num)
    with open(file_path,"w",encoding="utf-8") as f:
        f.write(html_str)  #保存html字符串，就是网页内容

def run(self):
    #1.前100页的url列表，因为是同一个贴吧所以其url必有规律，
    # 为了代码复用，因为不同贴吧名称.url不同，所以封装个函数专门处理url
    url_list=self.get_url_list()

    #2.遍历每个url,发送请求，获取对应的响应并保存
    for url in url_list:
        html_str=self.parse_url(url)
        page_num=url_list.index(url)+1  #当前页码数
        self.save_html(html_str,page_num)
</code></pre> 
<p>if <strong>name</strong>==“<strong>main</strong>”:<br> liyi=TiebaSpider(“Liyi”,100)<br> liyi.run()</p> 
<p>补充：<br> 响应头中set-cookies 的内容是服务器在我们本地加载的cookies<br> 当爬虫被识别出时，服务器可能给你一些无用内容<br> 把请求头中键值对抄到header中，发动请求<br> 在url中参数有一些 %开头，是经过编码后的结果，可以在线查询对应内容<br> 以后用面向对象思维去写，上来class,内置run方法，运行这个类，在这个方法内写入运行该类步骤思想</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/950920a548ead07e92b28d0e1a774231/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">GetForegroundWindow获取的是托管进程ApplicationFrameHost，而不是真正的进程，比如XD软件...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7cfe1270f240edc402d554502136ca5e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">五款中文分词工具在线PK: Jieba, SnowNLP, PkuSeg, THULAC, HanLP</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>