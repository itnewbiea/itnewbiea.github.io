<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mybatis中返回对象包含其他对象情况 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mybatis中返回对象包含其他对象情况" />
<meta property="og:description" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt; &lt;!DOCTYPE mapper PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34; &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt; &lt;mapper namespace=&#34;com.xxx.server.mapper.AdminMapper&#34;&gt; &lt;!-- 通用查询映射结果 --&gt; &lt;resultMap id=&#34;BaseResultMap&#34; type=&#34;com.xxx.server.pojo.Admin&#34;&gt; &lt;!-- --&gt; &lt;id column=&#34;id&#34; property=&#34;id&#34;/&gt; &lt;result column=&#34;name&#34; property=&#34;name&#34;/&gt; &lt;result column=&#34;phone&#34; property=&#34;phone&#34;/&gt; &lt;result column=&#34;telephone&#34; property=&#34;telephone&#34;/&gt; &lt;result column=&#34;address&#34; property=&#34;address&#34;/&gt; &lt;result column=&#34;enabled&#34; property=&#34;enabled&#34;/&gt; &lt;result column=&#34;username&#34; property=&#34;username&#34;/&gt; &lt;result column=&#34;password&#34; property=&#34;password&#34;/&gt; &lt;result column=&#34;user_face&#34; property=&#34;userFace&#34;/&gt; &lt;result column=&#34;remark&#34; property=&#34;remark&#34;/&gt; &lt;/resultMap&gt; &lt;resultMap id=&#34;AdminWithRole&#34; type=&#34;com.xxx.server.pojo.Admin&#34; extends=&#34;BaseResultMap&#34;&gt; &lt;collection property=&#34;roles&#34; ofType=&#34;com.xxx.server.pojo.Role&#34;&gt; &lt;id column=&#34;rid&#34; property=&#34;id&#34;/&gt; &lt;result column=&#34;rname&#34; property=&#34;name&#34;/&gt; &lt;result column=&#34;rnameZh&#34; property=&#34;nameZh&#34;/&gt; &lt;/collection&gt; &lt;/resultMap&gt; &lt;!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/ff98386ba52fc1dfff9ea1952025dafa/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-11T11:20:05+08:00" />
<meta property="article:modified_time" content="2022-08-11T11:20:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mybatis中返回对象包含其他对象情况</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;
&lt;mapper namespace="com.xxx.server.mapper.AdminMapper"&gt;

    &lt;!-- 通用查询映射结果 --&gt;
    &lt;resultMap id="BaseResultMap" type="com.xxx.server.pojo.Admin"&gt;
        &lt;!--  --&gt;
        &lt;id column="id" property="id"/&gt;
        &lt;result column="name" property="name"/&gt;
        &lt;result column="phone" property="phone"/&gt;
        &lt;result column="telephone" property="telephone"/&gt;
        &lt;result column="address" property="address"/&gt;
        &lt;result column="enabled" property="enabled"/&gt;
        &lt;result column="username" property="username"/&gt;
        &lt;result column="password" property="password"/&gt;
        &lt;result column="user_face" property="userFace"/&gt;
        &lt;result column="remark" property="remark"/&gt;
    &lt;/resultMap&gt;

    &lt;resultMap id="AdminWithRole" type="com.xxx.server.pojo.Admin" extends="BaseResultMap"&gt;
        &lt;collection property="roles" ofType="com.xxx.server.pojo.Role"&gt;
            &lt;id column="rid" property="id"/&gt;
            &lt;result column="rname" property="name"/&gt;
            &lt;result column="rnameZh" property="nameZh"/&gt;
        &lt;/collection&gt;
    &lt;/resultMap&gt;

    &lt;!-- 获取所有操作员 --&gt;
    &lt;select id="getAllAdmins" resultMap="AdminWithRole"&gt;
        SELECT
        a.*,
        r.id AS rid,
        r.name AS rname,
        r.name_zh AS rnameZh
        FROM
        t_admin a
        LEFT JOIN
        t_admin_role ar ON a.id = ar.`admin_id`
        LEFT JOIN
        t_role r ON r.id = ar.`rid`
        WHERE
        a.id !=#{id}
        &lt;!-- 不传关键字 查所有 --&gt;
        &lt;if test="null!=keywords and ''!=keywords"&gt;
            AND a.`name` LIKE CONCAT('%',#{keywords}, '%')
        &lt;/if&gt;
        ORDER BY
        a.id
    &lt;/select&gt;
&lt;/mapper&gt;
</code></pre> 
<p>返回的对象</p> 
<pre><code>package com.xxx.server.pojo;

import com.baomidou.mybatisplus.annotation.TableField;
import com.baomidou.mybatisplus.annotation.TableName;
import com.baomidou.mybatisplus.annotation.IdType;
import com.baomidou.mybatisplus.annotation.TableId;

import java.io.Serializable;
import java.util.Collection;
import java.util.List;
import java.util.stream.Collectors;

import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import com.xxx.server.config.CustomAuthorityDeserialize;
import io.swagger.annotations.ApiModel;
import io.swagger.annotations.ApiModelProperty;
import lombok.AccessLevel;
import lombok.Data;
import lombok.EqualsAndHashCode;
import lombok.Getter;
import lombok.experimental.Accessors;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.UserDetails;

/**
 * &lt;p&gt;
 * 管理员表
 * &lt;/p&gt;
 *
 * @author Bing
 * @since 2021-01-13
 */
@Data
@EqualsAndHashCode(callSuper = false)
@Accessors(chain = true)
@TableName("t_admin")
@ApiModel(value = "Admin对象", description = "管理员表")
public class Admin implements Serializable, UserDetails {

    private static final long serialVersionUID = 1L;

    @ApiModelProperty(value = "id")
    @TableId(value = "id", type = IdType.AUTO)
    private Integer id;

    @ApiModelProperty(value = "姓名")
    private String name;

    @ApiModelProperty(value = "手机号码")
    private String phone;

    @ApiModelProperty(value = "住宅电话")
    private String telephone;

    @ApiModelProperty(value = "联系地址")
    private String address;

    @ApiModelProperty(value = "是否启用")
    @Getter(AccessLevel.NONE) // 不需要生成 get 方法，防止与 UserDetails 重写的 isEnabled 冲突
    private Boolean enabled;

    @ApiModelProperty(value = "用户名")
    private String username;

    @ApiModelProperty(value = "密码")
    private String password;

    @ApiModelProperty(value = "用户头像")
    private String userFace;

    @ApiModelProperty(value = "备注")
    private String remark;

    @ApiModelProperty(value = "角色")
    @TableField(exist = false)
    private List&lt;Role&gt; roles;

    /**
     * 获取权限列表
     * role.getName() 权限名字
     * 角色里面对应的名字，把它转成 SimpleGrantedAuthority 返回
     * @return
     */
    @Override
    @JsonDeserialize(using = CustomAuthorityDeserialize.class)
    public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() {
        List&lt;SimpleGrantedAuthority&gt; authorities = roles
                .stream()
                .map(role -&gt; new SimpleGrantedAuthority(role.getName()))
                .collect(Collectors.toList());
        return authorities;
    }

    @Override
    public boolean isAccountNonExpired() {
        return true;
    }

    @Override
    public boolean isAccountNonLocked() {
        return true;
    }

    @Override
    public boolean isCredentialsNonExpired() {
        return true;
    }

    @Override
    public boolean isEnabled() {
        return this.enabled;
    }
}
</code></pre> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/32ae2503b0375ec48de254562056f9b3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Kubernetes（k8s）安全机制</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fbee8977d8ff8c6925de7d4e58eb2d25/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Print.js javascript库 实现页面打印</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>