<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>pyflink 读取kafka - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="pyflink 读取kafka" />
<meta property="og:description" content="# -*- coding: utf-8 -*-
from pyflink.datastream import StreamExecutionEnvironment
from pyflink.datastream.functions import MapFunction, RuntimeContext, KeyedProcessFunction
from abc import ABC, abstractmethod
from pyflink.datastream import StreamExecutionEnvironment
from pyflink.datastream.functions import MapFunction, RuntimeContext, KeyedProcessFunction
from pyflink.datastream.state import MapStateDescriptor
from pyflink.datastream.connectors.kafka import FlinkKafkaConsumer
from pyflink.common.typeinfo import Types, TypeInformation
from pyflink.datastream.connectors.elasticsearch import Elasticsearch7SinkBuilder, ElasticsearchEmitter, FlushBackoffType
from pyflink.datastream.connectors import DeliveryGuarantee
from pyflink.common.serialization import SimpleStringSchema
import json
import re
from datetime import datetime
from elasticsearch import Elasticsearch" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/96ee89c481827589695d8d0737aaf97e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-12T14:34:09+08:00" />
<meta property="article:modified_time" content="2023-06-12T14:34:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">pyflink 读取kafka</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p># -*- coding: utf-8 -*-<br> from pyflink.datastream import StreamExecutionEnvironment<br> from pyflink.datastream.functions import  MapFunction, RuntimeContext, KeyedProcessFunction<br> from abc import ABC, abstractmethod<br> from pyflink.datastream import StreamExecutionEnvironment<br> from pyflink.datastream.functions import  MapFunction, RuntimeContext, KeyedProcessFunction<br> from pyflink.datastream.state import MapStateDescriptor<br> from pyflink.datastream.connectors.kafka import FlinkKafkaConsumer<br> from pyflink.common.typeinfo import Types, TypeInformation<br> from pyflink.datastream.connectors.elasticsearch import Elasticsearch7SinkBuilder, ElasticsearchEmitter, FlushBackoffType<br> from pyflink.datastream.connectors import DeliveryGuarantee<br> from pyflink.common.serialization import SimpleStringSchema<br> import json<br> import re<br> from datetime import datetime<br> from elasticsearch import Elasticsearch<br> from pyflink.datastream.functions import RuntimeContext, FlatMapFunction<br> from pyflink.common.typeinfo import Types<br> from pyflink.datastream import StreamExecutionEnvironment<br> from pyflink.datastream.connectors.kafka import FlinkKafkaConsumer<br> from pyflink.common.serialization import SimpleStringSchema</p> 
<p><br> import re<br> import redis</p> 
<p><br> # 创建 StreamExecutionEnvironment 对象<br> env = StreamExecutionEnvironment.get_execution_environment()<br> env.add_jars("file:///root/flink-sql-connector-kafka_2.11-1.14.4.jar")</p> 
<p>TEST_KAFKA_SERVERS = "127.0.0.1:9092"<br> TEST_KAFKA_TOPIC = "topic_elink"<br> TEST_GROUP_ID = "pyflink_group"<br> def get_kafka_customer_properties(kafka_servers: str, group_id: str):<br>     properties = {<!-- --><br>         "bootstrap.servers": kafka_servers,<br>         "fetch.max.bytes": "67108864",<br>         "key.deserializer": "org.apache.kafka.common.serialization.StringDeserializer",<br>         "value.deserializer": "org.apache.kafka.common.serialization.StringDeserializer",<br>         "enable.auto.commit": "false",  # 关闭kafka 自动提交，此处不能传bool 类型会报错<br>         "group.id": group_id,<br>     }<br>     return properties<br> properties = get_kafka_customer_properties(TEST_KAFKA_SERVERS, TEST_GROUP_ID)</p> 
<p><br> data_stream = env.add_source(<br>         FlinkKafkaConsumer(topics='topic_elink',<br>                            properties=properties,<br>                            deserialization_schema=SimpleStringSchema()) \<br>             .set_commit_offsets_on_checkpoints(True) \<br>             .set_start_from_latest()<br>     ).name(f"消费{TEST_KAFKA_TOPIC}主题数据")</p> 
<p>data_stream.print()<br> env.set_parallelism(1)</p> 
<p># 执行任务<br> env.execute('Add "bus_seq" to each line')</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/68c5a0a75c55c99799b4b744a1e7c88d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">docker安装nacos2.2.0并配置持久化</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/79a4a2e70586e175dcd835beb5e6623e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">人工智能实战项目(python)&#43;多领域实战练手项目</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>