<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python真就无所不能？居然还能开发APP软件。 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python真就无所不能？居然还能开发APP软件。" />
<meta property="og:description" content="前言 Python是脚本语言，可以说它是万能的，只有你想不到，没有它做不到！虽然用它来开发app还是显得有点不对路，但用Python开发的app应当是作为编码练习、自娱自乐所用，加上目前这方面的模块还不是特别成熟，bug比较多，总而言之，大家如果真有需求建议使用Java会好一点！
准备工作 利用Python开发app需要用到Python的一个模块–kivy，kivy是一个开源的，跨平台的Python开发框架，用于开发使用创新的应用程序。简而言之，这是一个Python桌面程序开发框架（类似wxpython等模块），强大的是kivy支持linux、mac、windows、android、ios平台，这也是为什么开发app需要用到这个模块。
虽然kivy是跨平台的，但是想要在不同的平台使用Python代码，还需要将Python代码打包成对应平台的可执行程序，好在kivy项目下有个打包工具项目–buildozer，这是官方推荐的打包工具，因为相对比较简单，自动化程度高，其他项目比如：Python-for-android也能起到类似的作用，这里不展开介绍。
搭建kivy开发环境 需要在pc上安装kivy开发环境，这里演示下mac与linux下的安装过程。
install kivy for mac 安装一些依赖包：
brew install pkg-config sdl2 sdl2_image sdl2_ttf sdl2_mixer gstreamer 安装cython以及kivy：
pip install cython==0.25 pip install kivy 如果安装kivy报错，则使用下面的方式安装kivy：
git clone https://github.com/kivy/kivy python setup.py install 安装后测试：
$python Python 2.7.10 (default, Jul 15 2017, 17:16:57) [GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.31)] on darwin Type &#34;help&#34;, &#34;copyright&#34;, &#34;credits&#34; or &#34;license&#34; for more information. &gt;&gt;&gt; &gt;&gt;&gt; import kivy [INFO ] [Logger ] Record log in /Users/didi/." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/f9825fb556a4c0437d038ae64db5a824/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-19T17:47:39+08:00" />
<meta property="article:modified_time" content="2023-04-19T17:47:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python真就无所不能？居然还能开发APP软件。</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>       前言</h2> 
<p>       Python是脚本语言，可以说它是万能的，只有你想不到，没有它做不到！虽然用它来开发app还是显得有点不对路，但用Python开发的app应当是作为编码练习、自娱自乐所用，加上目前这方面的模块还不是特别成熟，bug比较多，总而言之，大家如果真有需求建议使用Java会好一点！</p> 
<p class="img-center"><img alt="" height="504" src="https://images2.imgbox.com/27/a9/6hKbG6c0_o.png" width="500"></p> 
<p> </p> 
<h3><strong>准备工作</strong></h3> 
<p>利用Python开发app需要用到Python的一个模块–kivy，kivy是一个开源的，跨平台的Python开发框架，用于开发使用创新的应用程序。简而言之，这是一个Python桌面程序开发框架（类似wxpython等模块），强大的是kivy支持linux、mac、windows、android、ios平台，这也是为什么开发app需要用到这个模块。</p> 
<p>虽然kivy是跨平台的，但是想要在不同的平台使用Python代码，还需要将Python代码打包成对应平台的可执行程序，好在kivy项目下有个打包工具项目–buildozer，这是官方推荐的打包工具，因为相对比较简单，自动化程度高，其他项目比如：Python-for-android也能起到类似的作用，这里不展开介绍。</p> 
<h3><strong>搭建kivy开发环境</strong></h3> 
<p>需要在pc上安装kivy开发环境，这里演示下mac与linux下的安装过程。</p> 
<pre><strong>install kivy for mac</strong>
</pre> 
<p>安装一些依赖包：</p> 
<pre><code>brew install pkg-config sdl2 sdl2_image sdl2_ttf sdl2_mixer gstreamer</code></pre> 
<p>安装cython以及kivy：</p> 
<pre><code>pip install cython==0.25
pip install kivy</code></pre> 
<p> </p> 
<p>如果安装kivy报错，则使用下面的方式安装kivy：</p> 
<pre><code>git clone https://github.com/kivy/kivy
python setup.py install
</code></pre> 
<p>安装后测试：</p> 
<pre><code>$python
Python 2.7.10 (default, Jul 15 2017, 17:16:57)
[GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.31)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt;
&gt;&gt;&gt; import kivy
[INFO   ] [Logger      ] Record log in /Users/didi/.kivy/logs/kivy_18-05-08_4.txt
[INFO   ] [Kivy        ] v1.10.1.dev0, git-5f6c66e, 20180507
[INFO   ] [Python      ] v2.7.10 (default, Jul 15 2017, 17:16:57)
[GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.31)]
</code></pre> 
<p>说明：导入kivy模块没有报错则说明安装成功。</p> 
<pre><strong>install kivy for centos7</strong>
</pre> 
<p>先安装依赖：</p> 
<pre><code>yum install \
make \
mercurial \
automake \
gcc \
gcc-c++ \
SDL_ttf-devel \
SDL_mixer-devel \
khrplatform-devel \
mesa-libGLES \
mesa-libGLES-devel \
gstreamer-plugins-good \
gstreamer \
gstreamer-python \
mtdev-devel \
python-devel \
python-pip \
java-devel
</code></pre> 
<p>安装cython以及kivy:</p> 
<pre><code>pip install Cython==0.20
pip install kivy
</code></pre> 
<p>centos安装kivy参考：由于文章审核，外站链接咱就不带了！</p> 
<h3><strong>用kivy开发第一个Python app</strong></h3> 
<p>安装完kivy就可以开发app程序了，这里演示下hello-world程序，关于kivy更复杂的用法不是本文重点，后面再成文介绍。</p> 
<p><strong>创建一个main.py文件，写入：</strong></p> 
<pre><code>#! -*- coding:utf-8 -*-
from kivy.app import App
class HelloApp(App):
pass
if __name__ == '__main__':
HelloApp().run()
</code></pre> 
<p><strong>创建一个hello.kv文件，写入：</strong></p> 
<pre><code>Label:
text: 'Hello, World! I am nMask'
</code></pre> 
<p>简单说明：main.py是入口函数，定义了一个HelloApp类，该类继承kivy.app；hello.kv文件是kivy程序，相当于定义界面风格等，该文件命名规则为类名小写且去除app。</p> 
<h3><strong>运行第一个Python app</strong></h3> 
<pre><code>python main.py
</code></pre> 
<p>运行结果：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/94/0b/96SdrEt0_o.jpg"></p> 
<h3><strong>安装buildozer工具</strong></h3> 
<p>通过以上的编码，我创建了自己的第一个python app程序，该程序可以直接在mac、linux、windows平台下运行，那么如何让它在安卓或者苹果手机上运行呢？我们知道在安卓上运行，需要将其打包成apk安装程序，因此就需要用到前面提到过的buildozer工具，（buildozer工具可以打包kivy程序，支持android、ios等），buildozer的安装过程比较简单：</p> 
<pre><code>pip install buildozer
</code></pre> 
<h3><strong>使用buildozer工具将kivy程序打包成apk</strong></h3> 
<p>在python项目目录下运行：</p> 
<pre><code>buildozer init
</code></pre> 
<p>运行成功将会创建一个配置文件buildozer.spec，可以通过修改配置文件更改app的名称等，然后运行：</p> 
<pre><code>buildozer android debug deploy run
</code></pre> 
<p>运行以上命令将会生成跨平台的安装包，可适用安卓、ios等，如果用于安卓，则是利用python-for-android项目。</p> 
<p>在第一次运行以上命令的时候，会自动在系统中下载安卓sdk等必要文件，如下图。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/c2/f7/syHiRkC6_o.png"></p> 
<p>说明：这里只演示打包成apk文件，iso平台的可自行研究，参考文档：https://github.com/kivy/buildozer。</p> 
<h3><strong>python apk程序测试</strong></h3> 
<p>如果以上步骤都运行成功的话，应该会在项目目录下的bin目录下生成一个apk文件，类似如下：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/de/0f/roWg1JGz_o.jpg"></p> 
<p>然后将apk下载到安卓系统的手机上，安装即可，测试效果如下：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/37/a0/1068AwWJ_o.jpg"></p> 
<p>打开app</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/bf/2f/1crOczwS_o.jpg"></p> 
<h3><strong>buildozer使用说明</strong></h3> 
<pre><code>Usage:
buildozer [--profile &lt;name&gt;] [--verbose] [target] &lt;command&gt;...
buildozer --version
Available targets:
android        Android target, based on python-for-android project
ios            iOS target, based on kivy-ios project
android_old    Android target, based on python-for-android project (old toolchain)
Global commands (without target):
distclean          Clean the whole Buildozer environment.
help               Show the Buildozer help.
init               Create a initial buildozer.spec in the current directory
serve              Serve the bin directory via SimpleHTTPServer
setdefault         Set the default command to run when no arguments are given
version            Show the Buildozer version
Target commands:
clean      Clean the target environment
update     Update the target dependencies
debug      Build the application in debug mode
release    Build the application in release mode
deploy     Deploy the application on the device
run        Run the application on the device
serve      Serve the bin directory via SimpleHTTPServer
Target "android_old" commands:
adb                Run adb from the Android SDK. Args must come after --, or
use --alias to make an alias
logcat             Show the log from the device
Target "ios" commands:
list_identities    List the available identities to use for signing.
xcode              Open the xcode project.
Target "android" commands:
adb                Run adb from the Android SDK. Args must come after --, or
use --alias to make an alias
logcat             Show the log from the device
p4a                Run p4a commands. Args must come after --, or use --alias
to make an alias
</code></pre> 
<h3><strong>buildozer打包过程中的坑点</strong></h3> 
<p>如果在打包过程中遇到报错，可以修改buildozer.spec配置文件中的log_level为2，然后重新运行，可以看具体的错误信息。</p> 
<p><strong>报错：You might have missed to install 32bits libs</strong></p> 
<p>这个错是我在centos7上运行时报的错，大意是系统缺少了某些32位的依赖文件。</p> 
<p>解决方案：</p> 
<pre><code>yum -y install --skip-broken glibc.i686 arts.i686 audiofile.i686 bzip2-libs.i686 cairo.i686 cyrus-s</code></pre> 
<p> </p> 
<p><strong>报错：Error compiling Cython file</strong></p> 
<p>错误大意为cython文件出错，可能是cython模块没有安装，或者版本有问题。解决方案：</p> 
<pre><code>pip install cython==0.25
</code></pre> 
<p>报错：IOError: [Errno 2] No such file or directory….. 这是在打包的最后一步，将apk文件copy到项目bin目录下时报的错，是buildozer的一个bug。</p> 
<p>解决方案：</p> 
<p>修改/usr/local/lib/python2.7/dist-packages/buildozer/tagets/android.py文件：</p> 
<p><strong>在文件开头导入:</strong></p> 
<p>from distutils.version import LooseVersion</p> 
<p><strong>将786行:XXX found how the apk name is really built from the title这一行以下的代码替换为：</strong></p> 
<pre><code>__sdk_dir = self.android_sdk_dir
build_tools_versions = os.listdir(join(__sdk_dir, 'build-tools'))
build_tools_versions = sorted(build_tools_versions, key=LooseVersion)
build_tools_version = build_tools_versions[-1]
gradle_files = ["build.gradle", "gradle", "gradlew"]
is_gradle_build = any((exists(join(dist_dir, x)) for x in gradle_files)) and build_tools_version &gt;= ’25.0'
</code></pre> 
<h3><strong>buildozer虚拟机</strong></h3> 
<p>kivy官方推出了一个buildozer虚拟机镜像，已经安装好了buildozer以及一些依赖文件，为buildozer打包测试提供平台。由于之前我在mac上利用buildozer打包一直报错，后来换成centos也依然没有成功，因此便下载了此虚拟机，测试效果如下：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/ec/10/mZpcKzsX_o.jpg"></p> 
<p>需要虚拟机下载的可以文末找我！</p> 
<p>说明：对于无法解决依赖问题的朋友，可以使用此虚拟机进行程序打包，开发环境还是推荐用自己的本机。</p> 
<h3><strong>kivy开发实例</strong></h3> 
<p>因为本文重点在于介绍如何利用kivy+buildozer开发一款python app，因此对于kivy的开发过程，以及app功能进行了最简化。</p> 
<p>到这里就结束了，你觉得Python适合用来开发app吗？</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5b7ead3c808a13fcfca6c5844ce87388/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Jtti：小程序使用webview内嵌h5页面wx.miniProgram.getEnv失效怎么解决</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d093ccc7222f9f8896f9550c297bfaff/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Unity URP渲染管线下设置灯光数量上限_灯光不显示问题案例分享】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>