<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>项目配置Babel - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="项目配置Babel" />
<meta property="og:description" content="当前@babel/core最新版本是：7.20.12
当前@babel/preset-env最新版本是：7.20.2
我们知道：core-js是一种polyfill，它提供了旧版本浏览器缺失的所有的ES6&#43; API的方法与实现。
在这里，以及下文，我们把通过引入core-js的某个模块，来实现旧版本浏览器不支持的某个ES6&#43; API的过程，叫做垫平。
我们看看core-js这个包里面的主要一些模块：
pic_5.png
es：里面只包含有稳定的ES功能。
proposals：里面包含所有stage阶段的API
stable：它里面包含了，只有稳定的ES功能跟网络标准
所以，我们可以这么使用：
当我们只需要垫平某个稳定的ES6&#43; API，我们可以用es这个文件夹里的polyfill来垫平 （import X from &#39;es/xx&#39;）
当我们需要用到提案阶段的API时，我就用proposals这个文件夹里的polyfill来垫平（import X from &#39;proposals/xx&#39;）
当我们想垫平所有稳定版本的ES6&#43; API，可以导入用stable文件夹（import &#39;core-js/stable&#39;）
当我们想垫平所有的ES6&#43; API（包括提案阶段），可以直接import &#39;core-js&#39;
Babel大体由两个功能组成：
编译ES6&#43;最新语法（let、class、() =&gt; {}等）
实现旧版本浏览器不支持的ES6&#43;的API（Promise、Symbol、Array.prototype.includes等）
@babel/preset-env有以下两个功能：
它只编译ES6&#43;语法
它并不提供polyfill，但是可以通过配置我们代码运行的目标环境，从而控制polyfill的导入跟语法编译，使ES6&#43;的新特性可以在我们想要的目标环境中顺利运行
@babel/plugin-transform-runtime也有以下两个功能：
@babel/runtime跟@babel/plugin-transform-runtime两者配合，可以减少打包体积
也有一个配置功能，用来处理polyfill如何垫平
如果我们想要在旧浏览器用到ES6&#43; API时，我们应该安装3版本的core-js（或者后续更高版本的）；
那我们可以很清楚的知道：
实现Babel第一个功能：我们用@babel/preset-env就可以了
实现Babel第二个功能：我们就需要用core-js这个包来提供polyfill，并与@babel/preset-env或者@babel/plugin-transform-runtime的配置功能相互配合使用
我们先来看看@babel/preset-env的配置项有哪些：
// babel.config.js const presets = [ [ &#39;@babel/preset-env&#39;, { modules, targets, corejs, useBuiltIns, spec, loose, debug, bugfixes, include, exclude, forceAllTransforms, configPath, ignoreBrowserslistConfig, browserslistEnv, shippedProposals } ] ]; module." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/92841c32973ca09e7d6b83d3563ffc0f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-03T11:36:02+08:00" />
<meta property="article:modified_time" content="2023-03-03T11:36:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">项目配置Babel</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>当前<span class="kdocs-fontSize" style="font-size:9pt;">@babel/core</span>最新版本是：<span class="kdocs-fontSize" style="font-size:9pt;">7.20.12</span></p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>当前<span class="kdocs-fontSize" style="font-size:9pt;">@babel/preset-env</span>最新版本是：<span class="kdocs-fontSize" style="font-size:9pt;">7.20.2</span></p></li></ul> 
 <p style="text-align:left;">我们知道：<span class="kdocs-fontSize" style="font-size:9pt;">core-js</span>是一种<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>，它提供了旧版本浏览器缺失的<span class="kdocs-bold" style="font-weight:bold;">所有</span>的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>的方法与实现。</p> 
 <p style="text-align:left;">在这里，以及下文，我们把通过引入<span class="kdocs-fontSize" style="font-size:9pt;">core-js</span>的<span class="kdocs-bold" style="font-weight:bold;">某个模块</span>，来实现旧版本浏览器不支持的<span class="kdocs-bold" style="font-weight:bold;">某个</span><span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>的过程，叫做垫平。</p> 
 <p style="text-align:left;">我们看看<span class="kdocs-fontSize" style="font-size:9pt;">core-js</span>这个包里面的主要一些模块：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:244px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:143.44263%;height:0;"> 
    <img src="https://images2.imgbox.com/b9/e7/jH2Istem_o.jpg" style="margin-left:;display:block;width:244px;margin-top:-143.44263%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:center;"><span class="kdocs-fontSize" style="font-size:9pt;">pic_5.png</span></p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">es</span>：里面只包含有稳定的<span class="kdocs-fontSize" style="font-size:9pt;">ES</span>功能。</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">proposals</span>：里面包含所有<span class="kdocs-fontSize" style="font-size:9pt;">stage</span>阶段的<span class="kdocs-fontSize" style="font-size:9pt;">API</span></p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">stable</span>：它里面包含了，只有稳定的<span class="kdocs-fontSize" style="font-size:9pt;">ES</span>功能跟网络标准</p></li></ul> 
 <p style="text-align:left;">所以，我们可以这么使用：</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>当我们只需要垫平<span class="kdocs-bold" style="font-weight:bold;">某个</span>稳定的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>，我们可以用<span class="kdocs-fontSize" style="font-size:9pt;">es</span>这个文件夹里的<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>来垫平 （<span class="kdocs-fontSize" style="font-size:9pt;">import X from 'es/xx'</span>）</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>当我们需要用到<span class="kdocs-bold" style="font-weight:bold;">提案阶段</span>的<span class="kdocs-fontSize" style="font-size:9pt;">API</span>时，我就用<span class="kdocs-fontSize" style="font-size:9pt;">proposals</span>这个文件夹里的<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>来垫平（<span class="kdocs-fontSize" style="font-size:9pt;">import X from 'proposals/xx'</span>）</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>当我们想垫平<span class="kdocs-bold" style="font-weight:bold;">所有稳定版本</span>的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>，可以导入用<span class="kdocs-fontSize" style="font-size:9pt;">stable</span>文件夹（<span class="kdocs-fontSize" style="font-size:9pt;">import 'core-js/stable'</span>）</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>当我们想垫平<span class="kdocs-bold" style="font-weight:bold;">所有</span>的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>（包括提案阶段），可以直接<span class="kdocs-fontSize" style="font-size:9pt;">import 'core-js'</span></p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">Babel</span>大体由两个功能组成：</p></li></ul> 
 <ol start="1"><li style="margin-left:2.8em;list-style-type:lower-alpha;text-indent:0;"><p>编译<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span>最新语法（<span class="kdocs-fontSize" style="font-size:9pt;">let</span>、<span class="kdocs-fontSize" style="font-size:9pt;">class</span>、<span class="kdocs-fontSize" style="font-size:9pt;">() =&gt; {}</span>等）</p></li></ol> 
 <ol start="2"><li style="margin-left:2.8em;list-style-type:lower-alpha;text-indent:0;"><p>实现旧版本浏览器不支持的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span>的<span class="kdocs-fontSize" style="font-size:9pt;">API</span>（<span class="kdocs-fontSize" style="font-size:9pt;">Promise</span>、<span class="kdocs-fontSize" style="font-size:9pt;">Symbol</span>、<span class="kdocs-fontSize" style="font-size:9pt;">Array.prototype.includes</span>等）</p></li></ol> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">@babel/preset-env</span>有以下两个功能：</p></li></ul> 
 <ol start="3"><li style="margin-left:2.8em;list-style-type:lower-alpha;text-indent:0;"><p>它<span class="kdocs-bold" style="font-weight:bold;">只编译</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">ES6+</span></span><span class="kdocs-bold" style="font-weight:bold;">语法</span></p></li></ol> 
 <ol start="4"><li style="margin-left:2.8em;list-style-type:lower-alpha;text-indent:0;"><p>它并不提供<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>，但是可以通过<span class="kdocs-bold" style="font-weight:bold;">配置</span>我们代码运行的<span class="kdocs-bold" style="font-weight:bold;">目标环境</span>，从而控制<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>的导入跟语法编译，使<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span>的新特性可以在我们想要的<span class="kdocs-bold" style="font-weight:bold;">目标环境</span>中顺利运行</p></li></ol> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">@babel/plugin-transform-runtime</span>也有以下两个功能：</p></li></ul> 
 <ol start="5"><li style="margin-left:2.8em;list-style-type:lower-alpha;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">@babel/runtime</span>跟<span class="kdocs-fontSize" style="font-size:9pt;">@babel/plugin-transform-runtime</span>两者配合，可以减少打包体积</p></li></ol> 
 <ol start="6"><li style="margin-left:2.8em;list-style-type:lower-alpha;text-indent:0;"><p>也有一个配置功能，用来处理<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>如何垫平</p></li></ol> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>如果我们想要在旧浏览器用到<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>时，我们应该安装<span class="kdocs-fontSize" style="font-size:9pt;">3</span>版本的<span class="kdocs-fontSize" style="font-size:9pt;">core-js</span>（或者后续更高版本的）；</p></li></ul> 
 <p style="text-align:left;">那我们可以很清楚的知道：</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>实现<span class="kdocs-fontSize" style="font-size:9pt;">Babel</span>第一个功能：我们用<span class="kdocs-fontSize" style="font-size:9pt;">@babel/preset-env</span>就可以了</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>实现<span class="kdocs-fontSize" style="font-size:9pt;">Babel</span>第二个功能：我们就需要用<span class="kdocs-fontSize" style="font-size:9pt;">core-js</span>这个包来提供<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>，并与<span class="kdocs-fontSize" style="font-size:9pt;">@babel/preset-env</span>或者<span class="kdocs-fontSize" style="font-size:9pt;">@babel/plugin-transform-runtime</span>的配置功能相互配合使用</p></li></ul> 
 <p style="text-align:left;">我们先来看看<span class="kdocs-fontSize" style="font-size:9pt;">@babel/preset-env</span>的配置项有哪些：</p> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">// babel.config.js
const presets = [
    [
        '@babel/preset-env',
        {
            modules,
            targets,
            corejs,
            useBuiltIns,
            
            spec,
            loose,
            debug,
            bugfixes,
            include,
            exclude,
            forceAllTransforms,
            configPath,
            ignoreBrowserslistConfig,
            browserslistEnv,
            shippedProposals
        }
    ]
];
module.exports = {presets};</code></pre> 
 <p style="text-align:left;">我们可以看到配置项还是蛮多的（有一些配置项，后期可能会废弃），但是，其实我们平时项目中主要用到前四个配置，所以在这里我们重点来看看前四个配置。</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">modules</span></h3> 
 <hr> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>功能：启用<span class="kdocs-fontSize" style="font-size:9pt;">ES</span>模块语法向另一种模块类型的转换</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>默认值：<span class="kdocs-fontSize" style="font-size:9pt;">auto</span></p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>可取的值：<span class="kdocs-fontSize" style="font-size:9pt;">"amd" | "umd" | "systemjs" | "commonjs" | "cjs" | "auto" | false</span></p></li></ul> 
 <p style="text-align:left;">当我们设置成<span class="kdocs-fontSize" style="font-size:9pt;">false</span>的时候，<span class="kdocs-fontSize" style="font-size:9pt;">Babel</span>编译产生的一些辅助函数的引入方式会变成<span class="kdocs-fontSize" style="font-size:9pt;">ES6</span>的模式引入（<span class="kdocs-fontSize" style="font-size:9pt;">import A from 'B'</span>）。</p> 
 <p style="text-align:left;">我们把 <span class="kdocs-bold" style="font-weight:bold;">use-transform-runtime[6]</span> 这个案例<span class="kdocs-fontSize" style="font-size:9pt;">Babel</span>配置改成以下配置，感受一下<span class="kdocs-fontSize" style="font-size:9pt;">modules</span>这个配置的功能。</p> 
 <p style=""></p> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">// babel.config.js

const plugins = [
    '@babel/plugin-transform-runtime'
]

const presets = [
    [
        '@babel/preset-env',
        {
            modules: false
        }
    ]
];

module.exports = {plugins, presets};</code></pre> 
 <p style="text-align:left;">在<span class="kdocs-bold" style="font-weight:bold;">没设置</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">modules</span></span><span class="kdocs-bold" style="font-weight:bold;">配置项</span>时，编译后的文件是：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:921px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:27.361565%;height:0;"> 
    <img src="https://images2.imgbox.com/44/94/7q2IB7DI_o.png" style="margin-left:;display:block;width:921px;margin-top:-27.361565%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">我们会发现辅助函数都是以<span class="kdocs-fontSize" style="font-size:9pt;">require</span>的方式引入的；</p> 
 <p style="text-align:left;">在<span class="kdocs-bold" style="font-weight:bold;">设置了</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">modules</span></span><span class="kdocs-bold" style="font-weight:bold;">配置项</span>后，编译后的文件是：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:632px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:29.430378%;height:0;"> 
    <img src="https://images2.imgbox.com/d8/9d/UDRYT6zk_o.png" style="margin-left:;display:block;width:632px;margin-top:-29.430378%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">我们会发现辅助函数变成了我们熟悉的<span class="kdocs-fontSize" style="font-size:9pt;">ES6</span>模块方式<span class="kdocs-fontSize" style="font-size:9pt;">import</span>引入。</p> 
 <p style="text-align:left;">这样有一个好处，就是我们用一些像<span class="kdocs-fontSize" style="font-size:9pt;">Webpack</span>打包工具时，可以对代码静态分析，很好地<span class="kdocs-fontSize" style="font-size:9pt;">tree shaking</span>减少代码体积，所以我们配置<span class="kdocs-fontSize" style="font-size:9pt;">Babel</span>的时候建议设置<span class="kdocs-fontSize" style="font-size:9pt;">modules: false</span></p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">targets</span></h3> 
 <hr> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">作用</span></h4> 
 <p style="text-align:left;">它的用法与 <span class="kdocs-bold" style="font-weight:bold;">browserslist[8]</span> 一致。它可以用来设置我们的代码需要兼容的<span class="kdocs-bold" style="font-weight:bold;">目标环境</span>，因此它：</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>可以有效地减少<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span>的语法编译</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>可以有效控制<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>导入多少</p></li></ul> 
 <h5 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">注意</span></h5> 
 <h5 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">第一点</span></h5> 
 <p style="text-align:left;">如果我们没有设置这个配置项时，它会去我们的<span class="kdocs-fontSize" style="font-size:9pt;">Babel</span>配置文件找<span class="kdocs-bold" style="font-weight:bold;">顶层的</span><span class="kdocs-fontSize" style="font-size:9pt;">targets</span>；如果顶层没有设置<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>，则会去我们的<span class="kdocs-fontSize" style="font-size:9pt;">package.json</span>里的<span class="kdocs-fontSize" style="font-size:9pt;">browserslist</span>或者根目录找<span class="kdocs-fontSize" style="font-size:9pt;">.browserslistrc</span>；如果还没有则默认值为<span class="kdocs-fontSize" style="font-size:9pt;">{}</span>。查找过程大致如下，序号代表查找顺序：</p> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">// Babel配置文件
{
    targets: 'ie 10', // 2. 如果presets里面没有设置targets，会来这里查找
    presets: [
        [
            '@babel/preset-env',
            {
                targets: 'ie 9' // 1. 先在这里查找，没的话去顶层targets查找
            }
        ]
    ]
}

// package.json
{
    ...,
    browserslist: [
        'ie 11' // 3. 如果顶层targest里面没有设置，会来这里查找；如果这里也没设置，则为默认值{}
    ]
}</code></pre> 
 <h5 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">第二点</span></h5> 
 <p style="text-align:left;">如果我们没有设置这个配置项时，<span class="kdocs-fontSize" style="font-size:9pt;">Babel</span>会假设我们要兼容的目标环境是最旧的浏览器，所以会将所有的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span>语法代码转化为<span class="kdocs-fontSize" style="font-size:9pt;">ES5</span>。<span class="kdocs-bold" style="font-weight:bold;">所以我们配置</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">Babel</span></span><span class="kdocs-bold" style="font-weight:bold;">的时候，要设置</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">targets</span></span><span class="kdocs-bold" style="font-weight:bold;">以减少输出代码大小。</span></p> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">如果我们的代码不需要在一些比较低端的浏览器跑的话，设置</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">targets</span></span><span class="kdocs-bold" style="font-weight:bold;">就十分有必要。</span></p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">corejs</span></h3> 
 <hr> 
 <p style="text-align:left;">当<span class="kdocs-fontSize" style="font-size:9pt;">useBuiltIns</span>不为<span class="kdocs-fontSize" style="font-size:9pt;">false</span>的时候，需要设置这个配置项</p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">配置</span></h4> 
 <p style="text-align:left;">它有两种配置方式：</p> 
 <ol start="1"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>直接设置<span class="kdocs-fontSize" style="font-size:9pt;">core-js</span>版本号</p></li></ol> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">...
{
useBuiltIns: 'usage',
corejs: '3.27.2'
}
...</code></pre> 
 <ol start="2"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>配置<span class="kdocs-fontSize" style="font-size:9pt;">corejs</span></p></li></ol> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">...
{
useBuiltIns: 'usage',
corejs: {
    version: '3.27.2',
    // 是否编译提案阶段ES6+ API
    proposals: false
},
}
...</code></pre> 
 <h5 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">注意</span></h5> 
 <ol start="1"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>当我们的<span class="kdocs-fontSize" style="font-size:9pt;">useBuiltIns</span>不为<span class="kdocs-fontSize" style="font-size:9pt;">false</span>的时候，需要设置<span class="kdocs-fontSize" style="font-size:9pt;">corejs</span>这个配置项</p></li></ol> 
 <ol start="2"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">2</span>版本的<span class="kdocs-fontSize" style="font-size:9pt;">core-js</span>已经不建议使用了；我们用当然要用最新的，目前最新的版本是<a class="kdocs-link" style="color:#0A6CFF;" href="mailto:core-js@3.27.2" rel="nofollow noopener noreferrer" target="_blank"><span class="kdocs-fontSize" style="font-size:9pt;">core-js@3.27.2</span></a></p></li></ol> 
 <ol start="3"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p><span class="kdocs-bold" style="font-weight:bold;">我们安装的</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">core-js</span></span><span class="kdocs-bold" style="font-weight:bold;">要尽量保持最新，因为越新的包，包含的</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">polyfill</span></span><span class="kdocs-bold" style="font-weight:bold;">才会越多</span></p></li></ol> 
 <ol start="4"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>我们设置<span class="kdocs-fontSize" style="font-size:9pt;">corejs</span>的版本号时，不要直接指定<span class="kdocs-fontSize" style="font-size:9pt;">2</span>或者<span class="kdocs-fontSize" style="font-size:9pt;">3</span>，它会被解析为<span class="kdocs-fontSize" style="font-size:9pt;">2.0</span>或者<span class="kdocs-fontSize" style="font-size:9pt;">3.0</span>。所以，我们应该带上<span class="kdocs-bold" style="font-weight:bold;">子版本号</span>（<span class="kdocs-fontSize" style="font-size:9pt;">3.27.2</span>），这样才会有最新的<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span></p></li></ol> 
 <ol start="5"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">core-js</span>默认用<span class="kdocs-bold" style="font-weight:bold;">稳定版</span>的<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>来垫平，但如果有时我们想用还处在提案阶段的<span class="kdocs-fontSize" style="font-size:9pt;">API</span>怎么办？</p></li></ol> 
 <ul><li style="margin-left:2.8em;list-style-type:circle;text-indent:0;"><p>如果我们配置的是<span class="kdocs-fontSize" style="font-size:9pt;">useBuiltIns: entry</span>，我们得手动引入<span class="kdocs-fontSize" style="font-size:9pt;">core-js</span>提案的<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>来垫平。<span class="kdocs-bold" style="font-weight:bold;">提案的</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">polyfill</span></span><span class="kdocs-bold" style="font-weight:bold;">放在</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">core-js/proposals</span></span><span class="kdocs-bold" style="font-weight:bold;">文件夹中</span>（<span class="kdocs-fontSize" style="font-size:9pt;">import 'core-js/proposals/array-last'</span>）</p></li></ul> 
 <ul><li style="margin-left:2.8em;list-style-type:circle;text-indent:0;"><p>如果我们配置的是<span class="kdocs-fontSize" style="font-size:9pt;">useBuiltIns: 'usage'</span>，则我们用上面说的<span class="kdocs-fontSize" style="font-size:9pt;">corejs</span>模块里面提到的第二种配置方式，把<span class="kdocs-fontSize" style="font-size:9pt;">proposals</span>设为<span class="kdocs-fontSize" style="font-size:9pt;">true</span>就可以了</p></li></ul> 
 <p style="text-align:left;">它的作用会结合下面的<span class="kdocs-fontSize" style="font-size:9pt;">useBuiltIns</span>一起讲。</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">useBuiltIns</span></h3> 
 <hr> 
 <p style="text-align:left;">上面我们提到了，我们把通过引入<span class="kdocs-fontSize" style="font-size:9pt;">core-js</span>的<span class="kdocs-bold" style="font-weight:bold;">某个模块</span>，来实现旧版本浏览器不支持的<span class="kdocs-bold" style="font-weight:bold;">某个</span><span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>的过程，叫做垫平。</p> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">这个配置就是用来设置我们</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">core-js</span></span><span class="kdocs-bold" style="font-weight:bold;">的垫平方式的</span>。它有下面三个值：</p> 
 <blockquote class="kdocs-blockquote" style="text-align:left;">
   为了更好的理解，我们用 
  <span class="kdocs-fontSize" style="font-size:9pt;">Promise</span>这个 
  <span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> 
  <span class="kdocs-fontSize" style="font-size:9pt;">API</span>作为下面的例子。我们都知道： 
  <br> 
  <span class="kdocs-fontSize" style="font-size:9pt;">IE 11</span>并不支持 
  <span class="kdocs-fontSize" style="font-size:9pt;">Promise</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:9pt;">Promise</span>这个对象其实还有很多方法，例如 
  <span class="kdocs-fontSize" style="font-size:9pt;">Promise.any</span>、 
  <span class="kdocs-fontSize" style="font-size:9pt;">Promise.all</span>、 
  <span class="kdocs-fontSize" style="font-size:9pt;">Promise.finally</span>等。 
  <br>我们用这个案例 
  <span class="kdocs-bold" style="font-weight:bold;">preset-env-useBuiltIns-config[12]</span> 来讲解 
 </blockquote> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">entry</span></h4> 
 <p style="text-align:left;">我们可以这么理解，<span class="kdocs-fontSize" style="font-size:9pt;">entry</span>中文是“进入”的意思，这个值说明我们的<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>应该是需要从某个<span class="kdocs-bold" style="font-weight:bold;">入口</span>引入来垫平。</p> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">我们把配置设置为：</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">useBuiltIns: 'entry'</span></span></p> 
 <h5 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">总结</span></h5> 
 <p style="text-align:left;">所以我们可以总结出，它的执行原理大致是这样的：</p> 
 <ol start="1"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>我们需要<span class="kdocs-bold" style="font-weight:bold;">手动</span><span class="kdocs-fontSize" style="font-size:9pt;">import</span><span class="kdocs-bold" style="font-weight:bold;">所有</span>或者<span class="kdocs-bold" style="font-weight:bold;">某块</span><span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span></p></li></ol> 
 <ol start="2"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">Babel</span>会根据我们设置的<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>（目标环境），来判断我们手动<span class="kdocs-fontSize" style="font-size:9pt;">import</span>的<span class="kdocs-bold" style="font-weight:bold;">所有</span>或者<span class="kdocs-bold" style="font-weight:bold;">某块</span><span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>是不是当前缺失的</p></li></ol> 
 <ol start="3"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>如果是的话，就会把我们手动<span class="kdocs-fontSize" style="font-size:9pt;">import</span><span class="kdocs-bold" style="font-weight:bold;">所有</span>或者<span class="kdocs-bold" style="font-weight:bold;">某块</span><span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>，拆分成很多小模块，<span class="kdocs-bold" style="font-weight:bold;">引入我们目标环境不支持的模块</span></p></li></ol> 
 <h5 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">注意</span></h5> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>为了避免一些奇奇怪怪的问题，我们手动<span class="kdocs-fontSize" style="font-size:9pt;">import</span>的<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>应该<span class="kdocs-bold" style="font-weight:bold;">统一在入口文件</span>（我们现在的工程项目一般都会有一个入口文件）</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>如果我们想一劳永逸，直接把当前环境<span class="kdocs-bold" style="font-weight:bold;">所有</span>不支持的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>垫平，那我们就<span class="kdocs-fontSize" style="font-size:9pt;">import 'core-js/stable'</span>（这会垫平当前<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>**不支持的所有稳定版本的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>**，所以也会导致包变大）</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>如果我们只想单纯垫平<span class="kdocs-bold" style="font-weight:bold;">某个</span><span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>（前提是<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>不支持这个<span class="kdocs-fontSize" style="font-size:9pt;">API</span>，否则手动<span class="kdocs-fontSize" style="font-size:9pt;">import</span>了也没用；例如只想垫平<span class="kdocs-fontSize" style="font-size:9pt;">Promise</span>），那我们<span class="kdocs-fontSize" style="font-size:9pt;">import 'core-js/es/promise</span>就可以了</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>如果想垫平提案阶段的<span class="kdocs-fontSize" style="font-size:9pt;">API</span>，则也需要手动<span class="kdocs-fontSize" style="font-size:9pt;">import</span>对应提案的<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>（<span class="kdocs-fontSize" style="font-size:9pt;">import "core-js/proposals/string-replace-all</span>）</p></li></ul> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">usage</span></h4> 
 <p style="text-align:left;">这个值的作用，就是我们不需要手动<span class="kdocs-fontSize" style="font-size:9pt;">import</span>，它会自动帮我们<span class="kdocs-fontSize" style="font-size:9pt;">import</span>当前<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>缺失的<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>。</p> 
 <h5 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">表现</span></h5> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">我们把配置设置为：</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">useBuiltIns: 'usage'</span></span></p> 
 <h5 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">总结</span></h5> 
 <p style="text-align:left;">所以我们可以总结出，它的执行原理大致是这样的：</p> 
 <ol start="1"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>我们<span class="kdocs-bold" style="font-weight:bold;">不需要手动</span><span class="kdocs-fontSize" style="font-size:9pt;">import</span><span class="kdocs-bold" style="font-weight:bold;">所有</span>或者<span class="kdocs-bold" style="font-weight:bold;">某块</span><span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span></p></li></ol> 
 <ol start="2"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">Babel</span>会根据我们当前代码中用到的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>，并判断当前的<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>支不支持我们用到的这个<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span></p></li></ol> 
 <ol start="3"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>如果不支持的话，则<span class="kdocs-bold" style="font-weight:bold;">自动导入这个</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">ES6+</span></span><span class="kdocs-bold" style="font-weight:bold;"> </span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">API</span></span><span class="kdocs-bold" style="font-weight:bold;">对应的</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">polyfill</span></span></p></li></ol> 
 <p style="text-align:left;">因为它会自动导入，所以我们专注写我们的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span>就好了。</p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">false</span></h4> 
 <p style="text-align:left;">它是默认值。它表示不要在每个文件中自动添加<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>，也<span class="kdocs-bold" style="font-weight:bold;">不会根据</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">targets</span></span><span class="kdocs-bold" style="font-weight:bold;">判断</span>缺不缺失，也不会将我们手动<span class="kdocs-fontSize" style="font-size:9pt;">import</span><span class="kdocs-bold" style="font-weight:bold;">所有</span>或者<span class="kdocs-bold" style="font-weight:bold;">某块</span><span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>拆分为单个<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>引入。</p> 
 <h5 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">总结</span></h5> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;">useBuiltIns</span>设置为<span class="kdocs-fontSize" style="font-size:9pt;">false</span>:</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>对我们的垫平方式没作用，源码是什么样，输出就是什么样</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>设置<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>无效</p></li></ul> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">使用</span></h3> 
 <hr> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">适配 IE 11</span></h4> 
 <p style="text-align:left;">相信通过上面的讲解，我们对各个配置项有个大概的了解了，那我们再更深入体验一下。</p> 
 <p style="text-align:left;">我们都知道<span class="kdocs-fontSize" style="font-size:9pt;">IE 11</span>基本是不支持<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span>的</p> 
 <p style="text-align:left;">那我们就用<span class="kdocs-fontSize" style="font-size:9pt;">IE 11</span>作为我们的<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>（目标环境），研究一下如何配置<span class="kdocs-fontSize" style="font-size:9pt;">Babel</span>，使我们写的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span>代码能在<span class="kdocs-fontSize" style="font-size:9pt;">IE 11</span>中跑起来。我们用这个案例 <span class="kdocs-bold" style="font-weight:bold;">preset-env-template-config[16]</span></p> 
 <blockquote class="kdocs-blockquote" style="text-align:left;">
   注意：为了避免 
  <span class="kdocs-fontSize" style="font-size:9pt;">Webpack</span>打包错误，我们把 
  <span class="kdocs-fontSize" style="font-size:9pt;">targets</span>写在 
  <span class="kdocs-fontSize" style="font-size:9pt;">package.json</span>中，这样 
  <span class="kdocs-fontSize" style="font-size:9pt;">Webpack</span>才能识别环境打包 
  <br> 
  <span class="kdocs-fontSize" style="font-size:9pt;">...</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:9pt;">"browserslist": [</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:9pt;"> "ie 11"</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:9pt;"> ]</span> 
  <br> 
  <span class="kdocs-fontSize" style="font-size:9pt;"> ...</span> 
 </blockquote> 
 <p style="text-align:left;">我们用一下这段代码作为我们的入口文件：</p> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">// 如果用`usage`方式，则注释掉这段代码
import 'core-js/stable';

const lMC = {
    name: 'limingcan',
    like: ['eat', 'drink', 'play', 'fun'],
    breath() {
        return new Promise(resolve =&gt; {
            setTimeout(() =&gt; resolve(), 1000)
        })
    }
};

lMC.breath().then(() =&gt; console.log('breath'));
console.log(lMC.like.includes('play'));
console.log(Array.of(1, 2, 3));</code></pre> 
 <p style="text-align:left;">根据我们上面几个配置项的讲解，如果我们想：</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>一劳永逸的直接垫平<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>所有不支持的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>，那我们的配置应该是：</p></li></ul> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">const presets = [
  [
      '@babel/preset-env',
      {
          modules: false,
          useBuiltIns: 'entry',
          corejs: {
              version: '3.27.2',
              proposals: true
          }
      }
  ]
];
module.exports = { presets};</code></pre> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>如果我们想减少包的体积，只垫平我们用到的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>，那我们的配置应该是：</p></li></ul> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">const presets = [
  [
      '@babel/preset-env',
      {
          modules: false,
          useBuiltIns: 'usage',
          corejs: {
              version: '3.27.2',
              proposals: true
          }
      }
  ]
];
module.exports = { presets};</code></pre> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>它只会垫平我们代码中用到的<span class="kdocs-fontSize" style="font-size:9pt;">API</span>；</p></li></ul> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">常见问题</span></h4> 
 <p style="text-align:left;">通过上面的例子，我们会发现：</p> 
 <p style="text-align:left;">如果配置是<span class="kdocs-fontSize" style="font-size:9pt;">useBuiltIns: 'entry'</span></p> 
 <ol start="1"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>我们垫平的<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>，都是注入到<span class="kdocs-fontSize" style="font-size:9pt;">window</span>全局的，或者是某个内置对象的原型（<span class="kdocs-fontSize" style="font-size:9pt;">prototype</span>）上，这<span class="kdocs-bold" style="font-weight:bold;">影响到了全局</span></p></li></ol> 
 <ol start="2"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>一劳永逸的方式会垫平当前<span class="kdocs-fontSize" style="font-size:9pt;">targets</span><span class="kdocs-bold" style="font-weight:bold;">所有不支持的</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">ES6+</span></span><span class="kdocs-bold" style="font-weight:bold;"> </span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">API</span></span><span class="kdocs-bold" style="font-weight:bold;">，这虽然方便，但这会导致包变得很大</span></p></li></ol> 
 <p style="text-align:left;">如果配置是<span class="kdocs-fontSize" style="font-size:9pt;">useBuiltIns: 'usage'</span></p> 
 <ol start="3"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>它也会将垫平的<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>注入到全局。</p></li></ol> 
 <ol start="4"><li style="margin-left:1.4em;list-style-type:decimal;text-indent:0;"><p>由于<span class="kdocs-fontSize" style="font-size:9pt;">useBuiltIns: 'usage'</span>是判断当前<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>支不支持我们代码中用到的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>，如果不支持会自己<span class="kdocs-fontSize" style="font-size:9pt;">import</span>。<br>那有这样一种情况，如果第三方库用到了我们当前<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>不支持的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>，但我们自己的代码没有用到这个<span class="kdocs-fontSize" style="font-size:9pt;">API</span>，那么这个<span class="kdocs-fontSize" style="font-size:9pt;">API</span>是不会被叠平的，这会导致我们项目报错。</p></li></ol> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">总结</span></h4> 
 <hr> 
 <p style="text-align:left;">看到这里，相信我们对<span class="kdocs-fontSize" style="font-size:9pt;">@babel/preset-env</span>的配置功能已经有个大概的了解了。上述所说的问题确实是我们很实际的问题。</p> 
 <p style="text-align:left;">因此，<span class="kdocs-fontSize" style="font-size:9pt;">useBuiltIns</span>设置<span class="kdocs-fontSize" style="font-size:9pt;">entry</span>还是<span class="kdocs-fontSize" style="font-size:9pt;">usage</span>，还是得根据我们项目实际需求来，我个人建议：</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>由于我们<span class="kdocs-fontSize" style="font-size:9pt;">@babel/preset-env</span>配置方式，是会把当前<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>缺失的<span class="kdocs-fontSize" style="font-size:9pt;">API</span><span class="kdocs-bold" style="font-weight:bold;">注入到全局</span>，所以这个配置方式是比较适合我们做的一些<span class="kdocs-bold" style="font-weight:bold;">前端工程项目</span>或者<span class="kdocs-bold" style="font-weight:bold;">应用程序</span>。如果对包的体积不是很在意，建议使用<span class="kdocs-fontSize" style="font-size:9pt;">useBuiltIns: entry</span>的方式，然后再<span class="kdocs-fontSize" style="font-size:9pt;">import 'core-js/stable'</span>，一劳永逸的垫平，这样可以帮我们避免掉一些奇怪的问题，</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>如果使用<span class="kdocs-fontSize" style="font-size:9pt;">useBuiltIns: usage</span>，那还是得注意第三方库的问题。如果判断出哪块<span class="kdocs-fontSize" style="font-size:9pt;">polyfill</span>缺失，我们可以自己手动<span class="kdocs-fontSize" style="font-size:9pt;">import</span>去垫平</p></li></ul> 
 <h2 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">再谈@babel/plugin-transform-runtime</span></h2> 
 <hr> 
 <p style="text-align:left;">上面说到，<span class="kdocs-fontSize" style="font-size:9pt;">@babel/preset-env</span>配置方式，是会把当前浏览器缺失的<span class="kdocs-fontSize" style="font-size:9pt;">API</span><span class="kdocs-bold" style="font-weight:bold;">注入到全局的</span>，那么有没有不注入全局的办法呢？答案是有的。它就是我们接下来要讲的<span class="kdocs-fontSize" style="font-size:9pt;">@babel/plugin-transform-runtime</span>配置。</p> 
 <p style="text-align:left;">我们先来看看它有几个配置项：</p> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">// babel.config.js
const plugins = [
    [
        '@babel/plugin-transform-runtime',
        {
            helpers,
            regenerator,
            corejs,
            
            version
        }
    ]
];
module.exports = {plugins};</code></pre> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">helpers &amp;&amp; regenerator</span></h3> 
 <hr> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">解析</span></h4> 
 <p style="text-align:left;">我们先看前两个配置，因为前两个配置比较简单，我们放在一起讲。</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">helpers</span>默认值是：<span class="kdocs-fontSize" style="font-size:9pt;">true</span></p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">regenerator</span>默认值是：<span class="kdocs-fontSize" style="font-size:9pt;">true</span></p></li></ul> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">关于</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">@babel/runtime</span></span></p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">@babel/runtime</span>是<span class="kdocs-bold" style="font-weight:bold;">存放了</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">Babel</span></span><span class="kdocs-bold" style="font-weight:bold;">辅助函数的一个集合包</span></p></li></ul> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">关于辅助函数</span></p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>当我们只用了一些<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span>语法糖的时候，<span class="kdocs-fontSize" style="font-size:9pt;">Babel</span>编译时会内联注入一些辅助函数</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">@babel/plugin-transform-runtime</span>与<span class="kdocs-fontSize" style="font-size:9pt;">@babel/runtime</span>配合使用时，会将我们用到的辅助函数，从<span class="kdocs-fontSize" style="font-size:9pt;">@babel/runtime</span>中以<span class="kdocs-fontSize" style="font-size:9pt;">require</span>或者<span class="kdocs-fontSize" style="font-size:9pt;">import</span>的方式，引入到我们的文件中，实现复用，从而减小我们最终输出包的体积。</p></li></ul> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">关于</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">regenerator</span></span></p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>我们的源码里面使用了<span class="kdocs-fontSize" style="font-size:9pt;">async function() {}</span>等异步函数，或者<span class="kdocs-fontSize" style="font-size:9pt;">fuction* myGenerator() {}</span>这种<span class="kdocs-fontSize" style="font-size:9pt;">Generator</span>函数的话，就会需要用到<span class="kdocs-fontSize" style="font-size:9pt;">regenerator-runtime</span>这个包来编译。</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">Babel &gt;= 7.18.0</span>，<span class="kdocs-fontSize" style="font-size:9pt;">regenerator-runtime</span>包里的内容，会以<span class="kdocs-bold" style="font-weight:bold;">局部变量的方式内联注入到我们的代码中</span>，这样我们就不需要全局提供一个<span class="kdocs-fontSize" style="font-size:9pt;">regeneratorRuntime</span>对象。</p></li></ul> 
 <p style="text-align:left;">例如我们使用了<span class="kdocs-fontSize" style="font-size:9pt;">class</span>语法糖跟<span class="kdocs-fontSize" style="font-size:9pt;">async function() {}</span>，然后用<span class="kdocs-fontSize" style="font-size:9pt;">@babel/runtime</span>跟<span class="kdocs-fontSize" style="font-size:9pt;">@babel/plugin-transform-runtime</span>（默认情况下，<span class="kdocs-fontSize" style="font-size:9pt;">helpers</span>与<span class="kdocs-fontSize" style="font-size:9pt;">regenerator</span>值为<span class="kdocs-fontSize" style="font-size:9pt;">true</span>）配合使用，编译后如下图：</p> 
 <hr> 
 <p style="text-align:left;">当我们把<span class="kdocs-fontSize" style="font-size:9pt;">helpers</span>跟<span class="kdocs-fontSize" style="font-size:9pt;">regenerator</span>的值设为<span class="kdocs-fontSize" style="font-size:9pt;">false</span>：</p> 
 <p style="text-align:left;">我们会发现我们的辅助函数，跟<span class="kdocs-fontSize" style="font-size:9pt;">regenerator-runtime</span>这个包又变回了内联方式。所以：</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">helpers</span>：控制的是我们的辅助函数，<span class="kdocs-bold" style="font-weight:bold;">是否不内联</span>进我们的代码中。</p></li></ul> 
 <ul><li style="margin-left:2.8em;list-style-type:circle;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">true</span>的话是不内联，而是引用<span class="kdocs-fontSize" style="font-size:9pt;">@babel/runtime</span>辅助函数集合包</p></li></ul> 
 <ul><li style="margin-left:2.8em;list-style-type:circle;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">false</span>的话，则会内联</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">regenerator</span>：与<span class="kdocs-fontSize" style="font-size:9pt;">helpers</span>类似，控制的是我们<span class="kdocs-fontSize" style="font-size:9pt;">regenerator-runtime</span>这个包的代码，<span class="kdocs-bold" style="font-weight:bold;">是否不内联</span>进我们的代码中。</p></li></ul> 
 <ul><li style="margin-left:2.8em;list-style-type:circle;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">true</span>的话是不内联，而是引用<span class="kdocs-fontSize" style="font-size:9pt;">@babel/runtime</span>辅助函数集合包</p></li></ul> 
 <ul><li style="margin-left:2.8em;list-style-type:circle;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">false</span>的话，则会内联</p></li></ul> 
 <h5 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">注意</span></h5> 
 <p style="text-align:left;">官网中关于<span class="kdocs-fontSize" style="font-size:9pt;">regenerator</span>的解释，大致意思是：<span class="kdocs-fontSize" style="font-size:9pt;">regenerator</span>如果设为<span class="kdocs-fontSize" style="font-size:9pt;">false</span>，需要我们提供一个全局的<span class="kdocs-fontSize" style="font-size:9pt;">regeneratorRuntime</span>的对象。</p> 
 <p style="text-align:left;">但是：</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>当<span class="kdocs-fontSize" style="font-size:9pt;">Babel &gt;= 7.18.0</span>以后，<span class="kdocs-fontSize" style="font-size:9pt;">regenerator-runtime</span>包里的内容，会以<span class="kdocs-bold" style="font-weight:bold;">局部变量的方式内联注入到我们的代码中</span>。所以其实<span class="kdocs-fontSize" style="font-size:9pt;">Babel &gt;= 7.18.0</span> <span class="kdocs-fontSize" style="font-size:9pt;">regenerator</span>这个配置项个人觉得是基本没用了</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">Babel &lt; 7.18.0</span>的话，则需要我们提供一个全局的<span class="kdocs-fontSize" style="font-size:9pt;">regeneratorRuntime</span>的对象。相关案例可查看 <span class="kdocs-bold" style="font-weight:bold;">import-regenerator-runtime[21]</span>，开启<span class="kdocs-fontSize" style="font-size:9pt;">babel.config.js</span>相关注释代码。</p></li></ul> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">corejs</span></h3> 
 <hr> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">解析</span></h4> 
 <p style="text-align:left;"><span class="kdocs-fontSize" style="font-size:9pt;">corejs</span>这个配置项一旦不为<span class="kdocs-fontSize" style="font-size:9pt;">false</span>，就是用来设置我们的要垫平的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>，以<span class="kdocs-bold" style="font-weight:bold;">不污染全局局部变量方式垫平。</span></p> 
 <p style="text-align:left;">它有三个值：</p> 
 <div style=""> 
  <table class="kdocs-table" border="1" cellpadding="1" cellspacing="1" style=""><tbody><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">值</span></p></td><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">对应依赖</span></p></td><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">补充</span></p></td></tr><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style="">false（默认值）</p></td><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style="">@babel/runtime</p></td><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style=""></p></td></tr><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style="">2</p></td><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style="">@babel/runtime-corejs2</p></td><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style="">1. 只能编译支持全局变量（如Promise）和静态属性（如Array.from）；</p></td></tr><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style="">2. 不能编译实例相关方法（[].includes）</p></td><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style=""></p></td><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style=""></p></td></tr><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style="">3</p></td><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style="">@babel/runtime-corejs3</p></td><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style="">1. 既能编译能编译支持全局变量和静态属性，又能编译实例方法</p></td></tr><tr class="kdocs-tableRow"><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style="">2. 开启proposals: true，还可以编译提案阶段的API</p></td><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style=""></p></td><td class="kdocs-tableCell" style="width:246px;vertical-align:top;height:52px;"><p style=""></p></td></tr></tbody></table> 
 </div> 
 <p style="text-align:left;">我们用这个例子 <span class="kdocs-bold" style="font-weight:bold;">transform-runtime-config[22]</span> 体验一下。</p> 
 <p style="">如果配置的是<span class="kdocs-fontSize" style="font-size:9pt;">corejs: 2</span>的话，会怎么样：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:636px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:48.742138%;height:0;"> 
    <img src="https://images2.imgbox.com/94/79/xYvf7iv2_o.jpg" style="margin-left:;display:block;width:636px;margin-top:-48.742138%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>我们会发现，实例方法<span class="kdocs-fontSize" style="font-size:9pt;">includes</span>没被垫平，提案<span class="kdocs-fontSize" style="font-size:9pt;">API</span>（<span class="kdocs-fontSize" style="font-size:9pt;">Math.signbit</span>）也没有被垫平；<span class="kdocs-fontSize" style="font-size:9pt;">Promise</span>是以局部变量的方式出现在我们的代码中。</p></li></ul> 
 <p style="">我们再看看配置的是<span class="kdocs-fontSize" style="font-size:9pt;">corejs: {version: 3, proposals: true}</span>：</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:636px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:53.930817%;height:0;"> 
    <img src="https://images2.imgbox.com/c2/26/MiDrn4se_o.jpg" style="margin-left:;display:block;width:636px;margin-top:-53.930817%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">我们会发现，实例方法<span class="kdocs-fontSize" style="font-size:9pt;">includes</span>被垫平，提案<span class="kdocs-fontSize" style="font-size:9pt;">API</span>（<span class="kdocs-fontSize" style="font-size:9pt;">Math.signbit</span>）也垫平；但它们都以<span class="kdocs-bold" style="font-weight:bold;">局部变量</span>的方式注入。</p> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">所以，如果我们不想以全局的方式污染的方式垫平我们的</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">ES6+</span></span><span class="kdocs-bold" style="font-weight:bold;"> </span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">API</span></span><span class="kdocs-bold" style="font-weight:bold;">，我们</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">corejs</span></span><span class="kdocs-bold" style="font-weight:bold;">就不能为</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">false</span></span><span class="kdocs-bold" style="font-weight:bold;">，并且优先使用</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">@babel/runtime-corejs3</span></span><span class="kdocs-bold" style="font-weight:bold;">这个包来垫平</span>（设置为<span class="kdocs-fontSize" style="font-size:9pt;">3</span>）</p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">优化</span></h4> 
 <p style="text-align:left;">上面的案例我们并没有设置<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>，所以<span class="kdocs-fontSize" style="font-size:9pt;">@babel/plugin-transform-runtime</span>配置下，会把我们代码中用到的<span class="kdocs-bold" style="font-weight:bold;">所有</span><span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>都垫平。我们来设置<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>，看看能不能垫平我们的<span class="kdocs-fontSize" style="font-size:9pt;">targets</span>不支持的<span class="kdocs-fontSize" style="font-size:9pt;">ES6+</span> <span class="kdocs-fontSize" style="font-size:9pt;">API</span>。</p> 
 <p style="text-align:left;">我们在<span class="kdocs-fontSize" style="font-size:9pt;">package.json</span>里面添加，或者在<span class="kdocs-bold" style="font-weight:bold;">配置文件的顶层</span>添加是可以的（<span class="kdocs-bold" style="font-weight:bold;">经过测试，在</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">@babel/preset-env</span></span><span class="kdocs-bold" style="font-weight:bold;">里面设置</span><span class="kdocs-fontSize" style="font-size:9pt;"><span class="kdocs-bold" style="font-weight:bold;">targets</span></span><span class="kdocs-bold" style="font-weight:bold;">是不行的</span>）：</p> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">// package.json
"browserslist": [
    "chrome 80"
]

// 或者在顶层添加
module.exports = {
    targets: {chrome: 80}, // 在这里添加
    presets: ['@babel/preset-env'],
    plugins: [
        [
            "@babel/plugin-transform-runtime",
            {
                ...
            }
        ]
    ]
}</code></pre> 
 <p style="text-align:left;">我们会发现，<span class="kdocs-fontSize" style="font-size:9pt;">Promise</span>跟<span class="kdocs-fontSize" style="font-size:9pt;">includes</span>都没有被垫平，因为<span class="kdocs-fontSize" style="font-size:9pt;">chrome 80</span>已经支持了</p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">总结</span></h4> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p><span class="kdocs-fontSize" style="font-size:9pt;">@babel/preset-env</span>是以全局方式垫平，<span class="kdocs-fontSize" style="font-size:9pt;">@babel/plugin-transform-runtime</span>是以局部变量方式垫平，两者我们应该选择其一，不要又用<span class="kdocs-fontSize" style="font-size:9pt;">@babel/preset-env</span>配置方式，又用<span class="kdocs-fontSize" style="font-size:9pt;">@babel/plugin-transform-runtime</span>配置方式，这样肯定会出现一些奇奇怪怪的问题。</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>因为使用<span class="kdocs-fontSize" style="font-size:9pt;">@babel/plugin-transform-runtime</span>垫平是以<span class="kdocs-bold" style="font-weight:bold;">局部变量的方式</span>来垫平，所以<span class="kdocs-fontSize" style="font-size:9pt;">@babel/plugin-transform-runtime</span>这种配置方式更适合来做 <span class="kdocs-bold" style="font-weight:bold;">库</span> 的开发。它可以很好的帮我们的库与使用者的项目解耦。</p></li></ul> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">最后</span></h3> 
 <hr> 
 <p style="text-align:left;">通过以上的了解，我们最后来总结一下这个配置。</p> 
 <p style="">如果我们开发的项目是<span class="kdocs-bold" style="font-weight:bold;">应用程序</span>，或者<span class="kdocs-bold" style="font-weight:bold;">大型的项目</span>，那我们可以这么配置：</p> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">// Babel配置
const presets = [
  [
      '@babel/preset-env',
      {
          modules: false,

          // 或者只想用垫平我们代码中用到的 --&gt; useBuiltIns: 'usage',
          useBuiltIns: 'entry',
          corejs: {
              version: '3.27.2',
              proposals: true
          }
      }
  ]
];
const plugins = [
  '@babel/plugin-transform-runtime'
];
module.exports = {plugins, presets};

// package.json
{
  ...,
  // 设置目标环境
  "browserslist": [
      "ie 11"
  ]
}

// 入口文件
// ---- useBuiltIns: 'entry'时，需要引入以下----
// 垫平全部ES6+稳定版API
import 'core-js/stable'; 
// ---- 或者 -----
// 垫平所有ES6+ API，包括提案阶段
import 'core-js';</code></pre> 
 <hr> 
 <p style="">如果我们是想开发一个<span class="kdocs-bold" style="font-weight:bold;">第三方库</span>，我们可以这么配置：</p> 
 <pre class="kdocs-plaintext"><code class="language-plaintext">// Babel配置
const presets = [
  [
      '@babel/preset-env',
      {
          modules: false
      }
  ]
];
const plugins = [
  [
      '@babel/plugin-transform-runtime',
      {
          corejs: {
              version: 3,
              proposals: true
          }
      }
  ]
];
module.exports = {plugins, presets};

// package.json
{
  ...,
  // 设置目标环境
  "browserslist": [
      "ie 11"
  ]
}

// 入口文件
const Method = {
  wait(delay) {
      return new Promise(resolve =&gt; setTimeout(() =&gt; resolve(), delay);
  }
}
...</code></pre> 
 <p style=""></p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ea36df1a4747493e000cb71365b8897f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">服务器安装配置lldp协议</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f6c0bc7c8cce05b817e025579ba545fe/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【SpringCloud Alibaba系列】Dubbo基础入门篇</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>