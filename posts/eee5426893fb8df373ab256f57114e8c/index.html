<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>maven-plugin(idea)-2 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="maven-plugin(idea)-2" />
<meta property="og:description" content="package jacco; import com.intellij.openapi.actionSystem.AnAction; import com.intellij.openapi.actionSystem.AnActionEvent; import com.intellij.openapi.project.Project; import com.intellij.openapi.ui.Messages; import com.intellij.openapi.util.SystemInfo; import com.intellij.openapi.util.text.StringUtil; import com.intellij.openapi.vfs.VirtualFile; import com.intellij.openapi.wm.ToolWindow; import com.intellij.openapi.wm.ToolWindowManager; import com.intellij.ui.content.Content; import org.jdom.Document; import org.jdom.Element; import org.jdom.input.SAXBuilder; import java.awt.*; import java.io.*; import java.util.ArrayList; import java.util.List; public class GenerateCoverageReportAction extends AnAction { @Override public void actionPerformed(AnActionEvent event) { Project project = event.getProject(); if (project == null) { return; } VirtualFile projectFile = project.getProjectFile(); if (projectFile == null) { return; } VirtualFile baseDir = project." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/eee5426893fb8df373ab256f57114e8c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-02T09:13:29+08:00" />
<meta property="article:modified_time" content="2024-01-02T09:13:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">maven-plugin(idea)-2</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre><code class="prism language-xml">package jacco;

import com.intellij.openapi.actionSystem.AnAction;
import com.intellij.openapi.actionSystem.AnActionEvent;

import com.intellij.openapi.project.Project;
import com.intellij.openapi.ui.Messages;
import com.intellij.openapi.util.SystemInfo;
import com.intellij.openapi.util.text.StringUtil;
import com.intellij.openapi.vfs.VirtualFile;
import com.intellij.openapi.wm.ToolWindow;
import com.intellij.openapi.wm.ToolWindowManager;
import com.intellij.ui.content.Content;
import org.jdom.Document;
import org.jdom.Element;
import org.jdom.input.SAXBuilder;

import java.awt.*;
import java.io.*;
import java.util.ArrayList;
import java.util.List;

public class GenerateCoverageReportAction extends AnAction {

    @Override
    public void actionPerformed(AnActionEvent event) {
        Project project = event.getProject();
        if (project == null) {
            return;
        }

        VirtualFile projectFile = project.getProjectFile();
        if (projectFile == null) {
            return;
        }

        VirtualFile baseDir = project.getBaseDir();
        if (baseDir == null) {
            return;
        }


        MyToolWindowPanel1 panel = getToolWindowPanel(project);

        String mavenExecutablePath = getMavenExecutablePath();
        if (StringUtil.isEmptyOrSpaces(mavenExecutablePath)) {
            Messages.showErrorDialog("Cannot find Maven executable", "Error");
            return;
        }

        List<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>String</span><span class="token punctuation">&gt;</span></span> command = new ArrayList&lt;&gt;();
        command.add(mavenExecutablePath);
        command.add("clean");

        try {
            ProcessBuilder builder = new ProcessBuilder(command);
            builder.directory(new File(baseDir.getPath()));
            builder.redirectErrorStream(true);

            Process process = builder.start();

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
                panel.appendText(line + "\n");
            }

            process.waitFor();
        } catch (IOException | InterruptedException e) {
            Messages.showErrorDialog("Failed to execute Maven command: " + e.getMessage(), "Error");
        }
    }

    private String getMavenExecutablePath() {
        String mavenExecutable = SystemInfo.isWindows ? "mvn.cmd" : "mvn";
        String[] pathVariables = System.getenv("PATH").split(System.getProperty("path.separator"));

        for (String pathVariable : pathVariables) {
            String executablePath = pathVariable + "/" + mavenExecutable;
            if (isExecutable(executablePath)) {
                return executablePath;
            }
        }

        return "";
    }

    private boolean isExecutable(String path) {
        ProcessBuilder builder = new ProcessBuilder("sh", "-c", "test -x " + path);
        try {
            Process process = builder.start();
            process.waitFor();
            return process.exitValue() == 0;
        } catch (IOException | InterruptedException e) {
            return false;
        }
    }

    private MyToolWindowPanel1 getToolWindowPanel(Project project) {
        MyToolWindowPanel1 panel = null;
        ToolWindowManager toolWindowManager = ToolWindowManager.getInstance(project);
        ToolWindow toolWindow = toolWindowManager.getToolWindow("My Plugin Tool Window");
        if (toolWindow != null) {
            Content content = toolWindow.getContentManager().getContent(0);
            if (content != null) {
                panel = (MyToolWindowPanel1) content.getComponent();
            }
        }
        return panel;
    }
}





</code></pre> 
<pre><code class="prism language-xml">在这里插入代码片
</code></pre> 
<pre><code class="prism language-xml">package jacco;

import com.intellij.openapi.components.ProjectComponent;
import com.intellij.openapi.project.Project;
import com.intellij.openapi.util.Disposer;
import com.intellij.openapi.wm.ToolWindow;
import com.intellij.openapi.wm.ToolWindowAnchor;
import com.intellij.openapi.wm.ToolWindowFactory;
import com.intellij.openapi.wm.ToolWindowManager;
import com.intellij.ui.components.JBScrollPane;
import com.intellij.ui.content.Content;
import com.intellij.ui.content.ContentFactory;
import com.intellij.ui.content.ContentManager;
import com.intellij.util.ui.update.Activatable;
import com.intellij.util.ui.update.UiNotifyConnector;
import org.jetbrains.annotations.NotNull;

import javax.swing.*;
import java.awt.*;

public class MyPluginToolWindow implements ProjectComponent, ToolWindowFactory {
    private Project project;
    private ToolWindow toolWindow;
    private MyToolWindowPanel1 myToolWindowPanel;

    private UiNotifyConnector uiNotifyConnector;

    public MyPluginToolWindow(Project project) {
        this.project = project;
    }

    @Override
    public void initComponent() {

//        ToolWindowManager toolWindowManager = ToolWindowManager.getInstance(project);
//        ContentFactory contentFactory = ContentFactory.getInstance();
//
//        myToolWindowPanel = new MyToolWindowPanel1();
//        Content content = contentFactory.createContent(myToolWindowPanel, "My Tool Window", false);
//        toolWindow = toolWindowManager.registerToolWindow("My Plugin Tool Window", false, ToolWindowAnchor.RIGHT);
//        ContentManager contentManager = toolWindow.getContentManager();
//        contentManager.addContent(content);
    }



    @Override
    public void createToolWindowContent(@NotNull Project project, @NotNull ToolWindow toolWindow) {
//        ToolWindowManager toolWindowManager = ToolWindowManager.getInstance(project);
//        ContentFactory contentFactory = ContentFactory.getInstance();
//
//        myToolWindowPanel = new MyToolWindowPanel1();
//        Content content = contentFactory.createContent(myToolWindowPanel, "My Tool Window", false);
//        toolWindow = toolWindowManager.registerToolWindow("My Plugin Tool Window", false, ToolWindowAnchor.RIGHT);
//        ContentManager contentManager = toolWindow.getContentManager();
//        contentManager.addContent(content);
    }

    @Override
    public void disposeComponent() {

        // 释放组件时执行的操作，例如注销工具窗口

    }

    @Override
    public void projectOpened() {
        ToolWindowManager toolWindowManager = ToolWindowManager.getInstance(project);
        ContentFactory contentFactory = ContentFactory.getInstance();

        myToolWindowPanel = new MyToolWindowPanel1();
        Content content = contentFactory.createContent(myToolWindowPanel, "My Tool Window", false);
        toolWindow = toolWindowManager.registerToolWindow("My Plugin Tool Window", false, ToolWindowAnchor.RIGHT);
        ContentManager contentManager = toolWindow.getContentManager();
        contentManager.addContent(content);
        toolWindow.show();
    }

    @Override
    public void projectClosed() {

        ToolWindowManager toolWindowManager = ToolWindowManager.getInstance(project);
        toolWindowManager.unregisterToolWindow("My Tool Window");

    }


}




 class MyToolWindowPanel1 extends JPanel {

     private final JTextArea textArea;
    public MyToolWindowPanel1() {
        setLayout(new BorderLayout());
        setPreferredSize(new Dimension(500, 300));

        textArea = new JTextArea();
        textArea.setEditable(false);

        JScrollPane scrollPane = new JBScrollPane(textArea);
        add(scrollPane, BorderLayout.CENTER);
    }


     public void appendText(String text) {
         SwingUtilities.invokeLater(() -&gt; textArea.append(text));
     }
}
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d59f6b742a4484fdaac75ec3b9a68925/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">机器视觉在食品安全检测领域的应用与展望</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9ac60ad02a524fda553d87a710a2a99c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">halcon3D点云处理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>