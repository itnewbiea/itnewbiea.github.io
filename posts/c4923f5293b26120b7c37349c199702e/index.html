<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Vol.1 人鼠基因转换 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Vol.1 人鼠基因转换" />
<meta property="og:description" content="Vol.1 人鼠基因转换 &#34;像清风追着流云 望你时忽远忽近&#34;
0x00 写在前面 ​ 又开了一个系列新坑, 这一系列的文章主要面向生物信息学, 尝试着从R和统计开始, 自己边学边写, 把遇到的一些问题展现出来.
​ 这一系列可能会要求有R/生物信息学最基本的基础了解就够了,当然如果还不懂可以去公众号三文鱼卷, 搜索&#34;科研工具箱 &#34;话题下相关内容.
0x01 问题的提出 ​ 如果处理的是小鼠的基因芯片表达矩阵，最后做gsea等分析要对生物学数据库注释，发现绝大部分数据库都是人类的基因名字，有一个取巧的方法是把基因名字修改一下，如下所示：
[1] &#34;PTPRC&#34; &#34;EPCAM&#34; &#34;MME&#34; &#34;CD3G&#34; &#34;CD3E&#34; &#34;CD68&#34; &#34;CD79A&#34; # 人基因 [1] &#34;Ptprc&#34; &#34;Epcam&#34; &#34;Mme&#34; &#34;Cd3g&#34; &#34;Cd3e&#34; &#34;Cd68&#34; &#34;Cd79a&#34;	# 鼠基因 ​ 然而,不同物种的基因对应关系是有相应的同源基因数据库的，不能仅仅是把基因名字修改。回归教程本身，人鼠基因转换之首字母大写在R语言的师兄，本着不想自己去造轮子的心态，搜索了一下：发现了好多解决方案.
​ 但是对于人和鼠的基因来说，人的基因多数是大写字母表示，而鼠是同源基因多数是首字母大写，其余字母小写。但仅仅首字母大写并不能完全实现人鼠基因转换。可以找到一一对应的基因列表，进行转换。因此本文使用其他方法进行人鼠基因的转换
0x02 转换方法 ​ 目前有的方法主要是大小写转换, 正则表达式匹配等, 但存在如TP53(human) 对应 Trp53(mouse)的情况. 为了解决这一问题, 还是要回到公共数据库进行检索匹配. 使用R包biomaRt进行.
library(&#34;biomaRt&#34;) #install ? ms.gene &lt;- c(&#34;Ptprc&#34;,&#34;Epcam&#34;, &#39;Mme&#39;,&#34;Cd3g&#34;, &#34;Cd79a&#34;,&#34;Trp53&#34;) # 用于转换的基因 listDatasets(useMart(&#34;ensembl&#34;)) # 查看ensembl数据库中可用的生物数据集 human=useMart(&#34;ensembl&#34;,&#34;hsapiens_gene_ensembl&#34;)	#检索到人类数据集 mouse=useMart(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c4923f5293b26120b7c37349c199702e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-09T23:20:16+08:00" />
<meta property="article:modified_time" content="2021-09-09T23:20:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Vol.1 人鼠基因转换</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="Vol1__0"></a>Vol.1 人鼠基因转换</h3> 
<p><em><strong>"像清风追着流云 望你时忽远忽近"</strong></em></p> 
<h4><a id="0x00%09_6"></a>0x00 写在前面</h4> 
<p>​ 又开了一个系列新坑, 这一系列的文章主要面向生物信息学, 尝试着从<em>R</em>和统计开始, 自己边学边写, 把遇到的一些问题展现出来.</p> 
<p>​ 这一系列可能会要求有R/生物信息学最基本的基础了解就够了,当然如果还不懂可以去公众号<u>三文鱼卷</u>, 搜索"<em><strong>科研工具箱</strong></em> "话题下相关内容.</p> 
<h4><a id="0x01%09_12"></a>0x01 问题的提出</h4> 
<p>​ 如果处理的是小鼠的基因芯片表达矩阵，最后做gsea等分析要对生物学数据库注释，发现绝大部分数据库都是人类的基因名字，有一个取巧的方法是把基因名字修改一下，如下所示：</p> 
<pre><code class="prism language-R">[1] "PTPRC" "EPCAM" "MME"   "CD3G"  "CD3E"  "CD68"  "CD79A" # 人基因
[1] "Ptprc" "Epcam" "Mme"   "Cd3g"  "Cd3e"  "Cd68"  "Cd79a"	# 鼠基因
</code></pre> 
<p>​ 然而,不同物种的基因对应关系是有相应的同源基因数据库的，不能仅仅是把基因名字修改。回归教程本身，人鼠基因转换之首字母大写在R语言的师兄，本着不想自己去造轮子的心态，搜索了一下：发现了好多解决方案.</p> 
<p>​ <strong>但是</strong>对于人和鼠的基因来说，人的基因多数是大写字母表示，而鼠是同源基因多数是首字母大写，其余字母小写。但仅仅首字母大写并不能完全实现人鼠基因转换。可以找到一一对应的基因列表，进行转换。因此本文使用其他方法进行人鼠基因的转换</p> 
<h4><a id="0x02%09_25"></a>0x02 转换方法</h4> 
<p>​ 目前有的方法主要是大小写转换, 正则表达式匹配等, 但存在如TP53(<em>human</em>) 对应 Trp53(<em>mouse</em>)的情况. 为了解决这一问题, 还是要回到公共数据库进行检索匹配. 使用R包<code>biomaRt</code>进行.</p> 
<pre><code class="prism language-R">library("biomaRt") #install ?
ms.gene &lt;- c("Ptprc","Epcam", 'Mme',"Cd3g", "Cd79a","Trp53") # 用于转换的基因

listDatasets(useMart("ensembl")) # 查看ensembl数据库中可用的生物数据集
human=useMart("ensembl","hsapiens_gene_ensembl")	#检索到人类数据集
mouse=useMart("ensembl","mmusculus_gene_ensembl")	#鼠
listAttributes(human) # 查看可用转换的参数
listAttributes(mouse)
# mgi_symbol 表示小鼠的基因名,hgnc_symbol表示人基因名
getLDS( 	#使用getLDS()将基因进行转换
  values = ms.gene,mart = mouse,
  attributes = "mgi_symbol",filters = "mgi_symbol", 
  martL=human,
  attributesL = c("hgnc_symbol","chromosome_name"))
  # 这里得到的结果都是相应的,所以不需要额外的filtersL参数了
  # 查询可知Attribute参数中有chromosome_name,因此可以同时显示对应基因在人体染色体位置等


#  MGI.symbol HGNC.symbol Chromosome.scaffold.name
#1      Cd79a       CD79A                       19
#2      Epcam       EPCAM                        2
#3      Ptprc       PTPRC                        1
#4       Cd3g        CD3G                       11
#5      Trp53        TP53                       17
#6        Mme         MME                        3

</code></pre> 
<p>​ 可以看到, 基因名转换的同时还可以得到如染色体位置, 起始点等诸多数据. mart文件~1Mb, 转换很方便. 当然也可以把这个函数进行封装, 造出自己的轮子.</p> 
<pre><code class="prism language-R">Ms2Hs &lt;- function(gene){
  require(biomaRt)
  human=useMart("ensembl","hsapiens_gene_ensembl")
  mouse=useMart("ensembl","mmusculus_gene_ensembl")
  geneTrans &lt;- getLDS(
    values = gene,mart = mouse,
    attributes = "mgi_symbol",filters = "mgi_symbol",
    attributesL = "hgnc_symbol",
    martL=human)
  hs.gene &lt;- as.vector(geneTrans$HGNC.symbol)
  names(hs.gene) &lt;- geneTrans$MGI.symbol
  return(hs.gene)}
Ms2Hs(ms.gene)
#  Cd79a   Epcam   Trp53    Cd3g   Ptprc     Mme    
#"CD79A" "EPCAM"  "TP53"  "CD3G" "PTPRC"   "MME" 

</code></pre> 
<h4><a id="0x03%09_79"></a>0x03 小结</h4> 
<p>​ 好困, 好饿, 今天该练胸了, 记得高碳水高蛋白.</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2a34dc72a2150cc39cfe205de54660ed/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue&#43;elementUI实现滚动加载请求接口</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2d6e31e9436976dbfb913ebf29cdc62e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">记一个httpservletrequest接受不到参数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>