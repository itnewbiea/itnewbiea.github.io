<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>android自定义Dialog，仿QQ手机浏览器 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="android自定义Dialog，仿QQ手机浏览器" />
<meta property="og:description" content="以前一直不大喜欢android系统的对话框，这两天上班比较空闲，就试着模仿一下QQ浏览器的对话框。 本来以前想写个类继承Dialog，但受水平限制，没有实现。主要代码如下：
public class CustomAlertDialog { private AlertDialog dialog; private LayoutInflater inflater; private Button leftBtn, midBtn, rightBtn; private LinearLayout titleLay, bottomLay; private ScrollView contentLay; private TextView title, contentMsg; private Context context; private View dialogView; public CustomAlertDialog(Context context) { this.context = context; inflater = LayoutInflater.from(context); dialogView = inflater.inflate(R.layout.dialog, null); bottomLay = (LinearLayout) dialogView.findViewById(R.id.dialog_btns); contentLay = (ScrollView) dialogView.findViewById(R.id.dialog_content_lay); dialog = new AlertDialog.Builder(context).create(); } public void show() { dialog.show(); dialog.getWindow().setContentView(dialogView); } public void dismiss() { if (dialog !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/db24cf869c0f1a8b07866d85ea4e6314/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2011-12-31T18:52:59+08:00" />
<meta property="article:modified_time" content="2011-12-31T18:52:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">android自定义Dialog，仿QQ手机浏览器</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    以前一直不大喜欢android系统的对话框，这两天上班比较空闲，就试着模仿一下QQ浏览器的对话框。 
<br> 
<p>本来以前想写个类继承Dialog，但受水平限制，没有实现。主要代码如下：</p> 
<p><br> </p> 
<p></p> 
<pre><code class="language-java">public class CustomAlertDialog
{
	private AlertDialog dialog;
	private LayoutInflater inflater;
	private Button leftBtn, midBtn, rightBtn;
	private LinearLayout titleLay, bottomLay;
	private ScrollView contentLay;
	private TextView title, contentMsg;
	private Context context;
	private View dialogView;
	
	public CustomAlertDialog(Context context)
	{
		this.context = context;
		inflater = LayoutInflater.from(context);
		dialogView = inflater.inflate(R.layout.dialog, null);
		
		bottomLay = (LinearLayout) dialogView.findViewById(R.id.dialog_btns);
		contentLay = (ScrollView) dialogView.findViewById(R.id.dialog_content_lay);
		dialog = new AlertDialog.Builder(context).create();
	}
	
	
	public void show() {
		dialog.show();
		dialog.getWindow().setContentView(dialogView);
	}
	
	public void dismiss() {
		if (dialog != null &amp;&amp; dialog.isShowing()) {
			dialog.dismiss();
		}
	}
	
	public boolean isShowing() {
		if (dialog != null)
			return dialog.isShowing();
		return false;
	}
	
	public void setCancelable(boolean bool) {
		dialog.setCancelable(bool);
	}
	
	public void setContentView(View view) {
		contentLay.removeAllViews();
		contentLay.addView(view);
	}
	
	public void setMessage(String msg) {
		contentMsg = (TextView) dialogView.findViewById(R.id.dialog_content);
		contentMsg.setText(msg);
		contentMsg.setVisibility(View.VISIBLE);
	}
	
	public void setTitle(String title) {
		titleLay = (LinearLayout) dialogView.findViewById(R.id.dialog_title_lay);
		this.title = (TextView) dialogView.findViewById(R.id.dialog_title);
		titleLay.setVisibility(View.VISIBLE);
		this.title.setText(title);
	}
	
	public void setOnPositiveButton(String str, View.OnClickListener listener) {
		bottomLay.setVisibility(View.VISIBLE);
		leftBtn = (Button) dialogView.findViewById(R.id.dialog_left_btn);
		leftBtn.setVisibility(View.VISIBLE);
		leftBtn.setText(str);
		leftBtn.setOnClickListener(listener);
	}
	
	public void setOnNegativeButton(String str, View.OnClickListener listener) {
		bottomLay.setVisibility(View.VISIBLE);
		rightBtn = (Button) dialogView.findViewById(R.id.dialog_right_btn);
		rightBtn.setVisibility(View.VISIBLE);
		rightBtn.setText(str);
		rightBtn.setOnClickListener(listener);
	}
	
	public void setOnNeutralButton(String str, View.OnClickListener listener) {
		bottomLay.setVisibility(View.VISIBLE);
		midBtn = (Button) dialogView.findViewById(R.id.dialog_mid_btn);
		midBtn.setVisibility(View.VISIBLE);
		midBtn.setText(str);
		midBtn.setOnClickListener(listener);
	}
}
</code></pre> 
<br> 这个对话框的布局由标题部分，内容部分，和底部按钮部分组成，最多3个按钮，需要哪些按钮，只要设置这些按钮的listener就可以显示出来；内容部分，可以设置为自定义的View，也可以是简单的一个TextView（通过setMessage方法）。布局如下dialog.xml： 
<br> 
<p></p> 
<p><br> </p> 
<p></p> 
<pre><code class="language-html">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="180dip" android:layout_height="160dip" &gt;
    &lt;LinearLayout android:id="@+id/dialog_title_lay" android:layout_width="fill_parent" android:layout_height="wrap_content"
        android:background="@drawable/alertdlg_title_bg" android:gravity="center_vertical" android:visibility="gone"&gt;
        &lt;TextView android:id="@+id/dialog_title" android:layout_width="fill_parent" android:layout_height="wrap_content"
	   		android:text="标题" android:textSize="18sp" android:textColor="#000000" android:textStyle="bold"
	   		android:layout_marginLeft="10dip" android:layout_marginRight="10dip"/&gt;
    &lt;/LinearLayout&gt;
	&lt;ScrollView android:id="@+id/dialog_content_lay" android:layout_width="fill_parent" android:layout_height="100dip"
        android:background="@drawable/alertdlg_content_bg" android:gravity="center" 
        android:layout_below="@id/dialog_title_lay"&gt;
	    &lt;TextView android:id="@+id/dialog_content" android:layout_width="wrap_content" android:layout_height="wrap_content"
	        android:text="内容" android:textSize="16sp" android:textColor="#000000" android:visibility="gone"
	        android:layout_marginLeft="10dip" android:layout_marginRight="10dip" android:layout_marginTop="10dip"/&gt;
    &lt;/ScrollView&gt;
    &lt;LinearLayout android:id="@+id/dialog_btns" android:layout_width="fill_parent" android:layout_height="wrap_content"
        android:background="@drawable/alertdlg_bottom_bg" android:layout_below="@id/dialog_content_lay"
        android:gravity="center" android:visibility="gone"&gt;
        &lt;Button android:id="@+id/dialog_left_btn" android:layout_width="wrap_content" android:layout_height="wrap_content"
            android:text="左按钮" android:background="@drawable/button_blue_normal" android:layout_marginRight="10dip"
            android:layout_marginLeft="10dip" android:layout_weight="1" android:visibility="gone"/&gt;
        &lt;Button android:id="@+id/dialog_mid_btn" android:layout_width="wrap_content" android:layout_height="wrap_content"
            android:text="中按钮" android:background="@drawable/button_blue_normal" android:layout_marginRight="10dip"
            android:layout_marginLeft="10dip" android:layout_weight="1" android:visibility="gone"/&gt;
        &lt;Button android:id="@+id/dialog_right_btn" android:layout_width="wrap_content" android:layout_height="wrap_content"
            android:text="右按钮" android:background="@drawable/button_blue_pressed" android:layout_marginRight="10dip"
            android:layout_marginLeft="10dip" android:layout_weight="1" android:visibility="gone"/&gt;
    &lt;/LinearLayout&gt;

&lt;/RelativeLayout&gt;</code></pre> 
<br> 测试界面，主要就2个按钮，主要看看不同的2个dialog，第一个显示3个按钮，中间内容是一个TextView；第二个显示一个按钮，中间是自定义的View： 
<p></p> 
<p></p> 
<pre><code class="language-java">public class TestCustomDialogActivity extends Activity {
	Button button1, button2;
	LayoutInflater inflater;
	CustomAlertDialog customAd;
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        button1 = (Button) findViewById(R.id.button1);
        button2 = (Button) findViewById(R.id.button2);
        inflater = LayoutInflater.from(this);
        button1.setOnClickListener(new OnClickListener()
		{
			
			@Override
			public void onClick(View v) {
				customAd = new CustomAlertDialog(TestCustomDialogActivity.this);
				customAd.setTitle("密码被盗");
				customAd.setMessage("互联网用户数据泄密事件继续发酵。继CSDN、天涯、新浪等互联网公司后，" +
						"京东商城、网易公司、支付宝也被卷入“泄密门”。昨日又有网友爆料称，交通银行和民生银行用户资料也遭外泄。" +
						"昨日中午，有爆料称交通银行7000万客户、民生银行3500万用户以及工行用户资料外泄，" +
						"泄露数据包括用户的姓名、卡号、密码等敏感信息，并发布信息截图。" +
						"对此，三家银行昨天均发布声明否认有用户资料外泄。业内专家也指出，银行卡交易系统不可能存在明文密码。");
				customAd.setOnPositiveButton("确定", new OnClickListener()
				{
					@Override
					public void onClick(View v)
					{
						Toast.makeText(TestCustomDialogActivity.this, "左按钮", Toast.LENGTH_SHORT).show();
						customAd.dismiss();
					}
				});
				
				customAd.setOnNeutralButton("其他", new OnClickListener()
				{
					@Override
					public void onClick(View v)
					{
						Toast.makeText(TestCustomDialogActivity.this, "中按钮", Toast.LENGTH_SHORT).show();
						customAd.dismiss();
					}
				});
				
				customAd.setOnNegativeButton("取消", new OnClickListener()
				{
					
					@Override
					public void onClick(View v)
					{
						Toast.makeText(TestCustomDialogActivity.this, "右按钮", Toast.LENGTH_SHORT).show();
						customAd.dismiss();
					}
				});
				customAd.setCancelable(false);
				customAd.show();
				
			}
		});
        
        button2.setOnClickListener(new OnClickListener()
		{
			
			@Override
			public void onClick(View v)
			{
				customAd = new CustomAlertDialog(TestCustomDialogActivity.this);
				View view = inflater.inflate(R.layout.dialog_content, null);
				customAd.setContentView(view);
				customAd.setTitle("退出");
				customAd.setOnPositiveButton("确定", new OnClickListener()
				{
					@Override
					public void onClick(View v)
					{
						Toast.makeText(TestCustomDialogActivity.this, "确定退出", Toast.LENGTH_SHORT).show();
						customAd.dismiss();
					}
				});
				customAd.setCancelable(true);
				customAd.show();
			}
		});
    }
    
}</code></pre> 
<br> 
<img src="https://images2.imgbox.com/4f/46/idD325mV_o.gif" alt=""> 
<br> 
<p></p> 
<p><img src="https://images2.imgbox.com/3d/2e/V3sFIhAV_o.gif" alt=""><br> </p> 
<p><br> </p> 
<p><img src="https://images2.imgbox.com/cf/0d/6yoOSvXW_o.gif" alt=""><br> </p> 
<p><br> </p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/781acaa641f9291c6abb52633e2db189/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mysql 左连接、右连接和内连接</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/550dd51755d027271d871b778a3c74d1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于DTS的软件测试管理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>