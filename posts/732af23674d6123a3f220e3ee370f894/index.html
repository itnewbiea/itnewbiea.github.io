<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue &#43; vue-json-excel 制作导出excel - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue &#43; vue-json-excel 制作导出excel" />
<meta property="og:description" content="项目场景： 项目场景：我目前有一个列表，功能可以筛选时间以及渠道，筛选出来的数据包含订单号字段，渲染在列表中，我需要把所有的订单号，根据时间渠道筛选后，把筛选后的所有订单号导出只Excel中。
这个功能一开始也是在网上找办法，但是也是不是很适用，这里就分享一下我的解决方案。
注：这里只提供思路及方法，直接复制就无法使用的，因为涉及到其他的组件（时间，渠道）就没有放全代码了,建议参考一下思路，然后用自己的方法来实现会比复制粘贴更好，授人以鱼不如授人以渔这个道理相信大家都懂。
效果 当点击导出则直接下载对应的数据，这里表头为Hader（可自定义），TrackingNo（必须）为订单号下面的为导出的数据，Startime（必须）：开始时间，Endtime（必须）：结束时间，LabelType：渠道：当为空时显示空。
1.安装并引入vue-json-excel： 我这里是通过npm的包管理器，并且进行全局引入的方式。
1.下载vue-json-excel npm i vue-json-excel 2.全局引入 在main.js中
//导入导出excel表格组件 import JsonExcel from &#39;vue-json-excel&#39; Vue.component(&#39;downloadExcel&#39;, JsonExcel) 2.页面中使用 1.HTML &lt;download-excel class=&#34;export-excel-wrapper&#34; :data = &#34;print&#34; :fields = &#34;json_fields&#34; type=&#34;csv&#34; header = &#34;Header&#34; name = &#34;filename&#34; style=&#34;width:100px;float: left;&#34; &gt; &lt;el-button style=&#34;margin-left:20px&#34; type=&#34;primary&#34;&gt;{{$t(&#39;export&#39;)}}&lt;/el-button&gt; &lt;/download-excel&gt; 2.JS export default { data(){ return{ print:[], json_fields:{} } }, methods(){ GetJsonFileds(val){ //导出 let params={ TrackingNo : this.photoinfo.waybill_number, StockID : this.StockInfovalue, LabelType : this.photoinfo.LabelType, Startime : this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/732af23674d6123a3f220e3ee370f894/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-08T14:04:25+08:00" />
<meta property="article:modified_time" content="2023-05-08T14:04:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue &#43; vue-json-excel 制作导出excel</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>项目场景：</h2> 
<p>项目场景：我目前有一个列表，功能可以筛选时间以及渠道，筛选出来的数据包含订单号字段，渲染在列表中，我需要把所有的订单号，根据时间渠道筛选后，把筛选后的所有订单号导出只Excel中。</p> 
<p>这个功能一开始也是在网上找办法，但是也是不是很适用，这里就分享一下我的解决方案。<br> <code>注：这里只提供思路及方法，直接复制就无法使用的，因为涉及到其他的组件（时间，渠道）就没有放全代码了,建议参考一下思路，然后用自己的方法来实现会比复制粘贴更好，授人以鱼不如授人以渔这个道理相信大家都懂。</code></p> 
<hr> 
<h2><a id="_8"></a>效果</h2> 
<p><img src="https://images2.imgbox.com/a4/9a/sNCUJa7P_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/74/04/L9odHiII_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>当点击导出则直接下载对应的数据，这里表头为Hader（可自定义），TrackingNo（必须）为订单号下面的为导出的数据，Startime（必须）：开始时间，Endtime（必须）：结束时间，LabelType：渠道：当为空时显示空。</p> 
</blockquote> 
<hr> 
<h2><a id="1vuejsonexcel_17"></a>1.安装并引入vue-json-excel：</h2> 
<p>我这里是通过npm的包管理器，并且进行全局引入的方式。</p> 
<h3><a id="1vuejsonexcel_19"></a>1.下载vue-json-excel</h3> 
<pre><code class="prism language-powershell">npm i vue-json-excel
</code></pre> 
<h3><a id="2_24"></a>2.全局引入</h3> 
<p>在main.js中</p> 
<pre><code class="prism language-javascript"><span class="token comment">//导入导出excel表格组件</span>
<span class="token keyword">import</span> JsonExcel <span class="token keyword">from</span> <span class="token string">'vue-json-excel'</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'downloadExcel'</span><span class="token punctuation">,</span> JsonExcel<span class="token punctuation">)</span>
</code></pre> 
<hr> 
<h2><a id="2_34"></a>2.页面中使用</h2> 
<h3><a id="1HTML_35"></a>1.HTML</h3> 
<pre><code class="prism language-html"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>download-excel</span> 
   <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>export-excel-wrapper<span class="token punctuation">"</span></span>
   <span class="token attr-name">:data</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>print<span class="token punctuation">"</span></span>
   <span class="token attr-name">:fields</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>json_fields<span class="token punctuation">"</span></span> 
   <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>csv<span class="token punctuation">"</span></span>
   <span class="token attr-name">header</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>Header<span class="token punctuation">"</span></span>
   <span class="token attr-name">name</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>filename<span class="token punctuation">"</span></span>
   <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>100px<span class="token punctuation">;</span><span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span>
 <span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">margin-left</span><span class="token punctuation">:</span>20px</span><span class="token punctuation">"</span></span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{$t('export')}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>download-excel</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3><a id="2JS_49"></a>2.JS</h3> 
<pre><code class="prism language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span><span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">print</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			<span class="token literal-property property">json_fields</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function">methods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		    <span class="token function">GetJsonFileds</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token comment">//导出</span>
      <span class="token keyword">let</span> params<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">TrackingNo</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>photoinfo<span class="token punctuation">.</span>waybill_number<span class="token punctuation">,</span>
        <span class="token literal-property property">StockID</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>StockInfovalue<span class="token punctuation">,</span>
        <span class="token literal-property property">LabelType</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>photoinfo<span class="token punctuation">.</span>LabelType<span class="token punctuation">,</span>
        <span class="token literal-property property">Startime</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>photoinfo<span class="token punctuation">.</span>starttime<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">Endtime</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>photoinfo<span class="token punctuation">.</span>starttime<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>photoinfo<span class="token punctuation">.</span>starttime<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>photoinfo<span class="token punctuation">.</span>starttime<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">warning</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$t</span><span class="token punctuation">(</span><span class="token string">'Unselected_time'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span>LabelType <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        params<span class="token punctuation">.</span>LabelType <span class="token operator">=</span> <span class="token string">''</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        params<span class="token punctuation">.</span>LabelType <span class="token operator">=</span> params<span class="token punctuation">.</span>LabelType<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$api<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/Shipment/DownTrackingNoPhotodata'</span><span class="token punctuation">,</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>return_codes<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>print <span class="token operator">=</span> res<span class="token punctuation">.</span>return_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Date
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>print<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$t</span><span class="token punctuation">(</span><span class="token string">'Data_in_this_time_range_is_null'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">!=</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> val <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$t</span><span class="token punctuation">(</span><span class="token string">'exporting'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>print<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Startime <span class="token operator">=</span> res<span class="token punctuation">.</span>return_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Startime <span class="token operator">||</span> <span class="token string">'empty'</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>print<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Endtime <span class="token operator">=</span> res<span class="token punctuation">.</span>return_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Endtime <span class="token operator">||</span> <span class="token string">'empty'</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>print<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>LabelType <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>photoinfo<span class="token punctuation">.</span>LabelType <span class="token operator">||</span> <span class="token string">'empty'</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>json_fields<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">TrackingNo</span><span class="token operator">:</span><span class="token string">'TrackingNo'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">Startime</span><span class="token operator">:</span><span class="token string">'Startime'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">Endtime</span><span class="token operator">:</span><span class="token string">'Endtime'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">LabelType</span><span class="token operator">:</span><span class="token string">'LabelType'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$t</span><span class="token punctuation">(</span><span class="token string">'operation_failed'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_108"></a>字段说明</h3> 
<ol><li>class：类</li><li>data：这个data是需要打印的数据</li><li>fields：打印格式</li><li>type：导出的类型</li><li>header：头</li><li>name：导出的文件名</li><li>style：样式</li></ol> 
<h3><a id="_116"></a>实现逻辑</h3> 
<p>首先我这里有一个时间选择控件和渠道控件将这些控件的值改变时就会触发<code>GetJsonFileds</code>函数，并且会带值，证明是渠道或者时间，这个后面会用到。</p> 
<p>先说一下为什么要这样子做，因为我在做完之后发现一个很严重的问题，就是这个导出的逻辑是，通过读取<code>data</code>里面的值，通过<code>fields</code>导出来的，这样子就会出现一个问题，就是<strong>数据的更新是在导出的后面的</strong>所以导出的数据要么为空导不出来，要么是上一次的数据。</p> 
<p>所以这里就想到这个办法，在选择时间控件的时候，就先去触发函数进行预处理，先把数据处理好，因为时间这里是必选，所以放在时间上没有问题，如果不选择时间的话，这里<code>this.photoinfo.starttime.length</code>便会直接跳出提示需要输入时间。</p> 
<p>但是这样子又还有一个问题就是先选完时间之后再去选择渠道最后打印渠道又是慢一步的，按照同样的方法的话，渠道又不是必选的，所以这里又要在判断一次，通过渠道传入的2在判断，这里的话就分两种情况来处理，一时先选择时间，二是先选择渠道，如果先选择渠道则不需要动直接return，但是如果先选择的是时间的话，在选择渠道就需要重新更新数据，使用直接拿时间的值就好了，能拿到到就说明是先选择的时间。</p> 
<p>这里注意一个重要的逻辑，导出的事件是放在按钮上的，而导出的数据是放在时间控件值改变上的。<br> 处理好这个之后便可以去调用后台接口去拿数据，拿到数据之后直接传给<code>print</code>，并且判断是不是为空，如果为空就是证明这个时间段是没有数据的一样跳出，这里的话也可以直接判断后端的返回数据都一样的。</p> 
<p>现在拿到后端数据并且确定有数据之后将数据写入到print里面，并且修改它的格式。</p> 
<h2><a id="_129"></a>总结</h2> 
<p>这里要注意一个坑：<strong>目前我看到网上其他的都没有说到这一点，当导出的数据为动态数据的时候，如果fields在data中定义的话那么最终导出的数据都是上一次的数据，所以我这里的方法是在选择完对应筛选信息后先去更新一遍数据，在后续导出时保证导出的是最新的筛选数据。</strong></p> 
<p>这个导出的流程为：</p> 
<p>先选择渠道</p> 
<ol><li>选择渠道</li><li>渠道值改变触发函数，但是函数并没有什么操作</li><li>选择时间</li><li>时间值改变更新数据，这里会将渠道的值一起更新过去</li><li>导出</li></ol> 
<p>先选择时间</p> 
<ol><li>选择时间</li><li>时间的值改变，更新数据，但是此时渠道的值为空</li><li>选择渠道</li><li>渠道值改变，重新更新数据，此时会带上渠道的值，时间的值一致</li><li>导出</li></ol> 
<p>以上就是我解决这个方法的思路</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ee1325d1852d526da179caf8f4bac54b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">语雀版《广西骚戴软考独家笔记》软考最好的笔记，只看笔记就能获得高分，软件设计师</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7aabaf349160d42acf39b089b84b9ba7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">idea如何实现Servlet程序</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>