<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Oracle体系结构篇之数据文件 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Oracle体系结构篇之数据文件" />
<meta property="og:description" content="目录
一、概述
1.1、数据文件
1.2、存储结构分类
二、物理存储结构
2.1、操作系统数据块
2.2、数据文件
三、逻辑存储结构
3.1、表空间
3.2、段
3.3、区
3.4、块
在开始介绍数据文件之前，我们先先回顾下数据库包含哪些文件？
有参数文件、控制文件、数据文件、重做日志文件、归档日志文件、跟踪文件、口令文件、警告文件等。具体介绍请查看：Oracle体系结构篇之数据库
一、概述 1.1、数据文件 数据文件是指存储数据库中数据的文件，这些“xxxx.dbf”存储着系统数据、数据字典数据、索引数据以及用户存储的数据，所以这部分也是数据库最核心的部分。数据文件大小是灵活的，可以通过设置让它自动扩展，避免了数据量过大但是数据文件空间有限这种状况； 数据文件是专属于一个数据库的，也专属于一个表空间的，但是一个表空间却可以拥有多个数据文件。
1.2、存储结构分类 数据文件按照存储结构可以分为物理存储结构和逻辑逻辑结构。
二、物理存储结构 这个就很好理解了，就是保存在磁盘空间上的数据，以文件的形式组织在一起，是一些能看得见，实际存在的东西，大白话就是一类文件组成了Oracle的数据文件的物理存储结构。
2.1、操作系统数据块 操作系统数据块是文件系统所使用的最小分配单元。数据库就是搭建在操作系统数据块基础上。
2.2、数据文件 保存Oracle数据的操作系统文件，用户可以在操作系统中浏览到数据库的数据文件。数据库创建时会创建对应数据文件，数据文件中保存着数据字典和用户数据等信息。
可以在数据库中查看数据文件信息：
SELECT * FROM DBA_DATA_FILES;
三、逻辑存储结构 在oracle数据库中，对数据库操作会涉及逻辑存储结构，它是从逻辑角度分析数据库的构成，描述的是数据库内部数据的组织与管理方式，与操作系统没有关系。主要包括表空间、段、区和数据块，所有的结构都是一对多的关系，一个数据库可以拥有多个表空间，一个表空间拥有多个段等等。
3.1、表空间 Oracle 数据库是由若干个表空间构成的。任何数据库对象在存储时都必须存储在某个表空间中。表空间对应于若干个磁盘文件，即表空间是由一个或多个磁盘文件 构成的。表空间相当于操作系统中的文件夹，也是数据库逻辑结构与物理文件之间的一个映 射。每个数据库至少有一个表空间，表空间的大小等于所有从属于它的数据文件大小的总和。
可在数据库中查看表空间信息
SELECT * FROM DBA_TABLESPACES;
常用表空间：
1）SYSTEM 系统表空间
SYSTEM表空间包含数据字典，是数据库的大脑，没有SYSTEM表空间，数据库就无法运转。数据字典表存储在编号为 1 的数据文件中。
所有和 PL/SQL 程序结构（包括过程（procedure），函数（function），包（package），及触发器（trigger））有关的数据都被保存在 SYSTEM 表空间中。如果数据库中用户定义的程序结构很多，那么管理员必须为之在 SYSTEM 表空间中提供足够的空间。
SYSTEM表空间特性:
不能脱机offline不能置为只读read only不能重命名不能删除 2）SYSAUX 表空间
Sysaux 主要作用就是减轻system表空间的压力，部分的程序与工具放在sysaux表空间中。
在Oracle 10g 版本中，引入了SYSTEM表空间的一个辅助表空间： SYSAUX表空间。
SYSAUX 表空间存放一些其他的metadata组件，如OEM,Streams 等会默认存放在SYSAUX表空间里。这样也能降低SYSTEM表空间的负载。 因此SYSAUX 表空间也是在在DB 创建或者升级时自动创建的。 如果在手工使用SQL创建DB时没有指定SYSAUX tablespace，那么创建语句会报错。 无法执行。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/1f2f3cf601787633e0bf44af0f889b5c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-14T16:20:41+08:00" />
<meta property="article:modified_time" content="2021-12-14T16:20:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Oracle体系结构篇之数据文件</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%E6%A6%82%E8%BF%B0-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E6%A6%82%E8%BF%B0" rel="nofollow" title="一、概述">一、概述</a></p> 
<p id="1.1%E3%80%81%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6-toc" style="margin-left:40px;"><a href="#1.1%E3%80%81%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6" rel="nofollow" title="1.1、数据文件">1.1、数据文件</a></p> 
<p id="1.2%E3%80%81%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84%E5%88%86%E7%B1%BB-toc" style="margin-left:40px;"><a href="#1.2%E3%80%81%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84%E5%88%86%E7%B1%BB" rel="nofollow" title="1.2、存储结构分类">1.2、存储结构分类</a></p> 
<p id="%E4%BA%8C%E3%80%81%E7%89%A9%E7%90%86%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E7%89%A9%E7%90%86%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84" rel="nofollow" title="二、物理存储结构">二、物理存储结构</a></p> 
<p id="2.1%E3%80%81%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%9D%97-toc" style="margin-left:40px;"><a href="#2.1%E3%80%81%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%9D%97" rel="nofollow" title="2.1、操作系统数据块">2.1、操作系统数据块</a></p> 
<p id="2.2%E3%80%81%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6-toc" style="margin-left:40px;"><a href="#2.2%E3%80%81%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6" rel="nofollow" title="2.2、数据文件">2.2、数据文件</a></p> 
<p id="%E4%B8%89%E3%80%81%E9%80%BB%E8%BE%91%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81%E9%80%BB%E8%BE%91%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84" rel="nofollow" title="三、逻辑存储结构">三、逻辑存储结构</a></p> 
<p id="3.1%E3%80%81%E8%A1%A8%E7%A9%BA%E9%97%B4-toc" style="margin-left:40px;"><a href="#3.1%E3%80%81%E8%A1%A8%E7%A9%BA%E9%97%B4" rel="nofollow" title="3.1、表空间">3.1、表空间</a></p> 
<p id="3.2%E3%80%81%E6%AE%B5-toc" style="margin-left:40px;"><a href="#3.2%E3%80%81%E6%AE%B5" rel="nofollow" title="3.2、段">3.2、段</a></p> 
<p id="3.3%E3%80%81%E5%8C%BA-toc" style="margin-left:40px;"><a href="#3.3%E3%80%81%E5%8C%BA" rel="nofollow" title="3.3、区">3.3、区</a></p> 
<p id="3.4%E3%80%81%E5%9D%97-toc" style="margin-left:40px;"><a href="#3.4%E3%80%81%E5%9D%97" rel="nofollow" title="3.4、块">3.4、块</a></p> 
<hr id="hr-toc"> 
<p>在开始介绍数据文件之前，我们先先回顾下数据库包含哪些文件？</p> 
<p>有参数文件、控制文件、<strong>数据文件</strong>、重做日志文件、归档日志文件、跟踪文件、口令文件、警告文件等。具体介绍请查看：<a class="link-info" href="https://blog.csdn.net/Flychuer/article/details/121636932?spm=1001.2014.3001.5501" title="Oracle体系结构篇之数据库">Oracle体系结构篇之数据库</a></p> 
<h2 id="%E4%B8%80%E3%80%81%E6%A6%82%E8%BF%B0">一、概述</h2> 
<h3 id="1.1%E3%80%81%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6">1.1、数据文件</h3> 
<p>数据文件是指存储数据库中数据的文件，这些“xxxx.dbf”存储着系统数据、数据字典数据、索引数据以及用户存储的数据，所以这部分也是数据库最核心的部分。数据文件大小是灵活的，可以通过设置让它自动扩展，避免了数据量过大但是数据文件空间有限这种状况； <strong>数据文件是专属于一个数据库的，也专属于一个表空间的，但是一个表空间却可以拥有多个数据文件</strong>。</p> 
<h3 id="1.2%E3%80%81%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84%E5%88%86%E7%B1%BB">1.2、存储结构分类</h3> 
<p>数据文件按照存储结构可以分为物理存储结构和逻辑逻辑结构。</p> 
<h2 id="%E4%BA%8C%E3%80%81%E7%89%A9%E7%90%86%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84">二、物理存储结构</h2> 
<p>这个就很好理解了，就是保存在磁盘空间上的数据，以文件的形式组织在一起，是一些能看得见，实际存在的东西，大白话就是一类文件组成了Oracle的数据文件的物理存储结构。</p> 
<p><img alt="" height="184" src="https://images2.imgbox.com/c1/cb/e0fIE18z_o.png" width="508"></p> 
<h3 id="2.1%E3%80%81%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%9D%97">2.1、操作系统数据块</h3> 
<p>操作系统数据块是文件系统所使用的最小分配单元。数据库就是搭建在操作系统数据块基础上。</p> 
<h3 id="2.2%E3%80%81%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6">2.2、数据文件</h3> 
<p>保存Oracle数据的操作系统文件，用户可以在操作系统中浏览到数据库的数据文件。数据库创建时会创建对应数据文件，数据文件中保存着数据字典和用户数据等信息。</p> 
<p>可以在数据库中查看数据文件信息：</p> 
<blockquote> 
 <p>SELECT * FROM DBA_DATA_FILES;</p> 
</blockquote> 
<h2 id="%E4%B8%89%E3%80%81%E9%80%BB%E8%BE%91%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84">三、逻辑存储结构</h2> 
<p>在oracle数据库中，对数据库操作会涉及逻辑存储结构，它是从逻辑角度分析数据库的构成，描述的是数据库内部数据的组织与管理方式，与操作系统没有关系。主要包括表空间、段、区和数据块，所有的结构都是一对多的关系，一个数据库可以拥有多个表空间，一个表空间拥有多个段等等。</p> 
<p><img alt="" height="521" src="https://images2.imgbox.com/47/97/zTaBqPOY_o.png" width="556"></p> 
<h3 id="3.1%E3%80%81%E8%A1%A8%E7%A9%BA%E9%97%B4">3.1、表空间</h3> 
<p>Oracle 数据库是由若干个表空间构成的。任何数据库对象在存储时都必须存储在某个表空间中。表空间对应于若干个磁盘文件，即表空间是由一个或多个磁盘文件 构成的。表空间相当于操作系统中的文件夹，也是数据库逻辑结构与物理文件之间的一个映 射。每个数据库至少有一个表空间，表空间的大小等于所有从属于它的数据文件大小的总和。</p> 
<p>可在数据库中查看表空间信息</p> 
<blockquote> 
 <p>SELECT * FROM DBA_TABLESPACES;</p> 
</blockquote> 
<p id="常用表空间"><strong>常用表空间：</strong></p> 
<p><strong>1）SYSTEM 系统表空间</strong></p> 
<p>SYSTEM表空间包含数据字典，是数据库的大脑，没有SYSTEM表空间，数据库就无法运转。数据字典表存储在编号为 1 的数据文件中。</p> 
<p>所有和 PL/SQL 程序结构（包括过程（procedure），函数（function），包（package），及触发器（trigger））有关的数据都被保存在 SYSTEM 表空间中。如果数据库中用户定义的程序结构很多，那么管理员必须为之在 SYSTEM 表空间中提供足够的空间。</p> 
<p>SYSTEM表空间特性:</p> 
<ul><li>不能脱机offline</li><li>不能置为只读read only</li><li>不能重命名</li><li>不能删除</li></ul> 
<p><strong>2）SYSAUX 表空间</strong></p> 
<p>Sysaux 主要作用就是减轻system表空间的压力，部分的程序与工具放在sysaux表空间中。</p> 
<p>在Oracle 10g 版本中，引入了SYSTEM表空间的一个辅助表空间： SYSAUX表空间。</p> 
<p>SYSAUX 表空间存放一些其他的metadata组件，如OEM,Streams 等会默认存放在SYSAUX表空间里。这样也能降低SYSTEM表空间的负载。 因此SYSAUX 表空间也是在在DB 创建或者升级时自动创建的。 如果在手工使用SQL创建DB时没有指定SYSAUX tablespace，那么创建语句会报错。 无法执行。</p> 
<p>在正常操作下， 不能drop 和rename SYSAUX 表空间。 如果SYSAUX 表空间不可用时， 数据库的核心功能还是可以继续运行的。只是一些存放在SYSAUX表空间里的功能收到限制，就如我们之前说的OEM。</p> 
<p>参考：<a class="link-info" href="http://blog.itpub.net/29532781/viewspace-1174673/" rel="nofollow" title="oracle 系统表空间 ">oracle 系统表空间 </a></p> 
<p><strong>3）临时表空间</strong></p> 
<p>临时表空间用来管理数据库排序操作以及用于存储临时表、中间排序结果等临时对象,当ORACLE里需要用到SORT的时候，并且当PGA中sort_area_size大小不够时，将会把数据放入临时表空间里进行排序。像数据库中一些操作： CREATE INDEX、 ANALYZE、SELECT DISTINCT、ORDER BY、GROUP BY、 UNION ALL、 INTERSECT、MINUS、SORT-MERGE JOINS、HASH JOIN等都可能会用到临时表空间。当操作完成后，系统会自动清理临时表空间中的临时对象，自动释放临时段。这里的释放只是标记为空闲、可以重用，其实实质占用的磁盘空间并没有真正释放。这也是临时表空间有时会不断增大的原因。</p> 
<p>临时表空间存储大规模排序操作(小规模排序操作会直接在RAM里完成，大规模排序才需要磁盘排序Disk Sort)和散列操作的中间结果.它跟永久表空间不同的地方在于它由临时数据文件（temporary files）组成的,而不是永久数据文件（datafiles）。临时表空间不会存储永久类型的对象，所以它不会也不需要备份。另外，对临时数据文件的操作不产生redo日志，不过会生成undo日志。</p> 
<p>创建临时表空间或临时表空间添加临时数据文件时，即使临时数据文件很大，添加过程也相当快。这是因为ORACLE的临时数据文件是一类特殊的数据文件:稀疏文件（Sparse File）,当临时表空间文件创建时，它只会写入文件头部和最后块信息(only writes to the header and last block of the file)。它的空间是延后分配的.这就是你创建临时表空间或给临时表空间添加数据文件飞快的原因。</p> 
<p>另外，临时表空间是NOLOGGING模式以及它不保存永久类型对象，因此即使数据库损毁，做Recovery也不需要恢复Temporary Tablespace。</p> 
<p>参考：<a class="link-info" href="https://www.cnblogs.com/zhangyingai/p/7082594.html" rel="nofollow" title="ORACLE临时表空间总结">ORACLE临时表空间总结</a></p> 
<p><strong>4）UNDO表空间</strong></p> 
<p>用来保存事务的回退信息，用户不能在其中创建数据库对象。</p> 
<p>参考：<a class="link-info" href="https://www.cnblogs.com/lijiaman/p/7617351.html" rel="nofollow" title="[Oracle]理解undo表空间">[Oracle]理解undo表空间</a></p> 
<h3 id="3.2%E3%80%81%E6%AE%B5">3.2、段</h3> 
<p>段是一组盘区，它是一个独立的逻辑存储结构，用于存储具有独立存储结构对象的全部数据。段一般是数据库终端用户处理最小的存储单位，当段的数据区已满，Oracle为其分配另一个数据区，段的数据区在磁盘上可能是不连续的。根据段所存储的特征，可将其分为5种类型： </p> 
<ul><li>数据段：用来存储表中所有数据；在Oracle中，每当用户创建一个表时，系统将自动在默认表空间里分配一个与表名称相同的数据段，方便存储该表的所有数据。</li><li>索引段：用来存储表中索引的所有数据；在Oracle中，每当用户创建索引时，系统将自动在默认表空间创建一个与索引名称相同的索引段，方便存储该索引的所有数据。</li><li>临时段： 用于存储表排序或汇总时产生的临时数据；每当用户：</li><li>临时表空间进行Order by 进行排列或汇总时，系统在该用户的临时表空间自动创建一个临时段，在操作结束时自动消除。</li><li>LOB段：LOB用来存储表中大型数据对象，例如CLOB与BLOB</li><li>回退段：用于存储用户数据被修改之前的位置和值；当与要对用户的数据进行回退操作时，就要使用回退段。</li></ul> 
<p>可在数据库中查看段信息 </p> 
<blockquote> 
 <p>SELECT * FROM DBA_SEGMENTS;</p> 
</blockquote> 
<h3 id="3.3%E3%80%81%E5%8C%BA">3.3、区</h3> 
<p>区是Oracle存储分配的最小单位，它是由一个或多个数据块组成的。一个或多个区组成一个段，也就是说段的大小都是由区的个数来决定。当一个段的空间使用完之后，Oracle会自动为该字段分配成一个新的区，<strong>一个数据区不能跨越多个文件</strong>。</p> 
<p>可在数据库中查看区信息 </p> 
<blockquote> 
 <p>SELECT * FROM DBA_EXTENTS;</p> 
</blockquote> 
<h3 id="3.4%E3%80%81%E5%9D%97">3.4、块</h3> 
<p>块是用来管理存储空间的最基本的单位，也是最小的逻辑存储单位。块的大小由初始化参数db_block_size来决定，不同的Oracle版本的大小是不同的，但是数据库一旦创建，其大小便不可更改。虽然每个数据块可以存储不同类型的数据，但是每个数据块都具有一个相同的结构，如图： </p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/6f/d5/mygOoXfe_o.png"></p> 
<ul><li>块头：包含了该数据块一般的属性信息，如数据块的物理地址、所属段类型等</li><li>表目录：如果数据块中存储的数据时某个表的数据，则这里存放该表的信息</li><li>行目录：用来存储数据块中有效的行信息</li><li>空余空间：指数据块还没有使用的存储空间</li><li>行空间：表或者索引的数据存储在行空间中，所以行空间是数据块中已经使用的存储空间。</li></ul> 
<p>所以从描述就可以看出来，一个数据块的容量其实就是行空间与空余空间的容量总和。</p> 
<p>特别注意的是，这里的“块”是Oracle的“数据块”，不是操作系统的“块”。</p> 
<p>Oracle每次请求数据的时候，都是以块为单位。也就是说，Oracle每次请求的数据是块的整数倍。如果Oracle请求的数据量不到一块，Oracle也会读取整个块。所以说，“块”是Oracle读写数据的最小单位或者最基本的单位。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/87fed7735c2ebb59cfd1ab368373c4bb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Type-c桌面显示器方案（90W充电&#43;数据传输&#43;视频传输 办公娱乐一体桌面显示器）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9c524d5446c0b38ed905d18e64e7710b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Ubuntu18.04成功安装QT5.15的避坑步骤</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>