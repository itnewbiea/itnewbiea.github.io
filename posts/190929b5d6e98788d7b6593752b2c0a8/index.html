<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android的Broadcast应用说明一例 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android的Broadcast应用说明一例" />
<meta property="og:description" content="程序A的Receiver：
receiver = new BroadcastReceiver() {
@Override
public void onReceive(Context ctx, Intent intent) {
Log.i(&#34;TestActivity&#34;, &#34;===============Broadcast Received:&#34; &#43; intent.getAction());
if (intent.getAction().equals(RESPONSE_ACTION)) {
Uri uri = intent.getData();
String location = &#34;&#34;;
if (uri != null) {
Log.i(&#34;TestActivity&#34;,
&#34;=======================parameter location:&#34;
&#43; uri.getQueryParameter(&#34;location&#34;));
Log.i(&#34;TestActivity&#34;, &#34;======================= host:&#34;
&#43; uri.getHost());
Log.i(&#34;TestActivity&#34;, &#34;======================= path:&#34;
&#43; uri.getPath());
location = uri.getQueryParameter(&#34;location&#34;);
FileInputStream fis = null;
ByteArrayOutputStream bos = null;
File file = new File(location);
try {
fis = new FileInputStream(file);" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/190929b5d6e98788d7b6593752b2c0a8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-07-02T23:29:16+08:00" />
<meta property="article:modified_time" content="2019-07-02T23:29:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android的Broadcast应用说明一例</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <p>程序A的Receiver：</p> 
 <div style="border-right:#cccccc 1px solid;border-top:#cccccc 1px solid;font-size:13px;border-left:#cccccc 1px solid;border-bottom:#cccccc 1px solid;"> 
  <img id="Codehighlighter1_35_1673_Open_Image" alt="" src="https://images2.imgbox.com/e4/0a/Lz2NQder_o.gif" align="top"> 
  <img id="Codehighlighter1_35_1673_Closed_Image" alt="" src="https://images2.imgbox.com/da/24/09IYDrpZ_o.gif" align="top"> 
  <span style="color:#000000;">receiver </span> 
  <span style="color:#000000;">=</span> 
  <span style="color:#000000;"> </span> 
  <span style="color:#0000ff;">new</span> 
  <span style="color:#000000;"> BroadcastReceiver() </span> 
  <span id="Codehighlighter1_35_1673_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/9d/0a/Hcj9CFC6_o.gif"></span> 
  <span id="Codehighlighter1_35_1673_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/fc/8c/BbuxzmQi_o.gif" align="top"><br><img alt="" src="https://images2.imgbox.com/f2/83/RsUIWwuA_o.gif" align="top">            @Override<br><img id="Codehighlighter1_104_1668_Open_Image" alt="" src="https://images2.imgbox.com/ef/be/tnIPXoKq_o.gif" align="top"><img id="Codehighlighter1_104_1668_Closed_Image" alt="" src="https://images2.imgbox.com/90/1d/4XxPigIG_o.gif" align="top">            </span><span style="color:#0000ff;">public</span><span style="color:#000000;"> </span><span style="color:#0000ff;">void</span><span style="color:#000000;"> onReceive(Context ctx, Intent intent) </span><span id="Codehighlighter1_104_1668_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/17/60/mXWxcbBP_o.gif"></span><span id="Codehighlighter1_104_1668_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/24/00/pVPLNOup_o.gif" align="top">                Log.i(</span><span style="color:#000000;">"</span><span style="color:#000000;">TestActivity</span><span style="color:#000000;">"</span><span style="color:#000000;">, </span><span style="color:#000000;">"</span><span style="color:#000000;">===============Broadcast Received:</span><span style="color:#000000;">"</span><span style="color:#000000;"> </span><span style="color:#000000;">+</span><span style="color:#000000;"> intent.getAction());<br><img id="Codehighlighter1_244_1663_Open_Image" alt="" src="https://images2.imgbox.com/05/73/zh0YmYrS_o.gif" align="top"><img id="Codehighlighter1_244_1663_Closed_Image" alt="" src="https://images2.imgbox.com/84/b1/qaRgmJqt_o.gif" align="top">                </span><span style="color:#0000ff;">if</span><span style="color:#000000;"> (intent.getAction().equals(RESPONSE_ACTION)) </span><span id="Codehighlighter1_244_1663_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/c8/d8/VT6rBV1u_o.gif"></span><span id="Codehighlighter1_244_1663_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/a3/f0/jtceiesh_o.gif" align="top">                    Uri uri </span><span style="color:#000000;">=</span><span style="color:#000000;"> intent.getData();<br><img alt="" src="https://images2.imgbox.com/92/e5/j7v9bhl9_o.gif" align="top">                    String location </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#000000;">""</span><span style="color:#000000;">;<br><img id="Codehighlighter1_328_1657_Open_Image" alt="" src="https://images2.imgbox.com/f4/84/mwy2PJSr_o.gif" align="top"><img id="Codehighlighter1_328_1657_Closed_Image" alt="" src="https://images2.imgbox.com/32/bb/OEGZuJbq_o.gif" align="top">                    </span><span style="color:#0000ff;">if</span><span style="color:#000000;"> (uri </span><span style="color:#000000;">!=</span><span style="color:#000000;"> </span><span style="color:#0000ff;">null</span><span style="color:#000000;">) </span><span id="Codehighlighter1_328_1657_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/b7/da/EkquoxzB_o.gif"></span><span id="Codehighlighter1_328_1657_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/98/42/5kD19WNG_o.gif" align="top">                        Log.i(</span><span style="color:#000000;">"</span><span style="color:#000000;">TestActivity</span><span style="color:#000000;">"</span><span style="color:#000000;">,<br><img alt="" src="https://images2.imgbox.com/56/7a/P8xFMBo3_o.gif" align="top">                                </span><span style="color:#000000;">"</span><span style="color:#000000;">=======================parameter location:</span><span style="color:#000000;">"</span><span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/ac/d1/HCBkAt3x_o.gif" align="top">                                        </span><span style="color:#000000;">+</span><span style="color:#000000;"> uri.getQueryParameter(</span><span style="color:#000000;">"</span><span style="color:#000000;">location</span><span style="color:#000000;">"</span><span style="color:#000000;">));<br><img alt="" src="https://images2.imgbox.com/2d/5a/mEGxD1vd_o.gif" align="top">                        Log.i(</span><span style="color:#000000;">"</span><span style="color:#000000;">TestActivity</span><span style="color:#000000;">"</span><span style="color:#000000;">, </span><span style="color:#000000;">"</span><span style="color:#000000;">======================= host:</span><span style="color:#000000;">"</span><span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/89/1c/cOV61EnO_o.gif" align="top">                                </span><span style="color:#000000;">+</span><span style="color:#000000;"> uri.getHost());<br><img alt="" src="https://images2.imgbox.com/6d/16/C1Iv81Of_o.gif" align="top">                        Log.i(</span><span style="color:#000000;">"</span><span style="color:#000000;">TestActivity</span><span style="color:#000000;">"</span><span style="color:#000000;">, </span><span style="color:#000000;">"</span><span style="color:#000000;">======================= path:</span><span style="color:#000000;">"</span><span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/03/4e/1Hn1NNAo_o.gif" align="top">                                </span><span style="color:#000000;">+</span><span style="color:#000000;"> uri.getPath());<br><img alt="" src="https://images2.imgbox.com/f8/49/1osxZQBG_o.gif" align="top">                        location </span><span style="color:#000000;">=</span><span style="color:#000000;"> uri.getQueryParameter(</span><span style="color:#000000;">"</span><span style="color:#000000;">location</span><span style="color:#000000;">"</span><span style="color:#000000;">);<br><img alt="" src="https://images2.imgbox.com/50/09/JWPfuUtx_o.gif" align="top">                        FileInputStream fis </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#0000ff;">null</span><span style="color:#000000;">;<br><img alt="" src="https://images2.imgbox.com/ee/0d/kDOgfs4x_o.gif" align="top">                        ByteArrayOutputStream bos </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#0000ff;">null</span><span style="color:#000000;">;<br><img alt="" src="https://images2.imgbox.com/95/87/2qCHPUVS_o.gif" align="top">                        File file </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#0000ff;">new</span><span style="color:#000000;"> File(location);<br><img id="Codehighlighter1_805_1216_Open_Image" alt="" src="https://images2.imgbox.com/2f/99/XdDIicdI_o.gif" align="top"><img id="Codehighlighter1_805_1216_Closed_Image" alt="" src="https://images2.imgbox.com/cc/a9/kvGN1BwI_o.gif" align="top">                        </span><span style="color:#0000ff;">try</span><span style="color:#000000;"> </span><span id="Codehighlighter1_805_1216_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/58/7f/PjaQ05x9_o.gif"></span><span id="Codehighlighter1_805_1216_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/df/4e/S06b5xTo_o.gif" align="top">                            fis </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#0000ff;">new</span><span style="color:#000000;"> FileInputStream(file);<br><img alt="" src="https://images2.imgbox.com/c8/04/w2gF5BI2_o.gif" align="top">                            bos </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#0000ff;">new</span><span style="color:#000000;"> ByteArrayOutputStream();<br><img alt="" src="https://images2.imgbox.com/3f/95/F90sc3un_o.gif" align="top">                            </span><span style="color:#0000ff;">byte</span><span style="color:#000000;">[] data </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#0000ff;">new</span><span style="color:#000000;"> </span><span style="color:#0000ff;">byte</span><span style="color:#000000;">[</span><span style="color:#000000;">512</span><span style="color:#000000;">];<br><img alt="" src="https://images2.imgbox.com/94/17/ru7s29kh_o.gif" align="top">                            </span><span style="color:#0000ff;">int</span><span style="color:#000000;"> count </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#000000;">-</span><span style="color:#000000;">1</span><span style="color:#000000;">;<br><img id="Codehighlighter1_994_1038_Open_Image" alt="" src="https://images2.imgbox.com/62/d7/0uRAD9pd_o.gif" align="top"><img id="Codehighlighter1_994_1038_Closed_Image" alt="" src="https://images2.imgbox.com/ab/11/k7y7h33c_o.gif" align="top">                            </span><span style="color:#0000ff;">while</span><span style="color:#000000;"> ((count </span><span style="color:#000000;">=</span><span style="color:#000000;"> fis.read(data)) </span><span style="color:#000000;">!=</span><span style="color:#000000;"> </span><span style="color:#000000;">-</span><span style="color:#000000;">1</span><span style="color:#000000;">) </span><span id="Codehighlighter1_994_1038_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/33/33/YtGyR2oV_o.gif"></span><span id="Codehighlighter1_994_1038_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/43/fd/IVExtoZG_o.gif" align="top">                                bos.write(data, </span><span style="color:#000000;">0</span><span style="color:#000000;">, count);<br><img alt="" src="https://images2.imgbox.com/8d/5a/IOKUtCxe_o.gif" align="top">                            }</span></span><span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/75/8e/siNOxcoh_o.gif" align="top">                            String xml </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#0000ff;">new</span><span style="color:#000000;"> String(bos.toByteArray());<br><img alt="" src="https://images2.imgbox.com/d9/f4/2iDyECYt_o.gif" align="top">                            Log.i(</span><span style="color:#000000;">"</span><span style="color:#000000;">TestActivity</span><span style="color:#000000;">"</span><span style="color:#000000;">, </span><span style="color:#000000;">"</span><span style="color:#000000;">xml1=</span><span style="color:#000000;">"</span><span style="color:#000000;"> </span><span style="color:#000000;">+</span><span style="color:#000000;"> xml);<br><img alt="" src="https://images2.imgbox.com/47/2f/JGaUCLIV_o.gif" align="top">                            Toast.makeText(TestActivity.</span><span style="color:#0000ff;">this</span><span style="color:#000000;">, xml, Toast.LENGTH_SHORT).show();<br><img id="Codehighlighter1_1239_1276_Open_Image" alt="" src="https://images2.imgbox.com/42/e0/gvn1pySB_o.gif" align="top"><img id="Codehighlighter1_1239_1276_Closed_Image" alt="" src="https://images2.imgbox.com/9a/fa/1G1m72Ru_o.gif" align="top">                        }</span></span><span style="color:#000000;"> </span><span style="color:#0000ff;">catch</span><span style="color:#000000;"> (Exception ex) </span><span id="Codehighlighter1_1239_1276_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/b5/9e/0JbGnNwH_o.gif"></span><span id="Codehighlighter1_1239_1276_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/34/70/D61kn2Fm_o.gif" align="top">                            ex.printStackTrace();<br><img id="Codehighlighter1_1286_1650_Open_Image" alt="" src="https://images2.imgbox.com/bf/fd/Z1UdAmm6_o.gif" align="top"><img id="Codehighlighter1_1286_1650_Closed_Image" alt="" src="https://images2.imgbox.com/0b/56/TQjcL8vR_o.gif" align="top">                        }</span></span><span style="color:#000000;"> </span><span style="color:#0000ff;">finally</span><span style="color:#000000;"> </span><span id="Codehighlighter1_1286_1650_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/c2/07/b7FQSDsK_o.gif"></span><span id="Codehighlighter1_1286_1650_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/2d/d8/uZHyyPG7_o.gif" align="top">                            </span><span style="color:#0000ff;">if</span><span style="color:#000000;"> (fis </span><span style="color:#000000;">!=</span><span style="color:#000000;"> </span><span style="color:#0000ff;">null</span><span style="color:#000000;">)<br><img id="Codehighlighter1_1324_1356_Open_Image" alt="" src="https://images2.imgbox.com/96/8a/Pd8Kz4ca_o.gif" align="top"><img id="Codehighlighter1_1324_1356_Closed_Image" alt="" src="https://images2.imgbox.com/51/d9/LFrg0vW8_o.gif" align="top">                                </span><span style="color:#0000ff;">try</span><span style="color:#000000;"> </span><span id="Codehighlighter1_1324_1356_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/99/82/El4WaRFT_o.gif"></span><span id="Codehighlighter1_1324_1356_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/21/74/UPDIW6pv_o.gif" align="top">                                    fis.close();<br><img id="Codehighlighter1_1380_1464_Open_Image" alt="" src="https://images2.imgbox.com/15/32/6b8MQa3v_o.gif" align="top"><img id="Codehighlighter1_1380_1464_Closed_Image" alt="" src="https://images2.imgbox.com/d2/60/LuVsYI7E_o.gif" align="top">                                }</span></span><span style="color:#000000;"> </span><span style="color:#0000ff;">catch</span><span style="color:#000000;"> (IOException e) </span><span id="Codehighlighter1_1380_1464_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/1b/48/Egcpc055_o.gif"></span><span id="Codehighlighter1_1380_1464_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/ae/91/JgPL2E7y_o.gif" align="top">                                    </span><span style="color:#008000;">//</span><span style="color:#008000;"> TODO Auto-generated catch block</span><span style="color:#008000;"><br><img alt="" src="https://images2.imgbox.com/0a/dd/8vvSL5Xk_o.gif" align="top"></span><span style="color:#000000;">                                    e.printStackTrace();<br><img alt="" src="https://images2.imgbox.com/0c/f7/A4gNEZWt_o.gif" align="top">                                }</span></span><span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/c4/fe/IM9A1MnV_o.gif" align="top">                            </span><span style="color:#0000ff;">if</span><span style="color:#000000;"> (bos </span><span style="color:#000000;">!=</span><span style="color:#000000;"> </span><span style="color:#0000ff;">null</span><span style="color:#000000;">)<br><img id="Codehighlighter1_1502_1534_Open_Image" alt="" src="https://images2.imgbox.com/85/dc/15S2akYO_o.gif" align="top"><img id="Codehighlighter1_1502_1534_Closed_Image" alt="" src="https://images2.imgbox.com/de/21/LHuMSQH0_o.gif" align="top">                                </span><span style="color:#0000ff;">try</span><span style="color:#000000;"> </span><span id="Codehighlighter1_1502_1534_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/5d/1a/GiGwq28O_o.gif"></span><span id="Codehighlighter1_1502_1534_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/5d/53/1YN918yG_o.gif" align="top">                                    bos.close();<br><img id="Codehighlighter1_1558_1642_Open_Image" alt="" src="https://images2.imgbox.com/2b/6a/RR6dg1Zh_o.gif" align="top"><img id="Codehighlighter1_1558_1642_Closed_Image" alt="" src="https://images2.imgbox.com/40/85/bLGAU3Lh_o.gif" align="top">                                }</span></span><span style="color:#000000;"> </span><span style="color:#0000ff;">catch</span><span style="color:#000000;"> (IOException e) </span><span id="Codehighlighter1_1558_1642_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/26/7d/WUO8W6At_o.gif"></span><span id="Codehighlighter1_1558_1642_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/05/7f/GXjIhDXv_o.gif" align="top">                                    </span><span style="color:#008000;">//</span><span style="color:#008000;"> TODO Auto-generated catch block</span><span style="color:#008000;"><br><img alt="" src="https://images2.imgbox.com/7c/f3/7uLcTFdL_o.gif" align="top"></span><span style="color:#000000;">                                    e.printStackTrace();<br><img alt="" src="https://images2.imgbox.com/d0/ec/YTZIq0QW_o.gif" align="top">                                }</span></span><span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/f2/6d/du1BGXrX_o.gif" align="top">                        }</span></span><span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/f4/22/CGNkP67W_o.gif" align="top">                    }</span></span><span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/40/de/ST05G0dW_o.gif" align="top">                }</span></span><span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/25/42/wmbgxfAi_o.gif" align="top">            }</span></span><span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/f3/5d/to0Qli2W_o.gif" align="top"><br><img alt="" src="https://images2.imgbox.com/34/57/mgysDXOH_o.gif" align="top">        }</span></span> 
  <span style="color:#000000;">;<br><img alt="" src="https://images2.imgbox.com/2d/5e/piePErv8_o.gif" align="top">        IntentFilter filter </span> 
  <span style="color:#000000;">=</span> 
  <span style="color:#000000;"> </span> 
  <span style="color:#0000ff;">new</span> 
  <span style="color:#000000;"> IntentFilter();<br><img alt="" src="https://images2.imgbox.com/9a/88/FOfWnjqE_o.gif" align="top">        filter.addAction(RESPONSE_ACTION);<br><img alt="" src="https://images2.imgbox.com/bc/53/HX8TwLAe_o.gif" align="top">        filter.addCategory(Intent.CATEGORY_DEFAULT);<br><img alt="" src="https://images2.imgbox.com/11/8c/vvcC1Yfp_o.gif" align="top">        filter.addDataScheme(</span> 
  <span style="color:#000000;">"http</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">);<br><img alt="" src="https://images2.imgbox.com/30/a4/sTmC2x9N_o.gif" align="top">        registerReceiver(receiver, filter);</span> 
 </div>程序A的发送BC： 
 <br> 
 <div style="border-right:#cccccc 1px solid;border-top:#cccccc 1px solid;font-size:13px;border-left:#cccccc 1px solid;border-bottom:#cccccc 1px solid;"> 
  <img id="Codehighlighter1_47_380_Open_Image" alt="" src="https://images2.imgbox.com/d9/f0/iBfEPTCu_o.gif" align="top"> 
  <img id="Codehighlighter1_47_380_Closed_Image" alt="" src="https://images2.imgbox.com/de/70/4Tg6mVMP_o.gif" align="top"> 
  <span style="color:#000000;">        btn.setOnClickListener(</span> 
  <span style="color:#0000ff;">new</span> 
  <span style="color:#000000;"> OnClickListener() </span> 
  <span id="Codehighlighter1_47_380_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/5b/7c/AdX0cEvL_o.gif"></span> 
  <span id="Codehighlighter1_47_380_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/9a/80/dUnc2pck_o.gif" align="top"><br><img alt="" src="https://images2.imgbox.com/6b/ad/HJVf0bRn_o.gif" align="top">            @Override<br><img id="Codehighlighter1_97_376_Open_Image" alt="" src="https://images2.imgbox.com/07/27/B7R1OSI4_o.gif" align="top"><img id="Codehighlighter1_97_376_Closed_Image" alt="" src="https://images2.imgbox.com/14/67/PWNQjgQU_o.gif" align="top">            </span><span style="color:#0000ff;">public</span><span style="color:#000000;"> </span><span style="color:#0000ff;">void</span><span style="color:#000000;"> onClick(View arg0) </span><span id="Codehighlighter1_97_376_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/72/c0/B1TbVI71_o.gif"></span><span id="Codehighlighter1_97_376_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/c5/a2/0rV0mqst_o.gif" align="top">                </span><span style="color:#008000;">//</span><span style="color:#008000;"> TODO Auto-generated method stub</span><span style="color:#008000;"><br><img alt="" src="https://images2.imgbox.com/d9/d2/Mi32x26W_o.gif" align="top"></span><span style="color:#000000;">                Uri uri </span><span style="color:#000000;">=</span><span style="color:#000000;"> Uri.parse(</span><span style="color:#000000;">"</span><span style="color:#000000;">http://www.xx.com/getDetails?id=123</span><span style="color:#000000;">"</span><span style="color:#000000;">);<br><img alt="" src="https://images2.imgbox.com/06/8b/Mn2B2tNK_o.gif" align="top">                Intent in </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#0000ff;">new</span><span style="color:#000000;"> Intent();<br><img alt="" src="https://images2.imgbox.com/49/c7/eR0sJWTT_o.gif" align="top">                in.setAction(REQUEST_ACTION);<br><img alt="" src="https://images2.imgbox.com/a3/c5/qu1hHYTN_o.gif" align="top">                in.addCategory(Intent.CATEGORY_DEFAULT);<br><img alt="" src="https://images2.imgbox.com/b2/2e/ntjJ4ILv_o.gif" align="top">                in.setData(uri);<br><img alt="" src="https://images2.imgbox.com/41/3e/qDL5zwDP_o.gif" align="top">                TestActivity.</span><span style="color:#0000ff;">this</span><span style="color:#000000;">.sendBroadcast(in);<br><img alt="" src="https://images2.imgbox.com/d5/07/v4SXQh1a_o.gif" align="top">            }</span></span><span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/46/31/FsFqxZdM_o.gif" align="top">        }</span></span> 
  <span style="color:#000000;">);</span> 
 </div> 
 <br> 
 <br>程序B的Receiver： 
 <br> 
 <div style="border-right:#cccccc 1px solid;border-top:#cccccc 1px solid;font-size:13px;border-left:#cccccc 1px solid;border-bottom:#cccccc 1px solid;"> 
  <img alt="" src="https://images2.imgbox.com/e9/aa/GySY96qJ_o.gif" align="top"> 
  <span style="color:#000000;">@Override<br><img id="Codehighlighter1_65_607_Open_Image" alt="" src="https://images2.imgbox.com/83/77/owHzzVhZ_o.gif" align="top"><img id="Codehighlighter1_65_607_Closed_Image" alt="" src="https://images2.imgbox.com/b6/4a/yM77uUV7_o.gif" align="top">    </span> 
  <span style="color:#0000ff;">public</span> 
  <span style="color:#000000;"> </span> 
  <span style="color:#0000ff;">void</span> 
  <span style="color:#000000;"> onReceive(Context context, Intent intent) </span> 
  <span id="Codehighlighter1_65_607_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/12/a5/ZcuP0hig_o.gif"></span> 
  <span id="Codehighlighter1_65_607_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/43/ac/iBLKYKvP_o.gif" align="top">        </span><span style="color:#0000ff;">if</span><span style="color:#000000;">(intent </span><span style="color:#000000;">!=</span><span style="color:#000000;"> </span><span style="color:#0000ff;">null</span><span style="color:#000000;">)<br><img id="Codehighlighter1_96_449_Open_Image" alt="" src="https://images2.imgbox.com/06/b5/GLlgkVfN_o.gif" align="top"><img id="Codehighlighter1_96_449_Closed_Image" alt="" src="https://images2.imgbox.com/76/6c/KfX88OWF_o.gif" align="top">        </span><span id="Codehighlighter1_96_449_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/9e/39/NwRj8xFg_o.gif"></span><span id="Codehighlighter1_96_449_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/a9/65/5gyIc7O4_o.gif" align="top">            Uri uri </span><span style="color:#000000;">=</span><span style="color:#000000;"> intent.getData();<br><img alt="" src="https://images2.imgbox.com/8b/c9/pC8Wb3WY_o.gif" align="top">            </span><span style="color:#0000ff;">if</span><span style="color:#000000;">(uri </span><span style="color:#000000;">!=</span><span style="color:#000000;"> </span><span style="color:#0000ff;">null</span><span style="color:#000000;">)<br><img id="Codehighlighter1_178_425_Open_Image" alt="" src="https://images2.imgbox.com/84/63/8fWiFfYZ_o.gif" align="top"><img id="Codehighlighter1_178_425_Closed_Image" alt="" src="https://images2.imgbox.com/e8/ee/Wxq0veJf_o.gif" align="top">            </span><span id="Codehighlighter1_178_425_Closed_Text" style="border-right:#808080 1px solid;border-top:#808080 1px solid;border-left:#808080 1px solid;border-bottom:#808080 1px solid;"><img alt="" src="https://images2.imgbox.com/9f/3c/Apr5v4De_o.gif"></span><span id="Codehighlighter1_178_425_Open_Text"><span style="color:#000000;">{<!-- --><br><img alt="" src="https://images2.imgbox.com/45/81/084VnW0b_o.gif" align="top">                Log.i(</span><span style="color:#000000;">"</span><span style="color:#000000;">BGServiceReceiver</span><span style="color:#000000;">"</span><span style="color:#000000;">, </span><span style="color:#000000;">"</span><span style="color:#000000;">=======================</span><span style="color:#000000;">"</span><span style="color:#000000;"> </span><span style="color:#000000;">+</span><span style="color:#000000;"> uri.getQueryParameter(</span><span style="color:#000000;">"</span><span style="color:#000000;">id</span><span style="color:#000000;">"</span><span style="color:#000000;">));<br><img alt="" src="https://images2.imgbox.com/2c/c6/AC8e0RlL_o.gif" align="top">                intent.setClassName(</span><span style="color:#000000;">"</span><span style="color:#000000;">com.backgroundservice</span><span style="color:#000000;">"</span><span style="color:#000000;">,<br><img alt="" src="https://images2.imgbox.com/c2/ed/qsiw3Iax_o.gif" align="top">                </span><span style="color:#000000;">"</span><span style="color:#000000;">com.backgroundservice.TestBackgroundService</span><span style="color:#000000;">"</span><span style="color:#000000;">);<br><img alt="" src="https://images2.imgbox.com/f2/31/3a2W129n_o.gif" align="top">                context.startService(intent);<br><img alt="" src="https://images2.imgbox.com/1c/61/JTq3WVf9_o.gif" align="top">            }</span></span><span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/38/dd/oHc4LFJT_o.gif" align="top">                <br><img alt="" src="https://images2.imgbox.com/cd/57/sSSHkSU3_o.gif" align="top">        }</span></span><span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/b1/62/iHvEfNY1_o.gif" align="top"></span><span style="color:#008000;">//</span><span style="color:#008000;">        try {<!-- --><br><img alt="" src="https://images2.imgbox.com/ea/46/Y7GjdVzK_o.gif" align="top"></span><span style="color:#008000;">//</span><span style="color:#008000;">            Thread.sleep(5000);<br><img alt="" src="https://images2.imgbox.com/e9/2e/DNl8ZFUi_o.gif" align="top"></span><span style="color:#008000;">//</span><span style="color:#008000;">        } catch (InterruptedException e) {<!-- --><br><img alt="" src="https://images2.imgbox.com/07/ab/gFU0kc58_o.gif" align="top"></span><span style="color:#008000;">//</span><span style="color:#008000;">            </span><span style="color:#008000;">//</span><span style="color:#008000;"> TODO Auto-generated catch block<br><img alt="" src="https://images2.imgbox.com/1f/97/czIR4pQx_o.gif" align="top"></span><span style="color:#008000;">//</span><span style="color:#008000;">            e.printStackTrace();<br><img alt="" src="https://images2.imgbox.com/89/00/XPWq7Mqd_o.gif" align="top"></span><span style="color:#008000;">//</span><span style="color:#008000;">        }</span><span style="color:#008000;"><br><img alt="" src="https://images2.imgbox.com/8d/9f/6PPJjQ1F_o.gif" align="top"></span><span style="color:#000000;">    <br><img alt="" src="https://images2.imgbox.com/72/f2/pQExJyjC_o.gif" align="top"><br><img alt="" src="https://images2.imgbox.com/fa/08/XKLgsdPz_o.gif" align="top">    }</span></span> 
 </div>配置： 
 <br> 
 <div style="border-right:#cccccc 1px solid;border-top:#cccccc 1px solid;font-size:13px;border-left:#cccccc 1px solid;border-bottom:#cccccc 1px solid;"> 
  <img alt="" src="https://images2.imgbox.com/8f/4e/Ht3B25ie_o.gif" align="top"> 
  <span style="color:#000000;">        </span> 
  <span style="color:#0000ff;">&lt;</span> 
  <span style="color:#800000;">receiver </span> 
  <span style="color:#ff0000;">android:name</span> 
  <span style="color:#0000ff;">="ServiceReceiver"</span> 
  <span style="color:#0000ff;">&gt;</span> 
  <span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/08/90/iGJzuKEy_o.gif" align="top">            </span> 
  <span style="color:#0000ff;">&lt;</span> 
  <span style="color:#800000;">intent-filter</span> 
  <span style="color:#0000ff;">&gt;</span> 
  <span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/48/66/7skdOi4a_o.gif" align="top">                </span> 
  <span style="color:#0000ff;">&lt;</span> 
  <span style="color:#800000;">action </span> 
  <span style="color:#ff0000;">android:name</span> 
  <span style="color:#0000ff;">="android.intent.action.STORE_REQUEST"</span> 
  <span style="color:#0000ff;">&gt;&lt;/</span> 
  <span style="color:#800000;">action</span> 
  <span style="color:#0000ff;">&gt;</span> 
  <span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/f5/d0/ZCmSBgDq_o.gif" align="top">                </span> 
  <span style="color:#0000ff;">&lt;</span> 
  <span style="color:#800000;">category </span> 
  <span style="color:#ff0000;">android:name</span> 
  <span style="color:#0000ff;">="android.intent.category.DEFAULT"</span> 
  <span style="color:#0000ff;">&gt;&lt;/</span> 
  <span style="color:#800000;">category</span> 
  <span style="color:#0000ff;">&gt;</span> 
  <span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/41/c8/uZxN53O4_o.gif" align="top">                </span> 
  <span style="color:#0000ff;">&lt;</span> 
  <span style="color:#800000;">data </span> 
  <span style="color:#ff0000;">android:scheme</span> 
  <span style="color:#0000ff;">="http"</span> 
  <span style="color:#0000ff;">&gt;&lt;/</span> 
  <span style="color:#800000;">data</span> 
  <span style="color:#0000ff;">&gt;</span> 
  <span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/f4/2f/nDlBztrA_o.gif" align="top">            </span> 
  <span style="color:#0000ff;">&lt;/</span> 
  <span style="color:#800000;">intent-filter</span> 
  <span style="color:#0000ff;">&gt;</span> 
  <span style="color:#000000;"><br><img alt="" src="https://images2.imgbox.com/dc/ef/WxkQtyPH_o.gif" align="top">        </span> 
  <span style="color:#0000ff;">&lt;/</span> 
  <span style="color:#800000;">receiver</span> 
  <span style="color:#0000ff;">&gt;</span> 
 </div> 
 <br>程序B的发送BC： 
 <br> 
 <div style="border-right:#cccccc 1px solid;border-top:#cccccc 1px solid;font-size:13px;border-left:#cccccc 1px solid;border-bottom:#cccccc 1px solid;"> 
  <img alt="" src="https://images2.imgbox.com/3e/43/VVt5UqH9_o.gif" align="top"> 
  <span style="color:#000000;">        Intent in </span> 
  <span style="color:#000000;">=</span> 
  <span style="color:#000000;"> </span> 
  <span style="color:#0000ff;">new</span> 
  <span style="color:#000000;"> Intent();<br><img alt="" src="https://images2.imgbox.com/8e/9f/1VsLnBhv_o.gif" align="top">        in.setAction(RESPONSE_ACTION);<br><img alt="" src="https://images2.imgbox.com/fe/88/rZW029dT_o.gif" align="top">        in.addCategory(Intent.CATEGORY_DEFAULT);<br><img alt="" src="https://images2.imgbox.com/af/36/W19CWN3S_o.gif" align="top">        in.setData(Uri.parse(</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">http://www.xx.com/setList?location=/sdcard/xx.xml</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">));<br><img alt="" src="https://images2.imgbox.com/32/fe/qbik2Nws_o.gif" align="top">        </span> 
  <span style="color:#0000ff;">this</span> 
  <span style="color:#000000;">.sendBroadcast(in);</span> 
 </div> 
 <p><br>如果想让目标Activity或者Service接收到相应的Broadcast，就需要完全匹配目标Activity或者Service的IntentFilter，否则目标Filter无法接收到相应的Broadcast。注意：IntentFilter设置的时候都要默认带上CATEGORY_DEFAULT，否则可能会造成潜在问题。<br>文档中的说明如下：<br>In principle, therefore, an Intent object with no categories should always pass this test, regardless of what's in the filter. That's mostly true. However, with one exception, Android treats all implicit intents passed to <a href="http://www.blogjava.net/TiGERTiAN/archive/reference/android/content/Context.html#startActivity%28android.content.Intent%29" rel="nofollow"><font color="#1a8bc8">startActivity()</font></a> as if they contained at least one category: "<code class="Code prettyprint">android.intent.category.DEFAULT</code>" (the <code class="Code prettyprint">CATEGORY_DEFAULT</code> constant). Therefore, activities that are willing to receive implicit intents must include "<code class="Code prettyprint">android.intent.category.DEFAULT</code>" in their intent filters. </p> 
 <p> </p> 
 <p>TrackBack：<a href="http://www.blogjava.net/TiGERTiAN/archive/2010/01/31/311413.html" rel="nofollow">http://www.blogjava.net/TiGERTiAN/archive/2010/01/31/311413.html</a></p> 
</div> 
<p>转载于:https://www.cnblogs.com/hdjjun/archive/2010/06/02/1749859.html</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a4e2086a63093064b59293093ea915ce/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">一步一步学Silverlight 2系列（19）：如何在Silverlight中与HTML DOM交互（上）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1164741d3557a31b3383ffd7fe231820/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关于编程语言的一些思考</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>