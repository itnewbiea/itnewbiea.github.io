<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQL 求同比 环比 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SQL 求同比 环比" />
<meta property="og:description" content="一、要求 1、表结构如下: ID DepartName(部门) Sales（销售量) SalesDate(销售日期) 1 营销一部 300 2006-7-1 2 营销二部 500 2006-7-1 3 营销三部 800 2006-8-1 4 营销一部 600 2006-8-1 5 营销二部 800 2006-8-1 6 营销一部 400 2007-7-1 7 营销二部 800 2007-7-1 8 营销三部 700 2007-8-1 9 营销一部 600 2008-7-1 10 营销二部 300 2008-7-1 2、要根据要求得到以下数据 1）得到同比数据 部门 对比年月 本月销售总量 去年同期销售总量 同比 营销一部 2006-07-01 300.00 NULL 无穷大 营销二部 2006-07-01 500.00 NULL 无穷大 营销三部 2006-08-01 800.00 NULL 无穷大 营销一部 2006-08-01 600." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8bf935fba8cfb30464ef741bda4261a0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-02-26T11:24:13+08:00" />
<meta property="article:modified_time" content="2017-02-26T11:24:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQL 求同比 环比</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>一、要求</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>1、表结构如下:</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>ID  DepartName(部门) Sales（销售量) SalesDate(销售日期)</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>1      营销一部       300              2006-7-1 </span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>2      营销二部       500              2006-7-1 </span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>3      营销三部       800              2006-8-1 </span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>4      营销一部       600              2006-8-1 </span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>5      营销二部       800              2006-8-1 </span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>6      营销一部       400              2007-7-1 </span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>7      营销二部       800              2007-7-1 </span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>8      营销三部       700              2007-8-1 </span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>9      营销一部       600              2008-7-1 </span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>10     营销二部       300              2008-7-1 </span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>2、要根据要求得到以下数据</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>1）得到同比数据</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>部门  对比年月 本月销售总量  去年同期销售总量 同比</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销一部 2006-07-01 300.00  NULL  无穷大</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销二部 2006-07-01 500.00  NULL  无穷大</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销三部 2006-08-01 800.00  NULL  无穷大</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销一部 2006-08-01 600.00  NULL  无穷大</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销二部 2006-08-01 800.00  NULL  无穷大</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销一部 2007-07-01 400.00  300.00  33.33%</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销二部 2007-07-01 800.00  500.00  60.00%</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销三部 2007-08-01 700.00  800.00  -12.50%</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销一部 2008-07-01 600.00  400.00  50.00%</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销二部 2008-07-01 700.00  800.00  -12.50%</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>(2)选择月份 获取环比数据</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>部门  对比年月 本月销售总量  上月销售总量 环比</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销一部 2006-07-01 300.00  NULL  无穷大</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销二部 2006-07-01 500.00  NULL  无穷大</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销三部 2006-08-01 800.00  NULL  无穷大</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销一部 2006-08-01 600.00  300.00  100.00%</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销二部 2006-08-01 800.00  500.00  60.00%</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销一部 2007-07-01 400.00  NULL  无穷大</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销二部 2007-07-01 800.00  NULL  无穷大</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销三部 2007-08-01 700.00  NULL  无穷大</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销一部 2008-07-01 600.00  NULL  无穷大</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>营销二部 2008-07-01 700.00  NULL  无穷大</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>二、代码：</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>1、创建表</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>CREATE TABLE SalesDetail(</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>ID int,   --序号</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>DepartName varchar(50), --部门</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>Sales decimal(10,2), --销售量</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>SalesDate Datetime --销售日期</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>)</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>2、插入测试数据</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>insert into SalesDetail(ID, DepartName, Sales, SalesDate)</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>select 1, '营销一部', 300, '2006-7-1'</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>UNION ALL select 2, '营销二部', 500, '2006-7-1'</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>UNION ALL select 3, '营销三部', 800, '2006-8-1'</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>UNION ALL select 4, '营销一部', 600, '2006-8-1'</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>UNION ALL select 5, '营销二部', 800, '2006-8-1'</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>UNION ALL select 6, '营销一部', 400, '2007-7-1'</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>UNION ALL select 7, '营销二部', 800, '2007-7-1'</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>UNION ALL select 8, '营销三部', 700, '2007-8-1'</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>UNION ALL select 9, '营销一部', 600, '2008-7-1'</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>UNION ALL select 10, '营销二部', 700, '2008-7-1'</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>3、实现SQL代码</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>//得到环比</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>select c.DepartName as 部门, convert(varchar(10), c.SalesDate, 23) as 对比年月, c.Sales as 本月销售总量, d.Sales as 上月销售总量, case when d.Sales is null or d.Sales=0 then '无穷大' else cast(cast((isnull(c.Sales, 0)-isnull(d.Sales,0))*100/isnull(d.Sales, 0) as decimal(10,2)) as varchar(50))+'%' end as 环比 from SalesDetail c left join</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>(select a.DepartName as DepartName, a.Sales as Sales, a.SalesDate as lsSalesDate, b.SalesDate as SalesDate from SalesDetail a join SalesDetail b on a.SalesDate=DateAdd(month, -1, b.SalesDate) and a.DepartName=b.DepartName) d</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>on c.SalesDate=d.SalesDate and c.DepartName=d.DepartName</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>//得到同比</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>select c.DepartName as 部门, convert(varchar(10), c.SalesDate, 23) as 对比年月, c.Sales as 本月销售总量, d.Sales as 去年同期销售总量, case when d.Sales is null or d.Sales=0 then '无穷大' else cast(cast((isnull(c.Sales, 0)-isnull(d.Sales,0))*100/isnull(d.Sales, 0) as decimal(10,2)) as varchar(50))+'%' end as 同比 from SalesDetail c left join</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>(select a.DepartName as DepartName, a.Sales as Sales, a.SalesDate as lsSalesDate, b.SalesDate as SalesDate from SalesDetail a join SalesDetail b on a.SalesDate=DateAdd(year, -1, b.SalesDate) and a.DepartName=b.DepartName) d</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>on c.SalesDate=d.SalesDate and c.DepartName=d.DepartName</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>4、SQL语句说明</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>//获取根据时间获取去年同期时间</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>select DateAdd(year, -1, SalesDate)</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>//获取根据时间获取上月时间</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>select DateAdd(month, -1, SalesDate)</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>//获取根据时间获取去年同期时间数据</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>select a.DepartName as DepartName, a.Sales as Sales, a.SalesDate as lsSalesDate, b.SalesDate as SalesDate from SalesDetail a join SalesDetail b on a.SalesDate=DateAdd(year, -1, b.SalesDate) and a.DepartName=b.DepartName</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>//获取根据时间获取上月时间数据</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'> 
<span style='color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>select a.DepartName as DepartName, a.Sales as Sales, a.SalesDate as lsSalesDate, b.SalesDate as SalesDate from SalesDetail a join SalesDetail b on a.SalesDate=DateAdd(month, -1, b.SalesDate) and a.DepartName=b.DepartName</span> 
<br style='margin:0px; padding:0px; color:rgb(64,50,38); font-family:"PingFang SC","Helvetica Neue",Helvetica,Arial,sans-serif; font-size:14px'>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f471f8e3d6d3f9dd099de2e8d5d3e3ee/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">使用Fiddler抓包工具抓取服务器数据</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/406ba98b64575f87a4bc58ba9b35e14f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">各类ReactNative学习资源、开源App和组件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>