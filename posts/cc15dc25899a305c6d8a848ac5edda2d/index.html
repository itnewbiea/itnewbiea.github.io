<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mysql事务 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mysql事务" />
<meta property="og:description" content="一、事务的特性：
1.原子性
保证一个事务中数据要么全部成功提交，要么全部失败回滚，不能只执行其中一部分操作。
2.一致性 事务的执行不能破坏数据库的完整性和一直性，在事务的执行前后数据库都必须处于一致性状态。
3.隔离性
未授权读取（未提交的数据读取），授权读取（已提交数据的读取），可重复读取和串行化
4.持久性
一旦事务提交，那么它对数据库中的对应数据的状态的变更就会永久保存到数据库中。即使发生系统崩溃或机器宕机等故障，只要数据库能够重新启动，那么一定能够将其恢复到事务成功结束的状态
注：mysql的MyISAM引擎不支持事务
二、查看数据库引擎
#查看数据库引擎
show engines;
三、配合spring框架使用方法以及配置：
1.spring配置事务
编程式：通过编码的方式手动启用、提交或回滚事务，粒度更细，但更麻烦。
声明式：通过在方法或类或接口上添加注解进行包装，无侵入地实现事务，更方便，但粒度更大。
2.配置事务管理器
&lt;!-- 开启事务注解驱动，基于注解的声明式事务 --&gt; &lt;tx:annotation-driven transaction-manager=&#34;transactionManager&#34; proxy-target-class=&#34;true&#34; /&gt; &lt;bean id=&#34;transactionManager&#34; class=&#34;org.springframework.jdbc.datasource.DataSourceTransactionManager&#34;&gt; &lt;property name=&#34;dataSource&#34; ref=&#34;dataSource&#34; /&gt; &lt;/bean&gt; 四、简单测试使用编程式事务
1.数据库表中原数据：
2.对表进行添加和删除操作（使用100/0模拟引发错误）
@Override public void shiwu(Liuyan record) { // 开始事务 TransactionStatus status = transactionManager.getTransaction(new DefaultTransactionDefinition()); try { Liuyan liuyan = new Liuyan(); liuyan.setLyid(utils.getUUID()); liuyanMapper.insertSelective(liuyan); liuyanMapper.deleteByPrimaryKey(&#34;7bebc14c-ba49-418f-b762-fb8a45e72502&#34;); int ss=100/0;//模拟引发错误 transactionManager.commit(status);// 提交事务 } catch (Exception e) { // TODO: handle exception // 异常回滚，并不一定要在try." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/cc15dc25899a305c6d8a848ac5edda2d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-16T16:55:24+08:00" />
<meta property="article:modified_time" content="2022-05-16T16:55:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mysql事务</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>一、事务的特性：</p> 
<blockquote> 
 <p><strong>1.原子性</strong></p> 
 <p>保证一个事务中数据要么全部成功提交，要么全部失败回滚，不能只执行其中一部分操作。</p> 
 <p></p> 
 <p><strong>2.一致性</strong> </p> 
 <p>事务的执行不能破坏数据库的完整性和一直性，在事务的执行前后数据库都必须处于一致性状态。</p> 
 <p></p> 
 <p><strong>3.隔离性</strong></p> 
 <p>未授权读取（未提交的数据读取），授权读取（已提交数据的读取），可重复读取和串行化<br>  </p> 
 <p><strong>4.持久性</strong></p> 
 <p>一旦事务提交，那么它对数据库中的对应数据的状态的变更就会永久保存到数据库中。即使发生系统崩溃或机器宕机等故障，只要数据库能够重新启动，那么一定能够将其恢复到事务成功结束的状态<br>  </p> 
</blockquote> 
<p></p> 
<blockquote> 
 <p>注：mysql的MyISAM引擎不支持事务</p> 
</blockquote> 
<p>二、查看数据库引擎</p> 
<blockquote> 
 <p>#查看数据库引擎<br> show engines;</p> 
</blockquote> 
<p> <img alt="" height="354" src="https://images2.imgbox.com/eb/62/yRFbesMQ_o.png" width="762"></p> 
<p>三、配合spring框架使用方法以及配置：</p> 
<p>1.spring配置事务</p> 
<blockquote> 
 <p><span style="color:#fe2c24;"><code>编程式</code></span>：通过编码的方式手动启用、提交或回滚事务，粒度更细，但更麻烦。</p> 
 <p><span style="color:#fe2c24;"><code>声明式</code></span>：通过在方法或类或接口上添加注解进行包装，无侵入地实现事务，更方便，但粒度更大。</p> 
</blockquote> 
<p>2.配置事务管理器</p> 
<pre><code>&lt;!-- 开启事务注解驱动，基于注解的声明式事务 --&gt;  
&lt;tx:annotation-driven transaction-manager="transactionManager" proxy-target-class="true" /&gt;
	 
&lt;bean id="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager"&gt;
	&lt;property name="dataSource" ref="dataSource" /&gt;
&lt;/bean&gt;</code></pre> 
<p>四、简单测试使用编程式事务</p> 
<p>1.数据库表中原数据：</p> 
<p><img alt="" height="354" src="https://images2.imgbox.com/6c/25/QMEyvzUg_o.png" width="1200"></p> 
<p> 2.对表进行添加和删除操作（使用100/0模拟引发错误）</p> 
<pre><code class="language-java">@Override
public void shiwu(Liuyan record) {
		// 开始事务
		TransactionStatus status = transactionManager.getTransaction(new DefaultTransactionDefinition());
		try {
			Liuyan liuyan = new Liuyan();
			liuyan.setLyid(utils.getUUID());
		    liuyanMapper.insertSelective(liuyan);
			liuyanMapper.deleteByPrimaryKey("7bebc14c-ba49-418f-b762-fb8a45e72502");
			int ss=100/0;//模拟引发错误
			transactionManager.commit(status);// 提交事务
		} catch (Exception e) {
			// TODO: handle exception
			// 异常回滚，并不一定要在try...catch中
			e.printStackTrace();
			transactionManager.rollback(status);
		}
	}</code></pre> 
<p></p> 
<p>3.执行后数据库未变：</p> 
<p></p> 
<p><img alt="" height="354" src="https://images2.imgbox.com/07/ac/kDYpxG28_o.png" width="1200"></p> 
<p></p> 
<p>4.删除（100/0错误）后执行事务数据库变化</p> 
<p> 已经不存在（7bebc14c-ba49-418f-b762-fb8a45e72502）这条数据并且随机增加了一条。<img alt="" height="319" src="https://images2.imgbox.com/bb/d8/s8jkbsVb_o.png" width="1200"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2203ae016ccd7d99f9e814b1f6a923a1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[MIT]微积分重点 第十六课 关于增长的微分方程 学习笔记</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/98f9ddfa766a50e7be941792f1533395/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">入门激光雷达点云的3D目标检测</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>