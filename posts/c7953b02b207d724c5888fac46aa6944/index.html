<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>斯特拉森(Strassen)算法 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="斯特拉森(Strassen)算法" />
<meta property="og:description" content="斯特拉森(Strassen)算法简介 先借用一下百度百科：
简单解释 通俗的说，斯特拉森算法把原先普通二阶矩阵相乘需要的8次乘法压缩到7次乘法，而在计算机，乘法运算的耗时远远高于加减运算，所以斯特拉森算法可以将O(d^ 3) 压缩到O(d^2.8)。
需要知道的是，斯特拉森算法只是对矩阵分治的算法而不是单独的乘法算法，分治完成时最后使用的还是普通矩阵乘法，在阶数小于等于32（或者64？看过不同的实验结果）时普通的矩阵乘法会有更快的速度，而随着矩阵的阶不断增加，斯特拉森可以提供更快的速度。
一些拓展 在这里，提供另外一种形式的斯特拉森：
同样是通过代数的分解与合并，我们构造出另外一种看起来更复杂的算法。这次我们分解出的项数更多，意味着拓展性更高，于是我们在求矩阵平方时有了新的改进。
矩阵的平方-斯特拉森 我们只需要沿用之前图中的2.s。然后7次乘法使用上图方法，便可以减少一部分的预运算，而上图中，我们依然有P1P2P3可以递归入经过平方优化的斯特拉森算法，获得更快的速度。
C语言描述斯特拉森标准模板 第一个部分我们先来写核心思路。
int Strassen(int N, int **MatrixA, int **MatrixB, int **MatrixC) {int HalfSize = N/2; int newSize = N/2; int nsize=N/2; int i=0,j=0; int newLength=0; newLength = newSize; if ( N &lt;= 32)//choosing the threshold is extremely important, try N&lt;=2 to see the result { MUL(MatrixA,MatrixB,MatrixC,N); } else {int** A11; int** A12; int** A21; int** A22; int** B11; int** B12; int** B21; int** B22; int** C11; int** C12; int** C21; int** C22; int** M1; int** M2; int** M3; int** M4; int** M5; int** M6; int** M7; int** AResult; int** BResult; }//此处省略动态内存的申请，最后也省略了内存的释放 for (i = 0; i &lt; N / 2; i&#43;&#43;) { for (j = 0; j &lt; N / 2; j&#43;&#43;) { A11[i][j] = MatrixA[i][j]; A12[i][j] = MatrixA[i][j &#43; N / 2]; A21[i][j] = MatrixA[i &#43; N / 2][j]; A22[i][j] = MatrixA[i &#43; N / 2][j &#43; N / 2]; B11[i][j] = MatrixB[i][j]; B12[i][j] = MatrixB[i][j &#43; N / 2]; B21[i][j] = MatrixB[i &#43; N / 2][j]; B22[i][j] = MatrixB[i &#43; N / 2][j &#43; N / 2]; } } //here we calculate M1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c7953b02b207d724c5888fac46aa6944/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-21T14:08:53+08:00" />
<meta property="article:modified_time" content="2020-12-21T14:08:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">斯特拉森(Strassen)算法</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Strassen_2"></a>斯特拉森(Strassen)算法简介</h2> 
<p>先借用一下百度百科：<br> <img src="https://images2.imgbox.com/f9/55/cOhhjjgq_o.jpg" alt="在这里插入图片描述"></p> 
<h3><a id="_6"></a>简单解释</h3> 
<p>通俗的说，斯特拉森算法把原先普通二阶矩阵相乘需要的8次乘法压缩到7次乘法，而在计算机，乘法运算的耗时远远高于加减运算，所以斯特拉森算法可以将O(d^ 3) 压缩到O(d^2.8)。<br> 需要知道的是，斯特拉森算法只是对矩阵分治的算法而不是单独的乘法算法，分治完成时最后使用的还是普通矩阵乘法，在阶数小于等于32（或者64？看过不同的实验结果）时普通的矩阵乘法会有更快的速度，而随着矩阵的阶不断增加，斯特拉森可以提供更快的速度。</p> 
<h3><a id="_12"></a>一些拓展</h3> 
<p>在这里，提供另外一种形式的斯特拉森：<br> <img src="https://images2.imgbox.com/e5/97/CWRssrcv_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/74/82/Lsq3x2qF_o.jpg" alt="在这里插入图片描述"><br> 同样是通过代数的分解与合并，我们构造出另外一种看起来更复杂的算法。这次我们分解出的项数更多，意味着拓展性更高，于是我们在求矩阵平方时有了新的改进。</p> 
<h3><a id="_19"></a>矩阵的平方-斯特拉森</h3> 
<p><img src="https://images2.imgbox.com/ee/66/lLReMANS_o.jpg" alt="在这里插入图片描述"><br> 我们只需要沿用之前图中的2.s。然后7次乘法使用上图方法，便可以减少一部分的预运算，而上图中，我们依然有P1P2P3可以递归入经过平方优化的斯特拉森算法，获得更快的速度。</p> 
<h2><a id="C_23"></a>C语言描述斯特拉森标准模板</h2> 
<p>第一个部分我们先来写核心思路。</p> 
<pre><code class="prism language-c"><span class="token keyword">int</span> <span class="token function">Strassen</span><span class="token punctuation">(</span><span class="token keyword">int</span> N<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token operator">*</span>MatrixA<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token operator">*</span>MatrixB<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token operator">*</span>MatrixC<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token keyword">int</span> HalfSize <span class="token operator">=</span> N<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> newSize <span class="token operator">=</span> N<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> nsize<span class="token operator">=</span>N<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> newLength<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    newLength <span class="token operator">=</span> newSize<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> N <span class="token operator">&lt;=</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token comment">//choosing the threshold is extremely important, try N&lt;=2 to see the result</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">MUL</span><span class="token punctuation">(</span>MatrixA<span class="token punctuation">,</span>MatrixB<span class="token punctuation">,</span>MatrixC<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span><span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> A11<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> A12<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> A21<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> A22<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> B11<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> B12<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> B21<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> B22<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> C11<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> C12<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> C21<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> C22<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> M1<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> M2<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> M3<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> M4<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> M5<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> M6<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> M7<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> AResult<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> BResult<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token comment">//此处省略动态内存的申请，最后也省略了内存的释放</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                A11<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> MatrixA<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                A12<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> MatrixA<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                A21<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> MatrixA<span class="token punctuation">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                A22<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> MatrixA<span class="token punctuation">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                B11<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> MatrixB<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                B12<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> MatrixB<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                B21<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> MatrixB<span class="token punctuation">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                B22<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> MatrixB<span class="token punctuation">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//here we calculate M1..M7 matrices .</span>
        <span class="token comment">//M1[][]</span>
        <span class="token function">ADD</span><span class="token punctuation">(</span> A11<span class="token punctuation">,</span>A22<span class="token punctuation">,</span>AResult<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ADD</span><span class="token punctuation">(</span> B11<span class="token punctuation">,</span>B22<span class="token punctuation">,</span>BResult<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Strassen</span><span class="token punctuation">(</span> HalfSize<span class="token punctuation">,</span> AResult<span class="token punctuation">,</span> BResult<span class="token punctuation">,</span> M1 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//now that we need to multiply this , we use the strassen itself .</span>
        <span class="token comment">//M2[][]</span>
        <span class="token function">ADD</span><span class="token punctuation">(</span> A21<span class="token punctuation">,</span>A22<span class="token punctuation">,</span>AResult<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">//M2=(A21+A22)B11</span>
        <span class="token function">Strassen</span><span class="token punctuation">(</span>HalfSize<span class="token punctuation">,</span> AResult<span class="token punctuation">,</span> B11<span class="token punctuation">,</span> M2<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//Mul(AResult,B11,M2);</span>
        <span class="token comment">//M3[][]</span>
        <span class="token function">SUB</span><span class="token punctuation">(</span> B12<span class="token punctuation">,</span>B22<span class="token punctuation">,</span>BResult<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">//M3=A11(B12-B22)</span>
        <span class="token function">Strassen</span><span class="token punctuation">(</span>HalfSize<span class="token punctuation">,</span> A11<span class="token punctuation">,</span> BResult<span class="token punctuation">,</span> M3<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//Mul(A11,BResult,M3);</span>
        <span class="token comment">//M4[][]</span>
        <span class="token function">SUB</span><span class="token punctuation">(</span> B21<span class="token punctuation">,</span> B11<span class="token punctuation">,</span> BResult<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//M4=A22(B21-B11)</span>
        <span class="token function">Strassen</span><span class="token punctuation">(</span>HalfSize<span class="token punctuation">,</span> A22<span class="token punctuation">,</span> BResult<span class="token punctuation">,</span> M4<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//Mul(A22,BResult,M4);</span>
        <span class="token comment">//M5[][]</span>
        <span class="token function">ADD</span><span class="token punctuation">(</span> A11<span class="token punctuation">,</span> A12<span class="token punctuation">,</span> AResult<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//M5=(A11+A12)B22</span>
        <span class="token function">Strassen</span><span class="token punctuation">(</span>HalfSize<span class="token punctuation">,</span> AResult<span class="token punctuation">,</span> B22<span class="token punctuation">,</span> M5<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//Mul(AResult,B22,M5);</span>
        <span class="token comment">//M6[][]</span>
        <span class="token function">SUB</span><span class="token punctuation">(</span> A21<span class="token punctuation">,</span> A11<span class="token punctuation">,</span> AResult<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ADD</span><span class="token punctuation">(</span> B11<span class="token punctuation">,</span> B12<span class="token punctuation">,</span> BResult<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//M6=(A21-A11)(B11+B12)</span>
        <span class="token function">Strassen</span><span class="token punctuation">(</span> HalfSize<span class="token punctuation">,</span> AResult<span class="token punctuation">,</span> BResult<span class="token punctuation">,</span> M6<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//Mul(AResult,BResult,M6);</span>
        <span class="token comment">//M7[][]</span>
        <span class="token function">SUB</span><span class="token punctuation">(</span>A12<span class="token punctuation">,</span> A22<span class="token punctuation">,</span> AResult<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ADD</span><span class="token punctuation">(</span>B21<span class="token punctuation">,</span> B22<span class="token punctuation">,</span> BResult<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//M7=(A12-A22)(B21+B22)</span>
        <span class="token function">Strassen</span><span class="token punctuation">(</span>HalfSize<span class="token punctuation">,</span> AResult<span class="token punctuation">,</span> BResult<span class="token punctuation">,</span> M7<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//Mul(AResult,BResult,M7);</span>
        <span class="token comment">//C11 = M1 + M4 - M5 + M7;</span>
        <span class="token function">ADD</span><span class="token punctuation">(</span> M1<span class="token punctuation">,</span> M4<span class="token punctuation">,</span> AResult<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">SUB</span><span class="token punctuation">(</span> M7<span class="token punctuation">,</span> M5<span class="token punctuation">,</span> BResult<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ADD</span><span class="token punctuation">(</span> AResult<span class="token punctuation">,</span> BResult<span class="token punctuation">,</span> C11<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//C12 = M3 + M5;</span>
        <span class="token function">ADD</span><span class="token punctuation">(</span> M3<span class="token punctuation">,</span> M5<span class="token punctuation">,</span> C12<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//C21 = M2 + M4;</span>
        <span class="token function">ADD</span><span class="token punctuation">(</span> M2<span class="token punctuation">,</span> M4<span class="token punctuation">,</span> C21<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//C22 = M1 + M3 - M2 + M6;</span>
        <span class="token function">ADD</span><span class="token punctuation">(</span> M1<span class="token punctuation">,</span> M3<span class="token punctuation">,</span> AResult<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">SUB</span><span class="token punctuation">(</span> M6<span class="token punctuation">,</span> M2<span class="token punctuation">,</span> BResult<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ADD</span><span class="token punctuation">(</span> AResult<span class="token punctuation">,</span> BResult<span class="token punctuation">,</span> C22<span class="token punctuation">,</span> HalfSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//at this point , we have calculated the c11..c22 matrices, and now we are going to</span>
        <span class="token comment">//put them together and make a unit matrix which would describe our resulting Matrix.</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token operator">/</span><span class="token number">2</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token operator">/</span><span class="token number">2</span> <span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                MatrixC<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> C11<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                MatrixC<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> C12<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                MatrixC<span class="token punctuation">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> C21<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                MatrixC<span class="token punctuation">[</span>i <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> N <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> C22<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>可以看到我们不断<strong>递归</strong>对矩阵做分治拆解，简单来说就是把一个大块矩阵不断做斯特拉森拆解，考虑速度在斯特拉森函数内部只做加减法，当拆解到<strong>一定大小</strong>的矩阵时，将每个小矩阵投入<strong>普通的矩阵乘法运算</strong>，至于这个 ‘一定大小’ 在上面的代码中定义为32，很有可能在64达到最快速度。<br> 于是我们有三个运算：<br> 乘：MUL函数，采用标准三次方速度的矩阵乘法；<br> 加：ADD函数，执行普通矩阵加法；<br> 减：SUB函数，执行普通矩阵减法；<br> 如下：</p> 
<pre><code class="prism language-c"><span class="token keyword">int</span> <span class="token function">ADD</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> MatrixA<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> MatrixB<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> MatrixResult<span class="token punctuation">,</span> <span class="token keyword">int</span> MatrixSize <span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MatrixSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> MatrixSize<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            MatrixResult<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span>  MatrixA<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> MatrixB<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">SUB</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> MatrixA<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> MatrixB<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> MatrixResult<span class="token punctuation">,</span> <span class="token keyword">int</span> MatrixSize <span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MatrixSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>  j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> MatrixSize<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            MatrixResult<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span>  MatrixA<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-</span> MatrixB<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">MUL</span><span class="token punctuation">(</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> MatrixA<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> MatrixB<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span> MatrixResult<span class="token punctuation">,</span> <span class="token keyword">int</span> MatrixSize <span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>MatrixSize <span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>MatrixSize <span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            MatrixResult<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">&lt;</span>MatrixSize <span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                MatrixResult<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>MatrixResult<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span>MatrixA<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">*</span>MatrixB<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>主函数可自行定义输入输出方法：<br> 这里，我们输入的是矩阵的阶数和一个矩阵A，输出矩阵A*A</strong><br> 但这是一个普通的斯特拉森模板，没有针对平方的特殊处理，输入输出操作可自行更改。<br> PS:我们不建议使用任何全局变量。</p> 
<pre><code class="prism language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token operator">*</span><span class="token operator">*</span>a<span class="token punctuation">,</span><span class="token operator">*</span><span class="token operator">*</span>new1<span class="token punctuation">;</span>
  <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>size<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
      <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span>i<span class="token operator">*</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
   new1<span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">*</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>new1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
a<span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">*</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>size<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
   <span class="token punctuation">{<!-- --></span>
       <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
  <span class="token function">Strassen</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span>a<span class="token punctuation">,</span>a<span class="token punctuation">,</span>new1<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>size<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span>new1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span>size<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span><span class="token function">free</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">free</span><span class="token punctuation">(</span>new1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
     <span class="token function">free</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">free</span><span class="token punctuation">(</span>new1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>至于只针对求平方的代码优化，有机会再写。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d836df9269d24c1cc6502db7a382266b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">激光雷达——目标识别（滤波、分割、聚类，包围盒）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a6a0f06fec45c2fa41dfcd75222547fe/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【2020.12】Aspose.words 20.12最新版Crack，word转pdf去水印方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>