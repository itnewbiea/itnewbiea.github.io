<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>向word文档中插入文字和图片 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="向word文档中插入文字和图片" />
<meta property="og:description" content="package com.xxxx; import com.deepoove.poi.XWPFTemplate; import com.deepoove.poi.data.PictureRenderData; import org.springframework.core.io.ClassPathResource; import sun.misc.BASE64Decoder; import sun.misc.BASE64Encoder; import javax.imageio.stream.FileImageOutputStream; import java.io.*; import java.util.HashMap; import java.util.Map; public class Text { public static void asd() { try { //待处理的图片 String imgFile = &#34;D:/123.jpg&#34;; //将图片转化成base64 InputStream in = null; byte[] data1; //读取图片字节数组 in = new FileInputStream(imgFile); data1 = new byte[in.available()]; in.read(data1); in.close(); //获取base64码转换成byte[]数组 byte[] bytes = new byte[0]; //对字节数组Base64编码 BASE64Encoder encoder = new BASE64Encoder(); //base64编码会自动换行 String imageData = encoder." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/b63fd6cdfbaf4a6fe4c16d875a5abd0d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-10T16:19:24+08:00" />
<meta property="article:modified_time" content="2022-02-10T16:19:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">向word文档中插入文字和图片</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<pre><code class="language-java">package com.xxxx;

import com.deepoove.poi.XWPFTemplate;
import com.deepoove.poi.data.PictureRenderData;
import org.springframework.core.io.ClassPathResource;
import sun.misc.BASE64Decoder;
import sun.misc.BASE64Encoder;
import javax.imageio.stream.FileImageOutputStream;
import java.io.*;
import java.util.HashMap;
import java.util.Map;

public class Text {
    public static void  asd() {
        try {
            //待处理的图片
            String imgFile = "D:/123.jpg";
            //将图片转化成base64
            InputStream in = null;
            byte[] data1;
            //读取图片字节数组
                in = new FileInputStream(imgFile);
                data1 = new byte[in.available()];
                in.read(data1);
                in.close();
            //获取base64码转换成byte[]数组
            byte[] bytes = new byte[0];
            //对字节数组Base64编码
            BASE64Encoder encoder = new BASE64Encoder();
            //base64编码会自动换行
            String imageData = encoder.encode(data1).replaceAll("[\\s*\t\n\r]", "");
            //将base64转化为流
            bytes = new BASE64Decoder().decodeBuffer(imageData.trim());
            //转化为输入流
            File file = new File("");
            String filePath1 = file.getCanonicalPath();//获取项目路径
            System.out.println(filePath1+"\\p.jpg");
            ByteArrayInputStream inputStream = new ByteArrayInputStream(bytes);//输入流输入bytes数组
            int leng;
            byte[] b = new byte[1024];
            FileImageOutputStream imageOutput = new FileImageOutputStream(new File("filePath1.jpg"));//打开输入流生成图片
            while ((leng = inputStream.read(b)) != -1) {
                //将byte写入硬盘
                imageOutput.write(b, 0, leng);
            }
            imageOutput.close();
            Map&lt;String, Object&gt; data = new HashMap&lt;String, Object&gt;();
            // 文本
            data.put("name", "张三");
            //图片(自定义设置高/宽)
            data.put("photo", new PictureRenderData(127, 185, "filePath1.jpg"));
            // 写入word输出
            System.out.println(filePath1+"\\wordTest.docx");
            //获取模板
            ClassPathResource template = new ClassPathResource("D:/360/img.docx");
            //读取图片路径
            String filePath = template.getPath();
            //填充word
            XWPFTemplate xwpfTemplate = XWPFTemplate.compile(filePath).render(data);
            //生成word路径
            String docName = filePath1+System.currentTimeMillis() + ".docx";
            //新建File文件对象
            File targetFile = new File(docName);
            //FileOutputStream文件字节输出流
            FileOutputStream out = new FileOutputStream(targetFile);     
            xwpfTemplate.write(out);
            out.flush();          //刷新
            out.close();         //关流
            xwpfTemplate.close();
        } catch (
                IOException e) {
            e.printStackTrace();
        }
    }

}
</code></pre> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/af2d5785b47189749c77330988738d53/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Win11解决应用程序字体太小</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a931b1d162512138407cdce9c59adbc8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">React&#43;wangEditor生成在线编辑工具</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>