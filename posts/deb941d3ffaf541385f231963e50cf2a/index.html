<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>AJAX 识XMLHttpRequest与发送AJAX请求与ajax提交数据 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="AJAX 识XMLHttpRequest与发送AJAX请求与ajax提交数据" />
<meta property="og:description" content="东篱把酒黄昏后，有暗香盈袖
文章目录 前言一、XMLHttpRequest的readyState二、onreadyStatechange三、发送AJAX请求步骤四、ajax提交数据五、ajax get请求缓存问题六、ajax发送post请求总结 前言 耳鸣，真烦人
一、XMLHttpRequest的readyState readyState属性用于记录XMLHttpRequest对象的状态：
值 状态 描述
0 UNSENT 代理被创建，但尚未调用 open() 方法。（请求未初始化）
1 OPENED open() 方法已经被调用。（服务器连接已建立）
2 HEADERS_RECEIVED send() 方法已经被调用，并且头部和状态已经可获得。（请求已收到）
3 LOADING 下载中；responseText 属性已经包含部分数据。(正在处理请求)
4 DONE 下载操作已完成。(请求已完成且响应已就绪)
当XMLHttpRequest对象的readyState属性的值变成4的时候，表示这个AJAX请求以及响应，已经全部完成了
二、onreadyStatechange 当readyState发生改变时调用onreadyStatechange（）
三、发送AJAX请求步骤 四步
第一步，创建AJAX核心对象，XMLHttpRequest var xhr = new XMLHttpRequest(); 第二步，注册回调函数 xhr.onreadystatechange = function () { if (this.readyState == 4) { if (this.status == 200) { //通过XMLHttpRequest对象的responseText属性可以获取到服务器响应回来的内容 //并且不管服务器响应回来的是什么，都以普通文本的形式获取（服务器可能响应回来，普通文本、XML、JSON、HTML....） document.getElementById(&#34;myspan&#34;).innerHTML = this.responseText this.responseText }else { alert(this.status) } } } 第三步，开启通道(open只是浏览器和服务器建立连接，通道打开，并不会发送请求) xhr." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/deb941d3ffaf541385f231963e50cf2a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-22T19:45:05+08:00" />
<meta property="article:modified_time" content="2022-09-22T19:45:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">AJAX 识XMLHttpRequest与发送AJAX请求与ajax提交数据</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>东篱把酒黄昏后，有暗香盈袖</p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_7" rel="nofollow">前言</a></li><li><a href="#XMLHttpRequestreadyState_15" rel="nofollow">一、XMLHttpRequest的readyState</a></li><li><a href="#onreadyStatechange_29" rel="nofollow">二、onreadyStatechange</a></li><li><a href="#AJAX_31" rel="nofollow">三、发送AJAX请求步骤</a></li><li><a href="#ajax_68" rel="nofollow">四、ajax提交数据</a></li><li><a href="#ajax_get_83" rel="nofollow">五、ajax get请求缓存问题</a></li><li><a href="#ajaxpost_101" rel="nofollow">六、ajax发送post请求</a></li><li><a href="#_132" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_7"></a>前言</h2> 
<p>耳鸣，真烦人</p> 
<hr> 
<h2><a id="XMLHttpRequestreadyState_15"></a>一、XMLHttpRequest的readyState</h2> 
<p>readyState属性用于记录XMLHttpRequest对象的状态：</p> 
<p>值 状态 描述<br> 0 UNSENT 代理被创建，但尚未调用 open() 方法。（<code>请求未初始化</code>）<br> 1 OPENED open() 方法已经被调用。（<code>服务器连接已建立</code>）<br> 2 HEADERS_RECEIVED send() 方法已经被调用，并且头部和状态已经可获得。（<code>请求已收到</code>）<br> 3 LOADING 下载中；responseText 属性已经包含部分数据。(<code>正在处理请求</code>)<br> 4 DONE 下载操作已完成。(<code>请求已完成且响应已就绪</code>)</p> 
<p>当XMLHttpRequest对象的readyState属性的值变成4的时候，表示这个AJAX请求以及响应，已经全部完成了</p> 
<h2><a id="onreadyStatechange_29"></a>二、onreadyStatechange</h2> 
<p>当readyState发生改变时调用onreadyStatechange（）</p> 
<h2><a id="AJAX_31"></a>三、发送AJAX请求步骤</h2> 
<p>四步</p> 
<ol><li>第一步，创建AJAX核心对象，XMLHttpRequest</li></ol> 
<pre><code class="prism language-java">            <span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="2"><li>第二步，注册回调函数</li></ol> 
<pre><code class="prism language-java">            xhr<span class="token punctuation">.</span>onreadystatechange <span class="token operator">=</span> function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">//通过XMLHttpRequest对象的responseText属性可以获取到服务器响应回来的内容</span>
                        <span class="token comment">//并且不管服务器响应回来的是什么，都以普通文本的形式获取（服务器可能响应回来，普通文本、XML、JSON、HTML....）</span>
                        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"myspan"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>responseText
                        <span class="token keyword">this</span><span class="token punctuation">.</span>responseText
                    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
</code></pre> 
<ol start="3"><li>第三步，开启通道(open只是浏览器和服务器建立连接，通道打开，并不会发送请求)</li></ol> 
<pre><code class="prism language-java">            xhr<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span><span class="token string">"/ajax/ajaxrequest2"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="4"><li>第四步，发送请求</li></ol> 
<pre><code class="prism language-java">            xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h2><a id="ajax_68"></a>四、ajax提交数据</h2> 
<p>get请求提交数据是在“请求行”上提交，格式是url？name=value&amp;name=value…<br> （HTTP协议中所规定，遵守即可）</p> 
<pre><code class="prism language-java">			<span class="token keyword">var</span> usercode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"usercode"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            <span class="token keyword">var</span> username <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            xhr<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span><span class="token string">"/ajax/ajaxrequest2?usercode="</span><span class="token operator">+</span>usercode<span class="token operator">+</span><span class="token string">"&amp;username="</span><span class="token operator">+</span>username<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-java">usercode<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> id<span class="token operator">=</span><span class="token string">"usercode"</span><span class="token operator">&gt;</span><span class="token generics"><span class="token punctuation">&lt;</span>br<span class="token punctuation">&gt;</span></span>
username<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> id<span class="token operator">=</span><span class="token string">"username"</span><span class="token operator">&gt;</span>
</code></pre> 
<h2><a id="ajax_get_83"></a>五、ajax get请求缓存问题</h2> 
<p>对于低版本的ie浏览器来说，ajax的get请求可能会走缓存，存在缓存问题<br> 什么是ajax 缓存问题？<br> 在HTTP协议中是这样规定get请求的：get请求会被缓存起来<br> POST请求在HTTP协议中规定的是：POST请求不会被浏览器缓存<br> GET请求缓存的优点：直接从浏览器缓存中获取资源，不需要从服务器上重新加载资源，速度较快，用户体验好<br> GET请求缓存的缺点：无法实时获取最新的服务器资源<br> 浏览器什么时候会走缓存？</p> 
<ol><li>是一个GET请求</li><li>请求路径已经被浏览器缓存过了，第二次发送请求的时候，这个路径没有变化，会走浏览器缓存<br> 如果是低版本的IE浏览器，如何解决ajax get请求的缓存问题？<br> 可以在url后加一个时间戳或随机数</li></ol> 
<pre><code class="prism language-java"><span class="token comment">// xhr.open("GET","/ajax/ajaxrequest2?t="+new Date().getTime()+"usercode="+usercode+"&amp;username="+username,true)</span>
   xhr<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span><span class="token string">"/ajax/ajaxrequest2?t="</span><span class="token operator">+</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"usercode="</span><span class="token operator">+</span>usercode<span class="token operator">+</span><span class="token string">"&amp;username="</span><span class="token operator">+</span>username<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span>
            
</code></pre> 
<h2><a id="ajaxpost_101"></a>六、ajax发送post请求</h2> 
<p>修改open函数中的get即可</p> 
<pre><code class="prism language-java">            xhr<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span><span class="token string">"/ajax/ajaxrequest3"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre> 
<p>在ajaxrequest3对应的方法中也应该重写doPost方法</p> 
<p>get请求提交参数：请求行<br> <img src="https://images2.imgbox.com/a9/a2/CNFNK7qN_o.png" alt="在这里插入图片描述"></p> 
<p>post请求提交参数：请求体<br> <img src="https://images2.imgbox.com/6b/7c/4yC0MBbS_o.png" alt="在这里插入图片描述"><br> 模拟ajax提交form表单</p> 
<pre><code class="prism language-java">xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span><span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">)</span>
</code></pre> 
<p>可以在form中的enctype属性中拿到</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>form enctype<span class="token operator">=</span><span class="token string">"application/x-www-form-urlencoded"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8a/fc/tqT4dFOx_o.png" alt="在这里插入图片描述"></p> 
<p>如果不进行表单模拟就会如下：<br> <img src="https://images2.imgbox.com/c3/ef/mK0TDZVX_o.png" alt="在这里插入图片描述"><br> 并且拿不到数据</p> 
<hr> 
<h2><a id="_132"></a>总结</h2> 
<p>xhr.readyState ajax中的XMLHttpRequest状态码<br> xhr.status Http协议中的状态码</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dc1a062e50703b13d4a20ee7f645f4d6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux救援模式应该这样玩（包含重置CentOS 7和8的密码）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2a1324165c68f231afa022e4a0e15470/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">运放如何通过自激振荡产生正弦波？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>