<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ä¿¡å·é‡ï¼ˆSemaphoreï¼‰ä¸çº¿ç¨‹è®¡æ•°å™¨ï¼ˆCountDownLatchï¼‰ - ITå­¦ä¹ è€…åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ä¿¡å·é‡ï¼ˆSemaphoreï¼‰ä¸çº¿ç¨‹è®¡æ•°å™¨ï¼ˆCountDownLatchï¼‰" />
<meta property="og:description" content="ç›®å½•
ğŸ‰ä¿¡å·é‡ï¼ˆSemaphoreï¼‰
ğŸ¥­çº¿ç¨‹è®¡æ•°å™¨ï¼ˆCountDownLatchï¼‰
ğŸ‰ä¿¡å·é‡ï¼ˆSemaphoreï¼‰ Semaphoreå±äºå…±äº«é”ï¼Œå³å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è·å–ï¼Œç”¨æ¥è¡¨ç¤ºå¯ç”¨èµ„æºçš„ä¸ªæ•°ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè®¡æ•°å™¨
ğŸ¥©ç†è§£ä¿¡å·é‡ï¼š
ğŸ‚æˆ‘ä»¬å°†ä¿¡å·é‡ç†è§£ä¸ºä¸€ä¸ªåœè½¦åœºçš„ç©ºè½¦ä½ï¼Œä¾‹å¦‚å½“å‰æœ‰100ä¸ªç©ºè½¦ä½ï¼Œè¡¨ç¤º100ä¸ªå¯ç”¨èµ„æº
ğŸ‚å½“æœ‰è½¦å¼€è¿›åœè½¦åœºï¼Œå°±ç›¸å½“äºç”³è¯·ä¸€ä¸ªå¯ç”¨èµ„æºï¼Œç©ºè½¦ä½å°±-1ï¼ˆè¿™ä¸ªç§°ä¸ºä¿¡å·é‡çš„Pæ“ä½œï¼‰
ğŸ‚å½“æœ‰è½¦å¼€å‡ºåœè½¦åœºï¼Œå°±ç›¸å½“äºé‡Šæ”¾ä¸€ä¸ªå¯ç”¨èµ„æºï¼Œç©ºè½¦ä½å°±&#43;1ï¼ˆè¿™ä¸ªç§°ä¸ºä¿¡å·é‡çš„Væ“ä½œï¼‰
ğŸ‚å¦‚æœå¯ç”¨èµ„æºä¸º0ï¼Œä¼šå°è¯•ç”³è¯·èµ„æºï¼Œå°±ä¼šé˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æœ‰å…¶ä»–çº¿ç¨‹é‡Šæ”¾èµ„æº
ğŸ¥©æ³¨æ„ï¼šSemaphoreçš„PVæ“ä½œçš„åŠ å‡è®¡æ•°å™¨æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ï¼Œå¯ä»¥ç›´æ¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨
ğŸ¡Semaphoreçš„æ„é€ æ–¹æ³•ï¼š
ğŸ­Semaphoreçš„å¸¸ç”¨æ–¹æ³•ï¼š
ğŸ¢ä½¿ç”¨åœºæ™¯ï¼š
â˜˜ï¸ç­‰å¾…ä¸€ç»„çº¿ç¨‹æ‰§è¡Œå®Œï¼Œå†æ‰§è¡ŒæŸä¸ªä»»åŠ¡
â˜˜ï¸åŒä¸€ä¸ªæ—¶é—´æœ€å¤šæ‰§è¡Œnä¸ªçº¿ç¨‹ï¼ˆæœ‰é™èµ„æºçš„ä½¿ç”¨ï¼‰
ğŸ´ç¤ºä¾‹ï¼š
åˆ›å»ºSemaphoreå®ä¾‹ï¼Œåˆå§‹åŒ–ä¸º4ï¼Œè¡¨ç¤º4ä¸ªå¯ç”¨èµ„æº
acquireæ–¹æ³•è¡¨ç¤ºç”³è¯·èµ„æºï¼ˆPæ“ä½œï¼‰ï¼Œreleaseæ–¹æ³•è¡¨ç¤ºé‡Šæ”¾èµ„æºï¼ˆVæ“ä½œï¼‰
åˆ›å»º20ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½å°è¯•ç”³è¯·èµ„æºï¼Œsleepç­‰å¾…1ç§’åï¼Œé‡Šæ”¾èµ„æºï¼Œè§‚å¯Ÿç¨‹åºæ‰§è¡Œç»“æœ
ğŸ‘â€ğŸ—¨ï¸ä»£ç å±•ç¤ºï¼š
import java.util.concurrent.Semaphore; public class SemaphoreTest { public static void main(String[] args) { Semaphore sem = new Semaphore(4); Runnable runnable = new Runnable() { @Override public void run() { try { System.out.println(&#34;ç”³è¯·èµ„æº&#34;); sem.acquire(); System.out.println(&#34;è·å–åˆ°èµ„æº&#34;); Thread.sleep(1000); sem.release(); System.out.println(&#34;é‡Šæ”¾èµ„æº&#34;); } catch (InterruptedException e) { e.printStackTrace(); } } }; for(int i = 0;i &lt; 20;i&#43;&#43;){ Thread t = new Thread(runnable); t." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/37390f8cbc6aa3a5af85aafad49ab99f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-09T21:53:20+08:00" />
<meta property="article:modified_time" content="2022-04-09T21:53:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ITå­¦ä¹ è€…åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ITå­¦ä¹ è€…åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ä¿¡å·é‡ï¼ˆSemaphoreï¼‰ä¸çº¿ç¨‹è®¡æ•°å™¨ï¼ˆCountDownLatchï¼‰</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>ç›®å½•</strong></p> 
<p id="%F0%9F%8D%8D%E4%BF%A1%E5%8F%B7%E9%87%8F%EF%BC%88Semaphore%EF%BC%89-toc" style="margin-left:0px;"><a href="#%F0%9F%8D%8D%E4%BF%A1%E5%8F%B7%E9%87%8F%EF%BC%88Semaphore%EF%BC%89" rel="nofollow">ğŸ‰ä¿¡å·é‡ï¼ˆSemaphoreï¼‰</a></p> 
<p id="%F0%9F%A5%AD%E7%BA%BF%E7%A8%8B%E8%AE%A1%E6%95%B0%E5%99%A8%EF%BC%88CountDownLatch%EF%BC%89-toc" style="margin-left:0px;"><a href="#%F0%9F%A5%AD%E7%BA%BF%E7%A8%8B%E8%AE%A1%E6%95%B0%E5%99%A8%EF%BC%88CountDownLatch%EF%BC%89" rel="nofollow">ğŸ¥­çº¿ç¨‹è®¡æ•°å™¨ï¼ˆCountDownLatchï¼‰</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2>ğŸ‰ä¿¡å·é‡ï¼ˆSemaphoreï¼‰</h2> 
<p><span style="color:#fe2c24;"><span style="background-color:#fef2f0;">Semaphoreå±äºå…±äº«é”</span></span>ï¼Œå³å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è·å–ï¼Œç”¨æ¥<span style="color:#fe2c24;"><span style="background-color:#fef2f0;">è¡¨ç¤ºå¯ç”¨èµ„æºçš„ä¸ªæ•°</span></span>ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª<span style="color:#fe2c24;"><span style="background-color:#fef2f0;">è®¡æ•°å™¨</span></span></p> 
<p><strong>ğŸ¥©ç†è§£ä¿¡å·é‡ï¼š</strong></p> 
<blockquote> 
 <p>ğŸ‚æˆ‘ä»¬å°†ä¿¡å·é‡ç†è§£ä¸ºä¸€ä¸ªåœè½¦åœºçš„ç©ºè½¦ä½ï¼Œä¾‹å¦‚å½“å‰æœ‰100ä¸ªç©ºè½¦ä½ï¼Œè¡¨ç¤º100ä¸ªå¯ç”¨èµ„æº<br> ğŸ‚å½“æœ‰è½¦å¼€è¿›åœè½¦åœºï¼Œå°±ç›¸å½“äº<span style="color:#fe2c24;"><span style="background-color:#fefcd8;">ç”³è¯·ä¸€ä¸ªå¯ç”¨èµ„æº</span></span>ï¼Œ<span style="color:#fe2c24;"><span style="background-color:#fefcd8;">ç©ºè½¦ä½å°±-1</span></span>ï¼ˆè¿™ä¸ªç§°ä¸ºä¿¡å·é‡çš„<span style="color:#fe2c24;"><span style="background-color:#fefcd8;">Pæ“ä½œ</span></span>ï¼‰<br> ğŸ‚å½“æœ‰è½¦å¼€å‡ºåœè½¦åœºï¼Œå°±ç›¸å½“äº<span style="color:#fe2c24;"><span style="background-color:#fefcd8;">é‡Šæ”¾ä¸€ä¸ªå¯ç”¨èµ„æº</span></span>ï¼Œ<span style="color:#fe2c24;"><span style="background-color:#fefcd8;">ç©ºè½¦ä½å°±+1</span></span>ï¼ˆè¿™ä¸ªç§°ä¸ºä¿¡å·é‡çš„<span style="color:#fe2c24;"><span style="background-color:#fefcd8;">Væ“ä½œ</span></span>ï¼‰<br> ğŸ‚å¦‚æœ<span style="color:#fe2c24;"><span style="background-color:#fefcd8;">å¯ç”¨èµ„æºä¸º0</span></span>ï¼Œä¼šå°è¯•ç”³è¯·èµ„æºï¼Œå°±ä¼š<span style="color:#fe2c24;"><span style="background-color:#fefcd8;">é˜»å¡ç­‰å¾…</span></span>ï¼Œç›´åˆ°æœ‰å…¶ä»–çº¿ç¨‹é‡Šæ”¾èµ„æº</p> 
</blockquote> 
<blockquote> 
 <p><strong>ğŸ¥©æ³¨æ„ï¼š</strong>Semaphoreçš„<span style="color:#fe2c24;"><span style="background-color:#d4e9d5;">PVæ“ä½œ</span></span>çš„åŠ å‡è®¡æ•°å™¨æ“ä½œéƒ½æ˜¯<span style="color:#fe2c24;"><span style="background-color:#d4e9d5;">åŸå­æ€§</span></span>çš„ï¼Œå¯ä»¥ç›´æ¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨</p> 
</blockquote> 
<p><strong>ğŸ¡Semaphoreçš„æ„é€ æ–¹æ³•ï¼š</strong></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ca/89/OIpwrt1V_o.jpg"></p> 
<p><strong>ğŸ­Semaphoreçš„å¸¸ç”¨æ–¹æ³•ï¼š</strong></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/8b/f5/Lty5o3De_o.jpg"></p> 
<p><strong>ğŸ¢ä½¿ç”¨åœºæ™¯ï¼š</strong></p> 
<blockquote> 
 <p>â˜˜ï¸ç­‰å¾…ä¸€ç»„çº¿ç¨‹æ‰§è¡Œå®Œï¼Œå†æ‰§è¡ŒæŸä¸ªä»»åŠ¡<br> â˜˜ï¸åŒä¸€ä¸ªæ—¶é—´æœ€å¤šæ‰§è¡Œnä¸ªçº¿ç¨‹ï¼ˆ<span style="color:#fe2c24;"><span style="background-color:#fef2f0;">æœ‰é™èµ„æºçš„ä½¿ç”¨</span></span>ï¼‰</p> 
</blockquote> 
<p><strong>ğŸ´ç¤ºä¾‹ï¼š</strong></p> 
<blockquote> 
 <p>åˆ›å»ºSemaphoreå®ä¾‹ï¼Œåˆå§‹åŒ–ä¸º4ï¼Œè¡¨ç¤º4ä¸ªå¯ç”¨èµ„æº<br> acquireæ–¹æ³•è¡¨ç¤ºç”³è¯·èµ„æºï¼ˆPæ“ä½œï¼‰ï¼Œreleaseæ–¹æ³•è¡¨ç¤ºé‡Šæ”¾èµ„æºï¼ˆVæ“ä½œï¼‰<br> åˆ›å»º20ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½å°è¯•ç”³è¯·èµ„æºï¼Œsleepç­‰å¾…1ç§’åï¼Œé‡Šæ”¾èµ„æºï¼Œè§‚å¯Ÿç¨‹åºæ‰§è¡Œç»“æœ</p> 
</blockquote> 
<p><strong>ğŸ‘â€ğŸ—¨ï¸ä»£ç å±•ç¤ºï¼š</strong></p> 
<pre><code class="language-java">import java.util.concurrent.Semaphore;

public class SemaphoreTest {
    public static void main(String[] args) {
        Semaphore sem = new Semaphore(4);
        Runnable runnable = new Runnable() {
            @Override
            public void run() {
                try {
                    System.out.println("ç”³è¯·èµ„æº");
                    sem.acquire();
                    System.out.println("è·å–åˆ°èµ„æº");
                    Thread.sleep(1000);
                    sem.release();
                    System.out.println("é‡Šæ”¾èµ„æº");
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        };
        for(int i = 0;i &lt; 20;i++){
            Thread t = new Thread(runnable);
            t.start();
        }
    }
}
</code></pre> 
<p><strong>ğŸ‘â€ğŸ—¨ï¸æ‰“å°ç»“æœè¯´æ˜ï¼š</strong></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b5/28/9wObtA26_o.jpg"></p> 
<h2 id="%F0%9F%A5%AD%E7%BA%BF%E7%A8%8B%E8%AE%A1%E6%95%B0%E5%99%A8%EF%BC%88CountDownLatch%EF%BC%89">ğŸ¥­çº¿ç¨‹è®¡æ•°å™¨ï¼ˆCountDownLatchï¼‰</h2> 
<p><span style="color:#fe2c24;"><span style="background-color:#fef2f0;">CountDownLatchä¹Ÿå±äºå…±äº«é”</span></span>ï¼Œå…¶å†…éƒ¨æœ‰ä¸€ä¸ª<span style="color:#fe2c24;"><span style="background-color:#fef2f0;">intç±»å‹çš„å±æ€§</span></span>è¡¨ç¤ºå¯ä»¥åŒæ—¶<span style="color:#fe2c24;"><span style="background-color:#fef2f0;">å¹¶å‘å¹¶è¡Œçš„çº¿ç¨‹çš„æ•°é‡</span></span>Â <br><span style="color:#fe2c24;"><span style="background-color:#fef2f0;">åŒæ—¶ç­‰å¾…Nä¸ªä»»åŠ¡æ‰§è¡Œç»“æŸ</span></span></p> 
<blockquote> 
 <p><strong>ä¸¾ä¾‹è¯´æ˜ï¼š</strong></p> 
 <p>æ¯”å¦‚è·‘æ­¥æ¯”èµ›ï¼Œå¿…é¡»ç­‰æ‰€æœ‰è¿åŠ¨å‘˜é€šè¿‡ç»ˆç‚¹æ‰èƒ½å…¬å¸ƒæˆç»©</p> 
</blockquote> 
<p><strong>ğŸ­CountDownLatchçš„æ„é€ æ–¹æ³•ï¼š</strong></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/dc/8d/ImwXMKQb_o.jpg"></p> 
<p><strong>ğŸ¡CountDownLatchçš„å¸¸ç”¨æ–¹æ³•ï¼š</strong></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/cf/ca/Q5XXXHxM_o.jpg"></p> 
<blockquote> 
 <p><strong>ğŸ¥©ä½¿ç”¨åœºæ™¯ï¼š</strong>ç­‰å¾…å¤šä¸ªçº¿ç¨‹å…¨éƒ¨æ‰§è¡Œå®Œï¼Œå†æ‰§è¡ŒæŸä¸ªä»»åŠ¡</p> 
</blockquote> 
<blockquote> 
 <p><strong>ğŸ¥©æ³¨æ„ï¼š</strong><span style="color:#fe2c24;"><span style="background-color:#fef2f0;">CountDownLatch</span><span style="background-color:#98c091;">åªèƒ½å‡</span><span style="background-color:#f9eda6;">ä¸èƒ½åŠ Â </span></span></p> 
</blockquote> 
<p><strong>ğŸ´ç¤ºä¾‹ï¼š</strong></p> 
<blockquote> 
 <p>æ„é€ CountDownLatchå®ä¾‹ï¼Œåˆå§‹åŒ–ä¸º10ï¼Œè¡¨ç¤ºæœ‰10ä¸ªä»»åŠ¡éœ€è¦å®Œæˆ<br> æ¯ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œè°ƒç”¨countDown()ï¼ŒCountDownLatchå†…éƒ¨è®¡æ•°å™¨è‡ªå‡<br> ä¸»çº¿ç¨‹è°ƒç”¨await(),ç­‰å¾…æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œä¹Ÿå°±æ˜¯è®¡æ•°å™¨å€¼ä¸º0ï¼Œå†ç»§ç»­æ‰§è¡Œä¸»çº¿ç¨‹åç»­ä»»åŠ¡</p> 
</blockquote> 
<p>ğŸ‘â€ğŸ—¨ï¸<strong>ä»£ç å±•ç¤ºï¼š</strong></p> 
<pre><code class="language-java">import java.util.concurrent.CountDownLatch;

public class CountDownLatchTest {
    public static void main(String[] args) throws InterruptedException {
        CountDownLatch latch = new CountDownLatch(10);
        Runnable runnable = new Runnable() {
            @Override
            public void run() {
                System.out.println(Thread.currentThread().getName());
                latch.countDown();
            }
        };
        for(int i = 0;i &lt; 10;i++){
            Thread t = new Thread(runnable);
            t.start();
        }
        latch.await();
        System.out.println("10ä¸ªçº¿ç¨‹æ¯”èµ›ç»“æŸ");
    }
}
</code></pre> 
<p><strong>ğŸ‘â€ğŸ—¨ï¸æ‰“å°ç»“æœè¯´æ˜ï¼š</strong></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b3/0d/pzucGUQT_o.jpg"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/536d68075bdbce3e008745acd38c83d4/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">uniappå°ç¨‹åºçˆ¶ç»„ä»¶ä¸å­ç»„ä»¶ä¹‹é—´è°ƒç”¨æ–¹æ³•</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/daffbe7329e3317d859d2ff79c9904d1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">iframeåµŒå…¥é¡µé¢ä¹‹Cookieså­˜å–</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ITå­¦ä¹ è€…åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>