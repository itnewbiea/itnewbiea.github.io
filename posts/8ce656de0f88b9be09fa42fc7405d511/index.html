<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>表空间创建格式及属性说明 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="表空间创建格式及属性说明" />
<meta property="og:description" content="今天看了很多关于创建表空间的帖子，但是觉得都不全面，所以决定结合自己的开发经验和网上资源总结一下。 ORACLE中，表空间是数据管理的基本方法，所有用户的对象要存放在表空间中，也就是用户有空间的使用权，才能创建用户对象．否则是不充许创建对象，因为就是想创建对象,如表,索引等，也没有地方存放,Oracle会提示:没有存储配额．　因此，在创建对象之前，首先要分配存储空间。 一、创建表空间完整的格式 CREATE [UNDO|TEMPORARY] TABLESPACE tablespace_name DATAFILE &#39;path/filename&#39; [SIZE INTEGER[K| M]] [REUSE] [AUTOEXTEND [OFF | ON ] ] [NEXT INTEGER[K | M]] [MAXSIZE [UNLIMITED | INTEGER[K | M]]] [MINIMUM EXTENT INTEGER[K | M]] [BLOCKSIZE integer [k]] [DEFAULT STORAGE storage_clause] [ONLINE | OFFLINE] [LOGGING | NOLOGGING] [FORCE LOGGING] [EXTENT MANAGEMENT [DICTIONARY | LOCAL]] [AUTOALLOCATE | UNIFORM [SIZE INTEGER[K | M]]] [SEGMENT SPACE MANAGEMENT [AUTO | MANUAL]] 二、表空间格式说明 1、UNDO 说明系统将创建一个回滚表空间。 在9i中数据库管理员可以不必管理回滚段，只有建立了undo表空间，系统就会自动管理回滚段的分配，回收的工作。当然,也可以创建一般的表空间,在上 面创建回滚段." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8ce656de0f88b9be09fa42fc7405d511/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-08-20T17:40:05+08:00" />
<meta property="article:modified_time" content="2012-08-20T17:40:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">表空间创建格式及属性说明</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    今天看了很多关于创建表空间的帖子，但是觉得都不全面，所以决定结合自己的开发经验和网上资源总结一下。 
<br> 
<br> 
<br> ORACLE中，表空间是数据管理的基本方法，所有用户的对象要存放在表空间中，也就是用户有空间的使用权，才能创建用户对象．否则是不充许创建对象，因为就是想创建对象,如表,索引等，也没有地方存放,Oracle会提示:没有存储配额．　　因此，在创建对象之前，首先要分配存储空间。 
<br> 
<br> 
<br> 一、创建表空间完整的格式 
<br> CREATE [UNDO|TEMPORARY] TABLESPACE tablespace_name  
<br>      DATAFILE 'path/filename' [SIZE INTEGER[K| M]]  [REUSE]  
<br>      [AUTOEXTEND [OFF | ON ] ] 
<br>      [NEXT INTEGER[K | M]] 
<br>      [MAXSIZE [UNLIMITED | INTEGER[K | M]]] 
<br>      [MINIMUM EXTENT INTEGER[K | M]] 
<br>      [BLOCKSIZE integer [k]] 
<br>      [DEFAULT STORAGE storage_clause] 
<br>      [ONLINE | OFFLINE] 
<br>      [LOGGING | NOLOGGING] 
<br>      [FORCE LOGGING] 
<br>      [EXTENT MANAGEMENT [DICTIONARY | LOCAL]] 
<br>      [AUTOALLOCATE | UNIFORM [SIZE INTEGER[K | M]]] 
<br>      [SEGMENT SPACE MANAGEMENT [AUTO | MANUAL]] 
<br> 
<br> 
<br> 二、表空间格式说明 
<br> 1、UNDO 
<br>       说明系统将创建一个回滚表空间。 
<br>        在9i中数据库管理员可以不必管理回滚段，只有建立了undo表空间，系统就会自动管理回滚段的分配，回收的工作。当然,也可以创建一般的表空间,在上         面创建回滚段.不过对于用户来说,系统管理比自己管理要好很多.如果需要自己管理,请参见回滚段管理的命令详解. 
<br>        当没有为系统指定回滚表空间时,系统将使用system系统回滚段来进行事务管理。 
<br> 2、tablespace_name表空间名满足oracle的命名规范即可。 
<br> 3、DATAFILE 'path/filename' [SIZE INTEGER[K| M]]  [REUSE]  
<br>       指定一个或多个数据文件路径和文件名,[SIZE INTEGER[K| M]]用来指定表空间在数据文件中所占的空间大小，K|M是说大小的单位是K还是M。 
<br>       [REUSE] 如果创建表空间指定的数据文件已经存在，则需要使用reuse注明，否则会报错。 
<br>       ERROR at line 1: 
<br> ORA-01537: cannot add data file 'E:\oracle\oradata\10.1.0\ZRPTEST\TB_TEST1.dbf' 
<br> - file already part of database 
<br> 4、[AUTOEXTEND [OFF | ON ] ]   
<br>       禁止或允许自动扩展数据文件，默认情况下为OFF 
<br> 5、[NEXT INTEGER[K | M]]  
<br>       指定当需要更多盘区时分配给数据文件的磁盘空间，以K或M为单位。 
<br> 6、[MAXSIZE [UNLIMITED | INTEGER[K | M]]]  
<br>       指定允许分配给数据文件的最大磁盘空间，当为UNLIMITED时表示只有当磁盘空间满时，才不允许再扩展数据文件。 
<br> 7、[MINMUM EXTENT INTEGER[K | M]]   
<br>       指定盘区大小是指定大小的整数倍。即initial和next盘区大小应为minimum extent的整数倍，这个参数可以减小空间碎片，保证表空间的范围是这个值的整数倍。 
<br>       【注：minextents 用于指定在创建时分配给段的盘区总数。使用这个参数，即使可用空间是不连续的，在创建对象时也能分配很大的空间。默认                    值和最小值都是1。如果minextents&gt;1，盘区大小以next和pctincrease为基础计算。】 
<br> 8、[BLOCKSIZE integer [k]] 
<br>         这个参数可以设定一个不标准的块的大小。如果要设置这个参数，必须设置db_block_size,至少一个db_nk_block_size, 
<br>         并且声明的integer的值必须等于db_nk_block_size. 
<br>        注意：在临时表空间不能设置这个参数。 
<br> 9、 [DEFAULT STORAGE storage_clause] 
<br>        表示为在该表空间创建的全部对象指定缺省的存储参数，没有指定时oracle将会为所有对象指定一些系统默认的存储参数。 
<br>        storage_clause的语法格式如下： 
<br>        STORAGE（ 
<br>             INITIAL integer[K|M]       --为段分配第一个区的大小 
<br>             NEXT     integer[K|M]       --为第一个扩展分区的大小 
<br>             MINEXTENTS integer|UMLIMITED      --创建段时分配的最小总区间数 
<br>             MAXEXTENTS integer|UMLIMITED     --创建段时分配的最大总区间数 
<br>             PCTINCREASE integer                           --每次扩展增量的大小 
<br>             FREELISTS integer                                  --模式对象中每一个自由列表组中自由列表的数量，表、族或索引的每个空闲列表组中的列表数量。 
<br>             FREELISTS GROUPS integer                  --指定表、族或索引的每个空闲列表组数量。 
<br>          ） 
<br> 10、[ONLINE | OFFLINE] 
<br>       ONLINE是指在创建表空间之后使该表空间立即对授权访问该表空间的用户可用。 
<br>       OFFLINE是指offline以后，未完成的事物可以提交或回滚，但不能发起新的事物，也不能进行查询。OFFLINE的四种模式 
<br>        （1）NORMAL：做检查点  
<br>                  alter tablespace users  offline;           alter tablespace users online; 
<br>        （2）TEMPORARY：可以在数据文件损坏的情况下offline tablespace 
<br>                  alter tablespace users offline temporary;   alter tablespace users online; 
<br>        （3）IMMEDIATE：不做检查点，只有在归档模式下才可以offline tablespace，online时需要recover 
<br>                  alter tablespace users offline immediate;    recover tablespace users;       alter tablespace users online; 
<br>         （4）FOR RECOVER：在归档模式下才可以offonline，在基于时间点的恢复时使用。 
<br>                  alter tablespace users offline for recover;     recover tablsespace users;    alter tablespace users online; 
<br> 11、[LOGGING | NOLOGGING] 
<br>       指定日志属性，它表示将来的表、索引等是否需要进行日志处理。默认值为LOGGING 
<br> 12、[FORCE LOGGING] 
<br>        使用这个子句指出表空间进入强制日志模式。此时，系统将记录表空间上对象的所有改变，除了临时段的改变。这个参数高于对象的nologging选项。 
<br>        注意：设置这个参数指数据库不可以open并且进入读写模式。而且，在临时表空间和回滚表空间中不能使用这个选项。 
<br> 13、[PERMANENT | TEMPORARY] 
<br>        指出表空间的属性，是永久表空间还是临时表空间。永久表空间存放的是永久对象，临时表空间存放的是session生命期中存在的临时对象。 
<br>        这个参数生成的临时表空间创建后一直都是字典管理，不能使用extent management local选项。 
<br>        如果要创建本地管理表空间，必须使用create temporary tablespace 
<br>        注意，声明了这个参数后，不能声明block size 
<br> 14、[EXTENT MANAGEMENT [DICTIONARY | LOCAL]] 
<br>         [AUTOALLOCATE | UNIFORM [SIZE INTEGER[K | M]]] 
<br>         这是最重要的子句，说明了表空间如何管理范围。一旦你声明了这个子句，只能通过移植的方式改变这些参数。 
<br>         如果希望表空间本地管理的话，声明local选项。本地管理表空间是通过位图管理的。autoallocate说明表空间自动分配范围，用户不能指定范围的大小。 
<br>         只有9.0以上的版本具有这个功能。uniform说明表空间的范围的固定大小，缺省是1m。 
<br>          不能将本地管理的数据库的system表空间设置成字典管理。oracle公司推荐使用本地管理表空间。 
<br>          如果没有设置extent_management_clause，oracle会给他设置一个默认值。如果初始化参数compatible小于9.0.0,那么系统创建字典管理表空间。 
<br>           如果大于9.0.0,那么按照如下设置：如果没有指定default storage_clause,oracle创建一个自动分配的本地管理表空间。 
<br>          否则，如果指定了mininum extent,那么oracle判断mininum extent 、initial、next是否相等,以及pctincrease是否=0.如果满足以上的条件，oracle创建一个本地管理 
<br>           表空间，extent size是initial.如果不满足以上条件，那么oracle将创建一个自动分配的本地管理表空间。 
<br>           如果没有指定mininum extent。initial、那么oracle判断next是否相等,以及pctincrease是否=0。表示满足oracle创建一个本地管理表空间并指定uniform。 
<br>            否则oracle将创建一个自动分配的本地管理表空间。 
<br>           注意：本地管理表空间只能存储永久对象。如果你声明了local,将不能声明default storage_clause,mininum extent、temporary. 
<br> 15、[SEGMENT SPACE MANAGEMENT [AUTO | MANUAL]] 
<br>        指定 表空间段的管理方式，AUTO为系统自动管理，MANUAL为手工管理。默认为AUTO。 
<br> 
<br> 
<br> 三、表空间创建实例 
<br> 1、创建一个本地自动分配管理的永久表空间： 
<br>       SQL&gt; create tablespace ZRP_MAIN_TB  
<br>   2    datafile 'E:\oracle\oradata\10.1.0\ZRPTEST\ZRP_TB\MAIN_TB1.dbf' size 200M, 
<br>   3             'E:\oracle\oradata\10.1.0\ZRPTEST\ZRP_TB\MAIN_TB2.dbf' size 200M AUTOEXTEND ON  NEXT 
<br>  1M MAXSIZE 2000M  
<br>   4    ONLINE  
<br>   5    LOGGING  
<br>   6    EXTENT MANAGEMENT LOCAL AUTOALLOCATE  
<br>   7    SEGMENT SPACE MANAGEMENT AUTO; 
<br> 
<br> 
<br> Tablespace created. 
<br> 
<br> 
<br> SQL&gt; create tablespace ZRP_MAIN_TB  
<br>   2    datafile 'E:\oracle\oradata\10.1.0\ZRPTEST\ZRP_TB\MAIN_TB1.dbf' size 200M, 
<br>   3             'E:\oracle\oradata\10.1.0\ZRPTEST\ZRP_TB\MAIN_TB2.dbf' size 200M  
<br>   4    EXTENT MANAGEMENT LOCAL AUTOALLOCATE ; 
<br> 
<br> 
<br> Tablespace created. 
<br> 
<br> 
<br> 注：这里不能设置MINIMUN EXTENT 和BLOCKSIZE，否则会报错。 
<br> SQL&gt; create tablespace ZRP_MAIN_TB  
<br>   2    datafile 'E:\oracle\oradata\10.1.0\ZRPTEST\ZRP_TB\MAIN_TB1.dbf' size 200M, 
<br>   3             'E:\oracle\oradata\10.1.0\ZRPTEST\ZRP_TB\MAIN_TB2.dbf' size 200M AUTOEXTEND ON  NEXT 
<br>  1M MAXSIZE 2000M  
<br>   4    MINIMUM EXTENT 32K  
<br>   5    BLOCKSIZE 1 
<br>   6    ONLINE  
<br>   7    LOGGING  
<br>   8    EXTENT MANAGEMENT LOCAL AUTOALLOCATE  
<br>   9    SEGMENT SPACE MANAGEMENT AUTO; 
<br> create tablespace ZRP_MAIN_TB 
<br> * 
<br> ERROR at line 1: 
<br> ORA-25143: default storage clause is not compatible with allocation policy 
<br> 
<br> 
<br> 2、创建一个数据字典管理的的永久表空间： 
<br> SQL&gt; CREATE TABLESPACE ZRP_MAIN_TB  
<br>   2    DATAFILE 'E:\oracle\oradata\10.1.0\ZRPTEST\ZRP_TB\MAIN_TB1.dbf' size 200M, 
<br>   3             'E:\oracle\oradata\10.1.0\ZRPTEST\ZRP_TB\MAIN_TB2.dbf' size 200M AUTOEXTEND ON  NEXT 
<br>  1280K MAXSIZE 2000M  
<br>   4    MINIMUM EXTENT 128K  
<br>   5    BLOCKSIZE 1 
<br>   6    DEFAULT STORAGE( 
<br>   7      INITIAL 1280K  
<br>   8   NEXT    1280K  
<br>   9   MINEXTENTS 1  
<br>  10   MAXEXTENTS 4096  
<br>  11   PCTINCREASE 0  
<br>  12    ) 
<br>  13    ONLINE  
<br>  14    LOGGING  
<br>  15    EXTENT MANAGEMENT DICTIONARY  
<br>  16    UNIFORM SIZE 200M; 
<br> CREATE TABLESPACE ZRP_MAIN_TB 
<br> * 
<br> ERROR at line 1: 
<br> ORA-12913: Cannot create dictionary managed tablespace 
<br> 
<br> 
<br> 错误原因：在ORACLE9i之后，系统缺省安装时为本地管理表空间（LOCAL MANAGED TABLESPACE）LMT。 
<br> 注：这里不能设置SEGMENT SPACE MANAGEMENT AUTO; 
<br> 
<br> 
<br> 3、创建一个临时表空间： 
<br> 格式一： 
<br> SQL&gt; create temporary tablespace ZRP_TMP_TB1 
<br>   2  tempfile 'E:\oracle\oradata\10.1.0\ZRPTEST\ZRP_TB\TMP_TB1.dbf' size 100M 
<br>   3  autoextend on  
<br>   4  next 1M 
<br>   5  extent management local  
<br>   6  / 
<br> 
<br> 
<br> Tablespace created. 
<br> 注意：这里不能用AUTOALLOCATE 、SEGMENT SPACE MANAGEMENT AUTO、LOGGING、ONLINE等标记符。 
<br> 
<br> 
<br> 格式一： 
<br> create temporary tablespace ZRP_TMP_TB3  
<br> tempfile 'E:\oracle\oradata\10.1.0\ZRPTEST\ZRP_TB\TMP_TB3.dbf' size 100M 
<br> autoextend on  
<br> next 10M  
<br> maxsize 100M 
<br> extent management local  
<br> uniform size 99M; 
<br> 注意：1、在创建表空间过程中uniform size的大小必须小于数据文件的size大小 
<br>             2、在创建表空间过程中maxsize的大小必须大于等于数据文件的size大小  
<br> 
<br> 
<br> 
<br> 
<br> 4、创建一个UNDO表空间： 
<br> create undo tablespace ZRP_UNDO_TB1  
<br> datafile 'E:\oracle\oradata\10.1.0\ZRPTEST\ZRP_TB\UNDO_TB1.dbf' size 100M 
<br> autoextend on  
<br> next 10M  
<br> maxsize 100M 
<br> online  
<br> extent management local autoallocate;  
<br> segment space management auto; 
<br> 注意：这里不能定义minimum extent、blocksize、default storage、online、logging、segment space management。 
<br> 
<br> 
<br> 
<br> 
<br>        
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e47b9a7401aa40c0562d92a5799d24f6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">LR常见问题整理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6ef08a1ace280881031deda080eefeff/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据库设计经验谈(2)设计表和字段</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>