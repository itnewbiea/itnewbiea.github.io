<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>某后台管理系统加密参数逆向分析 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="某后台管理系统加密参数逆向分析" />
<meta property="og:description" content="前言 在我们日常的渗透中经常会遇到开局一个登录框的情况，弱口令爆破当然是我们的首选。但是有的网站会对账号密码等登录信息进行加密处理，这一步不由得阻碍了很多人的脚步。前端的加解密是比较常见的，无论是 web 后台还是小程序，都常常存在加解密传输，签名防篡改等机制，会使很多渗透人员没有办法直接对参数的值进行更改，大大增加了攻击者的攻击成本。本文将一个带验证码的后台实站案例与大家分享。
正文 发包逻辑分析： 开局一个登录框，随便输入一段账号密码跟验证码进行抓包
提交错误的验证码跟账号密码弹出了验证码错误！的提示，说明这个数据包就是校验账号密码跟验证码的数据包
查看一下参数，账号，验证码都是明文，密码被加密了
搜索参数关键词password，可以看到一个带有login的js文件，双击进入文件。
在文件内部总共有10个password关键词，全部打上断点发包校验。
断点在196行断了下来，t.param.password是明文。经过Object(i[&#34;a&#34;])函数运行之后就成了加密密文。证明Object(i[&#34;a&#34;])便是加密函数！后续便是把所有需要拿去爆破的明文加密成密文便可绕过前端加密直接进行暴力破解。
扣加密函数： 进入到加密函数内部查看
可以看到函数内部有个s函数，将断点下到156行，查看传进来的t是什么值，以及经过s函数运行之后的返回值又是什么呢。
t是传进来的明文，返回值是加密之后的值。
观察一下代码，可以看到&#34;93a9&#34;和 &#34;7d92&#34;，把代码拉到第一行，这个站点用的webpack打包技术。
那么webpack又是什么呢？
WebPack打包 webpack是一个基于模块化的打包（构建）工具, 它把一切都视作模块
概念：
webpack是 JavaScript 应用程序的模块打包器,可以把开发中的所有资源（图片、js文件、css文件等）都看成模块，通过loader（加载器）和plugins（插件）对资源进行处理，打包成符合生产环境部署的前端资源。所有的资源都是通过JavaScript渲染出来的。
如果一个页面大部分是script标签构成，80%以上是webpack打包。
1. webpack打包简介
image20220329153518062
多个JS文件打包：
如果模块比较多，就会将模块打包成JS文件, 然后定义一个全局变量 window[&#34;webpackJsonp&#34;] = [ ]，它的作用是存储需要动态导入的模块，然后重写 window[&#34;webpackJsonp&#34;] 数组的 push( ) 方法为 webpackJsonpCallback( ),也就是说 window[&#34;webpackJsonp&#34;].push( ) 其实执行的是 webpackJsonpCallback( ),window[&#34;webpackJsonp&#34;].push( )接收三个参数,第一个参数是模块的ID,第二个参数是 一个数组或者对象,里面定义大量的函数,第三个参数是要调用的函数(可选)
寻找加载器 加载器一般是使用call或者apply方法
call() 方法会立即执行这个函数，接受一个多个参数，参数之间用逗号隔开；
apply()方法会立即执行这个函数，接受一个包含多个参数的数组；
我们找类似i(&#34;1ff3&#34;)这种的字眼，然后打断点，刷新页面进断点，一般就可以找到加载器了
断点断下来之后直接进入加载器函数
可以看到d函数里面明显的使用了call函数。
直接全扣整段webpack代码。
定义全局变量调用模块，运行代码
var 君主; 报错windows未定义。直接补上window对象。
var window={}; 在导出的模块里面没有寻找到我们需要的“7d92”模块
复制donate~login.06871226.js文件到ide折叠，将其7d92模块复制到我们有加载器的模块数组里面。
调用7d92模块" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/4a1943409308dbb26f57e2ab2d18bb34/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-29T17:09:47+08:00" />
<meta property="article:modified_time" content="2023-12-29T17:09:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">某后台管理系统加密参数逆向分析</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>前言</h3> 
<p>在我们日常的渗透中经常会遇到开局一个登录框的情况，弱口令爆破当然是我们的首选。但是有的网站会对账号密码等登录信息进行加密处理，这一步不由得阻碍了很多人的脚步。前端的加解密是比较常见的，无论是 web 后台还是小程序，都常常存在加解密传输，签名防篡改等机制，会使很多渗透人员没有办法直接对参数的值进行更改，大大增加了攻击者的攻击成本。本文将一个带验证码的后台实站案例与大家分享。</p> 
<h3>正文</h3> 
<h4>发包逻辑分析：</h4> 
<p>开局一个登录框，随便输入一段账号密码跟验证码进行抓包</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="810" src="https://images2.imgbox.com/64/f8/tlpdUCSv_o.jpg" width="731"></p> 
<p>提交错误的验证码跟账号密码弹出了验证码错误！的提示，说明这个数据包就是校验账号密码跟验证码的数据包</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="107" src="https://images2.imgbox.com/d2/05/QtO1DLJQ_o.jpg" width="1080"></p> 
<p>查看一下参数，账号，验证码都是明文，密码被加密了</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="261" src="https://images2.imgbox.com/bd/88/FQeRSr7A_o.jpg" width="1080"></p> 
<p>搜索参数关键词password，可以看到一个带有login的js文件，双击进入文件。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="177" src="https://images2.imgbox.com/67/2c/mywu1bkY_o.jpg" width="1080"></p> 
<p>在文件内部总共有10个password关键词，全部打上断点发包校验。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="529" src="https://images2.imgbox.com/a3/c8/gmXsObv1_o.jpg" width="1080"></p> 
<p>断点在196行断了下来，t.param.password是明文。经过Object(i["a"])函数运行之后就成了加密密文。证明Object(i["a"])便是加密函数！后续便是把所有需要拿去爆破的明文加密成密文便可绕过前端加密直接进行暴力破解。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="127" src="https://images2.imgbox.com/34/b5/UBA256hS_o.jpg" width="1080"></p> 
<p></p> 
<p class="img-center"><img alt="图片" height="130" src="https://images2.imgbox.com/ea/80/Yy1pCLOY_o.jpg" width="1080"></p> 
<h4>扣加密函数：</h4> 
<p>进入到加密函数内部查看</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="137" src="https://images2.imgbox.com/f6/1b/SRE6mR1m_o.jpg" width="1080"></p> 
<p>可以看到函数内部有个s函数，将断点下到156行，查看传进来的t是什么值，以及经过s函数运行之后的返回值又是什么呢。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="612" src="https://images2.imgbox.com/40/87/WXgM80P0_o.jpg" width="1080"></p> 
<p>t是传进来的明文，返回值是加密之后的值。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="103" src="https://images2.imgbox.com/a2/57/u6CFwn7G_o.jpg" width="1080"></p> 
<p>观察一下代码，可以看到"93a9"和 "7d92"，把代码拉到第一行，这个站点用的webpack打包技术。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="28" src="https://images2.imgbox.com/9c/e4/G8JFpNlM_o.jpg" width="962"></p> 
<p>那么webpack又是什么呢？</p> 
<h4>WebPack打包</h4> 
<p><code>webpack</code>是一个基于模块化的打包（构建）工具, 它把一切都视作模块</p> 
<p><strong>概念：</strong></p> 
<p><code>webpack</code>是 <code>JavaScript</code> 应用程序的模块打包器,可以把开发中的所有资源（图片、js文件、css文件等）都看成模块，通过loader（加载器）和<code>plugins</code>（插件）对资源进行处理，打包成符合生产环境部署的前端资源。所有的资源都是通过<code>JavaScript</code>渲染出来的。</p> 
<p>如果一个页面大部分是script标签构成，80%以上是<code>webpack</code>打包。</p> 
<ol><li> <p>1. <code>webpack</code>打包简介</p> </li></ol> 
<p></p> 
<p class="img-center"><img alt="图片" height="631" src="https://images2.imgbox.com/56/8a/1P2CvSz4_o.jpg" width="949"></p> 
<p>image20220329153518062</p> 
<p>多个<code>JS</code>文件打包：</p> 
<p>如果模块比较多，就会将模块打包成JS文件, 然后定义一个全局变量 <code>window["webpackJsonp"] = [ ]</code>，它的作用是存储需要动态导入的模块，然后重写 <code>window["webpackJsonp"]</code> 数组的 push( ) 方法为 <code>webpackJsonpCallback( )</code>,也就是说 <code>window["webpackJsonp"].push( )</code> 其实执行的是 <code>webpackJsonpCallback( )</code>,<code>window["webpackJsonp"].push( )</code>接收三个参数,第一个参数是模块的ID,第二个参数是 一个数组或者对象,里面定义大量的函数,第三个参数是要调用的函数(可选)</p> 
<h4>寻找加载器</h4> 
<p>加载器一般是使用call或者apply方法</p> 
<p>call() 方法会立即执行这个函数，接受一个多个参数，参数之间用逗号隔开；<br> apply()方法会立即执行这个函数，接受一个包含多个参数的数组；</p> 
<p>我们找类似i("1ff3")这种的字眼，然后打断点，刷新页面进断点，一般就可以找到加载器了</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="508" src="https://images2.imgbox.com/47/b7/INOYKVli_o.jpg" width="1080"></p> 
<p>断点断下来之后直接进入加载器函数</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="278" src="https://images2.imgbox.com/dc/39/KTyaeaLk_o.jpg" width="1080"></p> 
<p>可以看到d函数里面明显的使用了call函数。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="546" src="https://images2.imgbox.com/1e/a1/P5CaLwtI_o.jpg" width="1080"></p> 
<p>直接全扣整段webpack代码。</p> 
<p>定义全局变量调用模块，运行代码</p> 
<pre><code>var 君主;</code></pre> 
<p></p> 
<p class="img-center"><img alt="图片" height="611" src="https://images2.imgbox.com/35/dc/19D7aNqA_o.jpg" width="892"></p> 
<p>报错windows未定义。直接补上window对象。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="213" src="https://images2.imgbox.com/4f/da/DofSMnBM_o.jpg" width="1080"></p> 
<pre><code>var window={};</code></pre> 
<p>在导出的模块里面没有寻找到我们需要的“7d92”模块</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="388" src="https://images2.imgbox.com/c3/c9/Jn6dooam_o.jpg" width="1080"></p> 
<p>复制donate~login.06871226.js文件到ide折叠，将其7d92模块复制到我们有加载器的模块数组里面。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="233" src="https://images2.imgbox.com/3a/14/NfW8kmgL_o.jpg" width="1080"></p> 
<p>调用7d92模块</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="336" src="https://images2.imgbox.com/16/84/4sZHZOPc_o.jpg" width="718"></p> 
<p>报错了TypeError: Cannot read properties of undefined (reading 'call')模块缺失的错误。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="192" src="https://images2.imgbox.com/11/96/jdYDAA0M_o.jpg" width="1080"></p> 
<p>打印传进去的模块，看看是缺失哪个模块咱们直接补。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="276" src="https://images2.imgbox.com/ed/08/OwOFdFvZ_o.jpg" width="905"></p> 
<p>缺失1ff3模块</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="287" src="https://images2.imgbox.com/63/e4/REGfvRY6_o.jpg" width="1080"></p> 
<p>缺失f28c模块</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="645" src="https://images2.imgbox.com/89/13/MPfSvzUp_o.jpg" width="1005"></p> 
<p>浏览器全局搜索f28c，模块f28c在chunk-vendors.db1c4c0d.js文件里面。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="536" src="https://images2.imgbox.com/45/17/Pef1F26W_o.jpg" width="1080"></p> 
<p>缺失143d模块,143d模块在donate~login.06871226.js文件里面。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="463" src="https://images2.imgbox.com/32/b9/xJgnGjJa_o.jpg" width="1080"></p> 
<p>后续报错的93a9，ea6a模块也都在donate~login.06871226.js文件里面。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="908" src="https://images2.imgbox.com/79/d8/2cNEC3IT_o.jpg" width="846"></p> 
<p>没有报错了，调用当前函数。加密值出来了。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="462" src="https://images2.imgbox.com/39/cd/Zpa1hE7s_o.jpg" width="1080"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8081533c0e8a25287b9ed4f55e68caa1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Oracle研学-对象</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/74f00553212046f0ac1a8be528b221fc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">flutter绘制流程——rebuild</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>