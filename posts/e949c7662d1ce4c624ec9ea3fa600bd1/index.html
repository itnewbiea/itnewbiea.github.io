<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【大数据（一）】hadoop2.4.1集群搭建(重点) - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【大数据（一）】hadoop2.4.1集群搭建(重点)" />
<meta property="og:description" content="​
1.准备Linux环境 1.0先将虚拟机的网络模式选为NAT 1.1修改主机名 vi /etc/sysconfig/network
NETWORKING=yes HOSTNAME=server1.itcast.cn 1.2修改ip地址 vi /etc/sysconfig/network-scripts/ifcfg-eth0
重新启动网络：service network restart
1.3修改ip地址和主机名的映射关系 vi /etc/hosts
127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4 ::1 localhost localhost.localdomain localhost6 localhost6.localdomain6 192.168.0.101 server1.itcast.cn 1.4关闭防火墙iptables并设置其开机启动/不启动 #查看防火墙状态
service iptables status #关闭防火墙
service iptables stop #查看防火墙开机启动状态
chkconfig iptables --list #关闭防火墙开机启动
chkconfig iptables off 1.5 修改sudo （sudo是linux系统管理指令，是允许系统管理员让普通用户执行一些或者全部的root命令的一个工具）
1. su root #进入超级用户 2. ll /etc/sudoers #查看/etc/sudoers的权限 3. chmod 777 /etc/sudoers #修改/etc/sudoers文件的权限成可读可写可执行 4 vi /etc/sudoers # 给hadoop用户添加执行的权限 root ALL=(ALL) ALL hadoop ALL=(ALL) ALL 5." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/e949c7662d1ce4c624ec9ea3fa600bd1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-04T16:33:06+08:00" />
<meta property="article:modified_time" content="2024-01-04T16:33:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【大数据（一）】hadoop2.4.1集群搭建(重点)</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:.0001pt;text-align:justify;">​</p> 
<h2 style="text-align:justify;"><strong><strong><strong>1.准备Linux环境</strong></strong></strong></h2> 
<h3 style="text-align:justify;"><strong>1.0先将虚拟机的网络模式选为NAT</strong></h3> 
<h3 style="background-color:transparent;text-align:justify;"><strong>1.1修改主机名</strong></h3> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">vi /etc/sysconfig/network</p> 
</blockquote> 
<pre><code class="language-javascript">NETWORKING=yes

HOSTNAME=server1.itcast.cn</code></pre> 
<h3 style="text-align:justify;"><strong>1.2修改ip地址</strong></h3> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">vi /etc/sysconfig/network-scripts/ifcfg-eth0</p> 
</blockquote> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong>重新启动网络：</strong>service network restart</p> 
</blockquote> 
<h3 style="text-align:justify;"><strong>1.3修改ip地址和主机名的映射关系</strong></h3> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">vi /etc/hosts</p> 
</blockquote> 
<pre><code class="language-javascript">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4

::1         localhost localhost.localdomain localhost6 localhost6.localdomain6

192.168.0.101 server1.itcast.cn</code></pre> 
<h3 style="background-color:transparent;text-align:justify;"><strong>1.4关闭防火墙iptables并设置其开机启动/不启动</strong></h3> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">#查看防火墙状态</p> 
</blockquote> 
<pre><code class="language-javascript">service iptables status</code></pre> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">#关闭防火墙</p> 
</blockquote> 
<pre><code class="language-javascript">service iptables stop</code></pre> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">#查看防火墙开机启动状态</p> 
</blockquote> 
<pre><code class="language-javascript">chkconfig iptables --list</code></pre> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">#关闭防火墙开机启动</p> 
</blockquote> 
<pre><code class="language-javascript">chkconfig iptables off</code></pre> 
<h3 style="background-color:transparent;text-align:justify;"><strong>1.5 修改sudo</strong></h3> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">（sudo是linux系统管理指令，是允许系统管理员让普通用户执行一些或者全部的root命令的一个工具）</p> 
</blockquote> 
<pre><code class="language-javascript">1.  su root   #进入超级用户

2.  ll /etc/sudoers   #查看/etc/sudoers的权限

3.  chmod 777 /etc/sudoers  #修改/etc/sudoers文件的权限成可读可写可执行

4    vi  /etc/sudoers

# 给hadoop用户添加执行的权限

  root    ALL=(ALL)       ALL

hadoop  ALL=(ALL)       ALL 

5.  chmod 440 /etc/sudoers   #退出保存/etc/sudoers文件

6.  su username  #切换用户到指定用户

7. 关闭linux服务器的图形界面：

（1）vi  /etc/inittab

（2）id:5:initdefault:  ------&gt;  id:3:initdefault:

8.重启Linux：Reboot </code></pre> 
<h3 style="text-align:justify;"><strong>1.6 虚拟机复制  </strong></h3> 
<p style="margin-left:.0001pt;text-align:justify;"> 右键--&gt;管理--&gt;克隆</p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">（1）解决克隆后eth0不见的问题</p> 
</blockquote> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">直接修改  /etc/sysconfig/network-script/ifcfg-eth0</p> 
 <p style="margin-left:.0001pt;text-align:justify;">删掉UUID  HWADDR</p> 
 <p style="margin-left:.0001pt;text-align:justify;">配置静态地址</p> 
</blockquote> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">（2）然后：</p> 
</blockquote> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">vi /etc/udev/rules.d/70-persistent-net.rules</p> 
 <p style="margin-left:.0001pt;text-align:justify;">   删除eth0的一段</p> 
 <p style="margin-left:.0001pt;text-align:justify;">   把第二段的最后 eth1 改成eth0</p> 
 <p style="margin-left:.0001pt;text-align:justify;">然后 reboot</p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;">                                        </p> 
<h2 style="text-align:justify;"><strong><strong><strong>2.安装JDK</strong></strong></strong></h2> 
<h3 style="text-align:justify;"><strong>2.1上传安装包</strong></h3> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">alt+p 后出现sftp窗口，然后put d:\xxx\yy\ll\jdk-7u_65-i585.tar.gz</p> 
</blockquote> 
<h3 style="text-align:justify;"><strong>2.2解压jdk</strong></h3> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">#创建文件夹</p> 
</blockquote> 
<pre><code class="language-javascript">mkdir /home/hadoop/app</code></pre> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">#解压</p> 
</blockquote> 
<pre><code class="language-javascript">tar -zxvf jdk-7u55-linux-i586.tar.gz -C /home/hadoop/app</code></pre> 
<h3 style="background-color:transparent;text-align:justify;"><strong>2.3将java添加到环境变量中</strong></h3> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">vi /etc/profile</p> 
</blockquote> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">#在文件最后添加</p> 
</blockquote> 
<pre><code class="language-javascript">export JAVA_HOME=/home/hadoop/app/jdk-7u_65-i585

export PATH=$PATH:$JAVA_HOME/bin

export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</code></pre> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">#刷新配置</p> 
</blockquote> 
<pre><code class="language-javascript">source /etc/profile</code></pre> 
<h2 style="text-align:justify;"><strong><strong><strong>3.安装hadoop2.4.1</strong></strong></strong></h2> 
<h3 style="text-align:justify;"><strong>3.1上传安装包</strong></h3> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">alt+p 后出现sftp窗口先上传hadoop的安装包到服务器上去/home/hadoop/</p> 
 <p style="margin-left:.0001pt;text-align:justify;"></p> 
 <p style="margin-left:.0001pt;text-align:justify;">解压到 Hadoop/apps : tar -zxvf hadoop-2.6.4.tar.gz -C /home/hadoop/apps</p> 
 <p style="margin-left:.0001pt;text-align:justify;"></p> 
 <p style="margin-left:.0001pt;text-align:justify;">注意：hadoop2.x的配置文件$HADOOP_HOME/etc/hadoop</p> 
 <p style="margin-left:.0001pt;text-align:justify;">伪分布式需要修改5个配置文件</p> 
</blockquote> 
<h3 style="text-align:justify;"><strong>3.2配置hadoop</strong></h3> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">    进入目录：cd  /home/hadoop/apps/hadoop-2.6.4/etc/hadoop</p> 
</blockquote> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong>第一个：hadoop-env.sh</strong></p> 
 <p style="margin-left:.0001pt;text-align:justify;">vi hadoop-env.sh</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#第27行​</p> 
 <p style="margin-left:.0001pt;text-align:justify;">编辑</p> 
</blockquote> 
<pre><code class="language-javascript">export JAVA_HOME=/home/hadoop/apps/jdk1.7.0_45</code></pre> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">第二个：core-site.xml</p> 
 <p style="margin-left:.0001pt;text-align:justify;"></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#4da8ee;">vi  core-site.xml</span></strong></p> 
</blockquote> 
<pre><code class="language-javascript">&lt;!-- 指定HADOOP所使用的文件系统schema（URI），HDFS的老大（NameNode）的地址 --&gt;

&lt;configuration&gt;

&lt;property&gt;

&lt;name&gt;fs.defaultFS&lt;/name&gt;

&lt;value&gt;hdfs://mini1:9000&lt;/value&gt;

&lt;/property&gt;

(修改前的&lt;value&gt;hdfs://weekend-1206-01:9000&lt;/value&gt;)

&lt;!-- 指定hadoop运行时产生文件的存储目录 --&gt;

&lt;property&gt;

&lt;name&gt;hadoop.tmp.dir&lt;/name&gt;

&lt;value&gt;/home/hadoop/hdpdata&lt;/value&gt;

        &lt;/property&gt;

（修改前的&lt;value&gt;/home/hadoop/hadoop-2.4.1/tmp&lt;/value&gt;  )

&lt;/configuration&gt;</code></pre> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">第三个：hdfs-site.xml   </p> 
 <p style="margin-left:.0001pt;text-align:justify;"></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#4da8ee;">   vi hdfs-site.xml</span></strong></p> 
</blockquote> 
<pre><code class="language-javascript">&lt;!-- 指定HDFS副本的数量 --&gt;

&lt;configuration&gt;

&lt;property&gt;

&lt;name&gt;dfs.replication&lt;/name&gt;

&lt;value&gt;2&lt;/value&gt;

&lt;/property&gt;

&lt;property&gt;

&lt;name&gt;dfs.secondary.http.address&lt;/name&gt;

&lt;value&gt;192.168.1.152:50090&lt;/value&gt;

&lt;/property&gt;

&lt;/configuration&gt;</code></pre> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">第四个：mapred-site.xml</p> 
 <p style="margin-left:.0001pt;text-align:justify;"></p> 
 <p style="margin-left:.0001pt;text-align:justify;">(mv mapred-site.xml.  template mapred-site.xml)</p> 
 <p style="margin-left:.0001pt;text-align:justify;">mv mapred-site.xml.template      mapred-site.xml</p> 
 <p style="margin-left:.0001pt;text-align:justify;">vim mapred-site.xml</p> 
</blockquote> 
<pre><code class="language-javascript">&lt;!-- 指定mr运行在yarn上 --&gt;

&lt;property&gt;

&lt;name&gt;mapreduce.framework.name&lt;/name&gt;

&lt;value&gt;yarn&lt;/value&gt;

&lt;/property&gt;

重命名：mv mapred-site.xml.template    mapred-site.xml</code></pre> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">第五个：yarn-site.xml</p> 
 <p style="margin-left:.0001pt;text-align:justify;"></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#4da8ee;"><strong>vi yarn-site.xml</strong></span></p> 
</blockquote> 
<pre><code class="language-javascript">&lt;!-- 指定YARN的老大（ResourceManager）的地址 --&gt;

&lt;property&gt;

&lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;

&lt;value&gt;mini1&lt;/value&gt;

&lt;/property&gt;

&lt;!-- reducer获取数据的方式 --&gt;

&lt;property&gt;

&lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;

&lt;value&gt;mapreduce_shuffle&lt;/value&gt;

&lt;/property&gt;</code></pre> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">  分发到各个mini2 ，mini3 的机器上</p> 
</blockquote> 
<pre><code class="language-javascript">scp -r /home/hadoop/apps mini2:/home/hadoop/

scp -r /home/hadoop/apps mini3:/home/hadoop/</code></pre> 
<h3 style="text-align:justify;"><strong>3.3将hadoop添加到环境变量</strong></h3> 
<pre><code class="language-javascript">sudo vi /etc/profile

export JAVA_HOME=/usr/java/jdk1.7.0_65

export HADOOP_HOME= /home/hadoop/apps/hadoop-2.6.4 

export PATH=$PATH:$JAVA_HOME/bin:$HADOOP_HOME/bin:$HADOOP_HOME/sbin

source /etc/profile</code></pre> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">分发到各个mini2 ，mini3 的机器上</p> 
</blockquote> 
<pre><code class="language-javascript">sudo scp /etc/profile mini2:/etc/

sudo scp /etc/profile mini3:/etc/</code></pre> 
<h3 style="text-align:justify;"><strong>3.4格式化namenode（是对namenode进行初始化）</strong></h3> 
<pre><code class="language-javascript">hdfs namenode -format (hadoop namenode -format)

hdfs datanode -format</code></pre> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">添加从节点</p> 
</blockquote> 
<pre><code class="language-javascript">vi /home/hadoop/apps/hadoop-2.6.4/etc/Hadoop/slaves

localhost

mini2

mini3</code></pre> 
<h3 style="text-align:justify;"><strong>3.5启动/关闭hadoop</strong></h3> 
<pre><code class="language-javascript">#mini1：cd  /home/hadoop/apps/hadoop-2.6.4/sbin

启动： hadoop-daemon.sh  start namenode

关闭：hadoop-daemon.sh  stop namenode

#mini2: source /etc/profile

启动：hadoop-daemon.sh  start datanode

关闭：hadoop-daemon.sh  stop datanode

#mini3

启动：hadoop-daemon.sh  start datanode

关闭：hadoop-daemon.sh  stop datanode

先启动HDFS

sbin/start-dfs.sh

再启动YARN

sbin/start-yarn.sh

------------------------------------------------------------------------------

全部启动

路径： cd  /home/hadoop/apps/hadoop-2.6.4/sbin

./start-all.sh

./stop-all.sh

启动namenode

hadoop-daemon.sh start namenode

启动datanode

hadoop-daemon.sh start datanode

启动yarn

hadoop-daemon.sh start yarn

查看hdfs 状态

hdfs  dfsadmin  -report</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">  </p> 
<h3 style="text-align:justify;"><strong>3.6验证是否启动成功</strong></h3> 
<pre><code class="language-javascript">使用jps命令验证

27408 NameNode

28218 Jps

27643 SecondaryNameNode

28066 NodeManager

27803 ResourceManager

27512 DataNode

http://192.168.1.101:50070 （HDFS管理界面）

http://192.168.1.101:8088 （MR管理界面）</code></pre> 
<h2 style="text-align:justify;"><strong><strong><strong>4.配置ssh免登陆</strong></strong></strong></h2> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">系统重装后修改 ssh：</p> 
 <p style="margin-left:.0001pt;text-align:justify;">进入是vi  /root/.ssh/known_hosts 删除对应的节点内容</p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;">--------------------------------------------------------------------------------</p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">#生成ssh免登陆密钥</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#进入到我的home目录:cd ~/.ssh</p> 
 <p style="margin-left:.0001pt;text-align:justify;"> （1） ssh-keygen （四个回车）</p> 
 <p style="margin-left:.0001pt;text-align:justify;">执行完这个命令后，会生成两个文件id_rsa（私钥）、id_rsa.pub（公钥）</p> 
 <p style="margin-left:.0001pt;text-align:justify;">将公钥拷贝到要免密登陆的目标机器上</p> 
 <p style="margin-left:.0001pt;text-align:justify;"> （2） ssh-copy-id mini2</p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;">---------------------------</p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">ssh免登陆：</p> 
 <p style="margin-left:.0001pt;text-align:justify;">生成key:</p> 
 <p style="margin-left:.0001pt;text-align:justify;">ssh-keygen</p> 
 <p style="margin-left:.0001pt;text-align:justify;">复制从A复制到B上:</p> 
 <p style="margin-left:.0001pt;text-align:justify;">ssh-copy-id B</p> 
 <p style="margin-left:.0001pt;text-align:justify;">验证：</p> 
 <p style="margin-left:.0001pt;text-align:justify;">ssh localhost/exit，ps -e|grep ssh</p> 
 <p style="margin-left:.0001pt;text-align:justify;">ssh A  #在B中执行</p> 
</blockquote> 
<h2 style="text-align:justify;"></h2> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">​</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f27a3ca4279c60d695adff206d8433c7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">安装部署halo博客</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ed710a3879923a1b969f0376c6cbd1ef/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Langchain-Chatchat开源库使用的随笔记（一）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>