<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Gradle发布依赖包到Github仓库 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Gradle发布依赖包到Github仓库" />
<meta property="og:description" content="上周接了个需求，需要把项目中一个模块打包发布到git上供其他项目使用。
大无语，查了一大堆真的是醉醉的，乱七八糟没有一个好使的，最后还是官方文档靠谱啊，xdm，以后有需求先查官方文档啊！！！
我个人认为，写博客不光是为了记录，同时最好也能帮别人解决一些问题，只有这样一篇博客才多少有点价值吧，写到哪种程度呢，最好是饭都送到嘴边那种程度！！！这样自己回过头来看的时候，也不会一脸懵。
下面想详细说一下gradle发布依赖包到github仓库的具体步骤。
请保证访问github畅通，最好网络好一点，因为上传和下载如果网络不佳，是很可能失败的。
第一步：修改配置 （此处是单个包，多个包参考官网，区别不大，官网地址文末会放）在你需要发布的模块的build.gradle文件中，添加下列代码：
plugins { id &#39;maven-publish&#39; } publishing { repositories { maven { name = &#34;GitHubPackages&#34; url = uri(&#34;https://maven.pkg.github.com/jwcxs-m/jarproject&#34;) credentials { username = System.getenv(&#34;GITHUB_ACTOR&#34;) password = System.getenv(&#34;GITHUB_TOKEN&#34;) } } } publications { gpr(MavenPublication) { from(components.java) } } } username和password我这里配了环境变量，如果嫌麻烦甚至可以在发包的时候直接给定值，像下面这样：
credentials { username = &#34;Damon&#34; password = &#34;ghp_7asdwrc123dsww34YyqkkpP1jHzvR&#34; } 注意：如果直接填写了token，不要把token直接提交到github仓库中，不然github会检测到你的token被上传到项目里，就强行给你把token停用了！！！
然后就是说password，就是这个token咋生成的：
最后拉到最下方，点这个绿的一键生成。
生成后的token复制出来，因为只有第一次能看到，下次进来就看不到了。然后把token设置给上面的password就行。
第二步：发布 找个喜欢的地方（常用终端或者是IDEA里的终端都行…），直接执行gradle publish（不出意外的话，就会看到发布成功，出意外了再说…）
乌鱼子，刚说完就报错了…
Failed to publish publication &#39;gpr&#39; to repository &#39;GitHubPackages&#39; Could not PUT &#39;https://maven." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/5e618749f4067adbe279b320f3e799b0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-17T10:21:49+08:00" />
<meta property="article:modified_time" content="2022-03-17T10:21:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Gradle发布依赖包到Github仓库</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>上周接了个需求，需要把项目中一个模块打包发布到git上供其他项目使用。<br> 大无语，查了一大堆真的是醉醉的，乱七八糟没有一个好使的，最后还是官方文档靠谱啊，xdm，以后有需求先查官方文档啊！！！<br> 我个人认为，写博客不光是为了记录，同时最好也能帮别人解决一些问题，只有这样一篇博客才多少有点价值吧，写到哪种程度呢，最好是饭都送到嘴边那种程度！！！这样自己回过头来看的时候，也不会一脸懵。<br> 下面想详细说一下gradle发布依赖包到github仓库的具体步骤。<br> <strong>请保证访问github畅通，最好网络好一点，因为上传和下载如果网络不佳，是很可能失败的。</strong></p> 
<h3><a id="_5"></a>第一步：修改配置</h3> 
<p>（此处是单个包，多个包参考官网，区别不大，官网地址文末会放）在你需要发布的模块的build.gradle文件中，添加下列代码：<br> <img src="https://images2.imgbox.com/58/85/yhx8eNzu_o.png" alt="在这里插入图片描述"></p> 
<pre><code>plugins {
    id 'maven-publish'
}
</code></pre> 
<pre><code>publishing {
    repositories {
        maven {
            name = "GitHubPackages"
            url = uri("https://maven.pkg.github.com/jwcxs-m/jarproject")
            credentials {
                username = System.getenv("GITHUB_ACTOR")
                password = System.getenv("GITHUB_TOKEN")
            }
        }
    }

    publications {
        gpr(MavenPublication) {
            from(components.java)
        }
    }
}
</code></pre> 
<p><strong>username和password我这里配了环境变量，如果嫌麻烦甚至可以在发包的时候直接给定值，像下面这样：</strong></p> 
<pre><code>credentials {
                username = "Damon"
                password = "ghp_7asdwrc123dsww34YyqkkpP1jHzvR"
            }
</code></pre> 
<p><strong>注意：如果直接填写了token，不要把token直接提交到github仓库中，不然github会检测到你的token被上传到项目里，就强行给你把token停用了！！！</strong></p> 
<p><strong>然后就是说password，就是这个token咋生成的：</strong><br> <img src="https://images2.imgbox.com/e6/3a/0tH4JSri_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ef/6f/rP3czUzO_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4c/73/gAFEMNm1_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a7/de/qOYNe3wz_o.png" alt="在这里插入图片描述"><br> 最后拉到最下方，点这个绿的一键生成。<br> <img src="https://images2.imgbox.com/12/63/divKULDE_o.png" alt="在这里插入图片描述"><br> <strong>生成后的token复制出来，因为只有第一次能看到，下次进来就看不到了。然后把token设置给上面的password就行。</strong></p> 
<h3><a id="_51"></a>第二步：发布</h3> 
<p>找个喜欢的地方（常用终端或者是IDEA里的终端都行…），直接执行<code>gradle publish</code>（不出意外的话，就会看到发布成功，出意外了再说…）<br> 乌鱼子，刚说完就报错了…</p> 
<pre><code>Failed to publish publication 'gpr' to repository 'GitHubPackages'
 Could not PUT 'https://maven.pkg.github.com/jwcxs-m/tjar/io/dingodb/d/0.1.0-SNAPSHOT/d-0.1.0-20220316.024713-3.jar'. Received status code 422 from server: Unprocessable Entity
</code></pre> 
<p>一开始我以为是项目的问题，就尝试重新在github上新建项目，然后试了有2次都不行。<br> 就换了个思路，结合之前成功的项目，发现现在使用这个项目没有gradle的子模块，就尝试建了一个子模块：<br> <img src="https://images2.imgbox.com/b7/8d/QFBAkVBj_o.png" alt="在这里插入图片描述"><br> 然后就publish成功了：<br> <img src="https://images2.imgbox.com/96/58/09dTJAJ4_o.png" alt="在这里插入图片描述"><br> github仓库中显示：<br> <img src="https://images2.imgbox.com/2f/61/WoR6zNXU_o.png" alt="在这里插入图片描述"><br> 至此，使用gradle发布依赖包到github已经完全讲完了。</p> 
<h3><a id="_66"></a>如何使用上传的依赖包</h3> 
<p>传都传上去了，总不能不说使用的事情吧，那不合理…<br> 上面github截图那个红框点进去会看到：<br> <img src="https://images2.imgbox.com/df/ed/D0x9VOs3_o.png" alt="在这里插入图片描述"><br> 如果不是很清楚怎么使用，就先看看这个，然后根据这个去在配置里引用该依赖包：<br> <img src="https://images2.imgbox.com/38/8b/V2JyxQDN_o.png" alt="在这里插入图片描述"><br> 上面那块红框内的东西，跟publish时的配置保持一致就可以了，主要是<strong>url</strong>一定要一致。<br> dependencies里，引用依赖格式是<strong>groupId:artifactId:version</strong><br> 配置好以后按下面两种方式刷新都可以：<br> <img src="https://images2.imgbox.com/2c/e3/H8ijPal3_o.png" alt="在这里插入图片描述"><br> 或<br> <img src="https://images2.imgbox.com/01/15/pKJ6Glva_o.png" alt="在这里插入图片描述"><br> 刷新之后在左侧也可查看。（如果下载不了，首先查看url以及dependencies到底设置的对不对，然后就是<strong>再次强调：网一定要好…不然很难下载下来。</strong>）<br> <img src="https://images2.imgbox.com/45/c2/GtvVbOQr_o.png" alt="在这里插入图片描述"><br> 到此结束吧，可能中途还会碰到一些问题，比如我在下载依赖包的时候，因为网络太差，导致下载失败解析不了，去本地仓库查看，发现目录下全是lastupdated后缀结尾的文件，于是整个目录全删除，网络确定好一点的时候，又重新刷新才下载下来。</p> 
<p>官方文档（里面还有maven等各种型号）：<br> https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-gradle-registry</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/27bcd47b7702a338801239c4795cc99c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">pytorch卷积操作nn.Conv中的groups参数用法解释</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7cf737db7de2038c0ea8d1b83932bacc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">内网安全-域横向CobaltStrike&amp;SPN&amp;RDP</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>