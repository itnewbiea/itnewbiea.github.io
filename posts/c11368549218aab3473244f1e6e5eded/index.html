<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>php文章归档怎么做,php归档格式phar文件详解 | 木凡博客 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="php文章归档怎么做,php归档格式phar文件详解 | 木凡博客" />
<meta property="og:description" content="phar (“Php ARchive”) 是PHP里类似于JAR的一种打包文件。如果你使用的是PHP5.3或更高版本，那么phar后缀文件是默认开启支持的，你不需要任何其他的安装就可以使用它。
phar归档文件有三种格式：tar归档、zip归档、phar归档，前两种执行需要php安装phar 扩展支持，用的也比较少，这里主要讲phar归档格式。
phar文件缺省状态是只读的，使用phar文件不需要任何的配置，部署非常方便。因为我们要创建phar文件，所以需要允许写入phar文件，这需要修改一下php.ini。找到phar.readonly将其修改为phar.readonly = off，注意不要忘记去掉前面的注释分号;。
一、创建phar文件
我们建立项目文件夹project，目录内结构如下：
static
-common.js
-app.css
lib
-liba.php
template
-msg.html
index.php
common.php
1
2
3
4
5
6
7
8
9
static
-common.js
-app.css
lib
-liba.php
template
-msg.html
index.php
common.php
项目文件有了，现在我们开始创建phar文件。首先在project同级目录下创建文件build.php，用于产生phar格式文件。内容如下：
PHP
/**
* @Author 木凡
* @DateTime 2020-04-24T15:03:49&#43;0800
* @Domian http://mounui.com
*/
// 产生一个myphar.phar文件
$phar = new Phar(&#39;myphar.phar&#39;);
// 添加project里面的所有文件到myphar.phar文件
$phar-&gt;buildFromDirectory(dirname(__FILE__) . &#39;/project&#39;);
// 设置执行时的入口文件，这里都设置为index.php。注意：如果项目不具备单一执行入口则不宜使用phar归档文件
$phar-&gt;setStub($phar-&gt;createDefaultStub(&#39;index.php&#39;));
1
2
3
4" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c11368549218aab3473244f1e6e5eded/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-09T18:59:08+08:00" />
<meta property="article:modified_time" content="2021-03-09T18:59:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">php文章归档怎么做,php归档格式phar文件详解 | 木凡博客</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>phar (“Php ARchive”) 是PHP里类似于JAR的一种打包文件。如果你使用的是PHP5.3或更高版本，那么phar后缀文件是默认开启支持的，你不需要任何其他的安装就可以使用它。</p> 
 <p>phar归档文件有三种格式：tar归档、zip归档、phar归档，前两种执行需要php安装phar 扩展支持，用的也比较少，这里主要讲phar归档格式。</p> 
 <p>phar文件缺省状态是只读的，使用phar文件不需要任何的配置，部署非常方便。因为我们要创建phar文件，所以需要允许写入phar文件，这需要修改一下php.ini。找到phar.readonly将其修改为phar.readonly = off，注意不要忘记去掉前面的注释分号;。</p> 
 <p>一、创建phar文件</p> 
 <p>我们建立项目文件夹project，目录内结构如下：</p> 
 <p>static</p> 
 <p>-common.js</p> 
 <p>-app.css</p> 
 <p>lib</p> 
 <p>-liba.php</p> 
 <p>template</p> 
 <p>-msg.html</p> 
 <p>index.php</p> 
 <p>common.php</p> 
 <p>1</p> 
 <p>2</p> 
 <p>3</p> 
 <p>4</p> 
 <p>5</p> 
 <p>6</p> 
 <p>7</p> 
 <p>8</p> 
 <p>9</p> 
 <p>static</p> 
 <p>-common.js</p> 
 <p>-app.css</p> 
 <p>lib</p> 
 <p>-liba.php</p> 
 <p>template</p> 
 <p>-msg.html</p> 
 <p>index.php</p> 
 <p>common.php</p> 
 <p>项目文件有了，现在我们开始创建phar文件。首先在project同级目录下创建文件build.php，用于产生phar格式文件。内容如下：</p> 
 <p>PHP</p> 
 <p>/**</p> 
 <p>* @Author 木凡</p> 
 <p>* @DateTime 2020-04-24T15:03:49+0800</p> 
 <p>* @Domian http://mounui.com</p> 
 <p>*/</p> 
 <p>// 产生一个myphar.phar文件</p> 
 <p>$phar = new Phar('myphar.phar');</p> 
 <p>// 添加project里面的所有文件到myphar.phar文件</p> 
 <p>$phar-&gt;buildFromDirectory(dirname(__FILE__) . '/project');</p> 
 <p>// 设置执行时的入口文件，这里都设置为index.php。注意：如果项目不具备单一执行入口则不宜使用phar归档文件</p> 
 <p>$phar-&gt;setStub($phar-&gt;createDefaultStub('index.php'));</p> 
 <p>1</p> 
 <p>2</p> 
 <p>3</p> 
 <p>4</p> 
 <p>5</p> 
 <p>6</p> 
 <p>7</p> 
 <p>8</p> 
 <p>9</p> 
 <p>10</p> 
 <p>11</p> 
 <p>/**</p> 
 <p>* @Author   木凡</p> 
 <p>* @DateTime 2020-04-24T15:03:49+0800</p> 
 <p>* @Domian   http://mounui.com</p> 
 <p>*/</p> 
 <p>// 产生一个myphar.phar文件</p> 
 <p>$phar=newPhar('myphar.phar');</p> 
 <p>// 添加project里面的所有文件到myphar.phar文件</p> 
 <p>$phar-&gt;buildFromDirectory(dirname(__FILE__).'/project');</p> 
 <p>// 设置执行时的入口文件，这里都设置为index.php。注意：如果项目不具备单一执行入口则不宜使用phar归档文件</p> 
 <p>$phar-&gt;setStub($phar-&gt;createDefaultStub('index.php'));</p> 
 <p>new Phar的参数是压缩包的名称。buildFromDirectory指定压缩的目录，第二个参数可通过正则来制定压缩文件的扩展名。执行build.php文件就创建了一个myphar.phar文件。</p> 
 <p>在创建过程中可能会遇到错误提示“creating archive "myphar.phar" disabled by the php.ini setting phar.readonly”，这里就是没有修改php.ini中phar.readonly = off引起的。</p> 
 <p>二、使用phar文件</p> 
 <p>在使用的时候我们只需要直接引入phar文件就可以了</p> 
 <p>PHP</p> 
 <p>/**</p> 
 <p>* @Author 木凡</p> 
 <p>* @DateTime 2020-04-24T15:10:55+0800</p> 
 <p>* @Domian http://mounui.com</p> 
 <p>*/</p> 
 <p>// 当我们使用index.php文件的时候只需要引入myphar.phar就可以，因为创建的时候我们设置的入口文件就是index.php</p> 
 <p>include "myphar.phar";</p> 
 <p>// 使用其他文件的时候不仅要引入phar，还要单独引入要使用的文件</p> 
 <p>include "phar://myphar.phar/common.php";</p> 
 <p>1</p> 
 <p>2</p> 
 <p>3</p> 
 <p>4</p> 
 <p>5</p> 
 <p>6</p> 
 <p>7</p> 
 <p>8</p> 
 <p>9</p> 
 <p>/**</p> 
 <p>* @Author   木凡</p> 
 <p>* @DateTime 2020-04-24T15:10:55+0800</p> 
 <p>* @Domian   http://mounui.com</p> 
 <p>*/</p> 
 <p>// 当我们使用index.php文件的时候只需要引入myphar.phar就可以，因为创建的时候我们设置的入口文件就是index.php</p> 
 <p>include"myphar.phar";</p> 
 <p>// 使用其他文件的时候不仅要引入phar，还要单独引入要使用的文件</p> 
 <p>include"phar://myphar.phar/common.php";</p> 
 <p>在实际项目中一般会在入口文件中导入其他所需的全部文件，所以如果项目不具备单一入口不宜使用phar归档文件。</p> 
 <p>三、还原phar文件</p> 
 <p>PHP</p> 
 <p>/**</p> 
 <p>* @Author 木凡</p> 
 <p>* @DateTime 2020-04-24T15:15:55+0800</p> 
 <p>* @Domian http://mounui.com</p> 
 <p>*/</p> 
 <p>// 需要还原的phar文件，路径不要写错</p> 
 <p>$phar = new Phar('myphar.phar');</p> 
 <p>// 这里填写phar文件的还原路径和名称</p> 
 <p>$phar-&gt;extractTo('myphar');</p> 
 <p>1</p> 
 <p>2</p> 
 <p>3</p> 
 <p>4</p> 
 <p>5</p> 
 <p>6</p> 
 <p>7</p> 
 <p>8</p> 
 <p>9</p> 
 <p>/**</p> 
 <p>* @Author   木凡</p> 
 <p>* @DateTime 2020-04-24T15:15:55+0800</p> 
 <p>* @Domian   http://mounui.com</p> 
 <p>*/</p> 
 <p>// 需要还原的phar文件，路径不要写错</p> 
 <p>$phar=newPhar('myphar.phar');</p> 
 <p>// 这里填写phar文件的还原路径和名称</p> 
 <p>$phar-&gt;extractTo('myphar');</p> 
 <p>经过打包归档后的文件在使用的时候并不会影响效率，而且方便部署。</p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cae2b4e392eaff1fff1716bacb3ade8c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">php manager如何安装目录,linux如何查看php安装目录？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3e2a403e33303ebb39df8eed1bf91523/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">linux 的php怎么安装目录,linux如何查找php安装目录</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>