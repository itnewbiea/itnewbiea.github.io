<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习实战(MachineLearinginAction) 第三章 决策树 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习实战(MachineLearinginAction) 第三章 决策树" />
<meta property="og:description" content="决策树(decision tree)很流行的一个原因就是对机器学习算法的知识要求很低.
决策模块(decision block) 终止模块(terminating block):表示已经得出结论,可以终止运行 分支(branch)连接决策模块或终止模块.
有点:计算复杂度不高,易于理解,对中间值的缺失不敏感,可处理不相关特征数据. 缺点:可能会产生过度匹配问题. 使用数据类型:数值型和标称型
创建数据集
def createDataSet(): dataSet = [[1, 1, &#39;yes&#39;], [1, 1, &#39;yes&#39;], [1, 0, &#39;no&#39;], [0, 1, &#39;no&#39;], [0, 1, &#39;no&#39;]] labels = [&#39;no surfacing&#39;,&#39;flippers&#39;] #change to discrete values return dataSet, labels 计算信息熵 信息增益(information gain) 熵(entropy) 如果待分类的事物可能划分在多个分类中,则符号 xi x i 的信息定义为 l(xi)=−log2p(xi) l ( x i ) = − l o g 2 p ( x i ) ,注意这个是信息值 其中 p(xi) p ( x i ) 是选择该分类的概率." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/8bdc5ec64e277b491d078cb4408d3349/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-03-12T14:34:59+08:00" />
<meta property="article:modified_time" content="2018-03-12T14:34:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习实战(MachineLearinginAction) 第三章 决策树</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>决策树(decision tree)很流行的一个原因就是对机器学习算法的知识要求很低.</p> 
<p>决策模块(decision block) <br> 终止模块(terminating block):表示已经得出结论,可以终止运行 <br> 分支(branch)连接决策模块或终止模块.</p> 
<p>有点:计算复杂度不高,易于理解,对中间值的缺失不敏感,可处理不相关特征数据. <br> 缺点:可能会产生过度匹配问题. <br> 使用数据类型:数值型和标称型</p> 
<p><strong>创建数据集</strong></p> 
<pre class="prettyprint"><code class=" hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">createDataSet</span><span class="hljs-params">()</span>:</span>
    dataSet = [[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'yes'</span>],
               [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'yes'</span>],
               [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-string">'no'</span>],
               [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'no'</span>],
               [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'no'</span>]]
    labels = [<span class="hljs-string">'no surfacing'</span>,<span class="hljs-string">'flippers'</span>]
    <span class="hljs-comment">#change to discrete values</span>
    <span class="hljs-keyword">return</span> dataSet, labels</code></pre> 
<p><strong>计算信息熵</strong> <br> 信息增益(information gain) <br> 熵(entropy) <br> 如果待分类的事物可能划分在多个分类中,则符号<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-257" style="width: 1.096em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em 1000.89em 2.451em -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-258"><span class="msubsup" id="MathJax-Span-259"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.52em 4.169em -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.576em;"><span class="mi" id="MathJax-Span-261" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       x 
      
     
       i 
      
     
   </span></span><script type="math/tex" id="MathJax-Element-17">x_i</script>的信息定义为 <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-262" style="width: 9.482em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.867em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em 1007.76em 2.555em -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-263"><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-266"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.52em 4.169em -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.576em;"><span class="mi" id="MathJax-Span-268" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-269" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mo" id="MathJax-Span-271" style="font-family: MathJax_Main; padding-left: 0.263em;">−</span><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math-italic;">o</span><span class="msubsup" id="MathJax-Span-274"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.378em -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-275" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.471em;"><span class="mn" id="MathJax-Span-276" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-278" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-279"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.52em 4.169em -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.576em;"><span class="mi" id="MathJax-Span-281" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      l 
     
    
      ( 
     
     
     
       x 
      
     
       i 
      
     
    
      ) 
     
    
      = 
     
    
      − 
     
    
      l 
     
    
      o 
     
     
     
       g 
      
     
       2 
      
     
    
      p 
     
    
      ( 
     
     
     
       x 
      
     
       i 
      
     
    
      ) 
     
   </span></span><script type="math/tex" id="MathJax-Element-18">l(x_i) = -log_2p(x_i)</script>,注意这个是信息值 <br> 其中<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-283" style="width: 2.659em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em 1002.09em 2.555em -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-284"><span class="mi" id="MathJax-Span-285" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-286" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-287"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.52em 4.169em -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.576em;"><span class="mi" id="MathJax-Span-289" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      p 
     
    
      ( 
     
     
     
       x 
      
     
       i 
      
     
    
      ) 
     
   </span></span><script type="math/tex" id="MathJax-Element-19">p(x_i)</script>是选择该分类的概率. <br> 为了计算熵,要计算所有类别所有可能值包含的信息期望值: <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-291" style="width: 13.909em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.565em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.044em 1011.46em 2.607em -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-292"><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-294" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mo" id="MathJax-Span-295" style="font-family: MathJax_Main; padding-left: 0.263em;">−</span><span class="munderover" id="MathJax-Span-296" style="padding-left: 0.159em;"><span style="display: inline-block; position: relative; width: 2.294em; height: 0px;"><span style="position: absolute; clip: rect(3.128em 1000.99em 4.43em -999.997em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-297" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.388em 1000.68em 4.169em -999.997em); top: -4.477em; left: 1.044em;"><span class="mi" id="MathJax-Span-298" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.388em 1001.2em 4.169em -999.997em); top: -3.747em; left: 1.044em;"><span class="texatom" id="MathJax-Span-299"><span class="mrow" id="MathJax-Span-300"><span class="mi" id="MathJax-Span-301" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-302" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-303" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-304" style="font-family: MathJax_Math-italic; padding-left: 0.159em;">p</span><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-306"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.52em 4.169em -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.576em;"><span class="mi" id="MathJax-Span-308" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-309" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-311" style="font-family: MathJax_Math-italic;">o</span><span class="msubsup" id="MathJax-Span-312"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.378em -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-313" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.471em;"><span class="mn" id="MathJax-Span-314" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-315" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-317"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.52em 4.169em -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.576em;"><span class="mi" id="MathJax-Span-319" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-320" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      H 
     
    
      = 
     
    
      − 
     
     
     
       ∑ 
      
      
      
        i 
       
      
        = 
       
      
        0 
       
      
     
       N 
      
     
    
      p 
     
    
      ( 
     
     
     
       x 
      
     
       i 
      
     
    
      ) 
     
    
      l 
     
    
      o 
     
     
     
       g 
      
     
       2 
      
     
    
      p 
     
    
      ( 
     
     
     
       x 
      
     
       i 
      
     
    
      ) 
     
   </span></span><script type="math/tex" id="MathJax-Element-20">H = -\sum_{i=0}^Np(x_i)log_2p(x_i)</script>,这个才是熵 <br> 其中n是分类的数目.</p> 
<p>信息熵图1</p> 
<pre class="prettyprint"><code class=" hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> log
x = [i/<span class="hljs-number">100</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,<span class="hljs-number">101</span>)]
y = [-log(i,<span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x]
plt.xlabel(<span class="hljs-string">"p(x)"</span>)
plt.ylabel(<span class="hljs-string">"l(x)"</span>)
plt.title(<span class="hljs-string">"entropy"</span>)
plt.plot(x,y)</code></pre> 
<p><img src="https://images2.imgbox.com/95/63/K5Wqe56F_o.png" alt="这里写图片描述" title=""> <br> 概率越小,信息量越大.比如明天我们这太阳从东边升起,这是概率为1的事情,所以信心量很小.</p> 
<p>熵的计算的目标是目标变量,也就是说选择不同的特征,会对应不同的目标变量,而这些不同的目标变量会对应不同的熵</p> 
<p>信息熵图2</p> 
<pre class="prettyprint"><code class=" hljs lasso"><span class="hljs-keyword">import</span> matplotlib<span class="hljs-built_in">.</span>pyplot as plt
from math <span class="hljs-keyword">import</span> <span class="hljs-keyword">log</span>
from mpl_toolkits<span class="hljs-built_in">.</span>mplot3d <span class="hljs-keyword">import</span> Axes3D

x <span class="hljs-subst">=</span> <span class="hljs-preprocessor">[</span>i/<span class="hljs-number">100</span> for i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>)<span class="hljs-preprocessor">]</span><span class="hljs-markup">
y = </span><span class="hljs-preprocessor">[</span><span class="hljs-number">1</span><span class="hljs-attribute">-i</span> for i <span class="hljs-keyword">in</span> x<span class="hljs-preprocessor">]</span><span class="hljs-markup">
z = </span><span class="hljs-preprocessor">[</span><span class="hljs-attribute">-i</span><span class="hljs-subst">*</span><span class="hljs-keyword">log</span>(i,<span class="hljs-number">2</span>)<span class="hljs-subst">-</span>(<span class="hljs-number">1</span><span class="hljs-attribute">-i</span>)<span class="hljs-subst">*</span><span class="hljs-keyword">log</span>((<span class="hljs-number">1</span><span class="hljs-attribute">-i</span>),<span class="hljs-number">2</span>) for i <span class="hljs-keyword">in</span> x<span class="hljs-preprocessor">]</span><span class="hljs-markup">

fig = plt.figure()
ax = Axes3D(fig)
ax.scatter(x, y, z)</span></code></pre> 
<p><img src="https://images2.imgbox.com/c6/12/Crb4qdF4_o.png" alt="这里写图片描述" title=""> <br> 由上图可以看出在目标变量为2个种类时,当二者的出现概率都为0.5时</p> 
<pre class="prettyprint"><code class=" hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calcShannonEnt</span><span class="hljs-params">(dataSet)</span>:</span>
    numEntries = len(dataSet)  <span class="hljs-comment"># 计算数据集的长度</span>
    labelCounts = {}
    <span class="hljs-keyword">for</span> featVec <span class="hljs-keyword">in</span> dataSet: <span class="hljs-comment"># 计算每个目标变量的出现的次数</span>
        currentLabel = featVec[-<span class="hljs-number">1</span>]  <span class="hljs-comment"># 获得该样本的目标变量</span>
        <span class="hljs-keyword">if</span> currentLabel <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> labelCounts.keys(): labelCounts[currentLabel] = <span class="hljs-number">0</span>  <span class="hljs-comment"># 计算目标变量出现的次数</span>
        labelCounts[currentLabel] += <span class="hljs-number">1</span>
    shannonEnt = <span class="hljs-number">0.0</span>
    <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> labelCounts:  <span class="hljs-comment"># 计算信息熵</span>
        prob = float(labelCounts[key])/numEntries
        shannonEnt -= prob * log(prob,<span class="hljs-number">2</span>) <span class="hljs-comment">#log base 2</span>
    <span class="hljs-keyword">return</span> shannonEnt</code></pre> 
<p>熵越高,则混合的数据也越多.</p> 
<p><strong>按照给定特征划分数据集</strong> </p> 
<pre class="prettyprint"><code class=" hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">splitDataSet</span><span class="hljs-params">(dataSet, axis, value)</span>:</span>
    <span class="hljs-string">"""
    分割数据集,去掉指定的axis
    :param dataSet: (list)数据集
    :param axis: (int)要去掉的列
    :param value: (int)在axis列符合条件的值
    :return: 切割之后的数据集
    """</span>
    retDataSet = []  <span class="hljs-comment"># 创建新的列表,是为了不破坏原有的列表,因为list类型是引用类型</span>
    <span class="hljs-keyword">for</span> featVec <span class="hljs-keyword">in</span> dataSet:
        <span class="hljs-keyword">if</span> featVec[axis] == value:
            reducedFeatVec = featVec[:axis]     <span class="hljs-comment">#截取该行之前的</span>
            reducedFeatVec.extend(featVec[axis+<span class="hljs-number">1</span>:])  <span class="hljs-comment"># 添加该行之后的</span>
            retDataSet.append(reducedFeatVec)
    <span class="hljs-keyword">return</span> retDataSet</code></pre> 
<p><strong>计算信息增益最大的的特征</strong></p> 
<pre class="prettyprint"><code class=" hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">chooseBestFeatureToSplit</span><span class="hljs-params">(dataSet)</span>:</span>
    numFeatures = len(dataSet[<span class="hljs-number">0</span>]) - <span class="hljs-number">1</span>  <span class="hljs-comment"># 计算特征的个数,最后一列是类别标签</span>
    baseEntropy = calcShannonEnt(dataSet)  <span class="hljs-comment"># 计算熵的期望,这里使用的目标变量</span>
    bestInfoGain = <span class="hljs-number">0.0</span>; bestFeature = -<span class="hljs-number">1</span>  <span class="hljs-comment"># 初始化最优信息增益,初始化最优特征</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(numFeatures):  <span class="hljs-comment"># 迭代特征</span>
        featList = [example[i] <span class="hljs-keyword">for</span> example <span class="hljs-keyword">in</span> dataSet]  <span class="hljs-comment"># 创建所有样本的第i个特征的列表</span>
        uniqueVals = set(featList)  <span class="hljs-comment"># 去重</span>
        newEntropy = <span class="hljs-number">0.0</span>  <span class="hljs-comment"># 初始化熵</span>
        <span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> uniqueVals:
            subDataSet = splitDataSet(dataSet, i, value)  <span class="hljs-comment"># 获取分割之后的数据集</span>
            prob = len(subDataSet)/float(len(dataSet))  <span class="hljs-comment"># 获取该特征值的概率</span>
            newEntropy += prob * calcShannonEnt(subDataSet)  <span class="hljs-comment"># 计算该值的信息熵</span>
        infoGain = baseEntropy - newEntropy <span class="hljs-comment"># 计算信息增益</span>
        <span class="hljs-keyword">if</span> (infoGain &gt; bestInfoGain):       <span class="hljs-comment"># 如果信息增益大于最优增益</span>
            bestInfoGain = infoGain         <span class="hljs-comment"># 更新</span>
            bestFeature = i
    <span class="hljs-keyword">return</span> bestFeature                      <span class="hljs-comment"># 返回信息增益最大的特征</span></code></pre> 
<p><strong>创建树</strong></p> 
<pre class="prettyprint"><code class=" hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">majorityCnt</span><span class="hljs-params">(classList)</span>:</span>
    classCount={}
    <span class="hljs-keyword">for</span> vote <span class="hljs-keyword">in</span> classList:
        <span class="hljs-keyword">if</span> vote <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> classCount.keys(): classCount[vote] = <span class="hljs-number">0</span>
        classCount[vote] += <span class="hljs-number">1</span>
    sortedClassCount = sorted(classCount.iteritems(), key=operator.itemgetter(<span class="hljs-number">1</span>), reverse=<span class="hljs-keyword">True</span>)
    <span class="hljs-keyword">return</span> sortedClassCount[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">createTree</span><span class="hljs-params">(dataSet,labels)</span>:</span>
    <span class="hljs-string">"""
    递归创建树
    :param dataSet: (list)嵌套列表,数据集
    :param labels: (list)标签列表
    :return: (dict)返回嵌套字典
    """</span>
    classList = [example[-<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> example <span class="hljs-keyword">in</span> dataSet]
    <span class="hljs-keyword">if</span> classList.count(classList[<span class="hljs-number">0</span>]) == len(classList): 
        <span class="hljs-keyword">return</span> classList[<span class="hljs-number">0</span>]  <span class="hljs-comment"># 当所有特征都相同的时候,停止</span>
    <span class="hljs-keyword">if</span> len(dataSet[<span class="hljs-number">0</span>]) == <span class="hljs-number">1</span>:  <span class="hljs-comment"># 当遍历完所有特征之后停止</span>
        <span class="hljs-keyword">return</span> majorityCnt(classList)  <span class="hljs-comment"># 遍历特征之后如果特征值还不唯一,则通过计数的方法确定哪个是最终特征</span>
    bestFeat = chooseBestFeatureToSplit(dataSet)  <span class="hljs-comment"># 获取最优特征</span>
    bestFeatLabel = labels[bestFeat]  <span class="hljs-comment"># 获取特征对应的标签</span>
    myTree = {bestFeatLabel:{}}  <span class="hljs-comment"># </span>
    <span class="hljs-keyword">del</span>(labels[bestFeat])  <span class="hljs-comment"># 删除已经使用的标签</span>
    featValues = [example[bestFeat] <span class="hljs-keyword">for</span> example <span class="hljs-keyword">in</span> dataSet]  <span class="hljs-comment"># 获取样本最优特征,组成列表</span>
    uniqueVals = set(featValues)  <span class="hljs-comment"># 去重</span>
    <span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> uniqueVals:
        subLabels = labels[:]  <span class="hljs-comment"># 复制所有剩余的labels</span>
        myTree[bestFeatLabel][value] = createTree(splitDataSet(dataSet, bestFeat, value),subLabels)
    <span class="hljs-keyword">return</span> myTree</code></pre> 
<p>叶节点(leaf node) <br> 判断节点(decision node)</p> 
<p><strong>决策树分类器</strong> <br> 就是查询嵌套词典</p> 
<pre class="prettyprint"><code class=" hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">classify</span><span class="hljs-params">(inputTree,featLabels,testVec)</span>:</span>
    <span class="hljs-string">"""
    决策树模型分类器
    :param inputTree: (dict)一个嵌套字典,树模型
    :param featLabels: (list)特征标签
    :param testVec: (list)测试向量
    :return:
    """</span>
    firstStr = inputTree.keys()[<span class="hljs-number">0</span>]  <span class="hljs-comment"># 获得第一个节点key</span>
    secondDict = inputTree[firstStr]  <span class="hljs-comment">#</span>
    featIndex = featLabels.index(firstStr)
    key = testVec[featIndex]
    valueOfFeat = secondDict[key]
    <span class="hljs-keyword">if</span> isinstance(valueOfFeat, dict): <span class="hljs-comment"># 如果是字典就继续递归,如果不是则返回</span>
        classLabel = classify(valueOfFeat, featLabels, testVec)
    <span class="hljs-keyword">else</span>: classLabel = valueOfFeat
    <span class="hljs-keyword">return</span> classLabel</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b1e129ae9daa87307d75023128e45233/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">清流鼎点发布超低延时技术，50ms超低延时赋能多行业强交互场景丨Xtecher 前线</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/17325a256ce1bcaabd086cfa832533b4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL 中的重做日志，回滚日志以及二进制日志的简单总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>