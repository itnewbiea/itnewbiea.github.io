<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>react 简介 路由及生命周期 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="react 简介 路由及生命周期" />
<meta property="og:description" content="全局下载react 脚手架
npm install -g create-react-app 创建项目
create-react-app my-app // my-app 为自己的demo名称 更新npm(报错)
npm cache clean --force //清缓存 npm install npm -g // 重新下载npm npm install -g create-react-app //全局下载react 脚手架 create-react-app my-app //创建项目 注意 (vue尽量 npm react尽量 yarn)
react 路由
class home extends React.Component { constructor(props) { super(props); this.state={ } // this.handleClick = this.handleClick.bind(this); } // 路由跳转 nav(child) { console.log(child); this.props.history.push({ pathname: &#34;/css&#34;, query: child }); //https://blog.csdn.net/qq8241994/article/details/85074581 路由传参地址介绍 // this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/17589890cae1230c72b4ee633aa6a650/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-13T15:30:08+08:00" />
<meta property="article:modified_time" content="2020-08-13T15:30:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">react 简介 路由及生命周期</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>全局下载react 脚手架</p> 
<pre><code class="prism language-javascript">npm install <span class="token operator">-</span>g create<span class="token operator">-</span>react<span class="token operator">-</span>app
</code></pre> 
<p>创建项目</p> 
<pre><code class="prism language-javascript">create<span class="token operator">-</span>react<span class="token operator">-</span>app my<span class="token operator">-</span>app   <span class="token comment">// my-app 为自己的demo名称</span>
</code></pre> 
<p>更新npm(报错)</p> 
<pre><code class="prism language-javascript">npm cache clean <span class="token operator">--</span>force  <span class="token comment">//清缓存</span>
npm install npm  <span class="token operator">-</span>g  <span class="token comment">// 重新下载npm </span>
npm install <span class="token operator">-</span>g create<span class="token operator">-</span>react<span class="token operator">-</span>app <span class="token comment">//全局下载react 脚手架</span>
create<span class="token operator">-</span>react<span class="token operator">-</span>app my<span class="token operator">-</span>app  <span class="token comment">//创建项目 </span>
</code></pre> 
<p>注意 (vue尽量 npm react尽量 yarn)</p> 
<p>react 路由</p> 
<pre><code class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">home</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span>
    <span class="token comment">// this.handleClick = this.handleClick.bind(this);</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 路由跳转</span>
  <span class="token function">nav</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> pathname<span class="token punctuation">:</span> <span class="token string">"/css"</span><span class="token punctuation">,</span> query<span class="token punctuation">:</span> child <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//https://blog.csdn.net/qq8241994/article/details/85074581 路由传参地址介绍</span>
    <span class="token comment">// this.props.history.push({ pathname: "/Detail", state: child });</span>
  <span class="token punctuation">}</span>
<span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">{<!-- --></span><span class="token comment">/* vue div包裹起来 */</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
          <span class="token punctuation">{<!-- --></span><span class="token comment">/* a标签跳转 */</span><span class="token punctuation">}</span>
          <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">'/way/3'</span><span class="token operator">&gt;</span>a标签路由跳转<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
          <span class="token punctuation">{<!-- --></span><span class="token comment">/* 事件跳转 */</span><span class="token punctuation">}</span>
           <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'way/4'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>通过函数跳转<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> pathname<span class="token punctuation">:</span> <span class="token string">"/way/5"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>link路由<span class="token operator">/</span><span class="token number">5</span><span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
       
          <span class="token punctuation">{<!-- --></span><span class="token comment">/* 点击跳转 */</span><span class="token punctuation">}</span>
          <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>nav<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>事件路由跳转<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
          <span class="token punctuation">{<!-- --></span><span class="token comment">/* link 跳转 */</span><span class="token punctuation">}</span>
          <span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> pathname<span class="token punctuation">:</span> <span class="token string">"/css"</span><span class="token punctuation">,</span> query<span class="token punctuation">:</span> <span class="token string">"参数2"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>link路由query<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> pathname<span class="token punctuation">:</span> <span class="token string">"/opacity"</span><span class="token punctuation">,</span> query<span class="token punctuation">:</span> <span class="token string">"参数2"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>opacity动画<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
         
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
         <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>react 生命周期函数</p> 
<ol><li>挂载卸载过程</li></ol> 
<pre><code class="prism language-javascript"><span class="token number">1.1</span><span class="token punctuation">.</span><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 函数初始化 vue data 函数 super(),</span>
<span class="token number">1.2</span><span class="token punctuation">.</span><span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 未挂载 但是还未渲染DOM时 beforecreate</span>
<span class="token number">1.3</span><span class="token punctuation">.</span><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 挂载 mount 此时dom节点已经生成，可以在这里调用ajax请求</span>
<span class="token number">1.4</span><span class="token punctuation">.</span><span class="token function">componentWillUnmount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//卸载和数据的销毁。</span>

</code></pre> 
<ol start="2"><li>更新过程</li></ol> 
<pre><code class="prism language-javascript"><span class="token number">2.1</span><span class="token punctuation">.</span> <span class="token function">componentWillReceiveProps</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span>
<span class="token number">2.2</span><span class="token punctuation">.</span><span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span>nextState<span class="token punctuation">)</span>
<span class="token number">2.3</span><span class="token punctuation">.</span><span class="token function">componentWillUpdate</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span>nextState<span class="token punctuation">)</span>
<span class="token number">2.4</span><span class="token punctuation">.</span><span class="token function">componentDidUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span>prevState<span class="token punctuation">)</span>
<span class="token number">2.5</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="3"><li>React新增的生命周期(个人补充)</li></ol> 
<pre><code class="prism language-javascript"><span class="token number">3.1</span><span class="token punctuation">.</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span>
<span class="token number">3.2</span><span class="token punctuation">.</span> <span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span>
</code></pre> 
<p>这周开始学习React的生命周期。</p> 
<p>React的生命周期从广义上分为三个阶段：挂载、渲染、卸载</p> 
<p>因此可以把React的生命周期分为两类：挂载卸载过程和更新过程。<br> React的生命周期图:<br> React生命周期图</p> 
<blockquote> 
 <ol><li>挂载卸载过程<br> 1.1.constructor() constructor()中完成了React数据的初始化，它接受两个参数：props和context，当想在函数内部使用这两个参数时，需使用super()传入这两个参数。<br> 注意：只要使用了constructor()就必须写super(),否则会导致this指向错误。</li></ol> 
 <p>1.2.componentWillMount() componentWillMount()一般用的比较少，它更多的是在服务端渲染时使用。它代表的过程是组件已经经历了constructor()初始化数据后，但是还未渲染DOM时。</p> 
 <p>1.3.componentDidMount() 组件第一次渲染完成，此时dom节点已经生成，可以在这里调用ajax请求，返回数据setState后组件会重新渲染</p> 
 <p>1.4.componentWillUnmount () 在此处完成组件的卸载和数据的销毁。</p> 
 <p>clear你在组建中所有的setTimeout,setInterval 移除所有组建中的监听 removeEventListener<br> 有时候我们会碰到这个warning: Can only update a mounted or mounting component.<br> This usually means you called setState() on an unmounted<br> component. This is a no-op. Please check the code for the undefined<br> component. 原因：因为你在组件中的ajax请求返回setState,而你组件销毁的时候，请求还未完成，因此会报warning<br> 解决方法：</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>isMount <span class="token operator">===</span> <span class="token boolean">true</span>
    axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>isMount <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>   <span class="token comment">// 增加条件ismount为true时</span>
      aaa<span class="token punctuation">:</span>res
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>isMount <span class="token operator">===</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre> 
<ol start="2"><li>更新过程</li></ol> 
<blockquote> 
 <p>2.1. componentWillReceiveProps (nextProps) 在接受父组件改变后的props需要重新渲染组件时用到的比较多 接受一个参数nextProps<br> 通过对比nextProps和this.props，将nextProps的state为当前组件的state，从而重新渲染组件</p> 
</blockquote> 
<pre><code class="prism language-javascript">  <span class="token function">componentWillReceiveProps</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    nextProps<span class="token punctuation">.</span>openNotice <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>openNotice<span class="token operator">&amp;&amp;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        openNotice<span class="token punctuation">:</span>nextProps<span class="token punctuation">.</span>openNotice
    <span class="token punctuation">}</span><span class="token function">，</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>openNotice<span class="token punctuation">:</span>nextProps<span class="token punctuation">)</span>
      <span class="token comment">//将state更新为nextProps,在setState的第二个参数（回调）可以打         印出新的state</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>2.2.shouldComponentUpdate(nextProps,nextState) 主要用于性能优化(部分更新) 唯一用于控制组件重新渲染的生命周期，由于在react中，setState以后，state发生变化，组件会进入重新渲染的流程，在这里return<br> false可以阻止组件的更新<br> 因为react父组件的重新渲染会导致其所有子组件的重新渲染，这个时候其实我们是不需要所有子组件都跟着重新渲染的，因此需要在子组件的该生命周期中做判断</p> 
 <p>2.3.componentWillUpdate (nextProps,nextState) shouldComponentUpdate返回true以后，组件进入重新渲染的流程，进入componentWillUpdate,这里同样可以拿到nextProps和nextState。</p> 
 <p>2.4.componentDidUpdate(prevProps,prevState) 组件更新完毕后，react只会在第一次初始化成功会进入componentDidmount,之后每次重新渲染后都会进入这个生命周期，这里可以拿到prevProps和prevState，即更新前的props和state。</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token number">2.5</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
render函数会插入jsx生成的dom结构，react会生成一份虚拟dom树，在每一次组件更新时，在此react会通过其diff算法比较更新前后的新旧<span class="token constant">DOM</span>树，比较以后，找到最小的有差异的<span class="token constant">DOM</span>节点，并重新渲染。
</code></pre> 
<ol start="3"><li>React新增的生命周期(个人补充)<br> React新增生命周期<br> 3</li></ol> 
<blockquote> 
 <p>.1. getDerivedStateFromProps(nextProps, prevState)<br> 代替componentWillReceiveProps()。<br> 老版本中的componentWillReceiveProps()方法判断前后两个 props 是否相同，如果不同再将新的 props<br> 更新到相应的 state 上去。这样做一来会破坏 state 数据的单一数据源，导致组件状态变得不可预测，另一方面也会增加组件的重绘次数。</p> 
</blockquote> 
<p>举个例子:</p> 
<pre><code class="prism language-javascript"><span class="token comment">// before</span>
<span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>isLogin <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> 
      isLogin<span class="token punctuation">:</span> nextProps<span class="token punctuation">.</span>isLogin<span class="token punctuation">,</span>   
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-javascript"><span class="token comment">// after</span>
<span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>isLogin <span class="token operator">!==</span> prevState<span class="token punctuation">.</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      isLogin<span class="token punctuation">:</span> nextProps<span class="token punctuation">.</span>isLogin<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-javascript"><span class="token function">componentDidUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>prevState<span class="token punctuation">.</span>isLogin <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>这两者最大的不同就是: 在 componentWillReceiveProps 中，我们一般会做以下两件事，一是根据 props 来更新<br> state，二是触发一些回调，如动画或页面跳转等。</p> 
 <p>在老版本的 React 中，这两件事我们都需要在 componentWillReceiveProps 中去做。 而在新版本中，官方将更新<br> state 与触发回调重新分配到了 getDerivedStateFromProps 与 componentDidUpdate<br> 中，使得组件整体的更新逻辑更为清晰。而且在 getDerivedStateFromProps 中还禁止了组件去访问<br> this.props，强制让开发者去比较 nextProps 与 prevState 中的值，以确保当开发者用到<br> getDerivedStateFromProps 这个生命周期函数时，就是在根据当前的 props 来更新组件的<br> state，而不是去做其他一些让组件自身状态变得更加不可预测的事情。</p> 
 <p>3.2. getSnapshotBeforeUpdate(prevProps, prevState) 代替componentWillUpdate。 常见的 componentWillUpdate 的用例是在组件更新前，读取当前某个 DOM<br> 元素的状态，并在 componentDidUpdate 中进行相应的处理。</p> 
</blockquote> 
<p>这两者的区别在于：</p> 
<blockquote> 
 <p>在 React 开启异步渲染模式后，在 render 阶段读取到的 DOM 元素状态并不总是和 commit 阶段相同，这就导致在<br> componentDidUpdate 中使用 componentWillUpdate 中读取到的 DOM<br> 元素状态是不安全的，因为这时的值很有可能已经失效了。 getSnapshotBeforeUpdate 会在最终的 render<br> 之前被调用，也就是说在 getSnapshotBeforeUpdate 中读取到的 DOM 元素状态是可以保证与<br> componentDidUpdate 中一致的。 此生命周期返回的任何值都将作为参数传递给componentDidUpdate（）。</p> 
</blockquote> 
<p>转载链接：<a href="https://www.jianshu.com/p/b331d0e4b398" rel="nofollow">https://www.jianshu.com/p/b331d0e4b398</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1e4db108cd0aec5b06f9766ef1495ba9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">embed标签修饰的pdf文件下载——（embed src=“about:blank“）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/201c5b87776c0b0a3df886af0d3a84a7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">第 15 篇：接口的单元测试</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>