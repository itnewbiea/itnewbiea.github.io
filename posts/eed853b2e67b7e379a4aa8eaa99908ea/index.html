<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python之pandas索引、DataFrame数据选取及filter介绍 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python之pandas索引、DataFrame数据选取及filter介绍" />
<meta property="og:description" content="目录 1.数据筛选1.1 单条件筛选1.2 多条件筛选1.3 索引筛选1.3.1 切片操作1.3.2 loc函数1.3.3 iloc函数1.3.4 ix函数1.3.5 at函数1.3.6 iat函数 2.filter 1.数据筛选 a b c 0 0 2 4 1 6 8 10 2 12 14 16 3 18 20 22 4 24 26 28 5 30 32 34 6 36 38 40 1.1 单条件筛选 df[df[&#39;a&#39;]&gt;30] # 筛选a列的取值大于30的记录,但只显示满足条件的b，c列的值 df[[&#39;b&#39;,&#39;c&#39;]][df[&#39;a&#39;]&gt;30] # 使用isin函数根据特定值筛选记录。筛选a值等于30或者54的记录 df[df.a.isin([30, 54])] # 选择时间小于10秒的行 time_series = time_series[time_series.index &lt; timedelta(seconds=10)] c2 = c1[c1.values == class_num] #过滤掉为 0 的行 data = df[df[self." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/eed853b2e67b7e379a4aa8eaa99908ea/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-25T09:19:21+08:00" />
<meta property="article:modified_time" content="2022-08-25T09:19:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python之pandas索引、DataFrame数据选取及filter介绍</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#1_2" rel="nofollow">1.数据筛选</a></li><li><ul><li><a href="#11__14" rel="nofollow">1.1 单条件筛选</a></li><li><a href="#12__34" rel="nofollow">1.2 多条件筛选</a></li><li><a href="#13__43" rel="nofollow">1.3 索引筛选</a></li><li><ul><li><a href="#131__44" rel="nofollow">1.3.1 切片操作</a></li><li><a href="#132_loc_53" rel="nofollow">1.3.2 loc函数</a></li><li><a href="#133_iloc_121" rel="nofollow">1.3.3 iloc函数</a></li><li><a href="#134_ix_158" rel="nofollow">1.3.4 ix函数</a></li><li><a href="#135_at_183" rel="nofollow">1.3.5 at函数</a></li><li><a href="#136_iat_190" rel="nofollow">1.3.6 iat函数</a></li></ul> 
  </li></ul> 
  </li><li><a href="#2filter_197" rel="nofollow">2.filter</a></li></ul> 
</div> 
<p></p> 
<h2><a id="1_2"></a>1.数据筛选</h2> 
<pre><code class="prism language-python">    a   b   c
<span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">4</span>
<span class="token number">1</span>   <span class="token number">6</span>   <span class="token number">8</span>  <span class="token number">10</span>
<span class="token number">2</span>  <span class="token number">12</span>  <span class="token number">14</span>  <span class="token number">16</span>
<span class="token number">3</span>  <span class="token number">18</span>  <span class="token number">20</span>  <span class="token number">22</span>
<span class="token number">4</span>  <span class="token number">24</span>  <span class="token number">26</span>  <span class="token number">28</span>
<span class="token number">5</span>  <span class="token number">30</span>  <span class="token number">32</span>  <span class="token number">34</span>
<span class="token number">6</span>  <span class="token number">36</span>  <span class="token number">38</span>  <span class="token number">40</span>
</code></pre> 
<h3><a id="11__14"></a>1.1 单条件筛选</h3> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">30</span><span class="token punctuation">]</span>
<span class="token comment"># 筛选a列的取值大于30的记录,但只显示满足条件的b，c列的值</span>
df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">30</span><span class="token punctuation">]</span>
<span class="token comment"># 使用isin函数根据特定值筛选记录。筛选a值等于30或者54的记录</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>a<span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># 选择时间小于10秒的行</span>
time_series <span class="token operator">=</span> time_series<span class="token punctuation">[</span>time_series<span class="token punctuation">.</span>index <span class="token operator">&lt;</span> timedelta<span class="token punctuation">(</span>seconds<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
c2 <span class="token operator">=</span> c1<span class="token punctuation">[</span>c1<span class="token punctuation">.</span>values <span class="token operator">==</span> class_num<span class="token punctuation">]</span>

<span class="token comment">#过滤掉为 0 的行</span>
data <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span>self<span class="token punctuation">.</span>time_col<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'0'</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">"Supplier Name"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'Z'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'Cost'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'$'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">600</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#行中的值匹配某个模式</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'Invoice Number'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"001-"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="12__34"></a>1.2 多条件筛选</h3> 
<p>可以使用&amp;（并）与| （或）操作符或者特定的函数实现多条件筛选</p> 
<pre><code class="prism language-python"><span class="token comment"># 使用&amp;筛选a列的取值大于30，b列的取值大于40的记录</span>
df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># 多条件筛选 + 索引重置</span>
data <span class="token operator">=</span> meso_data<span class="token punctuation">[</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>meso_data<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> start_date<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>meso_data<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> end_date<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="13__43"></a>1.3 索引筛选</h3> 
<h4><a id="131__44"></a>1.3.1 切片操作</h4> 
<p>df[行索引，列索引]或df[[列名1，列名2]]</p> 
<pre><code class="prism language-python"><span class="token comment"># 使用切片操作选择特定的行</span>
df<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token comment">#传入列名选择特定的列</span>
df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<h4><a id="132_loc_53"></a>1.3.2 loc函数</h4> 
<p>当每列已有column name时，用 df [ ‘a’ ] 就能选取出一整列数据。如果你知道column names 和 index，且两者都很好输入，可以选择 .loc同时进行行列选择。</p> 
<pre><code class="prism language-python">In <span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">4</span>

In <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    a   c
<span class="token number">1</span>   <span class="token number">6</span>  <span class="token number">10</span>
<span class="token number">2</span>  <span class="token number">12</span>  <span class="token number">16</span>
<span class="token number">3</span>  <span class="token number">18</span>  <span class="token number">22</span>
<span class="token number">4</span>  <span class="token number">24</span>  <span class="token number">28</span>

In <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    a   c
<span class="token number">1</span>   <span class="token number">6</span>  <span class="token number">10</span>
<span class="token number">3</span>  <span class="token number">18</span>  <span class="token number">22</span>
<span class="token number">5</span>  <span class="token number">30</span>  <span class="token number">34</span>

df <span class="token operator">=</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'行业编码'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'单位编码'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">102</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
use_df <span class="token operator">=</span> tenmin<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>tenmin<span class="token punctuation">[</span><span class="token string">'状态'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>tenmin<span class="token punctuation">[</span><span class="token string">'模式'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>tenmin<span class="token punctuation">[</span><span class="token string">'完整率'</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># 根据某两列条件选择数据，然后索引重置</span>
Data<span class="token operator">=</span> Data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>Data<span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>Data<span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span>ws_name<span class="token punctuation">]</span> <span class="token operator">&gt;</span> CutOutWS<span class="token punctuation">,</span> power_name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>

ws_ym_ak<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>ws_ym_ak<span class="token punctuation">.</span>year <span class="token operator">==</span> date<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>ws_ym_ak<span class="token punctuation">.</span>month <span class="token operator">==</span> date<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">112</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">7.2683892675086845</span>

ws_ym_ak<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>ws_ym_ak<span class="token punctuation">.</span>year <span class="token operator">==</span> date<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>ws_ym_ak<span class="token punctuation">.</span>month <span class="token operator">==</span> date<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'K'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">113</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">3.97522610048051</span>

<span class="token comment">#按时间过滤行，同时选择['time', 'filled_ws']两列</span>
construct_ws <span class="token operator">=</span> target<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>target<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> start<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>target<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> end<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">,</span> <span class="token string">'filled_ws'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token comment">#取一个值，行满足year=date[0],month=date[1]时，第'A'列对应的值。</span>
ws<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>ws<span class="token punctuation">.</span>year <span class="token operator">==</span> date<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>ws<span class="token punctuation">.</span>month <span class="token operator">==</span> date<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> 

ws<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>ws<span class="token punctuation">.</span>year <span class="token operator">==</span> date<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>ws<span class="token punctuation">.</span>month <span class="token operator">==</span> date<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values <span class="token comment">#是一个&lt;class 'numpy.ndarray'&gt;</span>
ws<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>ws<span class="token punctuation">.</span>year <span class="token operator">==</span> date<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>ws<span class="token punctuation">.</span>month <span class="token operator">==</span> date<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">]</span> <span class="token comment">#是一个&lt;class 'pandas.core.series.Series'&gt;</span>

temp <span class="token operator">=</span> <span class="token punctuation">(</span>Data<span class="token punctuation">[</span><span class="token string">'wtb_std'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> firm_wd_std<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>Data<span class="token punctuation">[</span><span class="token string">'wrf_std'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> firm_wd_std<span class="token punctuation">)</span>  <span class="token comment"># bool型结果</span>
Merged_Data <span class="token operator">=</span> Data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>temp<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>  <span class="token comment"># 根据上面的bool结果，筛选数据</span>

data <span class="token operator">=</span> data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'std'</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>

<span class="token comment">#过滤之后再求mean均值</span>
test <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>repr_year<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>repr_year<span class="token punctuation">[</span><span class="token string">'信息时间'</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> turbine_info<span class="token punctuation">[</span><span class="token string">'ays_start'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> 
<span class="token punctuation">(</span>repr_year<span class="token punctuation">[</span><span class="token string">'信息时间'</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>turbine_info<span class="token punctuation">[</span><span class="token string">'ays_end'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'ws_mean'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">)</span>
test <span class="token operator">=</span> repr_year<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>repr_year<span class="token punctuation">[</span><span class="token string">'信息时间'</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> turbine_info<span class="token punctuation">[</span><span class="token string">'ays_start'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> 
<span class="token punctuation">(</span>repr_year<span class="token punctuation">[</span><span class="token string">'信息时间'</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>turbine_info<span class="token punctuation">[</span><span class="token string">'ays_end'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'ws_mean'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

x_1 <span class="token operator">=</span> sales_train_validation<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>sales_train_validation<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">==</span> ids<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>d_cols<span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"Supplier Name"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'Z'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Cost'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'$'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">600.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>

li <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2341</span><span class="token punctuation">,</span> <span class="token number">6650</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'Part Number'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span>li<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'Part Number'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span>li<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">#选取特定的列</span>
<span class="token comment">#列标题打印</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"Invoice Number"</span><span class="token punctuation">,</span> <span class="token string">"Part Number"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#选取连续的行</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="133_iloc_121"></a>1.3.3 iloc函数</h4> 
<p>如果column name太长，输入不方便，或者index是一列时间序列，更不好输入，那就可以选择 .iloc了，该方法接受列名的index,iloc 使得我们可以对column使用slice（切片）的方法对数据进行选取。这边的 i 我觉得代表index，比较好记点。</p> 
<pre><code class="prism language-python">In <span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">4</span>

In <span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    a   c
<span class="token number">1</span>   <span class="token number">6</span>  <span class="token number">10</span>
<span class="token number">2</span>  <span class="token number">12</span>  <span class="token number">16</span>
<span class="token number">3</span>  <span class="token number">18</span>  <span class="token number">22</span>

In <span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    a   c
<span class="token number">1</span>   <span class="token number">6</span>  <span class="token number">10</span>
<span class="token number">3</span>  <span class="token number">18</span>  <span class="token number">22</span>
<span class="token number">5</span>  <span class="token number">30</span>  <span class="token number">34</span>

In <span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    a   b
<span class="token number">1</span>   <span class="token number">6</span>   <span class="token number">8</span>
<span class="token number">3</span>  <span class="token number">18</span>  <span class="token number">20</span>
<span class="token number">5</span>  <span class="token number">30</span>  <span class="token number">32</span>

start <span class="token operator">=</span> temp_df<span class="token punctuation">[</span>target_col<span class="token punctuation">]</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
end <span class="token operator">=</span> temp_df<span class="token punctuation">[</span>target_col<span class="token punctuation">]</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token comment">#直接用iloc选择某行</span>
production_end <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>data<span class="token punctuation">[</span>time_col<span class="token punctuation">]</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">#列索引值,打印1，3列</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="134_ix_158"></a>1.3.4 ix函数</h4> 
<p>ix的功能更加强大，参数既可以是索引，也可以是名称，相当于，loc和iloc的合体。需要注意的是在使用的时候需要统一，在行选择时同时出现索引和名称， 同样在同行选择时同时出现索引和名称。</p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>ix<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    a   b
<span class="token number">1</span>   <span class="token number">6</span>   <span class="token number">8</span>
<span class="token number">2</span>  <span class="token number">12</span>  <span class="token number">14</span>
<span class="token number">3</span>  <span class="token number">18</span>  <span class="token number">20</span>

In <span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>ix<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    a   b
<span class="token number">1</span>   <span class="token number">6</span>   <span class="token number">8</span>
<span class="token number">3</span>  <span class="token number">18</span>  <span class="token number">20</span>
<span class="token number">5</span>  <span class="token number">30</span>  <span class="token number">32</span>

In <span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>ix<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    a   c
<span class="token number">1</span>   <span class="token number">6</span>  <span class="token number">10</span>
<span class="token number">3</span>  <span class="token number">18</span>  <span class="token number">22</span>
<span class="token number">5</span>  <span class="token number">30</span>  <span class="token number">34</span>
</code></pre> 
<h4><a id="135_at_183"></a>1.3.5 at函数</h4> 
<p>根据指定行index及列label，快速定位DataFrame的元素，选择列时仅支持列名。</p> 
<pre><code class="prism language-python">In <span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>at<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">18</span>
</code></pre> 
<h4><a id="136_iat_190"></a>1.3.6 iat函数</h4> 
<p>与at的功能相同，只使用索引参数</p> 
<pre><code class="prism language-python">In <span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>iat<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">18</span>
</code></pre> 
<h2><a id="2filter_197"></a>2.filter</h2> 
<p>python筛选列表中大于0的数据的方法：</p> 
<p>1、使用匿名函数lambda和filter函数筛选列表中大于0的数据</p> 
<pre><code class="prism language-python">Ldata <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
res1 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> Ldata<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>res1<span class="token punctuation">)</span>

输出结果如下：
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>
<span class="token comment">#挑选df中，每行全部大于0，的行</span>
df0 <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> y<span class="token punctuation">:</span> y <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># 差分后，剔除全为正之后</span>
df_1 <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> y<span class="token punctuation">:</span> y <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">4</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

</code></pre> 
<p>2、使用列表解析筛选列表中大于0的数据</p> 
<pre><code class="prism language-python">Ldata <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
res1 <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> Ldata <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>res1<span class="token punctuation">)</span>
</code></pre> 
<p>输出结果如下：</p> 
<pre><code class="prism language-python"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>
</code></pre> 
<p>参考链接：<br> [1] <a href="https://www.py.cn/faq/python/18307.html" rel="nofollow">python怎么筛选列表中大于0的数据？</a>2020.5<br> [2] <a href="https://blog.csdn.net/sinat_38682860/article/details/98208405">python之pandas数据筛选和csv操作</a> 2019.8</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b07288ef33d546c567839329638362df/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">npm install报错npm ERR Could not resolve dependency: npm ERR peer...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a630679729e10e6b77db15c04bbaf353/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue汉字转拼音-pinyin.js</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>