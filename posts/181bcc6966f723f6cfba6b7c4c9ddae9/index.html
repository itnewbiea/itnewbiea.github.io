<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Androidé¡¹ç›®æ¥å…¥React Nativeæ–¹æ¡ˆ - ITå­¦ä¹ è€…åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Androidé¡¹ç›®æ¥å…¥React Nativeæ–¹æ¡ˆ" />
<meta property="og:description" content="æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»åœ¨ç°æœ‰çš„Androidé¡¹ç›®ä¸­æ¥å…¥React Nativeçš„æ¥å…¥è¿‡ç¨‹ï¼Œåˆ†ææ¥å…¥è¿‡ç¨‹ä¸­çš„ä¸€äº›é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Œæ¥å…¥RNçš„å¹³å°ä¸ºAndroidï¼Œå¼€å‘ç¯å¢ƒä¸ºMacï¼Œå¼€å‘å·¥å…·ä¸ºAndroid Studioã€‚
ä¸€ã€ç¯å¢ƒé…ç½® 1ã€Androidé…ç½® å› ä¸ºæ˜¯ç°æœ‰çš„Androidé¡¹ç›®é›†æˆRNï¼Œæ‰€ä»¥å…³äºAndroidæ–¹é¢çš„SDKï¼ŒJDKï¼Œç¯å¢ƒå˜é‡é…ç½®ä¸åšè¿‡å¤šçš„ä»‹ç»ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ç¯å¢ƒå˜é‡çš„é…ç½®ï¼š
ç»ˆç«¯è¾“å…¥ï¼š$ open -e ~/.zshrc
export ANDROID_HOME=/Users/username/Library/Android/sdk
export PATH=$PATH:$ANDROID_HOME/tools
export PATH=$PATH:$ANDROID_HOME/tools/bin
export PATH=$PATH:$ANDROID_HOME/platform-tools
export PATH=$PATH:$ANDROID_HOME/emulator
export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_181.jdk/Contents/Home
export PATH=$JAVA_HOME/bin:$PATH:.
export CLASSPATH=$JAVA_HOME/lib/tools.jar:$JAVA_HOME/lib/dt.jar:.
ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆï¼š$ source ~/.zshrc
2ã€React Nativeé…ç½® ï¼ˆ1ï¼‰å®‰è£… Node å’Œ Watchman
æˆ‘ä»¬æ¨èä½¿ç”¨Homebrewæ¥å®‰è£… Node å’Œ Watchmanã€‚åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œä¸‹åˆ—å‘½ä»¤å®‰è£…ï¼ˆå¦‚å®‰è£…è¾ƒæ…¢å¯ä»¥å°è¯•é˜¿é‡Œäº‘çš„é•œåƒæº https://developer.aliyun.com/mirror/homebrewï¼‰ï¼š
$ brew install node
$ brew install watchman
# ä½¿ç”¨nrmå·¥å…·åˆ‡æ¢æ·˜å®æº
$ npx nrm use taobao
å¦‚æœä¹‹åéœ€è¦åˆ‡æ¢å›å®˜æ–¹æºå¯ä½¿ç”¨
$ npx nrm use npm
ï¼ˆ2ï¼‰å®‰è£…Yarn
Yarnæ˜¯ Facebook æä¾›çš„æ›¿ä»£ npm çš„å·¥å…·ï¼Œå¯ä»¥åŠ é€Ÿ node æ¨¡å—çš„ä¸‹è½½ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/181bcc6966f723f6cfba6b7c4c9ddae9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-18T15:09:31+08:00" />
<meta property="article:modified_time" content="2023-01-18T15:09:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ITå­¦ä¹ è€…åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ITå­¦ä¹ è€…åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Androidé¡¹ç›®æ¥å…¥React Nativeæ–¹æ¡ˆ</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>Â Â Â Â Â Â Â Â æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»åœ¨ç°æœ‰çš„Androidé¡¹ç›®ä¸­æ¥å…¥React Nativeçš„æ¥å…¥è¿‡ç¨‹ï¼Œåˆ†ææ¥å…¥è¿‡ç¨‹ä¸­çš„ä¸€äº›é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Œæ¥å…¥RNçš„å¹³å°ä¸ºAndroidï¼Œå¼€å‘ç¯å¢ƒä¸ºMacï¼Œå¼€å‘å·¥å…·ä¸ºAndroid Studioã€‚</p> 
<h3>ä¸€ã€ç¯å¢ƒé…ç½®</h3> 
<h4>1ã€Androidé…ç½®</h4> 
<p>Â Â Â Â Â Â Â Â å› ä¸ºæ˜¯ç°æœ‰çš„Androidé¡¹ç›®é›†æˆRNï¼Œæ‰€ä»¥å…³äºAndroidæ–¹é¢çš„SDKï¼ŒJDKï¼Œç¯å¢ƒå˜é‡é…ç½®ä¸åšè¿‡å¤šçš„ä»‹ç»ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ç¯å¢ƒå˜é‡çš„é…ç½®ï¼š</p> 
<p>ç»ˆç«¯è¾“å…¥ï¼š$ open -e ~/.zshrc</p> 
<blockquote> 
 <p>export ANDROID_HOME=/Users/username/Library/Android/sdk<br> export PATH=$PATH:$ANDROID_HOME/tools<br> export PATH=$PATH:$ANDROID_HOME/tools/bin<br> export PATH=$PATH:$ANDROID_HOME/platform-tools<br> export PATH=$PATH:$ANDROID_HOME/emulator</p> 
 <p>export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_181.jdk/Contents/Home<br> export PATH=$JAVA_HOME/bin:$PATH:.<br> export CLASSPATH=$JAVA_HOME/lib/tools.jar:$JAVA_HOME/lib/dt.jar:.</p> 
</blockquote> 
<p>ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆï¼š$ source ~/.zshrc</p> 
<h4>2ã€React Nativeé…ç½®</h4> 
<p>ï¼ˆ1ï¼‰å®‰è£… Node å’Œ Watchman</p> 
<p>Â Â Â Â Â Â Â Â æˆ‘ä»¬æ¨èä½¿ç”¨Homebrewæ¥å®‰è£… Node å’Œ Watchmanã€‚åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œä¸‹åˆ—å‘½ä»¤å®‰è£…ï¼ˆå¦‚å®‰è£…è¾ƒæ…¢å¯ä»¥å°è¯•é˜¿é‡Œäº‘çš„é•œåƒæº https://developer.aliyun.com/mirror/homebrewï¼‰ï¼š</p> 
<blockquote> 
 <p>$ brew install node<br> $ brew install watchman</p> 
 <p># ä½¿ç”¨nrmå·¥å…·åˆ‡æ¢æ·˜å®æº<br> $ npx nrm use taobao</p> 
 <p>å¦‚æœä¹‹åéœ€è¦åˆ‡æ¢å›å®˜æ–¹æºå¯ä½¿ç”¨<br> $ npx nrm use npm</p> 
</blockquote> 
<p>ï¼ˆ2ï¼‰å®‰è£…Yarn</p> 
<p>Â Â Â Â Â Â Â Â Yarnæ˜¯ Facebook æä¾›çš„æ›¿ä»£ npm çš„å·¥å…·ï¼Œå¯ä»¥åŠ é€Ÿ node æ¨¡å—çš„ä¸‹è½½ã€‚</p> 
<blockquote> 
 <p>$ npm install -g yarn</p> 
</blockquote> 
<p>Â Â Â Â Â Â Â Â å®‰è£…å®Œ yarn ä¹‹åå°±å¯ä»¥ç”¨ yarn ä»£æ›¿ npm äº†ï¼Œä¾‹å¦‚ç”¨yarnä»£æ›¿npm installå‘½ä»¤ï¼Œç”¨yarn add æŸç¬¬ä¸‰æ–¹åº“åä»£æ›¿npm install æŸç¬¬ä¸‰æ–¹åº“åã€‚</p> 
<h3>äºŒã€ç›®å½•é…ç½®</h3> 
<h4>1ã€é¡¹ç›®ç»“æ„</h4> 
<p>Â Â Â Â Â Â Â Â é¦–å…ˆéœ€äº†è§£RNé¡¹ç›®çš„ç›®å½•ç»“æ„ï¼Œä¸èƒ½åœ¨ç°åœ¨çš„Androidé¡¹ç›®ä¸­åˆ›å»ºRNç›¸å…³æ–‡ä»¶å’Œæ¨¡å—ï¼Œå¦åˆ™ä¼šå¯¼è‡´react-native linkå¤±è´¥ï¼Œå‡ºç°å„ç§å¥‡æ€ªçš„é—®é¢˜ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š</p> 
<blockquote> 
 <p>React Native CLI failed to determine Android project configuration.</p> 
</blockquote> 
<h4>2ã€é¡¹ç›®åˆå§‹åŒ–é…ç½®</h4> 
<p>Â Â Â Â Â Â Â Â é¦–å…ˆåˆ›å»ºä¸€ä¸ªç©ºç›®å½•ç”¨äºå­˜æ”¾ React Native é¡¹ç›®ï¼Œç„¶ååœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ª/androidå­ç›®å½•ï¼ŒæŠŠä½ ç°æœ‰çš„ Android é¡¹ç›®æ‹·è´åˆ°/androidå­ç›®å½•ä¸­ã€‚åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºpackage.jsonçš„ç©ºæ–‡æœ¬æ–‡ä»¶ï¼Œç„¶åå¡«å…¥ä»¥ä¸‹å†…å®¹ï¼š</p> 
<pre><code class="language-bash">{
  "name": "MyReactNativeApp",
  "version": "0.0.1",
  "private": true,
  "scripts": {
    "start": "react-native run-android"
  }
}
</code></pre> 
<p>Â Â Â Â Â Â Â Â nameå’Œversionå¯¹äºç°æœ‰çš„Androidé¡¹ç›®æ²¡æœ‰å®é™…æ„ä¹‰ï¼Œé™¤éæŠŠä»–å‘å¸ƒåˆ°ä»“åº“ä¸­ã€‚</p> 
<p>Â Â Â Â Â Â Â Â scriptsç”¨äºå®‰è£…é¡¹ç›®åˆ°æ‰‹æœºå¹¶ä¸”å¯åŠ¨æœåŠ¡ã€‚</p> 
<h4>3ã€å®‰è£…Reactå’ŒReact Nativeæ¨¡å—</h4> 
<p>Â Â Â Â Â Â Â Â æ‰“å¼€ä¸€ä¸ªç»ˆç«¯/å‘½ä»¤æç¤ºè¡Œï¼Œè¿›å…¥åˆ°é¡¹ç›®ç›®å½•ä¸­ï¼ˆå³åŒ…å«æœ‰ package.json æ–‡ä»¶çš„ç›®å½•ï¼‰ï¼Œæ³¨æ„ä¸€å®šè¦åˆ‡æ¢åˆ°è¯¥ç›®å½•ä¸­ï¼Œç„¶åè¿è¡Œä¸‹åˆ—å‘½ä»¤æ¥å®‰è£…ï¼š</p> 
<blockquote> 
 <p>$ yarn add react-native</p> 
</blockquote> 
<p>Â Â Â Â Â Â Â Â å®‰è£…å®Œæˆä¹‹åç»ˆç«¯ä¼šå‡ºç°ä¸€æ¡è­¦å‘Šï¼š</p> 
<blockquote> 
 <p>warning " &gt; react-native@0.63.3" has unmet peer dependency "react@16.13.1".</p> 
</blockquote> 
<p>Â Â Â Â Â Â Â Â è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œæ„å‘³ç€æˆ‘ä»¬è¿˜éœ€è¦å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„ Reactï¼š</p> 
<blockquote> 
 <p>$ yarn add react@16.13.1</p> 
</blockquote> 
<p>Â Â Â Â Â Â Â Â è¿™æ ·å®‰è£…å°±å®Œæˆï¼Œå®‰è£…å®Œæˆåå†æ¬¡æ‰“å¼€package.jsonï¼Œå°±ä¼šå‘ç°è¯¥æ¨¡å—å·²ç»æ·»åŠ ä¾èµ–äº†ï¼Œå¦‚ä¸‹å›¾ï¼š</p> 
<p style="text-align:center;"><img alt="" height="264" src="https://images2.imgbox.com/d4/5d/CfbuPPLq_o.png" width="446"></p> 
<h3>ä¸‰ã€Androidé¡¹ç›®é…ç½®</h3> 
<p>Â Â Â Â Â Â Â Â æŠŠæ–°å»ºçš„RNé¡¹ç›®çš„ç›®å½•ä¸­çš„Androidé¡¹ç›®ä½¿ç”¨æ‰“å¼€Android Studioæ‰“å¼€ï¼Œåœ¨ç¼–è¾‘å™¨ä¸Šé¢å®Œæˆä»¥ä¸‹æ“ä½œï¼š</p> 
<h4>1ã€gradleé…ç½®</h4> 
<p>ï¼ˆ1ï¼‰åœ¨ä½ çš„ app ä¸­ build.gradle æ–‡ä»¶ä¸­æ·»åŠ  React Native å’Œ JSC å¼•æ“ä¾èµ–:</p> 
<pre><code class="language-Groovy">dependencies {

    implementation fileTree(dir: "libs", include: ["*.jar"])
    implementation 'androidx.appcompat:appcompat:1.2.0'
    ...
    implementation "com.facebook.react:react-native:+" // From node_modules
    implementation "org.webkit:android-jsc:+"
}</code></pre> 
<p>Â Â Â Â Â Â Â Â æ³¨æ„ï¼Œä»¥ä¸Šä¸¤ä¸ªéƒ½å¿…é¡»æ·»åŠ ï¼Œç¼ºä¸€ä¸å¯ã€‚</p> 
<p>ï¼ˆ2ï¼‰åœ¨é¡¹ç›®çš„build.gradleæ–‡ä»¶ä¸­ä¸ºReact Nativeå’ŒJSC å¼•æ“æ·»åŠ maven</p> 
<pre><code class="language-Groovy">allprojects {
    repositories {
        google()
        jcenter()
        maven {
            // All of React Native (JS, Android binaries) is installed from npm
            url "$rootDir/../node_modules/react-native/android"
        }
        maven {
            // Android JSC is installed from npm
            url("$rootDir/../node_modules/jsc-android/dist")
        }
    }
}</code></pre> 
<p>Â Â Â Â Â Â Â Â è¿è¡ŒAndroid Studioçš„gradleå³ä¸Šè§’ä¸Šé¢çš„ã€Sync Nowã€‘,å¦‚ä½•èƒ½å¤Ÿæ­£å¸¸ç¼–è¯‘ï¼Œåˆ™è¯´æ˜è·¯å¾„é…ç½®æ­£å¸¸ï¼Œå¦åˆ™è·¯å¾„æœ‰è¯¯ã€‚</p> 
<h4>2ã€AndroidManifest.xmlé…ç½®</h4> 
<p>(1)manifestèŠ‚ç‚¹ä¸‹ï¼š</p> 
<pre><code class="language-XML">&lt;uses-permission android:name="android.permission.INTERNET" /&gt;
&lt;uses-permission android:name="android.permission.SYSTEM_ALERT_WINDOW" /&gt;</code></pre> 
<p>Â Â Â Â Â Â Â Â è®¾ç½®ç½‘ç»œè¯·æ±‚æƒé™å’ŒRNå±å¹•æ˜¾ç¤ºæ—¥å¿—æƒé™ã€‚</p> 
<p>(2)applicationèŠ‚ç‚¹ä¸‹ï¼š</p> 
<pre><code class="language-XML">&lt;activity android:name="com.facebook.react.devsupport.DevSettingsActivity" /&gt;</code></pre> 
<p>Â Â Â Â Â Â Â Â å¦‚æœéœ€è¦è®¿é—®å¼€å‘è€…èœå•ï¼Œåˆ™éœ€è¦å£°æ˜ï¼Œå¼€å‘è€…èœå•ä¸€èˆ¬ä»…ç”¨äºåœ¨å¼€å‘æ—¶ä»PackageræœåŠ¡å™¨åˆ·æ–°JavaScriptä»£ç ï¼Œæ‰€ä»¥åœ¨æ­£å¼å‘å¸ƒæ—¶å¯ä»¥å»æ‰è¿™ä¸€æƒé™ã€‚</p> 
<p>(3)applicationèŠ‚ç‚¹å†…ï¼š</p> 
<pre><code class="language-XML">android:networkSecurityConfig="@xml/network_security_config"

app/src/res/xml/network_security_config.xml:

&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;network-security-config&gt;
  &lt;!-- allow cleartext traffic for React Native packager ips in debug --&gt;
  &lt;domain-config cleartextTrafficPermitted="true"&gt;
    &lt;domain includeSubdomains="false"&gt;localhost&lt;/domain&gt;
    &lt;domain includeSubdomains="false"&gt;10.0.2.2&lt;/domain&gt;
    &lt;domain includeSubdomains="false"&gt;10.0.3.2&lt;/domain&gt;
  &lt;/domain-config&gt;
&lt;/network-security-config&gt;</code></pre> 
<p>Â Â Â Â Â Â Â Â é€‚é…Android9.0æ˜æ–‡httpè®¿é—®é™åˆ¶ã€‚</p> 
<h4>å››ã€ä»£ç é›†æˆ</h4> 
<h4>1ã€index.jsåˆ›å»º</h4> 
<p>Â  Â  Â  Â  index.jsæ˜¯ React Nativeåº”ç”¨åœ¨Androidä¸Šçš„å…¥å£æ–‡ä»¶ã€‚è€Œä¸”å®ƒæ˜¯ä¸å¯æˆ–ç¼ºçš„ï¼å®ƒå¯ä»¥æ˜¯ä¸ªå¾ˆç®€å•çš„æ–‡ä»¶ï¼Œç®€å•åˆ°å¯ä»¥åªåŒ…å«ä¸€è¡Œrequire/importå¯¼å…¥è¯­å¥ã€‚åœ¨RNé¡¹ç›®çš„æ ¹æ®ç›®å½•åˆ›å»ºindex.jsï¼ˆå’Œpackage.jsonï¼‰åŒçº§ç›®å½•ã€‚</p> 
<h4>2ã€æ·»åŠ æµ‹è¯•çš„React Nativeä»£ç </h4> 
<pre><code class="language-javascript">import React from 'react';
import {
  AppRegistry,
  StyleSheet,
  Text,
  View
} from 'react-native';

class HelloWorld extends React.Component {
  render() {
    return (
      &lt;View style={styles.container}&gt;
        &lt;Text style={styles.hello}&gt;Hello, World&lt;/Text&gt;
      &lt;/View&gt;
    );
  }
}
const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: 'center'
  },
  hello: {
    fontSize: 20,
    textAlign: 'center',
    margin: 10
  }
});

AppRegistry.registerComponent(
  'MyReactNativeApp',
  () =&gt; HelloWorld
);</code></pre> 
<h4>3ã€é…ç½®Activity</h4> 
<p>Â  Â  Â  Â  é…ç½®ä¸€ä¸ªåŸºç±»çš„Activityï¼Œåˆå§‹åŒ–ä¸€äº›å‚æ•°ï¼Œè®©éœ€è¦ç”¨React Nativeå¼€å‘çš„é¡µé¢ç»§æ‰¿åŸºç±»ï¼Œå‚æ•°å«ä¹‰çœ‹å¤‡æ³¨ã€‚</p> 
<pre><code class="language-javascript">
public class BaseActivity extends AppCompatActivity implements DefaultHardwareBackBtnHandler {

    private final int OVERLAY_PERMISSION_REQ_CODE = 1;  // ä»»å†™ä¸€ä¸ªå€¼
    protected ReactInstanceManager mReactInstanceManager;

    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        mReactInstanceManager = ReactInstanceManager.builder()
                .setApplication(getApplication())
                .setCurrentActivity(this)
                .setBundleAssetName("index.android.bundle")
                .setJSMainModulePath("index")
                .addPackage(new MainReactPackage())
                //æ³¨æ„BuildConfigåº”è¯¥æ˜¯åœ¨ä½ è‡ªå·±çš„åŒ…ä¸­è‡ªåŠ¨ç”Ÿæˆï¼Œæ— éœ€é¢å¤–å¼•å…¥ã€‚åƒä¸‡ä¸è¦ä»com.facebook...çš„åŒ…ä¸­å¼•å…¥ï¼
                .setUseDeveloperSupport(BuildConfig.DEBUG)
                .setInitialLifecycleState(LifecycleState.RESUMED)
                .build();
        // é…ç½®æƒé™ä»¥ä¾¿å¼€å‘ä¸­çš„çº¢å±é”™è¯¯èƒ½æ­£ç¡®æ˜¾ç¤ºï¼Œç”¨äºç¨‹åºè°ƒè¯•ä¸­
        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) {
            if (!Settings.canDrawOverlays(this)) {
                Intent intent = new Intent(Settings.ACTION_MANAGE_OVERLAY_PERMISSION,
                        Uri.parse("package:" + getPackageName()));
                startActivityForResult(intent, OVERLAY_PERMISSION_REQ_CODE);
            }
        }
    }

    //å›è°ƒæƒé™ç»“æœ
    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        if (requestCode == OVERLAY_PERMISSION_REQ_CODE) {
            if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) {
                if (!Settings.canDrawOverlays(this)) {
                    // SYSTEM_ALERT_WINDOW permission not granted
                }
            }
        }
        mReactInstanceManager.onActivityResult(this, requestCode, resultCode, data);
    }

    /**
     * æŠŠç”Ÿå‘½å‘¨æœŸå›ä¼ ç»™ React Native
     */
    @Override
    protected void onPause() {
        super.onPause();

        if (mReactInstanceManager != null) {
            mReactInstanceManager.onHostPause(this);
        }
    }

    @Override
    protected void onResume() {
        super.onResume();
        if (mReactInstanceManager != null) {
            mReactInstanceManager.onHostResume(this, this);
        }
    }

    @Override
    protected void onDestroy() {
        super.onDestroy();
        if (mReactInstanceManager != null) {
            mReactInstanceManager.onHostDestroy(this);
        }
    }

    /**
     * æŠŠåé€€æŒ‰é’®äº‹ä»¶ä¼ é€’ç»™ React Native
     */
    @Override
    public void onBackPressed() {
        if (mReactInstanceManager != null) {
            mReactInstanceManager.onBackPressed();
        } else {
            super.onBackPressed();
        }
    }

    @Override
    public boolean onKeyUp(int keyCode, KeyEvent event) {
        if (keyCode == KeyEvent.KEYCODE_MENU &amp;&amp; mReactInstanceManager != null) {
            mReactInstanceManager.showDevOptionsDialog();
            return true;
        }
        return super.onKeyUp(keyCode, event);
    }

    @Override
    public void invokeDefaultOnBackPressed() {
        super.onBackPressed();
    }
}</code></pre> 
<h4>4ã€ç¼–å†™React Nativeé¡µé¢</h4> 
<pre><code class="language-java">public class MyReactActivity extends BaseActivity {

    private ReactRootView mReactRootView;
    
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        mReactRootView = new ReactRootView(this);
        // æ³¨æ„è¿™é‡Œçš„MyReactNativeAppå¿…é¡»å¯¹åº”â€œindex.jsâ€ä¸­çš„
        // â€œAppRegistry.registerComponent()â€çš„ç¬¬ä¸€ä¸ªå‚æ•°
        mReactRootView.startReactApplication(mReactInstanceManager, "MyReactNativeApp", null);
        setContentView(mReactRootView);
    }

    @Override
    protected void onDestroy() {
        super.onDestroy();
        if (mReactRootView != null) {
            mReactRootView.unmountReactApplication();
        }
    }
}</code></pre> 
<p>Â Â Â Â Â Â Â Â åœ¨AndroidManifest.xmlæ³¨å†ŒMyReactActivityï¼š</p> 
<pre><code class="language-XML">&lt;activity
    android:name=".MyReactActivity"
    android:label="@string/app_name"
    android:theme="@style/Theme.AppCompat.Light.NoActionBar"&gt;
&lt;/activity&gt;</code></pre> 
<p>Â Â Â Â Â Â Â Â éœ€è¦æŠŠMyReactActivityçš„ä¸»é¢˜è®¾å®šä¸ºTheme.AppCompat.Light.NoActionBarï¼Œå› ä¸ºé‡Œé¢æœ‰è®¸å¤šç»„ä»¶éƒ½ä½¿ç”¨äº†è¿™ä¸€ä¸»é¢˜ã€‚</p> 
<h4>5ã€åœ¨MainActivityå¯åŠ¨è¯¥RNé¡µé¢</h4> 
<pre><code class="language-java">
public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        findViewById(R.id.btn).setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                MainActivity.this.startActivity(new Intent(MainActivity.this, MyReactActivity.class));
            }
        });
    }
}
</code></pre> 
<p>Â Â Â Â Â Â Â Â ä»£ç å°±é›†æˆå®Œæ¯•ï¼Œç»“æ„å›¾å¦‚ä¸‹ï¼š</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/fe/19/18jNJHwp_o.png"></p> 
<h3>äº”ã€é¡¹ç›®è¿è¡ŒÂ </h3> 
<h4>1ã€å‘½ä»¤è¡Œè¿è¡Œ</h4> 
<p>Â Â Â Â Â Â Â Â ä½¿ç”¨USBè¿æ¥ç”µè„‘ï¼Œé€šè¿‡adb deviceså‘½ä»¤æŸ¥çœ‹è®¾å¤‡å¦‚æœæœ‰è®¾å¤‡åˆ—è¡¨ï¼Œåˆ™å·²ç»è¿æ¥åˆ°è®¾å¤‡ï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œåˆ‡æ¢åˆ°é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œå‘½ä»¤ï¼š</p> 
<blockquote> 
 <p>$ yarn start</p> 
 <p>æˆ–è€…</p> 
 <p>$ react-native run-android</p> 
</blockquote> 
<h4 style="text-align:center;"><img alt="" src="https://images2.imgbox.com/90/66/9Oa2dinI_o.png"></h4> 
<p>Â Â Â Â Â Â Â Â å‡ºç°å¦‚å›¾æ‰€ç¤ºå†…å®¹ï¼ŒAndroid project not found. Are you sure this is a React Native project?ï¼Œè¿™å—çš„é—®é¢˜è¿˜æ˜¯é¡¹ç›®ç»“æ„çš„é—®é¢˜ï¼Œå¯¹æ¯”ä¸‹åˆšåˆšå¼€å§‹çš„é¡¹ç›®ç»“æ„å’Œä¸Šä¸€æ­¥å’±ä»¬è‡ªå·±é¡¹ç›®ç»“æ„ï¼šÂ </p> 
<p style="text-align:center;"><img alt="" height="242" src="https://images2.imgbox.com/0d/75/6SZFpLcC_o.png" width="409"></p> 
<p>Â Â Â Â Â Â Â Â å‘ç°ç¼ºå°‘androidç›®å½•ï¼Œè¿™å—çš„androidç›®å½•å°±ä½¿å’±ä»¬ä¸Šé¢çš„Demoç›®å½•ï¼Œä¿®æ”¹Demoä¸ºandroidç›®å½•ï¼Œé‡æ–°æ‰§è¡Œyarn startï¼Œè¿™æ—¶å€™ä¼šå‡ºç°ä¸¤ä¸ªç»ˆç«¯ç•Œé¢ï¼Œå¦‚ä¸‹ï¼š</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/91/d1/v7kVyuWD_o.png"></p> 
<p>Â Â Â Â Â Â Â Â Â æ ¹æ®å³è¾¹ç•Œé¢æç¤ºï¼Œç‚¹å‡»é”®ç›˜Rï¼Œä¼šçœ‹åˆ°å±å¹•çš„RNé¡µé¢ä¼šåˆ·æ–°ï¼Œç‚¹å‡»é”®ç›˜Dä¼šå‡ºç°å¦‚ä¸‹ï¼š</p> 
<p style="text-align:center;"><img alt="" height="502" src="https://images2.imgbox.com/93/53/vEL0sBYj_o.jpg" width="232"></p> 
<p>Â Â Â Â Â Â Â Â Â ç‚¹å‡»Reloadä¹Ÿä¼šé‡æ–°åŠ è½½ï¼Œæ•ˆæœç±»ä¼¼ä¸ç»ˆç«¯ä¸Šè¾“å…¥Rä¸€æ ·ã€‚å¦‚æœå‡ºç°ä»¥ä¸‹çŠ¶æ€ï¼Œåˆ™æ˜¯Serveræœªè¿æ¥æˆåŠŸï¼š</p> 
<p style="text-align:center;"><img alt="" height="504" src="https://images2.imgbox.com/71/c6/Dga97G53_o.jpg" width="232"></p> 
<p>Â Â Â Â Â Â Â Â è§£å†³æ–¹æ¡ˆï¼šÂ </p> 
<p>Â  Â  ï¼ˆ1ï¼‰é€šè¿‡adb deviceså‘½ä»¤æŸ¥çœ‹è®¾å¤‡æ˜¯å¦è¿æ¥æˆåŠŸï¼Œå¦‚æœæˆåŠŸï¼›<br> Â  Â  ï¼ˆ2ï¼‰é‡æ–°æ‰§è¡Œyarn startï¼Œé‡æ–°å®‰è£…ã€‚</p> 
<h4>2ã€Android Studio + å‘½ä»¤è¡Œè¿è¡Œ</h4> 
<p>Â Â Â Â Â Â Â Â é™¤äº†ä¸Šé¢çš„è¿è¡Œæ–¹å¼å¤–ï¼Œè¿˜å¯ä»¥åœ¨Android Studioä¸Šé¢è¿è¡Œï¼Œåœ¨Android Studioä¸Šé¢Run appè¿è¡Œä¹‹åï¼Œåœ¨RNé¡¹ç›®çš„æ ¹ç›®å½•ç»ˆç«¯ä¸­è¾“å…¥ï¼š</p> 
<blockquote> 
 <p>$ react-native start</p> 
</blockquote> 
<p>Â Â Â Â Â Â Â Â å³å¯å¼€å¯æœåŠ¡ï¼Œæ“ä½œå’Œä¸Šé¢ç¬¬ä¸€ç§æ–¹å¼ç±»ä¼¼ã€‚</p> 
<h4>3ã€Android Studioä¸­è¿è¡Œ</h4> 
<p>Â Â Â Â Â Â Â Â æ‰“å¼€androidç›®å½•ä¸­çš„Androidé¡¹ç›®ï¼Œé¢æ¿æœ€åº•éƒ¨æ‰¾åˆ°Terminalæ§åˆ¶å°ï¼Œç›´æ¥è¾“å…¥ï¼š</p> 
<blockquote> 
 <p>$ yarn start</p> 
</blockquote> 
<p>Â Â Â Â Â Â Â Â æ•ˆæœå’Œç¬¬ä¸€ç§æ–¹å¼ä¸€æ ·ã€‚</p> 
<h3>å…­ã€é¡¹ç›®æ‰“åŒ…</h3> 
<p>Â Â Â Â Â Â Â Â åœ¨BaseActivityä¸­æ·»åŠ äº†.addPackage(new MainReactPackage())ï¼Œé™¤æ­¤ä¹‹å¤–ç³»ç»Ÿè¿˜æä¾›äº†äº†ä¸ª.addPackages(packages)æ–¹æ³•ï¼Œå‚æ•°ä¸ºï¼š</p> 
<pre><code class="language-java">List&lt;ReactPackage&gt; packages = new PackageList(getApplication()).getPackages();</code></pre> 
<p>Â Â Â Â Â Â Â Â ç›´æ¥ä½¿ç”¨ä¼šæ‰¾ä¸åˆ°PackageListç±»ï¼Œæ˜¯å› ä¸ºæ²¡æœ‰linkï¼Œåœ¨React Native 0.60 åŠ å…¥äº†ä¸€ä¸ªautolinkingç‰¹æ€§ï¼Œä¸éœ€è¦é¢å¤–è°ƒç”¨react-native linkå‘½ä»¤ã€‚ä¿®æ”¹androidçš„setting.gradle,bulid.gradleå°±å¯ä»¥è‡ªåŠ¨å®Œæˆlinkã€‚</p> 
<p>Â Â Â Â Â Â Â Â setting.gradleæ·»åŠ ï¼š</p> 
<pre><code class="language-Groovy">apply from: file("../node_modules/@react-native-community/cli-platform-android/native_modules.gradle")
applyNativeModulesSettingsGradle(settings)

app/build.gradleæ·»åŠ ï¼š

apply from: file("../../node_modules/@react-native-community/cli-platform-android/native_modules.gradle")
applyNativeModulesAppBuildGradle(project)
</code></pre> 
<p>Â Â Â Â Â Â Â Â è¿™æ ·é‡æ–°clearé¡¹ç›®ï¼ŒReBuild Progecté¡¹ç›®ï¼Œå°±å¯ä»¥æ­£å¸¸ç¼–è¯‘é€šè¿‡ã€‚å…³äºautolinkçš„è¯¦ç»†åŸç†ï¼Œè¯·å‚è€ƒï¼š<a class="link-info" href="https://www.jianshu.com/p/9641b3beae84" rel="nofollow" title="https://www.jianshu.com/p/9641b3beae84">https://www.jianshu.com/p/9641b3beae84</a></p> 
<p>Â Â Â Â Â Â Â Â å…¶ä»–å‚è€ƒèµ„æ–™ï¼š<a class="link-info" href="https://reactnative.cn/" rel="nofollow" title="https://reactnative.cn/">https://reactnative.cn/</a></p> 
<p></p> 
<p>Â  Â  Â  Â  è¿™äº›ä¸œè¥¿æ•´ç†äº†å¾ˆä¹…äº†ä»Šå¤©æ‰å‘ç°ï¼Œé¡ºä¾¿è®°å½•ä¸‹ã€‚ä»Šå¤©æ˜¯è…Šæœˆ27æ—¥ï¼Œæ˜å¤©å›è€å®¶äº†ï¼Œæœ€åç¥å¤§å®¶2023å¹´æ–°å¹´å¿«ä¹ï¼ï¼ï¼ğŸ˜‹ğŸ˜‹ğŸ˜‹</p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ca6c5ca9cd9deb7e49de94896a569730/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">Taroå‡çº§3.5.10ç‰ˆæœ¬åå‡ºç°swcç›¸å…³ç¼–è¯‘æŠ¥é”™ã€windowsã€‘</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/18651b6d018300b9acc29a175451ac08/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">ï¼ˆå·²è§£å†³ï¼‰jar!/BOOT-INF/classes!/application.yml (No such file or directory)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ITå­¦ä¹ è€…åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>