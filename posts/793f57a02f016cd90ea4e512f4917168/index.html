<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Mysql常用用法总结 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Mysql常用用法总结" />
<meta property="og:description" content="SQL 分为四类 1、DML（数据操作语言）操作数据库中的数据（insert、update、delete） 2、DDL（数据定义语言）创建、删除、修改数据库、数据表 3、DQL（数据查询语言）对数据库中的数据进行查询（select） 4、DCL（数据控制语言）用来提交数据库事务（commit、rollback） 目录 一、管理数据库结构
1、操作数据库SQL2、操作数据表SQL 3、SQL函数 4、SQL运算符 5、数据CRUD 二、表关系
1、表设计 2、表之间关系 三、多表关联查询
1、关联查询 2、一对多关联查询 3、多对多关联查询4、去重distinct 5、分页limit 四、数据库索引Index
1、 数据库索引2、数据库索引机制的实现 五、事务Transaction
1、 事务2、Mysql的事务隔离机制 六、视图View
七、触发器Trigger
八、存储过程Procedure
一、管理数据库结构 返回顶部目录 数据库 -》数据表 -》数据
1、操作数据库 SQL 返回顶部目录 1、创建数据库
create database 数据库名称 default character set utf8 collate utf8_general_ci; 2、删除数据库
drop database 数据库名称; 3、查看数据库
show databases; 4、选择数据库
use 数据库名称;	2、 操作数据表 SQL 返回顶部目录 1、创建数据表
create table 数据表名( 字段信息 字段名 数据类型, ); create table student( id int, name varchar(10), score int ); 2、删除数据表" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/793f57a02f016cd90ea4e512f4917168/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-11T10:54:26+08:00" />
<meta property="article:modified_time" content="2022-03-11T10:54:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Mysql常用用法总结</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <table><tbody><tr><td bgcolor="#1FF"> 
    <div>
      SQL 分为四类 1、DML（数据操作语言）操作数据库中的数据（insert、update、delete） 2、DDL（数据定义语言）创建、删除、修改数据库、数据表 3、DQL（数据查询语言）对数据库中的数据进行查询（select） 4、DCL（数据控制语言）用来提交数据库事务（commit、rollback） 
    </div> </td></tr></tbody></table> 
<h2 id="miao0" align="center"> 目录 </h2> 
<p><a href="#miao1" rel="nofollow"> 一、管理数据库结构</a></p> 
<ul><li><a href="#miao11" rel="nofollow">1、操作数据库SQL</a></li><li><a href="#miao12" rel="nofollow">2、操作数据表SQL </a></li><li><a href="#miao13" rel="nofollow">3、SQL函数 </a></li><li><a href="#miao14" rel="nofollow">4、SQL运算符 </a></li><li><a href="#miao15" rel="nofollow">5、数据CRUD </a></li></ul> 
<p><a href="#miao2" rel="nofollow"> 二、表关系</a></p> 
<ul><li><a href="#miao21" rel="nofollow">1、表设计 </a></li><li><a href="#miao22" rel="nofollow">2、表之间关系 </a></li></ul> 
<p><a href="#miao3" rel="nofollow"> 三、多表关联查询</a></p> 
<ul><li><a href="#miao31" rel="nofollow">1、关联查询 </a></li><li><a href="#miao32" rel="nofollow">2、一对多关联查询 </a></li><li><a href="#miao33" rel="nofollow">3、多对多关联查询</a></li><li><a href="#miao34" rel="nofollow">4、去重distinct </a></li><li><a href="#miao35" rel="nofollow">5、分页limit </a></li></ul> 
<p><a href="#miao4" rel="nofollow"> 四、数据库索引Index</a></p> 
<ul><li><a href="#miao41" rel="nofollow">1、 数据库索引</a></li><li><a href="#miao42" rel="nofollow">2、数据库索引机制的实现 </a></li></ul> 
<p><a href="#miao5" rel="nofollow"> 五、事务Transaction</a></p> 
<ul><li><a href="#miao51" rel="nofollow">1、 事务</a></li><li><a href="#miao52" rel="nofollow">2、Mysql的事务隔离机制 </a></li></ul> 
<p><a href="#miao6" rel="nofollow"> 六、视图View</a><br> <a href="#miao7" rel="nofollow"> 七、触发器Trigger</a><br> <a href="#miao8" rel="nofollow"> 八、存储过程Procedure</a></p> 
<hr> 
<h2 id="miao1" align="center">一、管理数据库结构</h2> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<p>数据库 -》数据表 -》数据</p> 
<h4 id="miao11" align="center">1、操作数据库 SQL</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<p>1、创建数据库</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">database</span> 数据库名称 <span class="token keyword">default</span> <span class="token keyword">character</span> <span class="token keyword">set</span> utf8 <span class="token keyword">collate</span> utf8_general_ci<span class="token punctuation">;</span>
</code></pre> 
<p>2、删除数据库</p> 
<pre><code class="prism language-sql"><span class="token keyword">drop</span> <span class="token keyword">database</span> 数据库名称<span class="token punctuation">;</span>
</code></pre> 
<p>3、查看数据库</p> 
<pre><code class="prism language-sql"><span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
</code></pre> 
<p>4、选择数据库</p> 
<pre><code class="prism language-sql"><span class="token keyword">use</span> 数据库名称<span class="token punctuation">;</span>	
</code></pre> 
<h4 id="miao12" align="center">2、 操作数据表 SQL</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<p>1、创建数据表</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> 数据表名<span class="token punctuation">(</span>
	字段信息
    字段名 数据类型<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> student<span class="token punctuation">(</span>
    id <span class="token keyword">int</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    score <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>2、删除数据表</p> 
<pre><code class="prism language-sql"><span class="token keyword">drop</span> <span class="token keyword">table</span> 数据表名<span class="token punctuation">;</span>
</code></pre> 
<p>3、查看数据表</p> 
<pre><code class="prism language-sql"><span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
</code></pre> 
<p>4、查看某张表的结构</p> 
<pre><code class="prism language-sql"><span class="token keyword">desc</span> 数据表名<span class="token punctuation">;</span>
</code></pre> 
<p>5、修改数据表</p> 
<p>新增一个字段</p> 
<pre><code class="prism language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 数据表名 <span class="token keyword">add</span> 字段名 字段数据类型<span class="token punctuation">;</span>
</code></pre> 
<p>修改一个字段</p> 
<pre><code class="prism language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 数据表名 change 旧字段名 新字段名 新字段数据类型<span class="token punctuation">;</span>
</code></pre> 
<p>删除一个字段</p> 
<pre><code class="prism language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 数据表名 <span class="token keyword">drop</span> 字段名<span class="token punctuation">;</span>
</code></pre> 
<h4 id="miao13" align="center">3、SQL 函数</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<h6><a id="31__141"></a>3.1 数学函数</h6> 
<pre><code class="prism language-sql">abs<span class="token punctuation">(</span><span class="token punctuation">)</span> 求绝对值
<span class="token keyword">select</span> abs<span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

floor<span class="token punctuation">(</span><span class="token punctuation">)</span> 返回小于参数的最大整数
<span class="token keyword">select</span> floor<span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

ceil<span class="token punctuation">(</span><span class="token punctuation">)</span> 返回大于参数的最小整数
<span class="token keyword">select</span> ceil<span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="32__154"></a>3.2 字符串函数</h6> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span><span class="token punctuation">(</span>str1<span class="token punctuation">,</span><span class="token keyword">index</span><span class="token punctuation">,</span>len<span class="token punctuation">,</span>str2<span class="token punctuation">)</span>
str1中<span class="token keyword">index</span>位置开始，长度为len的字符替换为str2<span class="token punctuation">,</span><span class="token keyword">index</span>从<span class="token number">1</span>开始
<span class="token keyword">select</span> <span class="token keyword">insert</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'java'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">ucase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
将字母值变为大写
<span class="token keyword">select</span> upper<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">ucase</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">lcase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
将字母值变为小写
<span class="token keyword">select</span> lower<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">lcase</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

<span class="token keyword">left</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span>len<span class="token punctuation">)</span>
返回str字符串的前len个字符
<span class="token keyword">select</span> <span class="token keyword">left</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

<span class="token keyword">right</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span>len<span class="token punctuation">)</span>
返回str字符串的后len个字符
<span class="token keyword">select</span> <span class="token keyword">right</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

substring<span class="token punctuation">(</span>str<span class="token punctuation">,</span><span class="token keyword">index</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span>
截取str，从<span class="token keyword">index</span>位置开始，长度为len
<span class="token keyword">select</span> substring<span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

reverse<span class="token punctuation">(</span><span class="token punctuation">)</span>
反序输出
<span class="token keyword">select</span> reverse<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="33__188"></a>3.3 日期函数</h6> 
<pre><code class="prism language-sql">curdate<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">current_date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 获取当前日期
<span class="token keyword">select</span> <span class="token keyword">current_date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> curdate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

curtime<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">current_time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 获取当前时间
<span class="token keyword">select</span> curtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token keyword">current_time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 获取当前日期<span class="token operator">+</span>时间
<span class="token keyword">select</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

datediff<span class="token punctuation">(</span>day1<span class="token punctuation">,</span>day2<span class="token punctuation">)</span> 计算day1和day2之间相隔的天数
<span class="token keyword">select</span> datediff<span class="token punctuation">(</span><span class="token string">'2022-5-1'</span><span class="token punctuation">,</span><span class="token string">'2022-3-31'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

adddate<span class="token punctuation">(</span><span class="token keyword">day</span><span class="token punctuation">,</span>num<span class="token punctuation">)</span> 计算<span class="token keyword">day</span>日期num天之后的日期
<span class="token keyword">select</span> adddate<span class="token punctuation">(</span><span class="token string">'2022-2-20'</span><span class="token punctuation">,</span><span class="token number">173</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

subdate<span class="token punctuation">(</span><span class="token keyword">day</span><span class="token punctuation">,</span>num<span class="token punctuation">)</span> 计算<span class="token keyword">day</span>日期num天之前的日期
<span class="token keyword">select</span> subdate<span class="token punctuation">(</span><span class="token string">'2022-2-20'</span><span class="token punctuation">,</span><span class="token number">173</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="34__212"></a>3.4 聚合函数</h6> 
<pre><code class="prism language-sql"><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 根据某个字段统计记录数
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

<span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 计算某个字段值的总和
<span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

<span class="token function">avg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 求某个字段值的平均值
<span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

<span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 求某个字段值的最大值
<span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

<span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 求某个字段值的最小值
<span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> name<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">group</span> <span class="token keyword">by</span> name <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">count</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> name<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">group</span> <span class="token keyword">by</span> name <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">count</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">;</span>
</code></pre> 
<p>where 和 having 的区别</p> 
<p>where 和 having 都是追加条件的，区别在于 SQL 是否进行了分组查询，如果进行了分组查询则使用 having，如果没有进行分组查询则使用 where。</p> 
<h4 id="miao14" align="center">4、 SQL 运算符</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<h6><a id="41__243"></a>4.1 算术运算符</h6> 
<p>1、执行运算符：加减乘除</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> num<span class="token operator">+</span><span class="token number">100</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> 
<p>2、比较运算符：大于、等于、小于、不等于</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> num <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> 
<p>3、逻辑运算符：&amp;&amp;、||、!</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">!</span><span class="token punctuation">(</span>num <span class="token operator">&lt;</span> <span class="token number">100</span> <span class="token operator">||</span> num <span class="token operator">&gt;</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="42__263"></a>4.2 特殊运算符</h6> 
<p>1、is null 判断字段值是否为空</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> 
<p>2、between and 判断字段值是否在某个区间之内</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> num <span class="token operator">between</span> <span class="token number">50</span> <span class="token operator">and</span> <span class="token number">100</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> 
<p>3、in 判断字段值是否在某个确定值的集合内</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> name <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">||</span> id <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">||</span> id <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code></pre> 
<p>4、like 模糊查询</p> 
<p>包含’电脑’</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'%电脑%'</span><span class="token punctuation">;</span>
</code></pre> 
<p>以’电脑’开头</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'电脑%'</span><span class="token punctuation">;</span>
</code></pre> 
<p>以’电脑’结尾</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'%电脑'</span><span class="token punctuation">;</span>
</code></pre> 
<p>name 长度为 2</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'__'</span><span class="token punctuation">;</span>
</code></pre> 
<p>name 长度为 3，并且以’电’开头</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'电__'</span><span class="token punctuation">;</span>
</code></pre> 
<p>name 长度为 3，中间为’电’</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'_电_'</span><span class="token punctuation">;</span>
</code></pre> 
<p>name 长度为 3，以’电’结尾</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'__电'</span><span class="token punctuation">;</span>
</code></pre> 
<h4 id="miao15" align="center">5、 数据 CRUD</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<p>CRUD</p> 
<p>create 创建</p> 
<p>read 读取</p> 
<p>update 修改</p> 
<p>delete 删除</p> 
<p>添加数据</p> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> 数据表<span class="token punctuation">(</span>字段列表<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span>字段值<span class="token punctuation">)</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">user</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'数据库'</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>查询数据</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> 字段列表 <span class="token keyword">from</span> 数据表名<span class="token punctuation">;</span>
<span class="token keyword">select</span> id<span class="token punctuation">,</span>name <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> 
<p>修改数据</p> 
<pre><code class="prism language-sql"><span class="token keyword">update</span> 数据表名 <span class="token keyword">set</span> 字段名<span class="token operator">=</span>字段值<span class="token punctuation">,</span>字段名<span class="token operator">=</span>字段值<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">where</span> 条件
</code></pre> 
<p>删除数据</p> 
<pre><code class="prism language-sql"><span class="token keyword">delete</span> <span class="token keyword">from</span> 数据表名 <span class="token keyword">where</span> 条件
</code></pre> 
<hr> 
<h2 id="miao2" align="center"> 二、表关系</h2> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<h4><a id="_374"></a></h4> 
<h4 id="miao21" align="center">1、表设计</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<h6><a id="11_378"></a>1.1主键</h6> 
<p>表中的一个字段，将其设置为主键，该字段的值是每一行记录的唯一标识。</p> 
<p>默认情况下，每张表都要有一个主键，一张表只能有一个主键。</p> 
<p>主键的值必须唯一。</p> 
<p>主键生成策略：代理主键，主键的值与业务无关，仅仅是用来标识一行数据的</p> 
<p>一般定义为 int 类型，因为 int 类型存储空间小，而且可以设置自增，当然有例外情况，订单编号，要求唯一，需要使用 String UUID</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> student<span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    age <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="12_397"></a>1.2外键</h6> 
<p>表中的一个字段，将其设置为外键，用来跟其他表进行关联的</p> 
<p>外键必须跟其他表的主键建立约束关系</p> 
<p>学生和班级</p> 
<table><thead><tr><th>编号</th><th>名称</th></tr></thead><tbody><tr><td>001</td><td>Java1班</td></tr><tr><td>002</td><td>Java2班</td></tr></tbody></table> 
<table><thead><tr><th>编号</th><th>姓名</th><th>班级</th></tr></thead><tbody><tr><td>1</td><td>张三</td><td></td></tr><tr><td>2</td><td>李四</td><td></td></tr><tr><td>3</td><td>王五</td><td></td></tr></tbody></table> 
<p>学生一定属于某个班级，所以学生表就需要有一个外键，用来约束学生必须对应一个存在的班级</p> 
<p>数据表的体现就是学生表的外键要跟班级表的主键建立约束关系，学生表的班级信息需要被班级表的主键所约束</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> class<span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">create</span> <span class="token keyword">table</span> student<span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    cid <span class="token keyword">int</span><span class="token punctuation">,</span>
    <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span> <span class="token keyword">references</span> class<span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4 id="miao22" align="center">2、表之间关系</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<p>数据表之间的关系分三种：</p> 
<p>1、一对一：A 表中的一条数据只能对应 B 表中的一条数据，B 表中的一条数据只能对应 A 表中的一条数据。</p> 
<p>2、一对多：A 表中的一条数据只能对应 B 表中的一条数据，B 表中的一条数据可以对应 A 表中的多条数据。</p> 
<p>3、多对多：A 表中的一条数据可以对应 B 表中的多条数据，B 表中的一条数据可以对应 A 表中的多条数据。</p> 
<p>一对一关系一般不用，主要用的是一对多和多对多</p> 
<blockquote> 
 <p>多对多</p> 
</blockquote> 
<p>学生选课</p> 
<p>学生表 account、课程表 course、中间表 account_course</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> account<span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> course<span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> account_course<span class="token punctuation">(</span>
    id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    cid <span class="token keyword">int</span><span class="token punctuation">,</span>
    aid <span class="token keyword">int</span><span class="token punctuation">,</span>
    <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>cid<span class="token punctuation">)</span> <span class="token keyword">references</span> course<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>aid<span class="token punctuation">)</span> <span class="token keyword">references</span> account<span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>account 和 course 都是主表，account_course 是从表，主表中的主键要约束从表中的外键。</p> 
<p>两个列作为一个主键，叫做联合主键</p> 
<hr> 
<h2 id="miao3" align="center">三、多表关联查询</h2> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<h4 id="miao31" align="center">1、关联查询</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<p>多张表进行关联查询</p> 
<blockquote> 
 <p>嵌套查询</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> name <span class="token keyword">from</span> class <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> cid <span class="token keyword">from</span> student <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>将两个 SQL 语句进行嵌套处理，第二条 SQL 的值作为第一条 SQL 的条件进行查询</p> 
<blockquote> 
 <p>连接查询</p> 
</blockquote> 
<ul><li>内连接（笛卡尔积）</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student <span class="token keyword">inner</span> <span class="token keyword">join</span> class <span class="token keyword">on</span> class<span class="token punctuation">.</span>id <span class="token operator">=</span> cid<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> s<span class="token punctuation">.</span>id sid<span class="token punctuation">,</span>s<span class="token punctuation">.</span>name sname<span class="token punctuation">,</span>c<span class="token punctuation">.</span>id cid<span class="token punctuation">,</span>c<span class="token punctuation">.</span>name cname <span class="token keyword">from</span> student s<span class="token punctuation">,</span>class c <span class="token keyword">where</span> c<span class="token punctuation">.</span>id <span class="token operator">=</span> s<span class="token punctuation">.</span>cid<span class="token punctuation">;</span>
</code></pre> 
<ul><li> <p>外连接</p> 
  <ul><li>左连接：左表所有数据和右表满足条件的数据</li></ul> <pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student <span class="token keyword">left</span> <span class="token keyword">join</span> class c <span class="token keyword">on</span> student<span class="token punctuation">.</span>cid <span class="token operator">=</span> c<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> 
  <ul><li>右连接：右表所有数据和左表满足条件的数据</li></ul> <pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student <span class="token keyword">right</span> <span class="token keyword">join</span> class c <span class="token keyword">on</span> student<span class="token punctuation">.</span>cid <span class="token operator">=</span> c<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> </li></ul> 
<h4 id="miao32" align="center">2、一对多关联查询</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<p>查询全部学生信息，包括所在班级信息</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> s<span class="token punctuation">.</span>id sid<span class="token punctuation">,</span>s<span class="token punctuation">.</span>name sname<span class="token punctuation">,</span>c<span class="token punctuation">.</span>id cid<span class="token punctuation">,</span>c<span class="token punctuation">.</span>name cname <span class="token keyword">from</span> student s<span class="token punctuation">,</span>class c <span class="token keyword">where</span> s<span class="token punctuation">.</span>cid <span class="token operator">=</span> c<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> 
<p>查询全部班级，包括班级的学习</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> c<span class="token punctuation">.</span>id cid<span class="token punctuation">,</span>c<span class="token punctuation">.</span>name cname<span class="token punctuation">,</span>s<span class="token punctuation">.</span>id sid<span class="token punctuation">,</span>s<span class="token punctuation">.</span>name sname <span class="token keyword">from</span> student s<span class="token punctuation">,</span>class c <span class="token keyword">where</span> s<span class="token punctuation">.</span>cid <span class="token operator">=</span> c<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> 
<h4 id="miao33" align="center">3、多对多关联查询</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> a<span class="token punctuation">.</span>id aid<span class="token punctuation">,</span>a<span class="token punctuation">.</span>name aname<span class="token punctuation">,</span>c<span class="token punctuation">.</span>id cid<span class="token punctuation">,</span>c<span class="token punctuation">.</span>name cname <span class="token keyword">from</span> account a<span class="token punctuation">,</span>course c<span class="token punctuation">,</span>account_course ac
<span class="token keyword">where</span> a<span class="token punctuation">.</span>id <span class="token operator">=</span> ac<span class="token punctuation">.</span>aid <span class="token operator">and</span> c<span class="token punctuation">.</span>id <span class="token operator">=</span> ac<span class="token punctuation">.</span>cid<span class="token punctuation">;</span>
</code></pre> 
<h4 id="miao34" align="center">4、去重distinct</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">distinct</span> a<span class="token punctuation">.</span>id aid<span class="token punctuation">,</span>a<span class="token punctuation">.</span>name aname<span class="token punctuation">,</span>c<span class="token punctuation">.</span>id cid<span class="token punctuation">,</span>c<span class="token punctuation">.</span>name cname <span class="token keyword">from</span> account a<span class="token punctuation">,</span>course c<span class="token punctuation">,</span>account_course ac
<span class="token keyword">where</span> a<span class="token punctuation">.</span>id <span class="token operator">=</span> ac<span class="token punctuation">.</span>aid <span class="token operator">and</span> c<span class="token punctuation">.</span>id <span class="token operator">=</span> ac<span class="token punctuation">.</span>cid<span class="token punctuation">;</span>
</code></pre> 
<p>去重操作只需要在 SQL 语句中添加 distinct 关键字即可，去重的要求是查询出来的数据必须完全一致，每个字段值都一样。</p> 
<h4 id="miao35" align="center">5、分页limit</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<p>分页查询是在 SQL 语句中添加 limit 进行，limit index,length</p> 
<p>index：截取的起始位置</p> 
<p>length：截取的长度</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account <span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">;</span>
</code></pre> 
<hr> 
<h2 id="miao4" align="center">四、数据库索引Index</h2> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<h4 id="miao41" align="center">1、数据库索引</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<p>索引是一种特殊的数据库结构，可以用来快速查询数据表中的特定记录，它是提高数据库性能的重要方式，所有字段都可以添加索引。</p> 
<p>主键自带索引，索引就是用来提高查询速度的。</p> 
<p>索引包括：普通索引、唯一性索引、全文索引、单列索引、多列索引、空间索引</p> 
<p>虽然使用索引可以提升检索数据的速度，但是创建和维护索引需要耗费时间，索引需要占用物理空间，给字段添加索引的时候需要结合具体情况来选择。</p> 
<p>普通索引：不需要任何限制条件的索引，可以在任意数据类型的字段上创建。</p> 
<p>唯一性索引：索引的值必须唯一，比如主键索引。</p> 
<p>全文索引：只能创建在 char、varchar、text 类型的字段上，查询数据量较大的字符串类型字段时，使用全文索引可以提高查询速度，InnoDB 存储引擎不支持全文索引。</p> 
<p>单列索引：只对应一个字段的索引。</p> 
<p>多列索引：在一张表的多个字段上创建一个索引，跟联合主键类似。</p> 
<p>空间索引：只能建立在空间数据库上（GIS），InnoDB 存储引擎不支持该索引。</p> 
<p>索引的特点：</p> 
<ul><li>主键自带索引</li><li>可以给任何字段添加索引</li></ul> 
<p>索引的设计原则：</p> 
<ul><li>字段出现在 where 语句中的列</li><li>索引的值尽量唯一，效率更高</li><li>不要添加过多的索引，维护成本很高</li></ul> 
<p>1、添加索引</p> 
<pre><code class="prism language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> account <span class="token keyword">add</span> <span class="token keyword">index</span> index_name<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> index_name <span class="token keyword">on</span> account<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>2、删除索引</p> 
<pre><code class="prism language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> account <span class="token keyword">drop</span> <span class="token keyword">index</span> index_name<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">drop</span> <span class="token keyword">index</span> index_name <span class="token keyword">on</span> account<span class="token punctuation">;</span>
</code></pre> 
<h4 id="miao42" align="center">2、数据库索引机制的实现</h4> 
<p><a href="#miao0" rel="nofollow">返回顶部目录</a></p> 
<div>
  点击延申阅读&gt; 
</div> 
<p><a href="https://blog.csdn.net/qq_44969643/article/details/116279109">Mysql的索引机制</a></p> 
<hr> 
<h2 id="miao5" align="center">五、事务Transaction</h2> 
<p><a href="#miao0" rel="nofollow">返回顶部目录</a></p> 
<h4 id="miao51" align="center">1、事务</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<p>将多条 SQL 作为一个整体，要么全部执行，要么一条都不执行。</p> 
<p>张三 1000，李四 1000</p> 
<p>张三借给李四 500</p> 
<p>张三 500，李四 1500</p> 
<pre><code class="prism language-sql"><span class="token keyword">update</span> <span class="token keyword">user</span> <span class="token keyword">set</span> money <span class="token operator">=</span> <span class="token number">500</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> <span class="token keyword">user</span> <span class="token keyword">set</span> money <span class="token operator">=</span> <span class="token number">1500</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'李四'</span><span class="token punctuation">;</span>
</code></pre> 
<p>事务的特点：</p> 
<ul><li>原子性：多条 SQL 是一个整体，不可再分割</li><li>一致性：SQL 执行前后，数据库的数据值保持一致</li><li>隔离性：一个事务的执行不能被其他事务所干扰</li><li>持久性：一个事务一旦提交，数据库中数据的改变是永久性的</li></ul> 
<p>事务的具体操作：</p> 
<p>1、开启事务</p> 
<p>start transaction;</p> 
<p>2、回滚</p> 
<p>rollback;</p> 
<p>3、提交</p> 
<p>commit;</p> 
<p>关闭事务的自动提交，MySQL 默认的执行方式是自动提交，默认开启了自动提交。</p> 
<pre><code class="prism language-sql">关闭自动提交
<span class="token keyword">set</span> autocommit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
开启自动提交
<span class="token keyword">set</span> autocommit <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
查看 autocommit 的值
<span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'autocommit'</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">start</span> <span class="token keyword">transaction</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> <span class="token keyword">user</span> <span class="token keyword">set</span> money <span class="token operator">=</span> <span class="token number">500</span> <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> <span class="token keyword">user</span> <span class="token keyword">set</span> money <span class="token operator">=</span> <span class="token number">1500</span> <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">rollback</span><span class="token punctuation">;</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>
</code></pre> 
<h4 id="miao52" align="center">2、Mysql的事务隔离机制</h4> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<div></div> 
<p>点击延伸阅读&gt;<br> <a href="https://blog.csdn.net/qq_44969643/article/details/115875681">Mysql的事务隔离机制</a></p> 
<hr> 
<h2 id="miao6" align="center">六、视图View</h2> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<p>数据库中的一张虚拟表，允许不同用户或应用程序以不同的方式查看同一张表中的数据。</p> 
<p>创建视图</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">view</span> view_common <span class="token keyword">as</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>name <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">view</span> view_all <span class="token keyword">as</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> 
<p>使用视图</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> view_common<span class="token punctuation">;</span>
</code></pre> 
<p>删除视图</p> 
<pre><code class="prism language-sql"><span class="token keyword">drop</span> <span class="token keyword">view</span> view_common<span class="token punctuation">;</span>
</code></pre> 
<hr> 
<h2 id="miao7" align="center">七、触发器Trigger</h2> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<p>触发器定义了一系列的操作，可以对指定表进行插入，更新，删除操作的同时自动执行这些操作。</p> 
<p>触发器的优点：</p> 
<ul><li>开发更快，因为触发器存储在数据库中的，所以不必编写每个触发器在应用程序中执行的操作</li><li>更容易维护，定义触发器之后，访问目标表，会自动调用触发器。</li><li>业务全局实现，如果修改业务，只需要修改触发器即可，不需要修改业务代码。</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> tab1<span class="token punctuation">(</span>
    tab1_id <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> tab2<span class="token punctuation">(</span>
    tab2_id <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">trigger</span> t_afterinsert_on_tab1
    <span class="token keyword">after</span> <span class="token keyword">insert</span> <span class="token keyword">on</span> tab1
    <span class="token keyword">for each row</span>
    <span class="token keyword">begin</span>
        <span class="token keyword">insert</span> <span class="token keyword">into</span> tab2<span class="token punctuation">(</span>tab2_id<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span>new<span class="token punctuation">.</span>tab1_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> 
<p>删除触发器</p> 
<pre><code class="prism language-sql"><span class="token keyword">drop</span> <span class="token keyword">trigger</span> t_afterinsert_on_tab1<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">trigger</span> t_afterdelete_on_tab1
    <span class="token keyword">after</span> <span class="token keyword">delete</span> <span class="token keyword">on</span> tab1
    <span class="token keyword">for each row</span>
    <span class="token keyword">begin</span>
        <span class="token keyword">delete</span> <span class="token keyword">from</span> tab2 <span class="token keyword">where</span> tab2_id <span class="token operator">=</span> old<span class="token punctuation">.</span>tab1_id<span class="token punctuation">;</span>
    <span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> 
<hr> 
<h2 id="miao8" align="center">八、存储过程Procedure</h2> 
<a href="#miao0" rel="nofollow">返回顶部目录</a> 
<p>存储过程是一组为了完成特定功能的 SQL 语句的集合，存储在数据库中的，用户可以直接进行调用，类似于方法的调用。</p> 
<p>一次编写，多次使用，避免开发人员重复编写相同的 SQL。</p> 
<p>创建存储过程</p> 
<p>参数：</p> 
<p>1、输入输出类型：入参、出参</p> 
<p>入参是指传到存储过程中的参数，类似于 Java 中的参数</p> 
<p>出参是指存储过程返回的数据，类似于 Java 中的返回值</p> 
<p>2、参数名称</p> 
<p>3、参数类型</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">procedure</span> add_name<span class="token punctuation">(</span><span class="token operator">in</span> target <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">declare</span> name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> target <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">then</span>
       <span class="token keyword">set</span> name <span class="token operator">=</span> <span class="token string">'MySQL'</span><span class="token punctuation">;</span>
       <span class="token keyword">else</span>
        <span class="token keyword">set</span> name <span class="token operator">=</span> <span class="token string">'Java'</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
    <span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">user</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> 
<p>调用存储过程</p> 
<pre><code class="prism language-sql"><span class="token keyword">call</span> add_name<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>删除存储过程</p> 
<pre><code class="prism language-sql"><span class="token keyword">drop</span> <span class="token keyword">procedure</span> add_name<span class="token punctuation">;</span>
</code></pre> 
<p>出参</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">procedure</span> count_of_course<span class="token punctuation">(</span><span class="token keyword">out</span> num <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">into</span> num <span class="token keyword">from</span> course<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">call</span> count_of_course<span class="token punctuation">(</span><span class="token variable">@num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token variable">@num</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">procedure</span> test<span class="token punctuation">(</span><span class="token operator">in</span> num <span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">out</span> val <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">if</span> num <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">then</span>
        <span class="token keyword">select</span> id <span class="token keyword">into</span> val <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
        <span class="token keyword">select</span> money <span class="token keyword">into</span> val <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">call</span> test<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token variable">@val</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token variable">@val</span><span class="token punctuation">;</span>
</code></pre> 
<p>if</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">procedure</span> example_if<span class="token punctuation">(</span><span class="token operator">in</span> x <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">if</span> x <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">then</span>
        <span class="token keyword">select</span> id <span class="token keyword">from</span> student<span class="token punctuation">;</span>
        <span class="token keyword">elseif</span> x <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">then</span>
        <span class="token keyword">select</span> name <span class="token keyword">from</span> student<span class="token punctuation">;</span>
    <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">call</span> example_if<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>case-when</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">procedure</span> example_case<span class="token punctuation">(</span><span class="token operator">in</span> x <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">case</span> x
        <span class="token keyword">when</span> <span class="token number">1</span> <span class="token keyword">then</span> <span class="token keyword">select</span> id <span class="token keyword">from</span> student<span class="token punctuation">;</span>
        <span class="token keyword">when</span> <span class="token number">2</span> <span class="token keyword">then</span> <span class="token keyword">select</span> name <span class="token keyword">from</span> student<span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">select</span> cid <span class="token keyword">from</span> student<span class="token punctuation">;</span>
        <span class="token keyword">end</span> <span class="token keyword">case</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">call</span> example_case<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
</code></pre> 
<p>while</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">procedure</span> example_while<span class="token punctuation">(</span><span class="token keyword">out</span> sum <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">declare</span> i <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">declare</span> s <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> i<span class="token operator">&lt;=</span><span class="token number">100</span> <span class="token keyword">do</span>
        <span class="token keyword">set</span> s <span class="token operator">=</span> s<span class="token operator">+</span>i<span class="token punctuation">;</span>
        <span class="token keyword">set</span> i <span class="token operator">=</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span> <span class="token keyword">while</span><span class="token punctuation">;</span>
    <span class="token keyword">set</span> sum <span class="token operator">=</span> s<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token keyword">call</span> example_while<span class="token punctuation">(</span><span class="token variable">@sum</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@sum</span><span class="token punctuation">;</span>
</code></pre> 
<hr> 
<p>推荐阅读：<br> <a href="https://blog.csdn.net/qq_44969643/article/details/117060659">数据库的设计</a><br> <a href="https://blog.csdn.net/qq_44969643/article/details/115586387">Mysql的执行流程</a></p> 
<hr>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7421f8deea5ce2175978532e3a93c252/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">k8s集群StatefulSets的Pod优雅调度问题思考？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bef854e135f64214e23c03fde1281ddf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java：IDEA结合Git和Gitee的简单使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>