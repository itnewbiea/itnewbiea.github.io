<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【深度学习 项目实战】Keras深度学习多变量时间序列预测的LSTM模型 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【深度学习 项目实战】Keras深度学习多变量时间序列预测的LSTM模型" />
<meta property="og:description" content="无意中发现了一个巨牛的人工智能教程，忍不住分享一下给大家。教程不仅是零基础，通俗易懂，而且非常风趣幽默，像看小说一样！觉得太牛了，所以分享给大家。点这里可以跳转到教程。人工智能教程
本篇文章将介绍基于Keras深度学习的多变量时间序列预测的LSTM模型。
项目名称：空气污染预测
一、主要内容：
如何将原始数据集转换为可用于时间序列预测的内容。 如何准备数据并使LSTM适合多变量时间序列预测问题。 如何进行预测并将结果重新缩放为原始单位。 二、数据下载
在本教程中，我们将使用空气质量数据集。该数据集报告了美国驻中国大使馆五年来每小时的天气和污染水平。数据包括日期时间，称为PM2.5浓度的污染以及包括露点，温度，压力，风向，风速和雪雨累计小时数的天气信息。原始数据中的完整功能列表如下：
否：行号 年：此行中的数据年份 month：此行中数据的月份 日期：此行中的数据日期 hour：该行中的数据小时 pm2.5：PM2.5浓度 露点：露点 TEMP：温度 PRES：压力 cbwd：组合风向 Iws：累计风速 是：累计下雪时间 Ir：累计下雨时间 我们可以使用这些数据来构建预测问题，在此情况下，鉴于前几个小时的天气条件和污染，我们可以预测下一个小时的污染。
数据下载地址
下载数据集并将其命名为 raw.csv
三、数据处理
第一步，将零散的日期时间信息整合为一个单一的日期时间，以便我们可以将其用作 Pandas 的索引。
快速检查第一天的 pm2.5 的 NA 值。因此，我们需要删除第一行数据。在数据集中还有几个零散的「NA」值，我们现在可以用 0 值标记它们。
以下脚本用于加载原始数据集，并将日期时间信息解析为 Pandas DataFrame 索引。「No」列被删除，每列被指定更加清晰的名称。最后，将 NA 值替换为「0」值，并删除前一天的数据。
# -*- coding: utf-8 -*- from pandas import * # 定义字符串转换为日期数据 def parse(x): return datetime.strptime(x, &#39;%Y %m %d %H&#39;) # 数据存放路径设置 data_path=r&#39;D:\深度学习\数据集\raw.csv&#39; # 读取数据 dataset = read_csv(data_path,sep=&#39;,&#39;, parse_dates = [[&#39;year&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;]], index_col=0, date_parser=parse) # 删除NO列 dataset." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/411b7fc0cab06a7f3406a21ec8e9e51d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-07T16:36:48+08:00" />
<meta property="article:modified_time" content="2023-06-07T16:36:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【深度学习 项目实战】Keras深度学习多变量时间序列预测的LSTM模型</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>无意中发现了一个巨牛的人工智能教程，忍不住分享一下给大家。教程不仅是零基础，通俗易懂，而且非常风趣幽默，像看小说一样！觉得太牛了，所以分享给大家。点这里可以跳转到教程。<a href="https://www.captainai.net/u013421629" rel="nofollow">人工智能教程</a></p> 
<p>本篇文章将介绍基于Keras深度学习的多变量时间序列预测的LSTM模型。</p> 
<p>项目名称：空气污染预测</p> 
<p><strong>一、主要内容：</strong></p> 
<pre><code class="prism language-c">如何将原始数据集转换为可用于时间序列预测的内容。
如何准备数据并使LSTM适合多变量时间序列预测问题。
如何进行预测并将结果重新缩放为原始单位。
</code></pre> 
<p><strong>二、数据下载</strong></p> 
<p>在本教程中，我们将使用空气质量数据集。该数据集报告了美国驻中国大使馆五年来每小时的天气和污染水平。数据包括日期时间，称为PM2.5浓度的污染以及包括露点，温度，压力，风向，风速和雪雨累计小时数的天气信息。原始数据中的完整功能列表如下：</p> 
<pre><code class="prism language-c">否：行号
年：此行中的数据年份
month：此行中数据的月份
日期：此行中的数据日期
hour：该行中的数据小时
pm2<span class="token punctuation">.</span><span class="token number">5</span>：PM2<span class="token punctuation">.</span><span class="token number">5</span>浓度
露点：露点
TEMP：温度
PRES：压力
cbwd：组合风向
Iws：累计风速
是：累计下雪时间
Ir：累计下雨时间
</code></pre> 
<p>我们可以使用这些数据来构建预测问题，在此情况下，鉴于前几个小时的天气条件和污染，我们可以预测下一个小时的污染。</p> 
<p><a href="https://archive.ics.uci.edu/ml/datasets/Beijing+PM2.5+Data" rel="nofollow">数据下载地址</a><br> 下载数据集并将其命名为 raw.csv</p> 
<p><strong>三、数据处理</strong></p> 
<p>第一步，将零散的日期时间信息整合为一个单一的日期时间，以便我们可以将其用作 Pandas 的索引。<br> 快速检查第一天的 pm2.5 的 NA 值。因此，我们需要删除第一行数据。在数据集中还有几个零散的「NA」值，我们现在可以用 0 值标记它们。</p> 
<p>以下脚本用于加载原始数据集，并将日期时间信息解析为 Pandas DataFrame 索引。「No」列被删除，每列被指定更加清晰的名称。最后，将 NA 值替换为「0」值，并删除前一天的数据。</p> 
<pre><code class="prism language-c">
# <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span> coding<span class="token operator">:</span> utf<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span>
from pandas import <span class="token operator">*</span>

# 定义字符串转换为日期数据
def <span class="token function">parse</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">:</span>
	<span class="token keyword">return</span> datetime<span class="token punctuation">.</span><span class="token function">strptime</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token char">'%Y %m %d %H'</span><span class="token punctuation">)</span>

# 数据存放路径设置
data_path<span class="token operator">=</span>r<span class="token char">'D:\深度学习\数据集\raw.csv'</span>
# 读取数据
dataset <span class="token operator">=</span> <span class="token function">read_csv</span><span class="token punctuation">(</span>data_path<span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token char">','</span><span class="token punctuation">,</span>  parse_dates <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token char">'year'</span><span class="token punctuation">,</span> <span class="token char">'month'</span><span class="token punctuation">,</span> <span class="token char">'day'</span><span class="token punctuation">,</span> <span class="token char">'hour'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> date_parser<span class="token operator">=</span>parse<span class="token punctuation">)</span>
# 删除NO列
dataset<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token char">'No'</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span>True<span class="token punctuation">)</span>
# 重命名
dataset<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token char">'pollution'</span><span class="token punctuation">,</span> <span class="token char">'dew'</span><span class="token punctuation">,</span> <span class="token char">'temp'</span><span class="token punctuation">,</span> <span class="token char">'press'</span><span class="token punctuation">,</span> <span class="token char">'wnd_dir'</span><span class="token punctuation">,</span> <span class="token char">'wnd_spd'</span><span class="token punctuation">,</span> <span class="token char">'snow'</span><span class="token punctuation">,</span> <span class="token char">'rain'</span><span class="token punctuation">]</span>
# 索引重命名
dataset<span class="token punctuation">.</span>index<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token char">'date'</span>
# 填充NA值为<span class="token number">0</span>
dataset<span class="token punctuation">[</span><span class="token char">'pollution'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">fillna</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span>True<span class="token punctuation">)</span>

# 删除前<span class="token number">24</span>行无效数据
dataset <span class="token operator">=</span> dataset<span class="token punctuation">[</span><span class="token number">24</span><span class="token operator">:</span><span class="token punctuation">]</span>
# 打印前五行数据
<span class="token function">print</span><span class="token punctuation">(</span>dataset<span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
# 保存数据
dataset<span class="token punctuation">.</span><span class="token function">to_csv</span><span class="token punctuation">(</span>r<span class="token char">'D:\深度学习\数据集\pollution.csv'</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-c">                   pollution  dew  temp   press wnd_dir  wnd_spd  snow  rain
date                                                                          
<span class="token number">2010</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span>      <span class="token number">129.0</span>  <span class="token operator">-</span><span class="token number">16</span>  <span class="token operator">-</span><span class="token number">4.0</span>  <span class="token number">1020.0</span>      SE     <span class="token number">1.79</span>     <span class="token number">0</span>     <span class="token number">0</span>
<span class="token number">2010</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">01</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span>      <span class="token number">148.0</span>  <span class="token operator">-</span><span class="token number">15</span>  <span class="token operator">-</span><span class="token number">4.0</span>  <span class="token number">1020.0</span>      SE     <span class="token number">2.68</span>     <span class="token number">0</span>     <span class="token number">0</span>
<span class="token number">2010</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">02</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span>      <span class="token number">159.0</span>  <span class="token operator">-</span><span class="token number">11</span>  <span class="token operator">-</span><span class="token number">5.0</span>  <span class="token number">1021.0</span>      SE     <span class="token number">3.57</span>     <span class="token number">0</span>     <span class="token number">0</span>
<span class="token number">2010</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">03</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span>      <span class="token number">181.0</span>   <span class="token operator">-</span><span class="token number">7</span>  <span class="token operator">-</span><span class="token number">5.0</span>  <span class="token number">1022.0</span>      SE     <span class="token number">5.36</span>     <span class="token number">1</span>     <span class="token number">0</span>
<span class="token number">2010</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">04</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span>      <span class="token number">138.0</span>   <span class="token operator">-</span><span class="token number">7</span>  <span class="token operator">-</span><span class="token number">5.0</span>  <span class="token number">1022.0</span>      SE     <span class="token number">6.25</span>     <span class="token number">2</span>     <span class="token number">0</span>
</code></pre> 
<p><strong>四、建立多变量 LSTM 预测模型</strong></p> 
<pre><code class="prism language-c"># <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span> coding<span class="token operator">:</span> utf<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span>


from math import sqrt
from numpy import concatenate
from matplotlib import pyplot
from pandas import read_csv
from pandas import DataFrame
from pandas import concat
from sklearn<span class="token punctuation">.</span>preprocessing import MinMaxScaler
from sklearn<span class="token punctuation">.</span>preprocessing import LabelEncoder
from sklearn<span class="token punctuation">.</span>metrics import mean_squared_error<span class="token punctuation">,</span>r2_score
from keras<span class="token punctuation">.</span>models import Sequential
from keras<span class="token punctuation">.</span>layers import Dense
from keras<span class="token punctuation">.</span>layers import LSTM


# 将序列转换为监督学习函数
def <span class="token function">series_to_supervised</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> n_in<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> n_out<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> dropnan<span class="token operator">=</span>True<span class="token punctuation">)</span><span class="token operator">:</span>
    n_vars <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">if</span> <span class="token function">type</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> is list <span class="token keyword">else</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    df <span class="token operator">=</span> <span class="token function">DataFrame</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    cols<span class="token punctuation">,</span> names <span class="token operator">=</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">input</span> <span class="token expression"><span class="token function">sequence</span> <span class="token punctuation">(</span>t<span class="token operator">-</span>n<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> t<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></span></span>
    <span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span>n_in<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">:</span>
        cols<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
        names <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token char">'var%d(t-%d)'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j in <span class="token function">range</span><span class="token punctuation">(</span>n_vars<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">forecast</span> <span class="token expression"><span class="token function">sequence</span> <span class="token punctuation">(</span>t<span class="token punctuation">,</span> t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> t<span class="token operator">+</span>n<span class="token punctuation">)</span></span></span>
    <span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> n_out<span class="token punctuation">)</span><span class="token operator">:</span>
        cols<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token operator">:</span>
            names <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token char">'var%d(t)'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j in <span class="token function">range</span><span class="token punctuation">(</span>n_vars<span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token operator">:</span>
            names <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token char">'var%d(t+%d)'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j in <span class="token function">range</span><span class="token punctuation">(</span>n_vars<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">put</span> <span class="token expression">it all together</span></span>
    agg <span class="token operator">=</span> <span class="token function">concat</span><span class="token punctuation">(</span>cols<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    agg<span class="token punctuation">.</span>columns <span class="token operator">=</span> names
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">drop</span> <span class="token expression">rows with NaN values</span></span>
    <span class="token keyword">if</span> dropnan<span class="token operator">:</span>
        agg<span class="token punctuation">.</span><span class="token function">dropna</span><span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span>
    <span class="token keyword">return</span> agg


# 导入数据集
dataset <span class="token operator">=</span> <span class="token function">read_csv</span><span class="token punctuation">(</span>r<span class="token char">'D:\深度学习\数据集\pollution.csv'</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
values <span class="token operator">=</span> dataset<span class="token punctuation">.</span>values

# 离散变量独热编码
encoder <span class="token operator">=</span> <span class="token function">LabelEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
values<span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> encoder<span class="token punctuation">.</span><span class="token function">fit_transform</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

# 转换数据类型
values <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">astype</span><span class="token punctuation">(</span><span class="token char">'float32'</span><span class="token punctuation">)</span>

# 特征归一化为<span class="token number">0</span><span class="token operator">-</span><span class="token number">1</span>之间
scaler <span class="token operator">=</span> <span class="token function">MinMaxScaler</span><span class="token punctuation">(</span>feature_range<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
scaled <span class="token operator">=</span> scaler<span class="token punctuation">.</span><span class="token function">fit_transform</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span>

# 数据转换为监督学习数据集
reframed <span class="token operator">=</span> <span class="token function">series_to_supervised</span><span class="token punctuation">(</span>scaled<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

# 删除不需要的列
reframed<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span>reframed<span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span>True<span class="token punctuation">)</span>



# 划分训练数据集和测试数据集
values <span class="token operator">=</span> reframed<span class="token punctuation">.</span>values
n_train_hours <span class="token operator">=</span> <span class="token number">365</span> <span class="token operator">*</span> <span class="token number">24</span>
train <span class="token operator">=</span> values<span class="token punctuation">[</span><span class="token operator">:</span>n_train_hours<span class="token punctuation">,</span> <span class="token operator">:</span><span class="token punctuation">]</span>
test <span class="token operator">=</span> values<span class="token punctuation">[</span>n_train_hours<span class="token operator">:</span><span class="token punctuation">,</span> <span class="token operator">:</span><span class="token punctuation">]</span>
train_X<span class="token punctuation">,</span> train_y <span class="token operator">=</span> train<span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train<span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
test_X<span class="token punctuation">,</span> test_y <span class="token operator">=</span> test<span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> test<span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>

# 将输入（X）重构为 LSTM 预期的 <span class="token number">3</span>D 格式，即 <span class="token punctuation">[</span>样本，时间步，特征<span class="token punctuation">]</span>。
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">reshape</span> <span class="token expression">input to be <span class="token number">3</span>D <span class="token punctuation">[</span>samples<span class="token punctuation">,</span> timesteps<span class="token punctuation">,</span> features<span class="token punctuation">]</span></span></span>
train_X <span class="token operator">=</span> train_X<span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token punctuation">(</span>train_X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> train_X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
test_X <span class="token operator">=</span> test_X<span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token punctuation">(</span>test_X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> test_X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span>train_X<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> train_y<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> test_X<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> test_y<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>



# 设计lstm模型
model <span class="token operator">=</span> <span class="token function">Sequential</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">LSTM</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> input_shape<span class="token operator">=</span><span class="token punctuation">(</span>train_X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">Dense</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>loss<span class="token operator">=</span><span class="token char">'mae'</span><span class="token punctuation">,</span> optimizer<span class="token operator">=</span><span class="token char">'adam'</span><span class="token punctuation">)</span>
# 训练模型
history <span class="token operator">=</span> model<span class="token punctuation">.</span><span class="token function">fit</span><span class="token punctuation">(</span>train_X<span class="token punctuation">,</span> train_y<span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> validation_data<span class="token operator">=</span><span class="token punctuation">(</span>test_X<span class="token punctuation">,</span> test_y<span class="token punctuation">)</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span>False<span class="token punctuation">)</span>

# 误差可视化
pyplot<span class="token punctuation">.</span><span class="token function">plot</span><span class="token punctuation">(</span>history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token char">'loss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token char">'train'</span><span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span><span class="token function">plot</span><span class="token punctuation">(</span>history<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token char">'val_loss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token char">'test'</span><span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span><span class="token function">legend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


# 模型预测
yhat <span class="token operator">=</span> model<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span>test_X<span class="token punctuation">)</span>

# 转换预测值
test_X <span class="token operator">=</span> test_X<span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token punctuation">(</span>test_X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> test_X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
inv_yhat <span class="token operator">=</span> <span class="token function">concatenate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>yhat<span class="token punctuation">,</span> test_X<span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
inv_yhat <span class="token operator">=</span> scaler<span class="token punctuation">.</span><span class="token function">inverse_transform</span><span class="token punctuation">(</span>inv_yhat<span class="token punctuation">)</span>
inv_yhat <span class="token operator">=</span> inv_yhat<span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>

# 转换实际值
test_y <span class="token operator">=</span> test_y<span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>test_y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
inv_y <span class="token operator">=</span> <span class="token function">concatenate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>test_y<span class="token punctuation">,</span> test_X<span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
inv_y <span class="token operator">=</span> scaler<span class="token punctuation">.</span><span class="token function">inverse_transform</span><span class="token punctuation">(</span>inv_y<span class="token punctuation">)</span>
inv_y <span class="token operator">=</span> inv_y<span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>

# 模型评估
# 均方误差
rmse <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">mean_squared_error</span><span class="token punctuation">(</span>inv_y<span class="token punctuation">,</span> inv_yhat<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">R方</span></span>
r2<span class="token operator">=</span><span class="token function">r2_score</span><span class="token punctuation">(</span>inv_y<span class="token punctuation">,</span> inv_yhat<span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'Test RMSE: %.3f'</span> <span class="token operator">%</span> rmse<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'Test R2：%.3f'</span> <span class="token operator">%</span> r2<span class="token punctuation">)</span>



</code></pre> 
<p><img src="https://images2.imgbox.com/77/f6/ROF5rESO_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">Using TensorFlow backend<span class="token punctuation">.</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">46.083137</span><span class="token operator">:</span> I tensorflow<span class="token operator">/</span>stream_executor<span class="token operator">/</span>platform<span class="token operator">/</span><span class="token keyword">default</span><span class="token operator">/</span>dso_loader<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">44</span><span class="token punctuation">]</span> Successfully opened dynamic library cudart64_100<span class="token punctuation">.</span><span class="token function">dll</span>
<span class="token punctuation">(</span><span class="token number">8760</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">8760</span><span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">35039</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">35039</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">47.305909</span><span class="token operator">:</span> I tensorflow<span class="token operator">/</span>stream_executor<span class="token operator">/</span>platform<span class="token operator">/</span><span class="token keyword">default</span><span class="token operator">/</span>dso_loader<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">44</span><span class="token punctuation">]</span> Successfully opened dynamic library nvcuda<span class="token punctuation">.</span>dll
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">47.333454</span><span class="token operator">:</span> I tensorflow<span class="token operator">/</span>core<span class="token operator">/</span>common_runtime<span class="token operator">/</span>gpu<span class="token operator">/</span>gpu_device<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">1618</span><span class="token punctuation">]</span> Found device <span class="token number">0</span> with properties<span class="token operator">:</span> 
name<span class="token operator">:</span> GeForce GTX <span class="token number">1650</span> major<span class="token operator">:</span> <span class="token number">7</span> minor<span class="token operator">:</span> <span class="token number">5</span> <span class="token function">memoryClockRate</span><span class="token punctuation">(</span>GHz<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">1.56</span>
pciBusID<span class="token operator">:</span> <span class="token number">0000</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">00.0</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">47.333855</span><span class="token operator">:</span> I tensorflow<span class="token operator">/</span>stream_executor<span class="token operator">/</span>platform<span class="token operator">/</span><span class="token keyword">default</span><span class="token operator">/</span>dlopen_checker_stub<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">]</span> GPU libraries are statically linked<span class="token punctuation">,</span> skip dlopen check<span class="token punctuation">.</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">47.334613</span><span class="token operator">:</span> I tensorflow<span class="token operator">/</span>core<span class="token operator">/</span>common_runtime<span class="token operator">/</span>gpu<span class="token operator">/</span>gpu_device<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">1746</span><span class="token punctuation">]</span> Adding visible gpu devices<span class="token operator">:</span> <span class="token number">0</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">47.335203</span><span class="token operator">:</span> I tensorflow<span class="token operator">/</span>core<span class="token operator">/</span>platform<span class="token operator">/</span>cpu_feature_guard<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">142</span><span class="token punctuation">]</span> Your CPU supports instructions that this TensorFlow binary was not compiled to use<span class="token operator">:</span> AVX2
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">47.337976</span><span class="token operator">:</span> I tensorflow<span class="token operator">/</span>core<span class="token operator">/</span>common_runtime<span class="token operator">/</span>gpu<span class="token operator">/</span>gpu_device<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">1618</span><span class="token punctuation">]</span> Found device <span class="token number">0</span> with properties<span class="token operator">:</span> 
name<span class="token operator">:</span> GeForce GTX <span class="token number">1650</span> major<span class="token operator">:</span> <span class="token number">7</span> minor<span class="token operator">:</span> <span class="token number">5</span> <span class="token function">memoryClockRate</span><span class="token punctuation">(</span>GHz<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">1.56</span>
pciBusID<span class="token operator">:</span> <span class="token number">0000</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">00.0</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">47.338315</span><span class="token operator">:</span> I tensorflow<span class="token operator">/</span>stream_executor<span class="token operator">/</span>platform<span class="token operator">/</span><span class="token keyword">default</span><span class="token operator">/</span>dlopen_checker_stub<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">]</span> GPU libraries are statically linked<span class="token punctuation">,</span> skip dlopen check<span class="token punctuation">.</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">47.339027</span><span class="token operator">:</span> I tensorflow<span class="token operator">/</span>core<span class="token operator">/</span>common_runtime<span class="token operator">/</span>gpu<span class="token operator">/</span>gpu_device<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">1746</span><span class="token punctuation">]</span> Adding visible gpu devices<span class="token operator">:</span> <span class="token number">0</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">47.854835</span><span class="token operator">:</span> I tensorflow<span class="token operator">/</span>core<span class="token operator">/</span>common_runtime<span class="token operator">/</span>gpu<span class="token operator">/</span>gpu_device<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">1159</span><span class="token punctuation">]</span> Device interconnect StreamExecutor with strength <span class="token number">1</span> edge matrix<span class="token operator">:</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">47.855022</span><span class="token operator">:</span> I tensorflow<span class="token operator">/</span>core<span class="token operator">/</span>common_runtime<span class="token operator">/</span>gpu<span class="token operator">/</span>gpu_device<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">1165</span><span class="token punctuation">]</span>      <span class="token number">0</span> 
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">47.855120</span><span class="token operator">:</span> I tensorflow<span class="token operator">/</span>core<span class="token operator">/</span>common_runtime<span class="token operator">/</span>gpu<span class="token operator">/</span>gpu_device<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">1178</span><span class="token punctuation">]</span> <span class="token number">0</span><span class="token operator">:</span>   N 
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">47.855868</span><span class="token operator">:</span> I tensorflow<span class="token operator">/</span>core<span class="token operator">/</span>common_runtime<span class="token operator">/</span>gpu<span class="token operator">/</span>gpu_device<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">1304</span><span class="token punctuation">]</span> Created TensorFlow <span class="token function">device</span> <span class="token punctuation">(</span><span class="token operator">/</span>job<span class="token operator">:</span>localhost<span class="token operator">/</span>replica<span class="token operator">:</span><span class="token number">0</span><span class="token operator">/</span>task<span class="token operator">:</span><span class="token number">0</span><span class="token operator">/</span>device<span class="token operator">:</span>GPU<span class="token operator">:</span><span class="token number">0</span> with <span class="token number">2919</span> MB memory<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> physical <span class="token function">GPU</span> <span class="token punctuation">(</span>device<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> name<span class="token operator">:</span> GeForce GTX <span class="token number">1650</span><span class="token punctuation">,</span> pci bus id<span class="token operator">:</span> <span class="token number">0000</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">00.0</span><span class="token punctuation">,</span> compute capability<span class="token operator">:</span> <span class="token number">7.5</span><span class="token punctuation">)</span>
Train on <span class="token number">8760</span> samples<span class="token punctuation">,</span> validate on <span class="token number">35039</span> samples
Epoch <span class="token number">1</span><span class="token operator">/</span><span class="token number">100</span>
<span class="token number">2019</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">19</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">48.783437</span><span class="token operator">:</span> I tensorflow<span class="token operator">/</span>stream_executor<span class="token operator">/</span>platform<span class="token operator">/</span><span class="token keyword">default</span><span class="token operator">/</span>dso_loader<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">44</span><span class="token punctuation">]</span> Successfully opened dynamic library cublas64_100<span class="token punctuation">.</span>dll
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0606</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0485</span>
Epoch <span class="token number">2</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">1</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0347</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0372</span>
Epoch <span class="token number">3</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">1</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0180</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0230</span>
Epoch <span class="token number">4</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">1</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0157</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0165</span>
Epoch <span class="token number">5</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">1</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0149</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0147</span>
Epoch <span class="token number">6</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0149</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0145</span>
Epoch <span class="token number">7</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0147</span>
Epoch <span class="token number">8</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0147</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0147</span>
Epoch <span class="token number">9</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0150</span>
Epoch <span class="token number">10</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0144</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0155</span>
Epoch <span class="token number">11</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0149</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0148</span>
Epoch <span class="token number">12</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0149</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0151</span>
Epoch <span class="token number">13</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0150</span>
Epoch <span class="token number">14</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0147</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0149</span>
Epoch <span class="token number">15</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0147</span>
Epoch <span class="token number">16</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0151</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0154</span>
Epoch <span class="token number">17</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0150</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0154</span>
Epoch <span class="token number">18</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0148</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0152</span>
Epoch <span class="token number">19</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0149</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0153</span>
Epoch <span class="token number">20</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0148</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0157</span>
Epoch <span class="token number">21</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0147</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0156</span>
Epoch <span class="token number">22</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0147</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0157</span>
Epoch <span class="token number">23</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0147</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0158</span>
Epoch <span class="token number">24</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0147</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0156</span>
Epoch <span class="token number">25</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0154</span>
Epoch <span class="token number">26</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0155</span>
Epoch <span class="token number">27</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0155</span>
Epoch <span class="token number">28</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0148</span>
Epoch <span class="token number">29</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0147</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0149</span>
Epoch <span class="token number">30</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0156</span>
Epoch <span class="token number">31</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0151</span>
Epoch <span class="token number">32</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0152</span>
Epoch <span class="token number">33</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0150</span>
Epoch <span class="token number">34</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0145</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0149</span>
Epoch <span class="token number">35</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0147</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0147</span>
Epoch <span class="token number">36</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0145</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0148</span>
Epoch <span class="token number">37</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0145</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0147</span>
Epoch <span class="token number">38</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0146</span>
Epoch <span class="token number">39</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0145</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0146</span>
Epoch <span class="token number">40</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0145</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0143</span>
Epoch <span class="token number">41</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0144</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0143</span>
Epoch <span class="token number">42</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0145</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0143</span>
Epoch <span class="token number">43</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0144</span>
Epoch <span class="token number">44</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0145</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0141</span>
Epoch <span class="token number">45</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0144</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0139</span>
Epoch <span class="token number">46</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0140</span>
Epoch <span class="token number">47</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0140</span>
Epoch <span class="token number">48</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0138</span>
Epoch <span class="token number">49</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0145</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0140</span>
Epoch <span class="token number">50</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0139</span>
Epoch <span class="token number">51</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0138</span>
Epoch <span class="token number">52</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0140</span>
Epoch <span class="token number">53</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0139</span>
Epoch <span class="token number">54</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0144</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0138</span>
Epoch <span class="token number">55</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0145</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0138</span>
Epoch <span class="token number">56</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0145</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0138</span>
Epoch <span class="token number">57</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0144</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">58</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0145</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0137</span>
Epoch <span class="token number">59</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0137</span>
Epoch <span class="token number">60</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0141</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0137</span>
Epoch <span class="token number">61</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">62</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0146</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0144</span>
Epoch <span class="token number">63</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0145</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0140</span>
Epoch <span class="token number">64</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">65</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0145</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0144</span>
Epoch <span class="token number">66</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0137</span>
Epoch <span class="token number">67</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">68</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0137</span>
Epoch <span class="token number">69</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">70</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">71</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0137</span>
Epoch <span class="token number">72</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0137</span>
Epoch <span class="token number">73</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0137</span>
Epoch <span class="token number">74</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">75</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0138</span>
Epoch <span class="token number">76</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0144</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0137</span>
Epoch <span class="token number">77</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0144</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">78</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">79</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">80</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0135</span>
Epoch <span class="token number">81</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0135</span>
Epoch <span class="token number">82</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">83</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">84</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0135</span>
Epoch <span class="token number">85</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0135</span>
Epoch <span class="token number">86</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0135</span>
Epoch <span class="token number">87</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">88</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">89</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0135</span>
Epoch <span class="token number">90</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">91</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0135</span>
Epoch <span class="token number">92</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0144</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">93</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0135</span>
Epoch <span class="token number">94</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0135</span>
Epoch <span class="token number">95</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0135</span>
Epoch <span class="token number">96</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0144</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0135</span>
Epoch <span class="token number">97</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0143</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">98</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0134</span>
Epoch <span class="token number">99</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0141</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Epoch <span class="token number">100</span><span class="token operator">/</span><span class="token number">100</span>
 <span class="token operator">-</span> <span class="token number">2</span>s <span class="token operator">-</span> loss<span class="token operator">:</span> <span class="token number">0.0142</span> <span class="token operator">-</span> val_loss<span class="token operator">:</span> <span class="token number">0.0136</span>
Test RMSE<span class="token operator">:</span> <span class="token number">26.489</span>
Test R2：<span class="token number">0.917</span>

Process finished with exit code <span class="token number">0</span>

</code></pre> 
<p><strong>评估模型</strong></p> 
<p>模型拟合后，我们可以预测整个测试数据集。通过初始预测值和实际值，我们可以计算模型的误差分数。在这种情况下，我们可以计算出与变量相同的单元误差的均方根误差（RMSE）。<br> 以及R方确定系数</p> 
<p>Test RMSE: 26.489<br> Test R2：0.917</p> 
<p>模型效果不错哦</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b6947efe3887e3ed9058d77d7adcc2d4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">处理日期-dayjs</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f478d0c78d4cb68a2b9f9f101394ee83/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue3使用拖拽组件draggable-next的使用教程【保姆级】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>