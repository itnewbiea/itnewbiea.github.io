<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>XSLT学习笔记 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="XSLT学习笔记" />
<meta property="og:description" content="1. 样式声明：
&lt;xsl:stylesheet&gt;或&lt;xsl:transform&gt;
2. XSLT常用元素：
2.1 &lt;xsl:template&gt;：创建模板
Match属性的作用是使模板和XML元素相关联
e.g.:&lt;xsl:template match=&#34;\&#34;&gt;......&lt;/xsl:template&gt;
2.2 &lt;xsl:value-of&gt;：选取XML元素，并添加到已被转换的输出流中
e.g.:&lt;xsl:value-of select = &#34;xpath&#34;/&gt;
2.3 &lt;xsl:for-each&gt;：循环
2.4 &lt;xsl:sort&gt;：对结果进行排序
e.g.:&lt;xsl:for-each select =&#34;catalog/cd[&#34;article=&#39;Bob&#39;]&#34;&gt;
&lt;xsl:sort select=&#34;article&#34;/&gt;
.....
&lt;/xsl:for-each&gt;
在我实际练习时，发现如果select属性中若要带参数，需要按照如下语法：&lt;xsl:sort select=&#34;*[name()=$param1Name]&#34; order=&#34;{$para2Name}&#34;/&gt;
2.5 &lt;xsl:if&gt;：相当于if-then
&lt;xsl:if test=&#34;price&gt;10&#34;&gt;
......
&lt;/xsl:if&gt;
2.6 &lt;xsl:choose&gt;：相当于if-then-else
&lt;xsl:choose&gt;
&lt;xsl:when test=&#34;expression&#34;&gt;
......
&lt;/xsl:when&gt;
&lt;xsl:otherwise&gt;
......
&lt;/xsl:otherwise&gt;
&lt;/xsl:choose&gt;
3. XSLT常用函数
3.1 current()：返回当前节点
e.g.:&lt;xsl:value-of select=&#34;current()&#34;/&gt;
等效于：&lt;xsl:value-of select=&#34;.&#34;/&gt;
3.2 document()：访问一个外部的XML文档的节点
e.g.:&lt;xsl:value-of select=&#34;document(&#39;other.xml&#39;)/root/xpath&#34;/&gt;
实际应用中，貌似document后面的接的Xpath中不能带参数变量，例如这样会出现解析错误：&#34;document(&#39;other.xml&#39;)/root/$paramName/ChildNode&#34;
3.3 element-available():测试指定的元素是否能被XSLT处理器支持
e.g.:&lt;xsl:when test=&#34;element-available(&#39;xsl:comment&#39;)&#34;&gt;
判断是否支持注释
&lt;/xsl:when&gt;
3.4 format-number():数字转换为字符串
e.g.:&lt;value-of select=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c1a75b8e72e4e61d8b979af51bd30ba2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-07-05T01:03:34+08:00" />
<meta property="article:modified_time" content="2019-07-05T01:03:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">XSLT学习笔记</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <p><br><strong style="font-size:14pt;">1. 样式声明：</strong><br>&lt;xsl:stylesheet&gt;或&lt;xsl:transform&gt;</p> 
 <p> </p> 
 <p><br><br><strong style="font-size:14pt;">2. XSLT常用元素：</strong></p> 
 <p><strong>2.1 &lt;xsl:template&gt;：</strong>创建模板<br>    Match属性的作用是使模板和XML元素相关联<br>    e.g.:&lt;xsl:template match="\"&gt;......&lt;/xsl:template&gt;</p> 
 <p><strong>2.2 &lt;xsl:value-of&gt;：</strong>选取XML元素，并添加到已被转换的输出流中<br>    e.g.:&lt;xsl:value-of select = "xpath"/&gt;</p> 
 <p><strong>2.3 &lt;xsl:for-each&gt;：</strong>循环<br><strong>2.4 &lt;xsl:sort&gt;：</strong>对结果进行排序<br>    e.g.:&lt;xsl:for-each select ="catalog/cd["article='Bob']"&gt;<br>            &lt;xsl:sort select="article"/&gt;<br>            .....<br>         &lt;/xsl:for-each&gt;<br>   在我实际练习时，发现如果select属性中若要带参数，需要按照如下语法：&lt;xsl:sort select="*[name()=$param1Name]" order="{$para2Name}"/&gt;</p> 
 <p><strong>2.5 &lt;xsl:if&gt;：</strong>相当于if-then<br>    &lt;xsl:if test="price&gt;10"&gt;<br>        ......<br>    &lt;/xsl:if&gt;</p> 
 <p><strong>2.6 &lt;xsl:choose&gt;：</strong>相当于if-then-else<br>    &lt;xsl:choose&gt;<br>       &lt;xsl:when test="expression"&gt;<br>           ......<br>       &lt;/xsl:when&gt;<br>       &lt;xsl:otherwise&gt;<br>           ......<br>       &lt;/xsl:otherwise&gt;<br>    &lt;/xsl:choose&gt;</p> 
 <p> </p> 
 <p><strong><span style="font-size:14pt;">3. XSLT常用函数</span></strong><br><strong>3.1 current()：</strong>返回当前节点<br>    e.g.:&lt;xsl:value-of select="current()"/&gt;<br>    等效于：&lt;xsl:value-of select="."/&gt;</p> 
 <p><strong>3.2 document()：</strong>访问一个外部的XML文档的节点<br>    e.g.:&lt;xsl:value-of select="document('other.xml')/root/xpath"/&gt;<br>    实际应用中，貌似document后面的接的Xpath中不能带参数变量，例如这样会出现解析错误："document('other.xml')/root/$paramName/ChildNode"</p> 
 <p><strong>3.3 element-available():</strong>测试指定的元素是否能被XSLT处理器支持<br>    e.g.:&lt;xsl:when test="element-available('xsl:comment')"&gt;<br>             判断是否支持注释<br>         &lt;/xsl:when&gt;</p> 
 <p><strong>3.4 format-number():</strong>数字转换为字符串<br>    e.g.:&lt;value-of select="format-number(500,'#.00')"/&gt;</p> 
 <p><strong>3.5 function-available():</strong>测试是否支持该函数<br>    e.g.:&lt;xsl:if test="function-availabel('current')"&gt;<br>             ......<br>         &lt;/xsl:if&gt;</p> 
 <p><strong>3.6 generate-id()：</strong>返回自增独立唯一标识，类似于SQL中的identity(1,1)</p> 
 <p><strong>3.7 key():</strong>使用由&lt;xsl:key&gt;指定的索引[index]，从当前文档中返回一个节点组；<br>    e.g.: &lt;xsl:for-each select="key('string','object')"&gt;<br>              ......<br>          &lt;/xsl:for-each&gt;</p> 
 <p><strong>3.8 system-property():</strong>返回通过name属性指定的系统属性值<br>    e.g.:&lt;xsl:value-of select="system-property('xsl:version')"/&gt;</p> 
 <p><strong>3.9 unprased-entity-uri():</strong>返回未解析实体的URI.</p> 
 <p> </p> 
 <p><strong style="font-size:14pt;">4. JS传参数给XSLT：<br></strong>JS中：</p> 
 <div style="border-right:#cccccc 1px solid;border-top:#cccccc 1px solid;font-size:13px;border-left:#cccccc 1px solid;border-bottom:#cccccc 1px solid;"> 
  <img src="https://images2.imgbox.com/bd/d0/X9RqjZIg_o.gif" align="top" alt="None.gif"> 
  <span style="color:#000000;">var xml </span> 
  <span style="color:#000000;">=</span> 
  <span style="color:#000000;"> </span> 
  <span style="color:#0000ff;">new</span> 
  <span style="color:#000000;"> ActiveXObject(</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">MSXML2.DOMDocument</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">);<br><img src="https://images2.imgbox.com/15/a9/wWX9OfBg_o.gif" align="top" alt="None.gif">xml.load(</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">filename.xml</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">);<br><img src="https://images2.imgbox.com/a6/f1/UMQSX7tm_o.gif" align="top" alt="None.gif">var xsl </span> 
  <span style="color:#000000;">=</span> 
  <span style="color:#000000;"> </span> 
  <span style="color:#0000ff;">new</span> 
  <span style="color:#000000;"> ActiveXObject(</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">MSXML2.FreeThreadedDOMDocument</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">);<br><img src="https://images2.imgbox.com/30/de/B9JpxRWZ_o.gif" align="top" alt="None.gif">xsl.load(</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">filename.xsl</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">);      <br><img src="https://images2.imgbox.com/5c/08/5bs8RTl4_o.gif" align="top" alt="None.gif">var xslTemplate </span> 
  <span style="color:#000000;">=</span> 
  <span style="color:#000000;"> </span> 
  <span style="color:#0000ff;">new</span> 
  <span style="color:#000000;"> ActiveXObject(</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">MSXML2.XSLTemplate</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">);<br><img src="https://images2.imgbox.com/7f/d1/kv3EqAYR_o.gif" align="top" alt="None.gif">xslTemplate.stylesheet </span> 
  <span style="color:#000000;">=</span> 
  <span style="color:#000000;"> xsl;<br><img src="https://images2.imgbox.com/94/71/sJV3CJV9_o.gif" align="top" alt="None.gif">var xslProcessor </span> 
  <span style="color:#000000;">=</span> 
  <span style="color:#000000;"> xslTemplate.createProcessor();   <br><img src="https://images2.imgbox.com/e1/41/EmX29WHm_o.gif" align="top" alt="None.gif">xslProcessor.input </span> 
  <span style="color:#000000;">=</span> 
  <span style="color:#000000;"> xml;<br><img src="https://images2.imgbox.com/9d/d8/UBfYHyRL_o.gif" align="top" alt="None.gif">xslProcessor.addParameter(</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">ParamName</span> 
  <span style="color:#000000;">"</span> 
  <span style="color:#000000;">, paramValue);<br><img src="https://images2.imgbox.com/34/76/2QchYM2z_o.gif" align="top" alt="None.gif">xslProcessor.transform();</span> 
 </div> 
 <p>XSLT中:<br>&lt;param name="ParamName"&gt;&lt;/param&gt;<br>用$ParamName取得参数的值    <br><br></p> 
</div> 
<p>转载于:https://www.cnblogs.com/happyhippy/archive/2007/07/25/831576.html</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/26fd2e883e5b1153cbab16f5d907f7d8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Effective C# 摘录(2) - .NET资源管理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5404905fdae41f210dd68dd9e2fe15ab/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">VC中的CWnd指针和HWnd的区别于联系</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>