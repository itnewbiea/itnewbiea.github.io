<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【uni-app】uni-app实现聊天页面功能——功能篇（下） - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【uni-app】uni-app实现聊天页面功能——功能篇（下）" />
<meta property="og:description" content="目录 前言一、聊天框随键盘抬起思路代码实现 二、聊天消息列表随着聊天框的增高而滚动到最底部思路 三、问题完整代码实现总结 前言 前面我有写关于如何进行聊天页面布局和实现聊天消息滚动到最底部的文章。
【uni-app】uni-app实现聊天页面功能——功能篇（上）
【uni-app】uni-app实现聊天页面功能（小程序）——布局篇
这篇文章是基于这两篇的基础上完善的。
主要还是实现以下两个功能：
点击聊天框的时候，聊天框随键盘抬起且聊天消息列表滚动到最底部，但整体页面不抬起
聊天框textarea根据内容自适应高度，且聊天消息列表随着聊天框的增高而滚动到最底部（说白了就是最底部的消息不会被增高的聊天框给挡住）
一、聊天框随键盘抬起 uni-app官方文档中其实有给出关于这个的解决方案，只用设置一个属性。
textarea | uni-app官网 (dcloud.net.cn)
textarea的属性：
adjust-position —— 键盘抬起时，是否自动上推页面（默认值为true）
cursor-spacing —— 指定光标与键盘的距离，单位px（就是设置键盘与输入框的距离，默认值为0）
&lt;textarea cursor-spacing = &#34;60&#34;&gt;&lt;/textarea&gt; 虽然这种方法简单，但是有一个不好的地方是：页面整体会上移
如果想让聊天框随键盘抬起的同时不想让页面上移，可以参考下面这个方法。
思路 首先我们需要在键盘抬起的时候获取到键盘的高度，然后给聊天框动态设置合适的bottom值（键盘的高度），最后给textarea的属性adjust-position设置为false。
至于在点击聊天框的时候聊天消息定位到最底部（不会被遮挡）我将放到第二个板块去讲！！！
获取键盘高度采用官方给出的api（最快且稳定的）实现：uni.hideKeyboard() | uni-app官网 (dcloud.net.cn)
我们在页面加载时设置uni.onKeyboardHeightChange监听事件去获取到键盘高度，在页面卸载时使用uni.offKeyboardHeightChange解除监听键盘高度事件。
代码实现 视图部分（简写）：
&lt;template&gt; &lt;view class=&#34;chat&#34;&gt; &lt;scroll-view :style=&#34;{height: `${windowHeight-keyboardHeight}rpx`}&#34; id=&#34;scrollview&#34; scroll-y=&#34;true&#34; :scroll-top=&#34;scrollTop&#34; :scroll-with-animation=&#34;true&#34; class=&#34;scroll-view&#34; &gt; &lt;view id=&#34;msglistview&#34; class=&#34;chat-body&#34;&gt; ... &lt;/view&gt; &lt;/scroll-view&gt; &lt;!-- 底部消息发送栏 --&gt; &lt;view class=&#34;chat-bottom&#34;&gt; &lt;view class=&#34;send-msg&#34; :style=&#34;{bottom:`${keyboardHeight}rpx`}&#34;&gt; &lt;view class=&#34;uni-textarea&#34;&gt; &lt;textarea v-model=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/f24a2a7c9b5c815c040710c4bd39d2ae/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-25T11:44:37+08:00" />
<meta property="article:modified_time" content="2023-04-25T11:44:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【uni-app】uni-app实现聊天页面功能——功能篇（下）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><a href="#_2" rel="nofollow">前言</a></li><li><a href="#_21" rel="nofollow">一、聊天框随键盘抬起</a></li><li><ul><li><a href="#_44" rel="nofollow">思路</a></li><li><a href="#_56" rel="nofollow">代码实现</a></li></ul> 
   </li><li><a href="#_117" rel="nofollow">二、聊天消息列表随着聊天框的增高而滚动到最底部</a></li><li><ul><li><a href="#_123" rel="nofollow">思路</a></li></ul> 
   </li><li><a href="#_131" rel="nofollow">三、问题</a></li><li><a href="#_139" rel="nofollow">完整代码实现</a></li><li><a href="#_473" rel="nofollow">总结</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_2"></a>前言</h3> 
<p>前面我有写关于如何进行聊天页面布局和实现聊天消息滚动到最底部的文章。</p> 
<p><a href="https://blog.csdn.net/qq_51250105/article/details/130145862?spm=1001.2014.3001.5502">【uni-app】uni-app实现聊天页面功能——功能篇（上）</a></p> 
<p><a href="https://blog.csdn.net/qq_51250105/article/details/130084841?spm=1001.2014.3001.5502">【uni-app】uni-app实现聊天页面功能（小程序）——布局篇</a></p> 
<p>这篇文章是基于这两篇的基础上完善的。</p> 
<p>主要还是实现以下两个功能：</p> 
<ol><li> <p>点击聊天框的时候，<strong>聊天框随键盘抬起</strong>且聊天消息列表滚动到最底部，但整体页面不抬起</p> </li><li> <p>聊天框textarea根据内容自适应高度，且<strong>聊天消息列表随着聊天框的增高而滚动到最底部</strong>（说白了就是最底部的消息不会被增高的聊天框给挡住）</p> </li></ol> 
<p><img src="https://images2.imgbox.com/f2/ad/v2oJdGD2_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_21"></a>一、聊天框随键盘抬起</h3> 
<p>uni-app官方文档中其实有给出关于这个的解决方案，只用设置一个属性。</p> 
<p><a href="https://uniapp.dcloud.net.cn/component/textarea.html" rel="nofollow">textarea | uni-app官网 (dcloud.net.cn)</a></p> 
<blockquote> 
 <p>textarea的属性：</p> 
 <p><strong>adjust-position</strong> —— 键盘抬起时，是否自动上推页面（默认值为true）</p> 
 <p><strong>cursor-spacing</strong> —— 指定光标与键盘的距离，单位px（就是设置键盘与输入框的距离，默认值为0）</p> 
</blockquote> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">cursor-spacing</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>60<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>虽然这种方法简单，但是有一个不好的地方是：<strong>页面整体会上移</strong></p> 
<p><img src="https://images2.imgbox.com/d1/5c/guj8XSIC_o.png" alt="在这里插入图片描述"></p> 
<p>如果想让聊天框随键盘抬起的同时不想让页面上移，可以参考下面这个方法。</p> 
<h4><a id="_44"></a>思路</h4> 
<p>首先我们需要在键盘抬起的时候<strong>获取到键盘的高度</strong>，然后给聊天框<strong>动态设置合适的bottom值（键盘的高度）</strong>，最后给textarea的属性<code>adjust-position</code>设置为false。</p> 
<p>至于在点击聊天框的时候聊天消息定位到最底部（不会被遮挡）我将放到第二个板块去讲！！！</p> 
<hr> 
<p>获取键盘高度采用官方给出的api（最快且稳定的）实现：<a href="https://uniapp.dcloud.net.cn/api/key.html#onkeyboardheightchange" rel="nofollow">uni.hideKeyboard() | uni-app官网 (dcloud.net.cn)</a></p> 
<p>我们在<strong>页面加载</strong>时设置<code>uni.onKeyboardHeightChange</code>监听事件去获取到键盘高度，在页面卸载时使用<code>uni.offKeyboardHeightChange</code>解除监听键盘高度事件。</p> 
<h4><a id="_56"></a>代码实现</h4> 
<p>视图部分（简写）：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chat<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scroll-view</span> <span class="token attr-name">:style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{height: `${windowHeight-keyboardHeight}rpx`}<span class="token punctuation">"</span></span>
		<span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scrollview<span class="token punctuation">"</span></span>
		<span class="token attr-name">scroll-y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> 
		<span class="token attr-name">:scroll-top</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scrollTop<span class="token punctuation">"</span></span>
		<span class="token attr-name">:scroll-with-animation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
		<span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scroll-view<span class="token punctuation">"</span></span>
		<span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msglistview<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chat-body<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
				...
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scroll-view</span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!-- 底部消息发送栏 --&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chat-bottom<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>send-msg<span class="token punctuation">"</span></span> <span class="token attr-name">:style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{bottom:`${keyboardHeight}rpx`}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>uni-textarea<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chatMsg<span class="token punctuation">"</span></span>
					  <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span>
					  <span class="token attr-name">confirm-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>send<span class="token punctuation">"</span></span>
                      <span class="token attr-name">:adjust-position</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span>
                      <span class="token attr-name">:show-confirm-bar</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span>
					  <span class="token attr-name">auto-height</span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleSend<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>send-btn<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>发送<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>js部分：</p> 
<pre><code class="prism language-js"><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//键盘高度</span>
        <span class="token literal-property property">keyboardHeight</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token comment">// 聊天框距离底部的高度</span>
        <span class="token literal-property property">bottomHeight</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>	
<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	uni<span class="token punctuation">.</span><span class="token function">onKeyboardHeightChange</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//这里正常来讲代码直接写</span>
        <span class="token comment">//this.keyboardHeight=this.rpxTopx(res.height)就行了</span>
        <span class="token comment">//但是之前界面ui设计聊天框的高度有点高,为了不让键盘和聊天输入框之间距离差太大所以我改动了一下。</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>keyboardHeight <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">rpxTopx</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>height<span class="token operator">-</span><span class="token number">60</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>keyboardHeight<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">this</span><span class="token punctuation">.</span>keyboardHeight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">onUnload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	uni<span class="token punctuation">.</span><span class="token function">offKeyboardHeightChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//如果不传入监听的对象，则移除所有监听函数</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_117"></a>二、聊天消息列表随着聊天框的增高而滚动到最底部</h3> 
<p>需求：</p> 
<p>点击聊天框，聊天消息定位到最底部。聊天框textarea根据内容自适应高度（已实现），且<strong>聊天消息列表随着聊天框的增高而滚动到最底部</strong>（说白了就是最底部的消息不会被增高的聊天框给挡住）</p> 
<h4><a id="_123"></a>思路</h4> 
<p>因为点击聊天框的时候，键盘抬起，所以此时的内容可视区高度应该是：<strong>屏幕高度-（聊天框高度+键盘高度）</strong>，所以将这个高度赋值给聊天滚动区，同时<strong>页面更新时</strong>再调用聊天滚动到底部的函数就实现了</p> 
<p>聊天框的高度我们可以用<code>boundingClientRect</code>获取到，然后在textarea的行数发生变化的时候（@linechange）调用获取聊天框高度的函数。</p> 
<blockquote> 
 <p>还有个小细节就是，套在聊天框最外层的view也要跟随着聊天框改高度，然后颜色也要设置成跟界面背景色一样，这样当聊天框弹起来的时候就不会闪出一个白板。</p> 
</blockquote> 
<h3><a id="_131"></a>三、问题</h3> 
<p>设置scroll-view中的<code>scroll-with-animation</code>为true时，聊天发送消息会有一个过渡的动画效果。由于有动画时长，消息的发送会有一定的延时，这个动画的时长比我们设置的消息滚动到底部<code>scrollToBottom</code>函数的延时要长（也就是说，动画还未完成，就执行滚动到底部的函数，这只是我的个人猜想）。这样会导致发送的聊天消息比较长时（<strong>聊天消息只有一行的时候没影响</strong>），发送出去的消息会有一个回弹，页面不能滚到最底部（不能完整显示出聊天消息）。<br> <img src="https://images2.imgbox.com/05/0a/ZGHfJAGT_o.gif" alt="在这里插入图片描述"></p> 
<p><strong>解决方案</strong>：<br> 把动画效果删了，不加<code>scroll-with-animation</code><br> （如果有更好的解决办法也可以告诉我！）</p> 
<h3><a id="_139"></a>完整代码实现</h3> 
<p>整个页面完整代码：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chat<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scroll-view</span>  <span class="token attr-name">:style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{height: `${windowHeight-inputHeight}rpx`}<span class="token punctuation">"</span></span>
		<span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scrollview<span class="token punctuation">"</span></span>
		<span class="token attr-name">scroll-y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> 
		<span class="token attr-name">:scroll-top</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scrollTop<span class="token punctuation">"</span></span>
		<span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scroll-view<span class="token punctuation">"</span></span>
		<span class="token punctuation">&gt;</span></span>
			<span class="token comment">&lt;!-- 聊天主体 --&gt;</span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msglistview<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chat-body<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token comment">&lt;!-- 聊天记录 --&gt;</span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(item,index) in msgList<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
					<span class="token comment">&lt;!-- 自己发的消息 --&gt;</span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item self<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.userContent != <span class="token punctuation">'</span><span class="token punctuation">'</span><span class="token punctuation">"</span></span> <span class="token punctuation">&gt;</span></span>
						<span class="token comment">&lt;!-- 文字内容 --&gt;</span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content right<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
						{<!-- -->{item.userContent}}
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
						<span class="token comment">&lt;!-- 头像 --&gt;</span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>avatar<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
					<span class="token comment">&lt;!-- 机器人发的消息 --&gt;</span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item Ai<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.botContent != <span class="token punctuation">'</span><span class="token punctuation">'</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
						<span class="token comment">&lt;!-- 头像 --&gt;</span>     
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>avatar<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
						<span class="token comment">&lt;!-- 文字内容 --&gt;</span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content left<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
							{<!-- -->{item.botContent}}
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scroll-view</span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!-- 底部消息发送栏 --&gt;</span>
		<span class="token comment">&lt;!-- 用来占位，防止聊天消息被发送框遮挡 --&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chat-bottom<span class="token punctuation">"</span></span> <span class="token attr-name">:style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{height: `${inputHeight}rpx`}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>send-msg<span class="token punctuation">"</span></span> <span class="token attr-name">:style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{bottom:`${keyboardHeight}rpx`}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>uni-textarea<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chatMsg<span class="token punctuation">"</span></span>
					  <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span>
					  <span class="token attr-name">confirm-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>send<span class="token punctuation">"</span></span>
					  <span class="token attr-name">@confirm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleSend<span class="token punctuation">"</span></span>
					  <span class="token attr-name">:show-confirm-bar</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span>
					  <span class="token attr-name">:adjust-position</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span>
					  <span class="token attr-name">@linechange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sendHeight<span class="token punctuation">"</span></span>
					  <span class="token attr-name">@focus</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>focus<span class="token punctuation">"</span></span> <span class="token attr-name">@blur</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>blur<span class="token punctuation">"</span></span>
					 <span class="token attr-name">auto-height</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleSend<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>send-btn<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>发送<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
				<span class="token comment">//键盘高度</span>
				<span class="token literal-property property">keyboardHeight</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
				<span class="token comment">//底部消息发送高度</span>
				<span class="token literal-property property">bottomHeight</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
				<span class="token comment">//滚动距离</span>
				<span class="token literal-property property">scrollTop</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
				<span class="token literal-property property">userId</span><span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>
				<span class="token comment">//发送的消息</span>
				<span class="token literal-property property">chatMsg</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span>
				<span class="token literal-property property">msgList</span><span class="token operator">:</span><span class="token punctuation">[</span>
					<span class="token punctuation">{<!-- --></span>
					    <span class="token literal-property property">botContent</span><span class="token operator">:</span> <span class="token string">"hello，请问我有什么可以帮助你的吗？"</span><span class="token punctuation">,</span>
					    <span class="token literal-property property">recordId</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
					    <span class="token literal-property property">titleId</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
					    <span class="token literal-property property">userContent</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
					    <span class="token literal-property property">userId</span><span class="token operator">:</span> <span class="token number">0</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token punctuation">{<!-- --></span>
					    <span class="token literal-property property">botContent</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
					    <span class="token literal-property property">recordId</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
					    <span class="token literal-property property">titleId</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
					    <span class="token literal-property property">userContent</span><span class="token operator">:</span> <span class="token string">"你好呀我想问你一件事"</span><span class="token punctuation">,</span>
					    <span class="token literal-property property">userId</span><span class="token operator">:</span> <span class="token number">0</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token punctuation">]</span>	
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">updated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			<span class="token comment">//页面更新时调用聊天消息定位到最底部</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">scrollToBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
			<span class="token function">windowHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">rpxTopx</span><span class="token punctuation">(</span>uni<span class="token punctuation">.</span><span class="token function">getSystemInfoSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>windowHeight<span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">// 键盘弹起来的高度+发送框高度</span>
			<span class="token function">inputHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bottomHeight<span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>keyboardHeight
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			uni<span class="token punctuation">.</span><span class="token function">onKeyboardHeightChange</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
				<span class="token comment">//这里正常来讲代码直接写</span>
				<span class="token comment">//this.keyboardHeight=this.rpxTopx(res.height)就行了</span>
				<span class="token comment">//但是之前界面ui设计聊天框的高度有点高,为了不让键盘和聊天输入框之间距离差太大所以我改动了一下。</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>keyboardHeight <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">rpxTopx</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>height<span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">)</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>keyboardHeight<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">this</span><span class="token punctuation">.</span>keyboardHeight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">onUnload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			uni<span class="token punctuation">.</span><span class="token function">offKeyboardHeightChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
			<span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">scrollToBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function">blur</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">scrollToBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">// px转换成rpx</span>
			<span class="token function">rpxTopx</span><span class="token punctuation">(</span><span class="token parameter">px</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">let</span> deviceWidth <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getSystemInfoSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>windowWidth
				<span class="token keyword">let</span> rpx <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token number">750</span> <span class="token operator">/</span> deviceWidth <span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">Number</span><span class="token punctuation">(</span>px<span class="token punctuation">)</span>
				<span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>rpx<span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">// 监视聊天发送栏高度</span>
			<span class="token function">sendHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
					<span class="token keyword">let</span> query <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">createSelectorQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					query<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'.send-msg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">boundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
					query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
						<span class="token keyword">this</span><span class="token punctuation">.</span>bottomHeight <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">rpxTopx</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>height<span class="token punctuation">)</span>
					<span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">// 滚动至聊天底部</span>
			<span class="token function">scrollToBottom</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
					<span class="token keyword">let</span> query <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">createSelectorQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">in</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					query<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'#scrollview'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">boundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					query<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'#msglistview'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">boundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
						<span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>height <span class="token operator">&gt;</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
							<span class="token keyword">this</span><span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">rpxTopx</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>height <span class="token operator">-</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>height<span class="token punctuation">)</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">// 发送消息</span>
			<span class="token function">handleSend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				<span class="token comment">//如果消息不为空</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>chatMsg<span class="token operator">||</span><span class="token operator">!</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\s+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>chatMsg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
						<span class="token literal-property property">botContent</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
						<span class="token literal-property property">recordId</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
						<span class="token literal-property property">titleId</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
						<span class="token literal-property property">userContent</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>chatMsg<span class="token punctuation">,</span>
						<span class="token literal-property property">userId</span><span class="token operator">:</span> <span class="token number">0</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>msgList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>chatMsg <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">scrollToBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>$modal<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token string">'不能发送空白消息'</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scss<span class="token punctuation">"</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
	
	$<span class="token property">chatContentbgc</span><span class="token punctuation">:</span> #C2DCFF<span class="token punctuation">;</span>
	$<span class="token property">sendBtnbgc</span><span class="token punctuation">:</span> #4F7DF5<span class="token punctuation">;</span>
	
	<span class="token selector">view,button,text,input,textarea</span> <span class="token punctuation">{<!-- --></span>
		<span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
		<span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
		<span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/* 聊天消息 */</span>
	<span class="token selector">.chat</span> <span class="token punctuation">{<!-- --></span>
		<span class="token selector">.scroll-view</span> <span class="token punctuation">{<!-- --></span>
			<span class="token selector">::-webkit-scrollbar</span> <span class="token punctuation">{<!-- --></span>
					    <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
					    <span class="token property">width</span><span class="token punctuation">:</span> 0 <span class="token important">!important</span><span class="token punctuation">;</span>
					    <span class="token property">height</span><span class="token punctuation">:</span> 0 <span class="token important">!important</span><span class="token punctuation">;</span>
					    <span class="token property">-webkit-appearance</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
					    <span class="token property">background</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>
					    <span class="token property">color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>
					  <span class="token punctuation">}</span>
			
			// <span class="token property">background-color</span><span class="token punctuation">:</span> orange<span class="token punctuation">;</span>
			<span class="token property">background-color</span><span class="token punctuation">:</span> #F6F6F6<span class="token punctuation">;</span>
			
			<span class="token selector">.chat-body</span> <span class="token punctuation">{<!-- --></span>
				<span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
				<span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
				<span class="token property">padding-top</span><span class="token punctuation">:</span> 23rpx<span class="token punctuation">;</span>
				// <span class="token property">background-color</span><span class="token punctuation">:</span>skyblue<span class="token punctuation">;</span>
				
				<span class="token selector">.self</span> <span class="token punctuation">{<!-- --></span>
					<span class="token property">justify-content</span><span class="token punctuation">:</span> flex-end<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token selector">.item</span> <span class="token punctuation">{<!-- --></span>
					<span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
					<span class="token property">padding</span><span class="token punctuation">:</span> 23rpx 30rpx<span class="token punctuation">;</span>
					// <span class="token property">background-color</span><span class="token punctuation">:</span> greenyellow<span class="token punctuation">;</span>

					<span class="token selector">.right</span> <span class="token punctuation">{<!-- --></span>
						<span class="token property">background-color</span><span class="token punctuation">:</span> $chatContentbgc<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token selector">.left</span> <span class="token punctuation">{<!-- --></span>
						<span class="token property">background-color</span><span class="token punctuation">:</span> #FFFFFF<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
                    <span class="token selector">// 聊天消息的三角形
					.right::after</span> <span class="token punctuation">{<!-- --></span>
						<span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
						<span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
						<span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
						<span class="token property">width</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
						<span class="token property">height</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
						<span class="token property">left</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
						<span class="token property">top</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
						<span class="token property">border</span><span class="token punctuation">:</span> 12rpx solid transparent<span class="token punctuation">;</span>
						<span class="token property">border-left</span><span class="token punctuation">:</span> 12rpx solid $chatContentbgc<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					<span class="token selector">.left::after</span> <span class="token punctuation">{<!-- --></span>
						<span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
						<span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
						<span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
						<span class="token property">width</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
						<span class="token property">height</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
						<span class="token property">top</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
						<span class="token property">right</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
						<span class="token property">border</span><span class="token punctuation">:</span> 12rpx solid transparent<span class="token punctuation">;</span>
						<span class="token property">border-right</span><span class="token punctuation">:</span> 12rpx solid #FFFFFF<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					<span class="token selector">.content</span> <span class="token punctuation">{<!-- --></span>
						<span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
						<span class="token property">max-width</span><span class="token punctuation">:</span> 486rpx<span class="token punctuation">;</span>
						<span class="token property">border-radius</span><span class="token punctuation">:</span> 8rpx<span class="token punctuation">;</span>
						<span class="token property">word-wrap</span><span class="token punctuation">:</span> break-word<span class="token punctuation">;</span>
						<span class="token property">padding</span><span class="token punctuation">:</span> 24rpx 24rpx<span class="token punctuation">;</span>
						<span class="token property">margin</span><span class="token punctuation">:</span> 0 24rpx<span class="token punctuation">;</span>
						<span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
						<span class="token property">font-size</span><span class="token punctuation">:</span> 32rpx<span class="token punctuation">;</span>
						<span class="token property">font-family</span><span class="token punctuation">:</span> PingFang SC<span class="token punctuation">;</span>
						<span class="token property">font-weight</span><span class="token punctuation">:</span> 500<span class="token punctuation">;</span>
						<span class="token property">color</span><span class="token punctuation">:</span> #333333<span class="token punctuation">;</span>
						<span class="token property">line-height</span><span class="token punctuation">:</span> 42rpx<span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					<span class="token selector">.avatar</span> <span class="token punctuation">{<!-- --></span>
						<span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
						<span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
						<span class="token property">width</span><span class="token punctuation">:</span> 78rpx<span class="token punctuation">;</span>
						<span class="token property">height</span><span class="token punctuation">:</span> 78rpx<span class="token punctuation">;</span>
						<span class="token property">background</span><span class="token punctuation">:</span> $sendBtnbgc<span class="token punctuation">;</span>
						<span class="token property">border-radius</span><span class="token punctuation">:</span> 8rpx<span class="token punctuation">;</span>
						<span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
						
						<span class="token selector">image</span> <span class="token punctuation">{<!-- --></span>
							<span class="token property">align-self</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
						<span class="token punctuation">}</span>

					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token comment">/* 底部聊天发送栏 */</span>
		<span class="token selector">.chat-bottom</span> <span class="token punctuation">{<!-- --></span>
			<span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
			<span class="token property">height</span><span class="token punctuation">:</span> 177rpx<span class="token punctuation">;</span>
			<span class="token property">background</span><span class="token punctuation">:</span> #F4F5F7<span class="token punctuation">;</span>
			<span class="token property">transition</span><span class="token punctuation">:</span> all 0.1s ease<span class="token punctuation">;</span>
			

			<span class="token selector">.send-msg</span> <span class="token punctuation">{<!-- --></span>
				<span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
				<span class="token property">align-items</span><span class="token punctuation">:</span> flex-end<span class="token punctuation">;</span>
				<span class="token property">padding</span><span class="token punctuation">:</span> 16rpx 30rpx<span class="token punctuation">;</span>
				<span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
				<span class="token property">min-height</span><span class="token punctuation">:</span> 177rpx<span class="token punctuation">;</span>
				<span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
				<span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
				<span class="token property">background</span><span class="token punctuation">:</span> #EDEDED<span class="token punctuation">;</span>
				<span class="token property">transition</span><span class="token punctuation">:</span> all 0.1s ease<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token selector">.uni-textarea</span> <span class="token punctuation">{<!-- --></span>
				<span class="token property">padding-bottom</span><span class="token punctuation">:</span> 70rpx<span class="token punctuation">;</span>
                
				<span class="token selector">textarea</span> <span class="token punctuation">{<!-- --></span>
					<span class="token property">width</span><span class="token punctuation">:</span> 537rpx<span class="token punctuation">;</span>
					<span class="token property">min-height</span><span class="token punctuation">:</span> 75rpx<span class="token punctuation">;</span>
					<span class="token property">max-height</span><span class="token punctuation">:</span> 500rpx<span class="token punctuation">;</span>
					<span class="token property">background</span><span class="token punctuation">:</span> #FFFFFF<span class="token punctuation">;</span>
					<span class="token property">border-radius</span><span class="token punctuation">:</span> 8rpx<span class="token punctuation">;</span>
					<span class="token property">font-size</span><span class="token punctuation">:</span> 32rpx<span class="token punctuation">;</span>
					<span class="token property">font-family</span><span class="token punctuation">:</span> PingFang SC<span class="token punctuation">;</span>
					<span class="token property">color</span><span class="token punctuation">:</span> #333333<span class="token punctuation">;</span>
					<span class="token property">line-height</span><span class="token punctuation">:</span> 43rpx<span class="token punctuation">;</span>
					<span class="token property">padding</span><span class="token punctuation">:</span> 5rpx 8rpx<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
            
			<span class="token selector">.send-btn</span> <span class="token punctuation">{<!-- --></span>
				<span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
				<span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
				<span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
				<span class="token property">margin-bottom</span><span class="token punctuation">:</span> 70rpx<span class="token punctuation">;</span>
				<span class="token property">margin-left</span><span class="token punctuation">:</span> 25rpx<span class="token punctuation">;</span>
				<span class="token property">width</span><span class="token punctuation">:</span> 128rpx<span class="token punctuation">;</span>
				<span class="token property">height</span><span class="token punctuation">:</span> 75rpx<span class="token punctuation">;</span>
				<span class="token property">background</span><span class="token punctuation">:</span> $sendBtnbgc<span class="token punctuation">;</span>
				<span class="token property">border-radius</span><span class="token punctuation">:</span> 8rpx<span class="token punctuation">;</span>
				<span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
				<span class="token property">font-family</span><span class="token punctuation">:</span> PingFang SC<span class="token punctuation">;</span>
				<span class="token property">font-weight</span><span class="token punctuation">:</span> 500<span class="token punctuation">;</span>
				<span class="token property">color</span><span class="token punctuation">:</span> #FFFFFF<span class="token punctuation">;</span>
				<span class="token property">line-height</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3><a id="_473"></a>总结</h3> 
<p>聊天界面差不多就这样完结了！很多功能都是边做边想到的，主要是实现更好的交互体验！有问题欢迎来评论区留言噢~</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ba8b4fa7f2c92e9ddfeac9b54e7501d2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java实现文件预览</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b3dbdbca06876e67372a4f8f6cab16bc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">填充和步幅在卷积神经网络中的应用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>