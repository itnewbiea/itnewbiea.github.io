<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>字体图片rgb565格式转换为ARGB888格式 - IT学习者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="字体图片rgb565格式转换为ARGB888格式" />
<meta property="og:description" content="RGB的意思是红色（Red）、绿色（Green）和蓝色（Blue）
rgb565 是16位（2字节）
565表示在16位编码中每个颜色分量所占的位数。红色占5个bit，绿色占6个bit，蓝色占5个bit。
argb888 是32位 （4字节）
888表示红色占8个bit，绿色占8个bit，蓝色占8个bit，还有a表示透明度，也是占8个bit
那么一个像素点占8&#43;8&#43;8&#43;8=32位（4字节）
直接贴参考代码
//将渲染后的Surface转换成Bitmap void MySample_SurfaceWord_ToBMP(SDL_Surface *surface,BITMAP_S *stBitmap,SDL_Color fntcol) { unsigned short words_color = ((fntcol.r &gt;&gt; 3) &lt;&lt; 11) &#43; ((fntcol.g &gt;&gt; 2) &lt;&lt; 5) &#43; (fntcol.b &gt;&gt; 3); //字体颜色 unsigned short bck_color = 0xffff - words_color; //字体以外的背景颜色 stBitmap-&gt;u32Height = (surface-&gt;h); //BITMAP 的宽高向上2对齐 stBitmap-&gt;u32Width = (surface-&gt;w); stBitmap-&gt;pData = malloc(4*(stBitmap-&gt;u32Height)*(stBitmap-&gt;u32Width)); //申请空间，ARGB8888=&gt;4Byte/Pixel，总大小为4*w*h memset(stBitmap-&gt;pData,0,4*(stBitmap-&gt;u32Height)*(stBitmap-&gt;u32Width)); int i,j; int w = surface-&gt;w; int h = surface-&gt;h; for (i = 0; i &lt; h; &#43;&#43;i) { RK_U32 *p_dst = (RK_U32*)stBitmap-&gt;pData; RK_U16 *p_src = (RK_U16*)surface-&gt;pixels; int dis_pos = 0; if(w % 2 !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://itnewbiea.github.io/posts/c99fd02dfebdad1120fb02aa522495eb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-03T16:30:10+08:00" />
<meta property="article:modified_time" content="2023-12-03T16:30:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="IT学习者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">IT学习者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">字体图片rgb565格式转换为ARGB888格式</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>RGB的意思是红色（Red）、绿色（Green）和蓝色（Blue）<br> rgb565 是16位（2字节）<br> 565表示在16位编码中每个颜色分量所占的位数。红色占5个bit，绿色占6个bit，蓝色占5个bit。<br> argb888 是32位 （4字节）<br> 888表示红色占8个bit，绿色占8个bit，蓝色占8个bit，还有a表示透明度，也是占8个bit<br> 那么一个像素点占8+8+8+8=32位（4字节）</p> 
<p>直接贴参考代码</p> 
<pre><code class="prism language-c"><span class="token comment">//将渲染后的Surface转换成Bitmap</span>
 <span class="token keyword">void</span> <span class="token function">MySample_SurfaceWord_ToBMP</span><span class="token punctuation">(</span>SDL_Surface <span class="token operator">*</span>surface<span class="token punctuation">,</span>BITMAP_S <span class="token operator">*</span>stBitmap<span class="token punctuation">,</span>SDL_Color fntcol<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token keyword">unsigned</span> <span class="token keyword">short</span> words_color <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fntcol<span class="token punctuation">.</span>r <span class="token operator">&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fntcol<span class="token punctuation">.</span>g <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>fntcol<span class="token punctuation">.</span>b <span class="token operator">&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//字体颜色</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">short</span> bck_color <span class="token operator">=</span> <span class="token number">0xffff</span> <span class="token operator">-</span> words_color<span class="token punctuation">;</span> <span class="token comment">//字体以外的背景颜色</span>
  stBitmap<span class="token operator">-&gt;</span>u32Height <span class="token operator">=</span> <span class="token punctuation">(</span>surface<span class="token operator">-&gt;</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//BITMAP 的宽高向上2对齐</span>
	stBitmap<span class="token operator">-&gt;</span>u32Width <span class="token operator">=</span> <span class="token punctuation">(</span>surface<span class="token operator">-&gt;</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
	stBitmap<span class="token operator">-&gt;</span>pData <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token punctuation">(</span>stBitmap<span class="token operator">-&gt;</span>u32Height<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>stBitmap<span class="token operator">-&gt;</span>u32Width<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//申请空间，ARGB8888=&gt;4Byte/Pixel，总大小为4*w*h</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>stBitmap<span class="token operator">-&gt;</span>pData<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token operator">*</span><span class="token punctuation">(</span>stBitmap<span class="token operator">-&gt;</span>u32Height<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>stBitmap<span class="token operator">-&gt;</span>u32Width<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>
	<span class="token keyword">int</span> w <span class="token operator">=</span> surface<span class="token operator">-&gt;</span>w<span class="token punctuation">;</span>
	<span class="token keyword">int</span> h <span class="token operator">=</span> surface<span class="token operator">-&gt;</span>h<span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> h<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		RK_U32 <span class="token operator">*</span>p_dst <span class="token operator">=</span> <span class="token punctuation">(</span>RK_U32<span class="token operator">*</span><span class="token punctuation">)</span>stBitmap<span class="token operator">-&gt;</span>pData<span class="token punctuation">;</span>
		RK_U16 <span class="token operator">*</span>p_src <span class="token operator">=</span> <span class="token punctuation">(</span>RK_U16<span class="token operator">*</span><span class="token punctuation">)</span>surface<span class="token operator">-&gt;</span>pixels<span class="token punctuation">;</span>
	    <span class="token keyword">int</span> dis_pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	    <span class="token keyword">if</span><span class="token punctuation">(</span>w <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	    	dis_pos <span class="token operator">=</span> i<span class="token punctuation">;</span>     <span class="token comment">//处理w为奇数的情况</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>w<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">int</span> a<span class="token punctuation">,</span>r<span class="token punctuation">,</span> g <span class="token punctuation">,</span> b<span class="token punctuation">;</span>
			r <span class="token operator">=</span> <span class="token punctuation">(</span>p_src<span class="token punctuation">[</span>i<span class="token operator">*</span>w<span class="token operator">+</span>dis_pos<span class="token operator">+</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xF800</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">;</span>   <span class="token comment">//原图像是RGB565，RGB各分量提取</span>
			g <span class="token operator">=</span> <span class="token punctuation">(</span>p_src<span class="token punctuation">[</span>i<span class="token operator">*</span>w<span class="token operator">+</span>dis_pos<span class="token operator">+</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x07e0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">;</span>
			b <span class="token operator">=</span> <span class="token punctuation">(</span>p_src<span class="token punctuation">[</span>i<span class="token operator">*</span>w<span class="token operator">+</span>dis_pos<span class="token operator">+</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x001f</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span>
			
      <span class="token comment">//一致则A位设置为0，透明</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>bck_color <span class="token operator">==</span> p_src<span class="token punctuation">[</span>i<span class="token operator">*</span>w<span class="token operator">+</span>dis_pos<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
      a <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>   <span class="token comment">//当发现这一位与背景颜色相同时候，把a的透明度设为完全透明</span>
      <span class="token keyword">else</span> a <span class="token operator">=</span> <span class="token number">0xff</span><span class="token punctuation">;</span>

			p_dst<span class="token punctuation">[</span>i<span class="token operator">*</span>stBitmap<span class="token operator">-&gt;</span>u32Width<span class="token operator">+</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>r <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>g <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> b<span class="token punctuation">;</span> <span class="token comment">//转换成ARGB888</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	stBitmap<span class="token operator">-&gt;</span>enPixelFormat <span class="token operator">=</span> PIXEL_FORMAT_ARGB_8888<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b2cf57fdf68c34a1f005b4fab9b9f9a6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Wireshark抓包分析RTMP协议时，出现Unknown问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/44e9fa6e4fc8dc909e7d04b96806e4db/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java 数据结构篇-用链表、数组实现队列（数组实现：循环队列）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 IT学习者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://itnewbiea.github.io/js/foot.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>